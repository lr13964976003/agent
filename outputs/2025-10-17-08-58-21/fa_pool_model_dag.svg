<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: fa_pool_model_dag Pages: 1 -->
<svg width="2880pt" height="7pt"
 viewBox="0.00 0.00 2880.00 7.35" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.01 0.01) rotate(0) translate(4 783)">
<title>fa_pool_model_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-783 308378,-783 308378,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_base_layer</title>
<path fill="none" stroke="blue" d="M9082,-281C9082,-281 14384,-281 14384,-281 14390,-281 14396,-287 14396,-293 14396,-293 14396,-478 14396,-478 14396,-484 14390,-490 14384,-490 14384,-490 9082,-490 9082,-490 9076,-490 9070,-484 9070,-478 9070,-478 9070,-293 9070,-293 9070,-287 9076,-281 9082,-281"/>
<text text-anchor="middle" x="11733" y="-474.8" font-family="Times,serif" font-size="14.00">Base Layer (8 GPUs &#45; Static)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_base_embedding</title>
<path fill="none" stroke="blue" d="M9090,-386C9090,-386 14376,-386 14376,-386 14382,-386 14388,-392 14388,-398 14388,-398 14388,-447 14388,-447 14388,-453 14382,-459 14376,-459 14376,-459 9090,-459 9090,-459 9084,-459 9078,-453 9078,-447 9078,-447 9078,-398 9078,-398 9078,-392 9084,-386 9090,-386"/>
<text text-anchor="middle" x="11733" y="-445.4" font-family="Times,serif" font-size="12.00">Token Embedding</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_base_pos</title>
<path fill="none" stroke="blue" d="M9090,-289C9090,-289 14376,-289 14376,-289 14382,-289 14388,-295 14388,-301 14388,-301 14388,-350 14388,-350 14388,-356 14382,-362 14376,-362 14376,-362 9090,-362 9090,-362 9084,-362 9078,-356 9078,-350 9078,-350 9078,-301 9078,-301 9078,-295 9084,-289 9090,-289"/>
<text text-anchor="middle" x="11733" y="-348.4" font-family="Times,serif" font-size="12.00">Positional Encoding</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_attention_pool</title>
<path fill="none" stroke="red" d="M24538,-370C24538,-370 289218,-370 289218,-370 289224,-370 289230,-376 289230,-382 289230,-382 289230,-621 289230,-621 289230,-627 289224,-633 289218,-633 289218,-633 24538,-633 24538,-633 24532,-633 24526,-627 24526,-621 24526,-621 24526,-382 24526,-382 24526,-376 24532,-370 24538,-370"/>
<text text-anchor="middle" x="156878" y="-617.8" font-family="Times,serif" font-size="14.00">Dynamic Attention Pool (0&#45;32 GPUs)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_pool_0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="227938,-498 227938,-602 289222,-602 289222,-498 227938,-498"/>
<text text-anchor="middle" x="258580" y="-590" font-family="Times,serif" font-size="10.00">Use base GPUs for &lt;4096 tokens</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer0_0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="273903,-506 273903,-575 289214,-575 289214,-506 273903,-506"/>
<text text-anchor="middle" x="281558.5" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 0 Attention</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer1_0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="258584,-506 258584,-575 273895,-575 273895,-506 258584,-506"/>
<text text-anchor="middle" x="266239.5" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 1 Attention</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer2_0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="243265,-506 243265,-575 258576,-575 258576,-506 243265,-506"/>
<text text-anchor="middle" x="250920.5" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 2 Attention</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer3_0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="227946,-506 227946,-575 243257,-575 243257,-506 227946,-506"/>
<text text-anchor="middle" x="235601.5" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 3 Attention</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_pool_8</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="92954,-378 92954,-602 126586,-602 126586,-378 92954,-378"/>
<text text-anchor="middle" x="109770" y="-590" font-family="Times,serif" font-size="10.00">8 pool GPUs for 4096&#45;8192 tokens</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer0_8</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="92962,-386 92962,-575 101360,-575 101360,-386 92962,-386"/>
<text text-anchor="middle" x="97161" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 0 Attention</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer1_8</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="101368,-386 101368,-575 109766,-575 109766,-386 101368,-386"/>
<text text-anchor="middle" x="105567" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 1 Attention</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer2_8</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="109774,-386 109774,-575 118172,-575 118172,-386 109774,-386"/>
<text text-anchor="middle" x="113973" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 2 Attention</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer3_8</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="118180,-386 118180,-575 126578,-575 126578,-386 118180,-386"/>
<text text-anchor="middle" x="122379" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 3 Attention</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_pool_16</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="24534,-378 24534,-602 91982,-602 91982,-378 24534,-378"/>
<text text-anchor="middle" x="58258" y="-590" font-family="Times,serif" font-size="10.00">16 pool GPUs for 8192&#45;16384 tokens</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer0_16</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="58262,-386 58262,-575 75114,-575 75114,-386 58262,-386"/>
<text text-anchor="middle" x="66688" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 0 Attention</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer1_16</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="75122,-386 75122,-575 91974,-575 91974,-386 75122,-386"/>
<text text-anchor="middle" x="83548" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 1 Attention</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer2_16</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="24542,-386 24542,-575 41394,-575 41394,-386 24542,-386"/>
<text text-anchor="middle" x="32968" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 2 Attention</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer3_16</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="41402,-386 41402,-575 58254,-575 58254,-386 41402,-386"/>
<text text-anchor="middle" x="49828" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 3 Attention</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_pool_24</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="126594,-378 126594,-602 227930,-602 227930,-378 126594,-378"/>
<text text-anchor="middle" x="177262" y="-590" font-family="Times,serif" font-size="10.00">24 pool GPUs for &gt;16384 tokens</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer0_24</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="177266,-386 177266,-575 202590,-575 202590,-386 177266,-386"/>
<text text-anchor="middle" x="189928" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 0 Attention</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_layer1_24</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="202598,-386 202598,-575 227922,-575 227922,-386 202598,-386"/>
<text text-anchor="middle" x="215260" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 1 Attention</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_layer2_24</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="126602,-386 126602,-575 151926,-575 151926,-386 126602,-386"/>
<text text-anchor="middle" x="139264" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 2 Attention</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_layer3_24</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="151934,-386 151934,-575 177258,-575 177258,-386 151934,-386"/>
<text text-anchor="middle" x="164596" y="-564.6" font-family="Times,serif" font-size="8.00">Layer 3 Attention</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_layer0_ffn</title>
<path fill="none" stroke="black" d="M20,-217C20,-217 9050,-217 9050,-217 9056,-217 9062,-223 9062,-229 9062,-229 9062,-567 9062,-567 9062,-573 9056,-579 9050,-579 9050,-579 20,-579 20,-579 14,-579 8,-573 8,-567 8,-567 8,-229 8,-229 8,-223 14,-217 20,-217"/>
<text text-anchor="middle" x="4535" y="-565.4" font-family="Times,serif" font-size="12.00">Layer 0 FFN (Base GPUs)</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_layer1_ffn</title>
<path fill="none" stroke="black" d="M15476,-217C15476,-217 24506,-217 24506,-217 24512,-217 24518,-223 24518,-229 24518,-229 24518,-567 24518,-567 24518,-573 24512,-579 24506,-579 24506,-579 15476,-579 15476,-579 15470,-579 15464,-573 15464,-567 15464,-567 15464,-229 15464,-229 15464,-223 15470,-217 15476,-217"/>
<text text-anchor="middle" x="19991" y="-565.4" font-family="Times,serif" font-size="12.00">Layer 1 FFN (Base GPUs)</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_layer2_ffn</title>
<path fill="none" stroke="black" d="M290262,-217C290262,-217 299292,-217 299292,-217 299298,-217 299304,-223 299304,-229 299304,-229 299304,-567 299304,-567 299304,-573 299298,-579 299292,-579 299292,-579 290262,-579 290262,-579 290256,-579 290250,-573 290250,-567 290250,-567 290250,-229 290250,-229 290250,-223 290256,-217 290262,-217"/>
<text text-anchor="middle" x="294777" y="-565.4" font-family="Times,serif" font-size="12.00">Layer 2 FFN (Base GPUs)</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_layer3_ffn</title>
<path fill="none" stroke="black" d="M299324,-217C299324,-217 308354,-217 308354,-217 308360,-217 308366,-223 308366,-229 308366,-229 308366,-567 308366,-567 308366,-573 308360,-579 308354,-579 308354,-579 299324,-579 299324,-579 299318,-579 299312,-573 299312,-567 299312,-567 299312,-229 299312,-229 299312,-223 299318,-217 299324,-217"/>
<text text-anchor="middle" x="303839" y="-565.4" font-family="Times,serif" font-size="12.00">Layer 3 FFN (Base GPUs)</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M301045,-136C301045,-136 306132,-136 306132,-136 306138,-136 306144,-142 306144,-148 306144,-148 306144,-197 306144,-197 306144,-203 306138,-209 306132,-209 306132,-209 301045,-209 301045,-209 301039,-209 301033,-203 301033,-197 301033,-197 301033,-148 301033,-148 301033,-142 301039,-136 301045,-136"/>
<text text-anchor="middle" x="303588.5" y="-195.4" font-family="Times,serif" font-size="12.00">Output Layer (Base GPUs)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="12065" cy="-731" rx="221" ry="18"/>
<text text-anchor="middle" x="12065" y="-728.5" font-family="Arial" font-size="10.00">&lt;b&gt;Model Input&lt;/b&gt;&lt;br/&gt;Input: [batch_size=1024, seq_len=?, vocab_size=32000]</text>
</g>
<!-- resource_manager -->
<g id="node2" class="node">
<title>resource_manager</title>
<polygon fill="lightcoral" stroke="black" points="53565.42,-659 53377.71,-677 53002.29,-677 52814.58,-659 53002.29,-641 53377.71,-641 53565.42,-659"/>
<text text-anchor="middle" x="53190" y="-656.5" font-family="Arial" font-size="10.00">&lt;b&gt;Resource Manager&lt;/b&gt;&lt;br/&gt;Monitors sequence length&lt;br/&gt;Allocates attention pool GPUs&lt;br/&gt;Threshold: 4096 tokens</text>
</g>
<!-- input&#45;&gt;resource_manager -->
<g id="edge1" class="edge">
<title>input&#45;&gt;resource_manager</title>
<path fill="none" stroke="black" d="M11991.42,-713.94C11991.42,-692.65 11991.42,-659 11991.42,-659 11991.42,-659 52804.48,-659 52804.48,-659"/>
<polygon fill="black" stroke="black" points="52804.48,-662.5 52814.48,-659 52804.48,-655.5 52804.48,-662.5"/>
</g>
<!-- base_embed_0 -->
<g id="node3" class="node">
<title>base_embed_0</title>
<polygon fill="lightgreen" stroke="black" points="14380,-430 13734,-430 13734,-394 14380,-394 14380,-430"/>
<text text-anchor="middle" x="14057" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;base_embed_0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;base_embed_0</title>
<path fill="none" stroke="black" d="M12212.17,-717.34C12212.17,-701.93 12212.17,-679 12212.17,-679 12212.17,-679 14057,-679 14057,-679 14057,-679 14057,-440.35 14057,-440.35"/>
<polygon fill="black" stroke="black" points="14060.5,-440.35 14057,-430.35 14053.5,-440.35 14060.5,-440.35"/>
</g>
<!-- base_embed_1 -->
<g id="node4" class="node">
<title>base_embed_1</title>
<polygon fill="lightgreen" stroke="black" points="13716,-430 13070,-430 13070,-394 13716,-394 13716,-430"/>
<text text-anchor="middle" x="13393" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;base_embed_1 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;base_embed_1</title>
<path fill="none" stroke="black" d="M12138.58,-713.94C12138.58,-698.45 12138.58,-678 12138.58,-678 12138.58,-678 13377.96,-678 13377.96,-678 13377.96,-678 13377.96,-440.28 13377.96,-440.28"/>
<polygon fill="black" stroke="black" points="13381.46,-440.28 13377.96,-430.28 13374.46,-440.28 13381.46,-440.28"/>
</g>
<!-- base_embed_2 -->
<g id="node5" class="node">
<title>base_embed_2</title>
<polygon fill="lightgreen" stroke="black" points="13052,-430 12406,-430 12406,-394 13052,-394 13052,-430"/>
<text text-anchor="middle" x="12729" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;base_embed_2 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;base_embed_2</title>
<path fill="none" stroke="black" d="M12065,-712.72C12065,-697.05 12065,-677 12065,-677 12065,-677 12695.96,-677 12695.96,-677 12695.96,-677 12695.96,-440.21 12695.96,-440.21"/>
<polygon fill="black" stroke="black" points="12699.46,-440.21 12695.96,-430.21 12692.46,-440.21 12699.46,-440.21"/>
</g>
<!-- base_embed_3 -->
<g id="node6" class="node">
<title>base_embed_3</title>
<polygon fill="lightgreen" stroke="black" points="11724,-430 11078,-430 11078,-394 11724,-394 11724,-430"/>
<text text-anchor="middle" x="11401" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;base_embed_3 -->
<g id="edge12" class="edge">
<title>input&#45;&gt;base_embed_3</title>
<path fill="none" stroke="black" d="M11890.11,-720C11693.38,-720 11401,-720 11401,-720 11401,-720 11401,-440.34 11401,-440.34"/>
<polygon fill="black" stroke="black" points="11404.5,-440.34 11401,-430.34 11397.5,-440.34 11404.5,-440.34"/>
</g>
<!-- base_embed_4 -->
<g id="node7" class="node">
<title>base_embed_4</title>
<polygon fill="lightgreen" stroke="black" points="12388,-430 11742,-430 11742,-394 12388,-394 12388,-430"/>
<text text-anchor="middle" x="12065" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;base_embed_4 -->
<g id="edge15" class="edge">
<title>input&#45;&gt;base_embed_4</title>
<path fill="none" stroke="black" d="M11917.83,-717.29C11917.83,-717.29 11917.83,-440.24 11917.83,-440.24"/>
<polygon fill="black" stroke="black" points="11921.33,-440.24 11917.83,-430.24 11914.33,-440.24 11921.33,-440.24"/>
</g>
<!-- base_embed_5 -->
<g id="node8" class="node">
<title>base_embed_5</title>
<polygon fill="lightgreen" stroke="black" points="11060,-430 10414,-430 10414,-394 11060,-394 11060,-430"/>
<text text-anchor="middle" x="10737" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;base_embed_5 -->
<g id="edge18" class="edge">
<title>input&#45;&gt;base_embed_5</title>
<path fill="none" stroke="black" d="M11849.42,-727C11473.34,-727 10737,-727 10737,-727 10737,-727 10737,-440.3 10737,-440.3"/>
<polygon fill="black" stroke="black" points="10740.5,-440.3 10737,-430.3 10733.5,-440.3 10740.5,-440.3"/>
</g>
<!-- base_embed_6 -->
<g id="node9" class="node">
<title>base_embed_6</title>
<polygon fill="lightgreen" stroke="black" points="10396,-430 9750,-430 9750,-394 10396,-394 10396,-430"/>
<text text-anchor="middle" x="10073" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;base_embed_6 -->
<g id="edge21" class="edge">
<title>input&#45;&gt;base_embed_6</title>
<path fill="none" stroke="black" d="M11847.08,-734C11330.2,-734 10073,-734 10073,-734 10073,-734 10073,-440.23 10073,-440.23"/>
<polygon fill="black" stroke="black" points="10076.5,-440.23 10073,-430.23 10069.5,-440.23 10076.5,-440.23"/>
</g>
<!-- base_embed_7 -->
<g id="node10" class="node">
<title>base_embed_7</title>
<polygon fill="lightgreen" stroke="black" points="9732,-430 9086,-430 9086,-394 9732,-394 9732,-430"/>
<text text-anchor="middle" x="9409" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;base_embed_7 -->
<g id="edge24" class="edge">
<title>input&#45;&gt;base_embed_7</title>
<path fill="none" stroke="black" d="M11881.39,-741C11280.2,-741 9409,-741 9409,-741 9409,-741 9409,-440.16 9409,-440.16"/>
<polygon fill="black" stroke="black" points="9412.5,-440.16 9409,-430.16 9405.5,-440.16 9412.5,-440.16"/>
</g>
<!-- seq_router -->
<g id="node19" class="node">
<title>seq_router</title>
<polygon fill="lightyellow" stroke="black" points="92946.31,-550 92185.43,-550 91989.69,-514 92750.57,-514 92946.31,-550"/>
<text text-anchor="middle" x="92468" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Sequence Router&lt;/b&gt;&lt;br/&gt;Routes attention based on sequence length&lt;br/&gt;Short: base GPUs&lt;br/&gt;Long: attention pool</text>
</g>
<!-- resource_manager&#45;&gt;seq_router -->
<g id="edge2" class="edge">
<title>resource_manager&#45;&gt;seq_router</title>
<path fill="none" stroke="black" d="M53398.73,-675C56459.3,-675 92149.23,-675 92149.23,-675 92149.23,-675 92149.23,-553.7 92149.23,-553.7"/>
<polygon fill="black" stroke="black" points="92152.73,-553.7 92149.23,-543.7 92145.73,-553.7 92152.73,-553.7"/>
</g>
<!-- base_pos_0 -->
<g id="node11" class="node">
<title>base_pos_0</title>
<polygon fill="lightgreen" stroke="black" points="14380,-333 13734,-333 13734,-297 14380,-297 14380,-333"/>
<text text-anchor="middle" x="14057" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_embed_0&#45;&gt;base_pos_0 -->
<g id="edge4" class="edge">
<title>base_embed_0&#45;&gt;base_pos_0</title>
<path fill="none" stroke="black" d="M13949.33,-393.76C13949.33,-393.76 13949.33,-343.16 13949.33,-343.16"/>
<polygon fill="black" stroke="black" points="13952.83,-343.16 13949.33,-333.16 13945.83,-343.16 13952.83,-343.16"/>
</g>
<!-- base_pos_1 -->
<g id="node12" class="node">
<title>base_pos_1</title>
<polygon fill="lightgreen" stroke="black" points="13716,-333 13070,-333 13070,-297 13716,-297 13716,-333"/>
<text text-anchor="middle" x="13393" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_embed_1&#45;&gt;base_pos_1 -->
<g id="edge7" class="edge">
<title>base_embed_1&#45;&gt;base_pos_1</title>
<path fill="none" stroke="black" d="M13285.33,-393.76C13285.33,-393.76 13285.33,-343.16 13285.33,-343.16"/>
<polygon fill="black" stroke="black" points="13288.83,-343.16 13285.33,-333.16 13281.83,-343.16 13288.83,-343.16"/>
</g>
<!-- base_pos_2 -->
<g id="node13" class="node">
<title>base_pos_2</title>
<polygon fill="lightgreen" stroke="black" points="13052,-333 12406,-333 12406,-297 13052,-297 13052,-333"/>
<text text-anchor="middle" x="12729" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_embed_2&#45;&gt;base_pos_2 -->
<g id="edge10" class="edge">
<title>base_embed_2&#45;&gt;base_pos_2</title>
<path fill="none" stroke="black" d="M12729,-393.76C12729,-393.76 12729,-343.16 12729,-343.16"/>
<polygon fill="black" stroke="black" points="12732.5,-343.16 12729,-333.16 12725.5,-343.16 12732.5,-343.16"/>
</g>
<!-- base_pos_3 -->
<g id="node14" class="node">
<title>base_pos_3</title>
<polygon fill="lightgreen" stroke="black" points="11724,-333 11078,-333 11078,-297 11724,-297 11724,-333"/>
<text text-anchor="middle" x="11401" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_embed_3&#45;&gt;base_pos_3 -->
<g id="edge13" class="edge">
<title>base_embed_3&#45;&gt;base_pos_3</title>
<path fill="none" stroke="black" d="M11401,-393.76C11401,-393.76 11401,-343.16 11401,-343.16"/>
<polygon fill="black" stroke="black" points="11404.5,-343.16 11401,-333.16 11397.5,-343.16 11404.5,-343.16"/>
</g>
<!-- base_pos_4 -->
<g id="node15" class="node">
<title>base_pos_4</title>
<polygon fill="lightgreen" stroke="black" points="12388,-333 11742,-333 11742,-297 12388,-297 12388,-333"/>
<text text-anchor="middle" x="12065" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_embed_4&#45;&gt;base_pos_4 -->
<g id="edge16" class="edge">
<title>base_embed_4&#45;&gt;base_pos_4</title>
<path fill="none" stroke="black" d="M12065,-393.76C12065,-393.76 12065,-343.16 12065,-343.16"/>
<polygon fill="black" stroke="black" points="12068.5,-343.16 12065,-333.16 12061.5,-343.16 12068.5,-343.16"/>
</g>
<!-- base_pos_5 -->
<g id="node16" class="node">
<title>base_pos_5</title>
<polygon fill="lightgreen" stroke="black" points="10396,-333 9750,-333 9750,-297 10396,-297 10396,-333"/>
<text text-anchor="middle" x="10073" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_embed_5&#45;&gt;base_pos_5 -->
<g id="edge19" class="edge">
<title>base_embed_5&#45;&gt;base_pos_5</title>
<path fill="none" stroke="black" d="M10413.88,-412C10408.17,-412 10405,-412 10405,-412 10405,-412 10405,-315 10405,-315 10405,-315 10404.11,-315 10404.11,-315"/>
<polygon fill="black" stroke="black" points="10406.12,-311.5 10396.12,-315 10406.12,-318.5 10406.12,-311.5"/>
</g>
<!-- base_pos_6 -->
<g id="node17" class="node">
<title>base_pos_6</title>
<polygon fill="lightgreen" stroke="black" points="9732,-333 9086,-333 9086,-297 9732,-297 9732,-333"/>
<text text-anchor="middle" x="9409" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_embed_6&#45;&gt;base_pos_6 -->
<g id="edge22" class="edge">
<title>base_embed_6&#45;&gt;base_pos_6</title>
<path fill="none" stroke="black" d="M9749.88,-412C9744.17,-412 9741,-412 9741,-412 9741,-412 9741,-315 9741,-315 9741,-315 9740.11,-315 9740.11,-315"/>
<polygon fill="black" stroke="black" points="9742.12,-311.5 9732.12,-315 9742.12,-318.5 9742.12,-311.5"/>
</g>
<!-- base_pos_7 -->
<g id="node18" class="node">
<title>base_pos_7</title>
<polygon fill="lightgreen" stroke="black" points="11060,-333 10414,-333 10414,-297 11060,-297 11060,-333"/>
<text text-anchor="middle" x="10737" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_embed_7&#45;&gt;base_pos_7 -->
<g id="edge25" class="edge">
<title>base_embed_7&#45;&gt;base_pos_7</title>
<path fill="none" stroke="black" d="M9409,-393.91C9409,-370.87 9409,-334 9409,-334 9409,-334 10737,-334 10737,-334 10737,-334 10737,-333.92 10737,-333.92"/>
<polygon fill="black" stroke="black" points="10740.5,-343.18 10737,-333.18 10733.5,-343.18 10740.5,-343.18"/>
</g>
<!-- l0_ffn_ln_0 -->
<g id="node471" class="node">
<title>l0_ffn_ln_0</title>
<polygon fill="lightgreen" stroke="black" points="8928.5,-261 8295.5,-261 8295.5,-225 8928.5,-225 8928.5,-261"/>
<text text-anchor="middle" x="8612" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_0&#45;&gt;l0_ffn_ln_0 -->
<g id="edge28" class="edge">
<title>base_pos_0&#45;&gt;l0_ffn_ln_0</title>
<path fill="none" stroke="black" d="M13863.2,-296.76C13863.2,-281.43 13863.2,-262 13863.2,-262 13863.2,-262 8813.41,-262 8813.41,-262 8813.41,-262 8813.41,-261.92 8813.41,-261.92"/>
<polygon fill="black" stroke="black" points="8816.91,-271.18 8813.41,-261.18 8809.91,-271.18 8816.91,-271.18"/>
</g>
<!-- l1_ffn_ln_0 -->
<g id="node503" class="node">
<title>l1_ffn_ln_0</title>
<polygon fill="lightgreen" stroke="black" points="24279.5,-261 23646.5,-261 23646.5,-225 24279.5,-225 24279.5,-261"/>
<text text-anchor="middle" x="23963" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_0&#45;&gt;l1_ffn_ln_0 -->
<g id="edge365" class="edge">
<title>base_pos_0&#45;&gt;l1_ffn_ln_0</title>
<path fill="none" stroke="black" d="M14250.8,-296.87C14250.8,-286.69 14250.8,-276 14250.8,-276 14250.8,-276 23709.8,-276 23709.8,-276 23709.8,-276 23709.8,-271.04 23709.8,-271.04"/>
<polygon fill="black" stroke="black" points="23713.3,-271.04 23709.8,-261.04 23706.3,-271.04 23713.3,-271.04"/>
</g>
<!-- l2_ffn_ln_0 -->
<g id="node535" class="node">
<title>l2_ffn_ln_0</title>
<polygon fill="lightgreen" stroke="black" points="298645.5,-261 298012.5,-261 298012.5,-225 298645.5,-225 298645.5,-261"/>
<text text-anchor="middle" x="298329" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_0&#45;&gt;l2_ffn_ln_0 -->
<g id="edge702" class="edge">
<title>base_pos_0&#45;&gt;l2_ffn_ln_0</title>
<path fill="none" stroke="black" d="M14164.67,-333.06C14164.67,-344.44 14164.67,-357 14164.67,-357 14164.67,-357 298180.88,-357 298180.88,-357 298180.88,-357 298180.88,-271.06 298180.88,-271.06"/>
<polygon fill="black" stroke="black" points="298184.38,-271.06 298180.88,-261.06 298177.38,-271.06 298184.38,-271.06"/>
</g>
<!-- l3_ffn_ln_0 -->
<g id="node567" class="node">
<title>l3_ffn_ln_0</title>
<polygon fill="lightgreen" stroke="black" points="302447.5,-261 301814.5,-261 301814.5,-225 302447.5,-225 302447.5,-261"/>
<text text-anchor="middle" x="302131" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_0&#45;&gt;l3_ffn_ln_0 -->
<g id="edge1039" class="edge">
<title>base_pos_0&#45;&gt;l3_ffn_ln_0</title>
<path fill="none" stroke="black" d="M14121.6,-296.95C14121.6,-262.11 14121.6,-189 14121.6,-189 14121.6,-189 302058,-189 302058,-189 302058,-189 302058,-214.72 302058,-214.72"/>
<polygon fill="black" stroke="black" points="302054.5,-214.72 302058,-224.72 302061.5,-214.72 302054.5,-214.72"/>
</g>
<!-- allreduce_embed -->
<g id="node622" class="node">
<title>allreduce_embed</title>
<polygon fill="lightyellow" stroke="black" points="12073.84,-261 11531.64,-261 11392.16,-225 11934.36,-225 12073.84,-261"/>
<text text-anchor="middle" x="11733" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- base_pos_0&#45;&gt;allreduce_embed -->
<g id="edge5" class="edge">
<title>base_pos_0&#45;&gt;allreduce_embed</title>
<path fill="none" stroke="black" d="M13992.4,-296.78C13992.4,-276.63 13992.4,-247 13992.4,-247 13992.4,-247 12029.73,-247 12029.73,-247"/>
<polygon fill="black" stroke="black" points="12029.73,-243.5 12019.73,-247 12029.73,-250.5 12029.73,-243.5"/>
</g>
<!-- l0_ffn_ln_1 -->
<g id="node475" class="node">
<title>l0_ffn_ln_1</title>
<polygon fill="lightgreen" stroke="black" points="3426.5,-261 2793.5,-261 2793.5,-225 3426.5,-225 3426.5,-261"/>
<text text-anchor="middle" x="3110" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_1&#45;&gt;l0_ffn_ln_1 -->
<g id="edge34" class="edge">
<title>base_pos_1&#45;&gt;l0_ffn_ln_1</title>
<path fill="none" stroke="black" d="M13199.2,-296.96C13199.2,-284.44 13199.2,-270 13199.2,-270 13199.2,-270 3416.87,-270 3416.87,-270 3416.87,-270 3416.87,-269.12 3416.87,-269.12"/>
<polygon fill="black" stroke="black" points="3420.37,-271.16 3416.87,-261.16 3413.37,-271.16 3420.37,-271.16"/>
</g>
<!-- l1_ffn_ln_1 -->
<g id="node507" class="node">
<title>l1_ffn_ln_1</title>
<polygon fill="lightgreen" stroke="black" points="23147.5,-261 22514.5,-261 22514.5,-225 23147.5,-225 23147.5,-261"/>
<text text-anchor="middle" x="22831" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_1&#45;&gt;l1_ffn_ln_1 -->
<g id="edge371" class="edge">
<title>base_pos_1&#45;&gt;l1_ffn_ln_1</title>
<path fill="none" stroke="black" d="M13586.8,-296.87C13586.8,-286.69 13586.8,-276 13586.8,-276 13586.8,-276 22567.25,-276 22567.25,-276 22567.25,-276 22567.25,-271.04 22567.25,-271.04"/>
<polygon fill="black" stroke="black" points="22570.75,-271.04 22567.25,-261.04 22563.75,-271.04 22570.75,-271.04"/>
</g>
<!-- l2_ffn_ln_1 -->
<g id="node539" class="node">
<title>l2_ffn_ln_1</title>
<polygon fill="lightgreen" stroke="black" points="297786.5,-261 297153.5,-261 297153.5,-225 297786.5,-225 297786.5,-261"/>
<text text-anchor="middle" x="297470" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_1&#45;&gt;l2_ffn_ln_1 -->
<g id="edge708" class="edge">
<title>base_pos_1&#45;&gt;l2_ffn_ln_1</title>
<path fill="none" stroke="black" d="M13457.6,-296.89C13457.6,-263.13 13457.6,-194 13457.6,-194 13457.6,-194 297470,-194 297470,-194 297470,-194 297470,-214.75 297470,-214.75"/>
<polygon fill="black" stroke="black" points="297466.5,-214.75 297470,-224.75 297473.5,-214.75 297466.5,-214.75"/>
</g>
<!-- l3_ffn_ln_1 -->
<g id="node571" class="node">
<title>l3_ffn_ln_1</title>
<polygon fill="lightgreen" stroke="black" points="307561.5,-261 306928.5,-261 306928.5,-225 307561.5,-225 307561.5,-261"/>
<text text-anchor="middle" x="307245" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_1&#45;&gt;l3_ffn_ln_1 -->
<g id="edge1045" class="edge">
<title>base_pos_1&#45;&gt;l3_ffn_ln_1</title>
<path fill="none" stroke="black" d="M13500.67,-333.24C13500.67,-348.57 13500.67,-368 13500.67,-368 13500.67,-368 307240.24,-368 307240.24,-368 307240.24,-368 307240.24,-271.18 307240.24,-271.18"/>
<polygon fill="black" stroke="black" points="307243.74,-271.18 307240.24,-261.18 307236.74,-271.18 307243.74,-271.18"/>
</g>
<!-- base_pos_1&#45;&gt;allreduce_embed -->
<g id="edge8" class="edge">
<title>base_pos_1&#45;&gt;allreduce_embed</title>
<path fill="none" stroke="black" d="M13328.4,-296.78C13328.4,-278.17 13328.4,-252 13328.4,-252 13328.4,-252 12049.19,-252 12049.19,-252"/>
<polygon fill="black" stroke="black" points="12049.19,-248.5 12039.19,-252 12049.19,-255.5 12049.19,-248.5"/>
</g>
<!-- l0_ffn_ln_2 -->
<g id="node479" class="node">
<title>l0_ffn_ln_2</title>
<polygon fill="lightgreen" stroke="black" points="899.5,-261 266.5,-261 266.5,-225 899.5,-225 899.5,-261"/>
<text text-anchor="middle" x="583" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_2&#45;&gt;l0_ffn_ln_2 -->
<g id="edge40" class="edge">
<title>base_pos_2&#45;&gt;l0_ffn_ln_2</title>
<path fill="none" stroke="black" d="M12513.67,-296.97C12513.67,-290.15 12513.67,-284 12513.67,-284 12513.67,-284 741.25,-284 741.25,-284 741.25,-284 741.25,-271.1 741.25,-271.1"/>
<polygon fill="black" stroke="black" points="744.75,-271.1 741.25,-261.1 737.75,-271.1 744.75,-271.1"/>
</g>
<!-- l1_ffn_ln_2 -->
<g id="node511" class="node">
<title>l1_ffn_ln_2</title>
<polygon fill="lightgreen" stroke="black" points="22015.5,-261 21382.5,-261 21382.5,-225 22015.5,-225 22015.5,-261"/>
<text text-anchor="middle" x="21699" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_2&#45;&gt;l1_ffn_ln_2 -->
<g id="edge377" class="edge">
<title>base_pos_2&#45;&gt;l1_ffn_ln_2</title>
<path fill="none" stroke="black" d="M12944.33,-296.87C12944.33,-286.29 12944.33,-275 12944.33,-275 12944.33,-275 21435.25,-275 21435.25,-275 21435.25,-275 21435.25,-271.24 21435.25,-271.24"/>
<polygon fill="black" stroke="black" points="21438.75,-271.24 21435.25,-261.24 21431.75,-271.24 21438.75,-271.24"/>
</g>
<!-- l2_ffn_ln_2 -->
<g id="node543" class="node">
<title>l2_ffn_ln_2</title>
<polygon fill="lightgreen" stroke="black" points="295649.5,-261 295016.5,-261 295016.5,-225 295649.5,-225 295649.5,-261"/>
<text text-anchor="middle" x="295333" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_2&#45;&gt;l2_ffn_ln_2 -->
<g id="edge714" class="edge">
<title>base_pos_2&#45;&gt;l2_ffn_ln_2</title>
<path fill="none" stroke="black" d="M12836.67,-296.93C12836.67,-263.64 12836.67,-196 12836.67,-196 12836.67,-196 295333,-196 295333,-196 295333,-196 295333,-214.96 295333,-214.96"/>
<polygon fill="black" stroke="black" points="295329.5,-214.96 295333,-224.96 295336.5,-214.96 295329.5,-214.96"/>
</g>
<!-- l3_ffn_ln_2 -->
<g id="node575" class="node">
<title>l3_ffn_ln_2</title>
<polygon fill="lightgreen" stroke="black" points="306494.5,-261 305861.5,-261 305861.5,-225 306494.5,-225 306494.5,-261"/>
<text text-anchor="middle" x="306178" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_2&#45;&gt;l3_ffn_ln_2 -->
<g id="edge1051" class="edge">
<title>base_pos_2&#45;&gt;l3_ffn_ln_2</title>
<path fill="none" stroke="black" d="M12729,-296.92C12729,-260.77 12729,-183 12729,-183 12729,-183 305952.83,-183 305952.83,-183 305952.83,-183 305952.83,-215 305952.83,-215"/>
<polygon fill="black" stroke="black" points="305949.33,-215 305952.83,-225 305956.33,-215 305949.33,-215"/>
</g>
<!-- base_pos_2&#45;&gt;allreduce_embed -->
<g id="edge11" class="edge">
<title>base_pos_2&#45;&gt;allreduce_embed</title>
<path fill="none" stroke="black" d="M12621.33,-296.98C12621.33,-279.63 12621.33,-256 12621.33,-256 12621.33,-256 12064.65,-256 12064.65,-256"/>
<polygon fill="black" stroke="black" points="12064.65,-252.5 12054.65,-256 12064.65,-259.5 12064.65,-252.5"/>
</g>
<!-- l0_ffn_ln_3 -->
<g id="node483" class="node">
<title>l0_ffn_ln_3</title>
<polygon fill="lightgreen" stroke="black" points="5427.5,-261 4794.5,-261 4794.5,-225 5427.5,-225 5427.5,-261"/>
<text text-anchor="middle" x="5111" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_3&#45;&gt;l0_ffn_ln_3 -->
<g id="edge46" class="edge">
<title>base_pos_3&#45;&gt;l0_ffn_ln_3</title>
<path fill="none" stroke="black" d="M11156.52,-296.85C11156.52,-283.26 11156.52,-267 11156.52,-267 11156.52,-267 5312.41,-267 5312.41,-267 5312.41,-267 5312.41,-266.42 5312.41,-266.42"/>
<polygon fill="black" stroke="black" points="5315.91,-271.19 5312.41,-261.19 5308.91,-271.19 5315.91,-271.19"/>
</g>
<!-- l1_ffn_ln_3 -->
<g id="node515" class="node">
<title>l1_ffn_ln_3</title>
<polygon fill="lightgreen" stroke="black" points="19731.5,-261 19098.5,-261 19098.5,-225 19731.5,-225 19731.5,-261"/>
<text text-anchor="middle" x="19415" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_3&#45;&gt;l1_ffn_ln_3 -->
<g id="edge383" class="edge">
<title>base_pos_3&#45;&gt;l1_ffn_ln_3</title>
<path fill="none" stroke="black" d="M11613.36,-296.94C11613.36,-285.56 11613.36,-273 11613.36,-273 11613.36,-273 19156.05,-273 19156.05,-273 19156.05,-273 19156.05,-271.14 19156.05,-271.14"/>
<polygon fill="black" stroke="black" points="19159.55,-271.14 19156.05,-261.14 19152.55,-271.14 19159.55,-271.14"/>
</g>
<!-- l2_ffn_ln_3 -->
<g id="node547" class="node">
<title>l2_ffn_ln_3</title>
<polygon fill="lightgreen" stroke="black" points="296781.5,-261 296148.5,-261 296148.5,-225 296781.5,-225 296781.5,-261"/>
<text text-anchor="middle" x="296465" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_3&#45;&gt;l2_ffn_ln_3 -->
<g id="edge720" class="edge">
<title>base_pos_3&#45;&gt;l2_ffn_ln_3</title>
<path fill="none" stroke="black" d="M11313.56,-296.97C11313.56,-290.15 11313.56,-284 11313.56,-284 11313.56,-284 296206.05,-284 296206.05,-284 296206.05,-284 296206.05,-271.1 296206.05,-271.1"/>
<polygon fill="black" stroke="black" points="296209.55,-271.1 296206.05,-261.1 296202.55,-271.1 296209.55,-271.1"/>
</g>
<!-- l3_ffn_ln_3 -->
<g id="node579" class="node">
<title>l3_ffn_ln_3</title>
<polygon fill="lightgreen" stroke="black" points="301335.5,-261 300702.5,-261 300702.5,-225 301335.5,-225 301335.5,-261"/>
<text text-anchor="middle" x="301019" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_3&#45;&gt;l3_ffn_ln_3 -->
<g id="edge1057" class="edge">
<title>base_pos_3&#45;&gt;l3_ffn_ln_3</title>
<path fill="none" stroke="black" d="M11235.04,-296.97C11235.04,-262.58 11235.04,-191 11235.04,-191 11235.04,-191 300956.75,-191 300956.75,-191 300956.75,-191 300956.75,-214.81 300956.75,-214.81"/>
<polygon fill="black" stroke="black" points="300953.25,-214.81 300956.75,-224.81 300960.25,-214.81 300953.25,-214.81"/>
</g>
<!-- base_pos_3&#45;&gt;allreduce_embed -->
<g id="edge14" class="edge">
<title>base_pos_3&#45;&gt;allreduce_embed</title>
<path fill="none" stroke="black" d="M11502.72,-296.83C11502.72,-296.83 11502.72,-263.57 11502.72,-263.57"/>
<polygon fill="black" stroke="black" points="11506.22,-263.57 11502.72,-253.57 11499.22,-263.57 11506.22,-263.57"/>
</g>
<!-- l0_ffn_ln_4 -->
<g id="node487" class="node">
<title>l0_ffn_ln_4</title>
<polygon fill="lightgreen" stroke="black" points="6822.5,-261 6189.5,-261 6189.5,-225 6822.5,-225 6822.5,-261"/>
<text text-anchor="middle" x="6506" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_4&#45;&gt;l0_ffn_ln_4 -->
<g id="edge52" class="edge">
<title>base_pos_4&#45;&gt;l0_ffn_ln_4</title>
<path fill="none" stroke="black" d="M11852.64,-296.75C11852.64,-282.82 11852.64,-266 11852.64,-266 11852.64,-266 6812.87,-266 6812.87,-266 6812.87,-266 6812.87,-265.51 6812.87,-265.51"/>
<polygon fill="black" stroke="black" points="6816.37,-271.12 6812.87,-261.12 6809.37,-271.12 6816.37,-271.12"/>
</g>
<!-- l1_ffn_ln_4 -->
<g id="node519" class="node">
<title>l1_ffn_ln_4</title>
<polygon fill="lightgreen" stroke="black" points="20883.5,-261 20250.5,-261 20250.5,-225 20883.5,-225 20883.5,-261"/>
<text text-anchor="middle" x="20567" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_4&#45;&gt;l1_ffn_ln_4 -->
<g id="edge389" class="edge">
<title>base_pos_4&#45;&gt;l1_ffn_ln_4</title>
<path fill="none" stroke="black" d="M12309.48,-296.9C12309.48,-285.91 12309.48,-274 12309.48,-274 12309.48,-274 20308.05,-274 20308.05,-274 20308.05,-274 20308.05,-271.03 20308.05,-271.03"/>
<polygon fill="black" stroke="black" points="20311.55,-271.03 20308.05,-261.03 20304.55,-271.03 20311.55,-271.03"/>
</g>
<!-- l2_ffn_ln_4 -->
<g id="node551" class="node">
<title>l2_ffn_ln_4</title>
<polygon fill="lightgreen" stroke="black" points="294517.5,-261 293884.5,-261 293884.5,-225 294517.5,-225 294517.5,-261"/>
<text text-anchor="middle" x="294201" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_4&#45;&gt;l2_ffn_ln_4 -->
<g id="edge726" class="edge">
<title>base_pos_4&#45;&gt;l2_ffn_ln_4</title>
<path fill="none" stroke="black" d="M12230.96,-296.82C12230.96,-263.72 12230.96,-197 12230.96,-197 12230.96,-197 294201,-197 294201,-197 294201,-197 294201,-214.82 294201,-214.82"/>
<polygon fill="black" stroke="black" points="294197.5,-214.82 294201,-224.82 294204.5,-214.82 294197.5,-214.82"/>
</g>
<!-- l3_ffn_ln_4 -->
<g id="node583" class="node">
<title>l3_ffn_ln_4</title>
<polygon fill="lightgreen" stroke="black" points="304230.5,-261 303597.5,-261 303597.5,-225 304230.5,-225 304230.5,-261"/>
<text text-anchor="middle" x="303914" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_4&#45;&gt;l3_ffn_ln_4 -->
<g id="edge1063" class="edge">
<title>base_pos_4&#45;&gt;l3_ffn_ln_4</title>
<path fill="none" stroke="black" d="M12152.44,-296.79C12152.44,-261.23 12152.44,-186 12152.44,-186 12152.44,-186 303804.5,-186 303804.5,-186 303804.5,-186 303804.5,-214.96 303804.5,-214.96"/>
<polygon fill="black" stroke="black" points="303801,-214.96 303804.5,-224.96 303808,-214.96 303801,-214.96"/>
</g>
<!-- base_pos_4&#45;&gt;allreduce_embed -->
<g id="edge17" class="edge">
<title>base_pos_4&#45;&gt;allreduce_embed</title>
<path fill="none" stroke="black" d="M11963.28,-296.83C11963.28,-296.83 11963.28,-271.41 11963.28,-271.41"/>
<polygon fill="black" stroke="black" points="11966.78,-271.41 11963.28,-261.41 11959.78,-271.41 11966.78,-271.41"/>
</g>
<!-- l0_ffn_ln_5 -->
<g id="node491" class="node">
<title>l0_ffn_ln_5</title>
<polygon fill="lightgreen" stroke="black" points="4526.5,-261 3893.5,-261 3893.5,-225 4526.5,-225 4526.5,-261"/>
<text text-anchor="middle" x="4210" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_5&#45;&gt;l0_ffn_ln_5 -->
<g id="edge58" class="edge">
<title>base_pos_5&#45;&gt;l0_ffn_ln_5</title>
<path fill="none" stroke="black" d="M9857.67,-296.96C9857.67,-283.71 9857.67,-268 9857.67,-268 9857.67,-268 4521.93,-268 4521.93,-268 4521.93,-268 4521.93,-267.32 4521.93,-267.32"/>
<polygon fill="black" stroke="black" points="4525.43,-271.17 4521.93,-261.17 4518.43,-271.17 4525.43,-271.17"/>
</g>
<!-- l1_ffn_ln_5 -->
<g id="node523" class="node">
<title>l1_ffn_ln_5</title>
<polygon fill="lightgreen" stroke="black" points="18619.5,-261 17986.5,-261 17986.5,-225 18619.5,-225 18619.5,-261"/>
<text text-anchor="middle" x="18303" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_5&#45;&gt;l1_ffn_ln_5 -->
<g id="edge395" class="edge">
<title>base_pos_5&#45;&gt;l1_ffn_ln_5</title>
<path fill="none" stroke="black" d="M10180.67,-296.94C10180.67,-285.56 10180.67,-273 10180.67,-273 10180.67,-273 18044.05,-273 18044.05,-273 18044.05,-273 18044.05,-271.14 18044.05,-271.14"/>
<polygon fill="black" stroke="black" points="18047.55,-271.14 18044.05,-261.14 18040.55,-271.14 18047.55,-271.14"/>
</g>
<!-- l2_ffn_ln_5 -->
<g id="node555" class="node">
<title>l2_ffn_ln_5</title>
<polygon fill="lightgreen" stroke="black" points="291121.5,-261 290488.5,-261 290488.5,-225 291121.5,-225 291121.5,-261"/>
<text text-anchor="middle" x="290805" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_5&#45;&gt;l2_ffn_ln_5 -->
<g id="edge732" class="edge">
<title>base_pos_5&#45;&gt;l2_ffn_ln_5</title>
<path fill="none" stroke="black" d="M10073,-296.78C10073,-264.35 10073,-200 10073,-200 10073,-200 290805,-200 290805,-200 290805,-200 290805,-214.51 290805,-214.51"/>
<polygon fill="black" stroke="black" points="290801.5,-214.51 290805,-224.51 290808.5,-214.51 290801.5,-214.51"/>
</g>
<!-- l3_ffn_ln_5 -->
<g id="node587" class="node">
<title>l3_ffn_ln_5</title>
<polygon fill="lightgreen" stroke="black" points="300183.5,-261 299550.5,-261 299550.5,-225 300183.5,-225 300183.5,-261"/>
<text text-anchor="middle" x="299867" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_5&#45;&gt;l3_ffn_ln_5 -->
<g id="edge1069" class="edge">
<title>base_pos_5&#45;&gt;l3_ffn_ln_5</title>
<path fill="none" stroke="black" d="M9965.33,-296.85C9965.33,-262.64 9965.33,-192 9965.33,-192 9965.33,-192 299761.5,-192 299761.5,-192 299761.5,-192 299761.5,-214.88 299761.5,-214.88"/>
<polygon fill="black" stroke="black" points="299758,-214.88 299761.5,-224.88 299765,-214.88 299758,-214.88"/>
</g>
<!-- base_pos_5&#45;&gt;allreduce_embed -->
<g id="edge20" class="edge">
<title>base_pos_5&#45;&gt;allreduce_embed</title>
<path fill="none" stroke="black" d="M10288.33,-296.73C10288.33,-278.44 10288.33,-253 10288.33,-253 10288.33,-253 11490.49,-253 11490.49,-253"/>
<polygon fill="black" stroke="black" points="11490.49,-256.5 11500.49,-253 11490.49,-249.5 11490.49,-256.5"/>
</g>
<!-- l0_ffn_ln_6 -->
<g id="node495" class="node">
<title>l0_ffn_ln_6</title>
<polygon fill="lightgreen" stroke="black" points="2294.5,-261 1661.5,-261 1661.5,-225 2294.5,-225 2294.5,-261"/>
<text text-anchor="middle" x="1978" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_6&#45;&gt;l0_ffn_ln_6 -->
<g id="edge64" class="edge">
<title>base_pos_6&#45;&gt;l0_ffn_ln_6</title>
<path fill="none" stroke="black" d="M9193.67,-296.85C9193.67,-284.73 9193.67,-271 9193.67,-271 9193.67,-271 2284.87,-271 2284.87,-271 2284.87,-271 2284.87,-270.02 2284.87,-270.02"/>
<polygon fill="black" stroke="black" points="2288.37,-271.21 2284.87,-261.21 2281.37,-271.21 2288.37,-271.21"/>
</g>
<!-- l1_ffn_ln_6 -->
<g id="node527" class="node">
<title>l1_ffn_ln_6</title>
<polygon fill="lightgreen" stroke="black" points="17487.5,-261 16854.5,-261 16854.5,-225 17487.5,-225 17487.5,-261"/>
<text text-anchor="middle" x="17171" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_6&#45;&gt;l1_ffn_ln_6 -->
<g id="edge401" class="edge">
<title>base_pos_6&#45;&gt;l1_ffn_ln_6</title>
<path fill="none" stroke="black" d="M9516.67,-296.51C9516.67,-284.86 9516.67,-272 9516.67,-272 9516.67,-272 16917.8,-272 16917.8,-272 16917.8,-272 16917.8,-270.92 16917.8,-270.92"/>
<polygon fill="black" stroke="black" points="16921.3,-271.2 16917.8,-261.2 16914.3,-271.2 16921.3,-271.2"/>
</g>
<!-- l2_ffn_ln_6 -->
<g id="node559" class="node">
<title>l2_ffn_ln_6</title>
<polygon fill="lightgreen" stroke="black" points="292253.5,-261 291620.5,-261 291620.5,-225 292253.5,-225 292253.5,-261"/>
<text text-anchor="middle" x="291937" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_6&#45;&gt;l2_ffn_ln_6 -->
<g id="edge738" class="edge">
<title>base_pos_6&#45;&gt;l2_ffn_ln_6</title>
<path fill="none" stroke="black" d="M9409,-296.88C9409,-264.25 9409,-199 9409,-199 9409,-199 291937,-199 291937,-199 291937,-199 291937,-214.85 291937,-214.85"/>
<polygon fill="black" stroke="black" points="291933.5,-214.85 291937,-224.85 291940.5,-214.85 291933.5,-214.85"/>
</g>
<!-- l3_ffn_ln_6 -->
<g id="node591" class="node">
<title>l3_ffn_ln_6</title>
<polygon fill="lightgreen" stroke="black" points="303579.5,-261 302946.5,-261 302946.5,-225 303579.5,-225 303579.5,-261"/>
<text text-anchor="middle" x="303263" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_6&#45;&gt;l3_ffn_ln_6 -->
<g id="edge1075" class="edge">
<title>base_pos_6&#45;&gt;l3_ffn_ln_6</title>
<path fill="none" stroke="black" d="M9301.33,-296.8C9301.33,-261.69 9301.33,-188 9301.33,-188 9301.33,-188 302956.1,-188 302956.1,-188 302956.1,-188 302956.1,-214.99 302956.1,-214.99"/>
<polygon fill="black" stroke="black" points="302952.6,-214.99 302956.1,-224.99 302959.6,-214.99 302952.6,-214.99"/>
</g>
<!-- base_pos_6&#45;&gt;allreduce_embed -->
<g id="edge23" class="edge">
<title>base_pos_6&#45;&gt;allreduce_embed</title>
<path fill="none" stroke="black" d="M9624.33,-296.89C9624.33,-277.66 9624.33,-250 9624.33,-250 9624.33,-250 11478.79,-250 11478.79,-250"/>
<polygon fill="black" stroke="black" points="11478.79,-253.5 11488.79,-250 11478.79,-246.5 11478.79,-253.5"/>
</g>
<!-- l0_ffn_ln_7 -->
<g id="node499" class="node">
<title>l0_ffn_ln_7</title>
<polygon fill="lightgreen" stroke="black" points="8037.5,-261 7404.5,-261 7404.5,-225 8037.5,-225 8037.5,-261"/>
<text text-anchor="middle" x="7721" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_7&#45;&gt;l0_ffn_ln_7 -->
<g id="edge70" class="edge">
<title>base_pos_7&#45;&gt;l0_ffn_ln_7</title>
<path fill="none" stroke="black" d="M10521.67,-296.81C10521.67,-281.82 10521.67,-263 10521.67,-263 10521.67,-263 7972.53,-263 7972.53,-263 7972.53,-263 7972.53,-262.82 7972.53,-262.82"/>
<polygon fill="black" stroke="black" points="7976.03,-271.15 7972.53,-261.15 7969.03,-271.15 7976.03,-271.15"/>
</g>
<!-- l1_ffn_ln_7 -->
<g id="node531" class="node">
<title>l1_ffn_ln_7</title>
<polygon fill="lightgreen" stroke="black" points="16355.5,-261 15722.5,-261 15722.5,-225 16355.5,-225 16355.5,-261"/>
<text text-anchor="middle" x="16039" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_7&#45;&gt;l1_ffn_ln_7 -->
<g id="edge407" class="edge">
<title>base_pos_7&#45;&gt;l1_ffn_ln_7</title>
<path fill="none" stroke="black" d="M10844.67,-296.88C10844.67,-282.22 10844.67,-264 10844.67,-264 10844.67,-264 15785.8,-264 15785.8,-264 15785.8,-264 15785.8,-263.71 15785.8,-263.71"/>
<polygon fill="black" stroke="black" points="15789.3,-271.08 15785.8,-261.08 15782.3,-271.08 15789.3,-271.08"/>
</g>
<!-- l2_ffn_ln_7 -->
<g id="node563" class="node">
<title>l2_ffn_ln_7</title>
<polygon fill="lightgreen" stroke="black" points="293385.5,-261 292752.5,-261 292752.5,-225 293385.5,-225 293385.5,-261"/>
<text text-anchor="middle" x="293069" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_7&#45;&gt;l2_ffn_ln_7 -->
<g id="edge744" class="edge">
<title>base_pos_7&#45;&gt;l2_ffn_ln_7</title>
<path fill="none" stroke="black" d="M10737,-296.84C10737,-264.9 10737,-202 10737,-202 10737,-202 293069,-202 293069,-202 293069,-202 293069,-214.9 293069,-214.9"/>
<polygon fill="black" stroke="black" points="293065.5,-214.9 293069,-224.9 293072.5,-214.9 293065.5,-214.9"/>
</g>
<!-- l3_ffn_ln_7 -->
<g id="node595" class="node">
<title>l3_ffn_ln_7</title>
<polygon fill="lightgreen" stroke="black" points="305843.5,-261 305210.5,-261 305210.5,-225 305843.5,-225 305843.5,-261"/>
<text text-anchor="middle" x="305527" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Layer Norm&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- base_pos_7&#45;&gt;l3_ffn_ln_7 -->
<g id="edge1081" class="edge">
<title>base_pos_7&#45;&gt;l3_ffn_ln_7</title>
<path fill="none" stroke="black" d="M10629.33,-296.79C10629.33,-260.79 10629.33,-184 10629.33,-184 10629.33,-184 305401.17,-184 305401.17,-184 305401.17,-184 305401.17,-214.98 305401.17,-214.98"/>
<polygon fill="black" stroke="black" points="305397.67,-214.98 305401.17,-224.98 305404.67,-214.98 305397.67,-214.98"/>
</g>
<!-- base_pos_7&#45;&gt;allreduce_embed -->
<g id="edge26" class="edge">
<title>base_pos_7&#45;&gt;allreduce_embed</title>
<path fill="none" stroke="black" d="M10952.33,-296.97C10952.33,-279.94 10952.33,-257 10952.33,-257 10952.33,-257 11506.06,-257 11506.06,-257"/>
<polygon fill="black" stroke="black" points="11506.06,-260.5 11516.06,-257 11506.06,-253.5 11506.06,-260.5"/>
</g>
<!-- kv_sync_0 -->
<g id="node608" class="node">
<title>kv_sync_0</title>
<polygon fill="lightyellow" stroke="black" points="126609.15,-677 125767.39,-677 125550.85,-641 126392.61,-641 126609.15,-677"/>
<text text-anchor="middle" x="126080" y="-656.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Sync&lt;/b&gt;&lt;br/&gt;Synchronizes K,V tensors&lt;br/&gt;Across attention pool GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- seq_router&#45;&gt;kv_sync_0 -->
<g id="edge27" class="edge">
<title>seq_router&#45;&gt;kv_sync_0</title>
<path fill="none" stroke="black" d="M92468,-550.03C92468,-569.58 92468,-598 92468,-598 92468,-598 125652.85,-598 125652.85,-598 125652.85,-598 125652.85,-630.7 125652.85,-630.7"/>
<polygon fill="black" stroke="black" points="125649.35,-630.7 125652.85,-640.7 125656.35,-630.7 125649.35,-630.7"/>
</g>
<!-- kv_sync_1 -->
<g id="node609" class="node">
<title>kv_sync_1</title>
<polygon fill="lightyellow" stroke="black" points="127685.15,-677 126843.39,-677 126626.85,-641 127468.61,-641 127685.15,-677"/>
<text text-anchor="middle" x="127156" y="-656.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Sync&lt;/b&gt;&lt;br/&gt;Synchronizes K,V tensors&lt;br/&gt;Across attention pool GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- seq_router&#45;&gt;kv_sync_1 -->
<g id="edge364" class="edge">
<title>seq_router&#45;&gt;kv_sync_1</title>
<path fill="none" stroke="black" d="M92627.38,-550.17C92627.38,-569.09 92627.38,-596 92627.38,-596 92627.38,-596 127266.62,-596 127266.62,-596 127266.62,-596 127266.62,-630.78 127266.62,-630.78"/>
<polygon fill="black" stroke="black" points="127263.12,-630.78 127266.62,-640.78 127270.12,-630.78 127263.12,-630.78"/>
</g>
<!-- kv_sync_2 -->
<g id="node610" class="node">
<title>kv_sync_2</title>
<polygon fill="lightyellow" stroke="black" points="118177.15,-677 117335.39,-677 117118.85,-641 117960.61,-641 118177.15,-677"/>
<text text-anchor="middle" x="117648" y="-656.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Sync&lt;/b&gt;&lt;br/&gt;Synchronizes K,V tensors&lt;br/&gt;Across attention pool GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- seq_router&#45;&gt;kv_sync_2 -->
<g id="edge701" class="edge">
<title>seq_router&#45;&gt;kv_sync_2</title>
<path fill="none" stroke="black" d="M92786.77,-550.14C92786.77,-588.23 92786.77,-673 92786.77,-673 92786.77,-673 117301.28,-673 117301.28,-673"/>
<polygon fill="black" stroke="black" points="117301.28,-676.5 117311.28,-673 117301.28,-669.5 117301.28,-676.5"/>
</g>
<!-- kv_sync_3 -->
<g id="node611" class="node">
<title>kv_sync_3</title>
<polygon fill="lightyellow" stroke="black" points="125533.15,-677 124691.39,-677 124474.85,-641 125316.61,-641 125533.15,-677"/>
<text text-anchor="middle" x="125004" y="-656.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Sync&lt;/b&gt;&lt;br/&gt;Synchronizes K,V tensors&lt;br/&gt;Across attention pool GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- seq_router&#45;&gt;kv_sync_3 -->
<g id="edge1038" class="edge">
<title>seq_router&#45;&gt;kv_sync_3</title>
<path fill="none" stroke="black" d="M92308.62,-550.31C92308.62,-570.15 92308.62,-599 92308.62,-599 92308.62,-599 119495.94,-599 119495.94,-599 119495.94,-599 119495.94,-646 119495.94,-646 119495.94,-646 124494.87,-646 124494.87,-646"/>
<polygon fill="black" stroke="black" points="124494.87,-649.5 124504.87,-646 124494.87,-642.5 124494.87,-649.5"/>
</g>
<!-- attn_block_0_0_0 -->
<g id="node20" class="node">
<title>attn_block_0_0_0</title>
<polygon fill="lightgreen" stroke="black" points="289205.5,-550 288364.5,-550 288364.5,-514 289205.5,-514 289205.5,-550"/>
<text text-anchor="middle" x="288785" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Block: 1/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_0_0_0 -->
<g id="node21" class="node">
<title>kv_cache_0_0_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="288346.94,-550 287521.42,-550 287309.06,-514 288134.58,-514 288346.94,-550"/>
<text text-anchor="middle" x="287828" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_0_1_0 -->
<g id="node22" class="node">
<title>attn_block_0_1_0</title>
<polygon fill="lightgreen" stroke="black" points="287291.5,-550 286450.5,-550 286450.5,-514 287291.5,-514 287291.5,-550"/>
<text text-anchor="middle" x="286871" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Block: 2/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_0_1_0 -->
<g id="node23" class="node">
<title>kv_cache_0_1_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="286432.94,-550 285607.42,-550 285395.06,-514 286220.58,-514 286432.94,-550"/>
<text text-anchor="middle" x="285914" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_0_2_0 -->
<g id="node24" class="node">
<title>attn_block_0_2_0</title>
<polygon fill="lightgreen" stroke="black" points="285377.5,-550 284536.5,-550 284536.5,-514 285377.5,-514 285377.5,-550"/>
<text text-anchor="middle" x="284957" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Block: 3/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_0_2_0 -->
<g id="node25" class="node">
<title>kv_cache_0_2_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="284518.94,-550 283693.42,-550 283481.06,-514 284306.58,-514 284518.94,-550"/>
<text text-anchor="middle" x="284000" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_0_3_0 -->
<g id="node26" class="node">
<title>attn_block_0_3_0</title>
<polygon fill="lightgreen" stroke="black" points="283463.5,-550 282622.5,-550 282622.5,-514 283463.5,-514 283463.5,-550"/>
<text text-anchor="middle" x="283043" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Block: 4/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_0_3_0 -->
<g id="node27" class="node">
<title>kv_cache_0_3_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="282604.94,-550 281779.42,-550 281567.06,-514 282392.58,-514 282604.94,-550"/>
<text text-anchor="middle" x="282086" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_0_4_0 -->
<g id="node28" class="node">
<title>attn_block_0_4_0</title>
<polygon fill="lightgreen" stroke="black" points="281549.5,-550 280708.5,-550 280708.5,-514 281549.5,-514 281549.5,-550"/>
<text text-anchor="middle" x="281129" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Block: 5/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_0_4_0 -->
<g id="node29" class="node">
<title>kv_cache_0_4_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="280690.94,-550 279865.42,-550 279653.06,-514 280478.58,-514 280690.94,-550"/>
<text text-anchor="middle" x="280172" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_0_5_0 -->
<g id="node30" class="node">
<title>attn_block_0_5_0</title>
<polygon fill="lightgreen" stroke="black" points="279635.5,-550 278794.5,-550 278794.5,-514 279635.5,-514 279635.5,-550"/>
<text text-anchor="middle" x="279215" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Block: 6/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_0_5_0 -->
<g id="node31" class="node">
<title>kv_cache_0_5_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="278776.94,-550 277951.42,-550 277739.06,-514 278564.58,-514 278776.94,-550"/>
<text text-anchor="middle" x="278258" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_0_6_0 -->
<g id="node32" class="node">
<title>attn_block_0_6_0</title>
<polygon fill="lightgreen" stroke="black" points="277721.5,-550 276880.5,-550 276880.5,-514 277721.5,-514 277721.5,-550"/>
<text text-anchor="middle" x="277301" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Block: 7/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_0_6_0 -->
<g id="node33" class="node">
<title>kv_cache_0_6_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="276862.94,-550 276037.42,-550 275825.06,-514 276650.58,-514 276862.94,-550"/>
<text text-anchor="middle" x="276344" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_0_7_0 -->
<g id="node34" class="node">
<title>attn_block_0_7_0</title>
<polygon fill="lightgreen" stroke="black" points="275807.5,-550 274966.5,-550 274966.5,-514 275807.5,-514 275807.5,-550"/>
<text text-anchor="middle" x="275387" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Block: 8/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_0_7_0 -->
<g id="node35" class="node">
<title>kv_cache_0_7_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="274948.94,-550 274123.42,-550 273911.06,-514 274736.58,-514 274948.94,-550"/>
<text text-anchor="middle" x="274430" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_1_0_0 -->
<g id="node36" class="node">
<title>attn_block_1_0_0</title>
<polygon fill="lightgreen" stroke="black" points="273886.5,-550 273045.5,-550 273045.5,-514 273886.5,-514 273886.5,-550"/>
<text text-anchor="middle" x="273466" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Block: 1/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_1_0_0 -->
<g id="node37" class="node">
<title>kv_cache_1_0_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="273027.94,-550 272202.42,-550 271990.06,-514 272815.58,-514 273027.94,-550"/>
<text text-anchor="middle" x="272509" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_1_1_0 -->
<g id="node38" class="node">
<title>attn_block_1_1_0</title>
<polygon fill="lightgreen" stroke="black" points="271972.5,-550 271131.5,-550 271131.5,-514 271972.5,-514 271972.5,-550"/>
<text text-anchor="middle" x="271552" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Block: 2/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_1_1_0 -->
<g id="node39" class="node">
<title>kv_cache_1_1_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="271113.94,-550 270288.42,-550 270076.06,-514 270901.58,-514 271113.94,-550"/>
<text text-anchor="middle" x="270595" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_1_2_0 -->
<g id="node40" class="node">
<title>attn_block_1_2_0</title>
<polygon fill="lightgreen" stroke="black" points="270058.5,-550 269217.5,-550 269217.5,-514 270058.5,-514 270058.5,-550"/>
<text text-anchor="middle" x="269638" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Block: 3/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_1_2_0 -->
<g id="node41" class="node">
<title>kv_cache_1_2_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="269199.94,-550 268374.42,-550 268162.06,-514 268987.58,-514 269199.94,-550"/>
<text text-anchor="middle" x="268681" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_1_3_0 -->
<g id="node42" class="node">
<title>attn_block_1_3_0</title>
<polygon fill="lightgreen" stroke="black" points="268144.5,-550 267303.5,-550 267303.5,-514 268144.5,-514 268144.5,-550"/>
<text text-anchor="middle" x="267724" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Block: 4/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_1_3_0 -->
<g id="node43" class="node">
<title>kv_cache_1_3_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="267285.94,-550 266460.42,-550 266248.06,-514 267073.58,-514 267285.94,-550"/>
<text text-anchor="middle" x="266767" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_1_4_0 -->
<g id="node44" class="node">
<title>attn_block_1_4_0</title>
<polygon fill="lightgreen" stroke="black" points="266230.5,-550 265389.5,-550 265389.5,-514 266230.5,-514 266230.5,-550"/>
<text text-anchor="middle" x="265810" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Block: 5/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_1_4_0 -->
<g id="node45" class="node">
<title>kv_cache_1_4_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="265371.94,-550 264546.42,-550 264334.06,-514 265159.58,-514 265371.94,-550"/>
<text text-anchor="middle" x="264853" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_1_5_0 -->
<g id="node46" class="node">
<title>attn_block_1_5_0</title>
<polygon fill="lightgreen" stroke="black" points="264316.5,-550 263475.5,-550 263475.5,-514 264316.5,-514 264316.5,-550"/>
<text text-anchor="middle" x="263896" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Block: 6/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_1_5_0 -->
<g id="node47" class="node">
<title>kv_cache_1_5_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="263457.94,-550 262632.42,-550 262420.06,-514 263245.58,-514 263457.94,-550"/>
<text text-anchor="middle" x="262939" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_1_6_0 -->
<g id="node48" class="node">
<title>attn_block_1_6_0</title>
<polygon fill="lightgreen" stroke="black" points="262402.5,-550 261561.5,-550 261561.5,-514 262402.5,-514 262402.5,-550"/>
<text text-anchor="middle" x="261982" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Block: 7/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_1_6_0 -->
<g id="node49" class="node">
<title>kv_cache_1_6_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="261543.94,-550 260718.42,-550 260506.06,-514 261331.58,-514 261543.94,-550"/>
<text text-anchor="middle" x="261025" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_1_7_0 -->
<g id="node50" class="node">
<title>attn_block_1_7_0</title>
<polygon fill="lightgreen" stroke="black" points="260488.5,-550 259647.5,-550 259647.5,-514 260488.5,-514 260488.5,-550"/>
<text text-anchor="middle" x="260068" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Block: 8/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_1_7_0 -->
<g id="node51" class="node">
<title>kv_cache_1_7_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="259629.94,-550 258804.42,-550 258592.06,-514 259417.58,-514 259629.94,-550"/>
<text text-anchor="middle" x="259111" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_2_0_0 -->
<g id="node52" class="node">
<title>attn_block_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="258567.5,-550 257726.5,-550 257726.5,-514 258567.5,-514 258567.5,-550"/>
<text text-anchor="middle" x="258147" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Block: 1/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_2_0_0 -->
<g id="node53" class="node">
<title>kv_cache_2_0_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="257708.94,-550 256883.42,-550 256671.06,-514 257496.58,-514 257708.94,-550"/>
<text text-anchor="middle" x="257190" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_2_1_0 -->
<g id="node54" class="node">
<title>attn_block_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="256653.5,-550 255812.5,-550 255812.5,-514 256653.5,-514 256653.5,-550"/>
<text text-anchor="middle" x="256233" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Block: 2/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_2_1_0 -->
<g id="node55" class="node">
<title>kv_cache_2_1_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="255794.94,-550 254969.42,-550 254757.06,-514 255582.58,-514 255794.94,-550"/>
<text text-anchor="middle" x="255276" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_2_2_0 -->
<g id="node56" class="node">
<title>attn_block_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="254739.5,-550 253898.5,-550 253898.5,-514 254739.5,-514 254739.5,-550"/>
<text text-anchor="middle" x="254319" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Block: 3/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_2_2_0 -->
<g id="node57" class="node">
<title>kv_cache_2_2_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="253880.94,-550 253055.42,-550 252843.06,-514 253668.58,-514 253880.94,-550"/>
<text text-anchor="middle" x="253362" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_2_3_0 -->
<g id="node58" class="node">
<title>attn_block_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="252825.5,-550 251984.5,-550 251984.5,-514 252825.5,-514 252825.5,-550"/>
<text text-anchor="middle" x="252405" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Block: 4/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_2_3_0 -->
<g id="node59" class="node">
<title>kv_cache_2_3_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="251966.94,-550 251141.42,-550 250929.06,-514 251754.58,-514 251966.94,-550"/>
<text text-anchor="middle" x="251448" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_2_4_0 -->
<g id="node60" class="node">
<title>attn_block_2_4_0</title>
<polygon fill="lightgreen" stroke="black" points="250911.5,-550 250070.5,-550 250070.5,-514 250911.5,-514 250911.5,-550"/>
<text text-anchor="middle" x="250491" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Block: 5/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_2_4_0 -->
<g id="node61" class="node">
<title>kv_cache_2_4_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="250052.94,-550 249227.42,-550 249015.06,-514 249840.58,-514 250052.94,-550"/>
<text text-anchor="middle" x="249534" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_2_5_0 -->
<g id="node62" class="node">
<title>attn_block_2_5_0</title>
<polygon fill="lightgreen" stroke="black" points="248997.5,-550 248156.5,-550 248156.5,-514 248997.5,-514 248997.5,-550"/>
<text text-anchor="middle" x="248577" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Block: 6/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_2_5_0 -->
<g id="node63" class="node">
<title>kv_cache_2_5_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="248138.94,-550 247313.42,-550 247101.06,-514 247926.58,-514 248138.94,-550"/>
<text text-anchor="middle" x="247620" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_2_6_0 -->
<g id="node64" class="node">
<title>attn_block_2_6_0</title>
<polygon fill="lightgreen" stroke="black" points="247083.5,-550 246242.5,-550 246242.5,-514 247083.5,-514 247083.5,-550"/>
<text text-anchor="middle" x="246663" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Block: 7/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_2_6_0 -->
<g id="node65" class="node">
<title>kv_cache_2_6_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="246224.94,-550 245399.42,-550 245187.06,-514 246012.58,-514 246224.94,-550"/>
<text text-anchor="middle" x="245706" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_2_7_0 -->
<g id="node66" class="node">
<title>attn_block_2_7_0</title>
<polygon fill="lightgreen" stroke="black" points="245169.5,-550 244328.5,-550 244328.5,-514 245169.5,-514 245169.5,-550"/>
<text text-anchor="middle" x="244749" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Block: 8/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_2_7_0 -->
<g id="node67" class="node">
<title>kv_cache_2_7_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="244310.94,-550 243485.42,-550 243273.06,-514 244098.58,-514 244310.94,-550"/>
<text text-anchor="middle" x="243792" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_3_0_0 -->
<g id="node68" class="node">
<title>attn_block_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="243248.5,-550 242407.5,-550 242407.5,-514 243248.5,-514 243248.5,-550"/>
<text text-anchor="middle" x="242828" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Block: 1/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_3_0_0 -->
<g id="node69" class="node">
<title>kv_cache_3_0_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="242389.94,-550 241564.42,-550 241352.06,-514 242177.58,-514 242389.94,-550"/>
<text text-anchor="middle" x="241871" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_3_1_0 -->
<g id="node70" class="node">
<title>attn_block_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="241334.5,-550 240493.5,-550 240493.5,-514 241334.5,-514 241334.5,-550"/>
<text text-anchor="middle" x="240914" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Block: 2/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_3_1_0 -->
<g id="node71" class="node">
<title>kv_cache_3_1_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="240475.94,-550 239650.42,-550 239438.06,-514 240263.58,-514 240475.94,-550"/>
<text text-anchor="middle" x="239957" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_3_2_0 -->
<g id="node72" class="node">
<title>attn_block_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="239420.5,-550 238579.5,-550 238579.5,-514 239420.5,-514 239420.5,-550"/>
<text text-anchor="middle" x="239000" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Block: 3/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_3_2_0 -->
<g id="node73" class="node">
<title>kv_cache_3_2_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="238561.94,-550 237736.42,-550 237524.06,-514 238349.58,-514 238561.94,-550"/>
<text text-anchor="middle" x="238043" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_3_3_0 -->
<g id="node74" class="node">
<title>attn_block_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="237506.5,-550 236665.5,-550 236665.5,-514 237506.5,-514 237506.5,-550"/>
<text text-anchor="middle" x="237086" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Block: 4/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_3_3_0 -->
<g id="node75" class="node">
<title>kv_cache_3_3_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="236647.94,-550 235822.42,-550 235610.06,-514 236435.58,-514 236647.94,-550"/>
<text text-anchor="middle" x="236129" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_3_4_0 -->
<g id="node76" class="node">
<title>attn_block_3_4_0</title>
<polygon fill="lightgreen" stroke="black" points="235592.5,-550 234751.5,-550 234751.5,-514 235592.5,-514 235592.5,-550"/>
<text text-anchor="middle" x="235172" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Block: 5/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_3_4_0 -->
<g id="node77" class="node">
<title>kv_cache_3_4_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="234733.94,-550 233908.42,-550 233696.06,-514 234521.58,-514 234733.94,-550"/>
<text text-anchor="middle" x="234215" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_3_5_0 -->
<g id="node78" class="node">
<title>attn_block_3_5_0</title>
<polygon fill="lightgreen" stroke="black" points="233678.5,-550 232837.5,-550 232837.5,-514 233678.5,-514 233678.5,-550"/>
<text text-anchor="middle" x="233258" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Block: 6/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_3_5_0 -->
<g id="node79" class="node">
<title>kv_cache_3_5_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="232819.94,-550 231994.42,-550 231782.06,-514 232607.58,-514 232819.94,-550"/>
<text text-anchor="middle" x="232301" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_3_6_0 -->
<g id="node80" class="node">
<title>attn_block_3_6_0</title>
<polygon fill="lightgreen" stroke="black" points="231764.5,-550 230923.5,-550 230923.5,-514 231764.5,-514 231764.5,-550"/>
<text text-anchor="middle" x="231344" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Block: 7/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_3_6_0 -->
<g id="node81" class="node">
<title>kv_cache_3_6_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="230905.94,-550 230080.42,-550 229868.06,-514 230693.58,-514 230905.94,-550"/>
<text text-anchor="middle" x="230387" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_3_7_0 -->
<g id="node82" class="node">
<title>attn_block_3_7_0</title>
<polygon fill="lightgreen" stroke="black" points="229850.5,-550 229009.5,-550 229009.5,-514 229850.5,-514 229850.5,-550"/>
<text text-anchor="middle" x="229430" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Block: 8/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/0), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/0), hidden=4096]</text>
</g>
<!-- kv_cache_3_7_0 -->
<g id="node83" class="node">
<title>kv_cache_3_7_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="228991.94,-550 228166.42,-550 227954.06,-514 228779.58,-514 228991.94,-550"/>
<text text-anchor="middle" x="228473" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- attn_block_0_0_8 -->
<g id="node84" class="node">
<title>attn_block_0_0_8</title>
<polygon fill="lightgreen" stroke="black" points="94833,-430 93995,-430 93995,-394 94833,-394 94833,-430"/>
<text text-anchor="middle" x="94414" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- hier_reduce_0_8 -->
<g id="node596" class="node">
<title>hier_reduce_0_8</title>
<polygon fill="lightgray" stroke="black" points="14929,-333 14403.89,-315 14929,-297 15454.11,-315 14929,-333"/>
<text text-anchor="middle" x="14929" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 8 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_0_0_8&#45;&gt;hier_reduce_0_8 -->
<g id="edge78" class="edge">
<title>attn_block_0_0_8&#45;&gt;hier_reduce_0_8</title>
<path fill="none" stroke="black" d="M93998.56,-430.15C93998.56,-443.74 93998.56,-460 93998.56,-460 93998.56,-460 15474.63,-460 15474.63,-460 15474.63,-460 15474.63,-301 15474.63,-301 15474.63,-301 15055.72,-301 15055.72,-301"/>
<polygon fill="black" stroke="black" points="15055.72,-297.5 15045.72,-301 15055.72,-304.5 15055.72,-297.5"/>
</g>
<!-- kv_cache_0_0_8 -->
<g id="node85" class="node">
<title>kv_cache_0_0_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="95052.26,-550 94231.01,-550 94019.74,-514 94840.99,-514 95052.26,-550"/>
<text text-anchor="middle" x="94536" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_0_8&#45;&gt;attn_block_0_0_8 -->
<g id="edge77" class="edge">
<title>kv_cache_0_0_8&#45;&gt;attn_block_0_0_8</title>
<path fill="none" stroke="black" d="M94426.44,-513.77C94426.44,-513.77 94426.44,-440 94426.44,-440"/>
<polygon fill="black" stroke="black" points="94429.94,-440 94426.44,-430 94422.94,-440 94429.94,-440"/>
</g>
<!-- attn_block_0_1_8 -->
<g id="node86" class="node">
<title>attn_block_0_1_8</title>
<polygon fill="lightgreen" stroke="black" points="93856,-430 93018,-430 93018,-394 93856,-394 93856,-430"/>
<text text-anchor="middle" x="93437" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_0_1_8&#45;&gt;hier_reduce_0_8 -->
<g id="edge81" class="edge">
<title>attn_block_0_1_8&#45;&gt;hier_reduce_0_8</title>
<path fill="none" stroke="black" d="M93437,-393.83C93437,-391.55 93437,-390 93437,-390 93437,-390 15477.53,-390 15477.53,-390 15477.53,-390 15477.53,-305 15477.53,-305 15477.53,-305 15172.42,-305 15172.42,-305"/>
<polygon fill="black" stroke="black" points="15172.42,-301.5 15162.42,-305 15172.42,-308.5 15172.42,-301.5"/>
</g>
<!-- kv_cache_0_1_8 -->
<g id="node87" class="node">
<title>kv_cache_0_1_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="94002.26,-550 93181.01,-550 92969.74,-514 93790.99,-514 94002.26,-550"/>
<text text-anchor="middle" x="93486" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_1_8&#45;&gt;attn_block_0_1_8 -->
<g id="edge80" class="edge">
<title>kv_cache_0_1_8&#45;&gt;attn_block_0_1_8</title>
<path fill="none" stroke="black" d="M93437,-513.77C93437,-513.77 93437,-440 93437,-440"/>
<polygon fill="black" stroke="black" points="93440.5,-440 93437,-430 93433.5,-440 93440.5,-440"/>
</g>
<!-- attn_block_0_2_8 -->
<g id="node88" class="node">
<title>attn_block_0_2_8</title>
<polygon fill="lightgreen" stroke="black" points="101062,-430 100224,-430 100224,-394 101062,-394 101062,-430"/>
<text text-anchor="middle" x="100643" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_0_2_8&#45;&gt;hier_reduce_0_8 -->
<g id="edge84" class="edge">
<title>attn_block_0_2_8&#45;&gt;hier_reduce_0_8</title>
<path fill="none" stroke="black" d="M100263.06,-430C100263.06,-447.68 100263.06,-472 100263.06,-472 100263.06,-472 15457.21,-472 15457.21,-472 15457.21,-472 15457.21,-329 15457.21,-329 15457.21,-329 15055.9,-329 15055.9,-329"/>
<polygon fill="black" stroke="black" points="15055.9,-325.5 15045.9,-329 15055.9,-332.5 15055.9,-325.5"/>
</g>
<!-- kv_cache_0_2_8 -->
<g id="node89" class="node">
<title>kv_cache_0_2_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="101352.26,-550 100531.01,-550 100319.74,-514 101140.99,-514 101352.26,-550"/>
<text text-anchor="middle" x="100836" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_2_8&#45;&gt;attn_block_0_2_8 -->
<g id="edge83" class="edge">
<title>kv_cache_0_2_8&#45;&gt;attn_block_0_2_8</title>
<path fill="none" stroke="black" d="M100690.94,-513.77C100690.94,-513.77 100690.94,-440 100690.94,-440"/>
<polygon fill="black" stroke="black" points="100694.44,-440 100690.94,-430 100687.44,-440 100694.44,-440"/>
</g>
<!-- attn_block_0_3_8 -->
<g id="node90" class="node">
<title>attn_block_0_3_8</title>
<polygon fill="lightgreen" stroke="black" points="100013,-430 99175,-430 99175,-394 100013,-394 100013,-430"/>
<text text-anchor="middle" x="99594" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_0_3_8&#45;&gt;hier_reduce_0_8 -->
<g id="edge87" class="edge">
<title>attn_block_0_3_8&#45;&gt;hier_reduce_0_8</title>
<path fill="none" stroke="black" d="M99213.56,-430.03C99213.56,-447.06 99213.56,-470 99213.56,-470 99213.56,-470 15460.11,-470 15460.11,-470 15460.11,-470 15460.11,-325 15460.11,-325 15460.11,-325 15172.73,-325 15172.73,-325"/>
<polygon fill="black" stroke="black" points="15172.73,-321.5 15162.73,-325 15172.73,-328.5 15172.73,-321.5"/>
</g>
<!-- kv_cache_0_3_8 -->
<g id="node91" class="node">
<title>kv_cache_0_3_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="100302.26,-550 99481.01,-550 99269.74,-514 100090.99,-514 100302.26,-550"/>
<text text-anchor="middle" x="99786" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_3_8&#45;&gt;attn_block_0_3_8 -->
<g id="edge86" class="edge">
<title>kv_cache_0_3_8&#45;&gt;attn_block_0_3_8</title>
<path fill="none" stroke="black" d="M99641.44,-513.77C99641.44,-513.77 99641.44,-440 99641.44,-440"/>
<polygon fill="black" stroke="black" points="99644.94,-440 99641.44,-430 99637.94,-440 99644.94,-440"/>
</g>
<!-- attn_block_0_4_8 -->
<g id="node92" class="node">
<title>attn_block_0_4_8</title>
<polygon fill="lightgreen" stroke="black" points="98965,-430 98127,-430 98127,-394 98965,-394 98965,-430"/>
<text text-anchor="middle" x="98546" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_0_4_8&#45;&gt;hier_reduce_0_8 -->
<g id="edge90" class="edge">
<title>attn_block_0_4_8&#45;&gt;hier_reduce_0_8</title>
<path fill="none" stroke="black" d="M98164.56,-430.03C98164.56,-446.4 98164.56,-468 98164.56,-468 98164.56,-468 15463.02,-468 15463.02,-468 15463.02,-468 15463.02,-321 15463.02,-321 15463.02,-321 15289.24,-321 15289.24,-321"/>
<polygon fill="black" stroke="black" points="15289.24,-317.5 15279.24,-321 15289.24,-324.5 15289.24,-317.5"/>
</g>
<!-- kv_cache_0_4_8 -->
<g id="node93" class="node">
<title>kv_cache_0_4_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="99252.26,-550 98431.01,-550 98219.74,-514 99040.99,-514 99252.26,-550"/>
<text text-anchor="middle" x="98736" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_4_8&#45;&gt;attn_block_0_4_8 -->
<g id="edge89" class="edge">
<title>kv_cache_0_4_8&#45;&gt;attn_block_0_4_8</title>
<path fill="none" stroke="black" d="M98592.44,-513.77C98592.44,-513.77 98592.44,-440 98592.44,-440"/>
<polygon fill="black" stroke="black" points="98595.94,-440 98592.44,-430 98588.94,-440 98595.94,-440"/>
</g>
<!-- attn_block_0_5_8 -->
<g id="node94" class="node">
<title>attn_block_0_5_8</title>
<polygon fill="lightgreen" stroke="black" points="97920,-430 97082,-430 97082,-394 97920,-394 97920,-430"/>
<text text-anchor="middle" x="97501" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_0_5_8&#45;&gt;hier_reduce_0_8 -->
<g id="edge93" class="edge">
<title>attn_block_0_5_8&#45;&gt;hier_reduce_0_8</title>
<path fill="none" stroke="black" d="M97117.06,-430.28C97117.06,-445.95 97117.06,-466 97117.06,-466 97117.06,-466 15465.92,-466 15465.92,-466 15465.92,-466 15465.92,-317 15465.92,-317 15465.92,-317 15406,-317 15406,-317"/>
<polygon fill="black" stroke="black" points="15406,-313.5 15396,-317 15406,-320.5 15406,-313.5"/>
</g>
<!-- kv_cache_0_5_8 -->
<g id="node95" class="node">
<title>kv_cache_0_5_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="98202.26,-550 97381.01,-550 97169.74,-514 97990.99,-514 98202.26,-550"/>
<text text-anchor="middle" x="97686" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_5_8&#45;&gt;attn_block_0_5_8 -->
<g id="edge92" class="edge">
<title>kv_cache_0_5_8&#45;&gt;attn_block_0_5_8</title>
<path fill="none" stroke="black" d="M97544.94,-513.77C97544.94,-513.77 97544.94,-440 97544.94,-440"/>
<polygon fill="black" stroke="black" points="97548.44,-440 97544.94,-430 97541.44,-440 97548.44,-440"/>
</g>
<!-- attn_block_0_6_8 -->
<g id="node96" class="node">
<title>attn_block_0_6_8</title>
<polygon fill="lightgreen" stroke="black" points="96879,-430 96041,-430 96041,-394 96879,-394 96879,-430"/>
<text text-anchor="middle" x="96460" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_0_6_8&#45;&gt;hier_reduce_0_8 -->
<g id="edge96" class="edge">
<title>attn_block_0_6_8&#45;&gt;hier_reduce_0_8</title>
<path fill="none" stroke="black" d="M96071.56,-430.19C96071.56,-445.18 96071.56,-464 96071.56,-464 96071.56,-464 15468.82,-464 15468.82,-464 15468.82,-464 15468.82,-313 15468.82,-313 15468.82,-313 15406.02,-313 15406.02,-313"/>
<polygon fill="black" stroke="black" points="15406.02,-309.5 15396.02,-313 15406.02,-316.5 15406.02,-309.5"/>
</g>
<!-- kv_cache_0_6_8 -->
<g id="node97" class="node">
<title>kv_cache_0_6_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="97152.26,-550 96331.01,-550 96119.74,-514 96940.99,-514 97152.26,-550"/>
<text text-anchor="middle" x="96636" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_6_8&#45;&gt;attn_block_0_6_8 -->
<g id="edge95" class="edge">
<title>kv_cache_0_6_8&#45;&gt;attn_block_0_6_8</title>
<path fill="none" stroke="black" d="M96499.44,-513.77C96499.44,-513.77 96499.44,-440 96499.44,-440"/>
<polygon fill="black" stroke="black" points="96502.94,-440 96499.44,-430 96495.94,-440 96502.94,-440"/>
</g>
<!-- attn_block_0_7_8 -->
<g id="node98" class="node">
<title>attn_block_0_7_8</title>
<polygon fill="lightgreen" stroke="black" points="95847,-430 95009,-430 95009,-394 95847,-394 95847,-430"/>
<text text-anchor="middle" x="95428" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_0_7_8&#45;&gt;hier_reduce_0_8 -->
<g id="edge99" class="edge">
<title>attn_block_0_7_8&#45;&gt;hier_reduce_0_8</title>
<path fill="none" stroke="black" d="M95030.56,-430.05C95030.56,-444.37 95030.56,-462 95030.56,-462 95030.56,-462 15471.73,-462 15471.73,-462 15471.73,-462 15471.73,-309 15471.73,-309 15471.73,-309 15289.24,-309 15289.24,-309"/>
<polygon fill="black" stroke="black" points="15289.24,-305.5 15279.24,-309 15289.24,-312.5 15289.24,-305.5"/>
</g>
<!-- kv_cache_0_7_8 -->
<g id="node99" class="node">
<title>kv_cache_0_7_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="96102.26,-550 95281.01,-550 95069.74,-514 95890.99,-514 96102.26,-550"/>
<text text-anchor="middle" x="95586" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_7_8&#45;&gt;attn_block_0_7_8 -->
<g id="edge98" class="edge">
<title>kv_cache_0_7_8&#45;&gt;attn_block_0_7_8</title>
<path fill="none" stroke="black" d="M95458.44,-513.77C95458.44,-513.77 95458.44,-440 95458.44,-440"/>
<polygon fill="black" stroke="black" points="95461.94,-440 95458.44,-430 95454.94,-440 95461.94,-440"/>
</g>
<!-- attn_block_1_0_8 -->
<g id="node100" class="node">
<title>attn_block_1_0_8</title>
<polygon fill="lightgreen" stroke="black" points="103239,-430 102401,-430 102401,-394 103239,-394 103239,-430"/>
<text text-anchor="middle" x="102820" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- hier_reduce_1_8 -->
<g id="node599" class="node">
<title>hier_reduce_1_8</title>
<polygon fill="lightgray" stroke="black" points="90880,-333 90354.89,-315 90880,-297 91405.11,-315 90880,-333"/>
<text text-anchor="middle" x="90880" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 8 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_1_0_8&#45;&gt;hier_reduce_1_8 -->
<g id="edge415" class="edge">
<title>attn_block_1_0_8&#45;&gt;hier_reduce_1_8</title>
<path fill="none" stroke="black" d="M102820,-393.77C102820,-369.07 102820,-328 102820,-328 102820,-328 91036.12,-328 91036.12,-328"/>
<polygon fill="black" stroke="black" points="91036.12,-324.5 91026.12,-328 91036.12,-331.5 91036.12,-324.5"/>
</g>
<!-- kv_cache_1_0_8 -->
<g id="node101" class="node">
<title>kv_cache_1_0_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="103458.26,-550 102637.01,-550 102425.74,-514 103246.99,-514 103458.26,-550"/>
<text text-anchor="middle" x="102942" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_0_8&#45;&gt;attn_block_1_0_8 -->
<g id="edge414" class="edge">
<title>kv_cache_1_0_8&#45;&gt;attn_block_1_0_8</title>
<path fill="none" stroke="black" d="M102832.44,-513.77C102832.44,-513.77 102832.44,-440 102832.44,-440"/>
<polygon fill="black" stroke="black" points="102835.94,-440 102832.44,-430 102828.94,-440 102835.94,-440"/>
</g>
<!-- attn_block_1_1_8 -->
<g id="node102" class="node">
<title>attn_block_1_1_8</title>
<polygon fill="lightgreen" stroke="black" points="102262,-430 101424,-430 101424,-394 102262,-394 102262,-430"/>
<text text-anchor="middle" x="101843" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_1_1_8&#45;&gt;hier_reduce_1_8 -->
<g id="edge418" class="edge">
<title>attn_block_1_1_8&#45;&gt;hier_reduce_1_8</title>
<path fill="none" stroke="black" d="M101843,-393.8C101843,-369.64 101843,-330 101843,-330 101843,-330 90977.85,-330 90977.85,-330"/>
<polygon fill="black" stroke="black" points="90977.85,-326.5 90967.85,-330 90977.85,-333.5 90977.85,-326.5"/>
</g>
<!-- kv_cache_1_1_8 -->
<g id="node103" class="node">
<title>kv_cache_1_1_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="102408.26,-550 101587.01,-550 101375.74,-514 102196.99,-514 102408.26,-550"/>
<text text-anchor="middle" x="101892" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_1_8&#45;&gt;attn_block_1_1_8 -->
<g id="edge417" class="edge">
<title>kv_cache_1_1_8&#45;&gt;attn_block_1_1_8</title>
<path fill="none" stroke="black" d="M101843,-513.77C101843,-513.77 101843,-440 101843,-440"/>
<polygon fill="black" stroke="black" points="101846.5,-440 101843,-430 101839.5,-440 101846.5,-440"/>
</g>
<!-- attn_block_1_2_8 -->
<g id="node104" class="node">
<title>attn_block_1_2_8</title>
<polygon fill="lightgreen" stroke="black" points="109468,-430 108630,-430 108630,-394 109468,-394 109468,-430"/>
<text text-anchor="middle" x="109049" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_1_2_8&#45;&gt;hier_reduce_1_8 -->
<g id="edge421" class="edge">
<title>attn_block_1_2_8&#45;&gt;hier_reduce_1_8</title>
<path fill="none" stroke="black" d="M109049,-393.94C109049,-366.13 109049,-316 109049,-316 109049,-316 91385.99,-316 91385.99,-316"/>
<polygon fill="black" stroke="black" points="91385.99,-312.5 91375.99,-316 91385.99,-319.5 91385.99,-312.5"/>
</g>
<!-- kv_cache_1_2_8 -->
<g id="node105" class="node">
<title>kv_cache_1_2_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="109758.26,-550 108937.01,-550 108725.74,-514 109546.99,-514 109758.26,-550"/>
<text text-anchor="middle" x="109242" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_2_8&#45;&gt;attn_block_1_2_8 -->
<g id="edge420" class="edge">
<title>kv_cache_1_2_8&#45;&gt;attn_block_1_2_8</title>
<path fill="none" stroke="black" d="M109096.94,-513.77C109096.94,-513.77 109096.94,-440 109096.94,-440"/>
<polygon fill="black" stroke="black" points="109100.44,-440 109096.94,-430 109093.44,-440 109100.44,-440"/>
</g>
<!-- attn_block_1_3_8 -->
<g id="node106" class="node">
<title>attn_block_1_3_8</title>
<polygon fill="lightgreen" stroke="black" points="108419,-430 107581,-430 107581,-394 108419,-394 108419,-430"/>
<text text-anchor="middle" x="108000" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_1_3_8&#45;&gt;hier_reduce_1_8 -->
<g id="edge424" class="edge">
<title>attn_block_1_3_8&#45;&gt;hier_reduce_1_8</title>
<path fill="none" stroke="black" d="M108000,-393.88C108000,-366.56 108000,-318 108000,-318 108000,-318 91327.69,-318 91327.69,-318"/>
<polygon fill="black" stroke="black" points="91327.69,-314.5 91317.69,-318 91327.69,-321.5 91327.69,-314.5"/>
</g>
<!-- kv_cache_1_3_8 -->
<g id="node107" class="node">
<title>kv_cache_1_3_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="108708.26,-550 107887.01,-550 107675.74,-514 108496.99,-514 108708.26,-550"/>
<text text-anchor="middle" x="108192" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_3_8&#45;&gt;attn_block_1_3_8 -->
<g id="edge423" class="edge">
<title>kv_cache_1_3_8&#45;&gt;attn_block_1_3_8</title>
<path fill="none" stroke="black" d="M108047.44,-513.77C108047.44,-513.77 108047.44,-440 108047.44,-440"/>
<polygon fill="black" stroke="black" points="108050.94,-440 108047.44,-430 108043.94,-440 108050.94,-440"/>
</g>
<!-- attn_block_1_4_8 -->
<g id="node108" class="node">
<title>attn_block_1_4_8</title>
<polygon fill="lightgreen" stroke="black" points="107371,-430 106533,-430 106533,-394 107371,-394 107371,-430"/>
<text text-anchor="middle" x="106952" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_1_4_8&#45;&gt;hier_reduce_1_8 -->
<g id="edge427" class="edge">
<title>attn_block_1_4_8&#45;&gt;hier_reduce_1_8</title>
<path fill="none" stroke="black" d="M106952,-393.82C106952,-367.01 106952,-320 106952,-320 106952,-320 91269.47,-320 91269.47,-320"/>
<polygon fill="black" stroke="black" points="91269.48,-316.5 91259.47,-320 91269.47,-323.5 91269.48,-316.5"/>
</g>
<!-- kv_cache_1_4_8 -->
<g id="node109" class="node">
<title>kv_cache_1_4_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="107658.26,-550 106837.01,-550 106625.74,-514 107446.99,-514 107658.26,-550"/>
<text text-anchor="middle" x="107142" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_4_8&#45;&gt;attn_block_1_4_8 -->
<g id="edge426" class="edge">
<title>kv_cache_1_4_8&#45;&gt;attn_block_1_4_8</title>
<path fill="none" stroke="black" d="M106998.44,-513.77C106998.44,-513.77 106998.44,-440 106998.44,-440"/>
<polygon fill="black" stroke="black" points="107001.94,-440 106998.44,-430 106994.94,-440 107001.94,-440"/>
</g>
<!-- attn_block_1_5_8 -->
<g id="node110" class="node">
<title>attn_block_1_5_8</title>
<polygon fill="lightgreen" stroke="black" points="106326,-430 105488,-430 105488,-394 106326,-394 106326,-430"/>
<text text-anchor="middle" x="105907" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_1_5_8&#45;&gt;hier_reduce_1_8 -->
<g id="edge430" class="edge">
<title>attn_block_1_5_8&#45;&gt;hier_reduce_1_8</title>
<path fill="none" stroke="black" d="M105907,-393.79C105907,-367.49 105907,-322 105907,-322 105907,-322 91211.25,-322 91211.25,-322"/>
<polygon fill="black" stroke="black" points="91211.25,-318.5 91201.25,-322 91211.25,-325.5 91211.25,-318.5"/>
</g>
<!-- kv_cache_1_5_8 -->
<g id="node111" class="node">
<title>kv_cache_1_5_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="106608.26,-550 105787.01,-550 105575.74,-514 106396.99,-514 106608.26,-550"/>
<text text-anchor="middle" x="106092" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_5_8&#45;&gt;attn_block_1_5_8 -->
<g id="edge429" class="edge">
<title>kv_cache_1_5_8&#45;&gt;attn_block_1_5_8</title>
<path fill="none" stroke="black" d="M105950.94,-513.77C105950.94,-513.77 105950.94,-440 105950.94,-440"/>
<polygon fill="black" stroke="black" points="105954.44,-440 105950.94,-430 105947.44,-440 105954.44,-440"/>
</g>
<!-- attn_block_1_6_8 -->
<g id="node112" class="node">
<title>attn_block_1_6_8</title>
<polygon fill="lightgreen" stroke="black" points="105285,-430 104447,-430 104447,-394 105285,-394 105285,-430"/>
<text text-anchor="middle" x="104866" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_1_6_8&#45;&gt;hier_reduce_1_8 -->
<g id="edge433" class="edge">
<title>attn_block_1_6_8&#45;&gt;hier_reduce_1_8</title>
<path fill="none" stroke="black" d="M104866,-393.77C104866,-367.99 104866,-324 104866,-324 104866,-324 91152.67,-324 91152.67,-324"/>
<polygon fill="black" stroke="black" points="91152.67,-320.5 91142.67,-324 91152.67,-327.5 91152.67,-320.5"/>
</g>
<!-- kv_cache_1_6_8 -->
<g id="node113" class="node">
<title>kv_cache_1_6_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="105558.26,-550 104737.01,-550 104525.74,-514 105346.99,-514 105558.26,-550"/>
<text text-anchor="middle" x="105042" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_6_8&#45;&gt;attn_block_1_6_8 -->
<g id="edge432" class="edge">
<title>kv_cache_1_6_8&#45;&gt;attn_block_1_6_8</title>
<path fill="none" stroke="black" d="M104905.44,-513.77C104905.44,-513.77 104905.44,-440 104905.44,-440"/>
<polygon fill="black" stroke="black" points="104908.94,-440 104905.44,-430 104901.94,-440 104908.94,-440"/>
</g>
<!-- attn_block_1_7_8 -->
<g id="node114" class="node">
<title>attn_block_1_7_8</title>
<polygon fill="lightgreen" stroke="black" points="104253,-430 103415,-430 103415,-394 104253,-394 104253,-430"/>
<text text-anchor="middle" x="103834" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_1_7_8&#45;&gt;hier_reduce_1_8 -->
<g id="edge436" class="edge">
<title>attn_block_1_7_8&#45;&gt;hier_reduce_1_8</title>
<path fill="none" stroke="black" d="M103834,-393.76C103834,-368.52 103834,-326 103834,-326 103834,-326 91094.46,-326 91094.46,-326"/>
<polygon fill="black" stroke="black" points="91094.46,-322.5 91084.46,-326 91094.46,-329.5 91094.46,-322.5"/>
</g>
<!-- kv_cache_1_7_8 -->
<g id="node115" class="node">
<title>kv_cache_1_7_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="104508.26,-550 103687.01,-550 103475.74,-514 104296.99,-514 104508.26,-550"/>
<text text-anchor="middle" x="103992" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_7_8&#45;&gt;attn_block_1_7_8 -->
<g id="edge435" class="edge">
<title>kv_cache_1_7_8&#45;&gt;attn_block_1_7_8</title>
<path fill="none" stroke="black" d="M103864.44,-513.77C103864.44,-513.77 103864.44,-440 103864.44,-440"/>
<polygon fill="black" stroke="black" points="103867.94,-440 103864.44,-430 103860.94,-440 103867.94,-440"/>
</g>
<!-- attn_block_2_0_8 -->
<g id="node116" class="node">
<title>attn_block_2_0_8</title>
<polygon fill="lightgreen" stroke="black" points="111864,-430 111026,-430 111026,-394 111864,-394 111864,-430"/>
<text text-anchor="middle" x="111445" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- hier_reduce_2_8 -->
<g id="node602" class="node">
<title>hier_reduce_2_8</title>
<polygon fill="lightgray" stroke="black" points="125606,-333 125080.89,-315 125606,-297 126131.11,-315 125606,-333"/>
<text text-anchor="middle" x="125606" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 8 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_2_0_8&#45;&gt;hier_reduce_2_8 -->
<g id="edge752" class="edge">
<title>attn_block_2_0_8&#45;&gt;hier_reduce_2_8</title>
<path fill="none" stroke="black" d="M111445,-393.67C111445,-362.14 111445,-301 111445,-301 111445,-301 125479.15,-301 125479.15,-301"/>
<polygon fill="black" stroke="black" points="125479.15,-304.5 125489.15,-301 125479.15,-297.5 125479.15,-304.5"/>
</g>
<!-- kv_cache_2_0_8 -->
<g id="node117" class="node">
<title>kv_cache_2_0_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="111864.26,-550 111043.01,-550 110831.74,-514 111652.99,-514 111864.26,-550"/>
<text text-anchor="middle" x="111348" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_0_8&#45;&gt;attn_block_2_0_8 -->
<g id="edge751" class="edge">
<title>kv_cache_2_0_8&#45;&gt;attn_block_2_0_8</title>
<path fill="none" stroke="black" d="M111445,-513.77C111445,-513.77 111445,-440 111445,-440"/>
<polygon fill="black" stroke="black" points="111448.5,-440 111445,-430 111441.5,-440 111448.5,-440"/>
</g>
<!-- attn_block_2_1_8 -->
<g id="node118" class="node">
<title>attn_block_2_1_8</title>
<polygon fill="lightgreen" stroke="black" points="110862,-430 110024,-430 110024,-394 110862,-394 110862,-430"/>
<text text-anchor="middle" x="110443" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_2_1_8&#45;&gt;hier_reduce_2_8 -->
<g id="edge755" class="edge">
<title>attn_block_2_1_8&#45;&gt;hier_reduce_2_8</title>
<path fill="none" stroke="black" d="M110443,-393.84C110443,-361.9 110443,-299 110443,-299 110443,-299 125537.65,-299 125537.65,-299"/>
<polygon fill="black" stroke="black" points="125537.65,-302.5 125547.65,-299 125537.65,-295.5 125537.65,-302.5"/>
</g>
<!-- kv_cache_2_1_8 -->
<g id="node119" class="node">
<title>kv_cache_2_1_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="110814.26,-550 109993.01,-550 109781.74,-514 110602.99,-514 110814.26,-550"/>
<text text-anchor="middle" x="110298" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_1_8&#45;&gt;attn_block_2_1_8 -->
<g id="edge754" class="edge">
<title>kv_cache_2_1_8&#45;&gt;attn_block_2_1_8</title>
<path fill="none" stroke="black" d="M110419.06,-513.77C110419.06,-513.77 110419.06,-440 110419.06,-440"/>
<polygon fill="black" stroke="black" points="110422.56,-440 110419.06,-430 110415.56,-440 110422.56,-440"/>
</g>
<!-- attn_block_2_2_8 -->
<g id="node120" class="node">
<title>attn_block_2_2_8</title>
<polygon fill="lightgreen" stroke="black" points="118115,-430 117277,-430 117277,-394 118115,-394 118115,-430"/>
<text text-anchor="middle" x="117696" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_2_2_8&#45;&gt;hier_reduce_2_8 -->
<g id="edge758" class="edge">
<title>attn_block_2_2_8&#45;&gt;hier_reduce_2_8</title>
<path fill="none" stroke="black" d="M117696,-393.84C117696,-365.26 117696,-313 117696,-313 117696,-313 125128.9,-313 125128.9,-313"/>
<polygon fill="black" stroke="black" points="125128.9,-316.5 125138.9,-313 125128.9,-309.5 125128.9,-316.5"/>
</g>
<!-- kv_cache_2_2_8 -->
<g id="node121" class="node">
<title>kv_cache_2_2_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="118164.26,-550 117343.01,-550 117131.74,-514 117952.99,-514 118164.26,-550"/>
<text text-anchor="middle" x="117648" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_2_8&#45;&gt;attn_block_2_2_8 -->
<g id="edge757" class="edge">
<title>kv_cache_2_2_8&#45;&gt;attn_block_2_2_8</title>
<path fill="none" stroke="black" d="M117696,-513.77C117696,-513.77 117696,-440 117696,-440"/>
<polygon fill="black" stroke="black" points="117699.5,-440 117696,-430 117692.5,-440 117699.5,-440"/>
</g>
<!-- attn_block_2_3_8 -->
<g id="node122" class="node">
<title>attn_block_2_3_8</title>
<polygon fill="lightgreen" stroke="black" points="117138,-430 116300,-430 116300,-394 117138,-394 117138,-430"/>
<text text-anchor="middle" x="116719" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_2_3_8&#45;&gt;hier_reduce_2_8 -->
<g id="edge761" class="edge">
<title>attn_block_2_3_8&#45;&gt;hier_reduce_2_8</title>
<path fill="none" stroke="black" d="M116719,-393.94C116719,-364.89 116719,-311 116719,-311 116719,-311 125187.39,-311 125187.39,-311"/>
<polygon fill="black" stroke="black" points="125187.39,-314.5 125197.39,-311 125187.39,-307.5 125187.39,-314.5"/>
</g>
<!-- kv_cache_2_3_8 -->
<g id="node123" class="node">
<title>kv_cache_2_3_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="117114.26,-550 116293.01,-550 116081.74,-514 116902.99,-514 117114.26,-550"/>
<text text-anchor="middle" x="116598" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_3_8&#45;&gt;attn_block_2_3_8 -->
<g id="edge760" class="edge">
<title>kv_cache_2_3_8&#45;&gt;attn_block_2_3_8</title>
<path fill="none" stroke="black" d="M116707.06,-513.77C116707.06,-513.77 116707.06,-440 116707.06,-440"/>
<polygon fill="black" stroke="black" points="116710.56,-440 116707.06,-430 116703.56,-440 116710.56,-440"/>
</g>
<!-- attn_block_2_4_8 -->
<g id="node124" class="node">
<title>attn_block_2_4_8</title>
<polygon fill="lightgreen" stroke="black" points="116185,-430 115347,-430 115347,-394 116185,-394 116185,-430"/>
<text text-anchor="middle" x="115766" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_2_4_8&#45;&gt;hier_reduce_2_8 -->
<g id="edge764" class="edge">
<title>attn_block_2_4_8&#45;&gt;hier_reduce_2_8</title>
<path fill="none" stroke="black" d="M115766,-393.59C115766,-363.96 115766,-309 115766,-309 115766,-309 125245.79,-309 125245.79,-309"/>
<polygon fill="black" stroke="black" points="125245.79,-312.5 125255.79,-309 125245.79,-305.5 125245.79,-312.5"/>
</g>
<!-- kv_cache_2_4_8 -->
<g id="node125" class="node">
<title>kv_cache_2_4_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="116064.26,-550 115243.01,-550 115031.74,-514 115852.99,-514 116064.26,-550"/>
<text text-anchor="middle" x="115548" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_4_8&#45;&gt;attn_block_2_4_8 -->
<g id="edge763" class="edge">
<title>kv_cache_2_4_8&#45;&gt;attn_block_2_4_8</title>
<path fill="none" stroke="black" d="M115705.56,-513.77C115705.56,-513.77 115705.56,-440 115705.56,-440"/>
<polygon fill="black" stroke="black" points="115709.06,-440 115705.56,-430 115702.06,-440 115709.06,-440"/>
</g>
<!-- attn_block_2_5_8 -->
<g id="node126" class="node">
<title>attn_block_2_5_8</title>
<polygon fill="lightgreen" stroke="black" points="115135,-430 114297,-430 114297,-394 115135,-394 115135,-430"/>
<text text-anchor="middle" x="114716" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_2_5_8&#45;&gt;hier_reduce_2_8 -->
<g id="edge767" class="edge">
<title>attn_block_2_5_8&#45;&gt;hier_reduce_2_8</title>
<path fill="none" stroke="black" d="M114716,-393.71C114716,-363.63 114716,-307 114716,-307 114716,-307 125304.02,-307 125304.02,-307"/>
<polygon fill="black" stroke="black" points="125304.02,-310.5 125314.02,-307 125304.02,-303.5 125304.02,-310.5"/>
</g>
<!-- kv_cache_2_5_8 -->
<g id="node127" class="node">
<title>kv_cache_2_5_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="115014.26,-550 114193.01,-550 113981.74,-514 114802.99,-514 115014.26,-550"/>
<text text-anchor="middle" x="114498" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_5_8&#45;&gt;attn_block_2_5_8 -->
<g id="edge766" class="edge">
<title>kv_cache_2_5_8&#45;&gt;attn_block_2_5_8</title>
<path fill="none" stroke="black" d="M114655.56,-513.77C114655.56,-513.77 114655.56,-440 114655.56,-440"/>
<polygon fill="black" stroke="black" points="114659.06,-440 114655.56,-430 114652.06,-440 114659.06,-440"/>
</g>
<!-- attn_block_2_6_8 -->
<g id="node128" class="node">
<title>attn_block_2_6_8</title>
<polygon fill="lightgreen" stroke="black" points="114073,-430 113235,-430 113235,-394 114073,-394 114073,-430"/>
<text text-anchor="middle" x="113654" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_2_6_8&#45;&gt;hier_reduce_2_8 -->
<g id="edge770" class="edge">
<title>attn_block_2_6_8&#45;&gt;hier_reduce_2_8</title>
<path fill="none" stroke="black" d="M113654,-393.85C113654,-363.32 113654,-305 113654,-305 113654,-305 125362.61,-305 125362.61,-305"/>
<polygon fill="black" stroke="black" points="125362.61,-308.5 125372.61,-305 125362.61,-301.5 125362.61,-308.5"/>
</g>
<!-- kv_cache_2_6_8 -->
<g id="node129" class="node">
<title>kv_cache_2_6_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="113964.26,-550 113143.01,-550 112931.74,-514 113752.99,-514 113964.26,-550"/>
<text text-anchor="middle" x="113448" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_6_8&#45;&gt;attn_block_2_6_8 -->
<g id="edge769" class="edge">
<title>kv_cache_2_6_8&#45;&gt;attn_block_2_6_8</title>
<path fill="none" stroke="black" d="M113599.56,-513.77C113599.56,-513.77 113599.56,-440 113599.56,-440"/>
<polygon fill="black" stroke="black" points="113603.06,-440 113599.56,-430 113596.06,-440 113603.06,-440"/>
</g>
<!-- attn_block_2_7_8 -->
<g id="node130" class="node">
<title>attn_block_2_7_8</title>
<polygon fill="lightgreen" stroke="black" points="113017,-430 112179,-430 112179,-394 113017,-394 113017,-430"/>
<text text-anchor="middle" x="112598" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_2_7_8&#45;&gt;hier_reduce_2_8 -->
<g id="edge773" class="edge">
<title>attn_block_2_7_8&#45;&gt;hier_reduce_2_8</title>
<path fill="none" stroke="black" d="M112598,-393.51C112598,-362.41 112598,-303 112598,-303 112598,-303 125420.74,-303 125420.74,-303"/>
<polygon fill="black" stroke="black" points="125420.74,-306.5 125430.74,-303 125420.74,-299.5 125420.74,-306.5"/>
</g>
<!-- kv_cache_2_7_8 -->
<g id="node131" class="node">
<title>kv_cache_2_7_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="112914.26,-550 112093.01,-550 111881.74,-514 112702.99,-514 112914.26,-550"/>
<text text-anchor="middle" x="112398" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_7_8&#45;&gt;attn_block_2_7_8 -->
<g id="edge772" class="edge">
<title>kv_cache_2_7_8&#45;&gt;attn_block_2_7_8</title>
<path fill="none" stroke="black" d="M112546.56,-513.77C112546.56,-513.77 112546.56,-440 112546.56,-440"/>
<polygon fill="black" stroke="black" points="112550.06,-440 112546.56,-430 112543.06,-440 112550.06,-440"/>
</g>
<!-- attn_block_3_0_8 -->
<g id="node132" class="node">
<title>attn_block_3_0_8</title>
<polygon fill="lightgreen" stroke="black" points="120270,-430 119432,-430 119432,-394 120270,-394 120270,-430"/>
<text text-anchor="middle" x="119851" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- hier_reduce_3_8 -->
<g id="node605" class="node">
<title>hier_reduce_3_8</title>
<polygon fill="lightgray" stroke="black" points="134537,-333 134011.89,-315 134537,-297 135062.11,-315 134537,-333"/>
<text text-anchor="middle" x="134537" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 8 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_3_0_8&#45;&gt;hier_reduce_3_8 -->
<g id="edge1089" class="edge">
<title>attn_block_3_0_8&#45;&gt;hier_reduce_3_8</title>
<path fill="none" stroke="black" d="M119851,-393.75C119851,-370.98 119851,-335 119851,-335 119851,-335 134033.02,-335 134033.02,-335 134033.02,-335 134033.02,-325.86 134033.02,-325.86"/>
<polygon fill="black" stroke="black" points="134036.52,-325.86 134033.02,-315.86 134029.52,-325.86 134036.52,-325.86"/>
</g>
<!-- kv_cache_3_0_8 -->
<g id="node133" class="node">
<title>kv_cache_3_0_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="120270.26,-550 119449.01,-550 119237.74,-514 120058.99,-514 120270.26,-550"/>
<text text-anchor="middle" x="119754" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_0_8&#45;&gt;attn_block_3_0_8 -->
<g id="edge1088" class="edge">
<title>kv_cache_3_0_8&#45;&gt;attn_block_3_0_8</title>
<path fill="none" stroke="black" d="M119851,-513.77C119851,-513.77 119851,-440 119851,-440"/>
<polygon fill="black" stroke="black" points="119854.5,-440 119851,-430 119847.5,-440 119854.5,-440"/>
</g>
<!-- attn_block_3_1_8 -->
<g id="node134" class="node">
<title>attn_block_3_1_8</title>
<polygon fill="lightgreen" stroke="black" points="119268,-430 118430,-430 118430,-394 119268,-394 119268,-430"/>
<text text-anchor="middle" x="118849" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_3_1_8&#45;&gt;hier_reduce_3_8 -->
<g id="edge1092" class="edge">
<title>attn_block_3_1_8&#45;&gt;hier_reduce_3_8</title>
<path fill="none" stroke="black" d="M119252.94,-430.15C119252.94,-442.27 119252.94,-456 119252.94,-456 119252.94,-456 134262.83,-456 134262.83,-456 134262.83,-456 134262.83,-333.82 134262.83,-333.82"/>
<polygon fill="black" stroke="black" points="134266.33,-333.82 134262.83,-323.82 134259.33,-333.82 134266.33,-333.82"/>
</g>
<!-- kv_cache_3_1_8 -->
<g id="node135" class="node">
<title>kv_cache_3_1_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="119220.26,-550 118399.01,-550 118187.74,-514 119008.99,-514 119220.26,-550"/>
<text text-anchor="middle" x="118704" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_1_8&#45;&gt;attn_block_3_1_8 -->
<g id="edge1091" class="edge">
<title>kv_cache_3_1_8&#45;&gt;attn_block_3_1_8</title>
<path fill="none" stroke="black" d="M118825.06,-513.77C118825.06,-513.77 118825.06,-440 118825.06,-440"/>
<polygon fill="black" stroke="black" points="118828.56,-440 118825.06,-430 118821.56,-440 118828.56,-440"/>
</g>
<!-- attn_block_3_2_8 -->
<g id="node136" class="node">
<title>attn_block_3_2_8</title>
<polygon fill="lightgreen" stroke="black" points="126521,-430 125683,-430 125683,-394 126521,-394 126521,-430"/>
<text text-anchor="middle" x="126102" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_3_2_8&#45;&gt;hier_reduce_3_8 -->
<g id="edge1095" class="edge">
<title>attn_block_3_2_8&#45;&gt;hier_reduce_3_8</title>
<path fill="none" stroke="black" d="M126456.05,-393.97C126456.05,-369.02 126456.05,-327 126456.05,-327 126456.05,-327 134351.65,-327 134351.65,-327"/>
<polygon fill="black" stroke="black" points="134351.65,-330.5 134361.65,-327 134351.65,-323.5 134351.65,-330.5"/>
</g>
<!-- kv_cache_3_2_8 -->
<g id="node137" class="node">
<title>kv_cache_3_2_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="126570.26,-550 125749.01,-550 125537.74,-514 126358.99,-514 126570.26,-550"/>
<text text-anchor="middle" x="126054" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_2_8&#45;&gt;attn_block_3_2_8 -->
<g id="edge1094" class="edge">
<title>kv_cache_3_2_8&#45;&gt;attn_block_3_2_8</title>
<path fill="none" stroke="black" d="M126102,-513.77C126102,-513.77 126102,-440 126102,-440"/>
<polygon fill="black" stroke="black" points="126105.5,-440 126102,-430 126098.5,-440 126105.5,-440"/>
</g>
<!-- attn_block_3_3_8 -->
<g id="node138" class="node">
<title>attn_block_3_3_8</title>
<polygon fill="lightgreen" stroke="black" points="125544,-430 124706,-430 124706,-394 125544,-394 125544,-430"/>
<text text-anchor="middle" x="125125" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_3_3_8&#45;&gt;hier_reduce_3_8 -->
<g id="edge1098" class="edge">
<title>attn_block_3_3_8&#45;&gt;hier_reduce_3_8</title>
<path fill="none" stroke="black" d="M125312.35,-393.99C125312.35,-371.51 125312.35,-336 125312.35,-336 125312.35,-336 134054.35,-336 134054.35,-336 134054.35,-336 134054.35,-326.65 134054.35,-326.65"/>
<polygon fill="black" stroke="black" points="134057.85,-326.65 134054.35,-316.65 134050.85,-326.65 134057.85,-326.65"/>
</g>
<!-- kv_cache_3_3_8 -->
<g id="node139" class="node">
<title>kv_cache_3_3_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="125520.26,-550 124699.01,-550 124487.74,-514 125308.99,-514 125520.26,-550"/>
<text text-anchor="middle" x="125004" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_3_8&#45;&gt;attn_block_3_3_8 -->
<g id="edge1097" class="edge">
<title>kv_cache_3_3_8&#45;&gt;attn_block_3_3_8</title>
<path fill="none" stroke="black" d="M125113.06,-513.77C125113.06,-513.77 125113.06,-440 125113.06,-440"/>
<polygon fill="black" stroke="black" points="125116.56,-440 125113.06,-430 125109.56,-440 125116.56,-440"/>
</g>
<!-- attn_block_3_4_8 -->
<g id="node140" class="node">
<title>attn_block_3_4_8</title>
<polygon fill="lightgreen" stroke="black" points="124615,-430 123777,-430 123777,-394 124615,-394 124615,-430"/>
<text text-anchor="middle" x="124196" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_3_4_8&#45;&gt;hier_reduce_3_8 -->
<g id="edge1101" class="edge">
<title>attn_block_3_4_8&#45;&gt;hier_reduce_3_8</title>
<path fill="none" stroke="black" d="M124551.44,-430.16C124551.44,-435.04 124551.44,-439 124551.44,-439 124551.44,-439 134130.17,-439 134130.17,-439 134130.17,-439 134130.17,-329.13 134130.17,-329.13"/>
<polygon fill="black" stroke="black" points="134133.67,-329.13 134130.17,-319.13 134126.67,-329.13 134133.67,-329.13"/>
</g>
<!-- kv_cache_3_4_8 -->
<g id="node141" class="node">
<title>kv_cache_3_4_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="124470.26,-550 123649.01,-550 123437.74,-514 124258.99,-514 124470.26,-550"/>
<text text-anchor="middle" x="123954" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_4_8&#45;&gt;attn_block_3_4_8 -->
<g id="edge1100" class="edge">
<title>kv_cache_3_4_8&#45;&gt;attn_block_3_4_8</title>
<path fill="none" stroke="black" d="M124123.56,-513.77C124123.56,-513.77 124123.56,-440 124123.56,-440"/>
<polygon fill="black" stroke="black" points="124127.06,-440 124123.56,-430 124120.06,-440 124127.06,-440"/>
</g>
<!-- attn_block_3_5_8 -->
<g id="node142" class="node">
<title>attn_block_3_5_8</title>
<polygon fill="lightgreen" stroke="black" points="123614,-430 122776,-430 122776,-394 123614,-394 123614,-430"/>
<text text-anchor="middle" x="123195" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_3_5_8&#45;&gt;hier_reduce_3_8 -->
<g id="edge1104" class="edge">
<title>attn_block_3_5_8&#45;&gt;hier_reduce_3_8</title>
<path fill="none" stroke="black" d="M123525.94,-430.2C123525.94,-436.03 123525.94,-441 123525.94,-441 123525.94,-441 134163.33,-441 134163.33,-441 134163.33,-441 134163.33,-330.41 134163.33,-330.41"/>
<polygon fill="black" stroke="black" points="134166.83,-330.41 134163.33,-320.41 134159.83,-330.41 134166.83,-330.41"/>
</g>
<!-- kv_cache_3_5_8 -->
<g id="node143" class="node">
<title>kv_cache_3_5_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="123420.26,-550 122599.01,-550 122387.74,-514 123208.99,-514 123420.26,-550"/>
<text text-anchor="middle" x="122904" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_5_8&#45;&gt;attn_block_3_5_8 -->
<g id="edge1103" class="edge">
<title>kv_cache_3_5_8&#45;&gt;attn_block_3_5_8</title>
<path fill="none" stroke="black" d="M123098.06,-513.77C123098.06,-513.77 123098.06,-440 123098.06,-440"/>
<polygon fill="black" stroke="black" points="123101.56,-440 123098.06,-430 123094.56,-440 123101.56,-440"/>
</g>
<!-- attn_block_3_6_8 -->
<g id="node144" class="node">
<title>attn_block_3_6_8</title>
<polygon fill="lightgreen" stroke="black" points="122467,-430 121629,-430 121629,-394 122467,-394 122467,-430"/>
<text text-anchor="middle" x="122048" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_3_6_8&#45;&gt;hier_reduce_3_8 -->
<g id="edge1107" class="edge">
<title>attn_block_3_6_8&#45;&gt;hier_reduce_3_8</title>
<path fill="none" stroke="black" d="M122427.44,-430.04C122427.44,-437.75 122427.44,-445 122427.44,-445 122427.44,-445 134196.5,-445 134196.5,-445 134196.5,-445 134196.5,-331.63 134196.5,-331.63"/>
<polygon fill="black" stroke="black" points="134200,-331.63 134196.5,-321.63 134193,-331.63 134200,-331.63"/>
</g>
<!-- kv_cache_3_6_8 -->
<g id="node145" class="node">
<title>kv_cache_3_6_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="122370.26,-550 121549.01,-550 121337.74,-514 122158.99,-514 122370.26,-550"/>
<text text-anchor="middle" x="121854" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_6_8&#45;&gt;attn_block_3_6_8 -->
<g id="edge1106" class="edge">
<title>kv_cache_3_6_8&#45;&gt;attn_block_3_6_8</title>
<path fill="none" stroke="black" d="M121999.56,-513.77C121999.56,-513.77 121999.56,-440 121999.56,-440"/>
<polygon fill="black" stroke="black" points="122003.06,-440 121999.56,-430 121996.06,-440 122003.06,-440"/>
</g>
<!-- attn_block_3_7_8 -->
<g id="node146" class="node">
<title>attn_block_3_7_8</title>
<polygon fill="lightgreen" stroke="black" points="121417,-430 120579,-430 120579,-394 121417,-394 121417,-430"/>
<text text-anchor="middle" x="120998" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/8&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/8), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/8), hidden=4096]</text>
</g>
<!-- attn_block_3_7_8&#45;&gt;hier_reduce_3_8 -->
<g id="edge1110" class="edge">
<title>attn_block_3_7_8&#45;&gt;hier_reduce_3_8</title>
<path fill="none" stroke="black" d="M121377.44,-430.32C121377.44,-438.79 121377.44,-447 121377.44,-447 121377.44,-447 134229.67,-447 134229.67,-447 134229.67,-447 134229.67,-332.48 134229.67,-332.48"/>
<polygon fill="black" stroke="black" points="134233.17,-332.48 134229.67,-322.48 134226.17,-332.48 134233.17,-332.48"/>
</g>
<!-- kv_cache_3_7_8 -->
<g id="node147" class="node">
<title>kv_cache_3_7_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="121320.26,-550 120499.01,-550 120287.74,-514 121108.99,-514 121320.26,-550"/>
<text text-anchor="middle" x="120804" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_7_8&#45;&gt;attn_block_3_7_8 -->
<g id="edge1109" class="edge">
<title>kv_cache_3_7_8&#45;&gt;attn_block_3_7_8</title>
<path fill="none" stroke="black" d="M120949.56,-513.77C120949.56,-513.77 120949.56,-440 120949.56,-440"/>
<polygon fill="black" stroke="black" points="120953.06,-440 120949.56,-430 120946.06,-440 120953.06,-440"/>
</g>
<!-- attn_block_0_0_16 -->
<g id="node148" class="node">
<title>attn_block_0_0_16</title>
<polygon fill="lightgreen" stroke="black" points="68531,-430 67677,-430 67677,-394 68531,-394 68531,-430"/>
<text text-anchor="middle" x="68104" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- hier_reduce_0_16 -->
<g id="node597" class="node">
<title>hier_reduce_0_16</title>
<polygon fill="lightgray" stroke="black" points="62460,-333 61930.57,-315 62460,-297 62989.43,-315 62460,-333"/>
<text text-anchor="middle" x="62460" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 16 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_0_0_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge150" class="edge">
<title>attn_block_0_0_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M68104,-393.66C68104,-364.79 68104,-312 68104,-312 68104,-312 62911.41,-312 62911.41,-312"/>
<polygon fill="black" stroke="black" points="62911.41,-308.5 62901.41,-312 62911.41,-315.5 62911.41,-308.5"/>
</g>
<!-- kv_cache_0_0_16 -->
<g id="node149" class="node">
<title>kv_cache_0_0_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="68752.26,-550 67931.01,-550 67719.74,-514 68540.99,-514 68752.26,-550"/>
<text text-anchor="middle" x="68236" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_0_16&#45;&gt;attn_block_0_0_16 -->
<g id="edge149" class="edge">
<title>kv_cache_0_0_16&#45;&gt;attn_block_0_0_16</title>
<path fill="none" stroke="black" d="M68125.44,-513.77C68125.44,-513.77 68125.44,-440 68125.44,-440"/>
<polygon fill="black" stroke="black" points="68128.94,-440 68125.44,-430 68121.94,-440 68128.94,-440"/>
</g>
<!-- attn_block_0_1_16 -->
<g id="node150" class="node">
<title>attn_block_0_1_16</title>
<polygon fill="lightgreen" stroke="black" points="67484,-430 66630,-430 66630,-394 67484,-394 67484,-430"/>
<text text-anchor="middle" x="67057" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_1_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge153" class="edge">
<title>attn_block_0_1_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M67057,-393.57C67057,-365.18 67057,-314 67057,-314 67057,-314 62970.16,-314 62970.16,-314"/>
<polygon fill="black" stroke="black" points="62970.16,-310.5 62960.16,-314 62970.16,-317.5 62970.16,-310.5"/>
</g>
<!-- kv_cache_0_1_16 -->
<g id="node151" class="node">
<title>kv_cache_0_1_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="67702.26,-550 66881.01,-550 66669.74,-514 67490.99,-514 67702.26,-550"/>
<text text-anchor="middle" x="67186" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_1_16&#45;&gt;attn_block_0_1_16 -->
<g id="edge152" class="edge">
<title>kv_cache_0_1_16&#45;&gt;attn_block_0_1_16</title>
<path fill="none" stroke="black" d="M67076.94,-513.77C67076.94,-513.77 67076.94,-440 67076.94,-440"/>
<polygon fill="black" stroke="black" points="67080.44,-440 67076.94,-430 67073.44,-440 67080.44,-440"/>
</g>
<!-- attn_block_0_2_16 -->
<g id="node152" class="node">
<title>attn_block_0_2_16</title>
<polygon fill="lightgreen" stroke="black" points="66440,-430 65586,-430 65586,-394 66440,-394 66440,-430"/>
<text text-anchor="middle" x="66013" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_2_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge156" class="edge">
<title>attn_block_0_2_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M66013,-393.76C66013,-365.66 66013,-315 66013,-315 66013,-315 62999.52,-315 62999.52,-315"/>
<polygon fill="black" stroke="black" points="62999.52,-311.5 62989.52,-315 62999.52,-318.5 62999.52,-311.5"/>
</g>
<!-- kv_cache_0_2_16 -->
<g id="node153" class="node">
<title>kv_cache_0_2_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="66652.26,-550 65831.01,-550 65619.74,-514 66440.99,-514 66652.26,-550"/>
<text text-anchor="middle" x="66136" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_2_16&#45;&gt;attn_block_0_2_16 -->
<g id="edge155" class="edge">
<title>kv_cache_0_2_16&#45;&gt;attn_block_0_2_16</title>
<path fill="none" stroke="black" d="M66029.94,-513.77C66029.94,-513.77 66029.94,-440 66029.94,-440"/>
<polygon fill="black" stroke="black" points="66033.44,-440 66029.94,-430 66026.44,-440 66033.44,-440"/>
</g>
<!-- attn_block_0_3_16 -->
<g id="node154" class="node">
<title>attn_block_0_3_16</title>
<polygon fill="lightgreen" stroke="black" points="65401,-430 64547,-430 64547,-394 65401,-394 65401,-430"/>
<text text-anchor="middle" x="64974" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_3_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge159" class="edge">
<title>attn_block_0_3_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M64974,-393.68C64974,-366.08 64974,-317 64974,-317 64974,-317 62940.65,-317 62940.65,-317"/>
<polygon fill="black" stroke="black" points="62940.65,-313.5 62930.65,-317 62940.65,-320.5 62940.65,-313.5"/>
</g>
<!-- kv_cache_0_3_16 -->
<g id="node155" class="node">
<title>kv_cache_0_3_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="65602.26,-550 64781.01,-550 64569.74,-514 65390.99,-514 65602.26,-550"/>
<text text-anchor="middle" x="65086" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_3_16&#45;&gt;attn_block_0_3_16 -->
<g id="edge158" class="edge">
<title>kv_cache_0_3_16&#45;&gt;attn_block_0_3_16</title>
<path fill="none" stroke="black" d="M64985.44,-513.77C64985.44,-513.77 64985.44,-440 64985.44,-440"/>
<polygon fill="black" stroke="black" points="64988.94,-440 64985.44,-430 64981.94,-440 64988.94,-440"/>
</g>
<!-- attn_block_0_4_16 -->
<g id="node156" class="node">
<title>attn_block_0_4_16</title>
<polygon fill="lightgreen" stroke="black" points="64373,-430 63519,-430 63519,-394 64373,-394 64373,-430"/>
<text text-anchor="middle" x="63946" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_4_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge162" class="edge">
<title>attn_block_0_4_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M63946,-393.88C63946,-366.56 63946,-318 63946,-318 63946,-318 62911.32,-318 62911.32,-318"/>
<polygon fill="black" stroke="black" points="62911.32,-314.5 62901.32,-318 62911.32,-321.5 62911.32,-314.5"/>
</g>
<!-- kv_cache_0_4_16 -->
<g id="node157" class="node">
<title>kv_cache_0_4_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="64552.26,-550 63731.01,-550 63519.74,-514 64340.99,-514 64552.26,-550"/>
<text text-anchor="middle" x="64036" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_4_16&#45;&gt;attn_block_0_4_16 -->
<g id="edge161" class="edge">
<title>kv_cache_0_4_16&#45;&gt;attn_block_0_4_16</title>
<path fill="none" stroke="black" d="M63946.44,-513.77C63946.44,-513.77 63946.44,-440 63946.44,-440"/>
<polygon fill="black" stroke="black" points="63949.94,-440 63946.44,-430 63942.94,-440 63949.94,-440"/>
</g>
<!-- attn_block_0_5_16 -->
<g id="node158" class="node">
<title>attn_block_0_5_16</title>
<polygon fill="lightgreen" stroke="black" points="63368,-430 62514,-430 62514,-394 63368,-394 63368,-430"/>
<text text-anchor="middle" x="62941" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_5_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge165" class="edge">
<title>attn_block_0_5_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M62751.73,-393.76C62751.73,-393.76 62751.73,-333.35 62751.73,-333.35"/>
<polygon fill="black" stroke="black" points="62755.23,-333.35 62751.73,-323.35 62748.23,-333.35 62755.23,-333.35"/>
</g>
<!-- kv_cache_0_5_16 -->
<g id="node159" class="node">
<title>kv_cache_0_5_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="63502.26,-550 62681.01,-550 62469.74,-514 63290.99,-514 63502.26,-550"/>
<text text-anchor="middle" x="62986" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_5_16&#45;&gt;attn_block_0_5_16 -->
<g id="edge164" class="edge">
<title>kv_cache_0_5_16&#45;&gt;attn_block_0_5_16</title>
<path fill="none" stroke="black" d="M62941,-513.77C62941,-513.77 62941,-440 62941,-440"/>
<polygon fill="black" stroke="black" points="62944.5,-440 62941,-430 62937.5,-440 62944.5,-440"/>
</g>
<!-- attn_block_0_6_16 -->
<g id="node160" class="node">
<title>attn_block_0_6_16</title>
<polygon fill="lightgreen" stroke="black" points="62407,-430 61553,-430 61553,-394 62407,-394 62407,-430"/>
<text text-anchor="middle" x="61980" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_6_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge168" class="edge">
<title>attn_block_0_6_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M62354.06,-393.76C62354.06,-393.76 62354.06,-339.68 62354.06,-339.68"/>
<polygon fill="black" stroke="black" points="62357.56,-339.68 62354.06,-329.68 62350.56,-339.68 62357.56,-339.68"/>
</g>
<!-- kv_cache_0_6_16 -->
<g id="node161" class="node">
<title>kv_cache_0_6_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="62452.26,-550 61631.01,-550 61419.74,-514 62240.99,-514 62452.26,-550"/>
<text text-anchor="middle" x="61936" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_6_16&#45;&gt;attn_block_0_6_16 -->
<g id="edge167" class="edge">
<title>kv_cache_0_6_16&#45;&gt;attn_block_0_6_16</title>
<path fill="none" stroke="black" d="M61980,-513.77C61980,-513.77 61980,-440 61980,-440"/>
<polygon fill="black" stroke="black" points="61983.5,-440 61980,-430 61976.5,-440 61983.5,-440"/>
</g>
<!-- attn_block_0_7_16 -->
<g id="node162" class="node">
<title>attn_block_0_7_16</title>
<polygon fill="lightgreen" stroke="black" points="61424,-430 60570,-430 60570,-394 61424,-394 61424,-430"/>
<text text-anchor="middle" x="60997" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_7_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge171" class="edge">
<title>attn_block_0_7_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M60997,-393.85C60997,-363.32 60997,-305 60997,-305 60997,-305 62214.54,-305 62214.54,-305"/>
<polygon fill="black" stroke="black" points="62214.54,-308.5 62224.54,-305 62214.54,-301.5 62214.54,-308.5"/>
</g>
<!-- kv_cache_0_7_16 -->
<g id="node163" class="node">
<title>kv_cache_0_7_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="61402.26,-550 60581.01,-550 60369.74,-514 61190.99,-514 61402.26,-550"/>
<text text-anchor="middle" x="60886" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_7_16&#45;&gt;attn_block_0_7_16 -->
<g id="edge170" class="edge">
<title>kv_cache_0_7_16&#45;&gt;attn_block_0_7_16</title>
<path fill="none" stroke="black" d="M60986.06,-513.77C60986.06,-513.77 60986.06,-440 60986.06,-440"/>
<polygon fill="black" stroke="black" points="60989.56,-440 60986.06,-430 60982.56,-440 60989.56,-440"/>
</g>
<!-- attn_block_0_8_16 -->
<g id="node164" class="node">
<title>attn_block_0_8_16</title>
<polygon fill="lightgreen" stroke="black" points="60464,-430 59610,-430 59610,-394 60464,-394 60464,-430"/>
<text text-anchor="middle" x="60037" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Block: 9/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_8_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge174" class="edge">
<title>attn_block_0_8_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M60037,-393.84C60037,-362.59 60037,-302 60037,-302 60037,-302 62302.53,-302 62302.53,-302"/>
<polygon fill="black" stroke="black" points="62302.53,-305.5 62312.53,-302 62302.53,-298.5 62302.53,-305.5"/>
</g>
<!-- kv_cache_0_8_16 -->
<g id="node165" class="node">
<title>kv_cache_0_8_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="60352.26,-550 59531.01,-550 59319.74,-514 60140.99,-514 60352.26,-550"/>
<text text-anchor="middle" x="59836" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_8_16&#45;&gt;attn_block_0_8_16 -->
<g id="edge173" class="edge">
<title>kv_cache_0_8_16&#45;&gt;attn_block_0_8_16</title>
<path fill="none" stroke="black" d="M59981.06,-513.77C59981.06,-513.77 59981.06,-440 59981.06,-440"/>
<polygon fill="black" stroke="black" points="59984.56,-440 59981.06,-430 59977.56,-440 59984.56,-440"/>
</g>
<!-- attn_block_0_9_16 -->
<g id="node166" class="node">
<title>attn_block_0_9_16</title>
<polygon fill="lightgreen" stroke="black" points="59415.5,-430 58556.5,-430 58556.5,-394 59415.5,-394 59415.5,-430"/>
<text text-anchor="middle" x="58986" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Block: 10/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_9_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge177" class="edge">
<title>attn_block_0_9_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M58986,-393.84C58986,-361.9 58986,-299 58986,-299 58986,-299 62391.16,-299 62391.16,-299"/>
<polygon fill="black" stroke="black" points="62391.16,-302.5 62401.16,-299 62391.16,-295.5 62391.16,-302.5"/>
</g>
<!-- kv_cache_0_9_16 -->
<g id="node167" class="node">
<title>kv_cache_0_9_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="59302.26,-550 58481.01,-550 58269.74,-514 59090.99,-514 59302.26,-550"/>
<text text-anchor="middle" x="58786" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_9_16&#45;&gt;attn_block_0_9_16 -->
<g id="edge176" class="edge">
<title>kv_cache_0_9_16&#45;&gt;attn_block_0_9_16</title>
<path fill="none" stroke="black" d="M58929.31,-513.77C58929.31,-513.77 58929.31,-440 58929.31,-440"/>
<polygon fill="black" stroke="black" points="58932.81,-440 58929.31,-430 58925.81,-440 58932.81,-440"/>
</g>
<!-- attn_block_0_10_16 -->
<g id="node168" class="node">
<title>attn_block_0_10_16</title>
<polygon fill="lightgreen" stroke="black" points="74885,-430 74021,-430 74021,-394 74885,-394 74885,-430"/>
<text text-anchor="middle" x="74453" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Block: 11/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_10_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge180" class="edge">
<title>attn_block_0_10_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M74453,-393.51C74453,-362.41 74453,-303 74453,-303 74453,-303 62646.49,-303 62646.49,-303"/>
<polygon fill="black" stroke="black" points="62646.49,-299.5 62636.49,-303 62646.49,-306.5 62646.49,-299.5"/>
</g>
<!-- kv_cache_0_10_16 -->
<g id="node169" class="node">
<title>kv_cache_0_10_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="75106.39,-550 74278.57,-550 74065.61,-514 74893.43,-514 75106.39,-550"/>
<text text-anchor="middle" x="74586" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_10_16&#45;&gt;attn_block_0_10_16 -->
<g id="edge179" class="edge">
<title>kv_cache_0_10_16&#45;&gt;attn_block_0_10_16</title>
<path fill="none" stroke="black" d="M74475.28,-513.77C74475.28,-513.77 74475.28,-440 74475.28,-440"/>
<polygon fill="black" stroke="black" points="74478.78,-440 74475.28,-430 74471.78,-440 74478.78,-440"/>
</g>
<!-- attn_block_0_11_16 -->
<g id="node170" class="node">
<title>attn_block_0_11_16</title>
<polygon fill="lightgreen" stroke="black" points="73826,-430 72962,-430 72962,-394 73826,-394 73826,-430"/>
<text text-anchor="middle" x="73394" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Block: 12/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_11_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge183" class="edge">
<title>attn_block_0_11_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M73394,-393.68C73394,-362.87 73394,-304 73394,-304 73394,-304 62675.95,-304 62675.95,-304"/>
<polygon fill="black" stroke="black" points="62675.95,-300.5 62665.95,-304 62675.95,-307.5 62675.95,-300.5"/>
</g>
<!-- kv_cache_0_11_16 -->
<g id="node171" class="node">
<title>kv_cache_0_11_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="74047.39,-550 73219.57,-550 73006.61,-514 73834.43,-514 74047.39,-550"/>
<text text-anchor="middle" x="73527" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_11_16&#45;&gt;attn_block_0_11_16 -->
<g id="edge182" class="edge">
<title>kv_cache_0_11_16&#45;&gt;attn_block_0_11_16</title>
<path fill="none" stroke="black" d="M73416.28,-513.77C73416.28,-513.77 73416.28,-440 73416.28,-440"/>
<polygon fill="black" stroke="black" points="73419.78,-440 73416.28,-430 73412.78,-440 73419.78,-440"/>
</g>
<!-- attn_block_0_12_16 -->
<g id="node172" class="node">
<title>attn_block_0_12_16</title>
<polygon fill="lightgreen" stroke="black" points="72767,-430 71903,-430 71903,-394 72767,-394 72767,-430"/>
<text text-anchor="middle" x="72335" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Block: 13/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_12_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge186" class="edge">
<title>attn_block_0_12_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M72335,-393.54C72335,-363.17 72335,-306 72335,-306 72335,-306 62734.77,-306 62734.77,-306"/>
<polygon fill="black" stroke="black" points="62734.77,-302.5 62724.77,-306 62734.77,-309.5 62734.77,-302.5"/>
</g>
<!-- kv_cache_0_12_16 -->
<g id="node173" class="node">
<title>kv_cache_0_12_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="72988.39,-550 72160.57,-550 71947.61,-514 72775.43,-514 72988.39,-550"/>
<text text-anchor="middle" x="72468" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_12_16&#45;&gt;attn_block_0_12_16 -->
<g id="edge185" class="edge">
<title>kv_cache_0_12_16&#45;&gt;attn_block_0_12_16</title>
<path fill="none" stroke="black" d="M72357.28,-513.77C72357.28,-513.77 72357.28,-440 72357.28,-440"/>
<polygon fill="black" stroke="black" points="72360.78,-440 72357.28,-430 72353.78,-440 72360.78,-440"/>
</g>
<!-- attn_block_0_13_16 -->
<g id="node174" class="node">
<title>attn_block_0_13_16</title>
<polygon fill="lightgreen" stroke="black" points="71708,-430 70844,-430 70844,-394 71708,-394 71708,-430"/>
<text text-anchor="middle" x="71276" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Block: 14/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_13_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge189" class="edge">
<title>attn_block_0_13_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M71276,-393.71C71276,-363.63 71276,-307 71276,-307 71276,-307 62764.27,-307 62764.27,-307"/>
<polygon fill="black" stroke="black" points="62764.27,-303.5 62754.27,-307 62764.27,-310.5 62764.27,-303.5"/>
</g>
<!-- kv_cache_0_13_16 -->
<g id="node175" class="node">
<title>kv_cache_0_13_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="71929.39,-550 71101.57,-550 70888.61,-514 71716.43,-514 71929.39,-550"/>
<text text-anchor="middle" x="71409" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_13_16&#45;&gt;attn_block_0_13_16 -->
<g id="edge188" class="edge">
<title>kv_cache_0_13_16&#45;&gt;attn_block_0_13_16</title>
<path fill="none" stroke="black" d="M71298.28,-513.77C71298.28,-513.77 71298.28,-440 71298.28,-440"/>
<polygon fill="black" stroke="black" points="71301.78,-440 71298.28,-430 71294.78,-440 71301.78,-440"/>
</g>
<!-- attn_block_0_14_16 -->
<g id="node176" class="node">
<title>attn_block_0_14_16</title>
<polygon fill="lightgreen" stroke="black" points="70649,-430 69785,-430 69785,-394 70649,-394 70649,-430"/>
<text text-anchor="middle" x="70217" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Block: 15/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_14_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge192" class="edge">
<title>attn_block_0_14_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M70217,-393.59C70217,-363.96 70217,-309 70217,-309 70217,-309 62823.14,-309 62823.14,-309"/>
<polygon fill="black" stroke="black" points="62823.14,-305.5 62813.14,-309 62823.14,-312.5 62823.14,-305.5"/>
</g>
<!-- kv_cache_0_14_16 -->
<g id="node177" class="node">
<title>kv_cache_0_14_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="70870.39,-550 70042.57,-550 69829.61,-514 70657.43,-514 70870.39,-550"/>
<text text-anchor="middle" x="70350" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_14_16&#45;&gt;attn_block_0_14_16 -->
<g id="edge191" class="edge">
<title>kv_cache_0_14_16&#45;&gt;attn_block_0_14_16</title>
<path fill="none" stroke="black" d="M70239.28,-513.77C70239.28,-513.77 70239.28,-440 70239.28,-440"/>
<polygon fill="black" stroke="black" points="70242.78,-440 70239.28,-430 70235.78,-440 70242.78,-440"/>
</g>
<!-- attn_block_0_15_16 -->
<g id="node178" class="node">
<title>attn_block_0_15_16</title>
<polygon fill="lightgreen" stroke="black" points="69590,-430 68726,-430 68726,-394 69590,-394 69590,-430"/>
<text text-anchor="middle" x="69158" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Block: 16/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_0_15_16&#45;&gt;hier_reduce_0_16 -->
<g id="edge195" class="edge">
<title>attn_block_0_15_16&#45;&gt;hier_reduce_0_16</title>
<path fill="none" stroke="black" d="M69158,-393.94C69158,-364.89 69158,-311 69158,-311 69158,-311 62882.05,-311 62882.05,-311"/>
<polygon fill="black" stroke="black" points="62882.05,-307.5 62872.05,-311 62882.05,-314.5 62882.05,-307.5"/>
</g>
<!-- kv_cache_0_15_16 -->
<g id="node179" class="node">
<title>kv_cache_0_15_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="69811.39,-550 68983.57,-550 68770.61,-514 69598.43,-514 69811.39,-550"/>
<text text-anchor="middle" x="69291" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_15_16&#45;&gt;attn_block_0_15_16 -->
<g id="edge194" class="edge">
<title>kv_cache_0_15_16&#45;&gt;attn_block_0_15_16</title>
<path fill="none" stroke="black" d="M69180.28,-513.77C69180.28,-513.77 69180.28,-440 69180.28,-440"/>
<polygon fill="black" stroke="black" points="69183.78,-440 69180.28,-430 69176.78,-440 69183.78,-440"/>
</g>
<!-- attn_block_1_0_16 -->
<g id="node180" class="node">
<title>attn_block_1_0_16</title>
<polygon fill="lightgreen" stroke="black" points="85391,-430 84537,-430 84537,-394 85391,-394 85391,-430"/>
<text text-anchor="middle" x="84964" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- hier_reduce_1_16 -->
<g id="node600" class="node">
<title>hier_reduce_1_16</title>
<polygon fill="lightgray" stroke="black" points="79320,-333 78790.57,-315 79320,-297 79849.43,-315 79320,-333"/>
<text text-anchor="middle" x="79320" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 16 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_1_0_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge487" class="edge">
<title>attn_block_1_0_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M84964,-393.99C84964,-367.98 84964,-323 84964,-323 84964,-323 79624.51,-323 79624.51,-323"/>
<polygon fill="black" stroke="black" points="79624.51,-319.5 79614.51,-323 79624.51,-326.5 79624.51,-319.5"/>
</g>
<!-- kv_cache_1_0_16 -->
<g id="node181" class="node">
<title>kv_cache_1_0_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="85612.26,-550 84791.01,-550 84579.74,-514 85400.99,-514 85612.26,-550"/>
<text text-anchor="middle" x="85096" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_0_16&#45;&gt;attn_block_1_0_16 -->
<g id="edge486" class="edge">
<title>kv_cache_1_0_16&#45;&gt;attn_block_1_0_16</title>
<path fill="none" stroke="black" d="M84985.44,-513.77C84985.44,-513.77 84985.44,-440 84985.44,-440"/>
<polygon fill="black" stroke="black" points="84988.94,-440 84985.44,-430 84981.94,-440 84988.94,-440"/>
</g>
<!-- attn_block_1_1_16 -->
<g id="node182" class="node">
<title>attn_block_1_1_16</title>
<polygon fill="lightgreen" stroke="black" points="84344,-430 83490,-430 83490,-394 84344,-394 84344,-430"/>
<text text-anchor="middle" x="83917" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_1_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge490" class="edge">
<title>attn_block_1_1_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M83917,-393.97C83917,-368.49 83917,-325 83917,-325 83917,-325 79565.48,-325 79565.48,-325"/>
<polygon fill="black" stroke="black" points="79565.48,-321.5 79555.48,-325 79565.48,-328.5 79565.48,-321.5"/>
</g>
<!-- kv_cache_1_1_16 -->
<g id="node183" class="node">
<title>kv_cache_1_1_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="84562.26,-550 83741.01,-550 83529.74,-514 84350.99,-514 84562.26,-550"/>
<text text-anchor="middle" x="84046" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_1_16&#45;&gt;attn_block_1_1_16 -->
<g id="edge489" class="edge">
<title>kv_cache_1_1_16&#45;&gt;attn_block_1_1_16</title>
<path fill="none" stroke="black" d="M83936.94,-513.77C83936.94,-513.77 83936.94,-440 83936.94,-440"/>
<polygon fill="black" stroke="black" points="83940.44,-440 83936.94,-430 83933.44,-440 83940.44,-440"/>
</g>
<!-- attn_block_1_2_16 -->
<g id="node184" class="node">
<title>attn_block_1_2_16</title>
<polygon fill="lightgreen" stroke="black" points="83300,-430 82446,-430 82446,-394 83300,-394 83300,-430"/>
<text text-anchor="middle" x="82873" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_2_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge493" class="edge">
<title>attn_block_1_2_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M82873,-393.97C82873,-369.02 82873,-327 82873,-327 82873,-327 79506.5,-327 79506.5,-327"/>
<polygon fill="black" stroke="black" points="79506.5,-323.5 79496.5,-327 79506.5,-330.5 79506.5,-323.5"/>
</g>
<!-- kv_cache_1_2_16 -->
<g id="node185" class="node">
<title>kv_cache_1_2_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="83512.26,-550 82691.01,-550 82479.74,-514 83300.99,-514 83512.26,-550"/>
<text text-anchor="middle" x="82996" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_2_16&#45;&gt;attn_block_1_2_16 -->
<g id="edge492" class="edge">
<title>kv_cache_1_2_16&#45;&gt;attn_block_1_2_16</title>
<path fill="none" stroke="black" d="M82889.94,-513.77C82889.94,-513.77 82889.94,-440 82889.94,-440"/>
<polygon fill="black" stroke="black" points="82893.44,-440 82889.94,-430 82886.44,-440 82893.44,-440"/>
</g>
<!-- attn_block_1_3_16 -->
<g id="node186" class="node">
<title>attn_block_1_3_16</title>
<polygon fill="lightgreen" stroke="black" points="82261,-430 81407,-430 81407,-394 82261,-394 82261,-430"/>
<text text-anchor="middle" x="81834" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_3_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge496" class="edge">
<title>attn_block_1_3_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M81834,-393.99C81834,-369.58 81834,-329 81834,-329 81834,-329 79447.88,-329 79447.88,-329"/>
<polygon fill="black" stroke="black" points="79447.88,-325.5 79437.88,-329 79447.88,-332.5 79447.88,-325.5"/>
</g>
<!-- kv_cache_1_3_16 -->
<g id="node187" class="node">
<title>kv_cache_1_3_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="82462.26,-550 81641.01,-550 81429.74,-514 82250.99,-514 82462.26,-550"/>
<text text-anchor="middle" x="81946" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_3_16&#45;&gt;attn_block_1_3_16 -->
<g id="edge495" class="edge">
<title>kv_cache_1_3_16&#45;&gt;attn_block_1_3_16</title>
<path fill="none" stroke="black" d="M81845.44,-513.77C81845.44,-513.77 81845.44,-440 81845.44,-440"/>
<polygon fill="black" stroke="black" points="81848.94,-440 81845.44,-430 81841.94,-440 81848.94,-440"/>
</g>
<!-- attn_block_1_4_16 -->
<g id="node188" class="node">
<title>attn_block_1_4_16</title>
<polygon fill="lightgreen" stroke="black" points="81233,-430 80379,-430 80379,-394 81233,-394 81233,-430"/>
<text text-anchor="middle" x="80806" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_4_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge499" class="edge">
<title>attn_block_1_4_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M80806,-393.62C80806,-369.72 80806,-331 80806,-331 80806,-331 79389.17,-331 79389.17,-331"/>
<polygon fill="black" stroke="black" points="79389.17,-327.5 79379.17,-331 79389.17,-334.5 79389.17,-327.5"/>
</g>
<!-- kv_cache_1_4_16 -->
<g id="node189" class="node">
<title>kv_cache_1_4_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="81412.26,-550 80591.01,-550 80379.74,-514 81200.99,-514 81412.26,-550"/>
<text text-anchor="middle" x="80896" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_4_16&#45;&gt;attn_block_1_4_16 -->
<g id="edge498" class="edge">
<title>kv_cache_1_4_16&#45;&gt;attn_block_1_4_16</title>
<path fill="none" stroke="black" d="M80806.44,-513.77C80806.44,-513.77 80806.44,-440 80806.44,-440"/>
<polygon fill="black" stroke="black" points="80809.94,-440 80806.44,-430 80802.94,-440 80809.94,-440"/>
</g>
<!-- attn_block_1_5_16 -->
<g id="node190" class="node">
<title>attn_block_1_5_16</title>
<polygon fill="lightgreen" stroke="black" points="80228,-430 79374,-430 79374,-394 80228,-394 80228,-430"/>
<text text-anchor="middle" x="79801" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_5_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge502" class="edge">
<title>attn_block_1_5_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M79532.49,-393.76C79532.49,-393.76 79532.49,-335.93 79532.49,-335.93"/>
<polygon fill="black" stroke="black" points="79535.99,-335.93 79532.49,-325.93 79528.99,-335.93 79535.99,-335.93"/>
</g>
<!-- kv_cache_1_5_16 -->
<g id="node191" class="node">
<title>kv_cache_1_5_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="80362.26,-550 79541.01,-550 79329.74,-514 80150.99,-514 80362.26,-550"/>
<text text-anchor="middle" x="79846" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_5_16&#45;&gt;attn_block_1_5_16 -->
<g id="edge501" class="edge">
<title>kv_cache_1_5_16&#45;&gt;attn_block_1_5_16</title>
<path fill="none" stroke="black" d="M79801,-513.77C79801,-513.77 79801,-440 79801,-440"/>
<polygon fill="black" stroke="black" points="79804.5,-440 79801,-430 79797.5,-440 79804.5,-440"/>
</g>
<!-- attn_block_1_6_16 -->
<g id="node192" class="node">
<title>attn_block_1_6_16</title>
<polygon fill="lightgreen" stroke="black" points="79267,-430 78413,-430 78413,-394 79267,-394 79267,-430"/>
<text text-anchor="middle" x="78840" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_6_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge505" class="edge">
<title>attn_block_1_6_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M79028.77,-393.76C79028.77,-393.76 79028.77,-333.35 79028.77,-333.35"/>
<polygon fill="black" stroke="black" points="79032.27,-333.35 79028.77,-323.35 79025.27,-333.35 79032.27,-333.35"/>
</g>
<!-- kv_cache_1_6_16 -->
<g id="node193" class="node">
<title>kv_cache_1_6_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="79312.26,-550 78491.01,-550 78279.74,-514 79100.99,-514 79312.26,-550"/>
<text text-anchor="middle" x="78796" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_6_16&#45;&gt;attn_block_1_6_16 -->
<g id="edge504" class="edge">
<title>kv_cache_1_6_16&#45;&gt;attn_block_1_6_16</title>
<path fill="none" stroke="black" d="M78840,-513.77C78840,-513.77 78840,-440 78840,-440"/>
<polygon fill="black" stroke="black" points="78843.5,-440 78840,-430 78836.5,-440 78843.5,-440"/>
</g>
<!-- attn_block_1_7_16 -->
<g id="node194" class="node">
<title>attn_block_1_7_16</title>
<polygon fill="lightgreen" stroke="black" points="78284,-430 77430,-430 77430,-394 78284,-394 78284,-430"/>
<text text-anchor="middle" x="77857" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_7_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge508" class="edge">
<title>attn_block_1_7_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M77857,-393.67C77857,-362.14 77857,-301 77857,-301 77857,-301 79192.13,-301 79192.13,-301"/>
<polygon fill="black" stroke="black" points="79192.13,-304.5 79202.13,-301 79192.13,-297.5 79192.13,-304.5"/>
</g>
<!-- kv_cache_1_7_16 -->
<g id="node195" class="node">
<title>kv_cache_1_7_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="78262.26,-550 77441.01,-550 77229.74,-514 78050.99,-514 78262.26,-550"/>
<text text-anchor="middle" x="77746" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_7_16&#45;&gt;attn_block_1_7_16 -->
<g id="edge507" class="edge">
<title>kv_cache_1_7_16&#45;&gt;attn_block_1_7_16</title>
<path fill="none" stroke="black" d="M77846.06,-513.77C77846.06,-513.77 77846.06,-440 77846.06,-440"/>
<polygon fill="black" stroke="black" points="77849.56,-440 77846.06,-430 77842.56,-440 77849.56,-440"/>
</g>
<!-- attn_block_1_8_16 -->
<g id="node196" class="node">
<title>attn_block_1_8_16</title>
<polygon fill="lightgreen" stroke="black" points="77323,-430 76469,-430 76469,-394 77323,-394 77323,-430"/>
<text text-anchor="middle" x="76896" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Block: 9/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_8_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge511" class="edge">
<title>attn_block_1_8_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M76896,-393.51C76896,-361.69 76896,-300 76896,-300 76896,-300 79221.58,-300 79221.58,-300"/>
<polygon fill="black" stroke="black" points="79221.58,-303.5 79231.58,-300 79221.58,-296.5 79221.58,-303.5"/>
</g>
<!-- kv_cache_1_8_16 -->
<g id="node197" class="node">
<title>kv_cache_1_8_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="77212.26,-550 76391.01,-550 76179.74,-514 77000.99,-514 77212.26,-550"/>
<text text-anchor="middle" x="76696" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_8_16&#45;&gt;attn_block_1_8_16 -->
<g id="edge510" class="edge">
<title>kv_cache_1_8_16&#45;&gt;attn_block_1_8_16</title>
<path fill="none" stroke="black" d="M76840.56,-513.77C76840.56,-513.77 76840.56,-440 76840.56,-440"/>
<polygon fill="black" stroke="black" points="76844.06,-440 76840.56,-430 76837.06,-440 76844.06,-440"/>
</g>
<!-- attn_block_1_9_16 -->
<g id="node198" class="node">
<title>attn_block_1_9_16</title>
<polygon fill="lightgreen" stroke="black" points="76262.5,-430 75403.5,-430 75403.5,-394 76262.5,-394 76262.5,-430"/>
<text text-anchor="middle" x="75833" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Block: 10/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_9_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge514" class="edge">
<title>attn_block_1_9_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M75833,-393.94C75833,-361.79 75833,-298 75833,-298 75833,-298 79280.38,-298 79280.38,-298"/>
<polygon fill="black" stroke="black" points="79280.38,-301.5 79290.38,-298 79280.38,-294.5 79280.38,-301.5"/>
</g>
<!-- kv_cache_1_9_16 -->
<g id="node199" class="node">
<title>kv_cache_1_9_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="76162.26,-550 75341.01,-550 75129.74,-514 75950.99,-514 76162.26,-550"/>
<text text-anchor="middle" x="75646" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_9_16&#45;&gt;attn_block_1_9_16 -->
<g id="edge513" class="edge">
<title>kv_cache_1_9_16&#45;&gt;attn_block_1_9_16</title>
<path fill="none" stroke="black" d="M75782.81,-513.77C75782.81,-513.77 75782.81,-440 75782.81,-440"/>
<polygon fill="black" stroke="black" points="75786.31,-440 75782.81,-430 75779.31,-440 75786.31,-440"/>
</g>
<!-- attn_block_1_10_16 -->
<g id="node200" class="node">
<title>attn_block_1_10_16</title>
<polygon fill="lightgreen" stroke="black" points="91745,-430 90881,-430 90881,-394 91745,-394 91745,-430"/>
<text text-anchor="middle" x="91313" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Block: 11/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_10_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge517" class="edge">
<title>attn_block_1_10_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M91143.15,-393.96C91143.15,-372.34 91143.15,-339 91143.15,-339 91143.15,-339 79690.98,-339 79690.98,-339 79690.98,-339 79690.98,-330.57 79690.98,-330.57"/>
<polygon fill="black" stroke="black" points="79694.48,-330.57 79690.98,-320.57 79687.48,-330.57 79694.48,-330.57"/>
</g>
<!-- kv_cache_1_10_16 -->
<g id="node201" class="node">
<title>kv_cache_1_10_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="91966.39,-550 91138.57,-550 90925.61,-514 91753.43,-514 91966.39,-550"/>
<text text-anchor="middle" x="91446" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_10_16&#45;&gt;attn_block_1_10_16 -->
<g id="edge516" class="edge">
<title>kv_cache_1_10_16&#45;&gt;attn_block_1_10_16</title>
<path fill="none" stroke="black" d="M91335.28,-513.77C91335.28,-513.77 91335.28,-440 91335.28,-440"/>
<polygon fill="black" stroke="black" points="91338.78,-440 91335.28,-430 91331.78,-440 91338.78,-440"/>
</g>
<!-- attn_block_1_11_16 -->
<g id="node202" class="node">
<title>attn_block_1_11_16</title>
<polygon fill="lightgreen" stroke="black" points="90686,-430 89822,-430 89822,-394 90686,-394 90686,-430"/>
<text text-anchor="middle" x="90254" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Block: 12/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_11_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge520" class="edge">
<title>attn_block_1_11_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M89955.17,-393.84C89955.17,-365.26 89955.17,-313 89955.17,-313 89955.17,-313 79800.7,-313 79800.7,-313"/>
<polygon fill="black" stroke="black" points="79800.7,-309.5 79790.7,-313 79800.7,-316.5 79800.7,-309.5"/>
</g>
<!-- kv_cache_1_11_16 -->
<g id="node203" class="node">
<title>kv_cache_1_11_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="90907.39,-550 90079.57,-550 89866.61,-514 90694.43,-514 90907.39,-550"/>
<text text-anchor="middle" x="90387" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_11_16&#45;&gt;attn_block_1_11_16 -->
<g id="edge519" class="edge">
<title>kv_cache_1_11_16&#45;&gt;attn_block_1_11_16</title>
<path fill="none" stroke="black" d="M90276.28,-513.77C90276.28,-513.77 90276.28,-440 90276.28,-440"/>
<polygon fill="black" stroke="black" points="90279.78,-440 90276.28,-430 90272.78,-440 90279.78,-440"/>
</g>
<!-- attn_block_1_12_16 -->
<g id="node204" class="node">
<title>attn_block_1_12_16</title>
<polygon fill="lightgreen" stroke="black" points="89627,-430 88763,-430 88763,-394 89627,-394 89627,-430"/>
<text text-anchor="middle" x="89195" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Block: 13/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_12_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge523" class="edge">
<title>attn_block_1_12_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M89195,-393.76C89195,-365.66 89195,-315 89195,-315 89195,-315 79859.61,-315 79859.61,-315"/>
<polygon fill="black" stroke="black" points="79859.61,-311.5 79849.61,-315 79859.61,-318.5 79859.61,-311.5"/>
</g>
<!-- kv_cache_1_12_16 -->
<g id="node205" class="node">
<title>kv_cache_1_12_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="89848.39,-550 89020.57,-550 88807.61,-514 89635.43,-514 89848.39,-550"/>
<text text-anchor="middle" x="89328" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_12_16&#45;&gt;attn_block_1_12_16 -->
<g id="edge522" class="edge">
<title>kv_cache_1_12_16&#45;&gt;attn_block_1_12_16</title>
<path fill="none" stroke="black" d="M89217.28,-513.77C89217.28,-513.77 89217.28,-440 89217.28,-440"/>
<polygon fill="black" stroke="black" points="89220.78,-440 89217.28,-430 89213.78,-440 89220.78,-440"/>
</g>
<!-- attn_block_1_13_16 -->
<g id="node206" class="node">
<title>attn_block_1_13_16</title>
<polygon fill="lightgreen" stroke="black" points="88568,-430 87704,-430 87704,-394 88568,-394 88568,-430"/>
<text text-anchor="middle" x="88136" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Block: 14/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_13_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge526" class="edge">
<title>attn_block_1_13_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M88136,-393.68C88136,-366.08 88136,-317 88136,-317 88136,-317 79800.87,-317 79800.87,-317"/>
<polygon fill="black" stroke="black" points="79800.87,-313.5 79790.87,-317 79800.87,-320.5 79800.87,-313.5"/>
</g>
<!-- kv_cache_1_13_16 -->
<g id="node207" class="node">
<title>kv_cache_1_13_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="88789.39,-550 87961.57,-550 87748.61,-514 88576.43,-514 88789.39,-550"/>
<text text-anchor="middle" x="88269" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_13_16&#45;&gt;attn_block_1_13_16 -->
<g id="edge525" class="edge">
<title>kv_cache_1_13_16&#45;&gt;attn_block_1_13_16</title>
<path fill="none" stroke="black" d="M88158.28,-513.77C88158.28,-513.77 88158.28,-440 88158.28,-440"/>
<polygon fill="black" stroke="black" points="88161.78,-440 88158.28,-430 88154.78,-440 88161.78,-440"/>
</g>
<!-- attn_block_1_14_16 -->
<g id="node208" class="node">
<title>attn_block_1_14_16</title>
<polygon fill="lightgreen" stroke="black" points="87509,-430 86645,-430 86645,-394 87509,-394 87509,-430"/>
<text text-anchor="middle" x="87077" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Block: 15/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_14_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge529" class="edge">
<title>attn_block_1_14_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M87077,-393.63C87077,-366.52 87077,-319 87077,-319 87077,-319 79741.91,-319 79741.91,-319"/>
<polygon fill="black" stroke="black" points="79741.91,-315.5 79731.91,-319 79741.91,-322.5 79741.91,-315.5"/>
</g>
<!-- kv_cache_1_14_16 -->
<g id="node209" class="node">
<title>kv_cache_1_14_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="87730.39,-550 86902.57,-550 86689.61,-514 87517.43,-514 87730.39,-550"/>
<text text-anchor="middle" x="87210" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_14_16&#45;&gt;attn_block_1_14_16 -->
<g id="edge528" class="edge">
<title>kv_cache_1_14_16&#45;&gt;attn_block_1_14_16</title>
<path fill="none" stroke="black" d="M87099.28,-513.77C87099.28,-513.77 87099.28,-440 87099.28,-440"/>
<polygon fill="black" stroke="black" points="87102.78,-440 87099.28,-430 87095.78,-440 87102.78,-440"/>
</g>
<!-- attn_block_1_15_16 -->
<g id="node210" class="node">
<title>attn_block_1_15_16</title>
<polygon fill="lightgreen" stroke="black" points="86450,-430 85586,-430 85586,-394 86450,-394 86450,-430"/>
<text text-anchor="middle" x="86018" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Block: 16/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_1_15_16&#45;&gt;hier_reduce_1_16 -->
<g id="edge532" class="edge">
<title>attn_block_1_15_16&#45;&gt;hier_reduce_1_16</title>
<path fill="none" stroke="black" d="M86018,-393.58C86018,-366.99 86018,-321 86018,-321 86018,-321 79683.03,-321 79683.03,-321"/>
<polygon fill="black" stroke="black" points="79683.03,-317.5 79673.03,-321 79683.03,-324.5 79683.03,-317.5"/>
</g>
<!-- kv_cache_1_15_16 -->
<g id="node211" class="node">
<title>kv_cache_1_15_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="86671.39,-550 85843.57,-550 85630.61,-514 86458.43,-514 86671.39,-550"/>
<text text-anchor="middle" x="86151" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_15_16&#45;&gt;attn_block_1_15_16 -->
<g id="edge531" class="edge">
<title>kv_cache_1_15_16&#45;&gt;attn_block_1_15_16</title>
<path fill="none" stroke="black" d="M86040.28,-513.77C86040.28,-513.77 86040.28,-440 86040.28,-440"/>
<polygon fill="black" stroke="black" points="86043.78,-440 86040.28,-430 86036.78,-440 86043.78,-440"/>
</g>
<!-- attn_block_2_0_16 -->
<g id="node212" class="node">
<title>attn_block_2_0_16</title>
<polygon fill="lightgreen" stroke="black" points="35164,-430 34310,-430 34310,-394 35164,-394 35164,-430"/>
<text text-anchor="middle" x="34737" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- hier_reduce_2_16 -->
<g id="node603" class="node">
<title>hier_reduce_2_16</title>
<polygon fill="lightgray" stroke="black" points="37159,-333 36629.57,-315 37159,-297 37688.43,-315 37159,-333"/>
<text text-anchor="middle" x="37159" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 16 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_2_0_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge824" class="edge">
<title>attn_block_2_0_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M34737,-393.97C34737,-369.02 34737,-327 34737,-327 34737,-327 36972.38,-327 36972.38,-327"/>
<polygon fill="black" stroke="black" points="36972.38,-330.5 36982.38,-327 36972.38,-323.5 36972.38,-330.5"/>
</g>
<!-- kv_cache_2_0_16 -->
<g id="node213" class="node">
<title>kv_cache_2_0_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="35032.26,-550 34211.01,-550 33999.74,-514 34820.99,-514 35032.26,-550"/>
<text text-anchor="middle" x="34516" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_0_16&#45;&gt;attn_block_2_0_16 -->
<g id="edge823" class="edge">
<title>kv_cache_2_0_16&#45;&gt;attn_block_2_0_16</title>
<path fill="none" stroke="black" d="M34550.71,-513.77C34550.71,-513.77 34550.71,-440 34550.71,-440"/>
<polygon fill="black" stroke="black" points="34554.21,-440 34550.71,-430 34547.21,-440 34554.21,-440"/>
</g>
<!-- attn_block_2_1_16 -->
<g id="node214" class="node">
<title>attn_block_2_1_16</title>
<polygon fill="lightgreen" stroke="black" points="34159,-430 33305,-430 33305,-394 34159,-394 34159,-430"/>
<text text-anchor="middle" x="33732" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_1_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge827" class="edge">
<title>attn_block_2_1_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M33732,-393.77C33732,-367.99 33732,-324 33732,-324 33732,-324 36884.01,-324 36884.01,-324"/>
<polygon fill="black" stroke="black" points="36884.01,-327.5 36894.01,-324 36884.01,-320.5 36884.01,-327.5"/>
</g>
<!-- kv_cache_2_1_16 -->
<g id="node215" class="node">
<title>kv_cache_2_1_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="33982.26,-550 33161.01,-550 32949.74,-514 33770.99,-514 33982.26,-550"/>
<text text-anchor="middle" x="33466" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_1_16&#45;&gt;attn_block_2_1_16 -->
<g id="edge826" class="edge">
<title>kv_cache_2_1_16&#45;&gt;attn_block_2_1_16</title>
<path fill="none" stroke="black" d="M33530.71,-513.77C33530.71,-513.77 33530.71,-440 33530.71,-440"/>
<polygon fill="black" stroke="black" points="33534.21,-440 33530.71,-430 33527.21,-440 33534.21,-440"/>
</g>
<!-- attn_block_2_2_16 -->
<g id="node216" class="node">
<title>attn_block_2_2_16</title>
<polygon fill="lightgreen" stroke="black" points="33020,-430 32166,-430 32166,-394 33020,-394 33020,-430"/>
<text text-anchor="middle" x="32593" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_2_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge830" class="edge">
<title>attn_block_2_2_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M32593,-393.58C32593,-366.99 32593,-321 32593,-321 32593,-321 36795.93,-321 36795.93,-321"/>
<polygon fill="black" stroke="black" points="36795.93,-324.5 36805.93,-321 36795.93,-317.5 36795.93,-324.5"/>
</g>
<!-- kv_cache_2_2_16 -->
<g id="node217" class="node">
<title>kv_cache_2_2_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="32932.26,-550 32111.01,-550 31899.74,-514 32720.99,-514 32932.26,-550"/>
<text text-anchor="middle" x="32416" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_2_16&#45;&gt;attn_block_2_2_16 -->
<g id="edge829" class="edge">
<title>kv_cache_2_2_16&#45;&gt;attn_block_2_2_16</title>
<path fill="none" stroke="black" d="M32421.38,-513.77C32421.38,-513.77 32421.38,-440 32421.38,-440"/>
<polygon fill="black" stroke="black" points="32424.88,-440 32421.38,-430 32417.88,-440 32424.88,-440"/>
</g>
<!-- attn_block_2_3_16 -->
<g id="node218" class="node">
<title>attn_block_2_3_16</title>
<polygon fill="lightgreen" stroke="black" points="31915,-430 31061,-430 31061,-394 31915,-394 31915,-430"/>
<text text-anchor="middle" x="31488" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_3_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge833" class="edge">
<title>attn_block_2_3_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M31488,-393.88C31488,-366.56 31488,-318 31488,-318 31488,-318 36707.55,-318 36707.55,-318"/>
<polygon fill="black" stroke="black" points="36707.55,-321.5 36717.55,-318 36707.55,-314.5 36707.55,-321.5"/>
</g>
<!-- kv_cache_2_3_16 -->
<g id="node219" class="node">
<title>kv_cache_2_3_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="31882.26,-550 31061.01,-550 30849.74,-514 31670.99,-514 31882.26,-550"/>
<text text-anchor="middle" x="31366" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_3_16&#45;&gt;attn_block_2_3_16 -->
<g id="edge832" class="edge">
<title>kv_cache_2_3_16&#45;&gt;attn_block_2_3_16</title>
<path fill="none" stroke="black" d="M31471.56,-513.77C31471.56,-513.77 31471.56,-440 31471.56,-440"/>
<polygon fill="black" stroke="black" points="31475.06,-440 31471.56,-430 31468.06,-440 31475.06,-440"/>
</g>
<!-- attn_block_2_4_16 -->
<g id="node220" class="node">
<title>attn_block_2_4_16</title>
<polygon fill="lightgreen" stroke="black" points="30893,-430 30039,-430 30039,-394 30893,-394 30893,-430"/>
<text text-anchor="middle" x="30466" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_4_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge836" class="edge">
<title>attn_block_2_4_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M30466,-393.76C30466,-365.66 30466,-315 30466,-315 30466,-315 36619.27,-315 36619.27,-315"/>
<polygon fill="black" stroke="black" points="36619.27,-318.5 36629.27,-315 36619.27,-311.5 36619.27,-318.5"/>
</g>
<!-- kv_cache_2_4_16 -->
<g id="node221" class="node">
<title>kv_cache_2_4_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30832.26,-550 30011.01,-550 29799.74,-514 30620.99,-514 30832.26,-550"/>
<text text-anchor="middle" x="30316" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_4_16&#45;&gt;attn_block_2_4_16 -->
<g id="edge835" class="edge">
<title>kv_cache_2_4_16&#45;&gt;attn_block_2_4_16</title>
<path fill="none" stroke="black" d="M30303.38,-513.77C30303.38,-513.77 30303.38,-440 30303.38,-440"/>
<polygon fill="black" stroke="black" points="30306.88,-440 30303.38,-430 30299.88,-440 30306.88,-440"/>
</g>
<!-- attn_block_2_5_16 -->
<g id="node222" class="node">
<title>attn_block_2_5_16</title>
<polygon fill="lightgreen" stroke="black" points="29857,-430 29003,-430 29003,-394 29857,-394 29857,-430"/>
<text text-anchor="middle" x="29430" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_5_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge839" class="edge">
<title>attn_block_2_5_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M29430,-393.66C29430,-364.79 29430,-312 29430,-312 29430,-312 36707.8,-312 36707.8,-312"/>
<polygon fill="black" stroke="black" points="36707.8,-315.5 36717.8,-312 36707.8,-308.5 36707.8,-315.5"/>
</g>
<!-- kv_cache_2_5_16 -->
<g id="node223" class="node">
<title>kv_cache_2_5_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="29782.26,-550 28961.01,-550 28749.74,-514 29570.99,-514 29782.26,-550"/>
<text text-anchor="middle" x="29266" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_5_16&#45;&gt;attn_block_2_5_16 -->
<g id="edge838" class="edge">
<title>kv_cache_2_5_16&#45;&gt;attn_block_2_5_16</title>
<path fill="none" stroke="black" d="M29262.71,-513.77C29262.71,-513.77 29262.71,-440 29262.71,-440"/>
<polygon fill="black" stroke="black" points="29266.21,-440 29262.71,-430 29259.21,-440 29266.21,-440"/>
</g>
<!-- attn_block_2_6_16 -->
<g id="node224" class="node">
<title>attn_block_2_6_16</title>
<polygon fill="lightgreen" stroke="black" points="28896,-430 28042,-430 28042,-394 28896,-394 28896,-430"/>
<text text-anchor="middle" x="28469" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_6_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge842" class="edge">
<title>attn_block_2_6_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M28469,-393.59C28469,-363.96 28469,-309 28469,-309 28469,-309 36795.88,-309 36795.88,-309"/>
<polygon fill="black" stroke="black" points="36795.88,-312.5 36805.88,-309 36795.88,-305.5 36795.88,-312.5"/>
</g>
<!-- kv_cache_2_6_16 -->
<g id="node225" class="node">
<title>kv_cache_2_6_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="28732.26,-550 27911.01,-550 27699.74,-514 28520.99,-514 28732.26,-550"/>
<text text-anchor="middle" x="28216" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_6_16&#45;&gt;attn_block_2_6_16 -->
<g id="edge841" class="edge">
<title>kv_cache_2_6_16&#45;&gt;attn_block_2_6_16</title>
<path fill="none" stroke="black" d="M28387.06,-513.77C28387.06,-513.77 28387.06,-440 28387.06,-440"/>
<polygon fill="black" stroke="black" points="28390.56,-440 28387.06,-430 28383.56,-440 28390.56,-440"/>
</g>
<!-- attn_block_2_7_16 -->
<g id="node226" class="node">
<title>attn_block_2_7_16</title>
<polygon fill="lightgreen" stroke="black" points="27808,-430 26954,-430 26954,-394 27808,-394 27808,-430"/>
<text text-anchor="middle" x="27381" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_7_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge845" class="edge">
<title>attn_block_2_7_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M27381,-393.54C27381,-363.17 27381,-306 27381,-306 27381,-306 36883.98,-306 36883.98,-306"/>
<polygon fill="black" stroke="black" points="36883.98,-309.5 36893.98,-306 36883.98,-302.5 36883.98,-309.5"/>
</g>
<!-- kv_cache_2_7_16 -->
<g id="node227" class="node">
<title>kv_cache_2_7_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="27682.26,-550 26861.01,-550 26649.74,-514 27470.99,-514 27682.26,-550"/>
<text text-anchor="middle" x="27166" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_7_16&#45;&gt;attn_block_2_7_16 -->
<g id="edge844" class="edge">
<title>kv_cache_2_7_16&#45;&gt;attn_block_2_7_16</title>
<path fill="none" stroke="black" d="M27318.06,-513.77C27318.06,-513.77 27318.06,-440 27318.06,-440"/>
<polygon fill="black" stroke="black" points="27321.56,-440 27318.06,-430 27314.56,-440 27321.56,-440"/>
</g>
<!-- attn_block_2_8_16 -->
<g id="node228" class="node">
<title>attn_block_2_8_16</title>
<polygon fill="lightgreen" stroke="black" points="26739,-430 25885,-430 25885,-394 26739,-394 26739,-430"/>
<text text-anchor="middle" x="26312" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Block: 9/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_8_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge848" class="edge">
<title>attn_block_2_8_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M26312,-393.51C26312,-362.41 26312,-303 26312,-303 26312,-303 36972.29,-303 36972.29,-303"/>
<polygon fill="black" stroke="black" points="36972.29,-306.5 36982.29,-303 36972.29,-299.5 36972.29,-306.5"/>
</g>
<!-- kv_cache_2_8_16 -->
<g id="node229" class="node">
<title>kv_cache_2_8_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="26632.26,-550 25811.01,-550 25599.74,-514 26420.99,-514 26632.26,-550"/>
<text text-anchor="middle" x="26116" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_8_16&#45;&gt;attn_block_2_8_16 -->
<g id="edge847" class="edge">
<title>kv_cache_2_8_16&#45;&gt;attn_block_2_8_16</title>
<path fill="none" stroke="black" d="M26258.56,-513.77C26258.56,-513.77 26258.56,-440 26258.56,-440"/>
<polygon fill="black" stroke="black" points="26262.06,-440 26258.56,-430 26255.06,-440 26262.06,-440"/>
</g>
<!-- attn_block_2_9_16 -->
<g id="node230" class="node">
<title>attn_block_2_9_16</title>
<polygon fill="lightgreen" stroke="black" points="25680.5,-430 24821.5,-430 24821.5,-394 25680.5,-394 25680.5,-430"/>
<text text-anchor="middle" x="25251" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Block: 10/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_9_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge851" class="edge">
<title>attn_block_2_9_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M25251,-393.51C25251,-361.69 25251,-300 25251,-300 25251,-300 37060.42,-300 37060.42,-300"/>
<polygon fill="black" stroke="black" points="37060.42,-303.5 37070.42,-300 37060.42,-296.5 37060.42,-303.5"/>
</g>
<!-- kv_cache_2_9_16 -->
<g id="node231" class="node">
<title>kv_cache_2_9_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="25582.26,-550 24761.01,-550 24549.74,-514 25370.99,-514 25582.26,-550"/>
<text text-anchor="middle" x="25066" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_9_16&#45;&gt;attn_block_2_9_16 -->
<g id="edge850" class="edge">
<title>kv_cache_2_9_16&#45;&gt;attn_block_2_9_16</title>
<path fill="none" stroke="black" d="M25201.81,-513.77C25201.81,-513.77 25201.81,-440 25201.81,-440"/>
<polygon fill="black" stroke="black" points="25205.31,-440 25201.81,-430 25198.31,-440 25205.31,-440"/>
</g>
<!-- attn_block_2_10_16 -->
<g id="node232" class="node">
<title>attn_block_2_10_16</title>
<polygon fill="lightgreen" stroke="black" points="41176,-430 40312,-430 40312,-394 41176,-394 41176,-430"/>
<text text-anchor="middle" x="40744" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Block: 11/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_10_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge854" class="edge">
<title>attn_block_2_10_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M40744,-393.94C40744,-366.13 40744,-316 40744,-316 40744,-316 37669.36,-316 37669.36,-316"/>
<polygon fill="black" stroke="black" points="37669.36,-312.5 37659.36,-316 37669.36,-319.5 37669.36,-312.5"/>
</g>
<!-- kv_cache_2_10_16 -->
<g id="node233" class="node">
<title>kv_cache_2_10_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="41386.39,-550 40558.57,-550 40345.61,-514 41173.43,-514 41386.39,-550"/>
<text text-anchor="middle" x="40866" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_10_16&#45;&gt;attn_block_2_10_16 -->
<g id="edge853" class="edge">
<title>kv_cache_2_10_16&#45;&gt;attn_block_2_10_16</title>
<path fill="none" stroke="black" d="M40760.78,-513.77C40760.78,-513.77 40760.78,-440 40760.78,-440"/>
<polygon fill="black" stroke="black" points="40764.28,-440 40760.78,-430 40757.28,-440 40764.28,-440"/>
</g>
<!-- attn_block_2_11_16 -->
<g id="node234" class="node">
<title>attn_block_2_11_16</title>
<polygon fill="lightgreen" stroke="black" points="40128,-430 39264,-430 39264,-394 40128,-394 40128,-430"/>
<text text-anchor="middle" x="39696" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Block: 12/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_11_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge857" class="edge">
<title>attn_block_2_11_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M39696,-393.88C39696,-366.56 39696,-318 39696,-318 39696,-318 37610.55,-318 37610.55,-318"/>
<polygon fill="black" stroke="black" points="37610.55,-314.5 37600.55,-318 37610.55,-321.5 37610.55,-314.5"/>
</g>
<!-- kv_cache_2_11_16 -->
<g id="node235" class="node">
<title>kv_cache_2_11_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="40327.39,-550 39499.57,-550 39286.61,-514 40114.43,-514 40327.39,-550"/>
<text text-anchor="middle" x="39807" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_11_16&#45;&gt;attn_block_2_11_16 -->
<g id="edge856" class="edge">
<title>kv_cache_2_11_16&#45;&gt;attn_block_2_11_16</title>
<path fill="none" stroke="black" d="M39707.28,-513.77C39707.28,-513.77 39707.28,-440 39707.28,-440"/>
<polygon fill="black" stroke="black" points="39710.78,-440 39707.28,-430 39703.78,-440 39710.78,-440"/>
</g>
<!-- attn_block_2_12_16 -->
<g id="node236" class="node">
<title>attn_block_2_12_16</title>
<polygon fill="lightgreen" stroke="black" points="39091,-430 38227,-430 38227,-394 39091,-394 39091,-430"/>
<text text-anchor="middle" x="38659" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Block: 13/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_12_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge860" class="edge">
<title>attn_block_2_12_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M38659,-393.63C38659,-366.52 38659,-319 38659,-319 38659,-319 37580.87,-319 37580.87,-319"/>
<polygon fill="black" stroke="black" points="37580.87,-315.5 37570.87,-319 37580.87,-322.5 37580.87,-315.5"/>
</g>
<!-- kv_cache_2_12_16 -->
<g id="node237" class="node">
<title>kv_cache_2_12_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="39268.39,-550 38440.57,-550 38227.61,-514 39055.43,-514 39268.39,-550"/>
<text text-anchor="middle" x="38748" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_12_16&#45;&gt;attn_block_2_12_16 -->
<g id="edge859" class="edge">
<title>kv_cache_2_12_16&#45;&gt;attn_block_2_12_16</title>
<path fill="none" stroke="black" d="M38659.28,-513.77C38659.28,-513.77 38659.28,-440 38659.28,-440"/>
<polygon fill="black" stroke="black" points="38662.78,-440 38659.28,-430 38655.78,-440 38662.78,-440"/>
</g>
<!-- attn_block_2_13_16 -->
<g id="node238" class="node">
<title>attn_block_2_13_16</title>
<polygon fill="lightgreen" stroke="black" points="38076,-430 37212,-430 37212,-394 38076,-394 38076,-430"/>
<text text-anchor="middle" x="37644" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Block: 14/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_13_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge863" class="edge">
<title>attn_block_2_13_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M37370.82,-393.76C37370.82,-393.76 37370.82,-335.93 37370.82,-335.93"/>
<polygon fill="black" stroke="black" points="37374.32,-335.93 37370.82,-325.93 37367.32,-335.93 37374.32,-335.93"/>
</g>
<!-- kv_cache_2_13_16 -->
<g id="node239" class="node">
<title>kv_cache_2_13_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="38209.39,-550 37381.57,-550 37168.61,-514 37996.43,-514 38209.39,-550"/>
<text text-anchor="middle" x="37689" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_13_16&#45;&gt;attn_block_2_13_16 -->
<g id="edge862" class="edge">
<title>kv_cache_2_13_16&#45;&gt;attn_block_2_13_16</title>
<path fill="none" stroke="black" d="M37644,-513.77C37644,-513.77 37644,-440 37644,-440"/>
<polygon fill="black" stroke="black" points="37647.5,-440 37644,-430 37640.5,-440 37647.5,-440"/>
</g>
<!-- attn_block_2_14_16 -->
<g id="node240" class="node">
<title>attn_block_2_14_16</title>
<polygon fill="lightgreen" stroke="black" points="37106,-430 36242,-430 36242,-394 37106,-394 37106,-430"/>
<text text-anchor="middle" x="36674" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Block: 15/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_14_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge866" class="edge">
<title>attn_block_2_14_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M36867.77,-393.76C36867.77,-393.76 36867.77,-333.35 36867.77,-333.35"/>
<polygon fill="black" stroke="black" points="36871.27,-333.35 36867.77,-323.35 36864.27,-333.35 36871.27,-333.35"/>
</g>
<!-- kv_cache_2_14_16 -->
<g id="node241" class="node">
<title>kv_cache_2_14_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="37150.39,-550 36322.57,-550 36109.61,-514 36937.43,-514 37150.39,-550"/>
<text text-anchor="middle" x="36630" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_14_16&#45;&gt;attn_block_2_14_16 -->
<g id="edge865" class="edge">
<title>kv_cache_2_14_16&#45;&gt;attn_block_2_14_16</title>
<path fill="none" stroke="black" d="M36674,-513.77C36674,-513.77 36674,-440 36674,-440"/>
<polygon fill="black" stroke="black" points="36677.5,-440 36674,-430 36670.5,-440 36677.5,-440"/>
</g>
<!-- attn_block_2_15_16 -->
<g id="node242" class="node">
<title>attn_block_2_15_16</title>
<polygon fill="lightgreen" stroke="black" points="36113,-430 35249,-430 35249,-394 36113,-394 36113,-430"/>
<text text-anchor="middle" x="35681" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Block: 16/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_2_15_16&#45;&gt;hier_reduce_2_16 -->
<g id="edge869" class="edge">
<title>attn_block_2_15_16&#45;&gt;hier_reduce_2_16</title>
<path fill="none" stroke="black" d="M35681,-393.8C35681,-369.64 35681,-330 35681,-330 35681,-330 37060.7,-330 37060.7,-330"/>
<polygon fill="black" stroke="black" points="37060.7,-333.5 37070.7,-330 37060.7,-326.5 37060.7,-333.5"/>
</g>
<!-- kv_cache_2_15_16 -->
<g id="node243" class="node">
<title>kv_cache_2_15_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="36091.39,-550 35263.57,-550 35050.61,-514 35878.43,-514 36091.39,-550"/>
<text text-anchor="middle" x="35571" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_15_16&#45;&gt;attn_block_2_15_16 -->
<g id="edge868" class="edge">
<title>kv_cache_2_15_16&#45;&gt;attn_block_2_15_16</title>
<path fill="none" stroke="black" d="M35670.22,-513.77C35670.22,-513.77 35670.22,-440 35670.22,-440"/>
<polygon fill="black" stroke="black" points="35673.72,-440 35670.22,-430 35666.72,-440 35673.72,-440"/>
</g>
<!-- attn_block_3_0_16 -->
<g id="node244" class="node">
<title>attn_block_3_0_16</title>
<polygon fill="lightgreen" stroke="black" points="52024,-430 51170,-430 51170,-394 52024,-394 52024,-430"/>
<text text-anchor="middle" x="51597" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- hier_reduce_3_16 -->
<g id="node606" class="node">
<title>hier_reduce_3_16</title>
<polygon fill="lightgray" stroke="black" points="54019,-333 53489.57,-315 54019,-297 54548.43,-315 54019,-333"/>
<text text-anchor="middle" x="54019" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 16 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_3_0_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1161" class="edge">
<title>attn_block_3_0_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M51597,-393.84C51597,-365.26 51597,-313 51597,-313 51597,-313 53538.06,-313 53538.06,-313"/>
<polygon fill="black" stroke="black" points="53538.06,-316.5 53548.06,-313 53538.06,-309.5 53538.06,-316.5"/>
</g>
<!-- kv_cache_3_0_16 -->
<g id="node245" class="node">
<title>kv_cache_3_0_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="51892.26,-550 51071.01,-550 50859.74,-514 51680.99,-514 51892.26,-550"/>
<text text-anchor="middle" x="51376" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_0_16&#45;&gt;attn_block_3_0_16 -->
<g id="edge1160" class="edge">
<title>kv_cache_3_0_16&#45;&gt;attn_block_3_0_16</title>
<path fill="none" stroke="black" d="M51531.06,-513.77C51531.06,-513.77 51531.06,-440 51531.06,-440"/>
<polygon fill="black" stroke="black" points="51534.56,-440 51531.06,-430 51527.56,-440 51534.56,-440"/>
</g>
<!-- attn_block_3_1_16 -->
<g id="node246" class="node">
<title>attn_block_3_1_16</title>
<polygon fill="lightgreen" stroke="black" points="51019,-430 50165,-430 50165,-394 51019,-394 51019,-430"/>
<text text-anchor="middle" x="50592" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_1_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1164" class="edge">
<title>attn_block_3_1_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M50592,-393.94C50592,-364.89 50592,-311 50592,-311 50592,-311 53596.9,-311 53596.9,-311"/>
<polygon fill="black" stroke="black" points="53596.9,-314.5 53606.9,-311 53596.9,-307.5 53596.9,-314.5"/>
</g>
<!-- kv_cache_3_1_16 -->
<g id="node247" class="node">
<title>kv_cache_3_1_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="50842.26,-550 50021.01,-550 49809.74,-514 50630.99,-514 50842.26,-550"/>
<text text-anchor="middle" x="50326" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_1_16&#45;&gt;attn_block_3_1_16 -->
<g id="edge1163" class="edge">
<title>kv_cache_3_1_16&#45;&gt;attn_block_3_1_16</title>
<path fill="none" stroke="black" d="M50503.56,-513.77C50503.56,-513.77 50503.56,-440 50503.56,-440"/>
<polygon fill="black" stroke="black" points="50507.06,-440 50503.56,-430 50500.06,-440 50507.06,-440"/>
</g>
<!-- attn_block_3_2_16 -->
<g id="node248" class="node">
<title>attn_block_3_2_16</title>
<polygon fill="lightgreen" stroke="black" points="49880,-430 49026,-430 49026,-394 49880,-394 49880,-430"/>
<text text-anchor="middle" x="49453" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_2_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1167" class="edge">
<title>attn_block_3_2_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M49453,-393.76C49453,-364.43 49453,-310 49453,-310 49453,-310 53626.58,-310 53626.58,-310"/>
<polygon fill="black" stroke="black" points="53626.58,-313.5 53636.58,-310 53626.58,-306.5 53626.58,-313.5"/>
</g>
<!-- kv_cache_3_2_16 -->
<g id="node249" class="node">
<title>kv_cache_3_2_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="49792.26,-550 48971.01,-550 48759.74,-514 49580.99,-514 49792.26,-550"/>
<text text-anchor="middle" x="49276" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_2_16&#45;&gt;attn_block_3_2_16 -->
<g id="edge1166" class="edge">
<title>kv_cache_3_2_16&#45;&gt;attn_block_3_2_16</title>
<path fill="none" stroke="black" d="M49409.06,-513.77C49409.06,-513.77 49409.06,-440 49409.06,-440"/>
<polygon fill="black" stroke="black" points="49412.56,-440 49409.06,-430 49405.56,-440 49412.56,-440"/>
</g>
<!-- attn_block_3_3_16 -->
<g id="node250" class="node">
<title>attn_block_3_3_16</title>
<polygon fill="lightgreen" stroke="black" points="48775,-430 47921,-430 47921,-394 48775,-394 48775,-430"/>
<text text-anchor="middle" x="48348" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_3_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1170" class="edge">
<title>attn_block_3_3_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M48348,-393.88C48348,-364.09 48348,-308 48348,-308 48348,-308 53685.28,-308 53685.28,-308"/>
<polygon fill="black" stroke="black" points="53685.28,-311.5 53695.28,-308 53685.28,-304.5 53685.28,-311.5"/>
</g>
<!-- kv_cache_3_3_16 -->
<g id="node251" class="node">
<title>kv_cache_3_3_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="48742.26,-550 47921.01,-550 47709.74,-514 48530.99,-514 48742.26,-550"/>
<text text-anchor="middle" x="48226" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_3_16&#45;&gt;attn_block_3_3_16 -->
<g id="edge1169" class="edge">
<title>kv_cache_3_3_16&#45;&gt;attn_block_3_3_16</title>
<path fill="none" stroke="black" d="M48331.56,-513.77C48331.56,-513.77 48331.56,-440 48331.56,-440"/>
<polygon fill="black" stroke="black" points="48335.06,-440 48331.56,-430 48328.06,-440 48335.06,-440"/>
</g>
<!-- attn_block_3_4_16 -->
<g id="node252" class="node">
<title>attn_block_3_4_16</title>
<polygon fill="lightgreen" stroke="black" points="47753,-430 46899,-430 46899,-394 47753,-394 47753,-430"/>
<text text-anchor="middle" x="47326" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_4_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1173" class="edge">
<title>attn_block_3_4_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M47326,-393.54C47326,-363.17 47326,-306 47326,-306 47326,-306 53744.05,-306 53744.05,-306"/>
<polygon fill="black" stroke="black" points="53744.05,-309.5 53754.05,-306 53744.05,-302.5 53744.05,-309.5"/>
</g>
<!-- kv_cache_3_4_16 -->
<g id="node253" class="node">
<title>kv_cache_3_4_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="47692.26,-550 46871.01,-550 46659.74,-514 47480.99,-514 47692.26,-550"/>
<text text-anchor="middle" x="47176" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_4_16&#45;&gt;attn_block_3_4_16 -->
<g id="edge1172" class="edge">
<title>kv_cache_3_4_16&#45;&gt;attn_block_3_4_16</title>
<path fill="none" stroke="black" d="M47295.56,-513.77C47295.56,-513.77 47295.56,-440 47295.56,-440"/>
<polygon fill="black" stroke="black" points="47299.06,-440 47295.56,-430 47292.06,-440 47299.06,-440"/>
</g>
<!-- attn_block_3_5_16 -->
<g id="node254" class="node">
<title>attn_block_3_5_16</title>
<polygon fill="lightgreen" stroke="black" points="46717,-430 45863,-430 45863,-394 46717,-394 46717,-430"/>
<text text-anchor="middle" x="46290" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_5_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1176" class="edge">
<title>attn_block_3_5_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M46290,-393.85C46290,-363.32 46290,-305 46290,-305 46290,-305 53773.47,-305 53773.47,-305"/>
<polygon fill="black" stroke="black" points="53773.47,-308.5 53783.47,-305 53773.47,-301.5 53773.47,-308.5"/>
</g>
<!-- kv_cache_3_5_16 -->
<g id="node255" class="node">
<title>kv_cache_3_5_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="46642.26,-550 45821.01,-550 45609.74,-514 46430.99,-514 46642.26,-550"/>
<text text-anchor="middle" x="46126" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_5_16&#45;&gt;attn_block_3_5_16 -->
<g id="edge1175" class="edge">
<title>kv_cache_3_5_16&#45;&gt;attn_block_3_5_16</title>
<path fill="none" stroke="black" d="M46252.56,-513.77C46252.56,-513.77 46252.56,-440 46252.56,-440"/>
<polygon fill="black" stroke="black" points="46256.06,-440 46252.56,-430 46249.06,-440 46256.06,-440"/>
</g>
<!-- attn_block_3_6_16 -->
<g id="node256" class="node">
<title>attn_block_3_6_16</title>
<polygon fill="lightgreen" stroke="black" points="45674,-430 44820,-430 44820,-394 45674,-394 45674,-430"/>
<text text-anchor="middle" x="45247" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_6_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1179" class="edge">
<title>attn_block_3_6_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M45247,-393.51C45247,-362.41 45247,-303 45247,-303 45247,-303 53832.29,-303 53832.29,-303"/>
<polygon fill="black" stroke="black" points="53832.29,-306.5 53842.29,-303 53832.29,-299.5 53832.29,-306.5"/>
</g>
<!-- kv_cache_3_6_16 -->
<g id="node257" class="node">
<title>kv_cache_3_6_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="45592.26,-550 44771.01,-550 44559.74,-514 45380.99,-514 45592.26,-550"/>
<text text-anchor="middle" x="45076" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_6_16&#45;&gt;attn_block_3_6_16 -->
<g id="edge1178" class="edge">
<title>kv_cache_3_6_16&#45;&gt;attn_block_3_6_16</title>
<path fill="none" stroke="black" d="M45206.06,-513.77C45206.06,-513.77 45206.06,-440 45206.06,-440"/>
<polygon fill="black" stroke="black" points="45209.56,-440 45206.06,-430 45202.56,-440 45209.56,-440"/>
</g>
<!-- attn_block_3_7_16 -->
<g id="node258" class="node">
<title>attn_block_3_7_16</title>
<polygon fill="lightgreen" stroke="black" points="44627,-430 43773,-430 43773,-394 44627,-394 44627,-430"/>
<text text-anchor="middle" x="44200" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_7_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1182" class="edge">
<title>attn_block_3_7_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M44200,-393.67C44200,-362.14 44200,-301 44200,-301 44200,-301 53891.02,-301 53891.02,-301"/>
<polygon fill="black" stroke="black" points="53891.02,-304.5 53901.02,-301 53891.02,-297.5 53891.02,-304.5"/>
</g>
<!-- kv_cache_3_7_16 -->
<g id="node259" class="node">
<title>kv_cache_3_7_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="44542.26,-550 43721.01,-550 43509.74,-514 44330.99,-514 44542.26,-550"/>
<text text-anchor="middle" x="44026" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_7_16&#45;&gt;attn_block_3_7_16 -->
<g id="edge1181" class="edge">
<title>kv_cache_3_7_16&#45;&gt;attn_block_3_7_16</title>
<path fill="none" stroke="black" d="M44157.56,-513.77C44157.56,-513.77 44157.56,-440 44157.56,-440"/>
<polygon fill="black" stroke="black" points="44161.06,-440 44157.56,-430 44154.06,-440 44161.06,-440"/>
</g>
<!-- attn_block_3_8_16 -->
<g id="node260" class="node">
<title>attn_block_3_8_16</title>
<polygon fill="lightgreen" stroke="black" points="43579,-430 42725,-430 42725,-394 43579,-394 43579,-430"/>
<text text-anchor="middle" x="43152" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Block: 9/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_8_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1185" class="edge">
<title>attn_block_3_8_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M43152,-393.51C43152,-361.69 43152,-300 43152,-300 43152,-300 53920.73,-300 53920.73,-300"/>
<polygon fill="black" stroke="black" points="53920.73,-303.5 53930.73,-300 53920.73,-296.5 53920.73,-303.5"/>
</g>
<!-- kv_cache_3_8_16 -->
<g id="node261" class="node">
<title>kv_cache_3_8_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="43492.26,-550 42671.01,-550 42459.74,-514 43280.99,-514 43492.26,-550"/>
<text text-anchor="middle" x="42976" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_8_16&#45;&gt;attn_block_3_8_16 -->
<g id="edge1184" class="edge">
<title>kv_cache_3_8_16&#45;&gt;attn_block_3_8_16</title>
<path fill="none" stroke="black" d="M43108.56,-513.77C43108.56,-513.77 43108.56,-440 43108.56,-440"/>
<polygon fill="black" stroke="black" points="43112.06,-440 43108.56,-430 43105.06,-440 43112.06,-440"/>
</g>
<!-- attn_block_3_9_16 -->
<g id="node262" class="node">
<title>attn_block_3_9_16</title>
<polygon fill="lightgreen" stroke="black" points="42530.5,-430 41671.5,-430 41671.5,-394 42530.5,-394 42530.5,-430"/>
<text text-anchor="middle" x="42101" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Block: 10/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_9_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1188" class="edge">
<title>attn_block_3_9_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M42101,-393.94C42101,-361.79 42101,-298 42101,-298 42101,-298 53979.41,-298 53979.41,-298"/>
<polygon fill="black" stroke="black" points="53979.41,-301.5 53989.41,-298 53979.41,-294.5 53979.41,-301.5"/>
</g>
<!-- kv_cache_3_9_16 -->
<g id="node263" class="node">
<title>kv_cache_3_9_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="42442.26,-550 41621.01,-550 41409.74,-514 42230.99,-514 42442.26,-550"/>
<text text-anchor="middle" x="41926" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_9_16&#45;&gt;attn_block_3_9_16 -->
<g id="edge1187" class="edge">
<title>kv_cache_3_9_16&#45;&gt;attn_block_3_9_16</title>
<path fill="none" stroke="black" d="M42056.81,-513.77C42056.81,-513.77 42056.81,-440 42056.81,-440"/>
<polygon fill="black" stroke="black" points="42060.31,-440 42056.81,-430 42053.31,-440 42060.31,-440"/>
</g>
<!-- attn_block_3_10_16 -->
<g id="node264" class="node">
<title>attn_block_3_10_16</title>
<polygon fill="lightgreen" stroke="black" points="58036,-430 57172,-430 57172,-394 58036,-394 58036,-430"/>
<text text-anchor="middle" x="57604" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Block: 11/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_10_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1191" class="edge">
<title>attn_block_3_10_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M57604,-393.84C57604,-365.26 57604,-313 57604,-313 57604,-313 54499.98,-313 54499.98,-313"/>
<polygon fill="black" stroke="black" points="54499.98,-309.5 54489.98,-313 54499.98,-316.5 54499.98,-309.5"/>
</g>
<!-- kv_cache_3_10_16 -->
<g id="node265" class="node">
<title>kv_cache_3_10_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="58246.39,-550 57418.57,-550 57205.61,-514 58033.43,-514 58246.39,-550"/>
<text text-anchor="middle" x="57726" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_10_16&#45;&gt;attn_block_3_10_16 -->
<g id="edge1190" class="edge">
<title>kv_cache_3_10_16&#45;&gt;attn_block_3_10_16</title>
<path fill="none" stroke="black" d="M57620.78,-513.77C57620.78,-513.77 57620.78,-440 57620.78,-440"/>
<polygon fill="black" stroke="black" points="57624.28,-440 57620.78,-430 57617.28,-440 57624.28,-440"/>
</g>
<!-- attn_block_3_11_16 -->
<g id="node266" class="node">
<title>attn_block_3_11_16</title>
<polygon fill="lightgreen" stroke="black" points="56988,-430 56124,-430 56124,-394 56988,-394 56988,-430"/>
<text text-anchor="middle" x="56556" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Block: 12/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_11_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1194" class="edge">
<title>attn_block_3_11_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M56556,-393.94C56556,-366.13 56556,-316 56556,-316 56556,-316 54529.09,-316 54529.09,-316"/>
<polygon fill="black" stroke="black" points="54529.09,-312.5 54519.09,-316 54529.09,-319.5 54529.09,-312.5"/>
</g>
<!-- kv_cache_3_11_16 -->
<g id="node267" class="node">
<title>kv_cache_3_11_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="57187.39,-550 56359.57,-550 56146.61,-514 56974.43,-514 57187.39,-550"/>
<text text-anchor="middle" x="56667" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_11_16&#45;&gt;attn_block_3_11_16 -->
<g id="edge1193" class="edge">
<title>kv_cache_3_11_16&#45;&gt;attn_block_3_11_16</title>
<path fill="none" stroke="black" d="M56567.28,-513.77C56567.28,-513.77 56567.28,-440 56567.28,-440"/>
<polygon fill="black" stroke="black" points="56570.78,-440 56567.28,-430 56563.78,-440 56570.78,-440"/>
</g>
<!-- attn_block_3_12_16 -->
<g id="node268" class="node">
<title>attn_block_3_12_16</title>
<polygon fill="lightgreen" stroke="black" points="55951,-430 55087,-430 55087,-394 55951,-394 55951,-430"/>
<text text-anchor="middle" x="55519" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Block: 13/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_12_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1197" class="edge">
<title>attn_block_3_12_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M55519,-393.63C55519,-366.52 55519,-319 55519,-319 55519,-319 54440.87,-319 54440.87,-319"/>
<polygon fill="black" stroke="black" points="54440.87,-315.5 54430.87,-319 54440.87,-322.5 54440.87,-315.5"/>
</g>
<!-- kv_cache_3_12_16 -->
<g id="node269" class="node">
<title>kv_cache_3_12_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="56128.39,-550 55300.57,-550 55087.61,-514 55915.43,-514 56128.39,-550"/>
<text text-anchor="middle" x="55608" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_12_16&#45;&gt;attn_block_3_12_16 -->
<g id="edge1196" class="edge">
<title>kv_cache_3_12_16&#45;&gt;attn_block_3_12_16</title>
<path fill="none" stroke="black" d="M55519.28,-513.77C55519.28,-513.77 55519.28,-440 55519.28,-440"/>
<polygon fill="black" stroke="black" points="55522.78,-440 55519.28,-430 55515.78,-440 55522.78,-440"/>
</g>
<!-- attn_block_3_13_16 -->
<g id="node270" class="node">
<title>attn_block_3_13_16</title>
<polygon fill="lightgreen" stroke="black" points="54936,-430 54072,-430 54072,-394 54936,-394 54936,-430"/>
<text text-anchor="middle" x="54504" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Block: 14/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_13_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1200" class="edge">
<title>attn_block_3_13_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M54167.29,-393.76C54167.29,-393.76 54167.29,-338.19 54167.29,-338.19"/>
<polygon fill="black" stroke="black" points="54170.79,-338.19 54167.29,-328.19 54163.79,-338.19 54170.79,-338.19"/>
</g>
<!-- kv_cache_3_13_16 -->
<g id="node271" class="node">
<title>kv_cache_3_13_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="55069.39,-550 54241.57,-550 54028.61,-514 54856.43,-514 55069.39,-550"/>
<text text-anchor="middle" x="54549" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_13_16&#45;&gt;attn_block_3_13_16 -->
<g id="edge1199" class="edge">
<title>kv_cache_3_13_16&#45;&gt;attn_block_3_13_16</title>
<path fill="none" stroke="black" d="M54504,-513.77C54504,-513.77 54504,-440 54504,-440"/>
<polygon fill="black" stroke="black" points="54507.5,-440 54504,-430 54500.5,-440 54507.5,-440"/>
</g>
<!-- attn_block_3_14_16 -->
<g id="node272" class="node">
<title>attn_block_3_14_16</title>
<polygon fill="lightgreen" stroke="black" points="53966,-430 53102,-430 53102,-394 53966,-394 53966,-430"/>
<text text-anchor="middle" x="53534" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Block: 15/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_14_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1203" class="edge">
<title>attn_block_3_14_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M53727.77,-393.76C53727.77,-393.76 53727.77,-333.35 53727.77,-333.35"/>
<polygon fill="black" stroke="black" points="53731.27,-333.35 53727.77,-323.35 53724.27,-333.35 53731.27,-333.35"/>
</g>
<!-- kv_cache_3_14_16 -->
<g id="node273" class="node">
<title>kv_cache_3_14_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="54010.39,-550 53182.57,-550 52969.61,-514 53797.43,-514 54010.39,-550"/>
<text text-anchor="middle" x="53490" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_14_16&#45;&gt;attn_block_3_14_16 -->
<g id="edge1202" class="edge">
<title>kv_cache_3_14_16&#45;&gt;attn_block_3_14_16</title>
<path fill="none" stroke="black" d="M53534,-513.77C53534,-513.77 53534,-440 53534,-440"/>
<polygon fill="black" stroke="black" points="53537.5,-440 53534,-430 53530.5,-440 53537.5,-440"/>
</g>
<!-- attn_block_3_15_16 -->
<g id="node274" class="node">
<title>attn_block_3_15_16</title>
<polygon fill="lightgreen" stroke="black" points="52973,-430 52109,-430 52109,-394 52973,-394 52973,-430"/>
<text text-anchor="middle" x="52541" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Block: 16/16&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/16), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/16), hidden=4096]</text>
</g>
<!-- attn_block_3_15_16&#45;&gt;hier_reduce_3_16 -->
<g id="edge1206" class="edge">
<title>attn_block_3_15_16&#45;&gt;hier_reduce_3_16</title>
<path fill="none" stroke="black" d="M52541,-393.76C52541,-365.66 52541,-315 52541,-315 52541,-315 53479.32,-315 53479.32,-315"/>
<polygon fill="black" stroke="black" points="53479.32,-318.5 53489.32,-315 53479.32,-311.5 53479.32,-318.5"/>
</g>
<!-- kv_cache_3_15_16 -->
<g id="node275" class="node">
<title>kv_cache_3_15_16</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="52951.39,-550 52123.57,-550 51910.61,-514 52738.43,-514 52951.39,-550"/>
<text text-anchor="middle" x="52431" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_15_16&#45;&gt;attn_block_3_15_16 -->
<g id="edge1205" class="edge">
<title>kv_cache_3_15_16&#45;&gt;attn_block_3_15_16</title>
<path fill="none" stroke="black" d="M52530.22,-513.77C52530.22,-513.77 52530.22,-440 52530.22,-440"/>
<polygon fill="black" stroke="black" points="52533.72,-440 52530.22,-430 52526.72,-440 52533.72,-440"/>
</g>
<!-- attn_block_0_0_24 -->
<g id="node276" class="node">
<title>attn_block_0_0_24</title>
<polygon fill="lightgreen" stroke="black" points="195961,-430 195107,-430 195107,-394 195961,-394 195961,-430"/>
<text text-anchor="middle" x="195534" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- hier_reduce_0_24 -->
<g id="node598" class="node">
<title>hier_reduce_0_24</title>
<polygon fill="lightgray" stroke="black" points="186262,-333 185732.57,-315 186262,-297 186791.43,-315 186262,-333"/>
<text text-anchor="middle" x="186262" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 24 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_0_0_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge246" class="edge">
<title>attn_block_0_0_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M195534,-393.71C195534,-363.63 195534,-307 195534,-307 195534,-307 186566.42,-307 186566.42,-307"/>
<polygon fill="black" stroke="black" points="186566.42,-303.5 186556.42,-307 186566.42,-310.5 186566.42,-303.5"/>
</g>
<!-- kv_cache_0_0_24 -->
<g id="node277" class="node">
<title>kv_cache_0_0_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="196228.26,-550 195407.01,-550 195195.74,-514 196016.99,-514 196228.26,-550"/>
<text text-anchor="middle" x="195712" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_0_24&#45;&gt;attn_block_0_0_24 -->
<g id="edge245" class="edge">
<title>kv_cache_0_0_24&#45;&gt;attn_block_0_0_24</title>
<path fill="none" stroke="black" d="M195578.44,-513.77C195578.44,-513.77 195578.44,-440 195578.44,-440"/>
<polygon fill="black" stroke="black" points="195581.94,-440 195578.44,-430 195574.94,-440 195581.94,-440"/>
</g>
<!-- attn_block_0_1_24 -->
<g id="node278" class="node">
<title>attn_block_0_1_24</title>
<polygon fill="lightgreen" stroke="black" points="194911,-430 194057,-430 194057,-394 194911,-394 194911,-430"/>
<text text-anchor="middle" x="194484" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_1_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge249" class="edge">
<title>attn_block_0_1_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M194484,-393.59C194484,-363.96 194484,-309 194484,-309 194484,-309 186624.96,-309 186624.96,-309"/>
<polygon fill="black" stroke="black" points="186624.96,-305.5 186614.96,-309 186624.96,-312.5 186624.96,-305.5"/>
</g>
<!-- kv_cache_0_1_24 -->
<g id="node279" class="node">
<title>kv_cache_0_1_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="195178.26,-550 194357.01,-550 194145.74,-514 194966.99,-514 195178.26,-550"/>
<text text-anchor="middle" x="194662" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_1_24&#45;&gt;attn_block_0_1_24 -->
<g id="edge248" class="edge">
<title>kv_cache_0_1_24&#45;&gt;attn_block_0_1_24</title>
<path fill="none" stroke="black" d="M194528.44,-513.77C194528.44,-513.77 194528.44,-440 194528.44,-440"/>
<polygon fill="black" stroke="black" points="194531.94,-440 194528.44,-430 194524.94,-440 194531.94,-440"/>
</g>
<!-- attn_block_0_2_24 -->
<g id="node280" class="node">
<title>attn_block_0_2_24</title>
<polygon fill="lightgreen" stroke="black" points="193862,-430 193008,-430 193008,-394 193862,-394 193862,-430"/>
<text text-anchor="middle" x="193435" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_2_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge252" class="edge">
<title>attn_block_0_2_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M193435,-393.76C193435,-364.43 193435,-310 193435,-310 193435,-310 186654.48,-310 186654.48,-310"/>
<polygon fill="black" stroke="black" points="186654.48,-306.5 186644.48,-310 186654.48,-313.5 186654.48,-306.5"/>
</g>
<!-- kv_cache_0_2_24 -->
<g id="node281" class="node">
<title>kv_cache_0_2_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="194128.26,-550 193307.01,-550 193095.74,-514 193916.99,-514 194128.26,-550"/>
<text text-anchor="middle" x="193612" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_2_24&#45;&gt;attn_block_0_2_24 -->
<g id="edge251" class="edge">
<title>kv_cache_0_2_24&#45;&gt;attn_block_0_2_24</title>
<path fill="none" stroke="black" d="M193478.94,-513.77C193478.94,-513.77 193478.94,-440 193478.94,-440"/>
<polygon fill="black" stroke="black" points="193482.44,-440 193478.94,-430 193475.44,-440 193482.44,-440"/>
</g>
<!-- attn_block_0_3_24 -->
<g id="node282" class="node">
<title>attn_block_0_3_24</title>
<polygon fill="lightgreen" stroke="black" points="192813,-430 191959,-430 191959,-394 192813,-394 192813,-430"/>
<text text-anchor="middle" x="192386" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_3_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge255" class="edge">
<title>attn_block_0_3_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M192386,-393.66C192386,-364.79 192386,-312 192386,-312 192386,-312 186713.35,-312 186713.35,-312"/>
<polygon fill="black" stroke="black" points="186713.35,-308.5 186703.35,-312 186713.35,-315.5 186713.35,-308.5"/>
</g>
<!-- kv_cache_0_3_24 -->
<g id="node283" class="node">
<title>kv_cache_0_3_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="193078.26,-550 192257.01,-550 192045.74,-514 192866.99,-514 193078.26,-550"/>
<text text-anchor="middle" x="192562" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_3_24&#45;&gt;attn_block_0_3_24 -->
<g id="edge254" class="edge">
<title>kv_cache_0_3_24&#45;&gt;attn_block_0_3_24</title>
<path fill="none" stroke="black" d="M192429.44,-513.77C192429.44,-513.77 192429.44,-440 192429.44,-440"/>
<polygon fill="black" stroke="black" points="192432.94,-440 192429.44,-430 192425.94,-440 192432.94,-440"/>
</g>
<!-- attn_block_0_4_24 -->
<g id="node284" class="node">
<title>attn_block_0_4_24</title>
<polygon fill="lightgreen" stroke="black" points="191766,-430 190912,-430 190912,-394 191766,-394 191766,-430"/>
<text text-anchor="middle" x="191339" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_4_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge258" class="edge">
<title>attn_block_0_4_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M191339,-393.84C191339,-365.26 191339,-313 191339,-313 191339,-313 186742.8,-313 186742.8,-313"/>
<polygon fill="black" stroke="black" points="186742.8,-309.5 186732.8,-313 186742.8,-316.5 186742.8,-309.5"/>
</g>
<!-- kv_cache_0_4_24 -->
<g id="node285" class="node">
<title>kv_cache_0_4_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="192028.26,-550 191207.01,-550 190995.74,-514 191816.99,-514 192028.26,-550"/>
<text text-anchor="middle" x="191512" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_4_24&#45;&gt;attn_block_0_4_24 -->
<g id="edge257" class="edge">
<title>kv_cache_0_4_24&#45;&gt;attn_block_0_4_24</title>
<path fill="none" stroke="black" d="M191380.94,-513.77C191380.94,-513.77 191380.94,-440 191380.94,-440"/>
<polygon fill="black" stroke="black" points="191384.44,-440 191380.94,-430 191377.44,-440 191384.44,-440"/>
</g>
<!-- attn_block_0_5_24 -->
<g id="node286" class="node">
<title>attn_block_0_5_24</title>
<polygon fill="lightgreen" stroke="black" points="190722,-430 189868,-430 189868,-394 190722,-394 190722,-430"/>
<text text-anchor="middle" x="190295" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_5_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge261" class="edge">
<title>attn_block_0_5_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M190295,-393.76C190295,-365.66 190295,-315 190295,-315 190295,-315 186801.58,-315 186801.58,-315"/>
<polygon fill="black" stroke="black" points="186801.58,-311.5 186791.58,-315 186801.58,-318.5 186801.58,-311.5"/>
</g>
<!-- kv_cache_0_5_24 -->
<g id="node287" class="node">
<title>kv_cache_0_5_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="190978.26,-550 190157.01,-550 189945.74,-514 190766.99,-514 190978.26,-550"/>
<text text-anchor="middle" x="190462" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_5_24&#45;&gt;attn_block_0_5_24 -->
<g id="edge260" class="edge">
<title>kv_cache_0_5_24&#45;&gt;attn_block_0_5_24</title>
<path fill="none" stroke="black" d="M190333.94,-513.77C190333.94,-513.77 190333.94,-440 190333.94,-440"/>
<polygon fill="black" stroke="black" points="190337.44,-440 190333.94,-430 190330.44,-440 190337.44,-440"/>
</g>
<!-- attn_block_0_6_24 -->
<g id="node288" class="node">
<title>attn_block_0_6_24</title>
<polygon fill="lightgreen" stroke="black" points="189683,-430 188829,-430 188829,-394 189683,-394 189683,-430"/>
<text text-anchor="middle" x="189256" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_6_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge264" class="edge">
<title>attn_block_0_6_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M189256,-393.94C189256,-366.13 189256,-316 189256,-316 189256,-316 186772.29,-316 186772.29,-316"/>
<polygon fill="black" stroke="black" points="186772.29,-312.5 186762.29,-316 186772.29,-319.5 186772.29,-312.5"/>
</g>
<!-- kv_cache_0_6_24 -->
<g id="node289" class="node">
<title>kv_cache_0_6_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="189928.26,-550 189107.01,-550 188895.74,-514 189716.99,-514 189928.26,-550"/>
<text text-anchor="middle" x="189412" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_6_24&#45;&gt;attn_block_0_6_24 -->
<g id="edge263" class="edge">
<title>kv_cache_0_6_24&#45;&gt;attn_block_0_6_24</title>
<path fill="none" stroke="black" d="M189289.44,-513.77C189289.44,-513.77 189289.44,-440 189289.44,-440"/>
<polygon fill="black" stroke="black" points="189292.94,-440 189289.44,-430 189285.94,-440 189292.94,-440"/>
</g>
<!-- attn_block_0_7_24 -->
<g id="node290" class="node">
<title>attn_block_0_7_24</title>
<polygon fill="lightgreen" stroke="black" points="188656,-430 187802,-430 187802,-394 188656,-394 188656,-430"/>
<text text-anchor="middle" x="188229" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_7_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge267" class="edge">
<title>attn_block_0_7_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M188229,-393.88C188229,-366.56 188229,-318 188229,-318 188229,-318 186713.43,-318 186713.43,-318"/>
<polygon fill="black" stroke="black" points="186713.43,-314.5 186703.43,-318 186713.43,-321.5 186713.43,-314.5"/>
</g>
<!-- kv_cache_0_7_24 -->
<g id="node291" class="node">
<title>kv_cache_0_7_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="188878.26,-550 188057.01,-550 187845.74,-514 188666.99,-514 188878.26,-550"/>
<text text-anchor="middle" x="188362" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_7_24&#45;&gt;attn_block_0_7_24 -->
<g id="edge266" class="edge">
<title>kv_cache_0_7_24&#45;&gt;attn_block_0_7_24</title>
<path fill="none" stroke="black" d="M188250.94,-513.77C188250.94,-513.77 188250.94,-440 188250.94,-440"/>
<polygon fill="black" stroke="black" points="188254.44,-440 188250.94,-430 188247.44,-440 188254.44,-440"/>
</g>
<!-- attn_block_0_8_24 -->
<g id="node292" class="node">
<title>attn_block_0_8_24</title>
<polygon fill="lightgreen" stroke="black" points="187651,-430 186797,-430 186797,-394 187651,-394 187651,-430"/>
<text text-anchor="middle" x="187224" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Block: 9/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_8_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge270" class="edge">
<title>attn_block_0_8_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M186796.55,-412C186788.99,-412 186784.8,-412 186784.8,-412 186784.8,-412 186784.8,-325.28 186784.8,-325.28"/>
<polygon fill="black" stroke="black" points="186788.3,-325.28 186784.8,-315.28 186781.3,-325.28 186788.3,-325.28"/>
</g>
<!-- kv_cache_0_8_24 -->
<g id="node293" class="node">
<title>kv_cache_0_8_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="187828.26,-550 187007.01,-550 186795.74,-514 187616.99,-514 187828.26,-550"/>
<text text-anchor="middle" x="187312" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_8_24&#45;&gt;attn_block_0_8_24 -->
<g id="edge269" class="edge">
<title>kv_cache_0_8_24&#45;&gt;attn_block_0_8_24</title>
<path fill="none" stroke="black" d="M187224,-513.77C187224,-513.77 187224,-440 187224,-440"/>
<polygon fill="black" stroke="black" points="187227.5,-440 187224,-430 187220.5,-440 187227.5,-440"/>
</g>
<!-- attn_block_0_9_24 -->
<g id="node294" class="node">
<title>attn_block_0_9_24</title>
<polygon fill="lightgreen" stroke="black" points="186691.5,-430 185832.5,-430 185832.5,-394 186691.5,-394 186691.5,-430"/>
<text text-anchor="middle" x="186262" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Block: 10/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_9_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge273" class="edge">
<title>attn_block_0_9_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M186262,-393.76C186262,-393.76 186262,-343.16 186262,-343.16"/>
<polygon fill="black" stroke="black" points="186265.5,-343.16 186262,-333.16 186258.5,-343.16 186265.5,-343.16"/>
</g>
<!-- kv_cache_0_9_24 -->
<g id="node295" class="node">
<title>kv_cache_0_9_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="186778.26,-550 185957.01,-550 185745.74,-514 186566.99,-514 186778.26,-550"/>
<text text-anchor="middle" x="186262" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_9_24&#45;&gt;attn_block_0_9_24 -->
<g id="edge272" class="edge">
<title>kv_cache_0_9_24&#45;&gt;attn_block_0_9_24</title>
<path fill="none" stroke="black" d="M186262,-513.77C186262,-513.77 186262,-440 186262,-440"/>
<polygon fill="black" stroke="black" points="186265.5,-440 186262,-430 186258.5,-440 186265.5,-440"/>
</g>
<!-- attn_block_0_10_24 -->
<g id="node296" class="node">
<title>attn_block_0_10_24</title>
<polygon fill="lightgreen" stroke="black" points="185726,-430 184862,-430 184862,-394 185726,-394 185726,-430"/>
<text text-anchor="middle" x="185294" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Block: 11/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_10_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge276" class="edge">
<title>attn_block_0_10_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M185726.34,-412C185731.79,-412 185734.76,-412 185734.76,-412 185734.76,-412 185734.76,-325.28 185734.76,-325.28"/>
<polygon fill="black" stroke="black" points="185738.26,-325.28 185734.76,-315.28 185731.26,-325.28 185738.26,-325.28"/>
</g>
<!-- kv_cache_0_10_24 -->
<g id="node297" class="node">
<title>kv_cache_0_10_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="185727.39,-550 184899.57,-550 184686.61,-514 185514.43,-514 185727.39,-550"/>
<text text-anchor="middle" x="185207" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_10_24&#45;&gt;attn_block_0_10_24 -->
<g id="edge275" class="edge">
<title>kv_cache_0_10_24&#45;&gt;attn_block_0_10_24</title>
<path fill="none" stroke="black" d="M185294,-513.77C185294,-513.77 185294,-440 185294,-440"/>
<polygon fill="black" stroke="black" points="185297.5,-440 185294,-430 185290.5,-440 185297.5,-440"/>
</g>
<!-- attn_block_0_11_24 -->
<g id="node298" class="node">
<title>attn_block_0_11_24</title>
<polygon fill="lightgreen" stroke="black" points="184712,-430 183848,-430 183848,-394 184712,-394 184712,-430"/>
<text text-anchor="middle" x="184280" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Block: 12/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_11_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge279" class="edge">
<title>attn_block_0_11_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M184280,-393.8C184280,-369.64 184280,-330 184280,-330 184280,-330 186163.63,-330 186163.63,-330"/>
<polygon fill="black" stroke="black" points="186163.63,-333.5 186173.63,-330 186163.63,-326.5 186163.63,-333.5"/>
</g>
<!-- kv_cache_0_11_24 -->
<g id="node299" class="node">
<title>kv_cache_0_11_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="184668.39,-550 183840.57,-550 183627.61,-514 184455.43,-514 184668.39,-550"/>
<text text-anchor="middle" x="184148" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_11_24&#45;&gt;attn_block_0_11_24 -->
<g id="edge278" class="edge">
<title>kv_cache_0_11_24&#45;&gt;attn_block_0_11_24</title>
<path fill="none" stroke="black" d="M184258.22,-513.77C184258.22,-513.77 184258.22,-440 184258.22,-440"/>
<polygon fill="black" stroke="black" points="184261.72,-440 184258.22,-430 184254.72,-440 184261.72,-440"/>
</g>
<!-- attn_block_0_12_24 -->
<g id="node300" class="node">
<title>attn_block_0_12_24</title>
<polygon fill="lightgreen" stroke="black" points="183675,-430 182811,-430 182811,-394 183675,-394 183675,-430"/>
<text text-anchor="middle" x="183243" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Block: 13/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_12_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge282" class="edge">
<title>attn_block_0_12_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M183243,-393.77C183243,-369.07 183243,-328 183243,-328 183243,-328 186104.86,-328 186104.86,-328"/>
<polygon fill="black" stroke="black" points="186104.86,-331.5 186114.86,-328 186104.86,-324.5 186104.86,-331.5"/>
</g>
<!-- kv_cache_0_12_24 -->
<g id="node301" class="node">
<title>kv_cache_0_12_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="183609.39,-550 182781.57,-550 182568.61,-514 183396.43,-514 183609.39,-550"/>
<text text-anchor="middle" x="183089" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_12_24&#45;&gt;attn_block_0_12_24 -->
<g id="edge281" class="edge">
<title>kv_cache_0_12_24&#45;&gt;attn_block_0_12_24</title>
<path fill="none" stroke="black" d="M183210.22,-513.77C183210.22,-513.77 183210.22,-440 183210.22,-440"/>
<polygon fill="black" stroke="black" points="183213.72,-440 183210.22,-430 183206.72,-440 183213.72,-440"/>
</g>
<!-- attn_block_0_13_24 -->
<g id="node302" class="node">
<title>attn_block_0_13_24</title>
<polygon fill="lightgreen" stroke="black" points="182627,-430 181763,-430 181763,-394 182627,-394 182627,-430"/>
<text text-anchor="middle" x="182195" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Block: 14/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_13_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge285" class="edge">
<title>attn_block_0_13_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M182195,-393.76C182195,-368.52 182195,-326 182195,-326 182195,-326 186045.78,-326 186045.78,-326"/>
<polygon fill="black" stroke="black" points="186045.78,-329.5 186055.78,-326 186045.78,-322.5 186045.78,-329.5"/>
</g>
<!-- kv_cache_0_13_24 -->
<g id="node303" class="node">
<title>kv_cache_0_13_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="182550.39,-550 181722.57,-550 181509.61,-514 182337.43,-514 182550.39,-550"/>
<text text-anchor="middle" x="182030" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_13_24&#45;&gt;attn_block_0_13_24 -->
<g id="edge284" class="edge">
<title>kv_cache_0_13_24&#45;&gt;attn_block_0_13_24</title>
<path fill="none" stroke="black" d="M182156.72,-513.77C182156.72,-513.77 182156.72,-440 182156.72,-440"/>
<polygon fill="black" stroke="black" points="182160.22,-440 182156.72,-430 182153.22,-440 182160.22,-440"/>
</g>
<!-- attn_block_0_14_24 -->
<g id="node304" class="node">
<title>attn_block_0_14_24</title>
<polygon fill="lightgreen" stroke="black" points="181574,-430 180710,-430 180710,-394 181574,-394 181574,-430"/>
<text text-anchor="middle" x="181142" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Block: 15/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_14_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge288" class="edge">
<title>attn_block_0_14_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M181142,-393.77C181142,-367.99 181142,-324 181142,-324 181142,-324 185987.06,-324 185987.06,-324"/>
<polygon fill="black" stroke="black" points="185987.06,-327.5 185997.06,-324 185987.06,-320.5 185987.06,-327.5"/>
</g>
<!-- kv_cache_0_14_24 -->
<g id="node305" class="node">
<title>kv_cache_0_14_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="181491.39,-550 180663.57,-550 180450.61,-514 181278.43,-514 181491.39,-550"/>
<text text-anchor="middle" x="180971" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_14_24&#45;&gt;attn_block_0_14_24 -->
<g id="edge287" class="edge">
<title>kv_cache_0_14_24&#45;&gt;attn_block_0_14_24</title>
<path fill="none" stroke="black" d="M181100.72,-513.77C181100.72,-513.77 181100.72,-440 181100.72,-440"/>
<polygon fill="black" stroke="black" points="181104.22,-440 181100.72,-430 181097.22,-440 181104.22,-440"/>
</g>
<!-- attn_block_0_15_24 -->
<g id="node306" class="node">
<title>attn_block_0_15_24</title>
<polygon fill="lightgreen" stroke="black" points="180518,-430 179654,-430 179654,-394 180518,-394 180518,-430"/>
<text text-anchor="middle" x="180086" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Block: 16/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_15_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge291" class="edge">
<title>attn_block_0_15_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M180086,-393.58C180086,-366.99 180086,-321 180086,-321 180086,-321 185898.89,-321 185898.89,-321"/>
<polygon fill="black" stroke="black" points="185898.89,-324.5 185908.89,-321 185898.89,-317.5 185898.89,-324.5"/>
</g>
<!-- kv_cache_0_15_24 -->
<g id="node307" class="node">
<title>kv_cache_0_15_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="180432.39,-550 179604.57,-550 179391.61,-514 180219.43,-514 180432.39,-550"/>
<text text-anchor="middle" x="179912" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_15_24&#45;&gt;attn_block_0_15_24 -->
<g id="edge290" class="edge">
<title>kv_cache_0_15_24&#45;&gt;attn_block_0_15_24</title>
<path fill="none" stroke="black" d="M180043.22,-513.77C180043.22,-513.77 180043.22,-440 180043.22,-440"/>
<polygon fill="black" stroke="black" points="180046.72,-440 180043.22,-430 180039.72,-440 180046.72,-440"/>
</g>
<!-- attn_block_0_16_24 -->
<g id="node308" class="node">
<title>attn_block_0_16_24</title>
<polygon fill="lightgreen" stroke="black" points="179460,-430 178596,-430 178596,-394 179460,-394 179460,-430"/>
<text text-anchor="middle" x="179028" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_16&lt;br/&gt;Block: 17/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_16_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge294" class="edge">
<title>attn_block_0_16_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M179028,-393.63C179028,-366.52 179028,-319 179028,-319 179028,-319 185840.05,-319 185840.05,-319"/>
<polygon fill="black" stroke="black" points="185840.05,-322.5 185850.05,-319 185840.05,-315.5 185840.05,-322.5"/>
</g>
<!-- kv_cache_0_16_24 -->
<g id="node309" class="node">
<title>kv_cache_0_16_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="179373.39,-550 178545.57,-550 178332.61,-514 179160.43,-514 179373.39,-550"/>
<text text-anchor="middle" x="178853" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_16&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_16_24&#45;&gt;attn_block_0_16_24 -->
<g id="edge293" class="edge">
<title>kv_cache_0_16_24&#45;&gt;attn_block_0_16_24</title>
<path fill="none" stroke="black" d="M178984.72,-513.77C178984.72,-513.77 178984.72,-440 178984.72,-440"/>
<polygon fill="black" stroke="black" points="178988.22,-440 178984.72,-430 178981.22,-440 178988.22,-440"/>
</g>
<!-- attn_block_0_17_24 -->
<g id="node310" class="node">
<title>attn_block_0_17_24</title>
<polygon fill="lightgreen" stroke="black" points="178402,-430 177538,-430 177538,-394 178402,-394 178402,-430"/>
<text text-anchor="middle" x="177970" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_17&lt;br/&gt;Block: 18/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_17_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge297" class="edge">
<title>attn_block_0_17_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M177970,-393.68C177970,-366.08 177970,-317 177970,-317 177970,-317 185781.3,-317 185781.3,-317"/>
<polygon fill="black" stroke="black" points="185781.3,-320.5 185791.3,-317 185781.3,-313.5 185781.3,-320.5"/>
</g>
<!-- kv_cache_0_17_24 -->
<g id="node311" class="node">
<title>kv_cache_0_17_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="178314.39,-550 177486.57,-550 177273.61,-514 178101.43,-514 178314.39,-550"/>
<text text-anchor="middle" x="177794" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_17&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_17_24&#45;&gt;attn_block_0_17_24 -->
<g id="edge296" class="edge">
<title>kv_cache_0_17_24&#45;&gt;attn_block_0_17_24</title>
<path fill="none" stroke="black" d="M177926.22,-513.77C177926.22,-513.77 177926.22,-440 177926.22,-440"/>
<polygon fill="black" stroke="black" points="177929.72,-440 177926.22,-430 177922.72,-440 177929.72,-440"/>
</g>
<!-- attn_block_0_18_24 -->
<g id="node312" class="node">
<title>attn_block_0_18_24</title>
<polygon fill="lightgreen" stroke="black" points="202316,-430 201452,-430 201452,-394 202316,-394 202316,-430"/>
<text text-anchor="middle" x="201884" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_18&lt;br/&gt;Block: 19/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_18_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge300" class="edge">
<title>attn_block_0_18_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M201884,-393.94C201884,-361.79 201884,-298 201884,-298 201884,-298 186301.42,-298 186301.42,-298"/>
<polygon fill="black" stroke="black" points="186301.42,-294.5 186291.42,-298 186301.42,-301.5 186301.42,-294.5"/>
</g>
<!-- kv_cache_0_18_24 -->
<g id="node313" class="node">
<title>kv_cache_0_18_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="202582.39,-550 201754.57,-550 201541.61,-514 202369.43,-514 202582.39,-550"/>
<text text-anchor="middle" x="202062" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_18&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_18_24&#45;&gt;attn_block_0_18_24 -->
<g id="edge299" class="edge">
<title>kv_cache_0_18_24&#45;&gt;attn_block_0_18_24</title>
<path fill="none" stroke="black" d="M201928.78,-513.77C201928.78,-513.77 201928.78,-440 201928.78,-440"/>
<polygon fill="black" stroke="black" points="201932.28,-440 201928.78,-430 201925.28,-440 201932.28,-440"/>
</g>
<!-- attn_block_0_19_24 -->
<g id="node314" class="node">
<title>attn_block_0_19_24</title>
<polygon fill="lightgreen" stroke="black" points="201257,-430 200393,-430 200393,-394 201257,-394 201257,-430"/>
<text text-anchor="middle" x="200825" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_19&lt;br/&gt;Block: 20/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_19_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge303" class="edge">
<title>attn_block_0_19_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M200825,-393.51C200825,-361.69 200825,-300 200825,-300 200825,-300 186360.29,-300 186360.29,-300"/>
<polygon fill="black" stroke="black" points="186360.29,-296.5 186350.29,-300 186360.29,-303.5 186360.29,-296.5"/>
</g>
<!-- kv_cache_0_19_24 -->
<g id="node315" class="node">
<title>kv_cache_0_19_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="201523.39,-550 200695.57,-550 200482.61,-514 201310.43,-514 201523.39,-550"/>
<text text-anchor="middle" x="201003" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_19&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_19_24&#45;&gt;attn_block_0_19_24 -->
<g id="edge302" class="edge">
<title>kv_cache_0_19_24&#45;&gt;attn_block_0_19_24</title>
<path fill="none" stroke="black" d="M200869.78,-513.77C200869.78,-513.77 200869.78,-440 200869.78,-440"/>
<polygon fill="black" stroke="black" points="200873.28,-440 200869.78,-430 200866.28,-440 200873.28,-440"/>
</g>
<!-- attn_block_0_20_24 -->
<g id="node316" class="node">
<title>attn_block_0_20_24</title>
<polygon fill="lightgreen" stroke="black" points="200198,-430 199334,-430 199334,-394 200198,-394 200198,-430"/>
<text text-anchor="middle" x="199766" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_20&lt;br/&gt;Block: 21/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_20_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge306" class="edge">
<title>attn_block_0_20_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M199766,-393.67C199766,-362.14 199766,-301 199766,-301 199766,-301 186389.77,-301 186389.77,-301"/>
<polygon fill="black" stroke="black" points="186389.77,-297.5 186379.77,-301 186389.77,-304.5 186389.77,-297.5"/>
</g>
<!-- kv_cache_0_20_24 -->
<g id="node317" class="node">
<title>kv_cache_0_20_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="200464.39,-550 199636.57,-550 199423.61,-514 200251.43,-514 200464.39,-550"/>
<text text-anchor="middle" x="199944" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_20&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_20_24&#45;&gt;attn_block_0_20_24 -->
<g id="edge305" class="edge">
<title>kv_cache_0_20_24&#45;&gt;attn_block_0_20_24</title>
<path fill="none" stroke="black" d="M199810.78,-513.77C199810.78,-513.77 199810.78,-440 199810.78,-440"/>
<polygon fill="black" stroke="black" points="199814.28,-440 199810.78,-430 199807.28,-440 199814.28,-440"/>
</g>
<!-- attn_block_0_21_24 -->
<g id="node318" class="node">
<title>attn_block_0_21_24</title>
<polygon fill="lightgreen" stroke="black" points="199139,-430 198275,-430 198275,-394 199139,-394 199139,-430"/>
<text text-anchor="middle" x="198707" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_21&lt;br/&gt;Block: 22/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_21_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge309" class="edge">
<title>attn_block_0_21_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M198707,-393.51C198707,-362.41 198707,-303 198707,-303 198707,-303 186448.52,-303 186448.52,-303"/>
<polygon fill="black" stroke="black" points="186448.52,-299.5 186438.52,-303 186448.52,-306.5 186448.52,-299.5"/>
</g>
<!-- kv_cache_0_21_24 -->
<g id="node319" class="node">
<title>kv_cache_0_21_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="199405.39,-550 198577.57,-550 198364.61,-514 199192.43,-514 199405.39,-550"/>
<text text-anchor="middle" x="198885" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_21&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_21_24&#45;&gt;attn_block_0_21_24 -->
<g id="edge308" class="edge">
<title>kv_cache_0_21_24&#45;&gt;attn_block_0_21_24</title>
<path fill="none" stroke="black" d="M198751.78,-513.77C198751.78,-513.77 198751.78,-440 198751.78,-440"/>
<polygon fill="black" stroke="black" points="198755.28,-440 198751.78,-430 198748.28,-440 198755.28,-440"/>
</g>
<!-- attn_block_0_22_24 -->
<g id="node320" class="node">
<title>attn_block_0_22_24</title>
<polygon fill="lightgreen" stroke="black" points="198080,-430 197216,-430 197216,-394 198080,-394 198080,-430"/>
<text text-anchor="middle" x="197648" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_22&lt;br/&gt;Block: 23/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_22_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge312" class="edge">
<title>attn_block_0_22_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M197648,-393.68C197648,-362.87 197648,-304 197648,-304 197648,-304 186478.12,-304 186478.12,-304"/>
<polygon fill="black" stroke="black" points="186478.12,-300.5 186468.12,-304 186478.12,-307.5 186478.12,-300.5"/>
</g>
<!-- kv_cache_0_22_24 -->
<g id="node321" class="node">
<title>kv_cache_0_22_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="198346.39,-550 197518.57,-550 197305.61,-514 198133.43,-514 198346.39,-550"/>
<text text-anchor="middle" x="197826" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_22&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_22_24&#45;&gt;attn_block_0_22_24 -->
<g id="edge311" class="edge">
<title>kv_cache_0_22_24&#45;&gt;attn_block_0_22_24</title>
<path fill="none" stroke="black" d="M197692.78,-513.77C197692.78,-513.77 197692.78,-440 197692.78,-440"/>
<polygon fill="black" stroke="black" points="197696.28,-440 197692.78,-430 197689.28,-440 197696.28,-440"/>
</g>
<!-- attn_block_0_23_24 -->
<g id="node322" class="node">
<title>attn_block_0_23_24</title>
<polygon fill="lightgreen" stroke="black" points="197021,-430 196157,-430 196157,-394 197021,-394 197021,-430"/>
<text text-anchor="middle" x="196589" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_23&lt;br/&gt;Block: 24/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_0_23_24&#45;&gt;hier_reduce_0_24 -->
<g id="edge315" class="edge">
<title>attn_block_0_23_24&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M196589,-393.54C196589,-363.17 196589,-306 196589,-306 196589,-306 186537,-306 186537,-306"/>
<polygon fill="black" stroke="black" points="186537,-302.5 186527,-306 186537,-309.5 186537,-302.5"/>
</g>
<!-- kv_cache_0_23_24 -->
<g id="node323" class="node">
<title>kv_cache_0_23_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="197287.39,-550 196459.57,-550 196246.61,-514 197074.43,-514 197287.39,-550"/>
<text text-anchor="middle" x="196767" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_23&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_0_23_24&#45;&gt;attn_block_0_23_24 -->
<g id="edge314" class="edge">
<title>kv_cache_0_23_24&#45;&gt;attn_block_0_23_24</title>
<path fill="none" stroke="black" d="M196633.78,-513.77C196633.78,-513.77 196633.78,-440 196633.78,-440"/>
<polygon fill="black" stroke="black" points="196637.28,-440 196633.78,-430 196630.28,-440 196637.28,-440"/>
</g>
<!-- attn_block_1_0_24 -->
<g id="node324" class="node">
<title>attn_block_1_0_24</title>
<polygon fill="lightgreen" stroke="black" points="221293,-430 220439,-430 220439,-394 221293,-394 221293,-430"/>
<text text-anchor="middle" x="220866" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- hier_reduce_1_24 -->
<g id="node601" class="node">
<title>hier_reduce_1_24</title>
<polygon fill="lightgray" stroke="black" points="211594,-333 211064.57,-315 211594,-297 212123.43,-315 211594,-333"/>
<text text-anchor="middle" x="211594" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 24 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_1_0_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge583" class="edge">
<title>attn_block_1_0_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M220866,-393.76C220866,-365.66 220866,-315 220866,-315 220866,-315 212133.7,-315 212133.7,-315"/>
<polygon fill="black" stroke="black" points="212133.7,-311.5 212123.7,-315 212133.7,-318.5 212133.7,-311.5"/>
</g>
<!-- kv_cache_1_0_24 -->
<g id="node325" class="node">
<title>kv_cache_1_0_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="221560.26,-550 220739.01,-550 220527.74,-514 221348.99,-514 221560.26,-550"/>
<text text-anchor="middle" x="221044" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_0_24&#45;&gt;attn_block_1_0_24 -->
<g id="edge582" class="edge">
<title>kv_cache_1_0_24&#45;&gt;attn_block_1_0_24</title>
<path fill="none" stroke="black" d="M220910.44,-513.77C220910.44,-513.77 220910.44,-440 220910.44,-440"/>
<polygon fill="black" stroke="black" points="220913.94,-440 220910.44,-430 220906.94,-440 220913.94,-440"/>
</g>
<!-- attn_block_1_1_24 -->
<g id="node326" class="node">
<title>attn_block_1_1_24</title>
<polygon fill="lightgreen" stroke="black" points="220243,-430 219389,-430 219389,-394 220243,-394 220243,-430"/>
<text text-anchor="middle" x="219816" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_1_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge586" class="edge">
<title>attn_block_1_1_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M219816,-393.68C219816,-366.08 219816,-317 219816,-317 219816,-317 212074.83,-317 212074.83,-317"/>
<polygon fill="black" stroke="black" points="212074.83,-313.5 212064.83,-317 212074.83,-320.5 212074.83,-313.5"/>
</g>
<!-- kv_cache_1_1_24 -->
<g id="node327" class="node">
<title>kv_cache_1_1_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="220510.26,-550 219689.01,-550 219477.74,-514 220298.99,-514 220510.26,-550"/>
<text text-anchor="middle" x="219994" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_1_24&#45;&gt;attn_block_1_1_24 -->
<g id="edge585" class="edge">
<title>kv_cache_1_1_24&#45;&gt;attn_block_1_1_24</title>
<path fill="none" stroke="black" d="M219860.44,-513.77C219860.44,-513.77 219860.44,-440 219860.44,-440"/>
<polygon fill="black" stroke="black" points="219863.94,-440 219860.44,-430 219856.94,-440 219863.94,-440"/>
</g>
<!-- attn_block_1_2_24 -->
<g id="node328" class="node">
<title>attn_block_1_2_24</title>
<polygon fill="lightgreen" stroke="black" points="219194,-430 218340,-430 218340,-394 219194,-394 219194,-430"/>
<text text-anchor="middle" x="218767" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_2_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge589" class="edge">
<title>attn_block_1_2_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M218767,-393.63C218767,-366.52 218767,-319 218767,-319 218767,-319 212016.07,-319 212016.07,-319"/>
<polygon fill="black" stroke="black" points="212016.07,-315.5 212006.07,-319 212016.07,-322.5 212016.07,-315.5"/>
</g>
<!-- kv_cache_1_2_24 -->
<g id="node329" class="node">
<title>kv_cache_1_2_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="219460.26,-550 218639.01,-550 218427.74,-514 219248.99,-514 219460.26,-550"/>
<text text-anchor="middle" x="218944" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_2_24&#45;&gt;attn_block_1_2_24 -->
<g id="edge588" class="edge">
<title>kv_cache_1_2_24&#45;&gt;attn_block_1_2_24</title>
<path fill="none" stroke="black" d="M218810.94,-513.77C218810.94,-513.77 218810.94,-440 218810.94,-440"/>
<polygon fill="black" stroke="black" points="218814.44,-440 218810.94,-430 218807.44,-440 218814.44,-440"/>
</g>
<!-- attn_block_1_3_24 -->
<g id="node330" class="node">
<title>attn_block_1_3_24</title>
<polygon fill="lightgreen" stroke="black" points="218145,-430 217291,-430 217291,-394 218145,-394 218145,-430"/>
<text text-anchor="middle" x="217718" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_3_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge592" class="edge">
<title>attn_block_1_3_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M217718,-393.58C217718,-366.99 217718,-321 217718,-321 217718,-321 211957.2,-321 211957.2,-321"/>
<polygon fill="black" stroke="black" points="211957.2,-317.5 211947.2,-321 211957.2,-324.5 211957.2,-317.5"/>
</g>
<!-- kv_cache_1_3_24 -->
<g id="node331" class="node">
<title>kv_cache_1_3_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="218410.26,-550 217589.01,-550 217377.74,-514 218198.99,-514 218410.26,-550"/>
<text text-anchor="middle" x="217894" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_3_24&#45;&gt;attn_block_1_3_24 -->
<g id="edge591" class="edge">
<title>kv_cache_1_3_24&#45;&gt;attn_block_1_3_24</title>
<path fill="none" stroke="black" d="M217761.44,-513.77C217761.44,-513.77 217761.44,-440 217761.44,-440"/>
<polygon fill="black" stroke="black" points="217764.94,-440 217761.44,-430 217757.94,-440 217764.94,-440"/>
</g>
<!-- attn_block_1_4_24 -->
<g id="node332" class="node">
<title>attn_block_1_4_24</title>
<polygon fill="lightgreen" stroke="black" points="217098,-430 216244,-430 216244,-394 217098,-394 217098,-430"/>
<text text-anchor="middle" x="216671" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_4_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge595" class="edge">
<title>attn_block_1_4_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M216671,-393.77C216671,-367.99 216671,-324 216671,-324 216671,-324 211868.93,-324 211868.93,-324"/>
<polygon fill="black" stroke="black" points="211868.93,-320.5 211858.93,-324 211868.93,-327.5 211868.93,-320.5"/>
</g>
<!-- kv_cache_1_4_24 -->
<g id="node333" class="node">
<title>kv_cache_1_4_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="217360.26,-550 216539.01,-550 216327.74,-514 217148.99,-514 217360.26,-550"/>
<text text-anchor="middle" x="216844" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_4_24&#45;&gt;attn_block_1_4_24 -->
<g id="edge594" class="edge">
<title>kv_cache_1_4_24&#45;&gt;attn_block_1_4_24</title>
<path fill="none" stroke="black" d="M216712.94,-513.77C216712.94,-513.77 216712.94,-440 216712.94,-440"/>
<polygon fill="black" stroke="black" points="216716.44,-440 216712.94,-430 216709.44,-440 216716.44,-440"/>
</g>
<!-- attn_block_1_5_24 -->
<g id="node334" class="node">
<title>attn_block_1_5_24</title>
<polygon fill="lightgreen" stroke="black" points="216054,-430 215200,-430 215200,-394 216054,-394 216054,-430"/>
<text text-anchor="middle" x="215627" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_5_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge598" class="edge">
<title>attn_block_1_5_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M215627,-393.76C215627,-368.52 215627,-326 215627,-326 215627,-326 211810.24,-326 211810.24,-326"/>
<polygon fill="black" stroke="black" points="211810.24,-322.5 211800.24,-326 211810.24,-329.5 211810.24,-322.5"/>
</g>
<!-- kv_cache_1_5_24 -->
<g id="node335" class="node">
<title>kv_cache_1_5_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="216310.26,-550 215489.01,-550 215277.74,-514 216098.99,-514 216310.26,-550"/>
<text text-anchor="middle" x="215794" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_5_24&#45;&gt;attn_block_1_5_24 -->
<g id="edge597" class="edge">
<title>kv_cache_1_5_24&#45;&gt;attn_block_1_5_24</title>
<path fill="none" stroke="black" d="M215665.94,-513.77C215665.94,-513.77 215665.94,-440 215665.94,-440"/>
<polygon fill="black" stroke="black" points="215669.44,-440 215665.94,-430 215662.44,-440 215669.44,-440"/>
</g>
<!-- attn_block_1_6_24 -->
<g id="node336" class="node">
<title>attn_block_1_6_24</title>
<polygon fill="lightgreen" stroke="black" points="215015,-430 214161,-430 214161,-394 215015,-394 215015,-430"/>
<text text-anchor="middle" x="214588" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_6_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge601" class="edge">
<title>attn_block_1_6_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M214588,-393.77C214588,-369.07 214588,-328 214588,-328 214588,-328 211751.2,-328 211751.2,-328"/>
<polygon fill="black" stroke="black" points="211751.2,-324.5 211741.2,-328 211751.2,-331.5 211751.2,-324.5"/>
</g>
<!-- kv_cache_1_6_24 -->
<g id="node337" class="node">
<title>kv_cache_1_6_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="215260.26,-550 214439.01,-550 214227.74,-514 215048.99,-514 215260.26,-550"/>
<text text-anchor="middle" x="214744" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_6_24&#45;&gt;attn_block_1_6_24 -->
<g id="edge600" class="edge">
<title>kv_cache_1_6_24&#45;&gt;attn_block_1_6_24</title>
<path fill="none" stroke="black" d="M214621.44,-513.77C214621.44,-513.77 214621.44,-440 214621.44,-440"/>
<polygon fill="black" stroke="black" points="214624.94,-440 214621.44,-430 214617.94,-440 214624.94,-440"/>
</g>
<!-- attn_block_1_7_24 -->
<g id="node338" class="node">
<title>attn_block_1_7_24</title>
<polygon fill="lightgreen" stroke="black" points="213988,-430 213134,-430 213134,-394 213988,-394 213988,-430"/>
<text text-anchor="middle" x="213561" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_7_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge604" class="edge">
<title>attn_block_1_7_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M213561,-393.8C213561,-369.64 213561,-330 213561,-330 213561,-330 211692.34,-330 211692.34,-330"/>
<polygon fill="black" stroke="black" points="211692.34,-326.5 211682.34,-330 211692.34,-333.5 211692.34,-326.5"/>
</g>
<!-- kv_cache_1_7_24 -->
<g id="node339" class="node">
<title>kv_cache_1_7_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="214210.26,-550 213389.01,-550 213177.74,-514 213998.99,-514 214210.26,-550"/>
<text text-anchor="middle" x="213694" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_7_24&#45;&gt;attn_block_1_7_24 -->
<g id="edge603" class="edge">
<title>kv_cache_1_7_24&#45;&gt;attn_block_1_7_24</title>
<path fill="none" stroke="black" d="M213582.94,-513.77C213582.94,-513.77 213582.94,-440 213582.94,-440"/>
<polygon fill="black" stroke="black" points="213586.44,-440 213582.94,-430 213579.44,-440 213586.44,-440"/>
</g>
<!-- attn_block_1_8_24 -->
<g id="node340" class="node">
<title>attn_block_1_8_24</title>
<polygon fill="lightgreen" stroke="black" points="212983,-430 212129,-430 212129,-394 212983,-394 212983,-430"/>
<text text-anchor="middle" x="212556" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Block: 9/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_8_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge607" class="edge">
<title>attn_block_1_8_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M212128.55,-412C212120.99,-412 212116.8,-412 212116.8,-412 212116.8,-412 212116.8,-325.28 212116.8,-325.28"/>
<polygon fill="black" stroke="black" points="212120.3,-325.28 212116.8,-315.28 212113.3,-325.28 212120.3,-325.28"/>
</g>
<!-- kv_cache_1_8_24 -->
<g id="node341" class="node">
<title>kv_cache_1_8_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="213160.26,-550 212339.01,-550 212127.74,-514 212948.99,-514 213160.26,-550"/>
<text text-anchor="middle" x="212644" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_8_24&#45;&gt;attn_block_1_8_24 -->
<g id="edge606" class="edge">
<title>kv_cache_1_8_24&#45;&gt;attn_block_1_8_24</title>
<path fill="none" stroke="black" d="M212556,-513.77C212556,-513.77 212556,-440 212556,-440"/>
<polygon fill="black" stroke="black" points="212559.5,-440 212556,-430 212552.5,-440 212559.5,-440"/>
</g>
<!-- attn_block_1_9_24 -->
<g id="node342" class="node">
<title>attn_block_1_9_24</title>
<polygon fill="lightgreen" stroke="black" points="212023.5,-430 211164.5,-430 211164.5,-394 212023.5,-394 212023.5,-430"/>
<text text-anchor="middle" x="211594" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Block: 10/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_9_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge610" class="edge">
<title>attn_block_1_9_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M211594,-393.76C211594,-393.76 211594,-343.16 211594,-343.16"/>
<polygon fill="black" stroke="black" points="211597.5,-343.16 211594,-333.16 211590.5,-343.16 211597.5,-343.16"/>
</g>
<!-- kv_cache_1_9_24 -->
<g id="node343" class="node">
<title>kv_cache_1_9_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="212110.26,-550 211289.01,-550 211077.74,-514 211898.99,-514 212110.26,-550"/>
<text text-anchor="middle" x="211594" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_9_24&#45;&gt;attn_block_1_9_24 -->
<g id="edge609" class="edge">
<title>kv_cache_1_9_24&#45;&gt;attn_block_1_9_24</title>
<path fill="none" stroke="black" d="M211594,-513.77C211594,-513.77 211594,-440 211594,-440"/>
<polygon fill="black" stroke="black" points="211597.5,-440 211594,-430 211590.5,-440 211597.5,-440"/>
</g>
<!-- attn_block_1_10_24 -->
<g id="node344" class="node">
<title>attn_block_1_10_24</title>
<polygon fill="lightgreen" stroke="black" points="211058,-430 210194,-430 210194,-394 211058,-394 211058,-430"/>
<text text-anchor="middle" x="210626" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Block: 11/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_10_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge613" class="edge">
<title>attn_block_1_10_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M211058.03,-412C211063.47,-412 211066.44,-412 211066.44,-412 211066.44,-412 211066.44,-325.07 211066.44,-325.07"/>
<polygon fill="black" stroke="black" points="211069.94,-325.07 211066.44,-315.07 211062.94,-325.07 211069.94,-325.07"/>
</g>
<!-- kv_cache_1_10_24 -->
<g id="node345" class="node">
<title>kv_cache_1_10_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="211059.39,-550 210231.57,-550 210018.61,-514 210846.43,-514 211059.39,-550"/>
<text text-anchor="middle" x="210539" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_10_24&#45;&gt;attn_block_1_10_24 -->
<g id="edge612" class="edge">
<title>kv_cache_1_10_24&#45;&gt;attn_block_1_10_24</title>
<path fill="none" stroke="black" d="M210626,-513.77C210626,-513.77 210626,-440 210626,-440"/>
<polygon fill="black" stroke="black" points="210629.5,-440 210626,-430 210622.5,-440 210629.5,-440"/>
</g>
<!-- attn_block_1_11_24 -->
<g id="node346" class="node">
<title>attn_block_1_11_24</title>
<polygon fill="lightgreen" stroke="black" points="210044,-430 209180,-430 209180,-394 210044,-394 210044,-430"/>
<text text-anchor="middle" x="209612" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Block: 12/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_11_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge616" class="edge">
<title>attn_block_1_11_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M209612,-393.62C209612,-369.72 209612,-331 209612,-331 209612,-331 211524.95,-331 211524.95,-331"/>
<polygon fill="black" stroke="black" points="211524.95,-334.5 211534.95,-331 211524.95,-327.5 211524.95,-334.5"/>
</g>
<!-- kv_cache_1_11_24 -->
<g id="node347" class="node">
<title>kv_cache_1_11_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="210000.39,-550 209172.57,-550 208959.61,-514 209787.43,-514 210000.39,-550"/>
<text text-anchor="middle" x="209480" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_11_24&#45;&gt;attn_block_1_11_24 -->
<g id="edge615" class="edge">
<title>kv_cache_1_11_24&#45;&gt;attn_block_1_11_24</title>
<path fill="none" stroke="black" d="M209590.22,-513.77C209590.22,-513.77 209590.22,-440 209590.22,-440"/>
<polygon fill="black" stroke="black" points="209593.72,-440 209590.22,-430 209586.72,-440 209593.72,-440"/>
</g>
<!-- attn_block_1_12_24 -->
<g id="node348" class="node">
<title>attn_block_1_12_24</title>
<polygon fill="lightgreen" stroke="black" points="209074,-430 208210,-430 208210,-394 209074,-394 209074,-430"/>
<text text-anchor="middle" x="208642" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Block: 13/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_12_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge619" class="edge">
<title>attn_block_1_12_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M208642,-393.8C208642,-369.64 208642,-330 208642,-330 208642,-330 211495.65,-330 211495.65,-330"/>
<polygon fill="black" stroke="black" points="211495.65,-333.5 211505.65,-330 211495.65,-326.5 211495.65,-333.5"/>
</g>
<!-- kv_cache_1_12_24 -->
<g id="node349" class="node">
<title>kv_cache_1_12_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="208941.39,-550 208113.57,-550 207900.61,-514 208728.43,-514 208941.39,-550"/>
<text text-anchor="middle" x="208421" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_12_24&#45;&gt;attn_block_1_12_24 -->
<g id="edge618" class="edge">
<title>kv_cache_1_12_24&#45;&gt;attn_block_1_12_24</title>
<path fill="none" stroke="black" d="M208575.72,-513.77C208575.72,-513.77 208575.72,-440 208575.72,-440"/>
<polygon fill="black" stroke="black" points="208579.22,-440 208575.72,-430 208572.22,-440 208579.22,-440"/>
</g>
<!-- attn_block_1_13_24 -->
<g id="node350" class="node">
<title>attn_block_1_13_24</title>
<polygon fill="lightgreen" stroke="black" points="207993,-430 207129,-430 207129,-394 207993,-394 207993,-430"/>
<text text-anchor="middle" x="207561" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Block: 14/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_13_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge622" class="edge">
<title>attn_block_1_13_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M207561,-393.77C207561,-369.07 207561,-328 207561,-328 207561,-328 211436.88,-328 211436.88,-328"/>
<polygon fill="black" stroke="black" points="211436.88,-331.5 211446.88,-328 211436.88,-324.5 211436.88,-331.5"/>
</g>
<!-- kv_cache_1_13_24 -->
<g id="node351" class="node">
<title>kv_cache_1_13_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="207882.39,-550 207054.57,-550 206841.61,-514 207669.43,-514 207882.39,-550"/>
<text text-anchor="middle" x="207362" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_13_24&#45;&gt;attn_block_1_13_24 -->
<g id="edge621" class="edge">
<title>kv_cache_1_13_24&#45;&gt;attn_block_1_13_24</title>
<path fill="none" stroke="black" d="M207505.72,-513.77C207505.72,-513.77 207505.72,-440 207505.72,-440"/>
<polygon fill="black" stroke="black" points="207509.22,-440 207505.72,-430 207502.22,-440 207509.22,-440"/>
</g>
<!-- attn_block_1_14_24 -->
<g id="node352" class="node">
<title>attn_block_1_14_24</title>
<polygon fill="lightgreen" stroke="black" points="206923,-430 206059,-430 206059,-394 206923,-394 206923,-430"/>
<text text-anchor="middle" x="206491" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Block: 15/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_14_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge625" class="edge">
<title>attn_block_1_14_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M206491,-393.97C206491,-369.02 206491,-327 206491,-327 206491,-327 211407.23,-327 211407.23,-327"/>
<polygon fill="black" stroke="black" points="211407.23,-330.5 211417.23,-327 211407.23,-323.5 211407.23,-330.5"/>
</g>
<!-- kv_cache_1_14_24 -->
<g id="node353" class="node">
<title>kv_cache_1_14_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="206823.39,-550 205995.57,-550 205782.61,-514 206610.43,-514 206823.39,-550"/>
<text text-anchor="middle" x="206303" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_14_24&#45;&gt;attn_block_1_14_24 -->
<g id="edge624" class="edge">
<title>kv_cache_1_14_24&#45;&gt;attn_block_1_14_24</title>
<path fill="none" stroke="black" d="M206441.22,-513.77C206441.22,-513.77 206441.22,-440 206441.22,-440"/>
<polygon fill="black" stroke="black" points="206444.72,-440 206441.22,-430 206437.72,-440 206444.72,-440"/>
</g>
<!-- attn_block_1_15_24 -->
<g id="node354" class="node">
<title>attn_block_1_15_24</title>
<polygon fill="lightgreen" stroke="black" points="205858,-430 204994,-430 204994,-394 205858,-394 205858,-430"/>
<text text-anchor="middle" x="205426" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Block: 16/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_15_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge628" class="edge">
<title>attn_block_1_15_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M205426,-393.97C205426,-368.49 205426,-325 205426,-325 205426,-325 211348.33,-325 211348.33,-325"/>
<polygon fill="black" stroke="black" points="211348.33,-328.5 211358.33,-325 211348.33,-321.5 211348.33,-328.5"/>
</g>
<!-- kv_cache_1_15_24 -->
<g id="node355" class="node">
<title>kv_cache_1_15_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="205764.39,-550 204936.57,-550 204723.61,-514 205551.43,-514 205764.39,-550"/>
<text text-anchor="middle" x="205244" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_15_24&#45;&gt;attn_block_1_15_24 -->
<g id="edge627" class="edge">
<title>kv_cache_1_15_24&#45;&gt;attn_block_1_15_24</title>
<path fill="none" stroke="black" d="M205379.22,-513.77C205379.22,-513.77 205379.22,-440 205379.22,-440"/>
<polygon fill="black" stroke="black" points="205382.72,-440 205379.22,-430 205375.72,-440 205382.72,-440"/>
</g>
<!-- attn_block_1_16_24 -->
<g id="node356" class="node">
<title>attn_block_1_16_24</title>
<polygon fill="lightgreen" stroke="black" points="204796,-430 203932,-430 203932,-394 204796,-394 204796,-430"/>
<text text-anchor="middle" x="204364" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_16&lt;br/&gt;Block: 17/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_16_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge631" class="edge">
<title>attn_block_1_16_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M204364,-393.77C204364,-367.99 204364,-324 204364,-324 204364,-324 211319.18,-324 211319.18,-324"/>
<polygon fill="black" stroke="black" points="211319.18,-327.5 211329.18,-324 211319.18,-320.5 211319.18,-327.5"/>
</g>
<!-- kv_cache_1_16_24 -->
<g id="node357" class="node">
<title>kv_cache_1_16_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="204705.39,-550 203877.57,-550 203664.61,-514 204492.43,-514 204705.39,-550"/>
<text text-anchor="middle" x="204185" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_16&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_16_24&#45;&gt;attn_block_1_16_24 -->
<g id="edge630" class="edge">
<title>kv_cache_1_16_24&#45;&gt;attn_block_1_16_24</title>
<path fill="none" stroke="black" d="M204318.72,-513.77C204318.72,-513.77 204318.72,-440 204318.72,-440"/>
<polygon fill="black" stroke="black" points="204322.22,-440 204318.72,-430 204315.22,-440 204322.22,-440"/>
</g>
<!-- attn_block_1_17_24 -->
<g id="node358" class="node">
<title>attn_block_1_17_24</title>
<polygon fill="lightgreen" stroke="black" points="203736,-430 202872,-430 202872,-394 203736,-394 203736,-430"/>
<text text-anchor="middle" x="203304" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_17&lt;br/&gt;Block: 18/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_17_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge634" class="edge">
<title>attn_block_1_17_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M203304,-393.79C203304,-367.49 203304,-322 203304,-322 203304,-322 211260.3,-322 211260.3,-322"/>
<polygon fill="black" stroke="black" points="211260.3,-325.5 211270.3,-322 211260.3,-318.5 211260.3,-325.5"/>
</g>
<!-- kv_cache_1_17_24 -->
<g id="node359" class="node">
<title>kv_cache_1_17_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="203646.39,-550 202818.57,-550 202605.61,-514 203433.43,-514 203646.39,-550"/>
<text text-anchor="middle" x="203126" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_17&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_17_24&#45;&gt;attn_block_1_17_24 -->
<g id="edge633" class="edge">
<title>kv_cache_1_17_24&#45;&gt;attn_block_1_17_24</title>
<path fill="none" stroke="black" d="M203259.22,-513.77C203259.22,-513.77 203259.22,-440 203259.22,-440"/>
<polygon fill="black" stroke="black" points="203262.72,-440 203259.22,-430 203255.72,-440 203262.72,-440"/>
</g>
<!-- attn_block_1_18_24 -->
<g id="node360" class="node">
<title>attn_block_1_18_24</title>
<polygon fill="lightgreen" stroke="black" points="227648,-430 226784,-430 226784,-394 227648,-394 227648,-430"/>
<text text-anchor="middle" x="227216" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_18&lt;br/&gt;Block: 19/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_18_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge637" class="edge">
<title>attn_block_1_18_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M227216,-393.67C227216,-362.14 227216,-301 227216,-301 227216,-301 211721.87,-301 211721.87,-301"/>
<polygon fill="black" stroke="black" points="211721.87,-297.5 211711.87,-301 211721.87,-304.5 211721.87,-297.5"/>
</g>
<!-- kv_cache_1_18_24 -->
<g id="node361" class="node">
<title>kv_cache_1_18_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="227914.39,-550 227086.57,-550 226873.61,-514 227701.43,-514 227914.39,-550"/>
<text text-anchor="middle" x="227394" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_18&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_18_24&#45;&gt;attn_block_1_18_24 -->
<g id="edge636" class="edge">
<title>kv_cache_1_18_24&#45;&gt;attn_block_1_18_24</title>
<path fill="none" stroke="black" d="M227260.78,-513.77C227260.78,-513.77 227260.78,-440 227260.78,-440"/>
<polygon fill="black" stroke="black" points="227264.28,-440 227260.78,-430 227257.28,-440 227264.28,-440"/>
</g>
<!-- attn_block_1_19_24 -->
<g id="node362" class="node">
<title>attn_block_1_19_24</title>
<polygon fill="lightgreen" stroke="black" points="226589,-430 225725,-430 225725,-394 226589,-394 226589,-430"/>
<text text-anchor="middle" x="226157" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_19&lt;br/&gt;Block: 20/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_19_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge640" class="edge">
<title>attn_block_1_19_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M226157,-393.51C226157,-362.41 226157,-303 226157,-303 226157,-303 211780.6,-303 211780.6,-303"/>
<polygon fill="black" stroke="black" points="211780.6,-299.5 211770.6,-303 211780.6,-306.5 211780.6,-299.5"/>
</g>
<!-- kv_cache_1_19_24 -->
<g id="node363" class="node">
<title>kv_cache_1_19_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226855.39,-550 226027.57,-550 225814.61,-514 226642.43,-514 226855.39,-550"/>
<text text-anchor="middle" x="226335" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_19&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_19_24&#45;&gt;attn_block_1_19_24 -->
<g id="edge639" class="edge">
<title>kv_cache_1_19_24&#45;&gt;attn_block_1_19_24</title>
<path fill="none" stroke="black" d="M226201.78,-513.77C226201.78,-513.77 226201.78,-440 226201.78,-440"/>
<polygon fill="black" stroke="black" points="226205.28,-440 226201.78,-430 226198.28,-440 226205.28,-440"/>
</g>
<!-- attn_block_1_20_24 -->
<g id="node364" class="node">
<title>attn_block_1_20_24</title>
<polygon fill="lightgreen" stroke="black" points="225530,-430 224666,-430 224666,-394 225530,-394 225530,-430"/>
<text text-anchor="middle" x="225098" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_20&lt;br/&gt;Block: 21/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_20_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge643" class="edge">
<title>attn_block_1_20_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M225098,-393.54C225098,-363.17 225098,-306 225098,-306 225098,-306 211868.82,-306 211868.82,-306"/>
<polygon fill="black" stroke="black" points="211868.82,-302.5 211858.82,-306 211868.82,-309.5 211868.82,-302.5"/>
</g>
<!-- kv_cache_1_20_24 -->
<g id="node365" class="node">
<title>kv_cache_1_20_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="225796.39,-550 224968.57,-550 224755.61,-514 225583.43,-514 225796.39,-550"/>
<text text-anchor="middle" x="225276" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_20&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_20_24&#45;&gt;attn_block_1_20_24 -->
<g id="edge642" class="edge">
<title>kv_cache_1_20_24&#45;&gt;attn_block_1_20_24</title>
<path fill="none" stroke="black" d="M225142.78,-513.77C225142.78,-513.77 225142.78,-440 225142.78,-440"/>
<polygon fill="black" stroke="black" points="225146.28,-440 225142.78,-430 225139.28,-440 225146.28,-440"/>
</g>
<!-- attn_block_1_21_24 -->
<g id="node366" class="node">
<title>attn_block_1_21_24</title>
<polygon fill="lightgreen" stroke="black" points="224471,-430 223607,-430 223607,-394 224471,-394 224471,-430"/>
<text text-anchor="middle" x="224039" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_21&lt;br/&gt;Block: 22/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_21_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge646" class="edge">
<title>attn_block_1_21_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M224039,-393.88C224039,-364.09 224039,-308 224039,-308 224039,-308 211927.7,-308 211927.7,-308"/>
<polygon fill="black" stroke="black" points="211927.7,-304.5 211917.7,-308 211927.7,-311.5 211927.7,-304.5"/>
</g>
<!-- kv_cache_1_21_24 -->
<g id="node367" class="node">
<title>kv_cache_1_21_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="224737.39,-550 223909.57,-550 223696.61,-514 224524.43,-514 224737.39,-550"/>
<text text-anchor="middle" x="224217" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_21&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_21_24&#45;&gt;attn_block_1_21_24 -->
<g id="edge645" class="edge">
<title>kv_cache_1_21_24&#45;&gt;attn_block_1_21_24</title>
<path fill="none" stroke="black" d="M224083.78,-513.77C224083.78,-513.77 224083.78,-440 224083.78,-440"/>
<polygon fill="black" stroke="black" points="224087.28,-440 224083.78,-430 224080.28,-440 224087.28,-440"/>
</g>
<!-- attn_block_1_22_24 -->
<g id="node368" class="node">
<title>attn_block_1_22_24</title>
<polygon fill="lightgreen" stroke="black" points="223412,-430 222548,-430 222548,-394 223412,-394 223412,-430"/>
<text text-anchor="middle" x="222980" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_22&lt;br/&gt;Block: 23/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_22_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge649" class="edge">
<title>attn_block_1_22_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M222980,-393.76C222980,-364.43 222980,-310 222980,-310 222980,-310 211986.5,-310 211986.5,-310"/>
<polygon fill="black" stroke="black" points="211986.5,-306.5 211976.5,-310 211986.5,-313.5 211986.5,-306.5"/>
</g>
<!-- kv_cache_1_22_24 -->
<g id="node369" class="node">
<title>kv_cache_1_22_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="223678.39,-550 222850.57,-550 222637.61,-514 223465.43,-514 223678.39,-550"/>
<text text-anchor="middle" x="223158" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_22&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_22_24&#45;&gt;attn_block_1_22_24 -->
<g id="edge648" class="edge">
<title>kv_cache_1_22_24&#45;&gt;attn_block_1_22_24</title>
<path fill="none" stroke="black" d="M223024.78,-513.77C223024.78,-513.77 223024.78,-440 223024.78,-440"/>
<polygon fill="black" stroke="black" points="223028.28,-440 223024.78,-430 223021.28,-440 223028.28,-440"/>
</g>
<!-- attn_block_1_23_24 -->
<g id="node370" class="node">
<title>attn_block_1_23_24</title>
<polygon fill="lightgreen" stroke="black" points="222353,-430 221489,-430 221489,-394 222353,-394 222353,-430"/>
<text text-anchor="middle" x="221921" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_23&lt;br/&gt;Block: 24/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_1_23_24&#45;&gt;hier_reduce_1_24 -->
<g id="edge652" class="edge">
<title>attn_block_1_23_24&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M221921,-393.66C221921,-364.79 221921,-312 221921,-312 221921,-312 212045.26,-312 212045.26,-312"/>
<polygon fill="black" stroke="black" points="212045.26,-308.5 212035.26,-312 212045.26,-315.5 212045.26,-308.5"/>
</g>
<!-- kv_cache_1_23_24 -->
<g id="node371" class="node">
<title>kv_cache_1_23_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="222619.39,-550 221791.57,-550 221578.61,-514 222406.43,-514 222619.39,-550"/>
<text text-anchor="middle" x="222099" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_23&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_1_23_24&#45;&gt;attn_block_1_23_24 -->
<g id="edge651" class="edge">
<title>kv_cache_1_23_24&#45;&gt;attn_block_1_23_24</title>
<path fill="none" stroke="black" d="M221965.78,-513.77C221965.78,-513.77 221965.78,-440 221965.78,-440"/>
<polygon fill="black" stroke="black" points="221969.28,-440 221965.78,-430 221962.28,-440 221969.28,-440"/>
</g>
<!-- attn_block_2_0_24 -->
<g id="node372" class="node">
<title>attn_block_2_0_24</title>
<polygon fill="lightgreen" stroke="black" points="145386,-430 144532,-430 144532,-394 145386,-394 145386,-430"/>
<text text-anchor="middle" x="144959" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- hier_reduce_2_24 -->
<g id="node604" class="node">
<title>hier_reduce_2_24</title>
<polygon fill="lightgray" stroke="black" points="143998,-333 143468.57,-315 143998,-297 144527.43,-315 143998,-333"/>
<text text-anchor="middle" x="143998" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 24 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_2_0_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge920" class="edge">
<title>attn_block_2_0_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M144531.63,-412C144524.65,-412 144520.8,-412 144520.8,-412 144520.8,-412 144520.8,-325.28 144520.8,-325.28"/>
<polygon fill="black" stroke="black" points="144524.3,-325.28 144520.8,-315.28 144517.3,-325.28 144524.3,-325.28"/>
</g>
<!-- kv_cache_2_0_24 -->
<g id="node373" class="node">
<title>kv_cache_2_0_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="145564.26,-550 144743.01,-550 144531.74,-514 145352.99,-514 145564.26,-550"/>
<text text-anchor="middle" x="145048" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_0_24&#45;&gt;attn_block_2_0_24 -->
<g id="edge919" class="edge">
<title>kv_cache_2_0_24&#45;&gt;attn_block_2_0_24</title>
<path fill="none" stroke="black" d="M144959,-513.77C144959,-513.77 144959,-440 144959,-440"/>
<polygon fill="black" stroke="black" points="144962.5,-440 144959,-430 144955.5,-440 144962.5,-440"/>
</g>
<!-- attn_block_2_1_24 -->
<g id="node374" class="node">
<title>attn_block_2_1_24</title>
<polygon fill="lightgreen" stroke="black" points="144425,-430 143571,-430 143571,-394 144425,-394 144425,-430"/>
<text text-anchor="middle" x="143998" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_1_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge923" class="edge">
<title>attn_block_2_1_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M143998,-393.76C143998,-393.76 143998,-343.16 143998,-343.16"/>
<polygon fill="black" stroke="black" points="144001.5,-343.16 143998,-333.16 143994.5,-343.16 144001.5,-343.16"/>
</g>
<!-- kv_cache_2_1_24 -->
<g id="node375" class="node">
<title>kv_cache_2_1_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="144514.26,-550 143693.01,-550 143481.74,-514 144302.99,-514 144514.26,-550"/>
<text text-anchor="middle" x="143998" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_1_24&#45;&gt;attn_block_2_1_24 -->
<g id="edge922" class="edge">
<title>kv_cache_2_1_24&#45;&gt;attn_block_2_1_24</title>
<path fill="none" stroke="black" d="M143998,-513.77C143998,-513.77 143998,-440 143998,-440"/>
<polygon fill="black" stroke="black" points="144001.5,-440 143998,-430 143994.5,-440 144001.5,-440"/>
</g>
<!-- attn_block_2_2_24 -->
<g id="node376" class="node">
<title>attn_block_2_2_24</title>
<polygon fill="lightgreen" stroke="black" points="143464,-430 142610,-430 142610,-394 143464,-394 143464,-430"/>
<text text-anchor="middle" x="143037" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_2_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge926" class="edge">
<title>attn_block_2_2_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M143464.32,-412C143468.98,-412 143471.5,-412 143471.5,-412 143471.5,-412 143471.5,-325.28 143471.5,-325.28"/>
<polygon fill="black" stroke="black" points="143475,-325.28 143471.5,-315.28 143468,-325.28 143475,-325.28"/>
</g>
<!-- kv_cache_2_2_24 -->
<g id="node377" class="node">
<title>kv_cache_2_2_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="143464.26,-550 142643.01,-550 142431.74,-514 143252.99,-514 143464.26,-550"/>
<text text-anchor="middle" x="142948" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_2_24&#45;&gt;attn_block_2_2_24 -->
<g id="edge925" class="edge">
<title>kv_cache_2_2_24&#45;&gt;attn_block_2_2_24</title>
<path fill="none" stroke="black" d="M143037,-513.77C143037,-513.77 143037,-440 143037,-440"/>
<polygon fill="black" stroke="black" points="143040.5,-440 143037,-430 143033.5,-440 143040.5,-440"/>
</g>
<!-- attn_block_2_3_24 -->
<g id="node378" class="node">
<title>attn_block_2_3_24</title>
<polygon fill="lightgreen" stroke="black" points="142525,-430 141671,-430 141671,-394 142525,-394 142525,-430"/>
<text text-anchor="middle" x="142098" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_3_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge929" class="edge">
<title>attn_block_2_3_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M142098,-393.8C142098,-369.64 142098,-330 142098,-330 142098,-330 143899.54,-330 143899.54,-330"/>
<polygon fill="black" stroke="black" points="143899.54,-333.5 143909.54,-330 143899.54,-326.5 143899.54,-333.5"/>
</g>
<!-- kv_cache_2_3_24 -->
<g id="node379" class="node">
<title>kv_cache_2_3_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="142414.26,-550 141593.01,-550 141381.74,-514 142202.99,-514 142414.26,-550"/>
<text text-anchor="middle" x="141898" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_3_24&#45;&gt;attn_block_2_3_24 -->
<g id="edge928" class="edge">
<title>kv_cache_2_3_24&#45;&gt;attn_block_2_3_24</title>
<path fill="none" stroke="black" d="M142042.56,-513.77C142042.56,-513.77 142042.56,-440 142042.56,-440"/>
<polygon fill="black" stroke="black" points="142046.06,-440 142042.56,-430 142039.06,-440 142046.06,-440"/>
</g>
<!-- attn_block_2_4_24 -->
<g id="node380" class="node">
<title>attn_block_2_4_24</title>
<polygon fill="lightgreen" stroke="black" points="141520,-430 140666,-430 140666,-394 141520,-394 141520,-430"/>
<text text-anchor="middle" x="141093" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_4_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge932" class="edge">
<title>attn_block_2_4_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M141093,-393.77C141093,-369.07 141093,-328 141093,-328 141093,-328 143840.7,-328 143840.7,-328"/>
<polygon fill="black" stroke="black" points="143840.7,-331.5 143850.7,-328 143840.7,-324.5 143840.7,-331.5"/>
</g>
<!-- kv_cache_2_4_24 -->
<g id="node381" class="node">
<title>kv_cache_2_4_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="141364.26,-550 140543.01,-550 140331.74,-514 141152.99,-514 141364.26,-550"/>
<text text-anchor="middle" x="140848" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_4_24&#45;&gt;attn_block_2_4_24 -->
<g id="edge931" class="edge">
<title>kv_cache_2_4_24&#45;&gt;attn_block_2_4_24</title>
<path fill="none" stroke="black" d="M141015.06,-513.77C141015.06,-513.77 141015.06,-440 141015.06,-440"/>
<polygon fill="black" stroke="black" points="141018.56,-440 141015.06,-430 141011.56,-440 141018.56,-440"/>
</g>
<!-- attn_block_2_5_24 -->
<g id="node382" class="node">
<title>attn_block_2_5_24</title>
<polygon fill="lightgreen" stroke="black" points="140381,-430 139527,-430 139527,-394 140381,-394 140381,-430"/>
<text text-anchor="middle" x="139954" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_5_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge935" class="edge">
<title>attn_block_2_5_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M139954,-393.76C139954,-368.52 139954,-326 139954,-326 139954,-326 143781.9,-326 143781.9,-326"/>
<polygon fill="black" stroke="black" points="143781.9,-329.5 143791.9,-326 143781.9,-322.5 143781.9,-329.5"/>
</g>
<!-- kv_cache_2_5_24 -->
<g id="node383" class="node">
<title>kv_cache_2_5_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="140314.26,-550 139493.01,-550 139281.74,-514 140102.99,-514 140314.26,-550"/>
<text text-anchor="middle" x="139798" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_5_24&#45;&gt;attn_block_2_5_24 -->
<g id="edge934" class="edge">
<title>kv_cache_2_5_24&#45;&gt;attn_block_2_5_24</title>
<path fill="none" stroke="black" d="M139920.56,-513.77C139920.56,-513.77 139920.56,-440 139920.56,-440"/>
<polygon fill="black" stroke="black" points="139924.06,-440 139920.56,-430 139917.06,-440 139924.06,-440"/>
</g>
<!-- attn_block_2_6_24 -->
<g id="node384" class="node">
<title>attn_block_2_6_24</title>
<polygon fill="lightgreen" stroke="black" points="139342,-430 138488,-430 138488,-394 139342,-394 139342,-430"/>
<text text-anchor="middle" x="138915" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_6_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge938" class="edge">
<title>attn_block_2_6_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M138915,-393.77C138915,-367.99 138915,-324 138915,-324 138915,-324 143723.21,-324 143723.21,-324"/>
<polygon fill="black" stroke="black" points="143723.21,-327.5 143733.21,-324 143723.21,-320.5 143723.21,-327.5"/>
</g>
<!-- kv_cache_2_6_24 -->
<g id="node385" class="node">
<title>kv_cache_2_6_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="139264.26,-550 138443.01,-550 138231.74,-514 139052.99,-514 139264.26,-550"/>
<text text-anchor="middle" x="138748" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_6_24&#45;&gt;attn_block_2_6_24 -->
<g id="edge937" class="edge">
<title>kv_cache_2_6_24&#45;&gt;attn_block_2_6_24</title>
<path fill="none" stroke="black" d="M138876.06,-513.77C138876.06,-513.77 138876.06,-440 138876.06,-440"/>
<polygon fill="black" stroke="black" points="138879.56,-440 138876.06,-430 138872.56,-440 138879.56,-440"/>
</g>
<!-- attn_block_2_7_24 -->
<g id="node386" class="node">
<title>attn_block_2_7_24</title>
<polygon fill="lightgreen" stroke="black" points="138381,-430 137527,-430 137527,-394 138381,-394 138381,-430"/>
<text text-anchor="middle" x="137954" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_7_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge941" class="edge">
<title>attn_block_2_7_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M137954,-393.79C137954,-367.49 137954,-322 137954,-322 137954,-322 143664.38,-322 143664.38,-322"/>
<polygon fill="black" stroke="black" points="143664.38,-325.5 143674.38,-322 143664.38,-318.5 143664.38,-325.5"/>
</g>
<!-- kv_cache_2_7_24 -->
<g id="node387" class="node">
<title>kv_cache_2_7_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="138214.26,-550 137393.01,-550 137181.74,-514 138002.99,-514 138214.26,-550"/>
<text text-anchor="middle" x="137698" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_7_24&#45;&gt;attn_block_2_7_24 -->
<g id="edge940" class="edge">
<title>kv_cache_2_7_24&#45;&gt;attn_block_2_7_24</title>
<path fill="none" stroke="black" d="M137870.56,-513.77C137870.56,-513.77 137870.56,-440 137870.56,-440"/>
<polygon fill="black" stroke="black" points="137874.06,-440 137870.56,-430 137867.06,-440 137874.06,-440"/>
</g>
<!-- attn_block_2_8_24 -->
<g id="node388" class="node">
<title>attn_block_2_8_24</title>
<polygon fill="lightgreen" stroke="black" points="137292,-430 136438,-430 136438,-394 137292,-394 137292,-430"/>
<text text-anchor="middle" x="136865" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Block: 9/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_8_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge944" class="edge">
<title>attn_block_2_8_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M136865,-393.82C136865,-367.01 136865,-320 136865,-320 136865,-320 143605.45,-320 143605.45,-320"/>
<polygon fill="black" stroke="black" points="143605.45,-323.5 143615.45,-320 143605.45,-316.5 143605.45,-323.5"/>
</g>
<!-- kv_cache_2_8_24 -->
<g id="node389" class="node">
<title>kv_cache_2_8_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="137164.26,-550 136343.01,-550 136131.74,-514 136952.99,-514 137164.26,-550"/>
<text text-anchor="middle" x="136648" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_8_24&#45;&gt;attn_block_2_8_24 -->
<g id="edge943" class="edge">
<title>kv_cache_2_8_24&#45;&gt;attn_block_2_8_24</title>
<path fill="none" stroke="black" d="M136801.06,-513.77C136801.06,-513.77 136801.06,-440 136801.06,-440"/>
<polygon fill="black" stroke="black" points="136804.56,-440 136801.06,-430 136797.56,-440 136804.56,-440"/>
</g>
<!-- attn_block_2_9_24 -->
<g id="node390" class="node">
<title>attn_block_2_9_24</title>
<polygon fill="lightgreen" stroke="black" points="136223.5,-430 135364.5,-430 135364.5,-394 136223.5,-394 136223.5,-430"/>
<text text-anchor="middle" x="135794" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Block: 10/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_9_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge947" class="edge">
<title>attn_block_2_9_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M135794,-393.88C135794,-366.56 135794,-318 135794,-318 135794,-318 143546.55,-318 143546.55,-318"/>
<polygon fill="black" stroke="black" points="143546.55,-321.5 143556.55,-318 143546.55,-314.5 143546.55,-321.5"/>
</g>
<!-- kv_cache_2_9_24 -->
<g id="node391" class="node">
<title>kv_cache_2_9_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="136114.26,-550 135293.01,-550 135081.74,-514 135902.99,-514 136114.26,-550"/>
<text text-anchor="middle" x="135598" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_9_24&#45;&gt;attn_block_2_9_24 -->
<g id="edge946" class="edge">
<title>kv_cache_2_9_24&#45;&gt;attn_block_2_9_24</title>
<path fill="none" stroke="black" d="M135739.31,-513.77C135739.31,-513.77 135739.31,-440 135739.31,-440"/>
<polygon fill="black" stroke="black" points="135742.81,-440 135739.31,-430 135735.81,-440 135742.81,-440"/>
</g>
<!-- attn_block_2_10_24 -->
<g id="node392" class="node">
<title>attn_block_2_10_24</title>
<polygon fill="lightgreen" stroke="black" points="135160,-430 134296,-430 134296,-394 135160,-394 135160,-430"/>
<text text-anchor="middle" x="134728" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Block: 11/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_10_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge950" class="edge">
<title>attn_block_2_10_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M135150.23,-393.94C135150.23,-366.13 135150.23,-316 135150.23,-316 135150.23,-316 143487.76,-316 143487.76,-316"/>
<polygon fill="black" stroke="black" points="143487.76,-319.5 143497.76,-316 143487.76,-312.5 143487.76,-319.5"/>
</g>
<!-- kv_cache_2_10_24 -->
<g id="node393" class="node">
<title>kv_cache_2_10_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="135063.39,-550 134235.57,-550 134022.61,-514 134850.43,-514 135063.39,-550"/>
<text text-anchor="middle" x="134543" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_10_24&#45;&gt;attn_block_2_10_24 -->
<g id="edge949" class="edge">
<title>kv_cache_2_10_24&#45;&gt;attn_block_2_10_24</title>
<path fill="none" stroke="black" d="M134679.72,-513.77C134679.72,-513.77 134679.72,-440 134679.72,-440"/>
<polygon fill="black" stroke="black" points="134683.22,-440 134679.72,-430 134676.22,-440 134683.22,-440"/>
</g>
<!-- attn_block_2_11_24 -->
<g id="node394" class="node">
<title>attn_block_2_11_24</title>
<polygon fill="lightgreen" stroke="black" points="134097,-430 133233,-430 133233,-394 134097,-394 134097,-430"/>
<text text-anchor="middle" x="133665" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Block: 12/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_11_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge953" class="edge">
<title>attn_block_2_11_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M134075.67,-393.84C134075.67,-371.65 134075.67,-337 134075.67,-337 134075.67,-337 143470.02,-337 143470.02,-337 143470.02,-337 143470.02,-325.06 143470.02,-325.06"/>
<polygon fill="black" stroke="black" points="143473.52,-325.06 143470.02,-315.06 143466.52,-325.06 143473.52,-325.06"/>
</g>
<!-- kv_cache_2_11_24 -->
<g id="node395" class="node">
<title>kv_cache_2_11_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="134004.39,-550 133176.57,-550 132963.61,-514 133791.43,-514 134004.39,-550"/>
<text text-anchor="middle" x="133484" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_11_24&#45;&gt;attn_block_2_11_24 -->
<g id="edge952" class="edge">
<title>kv_cache_2_11_24&#45;&gt;attn_block_2_11_24</title>
<path fill="none" stroke="black" d="M133618.72,-513.77C133618.72,-513.77 133618.72,-440 133618.72,-440"/>
<polygon fill="black" stroke="black" points="133622.22,-440 133618.72,-430 133615.22,-440 133622.22,-440"/>
</g>
<!-- attn_block_2_12_24 -->
<g id="node396" class="node">
<title>attn_block_2_12_24</title>
<polygon fill="lightgreen" stroke="black" points="133036,-430 132172,-430 132172,-394 133036,-394 133036,-430"/>
<text text-anchor="middle" x="132604" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Block: 13/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_12_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge956" class="edge">
<title>attn_block_2_12_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M133011.85,-430.03C133011.85,-436.85 133011.85,-443 133011.85,-443 133011.85,-443 143472.98,-443 143472.98,-443 143472.98,-443 143472.98,-325.37 143472.98,-325.37"/>
<polygon fill="black" stroke="black" points="143476.48,-325.37 143472.98,-315.37 143469.48,-325.37 143476.48,-325.37"/>
</g>
<!-- kv_cache_2_12_24 -->
<g id="node397" class="node">
<title>kv_cache_2_12_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="132945.39,-550 132117.57,-550 131904.61,-514 132732.43,-514 132945.39,-550"/>
<text text-anchor="middle" x="132425" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_12_24&#45;&gt;attn_block_2_12_24 -->
<g id="edge955" class="edge">
<title>kv_cache_2_12_24&#45;&gt;attn_block_2_12_24</title>
<path fill="none" stroke="black" d="M132558.72,-513.77C132558.72,-513.77 132558.72,-440 132558.72,-440"/>
<polygon fill="black" stroke="black" points="132562.22,-440 132558.72,-430 132555.22,-440 132562.22,-440"/>
</g>
<!-- attn_block_2_13_24 -->
<g id="node398" class="node">
<title>attn_block_2_13_24</title>
<polygon fill="lightgreen" stroke="black" points="131976,-430 131112,-430 131112,-394 131976,-394 131976,-430"/>
<text text-anchor="middle" x="131544" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Block: 14/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_13_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge959" class="edge">
<title>attn_block_2_13_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M131952.19,-430.07C131952.19,-439.46 131952.19,-449 131952.19,-449 131952.19,-449 143474.46,-449 143474.46,-449 143474.46,-449 143474.46,-325.38 143474.46,-325.38"/>
<polygon fill="black" stroke="black" points="143477.96,-325.38 143474.46,-315.38 143470.96,-325.38 143477.96,-325.38"/>
</g>
<!-- kv_cache_2_13_24 -->
<g id="node399" class="node">
<title>kv_cache_2_13_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="131886.39,-550 131058.57,-550 130845.61,-514 131673.43,-514 131886.39,-550"/>
<text text-anchor="middle" x="131366" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_13_24&#45;&gt;attn_block_2_13_24 -->
<g id="edge958" class="edge">
<title>kv_cache_2_13_24&#45;&gt;attn_block_2_13_24</title>
<path fill="none" stroke="black" d="M131499.22,-513.77C131499.22,-513.77 131499.22,-440 131499.22,-440"/>
<polygon fill="black" stroke="black" points="131502.72,-440 131499.22,-430 131495.72,-440 131502.72,-440"/>
</g>
<!-- attn_block_2_14_24 -->
<g id="node400" class="node">
<title>attn_block_2_14_24</title>
<polygon fill="lightgreen" stroke="black" points="130916,-430 130052,-430 130052,-394 130916,-394 130916,-430"/>
<text text-anchor="middle" x="130484" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Block: 15/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_14_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge962" class="edge">
<title>attn_block_2_14_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M130892.52,-430.13C130892.52,-440.31 130892.52,-451 130892.52,-451 130892.52,-451 143475.94,-451 143475.94,-451 143475.94,-451 143475.94,-325.39 143475.94,-325.39"/>
<polygon fill="black" stroke="black" points="143479.44,-325.39 143475.94,-315.39 143472.44,-325.39 143479.44,-325.39"/>
</g>
<!-- kv_cache_2_14_24 -->
<g id="node401" class="node">
<title>kv_cache_2_14_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="130827.39,-550 129999.57,-550 129786.61,-514 130614.43,-514 130827.39,-550"/>
<text text-anchor="middle" x="130307" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_14_24&#45;&gt;attn_block_2_14_24 -->
<g id="edge961" class="edge">
<title>kv_cache_2_14_24&#45;&gt;attn_block_2_14_24</title>
<path fill="none" stroke="black" d="M130439.72,-513.77C130439.72,-513.77 130439.72,-440 130439.72,-440"/>
<polygon fill="black" stroke="black" points="130443.22,-440 130439.72,-430 130436.22,-440 130443.22,-440"/>
</g>
<!-- attn_block_2_15_24 -->
<g id="node402" class="node">
<title>attn_block_2_15_24</title>
<polygon fill="lightgreen" stroke="black" points="129857,-430 128993,-430 128993,-394 129857,-394 129857,-430"/>
<text text-anchor="middle" x="129425" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Block: 16/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_15_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge965" class="edge">
<title>attn_block_2_15_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M129833.52,-430.13C129833.52,-440.71 129833.52,-452 129833.52,-452 129833.52,-452 143477.43,-452 143477.43,-452 143477.43,-452 143477.43,-325.39 143477.43,-325.39"/>
<polygon fill="black" stroke="black" points="143480.93,-325.39 143477.43,-315.39 143473.93,-325.39 143480.93,-325.39"/>
</g>
<!-- kv_cache_2_15_24 -->
<g id="node403" class="node">
<title>kv_cache_2_15_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="129768.39,-550 128940.57,-550 128727.61,-514 129555.43,-514 129768.39,-550"/>
<text text-anchor="middle" x="129248" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_15_24&#45;&gt;attn_block_2_15_24 -->
<g id="edge964" class="edge">
<title>kv_cache_2_15_24&#45;&gt;attn_block_2_15_24</title>
<path fill="none" stroke="black" d="M129380.72,-513.77C129380.72,-513.77 129380.72,-440 129380.72,-440"/>
<polygon fill="black" stroke="black" points="129384.22,-440 129380.72,-430 129377.22,-440 129384.22,-440"/>
</g>
<!-- attn_block_2_16_24 -->
<g id="node404" class="node">
<title>attn_block_2_16_24</title>
<polygon fill="lightgreen" stroke="black" points="128798,-430 127934,-430 127934,-394 128798,-394 128798,-430"/>
<text text-anchor="middle" x="128366" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_16&lt;br/&gt;Block: 17/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_16_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge968" class="edge">
<title>attn_block_2_16_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M128774.52,-430.06C128774.52,-441.44 128774.52,-454 128774.52,-454 128774.52,-454 143478.91,-454 143478.91,-454 143478.91,-454 143478.91,-325.4 143478.91,-325.4"/>
<polygon fill="black" stroke="black" points="143482.41,-325.4 143478.91,-315.4 143475.41,-325.4 143482.41,-325.4"/>
</g>
<!-- kv_cache_2_16_24 -->
<g id="node405" class="node">
<title>kv_cache_2_16_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="128709.39,-550 127881.57,-550 127668.61,-514 128496.43,-514 128709.39,-550"/>
<text text-anchor="middle" x="128189" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_16&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_16_24&#45;&gt;attn_block_2_16_24 -->
<g id="edge967" class="edge">
<title>kv_cache_2_16_24&#45;&gt;attn_block_2_16_24</title>
<path fill="none" stroke="black" d="M128321.72,-513.77C128321.72,-513.77 128321.72,-440 128321.72,-440"/>
<polygon fill="black" stroke="black" points="128325.22,-440 128321.72,-430 128318.22,-440 128325.22,-440"/>
</g>
<!-- attn_block_2_17_24 -->
<g id="node406" class="node">
<title>attn_block_2_17_24</title>
<polygon fill="lightgreen" stroke="black" points="127739,-430 126875,-430 126875,-394 127739,-394 127739,-430"/>
<text text-anchor="middle" x="127307" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_17&lt;br/&gt;Block: 18/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_17_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge971" class="edge">
<title>attn_block_2_17_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M127703.78,-430.18C127703.78,-443.04 127703.78,-458 127703.78,-458 127703.78,-458 143480.39,-458 143480.39,-458 143480.39,-458 143480.39,-325.41 143480.39,-325.41"/>
<polygon fill="black" stroke="black" points="143483.89,-325.41 143480.39,-315.41 143476.89,-325.41 143483.89,-325.41"/>
</g>
<!-- kv_cache_2_17_24 -->
<g id="node407" class="node">
<title>kv_cache_2_17_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="127650.39,-550 126822.57,-550 126609.61,-514 127437.43,-514 127650.39,-550"/>
<text text-anchor="middle" x="127130" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_17&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_17_24&#45;&gt;attn_block_2_17_24 -->
<g id="edge970" class="edge">
<title>kv_cache_2_17_24&#45;&gt;attn_block_2_17_24</title>
<path fill="none" stroke="black" d="M127262.72,-513.77C127262.72,-513.77 127262.72,-440 127262.72,-440"/>
<polygon fill="black" stroke="black" points="127266.22,-440 127262.72,-430 127259.22,-440 127266.22,-440"/>
</g>
<!-- attn_block_2_18_24 -->
<g id="node408" class="node">
<title>attn_block_2_18_24</title>
<polygon fill="lightgreen" stroke="black" points="151654,-430 150790,-430 150790,-394 151654,-394 151654,-430"/>
<text text-anchor="middle" x="151222" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_18&lt;br/&gt;Block: 19/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_18_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge974" class="edge">
<title>attn_block_2_18_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M151222,-393.99C151222,-367.98 151222,-323 151222,-323 151222,-323 144302.39,-323 144302.39,-323"/>
<polygon fill="black" stroke="black" points="144302.39,-319.5 144292.39,-323 144302.39,-326.5 144302.39,-319.5"/>
</g>
<!-- kv_cache_2_18_24 -->
<g id="node409" class="node">
<title>kv_cache_2_18_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="151918.39,-550 151090.57,-550 150877.61,-514 151705.43,-514 151918.39,-550"/>
<text text-anchor="middle" x="151398" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_18&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_18_24&#45;&gt;attn_block_2_18_24 -->
<g id="edge973" class="edge">
<title>kv_cache_2_18_24&#45;&gt;attn_block_2_18_24</title>
<path fill="none" stroke="black" d="M151265.78,-513.77C151265.78,-513.77 151265.78,-440 151265.78,-440"/>
<polygon fill="black" stroke="black" points="151269.28,-440 151265.78,-430 151262.28,-440 151269.28,-440"/>
</g>
<!-- attn_block_2_19_24 -->
<g id="node410" class="node">
<title>attn_block_2_19_24</title>
<polygon fill="lightgreen" stroke="black" points="150596,-430 149732,-430 149732,-394 150596,-394 150596,-430"/>
<text text-anchor="middle" x="150164" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_19&lt;br/&gt;Block: 20/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_19_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge977" class="edge">
<title>attn_block_2_19_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M150164,-393.97C150164,-368.49 150164,-325 150164,-325 150164,-325 144243.59,-325 144243.59,-325"/>
<polygon fill="black" stroke="black" points="144243.59,-321.5 144233.59,-325 144243.59,-328.5 144243.59,-321.5"/>
</g>
<!-- kv_cache_2_19_24 -->
<g id="node411" class="node">
<title>kv_cache_2_19_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="150859.39,-550 150031.57,-550 149818.61,-514 150646.43,-514 150859.39,-550"/>
<text text-anchor="middle" x="150339" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_19&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_19_24&#45;&gt;attn_block_2_19_24 -->
<g id="edge976" class="edge">
<title>kv_cache_2_19_24&#45;&gt;attn_block_2_19_24</title>
<path fill="none" stroke="black" d="M150207.28,-513.77C150207.28,-513.77 150207.28,-440 150207.28,-440"/>
<polygon fill="black" stroke="black" points="150210.78,-440 150207.28,-430 150203.78,-440 150210.78,-440"/>
</g>
<!-- attn_block_2_20_24 -->
<g id="node412" class="node">
<title>attn_block_2_20_24</title>
<polygon fill="lightgreen" stroke="black" points="149540,-430 148676,-430 148676,-394 149540,-394 149540,-430"/>
<text text-anchor="middle" x="149108" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_20&lt;br/&gt;Block: 21/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_20_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge980" class="edge">
<title>attn_block_2_20_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M149108,-393.76C149108,-368.52 149108,-326 149108,-326 149108,-326 144214.25,-326 144214.25,-326"/>
<polygon fill="black" stroke="black" points="144214.25,-322.5 144204.25,-326 144214.25,-329.5 144214.25,-322.5"/>
</g>
<!-- kv_cache_2_20_24 -->
<g id="node413" class="node">
<title>kv_cache_2_20_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="149800.39,-550 148972.57,-550 148759.61,-514 149587.43,-514 149800.39,-550"/>
<text text-anchor="middle" x="149280" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_20&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_20_24&#45;&gt;attn_block_2_20_24 -->
<g id="edge979" class="edge">
<title>kv_cache_2_20_24&#45;&gt;attn_block_2_20_24</title>
<path fill="none" stroke="black" d="M149149.78,-513.77C149149.78,-513.77 149149.78,-440 149149.78,-440"/>
<polygon fill="black" stroke="black" points="149153.28,-440 149149.78,-430 149146.28,-440 149153.28,-440"/>
</g>
<!-- attn_block_2_21_24 -->
<g id="node414" class="node">
<title>attn_block_2_21_24</title>
<polygon fill="lightgreen" stroke="black" points="148486,-430 147622,-430 147622,-394 148486,-394 148486,-430"/>
<text text-anchor="middle" x="148054" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_21&lt;br/&gt;Block: 22/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_21_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge983" class="edge">
<title>attn_block_2_21_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M148054,-393.77C148054,-369.07 148054,-328 148054,-328 148054,-328 144155.35,-328 144155.35,-328"/>
<polygon fill="black" stroke="black" points="144155.35,-324.5 144145.35,-328 144155.35,-331.5 144155.35,-324.5"/>
</g>
<!-- kv_cache_2_21_24 -->
<g id="node415" class="node">
<title>kv_cache_2_21_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="148741.39,-550 147913.57,-550 147700.61,-514 148528.43,-514 148741.39,-550"/>
<text text-anchor="middle" x="148221" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_21&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_21_24&#45;&gt;attn_block_2_21_24 -->
<g id="edge982" class="edge">
<title>kv_cache_2_21_24&#45;&gt;attn_block_2_21_24</title>
<path fill="none" stroke="black" d="M148093.28,-513.77C148093.28,-513.77 148093.28,-440 148093.28,-440"/>
<polygon fill="black" stroke="black" points="148096.78,-440 148093.28,-430 148089.78,-440 148096.78,-440"/>
</g>
<!-- attn_block_2_22_24 -->
<g id="node416" class="node">
<title>attn_block_2_22_24</title>
<polygon fill="lightgreen" stroke="black" points="147438,-430 146574,-430 146574,-394 147438,-394 147438,-430"/>
<text text-anchor="middle" x="147006" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_22&lt;br/&gt;Block: 23/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_22_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge986" class="edge">
<title>attn_block_2_22_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M147006,-393.99C147006,-369.58 147006,-329 147006,-329 147006,-329 144125.92,-329 144125.92,-329"/>
<polygon fill="black" stroke="black" points="144125.92,-325.5 144115.92,-329 144125.92,-332.5 144125.92,-325.5"/>
</g>
<!-- kv_cache_2_22_24 -->
<g id="node417" class="node">
<title>kv_cache_2_22_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="147682.39,-550 146854.57,-550 146641.61,-514 147469.43,-514 147682.39,-550"/>
<text text-anchor="middle" x="147162" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_22&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_22_24&#45;&gt;attn_block_2_22_24 -->
<g id="edge985" class="edge">
<title>kv_cache_2_22_24&#45;&gt;attn_block_2_22_24</title>
<path fill="none" stroke="black" d="M147039.78,-513.77C147039.78,-513.77 147039.78,-440 147039.78,-440"/>
<polygon fill="black" stroke="black" points="147043.28,-440 147039.78,-430 147036.28,-440 147043.28,-440"/>
</g>
<!-- attn_block_2_23_24 -->
<g id="node418" class="node">
<title>attn_block_2_23_24</title>
<polygon fill="lightgreen" stroke="black" points="146401,-430 145537,-430 145537,-394 146401,-394 146401,-430"/>
<text text-anchor="middle" x="145969" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_23&lt;br/&gt;Block: 24/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_2_23_24&#45;&gt;hier_reduce_2_24 -->
<g id="edge989" class="edge">
<title>attn_block_2_23_24&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M145969,-393.62C145969,-369.72 145969,-331 145969,-331 145969,-331 144066.99,-331 144066.99,-331"/>
<polygon fill="black" stroke="black" points="144066.99,-327.5 144056.99,-331 144066.99,-334.5 144066.99,-327.5"/>
</g>
<!-- kv_cache_2_23_24 -->
<g id="node419" class="node">
<title>kv_cache_2_23_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="146623.39,-550 145795.57,-550 145582.61,-514 146410.43,-514 146623.39,-550"/>
<text text-anchor="middle" x="146103" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_23&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_2_23_24&#45;&gt;attn_block_2_23_24 -->
<g id="edge988" class="edge">
<title>kv_cache_2_23_24&#45;&gt;attn_block_2_23_24</title>
<path fill="none" stroke="black" d="M145991.78,-513.77C145991.78,-513.77 145991.78,-440 145991.78,-440"/>
<polygon fill="black" stroke="black" points="145995.28,-440 145991.78,-430 145988.28,-440 145995.28,-440"/>
</g>
<!-- attn_block_3_0_24 -->
<g id="node420" class="node">
<title>attn_block_3_0_24</title>
<polygon fill="lightgreen" stroke="black" points="170718,-430 169864,-430 169864,-394 170718,-394 170718,-430"/>
<text text-anchor="middle" x="170291" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Block: 1/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- hier_reduce_3_24 -->
<g id="node607" class="node">
<title>hier_reduce_3_24</title>
<polygon fill="lightgray" stroke="black" points="169330,-333 168800.57,-315 169330,-297 169859.43,-315 169330,-333"/>
<text text-anchor="middle" x="169330" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;Hierarchical Reduction&lt;/b&gt;&lt;br/&gt;Aggregates attention results&lt;br/&gt;From 24 GPUs to 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, hidden=4096]</text>
</g>
<!-- attn_block_3_0_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1257" class="edge">
<title>attn_block_3_0_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M169863.63,-412C169856.65,-412 169852.8,-412 169852.8,-412 169852.8,-412 169852.8,-325.28 169852.8,-325.28"/>
<polygon fill="black" stroke="black" points="169856.3,-325.28 169852.8,-315.28 169849.3,-325.28 169856.3,-325.28"/>
</g>
<!-- kv_cache_3_0_24 -->
<g id="node421" class="node">
<title>kv_cache_3_0_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="170896.26,-550 170075.01,-550 169863.74,-514 170684.99,-514 170896.26,-550"/>
<text text-anchor="middle" x="170380" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_0&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_0_24&#45;&gt;attn_block_3_0_24 -->
<g id="edge1256" class="edge">
<title>kv_cache_3_0_24&#45;&gt;attn_block_3_0_24</title>
<path fill="none" stroke="black" d="M170291,-513.77C170291,-513.77 170291,-440 170291,-440"/>
<polygon fill="black" stroke="black" points="170294.5,-440 170291,-430 170287.5,-440 170294.5,-440"/>
</g>
<!-- attn_block_3_1_24 -->
<g id="node422" class="node">
<title>attn_block_3_1_24</title>
<polygon fill="lightgreen" stroke="black" points="169757,-430 168903,-430 168903,-394 169757,-394 169757,-430"/>
<text text-anchor="middle" x="169330" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Block: 2/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_1_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1260" class="edge">
<title>attn_block_3_1_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M169330,-393.76C169330,-393.76 169330,-343.16 169330,-343.16"/>
<polygon fill="black" stroke="black" points="169333.5,-343.16 169330,-333.16 169326.5,-343.16 169333.5,-343.16"/>
</g>
<!-- kv_cache_3_1_24 -->
<g id="node423" class="node">
<title>kv_cache_3_1_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="169846.26,-550 169025.01,-550 168813.74,-514 169634.99,-514 169846.26,-550"/>
<text text-anchor="middle" x="169330" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_1&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_1_24&#45;&gt;attn_block_3_1_24 -->
<g id="edge1259" class="edge">
<title>kv_cache_3_1_24&#45;&gt;attn_block_3_1_24</title>
<path fill="none" stroke="black" d="M169330,-513.77C169330,-513.77 169330,-440 169330,-440"/>
<polygon fill="black" stroke="black" points="169333.5,-440 169330,-430 169326.5,-440 169333.5,-440"/>
</g>
<!-- attn_block_3_2_24 -->
<g id="node424" class="node">
<title>attn_block_3_2_24</title>
<polygon fill="lightgreen" stroke="black" points="168796,-430 167942,-430 167942,-394 168796,-394 168796,-430"/>
<text text-anchor="middle" x="168369" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Block: 3/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_2_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1263" class="edge">
<title>attn_block_3_2_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M168796.37,-412C168803.35,-412 168807.2,-412 168807.2,-412 168807.2,-412 168807.2,-325.28 168807.2,-325.28"/>
<polygon fill="black" stroke="black" points="168810.7,-325.28 168807.2,-315.28 168803.7,-325.28 168810.7,-325.28"/>
</g>
<!-- kv_cache_3_2_24 -->
<g id="node425" class="node">
<title>kv_cache_3_2_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="168796.26,-550 167975.01,-550 167763.74,-514 168584.99,-514 168796.26,-550"/>
<text text-anchor="middle" x="168280" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_2&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_2_24&#45;&gt;attn_block_3_2_24 -->
<g id="edge1262" class="edge">
<title>kv_cache_3_2_24&#45;&gt;attn_block_3_2_24</title>
<path fill="none" stroke="black" d="M168369,-513.77C168369,-513.77 168369,-440 168369,-440"/>
<polygon fill="black" stroke="black" points="168372.5,-440 168369,-430 168365.5,-440 168372.5,-440"/>
</g>
<!-- attn_block_3_3_24 -->
<g id="node426" class="node">
<title>attn_block_3_3_24</title>
<polygon fill="lightgreen" stroke="black" points="167835,-430 166981,-430 166981,-394 167835,-394 167835,-430"/>
<text text-anchor="middle" x="167408" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Block: 4/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_3_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1266" class="edge">
<title>attn_block_3_3_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M167408,-393.82C167408,-367.01 167408,-320 167408,-320 167408,-320 168937.4,-320 168937.4,-320"/>
<polygon fill="black" stroke="black" points="168937.4,-323.5 168947.4,-320 168937.4,-316.5 168937.4,-323.5"/>
</g>
<!-- kv_cache_3_3_24 -->
<g id="node427" class="node">
<title>kv_cache_3_3_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="167746.26,-550 166925.01,-550 166713.74,-514 167534.99,-514 167746.26,-550"/>
<text text-anchor="middle" x="167230" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_3&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_3_24&#45;&gt;attn_block_3_3_24 -->
<g id="edge1265" class="edge">
<title>kv_cache_3_3_24&#45;&gt;attn_block_3_3_24</title>
<path fill="none" stroke="black" d="M167363.56,-513.77C167363.56,-513.77 167363.56,-440 167363.56,-440"/>
<polygon fill="black" stroke="black" points="167367.06,-440 167363.56,-430 167360.06,-440 167367.06,-440"/>
</g>
<!-- attn_block_3_4_24 -->
<g id="node428" class="node">
<title>attn_block_3_4_24</title>
<polygon fill="lightgreen" stroke="black" points="166785,-430 165931,-430 165931,-394 166785,-394 166785,-430"/>
<text text-anchor="middle" x="166358" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Block: 5/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_4_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1269" class="edge">
<title>attn_block_3_4_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M166358,-393.88C166358,-366.56 166358,-318 166358,-318 166358,-318 168878.67,-318 168878.67,-318"/>
<polygon fill="black" stroke="black" points="168878.67,-321.5 168888.67,-318 168878.67,-314.5 168878.67,-321.5"/>
</g>
<!-- kv_cache_3_4_24 -->
<g id="node429" class="node">
<title>kv_cache_3_4_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="166696.26,-550 165875.01,-550 165663.74,-514 166484.99,-514 166696.26,-550"/>
<text text-anchor="middle" x="166180" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_4&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_4_24&#45;&gt;attn_block_3_4_24 -->
<g id="edge1268" class="edge">
<title>kv_cache_3_4_24&#45;&gt;attn_block_3_4_24</title>
<path fill="none" stroke="black" d="M166313.56,-513.77C166313.56,-513.77 166313.56,-440 166313.56,-440"/>
<polygon fill="black" stroke="black" points="166317.06,-440 166313.56,-430 166310.06,-440 166317.06,-440"/>
</g>
<!-- attn_block_3_5_24 -->
<g id="node430" class="node">
<title>attn_block_3_5_24</title>
<polygon fill="lightgreen" stroke="black" points="165735,-430 164881,-430 164881,-394 165735,-394 165735,-430"/>
<text text-anchor="middle" x="165308" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Block: 6/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_5_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1272" class="edge">
<title>attn_block_3_5_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M165308,-393.68C165308,-366.08 165308,-317 165308,-317 165308,-317 168849.27,-317 168849.27,-317"/>
<polygon fill="black" stroke="black" points="168849.27,-320.5 168859.27,-317 168849.27,-313.5 168849.27,-320.5"/>
</g>
<!-- kv_cache_3_5_24 -->
<g id="node431" class="node">
<title>kv_cache_3_5_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="165646.26,-550 164825.01,-550 164613.74,-514 165434.99,-514 165646.26,-550"/>
<text text-anchor="middle" x="165130" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_5&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_5_24&#45;&gt;attn_block_3_5_24 -->
<g id="edge1271" class="edge">
<title>kv_cache_3_5_24&#45;&gt;attn_block_3_5_24</title>
<path fill="none" stroke="black" d="M165263.56,-513.77C165263.56,-513.77 165263.56,-440 165263.56,-440"/>
<polygon fill="black" stroke="black" points="165267.06,-440 165263.56,-430 165260.06,-440 165267.06,-440"/>
</g>
<!-- attn_block_3_6_24 -->
<g id="node432" class="node">
<title>attn_block_3_6_24</title>
<polygon fill="lightgreen" stroke="black" points="164774,-430 163920,-430 163920,-394 164774,-394 164774,-430"/>
<text text-anchor="middle" x="164347" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Block: 7/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_6_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1275" class="edge">
<title>attn_block_3_6_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M164347,-393.76C164347,-365.66 164347,-315 164347,-315 164347,-315 168790.57,-315 168790.57,-315"/>
<polygon fill="black" stroke="black" points="168790.57,-318.5 168800.57,-315 168790.57,-311.5 168790.57,-318.5"/>
</g>
<!-- kv_cache_3_6_24 -->
<g id="node433" class="node">
<title>kv_cache_3_6_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="164596.26,-550 163775.01,-550 163563.74,-514 164384.99,-514 164596.26,-550"/>
<text text-anchor="middle" x="164080" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_6&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_6_24&#45;&gt;attn_block_3_6_24 -->
<g id="edge1274" class="edge">
<title>kv_cache_3_6_24&#45;&gt;attn_block_3_6_24</title>
<path fill="none" stroke="black" d="M164258.06,-513.77C164258.06,-513.77 164258.06,-440 164258.06,-440"/>
<polygon fill="black" stroke="black" points="164261.56,-440 164258.06,-430 164254.56,-440 164261.56,-440"/>
</g>
<!-- attn_block_3_7_24 -->
<g id="node434" class="node">
<title>attn_block_3_7_24</title>
<polygon fill="lightgreen" stroke="black" points="163679,-430 162825,-430 162825,-394 163679,-394 163679,-430"/>
<text text-anchor="middle" x="163252" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Block: 8/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_7_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1278" class="edge">
<title>attn_block_3_7_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M163252,-393.57C163252,-365.18 163252,-314 163252,-314 163252,-314 168819.71,-314 168819.71,-314"/>
<polygon fill="black" stroke="black" points="168819.71,-317.5 168829.71,-314 168819.71,-310.5 168819.71,-317.5"/>
</g>
<!-- kv_cache_3_7_24 -->
<g id="node435" class="node">
<title>kv_cache_3_7_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="163546.26,-550 162725.01,-550 162513.74,-514 163334.99,-514 163546.26,-550"/>
<text text-anchor="middle" x="163030" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_7&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_7_24&#45;&gt;attn_block_3_7_24 -->
<g id="edge1277" class="edge">
<title>kv_cache_3_7_24&#45;&gt;attn_block_3_7_24</title>
<path fill="none" stroke="black" d="M163185.56,-513.77C163185.56,-513.77 163185.56,-440 163185.56,-440"/>
<polygon fill="black" stroke="black" points="163189.06,-440 163185.56,-430 163182.06,-440 163189.06,-440"/>
</g>
<!-- attn_block_3_8_24 -->
<g id="node436" class="node">
<title>attn_block_3_8_24</title>
<polygon fill="lightgreen" stroke="black" points="162607,-430 161753,-430 161753,-394 162607,-394 162607,-430"/>
<text text-anchor="middle" x="162180" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Block: 9/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_8_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1281" class="edge">
<title>attn_block_3_8_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M162180,-393.66C162180,-364.79 162180,-312 162180,-312 162180,-312 168878.8,-312 168878.8,-312"/>
<polygon fill="black" stroke="black" points="168878.8,-315.5 168888.8,-312 168878.8,-308.5 168878.8,-315.5"/>
</g>
<!-- kv_cache_3_8_24 -->
<g id="node437" class="node">
<title>kv_cache_3_8_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="162496.26,-550 161675.01,-550 161463.74,-514 162284.99,-514 162496.26,-550"/>
<text text-anchor="middle" x="161980" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_8&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_8_24&#45;&gt;attn_block_3_8_24 -->
<g id="edge1280" class="edge">
<title>kv_cache_3_8_24&#45;&gt;attn_block_3_8_24</title>
<path fill="none" stroke="black" d="M162124.56,-513.77C162124.56,-513.77 162124.56,-440 162124.56,-440"/>
<polygon fill="black" stroke="black" points="162128.06,-440 162124.56,-430 162121.06,-440 162128.06,-440"/>
</g>
<!-- attn_block_3_9_24 -->
<g id="node438" class="node">
<title>attn_block_3_9_24</title>
<polygon fill="lightgreen" stroke="black" points="161546.5,-430 160687.5,-430 160687.5,-394 161546.5,-394 161546.5,-430"/>
<text text-anchor="middle" x="161117" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Block: 10/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_9_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1284" class="edge">
<title>attn_block_3_9_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M161117,-393.94C161117,-364.89 161117,-311 161117,-311 161117,-311 168908.15,-311 168908.15,-311"/>
<polygon fill="black" stroke="black" points="168908.15,-314.5 168918.15,-311 168908.15,-307.5 168908.15,-314.5"/>
</g>
<!-- kv_cache_3_9_24 -->
<g id="node439" class="node">
<title>kv_cache_3_9_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="161446.26,-550 160625.01,-550 160413.74,-514 161234.99,-514 161446.26,-550"/>
<text text-anchor="middle" x="160930" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_9&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_9_24&#45;&gt;attn_block_3_9_24 -->
<g id="edge1283" class="edge">
<title>kv_cache_3_9_24&#45;&gt;attn_block_3_9_24</title>
<path fill="none" stroke="black" d="M161066.81,-513.77C161066.81,-513.77 161066.81,-440 161066.81,-440"/>
<polygon fill="black" stroke="black" points="161070.31,-440 161066.81,-430 161063.31,-440 161070.31,-440"/>
</g>
<!-- attn_block_3_10_24 -->
<g id="node440" class="node">
<title>attn_block_3_10_24</title>
<polygon fill="lightgreen" stroke="black" points="160488,-430 159624,-430 159624,-394 160488,-394 160488,-430"/>
<text text-anchor="middle" x="160056" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Block: 11/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_10_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1287" class="edge">
<title>attn_block_3_10_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M160056,-393.59C160056,-363.96 160056,-309 160056,-309 160056,-309 168966.72,-309 168966.72,-309"/>
<polygon fill="black" stroke="black" points="168966.72,-312.5 168976.72,-309 168966.72,-305.5 168966.72,-312.5"/>
</g>
<!-- kv_cache_3_10_24 -->
<g id="node441" class="node">
<title>kv_cache_3_10_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="160395.39,-550 159567.57,-550 159354.61,-514 160182.43,-514 160395.39,-550"/>
<text text-anchor="middle" x="159875" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_10&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_10_24&#45;&gt;attn_block_3_10_24 -->
<g id="edge1286" class="edge">
<title>kv_cache_3_10_24&#45;&gt;attn_block_3_10_24</title>
<path fill="none" stroke="black" d="M160009.72,-513.77C160009.72,-513.77 160009.72,-440 160009.72,-440"/>
<polygon fill="black" stroke="black" points="160013.22,-440 160009.72,-430 160006.22,-440 160013.22,-440"/>
</g>
<!-- attn_block_3_11_24 -->
<g id="node442" class="node">
<title>attn_block_3_11_24</title>
<polygon fill="lightgreen" stroke="black" points="159427,-430 158563,-430 158563,-394 159427,-394 159427,-430"/>
<text text-anchor="middle" x="158995" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Block: 12/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_11_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1290" class="edge">
<title>attn_block_3_11_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M158995,-393.71C158995,-363.63 158995,-307 158995,-307 158995,-307 169025.63,-307 169025.63,-307"/>
<polygon fill="black" stroke="black" points="169025.63,-310.5 169035.63,-307 169025.63,-303.5 169025.63,-310.5"/>
</g>
<!-- kv_cache_3_11_24 -->
<g id="node443" class="node">
<title>kv_cache_3_11_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="159336.39,-550 158508.57,-550 158295.61,-514 159123.43,-514 159336.39,-550"/>
<text text-anchor="middle" x="158816" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_11&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_11_24&#45;&gt;attn_block_3_11_24 -->
<g id="edge1289" class="edge">
<title>kv_cache_3_11_24&#45;&gt;attn_block_3_11_24</title>
<path fill="none" stroke="black" d="M158949.72,-513.77C158949.72,-513.77 158949.72,-440 158949.72,-440"/>
<polygon fill="black" stroke="black" points="158953.22,-440 158949.72,-430 158946.22,-440 158953.22,-440"/>
</g>
<!-- attn_block_3_12_24 -->
<g id="node444" class="node">
<title>attn_block_3_12_24</title>
<polygon fill="lightgreen" stroke="black" points="158367,-430 157503,-430 157503,-394 158367,-394 158367,-430"/>
<text text-anchor="middle" x="157935" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Block: 13/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_12_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1293" class="edge">
<title>attn_block_3_12_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M157935,-393.54C157935,-363.17 157935,-306 157935,-306 157935,-306 169055.1,-306 169055.1,-306"/>
<polygon fill="black" stroke="black" points="169055.1,-309.5 169065.1,-306 169055.1,-302.5 169055.1,-309.5"/>
</g>
<!-- kv_cache_3_12_24 -->
<g id="node445" class="node">
<title>kv_cache_3_12_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="158277.39,-550 157449.57,-550 157236.61,-514 158064.43,-514 158277.39,-550"/>
<text text-anchor="middle" x="157757" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_12&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_12_24&#45;&gt;attn_block_3_12_24 -->
<g id="edge1292" class="edge">
<title>kv_cache_3_12_24&#45;&gt;attn_block_3_12_24</title>
<path fill="none" stroke="black" d="M157890.22,-513.77C157890.22,-513.77 157890.22,-440 157890.22,-440"/>
<polygon fill="black" stroke="black" points="157893.72,-440 157890.22,-430 157886.72,-440 157893.72,-440"/>
</g>
<!-- attn_block_3_13_24 -->
<g id="node446" class="node">
<title>attn_block_3_13_24</title>
<polygon fill="lightgreen" stroke="black" points="157307,-430 156443,-430 156443,-394 157307,-394 157307,-430"/>
<text text-anchor="middle" x="156875" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Block: 14/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_13_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1296" class="edge">
<title>attn_block_3_13_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M156875,-393.68C156875,-362.87 156875,-304 156875,-304 156875,-304 169113.89,-304 169113.89,-304"/>
<polygon fill="black" stroke="black" points="169113.89,-307.5 169123.89,-304 169113.89,-300.5 169113.89,-307.5"/>
</g>
<!-- kv_cache_3_13_24 -->
<g id="node447" class="node">
<title>kv_cache_3_13_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="157218.39,-550 156390.57,-550 156177.61,-514 157005.43,-514 157218.39,-550"/>
<text text-anchor="middle" x="156698" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_13&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_13_24&#45;&gt;attn_block_3_13_24 -->
<g id="edge1295" class="edge">
<title>kv_cache_3_13_24&#45;&gt;attn_block_3_13_24</title>
<path fill="none" stroke="black" d="M156830.72,-513.77C156830.72,-513.77 156830.72,-440 156830.72,-440"/>
<polygon fill="black" stroke="black" points="156834.22,-440 156830.72,-430 156827.22,-440 156834.22,-440"/>
</g>
<!-- attn_block_3_14_24 -->
<g id="node448" class="node">
<title>attn_block_3_14_24</title>
<polygon fill="lightgreen" stroke="black" points="156248,-430 155384,-430 155384,-394 156248,-394 156248,-430"/>
<text text-anchor="middle" x="155816" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Block: 15/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_14_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1299" class="edge">
<title>attn_block_3_14_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M155816,-393.51C155816,-362.41 155816,-303 155816,-303 155816,-303 169143.26,-303 169143.26,-303"/>
<polygon fill="black" stroke="black" points="169143.26,-306.5 169153.26,-303 169143.26,-299.5 169143.26,-306.5"/>
</g>
<!-- kv_cache_3_14_24 -->
<g id="node449" class="node">
<title>kv_cache_3_14_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="156159.39,-550 155331.57,-550 155118.61,-514 155946.43,-514 156159.39,-550"/>
<text text-anchor="middle" x="155639" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_14&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_14_24&#45;&gt;attn_block_3_14_24 -->
<g id="edge1298" class="edge">
<title>kv_cache_3_14_24&#45;&gt;attn_block_3_14_24</title>
<path fill="none" stroke="black" d="M155771.72,-513.77C155771.72,-513.77 155771.72,-440 155771.72,-440"/>
<polygon fill="black" stroke="black" points="155775.22,-440 155771.72,-430 155768.22,-440 155775.22,-440"/>
</g>
<!-- attn_block_3_15_24 -->
<g id="node450" class="node">
<title>attn_block_3_15_24</title>
<polygon fill="lightgreen" stroke="black" points="155189,-430 154325,-430 154325,-394 155189,-394 155189,-430"/>
<text text-anchor="middle" x="154757" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Block: 16/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_15_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1302" class="edge">
<title>attn_block_3_15_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M154757,-393.67C154757,-362.14 154757,-301 154757,-301 154757,-301 169202.16,-301 169202.16,-301"/>
<polygon fill="black" stroke="black" points="169202.16,-304.5 169212.16,-301 169202.16,-297.5 169202.16,-304.5"/>
</g>
<!-- kv_cache_3_15_24 -->
<g id="node451" class="node">
<title>kv_cache_3_15_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="155100.39,-550 154272.57,-550 154059.61,-514 154887.43,-514 155100.39,-550"/>
<text text-anchor="middle" x="154580" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_15&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_15_24&#45;&gt;attn_block_3_15_24 -->
<g id="edge1301" class="edge">
<title>kv_cache_3_15_24&#45;&gt;attn_block_3_15_24</title>
<path fill="none" stroke="black" d="M154712.72,-513.77C154712.72,-513.77 154712.72,-440 154712.72,-440"/>
<polygon fill="black" stroke="black" points="154716.22,-440 154712.72,-430 154709.22,-440 154716.22,-440"/>
</g>
<!-- attn_block_3_16_24 -->
<g id="node452" class="node">
<title>attn_block_3_16_24</title>
<polygon fill="lightgreen" stroke="black" points="154130,-430 153266,-430 153266,-394 154130,-394 154130,-430"/>
<text text-anchor="middle" x="153698" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_16&lt;br/&gt;Block: 17/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_16_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1305" class="edge">
<title>attn_block_3_16_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M153698,-393.51C153698,-361.69 153698,-300 153698,-300 153698,-300 169231.61,-300 169231.61,-300"/>
<polygon fill="black" stroke="black" points="169231.61,-303.5 169241.61,-300 169231.61,-296.5 169231.61,-303.5"/>
</g>
<!-- kv_cache_3_16_24 -->
<g id="node453" class="node">
<title>kv_cache_3_16_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="154041.39,-550 153213.57,-550 153000.61,-514 153828.43,-514 154041.39,-550"/>
<text text-anchor="middle" x="153521" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_16&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_16_24&#45;&gt;attn_block_3_16_24 -->
<g id="edge1304" class="edge">
<title>kv_cache_3_16_24&#45;&gt;attn_block_3_16_24</title>
<path fill="none" stroke="black" d="M153653.72,-513.77C153653.72,-513.77 153653.72,-440 153653.72,-440"/>
<polygon fill="black" stroke="black" points="153657.22,-440 153653.72,-430 153650.22,-440 153657.22,-440"/>
</g>
<!-- attn_block_3_17_24 -->
<g id="node454" class="node">
<title>attn_block_3_17_24</title>
<polygon fill="lightgreen" stroke="black" points="153071,-430 152207,-430 152207,-394 153071,-394 153071,-430"/>
<text text-anchor="middle" x="152639" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_17&lt;br/&gt;Block: 18/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_17_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1308" class="edge">
<title>attn_block_3_17_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M152639,-393.94C152639,-361.79 152639,-298 152639,-298 152639,-298 169290.35,-298 169290.35,-298"/>
<polygon fill="black" stroke="black" points="169290.35,-301.5 169300.35,-298 169290.35,-294.5 169290.35,-301.5"/>
</g>
<!-- kv_cache_3_17_24 -->
<g id="node455" class="node">
<title>kv_cache_3_17_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="152982.39,-550 152154.57,-550 151941.61,-514 152769.43,-514 152982.39,-550"/>
<text text-anchor="middle" x="152462" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_17&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_17_24&#45;&gt;attn_block_3_17_24 -->
<g id="edge1307" class="edge">
<title>kv_cache_3_17_24&#45;&gt;attn_block_3_17_24</title>
<path fill="none" stroke="black" d="M152594.72,-513.77C152594.72,-513.77 152594.72,-440 152594.72,-440"/>
<polygon fill="black" stroke="black" points="152598.22,-440 152594.72,-430 152591.22,-440 152598.22,-440"/>
</g>
<!-- attn_block_3_18_24 -->
<g id="node456" class="node">
<title>attn_block_3_18_24</title>
<polygon fill="lightgreen" stroke="black" points="176986,-430 176122,-430 176122,-394 176986,-394 176986,-430"/>
<text text-anchor="middle" x="176554" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_18&lt;br/&gt;Block: 19/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_18_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1311" class="edge">
<title>attn_block_3_18_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M176554,-393.51C176554,-362.41 176554,-303 176554,-303 176554,-303 169516.78,-303 169516.78,-303"/>
<polygon fill="black" stroke="black" points="169516.78,-299.5 169506.78,-303 169516.78,-306.5 169516.78,-299.5"/>
</g>
<!-- kv_cache_3_18_24 -->
<g id="node457" class="node">
<title>kv_cache_3_18_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="177250.39,-550 176422.57,-550 176209.61,-514 177037.43,-514 177250.39,-550"/>
<text text-anchor="middle" x="176730" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_18&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_18_24&#45;&gt;attn_block_3_18_24 -->
<g id="edge1310" class="edge">
<title>kv_cache_3_18_24&#45;&gt;attn_block_3_18_24</title>
<path fill="none" stroke="black" d="M176597.78,-513.77C176597.78,-513.77 176597.78,-440 176597.78,-440"/>
<polygon fill="black" stroke="black" points="176601.28,-440 176597.78,-430 176594.28,-440 176601.28,-440"/>
</g>
<!-- attn_block_3_19_24 -->
<g id="node458" class="node">
<title>attn_block_3_19_24</title>
<polygon fill="lightgreen" stroke="black" points="175928,-430 175064,-430 175064,-394 175928,-394 175928,-430"/>
<text text-anchor="middle" x="175496" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_19&lt;br/&gt;Block: 20/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_19_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1314" class="edge">
<title>attn_block_3_19_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M175496,-393.54C175496,-363.17 175496,-306 175496,-306 175496,-306 169604.95,-306 169604.95,-306"/>
<polygon fill="black" stroke="black" points="169604.95,-302.5 169594.95,-306 169604.95,-309.5 169604.95,-302.5"/>
</g>
<!-- kv_cache_3_19_24 -->
<g id="node459" class="node">
<title>kv_cache_3_19_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="176191.39,-550 175363.57,-550 175150.61,-514 175978.43,-514 176191.39,-550"/>
<text text-anchor="middle" x="175671" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_19&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_19_24&#45;&gt;attn_block_3_19_24 -->
<g id="edge1313" class="edge">
<title>kv_cache_3_19_24&#45;&gt;attn_block_3_19_24</title>
<path fill="none" stroke="black" d="M175539.28,-513.77C175539.28,-513.77 175539.28,-440 175539.28,-440"/>
<polygon fill="black" stroke="black" points="175542.78,-440 175539.28,-430 175535.78,-440 175542.78,-440"/>
</g>
<!-- attn_block_3_20_24 -->
<g id="node460" class="node">
<title>attn_block_3_20_24</title>
<polygon fill="lightgreen" stroke="black" points="174872,-430 174008,-430 174008,-394 174872,-394 174872,-430"/>
<text text-anchor="middle" x="174440" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_20&lt;br/&gt;Block: 21/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_20_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1317" class="edge">
<title>attn_block_3_20_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M174440,-393.88C174440,-364.09 174440,-308 174440,-308 174440,-308 169664.02,-308 169664.02,-308"/>
<polygon fill="black" stroke="black" points="169664.02,-304.5 169654.02,-308 169664.02,-311.5 169664.02,-304.5"/>
</g>
<!-- kv_cache_3_20_24 -->
<g id="node461" class="node">
<title>kv_cache_3_20_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="175132.39,-550 174304.57,-550 174091.61,-514 174919.43,-514 175132.39,-550"/>
<text text-anchor="middle" x="174612" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_20&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_20_24&#45;&gt;attn_block_3_20_24 -->
<g id="edge1316" class="edge">
<title>kv_cache_3_20_24&#45;&gt;attn_block_3_20_24</title>
<path fill="none" stroke="black" d="M174481.78,-513.77C174481.78,-513.77 174481.78,-440 174481.78,-440"/>
<polygon fill="black" stroke="black" points="174485.28,-440 174481.78,-430 174478.28,-440 174485.28,-440"/>
</g>
<!-- attn_block_3_21_24 -->
<g id="node462" class="node">
<title>attn_block_3_21_24</title>
<polygon fill="lightgreen" stroke="black" points="173818,-430 172954,-430 172954,-394 173818,-394 173818,-430"/>
<text text-anchor="middle" x="173386" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_21&lt;br/&gt;Block: 22/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_21_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1320" class="edge">
<title>attn_block_3_21_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M173386,-393.76C173386,-364.43 173386,-310 173386,-310 173386,-310 169722.49,-310 169722.49,-310"/>
<polygon fill="black" stroke="black" points="169722.49,-306.5 169712.49,-310 169722.49,-313.5 169722.49,-306.5"/>
</g>
<!-- kv_cache_3_21_24 -->
<g id="node463" class="node">
<title>kv_cache_3_21_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="174073.39,-550 173245.57,-550 173032.61,-514 173860.43,-514 174073.39,-550"/>
<text text-anchor="middle" x="173553" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_21&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_21_24&#45;&gt;attn_block_3_21_24 -->
<g id="edge1319" class="edge">
<title>kv_cache_3_21_24&#45;&gt;attn_block_3_21_24</title>
<path fill="none" stroke="black" d="M173425.28,-513.77C173425.28,-513.77 173425.28,-440 173425.28,-440"/>
<polygon fill="black" stroke="black" points="173428.78,-440 173425.28,-430 173421.78,-440 173428.78,-440"/>
</g>
<!-- attn_block_3_22_24 -->
<g id="node464" class="node">
<title>attn_block_3_22_24</title>
<polygon fill="lightgreen" stroke="black" points="172770,-430 171906,-430 171906,-394 172770,-394 172770,-430"/>
<text text-anchor="middle" x="172338" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_22&lt;br/&gt;Block: 23/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_22_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1323" class="edge">
<title>attn_block_3_22_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M172338,-393.66C172338,-364.79 172338,-312 172338,-312 172338,-312 169781.42,-312 169781.42,-312"/>
<polygon fill="black" stroke="black" points="169781.42,-308.5 169771.42,-312 169781.42,-315.5 169781.42,-308.5"/>
</g>
<!-- kv_cache_3_22_24 -->
<g id="node465" class="node">
<title>kv_cache_3_22_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="173014.39,-550 172186.57,-550 171973.61,-514 172801.43,-514 173014.39,-550"/>
<text text-anchor="middle" x="172494" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_22&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_22_24&#45;&gt;attn_block_3_22_24 -->
<g id="edge1322" class="edge">
<title>kv_cache_3_22_24&#45;&gt;attn_block_3_22_24</title>
<path fill="none" stroke="black" d="M172371.78,-513.77C172371.78,-513.77 172371.78,-440 172371.78,-440"/>
<polygon fill="black" stroke="black" points="172375.28,-440 172371.78,-430 172368.28,-440 172375.28,-440"/>
</g>
<!-- attn_block_3_23_24 -->
<g id="node466" class="node">
<title>attn_block_3_23_24</title>
<polygon fill="lightgreen" stroke="black" points="171733,-430 170869,-430 170869,-394 171733,-394 171733,-430"/>
<text text-anchor="middle" x="171301" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Attention Block&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_23&lt;br/&gt;Block: 24/24&lt;br/&gt;Input: [batch=1024, block_seq=ceil(seq/24), hidden=4096]&lt;br/&gt;Output: [batch=1024, block_seq=ceil(seq/24), hidden=4096]</text>
</g>
<!-- attn_block_3_23_24&#45;&gt;hier_reduce_3_24 -->
<g id="edge1326" class="edge">
<title>attn_block_3_23_24&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M171301,-393.76C171301,-365.66 171301,-315 171301,-315 171301,-315 169869.49,-315 169869.49,-315"/>
<polygon fill="black" stroke="black" points="169869.49,-311.5 169859.49,-315 169869.49,-318.5 169869.49,-311.5"/>
</g>
<!-- kv_cache_3_23_24 -->
<g id="node467" class="node">
<title>kv_cache_3_23_24</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="171955.39,-550 171127.57,-550 170914.61,-514 171742.43,-514 171955.39,-550"/>
<text text-anchor="middle" x="171435" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;KV Cache Share&lt;/b&gt;&lt;br/&gt;GPU: pool_gpu_23&lt;br/&gt;Replicates K,V across all GPUs&lt;br/&gt;[batch=1024, seq=?, heads=32, d_k=128]</text>
</g>
<!-- kv_cache_3_23_24&#45;&gt;attn_block_3_23_24 -->
<g id="edge1325" class="edge">
<title>kv_cache_3_23_24&#45;&gt;attn_block_3_23_24</title>
<path fill="none" stroke="black" d="M171323.78,-513.77C171323.78,-513.77 171323.78,-440 171323.78,-440"/>
<polygon fill="black" stroke="black" points="171327.28,-440 171323.78,-430 171320.28,-440 171327.28,-440"/>
</g>
<!-- l0_ffn_up_0 -->
<g id="node468" class="node">
<title>l0_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="9012,-550 8362,-550 8362,-514 9012,-514 9012,-550"/>
<text text-anchor="middle" x="8687" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ffn_down_0 -->
<g id="node469" class="node">
<title>l0_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="8977,-430 8315,-430 8315,-394 8977,-394 8977,-430"/>
<text text-anchor="middle" x="8646" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_0&#45;&gt;l0_ffn_down_0 -->
<g id="edge30" class="edge">
<title>l0_ffn_up_0&#45;&gt;l0_ffn_down_0</title>
<path fill="none" stroke="black" d="M8485,-513.77C8485,-513.77 8485,-440 8485,-440"/>
<polygon fill="black" stroke="black" points="8488.5,-440 8485,-430 8481.5,-440 8488.5,-440"/>
</g>
<!-- l0_ffn_up_0&#45;&gt;l0_ffn_down_0 -->
<g id="edge102" class="edge">
<title>l0_ffn_up_0&#45;&gt;l0_ffn_down_0</title>
<path fill="none" stroke="black" d="M8608,-513.77C8608,-513.77 8608,-440 8608,-440"/>
<polygon fill="black" stroke="black" points="8611.5,-440 8608,-430 8604.5,-440 8611.5,-440"/>
</g>
<!-- l0_ffn_up_0&#45;&gt;l0_ffn_down_0 -->
<g id="edge198" class="edge">
<title>l0_ffn_up_0&#45;&gt;l0_ffn_down_0</title>
<path fill="none" stroke="black" d="M8731,-513.77C8731,-513.77 8731,-440 8731,-440"/>
<polygon fill="black" stroke="black" points="8734.5,-440 8731,-430 8727.5,-440 8734.5,-440"/>
</g>
<!-- l0_ffn_up_0&#45;&gt;l0_ffn_down_0 -->
<g id="edge318" class="edge">
<title>l0_ffn_up_0&#45;&gt;l0_ffn_down_0</title>
<path fill="none" stroke="black" d="M8854,-513.77C8854,-513.77 8854,-440 8854,-440"/>
<polygon fill="black" stroke="black" points="8857.5,-440 8854,-430 8850.5,-440 8857.5,-440"/>
</g>
<!-- l0_ffn_res_0 -->
<g id="node470" class="node">
<title>l0_ffn_res_0</title>
<polygon fill="lightgray" stroke="black" points="8487,-333 7940.1,-315 8487,-297 9033.9,-315 8487,-333"/>
<text text-anchor="middle" x="8487" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_down_0&#45;&gt;l0_ffn_res_0 -->
<g id="edge31" class="edge">
<title>l0_ffn_down_0&#45;&gt;l0_ffn_res_0</title>
<path fill="none" stroke="black" d="M8447.4,-393.76C8447.4,-393.76 8447.4,-341.86 8447.4,-341.86"/>
<polygon fill="black" stroke="black" points="8450.9,-341.86 8447.4,-331.86 8443.9,-341.86 8450.9,-341.86"/>
</g>
<!-- l0_ffn_down_0&#45;&gt;l0_ffn_res_0 -->
<g id="edge103" class="edge">
<title>l0_ffn_down_0&#45;&gt;l0_ffn_res_0</title>
<path fill="none" stroke="black" d="M8579.8,-393.76C8579.8,-393.76 8579.8,-339.98 8579.8,-339.98"/>
<polygon fill="black" stroke="black" points="8583.3,-339.98 8579.8,-329.98 8576.3,-339.98 8583.3,-339.98"/>
</g>
<!-- l0_ffn_down_0&#45;&gt;l0_ffn_res_0 -->
<g id="edge199" class="edge">
<title>l0_ffn_down_0&#45;&gt;l0_ffn_res_0</title>
<path fill="none" stroke="black" d="M8712.2,-393.76C8712.2,-393.76 8712.2,-335.66 8712.2,-335.66"/>
<polygon fill="black" stroke="black" points="8715.7,-335.66 8712.2,-325.66 8708.7,-335.66 8715.7,-335.66"/>
</g>
<!-- l0_ffn_down_0&#45;&gt;l0_ffn_res_0 -->
<g id="edge319" class="edge">
<title>l0_ffn_down_0&#45;&gt;l0_ffn_res_0</title>
<path fill="none" stroke="black" d="M8844.6,-393.76C8844.6,-393.76 8844.6,-331.51 8844.6,-331.51"/>
<polygon fill="black" stroke="black" points="8848.1,-331.51 8844.6,-321.51 8841.1,-331.51 8848.1,-331.51"/>
</g>
<!-- l0_ffn_res_0&#45;&gt;l0_ffn_ln_0 -->
<g id="edge33" class="edge">
<title>l0_ffn_res_0&#45;&gt;l0_ffn_ln_0</title>
<path fill="none" stroke="black" d="M8353.05,-301.12C8353.05,-301.12 8353.05,-271.2 8353.05,-271.2"/>
<polygon fill="black" stroke="black" points="8356.55,-271.2 8353.05,-261.2 8349.55,-271.2 8356.55,-271.2"/>
</g>
<!-- l0_ffn_res_0&#45;&gt;l0_ffn_ln_0 -->
<g id="edge105" class="edge">
<title>l0_ffn_res_0&#45;&gt;l0_ffn_ln_0</title>
<path fill="none" stroke="black" d="M8410.59,-299.38C8410.59,-299.38 8410.59,-271.13 8410.59,-271.13"/>
<polygon fill="black" stroke="black" points="8414.09,-271.13 8410.59,-261.13 8407.09,-271.13 8414.09,-271.13"/>
</g>
<!-- l0_ffn_res_0&#45;&gt;l0_ffn_ln_0 -->
<g id="edge201" class="edge">
<title>l0_ffn_res_0&#45;&gt;l0_ffn_ln_0</title>
<path fill="none" stroke="black" d="M8468.14,-297.57C8468.14,-297.57 8468.14,-271.02 8468.14,-271.02"/>
<polygon fill="black" stroke="black" points="8471.64,-271.02 8468.14,-261.02 8464.64,-271.02 8471.64,-271.02"/>
</g>
<!-- l0_ffn_res_0&#45;&gt;l0_ffn_ln_0 -->
<g id="edge321" class="edge">
<title>l0_ffn_res_0&#45;&gt;l0_ffn_ln_0</title>
<path fill="none" stroke="black" d="M8525.68,-297.94C8525.68,-297.94 8525.68,-271.2 8525.68,-271.2"/>
<polygon fill="black" stroke="black" points="8529.18,-271.2 8525.68,-261.2 8522.18,-271.2 8529.18,-271.2"/>
</g>
<!-- l0_ffn_ln_0&#45;&gt;l0_ffn_up_0 -->
<g id="edge29" class="edge">
<title>l0_ffn_ln_0&#45;&gt;l0_ffn_up_0</title>
<path fill="none" stroke="black" d="M8928.78,-246C8994.57,-246 9044.36,-246 9044.36,-246 9044.36,-246 9044.36,-518 9044.36,-518 9044.36,-518 9022.02,-518 9022.02,-518"/>
<polygon fill="black" stroke="black" points="9022.02,-514.5 9012.02,-518 9022.02,-521.5 9022.02,-514.5"/>
</g>
<!-- l0_ffn_ln_0&#45;&gt;l0_ffn_up_0 -->
<g id="edge101" class="edge">
<title>l0_ffn_ln_0&#45;&gt;l0_ffn_up_0</title>
<path fill="none" stroke="black" d="M8928.78,-243C8999.89,-243 9054.77,-243 9054.77,-243 9054.77,-243 9054.77,-522 9054.77,-522 9054.77,-522 9022.22,-522 9022.22,-522"/>
<polygon fill="black" stroke="black" points="9022.22,-518.5 9012.22,-522 9022.22,-525.5 9022.22,-518.5"/>
</g>
<!-- l0_ffn_ln_0&#45;&gt;l0_ffn_up_0 -->
<g id="edge197" class="edge">
<title>l0_ffn_ln_0&#45;&gt;l0_ffn_up_0</title>
<path fill="none" stroke="black" d="M8928.6,-239C9005.05,-239 9065.18,-239 9065.18,-239 9065.18,-239 9065.18,-526 9065.18,-526 9065.18,-526 9022.2,-526 9022.2,-526"/>
<polygon fill="black" stroke="black" points="9022.2,-522.5 9012.2,-526 9022.2,-529.5 9022.2,-522.5"/>
</g>
<!-- l0_ffn_ln_0&#45;&gt;l0_ffn_up_0 -->
<g id="edge317" class="edge">
<title>l0_ffn_ln_0&#45;&gt;l0_ffn_up_0</title>
<path fill="none" stroke="black" d="M8928.59,-235C9010.23,-235 9075.59,-235 9075.59,-235 9075.59,-235 9075.59,-530 9075.59,-530 9075.59,-530 9022.29,-530 9022.29,-530"/>
<polygon fill="black" stroke="black" points="9022.29,-526.5 9012.29,-530 9022.29,-533.5 9022.29,-526.5"/>
</g>
<!-- l0_ffn_ln_0&#45;&gt;l0_ffn_res_0 -->
<g id="edge32" class="edge">
<title>l0_ffn_ln_0&#45;&gt;l0_ffn_res_0</title>
<path fill="none" stroke="black" d="M8583.23,-261.17C8583.23,-261.17 8583.23,-289.99 8583.23,-289.99"/>
<polygon fill="black" stroke="black" points="8579.73,-289.99 8583.23,-299.99 8586.73,-289.99 8579.73,-289.99"/>
</g>
<!-- l0_ffn_ln_0&#45;&gt;l0_ffn_res_0 -->
<g id="edge104" class="edge">
<title>l0_ffn_ln_0&#45;&gt;l0_ffn_res_0</title>
<path fill="none" stroke="black" d="M8640.77,-261.17C8640.77,-261.17 8640.77,-291.84 8640.77,-291.84"/>
<polygon fill="black" stroke="black" points="8637.27,-291.84 8640.77,-301.84 8644.27,-291.84 8637.27,-291.84"/>
</g>
<!-- l0_ffn_ln_0&#45;&gt;l0_ffn_res_0 -->
<g id="edge200" class="edge">
<title>l0_ffn_ln_0&#45;&gt;l0_ffn_res_0</title>
<path fill="none" stroke="black" d="M8698.32,-261.17C8698.32,-261.17 8698.32,-293.59 8698.32,-293.59"/>
<polygon fill="black" stroke="black" points="8694.82,-293.59 8698.32,-303.59 8701.82,-293.59 8694.82,-293.59"/>
</g>
<!-- l0_ffn_ln_0&#45;&gt;l0_ffn_res_0 -->
<g id="edge320" class="edge">
<title>l0_ffn_ln_0&#45;&gt;l0_ffn_res_0</title>
<path fill="none" stroke="black" d="M8755.86,-261.17C8755.86,-261.17 8755.86,-295.65 8755.86,-295.65"/>
<polygon fill="black" stroke="black" points="8752.36,-295.65 8755.86,-305.65 8759.36,-295.65 8752.36,-295.65"/>
</g>
<!-- l0_ffn_up_1 -->
<g id="node472" class="node">
<title>l0_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="3435,-550 2785,-550 2785,-514 3435,-514 3435,-550"/>
<text text-anchor="middle" x="3110" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ffn_down_1 -->
<g id="node473" class="node">
<title>l0_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="3266,-430 2604,-430 2604,-394 3266,-394 3266,-430"/>
<text text-anchor="middle" x="2935" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_1&#45;&gt;l0_ffn_down_1 -->
<g id="edge36" class="edge">
<title>l0_ffn_up_1&#45;&gt;l0_ffn_down_1</title>
<path fill="none" stroke="black" d="M2881.2,-513.77C2881.2,-513.77 2881.2,-440 2881.2,-440"/>
<polygon fill="black" stroke="black" points="2884.7,-440 2881.2,-430 2877.7,-440 2884.7,-440"/>
</g>
<!-- l0_ffn_up_1&#45;&gt;l0_ffn_down_1 -->
<g id="edge108" class="edge">
<title>l0_ffn_up_1&#45;&gt;l0_ffn_down_1</title>
<path fill="none" stroke="black" d="M2977.4,-513.77C2977.4,-513.77 2977.4,-440 2977.4,-440"/>
<polygon fill="black" stroke="black" points="2980.9,-440 2977.4,-430 2973.9,-440 2980.9,-440"/>
</g>
<!-- l0_ffn_up_1&#45;&gt;l0_ffn_down_1 -->
<g id="edge204" class="edge">
<title>l0_ffn_up_1&#45;&gt;l0_ffn_down_1</title>
<path fill="none" stroke="black" d="M3073.6,-513.77C3073.6,-513.77 3073.6,-440 3073.6,-440"/>
<polygon fill="black" stroke="black" points="3077.1,-440 3073.6,-430 3070.1,-440 3077.1,-440"/>
</g>
<!-- l0_ffn_up_1&#45;&gt;l0_ffn_down_1 -->
<g id="edge324" class="edge">
<title>l0_ffn_up_1&#45;&gt;l0_ffn_down_1</title>
<path fill="none" stroke="black" d="M3169.8,-513.77C3169.8,-513.77 3169.8,-440 3169.8,-440"/>
<polygon fill="black" stroke="black" points="3173.3,-440 3169.8,-430 3166.3,-440 3173.3,-440"/>
</g>
<!-- l0_ffn_res_1 -->
<g id="node474" class="node">
<title>l0_ffn_res_1</title>
<polygon fill="lightgray" stroke="black" points="2827,-333 2280.1,-315 2827,-297 3373.9,-315 2827,-333"/>
<text text-anchor="middle" x="2827" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_down_1&#45;&gt;l0_ffn_res_1 -->
<g id="edge37" class="edge">
<title>l0_ffn_down_1&#45;&gt;l0_ffn_res_1</title>
<path fill="none" stroke="black" d="M2736.4,-393.76C2736.4,-393.76 2736.4,-340.29 2736.4,-340.29"/>
<polygon fill="black" stroke="black" points="2739.9,-340.29 2736.4,-330.29 2732.9,-340.29 2739.9,-340.29"/>
</g>
<!-- l0_ffn_down_1&#45;&gt;l0_ffn_res_1 -->
<g id="edge109" class="edge">
<title>l0_ffn_down_1&#45;&gt;l0_ffn_res_1</title>
<path fill="none" stroke="black" d="M2868.8,-393.76C2868.8,-393.76 2868.8,-341.86 2868.8,-341.86"/>
<polygon fill="black" stroke="black" points="2872.3,-341.86 2868.8,-331.86 2865.3,-341.86 2872.3,-341.86"/>
</g>
<!-- l0_ffn_down_1&#45;&gt;l0_ffn_res_1 -->
<g id="edge205" class="edge">
<title>l0_ffn_down_1&#45;&gt;l0_ffn_res_1</title>
<path fill="none" stroke="black" d="M3001.2,-393.76C3001.2,-393.76 3001.2,-337.32 3001.2,-337.32"/>
<polygon fill="black" stroke="black" points="3004.7,-337.32 3001.2,-327.32 2997.7,-337.32 3004.7,-337.32"/>
</g>
<!-- l0_ffn_down_1&#45;&gt;l0_ffn_res_1 -->
<g id="edge325" class="edge">
<title>l0_ffn_down_1&#45;&gt;l0_ffn_res_1</title>
<path fill="none" stroke="black" d="M3133.6,-393.76C3133.6,-393.76 3133.6,-333.35 3133.6,-333.35"/>
<polygon fill="black" stroke="black" points="3137.1,-333.35 3133.6,-323.35 3130.1,-333.35 3137.1,-333.35"/>
</g>
<!-- l0_ffn_res_1&#45;&gt;l0_ffn_ln_1 -->
<g id="edge39" class="edge">
<title>l0_ffn_res_1&#45;&gt;l0_ffn_ln_1</title>
<path fill="none" stroke="black" d="M2857.99,-297.94C2857.99,-297.94 2857.99,-271.2 2857.99,-271.2"/>
<polygon fill="black" stroke="black" points="2861.49,-271.2 2857.99,-261.2 2854.49,-271.2 2861.49,-271.2"/>
</g>
<!-- l0_ffn_res_1&#45;&gt;l0_ffn_ln_1 -->
<g id="edge111" class="edge">
<title>l0_ffn_res_1&#45;&gt;l0_ffn_ln_1</title>
<path fill="none" stroke="black" d="M2922.49,-300.08C2922.49,-300.08 2922.49,-271.22 2922.49,-271.22"/>
<polygon fill="black" stroke="black" points="2925.99,-271.22 2922.49,-261.22 2918.99,-271.22 2925.99,-271.22"/>
</g>
<!-- l0_ffn_res_1&#45;&gt;l0_ffn_ln_1 -->
<g id="edge207" class="edge">
<title>l0_ffn_res_1&#45;&gt;l0_ffn_ln_1</title>
<path fill="none" stroke="black" d="M2986.98,-302.13C2986.98,-302.13 2986.98,-271.17 2986.98,-271.17"/>
<polygon fill="black" stroke="black" points="2990.48,-271.17 2986.98,-261.17 2983.48,-271.17 2990.48,-271.17"/>
</g>
<!-- l0_ffn_res_1&#45;&gt;l0_ffn_ln_1 -->
<g id="edge327" class="edge">
<title>l0_ffn_res_1&#45;&gt;l0_ffn_ln_1</title>
<path fill="none" stroke="black" d="M3051.48,-304.38C3051.48,-304.38 3051.48,-271.21 3051.48,-271.21"/>
<polygon fill="black" stroke="black" points="3054.98,-271.21 3051.48,-261.21 3047.98,-271.21 3054.98,-271.21"/>
</g>
<!-- l0_ffn_ln_1&#45;&gt;l0_ffn_up_1 -->
<g id="edge35" class="edge">
<title>l0_ffn_ln_1&#45;&gt;l0_ffn_up_1</title>
<path fill="none" stroke="black" d="M3379.39,-261.08C3379.39,-261.08 3379.39,-503.93 3379.39,-503.93"/>
<polygon fill="black" stroke="black" points="3375.89,-503.93 3379.39,-513.93 3382.89,-503.93 3375.89,-503.93"/>
</g>
<!-- l0_ffn_ln_1&#45;&gt;l0_ffn_up_1 -->
<g id="edge107" class="edge">
<title>l0_ffn_ln_1&#45;&gt;l0_ffn_up_1</title>
<path fill="none" stroke="black" d="M3384.84,-261.08C3384.84,-261.08 3384.84,-503.93 3384.84,-503.93"/>
<polygon fill="black" stroke="black" points="3381.34,-503.93 3384.84,-513.93 3388.34,-503.93 3381.34,-503.93"/>
</g>
<!-- l0_ffn_ln_1&#45;&gt;l0_ffn_up_1 -->
<g id="edge203" class="edge">
<title>l0_ffn_ln_1&#45;&gt;l0_ffn_up_1</title>
<path fill="none" stroke="black" d="M3390.28,-261.08C3390.28,-261.08 3390.28,-503.93 3390.28,-503.93"/>
<polygon fill="black" stroke="black" points="3386.78,-503.93 3390.28,-513.93 3393.78,-503.93 3386.78,-503.93"/>
</g>
<!-- l0_ffn_ln_1&#45;&gt;l0_ffn_up_1 -->
<g id="edge323" class="edge">
<title>l0_ffn_ln_1&#45;&gt;l0_ffn_up_1</title>
<path fill="none" stroke="black" d="M3395.72,-261.08C3395.72,-261.08 3395.72,-503.93 3395.72,-503.93"/>
<polygon fill="black" stroke="black" points="3392.22,-503.93 3395.72,-513.93 3399.22,-503.93 3392.22,-503.93"/>
</g>
<!-- l0_ffn_ln_1&#45;&gt;l0_ffn_res_1 -->
<g id="edge38" class="edge">
<title>l0_ffn_ln_1&#45;&gt;l0_ffn_res_1</title>
<path fill="none" stroke="black" d="M3115.97,-261.17C3115.97,-261.17 3115.97,-296.43 3115.97,-296.43"/>
<polygon fill="black" stroke="black" points="3112.47,-296.43 3115.97,-306.43 3119.47,-296.43 3112.47,-296.43"/>
</g>
<!-- l0_ffn_ln_1&#45;&gt;l0_ffn_res_1 -->
<g id="edge110" class="edge">
<title>l0_ffn_ln_1&#45;&gt;l0_ffn_res_1</title>
<path fill="none" stroke="black" d="M3180.47,-261.17C3180.47,-261.17 3180.47,-298.6 3180.47,-298.6"/>
<polygon fill="black" stroke="black" points="3176.97,-298.6 3180.47,-308.6 3183.97,-298.6 3176.97,-298.6"/>
</g>
<!-- l0_ffn_ln_1&#45;&gt;l0_ffn_res_1 -->
<g id="edge206" class="edge">
<title>l0_ffn_ln_1&#45;&gt;l0_ffn_res_1</title>
<path fill="none" stroke="black" d="M3244.96,-261.17C3244.96,-261.17 3244.96,-300.5 3244.96,-300.5"/>
<polygon fill="black" stroke="black" points="3241.46,-300.5 3244.96,-310.5 3248.46,-300.5 3241.46,-300.5"/>
</g>
<!-- l0_ffn_ln_1&#45;&gt;l0_ffn_res_1 -->
<g id="edge326" class="edge">
<title>l0_ffn_ln_1&#45;&gt;l0_ffn_res_1</title>
<path fill="none" stroke="black" d="M3309.45,-261.17C3309.45,-261.17 3309.45,-302.79 3309.45,-302.79"/>
<polygon fill="black" stroke="black" points="3305.96,-302.79 3309.45,-312.79 3312.96,-302.79 3305.96,-302.79"/>
</g>
<!-- l0_ffn_up_2 -->
<g id="node476" class="node">
<title>l0_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="727,-550 77,-550 77,-514 727,-514 727,-550"/>
<text text-anchor="middle" x="402" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ffn_down_2 -->
<g id="node477" class="node">
<title>l0_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="854,-430 192,-430 192,-394 854,-394 854,-430"/>
<text text-anchor="middle" x="523" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_2&#45;&gt;l0_ffn_down_2 -->
<g id="edge42" class="edge">
<title>l0_ffn_up_2&#45;&gt;l0_ffn_down_2</title>
<path fill="none" stroke="black" d="M299,-513.77C299,-513.77 299,-440 299,-440"/>
<polygon fill="black" stroke="black" points="302.5,-440 299,-430 295.5,-440 302.5,-440"/>
</g>
<!-- l0_ffn_up_2&#45;&gt;l0_ffn_down_2 -->
<g id="edge114" class="edge">
<title>l0_ffn_up_2&#45;&gt;l0_ffn_down_2</title>
<path fill="none" stroke="black" d="M406,-513.77C406,-513.77 406,-440 406,-440"/>
<polygon fill="black" stroke="black" points="409.5,-440 406,-430 402.5,-440 409.5,-440"/>
</g>
<!-- l0_ffn_up_2&#45;&gt;l0_ffn_down_2 -->
<g id="edge210" class="edge">
<title>l0_ffn_up_2&#45;&gt;l0_ffn_down_2</title>
<path fill="none" stroke="black" d="M513,-513.77C513,-513.77 513,-440 513,-440"/>
<polygon fill="black" stroke="black" points="516.5,-440 513,-430 509.5,-440 516.5,-440"/>
</g>
<!-- l0_ffn_up_2&#45;&gt;l0_ffn_down_2 -->
<g id="edge330" class="edge">
<title>l0_ffn_up_2&#45;&gt;l0_ffn_down_2</title>
<path fill="none" stroke="black" d="M620,-513.77C620,-513.77 620,-440 620,-440"/>
<polygon fill="black" stroke="black" points="623.5,-440 620,-430 616.5,-440 623.5,-440"/>
</g>
<!-- l0_ffn_res_2 -->
<g id="node478" class="node">
<title>l0_ffn_res_2</title>
<polygon fill="lightgray" stroke="black" points="583,-333 36.1,-315 583,-297 1129.9,-315 583,-333"/>
<text text-anchor="middle" x="583" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_down_2&#45;&gt;l0_ffn_res_2 -->
<g id="edge43" class="edge">
<title>l0_ffn_down_2&#45;&gt;l0_ffn_res_2</title>
<path fill="none" stroke="black" d="M324.4,-393.76C324.4,-393.76 324.4,-334.61 324.4,-334.61"/>
<polygon fill="black" stroke="black" points="327.9,-334.61 324.4,-324.61 320.9,-334.61 327.9,-334.61"/>
</g>
<!-- l0_ffn_down_2&#45;&gt;l0_ffn_res_2 -->
<g id="edge115" class="edge">
<title>l0_ffn_down_2&#45;&gt;l0_ffn_res_2</title>
<path fill="none" stroke="black" d="M456.8,-393.76C456.8,-393.76 456.8,-339.07 456.8,-339.07"/>
<polygon fill="black" stroke="black" points="460.3,-339.07 456.8,-329.07 453.3,-339.07 460.3,-339.07"/>
</g>
<!-- l0_ffn_down_2&#45;&gt;l0_ffn_res_2 -->
<g id="edge211" class="edge">
<title>l0_ffn_down_2&#45;&gt;l0_ffn_res_2</title>
<path fill="none" stroke="black" d="M589.2,-393.76C589.2,-393.76 589.2,-342.84 589.2,-342.84"/>
<polygon fill="black" stroke="black" points="592.7,-342.84 589.2,-332.84 585.7,-342.84 592.7,-342.84"/>
</g>
<!-- l0_ffn_down_2&#45;&gt;l0_ffn_res_2 -->
<g id="edge331" class="edge">
<title>l0_ffn_down_2&#45;&gt;l0_ffn_res_2</title>
<path fill="none" stroke="black" d="M721.6,-393.76C721.6,-393.76 721.6,-338.48 721.6,-338.48"/>
<polygon fill="black" stroke="black" points="725.1,-338.48 721.6,-328.48 718.1,-338.48 725.1,-338.48"/>
</g>
<!-- l0_ffn_res_2&#45;&gt;l0_ffn_ln_2 -->
<g id="edge45" class="edge">
<title>l0_ffn_res_2&#45;&gt;l0_ffn_ln_2</title>
<path fill="none" stroke="black" d="M319.25,-305.59C319.25,-305.59 319.25,-271.28 319.25,-271.28"/>
<polygon fill="black" stroke="black" points="322.75,-271.28 319.25,-261.28 315.75,-271.28 322.75,-271.28"/>
</g>
<!-- l0_ffn_res_2&#45;&gt;l0_ffn_ln_2 -->
<g id="edge117" class="edge">
<title>l0_ffn_res_2&#45;&gt;l0_ffn_ln_2</title>
<path fill="none" stroke="black" d="M372,-303.75C372,-303.75 372,-271.17 372,-271.17"/>
<polygon fill="black" stroke="black" points="375.5,-271.17 372,-261.17 368.5,-271.17 375.5,-271.17"/>
</g>
<!-- l0_ffn_res_2&#45;&gt;l0_ffn_ln_2 -->
<g id="edge213" class="edge">
<title>l0_ffn_res_2&#45;&gt;l0_ffn_ln_2</title>
<path fill="none" stroke="black" d="M424.75,-302.13C424.75,-302.13 424.75,-271.17 424.75,-271.17"/>
<polygon fill="black" stroke="black" points="428.25,-271.17 424.75,-261.17 421.25,-271.17 428.25,-271.17"/>
</g>
<!-- l0_ffn_res_2&#45;&gt;l0_ffn_ln_2 -->
<g id="edge333" class="edge">
<title>l0_ffn_res_2&#45;&gt;l0_ffn_ln_2</title>
<path fill="none" stroke="black" d="M477.5,-300.43C477.5,-300.43 477.5,-271.13 477.5,-271.13"/>
<polygon fill="black" stroke="black" points="481,-271.13 477.5,-261.13 474,-271.13 481,-271.13"/>
</g>
<!-- l0_ffn_ln_2&#45;&gt;l0_ffn_up_2 -->
<g id="edge41" class="edge">
<title>l0_ffn_ln_2&#45;&gt;l0_ffn_up_2</title>
<path fill="none" stroke="black" d="M266.27,-253C142.14,-253 28.85,-253 28.85,-253 28.85,-253 28.85,-521 28.85,-521 28.85,-521 66.87,-521 66.87,-521"/>
<polygon fill="black" stroke="black" points="66.87,-524.5 76.87,-521 66.87,-517.5 66.87,-524.5"/>
</g>
<!-- l0_ffn_ln_2&#45;&gt;l0_ffn_up_2 -->
<g id="edge113" class="edge">
<title>l0_ffn_ln_2&#45;&gt;l0_ffn_up_2</title>
<path fill="none" stroke="black" d="M266.23,-246C138.9,-246 21.65,-246 21.65,-246 21.65,-246 21.65,-528 21.65,-528 21.65,-528 66.96,-528 66.96,-528"/>
<polygon fill="black" stroke="black" points="66.96,-531.5 76.96,-528 66.96,-524.5 66.96,-531.5"/>
</g>
<!-- l0_ffn_ln_2&#45;&gt;l0_ffn_up_2 -->
<g id="edge209" class="edge">
<title>l0_ffn_ln_2&#45;&gt;l0_ffn_up_2</title>
<path fill="none" stroke="black" d="M266.31,-239C135.76,-239 14.45,-239 14.45,-239 14.45,-239 14.45,-535 14.45,-535 14.45,-535 66.72,-535 66.72,-535"/>
<polygon fill="black" stroke="black" points="66.72,-538.5 76.72,-535 66.72,-531.5 66.72,-538.5"/>
</g>
<!-- l0_ffn_ln_2&#45;&gt;l0_ffn_up_2 -->
<g id="edge329" class="edge">
<title>l0_ffn_ln_2&#45;&gt;l0_ffn_up_2</title>
<path fill="none" stroke="black" d="M266.49,-232C132.71,-232 7.25,-232 7.25,-232 7.25,-232 7.25,-542 7.25,-542 7.25,-542 66.92,-542 66.92,-542"/>
<polygon fill="black" stroke="black" points="66.92,-545.5 76.92,-542 66.92,-538.5 66.92,-545.5"/>
</g>
<!-- l0_ffn_ln_2&#45;&gt;l0_ffn_res_2 -->
<g id="edge44" class="edge">
<title>l0_ffn_ln_2&#45;&gt;l0_ffn_res_2</title>
<path fill="none" stroke="black" d="M530.25,-261.17C530.25,-261.17 530.25,-288.56 530.25,-288.56"/>
<polygon fill="black" stroke="black" points="526.75,-288.56 530.25,-298.56 533.75,-288.56 526.75,-288.56"/>
</g>
<!-- l0_ffn_ln_2&#45;&gt;l0_ffn_res_2 -->
<g id="edge116" class="edge">
<title>l0_ffn_ln_2&#45;&gt;l0_ffn_res_2</title>
<path fill="none" stroke="black" d="M583,-261.17C583,-261.17 583,-286.59 583,-286.59"/>
<polygon fill="black" stroke="black" points="579.5,-286.59 583,-296.59 586.5,-286.59 579.5,-286.59"/>
</g>
<!-- l0_ffn_ln_2&#45;&gt;l0_ffn_res_2 -->
<g id="edge212" class="edge">
<title>l0_ffn_ln_2&#45;&gt;l0_ffn_res_2</title>
<path fill="none" stroke="black" d="M635.75,-261.17C635.75,-261.17 635.75,-288.56 635.75,-288.56"/>
<polygon fill="black" stroke="black" points="632.25,-288.56 635.75,-298.56 639.25,-288.56 632.25,-288.56"/>
</g>
<!-- l0_ffn_ln_2&#45;&gt;l0_ffn_res_2 -->
<g id="edge332" class="edge">
<title>l0_ffn_ln_2&#45;&gt;l0_ffn_res_2</title>
<path fill="none" stroke="black" d="M688.5,-261.17C688.5,-261.17 688.5,-290.46 688.5,-290.46"/>
<polygon fill="black" stroke="black" points="685,-290.46 688.5,-300.46 692,-290.46 685,-290.46"/>
</g>
<!-- l0_ffn_up_3 -->
<g id="node480" class="node">
<title>l0_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="5194,-550 4544,-550 4544,-514 5194,-514 5194,-550"/>
<text text-anchor="middle" x="4869" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ffn_down_3 -->
<g id="node481" class="node">
<title>l0_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="5334,-430 4672,-430 4672,-394 5334,-394 5334,-430"/>
<text text-anchor="middle" x="5003" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_3&#45;&gt;l0_ffn_down_3 -->
<g id="edge48" class="edge">
<title>l0_ffn_up_3&#45;&gt;l0_ffn_down_3</title>
<path fill="none" stroke="black" d="M4776.4,-513.77C4776.4,-513.77 4776.4,-440 4776.4,-440"/>
<polygon fill="black" stroke="black" points="4779.9,-440 4776.4,-430 4772.9,-440 4779.9,-440"/>
</g>
<!-- l0_ffn_up_3&#45;&gt;l0_ffn_down_3 -->
<g id="edge120" class="edge">
<title>l0_ffn_up_3&#45;&gt;l0_ffn_down_3</title>
<path fill="none" stroke="black" d="M4880.8,-513.77C4880.8,-513.77 4880.8,-440 4880.8,-440"/>
<polygon fill="black" stroke="black" points="4884.3,-440 4880.8,-430 4877.3,-440 4884.3,-440"/>
</g>
<!-- l0_ffn_up_3&#45;&gt;l0_ffn_down_3 -->
<g id="edge216" class="edge">
<title>l0_ffn_up_3&#45;&gt;l0_ffn_down_3</title>
<path fill="none" stroke="black" d="M4985.2,-513.77C4985.2,-513.77 4985.2,-440 4985.2,-440"/>
<polygon fill="black" stroke="black" points="4988.7,-440 4985.2,-430 4981.7,-440 4988.7,-440"/>
</g>
<!-- l0_ffn_up_3&#45;&gt;l0_ffn_down_3 -->
<g id="edge336" class="edge">
<title>l0_ffn_up_3&#45;&gt;l0_ffn_down_3</title>
<path fill="none" stroke="black" d="M5089.6,-513.77C5089.6,-513.77 5089.6,-440 5089.6,-440"/>
<polygon fill="black" stroke="black" points="5093.1,-440 5089.6,-430 5086.1,-440 5093.1,-440"/>
</g>
<!-- l0_ffn_res_3 -->
<g id="node482" class="node">
<title>l0_ffn_res_3</title>
<polygon fill="lightgray" stroke="black" points="5111,-333 4564.1,-315 5111,-297 5657.9,-315 5111,-333"/>
<text text-anchor="middle" x="5111" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_down_3&#45;&gt;l0_ffn_res_3 -->
<g id="edge49" class="edge">
<title>l0_ffn_down_3&#45;&gt;l0_ffn_res_3</title>
<path fill="none" stroke="black" d="M4804.4,-393.76C4804.4,-393.76 4804.4,-333.35 4804.4,-333.35"/>
<polygon fill="black" stroke="black" points="4807.9,-333.35 4804.4,-323.35 4800.9,-333.35 4807.9,-333.35"/>
</g>
<!-- l0_ffn_down_3&#45;&gt;l0_ffn_res_3 -->
<g id="edge121" class="edge">
<title>l0_ffn_down_3&#45;&gt;l0_ffn_res_3</title>
<path fill="none" stroke="black" d="M4936.8,-393.76C4936.8,-393.76 4936.8,-337.32 4936.8,-337.32"/>
<polygon fill="black" stroke="black" points="4940.3,-337.32 4936.8,-327.32 4933.3,-337.32 4940.3,-337.32"/>
</g>
<!-- l0_ffn_down_3&#45;&gt;l0_ffn_res_3 -->
<g id="edge217" class="edge">
<title>l0_ffn_down_3&#45;&gt;l0_ffn_res_3</title>
<path fill="none" stroke="black" d="M5069.2,-393.76C5069.2,-393.76 5069.2,-341.86 5069.2,-341.86"/>
<polygon fill="black" stroke="black" points="5072.7,-341.86 5069.2,-331.86 5065.7,-341.86 5072.7,-341.86"/>
</g>
<!-- l0_ffn_down_3&#45;&gt;l0_ffn_res_3 -->
<g id="edge337" class="edge">
<title>l0_ffn_down_3&#45;&gt;l0_ffn_res_3</title>
<path fill="none" stroke="black" d="M5201.6,-393.76C5201.6,-393.76 5201.6,-340.29 5201.6,-340.29"/>
<polygon fill="black" stroke="black" points="5205.1,-340.29 5201.6,-330.29 5198.1,-340.29 5205.1,-340.29"/>
</g>
<!-- l0_ffn_res_3&#45;&gt;l0_ffn_ln_3 -->
<g id="edge51" class="edge">
<title>l0_ffn_res_3&#45;&gt;l0_ffn_ln_3</title>
<path fill="none" stroke="black" d="M4852.05,-305.29C4852.05,-305.29 4852.05,-271.12 4852.05,-271.12"/>
<polygon fill="black" stroke="black" points="4855.55,-271.12 4852.05,-261.12 4848.55,-271.12 4855.55,-271.12"/>
</g>
<!-- l0_ffn_res_3&#45;&gt;l0_ffn_ln_3 -->
<g id="edge123" class="edge">
<title>l0_ffn_res_3&#45;&gt;l0_ffn_ln_3</title>
<path fill="none" stroke="black" d="M4909.59,-303.43C4909.59,-303.43 4909.59,-271.01 4909.59,-271.01"/>
<polygon fill="black" stroke="black" points="4913.09,-271.01 4909.59,-261.01 4906.09,-271.01 4913.09,-271.01"/>
</g>
<!-- l0_ffn_res_3&#45;&gt;l0_ffn_ln_3 -->
<g id="edge219" class="edge">
<title>l0_ffn_res_3&#45;&gt;l0_ffn_ln_3</title>
<path fill="none" stroke="black" d="M4967.14,-301.46C4967.14,-301.46 4967.14,-271.1 4967.14,-271.1"/>
<polygon fill="black" stroke="black" points="4970.64,-271.1 4967.14,-261.1 4963.64,-271.1 4970.64,-271.1"/>
</g>
<!-- l0_ffn_res_3&#45;&gt;l0_ffn_ln_3 -->
<g id="edge339" class="edge">
<title>l0_ffn_res_3&#45;&gt;l0_ffn_ln_3</title>
<path fill="none" stroke="black" d="M5024.68,-299.73C5024.68,-299.73 5024.68,-271.05 5024.68,-271.05"/>
<polygon fill="black" stroke="black" points="5028.18,-271.05 5024.68,-261.05 5021.18,-271.05 5028.18,-271.05"/>
</g>
<!-- l0_ffn_ln_3&#45;&gt;l0_ffn_up_3 -->
<g id="edge47" class="edge">
<title>l0_ffn_ln_3&#45;&gt;l0_ffn_up_3</title>
<path fill="none" stroke="black" d="M4794.5,-253C4671.71,-253 4560.04,-253 4560.04,-253 4560.04,-253 4560.04,-503.69 4560.04,-503.69"/>
<polygon fill="black" stroke="black" points="4556.54,-503.69 4560.04,-513.69 4563.54,-503.69 4556.54,-503.69"/>
</g>
<!-- l0_ffn_ln_3&#45;&gt;l0_ffn_up_3 -->
<g id="edge119" class="edge">
<title>l0_ffn_ln_3&#45;&gt;l0_ffn_up_3</title>
<path fill="none" stroke="black" d="M4794.21,-246C4669.73,-246 4556.03,-246 4556.03,-246 4556.03,-246 4556.03,-503.67 4556.03,-503.67"/>
<polygon fill="black" stroke="black" points="4552.53,-503.67 4556.03,-513.67 4559.53,-503.67 4552.53,-503.67"/>
</g>
<!-- l0_ffn_ln_3&#45;&gt;l0_ffn_up_3 -->
<g id="edge215" class="edge">
<title>l0_ffn_ln_3&#45;&gt;l0_ffn_up_3</title>
<path fill="none" stroke="black" d="M4794.35,-239C4668.03,-239 4552.02,-239 4552.02,-239 4552.02,-239 4552.02,-503.67 4552.02,-503.67"/>
<polygon fill="black" stroke="black" points="4548.52,-503.67 4552.02,-513.67 4555.52,-503.67 4548.52,-503.67"/>
</g>
<!-- l0_ffn_ln_3&#45;&gt;l0_ffn_up_3 -->
<g id="edge335" class="edge">
<title>l0_ffn_ln_3&#45;&gt;l0_ffn_up_3</title>
<path fill="none" stroke="black" d="M4794.13,-232C4666.11,-232 4548.01,-232 4548.01,-232 4548.01,-232 4548.01,-503.69 4548.01,-503.69"/>
<polygon fill="black" stroke="black" points="4544.51,-503.69 4548.01,-513.69 4551.51,-503.69 4544.51,-503.69"/>
</g>
<!-- l0_ffn_ln_3&#45;&gt;l0_ffn_res_3 -->
<g id="edge50" class="edge">
<title>l0_ffn_ln_3&#45;&gt;l0_ffn_res_3</title>
<path fill="none" stroke="black" d="M5082.23,-261.17C5082.23,-261.17 5082.23,-287.58 5082.23,-287.58"/>
<polygon fill="black" stroke="black" points="5078.73,-287.58 5082.23,-297.58 5085.73,-287.58 5078.73,-287.58"/>
</g>
<!-- l0_ffn_ln_3&#45;&gt;l0_ffn_res_3 -->
<g id="edge122" class="edge">
<title>l0_ffn_ln_3&#45;&gt;l0_ffn_res_3</title>
<path fill="none" stroke="black" d="M5139.77,-261.17C5139.77,-261.17 5139.77,-287.58 5139.77,-287.58"/>
<polygon fill="black" stroke="black" points="5136.27,-287.58 5139.77,-297.58 5143.27,-287.58 5136.27,-287.58"/>
</g>
<!-- l0_ffn_ln_3&#45;&gt;l0_ffn_res_3 -->
<g id="edge218" class="edge">
<title>l0_ffn_ln_3&#45;&gt;l0_ffn_res_3</title>
<path fill="none" stroke="black" d="M5197.32,-261.17C5197.32,-261.17 5197.32,-289.52 5197.32,-289.52"/>
<polygon fill="black" stroke="black" points="5193.82,-289.52 5197.32,-299.52 5200.82,-289.52 5193.82,-289.52"/>
</g>
<!-- l0_ffn_ln_3&#45;&gt;l0_ffn_res_3 -->
<g id="edge338" class="edge">
<title>l0_ffn_ln_3&#45;&gt;l0_ffn_res_3</title>
<path fill="none" stroke="black" d="M5254.86,-261.17C5254.86,-261.17 5254.86,-291.38 5254.86,-291.38"/>
<polygon fill="black" stroke="black" points="5251.36,-291.38 5254.86,-301.38 5258.36,-291.38 5251.36,-291.38"/>
</g>
<!-- l0_ffn_up_4 -->
<g id="node484" class="node">
<title>l0_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="6885,-550 6235,-550 6235,-514 6885,-514 6885,-550"/>
<text text-anchor="middle" x="6560" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ffn_down_4 -->
<g id="node485" class="node">
<title>l0_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="6662,-430 6000,-430 6000,-394 6662,-394 6662,-430"/>
<text text-anchor="middle" x="6331" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_4&#45;&gt;l0_ffn_down_4 -->
<g id="edge54" class="edge">
<title>l0_ffn_up_4&#45;&gt;l0_ffn_down_4</title>
<path fill="none" stroke="black" d="M6320.4,-513.77C6320.4,-513.77 6320.4,-440 6320.4,-440"/>
<polygon fill="black" stroke="black" points="6323.9,-440 6320.4,-430 6316.9,-440 6323.9,-440"/>
</g>
<!-- l0_ffn_up_4&#45;&gt;l0_ffn_down_4 -->
<g id="edge126" class="edge">
<title>l0_ffn_up_4&#45;&gt;l0_ffn_down_4</title>
<path fill="none" stroke="black" d="M6405.8,-513.77C6405.8,-513.77 6405.8,-440 6405.8,-440"/>
<polygon fill="black" stroke="black" points="6409.3,-440 6405.8,-430 6402.3,-440 6409.3,-440"/>
</g>
<!-- l0_ffn_up_4&#45;&gt;l0_ffn_down_4 -->
<g id="edge222" class="edge">
<title>l0_ffn_up_4&#45;&gt;l0_ffn_down_4</title>
<path fill="none" stroke="black" d="M6491.2,-513.77C6491.2,-513.77 6491.2,-440 6491.2,-440"/>
<polygon fill="black" stroke="black" points="6494.7,-440 6491.2,-430 6487.7,-440 6494.7,-440"/>
</g>
<!-- l0_ffn_up_4&#45;&gt;l0_ffn_down_4 -->
<g id="edge342" class="edge">
<title>l0_ffn_up_4&#45;&gt;l0_ffn_down_4</title>
<path fill="none" stroke="black" d="M6576.6,-513.77C6576.6,-513.77 6576.6,-440 6576.6,-440"/>
<polygon fill="black" stroke="black" points="6580.1,-440 6576.6,-430 6573.1,-440 6580.1,-440"/>
</g>
<!-- l0_ffn_res_4 -->
<g id="node486" class="node">
<title>l0_ffn_res_4</title>
<polygon fill="lightgray" stroke="black" points="6223,-333 5676.1,-315 6223,-297 6769.9,-315 6223,-333"/>
<text text-anchor="middle" x="6223" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_down_4&#45;&gt;l0_ffn_res_4 -->
<g id="edge55" class="edge">
<title>l0_ffn_down_4&#45;&gt;l0_ffn_res_4</title>
<path fill="none" stroke="black" d="M6132.4,-393.76C6132.4,-393.76 6132.4,-340.29 6132.4,-340.29"/>
<polygon fill="black" stroke="black" points="6135.9,-340.29 6132.4,-330.29 6128.9,-340.29 6135.9,-340.29"/>
</g>
<!-- l0_ffn_down_4&#45;&gt;l0_ffn_res_4 -->
<g id="edge127" class="edge">
<title>l0_ffn_down_4&#45;&gt;l0_ffn_res_4</title>
<path fill="none" stroke="black" d="M6264.8,-393.76C6264.8,-393.76 6264.8,-341.86 6264.8,-341.86"/>
<polygon fill="black" stroke="black" points="6268.3,-341.86 6264.8,-331.86 6261.3,-341.86 6268.3,-341.86"/>
</g>
<!-- l0_ffn_down_4&#45;&gt;l0_ffn_res_4 -->
<g id="edge223" class="edge">
<title>l0_ffn_down_4&#45;&gt;l0_ffn_res_4</title>
<path fill="none" stroke="black" d="M6397.2,-393.76C6397.2,-393.76 6397.2,-337.32 6397.2,-337.32"/>
<polygon fill="black" stroke="black" points="6400.7,-337.32 6397.2,-327.32 6393.7,-337.32 6400.7,-337.32"/>
</g>
<!-- l0_ffn_down_4&#45;&gt;l0_ffn_res_4 -->
<g id="edge343" class="edge">
<title>l0_ffn_down_4&#45;&gt;l0_ffn_res_4</title>
<path fill="none" stroke="black" d="M6529.6,-393.76C6529.6,-393.76 6529.6,-333.35 6529.6,-333.35"/>
<polygon fill="black" stroke="black" points="6533.1,-333.35 6529.6,-323.35 6526.1,-333.35 6533.1,-333.35"/>
</g>
<!-- l0_ffn_res_4&#45;&gt;l0_ffn_ln_4 -->
<g id="edge57" class="edge">
<title>l0_ffn_res_4&#45;&gt;l0_ffn_ln_4</title>
<path fill="none" stroke="black" d="M6253.99,-297.94C6253.99,-297.94 6253.99,-271.2 6253.99,-271.2"/>
<polygon fill="black" stroke="black" points="6257.49,-271.2 6253.99,-261.2 6250.49,-271.2 6257.49,-271.2"/>
</g>
<!-- l0_ffn_res_4&#45;&gt;l0_ffn_ln_4 -->
<g id="edge129" class="edge">
<title>l0_ffn_res_4&#45;&gt;l0_ffn_ln_4</title>
<path fill="none" stroke="black" d="M6318.49,-300.08C6318.49,-300.08 6318.49,-271.22 6318.49,-271.22"/>
<polygon fill="black" stroke="black" points="6321.99,-271.22 6318.49,-261.22 6314.99,-271.22 6321.99,-271.22"/>
</g>
<!-- l0_ffn_res_4&#45;&gt;l0_ffn_ln_4 -->
<g id="edge225" class="edge">
<title>l0_ffn_res_4&#45;&gt;l0_ffn_ln_4</title>
<path fill="none" stroke="black" d="M6382.98,-302.13C6382.98,-302.13 6382.98,-271.17 6382.98,-271.17"/>
<polygon fill="black" stroke="black" points="6386.48,-271.17 6382.98,-261.17 6379.48,-271.17 6386.48,-271.17"/>
</g>
<!-- l0_ffn_res_4&#45;&gt;l0_ffn_ln_4 -->
<g id="edge345" class="edge">
<title>l0_ffn_res_4&#45;&gt;l0_ffn_ln_4</title>
<path fill="none" stroke="black" d="M6447.48,-304.38C6447.48,-304.38 6447.48,-271.21 6447.48,-271.21"/>
<polygon fill="black" stroke="black" points="6450.98,-271.21 6447.48,-261.21 6443.98,-271.21 6450.98,-271.21"/>
</g>
<!-- l0_ffn_ln_4&#45;&gt;l0_ffn_up_4 -->
<g id="edge53" class="edge">
<title>l0_ffn_ln_4&#45;&gt;l0_ffn_up_4</title>
<path fill="none" stroke="black" d="M6775.39,-261.08C6775.39,-261.08 6775.39,-503.93 6775.39,-503.93"/>
<polygon fill="black" stroke="black" points="6771.89,-503.93 6775.39,-513.93 6778.89,-503.93 6771.89,-503.93"/>
</g>
<!-- l0_ffn_ln_4&#45;&gt;l0_ffn_up_4 -->
<g id="edge125" class="edge">
<title>l0_ffn_ln_4&#45;&gt;l0_ffn_up_4</title>
<path fill="none" stroke="black" d="M6780.84,-261.08C6780.84,-261.08 6780.84,-503.93 6780.84,-503.93"/>
<polygon fill="black" stroke="black" points="6777.34,-503.93 6780.84,-513.93 6784.34,-503.93 6777.34,-503.93"/>
</g>
<!-- l0_ffn_ln_4&#45;&gt;l0_ffn_up_4 -->
<g id="edge221" class="edge">
<title>l0_ffn_ln_4&#45;&gt;l0_ffn_up_4</title>
<path fill="none" stroke="black" d="M6786.28,-261.08C6786.28,-261.08 6786.28,-503.93 6786.28,-503.93"/>
<polygon fill="black" stroke="black" points="6782.78,-503.93 6786.28,-513.93 6789.78,-503.93 6782.78,-503.93"/>
</g>
<!-- l0_ffn_ln_4&#45;&gt;l0_ffn_up_4 -->
<g id="edge341" class="edge">
<title>l0_ffn_ln_4&#45;&gt;l0_ffn_up_4</title>
<path fill="none" stroke="black" d="M6791.72,-261.08C6791.72,-261.08 6791.72,-503.93 6791.72,-503.93"/>
<polygon fill="black" stroke="black" points="6788.22,-503.93 6791.72,-513.93 6795.22,-503.93 6788.22,-503.93"/>
</g>
<!-- l0_ffn_ln_4&#45;&gt;l0_ffn_res_4 -->
<g id="edge56" class="edge">
<title>l0_ffn_ln_4&#45;&gt;l0_ffn_res_4</title>
<path fill="none" stroke="black" d="M6511.97,-261.17C6511.97,-261.17 6511.97,-296.43 6511.97,-296.43"/>
<polygon fill="black" stroke="black" points="6508.47,-296.43 6511.97,-306.43 6515.47,-296.43 6508.47,-296.43"/>
</g>
<!-- l0_ffn_ln_4&#45;&gt;l0_ffn_res_4 -->
<g id="edge128" class="edge">
<title>l0_ffn_ln_4&#45;&gt;l0_ffn_res_4</title>
<path fill="none" stroke="black" d="M6576.47,-261.17C6576.47,-261.17 6576.47,-298.6 6576.47,-298.6"/>
<polygon fill="black" stroke="black" points="6572.97,-298.6 6576.47,-308.6 6579.97,-298.6 6572.97,-298.6"/>
</g>
<!-- l0_ffn_ln_4&#45;&gt;l0_ffn_res_4 -->
<g id="edge224" class="edge">
<title>l0_ffn_ln_4&#45;&gt;l0_ffn_res_4</title>
<path fill="none" stroke="black" d="M6640.96,-261.17C6640.96,-261.17 6640.96,-300.5 6640.96,-300.5"/>
<polygon fill="black" stroke="black" points="6637.46,-300.5 6640.96,-310.5 6644.46,-300.5 6637.46,-300.5"/>
</g>
<!-- l0_ffn_ln_4&#45;&gt;l0_ffn_res_4 -->
<g id="edge344" class="edge">
<title>l0_ffn_ln_4&#45;&gt;l0_ffn_res_4</title>
<path fill="none" stroke="black" d="M6705.45,-261.17C6705.45,-261.17 6705.45,-302.79 6705.45,-302.79"/>
<polygon fill="black" stroke="black" points="6701.96,-302.79 6705.45,-312.79 6708.96,-302.79 6701.96,-302.79"/>
</g>
<!-- l0_ffn_up_5 -->
<g id="node488" class="node">
<title>l0_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="4459,-550 3809,-550 3809,-514 4459,-514 4459,-550"/>
<text text-anchor="middle" x="4134" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ffn_down_5 -->
<g id="node489" class="node">
<title>l0_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="4398,-430 3736,-430 3736,-394 4398,-394 4398,-430"/>
<text text-anchor="middle" x="4067" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_5&#45;&gt;l0_ffn_down_5 -->
<g id="edge60" class="edge">
<title>l0_ffn_up_5&#45;&gt;l0_ffn_down_5</title>
<path fill="none" stroke="black" d="M3926.8,-513.77C3926.8,-513.77 3926.8,-440 3926.8,-440"/>
<polygon fill="black" stroke="black" points="3930.3,-440 3926.8,-430 3923.3,-440 3930.3,-440"/>
</g>
<!-- l0_ffn_up_5&#45;&gt;l0_ffn_down_5 -->
<g id="edge132" class="edge">
<title>l0_ffn_up_5&#45;&gt;l0_ffn_down_5</title>
<path fill="none" stroke="black" d="M4044.6,-513.77C4044.6,-513.77 4044.6,-440 4044.6,-440"/>
<polygon fill="black" stroke="black" points="4048.1,-440 4044.6,-430 4041.1,-440 4048.1,-440"/>
</g>
<!-- l0_ffn_up_5&#45;&gt;l0_ffn_down_5 -->
<g id="edge228" class="edge">
<title>l0_ffn_up_5&#45;&gt;l0_ffn_down_5</title>
<path fill="none" stroke="black" d="M4162.4,-513.77C4162.4,-513.77 4162.4,-440 4162.4,-440"/>
<polygon fill="black" stroke="black" points="4165.9,-440 4162.4,-430 4158.9,-440 4165.9,-440"/>
</g>
<!-- l0_ffn_up_5&#45;&gt;l0_ffn_down_5 -->
<g id="edge348" class="edge">
<title>l0_ffn_up_5&#45;&gt;l0_ffn_down_5</title>
<path fill="none" stroke="black" d="M4280.2,-513.77C4280.2,-513.77 4280.2,-440 4280.2,-440"/>
<polygon fill="black" stroke="black" points="4283.7,-440 4280.2,-430 4276.7,-440 4283.7,-440"/>
</g>
<!-- l0_ffn_res_5 -->
<g id="node490" class="node">
<title>l0_ffn_res_5</title>
<polygon fill="lightgray" stroke="black" points="3959,-333 3412.1,-315 3959,-297 4505.9,-315 3959,-333"/>
<text text-anchor="middle" x="3959" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_down_5&#45;&gt;l0_ffn_res_5 -->
<g id="edge61" class="edge">
<title>l0_ffn_down_5&#45;&gt;l0_ffn_res_5</title>
<path fill="none" stroke="black" d="M3868.4,-393.76C3868.4,-393.76 3868.4,-340.29 3868.4,-340.29"/>
<polygon fill="black" stroke="black" points="3871.9,-340.29 3868.4,-330.29 3864.9,-340.29 3871.9,-340.29"/>
</g>
<!-- l0_ffn_down_5&#45;&gt;l0_ffn_res_5 -->
<g id="edge133" class="edge">
<title>l0_ffn_down_5&#45;&gt;l0_ffn_res_5</title>
<path fill="none" stroke="black" d="M4000.8,-393.76C4000.8,-393.76 4000.8,-341.86 4000.8,-341.86"/>
<polygon fill="black" stroke="black" points="4004.3,-341.86 4000.8,-331.86 3997.3,-341.86 4004.3,-341.86"/>
</g>
<!-- l0_ffn_down_5&#45;&gt;l0_ffn_res_5 -->
<g id="edge229" class="edge">
<title>l0_ffn_down_5&#45;&gt;l0_ffn_res_5</title>
<path fill="none" stroke="black" d="M4133.2,-393.76C4133.2,-393.76 4133.2,-337.32 4133.2,-337.32"/>
<polygon fill="black" stroke="black" points="4136.7,-337.32 4133.2,-327.32 4129.7,-337.32 4136.7,-337.32"/>
</g>
<!-- l0_ffn_down_5&#45;&gt;l0_ffn_res_5 -->
<g id="edge349" class="edge">
<title>l0_ffn_down_5&#45;&gt;l0_ffn_res_5</title>
<path fill="none" stroke="black" d="M4265.6,-393.76C4265.6,-393.76 4265.6,-333.35 4265.6,-333.35"/>
<polygon fill="black" stroke="black" points="4269.1,-333.35 4265.6,-323.35 4262.1,-333.35 4269.1,-333.35"/>
</g>
<!-- l0_ffn_res_5&#45;&gt;l0_ffn_ln_5 -->
<g id="edge63" class="edge">
<title>l0_ffn_res_5&#45;&gt;l0_ffn_ln_5</title>
<path fill="none" stroke="black" d="M3961.55,-296.83C3961.55,-296.83 3961.55,-271.41 3961.55,-271.41"/>
<polygon fill="black" stroke="black" points="3965.05,-271.41 3961.55,-261.41 3958.05,-271.41 3965.05,-271.41"/>
</g>
<!-- l0_ffn_res_5&#45;&gt;l0_ffn_ln_5 -->
<g id="edge135" class="edge">
<title>l0_ffn_res_5&#45;&gt;l0_ffn_ln_5</title>
<path fill="none" stroke="black" d="M4029.6,-299.02C4029.6,-299.02 4029.6,-271.22 4029.6,-271.22"/>
<polygon fill="black" stroke="black" points="4033.1,-271.22 4029.6,-261.22 4026.1,-271.22 4033.1,-271.22"/>
</g>
<!-- l0_ffn_res_5&#45;&gt;l0_ffn_ln_5 -->
<g id="edge231" class="edge">
<title>l0_ffn_res_5&#45;&gt;l0_ffn_ln_5</title>
<path fill="none" stroke="black" d="M4097.65,-301.46C4097.65,-301.46 4097.65,-271.1 4097.65,-271.1"/>
<polygon fill="black" stroke="black" points="4101.15,-271.1 4097.65,-261.1 4094.15,-271.1 4101.15,-271.1"/>
</g>
<!-- l0_ffn_res_5&#45;&gt;l0_ffn_ln_5 -->
<g id="edge351" class="edge">
<title>l0_ffn_res_5&#45;&gt;l0_ffn_ln_5</title>
<path fill="none" stroke="black" d="M4165.7,-303.75C4165.7,-303.75 4165.7,-271.17 4165.7,-271.17"/>
<polygon fill="black" stroke="black" points="4169.2,-271.17 4165.7,-261.17 4162.2,-271.17 4169.2,-271.17"/>
</g>
<!-- l0_ffn_ln_5&#45;&gt;l0_ffn_up_5 -->
<g id="edge59" class="edge">
<title>l0_ffn_ln_5&#45;&gt;l0_ffn_up_5</title>
<path fill="none" stroke="black" d="M4508.23,-261.24C4508.23,-323.09 4508.23,-521 4508.23,-521 4508.23,-521 4469.31,-521 4469.31,-521"/>
<polygon fill="black" stroke="black" points="4469.31,-517.5 4459.31,-521 4469.31,-524.5 4469.31,-517.5"/>
</g>
<!-- l0_ffn_ln_5&#45;&gt;l0_ffn_up_5 -->
<g id="edge131" class="edge">
<title>l0_ffn_ln_5&#45;&gt;l0_ffn_up_5</title>
<path fill="none" stroke="black" d="M4510.52,-261.26C4510.52,-324.16 4510.52,-528 4510.52,-528 4510.52,-528 4469.35,-528 4469.35,-528"/>
<polygon fill="black" stroke="black" points="4469.35,-524.5 4459.35,-528 4469.35,-531.5 4469.35,-524.5"/>
</g>
<!-- l0_ffn_ln_5&#45;&gt;l0_ffn_up_5 -->
<g id="edge227" class="edge">
<title>l0_ffn_ln_5&#45;&gt;l0_ffn_up_5</title>
<path fill="none" stroke="black" d="M4512.8,-261.27C4512.8,-325.19 4512.8,-535 4512.8,-535 4512.8,-535 4469.33,-535 4469.33,-535"/>
<polygon fill="black" stroke="black" points="4469.33,-531.5 4459.33,-535 4469.33,-538.5 4469.33,-531.5"/>
</g>
<!-- l0_ffn_ln_5&#45;&gt;l0_ffn_up_5 -->
<g id="edge347" class="edge">
<title>l0_ffn_ln_5&#45;&gt;l0_ffn_up_5</title>
<path fill="none" stroke="black" d="M4515.08,-261.25C4515.08,-326.17 4515.08,-542 4515.08,-542 4515.08,-542 4469.26,-542 4469.26,-542"/>
<polygon fill="black" stroke="black" points="4469.26,-538.5 4459.26,-542 4469.26,-545.5 4469.26,-538.5"/>
</g>
<!-- l0_ffn_ln_5&#45;&gt;l0_ffn_res_5 -->
<g id="edge62" class="edge">
<title>l0_ffn_ln_5&#45;&gt;l0_ffn_res_5</title>
<path fill="none" stroke="black" d="M4233.75,-261.17C4233.75,-261.17 4233.75,-295.65 4233.75,-295.65"/>
<polygon fill="black" stroke="black" points="4230.25,-295.65 4233.75,-305.65 4237.25,-295.65 4230.25,-295.65"/>
</g>
<!-- l0_ffn_ln_5&#45;&gt;l0_ffn_res_5 -->
<g id="edge134" class="edge">
<title>l0_ffn_ln_5&#45;&gt;l0_ffn_res_5</title>
<path fill="none" stroke="black" d="M4301.8,-261.17C4301.8,-261.17 4301.8,-298.26 4301.8,-298.26"/>
<polygon fill="black" stroke="black" points="4298.3,-298.26 4301.8,-308.26 4305.3,-298.26 4298.3,-298.26"/>
</g>
<!-- l0_ffn_ln_5&#45;&gt;l0_ffn_res_5 -->
<g id="edge230" class="edge">
<title>l0_ffn_ln_5&#45;&gt;l0_ffn_res_5</title>
<path fill="none" stroke="black" d="M4369.85,-261.17C4369.85,-261.17 4369.85,-300.5 4369.85,-300.5"/>
<polygon fill="black" stroke="black" points="4366.35,-300.5 4369.85,-310.5 4373.35,-300.5 4366.35,-300.5"/>
</g>
<!-- l0_ffn_ln_5&#45;&gt;l0_ffn_res_5 -->
<g id="edge350" class="edge">
<title>l0_ffn_ln_5&#45;&gt;l0_ffn_res_5</title>
<path fill="none" stroke="black" d="M4437.9,-261.17C4437.9,-261.17 4437.9,-302.34 4437.9,-302.34"/>
<polygon fill="black" stroke="black" points="4434.4,-302.34 4437.9,-312.34 4441.4,-302.34 4434.4,-302.34"/>
</g>
<!-- l0_ffn_up_6 -->
<g id="node492" class="node">
<title>l0_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="2357,-550 1707,-550 1707,-514 2357,-514 2357,-550"/>
<text text-anchor="middle" x="2032" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ffn_down_6 -->
<g id="node493" class="node">
<title>l0_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="2134,-430 1472,-430 1472,-394 2134,-394 2134,-430"/>
<text text-anchor="middle" x="1803" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_6&#45;&gt;l0_ffn_down_6 -->
<g id="edge66" class="edge">
<title>l0_ffn_up_6&#45;&gt;l0_ffn_down_6</title>
<path fill="none" stroke="black" d="M1792.4,-513.77C1792.4,-513.77 1792.4,-440 1792.4,-440"/>
<polygon fill="black" stroke="black" points="1795.9,-440 1792.4,-430 1788.9,-440 1795.9,-440"/>
</g>
<!-- l0_ffn_up_6&#45;&gt;l0_ffn_down_6 -->
<g id="edge138" class="edge">
<title>l0_ffn_up_6&#45;&gt;l0_ffn_down_6</title>
<path fill="none" stroke="black" d="M1877.8,-513.77C1877.8,-513.77 1877.8,-440 1877.8,-440"/>
<polygon fill="black" stroke="black" points="1881.3,-440 1877.8,-430 1874.3,-440 1881.3,-440"/>
</g>
<!-- l0_ffn_up_6&#45;&gt;l0_ffn_down_6 -->
<g id="edge234" class="edge">
<title>l0_ffn_up_6&#45;&gt;l0_ffn_down_6</title>
<path fill="none" stroke="black" d="M1963.2,-513.77C1963.2,-513.77 1963.2,-440 1963.2,-440"/>
<polygon fill="black" stroke="black" points="1966.7,-440 1963.2,-430 1959.7,-440 1966.7,-440"/>
</g>
<!-- l0_ffn_up_6&#45;&gt;l0_ffn_down_6 -->
<g id="edge354" class="edge">
<title>l0_ffn_up_6&#45;&gt;l0_ffn_down_6</title>
<path fill="none" stroke="black" d="M2048.6,-513.77C2048.6,-513.77 2048.6,-440 2048.6,-440"/>
<polygon fill="black" stroke="black" points="2052.1,-440 2048.6,-430 2045.1,-440 2052.1,-440"/>
</g>
<!-- l0_ffn_res_6 -->
<g id="node494" class="node">
<title>l0_ffn_res_6</title>
<polygon fill="lightgray" stroke="black" points="1695,-333 1148.1,-315 1695,-297 2241.9,-315 1695,-333"/>
<text text-anchor="middle" x="1695" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_down_6&#45;&gt;l0_ffn_res_6 -->
<g id="edge67" class="edge">
<title>l0_ffn_down_6&#45;&gt;l0_ffn_res_6</title>
<path fill="none" stroke="black" d="M1604.4,-393.76C1604.4,-393.76 1604.4,-340.29 1604.4,-340.29"/>
<polygon fill="black" stroke="black" points="1607.9,-340.29 1604.4,-330.29 1600.9,-340.29 1607.9,-340.29"/>
</g>
<!-- l0_ffn_down_6&#45;&gt;l0_ffn_res_6 -->
<g id="edge139" class="edge">
<title>l0_ffn_down_6&#45;&gt;l0_ffn_res_6</title>
<path fill="none" stroke="black" d="M1736.8,-393.76C1736.8,-393.76 1736.8,-341.86 1736.8,-341.86"/>
<polygon fill="black" stroke="black" points="1740.3,-341.86 1736.8,-331.86 1733.3,-341.86 1740.3,-341.86"/>
</g>
<!-- l0_ffn_down_6&#45;&gt;l0_ffn_res_6 -->
<g id="edge235" class="edge">
<title>l0_ffn_down_6&#45;&gt;l0_ffn_res_6</title>
<path fill="none" stroke="black" d="M1869.2,-393.76C1869.2,-393.76 1869.2,-337.32 1869.2,-337.32"/>
<polygon fill="black" stroke="black" points="1872.7,-337.32 1869.2,-327.32 1865.7,-337.32 1872.7,-337.32"/>
</g>
<!-- l0_ffn_down_6&#45;&gt;l0_ffn_res_6 -->
<g id="edge355" class="edge">
<title>l0_ffn_down_6&#45;&gt;l0_ffn_res_6</title>
<path fill="none" stroke="black" d="M2001.6,-393.76C2001.6,-393.76 2001.6,-333.35 2001.6,-333.35"/>
<polygon fill="black" stroke="black" points="2005.1,-333.35 2001.6,-323.35 1998.1,-333.35 2005.1,-333.35"/>
</g>
<!-- l0_ffn_res_6&#45;&gt;l0_ffn_ln_6 -->
<g id="edge69" class="edge">
<title>l0_ffn_res_6&#45;&gt;l0_ffn_ln_6</title>
<path fill="none" stroke="black" d="M1725.99,-297.94C1725.99,-297.94 1725.99,-271.2 1725.99,-271.2"/>
<polygon fill="black" stroke="black" points="1729.49,-271.2 1725.99,-261.2 1722.49,-271.2 1729.49,-271.2"/>
</g>
<!-- l0_ffn_res_6&#45;&gt;l0_ffn_ln_6 -->
<g id="edge141" class="edge">
<title>l0_ffn_res_6&#45;&gt;l0_ffn_ln_6</title>
<path fill="none" stroke="black" d="M1790.49,-300.08C1790.49,-300.08 1790.49,-271.22 1790.49,-271.22"/>
<polygon fill="black" stroke="black" points="1793.99,-271.22 1790.49,-261.22 1786.99,-271.22 1793.99,-271.22"/>
</g>
<!-- l0_ffn_res_6&#45;&gt;l0_ffn_ln_6 -->
<g id="edge237" class="edge">
<title>l0_ffn_res_6&#45;&gt;l0_ffn_ln_6</title>
<path fill="none" stroke="black" d="M1854.98,-302.13C1854.98,-302.13 1854.98,-271.17 1854.98,-271.17"/>
<polygon fill="black" stroke="black" points="1858.48,-271.17 1854.98,-261.17 1851.48,-271.17 1858.48,-271.17"/>
</g>
<!-- l0_ffn_res_6&#45;&gt;l0_ffn_ln_6 -->
<g id="edge357" class="edge">
<title>l0_ffn_res_6&#45;&gt;l0_ffn_ln_6</title>
<path fill="none" stroke="black" d="M1919.48,-304.38C1919.48,-304.38 1919.48,-271.21 1919.48,-271.21"/>
<polygon fill="black" stroke="black" points="1922.98,-271.21 1919.48,-261.21 1915.98,-271.21 1922.98,-271.21"/>
</g>
<!-- l0_ffn_ln_6&#45;&gt;l0_ffn_up_6 -->
<g id="edge65" class="edge">
<title>l0_ffn_ln_6&#45;&gt;l0_ffn_up_6</title>
<path fill="none" stroke="black" d="M2247.39,-261.08C2247.39,-261.08 2247.39,-503.93 2247.39,-503.93"/>
<polygon fill="black" stroke="black" points="2243.89,-503.93 2247.39,-513.93 2250.89,-503.93 2243.89,-503.93"/>
</g>
<!-- l0_ffn_ln_6&#45;&gt;l0_ffn_up_6 -->
<g id="edge137" class="edge">
<title>l0_ffn_ln_6&#45;&gt;l0_ffn_up_6</title>
<path fill="none" stroke="black" d="M2252.84,-261.08C2252.84,-261.08 2252.84,-503.93 2252.84,-503.93"/>
<polygon fill="black" stroke="black" points="2249.34,-503.93 2252.84,-513.93 2256.34,-503.93 2249.34,-503.93"/>
</g>
<!-- l0_ffn_ln_6&#45;&gt;l0_ffn_up_6 -->
<g id="edge233" class="edge">
<title>l0_ffn_ln_6&#45;&gt;l0_ffn_up_6</title>
<path fill="none" stroke="black" d="M2258.28,-261.08C2258.28,-261.08 2258.28,-503.93 2258.28,-503.93"/>
<polygon fill="black" stroke="black" points="2254.78,-503.93 2258.28,-513.93 2261.78,-503.93 2254.78,-503.93"/>
</g>
<!-- l0_ffn_ln_6&#45;&gt;l0_ffn_up_6 -->
<g id="edge353" class="edge">
<title>l0_ffn_ln_6&#45;&gt;l0_ffn_up_6</title>
<path fill="none" stroke="black" d="M2263.72,-261.08C2263.72,-261.08 2263.72,-503.93 2263.72,-503.93"/>
<polygon fill="black" stroke="black" points="2260.22,-503.93 2263.72,-513.93 2267.22,-503.93 2260.22,-503.93"/>
</g>
<!-- l0_ffn_ln_6&#45;&gt;l0_ffn_res_6 -->
<g id="edge68" class="edge">
<title>l0_ffn_ln_6&#45;&gt;l0_ffn_res_6</title>
<path fill="none" stroke="black" d="M1983.97,-261.17C1983.97,-261.17 1983.97,-296.43 1983.97,-296.43"/>
<polygon fill="black" stroke="black" points="1980.47,-296.43 1983.97,-306.43 1987.47,-296.43 1980.47,-296.43"/>
</g>
<!-- l0_ffn_ln_6&#45;&gt;l0_ffn_res_6 -->
<g id="edge140" class="edge">
<title>l0_ffn_ln_6&#45;&gt;l0_ffn_res_6</title>
<path fill="none" stroke="black" d="M2048.47,-261.17C2048.47,-261.17 2048.47,-298.6 2048.47,-298.6"/>
<polygon fill="black" stroke="black" points="2044.97,-298.6 2048.47,-308.6 2051.97,-298.6 2044.97,-298.6"/>
</g>
<!-- l0_ffn_ln_6&#45;&gt;l0_ffn_res_6 -->
<g id="edge236" class="edge">
<title>l0_ffn_ln_6&#45;&gt;l0_ffn_res_6</title>
<path fill="none" stroke="black" d="M2112.96,-261.17C2112.96,-261.17 2112.96,-300.5 2112.96,-300.5"/>
<polygon fill="black" stroke="black" points="2109.46,-300.5 2112.96,-310.5 2116.46,-300.5 2109.46,-300.5"/>
</g>
<!-- l0_ffn_ln_6&#45;&gt;l0_ffn_res_6 -->
<g id="edge356" class="edge">
<title>l0_ffn_ln_6&#45;&gt;l0_ffn_res_6</title>
<path fill="none" stroke="black" d="M2177.45,-261.17C2177.45,-261.17 2177.45,-302.79 2177.45,-302.79"/>
<polygon fill="black" stroke="black" points="2173.96,-302.79 2177.45,-312.79 2180.96,-302.79 2173.96,-302.79"/>
</g>
<!-- l0_ffn_up_7 -->
<g id="node496" class="node">
<title>l0_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="8017,-550 7367,-550 7367,-514 8017,-514 8017,-550"/>
<text text-anchor="middle" x="7692" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ffn_down_7 -->
<g id="node497" class="node">
<title>l0_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="7794,-430 7132,-430 7132,-394 7794,-394 7794,-430"/>
<text text-anchor="middle" x="7463" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_7&#45;&gt;l0_ffn_down_7 -->
<g id="edge72" class="edge">
<title>l0_ffn_up_7&#45;&gt;l0_ffn_down_7</title>
<path fill="none" stroke="black" d="M7452.4,-513.77C7452.4,-513.77 7452.4,-440 7452.4,-440"/>
<polygon fill="black" stroke="black" points="7455.9,-440 7452.4,-430 7448.9,-440 7455.9,-440"/>
</g>
<!-- l0_ffn_up_7&#45;&gt;l0_ffn_down_7 -->
<g id="edge144" class="edge">
<title>l0_ffn_up_7&#45;&gt;l0_ffn_down_7</title>
<path fill="none" stroke="black" d="M7537.8,-513.77C7537.8,-513.77 7537.8,-440 7537.8,-440"/>
<polygon fill="black" stroke="black" points="7541.3,-440 7537.8,-430 7534.3,-440 7541.3,-440"/>
</g>
<!-- l0_ffn_up_7&#45;&gt;l0_ffn_down_7 -->
<g id="edge240" class="edge">
<title>l0_ffn_up_7&#45;&gt;l0_ffn_down_7</title>
<path fill="none" stroke="black" d="M7623.2,-513.77C7623.2,-513.77 7623.2,-440 7623.2,-440"/>
<polygon fill="black" stroke="black" points="7626.7,-440 7623.2,-430 7619.7,-440 7626.7,-440"/>
</g>
<!-- l0_ffn_up_7&#45;&gt;l0_ffn_down_7 -->
<g id="edge360" class="edge">
<title>l0_ffn_up_7&#45;&gt;l0_ffn_down_7</title>
<path fill="none" stroke="black" d="M7708.6,-513.77C7708.6,-513.77 7708.6,-440 7708.6,-440"/>
<polygon fill="black" stroke="black" points="7712.1,-440 7708.6,-430 7705.1,-440 7712.1,-440"/>
</g>
<!-- l0_ffn_res_7 -->
<g id="node498" class="node">
<title>l0_ffn_res_7</title>
<polygon fill="lightgray" stroke="black" points="7355,-333 6808.1,-315 7355,-297 7901.9,-315 7355,-333"/>
<text text-anchor="middle" x="7355" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_down_7&#45;&gt;l0_ffn_res_7 -->
<g id="edge73" class="edge">
<title>l0_ffn_down_7&#45;&gt;l0_ffn_res_7</title>
<path fill="none" stroke="black" d="M7264.4,-393.76C7264.4,-393.76 7264.4,-340.29 7264.4,-340.29"/>
<polygon fill="black" stroke="black" points="7267.9,-340.29 7264.4,-330.29 7260.9,-340.29 7267.9,-340.29"/>
</g>
<!-- l0_ffn_down_7&#45;&gt;l0_ffn_res_7 -->
<g id="edge145" class="edge">
<title>l0_ffn_down_7&#45;&gt;l0_ffn_res_7</title>
<path fill="none" stroke="black" d="M7396.8,-393.76C7396.8,-393.76 7396.8,-341.86 7396.8,-341.86"/>
<polygon fill="black" stroke="black" points="7400.3,-341.86 7396.8,-331.86 7393.3,-341.86 7400.3,-341.86"/>
</g>
<!-- l0_ffn_down_7&#45;&gt;l0_ffn_res_7 -->
<g id="edge241" class="edge">
<title>l0_ffn_down_7&#45;&gt;l0_ffn_res_7</title>
<path fill="none" stroke="black" d="M7529.2,-393.76C7529.2,-393.76 7529.2,-337.32 7529.2,-337.32"/>
<polygon fill="black" stroke="black" points="7532.7,-337.32 7529.2,-327.32 7525.7,-337.32 7532.7,-337.32"/>
</g>
<!-- l0_ffn_down_7&#45;&gt;l0_ffn_res_7 -->
<g id="edge361" class="edge">
<title>l0_ffn_down_7&#45;&gt;l0_ffn_res_7</title>
<path fill="none" stroke="black" d="M7661.6,-393.76C7661.6,-393.76 7661.6,-333.35 7661.6,-333.35"/>
<polygon fill="black" stroke="black" points="7665.1,-333.35 7661.6,-323.35 7658.1,-333.35 7665.1,-333.35"/>
</g>
<!-- l0_ffn_res_7&#45;&gt;l0_ffn_ln_7 -->
<g id="edge75" class="edge">
<title>l0_ffn_res_7&#45;&gt;l0_ffn_ln_7</title>
<path fill="none" stroke="black" d="M7459.77,-300.43C7459.77,-300.43 7459.77,-271.13 7459.77,-271.13"/>
<polygon fill="black" stroke="black" points="7463.27,-271.13 7459.77,-261.13 7456.27,-271.13 7463.27,-271.13"/>
</g>
<!-- l0_ffn_res_7&#45;&gt;l0_ffn_ln_7 -->
<g id="edge147" class="edge">
<title>l0_ffn_res_7&#45;&gt;l0_ffn_ln_7</title>
<path fill="none" stroke="black" d="M7515.04,-302.13C7515.04,-302.13 7515.04,-271.17 7515.04,-271.17"/>
<polygon fill="black" stroke="black" points="7518.54,-271.17 7515.04,-261.17 7511.54,-271.17 7518.54,-271.17"/>
</g>
<!-- l0_ffn_res_7&#45;&gt;l0_ffn_ln_7 -->
<g id="edge243" class="edge">
<title>l0_ffn_res_7&#45;&gt;l0_ffn_ln_7</title>
<path fill="none" stroke="black" d="M7570.32,-304.06C7570.32,-304.06 7570.32,-271.05 7570.32,-271.05"/>
<polygon fill="black" stroke="black" points="7573.82,-271.05 7570.32,-261.05 7566.82,-271.05 7573.82,-271.05"/>
</g>
<!-- l0_ffn_res_7&#45;&gt;l0_ffn_ln_7 -->
<g id="edge363" class="edge">
<title>l0_ffn_res_7&#45;&gt;l0_ffn_ln_7</title>
<path fill="none" stroke="black" d="M7625.59,-305.88C7625.59,-305.88 7625.59,-271.15 7625.59,-271.15"/>
<polygon fill="black" stroke="black" points="7629.09,-271.15 7625.59,-261.15 7622.09,-271.15 7629.09,-271.15"/>
</g>
<!-- l0_ffn_ln_7&#45;&gt;l0_ffn_up_7 -->
<g id="edge71" class="edge">
<title>l0_ffn_ln_7&#45;&gt;l0_ffn_up_7</title>
<path fill="none" stroke="black" d="M7907.39,-261.08C7907.39,-261.08 7907.39,-503.93 7907.39,-503.93"/>
<polygon fill="black" stroke="black" points="7903.89,-503.93 7907.39,-513.93 7910.89,-503.93 7903.89,-503.93"/>
</g>
<!-- l0_ffn_ln_7&#45;&gt;l0_ffn_up_7 -->
<g id="edge143" class="edge">
<title>l0_ffn_ln_7&#45;&gt;l0_ffn_up_7</title>
<path fill="none" stroke="black" d="M7912.84,-261.08C7912.84,-261.08 7912.84,-503.93 7912.84,-503.93"/>
<polygon fill="black" stroke="black" points="7909.34,-503.93 7912.84,-513.93 7916.34,-503.93 7909.34,-503.93"/>
</g>
<!-- l0_ffn_ln_7&#45;&gt;l0_ffn_up_7 -->
<g id="edge239" class="edge">
<title>l0_ffn_ln_7&#45;&gt;l0_ffn_up_7</title>
<path fill="none" stroke="black" d="M7918.28,-261.08C7918.28,-261.08 7918.28,-503.93 7918.28,-503.93"/>
<polygon fill="black" stroke="black" points="7914.78,-503.93 7918.28,-513.93 7921.78,-503.93 7914.78,-503.93"/>
</g>
<!-- l0_ffn_ln_7&#45;&gt;l0_ffn_up_7 -->
<g id="edge359" class="edge">
<title>l0_ffn_ln_7&#45;&gt;l0_ffn_up_7</title>
<path fill="none" stroke="black" d="M7923.72,-261.08C7923.72,-261.08 7923.72,-503.93 7923.72,-503.93"/>
<polygon fill="black" stroke="black" points="7920.22,-503.93 7923.72,-513.93 7927.22,-503.93 7920.22,-503.93"/>
</g>
<!-- l0_ffn_ln_7&#45;&gt;l0_ffn_res_7 -->
<g id="edge74" class="edge">
<title>l0_ffn_ln_7&#45;&gt;l0_ffn_res_7</title>
<path fill="none" stroke="black" d="M7680.86,-261.17C7680.86,-261.17 7680.86,-297.55 7680.86,-297.55"/>
<polygon fill="black" stroke="black" points="7677.36,-297.55 7680.86,-307.55 7684.36,-297.55 7677.36,-297.55"/>
</g>
<!-- l0_ffn_ln_7&#45;&gt;l0_ffn_res_7 -->
<g id="edge146" class="edge">
<title>l0_ffn_ln_7&#45;&gt;l0_ffn_res_7</title>
<path fill="none" stroke="black" d="M7736.13,-261.17C7736.13,-261.17 7736.13,-299.27 7736.13,-299.27"/>
<polygon fill="black" stroke="black" points="7732.63,-299.27 7736.13,-309.27 7739.63,-299.27 7732.63,-299.27"/>
</g>
<!-- l0_ffn_ln_7&#45;&gt;l0_ffn_res_7 -->
<g id="edge242" class="edge">
<title>l0_ffn_ln_7&#45;&gt;l0_ffn_res_7</title>
<path fill="none" stroke="black" d="M7791.41,-261.17C7791.41,-261.17 7791.41,-301.34 7791.41,-301.34"/>
<polygon fill="black" stroke="black" points="7787.91,-301.34 7791.41,-311.34 7794.91,-301.34 7787.91,-301.34"/>
</g>
<!-- l0_ffn_ln_7&#45;&gt;l0_ffn_res_7 -->
<g id="edge362" class="edge">
<title>l0_ffn_ln_7&#45;&gt;l0_ffn_res_7</title>
<path fill="none" stroke="black" d="M7846.68,-261.17C7846.68,-261.17 7846.68,-302.79 7846.68,-302.79"/>
<polygon fill="black" stroke="black" points="7843.18,-302.79 7846.68,-312.79 7850.18,-302.79 7843.18,-302.79"/>
</g>
<!-- l1_ffn_up_0 -->
<g id="node500" class="node">
<title>l1_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="23863,-550 23213,-550 23213,-514 23863,-514 23863,-550"/>
<text text-anchor="middle" x="23538" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ffn_down_0 -->
<g id="node501" class="node">
<title>l1_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="24186,-430 23524,-430 23524,-394 24186,-394 24186,-430"/>
<text text-anchor="middle" x="23855" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_0&#45;&gt;l1_ffn_down_0 -->
<g id="edge367" class="edge">
<title>l1_ffn_up_0&#45;&gt;l1_ffn_down_0</title>
<path fill="none" stroke="black" d="M23591.8,-513.77C23591.8,-513.77 23591.8,-440 23591.8,-440"/>
<polygon fill="black" stroke="black" points="23595.3,-440 23591.8,-430 23588.3,-440 23595.3,-440"/>
</g>
<!-- l1_ffn_up_0&#45;&gt;l1_ffn_down_0 -->
<g id="edge439" class="edge">
<title>l1_ffn_up_0&#45;&gt;l1_ffn_down_0</title>
<path fill="none" stroke="black" d="M23659.6,-513.77C23659.6,-513.77 23659.6,-440 23659.6,-440"/>
<polygon fill="black" stroke="black" points="23663.1,-440 23659.6,-430 23656.1,-440 23663.1,-440"/>
</g>
<!-- l1_ffn_up_0&#45;&gt;l1_ffn_down_0 -->
<g id="edge535" class="edge">
<title>l1_ffn_up_0&#45;&gt;l1_ffn_down_0</title>
<path fill="none" stroke="black" d="M23727.4,-513.77C23727.4,-513.77 23727.4,-440 23727.4,-440"/>
<polygon fill="black" stroke="black" points="23730.9,-440 23727.4,-430 23723.9,-440 23730.9,-440"/>
</g>
<!-- l1_ffn_up_0&#45;&gt;l1_ffn_down_0 -->
<g id="edge655" class="edge">
<title>l1_ffn_up_0&#45;&gt;l1_ffn_down_0</title>
<path fill="none" stroke="black" d="M23795.2,-513.77C23795.2,-513.77 23795.2,-440 23795.2,-440"/>
<polygon fill="black" stroke="black" points="23798.7,-440 23795.2,-430 23791.7,-440 23798.7,-440"/>
</g>
<!-- l1_ffn_res_0 -->
<g id="node502" class="node">
<title>l1_ffn_res_0</title>
<polygon fill="lightgray" stroke="black" points="23963,-333 23416.1,-315 23963,-297 24509.9,-315 23963,-333"/>
<text text-anchor="middle" x="23963" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_down_0&#45;&gt;l1_ffn_res_0 -->
<g id="edge368" class="edge">
<title>l1_ffn_down_0&#45;&gt;l1_ffn_res_0</title>
<path fill="none" stroke="black" d="M23656.4,-393.76C23656.4,-393.76 23656.4,-333.35 23656.4,-333.35"/>
<polygon fill="black" stroke="black" points="23659.9,-333.35 23656.4,-323.35 23652.9,-333.35 23659.9,-333.35"/>
</g>
<!-- l1_ffn_down_0&#45;&gt;l1_ffn_res_0 -->
<g id="edge440" class="edge">
<title>l1_ffn_down_0&#45;&gt;l1_ffn_res_0</title>
<path fill="none" stroke="black" d="M23788.8,-393.76C23788.8,-393.76 23788.8,-337.32 23788.8,-337.32"/>
<polygon fill="black" stroke="black" points="23792.3,-337.32 23788.8,-327.32 23785.3,-337.32 23792.3,-337.32"/>
</g>
<!-- l1_ffn_down_0&#45;&gt;l1_ffn_res_0 -->
<g id="edge536" class="edge">
<title>l1_ffn_down_0&#45;&gt;l1_ffn_res_0</title>
<path fill="none" stroke="black" d="M23921.2,-393.76C23921.2,-393.76 23921.2,-341.86 23921.2,-341.86"/>
<polygon fill="black" stroke="black" points="23924.7,-341.86 23921.2,-331.86 23917.7,-341.86 23924.7,-341.86"/>
</g>
<!-- l1_ffn_down_0&#45;&gt;l1_ffn_res_0 -->
<g id="edge656" class="edge">
<title>l1_ffn_down_0&#45;&gt;l1_ffn_res_0</title>
<path fill="none" stroke="black" d="M24053.6,-393.76C24053.6,-393.76 24053.6,-340.29 24053.6,-340.29"/>
<polygon fill="black" stroke="black" points="24057.1,-340.29 24053.6,-330.29 24050.1,-340.29 24057.1,-340.29"/>
</g>
<!-- l1_ffn_res_0&#45;&gt;l1_ffn_ln_0 -->
<g id="edge370" class="edge">
<title>l1_ffn_res_0&#45;&gt;l1_ffn_ln_0</title>
<path fill="none" stroke="black" d="M23773.1,-303.11C23773.1,-303.11 23773.1,-271.12 23773.1,-271.12"/>
<polygon fill="black" stroke="black" points="23776.6,-271.12 23773.1,-261.12 23769.6,-271.12 23776.6,-271.12"/>
</g>
<!-- l1_ffn_res_0&#45;&gt;l1_ffn_ln_0 -->
<g id="edge442" class="edge">
<title>l1_ffn_res_0&#45;&gt;l1_ffn_ln_0</title>
<path fill="none" stroke="black" d="M23836.4,-301.12C23836.4,-301.12 23836.4,-271.2 23836.4,-271.2"/>
<polygon fill="black" stroke="black" points="23839.9,-271.2 23836.4,-261.2 23832.9,-271.2 23839.9,-271.2"/>
</g>
<!-- l1_ffn_res_0&#45;&gt;l1_ffn_ln_0 -->
<g id="edge538" class="edge">
<title>l1_ffn_res_0&#45;&gt;l1_ffn_ln_0</title>
<path fill="none" stroke="black" d="M23899.7,-299.02C23899.7,-299.02 23899.7,-271.22 23899.7,-271.22"/>
<polygon fill="black" stroke="black" points="23903.2,-271.22 23899.7,-261.22 23896.2,-271.22 23903.2,-271.22"/>
</g>
<!-- l1_ffn_res_0&#45;&gt;l1_ffn_ln_0 -->
<g id="edge658" class="edge">
<title>l1_ffn_res_0&#45;&gt;l1_ffn_ln_0</title>
<path fill="none" stroke="black" d="M23963,-296.83C23963,-296.83 23963,-271.41 23963,-271.41"/>
<polygon fill="black" stroke="black" points="23966.5,-271.41 23963,-261.41 23959.5,-271.41 23966.5,-271.41"/>
</g>
<!-- l1_ffn_ln_0&#45;&gt;l1_ffn_up_0 -->
<g id="edge366" class="edge">
<title>l1_ffn_ln_0&#45;&gt;l1_ffn_up_0</title>
<path fill="none" stroke="black" d="M23646.36,-249C23522.57,-249 23409.7,-249 23409.7,-249 23409.7,-249 23409.7,-503.87 23409.7,-503.87"/>
<polygon fill="black" stroke="black" points="23406.2,-503.87 23409.7,-513.87 23413.2,-503.87 23406.2,-503.87"/>
</g>
<!-- l1_ffn_ln_0&#45;&gt;l1_ffn_up_0 -->
<g id="edge438" class="edge">
<title>l1_ffn_ln_0&#45;&gt;l1_ffn_up_0</title>
<path fill="none" stroke="black" d="M23646.38,-243C23519.75,-243 23403.35,-243 23403.35,-243 23403.35,-243 23403.35,-503.92 23403.35,-503.92"/>
<polygon fill="black" stroke="black" points="23399.85,-503.92 23403.35,-513.92 23406.85,-503.92 23399.85,-503.92"/>
</g>
<!-- l1_ffn_ln_0&#45;&gt;l1_ffn_up_0 -->
<g id="edge534" class="edge">
<title>l1_ffn_ln_0&#45;&gt;l1_ffn_up_0</title>
<path fill="none" stroke="black" d="M23646.49,-237C23517,-237 23397,-237 23397,-237 23397,-237 23397,-503.99 23397,-503.99"/>
<polygon fill="black" stroke="black" points="23393.5,-503.99 23397,-513.99 23400.5,-503.99 23393.5,-503.99"/>
</g>
<!-- l1_ffn_ln_0&#45;&gt;l1_ffn_up_0 -->
<g id="edge654" class="edge">
<title>l1_ffn_ln_0&#45;&gt;l1_ffn_up_0</title>
<path fill="none" stroke="black" d="M23646.27,-231C23514.06,-231 23390.65,-231 23390.65,-231 23390.65,-231 23390.65,-503.62 23390.65,-503.62"/>
<polygon fill="black" stroke="black" points="23387.15,-503.62 23390.65,-513.62 23394.15,-503.62 23387.15,-503.62"/>
</g>
<!-- l1_ffn_ln_0&#45;&gt;l1_ffn_res_0 -->
<g id="edge369" class="edge">
<title>l1_ffn_ln_0&#45;&gt;l1_ffn_res_0</title>
<path fill="none" stroke="black" d="M24026.3,-261.17C24026.3,-261.17 24026.3,-289.04 24026.3,-289.04"/>
<polygon fill="black" stroke="black" points="24022.8,-289.04 24026.3,-299.04 24029.8,-289.04 24022.8,-289.04"/>
</g>
<!-- l1_ffn_ln_0&#45;&gt;l1_ffn_res_0 -->
<g id="edge441" class="edge">
<title>l1_ffn_ln_0&#45;&gt;l1_ffn_res_0</title>
<path fill="none" stroke="black" d="M24089.6,-261.17C24089.6,-261.17 24089.6,-290.93 24089.6,-290.93"/>
<polygon fill="black" stroke="black" points="24086.1,-290.93 24089.6,-300.93 24093.1,-290.93 24086.1,-290.93"/>
</g>
<!-- l1_ffn_ln_0&#45;&gt;l1_ffn_res_0 -->
<g id="edge537" class="edge">
<title>l1_ffn_ln_0&#45;&gt;l1_ffn_res_0</title>
<path fill="none" stroke="black" d="M24152.9,-261.17C24152.9,-261.17 24152.9,-293.16 24152.9,-293.16"/>
<polygon fill="black" stroke="black" points="24149.4,-293.16 24152.9,-303.16 24156.4,-293.16 24149.4,-293.16"/>
</g>
<!-- l1_ffn_ln_0&#45;&gt;l1_ffn_res_0 -->
<g id="edge657" class="edge">
<title>l1_ffn_ln_0&#45;&gt;l1_ffn_res_0</title>
<path fill="none" stroke="black" d="M24216.2,-261.17C24216.2,-261.17 24216.2,-295.25 24216.2,-295.25"/>
<polygon fill="black" stroke="black" points="24212.7,-295.25 24216.2,-305.25 24219.7,-295.25 24212.7,-295.25"/>
</g>
<!-- l1_ffn_up_1 -->
<g id="node504" class="node">
<title>l1_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="22963,-550 22313,-550 22313,-514 22963,-514 22963,-550"/>
<text text-anchor="middle" x="22638" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ffn_down_1 -->
<g id="node505" class="node">
<title>l1_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="23111,-430 22449,-430 22449,-394 23111,-394 23111,-430"/>
<text text-anchor="middle" x="22780" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_1&#45;&gt;l1_ffn_down_1 -->
<g id="edge373" class="edge">
<title>l1_ffn_up_1&#45;&gt;l1_ffn_down_1</title>
<path fill="none" stroke="black" d="M22551.8,-513.77C22551.8,-513.77 22551.8,-440 22551.8,-440"/>
<polygon fill="black" stroke="black" points="22555.3,-440 22551.8,-430 22548.3,-440 22555.3,-440"/>
</g>
<!-- l1_ffn_up_1&#45;&gt;l1_ffn_down_1 -->
<g id="edge445" class="edge">
<title>l1_ffn_up_1&#45;&gt;l1_ffn_down_1</title>
<path fill="none" stroke="black" d="M22654.6,-513.77C22654.6,-513.77 22654.6,-440 22654.6,-440"/>
<polygon fill="black" stroke="black" points="22658.1,-440 22654.6,-430 22651.1,-440 22658.1,-440"/>
</g>
<!-- l1_ffn_up_1&#45;&gt;l1_ffn_down_1 -->
<g id="edge541" class="edge">
<title>l1_ffn_up_1&#45;&gt;l1_ffn_down_1</title>
<path fill="none" stroke="black" d="M22757.4,-513.77C22757.4,-513.77 22757.4,-440 22757.4,-440"/>
<polygon fill="black" stroke="black" points="22760.9,-440 22757.4,-430 22753.9,-440 22760.9,-440"/>
</g>
<!-- l1_ffn_up_1&#45;&gt;l1_ffn_down_1 -->
<g id="edge661" class="edge">
<title>l1_ffn_up_1&#45;&gt;l1_ffn_down_1</title>
<path fill="none" stroke="black" d="M22860.2,-513.77C22860.2,-513.77 22860.2,-440 22860.2,-440"/>
<polygon fill="black" stroke="black" points="22863.7,-440 22860.2,-430 22856.7,-440 22863.7,-440"/>
</g>
<!-- l1_ffn_res_1 -->
<g id="node506" class="node">
<title>l1_ffn_res_1</title>
<polygon fill="lightgray" stroke="black" points="22831,-333 22284.1,-315 22831,-297 23377.9,-315 22831,-333"/>
<text text-anchor="middle" x="22831" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_down_1&#45;&gt;l1_ffn_res_1 -->
<g id="edge374" class="edge">
<title>l1_ffn_down_1&#45;&gt;l1_ffn_res_1</title>
<path fill="none" stroke="black" d="M22581.4,-393.76C22581.4,-393.76 22581.4,-334.87 22581.4,-334.87"/>
<polygon fill="black" stroke="black" points="22584.9,-334.87 22581.4,-324.87 22577.9,-334.87 22584.9,-334.87"/>
</g>
<!-- l1_ffn_down_1&#45;&gt;l1_ffn_res_1 -->
<g id="edge446" class="edge">
<title>l1_ffn_down_1&#45;&gt;l1_ffn_res_1</title>
<path fill="none" stroke="black" d="M22713.8,-393.76C22713.8,-393.76 22713.8,-339.37 22713.8,-339.37"/>
<polygon fill="black" stroke="black" points="22717.3,-339.37 22713.8,-329.37 22710.3,-339.37 22717.3,-339.37"/>
</g>
<!-- l1_ffn_down_1&#45;&gt;l1_ffn_res_1 -->
<g id="edge542" class="edge">
<title>l1_ffn_down_1&#45;&gt;l1_ffn_res_1</title>
<path fill="none" stroke="black" d="M22846.2,-393.76C22846.2,-393.76 22846.2,-342.51 22846.2,-342.51"/>
<polygon fill="black" stroke="black" points="22849.7,-342.51 22846.2,-332.51 22842.7,-342.51 22849.7,-342.51"/>
</g>
<!-- l1_ffn_down_1&#45;&gt;l1_ffn_res_1 -->
<g id="edge662" class="edge">
<title>l1_ffn_down_1&#45;&gt;l1_ffn_res_1</title>
<path fill="none" stroke="black" d="M22978.6,-393.76C22978.6,-393.76 22978.6,-338.19 22978.6,-338.19"/>
<polygon fill="black" stroke="black" points="22982.1,-338.19 22978.6,-328.19 22975.1,-338.19 22982.1,-338.19"/>
</g>
<!-- l1_ffn_res_1&#45;&gt;l1_ffn_ln_1 -->
<g id="edge376" class="edge">
<title>l1_ffn_res_1&#45;&gt;l1_ffn_ln_1</title>
<path fill="none" stroke="black" d="M22620,-303.75C22620,-303.75 22620,-271.17 22620,-271.17"/>
<polygon fill="black" stroke="black" points="22623.5,-271.17 22620,-261.17 22616.5,-271.17 22623.5,-271.17"/>
</g>
<!-- l1_ffn_res_1&#45;&gt;l1_ffn_ln_1 -->
<g id="edge448" class="edge">
<title>l1_ffn_res_1&#45;&gt;l1_ffn_ln_1</title>
<path fill="none" stroke="black" d="M22672.75,-302.13C22672.75,-302.13 22672.75,-271.17 22672.75,-271.17"/>
<polygon fill="black" stroke="black" points="22676.25,-271.17 22672.75,-261.17 22669.25,-271.17 22676.25,-271.17"/>
</g>
<!-- l1_ffn_res_1&#45;&gt;l1_ffn_ln_1 -->
<g id="edge544" class="edge">
<title>l1_ffn_res_1&#45;&gt;l1_ffn_ln_1</title>
<path fill="none" stroke="black" d="M22725.5,-300.43C22725.5,-300.43 22725.5,-271.13 22725.5,-271.13"/>
<polygon fill="black" stroke="black" points="22729,-271.13 22725.5,-261.13 22722,-271.13 22729,-271.13"/>
</g>
<!-- l1_ffn_res_1&#45;&gt;l1_ffn_ln_1 -->
<g id="edge664" class="edge">
<title>l1_ffn_res_1&#45;&gt;l1_ffn_ln_1</title>
<path fill="none" stroke="black" d="M22778.25,-298.66C22778.25,-298.66 22778.25,-271.04 22778.25,-271.04"/>
<polygon fill="black" stroke="black" points="22781.75,-271.04 22778.25,-261.04 22774.75,-271.04 22781.75,-271.04"/>
</g>
<!-- l1_ffn_ln_1&#45;&gt;l1_ffn_up_1 -->
<g id="edge372" class="edge">
<title>l1_ffn_ln_1&#45;&gt;l1_ffn_up_1</title>
<path fill="none" stroke="black" d="M22514.38,-249C22387.75,-249 22271.35,-249 22271.35,-249 22271.35,-249 22271.35,-521 22271.35,-521 22271.35,-521 22302.7,-521 22302.7,-521"/>
<polygon fill="black" stroke="black" points="22302.7,-524.5 22312.7,-521 22302.7,-517.5 22302.7,-524.5"/>
</g>
<!-- l1_ffn_ln_1&#45;&gt;l1_ffn_up_1 -->
<g id="edge444" class="edge">
<title>l1_ffn_ln_1&#45;&gt;l1_ffn_up_1</title>
<path fill="none" stroke="black" d="M22514.49,-243C22385,-243 22265,-243 22265,-243 22265,-243 22265,-528 22265,-528 22265,-528 22303,-528 22303,-528"/>
<polygon fill="black" stroke="black" points="22303,-531.5 22313,-528 22303,-524.5 22303,-531.5"/>
</g>
<!-- l1_ffn_ln_1&#45;&gt;l1_ffn_up_1 -->
<g id="edge540" class="edge">
<title>l1_ffn_ln_1&#45;&gt;l1_ffn_up_1</title>
<path fill="none" stroke="black" d="M22514.27,-237C22382.06,-237 22258.65,-237 22258.65,-237 22258.65,-237 22258.65,-535 22258.65,-535 22258.65,-535 22302.6,-535 22302.6,-535"/>
<polygon fill="black" stroke="black" points="22302.6,-538.5 22312.6,-535 22302.6,-531.5 22302.6,-538.5"/>
</g>
<!-- l1_ffn_ln_1&#45;&gt;l1_ffn_up_1 -->
<g id="edge660" class="edge">
<title>l1_ffn_ln_1&#45;&gt;l1_ffn_up_1</title>
<path fill="none" stroke="black" d="M22514.14,-231C22379.19,-231 22252.3,-231 22252.3,-231 22252.3,-231 22252.3,-542 22252.3,-542 22252.3,-542 22302.99,-542 22302.99,-542"/>
<polygon fill="black" stroke="black" points="22302.99,-545.5 22312.99,-542 22302.99,-538.5 22302.99,-545.5"/>
</g>
<!-- l1_ffn_ln_1&#45;&gt;l1_ffn_res_1 -->
<g id="edge375" class="edge">
<title>l1_ffn_ln_1&#45;&gt;l1_ffn_res_1</title>
<path fill="none" stroke="black" d="M22831,-261.17C22831,-261.17 22831,-286.59 22831,-286.59"/>
<polygon fill="black" stroke="black" points="22827.5,-286.59 22831,-296.59 22834.5,-286.59 22827.5,-286.59"/>
</g>
<!-- l1_ffn_ln_1&#45;&gt;l1_ffn_res_1 -->
<g id="edge447" class="edge">
<title>l1_ffn_ln_1&#45;&gt;l1_ffn_res_1</title>
<path fill="none" stroke="black" d="M22883.75,-261.17C22883.75,-261.17 22883.75,-288.56 22883.75,-288.56"/>
<polygon fill="black" stroke="black" points="22880.25,-288.56 22883.75,-298.56 22887.25,-288.56 22880.25,-288.56"/>
</g>
<!-- l1_ffn_ln_1&#45;&gt;l1_ffn_res_1 -->
<g id="edge543" class="edge">
<title>l1_ffn_ln_1&#45;&gt;l1_ffn_res_1</title>
<path fill="none" stroke="black" d="M22936.5,-261.17C22936.5,-261.17 22936.5,-290.46 22936.5,-290.46"/>
<polygon fill="black" stroke="black" points="22933,-290.46 22936.5,-300.46 22940,-290.46 22933,-290.46"/>
</g>
<!-- l1_ffn_ln_1&#45;&gt;l1_ffn_res_1 -->
<g id="edge663" class="edge">
<title>l1_ffn_ln_1&#45;&gt;l1_ffn_res_1</title>
<path fill="none" stroke="black" d="M22989.25,-261.17C22989.25,-261.17 22989.25,-291.84 22989.25,-291.84"/>
<polygon fill="black" stroke="black" points="22985.75,-291.84 22989.25,-301.84 22992.75,-291.84 22985.75,-291.84"/>
</g>
<!-- l1_ffn_up_2 -->
<g id="node508" class="node">
<title>l1_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="21687,-550 21037,-550 21037,-514 21687,-514 21687,-550"/>
<text text-anchor="middle" x="21362" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ffn_down_2 -->
<g id="node509" class="node">
<title>l1_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="21922,-430 21260,-430 21260,-394 21922,-394 21922,-430"/>
<text text-anchor="middle" x="21591" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_2&#45;&gt;l1_ffn_down_2 -->
<g id="edge379" class="edge">
<title>l1_ffn_up_2&#45;&gt;l1_ffn_down_2</title>
<path fill="none" stroke="black" d="M21345.4,-513.77C21345.4,-513.77 21345.4,-440 21345.4,-440"/>
<polygon fill="black" stroke="black" points="21348.9,-440 21345.4,-430 21341.9,-440 21348.9,-440"/>
</g>
<!-- l1_ffn_up_2&#45;&gt;l1_ffn_down_2 -->
<g id="edge451" class="edge">
<title>l1_ffn_up_2&#45;&gt;l1_ffn_down_2</title>
<path fill="none" stroke="black" d="M21430.8,-513.77C21430.8,-513.77 21430.8,-440 21430.8,-440"/>
<polygon fill="black" stroke="black" points="21434.3,-440 21430.8,-430 21427.3,-440 21434.3,-440"/>
</g>
<!-- l1_ffn_up_2&#45;&gt;l1_ffn_down_2 -->
<g id="edge547" class="edge">
<title>l1_ffn_up_2&#45;&gt;l1_ffn_down_2</title>
<path fill="none" stroke="black" d="M21516.2,-513.77C21516.2,-513.77 21516.2,-440 21516.2,-440"/>
<polygon fill="black" stroke="black" points="21519.7,-440 21516.2,-430 21512.7,-440 21519.7,-440"/>
</g>
<!-- l1_ffn_up_2&#45;&gt;l1_ffn_down_2 -->
<g id="edge667" class="edge">
<title>l1_ffn_up_2&#45;&gt;l1_ffn_down_2</title>
<path fill="none" stroke="black" d="M21601.6,-513.77C21601.6,-513.77 21601.6,-440 21601.6,-440"/>
<polygon fill="black" stroke="black" points="21605.1,-440 21601.6,-430 21598.1,-440 21605.1,-440"/>
</g>
<!-- l1_ffn_res_2 -->
<g id="node510" class="node">
<title>l1_ffn_res_2</title>
<polygon fill="lightgray" stroke="black" points="21699,-333 21152.1,-315 21699,-297 22245.9,-315 21699,-333"/>
<text text-anchor="middle" x="21699" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_down_2&#45;&gt;l1_ffn_res_2 -->
<g id="edge380" class="edge">
<title>l1_ffn_down_2&#45;&gt;l1_ffn_res_2</title>
<path fill="none" stroke="black" d="M21392.4,-393.76C21392.4,-393.76 21392.4,-333.35 21392.4,-333.35"/>
<polygon fill="black" stroke="black" points="21395.9,-333.35 21392.4,-323.35 21388.9,-333.35 21395.9,-333.35"/>
</g>
<!-- l1_ffn_down_2&#45;&gt;l1_ffn_res_2 -->
<g id="edge452" class="edge">
<title>l1_ffn_down_2&#45;&gt;l1_ffn_res_2</title>
<path fill="none" stroke="black" d="M21524.8,-393.76C21524.8,-393.76 21524.8,-337.32 21524.8,-337.32"/>
<polygon fill="black" stroke="black" points="21528.3,-337.32 21524.8,-327.32 21521.3,-337.32 21528.3,-337.32"/>
</g>
<!-- l1_ffn_down_2&#45;&gt;l1_ffn_res_2 -->
<g id="edge548" class="edge">
<title>l1_ffn_down_2&#45;&gt;l1_ffn_res_2</title>
<path fill="none" stroke="black" d="M21657.2,-393.76C21657.2,-393.76 21657.2,-341.86 21657.2,-341.86"/>
<polygon fill="black" stroke="black" points="21660.7,-341.86 21657.2,-331.86 21653.7,-341.86 21660.7,-341.86"/>
</g>
<!-- l1_ffn_down_2&#45;&gt;l1_ffn_res_2 -->
<g id="edge668" class="edge">
<title>l1_ffn_down_2&#45;&gt;l1_ffn_res_2</title>
<path fill="none" stroke="black" d="M21789.6,-393.76C21789.6,-393.76 21789.6,-340.29 21789.6,-340.29"/>
<polygon fill="black" stroke="black" points="21793.1,-340.29 21789.6,-330.29 21786.1,-340.29 21793.1,-340.29"/>
</g>
<!-- l1_ffn_res_2&#45;&gt;l1_ffn_ln_2 -->
<g id="edge382" class="edge">
<title>l1_ffn_res_2&#45;&gt;l1_ffn_ln_2</title>
<path fill="none" stroke="black" d="M21488,-303.75C21488,-303.75 21488,-271.17 21488,-271.17"/>
<polygon fill="black" stroke="black" points="21491.5,-271.17 21488,-261.17 21484.5,-271.17 21491.5,-271.17"/>
</g>
<!-- l1_ffn_res_2&#45;&gt;l1_ffn_ln_2 -->
<g id="edge454" class="edge">
<title>l1_ffn_res_2&#45;&gt;l1_ffn_ln_2</title>
<path fill="none" stroke="black" d="M21540.75,-302.13C21540.75,-302.13 21540.75,-271.17 21540.75,-271.17"/>
<polygon fill="black" stroke="black" points="21544.25,-271.17 21540.75,-261.17 21537.25,-271.17 21544.25,-271.17"/>
</g>
<!-- l1_ffn_res_2&#45;&gt;l1_ffn_ln_2 -->
<g id="edge550" class="edge">
<title>l1_ffn_res_2&#45;&gt;l1_ffn_ln_2</title>
<path fill="none" stroke="black" d="M21593.5,-300.43C21593.5,-300.43 21593.5,-271.13 21593.5,-271.13"/>
<polygon fill="black" stroke="black" points="21597,-271.13 21593.5,-261.13 21590,-271.13 21597,-271.13"/>
</g>
<!-- l1_ffn_res_2&#45;&gt;l1_ffn_ln_2 -->
<g id="edge670" class="edge">
<title>l1_ffn_res_2&#45;&gt;l1_ffn_ln_2</title>
<path fill="none" stroke="black" d="M21646.25,-298.66C21646.25,-298.66 21646.25,-271.04 21646.25,-271.04"/>
<polygon fill="black" stroke="black" points="21649.75,-271.04 21646.25,-261.04 21642.75,-271.04 21649.75,-271.04"/>
</g>
<!-- l1_ffn_ln_2&#45;&gt;l1_ffn_up_2 -->
<g id="edge378" class="edge">
<title>l1_ffn_ln_2&#45;&gt;l1_ffn_up_2</title>
<path fill="none" stroke="black" d="M21382.36,-249C21258.57,-249 21145.7,-249 21145.7,-249 21145.7,-249 21145.7,-503.87 21145.7,-503.87"/>
<polygon fill="black" stroke="black" points="21142.2,-503.87 21145.7,-513.87 21149.2,-503.87 21142.2,-503.87"/>
</g>
<!-- l1_ffn_ln_2&#45;&gt;l1_ffn_up_2 -->
<g id="edge450" class="edge">
<title>l1_ffn_ln_2&#45;&gt;l1_ffn_up_2</title>
<path fill="none" stroke="black" d="M21382.38,-243C21255.75,-243 21139.35,-243 21139.35,-243 21139.35,-243 21139.35,-503.92 21139.35,-503.92"/>
<polygon fill="black" stroke="black" points="21135.85,-503.92 21139.35,-513.92 21142.85,-503.92 21135.85,-503.92"/>
</g>
<!-- l1_ffn_ln_2&#45;&gt;l1_ffn_up_2 -->
<g id="edge546" class="edge">
<title>l1_ffn_ln_2&#45;&gt;l1_ffn_up_2</title>
<path fill="none" stroke="black" d="M21382.49,-237C21253,-237 21133,-237 21133,-237 21133,-237 21133,-503.99 21133,-503.99"/>
<polygon fill="black" stroke="black" points="21129.5,-503.99 21133,-513.99 21136.5,-503.99 21129.5,-503.99"/>
</g>
<!-- l1_ffn_ln_2&#45;&gt;l1_ffn_up_2 -->
<g id="edge666" class="edge">
<title>l1_ffn_ln_2&#45;&gt;l1_ffn_up_2</title>
<path fill="none" stroke="black" d="M21382.27,-231C21250.06,-231 21126.65,-231 21126.65,-231 21126.65,-231 21126.65,-503.62 21126.65,-503.62"/>
<polygon fill="black" stroke="black" points="21123.15,-503.62 21126.65,-513.62 21130.15,-503.62 21123.15,-503.62"/>
</g>
<!-- l1_ffn_ln_2&#45;&gt;l1_ffn_res_2 -->
<g id="edge381" class="edge">
<title>l1_ffn_ln_2&#45;&gt;l1_ffn_res_2</title>
<path fill="none" stroke="black" d="M21699,-261.17C21699,-261.17 21699,-286.59 21699,-286.59"/>
<polygon fill="black" stroke="black" points="21695.5,-286.59 21699,-296.59 21702.5,-286.59 21695.5,-286.59"/>
</g>
<!-- l1_ffn_ln_2&#45;&gt;l1_ffn_res_2 -->
<g id="edge453" class="edge">
<title>l1_ffn_ln_2&#45;&gt;l1_ffn_res_2</title>
<path fill="none" stroke="black" d="M21751.75,-261.17C21751.75,-261.17 21751.75,-288.56 21751.75,-288.56"/>
<polygon fill="black" stroke="black" points="21748.25,-288.56 21751.75,-298.56 21755.25,-288.56 21748.25,-288.56"/>
</g>
<!-- l1_ffn_ln_2&#45;&gt;l1_ffn_res_2 -->
<g id="edge549" class="edge">
<title>l1_ffn_ln_2&#45;&gt;l1_ffn_res_2</title>
<path fill="none" stroke="black" d="M21804.5,-261.17C21804.5,-261.17 21804.5,-290.46 21804.5,-290.46"/>
<polygon fill="black" stroke="black" points="21801,-290.46 21804.5,-300.46 21808,-290.46 21801,-290.46"/>
</g>
<!-- l1_ffn_ln_2&#45;&gt;l1_ffn_res_2 -->
<g id="edge669" class="edge">
<title>l1_ffn_ln_2&#45;&gt;l1_ffn_res_2</title>
<path fill="none" stroke="black" d="M21857.25,-261.17C21857.25,-261.17 21857.25,-291.84 21857.25,-291.84"/>
<polygon fill="black" stroke="black" points="21853.75,-291.84 21857.25,-301.84 21860.75,-291.84 21853.75,-291.84"/>
</g>
<!-- l1_ffn_up_3 -->
<g id="node512" class="node">
<title>l1_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="19881,-550 19231,-550 19231,-514 19881,-514 19881,-550"/>
<text text-anchor="middle" x="19556" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ffn_down_3 -->
<g id="node513" class="node">
<title>l1_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="19840,-430 19178,-430 19178,-394 19840,-394 19840,-430"/>
<text text-anchor="middle" x="19509" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_3&#45;&gt;l1_ffn_down_3 -->
<g id="edge385" class="edge">
<title>l1_ffn_up_3&#45;&gt;l1_ffn_down_3</title>
<path fill="none" stroke="black" d="M19352.8,-513.77C19352.8,-513.77 19352.8,-440 19352.8,-440"/>
<polygon fill="black" stroke="black" points="19356.3,-440 19352.8,-430 19349.3,-440 19356.3,-440"/>
</g>
<!-- l1_ffn_up_3&#45;&gt;l1_ffn_down_3 -->
<g id="edge457" class="edge">
<title>l1_ffn_up_3&#45;&gt;l1_ffn_down_3</title>
<path fill="none" stroke="black" d="M19474.6,-513.77C19474.6,-513.77 19474.6,-440 19474.6,-440"/>
<polygon fill="black" stroke="black" points="19478.1,-440 19474.6,-430 19471.1,-440 19478.1,-440"/>
</g>
<!-- l1_ffn_up_3&#45;&gt;l1_ffn_down_3 -->
<g id="edge553" class="edge">
<title>l1_ffn_up_3&#45;&gt;l1_ffn_down_3</title>
<path fill="none" stroke="black" d="M19596.4,-513.77C19596.4,-513.77 19596.4,-440 19596.4,-440"/>
<polygon fill="black" stroke="black" points="19599.9,-440 19596.4,-430 19592.9,-440 19599.9,-440"/>
</g>
<!-- l1_ffn_up_3&#45;&gt;l1_ffn_down_3 -->
<g id="edge673" class="edge">
<title>l1_ffn_up_3&#45;&gt;l1_ffn_down_3</title>
<path fill="none" stroke="black" d="M19718.2,-513.77C19718.2,-513.77 19718.2,-440 19718.2,-440"/>
<polygon fill="black" stroke="black" points="19721.7,-440 19718.2,-430 19714.7,-440 19721.7,-440"/>
</g>
<!-- l1_ffn_res_3 -->
<g id="node514" class="node">
<title>l1_ffn_res_3</title>
<polygon fill="lightgray" stroke="black" points="19415,-333 18868.1,-315 19415,-297 19961.9,-315 19415,-333"/>
<text text-anchor="middle" x="19415" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_down_3&#45;&gt;l1_ffn_res_3 -->
<g id="edge386" class="edge">
<title>l1_ffn_down_3&#45;&gt;l1_ffn_res_3</title>
<path fill="none" stroke="black" d="M19310.4,-393.76C19310.4,-393.76 19310.4,-339.68 19310.4,-339.68"/>
<polygon fill="black" stroke="black" points="19313.9,-339.68 19310.4,-329.68 19306.9,-339.68 19313.9,-339.68"/>
</g>
<!-- l1_ffn_down_3&#45;&gt;l1_ffn_res_3 -->
<g id="edge458" class="edge">
<title>l1_ffn_down_3&#45;&gt;l1_ffn_res_3</title>
<path fill="none" stroke="black" d="M19442.8,-393.76C19442.8,-393.76 19442.8,-342.19 19442.8,-342.19"/>
<polygon fill="black" stroke="black" points="19446.3,-342.19 19442.8,-332.19 19439.3,-342.19 19446.3,-342.19"/>
</g>
<!-- l1_ffn_down_3&#45;&gt;l1_ffn_res_3 -->
<g id="edge554" class="edge">
<title>l1_ffn_down_3&#45;&gt;l1_ffn_res_3</title>
<path fill="none" stroke="black" d="M19575.2,-393.76C19575.2,-393.76 19575.2,-337.89 19575.2,-337.89"/>
<polygon fill="black" stroke="black" points="19578.7,-337.89 19575.2,-327.89 19571.7,-337.89 19578.7,-337.89"/>
</g>
<!-- l1_ffn_down_3&#45;&gt;l1_ffn_res_3 -->
<g id="edge674" class="edge">
<title>l1_ffn_down_3&#45;&gt;l1_ffn_res_3</title>
<path fill="none" stroke="black" d="M19707.6,-393.76C19707.6,-393.76 19707.6,-333.6 19707.6,-333.6"/>
<polygon fill="black" stroke="black" points="19711.1,-333.6 19707.6,-323.6 19704.1,-333.6 19711.1,-333.6"/>
</g>
<!-- l1_ffn_res_3&#45;&gt;l1_ffn_ln_3 -->
<g id="edge388" class="edge">
<title>l1_ffn_res_3&#45;&gt;l1_ffn_ln_3</title>
<path fill="none" stroke="black" d="M19213.59,-303.43C19213.59,-303.43 19213.59,-271.01 19213.59,-271.01"/>
<polygon fill="black" stroke="black" points="19217.09,-271.01 19213.59,-261.01 19210.09,-271.01 19217.09,-271.01"/>
</g>
<!-- l1_ffn_res_3&#45;&gt;l1_ffn_ln_3 -->
<g id="edge460" class="edge">
<title>l1_ffn_res_3&#45;&gt;l1_ffn_ln_3</title>
<path fill="none" stroke="black" d="M19271.14,-301.46C19271.14,-301.46 19271.14,-271.1 19271.14,-271.1"/>
<polygon fill="black" stroke="black" points="19274.64,-271.1 19271.14,-261.1 19267.64,-271.1 19274.64,-271.1"/>
</g>
<!-- l1_ffn_res_3&#45;&gt;l1_ffn_ln_3 -->
<g id="edge556" class="edge">
<title>l1_ffn_res_3&#45;&gt;l1_ffn_ln_3</title>
<path fill="none" stroke="black" d="M19328.68,-299.73C19328.68,-299.73 19328.68,-271.05 19328.68,-271.05"/>
<polygon fill="black" stroke="black" points="19332.18,-271.05 19328.68,-261.05 19325.18,-271.05 19332.18,-271.05"/>
</g>
<!-- l1_ffn_res_3&#45;&gt;l1_ffn_ln_3 -->
<g id="edge676" class="edge">
<title>l1_ffn_res_3&#45;&gt;l1_ffn_ln_3</title>
<path fill="none" stroke="black" d="M19386.23,-297.94C19386.23,-297.94 19386.23,-271.2 19386.23,-271.2"/>
<polygon fill="black" stroke="black" points="19389.73,-271.2 19386.23,-261.2 19382.73,-271.2 19389.73,-271.2"/>
</g>
<!-- l1_ffn_ln_3&#45;&gt;l1_ffn_up_3 -->
<g id="edge384" class="edge">
<title>l1_ffn_ln_3&#45;&gt;l1_ffn_up_3</title>
<path fill="none" stroke="black" d="M19098.32,-253C18975.78,-253 18864.43,-253 18864.43,-253 18864.43,-253 18864.43,-521 18864.43,-521 18864.43,-521 19220.97,-521 19220.97,-521"/>
<polygon fill="black" stroke="black" points="19220.97,-524.5 19230.97,-521 19220.97,-517.5 19220.97,-524.5"/>
</g>
<!-- l1_ffn_ln_3&#45;&gt;l1_ffn_up_3 -->
<g id="edge456" class="edge">
<title>l1_ffn_ln_3&#45;&gt;l1_ffn_up_3</title>
<path fill="none" stroke="black" d="M19098.25,-246C18974.11,-246 18860.81,-246 18860.81,-246 18860.81,-246 18860.81,-528 18860.81,-528 18860.81,-528 19220.79,-528 19220.79,-528"/>
<polygon fill="black" stroke="black" points="19220.79,-531.5 19230.79,-528 19220.79,-524.5 19220.79,-531.5"/>
</g>
<!-- l1_ffn_ln_3&#45;&gt;l1_ffn_up_3 -->
<g id="edge552" class="edge">
<title>l1_ffn_ln_3&#45;&gt;l1_ffn_up_3</title>
<path fill="none" stroke="black" d="M19098.2,-239C18972.46,-239 18857.19,-239 18857.19,-239 18857.19,-239 18857.19,-535 18857.19,-535 18857.19,-535 19220.89,-535 19220.89,-535"/>
<polygon fill="black" stroke="black" points="19220.89,-538.5 19230.89,-535 19220.89,-531.5 19220.89,-538.5"/>
</g>
<!-- l1_ffn_ln_3&#45;&gt;l1_ffn_up_3 -->
<g id="edge672" class="edge">
<title>l1_ffn_ln_3&#45;&gt;l1_ffn_up_3</title>
<path fill="none" stroke="black" d="M19098.19,-232C18970.84,-232 18853.57,-232 18853.57,-232 18853.57,-232 18853.57,-542 18853.57,-542 18853.57,-542 19220.74,-542 19220.74,-542"/>
<polygon fill="black" stroke="black" points="19220.74,-545.5 19230.74,-542 19220.74,-538.5 19220.74,-545.5"/>
</g>
<!-- l1_ffn_ln_3&#45;&gt;l1_ffn_res_3 -->
<g id="edge387" class="edge">
<title>l1_ffn_ln_3&#45;&gt;l1_ffn_res_3</title>
<path fill="none" stroke="black" d="M19443.77,-261.17C19443.77,-261.17 19443.77,-287.58 19443.77,-287.58"/>
<polygon fill="black" stroke="black" points="19440.27,-287.58 19443.77,-297.58 19447.27,-287.58 19440.27,-287.58"/>
</g>
<!-- l1_ffn_ln_3&#45;&gt;l1_ffn_res_3 -->
<g id="edge459" class="edge">
<title>l1_ffn_ln_3&#45;&gt;l1_ffn_res_3</title>
<path fill="none" stroke="black" d="M19501.32,-261.17C19501.32,-261.17 19501.32,-289.52 19501.32,-289.52"/>
<polygon fill="black" stroke="black" points="19497.82,-289.52 19501.32,-299.52 19504.82,-289.52 19497.82,-289.52"/>
</g>
<!-- l1_ffn_ln_3&#45;&gt;l1_ffn_res_3 -->
<g id="edge555" class="edge">
<title>l1_ffn_ln_3&#45;&gt;l1_ffn_res_3</title>
<path fill="none" stroke="black" d="M19558.86,-261.17C19558.86,-261.17 19558.86,-291.38 19558.86,-291.38"/>
<polygon fill="black" stroke="black" points="19555.36,-291.38 19558.86,-301.38 19562.36,-291.38 19555.36,-291.38"/>
</g>
<!-- l1_ffn_ln_3&#45;&gt;l1_ffn_res_3 -->
<g id="edge675" class="edge">
<title>l1_ffn_ln_3&#45;&gt;l1_ffn_res_3</title>
<path fill="none" stroke="black" d="M19616.41,-261.17C19616.41,-261.17 19616.41,-293.59 19616.41,-293.59"/>
<polygon fill="black" stroke="black" points="19612.91,-293.59 19616.41,-303.59 19619.91,-293.59 19612.91,-293.59"/>
</g>
<!-- l1_ffn_up_4 -->
<g id="node516" class="node">
<title>l1_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="20596,-550 19946,-550 19946,-514 20596,-514 20596,-550"/>
<text text-anchor="middle" x="20271" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ffn_down_4 -->
<g id="node517" class="node">
<title>l1_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="20790,-430 20128,-430 20128,-394 20790,-394 20790,-430"/>
<text text-anchor="middle" x="20459" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_4&#45;&gt;l1_ffn_down_4 -->
<g id="edge391" class="edge">
<title>l1_ffn_up_4&#45;&gt;l1_ffn_down_4</title>
<path fill="none" stroke="black" d="M20221.6,-513.77C20221.6,-513.77 20221.6,-440 20221.6,-440"/>
<polygon fill="black" stroke="black" points="20225.1,-440 20221.6,-430 20218.1,-440 20225.1,-440"/>
</g>
<!-- l1_ffn_up_4&#45;&gt;l1_ffn_down_4 -->
<g id="edge463" class="edge">
<title>l1_ffn_up_4&#45;&gt;l1_ffn_down_4</title>
<path fill="none" stroke="black" d="M20315.2,-513.77C20315.2,-513.77 20315.2,-440 20315.2,-440"/>
<polygon fill="black" stroke="black" points="20318.7,-440 20315.2,-430 20311.7,-440 20318.7,-440"/>
</g>
<!-- l1_ffn_up_4&#45;&gt;l1_ffn_down_4 -->
<g id="edge559" class="edge">
<title>l1_ffn_up_4&#45;&gt;l1_ffn_down_4</title>
<path fill="none" stroke="black" d="M20408.8,-513.77C20408.8,-513.77 20408.8,-440 20408.8,-440"/>
<polygon fill="black" stroke="black" points="20412.3,-440 20408.8,-430 20405.3,-440 20412.3,-440"/>
</g>
<!-- l1_ffn_up_4&#45;&gt;l1_ffn_down_4 -->
<g id="edge679" class="edge">
<title>l1_ffn_up_4&#45;&gt;l1_ffn_down_4</title>
<path fill="none" stroke="black" d="M20502.4,-513.77C20502.4,-513.77 20502.4,-440 20502.4,-440"/>
<polygon fill="black" stroke="black" points="20505.9,-440 20502.4,-430 20498.9,-440 20505.9,-440"/>
</g>
<!-- l1_ffn_res_4 -->
<g id="node518" class="node">
<title>l1_ffn_res_4</title>
<polygon fill="lightgray" stroke="black" points="20567,-333 20020.1,-315 20567,-297 21113.9,-315 20567,-333"/>
<text text-anchor="middle" x="20567" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_down_4&#45;&gt;l1_ffn_res_4 -->
<g id="edge392" class="edge">
<title>l1_ffn_down_4&#45;&gt;l1_ffn_res_4</title>
<path fill="none" stroke="black" d="M20260.4,-393.76C20260.4,-393.76 20260.4,-333.35 20260.4,-333.35"/>
<polygon fill="black" stroke="black" points="20263.9,-333.35 20260.4,-323.35 20256.9,-333.35 20263.9,-333.35"/>
</g>
<!-- l1_ffn_down_4&#45;&gt;l1_ffn_res_4 -->
<g id="edge464" class="edge">
<title>l1_ffn_down_4&#45;&gt;l1_ffn_res_4</title>
<path fill="none" stroke="black" d="M20392.8,-393.76C20392.8,-393.76 20392.8,-337.32 20392.8,-337.32"/>
<polygon fill="black" stroke="black" points="20396.3,-337.32 20392.8,-327.32 20389.3,-337.32 20396.3,-337.32"/>
</g>
<!-- l1_ffn_down_4&#45;&gt;l1_ffn_res_4 -->
<g id="edge560" class="edge">
<title>l1_ffn_down_4&#45;&gt;l1_ffn_res_4</title>
<path fill="none" stroke="black" d="M20525.2,-393.76C20525.2,-393.76 20525.2,-341.86 20525.2,-341.86"/>
<polygon fill="black" stroke="black" points="20528.7,-341.86 20525.2,-331.86 20521.7,-341.86 20528.7,-341.86"/>
</g>
<!-- l1_ffn_down_4&#45;&gt;l1_ffn_res_4 -->
<g id="edge680" class="edge">
<title>l1_ffn_down_4&#45;&gt;l1_ffn_res_4</title>
<path fill="none" stroke="black" d="M20657.6,-393.76C20657.6,-393.76 20657.6,-340.29 20657.6,-340.29"/>
<polygon fill="black" stroke="black" points="20661.1,-340.29 20657.6,-330.29 20654.1,-340.29 20661.1,-340.29"/>
</g>
<!-- l1_ffn_res_4&#45;&gt;l1_ffn_ln_4 -->
<g id="edge394" class="edge">
<title>l1_ffn_res_4&#45;&gt;l1_ffn_ln_4</title>
<path fill="none" stroke="black" d="M20365.59,-303.43C20365.59,-303.43 20365.59,-271.01 20365.59,-271.01"/>
<polygon fill="black" stroke="black" points="20369.09,-271.01 20365.59,-261.01 20362.09,-271.01 20369.09,-271.01"/>
</g>
<!-- l1_ffn_res_4&#45;&gt;l1_ffn_ln_4 -->
<g id="edge466" class="edge">
<title>l1_ffn_res_4&#45;&gt;l1_ffn_ln_4</title>
<path fill="none" stroke="black" d="M20423.14,-301.46C20423.14,-301.46 20423.14,-271.1 20423.14,-271.1"/>
<polygon fill="black" stroke="black" points="20426.64,-271.1 20423.14,-261.1 20419.64,-271.1 20426.64,-271.1"/>
</g>
<!-- l1_ffn_res_4&#45;&gt;l1_ffn_ln_4 -->
<g id="edge562" class="edge">
<title>l1_ffn_res_4&#45;&gt;l1_ffn_ln_4</title>
<path fill="none" stroke="black" d="M20480.68,-299.73C20480.68,-299.73 20480.68,-271.05 20480.68,-271.05"/>
<polygon fill="black" stroke="black" points="20484.18,-271.05 20480.68,-261.05 20477.18,-271.05 20484.18,-271.05"/>
</g>
<!-- l1_ffn_res_4&#45;&gt;l1_ffn_ln_4 -->
<g id="edge682" class="edge">
<title>l1_ffn_res_4&#45;&gt;l1_ffn_ln_4</title>
<path fill="none" stroke="black" d="M20538.23,-297.94C20538.23,-297.94 20538.23,-271.2 20538.23,-271.2"/>
<polygon fill="black" stroke="black" points="20541.73,-271.2 20538.23,-261.2 20534.73,-271.2 20541.73,-271.2"/>
</g>
<!-- l1_ffn_ln_4&#45;&gt;l1_ffn_up_4 -->
<g id="edge390" class="edge">
<title>l1_ffn_ln_4&#45;&gt;l1_ffn_up_4</title>
<path fill="none" stroke="black" d="M20250.14,-245C20118.2,-245 19995.15,-245 19995.15,-245 19995.15,-245 19995.15,-503.61 19995.15,-503.61"/>
<polygon fill="black" stroke="black" points="19991.65,-503.61 19995.15,-513.61 19998.65,-503.61 19991.65,-503.61"/>
</g>
<!-- l1_ffn_ln_4&#45;&gt;l1_ffn_up_4 -->
<g id="edge462" class="edge">
<title>l1_ffn_ln_4&#45;&gt;l1_ffn_up_4</title>
<path fill="none" stroke="black" d="M20250.19,-240C20114.59,-240 19986.85,-240 19986.85,-240 19986.85,-240 19986.85,-503.73 19986.85,-503.73"/>
<polygon fill="black" stroke="black" points="19983.35,-503.73 19986.85,-513.73 19990.35,-503.73 19983.35,-503.73"/>
</g>
<!-- l1_ffn_ln_4&#45;&gt;l1_ffn_up_4 -->
<g id="edge558" class="edge">
<title>l1_ffn_ln_4&#45;&gt;l1_ffn_up_4</title>
<path fill="none" stroke="black" d="M20250.38,-235C20111.1,-235 19978.55,-235 19978.55,-235 19978.55,-235 19978.55,-503.87 19978.55,-503.87"/>
<polygon fill="black" stroke="black" points="19975.05,-503.87 19978.55,-513.87 19982.05,-503.87 19975.05,-503.87"/>
</g>
<!-- l1_ffn_ln_4&#45;&gt;l1_ffn_up_4 -->
<g id="edge678" class="edge">
<title>l1_ffn_ln_4&#45;&gt;l1_ffn_up_4</title>
<path fill="none" stroke="black" d="M20250.28,-230C20107.45,-230 19970.25,-230 19970.25,-230 19970.25,-230 19970.25,-503.56 19970.25,-503.56"/>
<polygon fill="black" stroke="black" points="19966.75,-503.56 19970.25,-513.56 19973.75,-503.56 19966.75,-503.56"/>
</g>
<!-- l1_ffn_ln_4&#45;&gt;l1_ffn_res_4 -->
<g id="edge393" class="edge">
<title>l1_ffn_ln_4&#45;&gt;l1_ffn_res_4</title>
<path fill="none" stroke="black" d="M20595.77,-261.17C20595.77,-261.17 20595.77,-287.58 20595.77,-287.58"/>
<polygon fill="black" stroke="black" points="20592.27,-287.58 20595.77,-297.58 20599.27,-287.58 20592.27,-287.58"/>
</g>
<!-- l1_ffn_ln_4&#45;&gt;l1_ffn_res_4 -->
<g id="edge465" class="edge">
<title>l1_ffn_ln_4&#45;&gt;l1_ffn_res_4</title>
<path fill="none" stroke="black" d="M20653.32,-261.17C20653.32,-261.17 20653.32,-289.52 20653.32,-289.52"/>
<polygon fill="black" stroke="black" points="20649.82,-289.52 20653.32,-299.52 20656.82,-289.52 20649.82,-289.52"/>
</g>
<!-- l1_ffn_ln_4&#45;&gt;l1_ffn_res_4 -->
<g id="edge561" class="edge">
<title>l1_ffn_ln_4&#45;&gt;l1_ffn_res_4</title>
<path fill="none" stroke="black" d="M20710.86,-261.17C20710.86,-261.17 20710.86,-291.38 20710.86,-291.38"/>
<polygon fill="black" stroke="black" points="20707.36,-291.38 20710.86,-301.38 20714.36,-291.38 20707.36,-291.38"/>
</g>
<!-- l1_ffn_ln_4&#45;&gt;l1_ffn_res_4 -->
<g id="edge681" class="edge">
<title>l1_ffn_ln_4&#45;&gt;l1_ffn_res_4</title>
<path fill="none" stroke="black" d="M20768.41,-261.17C20768.41,-261.17 20768.41,-293.59 20768.41,-293.59"/>
<polygon fill="black" stroke="black" points="20764.91,-293.59 20768.41,-303.59 20771.91,-293.59 20764.91,-293.59"/>
</g>
<!-- l1_ffn_up_5 -->
<g id="node520" class="node">
<title>l1_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="18291,-550 17641,-550 17641,-514 18291,-514 18291,-550"/>
<text text-anchor="middle" x="17966" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ffn_down_5 -->
<g id="node521" class="node">
<title>l1_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="18526,-430 17864,-430 17864,-394 18526,-394 18526,-430"/>
<text text-anchor="middle" x="18195" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_5&#45;&gt;l1_ffn_down_5 -->
<g id="edge397" class="edge">
<title>l1_ffn_up_5&#45;&gt;l1_ffn_down_5</title>
<path fill="none" stroke="black" d="M17949.4,-513.77C17949.4,-513.77 17949.4,-440 17949.4,-440"/>
<polygon fill="black" stroke="black" points="17952.9,-440 17949.4,-430 17945.9,-440 17952.9,-440"/>
</g>
<!-- l1_ffn_up_5&#45;&gt;l1_ffn_down_5 -->
<g id="edge469" class="edge">
<title>l1_ffn_up_5&#45;&gt;l1_ffn_down_5</title>
<path fill="none" stroke="black" d="M18034.8,-513.77C18034.8,-513.77 18034.8,-440 18034.8,-440"/>
<polygon fill="black" stroke="black" points="18038.3,-440 18034.8,-430 18031.3,-440 18038.3,-440"/>
</g>
<!-- l1_ffn_up_5&#45;&gt;l1_ffn_down_5 -->
<g id="edge565" class="edge">
<title>l1_ffn_up_5&#45;&gt;l1_ffn_down_5</title>
<path fill="none" stroke="black" d="M18120.2,-513.77C18120.2,-513.77 18120.2,-440 18120.2,-440"/>
<polygon fill="black" stroke="black" points="18123.7,-440 18120.2,-430 18116.7,-440 18123.7,-440"/>
</g>
<!-- l1_ffn_up_5&#45;&gt;l1_ffn_down_5 -->
<g id="edge685" class="edge">
<title>l1_ffn_up_5&#45;&gt;l1_ffn_down_5</title>
<path fill="none" stroke="black" d="M18205.6,-513.77C18205.6,-513.77 18205.6,-440 18205.6,-440"/>
<polygon fill="black" stroke="black" points="18209.1,-440 18205.6,-430 18202.1,-440 18209.1,-440"/>
</g>
<!-- l1_ffn_res_5 -->
<g id="node522" class="node">
<title>l1_ffn_res_5</title>
<polygon fill="lightgray" stroke="black" points="18303,-333 17756.1,-315 18303,-297 18849.9,-315 18303,-333"/>
<text text-anchor="middle" x="18303" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_down_5&#45;&gt;l1_ffn_res_5 -->
<g id="edge398" class="edge">
<title>l1_ffn_down_5&#45;&gt;l1_ffn_res_5</title>
<path fill="none" stroke="black" d="M17996.4,-393.76C17996.4,-393.76 17996.4,-333.35 17996.4,-333.35"/>
<polygon fill="black" stroke="black" points="17999.9,-333.35 17996.4,-323.35 17992.9,-333.35 17999.9,-333.35"/>
</g>
<!-- l1_ffn_down_5&#45;&gt;l1_ffn_res_5 -->
<g id="edge470" class="edge">
<title>l1_ffn_down_5&#45;&gt;l1_ffn_res_5</title>
<path fill="none" stroke="black" d="M18128.8,-393.76C18128.8,-393.76 18128.8,-337.32 18128.8,-337.32"/>
<polygon fill="black" stroke="black" points="18132.3,-337.32 18128.8,-327.32 18125.3,-337.32 18132.3,-337.32"/>
</g>
<!-- l1_ffn_down_5&#45;&gt;l1_ffn_res_5 -->
<g id="edge566" class="edge">
<title>l1_ffn_down_5&#45;&gt;l1_ffn_res_5</title>
<path fill="none" stroke="black" d="M18261.2,-393.76C18261.2,-393.76 18261.2,-341.86 18261.2,-341.86"/>
<polygon fill="black" stroke="black" points="18264.7,-341.86 18261.2,-331.86 18257.7,-341.86 18264.7,-341.86"/>
</g>
<!-- l1_ffn_down_5&#45;&gt;l1_ffn_res_5 -->
<g id="edge686" class="edge">
<title>l1_ffn_down_5&#45;&gt;l1_ffn_res_5</title>
<path fill="none" stroke="black" d="M18393.6,-393.76C18393.6,-393.76 18393.6,-340.29 18393.6,-340.29"/>
<polygon fill="black" stroke="black" points="18397.1,-340.29 18393.6,-330.29 18390.1,-340.29 18397.1,-340.29"/>
</g>
<!-- l1_ffn_res_5&#45;&gt;l1_ffn_ln_5 -->
<g id="edge400" class="edge">
<title>l1_ffn_res_5&#45;&gt;l1_ffn_ln_5</title>
<path fill="none" stroke="black" d="M18101.59,-303.43C18101.59,-303.43 18101.59,-271.01 18101.59,-271.01"/>
<polygon fill="black" stroke="black" points="18105.09,-271.01 18101.59,-261.01 18098.09,-271.01 18105.09,-271.01"/>
</g>
<!-- l1_ffn_res_5&#45;&gt;l1_ffn_ln_5 -->
<g id="edge472" class="edge">
<title>l1_ffn_res_5&#45;&gt;l1_ffn_ln_5</title>
<path fill="none" stroke="black" d="M18159.14,-301.46C18159.14,-301.46 18159.14,-271.1 18159.14,-271.1"/>
<polygon fill="black" stroke="black" points="18162.64,-271.1 18159.14,-261.1 18155.64,-271.1 18162.64,-271.1"/>
</g>
<!-- l1_ffn_res_5&#45;&gt;l1_ffn_ln_5 -->
<g id="edge568" class="edge">
<title>l1_ffn_res_5&#45;&gt;l1_ffn_ln_5</title>
<path fill="none" stroke="black" d="M18216.68,-299.73C18216.68,-299.73 18216.68,-271.05 18216.68,-271.05"/>
<polygon fill="black" stroke="black" points="18220.18,-271.05 18216.68,-261.05 18213.18,-271.05 18220.18,-271.05"/>
</g>
<!-- l1_ffn_res_5&#45;&gt;l1_ffn_ln_5 -->
<g id="edge688" class="edge">
<title>l1_ffn_res_5&#45;&gt;l1_ffn_ln_5</title>
<path fill="none" stroke="black" d="M18274.23,-297.94C18274.23,-297.94 18274.23,-271.2 18274.23,-271.2"/>
<polygon fill="black" stroke="black" points="18277.73,-271.2 18274.23,-261.2 18270.73,-271.2 18277.73,-271.2"/>
</g>
<!-- l1_ffn_ln_5&#45;&gt;l1_ffn_up_5 -->
<g id="edge396" class="edge">
<title>l1_ffn_ln_5&#45;&gt;l1_ffn_up_5</title>
<path fill="none" stroke="black" d="M17986.36,-249C17862.57,-249 17749.7,-249 17749.7,-249 17749.7,-249 17749.7,-503.87 17749.7,-503.87"/>
<polygon fill="black" stroke="black" points="17746.2,-503.87 17749.7,-513.87 17753.2,-503.87 17746.2,-503.87"/>
</g>
<!-- l1_ffn_ln_5&#45;&gt;l1_ffn_up_5 -->
<g id="edge468" class="edge">
<title>l1_ffn_ln_5&#45;&gt;l1_ffn_up_5</title>
<path fill="none" stroke="black" d="M17986.38,-243C17859.75,-243 17743.35,-243 17743.35,-243 17743.35,-243 17743.35,-503.92 17743.35,-503.92"/>
<polygon fill="black" stroke="black" points="17739.85,-503.92 17743.35,-513.92 17746.85,-503.92 17739.85,-503.92"/>
</g>
<!-- l1_ffn_ln_5&#45;&gt;l1_ffn_up_5 -->
<g id="edge564" class="edge">
<title>l1_ffn_ln_5&#45;&gt;l1_ffn_up_5</title>
<path fill="none" stroke="black" d="M17986.49,-237C17857,-237 17737,-237 17737,-237 17737,-237 17737,-503.99 17737,-503.99"/>
<polygon fill="black" stroke="black" points="17733.5,-503.99 17737,-513.99 17740.5,-503.99 17733.5,-503.99"/>
</g>
<!-- l1_ffn_ln_5&#45;&gt;l1_ffn_up_5 -->
<g id="edge684" class="edge">
<title>l1_ffn_ln_5&#45;&gt;l1_ffn_up_5</title>
<path fill="none" stroke="black" d="M17986.27,-231C17854.06,-231 17730.65,-231 17730.65,-231 17730.65,-231 17730.65,-503.62 17730.65,-503.62"/>
<polygon fill="black" stroke="black" points="17727.15,-503.62 17730.65,-513.62 17734.15,-503.62 17727.15,-503.62"/>
</g>
<!-- l1_ffn_ln_5&#45;&gt;l1_ffn_res_5 -->
<g id="edge399" class="edge">
<title>l1_ffn_ln_5&#45;&gt;l1_ffn_res_5</title>
<path fill="none" stroke="black" d="M18331.77,-261.17C18331.77,-261.17 18331.77,-287.58 18331.77,-287.58"/>
<polygon fill="black" stroke="black" points="18328.27,-287.58 18331.77,-297.58 18335.27,-287.58 18328.27,-287.58"/>
</g>
<!-- l1_ffn_ln_5&#45;&gt;l1_ffn_res_5 -->
<g id="edge471" class="edge">
<title>l1_ffn_ln_5&#45;&gt;l1_ffn_res_5</title>
<path fill="none" stroke="black" d="M18389.32,-261.17C18389.32,-261.17 18389.32,-289.52 18389.32,-289.52"/>
<polygon fill="black" stroke="black" points="18385.82,-289.52 18389.32,-299.52 18392.82,-289.52 18385.82,-289.52"/>
</g>
<!-- l1_ffn_ln_5&#45;&gt;l1_ffn_res_5 -->
<g id="edge567" class="edge">
<title>l1_ffn_ln_5&#45;&gt;l1_ffn_res_5</title>
<path fill="none" stroke="black" d="M18446.86,-261.17C18446.86,-261.17 18446.86,-291.38 18446.86,-291.38"/>
<polygon fill="black" stroke="black" points="18443.36,-291.38 18446.86,-301.38 18450.36,-291.38 18443.36,-291.38"/>
</g>
<!-- l1_ffn_ln_5&#45;&gt;l1_ffn_res_5 -->
<g id="edge687" class="edge">
<title>l1_ffn_ln_5&#45;&gt;l1_ffn_res_5</title>
<path fill="none" stroke="black" d="M18504.41,-261.17C18504.41,-261.17 18504.41,-293.59 18504.41,-293.59"/>
<polygon fill="black" stroke="black" points="18500.91,-293.59 18504.41,-303.59 18507.91,-293.59 18500.91,-293.59"/>
</g>
<!-- l1_ffn_up_6 -->
<g id="node524" class="node">
<title>l1_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="17159,-550 16509,-550 16509,-514 17159,-514 17159,-550"/>
<text text-anchor="middle" x="16834" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ffn_down_6 -->
<g id="node525" class="node">
<title>l1_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="17394,-430 16732,-430 16732,-394 17394,-394 17394,-430"/>
<text text-anchor="middle" x="17063" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_6&#45;&gt;l1_ffn_down_6 -->
<g id="edge403" class="edge">
<title>l1_ffn_up_6&#45;&gt;l1_ffn_down_6</title>
<path fill="none" stroke="black" d="M16817.4,-513.77C16817.4,-513.77 16817.4,-440 16817.4,-440"/>
<polygon fill="black" stroke="black" points="16820.9,-440 16817.4,-430 16813.9,-440 16820.9,-440"/>
</g>
<!-- l1_ffn_up_6&#45;&gt;l1_ffn_down_6 -->
<g id="edge475" class="edge">
<title>l1_ffn_up_6&#45;&gt;l1_ffn_down_6</title>
<path fill="none" stroke="black" d="M16902.8,-513.77C16902.8,-513.77 16902.8,-440 16902.8,-440"/>
<polygon fill="black" stroke="black" points="16906.3,-440 16902.8,-430 16899.3,-440 16906.3,-440"/>
</g>
<!-- l1_ffn_up_6&#45;&gt;l1_ffn_down_6 -->
<g id="edge571" class="edge">
<title>l1_ffn_up_6&#45;&gt;l1_ffn_down_6</title>
<path fill="none" stroke="black" d="M16988.2,-513.77C16988.2,-513.77 16988.2,-440 16988.2,-440"/>
<polygon fill="black" stroke="black" points="16991.7,-440 16988.2,-430 16984.7,-440 16991.7,-440"/>
</g>
<!-- l1_ffn_up_6&#45;&gt;l1_ffn_down_6 -->
<g id="edge691" class="edge">
<title>l1_ffn_up_6&#45;&gt;l1_ffn_down_6</title>
<path fill="none" stroke="black" d="M17073.6,-513.77C17073.6,-513.77 17073.6,-440 17073.6,-440"/>
<polygon fill="black" stroke="black" points="17077.1,-440 17073.6,-430 17070.1,-440 17077.1,-440"/>
</g>
<!-- l1_ffn_res_6 -->
<g id="node526" class="node">
<title>l1_ffn_res_6</title>
<polygon fill="lightgray" stroke="black" points="17171,-333 16624.1,-315 17171,-297 17717.9,-315 17171,-333"/>
<text text-anchor="middle" x="17171" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_down_6&#45;&gt;l1_ffn_res_6 -->
<g id="edge404" class="edge">
<title>l1_ffn_down_6&#45;&gt;l1_ffn_res_6</title>
<path fill="none" stroke="black" d="M16864.4,-393.76C16864.4,-393.76 16864.4,-333.35 16864.4,-333.35"/>
<polygon fill="black" stroke="black" points="16867.9,-333.35 16864.4,-323.35 16860.9,-333.35 16867.9,-333.35"/>
</g>
<!-- l1_ffn_down_6&#45;&gt;l1_ffn_res_6 -->
<g id="edge476" class="edge">
<title>l1_ffn_down_6&#45;&gt;l1_ffn_res_6</title>
<path fill="none" stroke="black" d="M16996.8,-393.76C16996.8,-393.76 16996.8,-337.32 16996.8,-337.32"/>
<polygon fill="black" stroke="black" points="17000.3,-337.32 16996.8,-327.32 16993.3,-337.32 17000.3,-337.32"/>
</g>
<!-- l1_ffn_down_6&#45;&gt;l1_ffn_res_6 -->
<g id="edge572" class="edge">
<title>l1_ffn_down_6&#45;&gt;l1_ffn_res_6</title>
<path fill="none" stroke="black" d="M17129.2,-393.76C17129.2,-393.76 17129.2,-341.86 17129.2,-341.86"/>
<polygon fill="black" stroke="black" points="17132.7,-341.86 17129.2,-331.86 17125.7,-341.86 17132.7,-341.86"/>
</g>
<!-- l1_ffn_down_6&#45;&gt;l1_ffn_res_6 -->
<g id="edge692" class="edge">
<title>l1_ffn_down_6&#45;&gt;l1_ffn_res_6</title>
<path fill="none" stroke="black" d="M17261.6,-393.76C17261.6,-393.76 17261.6,-340.29 17261.6,-340.29"/>
<polygon fill="black" stroke="black" points="17265.1,-340.29 17261.6,-330.29 17258.1,-340.29 17265.1,-340.29"/>
</g>
<!-- l1_ffn_res_6&#45;&gt;l1_ffn_ln_6 -->
<g id="edge406" class="edge">
<title>l1_ffn_res_6&#45;&gt;l1_ffn_ln_6</title>
<path fill="none" stroke="black" d="M16981.1,-303.11C16981.1,-303.11 16981.1,-271.12 16981.1,-271.12"/>
<polygon fill="black" stroke="black" points="16984.6,-271.12 16981.1,-261.12 16977.6,-271.12 16984.6,-271.12"/>
</g>
<!-- l1_ffn_res_6&#45;&gt;l1_ffn_ln_6 -->
<g id="edge478" class="edge">
<title>l1_ffn_res_6&#45;&gt;l1_ffn_ln_6</title>
<path fill="none" stroke="black" d="M17044.4,-301.12C17044.4,-301.12 17044.4,-271.2 17044.4,-271.2"/>
<polygon fill="black" stroke="black" points="17047.9,-271.2 17044.4,-261.2 17040.9,-271.2 17047.9,-271.2"/>
</g>
<!-- l1_ffn_res_6&#45;&gt;l1_ffn_ln_6 -->
<g id="edge574" class="edge">
<title>l1_ffn_res_6&#45;&gt;l1_ffn_ln_6</title>
<path fill="none" stroke="black" d="M17107.7,-299.02C17107.7,-299.02 17107.7,-271.22 17107.7,-271.22"/>
<polygon fill="black" stroke="black" points="17111.2,-271.22 17107.7,-261.22 17104.2,-271.22 17111.2,-271.22"/>
</g>
<!-- l1_ffn_res_6&#45;&gt;l1_ffn_ln_6 -->
<g id="edge694" class="edge">
<title>l1_ffn_res_6&#45;&gt;l1_ffn_ln_6</title>
<path fill="none" stroke="black" d="M17171,-296.83C17171,-296.83 17171,-271.41 17171,-271.41"/>
<polygon fill="black" stroke="black" points="17174.5,-271.41 17171,-261.41 17167.5,-271.41 17174.5,-271.41"/>
</g>
<!-- l1_ffn_ln_6&#45;&gt;l1_ffn_up_6 -->
<g id="edge402" class="edge">
<title>l1_ffn_ln_6&#45;&gt;l1_ffn_up_6</title>
<path fill="none" stroke="black" d="M16854.36,-249C16730.57,-249 16617.7,-249 16617.7,-249 16617.7,-249 16617.7,-503.87 16617.7,-503.87"/>
<polygon fill="black" stroke="black" points="16614.2,-503.87 16617.7,-513.87 16621.2,-503.87 16614.2,-503.87"/>
</g>
<!-- l1_ffn_ln_6&#45;&gt;l1_ffn_up_6 -->
<g id="edge474" class="edge">
<title>l1_ffn_ln_6&#45;&gt;l1_ffn_up_6</title>
<path fill="none" stroke="black" d="M16854.38,-243C16727.75,-243 16611.35,-243 16611.35,-243 16611.35,-243 16611.35,-503.92 16611.35,-503.92"/>
<polygon fill="black" stroke="black" points="16607.85,-503.92 16611.35,-513.92 16614.85,-503.92 16607.85,-503.92"/>
</g>
<!-- l1_ffn_ln_6&#45;&gt;l1_ffn_up_6 -->
<g id="edge570" class="edge">
<title>l1_ffn_ln_6&#45;&gt;l1_ffn_up_6</title>
<path fill="none" stroke="black" d="M16854.49,-237C16725,-237 16605,-237 16605,-237 16605,-237 16605,-503.99 16605,-503.99"/>
<polygon fill="black" stroke="black" points="16601.5,-503.99 16605,-513.99 16608.5,-503.99 16601.5,-503.99"/>
</g>
<!-- l1_ffn_ln_6&#45;&gt;l1_ffn_up_6 -->
<g id="edge690" class="edge">
<title>l1_ffn_ln_6&#45;&gt;l1_ffn_up_6</title>
<path fill="none" stroke="black" d="M16854.27,-231C16722.06,-231 16598.65,-231 16598.65,-231 16598.65,-231 16598.65,-503.62 16598.65,-503.62"/>
<polygon fill="black" stroke="black" points="16595.15,-503.62 16598.65,-513.62 16602.15,-503.62 16595.15,-503.62"/>
</g>
<!-- l1_ffn_ln_6&#45;&gt;l1_ffn_res_6 -->
<g id="edge405" class="edge">
<title>l1_ffn_ln_6&#45;&gt;l1_ffn_res_6</title>
<path fill="none" stroke="black" d="M17234.3,-261.17C17234.3,-261.17 17234.3,-289.04 17234.3,-289.04"/>
<polygon fill="black" stroke="black" points="17230.8,-289.04 17234.3,-299.04 17237.8,-289.04 17230.8,-289.04"/>
</g>
<!-- l1_ffn_ln_6&#45;&gt;l1_ffn_res_6 -->
<g id="edge477" class="edge">
<title>l1_ffn_ln_6&#45;&gt;l1_ffn_res_6</title>
<path fill="none" stroke="black" d="M17297.6,-261.17C17297.6,-261.17 17297.6,-290.93 17297.6,-290.93"/>
<polygon fill="black" stroke="black" points="17294.1,-290.93 17297.6,-300.93 17301.1,-290.93 17294.1,-290.93"/>
</g>
<!-- l1_ffn_ln_6&#45;&gt;l1_ffn_res_6 -->
<g id="edge573" class="edge">
<title>l1_ffn_ln_6&#45;&gt;l1_ffn_res_6</title>
<path fill="none" stroke="black" d="M17360.9,-261.17C17360.9,-261.17 17360.9,-293.16 17360.9,-293.16"/>
<polygon fill="black" stroke="black" points="17357.4,-293.16 17360.9,-303.16 17364.4,-293.16 17357.4,-293.16"/>
</g>
<!-- l1_ffn_ln_6&#45;&gt;l1_ffn_res_6 -->
<g id="edge693" class="edge">
<title>l1_ffn_ln_6&#45;&gt;l1_ffn_res_6</title>
<path fill="none" stroke="black" d="M17424.2,-261.17C17424.2,-261.17 17424.2,-295.25 17424.2,-295.25"/>
<polygon fill="black" stroke="black" points="17420.7,-295.25 17424.2,-305.25 17427.7,-295.25 17420.7,-295.25"/>
</g>
<!-- l1_ffn_up_7 -->
<g id="node528" class="node">
<title>l1_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="16189,-550 15539,-550 15539,-514 16189,-514 16189,-550"/>
<text text-anchor="middle" x="15864" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ffn_down_7 -->
<g id="node529" class="node">
<title>l1_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="16262,-430 15600,-430 15600,-394 16262,-394 16262,-430"/>
<text text-anchor="middle" x="15931" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_7&#45;&gt;l1_ffn_down_7 -->
<g id="edge409" class="edge">
<title>l1_ffn_up_7&#45;&gt;l1_ffn_down_7</title>
<path fill="none" stroke="black" d="M15717.8,-513.77C15717.8,-513.77 15717.8,-440 15717.8,-440"/>
<polygon fill="black" stroke="black" points="15721.3,-440 15717.8,-430 15714.3,-440 15721.3,-440"/>
</g>
<!-- l1_ffn_up_7&#45;&gt;l1_ffn_down_7 -->
<g id="edge481" class="edge">
<title>l1_ffn_up_7&#45;&gt;l1_ffn_down_7</title>
<path fill="none" stroke="black" d="M15835.6,-513.77C15835.6,-513.77 15835.6,-440 15835.6,-440"/>
<polygon fill="black" stroke="black" points="15839.1,-440 15835.6,-430 15832.1,-440 15839.1,-440"/>
</g>
<!-- l1_ffn_up_7&#45;&gt;l1_ffn_down_7 -->
<g id="edge577" class="edge">
<title>l1_ffn_up_7&#45;&gt;l1_ffn_down_7</title>
<path fill="none" stroke="black" d="M15953.4,-513.77C15953.4,-513.77 15953.4,-440 15953.4,-440"/>
<polygon fill="black" stroke="black" points="15956.9,-440 15953.4,-430 15949.9,-440 15956.9,-440"/>
</g>
<!-- l1_ffn_up_7&#45;&gt;l1_ffn_down_7 -->
<g id="edge697" class="edge">
<title>l1_ffn_up_7&#45;&gt;l1_ffn_down_7</title>
<path fill="none" stroke="black" d="M16071.2,-513.77C16071.2,-513.77 16071.2,-440 16071.2,-440"/>
<polygon fill="black" stroke="black" points="16074.7,-440 16071.2,-430 16067.7,-440 16074.7,-440"/>
</g>
<!-- l1_ffn_res_7 -->
<g id="node530" class="node">
<title>l1_ffn_res_7</title>
<polygon fill="lightgray" stroke="black" points="16039,-333 15492.1,-315 16039,-297 16585.9,-315 16039,-333"/>
<text text-anchor="middle" x="16039" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_down_7&#45;&gt;l1_ffn_res_7 -->
<g id="edge410" class="edge">
<title>l1_ffn_down_7&#45;&gt;l1_ffn_res_7</title>
<path fill="none" stroke="black" d="M15732.4,-393.76C15732.4,-393.76 15732.4,-333.35 15732.4,-333.35"/>
<polygon fill="black" stroke="black" points="15735.9,-333.35 15732.4,-323.35 15728.9,-333.35 15735.9,-333.35"/>
</g>
<!-- l1_ffn_down_7&#45;&gt;l1_ffn_res_7 -->
<g id="edge482" class="edge">
<title>l1_ffn_down_7&#45;&gt;l1_ffn_res_7</title>
<path fill="none" stroke="black" d="M15864.8,-393.76C15864.8,-393.76 15864.8,-337.32 15864.8,-337.32"/>
<polygon fill="black" stroke="black" points="15868.3,-337.32 15864.8,-327.32 15861.3,-337.32 15868.3,-337.32"/>
</g>
<!-- l1_ffn_down_7&#45;&gt;l1_ffn_res_7 -->
<g id="edge578" class="edge">
<title>l1_ffn_down_7&#45;&gt;l1_ffn_res_7</title>
<path fill="none" stroke="black" d="M15997.2,-393.76C15997.2,-393.76 15997.2,-341.86 15997.2,-341.86"/>
<polygon fill="black" stroke="black" points="16000.7,-341.86 15997.2,-331.86 15993.7,-341.86 16000.7,-341.86"/>
</g>
<!-- l1_ffn_down_7&#45;&gt;l1_ffn_res_7 -->
<g id="edge698" class="edge">
<title>l1_ffn_down_7&#45;&gt;l1_ffn_res_7</title>
<path fill="none" stroke="black" d="M16129.6,-393.76C16129.6,-393.76 16129.6,-340.29 16129.6,-340.29"/>
<polygon fill="black" stroke="black" points="16133.1,-340.29 16129.6,-330.29 16126.1,-340.29 16133.1,-340.29"/>
</g>
<!-- l1_ffn_res_7&#45;&gt;l1_ffn_ln_7 -->
<g id="edge412" class="edge">
<title>l1_ffn_res_7&#45;&gt;l1_ffn_ln_7</title>
<path fill="none" stroke="black" d="M15849.1,-303.11C15849.1,-303.11 15849.1,-271.12 15849.1,-271.12"/>
<polygon fill="black" stroke="black" points="15852.6,-271.12 15849.1,-261.12 15845.6,-271.12 15852.6,-271.12"/>
</g>
<!-- l1_ffn_res_7&#45;&gt;l1_ffn_ln_7 -->
<g id="edge484" class="edge">
<title>l1_ffn_res_7&#45;&gt;l1_ffn_ln_7</title>
<path fill="none" stroke="black" d="M15912.4,-301.12C15912.4,-301.12 15912.4,-271.2 15912.4,-271.2"/>
<polygon fill="black" stroke="black" points="15915.9,-271.2 15912.4,-261.2 15908.9,-271.2 15915.9,-271.2"/>
</g>
<!-- l1_ffn_res_7&#45;&gt;l1_ffn_ln_7 -->
<g id="edge580" class="edge">
<title>l1_ffn_res_7&#45;&gt;l1_ffn_ln_7</title>
<path fill="none" stroke="black" d="M15975.7,-299.02C15975.7,-299.02 15975.7,-271.22 15975.7,-271.22"/>
<polygon fill="black" stroke="black" points="15979.2,-271.22 15975.7,-261.22 15972.2,-271.22 15979.2,-271.22"/>
</g>
<!-- l1_ffn_res_7&#45;&gt;l1_ffn_ln_7 -->
<g id="edge700" class="edge">
<title>l1_ffn_res_7&#45;&gt;l1_ffn_ln_7</title>
<path fill="none" stroke="black" d="M16039,-296.83C16039,-296.83 16039,-271.41 16039,-271.41"/>
<polygon fill="black" stroke="black" points="16042.5,-271.41 16039,-261.41 16035.5,-271.41 16042.5,-271.41"/>
</g>
<!-- l1_ffn_ln_7&#45;&gt;l1_ffn_up_7 -->
<g id="edge408" class="edge">
<title>l1_ffn_ln_7&#45;&gt;l1_ffn_up_7</title>
<path fill="none" stroke="black" d="M15722.33,-243C15600.11,-243 15489.15,-243 15489.15,-243 15489.15,-243 15489.15,-534 15489.15,-534 15489.15,-534 15528.92,-534 15528.92,-534"/>
<polygon fill="black" stroke="black" points="15528.92,-537.5 15538.92,-534 15528.92,-530.5 15528.92,-537.5"/>
</g>
<!-- l1_ffn_ln_7&#45;&gt;l1_ffn_up_7 -->
<g id="edge480" class="edge">
<title>l1_ffn_ln_7&#45;&gt;l1_ffn_up_7</title>
<path fill="none" stroke="black" d="M15722.27,-238C15598.76,-238 15486.24,-238 15486.24,-238 15486.24,-238 15486.24,-538 15486.24,-538 15486.24,-538 15528.77,-538 15528.77,-538"/>
<polygon fill="black" stroke="black" points="15528.77,-541.5 15538.77,-538 15528.77,-534.5 15528.77,-541.5"/>
</g>
<!-- l1_ffn_ln_7&#45;&gt;l1_ffn_up_7 -->
<g id="edge576" class="edge">
<title>l1_ffn_ln_7&#45;&gt;l1_ffn_up_7</title>
<path fill="none" stroke="black" d="M15722.21,-234C15597.43,-234 15483.34,-234 15483.34,-234 15483.34,-234 15483.34,-542 15483.34,-542 15483.34,-542 15528.69,-542 15528.69,-542"/>
<polygon fill="black" stroke="black" points="15528.69,-545.5 15538.69,-542 15528.69,-538.5 15528.69,-545.5"/>
</g>
<!-- l1_ffn_ln_7&#45;&gt;l1_ffn_up_7 -->
<g id="edge696" class="edge">
<title>l1_ffn_ln_7&#45;&gt;l1_ffn_up_7</title>
<path fill="none" stroke="black" d="M15722.18,-229C15596.11,-229 15480.44,-229 15480.44,-229 15480.44,-229 15480.44,-546 15480.44,-546 15480.44,-546 15528.69,-546 15528.69,-546"/>
<polygon fill="black" stroke="black" points="15528.69,-549.5 15538.69,-546 15528.69,-542.5 15528.69,-549.5"/>
</g>
<!-- l1_ffn_ln_7&#45;&gt;l1_ffn_res_7 -->
<g id="edge411" class="edge">
<title>l1_ffn_ln_7&#45;&gt;l1_ffn_res_7</title>
<path fill="none" stroke="black" d="M16102.3,-261.17C16102.3,-261.17 16102.3,-289.04 16102.3,-289.04"/>
<polygon fill="black" stroke="black" points="16098.8,-289.04 16102.3,-299.04 16105.8,-289.04 16098.8,-289.04"/>
</g>
<!-- l1_ffn_ln_7&#45;&gt;l1_ffn_res_7 -->
<g id="edge483" class="edge">
<title>l1_ffn_ln_7&#45;&gt;l1_ffn_res_7</title>
<path fill="none" stroke="black" d="M16165.6,-261.17C16165.6,-261.17 16165.6,-290.93 16165.6,-290.93"/>
<polygon fill="black" stroke="black" points="16162.1,-290.93 16165.6,-300.93 16169.1,-290.93 16162.1,-290.93"/>
</g>
<!-- l1_ffn_ln_7&#45;&gt;l1_ffn_res_7 -->
<g id="edge579" class="edge">
<title>l1_ffn_ln_7&#45;&gt;l1_ffn_res_7</title>
<path fill="none" stroke="black" d="M16228.9,-261.17C16228.9,-261.17 16228.9,-293.16 16228.9,-293.16"/>
<polygon fill="black" stroke="black" points="16225.4,-293.16 16228.9,-303.16 16232.4,-293.16 16225.4,-293.16"/>
</g>
<!-- l1_ffn_ln_7&#45;&gt;l1_ffn_res_7 -->
<g id="edge699" class="edge">
<title>l1_ffn_ln_7&#45;&gt;l1_ffn_res_7</title>
<path fill="none" stroke="black" d="M16292.2,-261.17C16292.2,-261.17 16292.2,-295.25 16292.2,-295.25"/>
<polygon fill="black" stroke="black" points="16288.7,-295.25 16292.2,-305.25 16295.7,-295.25 16288.7,-295.25"/>
</g>
<!-- l2_ffn_up_0 -->
<g id="node532" class="node">
<title>l2_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="298559,-550 297909,-550 297909,-514 298559,-514 298559,-550"/>
<text text-anchor="middle" x="298234" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ffn_down_0 -->
<g id="node533" class="node">
<title>l2_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="298972,-430 298310,-430 298310,-394 298972,-394 298972,-430"/>
<text text-anchor="middle" x="298641" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_0&#45;&gt;l2_ffn_down_0 -->
<g id="edge704" class="edge">
<title>l2_ffn_up_0&#45;&gt;l2_ffn_down_0</title>
<path fill="none" stroke="black" d="M298359.8,-513.77C298359.8,-513.77 298359.8,-440 298359.8,-440"/>
<polygon fill="black" stroke="black" points="298363.3,-440 298359.8,-430 298356.3,-440 298363.3,-440"/>
</g>
<!-- l2_ffn_up_0&#45;&gt;l2_ffn_down_0 -->
<g id="edge776" class="edge">
<title>l2_ffn_up_0&#45;&gt;l2_ffn_down_0</title>
<path fill="none" stroke="black" d="M298409.6,-513.77C298409.6,-513.77 298409.6,-440 298409.6,-440"/>
<polygon fill="black" stroke="black" points="298413.1,-440 298409.6,-430 298406.1,-440 298413.1,-440"/>
</g>
<!-- l2_ffn_up_0&#45;&gt;l2_ffn_down_0 -->
<g id="edge872" class="edge">
<title>l2_ffn_up_0&#45;&gt;l2_ffn_down_0</title>
<path fill="none" stroke="black" d="M298459.4,-513.77C298459.4,-513.77 298459.4,-440 298459.4,-440"/>
<polygon fill="black" stroke="black" points="298462.9,-440 298459.4,-430 298455.9,-440 298462.9,-440"/>
</g>
<!-- l2_ffn_up_0&#45;&gt;l2_ffn_down_0 -->
<g id="edge992" class="edge">
<title>l2_ffn_up_0&#45;&gt;l2_ffn_down_0</title>
<path fill="none" stroke="black" d="M298509.2,-513.77C298509.2,-513.77 298509.2,-440 298509.2,-440"/>
<polygon fill="black" stroke="black" points="298512.7,-440 298509.2,-430 298505.7,-440 298512.7,-440"/>
</g>
<!-- l2_ffn_res_0 -->
<g id="node534" class="node">
<title>l2_ffn_res_0</title>
<polygon fill="lightgray" stroke="black" points="298749,-333 298202.1,-315 298749,-297 299295.9,-315 298749,-333"/>
<text text-anchor="middle" x="298749" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_down_0&#45;&gt;l2_ffn_res_0 -->
<g id="edge705" class="edge">
<title>l2_ffn_down_0&#45;&gt;l2_ffn_res_0</title>
<path fill="none" stroke="black" d="M298442.4,-393.76C298442.4,-393.76 298442.4,-333.35 298442.4,-333.35"/>
<polygon fill="black" stroke="black" points="298445.9,-333.35 298442.4,-323.35 298438.9,-333.35 298445.9,-333.35"/>
</g>
<!-- l2_ffn_down_0&#45;&gt;l2_ffn_res_0 -->
<g id="edge777" class="edge">
<title>l2_ffn_down_0&#45;&gt;l2_ffn_res_0</title>
<path fill="none" stroke="black" d="M298574.8,-393.76C298574.8,-393.76 298574.8,-337.32 298574.8,-337.32"/>
<polygon fill="black" stroke="black" points="298578.3,-337.32 298574.8,-327.32 298571.3,-337.32 298578.3,-337.32"/>
</g>
<!-- l2_ffn_down_0&#45;&gt;l2_ffn_res_0 -->
<g id="edge873" class="edge">
<title>l2_ffn_down_0&#45;&gt;l2_ffn_res_0</title>
<path fill="none" stroke="black" d="M298707.2,-393.76C298707.2,-393.76 298707.2,-341.86 298707.2,-341.86"/>
<polygon fill="black" stroke="black" points="298710.7,-341.86 298707.2,-331.86 298703.7,-341.86 298710.7,-341.86"/>
</g>
<!-- l2_ffn_down_0&#45;&gt;l2_ffn_res_0 -->
<g id="edge993" class="edge">
<title>l2_ffn_down_0&#45;&gt;l2_ffn_res_0</title>
<path fill="none" stroke="black" d="M298839.6,-393.76C298839.6,-393.76 298839.6,-340.29 298839.6,-340.29"/>
<polygon fill="black" stroke="black" points="298843.1,-340.29 298839.6,-330.29 298836.1,-340.29 298843.1,-340.29"/>
</g>
<!-- l2_ffn_res_0&#45;&gt;l2_ffn_ln_0 -->
<g id="edge707" class="edge">
<title>l2_ffn_res_0&#45;&gt;l2_ffn_ln_0</title>
<path fill="none" stroke="black" d="M298251.32,-313.22C298251.32,-313.22 298251.32,-271.27 298251.32,-271.27"/>
<polygon fill="black" stroke="black" points="298254.82,-271.27 298251.32,-261.27 298247.82,-271.27 298254.82,-271.27"/>
</g>
<!-- l2_ffn_res_0&#45;&gt;l2_ffn_ln_0 -->
<g id="edge779" class="edge">
<title>l2_ffn_res_0&#45;&gt;l2_ffn_ln_0</title>
<path fill="none" stroke="black" d="M298300.59,-311.53C298300.59,-311.53 298300.59,-271.21 298300.59,-271.21"/>
<polygon fill="black" stroke="black" points="298304.1,-271.21 298300.59,-261.21 298297.1,-271.21 298304.1,-271.21"/>
</g>
<!-- l2_ffn_res_0&#45;&gt;l2_ffn_ln_0 -->
<g id="edge875" class="edge">
<title>l2_ffn_res_0&#45;&gt;l2_ffn_ln_0</title>
<path fill="none" stroke="black" d="M298349.87,-309.82C298349.87,-309.82 298349.87,-271.02 298349.87,-271.02"/>
<polygon fill="black" stroke="black" points="298353.37,-271.02 298349.87,-261.02 298346.37,-271.02 298353.37,-271.02"/>
</g>
<!-- l2_ffn_res_0&#45;&gt;l2_ffn_ln_0 -->
<g id="edge995" class="edge">
<title>l2_ffn_res_0&#45;&gt;l2_ffn_ln_0</title>
<path fill="none" stroke="black" d="M298399.14,-308.36C298399.14,-308.36 298399.14,-271.05 298399.14,-271.05"/>
<polygon fill="black" stroke="black" points="298402.64,-271.05 298399.14,-261.05 298395.64,-271.05 298402.64,-271.05"/>
</g>
<!-- l2_ffn_ln_0&#45;&gt;l2_ffn_up_0 -->
<g id="edge703" class="edge">
<title>l2_ffn_ln_0&#45;&gt;l2_ffn_up_0</title>
<path fill="none" stroke="black" d="M298185.12,-261.08C298185.12,-261.08 298185.12,-503.93 298185.12,-503.93"/>
<polygon fill="black" stroke="black" points="298181.62,-503.93 298185.12,-513.93 298188.62,-503.93 298181.62,-503.93"/>
</g>
<!-- l2_ffn_ln_0&#45;&gt;l2_ffn_up_0 -->
<g id="edge775" class="edge">
<title>l2_ffn_ln_0&#45;&gt;l2_ffn_up_0</title>
<path fill="none" stroke="black" d="M298189.35,-261.08C298189.35,-261.08 298189.35,-503.93 298189.35,-503.93"/>
<polygon fill="black" stroke="black" points="298185.85,-503.93 298189.35,-513.93 298192.85,-503.93 298185.85,-503.93"/>
</g>
<!-- l2_ffn_ln_0&#45;&gt;l2_ffn_up_0 -->
<g id="edge871" class="edge">
<title>l2_ffn_ln_0&#45;&gt;l2_ffn_up_0</title>
<path fill="none" stroke="black" d="M298193.58,-261.08C298193.58,-261.08 298193.58,-503.93 298193.58,-503.93"/>
<polygon fill="black" stroke="black" points="298190.08,-503.93 298193.58,-513.93 298197.08,-503.93 298190.08,-503.93"/>
</g>
<!-- l2_ffn_ln_0&#45;&gt;l2_ffn_up_0 -->
<g id="edge991" class="edge">
<title>l2_ffn_ln_0&#45;&gt;l2_ffn_up_0</title>
<path fill="none" stroke="black" d="M298197.82,-261.08C298197.82,-261.08 298197.82,-503.93 298197.82,-503.93"/>
<polygon fill="black" stroke="black" points="298194.32,-503.93 298197.82,-513.93 298201.32,-503.93 298194.32,-503.93"/>
</g>
<!-- l2_ffn_ln_0&#45;&gt;l2_ffn_res_0 -->
<g id="edge706" class="edge">
<title>l2_ffn_ln_0&#45;&gt;l2_ffn_res_0</title>
<path fill="none" stroke="black" d="M298448.41,-261.17C298448.41,-261.17 298448.41,-296.81 298448.41,-296.81"/>
<polygon fill="black" stroke="black" points="298444.91,-296.81 298448.41,-306.81 298451.91,-296.81 298444.91,-296.81"/>
</g>
<!-- l2_ffn_ln_0&#45;&gt;l2_ffn_res_0 -->
<g id="edge778" class="edge">
<title>l2_ffn_ln_0&#45;&gt;l2_ffn_res_0</title>
<path fill="none" stroke="black" d="M298497.68,-261.17C298497.68,-261.17 298497.68,-295.25 298497.68,-295.25"/>
<polygon fill="black" stroke="black" points="298494.18,-295.25 298497.68,-305.25 298501.18,-295.25 298494.18,-295.25"/>
</g>
<!-- l2_ffn_ln_0&#45;&gt;l2_ffn_res_0 -->
<g id="edge874" class="edge">
<title>l2_ffn_ln_0&#45;&gt;l2_ffn_res_0</title>
<path fill="none" stroke="black" d="M298546.96,-261.17C298546.96,-261.17 298546.96,-293.59 298546.96,-293.59"/>
<polygon fill="black" stroke="black" points="298543.46,-293.59 298546.96,-303.59 298550.46,-293.59 298543.46,-293.59"/>
</g>
<!-- l2_ffn_ln_0&#45;&gt;l2_ffn_res_0 -->
<g id="edge994" class="edge">
<title>l2_ffn_ln_0&#45;&gt;l2_ffn_res_0</title>
<path fill="none" stroke="black" d="M298596.23,-261.17C298596.23,-261.17 298596.23,-291.84 298596.23,-291.84"/>
<polygon fill="black" stroke="black" points="298592.73,-291.84 298596.23,-301.84 298599.73,-291.84 298592.73,-291.84"/>
</g>
<!-- l2_ffn_up_1 -->
<g id="node536" class="node">
<title>l2_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="297675,-550 297025,-550 297025,-514 297675,-514 297675,-550"/>
<text text-anchor="middle" x="297350" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ffn_down_1 -->
<g id="node537" class="node">
<title>l2_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="297923,-430 297261,-430 297261,-394 297923,-394 297923,-430"/>
<text text-anchor="middle" x="297592" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_1&#45;&gt;l2_ffn_down_1 -->
<g id="edge710" class="edge">
<title>l2_ffn_up_1&#45;&gt;l2_ffn_down_1</title>
<path fill="none" stroke="black" d="M297343.8,-513.77C297343.8,-513.77 297343.8,-440 297343.8,-440"/>
<polygon fill="black" stroke="black" points="297347.3,-440 297343.8,-430 297340.3,-440 297347.3,-440"/>
</g>
<!-- l2_ffn_up_1&#45;&gt;l2_ffn_down_1 -->
<g id="edge782" class="edge">
<title>l2_ffn_up_1&#45;&gt;l2_ffn_down_1</title>
<path fill="none" stroke="black" d="M297426.6,-513.77C297426.6,-513.77 297426.6,-440 297426.6,-440"/>
<polygon fill="black" stroke="black" points="297430.1,-440 297426.6,-430 297423.1,-440 297430.1,-440"/>
</g>
<!-- l2_ffn_up_1&#45;&gt;l2_ffn_down_1 -->
<g id="edge878" class="edge">
<title>l2_ffn_up_1&#45;&gt;l2_ffn_down_1</title>
<path fill="none" stroke="black" d="M297509.4,-513.77C297509.4,-513.77 297509.4,-440 297509.4,-440"/>
<polygon fill="black" stroke="black" points="297512.9,-440 297509.4,-430 297505.9,-440 297512.9,-440"/>
</g>
<!-- l2_ffn_up_1&#45;&gt;l2_ffn_down_1 -->
<g id="edge998" class="edge">
<title>l2_ffn_up_1&#45;&gt;l2_ffn_down_1</title>
<path fill="none" stroke="black" d="M297592.2,-513.77C297592.2,-513.77 297592.2,-440 297592.2,-440"/>
<polygon fill="black" stroke="black" points="297595.7,-440 297592.2,-430 297588.7,-440 297595.7,-440"/>
</g>
<!-- l2_ffn_res_1 -->
<g id="node538" class="node">
<title>l2_ffn_res_1</title>
<polygon fill="lightgray" stroke="black" points="297617,-333 297070.1,-315 297617,-297 298163.9,-315 297617,-333"/>
<text text-anchor="middle" x="297617" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_down_1&#45;&gt;l2_ffn_res_1 -->
<g id="edge711" class="edge">
<title>l2_ffn_down_1&#45;&gt;l2_ffn_res_1</title>
<path fill="none" stroke="black" d="M297393.4,-393.76C297393.4,-393.76 297393.4,-335.66 297393.4,-335.66"/>
<polygon fill="black" stroke="black" points="297396.9,-335.66 297393.4,-325.66 297389.9,-335.66 297396.9,-335.66"/>
</g>
<!-- l2_ffn_down_1&#45;&gt;l2_ffn_res_1 -->
<g id="edge783" class="edge">
<title>l2_ffn_down_1&#45;&gt;l2_ffn_res_1</title>
<path fill="none" stroke="black" d="M297525.8,-393.76C297525.8,-393.76 297525.8,-340.29 297525.8,-340.29"/>
<polygon fill="black" stroke="black" points="297529.3,-340.29 297525.8,-330.29 297522.3,-340.29 297529.3,-340.29"/>
</g>
<!-- l2_ffn_down_1&#45;&gt;l2_ffn_res_1 -->
<g id="edge879" class="edge">
<title>l2_ffn_down_1&#45;&gt;l2_ffn_res_1</title>
<path fill="none" stroke="black" d="M297658.2,-393.76C297658.2,-393.76 297658.2,-341.86 297658.2,-341.86"/>
<polygon fill="black" stroke="black" points="297661.7,-341.86 297658.2,-331.86 297654.7,-341.86 297661.7,-341.86"/>
</g>
<!-- l2_ffn_down_1&#45;&gt;l2_ffn_res_1 -->
<g id="edge999" class="edge">
<title>l2_ffn_down_1&#45;&gt;l2_ffn_res_1</title>
<path fill="none" stroke="black" d="M297790.6,-393.76C297790.6,-393.76 297790.6,-337.32 297790.6,-337.32"/>
<polygon fill="black" stroke="black" points="297794.1,-337.32 297790.6,-327.32 297787.1,-337.32 297794.1,-337.32"/>
</g>
<!-- l2_ffn_res_1&#45;&gt;l2_ffn_ln_1 -->
<g id="edge713" class="edge">
<title>l2_ffn_res_1&#45;&gt;l2_ffn_ln_1</title>
<path fill="none" stroke="black" d="M297280.1,-307.83C297280.1,-307.83 297280.1,-271.05 297280.1,-271.05"/>
<polygon fill="black" stroke="black" points="297283.6,-271.05 297280.1,-261.05 297276.6,-271.05 297283.6,-271.05"/>
</g>
<!-- l2_ffn_res_1&#45;&gt;l2_ffn_ln_1 -->
<g id="edge785" class="edge">
<title>l2_ffn_res_1&#45;&gt;l2_ffn_ln_1</title>
<path fill="none" stroke="black" d="M297343.4,-305.88C297343.4,-305.88 297343.4,-271.15 297343.4,-271.15"/>
<polygon fill="black" stroke="black" points="297346.9,-271.15 297343.4,-261.15 297339.9,-271.15 297346.9,-271.15"/>
</g>
<!-- l2_ffn_res_1&#45;&gt;l2_ffn_ln_1 -->
<g id="edge881" class="edge">
<title>l2_ffn_res_1&#45;&gt;l2_ffn_ln_1</title>
<path fill="none" stroke="black" d="M297406.7,-303.75C297406.7,-303.75 297406.7,-271.17 297406.7,-271.17"/>
<polygon fill="black" stroke="black" points="297410.2,-271.17 297406.7,-261.17 297403.2,-271.17 297410.2,-271.17"/>
</g>
<!-- l2_ffn_res_1&#45;&gt;l2_ffn_ln_1 -->
<g id="edge1001" class="edge">
<title>l2_ffn_res_1&#45;&gt;l2_ffn_ln_1</title>
<path fill="none" stroke="black" d="M297470,-301.79C297470,-301.79 297470,-271 297470,-271"/>
<polygon fill="black" stroke="black" points="297473.5,-271 297470,-261 297466.5,-271 297473.5,-271"/>
</g>
<!-- l2_ffn_ln_1&#45;&gt;l2_ffn_up_1 -->
<g id="edge709" class="edge">
<title>l2_ffn_ln_1&#45;&gt;l2_ffn_up_1</title>
<path fill="none" stroke="black" d="M297153.3,-244C297101.1,-244 297063.61,-244 297063.61,-244 297063.61,-244 297063.61,-503.98 297063.61,-503.98"/>
<polygon fill="black" stroke="black" points="297060.11,-503.98 297063.61,-513.98 297067.11,-503.98 297060.11,-503.98"/>
</g>
<!-- l2_ffn_ln_1&#45;&gt;l2_ffn_up_1 -->
<g id="edge781" class="edge">
<title>l2_ffn_ln_1&#45;&gt;l2_ffn_up_1</title>
<path fill="none" stroke="black" d="M297153.45,-241C297097.75,-241 297057.18,-241 297057.18,-241 297057.18,-241 297057.18,-503.8 297057.18,-503.8"/>
<polygon fill="black" stroke="black" points="297053.68,-503.8 297057.18,-513.8 297060.68,-503.8 297053.68,-503.8"/>
</g>
<!-- l2_ffn_ln_1&#45;&gt;l2_ffn_up_1 -->
<g id="edge877" class="edge">
<title>l2_ffn_ln_1&#45;&gt;l2_ffn_up_1</title>
<path fill="none" stroke="black" d="M297153.3,-238C297094.29,-238 297050.74,-238 297050.74,-238 297050.74,-238 297050.74,-503.61 297050.74,-503.61"/>
<polygon fill="black" stroke="black" points="297047.24,-503.61 297050.74,-513.61 297054.24,-503.61 297047.24,-503.61"/>
</g>
<!-- l2_ffn_ln_1&#45;&gt;l2_ffn_up_1 -->
<g id="edge997" class="edge">
<title>l2_ffn_ln_1&#45;&gt;l2_ffn_up_1</title>
<path fill="none" stroke="black" d="M297153.38,-234C297090.96,-234 297044.31,-234 297044.31,-234 297044.31,-234 297044.31,-503.81 297044.31,-503.81"/>
<polygon fill="black" stroke="black" points="297040.81,-503.81 297044.31,-513.81 297047.81,-503.81 297040.81,-503.81"/>
</g>
<!-- l2_ffn_ln_1&#45;&gt;l2_ffn_res_1 -->
<g id="edge712" class="edge">
<title>l2_ffn_ln_1&#45;&gt;l2_ffn_res_1</title>
<path fill="none" stroke="black" d="M297533.3,-261.17C297533.3,-261.17 297533.3,-289.52 297533.3,-289.52"/>
<polygon fill="black" stroke="black" points="297529.8,-289.52 297533.3,-299.52 297536.8,-289.52 297529.8,-289.52"/>
</g>
<!-- l2_ffn_ln_1&#45;&gt;l2_ffn_res_1 -->
<g id="edge784" class="edge">
<title>l2_ffn_ln_1&#45;&gt;l2_ffn_res_1</title>
<path fill="none" stroke="black" d="M297596.6,-261.17C297596.6,-261.17 297596.6,-287.58 297596.6,-287.58"/>
<polygon fill="black" stroke="black" points="297593.1,-287.58 297596.6,-297.58 297600.1,-287.58 297593.1,-287.58"/>
</g>
<!-- l2_ffn_ln_1&#45;&gt;l2_ffn_res_1 -->
<g id="edge880" class="edge">
<title>l2_ffn_ln_1&#45;&gt;l2_ffn_res_1</title>
<path fill="none" stroke="black" d="M297659.9,-261.17C297659.9,-261.17 297659.9,-288.07 297659.9,-288.07"/>
<polygon fill="black" stroke="black" points="297656.4,-288.07 297659.9,-298.07 297663.4,-288.07 297656.4,-288.07"/>
</g>
<!-- l2_ffn_ln_1&#45;&gt;l2_ffn_res_1 -->
<g id="edge1000" class="edge">
<title>l2_ffn_ln_1&#45;&gt;l2_ffn_res_1</title>
<path fill="none" stroke="black" d="M297723.2,-261.17C297723.2,-261.17 297723.2,-290.46 297723.2,-290.46"/>
<polygon fill="black" stroke="black" points="297719.7,-290.46 297723.2,-300.46 297726.7,-290.46 297719.7,-290.46"/>
</g>
<!-- l2_ffn_up_2 -->
<g id="node540" class="node">
<title>l2_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="295852,-550 295202,-550 295202,-514 295852,-514 295852,-550"/>
<text text-anchor="middle" x="295527" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ffn_down_2 -->
<g id="node541" class="node">
<title>l2_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="295772,-430 295110,-430 295110,-394 295772,-394 295772,-430"/>
<text text-anchor="middle" x="295441" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_2&#45;&gt;l2_ffn_down_2 -->
<g id="edge716" class="edge">
<title>l2_ffn_up_2&#45;&gt;l2_ffn_down_2</title>
<path fill="none" stroke="black" d="M295316,-513.77C295316,-513.77 295316,-440 295316,-440"/>
<polygon fill="black" stroke="black" points="295319.5,-440 295316,-430 295312.5,-440 295319.5,-440"/>
</g>
<!-- l2_ffn_up_2&#45;&gt;l2_ffn_down_2 -->
<g id="edge788" class="edge">
<title>l2_ffn_up_2&#45;&gt;l2_ffn_down_2</title>
<path fill="none" stroke="black" d="M295430,-513.77C295430,-513.77 295430,-440 295430,-440"/>
<polygon fill="black" stroke="black" points="295433.5,-440 295430,-430 295426.5,-440 295433.5,-440"/>
</g>
<!-- l2_ffn_up_2&#45;&gt;l2_ffn_down_2 -->
<g id="edge884" class="edge">
<title>l2_ffn_up_2&#45;&gt;l2_ffn_down_2</title>
<path fill="none" stroke="black" d="M295544,-513.77C295544,-513.77 295544,-440 295544,-440"/>
<polygon fill="black" stroke="black" points="295547.5,-440 295544,-430 295540.5,-440 295547.5,-440"/>
</g>
<!-- l2_ffn_up_2&#45;&gt;l2_ffn_down_2 -->
<g id="edge1004" class="edge">
<title>l2_ffn_up_2&#45;&gt;l2_ffn_down_2</title>
<path fill="none" stroke="black" d="M295658,-513.77C295658,-513.77 295658,-440 295658,-440"/>
<polygon fill="black" stroke="black" points="295661.5,-440 295658,-430 295654.5,-440 295661.5,-440"/>
</g>
<!-- l2_ffn_res_2 -->
<g id="node542" class="node">
<title>l2_ffn_res_2</title>
<polygon fill="lightgray" stroke="black" points="295333,-333 294786.1,-315 295333,-297 295879.9,-315 295333,-333"/>
<text text-anchor="middle" x="295333" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_down_2&#45;&gt;l2_ffn_res_2 -->
<g id="edge717" class="edge">
<title>l2_ffn_down_2&#45;&gt;l2_ffn_res_2</title>
<path fill="none" stroke="black" d="M295242.4,-393.76C295242.4,-393.76 295242.4,-340.29 295242.4,-340.29"/>
<polygon fill="black" stroke="black" points="295245.9,-340.29 295242.4,-330.29 295238.9,-340.29 295245.9,-340.29"/>
</g>
<!-- l2_ffn_down_2&#45;&gt;l2_ffn_res_2 -->
<g id="edge789" class="edge">
<title>l2_ffn_down_2&#45;&gt;l2_ffn_res_2</title>
<path fill="none" stroke="black" d="M295374.8,-393.76C295374.8,-393.76 295374.8,-341.86 295374.8,-341.86"/>
<polygon fill="black" stroke="black" points="295378.3,-341.86 295374.8,-331.86 295371.3,-341.86 295378.3,-341.86"/>
</g>
<!-- l2_ffn_down_2&#45;&gt;l2_ffn_res_2 -->
<g id="edge885" class="edge">
<title>l2_ffn_down_2&#45;&gt;l2_ffn_res_2</title>
<path fill="none" stroke="black" d="M295507.2,-393.76C295507.2,-393.76 295507.2,-337.32 295507.2,-337.32"/>
<polygon fill="black" stroke="black" points="295510.7,-337.32 295507.2,-327.32 295503.7,-337.32 295510.7,-337.32"/>
</g>
<!-- l2_ffn_down_2&#45;&gt;l2_ffn_res_2 -->
<g id="edge1005" class="edge">
<title>l2_ffn_down_2&#45;&gt;l2_ffn_res_2</title>
<path fill="none" stroke="black" d="M295639.6,-393.76C295639.6,-393.76 295639.6,-333.35 295639.6,-333.35"/>
<polygon fill="black" stroke="black" points="295643.1,-333.35 295639.6,-323.35 295636.1,-333.35 295643.1,-333.35"/>
</g>
<!-- l2_ffn_res_2&#45;&gt;l2_ffn_ln_2 -->
<g id="edge719" class="edge">
<title>l2_ffn_res_2&#45;&gt;l2_ffn_ln_2</title>
<path fill="none" stroke="black" d="M295143.1,-303.11C295143.1,-303.11 295143.1,-271.12 295143.1,-271.12"/>
<polygon fill="black" stroke="black" points="295146.6,-271.12 295143.1,-261.12 295139.6,-271.12 295146.6,-271.12"/>
</g>
<!-- l2_ffn_res_2&#45;&gt;l2_ffn_ln_2 -->
<g id="edge791" class="edge">
<title>l2_ffn_res_2&#45;&gt;l2_ffn_ln_2</title>
<path fill="none" stroke="black" d="M295206.4,-301.12C295206.4,-301.12 295206.4,-271.2 295206.4,-271.2"/>
<polygon fill="black" stroke="black" points="295209.9,-271.2 295206.4,-261.2 295202.9,-271.2 295209.9,-271.2"/>
</g>
<!-- l2_ffn_res_2&#45;&gt;l2_ffn_ln_2 -->
<g id="edge887" class="edge">
<title>l2_ffn_res_2&#45;&gt;l2_ffn_ln_2</title>
<path fill="none" stroke="black" d="M295269.7,-299.02C295269.7,-299.02 295269.7,-271.22 295269.7,-271.22"/>
<polygon fill="black" stroke="black" points="295273.2,-271.22 295269.7,-261.22 295266.2,-271.22 295273.2,-271.22"/>
</g>
<!-- l2_ffn_res_2&#45;&gt;l2_ffn_ln_2 -->
<g id="edge1007" class="edge">
<title>l2_ffn_res_2&#45;&gt;l2_ffn_ln_2</title>
<path fill="none" stroke="black" d="M295333,-296.83C295333,-296.83 295333,-271.41 295333,-271.41"/>
<polygon fill="black" stroke="black" points="295336.5,-271.41 295333,-261.41 295329.5,-271.41 295336.5,-271.41"/>
</g>
<!-- l2_ffn_ln_2&#45;&gt;l2_ffn_up_2 -->
<g id="edge715" class="edge">
<title>l2_ffn_ln_2&#45;&gt;l2_ffn_up_2</title>
<path fill="none" stroke="black" d="M295649.63,-245C295777.87,-245 295896.28,-245 295896.28,-245 295896.28,-245 295896.28,-521 295896.28,-521 295896.28,-521 295862.1,-521 295862.1,-521"/>
<polygon fill="black" stroke="black" points="295862.1,-517.5 295852.1,-521 295862.1,-524.5 295862.1,-517.5"/>
</g>
<!-- l2_ffn_ln_2&#45;&gt;l2_ffn_up_2 -->
<g id="edge787" class="edge">
<title>l2_ffn_ln_2&#45;&gt;l2_ffn_up_2</title>
<path fill="none" stroke="black" d="M295649.79,-240C295780.38,-240 295901.72,-240 295901.72,-240 295901.72,-240 295901.72,-528 295901.72,-528 295901.72,-528 295862.35,-528 295862.35,-528"/>
<polygon fill="black" stroke="black" points="295862.35,-524.5 295852.35,-528 295862.35,-531.5 295862.35,-524.5"/>
</g>
<!-- l2_ffn_ln_2&#45;&gt;l2_ffn_up_2 -->
<g id="edge883" class="edge">
<title>l2_ffn_ln_2&#45;&gt;l2_ffn_up_2</title>
<path fill="none" stroke="black" d="M295649.89,-235C295782.84,-235 295907.16,-235 295907.16,-235 295907.16,-235 295907.16,-535 295907.16,-535 295907.16,-535 295862.29,-535 295862.29,-535"/>
<polygon fill="black" stroke="black" points="295862.29,-531.5 295852.29,-535 295862.29,-538.5 295862.29,-531.5"/>
</g>
<!-- l2_ffn_ln_2&#45;&gt;l2_ffn_up_2 -->
<g id="edge1003" class="edge">
<title>l2_ffn_ln_2&#45;&gt;l2_ffn_up_2</title>
<path fill="none" stroke="black" d="M295649.51,-230C295784.99,-230 295912.61,-230 295912.61,-230 295912.61,-230 295912.61,-542 295912.61,-542 295912.61,-542 295862.36,-542 295862.36,-542"/>
<polygon fill="black" stroke="black" points="295862.36,-538.5 295852.36,-542 295862.36,-545.5 295862.36,-538.5"/>
</g>
<!-- l2_ffn_ln_2&#45;&gt;l2_ffn_res_2 -->
<g id="edge718" class="edge">
<title>l2_ffn_ln_2&#45;&gt;l2_ffn_res_2</title>
<path fill="none" stroke="black" d="M295396.3,-261.17C295396.3,-261.17 295396.3,-289.04 295396.3,-289.04"/>
<polygon fill="black" stroke="black" points="295392.8,-289.04 295396.3,-299.04 295399.8,-289.04 295392.8,-289.04"/>
</g>
<!-- l2_ffn_ln_2&#45;&gt;l2_ffn_res_2 -->
<g id="edge790" class="edge">
<title>l2_ffn_ln_2&#45;&gt;l2_ffn_res_2</title>
<path fill="none" stroke="black" d="M295459.6,-261.17C295459.6,-261.17 295459.6,-290.93 295459.6,-290.93"/>
<polygon fill="black" stroke="black" points="295456.1,-290.93 295459.6,-300.93 295463.1,-290.93 295456.1,-290.93"/>
</g>
<!-- l2_ffn_ln_2&#45;&gt;l2_ffn_res_2 -->
<g id="edge886" class="edge">
<title>l2_ffn_ln_2&#45;&gt;l2_ffn_res_2</title>
<path fill="none" stroke="black" d="M295522.9,-261.17C295522.9,-261.17 295522.9,-293.16 295522.9,-293.16"/>
<polygon fill="black" stroke="black" points="295519.4,-293.16 295522.9,-303.16 295526.4,-293.16 295519.4,-293.16"/>
</g>
<!-- l2_ffn_ln_2&#45;&gt;l2_ffn_res_2 -->
<g id="edge1006" class="edge">
<title>l2_ffn_ln_2&#45;&gt;l2_ffn_res_2</title>
<path fill="none" stroke="black" d="M295586.2,-261.17C295586.2,-261.17 295586.2,-295.25 295586.2,-295.25"/>
<polygon fill="black" stroke="black" points="295582.7,-295.25 295586.2,-305.25 295589.7,-295.25 295582.7,-295.25"/>
</g>
<!-- l2_ffn_up_3 -->
<g id="node544" class="node">
<title>l2_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="296952,-550 296302,-550 296302,-514 296952,-514 296952,-550"/>
<text text-anchor="middle" x="296627" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ffn_down_3 -->
<g id="node545" class="node">
<title>l2_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="296904,-430 296242,-430 296242,-394 296904,-394 296904,-430"/>
<text text-anchor="middle" x="296573" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_3&#45;&gt;l2_ffn_down_3 -->
<g id="edge722" class="edge">
<title>l2_ffn_up_3&#45;&gt;l2_ffn_down_3</title>
<path fill="none" stroke="black" d="M296422.4,-513.77C296422.4,-513.77 296422.4,-440 296422.4,-440"/>
<polygon fill="black" stroke="black" points="296425.9,-440 296422.4,-430 296418.9,-440 296425.9,-440"/>
</g>
<!-- l2_ffn_up_3&#45;&gt;l2_ffn_down_3 -->
<g id="edge794" class="edge">
<title>l2_ffn_up_3&#45;&gt;l2_ffn_down_3</title>
<path fill="none" stroke="black" d="M296542.8,-513.77C296542.8,-513.77 296542.8,-440 296542.8,-440"/>
<polygon fill="black" stroke="black" points="296546.3,-440 296542.8,-430 296539.3,-440 296546.3,-440"/>
</g>
<!-- l2_ffn_up_3&#45;&gt;l2_ffn_down_3 -->
<g id="edge890" class="edge">
<title>l2_ffn_up_3&#45;&gt;l2_ffn_down_3</title>
<path fill="none" stroke="black" d="M296663.2,-513.77C296663.2,-513.77 296663.2,-440 296663.2,-440"/>
<polygon fill="black" stroke="black" points="296666.7,-440 296663.2,-430 296659.7,-440 296666.7,-440"/>
</g>
<!-- l2_ffn_up_3&#45;&gt;l2_ffn_down_3 -->
<g id="edge1010" class="edge">
<title>l2_ffn_up_3&#45;&gt;l2_ffn_down_3</title>
<path fill="none" stroke="black" d="M296783.6,-513.77C296783.6,-513.77 296783.6,-440 296783.6,-440"/>
<polygon fill="black" stroke="black" points="296787.1,-440 296783.6,-430 296780.1,-440 296787.1,-440"/>
</g>
<!-- l2_ffn_res_3 -->
<g id="node546" class="node">
<title>l2_ffn_res_3</title>
<polygon fill="lightgray" stroke="black" points="296465,-333 295918.1,-315 296465,-297 297011.9,-315 296465,-333"/>
<text text-anchor="middle" x="296465" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_down_3&#45;&gt;l2_ffn_res_3 -->
<g id="edge723" class="edge">
<title>l2_ffn_down_3&#45;&gt;l2_ffn_res_3</title>
<path fill="none" stroke="black" d="M296374.4,-393.76C296374.4,-393.76 296374.4,-340.29 296374.4,-340.29"/>
<polygon fill="black" stroke="black" points="296377.9,-340.29 296374.4,-330.29 296370.9,-340.29 296377.9,-340.29"/>
</g>
<!-- l2_ffn_down_3&#45;&gt;l2_ffn_res_3 -->
<g id="edge795" class="edge">
<title>l2_ffn_down_3&#45;&gt;l2_ffn_res_3</title>
<path fill="none" stroke="black" d="M296506.8,-393.76C296506.8,-393.76 296506.8,-341.86 296506.8,-341.86"/>
<polygon fill="black" stroke="black" points="296510.3,-341.86 296506.8,-331.86 296503.3,-341.86 296510.3,-341.86"/>
</g>
<!-- l2_ffn_down_3&#45;&gt;l2_ffn_res_3 -->
<g id="edge891" class="edge">
<title>l2_ffn_down_3&#45;&gt;l2_ffn_res_3</title>
<path fill="none" stroke="black" d="M296639.2,-393.76C296639.2,-393.76 296639.2,-337.32 296639.2,-337.32"/>
<polygon fill="black" stroke="black" points="296642.7,-337.32 296639.2,-327.32 296635.7,-337.32 296642.7,-337.32"/>
</g>
<!-- l2_ffn_down_3&#45;&gt;l2_ffn_res_3 -->
<g id="edge1011" class="edge">
<title>l2_ffn_down_3&#45;&gt;l2_ffn_res_3</title>
<path fill="none" stroke="black" d="M296771.6,-393.76C296771.6,-393.76 296771.6,-333.35 296771.6,-333.35"/>
<polygon fill="black" stroke="black" points="296775.1,-333.35 296771.6,-323.35 296768.1,-333.35 296775.1,-333.35"/>
</g>
<!-- l2_ffn_res_3&#45;&gt;l2_ffn_ln_3 -->
<g id="edge725" class="edge">
<title>l2_ffn_res_3&#45;&gt;l2_ffn_ln_3</title>
<path fill="none" stroke="black" d="M296321.14,-301.46C296321.14,-301.46 296321.14,-271.1 296321.14,-271.1"/>
<polygon fill="black" stroke="black" points="296324.64,-271.1 296321.14,-261.1 296317.64,-271.1 296324.64,-271.1"/>
</g>
<!-- l2_ffn_res_3&#45;&gt;l2_ffn_ln_3 -->
<g id="edge797" class="edge">
<title>l2_ffn_res_3&#45;&gt;l2_ffn_ln_3</title>
<path fill="none" stroke="black" d="M296378.68,-299.73C296378.68,-299.73 296378.68,-271.05 296378.68,-271.05"/>
<polygon fill="black" stroke="black" points="296382.18,-271.05 296378.68,-261.05 296375.18,-271.05 296382.18,-271.05"/>
</g>
<!-- l2_ffn_res_3&#45;&gt;l2_ffn_ln_3 -->
<g id="edge893" class="edge">
<title>l2_ffn_res_3&#45;&gt;l2_ffn_ln_3</title>
<path fill="none" stroke="black" d="M296436.23,-297.94C296436.23,-297.94 296436.23,-271.2 296436.23,-271.2"/>
<polygon fill="black" stroke="black" points="296439.73,-271.2 296436.23,-261.2 296432.73,-271.2 296439.73,-271.2"/>
</g>
<!-- l2_ffn_res_3&#45;&gt;l2_ffn_ln_3 -->
<g id="edge1013" class="edge">
<title>l2_ffn_res_3&#45;&gt;l2_ffn_ln_3</title>
<path fill="none" stroke="black" d="M296493.77,-297.94C296493.77,-297.94 296493.77,-271.2 296493.77,-271.2"/>
<polygon fill="black" stroke="black" points="296497.27,-271.2 296493.77,-261.2 296490.27,-271.2 296497.27,-271.2"/>
</g>
<!-- l2_ffn_ln_3&#45;&gt;l2_ffn_up_3 -->
<g id="edge721" class="edge">
<title>l2_ffn_ln_3&#45;&gt;l2_ffn_up_3</title>
<path fill="none" stroke="black" d="M296781.9,-257C296903.9,-257 297014.56,-257 297014.56,-257 297014.56,-257 297014.56,-521 297014.56,-521 297014.56,-521 296962.29,-521 296962.29,-521"/>
<polygon fill="black" stroke="black" points="296962.29,-517.5 296952.29,-521 296962.29,-524.5 296962.29,-517.5"/>
</g>
<!-- l2_ffn_ln_3&#45;&gt;l2_ffn_up_3 -->
<g id="edge793" class="edge">
<title>l2_ffn_ln_3&#45;&gt;l2_ffn_up_3</title>
<path fill="none" stroke="black" d="M296781.8,-254C296905.02,-254 297017.17,-254 297017.17,-254 297017.17,-254 297017.17,-528 297017.17,-528 297017.17,-528 296962.3,-528 296962.3,-528"/>
<polygon fill="black" stroke="black" points="296962.3,-524.5 296952.3,-528 296962.3,-531.5 296962.3,-524.5"/>
</g>
<!-- l2_ffn_ln_3&#45;&gt;l2_ffn_up_3 -->
<g id="edge889" class="edge">
<title>l2_ffn_ln_3&#45;&gt;l2_ffn_up_3</title>
<path fill="none" stroke="black" d="M296781.69,-251C296906.12,-251 297019.78,-251 297019.78,-251 297019.78,-251 297019.78,-535 297019.78,-535 297019.78,-535 296962.26,-535 296962.26,-535"/>
<polygon fill="black" stroke="black" points="296962.26,-531.5 296952.26,-535 296962.26,-538.5 296962.26,-531.5"/>
</g>
<!-- l2_ffn_ln_3&#45;&gt;l2_ffn_up_3 -->
<g id="edge1009" class="edge">
<title>l2_ffn_ln_3&#45;&gt;l2_ffn_up_3</title>
<path fill="none" stroke="black" d="M296781.56,-247C296907.2,-247 297022.39,-247 297022.39,-247 297022.39,-247 297022.39,-542 297022.39,-542 297022.39,-542 296962.16,-542 296962.16,-542"/>
<polygon fill="black" stroke="black" points="296962.16,-538.5 296952.16,-542 296962.16,-545.5 296962.16,-538.5"/>
</g>
<!-- l2_ffn_ln_3&#45;&gt;l2_ffn_res_3 -->
<g id="edge724" class="edge">
<title>l2_ffn_ln_3&#45;&gt;l2_ffn_res_3</title>
<path fill="none" stroke="black" d="M296551.32,-261.17C296551.32,-261.17 296551.32,-289.52 296551.32,-289.52"/>
<polygon fill="black" stroke="black" points="296547.82,-289.52 296551.32,-299.52 296554.82,-289.52 296547.82,-289.52"/>
</g>
<!-- l2_ffn_ln_3&#45;&gt;l2_ffn_res_3 -->
<g id="edge796" class="edge">
<title>l2_ffn_ln_3&#45;&gt;l2_ffn_res_3</title>
<path fill="none" stroke="black" d="M296608.86,-261.17C296608.86,-261.17 296608.86,-291.38 296608.86,-291.38"/>
<polygon fill="black" stroke="black" points="296605.36,-291.38 296608.86,-301.38 296612.36,-291.38 296605.36,-291.38"/>
</g>
<!-- l2_ffn_ln_3&#45;&gt;l2_ffn_res_3 -->
<g id="edge892" class="edge">
<title>l2_ffn_ln_3&#45;&gt;l2_ffn_res_3</title>
<path fill="none" stroke="black" d="M296666.41,-261.17C296666.41,-261.17 296666.41,-293.59 296666.41,-293.59"/>
<polygon fill="black" stroke="black" points="296662.91,-293.59 296666.41,-303.59 296669.91,-293.59 296662.91,-293.59"/>
</g>
<!-- l2_ffn_ln_3&#45;&gt;l2_ffn_res_3 -->
<g id="edge1012" class="edge">
<title>l2_ffn_ln_3&#45;&gt;l2_ffn_res_3</title>
<path fill="none" stroke="black" d="M296723.95,-261.17C296723.95,-261.17 296723.95,-295.25 296723.95,-295.25"/>
<polygon fill="black" stroke="black" points="296720.45,-295.25 296723.95,-305.25 296727.45,-295.25 296720.45,-295.25"/>
</g>
<!-- l2_ffn_up_4 -->
<g id="node548" class="node">
<title>l2_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="295006,-550 294356,-550 294356,-514 295006,-514 295006,-550"/>
<text text-anchor="middle" x="294681" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ffn_down_4 -->
<g id="node549" class="node">
<title>l2_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="294640,-430 293978,-430 293978,-394 294640,-394 294640,-430"/>
<text text-anchor="middle" x="294309" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_4&#45;&gt;l2_ffn_down_4 -->
<g id="edge728" class="edge">
<title>l2_ffn_up_4&#45;&gt;l2_ffn_down_4</title>
<path fill="none" stroke="black" d="M294412.8,-513.77C294412.8,-513.77 294412.8,-440 294412.8,-440"/>
<polygon fill="black" stroke="black" points="294416.3,-440 294412.8,-430 294409.3,-440 294416.3,-440"/>
</g>
<!-- l2_ffn_up_4&#45;&gt;l2_ffn_down_4 -->
<g id="edge800" class="edge">
<title>l2_ffn_up_4&#45;&gt;l2_ffn_down_4</title>
<path fill="none" stroke="black" d="M294469.6,-513.77C294469.6,-513.77 294469.6,-440 294469.6,-440"/>
<polygon fill="black" stroke="black" points="294473.1,-440 294469.6,-430 294466.1,-440 294473.1,-440"/>
</g>
<!-- l2_ffn_up_4&#45;&gt;l2_ffn_down_4 -->
<g id="edge896" class="edge">
<title>l2_ffn_up_4&#45;&gt;l2_ffn_down_4</title>
<path fill="none" stroke="black" d="M294526.4,-513.77C294526.4,-513.77 294526.4,-440 294526.4,-440"/>
<polygon fill="black" stroke="black" points="294529.9,-440 294526.4,-430 294522.9,-440 294529.9,-440"/>
</g>
<!-- l2_ffn_up_4&#45;&gt;l2_ffn_down_4 -->
<g id="edge1016" class="edge">
<title>l2_ffn_up_4&#45;&gt;l2_ffn_down_4</title>
<path fill="none" stroke="black" d="M294583.2,-513.77C294583.2,-513.77 294583.2,-440 294583.2,-440"/>
<polygon fill="black" stroke="black" points="294586.7,-440 294583.2,-430 294579.7,-440 294586.7,-440"/>
</g>
<!-- l2_ffn_res_4 -->
<g id="node550" class="node">
<title>l2_ffn_res_4</title>
<polygon fill="lightgray" stroke="black" points="294201,-333 293654.1,-315 294201,-297 294747.9,-315 294201,-333"/>
<text text-anchor="middle" x="294201" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_down_4&#45;&gt;l2_ffn_res_4 -->
<g id="edge729" class="edge">
<title>l2_ffn_down_4&#45;&gt;l2_ffn_res_4</title>
<path fill="none" stroke="black" d="M294110.4,-393.76C294110.4,-393.76 294110.4,-340.29 294110.4,-340.29"/>
<polygon fill="black" stroke="black" points="294113.9,-340.29 294110.4,-330.29 294106.9,-340.29 294113.9,-340.29"/>
</g>
<!-- l2_ffn_down_4&#45;&gt;l2_ffn_res_4 -->
<g id="edge801" class="edge">
<title>l2_ffn_down_4&#45;&gt;l2_ffn_res_4</title>
<path fill="none" stroke="black" d="M294242.8,-393.76C294242.8,-393.76 294242.8,-341.86 294242.8,-341.86"/>
<polygon fill="black" stroke="black" points="294246.3,-341.86 294242.8,-331.86 294239.3,-341.86 294246.3,-341.86"/>
</g>
<!-- l2_ffn_down_4&#45;&gt;l2_ffn_res_4 -->
<g id="edge897" class="edge">
<title>l2_ffn_down_4&#45;&gt;l2_ffn_res_4</title>
<path fill="none" stroke="black" d="M294375.2,-393.76C294375.2,-393.76 294375.2,-337.32 294375.2,-337.32"/>
<polygon fill="black" stroke="black" points="294378.7,-337.32 294375.2,-327.32 294371.7,-337.32 294378.7,-337.32"/>
</g>
<!-- l2_ffn_down_4&#45;&gt;l2_ffn_res_4 -->
<g id="edge1017" class="edge">
<title>l2_ffn_down_4&#45;&gt;l2_ffn_res_4</title>
<path fill="none" stroke="black" d="M294507.6,-393.76C294507.6,-393.76 294507.6,-333.35 294507.6,-333.35"/>
<polygon fill="black" stroke="black" points="294511.1,-333.35 294507.6,-323.35 294504.1,-333.35 294511.1,-333.35"/>
</g>
<!-- l2_ffn_res_4&#45;&gt;l2_ffn_ln_4 -->
<g id="edge731" class="edge">
<title>l2_ffn_res_4&#45;&gt;l2_ffn_ln_4</title>
<path fill="none" stroke="black" d="M294057.14,-301.46C294057.14,-301.46 294057.14,-271.1 294057.14,-271.1"/>
<polygon fill="black" stroke="black" points="294060.64,-271.1 294057.14,-261.1 294053.64,-271.1 294060.64,-271.1"/>
</g>
<!-- l2_ffn_res_4&#45;&gt;l2_ffn_ln_4 -->
<g id="edge803" class="edge">
<title>l2_ffn_res_4&#45;&gt;l2_ffn_ln_4</title>
<path fill="none" stroke="black" d="M294114.68,-299.73C294114.68,-299.73 294114.68,-271.05 294114.68,-271.05"/>
<polygon fill="black" stroke="black" points="294118.18,-271.05 294114.68,-261.05 294111.18,-271.05 294118.18,-271.05"/>
</g>
<!-- l2_ffn_res_4&#45;&gt;l2_ffn_ln_4 -->
<g id="edge899" class="edge">
<title>l2_ffn_res_4&#45;&gt;l2_ffn_ln_4</title>
<path fill="none" stroke="black" d="M294172.23,-297.94C294172.23,-297.94 294172.23,-271.2 294172.23,-271.2"/>
<polygon fill="black" stroke="black" points="294175.73,-271.2 294172.23,-261.2 294168.73,-271.2 294175.73,-271.2"/>
</g>
<!-- l2_ffn_res_4&#45;&gt;l2_ffn_ln_4 -->
<g id="edge1019" class="edge">
<title>l2_ffn_res_4&#45;&gt;l2_ffn_ln_4</title>
<path fill="none" stroke="black" d="M294229.77,-297.94C294229.77,-297.94 294229.77,-271.2 294229.77,-271.2"/>
<polygon fill="black" stroke="black" points="294233.27,-271.2 294229.77,-261.2 294226.27,-271.2 294233.27,-271.2"/>
</g>
<!-- l2_ffn_ln_4&#45;&gt;l2_ffn_up_4 -->
<g id="edge727" class="edge">
<title>l2_ffn_ln_4&#45;&gt;l2_ffn_up_4</title>
<path fill="none" stroke="black" d="M294517.63,-245C294645.87,-245 294764.28,-245 294764.28,-245 294764.28,-245 294764.28,-503.61 294764.28,-503.61"/>
<polygon fill="black" stroke="black" points="294760.78,-503.61 294764.28,-513.61 294767.78,-503.61 294760.78,-503.61"/>
</g>
<!-- l2_ffn_ln_4&#45;&gt;l2_ffn_up_4 -->
<g id="edge799" class="edge">
<title>l2_ffn_ln_4&#45;&gt;l2_ffn_up_4</title>
<path fill="none" stroke="black" d="M294517.79,-240C294648.38,-240 294769.72,-240 294769.72,-240 294769.72,-240 294769.72,-503.73 294769.72,-503.73"/>
<polygon fill="black" stroke="black" points="294766.22,-503.73 294769.72,-513.73 294773.22,-503.73 294766.22,-503.73"/>
</g>
<!-- l2_ffn_ln_4&#45;&gt;l2_ffn_up_4 -->
<g id="edge895" class="edge">
<title>l2_ffn_ln_4&#45;&gt;l2_ffn_up_4</title>
<path fill="none" stroke="black" d="M294517.89,-235C294650.84,-235 294775.16,-235 294775.16,-235 294775.16,-235 294775.16,-503.87 294775.16,-503.87"/>
<polygon fill="black" stroke="black" points="294771.66,-503.87 294775.16,-513.87 294778.66,-503.87 294771.66,-503.87"/>
</g>
<!-- l2_ffn_ln_4&#45;&gt;l2_ffn_up_4 -->
<g id="edge1015" class="edge">
<title>l2_ffn_ln_4&#45;&gt;l2_ffn_up_4</title>
<path fill="none" stroke="black" d="M294517.51,-230C294652.99,-230 294780.61,-230 294780.61,-230 294780.61,-230 294780.61,-503.56 294780.61,-503.56"/>
<polygon fill="black" stroke="black" points="294777.11,-503.56 294780.61,-513.56 294784.11,-503.56 294777.11,-503.56"/>
</g>
<!-- l2_ffn_ln_4&#45;&gt;l2_ffn_res_4 -->
<g id="edge730" class="edge">
<title>l2_ffn_ln_4&#45;&gt;l2_ffn_res_4</title>
<path fill="none" stroke="black" d="M294287.32,-261.17C294287.32,-261.17 294287.32,-289.52 294287.32,-289.52"/>
<polygon fill="black" stroke="black" points="294283.82,-289.52 294287.32,-299.52 294290.82,-289.52 294283.82,-289.52"/>
</g>
<!-- l2_ffn_ln_4&#45;&gt;l2_ffn_res_4 -->
<g id="edge802" class="edge">
<title>l2_ffn_ln_4&#45;&gt;l2_ffn_res_4</title>
<path fill="none" stroke="black" d="M294344.86,-261.17C294344.86,-261.17 294344.86,-291.38 294344.86,-291.38"/>
<polygon fill="black" stroke="black" points="294341.36,-291.38 294344.86,-301.38 294348.36,-291.38 294341.36,-291.38"/>
</g>
<!-- l2_ffn_ln_4&#45;&gt;l2_ffn_res_4 -->
<g id="edge898" class="edge">
<title>l2_ffn_ln_4&#45;&gt;l2_ffn_res_4</title>
<path fill="none" stroke="black" d="M294402.41,-261.17C294402.41,-261.17 294402.41,-293.59 294402.41,-293.59"/>
<polygon fill="black" stroke="black" points="294398.91,-293.59 294402.41,-303.59 294405.91,-293.59 294398.91,-293.59"/>
</g>
<!-- l2_ffn_ln_4&#45;&gt;l2_ffn_res_4 -->
<g id="edge1018" class="edge">
<title>l2_ffn_ln_4&#45;&gt;l2_ffn_res_4</title>
<path fill="none" stroke="black" d="M294459.95,-261.17C294459.95,-261.17 294459.95,-295.25 294459.95,-295.25"/>
<polygon fill="black" stroke="black" points="294456.45,-295.25 294459.95,-305.25 294463.45,-295.25 294456.45,-295.25"/>
</g>
<!-- l2_ffn_up_5 -->
<g id="node552" class="node">
<title>l2_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="291467,-550 290817,-550 290817,-514 291467,-514 291467,-550"/>
<text text-anchor="middle" x="291142" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ffn_down_5 -->
<g id="node553" class="node">
<title>l2_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="291244,-430 290582,-430 290582,-394 291244,-394 291244,-430"/>
<text text-anchor="middle" x="290913" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_5&#45;&gt;l2_ffn_down_5 -->
<g id="edge734" class="edge">
<title>l2_ffn_up_5&#45;&gt;l2_ffn_down_5</title>
<path fill="none" stroke="black" d="M290902.4,-513.77C290902.4,-513.77 290902.4,-440 290902.4,-440"/>
<polygon fill="black" stroke="black" points="290905.9,-440 290902.4,-430 290898.9,-440 290905.9,-440"/>
</g>
<!-- l2_ffn_up_5&#45;&gt;l2_ffn_down_5 -->
<g id="edge806" class="edge">
<title>l2_ffn_up_5&#45;&gt;l2_ffn_down_5</title>
<path fill="none" stroke="black" d="M290987.8,-513.77C290987.8,-513.77 290987.8,-440 290987.8,-440"/>
<polygon fill="black" stroke="black" points="290991.3,-440 290987.8,-430 290984.3,-440 290991.3,-440"/>
</g>
<!-- l2_ffn_up_5&#45;&gt;l2_ffn_down_5 -->
<g id="edge902" class="edge">
<title>l2_ffn_up_5&#45;&gt;l2_ffn_down_5</title>
<path fill="none" stroke="black" d="M291073.2,-513.77C291073.2,-513.77 291073.2,-440 291073.2,-440"/>
<polygon fill="black" stroke="black" points="291076.7,-440 291073.2,-430 291069.7,-440 291076.7,-440"/>
</g>
<!-- l2_ffn_up_5&#45;&gt;l2_ffn_down_5 -->
<g id="edge1022" class="edge">
<title>l2_ffn_up_5&#45;&gt;l2_ffn_down_5</title>
<path fill="none" stroke="black" d="M291158.6,-513.77C291158.6,-513.77 291158.6,-440 291158.6,-440"/>
<polygon fill="black" stroke="black" points="291162.1,-440 291158.6,-430 291155.1,-440 291162.1,-440"/>
</g>
<!-- l2_ffn_res_5 -->
<g id="node554" class="node">
<title>l2_ffn_res_5</title>
<polygon fill="lightgray" stroke="black" points="290805,-333 290258.1,-315 290805,-297 291351.9,-315 290805,-333"/>
<text text-anchor="middle" x="290805" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_down_5&#45;&gt;l2_ffn_res_5 -->
<g id="edge735" class="edge">
<title>l2_ffn_down_5&#45;&gt;l2_ffn_res_5</title>
<path fill="none" stroke="black" d="M290714.4,-393.76C290714.4,-393.76 290714.4,-340.29 290714.4,-340.29"/>
<polygon fill="black" stroke="black" points="290717.9,-340.29 290714.4,-330.29 290710.9,-340.29 290717.9,-340.29"/>
</g>
<!-- l2_ffn_down_5&#45;&gt;l2_ffn_res_5 -->
<g id="edge807" class="edge">
<title>l2_ffn_down_5&#45;&gt;l2_ffn_res_5</title>
<path fill="none" stroke="black" d="M290846.8,-393.76C290846.8,-393.76 290846.8,-341.86 290846.8,-341.86"/>
<polygon fill="black" stroke="black" points="290850.3,-341.86 290846.8,-331.86 290843.3,-341.86 290850.3,-341.86"/>
</g>
<!-- l2_ffn_down_5&#45;&gt;l2_ffn_res_5 -->
<g id="edge903" class="edge">
<title>l2_ffn_down_5&#45;&gt;l2_ffn_res_5</title>
<path fill="none" stroke="black" d="M290979.2,-393.76C290979.2,-393.76 290979.2,-337.32 290979.2,-337.32"/>
<polygon fill="black" stroke="black" points="290982.7,-337.32 290979.2,-327.32 290975.7,-337.32 290982.7,-337.32"/>
</g>
<!-- l2_ffn_down_5&#45;&gt;l2_ffn_res_5 -->
<g id="edge1023" class="edge">
<title>l2_ffn_down_5&#45;&gt;l2_ffn_res_5</title>
<path fill="none" stroke="black" d="M291111.6,-393.76C291111.6,-393.76 291111.6,-333.35 291111.6,-333.35"/>
<polygon fill="black" stroke="black" points="291115.1,-333.35 291111.6,-323.35 291108.1,-333.35 291115.1,-333.35"/>
</g>
<!-- l2_ffn_res_5&#45;&gt;l2_ffn_ln_5 -->
<g id="edge737" class="edge">
<title>l2_ffn_res_5&#45;&gt;l2_ffn_ln_5</title>
<path fill="none" stroke="black" d="M290558.83,-304.99C290558.83,-304.99 290558.83,-271.25 290558.83,-271.25"/>
<polygon fill="black" stroke="black" points="290562.33,-271.25 290558.83,-261.25 290555.33,-271.25 290562.33,-271.25"/>
</g>
<!-- l2_ffn_res_5&#45;&gt;l2_ffn_ln_5 -->
<g id="edge809" class="edge">
<title>l2_ffn_res_5&#45;&gt;l2_ffn_ln_5</title>
<path fill="none" stroke="black" d="M290629.17,-302.79C290629.17,-302.79 290629.17,-271.23 290629.17,-271.23"/>
<polygon fill="black" stroke="black" points="290632.67,-271.23 290629.17,-261.23 290625.67,-271.23 290632.67,-271.23"/>
</g>
<!-- l2_ffn_res_5&#45;&gt;l2_ffn_ln_5 -->
<g id="edge905" class="edge">
<title>l2_ffn_res_5&#45;&gt;l2_ffn_ln_5</title>
<path fill="none" stroke="black" d="M290699.5,-300.43C290699.5,-300.43 290699.5,-271.13 290699.5,-271.13"/>
<polygon fill="black" stroke="black" points="290703,-271.13 290699.5,-261.13 290696,-271.13 290703,-271.13"/>
</g>
<!-- l2_ffn_res_5&#45;&gt;l2_ffn_ln_5 -->
<g id="edge1025" class="edge">
<title>l2_ffn_res_5&#45;&gt;l2_ffn_ln_5</title>
<path fill="none" stroke="black" d="M290769.83,-297.94C290769.83,-297.94 290769.83,-271.2 290769.83,-271.2"/>
<polygon fill="black" stroke="black" points="290773.33,-271.2 290769.83,-261.2 290766.33,-271.2 290773.33,-271.2"/>
</g>
<!-- l2_ffn_ln_5&#45;&gt;l2_ffn_up_5 -->
<g id="edge733" class="edge">
<title>l2_ffn_ln_5&#45;&gt;l2_ffn_up_5</title>
<path fill="none" stroke="black" d="M291121.62,-249C291248.25,-249 291364.65,-249 291364.65,-249 291364.65,-249 291364.65,-503.87 291364.65,-503.87"/>
<polygon fill="black" stroke="black" points="291361.15,-503.87 291364.65,-513.87 291368.15,-503.87 291361.15,-503.87"/>
</g>
<!-- l2_ffn_ln_5&#45;&gt;l2_ffn_up_5 -->
<g id="edge805" class="edge">
<title>l2_ffn_ln_5&#45;&gt;l2_ffn_up_5</title>
<path fill="none" stroke="black" d="M291121.51,-243C291251,-243 291371,-243 291371,-243 291371,-243 291371,-503.92 291371,-503.92"/>
<polygon fill="black" stroke="black" points="291367.5,-503.92 291371,-513.92 291374.5,-503.92 291367.5,-503.92"/>
</g>
<!-- l2_ffn_ln_5&#45;&gt;l2_ffn_up_5 -->
<g id="edge901" class="edge">
<title>l2_ffn_ln_5&#45;&gt;l2_ffn_up_5</title>
<path fill="none" stroke="black" d="M291121.73,-237C291253.94,-237 291377.35,-237 291377.35,-237 291377.35,-237 291377.35,-503.99 291377.35,-503.99"/>
<polygon fill="black" stroke="black" points="291373.85,-503.99 291377.35,-513.99 291380.85,-503.99 291373.85,-503.99"/>
</g>
<!-- l2_ffn_ln_5&#45;&gt;l2_ffn_up_5 -->
<g id="edge1021" class="edge">
<title>l2_ffn_ln_5&#45;&gt;l2_ffn_up_5</title>
<path fill="none" stroke="black" d="M291121.86,-231C291256.81,-231 291383.7,-231 291383.7,-231 291383.7,-231 291383.7,-503.62 291383.7,-503.62"/>
<polygon fill="black" stroke="black" points="291380.2,-503.62 291383.7,-513.62 291387.2,-503.62 291380.2,-503.62"/>
</g>
<!-- l2_ffn_ln_5&#45;&gt;l2_ffn_res_5 -->
<g id="edge736" class="edge">
<title>l2_ffn_ln_5&#45;&gt;l2_ffn_res_5</title>
<path fill="none" stroke="black" d="M290840.17,-261.17C290840.17,-261.17 290840.17,-288.07 290840.17,-288.07"/>
<polygon fill="black" stroke="black" points="290836.67,-288.07 290840.17,-298.07 290843.67,-288.07 290836.67,-288.07"/>
</g>
<!-- l2_ffn_ln_5&#45;&gt;l2_ffn_res_5 -->
<g id="edge808" class="edge">
<title>l2_ffn_ln_5&#45;&gt;l2_ffn_res_5</title>
<path fill="none" stroke="black" d="M290910.5,-261.17C290910.5,-261.17 290910.5,-290.46 290910.5,-290.46"/>
<polygon fill="black" stroke="black" points="290907,-290.46 290910.5,-300.46 290914,-290.46 290907,-290.46"/>
</g>
<!-- l2_ffn_ln_5&#45;&gt;l2_ffn_res_5 -->
<g id="edge904" class="edge">
<title>l2_ffn_ln_5&#45;&gt;l2_ffn_res_5</title>
<path fill="none" stroke="black" d="M290980.83,-261.17C290980.83,-261.17 290980.83,-292.72 290980.83,-292.72"/>
<polygon fill="black" stroke="black" points="290977.33,-292.72 290980.83,-302.72 290984.33,-292.73 290977.33,-292.72"/>
</g>
<!-- l2_ffn_ln_5&#45;&gt;l2_ffn_res_5 -->
<g id="edge1024" class="edge">
<title>l2_ffn_ln_5&#45;&gt;l2_ffn_res_5</title>
<path fill="none" stroke="black" d="M291051.17,-261.17C291051.17,-261.17 291051.17,-294.85 291051.17,-294.85"/>
<polygon fill="black" stroke="black" points="291047.67,-294.85 291051.17,-304.85 291054.67,-294.85 291047.67,-294.85"/>
</g>
<!-- l2_ffn_up_6 -->
<g id="node556" class="node">
<title>l2_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="292599,-550 291949,-550 291949,-514 292599,-514 292599,-550"/>
<text text-anchor="middle" x="292274" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ffn_down_6 -->
<g id="node557" class="node">
<title>l2_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="292376,-430 291714,-430 291714,-394 292376,-394 292376,-430"/>
<text text-anchor="middle" x="292045" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_6&#45;&gt;l2_ffn_down_6 -->
<g id="edge740" class="edge">
<title>l2_ffn_up_6&#45;&gt;l2_ffn_down_6</title>
<path fill="none" stroke="black" d="M292034.4,-513.77C292034.4,-513.77 292034.4,-440 292034.4,-440"/>
<polygon fill="black" stroke="black" points="292037.9,-440 292034.4,-430 292030.9,-440 292037.9,-440"/>
</g>
<!-- l2_ffn_up_6&#45;&gt;l2_ffn_down_6 -->
<g id="edge812" class="edge">
<title>l2_ffn_up_6&#45;&gt;l2_ffn_down_6</title>
<path fill="none" stroke="black" d="M292119.8,-513.77C292119.8,-513.77 292119.8,-440 292119.8,-440"/>
<polygon fill="black" stroke="black" points="292123.3,-440 292119.8,-430 292116.3,-440 292123.3,-440"/>
</g>
<!-- l2_ffn_up_6&#45;&gt;l2_ffn_down_6 -->
<g id="edge908" class="edge">
<title>l2_ffn_up_6&#45;&gt;l2_ffn_down_6</title>
<path fill="none" stroke="black" d="M292205.2,-513.77C292205.2,-513.77 292205.2,-440 292205.2,-440"/>
<polygon fill="black" stroke="black" points="292208.7,-440 292205.2,-430 292201.7,-440 292208.7,-440"/>
</g>
<!-- l2_ffn_up_6&#45;&gt;l2_ffn_down_6 -->
<g id="edge1028" class="edge">
<title>l2_ffn_up_6&#45;&gt;l2_ffn_down_6</title>
<path fill="none" stroke="black" d="M292290.6,-513.77C292290.6,-513.77 292290.6,-440 292290.6,-440"/>
<polygon fill="black" stroke="black" points="292294.1,-440 292290.6,-430 292287.1,-440 292294.1,-440"/>
</g>
<!-- l2_ffn_res_6 -->
<g id="node558" class="node">
<title>l2_ffn_res_6</title>
<polygon fill="lightgray" stroke="black" points="291937,-333 291390.1,-315 291937,-297 292483.9,-315 291937,-333"/>
<text text-anchor="middle" x="291937" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_down_6&#45;&gt;l2_ffn_res_6 -->
<g id="edge741" class="edge">
<title>l2_ffn_down_6&#45;&gt;l2_ffn_res_6</title>
<path fill="none" stroke="black" d="M291846.4,-393.76C291846.4,-393.76 291846.4,-340.29 291846.4,-340.29"/>
<polygon fill="black" stroke="black" points="291849.9,-340.29 291846.4,-330.29 291842.9,-340.29 291849.9,-340.29"/>
</g>
<!-- l2_ffn_down_6&#45;&gt;l2_ffn_res_6 -->
<g id="edge813" class="edge">
<title>l2_ffn_down_6&#45;&gt;l2_ffn_res_6</title>
<path fill="none" stroke="black" d="M291978.8,-393.76C291978.8,-393.76 291978.8,-341.86 291978.8,-341.86"/>
<polygon fill="black" stroke="black" points="291982.3,-341.86 291978.8,-331.86 291975.3,-341.86 291982.3,-341.86"/>
</g>
<!-- l2_ffn_down_6&#45;&gt;l2_ffn_res_6 -->
<g id="edge909" class="edge">
<title>l2_ffn_down_6&#45;&gt;l2_ffn_res_6</title>
<path fill="none" stroke="black" d="M292111.2,-393.76C292111.2,-393.76 292111.2,-337.32 292111.2,-337.32"/>
<polygon fill="black" stroke="black" points="292114.7,-337.32 292111.2,-327.32 292107.7,-337.32 292114.7,-337.32"/>
</g>
<!-- l2_ffn_down_6&#45;&gt;l2_ffn_res_6 -->
<g id="edge1029" class="edge">
<title>l2_ffn_down_6&#45;&gt;l2_ffn_res_6</title>
<path fill="none" stroke="black" d="M292243.6,-393.76C292243.6,-393.76 292243.6,-333.35 292243.6,-333.35"/>
<polygon fill="black" stroke="black" points="292247.1,-333.35 292243.6,-323.35 292240.1,-333.35 292247.1,-333.35"/>
</g>
<!-- l2_ffn_res_6&#45;&gt;l2_ffn_ln_6 -->
<g id="edge743" class="edge">
<title>l2_ffn_res_6&#45;&gt;l2_ffn_ln_6</title>
<path fill="none" stroke="black" d="M291793.14,-301.46C291793.14,-301.46 291793.14,-271.1 291793.14,-271.1"/>
<polygon fill="black" stroke="black" points="291796.64,-271.1 291793.14,-261.1 291789.64,-271.1 291796.64,-271.1"/>
</g>
<!-- l2_ffn_res_6&#45;&gt;l2_ffn_ln_6 -->
<g id="edge815" class="edge">
<title>l2_ffn_res_6&#45;&gt;l2_ffn_ln_6</title>
<path fill="none" stroke="black" d="M291850.68,-299.73C291850.68,-299.73 291850.68,-271.05 291850.68,-271.05"/>
<polygon fill="black" stroke="black" points="291854.18,-271.05 291850.68,-261.05 291847.18,-271.05 291854.18,-271.05"/>
</g>
<!-- l2_ffn_res_6&#45;&gt;l2_ffn_ln_6 -->
<g id="edge911" class="edge">
<title>l2_ffn_res_6&#45;&gt;l2_ffn_ln_6</title>
<path fill="none" stroke="black" d="M291908.23,-297.94C291908.23,-297.94 291908.23,-271.2 291908.23,-271.2"/>
<polygon fill="black" stroke="black" points="291911.73,-271.2 291908.23,-261.2 291904.73,-271.2 291911.73,-271.2"/>
</g>
<!-- l2_ffn_res_6&#45;&gt;l2_ffn_ln_6 -->
<g id="edge1031" class="edge">
<title>l2_ffn_res_6&#45;&gt;l2_ffn_ln_6</title>
<path fill="none" stroke="black" d="M291965.77,-297.94C291965.77,-297.94 291965.77,-271.2 291965.77,-271.2"/>
<polygon fill="black" stroke="black" points="291969.27,-271.2 291965.77,-261.2 291962.27,-271.2 291969.27,-271.2"/>
</g>
<!-- l2_ffn_ln_6&#45;&gt;l2_ffn_up_6 -->
<g id="edge739" class="edge">
<title>l2_ffn_ln_6&#45;&gt;l2_ffn_up_6</title>
<path fill="none" stroke="black" d="M292253.62,-249C292380.25,-249 292496.65,-249 292496.65,-249 292496.65,-249 292496.65,-503.87 292496.65,-503.87"/>
<polygon fill="black" stroke="black" points="292493.15,-503.87 292496.65,-513.87 292500.15,-503.87 292493.15,-503.87"/>
</g>
<!-- l2_ffn_ln_6&#45;&gt;l2_ffn_up_6 -->
<g id="edge811" class="edge">
<title>l2_ffn_ln_6&#45;&gt;l2_ffn_up_6</title>
<path fill="none" stroke="black" d="M292253.51,-243C292383,-243 292503,-243 292503,-243 292503,-243 292503,-503.92 292503,-503.92"/>
<polygon fill="black" stroke="black" points="292499.5,-503.92 292503,-513.92 292506.5,-503.92 292499.5,-503.92"/>
</g>
<!-- l2_ffn_ln_6&#45;&gt;l2_ffn_up_6 -->
<g id="edge907" class="edge">
<title>l2_ffn_ln_6&#45;&gt;l2_ffn_up_6</title>
<path fill="none" stroke="black" d="M292253.73,-237C292385.94,-237 292509.35,-237 292509.35,-237 292509.35,-237 292509.35,-503.99 292509.35,-503.99"/>
<polygon fill="black" stroke="black" points="292505.85,-503.99 292509.35,-513.99 292512.85,-503.99 292505.85,-503.99"/>
</g>
<!-- l2_ffn_ln_6&#45;&gt;l2_ffn_up_6 -->
<g id="edge1027" class="edge">
<title>l2_ffn_ln_6&#45;&gt;l2_ffn_up_6</title>
<path fill="none" stroke="black" d="M292253.86,-231C292388.81,-231 292515.7,-231 292515.7,-231 292515.7,-231 292515.7,-503.62 292515.7,-503.62"/>
<polygon fill="black" stroke="black" points="292512.2,-503.62 292515.7,-513.62 292519.2,-503.62 292512.2,-503.62"/>
</g>
<!-- l2_ffn_ln_6&#45;&gt;l2_ffn_res_6 -->
<g id="edge742" class="edge">
<title>l2_ffn_ln_6&#45;&gt;l2_ffn_res_6</title>
<path fill="none" stroke="black" d="M292023.32,-261.17C292023.32,-261.17 292023.32,-289.52 292023.32,-289.52"/>
<polygon fill="black" stroke="black" points="292019.82,-289.52 292023.32,-299.52 292026.82,-289.52 292019.82,-289.52"/>
</g>
<!-- l2_ffn_ln_6&#45;&gt;l2_ffn_res_6 -->
<g id="edge814" class="edge">
<title>l2_ffn_ln_6&#45;&gt;l2_ffn_res_6</title>
<path fill="none" stroke="black" d="M292080.86,-261.17C292080.86,-261.17 292080.86,-291.38 292080.86,-291.38"/>
<polygon fill="black" stroke="black" points="292077.36,-291.38 292080.86,-301.38 292084.36,-291.38 292077.36,-291.38"/>
</g>
<!-- l2_ffn_ln_6&#45;&gt;l2_ffn_res_6 -->
<g id="edge910" class="edge">
<title>l2_ffn_ln_6&#45;&gt;l2_ffn_res_6</title>
<path fill="none" stroke="black" d="M292138.41,-261.17C292138.41,-261.17 292138.41,-293.59 292138.41,-293.59"/>
<polygon fill="black" stroke="black" points="292134.91,-293.59 292138.41,-303.59 292141.91,-293.59 292134.91,-293.59"/>
</g>
<!-- l2_ffn_ln_6&#45;&gt;l2_ffn_res_6 -->
<g id="edge1030" class="edge">
<title>l2_ffn_ln_6&#45;&gt;l2_ffn_res_6</title>
<path fill="none" stroke="black" d="M292195.95,-261.17C292195.95,-261.17 292195.95,-295.25 292195.95,-295.25"/>
<polygon fill="black" stroke="black" points="292192.45,-295.25 292195.95,-305.25 292199.45,-295.25 292192.45,-295.25"/>
</g>
<!-- l2_ffn_up_7 -->
<g id="node560" class="node">
<title>l2_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="293785,-550 293135,-550 293135,-514 293785,-514 293785,-550"/>
<text text-anchor="middle" x="293460" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ffn_down_7 -->
<g id="node561" class="node">
<title>l2_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="293508,-430 292846,-430 292846,-394 293508,-394 293508,-430"/>
<text text-anchor="middle" x="293177" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_7&#45;&gt;l2_ffn_down_7 -->
<g id="edge746" class="edge">
<title>l2_ffn_up_7&#45;&gt;l2_ffn_down_7</title>
<path fill="none" stroke="black" d="M293209.6,-513.77C293209.6,-513.77 293209.6,-440 293209.6,-440"/>
<polygon fill="black" stroke="black" points="293213.1,-440 293209.6,-430 293206.1,-440 293213.1,-440"/>
</g>
<!-- l2_ffn_up_7&#45;&gt;l2_ffn_down_7 -->
<g id="edge818" class="edge">
<title>l2_ffn_up_7&#45;&gt;l2_ffn_down_7</title>
<path fill="none" stroke="black" d="M293284.2,-513.77C293284.2,-513.77 293284.2,-440 293284.2,-440"/>
<polygon fill="black" stroke="black" points="293287.7,-440 293284.2,-430 293280.7,-440 293287.7,-440"/>
</g>
<!-- l2_ffn_up_7&#45;&gt;l2_ffn_down_7 -->
<g id="edge914" class="edge">
<title>l2_ffn_up_7&#45;&gt;l2_ffn_down_7</title>
<path fill="none" stroke="black" d="M293358.8,-513.77C293358.8,-513.77 293358.8,-440 293358.8,-440"/>
<polygon fill="black" stroke="black" points="293362.3,-440 293358.8,-430 293355.3,-440 293362.3,-440"/>
</g>
<!-- l2_ffn_up_7&#45;&gt;l2_ffn_down_7 -->
<g id="edge1034" class="edge">
<title>l2_ffn_up_7&#45;&gt;l2_ffn_down_7</title>
<path fill="none" stroke="black" d="M293433.4,-513.77C293433.4,-513.77 293433.4,-440 293433.4,-440"/>
<polygon fill="black" stroke="black" points="293436.9,-440 293433.4,-430 293429.9,-440 293436.9,-440"/>
</g>
<!-- l2_ffn_res_7 -->
<g id="node562" class="node">
<title>l2_ffn_res_7</title>
<polygon fill="lightgray" stroke="black" points="293069,-333 292522.1,-315 293069,-297 293615.9,-315 293069,-333"/>
<text text-anchor="middle" x="293069" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_down_7&#45;&gt;l2_ffn_res_7 -->
<g id="edge747" class="edge">
<title>l2_ffn_down_7&#45;&gt;l2_ffn_res_7</title>
<path fill="none" stroke="black" d="M292978.4,-393.76C292978.4,-393.76 292978.4,-340.29 292978.4,-340.29"/>
<polygon fill="black" stroke="black" points="292981.9,-340.29 292978.4,-330.29 292974.9,-340.29 292981.9,-340.29"/>
</g>
<!-- l2_ffn_down_7&#45;&gt;l2_ffn_res_7 -->
<g id="edge819" class="edge">
<title>l2_ffn_down_7&#45;&gt;l2_ffn_res_7</title>
<path fill="none" stroke="black" d="M293110.8,-393.76C293110.8,-393.76 293110.8,-341.86 293110.8,-341.86"/>
<polygon fill="black" stroke="black" points="293114.3,-341.86 293110.8,-331.86 293107.3,-341.86 293114.3,-341.86"/>
</g>
<!-- l2_ffn_down_7&#45;&gt;l2_ffn_res_7 -->
<g id="edge915" class="edge">
<title>l2_ffn_down_7&#45;&gt;l2_ffn_res_7</title>
<path fill="none" stroke="black" d="M293243.2,-393.76C293243.2,-393.76 293243.2,-337.32 293243.2,-337.32"/>
<polygon fill="black" stroke="black" points="293246.7,-337.32 293243.2,-327.32 293239.7,-337.32 293246.7,-337.32"/>
</g>
<!-- l2_ffn_down_7&#45;&gt;l2_ffn_res_7 -->
<g id="edge1035" class="edge">
<title>l2_ffn_down_7&#45;&gt;l2_ffn_res_7</title>
<path fill="none" stroke="black" d="M293375.6,-393.76C293375.6,-393.76 293375.6,-333.35 293375.6,-333.35"/>
<polygon fill="black" stroke="black" points="293379.1,-333.35 293375.6,-323.35 293372.1,-333.35 293379.1,-333.35"/>
</g>
<!-- l2_ffn_res_7&#45;&gt;l2_ffn_ln_7 -->
<g id="edge749" class="edge">
<title>l2_ffn_res_7&#45;&gt;l2_ffn_ln_7</title>
<path fill="none" stroke="black" d="M292925.14,-301.46C292925.14,-301.46 292925.14,-271.1 292925.14,-271.1"/>
<polygon fill="black" stroke="black" points="292928.64,-271.1 292925.14,-261.1 292921.64,-271.1 292928.64,-271.1"/>
</g>
<!-- l2_ffn_res_7&#45;&gt;l2_ffn_ln_7 -->
<g id="edge821" class="edge">
<title>l2_ffn_res_7&#45;&gt;l2_ffn_ln_7</title>
<path fill="none" stroke="black" d="M292982.68,-299.73C292982.68,-299.73 292982.68,-271.05 292982.68,-271.05"/>
<polygon fill="black" stroke="black" points="292986.18,-271.05 292982.68,-261.05 292979.18,-271.05 292986.18,-271.05"/>
</g>
<!-- l2_ffn_res_7&#45;&gt;l2_ffn_ln_7 -->
<g id="edge917" class="edge">
<title>l2_ffn_res_7&#45;&gt;l2_ffn_ln_7</title>
<path fill="none" stroke="black" d="M293040.23,-297.94C293040.23,-297.94 293040.23,-271.2 293040.23,-271.2"/>
<polygon fill="black" stroke="black" points="293043.73,-271.2 293040.23,-261.2 293036.73,-271.2 293043.73,-271.2"/>
</g>
<!-- l2_ffn_res_7&#45;&gt;l2_ffn_ln_7 -->
<g id="edge1037" class="edge">
<title>l2_ffn_res_7&#45;&gt;l2_ffn_ln_7</title>
<path fill="none" stroke="black" d="M293097.77,-297.94C293097.77,-297.94 293097.77,-271.2 293097.77,-271.2"/>
<polygon fill="black" stroke="black" points="293101.27,-271.2 293097.77,-261.2 293094.27,-271.2 293101.27,-271.2"/>
</g>
<!-- l2_ffn_ln_7&#45;&gt;l2_ffn_up_7 -->
<g id="edge745" class="edge">
<title>l2_ffn_ln_7&#45;&gt;l2_ffn_up_7</title>
<path fill="none" stroke="black" d="M293385.62,-249C293512.25,-249 293628.65,-249 293628.65,-249 293628.65,-249 293628.65,-503.87 293628.65,-503.87"/>
<polygon fill="black" stroke="black" points="293625.15,-503.87 293628.65,-513.87 293632.15,-503.87 293625.15,-503.87"/>
</g>
<!-- l2_ffn_ln_7&#45;&gt;l2_ffn_up_7 -->
<g id="edge817" class="edge">
<title>l2_ffn_ln_7&#45;&gt;l2_ffn_up_7</title>
<path fill="none" stroke="black" d="M293385.51,-243C293515,-243 293635,-243 293635,-243 293635,-243 293635,-503.92 293635,-503.92"/>
<polygon fill="black" stroke="black" points="293631.5,-503.92 293635,-513.92 293638.5,-503.92 293631.5,-503.92"/>
</g>
<!-- l2_ffn_ln_7&#45;&gt;l2_ffn_up_7 -->
<g id="edge913" class="edge">
<title>l2_ffn_ln_7&#45;&gt;l2_ffn_up_7</title>
<path fill="none" stroke="black" d="M293385.73,-237C293517.94,-237 293641.35,-237 293641.35,-237 293641.35,-237 293641.35,-503.99 293641.35,-503.99"/>
<polygon fill="black" stroke="black" points="293637.85,-503.99 293641.35,-513.99 293644.85,-503.99 293637.85,-503.99"/>
</g>
<!-- l2_ffn_ln_7&#45;&gt;l2_ffn_up_7 -->
<g id="edge1033" class="edge">
<title>l2_ffn_ln_7&#45;&gt;l2_ffn_up_7</title>
<path fill="none" stroke="black" d="M293385.86,-231C293520.81,-231 293647.7,-231 293647.7,-231 293647.7,-231 293647.7,-503.62 293647.7,-503.62"/>
<polygon fill="black" stroke="black" points="293644.2,-503.62 293647.7,-513.62 293651.2,-503.62 293644.2,-503.62"/>
</g>
<!-- l2_ffn_ln_7&#45;&gt;l2_ffn_res_7 -->
<g id="edge748" class="edge">
<title>l2_ffn_ln_7&#45;&gt;l2_ffn_res_7</title>
<path fill="none" stroke="black" d="M293155.32,-261.17C293155.32,-261.17 293155.32,-289.52 293155.32,-289.52"/>
<polygon fill="black" stroke="black" points="293151.82,-289.52 293155.32,-299.52 293158.82,-289.52 293151.82,-289.52"/>
</g>
<!-- l2_ffn_ln_7&#45;&gt;l2_ffn_res_7 -->
<g id="edge820" class="edge">
<title>l2_ffn_ln_7&#45;&gt;l2_ffn_res_7</title>
<path fill="none" stroke="black" d="M293212.86,-261.17C293212.86,-261.17 293212.86,-291.38 293212.86,-291.38"/>
<polygon fill="black" stroke="black" points="293209.36,-291.38 293212.86,-301.38 293216.36,-291.38 293209.36,-291.38"/>
</g>
<!-- l2_ffn_ln_7&#45;&gt;l2_ffn_res_7 -->
<g id="edge916" class="edge">
<title>l2_ffn_ln_7&#45;&gt;l2_ffn_res_7</title>
<path fill="none" stroke="black" d="M293270.41,-261.17C293270.41,-261.17 293270.41,-293.59 293270.41,-293.59"/>
<polygon fill="black" stroke="black" points="293266.91,-293.59 293270.41,-303.59 293273.91,-293.59 293266.91,-293.59"/>
</g>
<!-- l2_ffn_ln_7&#45;&gt;l2_ffn_res_7 -->
<g id="edge1036" class="edge">
<title>l2_ffn_ln_7&#45;&gt;l2_ffn_res_7</title>
<path fill="none" stroke="black" d="M293327.95,-261.17C293327.95,-261.17 293327.95,-295.25 293327.95,-295.25"/>
<polygon fill="black" stroke="black" points="293324.45,-295.25 293327.95,-305.25 293331.45,-295.25 293324.45,-295.25"/>
</g>
<!-- l3_ffn_up_0 -->
<g id="node564" class="node">
<title>l3_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="302789,-550 302139,-550 302139,-514 302789,-514 302789,-550"/>
<text text-anchor="middle" x="302464" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ffn_down_0 -->
<g id="node565" class="node">
<title>l3_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="302570,-430 301908,-430 301908,-394 302570,-394 302570,-430"/>
<text text-anchor="middle" x="302239" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_0&#45;&gt;l3_ffn_down_0 -->
<g id="edge1041" class="edge">
<title>l3_ffn_up_0&#45;&gt;l3_ffn_down_0</title>
<path fill="none" stroke="black" d="M302225.2,-513.77C302225.2,-513.77 302225.2,-440 302225.2,-440"/>
<polygon fill="black" stroke="black" points="302228.7,-440 302225.2,-430 302221.7,-440 302228.7,-440"/>
</g>
<!-- l3_ffn_up_0&#45;&gt;l3_ffn_down_0 -->
<g id="edge1113" class="edge">
<title>l3_ffn_up_0&#45;&gt;l3_ffn_down_0</title>
<path fill="none" stroke="black" d="M302311.4,-513.77C302311.4,-513.77 302311.4,-440 302311.4,-440"/>
<polygon fill="black" stroke="black" points="302314.9,-440 302311.4,-430 302307.9,-440 302314.9,-440"/>
</g>
<!-- l3_ffn_up_0&#45;&gt;l3_ffn_down_0 -->
<g id="edge1209" class="edge">
<title>l3_ffn_up_0&#45;&gt;l3_ffn_down_0</title>
<path fill="none" stroke="black" d="M302397.6,-513.77C302397.6,-513.77 302397.6,-440 302397.6,-440"/>
<polygon fill="black" stroke="black" points="302401.1,-440 302397.6,-430 302394.1,-440 302401.1,-440"/>
</g>
<!-- l3_ffn_up_0&#45;&gt;l3_ffn_down_0 -->
<g id="edge1329" class="edge">
<title>l3_ffn_up_0&#45;&gt;l3_ffn_down_0</title>
<path fill="none" stroke="black" d="M302483.8,-513.77C302483.8,-513.77 302483.8,-440 302483.8,-440"/>
<polygon fill="black" stroke="black" points="302487.3,-440 302483.8,-430 302480.3,-440 302487.3,-440"/>
</g>
<!-- l3_ffn_res_0 -->
<g id="node566" class="node">
<title>l3_ffn_res_0</title>
<polygon fill="lightgray" stroke="black" points="302131,-333 301584.1,-315 302131,-297 302677.9,-315 302131,-333"/>
<text text-anchor="middle" x="302131" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_down_0&#45;&gt;l3_ffn_res_0 -->
<g id="edge1042" class="edge">
<title>l3_ffn_down_0&#45;&gt;l3_ffn_res_0</title>
<path fill="none" stroke="black" d="M302040.4,-393.76C302040.4,-393.76 302040.4,-340.29 302040.4,-340.29"/>
<polygon fill="black" stroke="black" points="302043.9,-340.29 302040.4,-330.29 302036.9,-340.29 302043.9,-340.29"/>
</g>
<!-- l3_ffn_down_0&#45;&gt;l3_ffn_res_0 -->
<g id="edge1114" class="edge">
<title>l3_ffn_down_0&#45;&gt;l3_ffn_res_0</title>
<path fill="none" stroke="black" d="M302172.8,-393.76C302172.8,-393.76 302172.8,-341.86 302172.8,-341.86"/>
<polygon fill="black" stroke="black" points="302176.3,-341.86 302172.8,-331.86 302169.3,-341.86 302176.3,-341.86"/>
</g>
<!-- l3_ffn_down_0&#45;&gt;l3_ffn_res_0 -->
<g id="edge1210" class="edge">
<title>l3_ffn_down_0&#45;&gt;l3_ffn_res_0</title>
<path fill="none" stroke="black" d="M302305.2,-393.76C302305.2,-393.76 302305.2,-337.32 302305.2,-337.32"/>
<polygon fill="black" stroke="black" points="302308.7,-337.32 302305.2,-327.32 302301.7,-337.32 302308.7,-337.32"/>
</g>
<!-- l3_ffn_down_0&#45;&gt;l3_ffn_res_0 -->
<g id="edge1330" class="edge">
<title>l3_ffn_down_0&#45;&gt;l3_ffn_res_0</title>
<path fill="none" stroke="black" d="M302437.6,-393.76C302437.6,-393.76 302437.6,-333.35 302437.6,-333.35"/>
<polygon fill="black" stroke="black" points="302441.1,-333.35 302437.6,-323.35 302434.1,-333.35 302441.1,-333.35"/>
</g>
<!-- l3_ffn_res_0&#45;&gt;l3_ffn_ln_0 -->
<g id="edge1044" class="edge">
<title>l3_ffn_res_0&#45;&gt;l3_ffn_ln_0</title>
<path fill="none" stroke="black" d="M301987.14,-301.46C301987.14,-301.46 301987.14,-271.1 301987.14,-271.1"/>
<polygon fill="black" stroke="black" points="301990.64,-271.1 301987.14,-261.1 301983.64,-271.1 301990.64,-271.1"/>
</g>
<!-- l3_ffn_res_0&#45;&gt;l3_ffn_ln_0 -->
<g id="edge1116" class="edge">
<title>l3_ffn_res_0&#45;&gt;l3_ffn_ln_0</title>
<path fill="none" stroke="black" d="M302044.68,-299.73C302044.68,-299.73 302044.68,-271.05 302044.68,-271.05"/>
<polygon fill="black" stroke="black" points="302048.18,-271.05 302044.68,-261.05 302041.18,-271.05 302048.18,-271.05"/>
</g>
<!-- l3_ffn_res_0&#45;&gt;l3_ffn_ln_0 -->
<g id="edge1212" class="edge">
<title>l3_ffn_res_0&#45;&gt;l3_ffn_ln_0</title>
<path fill="none" stroke="black" d="M302102.23,-297.94C302102.23,-297.94 302102.23,-271.2 302102.23,-271.2"/>
<polygon fill="black" stroke="black" points="302105.73,-271.2 302102.23,-261.2 302098.73,-271.2 302105.73,-271.2"/>
</g>
<!-- l3_ffn_res_0&#45;&gt;l3_ffn_ln_0 -->
<g id="edge1332" class="edge">
<title>l3_ffn_res_0&#45;&gt;l3_ffn_ln_0</title>
<path fill="none" stroke="black" d="M302159.77,-297.94C302159.77,-297.94 302159.77,-271.2 302159.77,-271.2"/>
<polygon fill="black" stroke="black" points="302163.27,-271.2 302159.77,-261.2 302156.27,-271.2 302163.27,-271.2"/>
</g>
<!-- l3_ffn_ln_0&#45;&gt;l3_ffn_up_0 -->
<g id="edge1040" class="edge">
<title>l3_ffn_ln_0&#45;&gt;l3_ffn_up_0</title>
<path fill="none" stroke="black" d="M302447.63,-257C302570.47,-257 302682.18,-257 302682.18,-257 302682.18,-257 302682.18,-503.96 302682.18,-503.96"/>
<polygon fill="black" stroke="black" points="302678.68,-503.96 302682.18,-513.96 302685.68,-503.96 302678.68,-503.96"/>
</g>
<!-- l3_ffn_ln_0&#45;&gt;l3_ffn_up_0 -->
<g id="edge1112" class="edge">
<title>l3_ffn_ln_0&#45;&gt;l3_ffn_up_0</title>
<path fill="none" stroke="black" d="M302447.65,-253C302572.38,-253 302686.42,-253 302686.42,-253 302686.42,-253 302686.42,-503.69 302686.42,-503.69"/>
<polygon fill="black" stroke="black" points="302682.92,-503.69 302686.42,-513.69 302689.92,-503.69 302682.92,-503.69"/>
</g>
<!-- l3_ffn_ln_0&#45;&gt;l3_ffn_up_0 -->
<g id="edge1208" class="edge">
<title>l3_ffn_ln_0&#45;&gt;l3_ffn_up_0</title>
<path fill="none" stroke="black" d="M302447.62,-249C302574.25,-249 302690.65,-249 302690.65,-249 302690.65,-249 302690.65,-503.87 302690.65,-503.87"/>
<polygon fill="black" stroke="black" points="302687.15,-503.87 302690.65,-513.87 302694.15,-503.87 302687.15,-503.87"/>
</g>
<!-- l3_ffn_ln_0&#45;&gt;l3_ffn_up_0 -->
<g id="edge1328" class="edge">
<title>l3_ffn_ln_0&#45;&gt;l3_ffn_up_0</title>
<path fill="none" stroke="black" d="M302447.56,-245C302576.09,-245 302694.88,-245 302694.88,-245 302694.88,-245 302694.88,-503.61 302694.88,-503.61"/>
<polygon fill="black" stroke="black" points="302691.38,-503.61 302694.88,-513.61 302698.38,-503.61 302691.38,-503.61"/>
</g>
<!-- l3_ffn_ln_0&#45;&gt;l3_ffn_res_0 -->
<g id="edge1043" class="edge">
<title>l3_ffn_ln_0&#45;&gt;l3_ffn_res_0</title>
<path fill="none" stroke="black" d="M302217.32,-261.17C302217.32,-261.17 302217.32,-289.52 302217.32,-289.52"/>
<polygon fill="black" stroke="black" points="302213.82,-289.52 302217.32,-299.52 302220.82,-289.52 302213.82,-289.52"/>
</g>
<!-- l3_ffn_ln_0&#45;&gt;l3_ffn_res_0 -->
<g id="edge1115" class="edge">
<title>l3_ffn_ln_0&#45;&gt;l3_ffn_res_0</title>
<path fill="none" stroke="black" d="M302274.86,-261.17C302274.86,-261.17 302274.86,-291.38 302274.86,-291.38"/>
<polygon fill="black" stroke="black" points="302271.36,-291.38 302274.86,-301.38 302278.36,-291.38 302271.36,-291.38"/>
</g>
<!-- l3_ffn_ln_0&#45;&gt;l3_ffn_res_0 -->
<g id="edge1211" class="edge">
<title>l3_ffn_ln_0&#45;&gt;l3_ffn_res_0</title>
<path fill="none" stroke="black" d="M302332.41,-261.17C302332.41,-261.17 302332.41,-293.59 302332.41,-293.59"/>
<polygon fill="black" stroke="black" points="302328.91,-293.59 302332.41,-303.59 302335.91,-293.59 302328.91,-293.59"/>
</g>
<!-- l3_ffn_ln_0&#45;&gt;l3_ffn_res_0 -->
<g id="edge1331" class="edge">
<title>l3_ffn_ln_0&#45;&gt;l3_ffn_res_0</title>
<path fill="none" stroke="black" d="M302389.95,-261.17C302389.95,-261.17 302389.95,-295.25 302389.95,-295.25"/>
<polygon fill="black" stroke="black" points="302386.45,-295.25 302389.95,-305.25 302393.45,-295.25 302386.45,-295.25"/>
</g>
<!-- final_output_0 -->
<g id="node613" class="node">
<title>final_output_0</title>
<polygon fill="lightgreen" stroke="black" points="302940.5,-180 302319.5,-180 302319.5,-144 302940.5,-144 302940.5,-180"/>
<text text-anchor="middle" x="302630" y="-159.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ffn_ln_0&#45;&gt;final_output_0 -->
<g id="edge1379" class="edge">
<title>l3_ffn_ln_0&#45;&gt;final_output_0</title>
<path fill="none" stroke="black" d="M302383.5,-224.62C302383.5,-224.62 302383.5,-190.03 302383.5,-190.03"/>
<polygon fill="black" stroke="black" points="302387,-190.03 302383.5,-180.03 302380,-190.03 302387,-190.03"/>
</g>
<!-- l3_ffn_up_1 -->
<g id="node568" class="node">
<title>l3_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="307691,-550 307041,-550 307041,-514 307691,-514 307691,-550"/>
<text text-anchor="middle" x="307366" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ffn_down_1 -->
<g id="node569" class="node">
<title>l3_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="308034,-430 307372,-430 307372,-394 308034,-394 308034,-430"/>
<text text-anchor="middle" x="307703" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_1&#45;&gt;l3_ffn_down_1 -->
<g id="edge1047" class="edge">
<title>l3_ffn_up_1&#45;&gt;l3_ffn_down_1</title>
<path fill="none" stroke="black" d="M307435.8,-513.77C307435.8,-513.77 307435.8,-440 307435.8,-440"/>
<polygon fill="black" stroke="black" points="307439.3,-440 307435.8,-430 307432.3,-440 307439.3,-440"/>
</g>
<!-- l3_ffn_up_1&#45;&gt;l3_ffn_down_1 -->
<g id="edge1119" class="edge">
<title>l3_ffn_up_1&#45;&gt;l3_ffn_down_1</title>
<path fill="none" stroke="black" d="M307499.6,-513.77C307499.6,-513.77 307499.6,-440 307499.6,-440"/>
<polygon fill="black" stroke="black" points="307503.1,-440 307499.6,-430 307496.1,-440 307503.1,-440"/>
</g>
<!-- l3_ffn_up_1&#45;&gt;l3_ffn_down_1 -->
<g id="edge1215" class="edge">
<title>l3_ffn_up_1&#45;&gt;l3_ffn_down_1</title>
<path fill="none" stroke="black" d="M307563.4,-513.77C307563.4,-513.77 307563.4,-440 307563.4,-440"/>
<polygon fill="black" stroke="black" points="307566.9,-440 307563.4,-430 307559.9,-440 307566.9,-440"/>
</g>
<!-- l3_ffn_up_1&#45;&gt;l3_ffn_down_1 -->
<g id="edge1335" class="edge">
<title>l3_ffn_up_1&#45;&gt;l3_ffn_down_1</title>
<path fill="none" stroke="black" d="M307627.2,-513.77C307627.2,-513.77 307627.2,-440 307627.2,-440"/>
<polygon fill="black" stroke="black" points="307630.7,-440 307627.2,-430 307623.7,-440 307630.7,-440"/>
</g>
<!-- l3_ffn_res_1 -->
<g id="node570" class="node">
<title>l3_ffn_res_1</title>
<polygon fill="lightgray" stroke="black" points="307811,-333 307264.1,-315 307811,-297 308357.9,-315 307811,-333"/>
<text text-anchor="middle" x="307811" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_down_1&#45;&gt;l3_ffn_res_1 -->
<g id="edge1048" class="edge">
<title>l3_ffn_down_1&#45;&gt;l3_ffn_res_1</title>
<path fill="none" stroke="black" d="M307504.4,-393.76C307504.4,-393.76 307504.4,-333.35 307504.4,-333.35"/>
<polygon fill="black" stroke="black" points="307507.9,-333.35 307504.4,-323.35 307500.9,-333.35 307507.9,-333.35"/>
</g>
<!-- l3_ffn_down_1&#45;&gt;l3_ffn_res_1 -->
<g id="edge1120" class="edge">
<title>l3_ffn_down_1&#45;&gt;l3_ffn_res_1</title>
<path fill="none" stroke="black" d="M307636.8,-393.76C307636.8,-393.76 307636.8,-337.32 307636.8,-337.32"/>
<polygon fill="black" stroke="black" points="307640.3,-337.32 307636.8,-327.32 307633.3,-337.32 307640.3,-337.32"/>
</g>
<!-- l3_ffn_down_1&#45;&gt;l3_ffn_res_1 -->
<g id="edge1216" class="edge">
<title>l3_ffn_down_1&#45;&gt;l3_ffn_res_1</title>
<path fill="none" stroke="black" d="M307769.2,-393.76C307769.2,-393.76 307769.2,-341.86 307769.2,-341.86"/>
<polygon fill="black" stroke="black" points="307772.7,-341.86 307769.2,-331.86 307765.7,-341.86 307772.7,-341.86"/>
</g>
<!-- l3_ffn_down_1&#45;&gt;l3_ffn_res_1 -->
<g id="edge1336" class="edge">
<title>l3_ffn_down_1&#45;&gt;l3_ffn_res_1</title>
<path fill="none" stroke="black" d="M307901.6,-393.76C307901.6,-393.76 307901.6,-340.29 307901.6,-340.29"/>
<polygon fill="black" stroke="black" points="307905.1,-340.29 307901.6,-330.29 307898.1,-340.29 307905.1,-340.29"/>
</g>
<!-- l3_ffn_res_1&#45;&gt;l3_ffn_ln_1 -->
<g id="edge1050" class="edge">
<title>l3_ffn_res_1&#45;&gt;l3_ffn_ln_1</title>
<path fill="none" stroke="black" d="M307297.1,-313.75C307297.1,-313.75 307297.1,-271.13 307297.1,-271.13"/>
<polygon fill="black" stroke="black" points="307300.6,-271.13 307297.1,-261.13 307293.6,-271.13 307300.6,-271.13"/>
</g>
<!-- l3_ffn_res_1&#45;&gt;l3_ffn_ln_1 -->
<g id="edge1122" class="edge">
<title>l3_ffn_res_1&#45;&gt;l3_ffn_ln_1</title>
<path fill="none" stroke="black" d="M307330.15,-312.6C307330.15,-312.6 307330.15,-271.06 307330.15,-271.06"/>
<polygon fill="black" stroke="black" points="307333.65,-271.06 307330.15,-261.06 307326.65,-271.06 307333.65,-271.06"/>
</g>
<!-- l3_ffn_res_1&#45;&gt;l3_ffn_ln_1 -->
<g id="edge1218" class="edge">
<title>l3_ffn_res_1&#45;&gt;l3_ffn_ln_1</title>
<path fill="none" stroke="black" d="M307363.2,-311.53C307363.2,-311.53 307363.2,-271.21 307363.2,-271.21"/>
<polygon fill="black" stroke="black" points="307366.7,-271.21 307363.2,-261.21 307359.7,-271.21 307366.7,-271.21"/>
</g>
<!-- l3_ffn_res_1&#45;&gt;l3_ffn_ln_1 -->
<g id="edge1338" class="edge">
<title>l3_ffn_res_1&#45;&gt;l3_ffn_ln_1</title>
<path fill="none" stroke="black" d="M307396.25,-310.28C307396.25,-310.28 307396.25,-271.31 307396.25,-271.31"/>
<polygon fill="black" stroke="black" points="307399.75,-271.31 307396.25,-261.31 307392.75,-271.31 307399.75,-271.31"/>
</g>
<!-- l3_ffn_ln_1&#45;&gt;l3_ffn_up_1 -->
<g id="edge1046" class="edge">
<title>l3_ffn_ln_1&#45;&gt;l3_ffn_up_1</title>
<path fill="none" stroke="black" d="M307245,-261.08C307245,-261.08 307245,-503.93 307245,-503.93"/>
<polygon fill="black" stroke="black" points="307241.5,-503.93 307245,-513.93 307248.5,-503.93 307241.5,-503.93"/>
</g>
<!-- l3_ffn_ln_1&#45;&gt;l3_ffn_up_1 -->
<g id="edge1118" class="edge">
<title>l3_ffn_ln_1&#45;&gt;l3_ffn_up_1</title>
<path fill="none" stroke="black" d="M307249.76,-261.08C307249.76,-261.08 307249.76,-503.93 307249.76,-503.93"/>
<polygon fill="black" stroke="black" points="307246.26,-503.93 307249.76,-513.93 307253.26,-503.93 307246.26,-503.93"/>
</g>
<!-- l3_ffn_ln_1&#45;&gt;l3_ffn_up_1 -->
<g id="edge1214" class="edge">
<title>l3_ffn_ln_1&#45;&gt;l3_ffn_up_1</title>
<path fill="none" stroke="black" d="M307254.53,-261.08C307254.53,-261.08 307254.53,-503.93 307254.53,-503.93"/>
<polygon fill="black" stroke="black" points="307251.03,-503.93 307254.53,-513.93 307258.03,-503.93 307251.03,-503.93"/>
</g>
<!-- l3_ffn_ln_1&#45;&gt;l3_ffn_up_1 -->
<g id="edge1334" class="edge">
<title>l3_ffn_ln_1&#45;&gt;l3_ffn_up_1</title>
<path fill="none" stroke="black" d="M307259.29,-261.08C307259.29,-261.08 307259.29,-503.93 307259.29,-503.93"/>
<polygon fill="black" stroke="black" points="307255.79,-503.93 307259.29,-513.93 307262.79,-503.93 307255.79,-503.93"/>
</g>
<!-- l3_ffn_ln_1&#45;&gt;l3_ffn_res_1 -->
<g id="edge1049" class="edge">
<title>l3_ffn_ln_1&#45;&gt;l3_ffn_res_1</title>
<path fill="none" stroke="black" d="M307429.3,-261.17C307429.3,-261.17 307429.3,-299.27 307429.3,-299.27"/>
<polygon fill="black" stroke="black" points="307425.8,-299.27 307429.3,-309.27 307432.8,-299.27 307425.8,-299.27"/>
</g>
<!-- l3_ffn_ln_1&#45;&gt;l3_ffn_res_1 -->
<g id="edge1121" class="edge">
<title>l3_ffn_ln_1&#45;&gt;l3_ffn_res_1</title>
<path fill="none" stroke="black" d="M307462.35,-261.17C307462.35,-261.17 307462.35,-298.26 307462.35,-298.26"/>
<polygon fill="black" stroke="black" points="307458.85,-298.26 307462.35,-308.26 307465.85,-298.26 307458.85,-298.26"/>
</g>
<!-- l3_ffn_ln_1&#45;&gt;l3_ffn_res_1 -->
<g id="edge1217" class="edge">
<title>l3_ffn_ln_1&#45;&gt;l3_ffn_res_1</title>
<path fill="none" stroke="black" d="M307495.4,-261.17C307495.4,-261.17 307495.4,-297.18 307495.4,-297.18"/>
<polygon fill="black" stroke="black" points="307491.9,-297.18 307495.4,-307.18 307498.9,-297.18 307491.9,-297.18"/>
</g>
<!-- l3_ffn_ln_1&#45;&gt;l3_ffn_res_1 -->
<g id="edge1337" class="edge">
<title>l3_ffn_ln_1&#45;&gt;l3_ffn_res_1</title>
<path fill="none" stroke="black" d="M307528.45,-261.17C307528.45,-261.17 307528.45,-296.04 307528.45,-296.04"/>
<polygon fill="black" stroke="black" points="307524.95,-296.04 307528.45,-306.04 307531.95,-296.04 307524.95,-296.04"/>
</g>
<!-- final_output_1 -->
<g id="node614" class="node">
<title>final_output_1</title>
<polygon fill="lightgreen" stroke="black" points="306135.5,-180 305514.5,-180 305514.5,-144 306135.5,-144 306135.5,-180"/>
<text text-anchor="middle" x="305825" y="-159.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ffn_ln_1&#45;&gt;final_output_1 -->
<g id="edge1382" class="edge">
<title>l3_ffn_ln_1&#45;&gt;final_output_1</title>
<path fill="none" stroke="black" d="M307245,-224.62C307245,-200.72 307245,-162 307245,-162 307245,-162 306145.75,-162 306145.75,-162"/>
<polygon fill="black" stroke="black" points="306145.75,-158.5 306135.75,-162 306145.75,-165.5 306145.75,-158.5"/>
</g>
<!-- l3_ffn_up_2 -->
<g id="node572" class="node">
<title>l3_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="306832,-550 306182,-550 306182,-514 306832,-514 306832,-550"/>
<text text-anchor="middle" x="306507" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ffn_down_2 -->
<g id="node573" class="node">
<title>l3_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="306959,-430 306297,-430 306297,-394 306959,-394 306959,-430"/>
<text text-anchor="middle" x="306628" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_2&#45;&gt;l3_ffn_down_2 -->
<g id="edge1053" class="edge">
<title>l3_ffn_up_2&#45;&gt;l3_ffn_down_2</title>
<path fill="none" stroke="black" d="M306404,-513.77C306404,-513.77 306404,-440 306404,-440"/>
<polygon fill="black" stroke="black" points="306407.5,-440 306404,-430 306400.5,-440 306407.5,-440"/>
</g>
<!-- l3_ffn_up_2&#45;&gt;l3_ffn_down_2 -->
<g id="edge1125" class="edge">
<title>l3_ffn_up_2&#45;&gt;l3_ffn_down_2</title>
<path fill="none" stroke="black" d="M306511,-513.77C306511,-513.77 306511,-440 306511,-440"/>
<polygon fill="black" stroke="black" points="306514.5,-440 306511,-430 306507.5,-440 306514.5,-440"/>
</g>
<!-- l3_ffn_up_2&#45;&gt;l3_ffn_down_2 -->
<g id="edge1221" class="edge">
<title>l3_ffn_up_2&#45;&gt;l3_ffn_down_2</title>
<path fill="none" stroke="black" d="M306618,-513.77C306618,-513.77 306618,-440 306618,-440"/>
<polygon fill="black" stroke="black" points="306621.5,-440 306618,-430 306614.5,-440 306621.5,-440"/>
</g>
<!-- l3_ffn_up_2&#45;&gt;l3_ffn_down_2 -->
<g id="edge1341" class="edge">
<title>l3_ffn_up_2&#45;&gt;l3_ffn_down_2</title>
<path fill="none" stroke="black" d="M306725,-513.77C306725,-513.77 306725,-440 306725,-440"/>
<polygon fill="black" stroke="black" points="306728.5,-440 306725,-430 306721.5,-440 306728.5,-440"/>
</g>
<!-- l3_ffn_res_2 -->
<g id="node574" class="node">
<title>l3_ffn_res_2</title>
<polygon fill="lightgray" stroke="black" points="306679,-333 306132.1,-315 306679,-297 307225.9,-315 306679,-333"/>
<text text-anchor="middle" x="306679" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_down_2&#45;&gt;l3_ffn_res_2 -->
<g id="edge1054" class="edge">
<title>l3_ffn_down_2&#45;&gt;l3_ffn_res_2</title>
<path fill="none" stroke="black" d="M306429.4,-393.76C306429.4,-393.76 306429.4,-334.87 306429.4,-334.87"/>
<polygon fill="black" stroke="black" points="306432.9,-334.87 306429.4,-324.87 306425.9,-334.87 306432.9,-334.87"/>
</g>
<!-- l3_ffn_down_2&#45;&gt;l3_ffn_res_2 -->
<g id="edge1126" class="edge">
<title>l3_ffn_down_2&#45;&gt;l3_ffn_res_2</title>
<path fill="none" stroke="black" d="M306561.8,-393.76C306561.8,-393.76 306561.8,-339.37 306561.8,-339.37"/>
<polygon fill="black" stroke="black" points="306565.3,-339.37 306561.8,-329.37 306558.3,-339.37 306565.3,-339.37"/>
</g>
<!-- l3_ffn_down_2&#45;&gt;l3_ffn_res_2 -->
<g id="edge1222" class="edge">
<title>l3_ffn_down_2&#45;&gt;l3_ffn_res_2</title>
<path fill="none" stroke="black" d="M306694.2,-393.76C306694.2,-393.76 306694.2,-342.51 306694.2,-342.51"/>
<polygon fill="black" stroke="black" points="306697.7,-342.51 306694.2,-332.51 306690.7,-342.51 306697.7,-342.51"/>
</g>
<!-- l3_ffn_down_2&#45;&gt;l3_ffn_res_2 -->
<g id="edge1342" class="edge">
<title>l3_ffn_down_2&#45;&gt;l3_ffn_res_2</title>
<path fill="none" stroke="black" d="M306826.6,-393.76C306826.6,-393.76 306826.6,-338.19 306826.6,-338.19"/>
<polygon fill="black" stroke="black" points="306830.1,-338.19 306826.6,-328.19 306823.1,-338.19 306830.1,-338.19"/>
</g>
<!-- l3_ffn_res_2&#45;&gt;l3_ffn_ln_2 -->
<g id="edge1056" class="edge">
<title>l3_ffn_res_2&#45;&gt;l3_ffn_ln_2</title>
<path fill="none" stroke="black" d="M306172.32,-313.5C306172.32,-313.5 306172.32,-271.2 306172.32,-271.2"/>
<polygon fill="black" stroke="black" points="306175.82,-271.2 306172.32,-261.2 306168.82,-271.2 306175.82,-271.2"/>
</g>
<!-- l3_ffn_res_2&#45;&gt;l3_ffn_ln_2 -->
<g id="edge1128" class="edge">
<title>l3_ffn_res_2&#45;&gt;l3_ffn_ln_2</title>
<path fill="none" stroke="black" d="M306212.59,-312.27C306212.59,-312.27 306212.59,-271.12 306212.59,-271.12"/>
<polygon fill="black" stroke="black" points="306216.1,-271.12 306212.59,-261.12 306209.1,-271.12 306216.1,-271.12"/>
</g>
<!-- l3_ffn_res_2&#45;&gt;l3_ffn_ln_2 -->
<g id="edge1224" class="edge">
<title>l3_ffn_res_2&#45;&gt;l3_ffn_ln_2</title>
<path fill="none" stroke="black" d="M306252.87,-310.71C306252.87,-310.71 306252.87,-271.28 306252.87,-271.28"/>
<polygon fill="black" stroke="black" points="306256.37,-271.28 306252.87,-261.28 306249.37,-271.28 306256.37,-271.28"/>
</g>
<!-- l3_ffn_res_2&#45;&gt;l3_ffn_ln_2 -->
<g id="edge1344" class="edge">
<title>l3_ffn_res_2&#45;&gt;l3_ffn_ln_2</title>
<path fill="none" stroke="black" d="M306293.14,-309.35C306293.14,-309.35 306293.14,-271.04 306293.14,-271.04"/>
<polygon fill="black" stroke="black" points="306296.64,-271.04 306293.14,-261.04 306289.64,-271.04 306296.64,-271.04"/>
</g>
<!-- l3_ffn_ln_2&#45;&gt;l3_ffn_up_2 -->
<g id="edge1052" class="edge">
<title>l3_ffn_ln_2&#45;&gt;l3_ffn_up_2</title>
<path fill="none" stroke="black" d="M306098.85,-261.25C306098.85,-326.17 306098.85,-542 306098.85,-542 306098.85,-542 306171.94,-542 306171.94,-542"/>
<polygon fill="black" stroke="black" points="306171.94,-545.5 306181.94,-542 306171.94,-538.5 306171.94,-545.5"/>
</g>
<!-- l3_ffn_ln_2&#45;&gt;l3_ffn_up_2 -->
<g id="edge1124" class="edge">
<title>l3_ffn_ln_2&#45;&gt;l3_ffn_up_2</title>
<path fill="none" stroke="black" d="M306107.15,-261.27C306107.15,-325.19 306107.15,-535 306107.15,-535 306107.15,-535 306171.89,-535 306171.89,-535"/>
<polygon fill="black" stroke="black" points="306171.89,-538.5 306181.89,-535 306171.89,-531.5 306171.89,-538.5"/>
</g>
<!-- l3_ffn_ln_2&#45;&gt;l3_ffn_up_2 -->
<g id="edge1220" class="edge">
<title>l3_ffn_ln_2&#45;&gt;l3_ffn_up_2</title>
<path fill="none" stroke="black" d="M306115.45,-261.26C306115.45,-324.16 306115.45,-528 306115.45,-528 306115.45,-528 306171.87,-528 306171.87,-528"/>
<polygon fill="black" stroke="black" points="306171.87,-531.5 306181.87,-528 306171.87,-524.5 306171.87,-531.5"/>
</g>
<!-- l3_ffn_ln_2&#45;&gt;l3_ffn_up_2 -->
<g id="edge1340" class="edge">
<title>l3_ffn_ln_2&#45;&gt;l3_ffn_up_2</title>
<path fill="none" stroke="black" d="M306123.75,-261.24C306123.75,-323.09 306123.75,-521 306123.75,-521 306123.75,-521 306171.96,-521 306171.96,-521"/>
<polygon fill="black" stroke="black" points="306171.96,-524.5 306181.96,-521 306171.96,-517.5 306171.96,-524.5"/>
</g>
<!-- l3_ffn_ln_2&#45;&gt;l3_ffn_res_2 -->
<g id="edge1055" class="edge">
<title>l3_ffn_ln_2&#45;&gt;l3_ffn_res_2</title>
<path fill="none" stroke="black" d="M306333.41,-261.17C306333.41,-261.17 306333.41,-298.26 306333.41,-298.26"/>
<polygon fill="black" stroke="black" points="306329.91,-298.26 306333.41,-308.26 306336.91,-298.26 306329.91,-298.26"/>
</g>
<!-- l3_ffn_ln_2&#45;&gt;l3_ffn_res_2 -->
<g id="edge1127" class="edge">
<title>l3_ffn_ln_2&#45;&gt;l3_ffn_res_2</title>
<path fill="none" stroke="black" d="M306373.68,-261.17C306373.68,-261.17 306373.68,-296.81 306373.68,-296.81"/>
<polygon fill="black" stroke="black" points="306370.18,-296.81 306373.68,-306.81 306377.18,-296.81 306370.18,-296.81"/>
</g>
<!-- l3_ffn_ln_2&#45;&gt;l3_ffn_res_2 -->
<g id="edge1223" class="edge">
<title>l3_ffn_ln_2&#45;&gt;l3_ffn_res_2</title>
<path fill="none" stroke="black" d="M306413.96,-261.17C306413.96,-261.17 306413.96,-295.65 306413.96,-295.65"/>
<polygon fill="black" stroke="black" points="306410.46,-295.65 306413.96,-305.65 306417.46,-295.65 306410.46,-295.65"/>
</g>
<!-- l3_ffn_ln_2&#45;&gt;l3_ffn_res_2 -->
<g id="edge1343" class="edge">
<title>l3_ffn_ln_2&#45;&gt;l3_ffn_res_2</title>
<path fill="none" stroke="black" d="M306454.23,-261.17C306454.23,-261.17 306454.23,-294.02 306454.23,-294.02"/>
<polygon fill="black" stroke="black" points="306450.73,-294.02 306454.23,-304.02 306457.73,-294.02 306450.73,-294.02"/>
</g>
<!-- final_output_2 -->
<g id="node615" class="node">
<title>final_output_2</title>
<polygon fill="lightgreen" stroke="black" points="305496.5,-180 304875.5,-180 304875.5,-144 305496.5,-144 305496.5,-180"/>
<text text-anchor="middle" x="305186" y="-159.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ffn_ln_2&#45;&gt;final_output_2 -->
<g id="edge1385" class="edge">
<title>l3_ffn_ln_2&#45;&gt;final_output_2</title>
<path fill="none" stroke="black" d="M306044.17,-224.73C306044.17,-206.44 306044.17,-181 306044.17,-181 306044.17,-181 305448.83,-181 305448.83,-181 305448.83,-181 305448.83,-180.92 305448.83,-180.92"/>
<polygon fill="black" stroke="black" points="305452.33,-190.18 305448.83,-180.18 305445.33,-190.18 305452.33,-190.18"/>
</g>
<!-- l3_ffn_up_3 -->
<g id="node576" class="node">
<title>l3_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="301048,-550 300398,-550 300398,-514 301048,-514 301048,-550"/>
<text text-anchor="middle" x="300723" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ffn_down_3 -->
<g id="node577" class="node">
<title>l3_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="301242,-430 300580,-430 300580,-394 301242,-394 301242,-430"/>
<text text-anchor="middle" x="300911" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_3&#45;&gt;l3_ffn_down_3 -->
<g id="edge1059" class="edge">
<title>l3_ffn_up_3&#45;&gt;l3_ffn_down_3</title>
<path fill="none" stroke="black" d="M300673.6,-513.77C300673.6,-513.77 300673.6,-440 300673.6,-440"/>
<polygon fill="black" stroke="black" points="300677.1,-440 300673.6,-430 300670.1,-440 300677.1,-440"/>
</g>
<!-- l3_ffn_up_3&#45;&gt;l3_ffn_down_3 -->
<g id="edge1131" class="edge">
<title>l3_ffn_up_3&#45;&gt;l3_ffn_down_3</title>
<path fill="none" stroke="black" d="M300767.2,-513.77C300767.2,-513.77 300767.2,-440 300767.2,-440"/>
<polygon fill="black" stroke="black" points="300770.7,-440 300767.2,-430 300763.7,-440 300770.7,-440"/>
</g>
<!-- l3_ffn_up_3&#45;&gt;l3_ffn_down_3 -->
<g id="edge1227" class="edge">
<title>l3_ffn_up_3&#45;&gt;l3_ffn_down_3</title>
<path fill="none" stroke="black" d="M300860.8,-513.77C300860.8,-513.77 300860.8,-440 300860.8,-440"/>
<polygon fill="black" stroke="black" points="300864.3,-440 300860.8,-430 300857.3,-440 300864.3,-440"/>
</g>
<!-- l3_ffn_up_3&#45;&gt;l3_ffn_down_3 -->
<g id="edge1347" class="edge">
<title>l3_ffn_up_3&#45;&gt;l3_ffn_down_3</title>
<path fill="none" stroke="black" d="M300954.4,-513.77C300954.4,-513.77 300954.4,-440 300954.4,-440"/>
<polygon fill="black" stroke="black" points="300957.9,-440 300954.4,-430 300950.9,-440 300957.9,-440"/>
</g>
<!-- l3_ffn_res_3 -->
<g id="node578" class="node">
<title>l3_ffn_res_3</title>
<polygon fill="lightgray" stroke="black" points="301019,-333 300472.1,-315 301019,-297 301565.9,-315 301019,-333"/>
<text text-anchor="middle" x="301019" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_down_3&#45;&gt;l3_ffn_res_3 -->
<g id="edge1060" class="edge">
<title>l3_ffn_down_3&#45;&gt;l3_ffn_res_3</title>
<path fill="none" stroke="black" d="M300712.4,-393.76C300712.4,-393.76 300712.4,-333.35 300712.4,-333.35"/>
<polygon fill="black" stroke="black" points="300715.9,-333.35 300712.4,-323.35 300708.9,-333.35 300715.9,-333.35"/>
</g>
<!-- l3_ffn_down_3&#45;&gt;l3_ffn_res_3 -->
<g id="edge1132" class="edge">
<title>l3_ffn_down_3&#45;&gt;l3_ffn_res_3</title>
<path fill="none" stroke="black" d="M300844.8,-393.76C300844.8,-393.76 300844.8,-337.32 300844.8,-337.32"/>
<polygon fill="black" stroke="black" points="300848.3,-337.32 300844.8,-327.32 300841.3,-337.32 300848.3,-337.32"/>
</g>
<!-- l3_ffn_down_3&#45;&gt;l3_ffn_res_3 -->
<g id="edge1228" class="edge">
<title>l3_ffn_down_3&#45;&gt;l3_ffn_res_3</title>
<path fill="none" stroke="black" d="M300977.2,-393.76C300977.2,-393.76 300977.2,-341.86 300977.2,-341.86"/>
<polygon fill="black" stroke="black" points="300980.7,-341.86 300977.2,-331.86 300973.7,-341.86 300980.7,-341.86"/>
</g>
<!-- l3_ffn_down_3&#45;&gt;l3_ffn_res_3 -->
<g id="edge1348" class="edge">
<title>l3_ffn_down_3&#45;&gt;l3_ffn_res_3</title>
<path fill="none" stroke="black" d="M301109.6,-393.76C301109.6,-393.76 301109.6,-340.29 301109.6,-340.29"/>
<polygon fill="black" stroke="black" points="301113.1,-340.29 301109.6,-330.29 301106.1,-340.29 301113.1,-340.29"/>
</g>
<!-- l3_ffn_res_3&#45;&gt;l3_ffn_ln_3 -->
<g id="edge1062" class="edge">
<title>l3_ffn_res_3&#45;&gt;l3_ffn_ln_3</title>
<path fill="none" stroke="black" d="M300772.83,-304.99C300772.83,-304.99 300772.83,-271.25 300772.83,-271.25"/>
<polygon fill="black" stroke="black" points="300776.33,-271.25 300772.83,-261.25 300769.33,-271.25 300776.33,-271.25"/>
</g>
<!-- l3_ffn_res_3&#45;&gt;l3_ffn_ln_3 -->
<g id="edge1134" class="edge">
<title>l3_ffn_res_3&#45;&gt;l3_ffn_ln_3</title>
<path fill="none" stroke="black" d="M300843.17,-302.79C300843.17,-302.79 300843.17,-271.23 300843.17,-271.23"/>
<polygon fill="black" stroke="black" points="300846.67,-271.23 300843.17,-261.23 300839.67,-271.23 300846.67,-271.23"/>
</g>
<!-- l3_ffn_res_3&#45;&gt;l3_ffn_ln_3 -->
<g id="edge1230" class="edge">
<title>l3_ffn_res_3&#45;&gt;l3_ffn_ln_3</title>
<path fill="none" stroke="black" d="M300913.5,-300.43C300913.5,-300.43 300913.5,-271.13 300913.5,-271.13"/>
<polygon fill="black" stroke="black" points="300917,-271.13 300913.5,-261.13 300910,-271.13 300917,-271.13"/>
</g>
<!-- l3_ffn_res_3&#45;&gt;l3_ffn_ln_3 -->
<g id="edge1350" class="edge">
<title>l3_ffn_res_3&#45;&gt;l3_ffn_ln_3</title>
<path fill="none" stroke="black" d="M300983.83,-297.94C300983.83,-297.94 300983.83,-271.2 300983.83,-271.2"/>
<polygon fill="black" stroke="black" points="300987.33,-271.2 300983.83,-261.2 300980.33,-271.2 300987.33,-271.2"/>
</g>
<!-- l3_ffn_ln_3&#45;&gt;l3_ffn_up_3 -->
<g id="edge1058" class="edge">
<title>l3_ffn_ln_3&#45;&gt;l3_ffn_up_3</title>
<path fill="none" stroke="black" d="M300702.47,-255C300577.15,-255 300462.37,-255 300462.37,-255 300462.37,-255 300462.37,-503.83 300462.37,-503.83"/>
<polygon fill="black" stroke="black" points="300458.87,-503.83 300462.37,-513.83 300465.87,-503.83 300458.87,-503.83"/>
</g>
<!-- l3_ffn_ln_3&#45;&gt;l3_ffn_up_3 -->
<g id="edge1130" class="edge">
<title>l3_ffn_ln_3&#45;&gt;l3_ffn_up_3</title>
<path fill="none" stroke="black" d="M300702.31,-249C300572.75,-249 300452.68,-249 300452.68,-249 300452.68,-249 300452.68,-503.87 300452.68,-503.87"/>
<polygon fill="black" stroke="black" points="300449.18,-503.87 300452.68,-513.87 300456.18,-503.87 300449.18,-503.87"/>
</g>
<!-- l3_ffn_ln_3&#45;&gt;l3_ffn_up_3 -->
<g id="edge1226" class="edge">
<title>l3_ffn_ln_3&#45;&gt;l3_ffn_up_3</title>
<path fill="none" stroke="black" d="M300702.35,-243C300568.51,-243 300443,-243 300443,-243 300443,-243 300443,-503.92 300443,-503.92"/>
<polygon fill="black" stroke="black" points="300439.5,-503.92 300443,-513.92 300446.5,-503.92 300439.5,-503.92"/>
</g>
<!-- l3_ffn_ln_3&#45;&gt;l3_ffn_up_3 -->
<g id="edge1346" class="edge">
<title>l3_ffn_ln_3&#45;&gt;l3_ffn_up_3</title>
<path fill="none" stroke="black" d="M300702.16,-237C300564.16,-237 300433.32,-237 300433.32,-237 300433.32,-237 300433.32,-503.99 300433.32,-503.99"/>
<polygon fill="black" stroke="black" points="300429.82,-503.99 300433.32,-513.99 300436.82,-503.99 300429.82,-503.99"/>
</g>
<!-- l3_ffn_ln_3&#45;&gt;l3_ffn_res_3 -->
<g id="edge1061" class="edge">
<title>l3_ffn_ln_3&#45;&gt;l3_ffn_res_3</title>
<path fill="none" stroke="black" d="M301054.17,-261.17C301054.17,-261.17 301054.17,-288.07 301054.17,-288.07"/>
<polygon fill="black" stroke="black" points="301050.67,-288.07 301054.17,-298.07 301057.67,-288.07 301050.67,-288.07"/>
</g>
<!-- l3_ffn_ln_3&#45;&gt;l3_ffn_res_3 -->
<g id="edge1133" class="edge">
<title>l3_ffn_ln_3&#45;&gt;l3_ffn_res_3</title>
<path fill="none" stroke="black" d="M301124.5,-261.17C301124.5,-261.17 301124.5,-290.46 301124.5,-290.46"/>
<polygon fill="black" stroke="black" points="301121,-290.46 301124.5,-300.46 301128,-290.46 301121,-290.46"/>
</g>
<!-- l3_ffn_ln_3&#45;&gt;l3_ffn_res_3 -->
<g id="edge1229" class="edge">
<title>l3_ffn_ln_3&#45;&gt;l3_ffn_res_3</title>
<path fill="none" stroke="black" d="M301194.83,-261.17C301194.83,-261.17 301194.83,-292.72 301194.83,-292.72"/>
<polygon fill="black" stroke="black" points="301191.33,-292.72 301194.83,-302.72 301198.33,-292.73 301191.33,-292.72"/>
</g>
<!-- l3_ffn_ln_3&#45;&gt;l3_ffn_res_3 -->
<g id="edge1349" class="edge">
<title>l3_ffn_ln_3&#45;&gt;l3_ffn_res_3</title>
<path fill="none" stroke="black" d="M301265.17,-261.17C301265.17,-261.17 301265.17,-294.85 301265.17,-294.85"/>
<polygon fill="black" stroke="black" points="301261.67,-294.85 301265.17,-304.85 301268.67,-294.85 301261.67,-294.85"/>
</g>
<!-- final_output_3 -->
<g id="node616" class="node">
<title>final_output_3</title>
<polygon fill="lightgreen" stroke="black" points="302301.5,-180 301680.5,-180 301680.5,-144 302301.5,-144 302301.5,-180"/>
<text text-anchor="middle" x="301991" y="-159.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ffn_ln_3&#45;&gt;final_output_3 -->
<g id="edge1388" class="edge">
<title>l3_ffn_ln_3&#45;&gt;final_output_3</title>
<path fill="none" stroke="black" d="M301335.62,-237C301532.15,-237 301747.5,-237 301747.5,-237 301747.5,-237 301747.5,-190.16 301747.5,-190.16"/>
<polygon fill="black" stroke="black" points="301751,-190.16 301747.5,-180.16 301744,-190.16 301751,-190.16"/>
</g>
<!-- l3_ffn_up_4 -->
<g id="node580" class="node">
<title>l3_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="304444,-550 303794,-550 303794,-514 304444,-514 304444,-550"/>
<text text-anchor="middle" x="304119" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ffn_down_4 -->
<g id="node581" class="node">
<title>l3_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="304638,-430 303976,-430 303976,-394 304638,-394 304638,-430"/>
<text text-anchor="middle" x="304307" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_4&#45;&gt;l3_ffn_down_4 -->
<g id="edge1065" class="edge">
<title>l3_ffn_up_4&#45;&gt;l3_ffn_down_4</title>
<path fill="none" stroke="black" d="M304069.6,-513.77C304069.6,-513.77 304069.6,-440 304069.6,-440"/>
<polygon fill="black" stroke="black" points="304073.1,-440 304069.6,-430 304066.1,-440 304073.1,-440"/>
</g>
<!-- l3_ffn_up_4&#45;&gt;l3_ffn_down_4 -->
<g id="edge1137" class="edge">
<title>l3_ffn_up_4&#45;&gt;l3_ffn_down_4</title>
<path fill="none" stroke="black" d="M304163.2,-513.77C304163.2,-513.77 304163.2,-440 304163.2,-440"/>
<polygon fill="black" stroke="black" points="304166.7,-440 304163.2,-430 304159.7,-440 304166.7,-440"/>
</g>
<!-- l3_ffn_up_4&#45;&gt;l3_ffn_down_4 -->
<g id="edge1233" class="edge">
<title>l3_ffn_up_4&#45;&gt;l3_ffn_down_4</title>
<path fill="none" stroke="black" d="M304256.8,-513.77C304256.8,-513.77 304256.8,-440 304256.8,-440"/>
<polygon fill="black" stroke="black" points="304260.3,-440 304256.8,-430 304253.3,-440 304260.3,-440"/>
</g>
<!-- l3_ffn_up_4&#45;&gt;l3_ffn_down_4 -->
<g id="edge1353" class="edge">
<title>l3_ffn_up_4&#45;&gt;l3_ffn_down_4</title>
<path fill="none" stroke="black" d="M304350.4,-513.77C304350.4,-513.77 304350.4,-440 304350.4,-440"/>
<polygon fill="black" stroke="black" points="304353.9,-440 304350.4,-430 304346.9,-440 304353.9,-440"/>
</g>
<!-- l3_ffn_res_4 -->
<g id="node582" class="node">
<title>l3_ffn_res_4</title>
<polygon fill="lightgray" stroke="black" points="304415,-333 303868.1,-315 304415,-297 304961.9,-315 304415,-333"/>
<text text-anchor="middle" x="304415" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_down_4&#45;&gt;l3_ffn_res_4 -->
<g id="edge1066" class="edge">
<title>l3_ffn_down_4&#45;&gt;l3_ffn_res_4</title>
<path fill="none" stroke="black" d="M304108.4,-393.76C304108.4,-393.76 304108.4,-333.35 304108.4,-333.35"/>
<polygon fill="black" stroke="black" points="304111.9,-333.35 304108.4,-323.35 304104.9,-333.35 304111.9,-333.35"/>
</g>
<!-- l3_ffn_down_4&#45;&gt;l3_ffn_res_4 -->
<g id="edge1138" class="edge">
<title>l3_ffn_down_4&#45;&gt;l3_ffn_res_4</title>
<path fill="none" stroke="black" d="M304240.8,-393.76C304240.8,-393.76 304240.8,-337.32 304240.8,-337.32"/>
<polygon fill="black" stroke="black" points="304244.3,-337.32 304240.8,-327.32 304237.3,-337.32 304244.3,-337.32"/>
</g>
<!-- l3_ffn_down_4&#45;&gt;l3_ffn_res_4 -->
<g id="edge1234" class="edge">
<title>l3_ffn_down_4&#45;&gt;l3_ffn_res_4</title>
<path fill="none" stroke="black" d="M304373.2,-393.76C304373.2,-393.76 304373.2,-341.86 304373.2,-341.86"/>
<polygon fill="black" stroke="black" points="304376.7,-341.86 304373.2,-331.86 304369.7,-341.86 304376.7,-341.86"/>
</g>
<!-- l3_ffn_down_4&#45;&gt;l3_ffn_res_4 -->
<g id="edge1354" class="edge">
<title>l3_ffn_down_4&#45;&gt;l3_ffn_res_4</title>
<path fill="none" stroke="black" d="M304505.6,-393.76C304505.6,-393.76 304505.6,-340.29 304505.6,-340.29"/>
<polygon fill="black" stroke="black" points="304509.1,-340.29 304505.6,-330.29 304502.1,-340.29 304509.1,-340.29"/>
</g>
<!-- l3_ffn_res_4&#45;&gt;l3_ffn_ln_4 -->
<g id="edge1068" class="edge">
<title>l3_ffn_res_4&#45;&gt;l3_ffn_ln_4</title>
<path fill="none" stroke="black" d="M303908.32,-313.5C303908.32,-313.5 303908.32,-271.2 303908.32,-271.2"/>
<polygon fill="black" stroke="black" points="303911.82,-271.2 303908.32,-261.2 303904.82,-271.2 303911.82,-271.2"/>
</g>
<!-- l3_ffn_res_4&#45;&gt;l3_ffn_ln_4 -->
<g id="edge1140" class="edge">
<title>l3_ffn_res_4&#45;&gt;l3_ffn_ln_4</title>
<path fill="none" stroke="black" d="M303948.59,-312.27C303948.59,-312.27 303948.59,-271.12 303948.59,-271.12"/>
<polygon fill="black" stroke="black" points="303952.1,-271.12 303948.59,-261.12 303945.1,-271.12 303952.1,-271.12"/>
</g>
<!-- l3_ffn_res_4&#45;&gt;l3_ffn_ln_4 -->
<g id="edge1236" class="edge">
<title>l3_ffn_res_4&#45;&gt;l3_ffn_ln_4</title>
<path fill="none" stroke="black" d="M303988.87,-310.71C303988.87,-310.71 303988.87,-271.28 303988.87,-271.28"/>
<polygon fill="black" stroke="black" points="303992.37,-271.28 303988.87,-261.28 303985.37,-271.28 303992.37,-271.28"/>
</g>
<!-- l3_ffn_res_4&#45;&gt;l3_ffn_ln_4 -->
<g id="edge1356" class="edge">
<title>l3_ffn_res_4&#45;&gt;l3_ffn_ln_4</title>
<path fill="none" stroke="black" d="M304029.14,-309.35C304029.14,-309.35 304029.14,-271.04 304029.14,-271.04"/>
<polygon fill="black" stroke="black" points="304032.64,-271.04 304029.14,-261.04 304025.64,-271.04 304032.64,-271.04"/>
</g>
<!-- l3_ffn_ln_4&#45;&gt;l3_ffn_up_4 -->
<g id="edge1064" class="edge">
<title>l3_ffn_ln_4&#45;&gt;l3_ffn_up_4</title>
<path fill="none" stroke="black" d="M303834.85,-261.08C303834.85,-261.08 303834.85,-503.93 303834.85,-503.93"/>
<polygon fill="black" stroke="black" points="303831.35,-503.93 303834.85,-513.93 303838.35,-503.93 303831.35,-503.93"/>
</g>
<!-- l3_ffn_ln_4&#45;&gt;l3_ffn_up_4 -->
<g id="edge1136" class="edge">
<title>l3_ffn_ln_4&#45;&gt;l3_ffn_up_4</title>
<path fill="none" stroke="black" d="M303843.15,-261.08C303843.15,-261.08 303843.15,-503.93 303843.15,-503.93"/>
<polygon fill="black" stroke="black" points="303839.65,-503.93 303843.15,-513.93 303846.65,-503.93 303839.65,-503.93"/>
</g>
<!-- l3_ffn_ln_4&#45;&gt;l3_ffn_up_4 -->
<g id="edge1232" class="edge">
<title>l3_ffn_ln_4&#45;&gt;l3_ffn_up_4</title>
<path fill="none" stroke="black" d="M303851.45,-261.08C303851.45,-261.08 303851.45,-503.93 303851.45,-503.93"/>
<polygon fill="black" stroke="black" points="303847.95,-503.93 303851.45,-513.93 303854.95,-503.93 303847.95,-503.93"/>
</g>
<!-- l3_ffn_ln_4&#45;&gt;l3_ffn_up_4 -->
<g id="edge1352" class="edge">
<title>l3_ffn_ln_4&#45;&gt;l3_ffn_up_4</title>
<path fill="none" stroke="black" d="M303859.75,-261.08C303859.75,-261.08 303859.75,-503.93 303859.75,-503.93"/>
<polygon fill="black" stroke="black" points="303856.25,-503.93 303859.75,-513.93 303863.25,-503.93 303856.25,-503.93"/>
</g>
<!-- l3_ffn_ln_4&#45;&gt;l3_ffn_res_4 -->
<g id="edge1067" class="edge">
<title>l3_ffn_ln_4&#45;&gt;l3_ffn_res_4</title>
<path fill="none" stroke="black" d="M304069.41,-261.17C304069.41,-261.17 304069.41,-298.26 304069.41,-298.26"/>
<polygon fill="black" stroke="black" points="304065.91,-298.26 304069.41,-308.26 304072.91,-298.26 304065.91,-298.26"/>
</g>
<!-- l3_ffn_ln_4&#45;&gt;l3_ffn_res_4 -->
<g id="edge1139" class="edge">
<title>l3_ffn_ln_4&#45;&gt;l3_ffn_res_4</title>
<path fill="none" stroke="black" d="M304109.68,-261.17C304109.68,-261.17 304109.68,-296.81 304109.68,-296.81"/>
<polygon fill="black" stroke="black" points="304106.18,-296.81 304109.68,-306.81 304113.18,-296.81 304106.18,-296.81"/>
</g>
<!-- l3_ffn_ln_4&#45;&gt;l3_ffn_res_4 -->
<g id="edge1235" class="edge">
<title>l3_ffn_ln_4&#45;&gt;l3_ffn_res_4</title>
<path fill="none" stroke="black" d="M304149.96,-261.17C304149.96,-261.17 304149.96,-295.65 304149.96,-295.65"/>
<polygon fill="black" stroke="black" points="304146.46,-295.65 304149.96,-305.65 304153.46,-295.65 304146.46,-295.65"/>
</g>
<!-- l3_ffn_ln_4&#45;&gt;l3_ffn_res_4 -->
<g id="edge1355" class="edge">
<title>l3_ffn_ln_4&#45;&gt;l3_ffn_res_4</title>
<path fill="none" stroke="black" d="M304190.23,-261.17C304190.23,-261.17 304190.23,-294.02 304190.23,-294.02"/>
<polygon fill="black" stroke="black" points="304186.73,-294.02 304190.23,-304.02 304193.73,-294.02 304186.73,-294.02"/>
</g>
<!-- final_output_4 -->
<g id="node617" class="node">
<title>final_output_4</title>
<polygon fill="lightgreen" stroke="black" points="304218.5,-180 303597.5,-180 303597.5,-144 304218.5,-144 304218.5,-180"/>
<text text-anchor="middle" x="303908" y="-159.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ffn_ln_4&#45;&gt;final_output_4 -->
<g id="edge1391" class="edge">
<title>l3_ffn_ln_4&#45;&gt;final_output_4</title>
<path fill="none" stroke="black" d="M304011.5,-224.62C304011.5,-224.62 304011.5,-190.03 304011.5,-190.03"/>
<polygon fill="black" stroke="black" points="304015,-190.03 304011.5,-180.03 304008,-190.03 304015,-190.03"/>
</g>
<!-- l3_ffn_up_5 -->
<g id="node584" class="node">
<title>l3_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="300333,-550 299683,-550 299683,-514 300333,-514 300333,-550"/>
<text text-anchor="middle" x="300008" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ffn_down_5 -->
<g id="node585" class="node">
<title>l3_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="300292,-430 299630,-430 299630,-394 300292,-394 300292,-430"/>
<text text-anchor="middle" x="299961" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_5&#45;&gt;l3_ffn_down_5 -->
<g id="edge1071" class="edge">
<title>l3_ffn_up_5&#45;&gt;l3_ffn_down_5</title>
<path fill="none" stroke="black" d="M299804.8,-513.77C299804.8,-513.77 299804.8,-440 299804.8,-440"/>
<polygon fill="black" stroke="black" points="299808.3,-440 299804.8,-430 299801.3,-440 299808.3,-440"/>
</g>
<!-- l3_ffn_up_5&#45;&gt;l3_ffn_down_5 -->
<g id="edge1143" class="edge">
<title>l3_ffn_up_5&#45;&gt;l3_ffn_down_5</title>
<path fill="none" stroke="black" d="M299926.6,-513.77C299926.6,-513.77 299926.6,-440 299926.6,-440"/>
<polygon fill="black" stroke="black" points="299930.1,-440 299926.6,-430 299923.1,-440 299930.1,-440"/>
</g>
<!-- l3_ffn_up_5&#45;&gt;l3_ffn_down_5 -->
<g id="edge1239" class="edge">
<title>l3_ffn_up_5&#45;&gt;l3_ffn_down_5</title>
<path fill="none" stroke="black" d="M300048.4,-513.77C300048.4,-513.77 300048.4,-440 300048.4,-440"/>
<polygon fill="black" stroke="black" points="300051.9,-440 300048.4,-430 300044.9,-440 300051.9,-440"/>
</g>
<!-- l3_ffn_up_5&#45;&gt;l3_ffn_down_5 -->
<g id="edge1359" class="edge">
<title>l3_ffn_up_5&#45;&gt;l3_ffn_down_5</title>
<path fill="none" stroke="black" d="M300170.2,-513.77C300170.2,-513.77 300170.2,-440 300170.2,-440"/>
<polygon fill="black" stroke="black" points="300173.7,-440 300170.2,-430 300166.7,-440 300173.7,-440"/>
</g>
<!-- l3_ffn_res_5 -->
<g id="node586" class="node">
<title>l3_ffn_res_5</title>
<polygon fill="lightgray" stroke="black" points="299867,-333 299320.1,-315 299867,-297 300413.9,-315 299867,-333"/>
<text text-anchor="middle" x="299867" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_down_5&#45;&gt;l3_ffn_res_5 -->
<g id="edge1072" class="edge">
<title>l3_ffn_down_5&#45;&gt;l3_ffn_res_5</title>
<path fill="none" stroke="black" d="M299762.4,-393.76C299762.4,-393.76 299762.4,-339.68 299762.4,-339.68"/>
<polygon fill="black" stroke="black" points="299765.9,-339.68 299762.4,-329.68 299758.9,-339.68 299765.9,-339.68"/>
</g>
<!-- l3_ffn_down_5&#45;&gt;l3_ffn_res_5 -->
<g id="edge1144" class="edge">
<title>l3_ffn_down_5&#45;&gt;l3_ffn_res_5</title>
<path fill="none" stroke="black" d="M299894.8,-393.76C299894.8,-393.76 299894.8,-342.19 299894.8,-342.19"/>
<polygon fill="black" stroke="black" points="299898.3,-342.19 299894.8,-332.19 299891.3,-342.19 299898.3,-342.19"/>
</g>
<!-- l3_ffn_down_5&#45;&gt;l3_ffn_res_5 -->
<g id="edge1240" class="edge">
<title>l3_ffn_down_5&#45;&gt;l3_ffn_res_5</title>
<path fill="none" stroke="black" d="M300027.2,-393.76C300027.2,-393.76 300027.2,-337.89 300027.2,-337.89"/>
<polygon fill="black" stroke="black" points="300030.7,-337.89 300027.2,-327.89 300023.7,-337.89 300030.7,-337.89"/>
</g>
<!-- l3_ffn_down_5&#45;&gt;l3_ffn_res_5 -->
<g id="edge1360" class="edge">
<title>l3_ffn_down_5&#45;&gt;l3_ffn_res_5</title>
<path fill="none" stroke="black" d="M300159.6,-393.76C300159.6,-393.76 300159.6,-333.6 300159.6,-333.6"/>
<polygon fill="black" stroke="black" points="300163.1,-333.6 300159.6,-323.6 300156.1,-333.6 300163.1,-333.6"/>
</g>
<!-- l3_ffn_res_5&#45;&gt;l3_ffn_ln_5 -->
<g id="edge1074" class="edge">
<title>l3_ffn_res_5&#45;&gt;l3_ffn_ln_5</title>
<path fill="none" stroke="black" d="M299723.14,-301.46C299723.14,-301.46 299723.14,-271.1 299723.14,-271.1"/>
<polygon fill="black" stroke="black" points="299726.64,-271.1 299723.14,-261.1 299719.64,-271.1 299726.64,-271.1"/>
</g>
<!-- l3_ffn_res_5&#45;&gt;l3_ffn_ln_5 -->
<g id="edge1146" class="edge">
<title>l3_ffn_res_5&#45;&gt;l3_ffn_ln_5</title>
<path fill="none" stroke="black" d="M299780.68,-299.73C299780.68,-299.73 299780.68,-271.05 299780.68,-271.05"/>
<polygon fill="black" stroke="black" points="299784.18,-271.05 299780.68,-261.05 299777.18,-271.05 299784.18,-271.05"/>
</g>
<!-- l3_ffn_res_5&#45;&gt;l3_ffn_ln_5 -->
<g id="edge1242" class="edge">
<title>l3_ffn_res_5&#45;&gt;l3_ffn_ln_5</title>
<path fill="none" stroke="black" d="M299838.23,-297.94C299838.23,-297.94 299838.23,-271.2 299838.23,-271.2"/>
<polygon fill="black" stroke="black" points="299841.73,-271.2 299838.23,-261.2 299834.73,-271.2 299841.73,-271.2"/>
</g>
<!-- l3_ffn_res_5&#45;&gt;l3_ffn_ln_5 -->
<g id="edge1362" class="edge">
<title>l3_ffn_res_5&#45;&gt;l3_ffn_ln_5</title>
<path fill="none" stroke="black" d="M299895.77,-297.94C299895.77,-297.94 299895.77,-271.2 299895.77,-271.2"/>
<polygon fill="black" stroke="black" points="299899.27,-271.2 299895.77,-261.2 299892.27,-271.2 299899.27,-271.2"/>
</g>
<!-- l3_ffn_ln_5&#45;&gt;l3_ffn_up_5 -->
<g id="edge1070" class="edge">
<title>l3_ffn_ln_5&#45;&gt;l3_ffn_up_5</title>
<path fill="none" stroke="black" d="M299550.49,-255C299427.7,-255 299316.03,-255 299316.03,-255 299316.03,-255 299316.03,-521 299316.03,-521 299316.03,-521 299672.79,-521 299672.79,-521"/>
<polygon fill="black" stroke="black" points="299672.79,-524.5 299682.79,-521 299672.79,-517.5 299672.79,-524.5"/>
</g>
<!-- l3_ffn_ln_5&#45;&gt;l3_ffn_up_5 -->
<g id="edge1142" class="edge">
<title>l3_ffn_ln_5&#45;&gt;l3_ffn_up_5</title>
<path fill="none" stroke="black" d="M299550.2,-249C299425.72,-249 299312.02,-249 299312.02,-249 299312.02,-249 299312.02,-528 299312.02,-528 299312.02,-528 299672.93,-528 299672.93,-528"/>
<polygon fill="black" stroke="black" points="299672.93,-531.5 299682.93,-528 299672.93,-524.5 299672.93,-531.5"/>
</g>
<!-- l3_ffn_ln_5&#45;&gt;l3_ffn_up_5 -->
<g id="edge1238" class="edge">
<title>l3_ffn_ln_5&#45;&gt;l3_ffn_up_5</title>
<path fill="none" stroke="black" d="M299550.34,-243C299424.02,-243 299308,-243 299308,-243 299308,-243 299308,-535 299308,-535 299308,-535 299672.85,-535 299672.85,-535"/>
<polygon fill="black" stroke="black" points="299672.85,-538.5 299682.85,-535 299672.85,-531.5 299672.85,-538.5"/>
</g>
<!-- l3_ffn_ln_5&#45;&gt;l3_ffn_up_5 -->
<g id="edge1358" class="edge">
<title>l3_ffn_ln_5&#45;&gt;l3_ffn_up_5</title>
<path fill="none" stroke="black" d="M299550.11,-237C299422.09,-237 299303.98,-237 299303.98,-237 299303.98,-237 299303.98,-542 299303.98,-542 299303.98,-542 299672.78,-542 299672.78,-542"/>
<polygon fill="black" stroke="black" points="299672.78,-545.5 299682.78,-542 299672.78,-538.5 299672.78,-545.5"/>
</g>
<!-- l3_ffn_ln_5&#45;&gt;l3_ffn_res_5 -->
<g id="edge1073" class="edge">
<title>l3_ffn_ln_5&#45;&gt;l3_ffn_res_5</title>
<path fill="none" stroke="black" d="M299953.32,-261.17C299953.32,-261.17 299953.32,-289.52 299953.32,-289.52"/>
<polygon fill="black" stroke="black" points="299949.82,-289.52 299953.32,-299.52 299956.82,-289.52 299949.82,-289.52"/>
</g>
<!-- l3_ffn_ln_5&#45;&gt;l3_ffn_res_5 -->
<g id="edge1145" class="edge">
<title>l3_ffn_ln_5&#45;&gt;l3_ffn_res_5</title>
<path fill="none" stroke="black" d="M300010.86,-261.17C300010.86,-261.17 300010.86,-291.38 300010.86,-291.38"/>
<polygon fill="black" stroke="black" points="300007.36,-291.38 300010.86,-301.38 300014.36,-291.38 300007.36,-291.38"/>
</g>
<!-- l3_ffn_ln_5&#45;&gt;l3_ffn_res_5 -->
<g id="edge1241" class="edge">
<title>l3_ffn_ln_5&#45;&gt;l3_ffn_res_5</title>
<path fill="none" stroke="black" d="M300068.41,-261.17C300068.41,-261.17 300068.41,-293.59 300068.41,-293.59"/>
<polygon fill="black" stroke="black" points="300064.91,-293.59 300068.41,-303.59 300071.91,-293.59 300064.91,-293.59"/>
</g>
<!-- l3_ffn_ln_5&#45;&gt;l3_ffn_res_5 -->
<g id="edge1361" class="edge">
<title>l3_ffn_ln_5&#45;&gt;l3_ffn_res_5</title>
<path fill="none" stroke="black" d="M300125.95,-261.17C300125.95,-261.17 300125.95,-295.25 300125.95,-295.25"/>
<polygon fill="black" stroke="black" points="300122.45,-295.25 300125.95,-305.25 300129.45,-295.25 300122.45,-295.25"/>
</g>
<!-- final_output_5 -->
<g id="node618" class="node">
<title>final_output_5</title>
<polygon fill="lightgreen" stroke="black" points="301662.5,-180 301041.5,-180 301041.5,-144 301662.5,-144 301662.5,-180"/>
<text text-anchor="middle" x="301352" y="-159.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ffn_ln_5&#45;&gt;final_output_5 -->
<g id="edge1394" class="edge">
<title>l3_ffn_ln_5&#45;&gt;final_output_5</title>
<path fill="none" stroke="black" d="M299972.5,-224.62C299972.5,-200.72 299972.5,-162 299972.5,-162 299972.5,-162 301031.12,-162 301031.12,-162"/>
<polygon fill="black" stroke="black" points="301031.12,-165.5 301041.12,-162 301031.12,-158.5 301031.12,-165.5"/>
</g>
<!-- l3_ffn_up_6 -->
<g id="node588" class="node">
<title>l3_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="303729,-550 303079,-550 303079,-514 303729,-514 303729,-550"/>
<text text-anchor="middle" x="303404" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ffn_down_6 -->
<g id="node589" class="node">
<title>l3_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="303688,-430 303026,-430 303026,-394 303688,-394 303688,-430"/>
<text text-anchor="middle" x="303357" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_6&#45;&gt;l3_ffn_down_6 -->
<g id="edge1077" class="edge">
<title>l3_ffn_up_6&#45;&gt;l3_ffn_down_6</title>
<path fill="none" stroke="black" d="M303417.33,-513.77C303417.33,-513.77 303417.33,-440 303417.33,-440"/>
<polygon fill="black" stroke="black" points="303420.83,-440 303417.33,-430 303413.83,-440 303420.83,-440"/>
</g>
<!-- l3_ffn_up_6&#45;&gt;l3_ffn_down_6 -->
<g id="edge1149" class="edge">
<title>l3_ffn_up_6&#45;&gt;l3_ffn_down_6</title>
<path fill="none" stroke="black" d="M303485,-513.77C303485,-513.77 303485,-440 303485,-440"/>
<polygon fill="black" stroke="black" points="303488.5,-440 303485,-430 303481.5,-440 303488.5,-440"/>
</g>
<!-- l3_ffn_up_6&#45;&gt;l3_ffn_down_6 -->
<g id="edge1245" class="edge">
<title>l3_ffn_up_6&#45;&gt;l3_ffn_down_6</title>
<path fill="none" stroke="black" d="M303552.67,-513.77C303552.67,-513.77 303552.67,-440 303552.67,-440"/>
<polygon fill="black" stroke="black" points="303556.17,-440 303552.67,-430 303549.17,-440 303556.17,-440"/>
</g>
<!-- l3_ffn_up_6&#45;&gt;l3_ffn_down_6 -->
<g id="edge1365" class="edge">
<title>l3_ffn_up_6&#45;&gt;l3_ffn_down_6</title>
<path fill="none" stroke="black" d="M303620.33,-513.77C303620.33,-513.77 303620.33,-440 303620.33,-440"/>
<polygon fill="black" stroke="black" points="303623.83,-440 303620.33,-430 303616.83,-440 303623.83,-440"/>
</g>
<!-- l3_ffn_res_6 -->
<g id="node590" class="node">
<title>l3_ffn_res_6</title>
<polygon fill="lightgray" stroke="black" points="303263,-333 302716.1,-315 303263,-297 303809.9,-315 303263,-333"/>
<text text-anchor="middle" x="303263" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_down_6&#45;&gt;l3_ffn_res_6 -->
<g id="edge1078" class="edge">
<title>l3_ffn_down_6&#45;&gt;l3_ffn_res_6</title>
<path fill="none" stroke="black" d="M303158.4,-393.76C303158.4,-393.76 303158.4,-339.68 303158.4,-339.68"/>
<polygon fill="black" stroke="black" points="303161.9,-339.68 303158.4,-329.68 303154.9,-339.68 303161.9,-339.68"/>
</g>
<!-- l3_ffn_down_6&#45;&gt;l3_ffn_res_6 -->
<g id="edge1150" class="edge">
<title>l3_ffn_down_6&#45;&gt;l3_ffn_res_6</title>
<path fill="none" stroke="black" d="M303290.8,-393.76C303290.8,-393.76 303290.8,-342.19 303290.8,-342.19"/>
<polygon fill="black" stroke="black" points="303294.3,-342.19 303290.8,-332.19 303287.3,-342.19 303294.3,-342.19"/>
</g>
<!-- l3_ffn_down_6&#45;&gt;l3_ffn_res_6 -->
<g id="edge1246" class="edge">
<title>l3_ffn_down_6&#45;&gt;l3_ffn_res_6</title>
<path fill="none" stroke="black" d="M303423.2,-393.76C303423.2,-393.76 303423.2,-337.89 303423.2,-337.89"/>
<polygon fill="black" stroke="black" points="303426.7,-337.89 303423.2,-327.89 303419.7,-337.89 303426.7,-337.89"/>
</g>
<!-- l3_ffn_down_6&#45;&gt;l3_ffn_res_6 -->
<g id="edge1366" class="edge">
<title>l3_ffn_down_6&#45;&gt;l3_ffn_res_6</title>
<path fill="none" stroke="black" d="M303555.6,-393.76C303555.6,-393.76 303555.6,-333.6 303555.6,-333.6"/>
<polygon fill="black" stroke="black" points="303559.1,-333.6 303555.6,-323.6 303552.1,-333.6 303559.1,-333.6"/>
</g>
<!-- l3_ffn_res_6&#45;&gt;l3_ffn_ln_6 -->
<g id="edge1080" class="edge">
<title>l3_ffn_res_6&#45;&gt;l3_ffn_ln_6</title>
<path fill="none" stroke="black" d="M303016.83,-304.99C303016.83,-304.99 303016.83,-271.25 303016.83,-271.25"/>
<polygon fill="black" stroke="black" points="303020.33,-271.25 303016.83,-261.25 303013.33,-271.25 303020.33,-271.25"/>
</g>
<!-- l3_ffn_res_6&#45;&gt;l3_ffn_ln_6 -->
<g id="edge1152" class="edge">
<title>l3_ffn_res_6&#45;&gt;l3_ffn_ln_6</title>
<path fill="none" stroke="black" d="M303087.17,-302.79C303087.17,-302.79 303087.17,-271.23 303087.17,-271.23"/>
<polygon fill="black" stroke="black" points="303090.67,-271.23 303087.17,-261.23 303083.67,-271.23 303090.67,-271.23"/>
</g>
<!-- l3_ffn_res_6&#45;&gt;l3_ffn_ln_6 -->
<g id="edge1248" class="edge">
<title>l3_ffn_res_6&#45;&gt;l3_ffn_ln_6</title>
<path fill="none" stroke="black" d="M303157.5,-300.43C303157.5,-300.43 303157.5,-271.13 303157.5,-271.13"/>
<polygon fill="black" stroke="black" points="303161,-271.13 303157.5,-261.13 303154,-271.13 303161,-271.13"/>
</g>
<!-- l3_ffn_res_6&#45;&gt;l3_ffn_ln_6 -->
<g id="edge1368" class="edge">
<title>l3_ffn_res_6&#45;&gt;l3_ffn_ln_6</title>
<path fill="none" stroke="black" d="M303227.83,-297.94C303227.83,-297.94 303227.83,-271.2 303227.83,-271.2"/>
<polygon fill="black" stroke="black" points="303231.33,-271.2 303227.83,-261.2 303224.33,-271.2 303231.33,-271.2"/>
</g>
<!-- l3_ffn_ln_6&#45;&gt;l3_ffn_up_6 -->
<g id="edge1076" class="edge">
<title>l3_ffn_ln_6&#45;&gt;l3_ffn_up_6</title>
<path fill="none" stroke="black" d="M302946.37,-241C302823.53,-241 302711.82,-241 302711.82,-241 302711.82,-241 302711.82,-431 302711.82,-431 302711.82,-431 303349.67,-431 303349.67,-431 303349.67,-431 303349.67,-503.94 303349.67,-503.94"/>
<polygon fill="black" stroke="black" points="303346.17,-503.94 303349.67,-513.94 303353.17,-503.94 303346.17,-503.94"/>
</g>
<!-- l3_ffn_ln_6&#45;&gt;l3_ffn_up_6 -->
<g id="edge1148" class="edge">
<title>l3_ffn_ln_6&#45;&gt;l3_ffn_up_6</title>
<path fill="none" stroke="black" d="M302946.35,-237C302821.62,-237 302707.58,-237 302707.58,-237 302707.58,-237 302707.58,-433 302707.58,-433 302707.58,-433 303282,-433 303282,-433 303282,-433 303282,-503.84 303282,-503.84"/>
<polygon fill="black" stroke="black" points="303278.5,-503.84 303282,-513.84 303285.5,-503.84 303278.5,-503.84"/>
</g>
<!-- l3_ffn_ln_6&#45;&gt;l3_ffn_up_6 -->
<g id="edge1244" class="edge">
<title>l3_ffn_ln_6&#45;&gt;l3_ffn_up_6</title>
<path fill="none" stroke="black" d="M302946.38,-233C302819.75,-233 302703.35,-233 302703.35,-233 302703.35,-233 302703.35,-435 302703.35,-435 302703.35,-435 303214.33,-435 303214.33,-435 303214.33,-435 303214.33,-503.76 303214.33,-503.76"/>
<polygon fill="black" stroke="black" points="303210.83,-503.76 303214.33,-513.76 303217.83,-503.76 303210.83,-503.76"/>
</g>
<!-- l3_ffn_ln_6&#45;&gt;l3_ffn_up_6 -->
<g id="edge1364" class="edge">
<title>l3_ffn_ln_6&#45;&gt;l3_ffn_up_6</title>
<path fill="none" stroke="black" d="M302946.44,-229C302817.91,-229 302699.12,-229 302699.12,-229 302699.12,-229 302699.12,-437 302699.12,-437 302699.12,-437 303146.67,-437 303146.67,-437 303146.67,-437 303146.67,-503.68 303146.67,-503.68"/>
<polygon fill="black" stroke="black" points="303143.17,-503.68 303146.67,-513.68 303150.17,-503.68 303143.17,-503.68"/>
</g>
<!-- l3_ffn_ln_6&#45;&gt;l3_ffn_res_6 -->
<g id="edge1079" class="edge">
<title>l3_ffn_ln_6&#45;&gt;l3_ffn_res_6</title>
<path fill="none" stroke="black" d="M303298.17,-261.17C303298.17,-261.17 303298.17,-288.07 303298.17,-288.07"/>
<polygon fill="black" stroke="black" points="303294.67,-288.07 303298.17,-298.07 303301.67,-288.07 303294.67,-288.07"/>
</g>
<!-- l3_ffn_ln_6&#45;&gt;l3_ffn_res_6 -->
<g id="edge1151" class="edge">
<title>l3_ffn_ln_6&#45;&gt;l3_ffn_res_6</title>
<path fill="none" stroke="black" d="M303368.5,-261.17C303368.5,-261.17 303368.5,-290.46 303368.5,-290.46"/>
<polygon fill="black" stroke="black" points="303365,-290.46 303368.5,-300.46 303372,-290.46 303365,-290.46"/>
</g>
<!-- l3_ffn_ln_6&#45;&gt;l3_ffn_res_6 -->
<g id="edge1247" class="edge">
<title>l3_ffn_ln_6&#45;&gt;l3_ffn_res_6</title>
<path fill="none" stroke="black" d="M303438.83,-261.17C303438.83,-261.17 303438.83,-292.72 303438.83,-292.72"/>
<polygon fill="black" stroke="black" points="303435.33,-292.72 303438.83,-302.72 303442.33,-292.73 303435.33,-292.72"/>
</g>
<!-- l3_ffn_ln_6&#45;&gt;l3_ffn_res_6 -->
<g id="edge1367" class="edge">
<title>l3_ffn_ln_6&#45;&gt;l3_ffn_res_6</title>
<path fill="none" stroke="black" d="M303509.17,-261.17C303509.17,-261.17 303509.17,-294.85 303509.17,-294.85"/>
<polygon fill="black" stroke="black" points="303505.67,-294.85 303509.17,-304.85 303512.67,-294.85 303505.67,-294.85"/>
</g>
<!-- final_output_6 -->
<g id="node619" class="node">
<title>final_output_6</title>
<polygon fill="lightgreen" stroke="black" points="303579.5,-180 302958.5,-180 302958.5,-144 303579.5,-144 303579.5,-180"/>
<text text-anchor="middle" x="303269" y="-159.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ffn_ln_6&#45;&gt;final_output_6 -->
<g id="edge1397" class="edge">
<title>l3_ffn_ln_6&#45;&gt;final_output_6</title>
<path fill="none" stroke="black" d="M303269,-224.62C303269,-224.62 303269,-190.03 303269,-190.03"/>
<polygon fill="black" stroke="black" points="303272.5,-190.03 303269,-180.03 303265.5,-190.03 303272.5,-190.03"/>
</g>
<!-- l3_ffn_up_7 -->
<g id="node592" class="node">
<title>l3_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="306062,-550 305412,-550 305412,-514 306062,-514 306062,-550"/>
<text text-anchor="middle" x="305737" y="-529.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ffn_down_7 -->
<g id="node593" class="node">
<title>l3_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="305966,-430 305304,-430 305304,-394 305966,-394 305966,-430"/>
<text text-anchor="middle" x="305635" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_7&#45;&gt;l3_ffn_down_7 -->
<g id="edge1083" class="edge">
<title>l3_ffn_up_7&#45;&gt;l3_ffn_down_7</title>
<path fill="none" stroke="black" d="M305522.8,-513.77C305522.8,-513.77 305522.8,-440 305522.8,-440"/>
<polygon fill="black" stroke="black" points="305526.3,-440 305522.8,-430 305519.3,-440 305526.3,-440"/>
</g>
<!-- l3_ffn_up_7&#45;&gt;l3_ffn_down_7 -->
<g id="edge1155" class="edge">
<title>l3_ffn_up_7&#45;&gt;l3_ffn_down_7</title>
<path fill="none" stroke="black" d="M305633.6,-513.77C305633.6,-513.77 305633.6,-440 305633.6,-440"/>
<polygon fill="black" stroke="black" points="305637.1,-440 305633.6,-430 305630.1,-440 305637.1,-440"/>
</g>
<!-- l3_ffn_up_7&#45;&gt;l3_ffn_down_7 -->
<g id="edge1251" class="edge">
<title>l3_ffn_up_7&#45;&gt;l3_ffn_down_7</title>
<path fill="none" stroke="black" d="M305744.4,-513.77C305744.4,-513.77 305744.4,-440 305744.4,-440"/>
<polygon fill="black" stroke="black" points="305747.9,-440 305744.4,-430 305740.9,-440 305747.9,-440"/>
</g>
<!-- l3_ffn_up_7&#45;&gt;l3_ffn_down_7 -->
<g id="edge1371" class="edge">
<title>l3_ffn_up_7&#45;&gt;l3_ffn_down_7</title>
<path fill="none" stroke="black" d="M305855.2,-513.77C305855.2,-513.77 305855.2,-440 305855.2,-440"/>
<polygon fill="black" stroke="black" points="305858.7,-440 305855.2,-430 305851.7,-440 305858.7,-440"/>
</g>
<!-- l3_ffn_res_7 -->
<g id="node594" class="node">
<title>l3_ffn_res_7</title>
<polygon fill="lightgray" stroke="black" points="305527,-333 304980.1,-315 305527,-297 306073.9,-315 305527,-333"/>
<text text-anchor="middle" x="305527" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Residual Add&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]  2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_down_7&#45;&gt;l3_ffn_res_7 -->
<g id="edge1084" class="edge">
<title>l3_ffn_down_7&#45;&gt;l3_ffn_res_7</title>
<path fill="none" stroke="black" d="M305436.4,-393.76C305436.4,-393.76 305436.4,-340.29 305436.4,-340.29"/>
<polygon fill="black" stroke="black" points="305439.9,-340.29 305436.4,-330.29 305432.9,-340.29 305439.9,-340.29"/>
</g>
<!-- l3_ffn_down_7&#45;&gt;l3_ffn_res_7 -->
<g id="edge1156" class="edge">
<title>l3_ffn_down_7&#45;&gt;l3_ffn_res_7</title>
<path fill="none" stroke="black" d="M305568.8,-393.76C305568.8,-393.76 305568.8,-341.86 305568.8,-341.86"/>
<polygon fill="black" stroke="black" points="305572.3,-341.86 305568.8,-331.86 305565.3,-341.86 305572.3,-341.86"/>
</g>
<!-- l3_ffn_down_7&#45;&gt;l3_ffn_res_7 -->
<g id="edge1252" class="edge">
<title>l3_ffn_down_7&#45;&gt;l3_ffn_res_7</title>
<path fill="none" stroke="black" d="M305701.2,-393.76C305701.2,-393.76 305701.2,-337.32 305701.2,-337.32"/>
<polygon fill="black" stroke="black" points="305704.7,-337.32 305701.2,-327.32 305697.7,-337.32 305704.7,-337.32"/>
</g>
<!-- l3_ffn_down_7&#45;&gt;l3_ffn_res_7 -->
<g id="edge1372" class="edge">
<title>l3_ffn_down_7&#45;&gt;l3_ffn_res_7</title>
<path fill="none" stroke="black" d="M305833.6,-393.76C305833.6,-393.76 305833.6,-333.35 305833.6,-333.35"/>
<polygon fill="black" stroke="black" points="305837.1,-333.35 305833.6,-323.35 305830.1,-333.35 305837.1,-333.35"/>
</g>
<!-- l3_ffn_res_7&#45;&gt;l3_ffn_ln_7 -->
<g id="edge1086" class="edge">
<title>l3_ffn_res_7&#45;&gt;l3_ffn_ln_7</title>
<path fill="none" stroke="black" d="M305280.83,-304.99C305280.83,-304.99 305280.83,-271.25 305280.83,-271.25"/>
<polygon fill="black" stroke="black" points="305284.33,-271.25 305280.83,-261.25 305277.33,-271.25 305284.33,-271.25"/>
</g>
<!-- l3_ffn_res_7&#45;&gt;l3_ffn_ln_7 -->
<g id="edge1158" class="edge">
<title>l3_ffn_res_7&#45;&gt;l3_ffn_ln_7</title>
<path fill="none" stroke="black" d="M305351.17,-302.79C305351.17,-302.79 305351.17,-271.23 305351.17,-271.23"/>
<polygon fill="black" stroke="black" points="305354.67,-271.23 305351.17,-261.23 305347.67,-271.23 305354.67,-271.23"/>
</g>
<!-- l3_ffn_res_7&#45;&gt;l3_ffn_ln_7 -->
<g id="edge1254" class="edge">
<title>l3_ffn_res_7&#45;&gt;l3_ffn_ln_7</title>
<path fill="none" stroke="black" d="M305421.5,-300.43C305421.5,-300.43 305421.5,-271.13 305421.5,-271.13"/>
<polygon fill="black" stroke="black" points="305425,-271.13 305421.5,-261.13 305418,-271.13 305425,-271.13"/>
</g>
<!-- l3_ffn_res_7&#45;&gt;l3_ffn_ln_7 -->
<g id="edge1374" class="edge">
<title>l3_ffn_res_7&#45;&gt;l3_ffn_ln_7</title>
<path fill="none" stroke="black" d="M305491.83,-297.94C305491.83,-297.94 305491.83,-271.2 305491.83,-271.2"/>
<polygon fill="black" stroke="black" points="305495.33,-271.2 305491.83,-261.2 305488.33,-271.2 305495.33,-271.2"/>
</g>
<!-- l3_ffn_ln_7&#45;&gt;l3_ffn_up_7 -->
<g id="edge1082" class="edge">
<title>l3_ffn_ln_7&#45;&gt;l3_ffn_up_7</title>
<path fill="none" stroke="black" d="M305210.32,-255C305087.78,-255 304976.43,-255 304976.43,-255 304976.43,-255 304976.43,-521 304976.43,-521 304976.43,-521 305401.97,-521 305401.97,-521"/>
<polygon fill="black" stroke="black" points="305401.97,-524.5 305411.97,-521 305401.97,-517.5 305401.97,-524.5"/>
</g>
<!-- l3_ffn_ln_7&#45;&gt;l3_ffn_up_7 -->
<g id="edge1154" class="edge">
<title>l3_ffn_ln_7&#45;&gt;l3_ffn_up_7</title>
<path fill="none" stroke="black" d="M305210.25,-249C305086.11,-249 304972.81,-249 304972.81,-249 304972.81,-249 304972.81,-528 304972.81,-528 304972.81,-528 305401.81,-528 305401.81,-528"/>
<polygon fill="black" stroke="black" points="305401.81,-531.5 305411.81,-528 305401.81,-524.5 305401.81,-531.5"/>
</g>
<!-- l3_ffn_ln_7&#45;&gt;l3_ffn_up_7 -->
<g id="edge1250" class="edge">
<title>l3_ffn_ln_7&#45;&gt;l3_ffn_up_7</title>
<path fill="none" stroke="black" d="M305210.2,-243C305084.46,-243 304969.19,-243 304969.19,-243 304969.19,-243 304969.19,-535 304969.19,-535 304969.19,-535 305401.94,-535 305401.94,-535"/>
<polygon fill="black" stroke="black" points="305401.94,-538.5 305411.94,-535 305401.94,-531.5 305401.94,-538.5"/>
</g>
<!-- l3_ffn_ln_7&#45;&gt;l3_ffn_up_7 -->
<g id="edge1370" class="edge">
<title>l3_ffn_ln_7&#45;&gt;l3_ffn_up_7</title>
<path fill="none" stroke="black" d="M305210.19,-237C305082.84,-237 304965.57,-237 304965.57,-237 304965.57,-237 304965.57,-542 304965.57,-542 304965.57,-542 305401.8,-542 305401.8,-542"/>
<polygon fill="black" stroke="black" points="305401.8,-545.5 305411.8,-542 305401.8,-538.5 305401.8,-545.5"/>
</g>
<!-- l3_ffn_ln_7&#45;&gt;l3_ffn_res_7 -->
<g id="edge1085" class="edge">
<title>l3_ffn_ln_7&#45;&gt;l3_ffn_res_7</title>
<path fill="none" stroke="black" d="M305562.17,-261.17C305562.17,-261.17 305562.17,-288.07 305562.17,-288.07"/>
<polygon fill="black" stroke="black" points="305558.67,-288.07 305562.17,-298.07 305565.67,-288.07 305558.67,-288.07"/>
</g>
<!-- l3_ffn_ln_7&#45;&gt;l3_ffn_res_7 -->
<g id="edge1157" class="edge">
<title>l3_ffn_ln_7&#45;&gt;l3_ffn_res_7</title>
<path fill="none" stroke="black" d="M305632.5,-261.17C305632.5,-261.17 305632.5,-290.46 305632.5,-290.46"/>
<polygon fill="black" stroke="black" points="305629,-290.46 305632.5,-300.46 305636,-290.46 305629,-290.46"/>
</g>
<!-- l3_ffn_ln_7&#45;&gt;l3_ffn_res_7 -->
<g id="edge1253" class="edge">
<title>l3_ffn_ln_7&#45;&gt;l3_ffn_res_7</title>
<path fill="none" stroke="black" d="M305702.83,-261.17C305702.83,-261.17 305702.83,-292.72 305702.83,-292.72"/>
<polygon fill="black" stroke="black" points="305699.33,-292.72 305702.83,-302.72 305706.33,-292.73 305699.33,-292.72"/>
</g>
<!-- l3_ffn_ln_7&#45;&gt;l3_ffn_res_7 -->
<g id="edge1373" class="edge">
<title>l3_ffn_ln_7&#45;&gt;l3_ffn_res_7</title>
<path fill="none" stroke="black" d="M305773.17,-261.17C305773.17,-261.17 305773.17,-294.85 305773.17,-294.85"/>
<polygon fill="black" stroke="black" points="305769.67,-294.85 305773.17,-304.85 305776.67,-294.85 305769.67,-294.85"/>
</g>
<!-- final_output_7 -->
<g id="node620" class="node">
<title>final_output_7</title>
<polygon fill="lightgreen" stroke="black" points="304857.5,-180 304236.5,-180 304236.5,-144 304857.5,-144 304857.5,-180"/>
<text text-anchor="middle" x="304547" y="-159.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: base_gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ffn_ln_7&#45;&gt;final_output_7 -->
<g id="edge1400" class="edge">
<title>l3_ffn_ln_7&#45;&gt;final_output_7</title>
<path fill="none" stroke="black" d="M305210.18,-231C304923.85,-231 304547,-231 304547,-231 304547,-231 304547,-190.13 304547,-190.13"/>
<polygon fill="black" stroke="black" points="304550.5,-190.13 304547,-180.13 304543.5,-190.13 304550.5,-190.13"/>
</g>
<!-- hier_reduce_0_8&#45;&gt;l0_ffn_ln_0 -->
<g id="edge100" class="edge">
<title>hier_reduce_0_8&#45;&gt;l0_ffn_ln_0</title>
<path fill="none" stroke="black" d="M14666.07,-306C14532.99,-306 14399.25,-306 14399.25,-306 14399.25,-306 14399.25,-261 14399.25,-261 14399.25,-261 8938.84,-261 8938.84,-261"/>
<polygon fill="black" stroke="black" points="8938.84,-257.5 8928.84,-261 8938.84,-264.5 8938.84,-257.5"/>
</g>
<!-- hier_reduce_0_8&#45;&gt;l0_ffn_ln_1 -->
<g id="edge106" class="edge">
<title>hier_reduce_0_8&#45;&gt;l0_ffn_ln_1</title>
<path fill="none" stroke="black" d="M14929,-296.82C14929,-283.96 14929,-269 14929,-269 14929,-269 3421.68,-269 3421.68,-269 3421.68,-269 3421.68,-268.21 3421.68,-268.21"/>
<polygon fill="black" stroke="black" points="3425.18,-271.06 3421.68,-261.06 3418.18,-271.06 3425.18,-271.06"/>
</g>
<!-- hier_reduce_0_8&#45;&gt;l0_ffn_ln_2 -->
<g id="edge112" class="edge">
<title>hier_reduce_0_8&#45;&gt;l0_ffn_ln_2</title>
<path fill="none" stroke="black" d="M14578.8,-308.83C14578.8,-299.53 14578.8,-283 14578.8,-283 14578.8,-283 794,-283 794,-283 794,-283 794,-271.13 794,-271.13"/>
<polygon fill="black" stroke="black" points="797.5,-271.13 794,-261.13 790.5,-271.13 797.5,-271.13"/>
</g>
<!-- hier_reduce_0_8&#45;&gt;l0_ffn_ln_3 -->
<g id="edge118" class="edge">
<title>hier_reduce_0_8&#45;&gt;l0_ffn_ln_3</title>
<path fill="none" stroke="black" d="M15279.2,-308.99C15279.2,-295.91 15279.2,-266 15279.2,-266 15279.2,-266 5369.95,-266 5369.95,-266 5369.95,-266 5369.95,-265.51 5369.95,-265.51"/>
<polygon fill="black" stroke="black" points="5373.45,-271.12 5369.95,-261.12 5366.45,-271.12 5373.45,-271.12"/>
</g>
<!-- hier_reduce_0_8&#45;&gt;l0_ffn_ln_4 -->
<g id="edge124" class="edge">
<title>hier_reduce_0_8&#45;&gt;l0_ffn_ln_4</title>
<path fill="none" stroke="black" d="M14666.39,-324C14529.53,-324 14390.36,-324 14390.36,-324 14390.36,-324 14390.36,-265 14390.36,-265 14390.36,-265 6817.68,-265 6817.68,-265 6817.68,-265 6817.68,-264.62 6817.68,-264.62"/>
<polygon fill="black" stroke="black" points="6821.18,-271.17 6817.68,-261.17 6814.18,-271.17 6821.18,-271.17"/>
</g>
<!-- hier_reduce_0_8&#45;&gt;l0_ffn_ln_5 -->
<g id="edge130" class="edge">
<title>hier_reduce_0_8&#45;&gt;l0_ffn_ln_5</title>
<path fill="none" stroke="black" d="M15104.1,-302.65C15104.1,-288.73 15104.1,-268 15104.1,-268 15104.1,-268 4524.22,-268 4524.22,-268 4524.22,-268 4524.22,-267.32 4524.22,-267.32"/>
<polygon fill="black" stroke="black" points="4527.72,-271.17 4524.22,-261.17 4520.72,-271.17 4527.72,-271.17"/>
</g>
<!-- hier_reduce_0_8&#45;&gt;l0_ffn_ln_6 -->
<g id="edge136" class="edge">
<title>hier_reduce_0_8&#45;&gt;l0_ffn_ln_6</title>
<path fill="none" stroke="black" d="M14753.9,-302.98C14753.9,-289.95 14753.9,-271 14753.9,-271 14753.9,-271 2289.68,-271 2289.68,-271 2289.68,-271 2289.68,-270.02 2289.68,-270.02"/>
<polygon fill="black" stroke="black" points="2293.18,-271.21 2289.68,-261.21 2286.18,-271.21 2293.18,-271.21"/>
</g>
<!-- hier_reduce_0_8&#45;&gt;l0_ffn_ln_7 -->
<g id="edge142" class="edge">
<title>hier_reduce_0_8&#45;&gt;l0_ffn_ln_7</title>
<path fill="none" stroke="black" d="M14403.63,-315C14397.91,-315 14394.81,-315 14394.81,-315 14394.81,-315 14394.81,-263 14394.81,-263 14394.81,-263 8005.02,-263 8005.02,-263 8005.02,-263 8005.02,-262.82 8005.02,-262.82"/>
<polygon fill="black" stroke="black" points="8008.52,-271.15 8005.02,-261.15 8001.52,-271.15 8008.52,-271.15"/>
</g>
<!-- hier_reduce_0_16&#45;&gt;l0_ffn_ln_0 -->
<g id="edge196" class="edge">
<title>hier_reduce_0_16&#45;&gt;l0_ffn_ln_0</title>
<path fill="none" stroke="black" d="M61983.47,-317.32C61983.47,-327.66 61983.47,-369 61983.47,-369 61983.47,-369 11072,-369 11072,-369 11072,-369 11072,-228 11072,-228 11072,-228 8938.57,-228 8938.57,-228"/>
<polygon fill="black" stroke="black" points="8938.57,-224.5 8928.57,-228 8938.57,-231.5 8938.57,-224.5"/>
</g>
<!-- hier_reduce_0_16&#45;&gt;l0_ffn_ln_1 -->
<g id="edge202" class="edge">
<title>hier_reduce_0_16&#45;&gt;l0_ffn_ln_1</title>
<path fill="none" stroke="black" d="M62248.18,-325.91C62248.18,-343.45 62248.18,-376 62248.18,-376 62248.18,-376 3406.61,-376 3406.61,-376 3406.61,-376 3406.61,-271.21 3406.61,-271.21"/>
<polygon fill="black" stroke="black" points="3410.11,-271.21 3406.61,-261.21 3403.11,-271.21 3410.11,-271.21"/>
</g>
<!-- hier_reduce_0_16&#45;&gt;l0_ffn_ln_2 -->
<g id="edge208" class="edge">
<title>hier_reduce_0_16&#45;&gt;l0_ffn_ln_2</title>
<path fill="none" stroke="black" d="M62106.93,-321C61925.38,-321 61741.77,-321 61741.77,-321 61741.77,-321 61741.77,-282 61741.77,-282 61741.77,-282 846.75,-282 846.75,-282 846.75,-282 846.75,-271.13 846.75,-271.13"/>
<polygon fill="black" stroke="black" points="850.25,-271.13 846.75,-261.13 843.25,-271.13 850.25,-271.13"/>
</g>
<!-- hier_reduce_0_16&#45;&gt;l0_ffn_ln_3 -->
<g id="edge214" class="edge">
<title>hier_reduce_0_16&#45;&gt;l0_ffn_ln_3</title>
<path fill="none" stroke="black" d="M62142.3,-322.23C62142.3,-337.99 62142.3,-374 62142.3,-374 62142.3,-374 5670.02,-374 5670.02,-374 5670.02,-374 5670.02,-237 5670.02,-237 5670.02,-237 5437.67,-237 5437.67,-237"/>
<polygon fill="black" stroke="black" points="5437.67,-233.5 5427.67,-237 5437.67,-240.5 5437.67,-233.5"/>
</g>
<!-- hier_reduce_0_16&#45;&gt;l0_ffn_ln_4 -->
<g id="edge220" class="edge">
<title>hier_reduce_0_16&#45;&gt;l0_ffn_ln_4</title>
<path fill="none" stroke="black" d="M62089.36,-320.77C62089.36,-335.44 62089.36,-373 62089.36,-373 62089.36,-373 6802.61,-373 6802.61,-373 6802.61,-373 6802.61,-271.08 6802.61,-271.08"/>
<polygon fill="black" stroke="black" points="6806.11,-271.08 6802.61,-261.08 6799.11,-271.08 6806.11,-271.08"/>
</g>
<!-- hier_reduce_0_16&#45;&gt;l0_ffn_ln_5 -->
<g id="edge226" class="edge">
<title>hier_reduce_0_16&#45;&gt;l0_ffn_ln_5</title>
<path fill="none" stroke="black" d="M62195.24,-324.11C62195.24,-340.9 62195.24,-375 62195.24,-375 62195.24,-375 4519.65,-375 4519.65,-375 4519.65,-375 4519.65,-271.08 4519.65,-271.08"/>
<polygon fill="black" stroke="black" points="4523.15,-271.08 4519.65,-261.08 4516.15,-271.08 4523.15,-271.08"/>
</g>
<!-- hier_reduce_0_16&#45;&gt;l0_ffn_ln_6 -->
<g id="edge232" class="edge">
<title>hier_reduce_0_16&#45;&gt;l0_ffn_ln_6</title>
<path fill="none" stroke="black" d="M62301.12,-327.64C62301.12,-346.3 62301.12,-379 62301.12,-379 62301.12,-379 2274.61,-379 2274.61,-379 2274.61,-379 2274.61,-271.06 2274.61,-271.06"/>
<polygon fill="black" stroke="black" points="2278.11,-271.06 2274.61,-261.06 2271.11,-271.06 2278.11,-271.06"/>
</g>
<!-- hier_reduce_0_16&#45;&gt;l0_ffn_ln_7 -->
<g id="edge238" class="edge">
<title>hier_reduce_0_16&#45;&gt;l0_ffn_ln_7</title>
<path fill="none" stroke="black" d="M62036.41,-318.74C62036.41,-331.42 62036.41,-372 62036.41,-372 62036.41,-372 7934.61,-372 7934.61,-372 7934.61,-372 7934.61,-271.21 7934.61,-271.21"/>
<polygon fill="black" stroke="black" points="7938.11,-271.21 7934.61,-261.21 7931.11,-271.21 7938.11,-271.21"/>
</g>
<!-- hier_reduce_0_24&#45;&gt;l0_ffn_ln_0 -->
<g id="edge316" class="edge">
<title>hier_reduce_0_24&#45;&gt;l0_ffn_ln_0</title>
<path fill="none" stroke="black" d="M185736.98,-315.16C185736.98,-318.38 185736.98,-370 185736.98,-370 185736.98,-370 11066,-370 11066,-370 11066,-370 11066,-232 11066,-232 11066,-232 8938.73,-232 8938.73,-232"/>
<polygon fill="black" stroke="black" points="8938.73,-228.5 8928.73,-232 8938.73,-235.5 8938.73,-228.5"/>
</g>
<!-- hier_reduce_0_24&#45;&gt;l0_ffn_ln_1 -->
<g id="edge322" class="edge">
<title>hier_reduce_0_24&#45;&gt;l0_ffn_ln_1</title>
<path fill="none" stroke="black" d="M185739.2,-315.4C185739.2,-320.77 185739.2,-378 185739.2,-378 185739.2,-378 3401.16,-378 3401.16,-378 3401.16,-378 3401.16,-271.21 3401.16,-271.21"/>
<polygon fill="black" stroke="black" points="3404.66,-271.21 3401.16,-261.21 3397.66,-271.21 3404.66,-271.21"/>
</g>
<!-- hier_reduce_0_24&#45;&gt;l0_ffn_ln_2 -->
<g id="edge328" class="edge">
<title>hier_reduce_0_24&#45;&gt;l0_ffn_ln_2</title>
<path fill="none" stroke="black" d="M185741.43,-315.42C185741.43,-320.95 185741.43,-380 185741.43,-380 185741.43,-380 1139,-380 1139,-380 1139,-380 1139,-243 1139,-243 1139,-243 909.58,-243 909.58,-243"/>
<polygon fill="black" stroke="black" points="909.58,-239.5 899.58,-243 909.58,-246.5 909.58,-239.5"/>
</g>
<!-- hier_reduce_0_24&#45;&gt;l0_ffn_ln_3 -->
<g id="edge334" class="edge">
<title>hier_reduce_0_24&#45;&gt;l0_ffn_ln_3</title>
<path fill="none" stroke="black" d="M185797.85,-317.3C185797.85,-329.27 185797.85,-384 185797.85,-384 185797.85,-384 5663.98,-384 5663.98,-384 5663.98,-384 5663.98,-249 5663.98,-249 5663.98,-249 5437.86,-249 5437.86,-249"/>
<polygon fill="black" stroke="black" points="5437.86,-245.5 5427.86,-249 5437.86,-252.5 5437.86,-245.5"/>
</g>
<!-- hier_reduce_0_24&#45;&gt;l0_ffn_ln_4 -->
<g id="edge340" class="edge">
<title>hier_reduce_0_24&#45;&gt;l0_ffn_ln_4</title>
<path fill="none" stroke="black" d="M185780.52,-316.68C185780.52,-327.15 185780.52,-383 185780.52,-383 185780.52,-383 6797.16,-383 6797.16,-383 6797.16,-383 6797.16,-271.02 6797.16,-271.02"/>
<polygon fill="black" stroke="black" points="6800.66,-271.02 6797.16,-261.02 6793.66,-271.02 6800.66,-271.02"/>
</g>
<!-- hier_reduce_0_24&#45;&gt;l0_ffn_ln_5 -->
<g id="edge346" class="edge">
<title>hier_reduce_0_24&#45;&gt;l0_ffn_ln_5</title>
<path fill="none" stroke="black" d="M185743.65,-315.45C185743.65,-324.72 185743.65,-473 185743.65,-473 185743.65,-473 4517.37,-473 4517.37,-473 4517.37,-473 4517.37,-271.05 4517.37,-271.05"/>
<polygon fill="black" stroke="black" points="4520.87,-271.05 4517.37,-261.05 4513.87,-271.05 4520.87,-271.05"/>
</g>
<!-- hier_reduce_0_24&#45;&gt;l0_ffn_ln_6 -->
<g id="edge352" class="edge">
<title>hier_reduce_0_24&#45;&gt;l0_ffn_ln_6</title>
<path fill="none" stroke="black" d="M185815.17,-318.01C185815.17,-331.41 185815.17,-385 185815.17,-385 185815.17,-385 2269.16,-385 2269.16,-385 2269.16,-385 2269.16,-271.27 2269.16,-271.27"/>
<polygon fill="black" stroke="black" points="2272.66,-271.27 2269.16,-261.27 2265.66,-271.27 2272.66,-271.27"/>
</g>
<!-- hier_reduce_0_24&#45;&gt;l0_ffn_ln_7 -->
<g id="edge358" class="edge">
<title>hier_reduce_0_24&#45;&gt;l0_ffn_ln_7</title>
<path fill="none" stroke="black" d="M185763.2,-316.15C185763.2,-324.91 185763.2,-381 185763.2,-381 185763.2,-381 7929.16,-381 7929.16,-381 7929.16,-381 7929.16,-271.04 7929.16,-271.04"/>
<polygon fill="black" stroke="black" points="7932.66,-271.04 7929.16,-261.04 7925.66,-271.04 7932.66,-271.04"/>
</g>
<!-- hier_reduce_1_8&#45;&gt;l1_ffn_ln_0 -->
<g id="edge437" class="edge">
<title>hier_reduce_1_8&#45;&gt;l1_ffn_ln_0</title>
<path fill="none" stroke="black" d="M90821.37,-299C90594.86,-299 89789.5,-299 89789.5,-299 89789.5,-299 89789.5,-229 89789.5,-229 89789.5,-229 24289.53,-229 24289.53,-229"/>
<polygon fill="black" stroke="black" points="24289.53,-225.5 24279.53,-229 24289.53,-232.5 24289.53,-225.5"/>
</g>
<!-- hier_reduce_1_8&#45;&gt;l1_ffn_ln_1 -->
<g id="edge443" class="edge">
<title>hier_reduce_1_8&#45;&gt;l1_ffn_ln_1</title>
<path fill="none" stroke="black" d="M90763.26,-301C90475.81,-301 89757,-301 89757,-301 89757,-301 89757,-277 89757,-277 89757,-277 23094.75,-277 23094.75,-277 23094.75,-277 23094.75,-271.19 23094.75,-271.19"/>
<polygon fill="black" stroke="black" points="23098.25,-271.19 23094.75,-261.19 23091.25,-271.19 23098.25,-271.19"/>
</g>
<!-- hier_reduce_1_8&#45;&gt;l1_ffn_ln_2 -->
<g id="edge449" class="edge">
<title>hier_reduce_1_8&#45;&gt;l1_ffn_ln_2</title>
<path fill="none" stroke="black" d="M90704.82,-303C90381.68,-303 89724.5,-303 89724.5,-303 89724.5,-303 89724.5,-278 89724.5,-278 89724.5,-278 21962.75,-278 21962.75,-278 21962.75,-278 21962.75,-271.32 21962.75,-271.32"/>
<polygon fill="black" stroke="black" points="21966.25,-271.32 21962.75,-261.32 21959.25,-271.32 21966.25,-271.32"/>
</g>
<!-- hier_reduce_1_8&#45;&gt;l1_ffn_ln_3 -->
<g id="edge455" class="edge">
<title>hier_reduce_1_8&#45;&gt;l1_ffn_ln_3</title>
<path fill="none" stroke="black" d="M90520.35,-320.8C90520.35,-328.18 90520.35,-340 90520.35,-340 90520.35,-340 20011.75,-340 20011.75,-340 20011.75,-340 20011.75,-250 20011.75,-250 20011.75,-250 19741.72,-250 19741.72,-250"/>
<polygon fill="black" stroke="black" points="19741.72,-246.5 19731.72,-250 19741.72,-253.5 19741.72,-246.5"/>
</g>
<!-- hier_reduce_1_8&#45;&gt;l1_ffn_ln_4 -->
<g id="edge461" class="edge">
<title>hier_reduce_1_8&#45;&gt;l1_ffn_ln_4</title>
<path fill="none" stroke="black" d="M90646.35,-305C90300.31,-305 89692,-305 89692,-305 89692,-305 89692,-279 89692,-279 89692,-279 20825.95,-279 20825.95,-279 20825.95,-279 20825.95,-271.42 20825.95,-271.42"/>
<polygon fill="black" stroke="black" points="20829.45,-271.42 20825.95,-261.42 20822.45,-271.42 20829.45,-271.42"/>
</g>
<!-- hier_reduce_1_8&#45;&gt;l1_ffn_ln_5 -->
<g id="edge467" class="edge">
<title>hier_reduce_1_8&#45;&gt;l1_ffn_ln_5</title>
<path fill="none" stroke="black" d="M90588.05,-307C90226.99,-307 89659.5,-307 89659.5,-307 89659.5,-307 89659.5,-279 89659.5,-279 89659.5,-279 18561.95,-279 18561.95,-279 18561.95,-279 18561.95,-271.42 18561.95,-271.42"/>
<polygon fill="black" stroke="black" points="18565.45,-271.42 18561.95,-261.42 18558.45,-271.42 18565.45,-271.42"/>
</g>
<!-- hier_reduce_1_8&#45;&gt;l1_ffn_ln_6 -->
<g id="edge473" class="edge">
<title>hier_reduce_1_8&#45;&gt;l1_ffn_ln_6</title>
<path fill="none" stroke="black" d="M90471.42,-311C90277.85,-311 90088.35,-311 90088.35,-311 90088.35,-311 90088.35,-205 90088.35,-205 90088.35,-205 17065.5,-205 17065.5,-205 17065.5,-205 17065.5,-214.89 17065.5,-214.89"/>
<polygon fill="black" stroke="black" points="17062,-214.89 17065.5,-224.89 17069,-214.89 17062,-214.89"/>
</g>
<!-- hier_reduce_1_8&#45;&gt;l1_ffn_ln_7 -->
<g id="edge479" class="edge">
<title>hier_reduce_1_8&#45;&gt;l1_ffn_ln_7</title>
<path fill="none" stroke="black" d="M90529.55,-309C90372.3,-309 90221.52,-309 90221.52,-309 90221.52,-309 90221.52,-204 90221.52,-204 90221.52,-204 15933.5,-204 15933.5,-204 15933.5,-204 15933.5,-214.87 15933.5,-214.87"/>
<polygon fill="black" stroke="black" points="15930,-214.87 15933.5,-224.87 15937,-214.87 15930,-214.87"/>
</g>
<!-- hier_reduce_1_16&#45;&gt;l1_ffn_ln_0 -->
<g id="edge533" class="edge">
<title>hier_reduce_1_16&#45;&gt;l1_ffn_ln_0</title>
<path fill="none" stroke="black" d="M78937.4,-320C78757.03,-320 78580.79,-320 78580.79,-320 78580.79,-320 78580.79,-232 78580.79,-232 78580.79,-232 24289.9,-232 24289.9,-232"/>
<polygon fill="black" stroke="black" points="24289.9,-228.5 24279.9,-232 24289.9,-235.5 24289.9,-228.5"/>
</g>
<!-- hier_reduce_1_16&#45;&gt;l1_ffn_ln_1 -->
<g id="edge539" class="edge">
<title>hier_reduce_1_16&#45;&gt;l1_ffn_ln_1</title>
<path fill="none" stroke="black" d="M78996.35,-322C78781.52,-322 78538.84,-322 78538.84,-322 78538.84,-322 78538.84,-280 78538.84,-280 78538.84,-280 23042,-280 23042,-280 23042,-280 23042,-271.07 23042,-271.07"/>
<polygon fill="black" stroke="black" points="23045.5,-271.07 23042,-261.07 23038.5,-271.07 23045.5,-271.07"/>
</g>
<!-- hier_reduce_1_16&#45;&gt;l1_ffn_ln_2 -->
<g id="edge545" class="edge">
<title>hier_reduce_1_16&#45;&gt;l1_ffn_ln_2</title>
<path fill="none" stroke="black" d="M79025.75,-323C78789.46,-323 78496.9,-323 78496.9,-323 78496.9,-323 78496.9,-281 78496.9,-281 78496.9,-281 21910,-281 21910,-281 21910,-281 21910,-271.11 21910,-271.11"/>
<polygon fill="black" stroke="black" points="21913.5,-271.11 21910,-261.11 21906.5,-271.11 21913.5,-271.11"/>
</g>
<!-- hier_reduce_1_16&#45;&gt;l1_ffn_ln_3 -->
<g id="edge551" class="edge">
<title>hier_reduce_1_16&#45;&gt;l1_ffn_ln_3</title>
<path fill="none" stroke="black" d="M79084.48,-325C78828.33,-325 78454.95,-325 78454.95,-325 78454.95,-325 78454.95,-281 78454.95,-281 78454.95,-281 19673.95,-281 19673.95,-281 19673.95,-281 19673.95,-271.11 19673.95,-271.11"/>
<polygon fill="black" stroke="black" points="19677.45,-271.11 19673.95,-261.11 19670.45,-271.11 19677.45,-271.11"/>
</g>
<!-- hier_reduce_1_16&#45;&gt;l1_ffn_ln_4 -->
<g id="edge557" class="edge">
<title>hier_reduce_1_16&#45;&gt;l1_ffn_ln_4</title>
<path fill="none" stroke="black" d="M79261.15,-331C79093.05,-331 78622.74,-331 78622.74,-331 78622.74,-331 78622.74,-213 78622.74,-213 78622.74,-213 20567,-213 20567,-213 20567,-213 20567,-214.86 20567,-214.86"/>
<polygon fill="black" stroke="black" points="20563.5,-214.86 20567,-224.86 20570.5,-214.86 20563.5,-214.86"/>
</g>
<!-- hier_reduce_1_16&#45;&gt;l1_ffn_ln_5 -->
<g id="edge563" class="edge">
<title>hier_reduce_1_16&#45;&gt;l1_ffn_ln_5</title>
<path fill="none" stroke="black" d="M79202.09,-329C79013.42,-329 78664.69,-329 78664.69,-329 78664.69,-329 78664.69,-212 78664.69,-212 78664.69,-212 18408.5,-212 18408.5,-212 18408.5,-212 18408.5,-214.97 18408.5,-214.97"/>
<polygon fill="black" stroke="black" points="18405,-214.97 18408.5,-224.97 18412,-214.97 18405,-214.97"/>
</g>
<!-- hier_reduce_1_16&#45;&gt;l1_ffn_ln_6 -->
<g id="edge569" class="edge">
<title>hier_reduce_1_16&#45;&gt;l1_ffn_ln_6</title>
<path fill="none" stroke="black" d="M79172.69,-328C78991.22,-328 78706.64,-328 78706.64,-328 78706.64,-328 78706.64,-208 78706.64,-208 78706.64,-208 17276.5,-208 17276.5,-208 17276.5,-208 17276.5,-214.68 17276.5,-214.68"/>
<polygon fill="black" stroke="black" points="17273,-214.68 17276.5,-224.68 17280,-214.68 17273,-214.68"/>
</g>
<!-- hier_reduce_1_16&#45;&gt;l1_ffn_ln_7 -->
<g id="edge575" class="edge">
<title>hier_reduce_1_16&#45;&gt;l1_ffn_ln_7</title>
<path fill="none" stroke="black" d="M79113.71,-326C78950.03,-326 78748.58,-326 78748.58,-326 78748.58,-326 78748.58,-207 78748.58,-207 78748.58,-207 16144.5,-207 16144.5,-207 16144.5,-207 16144.5,-214.58 16144.5,-214.58"/>
<polygon fill="black" stroke="black" points="16141,-214.58 16144.5,-224.58 16148,-214.58 16141,-214.58"/>
</g>
<!-- hier_reduce_1_24&#45;&gt;l1_ffn_ln_0 -->
<g id="edge653" class="edge">
<title>hier_reduce_1_24&#45;&gt;l1_ffn_ln_0</title>
<path fill="none" stroke="black" d="M211240.71,-321C210353.37,-321 208101.5,-321 208101.5,-321 208101.5,-321 208101.5,-227 208101.5,-227 208101.5,-227 24289.72,-227 24289.72,-227"/>
<polygon fill="black" stroke="black" points="24289.72,-223.5 24279.72,-227 24289.72,-230.5 24289.72,-223.5"/>
</g>
<!-- hier_reduce_1_24&#45;&gt;l1_ffn_ln_1 -->
<g id="edge659" class="edge">
<title>hier_reduce_1_24&#45;&gt;l1_ffn_ln_1</title>
<path fill="none" stroke="black" d="M211068.34,-315.46C211068.34,-324.84 211068.34,-475 211068.34,-475 211068.34,-475 23384.3,-475 23384.3,-475 23384.3,-475 23384.3,-255 23384.3,-255 23384.3,-255 23157.64,-255 23157.64,-255"/>
<polygon fill="black" stroke="black" points="23157.64,-251.5 23147.64,-255 23157.64,-258.5 23157.64,-251.5"/>
</g>
<!-- hier_reduce_1_24&#45;&gt;l1_ffn_ln_2 -->
<g id="edge665" class="edge">
<title>hier_reduce_1_24&#45;&gt;l1_ffn_ln_2</title>
<path fill="none" stroke="black" d="M211070.25,-315.46C211070.25,-324.97 211070.25,-477 211070.25,-477 211070.25,-477 22277.7,-477 22277.7,-477 22277.7,-477 22277.7,-255 22277.7,-255 22277.7,-255 22025.86,-255 22025.86,-255"/>
<polygon fill="black" stroke="black" points="22025.86,-251.5 22015.86,-255 22025.86,-258.5 22025.86,-251.5"/>
</g>
<!-- hier_reduce_1_24&#45;&gt;l1_ffn_ln_3 -->
<g id="edge671" class="edge">
<title>hier_reduce_1_24&#45;&gt;l1_ffn_ln_3</title>
<path fill="none" stroke="black" d="M211072.15,-315.29C211072.15,-318.15 211072.15,-341 211072.15,-341 211072.15,-341 20003.45,-341 20003.45,-341 20003.45,-341 20003.45,-255 20003.45,-255 20003.45,-255 19741.62,-255 19741.62,-255"/>
<polygon fill="black" stroke="black" points="19741.62,-251.5 19731.62,-255 19741.62,-258.5 19741.62,-251.5"/>
</g>
<!-- hier_reduce_1_24&#45;&gt;l1_ffn_ln_4 -->
<g id="edge677" class="edge">
<title>hier_reduce_1_24&#45;&gt;l1_ffn_ln_4</title>
<path fill="none" stroke="black" d="M211074.06,-315.47C211074.06,-325.09 211074.06,-479 211074.06,-479 211074.06,-479 21120.3,-479 21120.3,-479 21120.3,-479 21120.3,-255 21120.3,-255 21120.3,-255 20893.64,-255 20893.64,-255"/>
<polygon fill="black" stroke="black" points="20893.64,-251.5 20883.64,-255 20893.64,-258.5 20893.64,-251.5"/>
</g>
<!-- hier_reduce_1_24&#45;&gt;l1_ffn_ln_5 -->
<g id="edge683" class="edge">
<title>hier_reduce_1_24&#45;&gt;l1_ffn_ln_5</title>
<path fill="none" stroke="black" d="M211182.08,-319C210918.61,-319 210626,-319 210626,-319 210626,-319 210626,-210 210626,-210 210626,-210 18197.5,-210 18197.5,-210 18197.5,-210 18197.5,-214.96 18197.5,-214.96"/>
<polygon fill="black" stroke="black" points="18194,-214.96 18197.5,-224.96 18201,-214.96 18194,-214.96"/>
</g>
<!-- hier_reduce_1_24&#45;&gt;l1_ffn_ln_6 -->
<g id="edge689" class="edge">
<title>hier_reduce_1_24&#45;&gt;l1_ffn_ln_6</title>
<path fill="none" stroke="black" d="M211075.97,-315.48C211075.97,-325.21 211075.97,-481 211075.97,-481 211075.97,-481 17724.3,-481 17724.3,-481 17724.3,-481 17724.3,-255 17724.3,-255 17724.3,-255 17497.64,-255 17497.64,-255"/>
<polygon fill="black" stroke="black" points="17497.64,-251.5 17487.64,-255 17497.64,-258.5 17497.64,-251.5"/>
</g>
<!-- hier_reduce_1_24&#45;&gt;l1_ffn_ln_7 -->
<g id="edge695" class="edge">
<title>hier_reduce_1_24&#45;&gt;l1_ffn_ln_7</title>
<path fill="none" stroke="black" d="M211121.19,-317.12C211121.19,-336.57 211121.19,-483 211121.19,-483 211121.19,-483 16592.3,-483 16592.3,-483 16592.3,-483 16592.3,-255 16592.3,-255 16592.3,-255 16365.64,-255 16365.64,-255"/>
<polygon fill="black" stroke="black" points="16365.64,-251.5 16355.64,-255 16365.64,-258.5 16365.64,-251.5"/>
</g>
<!-- hier_reduce_2_8&#45;&gt;l2_ffn_ln_0 -->
<g id="edge774" class="edge">
<title>hier_reduce_2_8&#45;&gt;l2_ffn_ln_0</title>
<path fill="none" stroke="black" d="M125772.66,-327.34C125772.66,-338.77 125772.66,-354 125772.66,-354 125772.66,-354 298172.42,-354 298172.42,-354 298172.42,-354 298172.42,-271.33 298172.42,-271.33"/>
<polygon fill="black" stroke="black" points="298175.92,-271.33 298172.42,-261.33 298168.92,-271.33 298175.92,-271.33"/>
</g>
<!-- hier_reduce_2_8&#45;&gt;l2_ffn_ln_1 -->
<g id="edge780" class="edge">
<title>hier_reduce_2_8&#45;&gt;l2_ffn_ln_1</title>
<path fill="none" stroke="black" d="M125862.32,-324.34C125862.32,-335.3 125862.32,-352 125862.32,-352 125862.32,-352 297037.87,-352 297037.87,-352 297037.87,-352 297037.87,-231 297037.87,-231 297037.87,-231 297143.39,-231 297143.39,-231"/>
<polygon fill="black" stroke="black" points="297143.39,-234.5 297153.39,-231 297143.39,-227.5 297143.39,-234.5"/>
</g>
<!-- hier_reduce_2_8&#45;&gt;l2_ffn_ln_2 -->
<g id="edge786" class="edge">
<title>hier_reduce_2_8&#45;&gt;l2_ffn_ln_2</title>
<path fill="none" stroke="black" d="M126041.64,-318.42C126041.64,-326.68 126041.64,-347 126041.64,-347 126041.64,-347 294758.84,-347 294758.84,-347 294758.84,-347 294758.84,-255 294758.84,-255 294758.84,-255 295006.11,-255 295006.11,-255"/>
<polygon fill="black" stroke="black" points="295006.11,-258.5 295016.11,-255 295006.11,-251.5 295006.11,-258.5"/>
</g>
<!-- hier_reduce_2_8&#45;&gt;l2_ffn_ln_3 -->
<g id="edge792" class="edge">
<title>hier_reduce_2_8&#45;&gt;l2_ffn_ln_3</title>
<path fill="none" stroke="black" d="M125951.98,-321.42C125951.98,-331.52 125951.98,-350 125951.98,-350 125951.98,-350 295890.84,-350 295890.84,-350 295890.84,-350 295890.84,-255 295890.84,-255 295890.84,-255 296138.11,-255 296138.11,-255"/>
<polygon fill="black" stroke="black" points="296138.11,-258.5 296148.11,-255 296138.11,-251.5 296138.11,-258.5"/>
</g>
<!-- hier_reduce_2_8&#45;&gt;l2_ffn_ln_4 -->
<g id="edge798" class="edge">
<title>hier_reduce_2_8&#45;&gt;l2_ffn_ln_4</title>
<path fill="none" stroke="black" d="M126131.31,-315C126274.58,-315 126391.1,-315 126391.1,-315 126391.1,-315 126391.1,-289 126391.1,-289 126391.1,-289 293999.59,-289 293999.59,-289 293999.59,-289 293999.59,-271.18 293999.59,-271.18"/>
<polygon fill="black" stroke="black" points="294003.09,-271.18 293999.59,-261.18 293996.09,-271.18 294003.09,-271.18"/>
</g>
<!-- hier_reduce_2_8&#45;&gt;l2_ffn_ln_5 -->
<g id="edge804" class="edge">
<title>hier_reduce_2_8&#45;&gt;l2_ffn_ln_5</title>
<path fill="none" stroke="black" d="M125956.17,-321C126083.28,-321 126196.25,-321 126196.25,-321 126196.25,-321 126196.25,-237 126196.25,-237 126196.25,-237 290478.29,-237 290478.29,-237"/>
<polygon fill="black" stroke="black" points="290478.29,-240.5 290488.29,-237 290478.29,-233.5 290478.29,-240.5"/>
</g>
<!-- hier_reduce_2_8&#45;&gt;l2_ffn_ln_6 -->
<g id="edge810" class="edge">
<title>hier_reduce_2_8&#45;&gt;l2_ffn_ln_6</title>
<path fill="none" stroke="black" d="M125781.15,-303C125975.24,-303 126261.2,-303 126261.2,-303 126261.2,-303 126261.2,-286 126261.2,-286 126261.2,-286 291735.59,-286 291735.59,-286 291735.59,-286 291735.59,-271.49 291735.59,-271.49"/>
<polygon fill="black" stroke="black" points="291739.09,-271.49 291735.59,-261.49 291732.09,-271.49 291739.09,-271.49"/>
</g>
<!-- hier_reduce_2_8&#45;&gt;l2_ffn_ln_7 -->
<g id="edge816" class="edge">
<title>hier_reduce_2_8&#45;&gt;l2_ffn_ln_7</title>
<path fill="none" stroke="black" d="M125956.32,-309C126139.55,-309 126326.15,-309 126326.15,-309 126326.15,-309 126326.15,-287 126326.15,-287 126326.15,-287 292867.59,-287 292867.59,-287 292867.59,-287 292867.59,-271.15 292867.59,-271.15"/>
<polygon fill="black" stroke="black" points="292871.09,-271.15 292867.59,-261.15 292864.09,-271.15 292871.09,-271.15"/>
</g>
<!-- hier_reduce_2_16&#45;&gt;l2_ffn_ln_0 -->
<g id="edge870" class="edge">
<title>hier_reduce_2_16&#45;&gt;l2_ffn_ln_0</title>
<path fill="none" stroke="black" d="M37529.64,-320.7C37529.64,-331.97 37529.64,-356 37529.64,-356 37529.64,-356 298176.65,-356 298176.65,-356 298176.65,-356 298176.65,-271.16 298176.65,-271.16"/>
<polygon fill="black" stroke="black" points="298180.15,-271.16 298176.65,-261.16 298173.15,-271.16 298180.15,-271.16"/>
</g>
<!-- hier_reduce_2_16&#45;&gt;l2_ffn_ln_1 -->
<g id="edge876" class="edge">
<title>hier_reduce_2_16&#45;&gt;l2_ffn_ln_1</title>
<path fill="none" stroke="black" d="M37277.04,-329C37514.52,-329 38027.56,-329 38027.56,-329 38027.56,-329 38027.56,-291 38027.56,-291 38027.56,-291 297216.8,-291 297216.8,-291 297216.8,-291 297216.8,-271.15 297216.8,-271.15"/>
<polygon fill="black" stroke="black" points="297220.3,-271.15 297216.8,-261.15 297213.3,-271.15 297220.3,-271.15"/>
</g>
<!-- hier_reduce_2_16&#45;&gt;l2_ffn_ln_2 -->
<g id="edge882" class="edge">
<title>hier_reduce_2_16&#45;&gt;l2_ffn_ln_2</title>
<path fill="none" stroke="black" d="M37365.03,-326C37593.63,-326 37930.68,-326 37930.68,-326 37930.68,-326 37930.68,-289 37930.68,-289 37930.68,-289 295079.8,-289 295079.8,-289 295079.8,-289 295079.8,-271.18 295079.8,-271.18"/>
<polygon fill="black" stroke="black" points="295083.3,-271.18 295079.8,-261.18 295076.3,-271.18 295083.3,-271.18"/>
</g>
<!-- hier_reduce_2_16&#45;&gt;l2_ffn_ln_3 -->
<g id="edge888" class="edge">
<title>hier_reduce_2_16&#45;&gt;l2_ffn_ln_3</title>
<path fill="none" stroke="black" d="M37306.09,-328C37542.1,-328 37979.12,-328 37979.12,-328 37979.12,-328 37979.12,-290 37979.12,-290 37979.12,-290 296263.59,-290 296263.59,-290 296263.59,-290 296263.59,-271.04 296263.59,-271.04"/>
<polygon fill="black" stroke="black" points="296267.09,-271.04 296263.59,-261.04 296260.09,-271.04 296267.09,-271.04"/>
</g>
<!-- hier_reduce_2_16&#45;&gt;l2_ffn_ln_4 -->
<g id="edge894" class="edge">
<title>hier_reduce_2_16&#45;&gt;l2_ffn_ln_4</title>
<path fill="none" stroke="black" d="M37423.94,-324C37630.4,-324 37882.23,-324 37882.23,-324 37882.23,-324 37882.23,-288 37882.23,-288 37882.23,-288 293942.05,-288 293942.05,-288 293942.05,-288 293942.05,-271.04 293942.05,-271.04"/>
<polygon fill="black" stroke="black" points="293945.55,-271.04 293942.05,-261.04 293938.55,-271.04 293945.55,-271.04"/>
</g>
<!-- hier_reduce_2_16&#45;&gt;l2_ffn_ln_5 -->
<g id="edge900" class="edge">
<title>hier_reduce_2_16&#45;&gt;l2_ffn_ln_5</title>
<path fill="none" stroke="black" d="M37217.86,-331C37364.97,-331 37736.91,-331 37736.91,-331 37736.91,-331 37736.91,-234 37736.91,-234 37736.91,-234 290478.2,-234 290478.2,-234"/>
<polygon fill="black" stroke="black" points="290478.2,-237.5 290488.2,-234 290478.2,-230.5 290478.2,-237.5"/>
</g>
<!-- hier_reduce_2_16&#45;&gt;l2_ffn_ln_6 -->
<g id="edge906" class="edge">
<title>hier_reduce_2_16&#45;&gt;l2_ffn_ln_6</title>
<path fill="none" stroke="black" d="M37511.99,-321C37654.24,-321 37785.35,-321 37785.35,-321 37785.35,-321 37785.35,-285 37785.35,-285 37785.35,-285 291678.05,-285 291678.05,-285 291678.05,-285 291678.05,-271.06 291678.05,-271.06"/>
<polygon fill="black" stroke="black" points="291681.55,-271.06 291678.05,-261.06 291674.55,-271.06 291681.55,-271.06"/>
</g>
<!-- hier_reduce_2_16&#45;&gt;l2_ffn_ln_7 -->
<g id="edge912" class="edge">
<title>hier_reduce_2_16&#45;&gt;l2_ffn_ln_7</title>
<path fill="none" stroke="black" d="M37453.5,-323C37635.21,-323 37833.79,-323 37833.79,-323 37833.79,-323 37833.79,-286 37833.79,-286 37833.79,-286 292810.05,-286 292810.05,-286 292810.05,-286 292810.05,-271.49 292810.05,-271.49"/>
<polygon fill="black" stroke="black" points="292813.55,-271.49 292810.05,-261.49 292806.55,-271.49 292813.55,-271.49"/>
</g>
<!-- hier_reduce_2_24&#45;&gt;l2_ffn_ln_0 -->
<g id="edge990" class="edge">
<title>hier_reduce_2_24&#45;&gt;l2_ffn_ln_0</title>
<path fill="none" stroke="black" d="M144444.81,-317.98C144444.81,-326.94 144444.81,-353 144444.81,-353 144444.81,-353 298168.18,-353 298168.18,-353 298168.18,-353 298168.18,-271.16 298168.18,-271.16"/>
<polygon fill="black" stroke="black" points="298171.68,-271.16 298168.18,-261.16 298164.68,-271.16 298171.68,-271.16"/>
</g>
<!-- hier_reduce_2_24&#45;&gt;l2_ffn_ln_1 -->
<g id="edge996" class="edge">
<title>hier_reduce_2_24&#45;&gt;l2_ffn_ln_1</title>
<path fill="none" stroke="black" d="M144454.71,-317.82C144454.71,-326.31 144454.71,-351 144454.71,-351 144454.71,-351 297031.44,-351 297031.44,-351 297031.44,-351 297031.44,-228 297031.44,-228 297031.44,-228 297143.31,-228 297143.31,-228"/>
<polygon fill="black" stroke="black" points="297143.31,-231.5 297153.31,-228 297143.31,-224.5 297143.31,-231.5"/>
</g>
<!-- hier_reduce_2_24&#45;&gt;l2_ffn_ln_2 -->
<g id="edge1002" class="edge">
<title>hier_reduce_2_24&#45;&gt;l2_ffn_ln_2</title>
<path fill="none" stroke="black" d="M144474.52,-317.03C144474.52,-323.93 144474.52,-346 144474.52,-346 144474.52,-346 294753.39,-346 294753.39,-346 294753.39,-346 294753.39,-250 294753.39,-250 294753.39,-250 295006.49,-250 295006.49,-250"/>
<polygon fill="black" stroke="black" points="295006.49,-253.5 295016.49,-250 295006.49,-246.5 295006.49,-253.5"/>
</g>
<!-- hier_reduce_2_24&#45;&gt;l2_ffn_ln_3 -->
<g id="edge1008" class="edge">
<title>hier_reduce_2_24&#45;&gt;l2_ffn_ln_3</title>
<path fill="none" stroke="black" d="M144464.61,-317.17C144464.61,-324.51 144464.61,-348 144464.61,-348 144464.61,-348 295885.39,-348 295885.39,-348 295885.39,-348 295885.39,-250 295885.39,-250 295885.39,-250 296138.49,-250 296138.49,-250"/>
<polygon fill="black" stroke="black" points="296138.49,-253.5 296148.49,-250 296138.49,-246.5 296138.49,-253.5"/>
</g>
<!-- hier_reduce_2_24&#45;&gt;l2_ffn_ln_4 -->
<g id="edge1014" class="edge">
<title>hier_reduce_2_24&#45;&gt;l2_ffn_ln_4</title>
<path fill="none" stroke="black" d="M144484.42,-316.61C144484.42,-322.84 144484.42,-345 144484.42,-345 144484.42,-345 293622.3,-345 293622.3,-345 293622.3,-345 293622.3,-255 293622.3,-255 293622.3,-255 293874.14,-255 293874.14,-255"/>
<polygon fill="black" stroke="black" points="293874.14,-258.5 293884.14,-255 293874.14,-251.5 293874.14,-258.5"/>
</g>
<!-- hier_reduce_2_24&#45;&gt;l2_ffn_ln_5 -->
<g id="edge1020" class="edge">
<title>hier_reduce_2_24&#45;&gt;l2_ffn_ln_5</title>
<path fill="none" stroke="black" d="M144321.89,-322C144752.96,-322 145461.5,-322 145461.5,-322 145461.5,-322 145461.5,-239 145461.5,-239 145461.5,-239 290478.46,-239 290478.46,-239"/>
<polygon fill="black" stroke="black" points="290478.46,-242.5 290488.46,-239 290478.46,-235.5 290478.46,-242.5"/>
</g>
<!-- hier_reduce_2_24&#45;&gt;l2_ffn_ln_6 -->
<g id="edge1026" class="edge">
<title>hier_reduce_2_24&#45;&gt;l2_ffn_ln_6</title>
<path fill="none" stroke="black" d="M144504.23,-316.16C144504.23,-321.33 144504.23,-342 144504.23,-342 144504.23,-342 291358.3,-342 291358.3,-342 291358.3,-342 291358.3,-255 291358.3,-255 291358.3,-255 291610.14,-255 291610.14,-255"/>
<polygon fill="black" stroke="black" points="291610.14,-258.5 291620.14,-255 291610.14,-251.5 291610.14,-258.5"/>
</g>
<!-- hier_reduce_2_24&#45;&gt;l2_ffn_ln_7 -->
<g id="edge1032" class="edge">
<title>hier_reduce_2_24&#45;&gt;l2_ffn_ln_7</title>
<path fill="none" stroke="black" d="M144494.32,-316.2C144494.32,-321.56 144494.32,-343 144494.32,-343 144494.32,-343 292490.3,-343 292490.3,-343 292490.3,-343 292490.3,-255 292490.3,-255 292490.3,-255 292742.14,-255 292742.14,-255"/>
<polygon fill="black" stroke="black" points="292742.14,-258.5 292752.14,-255 292742.14,-251.5 292742.14,-258.5"/>
</g>
<!-- hier_reduce_3_8&#45;&gt;l3_ffn_ln_0 -->
<g id="edge1111" class="edge">
<title>hier_reduce_3_8&#45;&gt;l3_ffn_ln_0</title>
<path fill="none" stroke="black" d="M134653.88,-301C134821.75,-301 135111.15,-301 135111.15,-301 135111.15,-301 135111.15,-294 135111.15,-294 135111.15,-294 301929.59,-294 301929.59,-294 301929.59,-294 301929.59,-271.12 301929.59,-271.12"/>
<polygon fill="black" stroke="black" points="301933.09,-271.12 301929.59,-261.12 301926.09,-271.12 301933.09,-271.12"/>
</g>
<!-- hier_reduce_3_8&#45;&gt;l3_ffn_ln_1 -->
<g id="edge1117" class="edge">
<title>hier_reduce_3_8&#45;&gt;l3_ffn_ln_1</title>
<path fill="none" stroke="black" d="M134829.01,-307C134983.04,-307 135140.46,-307 135140.46,-307 135140.46,-307 135140.46,-296 135140.46,-296 135140.46,-296 307077.22,-296 307077.22,-296 307077.22,-296 307077.22,-271.24 307077.22,-271.24"/>
<polygon fill="black" stroke="black" points="307080.72,-271.24 307077.22,-261.24 307073.72,-271.24 307080.72,-271.24"/>
</g>
<!-- hier_reduce_3_8&#45;&gt;l3_ffn_ln_2 -->
<g id="edge1123" class="edge">
<title>hier_reduce_3_8&#45;&gt;l3_ffn_ln_2</title>
<path fill="none" stroke="black" d="M134770.79,-305C134936.93,-305 135130.69,-305 135130.69,-305 135130.69,-305 135130.69,-295 135130.69,-295 135130.69,-295 305967.72,-295 305967.72,-295 305967.72,-295 305967.72,-271.19 305967.72,-271.19"/>
<polygon fill="black" stroke="black" points="305971.22,-271.19 305967.72,-261.19 305964.22,-271.19 305971.22,-271.19"/>
</g>
<!-- hier_reduce_3_8&#45;&gt;l3_ffn_ln_3 -->
<g id="edge1129" class="edge">
<title>hier_reduce_3_8&#45;&gt;l3_ffn_ln_3</title>
<path fill="none" stroke="black" d="M135004.04,-313C135056.54,-313 135091.61,-313 135091.61,-313 135091.61,-313 135091.61,-221 135091.61,-221 135091.61,-221 300787.25,-221 300787.25,-221 300787.25,-221 300787.25,-221.38 300787.25,-221.38"/>
<polygon fill="black" stroke="black" points="300783.75,-214.83 300787.25,-224.83 300790.75,-214.83 300783.75,-214.83"/>
</g>
<!-- hier_reduce_3_8&#45;&gt;l3_ffn_ln_4 -->
<g id="edge1135" class="edge">
<title>hier_reduce_3_8&#45;&gt;l3_ffn_ln_4</title>
<path fill="none" stroke="black" d="M134712.2,-303C134884.19,-303 135120.92,-303 135120.92,-303 135120.92,-303 135120.92,-294 135120.92,-294 135120.92,-294 303703.72,-294 303703.72,-294 303703.72,-294 303703.72,-271.12 303703.72,-271.12"/>
<polygon fill="black" stroke="black" points="303707.22,-271.12 303703.72,-261.12 303700.22,-271.12 303707.22,-271.12"/>
</g>
<!-- hier_reduce_3_8&#45;&gt;l3_ffn_ln_5 -->
<g id="edge1141" class="edge">
<title>hier_reduce_3_8&#45;&gt;l3_ffn_ln_5</title>
<path fill="none" stroke="black" d="M134595.54,-299C134739.91,-299 135101.38,-299 135101.38,-299 135101.38,-299 135101.38,-292 135101.38,-292 135101.38,-292 299665.59,-292 299665.59,-292 299665.59,-292 299665.59,-271.25 299665.59,-271.25"/>
<polygon fill="black" stroke="black" points="299669.09,-271.25 299665.59,-261.25 299662.09,-271.25 299669.09,-271.25"/>
</g>
<!-- hier_reduce_3_8&#45;&gt;l3_ffn_ln_6 -->
<g id="edge1147" class="edge">
<title>hier_reduce_3_8&#45;&gt;l3_ffn_ln_6</title>
<path fill="none" stroke="black" d="M134945.76,-311C135023.88,-311 135081.84,-311 135081.84,-311 135081.84,-311 135081.84,-218 135081.84,-218 135081.84,-218 302953.7,-218 302953.7,-218 302953.7,-218 302953.7,-218.68 302953.7,-218.68"/>
<polygon fill="black" stroke="black" points="302950.2,-214.83 302953.7,-224.83 302957.2,-214.83 302950.2,-214.83"/>
</g>
<!-- hier_reduce_3_8&#45;&gt;l3_ffn_ln_7 -->
<g id="edge1153" class="edge">
<title>hier_reduce_3_8&#45;&gt;l3_ffn_ln_7</title>
<path fill="none" stroke="black" d="M134887.18,-309C134988.37,-309 135072.07,-309 135072.07,-309 135072.07,-309 135072.07,-216 135072.07,-216 135072.07,-216 305305.83,-216 305305.83,-216 305305.83,-216 305305.83,-216.88 305305.83,-216.88"/>
<polygon fill="black" stroke="black" points="305302.33,-214.84 305305.83,-224.84 305309.33,-214.84 305302.33,-214.84"/>
</g>
<!-- hier_reduce_3_16&#45;&gt;l3_ffn_ln_0 -->
<g id="edge1207" class="edge">
<title>hier_reduce_3_16&#45;&gt;l3_ffn_ln_0</title>
<path fill="none" stroke="black" d="M54283.85,-324C54523.5,-324 54839.12,-324 54839.12,-324 54839.12,-324 54839.12,-293 54839.12,-293 54839.12,-293 301872.05,-293 301872.05,-293 301872.05,-293 301872.05,-271.05 301872.05,-271.05"/>
<polygon fill="black" stroke="black" points="301875.55,-271.05 301872.05,-261.05 301868.55,-271.05 301875.55,-271.05"/>
</g>
<!-- hier_reduce_3_16&#45;&gt;l3_ffn_ln_1 -->
<g id="edge1213" class="edge">
<title>hier_reduce_3_16&#45;&gt;l3_ffn_ln_1</title>
<path fill="none" stroke="black" d="M54262.59,-325.03C54262.59,-340.14 54262.59,-367 54262.59,-367 54262.59,-367 307235.47,-367 307235.47,-367 307235.47,-367 307235.47,-271.03 307235.47,-271.03"/>
<polygon fill="black" stroke="black" points="307238.97,-271.03 307235.47,-261.03 307231.97,-271.03 307238.97,-271.03"/>
</g>
<!-- hier_reduce_3_16&#45;&gt;l3_ffn_ln_2 -->
<g id="edge1219" class="edge">
<title>hier_reduce_3_16&#45;&gt;l3_ffn_ln_2</title>
<path fill="none" stroke="black" d="M54357.88,-321.81C54357.88,-335.28 54357.88,-364 54357.88,-364 54357.88,-364 306090.55,-364 306090.55,-364 306090.55,-364 306090.55,-271.11 306090.55,-271.11"/>
<polygon fill="black" stroke="black" points="306094.05,-271.11 306090.55,-261.11 306087.05,-271.11 306094.05,-271.11"/>
</g>
<!-- hier_reduce_3_16&#45;&gt;l3_ffn_ln_3 -->
<g id="edge1225" class="edge">
<title>hier_reduce_3_16&#45;&gt;l3_ffn_ln_3</title>
<path fill="none" stroke="black" d="M54195.92,-327C54410.04,-327 54742.23,-327 54742.23,-327 54742.23,-327 54742.23,-220 54742.23,-220 54742.23,-220 300872,-220 300872,-220 300872,-220 300872,-220.49 300872,-220.49"/>
<polygon fill="black" stroke="black" points="300868.5,-214.88 300872,-224.88 300875.5,-214.88 300868.5,-214.88"/>
</g>
<!-- hier_reduce_3_16&#45;&gt;l3_ffn_ln_4 -->
<g id="edge1231" class="edge">
<title>hier_reduce_3_16&#45;&gt;l3_ffn_ln_4</title>
<path fill="none" stroke="black" d="M54453.17,-318.38C54453.17,-329.16 54453.17,-362 54453.17,-362 54453.17,-362 303826.55,-362 303826.55,-362 303826.55,-362 303826.55,-271.07 303826.55,-271.07"/>
<polygon fill="black" stroke="black" points="303830.05,-271.07 303826.55,-261.07 303823.05,-271.07 303830.05,-271.07"/>
</g>
<!-- hier_reduce_3_16&#45;&gt;l3_ffn_ln_5 -->
<g id="edge1237" class="edge">
<title>hier_reduce_3_16&#45;&gt;l3_ffn_ln_5</title>
<path fill="none" stroke="black" d="M54342.83,-308C54636.91,-308 55024.96,-308 55024.96,-308 55024.96,-308 55024.96,-291 55024.96,-291 55024.96,-291 299608.05,-291 299608.05,-291 299608.05,-291 299608.05,-271.15 299608.05,-271.15"/>
<polygon fill="black" stroke="black" points="299611.55,-271.15 299608.05,-261.15 299604.55,-271.15 299611.55,-271.15"/>
</g>
<!-- hier_reduce_3_16&#45;&gt;l3_ffn_ln_6 -->
<g id="edge1243" class="edge">
<title>hier_reduce_3_16&#45;&gt;l3_ffn_ln_6</title>
<path fill="none" stroke="black" d="M54107.41,-330C54280.07,-330 54645.35,-330 54645.35,-330 54645.35,-330 54645.35,-120 54645.35,-120 54645.35,-120 302951.3,-120 302951.3,-120 302951.3,-120 302951.3,-214.85 302951.3,-214.85"/>
<polygon fill="black" stroke="black" points="302947.8,-214.85 302951.3,-224.85 302954.8,-214.85 302947.8,-214.85"/>
</g>
<!-- hier_reduce_3_16&#45;&gt;l3_ffn_ln_7 -->
<g id="edge1249" class="edge">
<title>hier_reduce_3_16&#45;&gt;l3_ffn_ln_7</title>
<path fill="none" stroke="black" d="M54401.42,-310C54669.62,-310 54980.48,-310 54980.48,-310 54980.48,-310 54980.48,-215 54980.48,-215 54980.48,-215 305353.5,-215 305353.5,-215 305353.5,-215 305353.5,-215.98 305353.5,-215.98"/>
<polygon fill="black" stroke="black" points="305350,-214.79 305353.5,-224.79 305357,-214.79 305350,-214.79"/>
</g>
<!-- hier_reduce_3_24&#45;&gt;l3_ffn_ln_0 -->
<g id="edge1327" class="edge">
<title>hier_reduce_3_24&#45;&gt;l3_ffn_ln_0</title>
<path fill="none" stroke="black" d="M169823.85,-316.46C169823.85,-324.1 169823.85,-359 169823.85,-359 169823.85,-359 301575,-359 301575,-359 301575,-359 301575,-249 301575,-249 301575,-249 301804.42,-249 301804.42,-249"/>
<polygon fill="black" stroke="black" points="301804.42,-252.5 301814.42,-249 301804.42,-245.5 301804.42,-252.5"/>
</g>
<!-- hier_reduce_3_24&#45;&gt;l3_ffn_ln_1 -->
<g id="edge1333" class="edge">
<title>hier_reduce_3_24&#45;&gt;l3_ffn_ln_1</title>
<path fill="none" stroke="black" d="M169790.42,-317.41C169790.42,-327.4 169790.42,-365 169790.42,-365 169790.42,-365 307230.71,-365 307230.71,-365 307230.71,-365 307230.71,-271 307230.71,-271"/>
<polygon fill="black" stroke="black" points="307234.21,-271 307230.71,-261 307227.21,-271 307234.21,-271"/>
</g>
<!-- hier_reduce_3_24&#45;&gt;l3_ffn_ln_2 -->
<g id="edge1339" class="edge">
<title>hier_reduce_3_24&#45;&gt;l3_ffn_ln_2</title>
<path fill="none" stroke="black" d="M169801.56,-317.06C169801.56,-326.25 169801.56,-363 169801.56,-363 169801.56,-363 306082.25,-363 306082.25,-363 306082.25,-363 306082.25,-271.23 306082.25,-271.23"/>
<polygon fill="black" stroke="black" points="306085.75,-271.23 306082.25,-261.23 306078.75,-271.23 306085.75,-271.23"/>
</g>
<!-- hier_reduce_3_24&#45;&gt;l3_ffn_ln_3 -->
<g id="edge1345" class="edge">
<title>hier_reduce_3_24&#45;&gt;l3_ffn_ln_3</title>
<path fill="none" stroke="black" d="M169834.99,-316.06C169834.99,-322.68 169834.99,-358 169834.99,-358 169834.99,-358 300423.63,-358 300423.63,-358 300423.63,-358 300423.63,-231 300423.63,-231 300423.63,-231 300692.14,-231 300692.14,-231"/>
<polygon fill="black" stroke="black" points="300692.14,-234.5 300702.14,-231 300692.14,-227.5 300692.14,-234.5"/>
</g>
<!-- hier_reduce_3_24&#45;&gt;l3_ffn_ln_4 -->
<g id="edge1351" class="edge">
<title>hier_reduce_3_24&#45;&gt;l3_ffn_ln_4</title>
<path fill="none" stroke="black" d="M169812.71,-316.98C169812.71,-325.78 169812.71,-361 169812.71,-361 169812.71,-361 303818.25,-361 303818.25,-361 303818.25,-361 303818.25,-271.18 303818.25,-271.18"/>
<polygon fill="black" stroke="black" points="303821.75,-271.18 303818.25,-261.18 303814.75,-271.18 303821.75,-271.18"/>
</g>
<!-- hier_reduce_3_24&#45;&gt;l3_ffn_ln_5 -->
<g id="edge1357" class="edge">
<title>hier_reduce_3_24&#45;&gt;l3_ffn_ln_5</title>
<path fill="none" stroke="black" d="M169768.14,-318.25C169768.14,-343.08 169768.14,-502 169768.14,-502 169768.14,-502 299299.97,-502 299299.97,-502 299299.97,-502 299299.97,-231 299299.97,-231 299299.97,-231 299540.33,-231 299540.33,-231"/>
<polygon fill="black" stroke="black" points="299540.33,-234.5 299550.33,-231 299540.33,-227.5 299540.33,-234.5"/>
</g>
<!-- hier_reduce_3_24&#45;&gt;l3_ffn_ln_6 -->
<g id="edge1363" class="edge">
<title>hier_reduce_3_24&#45;&gt;l3_ffn_ln_6</title>
<path fill="none" stroke="black" d="M169447.91,-301C169795.75,-301 170793.5,-301 170793.5,-301 170793.5,-301 170793.5,-132 170793.5,-132 170793.5,-132 302948.9,-132 302948.9,-132 302948.9,-132 302948.9,-214.67 302948.9,-214.67"/>
<polygon fill="black" stroke="black" points="302945.4,-214.67 302948.9,-224.67 302952.4,-214.67 302945.4,-214.67"/>
</g>
<!-- hier_reduce_3_24&#45;&gt;l3_ffn_ln_7 -->
<g id="edge1369" class="edge">
<title>hier_reduce_3_24&#45;&gt;l3_ffn_ln_7</title>
<path fill="none" stroke="black" d="M169389.03,-299C169598.11,-299 170291,-299 170291,-299 170291,-299 170291,-223 170291,-223 170291,-223 305258.17,-223 305258.17,-223 305258.17,-223 305258.17,-223.18 305258.17,-223.18"/>
<polygon fill="black" stroke="black" points="305254.67,-214.85 305258.17,-224.85 305261.67,-214.85 305254.67,-214.85"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_0_8 -->
<g id="edge76" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_0_8</title>
<path fill="none" stroke="black" d="M125856.69,-640.69C125856.69,-620.85 125856.69,-592 125856.69,-592 125856.69,-592 94536,-592 94536,-592 94536,-592 94536,-560 94536,-560"/>
<polygon fill="black" stroke="black" points="94539.5,-560 94536,-550 94532.5,-560 94539.5,-560"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_1_8 -->
<g id="edge79" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_1_8</title>
<path fill="none" stroke="black" d="M125754.77,-640.83C125754.77,-621.91 125754.77,-595 125754.77,-595 125754.77,-595 93486,-595 93486,-595 93486,-595 93486,-560.22 93486,-560.22"/>
<polygon fill="black" stroke="black" points="93489.5,-560.22 93486,-550.22 93482.5,-560.22 93489.5,-560.22"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_2_8 -->
<g id="edge82" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_2_8</title>
<path fill="none" stroke="black" d="M126468.21,-653.43C126468.21,-633.95 126468.21,-570 126468.21,-570 126468.21,-570 100836,-570 100836,-570 100836,-570 100836,-560.11 100836,-560.11"/>
<polygon fill="black" stroke="black" points="100839.5,-560.11 100836,-550.11 100832.5,-560.11 100839.5,-560.11"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_3_8 -->
<g id="edge85" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_3_8</title>
<path fill="none" stroke="black" d="M126366.29,-640.77C126366.29,-614.99 126366.29,-571 126366.29,-571 126366.29,-571 99786,-571 99786,-571 99786,-571 99786,-560.13 99786,-560.13"/>
<polygon fill="black" stroke="black" points="99789.5,-560.13 99786,-550.13 99782.5,-560.13 99789.5,-560.13"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_4_8 -->
<g id="edge88" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_4_8</title>
<path fill="none" stroke="black" d="M126264.37,-640.97C126264.37,-615.49 126264.37,-572 126264.37,-572 126264.37,-572 98736,-572 98736,-572 98736,-572 98736,-560.13 98736,-560.13"/>
<polygon fill="black" stroke="black" points="98739.5,-560.13 98736,-550.13 98732.5,-560.13 98739.5,-560.13"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_5_8 -->
<g id="edge91" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_5_8</title>
<path fill="none" stroke="black" d="M126162.45,-640.84C126162.45,-618.65 126162.45,-584 126162.45,-584 126162.45,-584 97686,-584 97686,-584 97686,-584 97686,-560.19 97686,-560.19"/>
<polygon fill="black" stroke="black" points="97689.5,-560.19 97686,-550.19 97682.5,-560.19 97689.5,-560.19"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_6_8 -->
<g id="edge94" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_6_8</title>
<path fill="none" stroke="black" d="M126060.53,-640.83C126060.53,-619.5 126060.53,-587 126060.53,-587 126060.53,-587 96636,-587 96636,-587 96636,-587 96636,-560.01 96636,-560.01"/>
<polygon fill="black" stroke="black" points="96639.5,-560.01 96636,-550.01 96632.5,-560.01 96639.5,-560.01"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_7_8 -->
<g id="edge97" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_7_8</title>
<path fill="none" stroke="black" d="M125958.61,-640.87C125958.61,-620.43 125958.61,-590 125958.61,-590 125958.61,-590 95586,-590 95586,-590 95586,-590 95586,-560.03 95586,-560.03"/>
<polygon fill="black" stroke="black" points="95589.5,-560.03 95586,-550.03 95582.5,-560.03 95589.5,-560.03"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_0_16 -->
<g id="edge148" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_0_16</title>
<path fill="none" stroke="black" d="M125593.25,-659.08C125593.25,-660.72 125593.25,-687 125593.25,-687 125593.25,-687 68236,-687 68236,-687 68236,-687 68236,-560.08 68236,-560.08"/>
<polygon fill="black" stroke="black" points="68239.5,-560.08 68236,-550.08 68232.5,-560.08 68239.5,-560.08"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_1_16 -->
<g id="edge151" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_1_16</title>
<path fill="none" stroke="black" d="M125635.58,-659.08C125635.58,-660.78 125635.58,-688 125635.58,-688 125635.58,-688 67186,-688 67186,-688 67186,-688 67186,-560.2 67186,-560.2"/>
<polygon fill="black" stroke="black" points="67189.5,-560.2 67186,-550.2 67182.5,-560.2 67189.5,-560.2"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_2_16 -->
<g id="edge154" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_2_16</title>
<path fill="none" stroke="black" d="M125677.9,-662.21C125677.9,-669.95 125677.9,-689 125677.9,-689 125677.9,-689 66136,-689 66136,-689 66136,-689 66136,-560.01 66136,-560.01"/>
<polygon fill="black" stroke="black" points="66139.5,-560.01 66136,-550.01 66132.5,-560.01 66139.5,-560.01"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_3_16 -->
<g id="edge157" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_3_16</title>
<path fill="none" stroke="black" d="M125720.23,-669.5C125720.23,-678.49 125720.23,-690 125720.23,-690 125720.23,-690 65086,-690 65086,-690 65086,-690 65086,-560.12 65086,-560.12"/>
<polygon fill="black" stroke="black" points="65089.5,-560.12 65086,-550.12 65082.5,-560.12 65089.5,-560.12"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_4_16 -->
<g id="edge160" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_4_16</title>
<path fill="none" stroke="black" d="M125762.55,-676.5C125762.55,-683.97 125762.55,-691 125762.55,-691 125762.55,-691 64036,-691 64036,-691 64036,-691 64036,-560.24 64036,-560.24"/>
<polygon fill="black" stroke="black" points="64039.5,-560.24 64036,-550.24 64032.5,-560.24 64039.5,-560.24"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_5_16 -->
<g id="edge163" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_5_16</title>
<path fill="none" stroke="black" d="M125804.88,-677.04C125804.88,-684.75 125804.88,-692 125804.88,-692 125804.88,-692 62986,-692 62986,-692 62986,-692 62986,-560.04 62986,-560.04"/>
<polygon fill="black" stroke="black" points="62989.5,-560.04 62986,-550.04 62982.5,-560.04 62989.5,-560.04"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_6_16 -->
<g id="edge166" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_6_16</title>
<path fill="none" stroke="black" d="M125847.21,-677.19C125847.21,-685.28 125847.21,-693 125847.21,-693 125847.21,-693 61936,-693 61936,-693 61936,-693 61936,-560.16 61936,-560.16"/>
<polygon fill="black" stroke="black" points="61939.5,-560.16 61936,-550.16 61932.5,-560.16 61939.5,-560.16"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_7_16 -->
<g id="edge169" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_7_16</title>
<path fill="none" stroke="black" d="M125889.53,-677.32C125889.53,-685.79 125889.53,-694 125889.53,-694 125889.53,-694 60886,-694 60886,-694 60886,-694 60886,-560.27 60886,-560.27"/>
<polygon fill="black" stroke="black" points="60889.5,-560.27 60886,-550.27 60882.5,-560.27 60889.5,-560.27"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_8_16 -->
<g id="edge172" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_8_16</title>
<path fill="none" stroke="black" d="M125931.86,-677C125931.86,-686 125931.86,-695 125931.86,-695 125931.86,-695 59836,-695 59836,-695 59836,-695 59836,-560.07 59836,-560.07"/>
<polygon fill="black" stroke="black" points="59839.5,-560.07 59836,-550.07 59832.5,-560.07 59839.5,-560.07"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_9_16 -->
<g id="edge175" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_9_16</title>
<path fill="none" stroke="black" d="M126228.14,-677.27C126228.14,-695.56 126228.14,-721 126228.14,-721 126228.14,-721 58786,-721 58786,-721 58786,-721 58786,-560.12 58786,-560.12"/>
<polygon fill="black" stroke="black" points="58789.5,-560.12 58786,-550.12 58782.5,-560.12 58789.5,-560.12"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_10_16 -->
<g id="edge178" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_10_16</title>
<path fill="none" stroke="black" d="M125974.18,-677.01C125974.18,-693.05 125974.18,-714 125974.18,-714 125974.18,-714 75118.16,-714 75118.16,-714 75118.16,-714 75118.16,-532 75118.16,-532 75118.16,-532 75010.05,-532 75010.05,-532"/>
<polygon fill="black" stroke="black" points="75010.05,-528.5 75000.05,-532 75010.05,-535.5 75010.05,-528.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_11_16 -->
<g id="edge181" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_11_16</title>
<path fill="none" stroke="black" d="M126016.51,-677.03C126016.51,-693.4 126016.51,-715 126016.51,-715 126016.51,-715 74056.5,-715 74056.5,-715 74056.5,-715 74056.5,-532 74056.5,-532 74056.5,-532 73950.95,-532 73950.95,-532"/>
<polygon fill="black" stroke="black" points="73950.95,-528.5 73940.95,-532 73950.95,-535.5 73950.95,-528.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_12_16 -->
<g id="edge184" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_12_16</title>
<path fill="none" stroke="black" d="M126058.84,-677.04C126058.84,-693.73 126058.84,-716 126058.84,-716 126058.84,-716 72997.5,-716 72997.5,-716 72997.5,-716 72997.5,-532 72997.5,-532 72997.5,-532 72891.95,-532 72891.95,-532"/>
<polygon fill="black" stroke="black" points="72891.95,-528.5 72881.95,-532 72891.95,-535.5 72891.95,-528.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_13_16 -->
<g id="edge187" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_13_16</title>
<path fill="none" stroke="black" d="M126101.16,-677.03C126101.16,-694.06 126101.16,-717 126101.16,-717 126101.16,-717 71938.5,-717 71938.5,-717 71938.5,-717 71938.5,-532 71938.5,-532 71938.5,-532 71832.95,-532 71832.95,-532"/>
<polygon fill="black" stroke="black" points="71832.95,-528.5 71822.95,-532 71832.95,-535.5 71832.95,-528.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_14_16 -->
<g id="edge190" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_14_16</title>
<path fill="none" stroke="black" d="M126143.49,-677.02C126143.49,-694.37 126143.49,-718 126143.49,-718 126143.49,-718 70879.5,-718 70879.5,-718 70879.5,-718 70879.5,-532 70879.5,-532 70879.5,-532 70773.95,-532 70773.95,-532"/>
<polygon fill="black" stroke="black" points="70773.95,-528.5 70763.95,-532 70773.95,-535.5 70773.95,-528.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_15_16 -->
<g id="edge193" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_15_16</title>
<path fill="none" stroke="black" d="M126185.82,-677C126185.82,-694.68 126185.82,-719 126185.82,-719 126185.82,-719 69820.5,-719 69820.5,-719 69820.5,-719 69820.5,-532 69820.5,-532 69820.5,-532 69714.95,-532 69714.95,-532"/>
<polygon fill="black" stroke="black" points="69714.95,-528.5 69704.95,-532 69714.95,-535.5 69714.95,-528.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_0_24 -->
<g id="edge244" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_0_24</title>
<path fill="none" stroke="black" d="M126585.31,-673C126601.78,-673 126611.29,-673 126611.29,-673 126611.29,-673 126611.29,-730 126611.29,-730 126611.29,-730 195712,-730 195712,-730 195712,-730 195712,-560.27 195712,-560.27"/>
<polygon fill="black" stroke="black" points="195715.5,-560.27 195712,-550.27 195708.5,-560.27 195715.5,-560.27"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_1_24 -->
<g id="edge247" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_1_24</title>
<path fill="none" stroke="black" d="M126561.44,-669C126593.3,-669 126613.03,-669 126613.03,-669 126613.03,-669 126613.03,-729 126613.03,-729 126613.03,-729 194662,-729 194662,-729 194662,-729 194662,-560.18 194662,-560.18"/>
<polygon fill="black" stroke="black" points="194665.5,-560.18 194662,-550.18 194658.5,-560.18 194665.5,-560.18"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_2_24 -->
<g id="edge250" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_2_24</title>
<path fill="none" stroke="black" d="M126537.01,-665C126583.9,-665 126614.77,-665 126614.77,-665 126614.77,-665 126614.77,-728 126614.77,-728 126614.77,-728 193612,-728 193612,-728 193612,-728 193612,-560.09 193612,-560.09"/>
<polygon fill="black" stroke="black" points="193615.5,-560.09 193612,-550.09 193608.5,-560.09 193615.5,-560.09"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_3_24 -->
<g id="edge253" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_3_24</title>
<path fill="none" stroke="black" d="M126513.06,-661C126574.06,-661 126616.5,-661 126616.5,-661 126616.5,-661 126616.5,-726 126616.5,-726 126616.5,-726 192562,-726 192562,-726 192562,-726 192562,-560.25 192562,-560.25"/>
<polygon fill="black" stroke="black" points="192565.5,-560.25 192562,-550.25 192558.5,-560.25 192565.5,-560.25"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_4_24 -->
<g id="edge256" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_4_24</title>
<path fill="none" stroke="black" d="M126488.98,-657C126563.52,-657 126618.24,-657 126618.24,-657 126618.24,-657 126618.24,-725 126618.24,-725 126618.24,-725 191512,-725 191512,-725 191512,-725 191512,-560.16 191512,-560.16"/>
<polygon fill="black" stroke="black" points="191515.5,-560.16 191512,-550.16 191508.5,-560.16 191515.5,-560.16"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_5_24 -->
<g id="edge259" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_5_24</title>
<path fill="none" stroke="black" d="M126464.88,-653C126552.31,-653 126619.98,-653 126619.98,-653 126619.98,-653 126619.98,-724 126619.98,-724 126619.98,-724 190462,-724 190462,-724 190462,-724 190462,-560.06 190462,-560.06"/>
<polygon fill="black" stroke="black" points="190465.5,-560.06 190462,-550.06 190458.5,-560.06 190465.5,-560.06"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_6_24 -->
<g id="edge262" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_6_24</title>
<path fill="none" stroke="black" d="M126440.95,-649C126540.5,-649 126621.71,-649 126621.71,-649 126621.71,-649 126621.71,-723 126621.71,-723 126621.71,-723 189412,-723 189412,-723 189412,-723 189412,-560.31 189412,-560.31"/>
<polygon fill="black" stroke="black" points="189415.5,-560.31 189412,-550.31 189408.5,-560.31 189415.5,-560.31"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_7_24 -->
<g id="edge265" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_7_24</title>
<path fill="none" stroke="black" d="M126416.83,-645C126527.84,-645 126623.45,-645 126623.45,-645 126623.45,-645 126623.45,-722 126623.45,-722 126623.45,-722 188362,-722 188362,-722 188362,-722 188362,-560.22 188362,-560.22"/>
<polygon fill="black" stroke="black" points="188365.5,-560.22 188362,-550.22 188358.5,-560.22 188365.5,-560.22"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_8_24 -->
<g id="edge268" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_8_24</title>
<path fill="none" stroke="black" d="M126524.42,-677.04C126524.42,-698.66 126524.42,-732 126524.42,-732 126524.42,-732 187312,-732 187312,-732 187312,-732 187312,-560.1 187312,-560.1"/>
<polygon fill="black" stroke="black" points="187315.5,-560.1 187312,-550.1 187308.5,-560.1 187315.5,-560.1"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_9_24 -->
<g id="edge271" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_9_24</title>
<path fill="none" stroke="black" d="M126566.75,-677.17C126566.75,-698.5 126566.75,-731 126566.75,-731 126566.75,-731 186262,-731 186262,-731 186262,-731 186262,-560.01 186262,-560.01"/>
<polygon fill="black" stroke="black" points="186265.5,-560.01 186262,-550.01 186258.5,-560.01 186265.5,-560.01"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_10_24 -->
<g id="edge274" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_10_24</title>
<path fill="none" stroke="black" d="M126574.46,-658.92C126574.46,-652.49 126574.46,-241 126574.46,-241 126574.46,-241 184787,-241 184787,-241 184787,-241 184787,-503.8 184787,-503.8"/>
<polygon fill="black" stroke="black" points="184783.5,-503.8 184787,-513.8 184790.5,-503.8 184783.5,-503.8"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_11_24 -->
<g id="edge277" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_11_24</title>
<path fill="none" stroke="black" d="M126578.78,-658.92C126578.78,-652.54 126578.78,-244 126578.78,-244 126578.78,-244 183761.5,-244 183761.5,-244 183761.5,-244 183761.5,-503.98 183761.5,-503.98"/>
<polygon fill="black" stroke="black" points="183758,-503.98 183761.5,-513.98 183765,-503.98 183758,-503.98"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_12_24 -->
<g id="edge280" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_12_24</title>
<path fill="none" stroke="black" d="M126583.11,-658.92C126583.11,-652.57 126583.11,-246 126583.11,-246 126583.11,-246 182719,-246 182719,-246 182719,-246 182719,-503.67 182719,-503.67"/>
<polygon fill="black" stroke="black" points="182715.5,-503.67 182719,-513.67 182722.5,-503.67 182715.5,-503.67"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_13_24 -->
<g id="edge283" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_13_24</title>
<path fill="none" stroke="black" d="M126587.44,-658.93C126587.44,-652.62 126587.44,-249 126587.44,-249 126587.44,-249 181668.5,-249 181668.5,-249 181668.5,-249 181668.5,-503.87 181668.5,-503.87"/>
<polygon fill="black" stroke="black" points="181665,-503.87 181668.5,-513.87 181672,-503.87 181665,-503.87"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_14_24 -->
<g id="edge286" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_14_24</title>
<path fill="none" stroke="black" d="M126591.77,-658.93C126591.77,-652.65 126591.77,-251 126591.77,-251 126591.77,-251 180614,-251 180614,-251 180614,-251 180614,-503.99 180614,-503.99"/>
<polygon fill="black" stroke="black" points="180610.5,-503.99 180614,-513.99 180617.5,-503.99 180610.5,-503.99"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_15_24 -->
<g id="edge289" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_15_24</title>
<path fill="none" stroke="black" d="M126596.09,-658.93C126596.09,-652.68 126596.09,-253 126596.09,-253 126596.09,-253 179557,-253 179557,-253 179557,-253 179557,-503.69 179557,-503.69"/>
<polygon fill="black" stroke="black" points="179553.5,-503.69 179557,-513.69 179560.5,-503.69 179553.5,-503.69"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_16_24 -->
<g id="edge292" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_16_24</title>
<path fill="none" stroke="black" d="M126600.42,-658.93C126600.42,-652.73 126600.42,-256 126600.42,-256 126600.42,-256 178499,-256 178499,-256 178499,-256 178499,-503.89 178499,-503.89"/>
<polygon fill="black" stroke="black" points="178495.5,-503.89 178499,-513.89 178502.5,-503.89 178495.5,-503.89"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_17_24 -->
<g id="edge295" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_17_24</title>
<path fill="none" stroke="black" d="M126604.75,-658.93C126604.75,-652.76 126604.75,-258 126604.75,-258 126604.75,-258 177405.78,-258 177405.78,-258 177405.78,-258 177405.78,-503.6 177405.78,-503.6"/>
<polygon fill="black" stroke="black" points="177402.28,-503.6 177405.78,-513.6 177409.28,-503.6 177402.28,-503.6"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_18_24 -->
<g id="edge298" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_18_24</title>
<path fill="none" stroke="black" d="M126270.47,-677.15C126270.47,-700.76 126270.47,-739 126270.47,-739 126270.47,-739 201532.5,-739 201532.5,-739 201532.5,-739 201532.5,-532 201532.5,-532 201532.5,-532 201638.05,-532 201638.05,-532"/>
<polygon fill="black" stroke="black" points="201638.05,-535.5 201648.05,-532 201638.05,-528.5 201638.05,-535.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_19_24 -->
<g id="edge301" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_19_24</title>
<path fill="none" stroke="black" d="M126312.79,-677.32C126312.79,-700.66 126312.79,-738 126312.79,-738 126312.79,-738 200473.5,-738 200473.5,-738 200473.5,-738 200473.5,-532 200473.5,-532 200473.5,-532 200579.05,-532 200579.05,-532"/>
<polygon fill="black" stroke="black" points="200579.05,-535.5 200589.05,-532 200579.05,-528.5 200579.05,-535.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_20_24 -->
<g id="edge304" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_20_24</title>
<path fill="none" stroke="black" d="M126355.12,-677.09C126355.12,-700.13 126355.12,-737 126355.12,-737 126355.12,-737 199414.5,-737 199414.5,-737 199414.5,-737 199414.5,-532 199414.5,-532 199414.5,-532 199520.05,-532 199520.05,-532"/>
<polygon fill="black" stroke="black" points="199520.05,-535.5 199530.05,-532 199520.05,-528.5 199520.05,-535.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_21_24 -->
<g id="edge307" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_21_24</title>
<path fill="none" stroke="black" d="M126397.45,-677.25C126397.45,-700.02 126397.45,-736 126397.45,-736 126397.45,-736 198355.5,-736 198355.5,-736 198355.5,-736 198355.5,-532 198355.5,-532 198355.5,-532 198461.05,-532 198461.05,-532"/>
<polygon fill="black" stroke="black" points="198461.05,-535.5 198471.05,-532 198461.05,-528.5 198461.05,-535.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_22_24 -->
<g id="edge310" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_22_24</title>
<path fill="none" stroke="black" d="M126439.77,-677.01C126439.77,-699.49 126439.77,-735 126439.77,-735 126439.77,-735 197296.5,-735 197296.5,-735 197296.5,-735 197296.5,-532 197296.5,-532 197296.5,-532 197402.05,-532 197402.05,-532"/>
<polygon fill="black" stroke="black" points="197402.05,-535.5 197412.05,-532 197402.05,-528.5 197402.05,-535.5"/>
</g>
<!-- kv_sync_0&#45;&gt;kv_cache_0_23_24 -->
<g id="edge313" class="edge">
<title>kv_sync_0&#45;&gt;kv_cache_0_23_24</title>
<path fill="none" stroke="black" d="M126482.1,-677.29C126482.1,-699.21 126482.1,-733 126482.1,-733 126482.1,-733 196237.34,-733 196237.34,-733 196237.34,-733 196237.34,-532 196237.34,-532 196237.34,-532 196342.92,-532 196342.92,-532"/>
<polygon fill="black" stroke="black" points="196342.92,-535.5 196352.92,-532 196342.92,-528.5 196342.92,-535.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_0_8 -->
<g id="edge413" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_0_8</title>
<path fill="none" stroke="black" d="M127351.92,-640.63C127351.92,-613.52 127351.92,-566 127351.92,-566 127351.92,-566 102942,-566 102942,-566 102942,-566 102942,-560.19 102942,-560.19"/>
<polygon fill="black" stroke="black" points="102945.5,-560.19 102942,-550.19 102938.5,-560.19 102945.5,-560.19"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_1_8 -->
<g id="edge416" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_1_8</title>
<path fill="none" stroke="black" d="M127309.27,-640.58C127309.27,-613.99 127309.27,-568 127309.27,-568 127309.27,-568 101892,-568 101892,-568 101892,-568 101892,-560 101892,-560"/>
<polygon fill="black" stroke="black" points="101895.5,-560 101892,-550 101888.5,-560 101895.5,-560"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_2_8 -->
<g id="edge419" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_2_8</title>
<path fill="none" stroke="black" d="M127607.8,-658.92C127607.8,-655.74 127607.8,-554 127607.8,-554 127607.8,-554 109242,-554 109242,-554 109242,-554 109242,-553.62 109242,-553.62"/>
<polygon fill="black" stroke="black" points="109245.5,-560.17 109242,-550.17 109238.5,-560.17 109245.5,-560.17"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_3_8 -->
<g id="edge422" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_3_8</title>
<path fill="none" stroke="black" d="M127565.15,-656.83C127565.15,-641.89 127565.15,-555 127565.15,-555 127565.15,-555 108192,-555 108192,-555 108192,-555 108192,-554.51 108192,-554.51"/>
<polygon fill="black" stroke="black" points="108195.5,-560.12 108192,-550.12 108188.5,-560.12 108195.5,-560.12"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_4_8 -->
<g id="edge425" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_4_8</title>
<path fill="none" stroke="black" d="M127522.5,-649.86C127522.5,-624.65 127522.5,-556 127522.5,-556 127522.5,-556 107142,-556 107142,-556 107142,-556 107142,-555.42 107142,-555.42"/>
<polygon fill="black" stroke="black" points="107145.5,-560.19 107142,-550.19 107138.5,-560.19 107145.5,-560.19"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_5_8 -->
<g id="edge428" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_5_8</title>
<path fill="none" stroke="black" d="M127479.86,-642.49C127479.86,-614.08 127479.86,-559 127479.86,-559 127479.86,-559 106092,-559 106092,-559 106092,-559 106092,-558.12 106092,-558.12"/>
<polygon fill="black" stroke="black" points="106095.5,-560.16 106092,-550.16 106088.5,-560.16 106095.5,-560.16"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_6_8 -->
<g id="edge431" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_6_8</title>
<path fill="none" stroke="black" d="M127437.21,-640.76C127437.21,-612.66 127437.21,-562 127437.21,-562 127437.21,-562 105042,-562 105042,-562 105042,-562 105042,-560.14 105042,-560.14"/>
<polygon fill="black" stroke="black" points="105045.5,-560.14 105042,-550.14 105038.5,-560.14 105045.5,-560.14"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_7_8 -->
<g id="edge434" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_7_8</title>
<path fill="none" stroke="black" d="M127394.56,-640.94C127394.56,-613.13 127394.56,-563 127394.56,-563 127394.56,-563 103992,-563 103992,-563 103992,-563 103992,-560.03 103992,-560.03"/>
<polygon fill="black" stroke="black" points="103995.5,-560.03 103992,-550.03 103988.5,-560.03 103995.5,-560.03"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_0_16 -->
<g id="edge485" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_0_16</title>
<path fill="none" stroke="black" d="M126968.1,-640.85C126968.1,-628.73 126968.1,-615 126968.1,-615 126968.1,-615 85096,-615 85096,-615 85096,-615 85096,-560.01 85096,-560.01"/>
<polygon fill="black" stroke="black" points="85099.5,-560.01 85096,-550.01 85092.5,-560.01 85099.5,-560.01"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_1_16 -->
<g id="edge488" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_1_16</title>
<path fill="none" stroke="black" d="M126925.45,-640.51C126925.45,-628.86 126925.45,-616 126925.45,-616 126925.45,-616 84046,-616 84046,-616 84046,-616 84046,-560.23 84046,-560.23"/>
<polygon fill="black" stroke="black" points="84049.5,-560.23 84046,-550.23 84042.5,-560.23 84049.5,-560.23"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_2_16 -->
<g id="edge491" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_2_16</title>
<path fill="none" stroke="black" d="M126882.8,-640.9C126882.8,-629.91 126882.8,-618 126882.8,-618 126882.8,-618 82996,-618 82996,-618 82996,-618 82996,-560.24 82996,-560.24"/>
<polygon fill="black" stroke="black" points="82999.5,-560.24 82996,-550.24 82992.5,-560.24 82999.5,-560.24"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_3_16 -->
<g id="edge494" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_3_16</title>
<path fill="none" stroke="black" d="M126840.16,-640.87C126840.16,-630.29 126840.16,-619 126840.16,-619 126840.16,-619 81946,-619 81946,-619 81946,-619 81946,-560.03 81946,-560.03"/>
<polygon fill="black" stroke="black" points="81949.5,-560.03 81946,-550.03 81942.5,-560.03 81949.5,-560.03"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_4_16 -->
<g id="edge497" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_4_16</title>
<path fill="none" stroke="black" d="M126797.51,-640.87C126797.51,-630.69 126797.51,-620 126797.51,-620 126797.51,-620 80896,-620 80896,-620 80896,-620 80896,-560.23 80896,-560.23"/>
<polygon fill="black" stroke="black" points="80899.5,-560.23 80896,-550.23 80892.5,-560.23 80899.5,-560.23"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_5_16 -->
<g id="edge500" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_5_16</title>
<path fill="none" stroke="black" d="M126754.86,-640.93C126754.86,-631.54 126754.86,-622 126754.86,-622 126754.86,-622 79846,-622 79846,-622 79846,-622 79846,-560.21 79846,-560.21"/>
<polygon fill="black" stroke="black" points="79849.5,-560.21 79846,-550.21 79842.5,-560.21 79849.5,-560.21"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_6_16 -->
<g id="edge503" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_6_16</title>
<path fill="none" stroke="black" d="M126712.22,-641C126712.22,-632 126712.22,-623 126712.22,-623 126712.22,-623 78796,-623 78796,-623 78796,-623 78796,-560.42 78796,-560.42"/>
<polygon fill="black" stroke="black" points="78799.5,-560.42 78796,-550.42 78792.5,-560.42 78799.5,-560.42"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_7_16 -->
<g id="edge506" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_7_16</title>
<path fill="none" stroke="black" d="M126669.57,-640.68C126669.57,-632.21 126669.57,-624 126669.57,-624 126669.57,-624 77746,-624 77746,-624 77746,-624 77746,-560.18 77746,-560.18"/>
<polygon fill="black" stroke="black" points="77749.5,-560.18 77746,-550.18 77742.5,-560.18 77749.5,-560.18"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_8_16 -->
<g id="edge509" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_8_16</title>
<path fill="none" stroke="black" d="M126732.74,-659.1C126732.74,-661.21 126732.74,-695 126732.74,-695 126732.74,-695 76696,-695 76696,-695 76696,-695 76696,-560.07 76696,-560.07"/>
<polygon fill="black" stroke="black" points="76699.5,-560.07 76696,-550.07 76692.5,-560.07 76699.5,-560.07"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_9_16 -->
<g id="edge512" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_9_16</title>
<path fill="none" stroke="black" d="M126838.55,-676.2C126838.55,-685.86 126838.55,-696 126838.55,-696 126838.55,-696 75646,-696 75646,-696 75646,-696 75646,-560.18 75646,-560.18"/>
<polygon fill="black" stroke="black" points="75649.5,-560.18 75646,-550.18 75642.5,-560.18 75649.5,-560.18"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_10_16 -->
<g id="edge515" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_10_16</title>
<path fill="none" stroke="black" d="M127223.98,-640.99C127223.98,-624.95 127223.98,-604 127223.98,-604 127223.98,-604 91978.15,-604 91978.15,-604 91978.15,-604 91978.15,-532 91978.15,-532 91978.15,-532 91870.05,-532 91870.05,-532"/>
<polygon fill="black" stroke="black" points="91870.05,-528.5 91860.05,-532 91870.05,-535.5 91870.05,-528.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_11_16 -->
<g id="edge518" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_11_16</title>
<path fill="none" stroke="black" d="M127181.33,-640.81C127181.33,-625.82 127181.33,-607 127181.33,-607 127181.33,-607 90916.5,-607 90916.5,-607 90916.5,-607 90916.5,-532 90916.5,-532 90916.5,-532 90810.95,-532 90810.95,-532"/>
<polygon fill="black" stroke="black" points="90810.95,-528.5 90800.95,-532 90810.95,-535.5 90810.95,-528.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_12_16 -->
<g id="edge521" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_12_16</title>
<path fill="none" stroke="black" d="M127138.68,-640.75C127138.68,-626.82 127138.68,-610 127138.68,-610 127138.68,-610 89857.5,-610 89857.5,-610 89857.5,-610 89857.5,-532 89857.5,-532 89857.5,-532 89751.95,-532 89751.95,-532"/>
<polygon fill="black" stroke="black" points="89751.95,-528.5 89741.95,-532 89751.95,-535.5 89751.95,-528.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_13_16 -->
<g id="edge524" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_13_16</title>
<path fill="none" stroke="black" d="M127096.04,-640.85C127096.04,-627.26 127096.04,-611 127096.04,-611 127096.04,-611 88798.5,-611 88798.5,-611 88798.5,-611 88798.5,-532 88798.5,-532 88798.5,-532 88692.95,-532 88692.95,-532"/>
<polygon fill="black" stroke="black" points="88692.95,-528.5 88682.95,-532 88692.95,-535.5 88692.95,-528.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_14_16 -->
<g id="edge527" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_14_16</title>
<path fill="none" stroke="black" d="M127053.39,-640.96C127053.39,-627.71 127053.39,-612 127053.39,-612 127053.39,-612 87739.5,-612 87739.5,-612 87739.5,-612 87739.5,-532 87739.5,-532 87739.5,-532 87633.95,-532 87633.95,-532"/>
<polygon fill="black" stroke="black" points="87633.95,-528.5 87623.95,-532 87633.95,-535.5 87633.95,-528.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_15_16 -->
<g id="edge530" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_15_16</title>
<path fill="none" stroke="black" d="M127010.74,-640.96C127010.74,-628.44 127010.74,-614 127010.74,-614 127010.74,-614 86680.5,-614 86680.5,-614 86680.5,-614 86680.5,-532 86680.5,-532 86680.5,-532 86574.95,-532 86574.95,-532"/>
<polygon fill="black" stroke="black" points="86574.95,-528.5 86564.95,-532 86574.95,-535.5 86574.95,-528.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_0_24 -->
<g id="edge581" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_0_24</title>
<path fill="none" stroke="black" d="M127673.23,-675C135144.36,-675 221044,-675 221044,-675 221044,-675 221044,-560.11 221044,-560.11"/>
<polygon fill="black" stroke="black" points="221047.5,-560.11 221044,-550.11 221040.5,-560.11 221047.5,-560.11"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_1_24 -->
<g id="edge584" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_1_24</title>
<path fill="none" stroke="black" d="M127661.1,-673C135006.24,-673 219994,-673 219994,-673 219994,-673 219994,-560.14 219994,-560.14"/>
<polygon fill="black" stroke="black" points="219997.5,-560.14 219994,-550.14 219990.5,-560.14 219997.5,-560.14"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_2_24 -->
<g id="edge587" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_2_24</title>
<path fill="none" stroke="black" d="M127649.15,-671C134869.2,-671 218944,-671 218944,-671 218944,-671 218944,-560.17 218944,-560.17"/>
<polygon fill="black" stroke="black" points="218947.5,-560.17 218944,-550.17 218940.5,-560.17 218947.5,-560.17"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_3_24 -->
<g id="edge590" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_3_24</title>
<path fill="none" stroke="black" d="M127637.05,-669C134730.6,-669 217894,-669 217894,-669 217894,-669 217894,-560.19 217894,-560.19"/>
<polygon fill="black" stroke="black" points="217897.5,-560.19 217894,-550.19 217890.5,-560.19 217897.5,-560.19"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_4_24 -->
<g id="edge593" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_4_24</title>
<path fill="none" stroke="black" d="M127625.13,-667C134593.16,-667 216844,-667 216844,-667 216844,-667 216844,-560.21 216844,-560.21"/>
<polygon fill="black" stroke="black" points="216847.5,-560.21 216844,-550.21 216840.5,-560.21 216847.5,-560.21"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_5_24 -->
<g id="edge596" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_5_24</title>
<path fill="none" stroke="black" d="M127613.08,-665C134454.27,-665 215794,-665 215794,-665 215794,-665 215794,-560.21 215794,-560.21"/>
<polygon fill="black" stroke="black" points="215797.5,-560.21 215794,-550.21 215790.5,-560.21 215797.5,-560.21"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_6_24 -->
<g id="edge599" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_6_24</title>
<path fill="none" stroke="black" d="M127601.22,-663C134316.6,-663 214744,-663 214744,-663 214744,-663 214744,-560.21 214744,-560.21"/>
<polygon fill="black" stroke="black" points="214747.5,-560.21 214744,-550.21 214740.5,-560.22 214747.5,-560.21"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_7_24 -->
<g id="edge602" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_7_24</title>
<path fill="none" stroke="black" d="M127588.94,-661C134175.07,-661 213694,-661 213694,-661 213694,-661 213694,-560.21 213694,-560.21"/>
<polygon fill="black" stroke="black" points="213697.5,-560.21 213694,-550.21 213690.5,-560.21 213697.5,-560.21"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_8_24 -->
<g id="edge605" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_8_24</title>
<path fill="none" stroke="black" d="M127577.19,-659C134037.38,-659 212644,-659 212644,-659 212644,-659 212644,-560.2 212644,-560.2"/>
<polygon fill="black" stroke="black" points="212647.5,-560.2 212644,-550.2 212640.5,-560.2 212647.5,-560.2"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_9_24 -->
<g id="edge608" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_9_24</title>
<path fill="none" stroke="black" d="M127565.04,-657C133896.02,-657 211594,-657 211594,-657 211594,-657 211594,-560.18 211594,-560.18"/>
<polygon fill="black" stroke="black" points="211597.5,-560.18 211594,-550.18 211590.5,-560.18 211597.5,-560.18"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_10_24 -->
<g id="edge611" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_10_24</title>
<path fill="none" stroke="black" d="M127553.09,-655C133755.65,-655 210539,-655 210539,-655 210539,-655 210539,-560.15 210539,-560.15"/>
<polygon fill="black" stroke="black" points="210542.5,-560.15 210539,-550.15 210535.5,-560.15 210542.5,-560.15"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_11_24 -->
<g id="edge614" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_11_24</title>
<path fill="none" stroke="black" d="M127541.07,-653C133613.96,-653 209480,-653 209480,-653 209480,-653 209480,-560.11 209480,-560.11"/>
<polygon fill="black" stroke="black" points="209483.5,-560.11 209480,-550.11 209476.5,-560.11 209483.5,-560.11"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_12_24 -->
<g id="edge617" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_12_24</title>
<path fill="none" stroke="black" d="M127529,-651C133471.36,-651 208421,-651 208421,-651 208421,-651 208421,-560.07 208421,-560.07"/>
<polygon fill="black" stroke="black" points="208424.5,-560.07 208421,-550.07 208417.5,-560.07 208424.5,-560.07"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_13_24 -->
<g id="edge620" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_13_24</title>
<path fill="none" stroke="black" d="M127516.91,-649C133327.93,-649 207362,-649 207362,-649 207362,-649 207362,-560.02 207362,-560.02"/>
<polygon fill="black" stroke="black" points="207365.5,-560.02 207362,-550.02 207358.5,-560.02 207365.5,-560.02"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_14_24 -->
<g id="edge623" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_14_24</title>
<path fill="none" stroke="black" d="M127504.8,-647C133183.77,-647 206303,-647 206303,-647 206303,-647 206303,-560.22 206303,-560.22"/>
<polygon fill="black" stroke="black" points="206306.5,-560.22 206303,-550.22 206299.5,-560.22 206306.5,-560.22"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_15_24 -->
<g id="edge626" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_15_24</title>
<path fill="none" stroke="black" d="M127492.7,-645C133038.97,-645 205244,-645 205244,-645 205244,-645 205244,-560.16 205244,-560.16"/>
<polygon fill="black" stroke="black" points="205247.5,-560.16 205244,-550.16 205240.5,-560.16 205247.5,-560.16"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_16_24 -->
<g id="edge629" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_16_24</title>
<path fill="none" stroke="black" d="M127480.88,-643C132895.88,-643 204185,-643 204185,-643 204185,-643 204185,-560.33 204185,-560.33"/>
<polygon fill="black" stroke="black" points="204188.5,-560.33 204185,-550.33 204181.5,-560.33 204188.5,-560.33"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_17_24 -->
<g id="edge632" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_17_24</title>
<path fill="none" stroke="black" d="M127579.26,-677.11C127579.26,-686.9 127579.26,-697 127579.26,-697 127579.26,-697 202594,-697 202594,-697 202594,-697 202594,-532 202594,-532 202594,-532 202702.07,-532 202702.07,-532"/>
<polygon fill="black" stroke="black" points="202702.07,-535.5 202712.07,-532 202702.07,-528.5 202702.07,-535.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_18_24 -->
<g id="edge635" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_18_24</title>
<path fill="none" stroke="black" d="M126944.37,-677.15C126944.37,-689.27 126944.37,-703 126944.37,-703 126944.37,-703 226864.5,-703 226864.5,-703 226864.5,-703 226864.5,-532 226864.5,-532 226864.5,-532 226970.05,-532 226970.05,-532"/>
<polygon fill="black" stroke="black" points="226970.05,-535.5 226980.05,-532 226970.05,-528.5 226970.05,-535.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_19_24 -->
<g id="edge638" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_19_24</title>
<path fill="none" stroke="black" d="M127050.18,-677.49C127050.18,-689.14 127050.18,-702 127050.18,-702 127050.18,-702 225805.5,-702 225805.5,-702 225805.5,-702 225805.5,-532 225805.5,-532 225805.5,-532 225911.05,-532 225911.05,-532"/>
<polygon fill="black" stroke="black" points="225911.05,-535.5 225921.05,-532 225911.05,-528.5 225911.05,-535.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_20_24 -->
<g id="edge641" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_20_24</title>
<path fill="none" stroke="black" d="M127156,-677.06C127156,-688.44 127156,-701 127156,-701 127156,-701 224746.5,-701 224746.5,-701 224746.5,-701 224746.5,-532 224746.5,-532 224746.5,-532 224852.05,-532 224852.05,-532"/>
<polygon fill="black" stroke="black" points="224852.05,-535.5 224862.05,-532 224852.05,-528.5 224852.05,-535.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_21_24 -->
<g id="edge644" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_21_24</title>
<path fill="none" stroke="black" d="M127261.82,-677.1C127261.82,-688.09 127261.82,-700 127261.82,-700 127261.82,-700 223687.5,-700 223687.5,-700 223687.5,-700 223687.5,-532 223687.5,-532 223687.5,-532 223793.05,-532 223793.05,-532"/>
<polygon fill="black" stroke="black" points="223793.05,-535.5 223803.05,-532 223793.05,-528.5 223793.05,-535.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_22_24 -->
<g id="edge647" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_22_24</title>
<path fill="none" stroke="black" d="M127367.63,-677.13C127367.63,-687.71 127367.63,-699 127367.63,-699 127367.63,-699 222628.5,-699 222628.5,-699 222628.5,-699 222628.5,-532 222628.5,-532 222628.5,-532 222734.05,-532 222734.05,-532"/>
<polygon fill="black" stroke="black" points="222734.05,-535.5 222744.05,-532 222734.05,-528.5 222734.05,-535.5"/>
</g>
<!-- kv_sync_1&#45;&gt;kv_cache_1_23_24 -->
<g id="edge650" class="edge">
<title>kv_sync_1&#45;&gt;kv_cache_1_23_24</title>
<path fill="none" stroke="black" d="M127473.45,-677.13C127473.45,-687.31 127473.45,-698 127473.45,-698 127473.45,-698 221569.34,-698 221569.34,-698 221569.34,-698 221569.34,-532 221569.34,-532 221569.34,-532 221674.92,-532 221674.92,-532"/>
<polygon fill="black" stroke="black" points="221674.92,-535.5 221684.92,-532 221674.92,-528.5 221674.92,-535.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_0_8 -->
<g id="edge750" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_0_8</title>
<path fill="none" stroke="black" d="M117257.18,-664C115881.86,-664 111348,-664 111348,-664 111348,-664 111348,-560.08 111348,-560.08"/>
<polygon fill="black" stroke="black" points="111351.5,-560.08 111348,-550.08 111344.5,-560.08 111351.5,-560.08"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_1_8 -->
<g id="edge753" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_1_8</title>
<path fill="none" stroke="black" d="M117268.95,-666C115764.78,-666 110298,-666 110298,-666 110298,-666 110298,-560.07 110298,-560.07"/>
<polygon fill="black" stroke="black" points="110301.5,-560.07 110298,-550.07 110294.5,-560.07 110301.5,-560.07"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_2_8 -->
<g id="edge756" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_2_8</title>
<path fill="none" stroke="black" d="M117820.04,-640.8C117820.04,-640.8 117820.04,-560.16 117820.04,-560.16"/>
<polygon fill="black" stroke="black" points="117823.54,-560.16 117820.04,-550.16 117816.54,-560.16 117823.54,-560.16"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_3_8 -->
<g id="edge759" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_3_8</title>
<path fill="none" stroke="black" d="M117125.4,-658.91C117125.4,-655.06 117125.4,-532 117125.4,-532 117125.4,-532 117018.68,-532 117018.68,-532"/>
<polygon fill="black" stroke="black" points="117018.68,-528.5 117008.68,-532 117018.68,-535.5 117018.68,-528.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_4_8 -->
<g id="edge762" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_4_8</title>
<path fill="none" stroke="black" d="M117190.8,-653C116620.66,-653 115720.04,-653 115720.04,-653 115720.04,-653 115720.04,-560.11 115720.04,-560.11"/>
<polygon fill="black" stroke="black" points="115723.54,-560.11 115720.04,-550.11 115716.54,-560.11 115723.54,-560.11"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_5_8 -->
<g id="edge765" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_5_8</title>
<path fill="none" stroke="black" d="M117226.85,-659C116368.69,-659 114498,-659 114498,-659 114498,-659 114498,-560.2 114498,-560.2"/>
<polygon fill="black" stroke="black" points="114501.5,-560.2 114498,-550.2 114494.5,-560.2 114501.5,-560.2"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_6_8 -->
<g id="edge768" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_6_8</title>
<path fill="none" stroke="black" d="M117232.83,-660C116172.55,-660 113448,-660 113448,-660 113448,-660 113448,-560.07 113448,-560.07"/>
<polygon fill="black" stroke="black" points="113451.5,-560.07 113448,-550.07 113444.5,-560.07 113451.5,-560.07"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_7_8 -->
<g id="edge771" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_7_8</title>
<path fill="none" stroke="black" d="M117245.03,-662C116015.94,-662 112398,-662 112398,-662 112398,-662 112398,-560.08 112398,-560.08"/>
<polygon fill="black" stroke="black" points="112401.5,-560.08 112398,-550.08 112394.5,-560.08 112401.5,-560.08"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_0_16 -->
<g id="edge822" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_0_16</title>
<path fill="none" stroke="black" d="M117178.91,-651C116714.71,-651 116073,-651 116073,-651 116073,-651 116073,-504 116073,-504 116073,-504 34791.42,-504 34791.42,-504 34791.42,-504 34791.42,-504.98 34791.42,-504.98"/>
<polygon fill="black" stroke="black" points="34787.92,-503.79 34791.42,-513.79 34794.92,-503.79 34787.92,-503.79"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_1_16 -->
<g id="edge825" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_1_16</title>
<path fill="none" stroke="black" d="M117214.9,-657C116469.44,-657 115023,-657 115023,-657 115023,-657 115023,-506 115023,-506 115023,-506 33756.42,-506 33756.42,-506 33756.42,-506 33756.42,-506.79 33756.42,-506.79"/>
<polygon fill="black" stroke="black" points="33752.92,-503.94 33756.42,-513.94 33759.92,-503.94 33752.92,-503.94"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_2_16 -->
<g id="edge828" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_2_16</title>
<path fill="none" stroke="black" d="M117299.06,-671C115773.29,-671 109764.06,-671 109764.06,-671 109764.06,-671 109764.06,-512 109764.06,-512 109764.06,-512 32676.75,-512 32676.75,-512 32676.75,-512 32676.75,-512.18 32676.75,-512.18"/>
<polygon fill="black" stroke="black" points="32673.25,-503.85 32676.75,-513.85 32680.25,-503.85 32673.25,-503.85"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_3_16 -->
<g id="edge831" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_3_16</title>
<path fill="none" stroke="black" d="M117124.79,-642C117020.37,-642 116942.09,-642 116942.09,-642 116942.09,-642 116942.09,-632 116942.09,-632 116942.09,-632 31366,-632 31366,-632 31366,-632 31366,-560.34 31366,-560.34"/>
<polygon fill="black" stroke="black" points="31369.5,-560.34 31366,-550.34 31362.5,-560.34 31369.5,-560.34"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_4_16 -->
<g id="edge834" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_4_16</title>
<path fill="none" stroke="black" d="M117287.08,-669C115742.84,-669 109770,-669 109770,-669 109770,-669 109770,-510 109770,-510 109770,-510 30567.75,-510 30567.75,-510 30567.75,-510 30567.75,-510.38 30567.75,-510.38"/>
<polygon fill="black" stroke="black" points="30564.25,-503.83 30567.75,-513.83 30571.25,-503.83 30564.25,-503.83"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_5_16 -->
<g id="edge837" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_5_16</title>
<path fill="none" stroke="black" d="M117281.16,-668C115728.38,-668 109775.94,-668 109775.94,-668 109775.94,-668 109775.94,-508 109775.94,-508 109775.94,-508 29522.42,-508 29522.42,-508 29522.42,-508 29522.42,-508.58 29522.42,-508.58"/>
<polygon fill="black" stroke="black" points="29518.92,-503.81 29522.42,-513.81 29525.92,-503.81 29518.92,-503.81"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_6_16 -->
<g id="edge840" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_6_16</title>
<path fill="none" stroke="black" d="M117136.65,-644C116943.76,-644 116770.04,-644 116770.04,-644 116770.04,-644 116770.04,-634 116770.04,-634 116770.04,-634 28216,-634 28216,-634 28216,-634 28216,-560.24 28216,-560.24"/>
<polygon fill="black" stroke="black" points="28219.5,-560.24 28216,-550.24 28212.5,-560.24 28219.5,-560.24"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_7_16 -->
<g id="edge843" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_7_16</title>
<path fill="none" stroke="black" d="M117148.75,-646C116877.96,-646 116598,-646 116598,-646 116598,-646 116598,-635 116598,-635 116598,-635 27166,-635 27166,-635 27166,-635 27166,-560.41 27166,-560.41"/>
<polygon fill="black" stroke="black" points="27169.5,-560.41 27166,-550.41 27162.5,-560.41 27169.5,-560.41"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_8_16 -->
<g id="edge846" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_8_16</title>
<path fill="none" stroke="black" d="M117160.63,-648C116820.04,-648 116425.96,-648 116425.96,-648 116425.96,-648 116425.96,-636 116425.96,-636 116425.96,-636 26116,-636 26116,-636 26116,-636 26116,-560.12 26116,-560.12"/>
<polygon fill="black" stroke="black" points="26119.5,-560.12 26116,-550.12 26112.5,-560.12 26119.5,-560.12"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_9_16 -->
<g id="edge849" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_9_16</title>
<path fill="none" stroke="black" d="M117172.62,-650C116768.69,-650 116253.91,-650 116253.91,-650 116253.91,-650 116253.91,-638 116253.91,-638 116253.91,-638 25066,-638 25066,-638 25066,-638 25066,-560.46 25066,-560.46"/>
<polygon fill="black" stroke="black" points="25069.5,-560.46 25066,-550.46 25062.5,-560.46 25069.5,-560.46"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_10_16 -->
<g id="edge852" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_10_16</title>
<path fill="none" stroke="black" d="M117202.84,-655C116541.34,-655 115375.96,-655 115375.96,-655 115375.96,-655 115375.96,-639 115375.96,-639 115375.96,-639 41398.16,-639 41398.16,-639 41398.16,-639 41398.16,-532 41398.16,-532 41398.16,-532 41290.05,-532 41290.05,-532"/>
<polygon fill="black" stroke="black" points="41290.05,-528.5 41280.05,-532 41290.05,-535.5 41290.05,-528.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_11_16 -->
<g id="edge855" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_11_16</title>
<path fill="none" stroke="black" d="M117705.35,-640.96C117705.35,-633.25 117705.35,-626 117705.35,-626 117705.35,-626 40336.5,-626 40336.5,-626 40336.5,-626 40336.5,-532 40336.5,-532 40336.5,-532 40230.95,-532 40230.95,-532"/>
<polygon fill="black" stroke="black" points="40230.95,-528.5 40220.95,-532 40230.95,-535.5 40230.95,-528.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_12_16 -->
<g id="edge858" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_12_16</title>
<path fill="none" stroke="black" d="M117590.65,-640.76C117590.65,-633.57 117590.65,-627 117590.65,-627 117590.65,-627 39277.5,-627 39277.5,-627 39277.5,-627 39277.5,-532 39277.5,-532 39277.5,-532 39171.95,-532 39171.95,-532"/>
<polygon fill="black" stroke="black" points="39171.95,-528.5 39161.95,-532 39171.95,-535.5 39171.95,-528.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_13_16 -->
<g id="edge861" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_13_16</title>
<path fill="none" stroke="black" d="M117475.96,-640.97C117475.96,-634.15 117475.96,-628 117475.96,-628 117475.96,-628 38218.22,-628 38218.22,-628 38218.22,-628 38218.22,-532 38218.22,-532 38218.22,-532 38113.06,-532 38113.06,-532"/>
<polygon fill="black" stroke="black" points="38113.06,-528.5 38103.06,-532 38113.06,-535.5 38113.06,-528.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_14_16 -->
<g id="edge864" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_14_16</title>
<path fill="none" stroke="black" d="M117361.26,-640.8C117361.26,-634.97 117361.26,-630 117361.26,-630 117361.26,-630 37159.5,-630 37159.5,-630 37159.5,-630 37159.5,-532 37159.5,-532 37159.5,-532 37053.95,-532 37053.95,-532"/>
<polygon fill="black" stroke="black" points="37053.95,-528.5 37043.95,-532 37053.95,-535.5 37053.95,-528.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_15_16 -->
<g id="edge867" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_15_16</title>
<path fill="none" stroke="black" d="M117246.57,-640.79C117246.57,-635.45 117246.57,-631 117246.57,-631 117246.57,-631 36100.5,-631 36100.5,-631 36100.5,-631 36100.5,-532 36100.5,-532 36100.5,-532 35994.95,-532 35994.95,-532"/>
<polygon fill="black" stroke="black" points="35994.95,-528.5 35984.95,-532 35994.95,-535.5 35994.95,-528.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_0_24 -->
<g id="edge918" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_0_24</title>
<path fill="none" stroke="black" d="M118027,-652C118329.88,-652 118704,-652 118704,-652 118704,-652 118704,-574 118704,-574 118704,-574 145048,-574 145048,-574 145048,-574 145048,-560.06 145048,-560.06"/>
<polygon fill="black" stroke="black" points="145051.5,-560.06 145048,-550.06 145044.5,-560.06 145051.5,-560.06"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_1_24 -->
<g id="edge921" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_1_24</title>
<path fill="none" stroke="black" d="M118087.26,-662C118834.87,-662 120274.56,-662 120274.56,-662 120274.56,-662 120274.56,-386 120274.56,-386 120274.56,-386 143526.44,-386 143526.44,-386 143526.44,-386 143526.44,-521.89 143526.44,-521.89"/>
<polygon fill="black" stroke="black" points="143522.94,-521.89 143526.44,-531.89 143529.94,-521.89 143522.94,-521.89"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_2_24 -->
<g id="edge924" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_2_24</title>
<path fill="none" stroke="black" d="M118093.2,-663C118843.53,-663 120279,-663 120279,-663 120279,-663 120279,-387 120279,-387 120279,-387 142567.5,-387 142567.5,-387 142567.5,-387 142567.5,-503.93 142567.5,-503.93"/>
<polygon fill="black" stroke="black" points="142564,-503.93 142567.5,-513.93 142571,-503.93 142564,-503.93"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_3_24 -->
<g id="edge927" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_3_24</title>
<path fill="none" stroke="black" d="M118020.8,-651C118287.95,-651 118600.77,-651 118600.77,-651 118600.77,-651 118600.77,-567 118600.77,-567 118600.77,-567 141898,-567 141898,-567 141898,-567 141898,-560.32 141898,-560.32"/>
<polygon fill="black" stroke="black" points="141901.5,-560.32 141898,-550.32 141894.5,-560.32 141901.5,-560.32"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_4_24 -->
<g id="edge930" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_4_24</title>
<path fill="none" stroke="black" d="M118014.76,-650C118244.61,-650 118497.55,-650 118497.55,-650 118497.55,-650 118497.55,-564 118497.55,-564 118497.55,-564 140848,-564 140848,-564 140848,-564 140848,-560.24 140848,-560.24"/>
<polygon fill="black" stroke="black" points="140851.5,-560.24 140848,-550.24 140844.5,-560.24 140851.5,-560.24"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_5_24 -->
<g id="edge933" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_5_24</title>
<path fill="none" stroke="black" d="M118099.18,-664C118852.19,-664 120283.44,-664 120283.44,-664 120283.44,-664 120283.44,-389 120283.44,-389 120283.44,-389 139434.5,-389 139434.5,-389 139434.5,-389 139434.5,-503.89 139434.5,-503.89"/>
<polygon fill="black" stroke="black" points="139431,-503.89 139434.5,-513.89 139438,-503.89 139431,-503.89"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_6_24 -->
<g id="edge936" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_6_24</title>
<path fill="none" stroke="black" d="M118008.86,-649C118199.45,-649 118394.32,-649 118394.32,-649 118394.32,-649 118394.32,-560 118394.32,-560 118394.32,-560 138748,-560 138748,-560 138748,-560 138748,-559.02 138748,-559.02"/>
<polygon fill="black" stroke="black" points="138751.5,-560.21 138748,-550.21 138744.5,-560.21 138751.5,-560.21"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_7_24 -->
<g id="edge939" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_7_24</title>
<path fill="none" stroke="black" d="M118002.94,-648C118151.84,-648 118291.1,-648 118291.1,-648 118291.1,-648 118291.1,-558 118291.1,-558 118291.1,-558 137698,-558 137698,-558 137698,-558 137698,-557.21 137698,-557.21"/>
<polygon fill="black" stroke="black" points="137701.5,-560.06 137698,-550.06 137694.5,-560.06 137701.5,-560.06"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_8_24 -->
<g id="edge942" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_8_24</title>
<path fill="none" stroke="black" d="M118051.07,-656C118517.74,-656 119223.09,-656 119223.09,-656 119223.09,-656 119223.09,-491 119223.09,-491 119223.09,-491 136177.69,-491 136177.69,-491 136177.69,-491 136177.69,-521.88 136177.69,-521.88"/>
<polygon fill="black" stroke="black" points="136174.19,-521.88 136177.69,-531.88 136181.19,-521.88 136174.19,-521.88"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_9_24 -->
<g id="edge945" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_9_24</title>
<path fill="none" stroke="black" d="M118056.95,-657C118524.52,-657 119226.04,-657 119226.04,-657 119226.04,-657 119226.04,-493 119226.04,-493 119226.04,-493 135120.94,-493 135120.94,-493 135120.94,-493 135120.94,-521.89 135120.94,-521.89"/>
<polygon fill="black" stroke="black" points="135117.44,-521.89 135120.94,-531.89 135124.44,-521.89 135117.44,-521.89"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_10_24 -->
<g id="edge948" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_10_24</title>
<path fill="none" stroke="black" d="M118062.87,-658C118531.3,-658 119229,-658 119229,-658 119229,-658 119229,-494 119229,-494 119229,-494 134059.78,-494 134059.78,-494 134059.78,-494 134059.78,-521.89 134059.78,-521.89"/>
<polygon fill="black" stroke="black" points="134056.28,-521.89 134059.78,-531.89 134063.28,-521.89 134056.28,-521.89"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_11_24 -->
<g id="edge951" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_11_24</title>
<path fill="none" stroke="black" d="M118069.09,-659C118538.34,-659 119231.96,-659 119231.96,-659 119231.96,-659 119231.96,-496 119231.96,-496 119231.96,-496 132987.7,-496 132987.7,-496 132987.7,-496 132987.7,-521.9 132987.7,-521.9"/>
<polygon fill="black" stroke="black" points="132984.2,-521.9 132987.7,-531.9 132991.2,-521.9 132984.2,-521.9"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_12_24 -->
<g id="edge954" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_12_24</title>
<path fill="none" stroke="black" d="M118075.09,-660C118545.12,-660 119234.91,-660 119234.91,-660 119234.91,-660 119234.91,-498 119234.91,-498 119234.91,-498 131928.37,-498 131928.37,-498 131928.37,-498 131928.37,-503.81 131928.37,-503.81"/>
<polygon fill="black" stroke="black" points="131924.87,-503.81 131928.37,-513.81 131931.87,-503.81 131924.87,-503.81"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_13_24 -->
<g id="edge957" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_13_24</title>
<path fill="none" stroke="black" d="M118166.29,-658.87C118166.29,-653.6 118166.29,-485 118166.29,-485 118166.29,-485 130869.04,-485 130869.04,-485 130869.04,-485 130869.04,-521.87 130869.04,-521.87"/>
<polygon fill="black" stroke="black" points="130865.54,-521.87 130869.04,-531.87 130872.54,-521.87 130865.54,-521.87"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_14_24 -->
<g id="edge960" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_14_24</title>
<path fill="none" stroke="black" d="M118168.44,-658.88C118168.44,-653.67 118168.44,-487 118168.44,-487 118168.44,-487 129810.04,-487 129810.04,-487 129810.04,-487 129810.04,-521.87 129810.04,-521.87"/>
<polygon fill="black" stroke="black" points="129806.54,-521.87 129810.04,-531.87 129813.54,-521.87 129806.54,-521.87"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_15_24 -->
<g id="edge963" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_15_24</title>
<path fill="none" stroke="black" d="M118170.6,-658.88C118170.6,-653.73 118170.6,-489 118170.6,-489 118170.6,-489 128751.04,-489 128751.04,-489 128751.04,-489 128751.04,-521.88 128751.04,-521.88"/>
<polygon fill="black" stroke="black" points="128747.54,-521.88 128751.04,-531.88 128754.54,-521.88 128747.54,-521.88"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_16_24 -->
<g id="edge966" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_16_24</title>
<path fill="none" stroke="black" d="M118174.92,-658.92C118174.92,-655.68 118174.92,-552 118174.92,-552 118174.92,-552 127676.82,-552 127676.82,-552 127676.82,-552 127676.82,-542.06 127676.82,-542.06"/>
<polygon fill="black" stroke="black" points="127680.32,-542.06 127676.82,-532.06 127673.32,-542.06 127680.32,-542.06"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_17_24 -->
<g id="edge969" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_17_24</title>
<path fill="none" stroke="black" d="M118172.76,-658.92C118172.76,-655.65 118172.76,-551 118172.76,-551 118172.76,-551 126625.19,-551 126625.19,-551 126625.19,-551 126625.19,-542.05 126625.19,-542.05"/>
<polygon fill="black" stroke="black" points="126628.69,-542.05 126625.19,-532.05 126621.69,-542.05 126628.69,-542.05"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_18_24 -->
<g id="edge972" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_18_24</title>
<path fill="none" stroke="black" d="M118049.43,-655.69C118049.43,-640.95 118049.43,-582 118049.43,-582 118049.43,-582 150868.5,-582 150868.5,-582 150868.5,-582 150868.5,-532 150868.5,-532 150868.5,-532 150974.05,-532 150974.05,-532"/>
<polygon fill="black" stroke="black" points="150974.05,-535.5 150984.05,-532 150974.05,-528.5 150974.05,-535.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_19_24 -->
<g id="edge975" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_19_24</title>
<path fill="none" stroke="black" d="M117934.74,-640.68C117934.74,-617.34 117934.74,-580 117934.74,-580 117934.74,-580 149809.5,-580 149809.5,-580 149809.5,-580 149809.5,-532 149809.5,-532 149809.5,-532 149915.05,-532 149915.05,-532"/>
<polygon fill="black" stroke="black" points="149915.05,-535.5 149925.05,-532 149915.05,-528.5 149915.05,-535.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_20_24 -->
<g id="edge978" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_20_24</title>
<path fill="none" stroke="black" d="M118081.17,-661C118697.59,-661 119754,-661 119754,-661 119754,-661 119754,-579 119754,-579 119754,-579 148750.5,-579 148750.5,-579 148750.5,-579 148750.5,-532 148750.5,-532 148750.5,-532 148856.05,-532 148856.05,-532"/>
<polygon fill="black" stroke="black" points="148856.05,-535.5 148866.05,-532 148856.05,-528.5 148856.05,-535.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_21_24 -->
<g id="edge981" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_21_24</title>
<path fill="none" stroke="black" d="M118044.84,-655C118448.06,-655 119013.68,-655 119013.68,-655 119013.68,-655 119013.68,-578 119013.68,-578 119013.68,-578 147691.5,-578 147691.5,-578 147691.5,-578 147691.5,-532 147691.5,-532 147691.5,-532 147797.05,-532 147797.05,-532"/>
<polygon fill="black" stroke="black" points="147797.05,-535.5 147807.05,-532 147797.05,-528.5 147797.05,-535.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_22_24 -->
<g id="edge984" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_22_24</title>
<path fill="none" stroke="black" d="M118039.23,-654C118409.96,-654 118910.45,-654 118910.45,-654 118910.45,-654 118910.45,-576 118910.45,-576 118910.45,-576 146632.5,-576 146632.5,-576 146632.5,-576 146632.5,-532 146632.5,-532 146632.5,-532 146738.05,-532 146738.05,-532"/>
<polygon fill="black" stroke="black" points="146738.05,-535.5 146748.05,-532 146738.05,-528.5 146738.05,-535.5"/>
</g>
<!-- kv_sync_2&#45;&gt;kv_cache_2_23_24 -->
<g id="edge987" class="edge">
<title>kv_sync_2&#45;&gt;kv_cache_2_23_24</title>
<path fill="none" stroke="black" d="M118032.8,-653C118370.18,-653 118807.23,-653 118807.23,-653 118807.23,-653 118807.23,-575 118807.23,-575 118807.23,-575 145573.34,-575 145573.34,-575 145573.34,-575 145573.34,-532 145573.34,-532 145573.34,-532 145678.92,-532 145678.92,-532"/>
<polygon fill="black" stroke="black" points="145678.92,-535.5 145688.92,-532 145678.92,-528.5 145678.92,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_0_8 -->
<g id="edge1087" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_0_8</title>
<path fill="none" stroke="black" d="M124498.74,-645C123230.25,-645 120012.06,-645 120012.06,-645 120012.06,-645 120012.06,-560.16 120012.06,-560.16"/>
<polygon fill="black" stroke="black" points="120015.56,-560.16 120012.06,-550.16 120008.56,-560.16 120015.56,-560.16"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_1_8 -->
<g id="edge1090" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_1_8</title>
<path fill="none" stroke="black" d="M124510.93,-647C123094.93,-647 119116.9,-647 119116.9,-647 119116.9,-647 119116.9,-560.22 119116.9,-560.22"/>
<polygon fill="black" stroke="black" points="119120.4,-560.22 119116.9,-550.22 119113.4,-560.22 119120.4,-560.22"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_2_8 -->
<g id="edge1093" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_2_8</title>
<path fill="none" stroke="black" d="M125526.6,-658.91C125526.6,-655.06 125526.6,-532 125526.6,-532 125526.6,-532 125633.32,-532 125633.32,-532"/>
<polygon fill="black" stroke="black" points="125633.32,-535.5 125643.32,-532 125633.32,-528.5 125633.32,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_3_8 -->
<g id="edge1096" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_3_8</title>
<path fill="none" stroke="black" d="M124573.89,-640.8C124573.89,-640.8 124573.89,-542.05 124573.89,-542.05"/>
<polygon fill="black" stroke="black" points="124577.39,-542.05 124573.89,-532.05 124570.39,-542.05 124577.39,-542.05"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_4_8 -->
<g id="edge1099" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_4_8</title>
<path fill="none" stroke="black" d="M124481.4,-658.91C124481.4,-655.06 124481.4,-532 124481.4,-532 124481.4,-532 124374.68,-532 124374.68,-532"/>
<polygon fill="black" stroke="black" points="124374.68,-528.5 124364.68,-532 124374.68,-535.5 124374.68,-528.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_5_8 -->
<g id="edge1102" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_5_8</title>
<path fill="none" stroke="black" d="M124480.68,-642C123909.75,-642 123076.04,-642 123076.04,-642 123076.04,-642 123076.04,-560.16 123076.04,-560.16"/>
<polygon fill="black" stroke="black" points="123079.54,-560.16 123076.04,-550.16 123072.54,-560.16 123079.54,-560.16"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_6_8 -->
<g id="edge1105" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_6_8</title>
<path fill="none" stroke="black" d="M124486.49,-643C123592.58,-643 121854,-643 121854,-643 121854,-643 121854,-560.33 121854,-560.33"/>
<polygon fill="black" stroke="black" points="121857.5,-560.33 121854,-550.33 121850.5,-560.33 121857.5,-560.33"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_7_8 -->
<g id="edge1108" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_7_8</title>
<path fill="none" stroke="black" d="M124492.67,-644C123373.09,-644 120804,-644 120804,-644 120804,-644 120804,-560.49 120804,-560.49"/>
<polygon fill="black" stroke="black" points="120807.5,-560.49 120804,-550.49 120800.5,-560.49 120807.5,-560.49"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_0_16 -->
<g id="edge1159" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_0_16</title>
<path fill="none" stroke="black" d="M124631.05,-667C124194.88,-667 123531.71,-667 123531.71,-667 123531.71,-667 123531.71,-704 123531.71,-704 123531.71,-704 51376,-704 51376,-704 51376,-704 51376,-560.08 51376,-560.08"/>
<polygon fill="black" stroke="black" points="51379.5,-560.08 51376,-550.08 51372.5,-560.08 51379.5,-560.08"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_1_16 -->
<g id="edge1162" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_1_16</title>
<path fill="none" stroke="black" d="M124636.86,-668C124228.51,-668 123625.55,-668 123625.55,-668 123625.55,-668 123625.55,-704 123625.55,-704 123625.55,-704 50326,-704 50326,-704 50326,-704 50326,-560.08 50326,-560.08"/>
<polygon fill="black" stroke="black" points="50329.5,-560.08 50326,-550.08 50322.5,-560.08 50329.5,-560.08"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_2_16 -->
<g id="edge1165" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_2_16</title>
<path fill="none" stroke="black" d="M124643.18,-669C124263.2,-669 123719.4,-669 123719.4,-669 123719.4,-669 123719.4,-705 123719.4,-705 123719.4,-705 49276,-705 49276,-705 49276,-705 49276,-560.19 49276,-560.19"/>
<polygon fill="black" stroke="black" points="49279.5,-560.19 49276,-550.19 49272.5,-560.19 49279.5,-560.19"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_3_16 -->
<g id="edge1168" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_3_16</title>
<path fill="none" stroke="black" d="M124649.15,-670C124298.21,-670 123813.24,-670 123813.24,-670 123813.24,-670 123813.24,-706 123813.24,-706 123813.24,-706 48226,-706 48226,-706 48226,-706 48226,-560.29 48226,-560.29"/>
<polygon fill="black" stroke="black" points="48229.5,-560.29 48226,-550.29 48222.5,-560.29 48229.5,-560.29"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_4_16 -->
<g id="edge1171" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_4_16</title>
<path fill="none" stroke="black" d="M124655.04,-671C124333.89,-671 123907.08,-671 123907.08,-671 123907.08,-671 123907.08,-707 123907.08,-707 123907.08,-707 47176,-707 47176,-707 47176,-707 47176,-560.07 47176,-560.07"/>
<polygon fill="black" stroke="black" points="47179.5,-560.07 47176,-550.07 47172.5,-560.07 47179.5,-560.07"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_5_16 -->
<g id="edge1174" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_5_16</title>
<path fill="none" stroke="black" d="M124661.25,-672C124370.72,-672 124000.92,-672 124000.92,-672 124000.92,-672 124000.92,-708 124000.92,-708 124000.92,-708 46126,-708 46126,-708 46126,-708 46126,-560.17 46126,-560.17"/>
<polygon fill="black" stroke="black" points="46129.5,-560.17 46126,-550.17 46122.5,-560.17 46129.5,-560.17"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_6_16 -->
<g id="edge1177" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_6_16</title>
<path fill="none" stroke="black" d="M124556.32,-659.14C124556.32,-662.08 124556.32,-709 124556.32,-709 124556.32,-709 45076,-709 45076,-709 45076,-709 45076,-560.28 45076,-560.28"/>
<polygon fill="black" stroke="black" points="45079.5,-560.28 45076,-550.28 45072.5,-560.28 45079.5,-560.28"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_7_16 -->
<g id="edge1180" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_7_16</title>
<path fill="none" stroke="black" d="M124637.72,-668.35C124637.72,-683.08 124637.72,-710 124637.72,-710 124637.72,-710 44026,-710 44026,-710 44026,-710 44026,-560.05 44026,-560.05"/>
<polygon fill="black" stroke="black" points="44029.5,-560.05 44026,-550.05 44022.5,-560.05 44029.5,-560.05"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_8_16 -->
<g id="edge1183" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_8_16</title>
<path fill="none" stroke="black" d="M124719.11,-677.19C124719.11,-692.18 124719.11,-711 124719.11,-711 124719.11,-711 42976,-711 42976,-711 42976,-711 42976,-560.15 42976,-560.15"/>
<polygon fill="black" stroke="black" points="42979.5,-560.15 42976,-550.15 42972.5,-560.15 42979.5,-560.15"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_9_16 -->
<g id="edge1186" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_9_16</title>
<path fill="none" stroke="black" d="M124800.51,-677.24C124800.51,-692.57 124800.51,-712 124800.51,-712 124800.51,-712 41926,-712 41926,-712 41926,-712 41926,-560.25 41926,-560.25"/>
<polygon fill="black" stroke="black" points="41929.5,-560.25 41926,-550.25 41922.5,-560.25 41929.5,-560.25"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_10_16 -->
<g id="edge1189" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_10_16</title>
<path fill="none" stroke="black" d="M124624.99,-666C124158.96,-666 123429,-666 123429,-666 123429,-666 123429,-740 123429,-740 123429,-740 58258.16,-740 58258.16,-740 58258.16,-740 58258.16,-532 58258.16,-532 58258.16,-532 58150.05,-532 58150.05,-532"/>
<polygon fill="black" stroke="black" points="58150.05,-528.5 58140.05,-532 58150.05,-535.5 58150.05,-528.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_11_16 -->
<g id="edge1192" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_11_16</title>
<path fill="none" stroke="black" d="M124667.05,-673C124408.23,-673 124094.76,-673 124094.76,-673 124094.76,-673 124094.76,-742 124094.76,-742 124094.76,-742 57196.5,-742 57196.5,-742 57196.5,-742 57196.5,-532 57196.5,-532 57196.5,-532 57090.95,-532 57090.95,-532"/>
<polygon fill="black" stroke="black" points="57090.95,-528.5 57080.95,-532 57090.95,-535.5 57090.95,-528.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_12_16 -->
<g id="edge1195" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_12_16</title>
<path fill="none" stroke="black" d="M124673.23,-674C124447.27,-674 124188.6,-674 124188.6,-674 124188.6,-674 124188.6,-743 124188.6,-743 124188.6,-743 56137.5,-743 56137.5,-743 56137.5,-743 56137.5,-532 56137.5,-532 56137.5,-532 56031.95,-532 56031.95,-532"/>
<polygon fill="black" stroke="black" points="56031.95,-528.5 56021.95,-532 56031.95,-535.5 56031.95,-528.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_13_16 -->
<g id="edge1198" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_13_16</title>
<path fill="none" stroke="black" d="M124679.11,-675C124487.59,-675 124282.45,-675 124282.45,-675 124282.45,-675 124282.45,-744 124282.45,-744 124282.45,-744 55078.22,-744 55078.22,-744 55078.22,-744 55078.22,-532 55078.22,-532 55078.22,-532 54973.06,-532 54973.06,-532"/>
<polygon fill="black" stroke="black" points="54973.06,-528.5 54963.06,-532 54973.06,-535.5 54973.06,-528.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_14_16 -->
<g id="edge1201" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_14_16</title>
<path fill="none" stroke="black" d="M124685.09,-676C124529.86,-676 124376.29,-676 124376.29,-676 124376.29,-676 124376.29,-745 124376.29,-745 124376.29,-745 53787.83,-745 53787.83,-745 53787.83,-745 53787.83,-560.16 53787.83,-560.16"/>
<polygon fill="black" stroke="black" points="53791.33,-560.16 53787.83,-550.16 53784.33,-560.16 53791.33,-560.16"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_15_16 -->
<g id="edge1204" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_15_16</title>
<path fill="none" stroke="black" d="M124618.9,-665C123970.76,-665 122731.96,-665 122731.96,-665 122731.96,-665 122731.96,-746 122731.96,-746 122731.96,-746 52362.67,-746 52362.67,-746 52362.67,-746 52362.67,-560.25 52362.67,-560.25"/>
<polygon fill="black" stroke="black" points="52366.17,-560.25 52362.67,-550.25 52359.17,-560.25 52366.17,-560.25"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_0_24 -->
<g id="edge1255" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_0_24</title>
<path fill="none" stroke="black" d="M125370.28,-677.16C125370.28,-682.04 125370.28,-686 125370.28,-686 125370.28,-686 170380,-686 170380,-686 170380,-686 170380,-560.27 170380,-560.27"/>
<polygon fill="black" stroke="black" points="170383.5,-560.27 170380,-550.27 170376.5,-560.27 170383.5,-560.27"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_1_24 -->
<g id="edge1258" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_1_24</title>
<path fill="none" stroke="black" d="M125451.68,-677.16C125451.68,-682.04 125451.68,-686 125451.68,-686 125451.68,-686 169330,-686 169330,-686 169330,-686 169330,-560.27 169330,-560.27"/>
<polygon fill="black" stroke="black" points="169333.5,-560.27 169330,-550.27 169326.5,-560.27 169333.5,-560.27"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_2_24 -->
<g id="edge1261" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_2_24</title>
<path fill="none" stroke="black" d="M125497.25,-671C125523.73,-671 125539.74,-671 125539.74,-671 125539.74,-671 125539.74,-685 125539.74,-685 125539.74,-685 168280,-685 168280,-685 168280,-685 168280,-560.15 168280,-560.15"/>
<polygon fill="black" stroke="black" points="168283.5,-560.15 168280,-550.15 168276.5,-560.15 168283.5,-560.15"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_3_24 -->
<g id="edge1264" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_3_24</title>
<path fill="none" stroke="black" d="M125467.13,-666C125512.19,-666 125541.6,-666 125541.6,-666 125541.6,-666 125541.6,-684 125541.6,-684 125541.6,-684 167230,-684 167230,-684 167230,-684 167230,-560.03 167230,-560.03"/>
<polygon fill="black" stroke="black" points="167233.5,-560.03 167230,-550.03 167226.5,-560.03 167233.5,-560.03"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_4_24 -->
<g id="edge1267" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_4_24</title>
<path fill="none" stroke="black" d="M125437.21,-661C125499.75,-661 125543.47,-661 125543.47,-661 125543.47,-661 125543.47,-683 125543.47,-683 125543.47,-683 166180,-683 166180,-683 166180,-683 166180,-560.21 166180,-560.21"/>
<polygon fill="black" stroke="black" points="166183.5,-560.21 166180,-550.21 166176.5,-560.21 166183.5,-560.21"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_5_24 -->
<g id="edge1270" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_5_24</title>
<path fill="none" stroke="black" d="M125406.98,-656C125486.18,-656 125545.33,-656 125545.33,-656 125545.33,-656 125545.33,-682 125545.33,-682 125545.33,-682 165130,-682 165130,-682 165130,-682 165130,-560.09 165130,-560.09"/>
<polygon fill="black" stroke="black" points="165133.5,-560.09 165130,-550.09 165126.5,-560.09 165133.5,-560.09"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_6_24 -->
<g id="edge1273" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_6_24</title>
<path fill="none" stroke="black" d="M125376.82,-651C125471.6,-651 125547.2,-651 125547.2,-651 125547.2,-651 125547.2,-681 125547.2,-681 125547.2,-681 164080,-681 164080,-681 164080,-681 164080,-560.27 164080,-560.27"/>
<polygon fill="black" stroke="black" points="164083.5,-560.27 164080,-550.27 164076.5,-560.27 164083.5,-560.27"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_7_24 -->
<g id="edge1276" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_7_24</title>
<path fill="none" stroke="black" d="M125346.87,-646C125456.05,-646 125549.06,-646 125549.06,-646 125549.06,-646 125549.06,-680 125549.06,-680 125549.06,-680 163030,-680 163030,-680 163030,-680 163030,-560.15 163030,-560.15"/>
<polygon fill="black" stroke="black" points="163033.5,-560.15 163030,-550.15 163026.5,-560.15 163033.5,-560.15"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_8_24 -->
<g id="edge1279" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_8_24</title>
<path fill="none" stroke="black" d="M125434.11,-658.85C125434.11,-655.86 125434.11,-608 125434.11,-608 125434.11,-608 161980,-608 161980,-608 161980,-608 161980,-560.01 161980,-560.01"/>
<polygon fill="black" stroke="black" points="161983.5,-560.01 161980,-550.01 161976.5,-560.01 161983.5,-560.01"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_9_24 -->
<g id="edge1282" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_9_24</title>
<path fill="none" stroke="black" d="M125348.09,-646.17C125348.09,-630.48 125348.09,-606 125348.09,-606 125348.09,-606 160930,-606 160930,-606 160930,-606 160930,-560.29 160930,-560.29"/>
<polygon fill="black" stroke="black" points="160933.5,-560.29 160930,-550.29 160926.5,-560.29 160933.5,-560.29"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_10_24 -->
<g id="edge1285" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_10_24</title>
<path fill="none" stroke="black" d="M125262.06,-640.97C125262.06,-624.6 125262.06,-603 125262.06,-603 125262.06,-603 159345.5,-603 159345.5,-603 159345.5,-603 159345.5,-532 159345.5,-532 159345.5,-532 159451.05,-532 159451.05,-532"/>
<polygon fill="black" stroke="black" points="159451.05,-535.5 159461.05,-532 159451.05,-528.5 159451.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_11_24 -->
<g id="edge1288" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_11_24</title>
<path fill="none" stroke="black" d="M125176.04,-640.96C125176.04,-624.27 125176.04,-602 125176.04,-602 125176.04,-602 158286.5,-602 158286.5,-602 158286.5,-602 158286.5,-532 158286.5,-532 158286.5,-532 158392.05,-532 158392.05,-532"/>
<polygon fill="black" stroke="black" points="158392.05,-535.5 158402.05,-532 158392.05,-528.5 158392.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_12_24 -->
<g id="edge1291" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_12_24</title>
<path fill="none" stroke="black" d="M125090.02,-640.98C125090.02,-623.63 125090.02,-600 125090.02,-600 125090.02,-600 157227.5,-600 157227.5,-600 157227.5,-600 157227.5,-532 157227.5,-532 157227.5,-532 157333.05,-532 157333.05,-532"/>
<polygon fill="black" stroke="black" points="157333.05,-535.5 157343.05,-532 157333.05,-528.5 157333.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_13_24 -->
<g id="edge1294" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_13_24</title>
<path fill="none" stroke="black" d="M125004,-640.89C125004,-621.66 125004,-594 125004,-594 125004,-594 156168.5,-594 156168.5,-594 156168.5,-594 156168.5,-532 156168.5,-532 156168.5,-532 156274.05,-532 156274.05,-532"/>
<polygon fill="black" stroke="black" points="156274.05,-535.5 156284.05,-532 156274.05,-528.5 156274.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_14_24 -->
<g id="edge1297" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_14_24</title>
<path fill="none" stroke="black" d="M124917.98,-640.78C124917.98,-620.63 124917.98,-591 124917.98,-591 124917.98,-591 155109.5,-591 155109.5,-591 155109.5,-591 155109.5,-532 155109.5,-532 155109.5,-532 155215.05,-532 155215.05,-532"/>
<polygon fill="black" stroke="black" points="155215.05,-535.5 155225.05,-532 155215.05,-528.5 155215.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_15_24 -->
<g id="edge1300" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_15_24</title>
<path fill="none" stroke="black" d="M124831.96,-640.72C124831.96,-619.68 124831.96,-588 124831.96,-588 124831.96,-588 154050.5,-588 154050.5,-588 154050.5,-588 154050.5,-532 154050.5,-532 154050.5,-532 154156.05,-532 154156.05,-532"/>
<polygon fill="black" stroke="black" points="154156.05,-535.5 154166.05,-532 154156.05,-528.5 154156.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_16_24 -->
<g id="edge1303" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_16_24</title>
<path fill="none" stroke="black" d="M124745.94,-640.96C124745.94,-619.34 124745.94,-586 124745.94,-586 124745.94,-586 152991.5,-586 152991.5,-586 152991.5,-586 152991.5,-532 152991.5,-532 152991.5,-532 153097.05,-532 153097.05,-532"/>
<polygon fill="black" stroke="black" points="153097.05,-535.5 153107.05,-532 153097.05,-528.5 153097.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_17_24 -->
<g id="edge1306" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_17_24</title>
<path fill="none" stroke="black" d="M124659.91,-640.99C124659.91,-618.51 124659.91,-583 124659.91,-583 124659.91,-583 151930,-583 151930,-583 151930,-583 151930,-532 151930,-532 151930,-532 152038.07,-532 152038.07,-532"/>
<polygon fill="black" stroke="black" points="152038.07,-535.5 152048.07,-532 152038.07,-528.5 152038.07,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_18_24 -->
<g id="edge1309" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_18_24</title>
<path fill="none" stroke="black" d="M125288.89,-677.23C125288.89,-703.01 125288.89,-747 125288.89,-747 125288.89,-747 176730,-747 176730,-747 176730,-747 176730,-560.33 176730,-560.33"/>
<polygon fill="black" stroke="black" points="176733.5,-560.33 176730,-550.33 176726.5,-560.33 176733.5,-560.33"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_19_24 -->
<g id="edge1312" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_19_24</title>
<path fill="none" stroke="black" d="M124881.91,-677.23C124881.91,-710.8 124881.91,-779 124881.91,-779 124881.91,-779 175141.5,-779 175141.5,-779 175141.5,-779 175141.5,-532 175141.5,-532 175141.5,-532 175247.05,-532 175247.05,-532"/>
<polygon fill="black" stroke="black" points="175247.05,-535.5 175257.05,-532 175247.05,-528.5 175247.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_20_24 -->
<g id="edge1315" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_20_24</title>
<path fill="none" stroke="black" d="M124963.3,-677.06C124963.3,-709.21 124963.3,-773 124963.3,-773 124963.3,-773 174082.5,-773 174082.5,-773 174082.5,-773 174082.5,-532 174082.5,-532 174082.5,-532 174188.05,-532 174188.05,-532"/>
<polygon fill="black" stroke="black" points="174188.05,-535.5 174198.05,-532 174188.05,-528.5 174188.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_21_24 -->
<g id="edge1318" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_21_24</title>
<path fill="none" stroke="black" d="M125044.7,-677.32C125044.7,-708.13 125044.7,-767 125044.7,-767 125044.7,-767 173023.5,-767 173023.5,-767 173023.5,-767 173023.5,-532 173023.5,-532 173023.5,-532 173129.05,-532 173129.05,-532"/>
<polygon fill="black" stroke="black" points="173129.05,-535.5 173139.05,-532 173129.05,-528.5 173129.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_22_24 -->
<g id="edge1321" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_22_24</title>
<path fill="none" stroke="black" d="M125126.09,-677.24C125126.09,-706.57 125126.09,-761 125126.09,-761 125126.09,-761 171964.5,-761 171964.5,-761 171964.5,-761 171964.5,-532 171964.5,-532 171964.5,-532 172070.05,-532 172070.05,-532"/>
<polygon fill="black" stroke="black" points="172070.05,-535.5 172080.05,-532 172070.05,-528.5 172070.05,-535.5"/>
</g>
<!-- kv_sync_3&#45;&gt;kv_cache_3_23_24 -->
<g id="edge1324" class="edge">
<title>kv_sync_3&#45;&gt;kv_cache_3_23_24</title>
<path fill="none" stroke="black" d="M125207.49,-677.06C125207.49,-704.87 125207.49,-755 125207.49,-755 125207.49,-755 170905.34,-755 170905.34,-755 170905.34,-755 170905.34,-532 170905.34,-532 170905.34,-532 171010.92,-532 171010.92,-532"/>
<polygon fill="black" stroke="black" points="171010.92,-535.5 171020.92,-532 171010.92,-528.5 171010.92,-535.5"/>
</g>
<!-- async_comm -->
<g id="node612" class="node">
<title>async_comm</title>
<polygon fill="lightyellow" stroke="black" points="290242.14,-430 289443.35,-430 289237.86,-394 290036.65,-394 290242.14,-430"/>
<text text-anchor="middle" x="289740" y="-409.5" font-family="Arial" font-size="10.00">&lt;b&gt;Asynchronous Communication&lt;/b&gt;&lt;br/&gt;Overlaps attention computation&lt;br/&gt;With FFN operations&lt;br/&gt;85% overlap efficiency</text>
</g>
<!-- async_comm&#45;&gt;hier_reduce_0_24 -->
<g id="edge1375" class="edge">
<title>async_comm&#45;&gt;hier_reduce_0_24</title>
<path fill="none" stroke="black" d="M289740,-393.92C289740,-392.15 289740,-391 289740,-391 289740,-391 186734.81,-391 186734.81,-391 186734.81,-391 186734.81,-327.19 186734.81,-327.19"/>
<polygon fill="black" stroke="black" points="186738.31,-327.19 186734.81,-317.19 186731.31,-327.19 186738.31,-327.19"/>
</g>
<!-- async_comm&#45;&gt;hier_reduce_1_24 -->
<g id="edge1376" class="edge">
<title>async_comm&#45;&gt;hier_reduce_1_24</title>
<path fill="none" stroke="black" d="M289991.16,-393.84C289991.16,-361.9 289991.16,-299 289991.16,-299 289991.16,-299 211663.05,-299 211663.05,-299"/>
<polygon fill="black" stroke="black" points="211663.05,-295.5 211653.05,-299 211663.05,-302.5 211663.05,-295.5"/>
</g>
<!-- async_comm&#45;&gt;hier_reduce_2_24 -->
<g id="edge1377" class="edge">
<title>async_comm&#45;&gt;hier_reduce_2_24</title>
<path fill="none" stroke="black" d="M289488.84,-393.85C289488.84,-392.7 289488.84,-392 289488.84,-392 289488.84,-392 144434.9,-392 144434.9,-392 144434.9,-392 144434.9,-328.31 144434.9,-328.31"/>
<polygon fill="black" stroke="black" points="144438.4,-328.31 144434.9,-318.31 144431.4,-328.31 144438.4,-328.31"/>
</g>
<!-- async_comm&#45;&gt;hier_reduce_3_24 -->
<g id="edge1378" class="edge">
<title>async_comm&#45;&gt;hier_reduce_3_24</title>
<path fill="none" stroke="black" d="M289740,-430.23C289740,-456.01 289740,-500 289740,-500 289740,-500 169779.28,-500 169779.28,-500 169779.28,-500 169779.28,-327.91 169779.28,-327.91"/>
<polygon fill="black" stroke="black" points="169782.78,-327.91 169779.28,-317.91 169775.78,-327.91 169782.78,-327.91"/>
</g>
<!-- allreduce_final_output -->
<g id="node626" class="node">
<title>allreduce_final_output</title>
<polygon fill="lightyellow" stroke="black" points="303928.84,-108 303386.64,-108 303247.16,-72 303789.36,-72 303928.84,-108"/>
<text text-anchor="middle" x="303588" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- final_output_0&#45;&gt;allreduce_final_output -->
<g id="edge1380" class="edge">
<title>final_output_0&#45;&gt;allreduce_final_output</title>
<path fill="none" stroke="black" d="M302630,-143.78C302630,-125.17 302630,-99 302630,-99 302630,-99 303341.5,-99 303341.5,-99"/>
<polygon fill="black" stroke="black" points="303341.5,-102.5 303351.5,-99 303341.5,-95.5 303341.5,-102.5"/>
</g>
<!-- final_output_1&#45;&gt;allreduce_final_output -->
<g id="edge1383" class="edge">
<title>final_output_1&#45;&gt;allreduce_final_output</title>
<path fill="none" stroke="black" d="M305825,-143.62C305825,-119.72 305825,-81 305825,-81 305825,-81 303834.49,-81 303834.49,-81"/>
<polygon fill="black" stroke="black" points="303834.49,-77.5 303824.49,-81 303834.49,-84.5 303834.49,-77.5"/>
</g>
<!-- final_output_2&#45;&gt;allreduce_final_output -->
<g id="edge1386" class="edge">
<title>final_output_2&#45;&gt;allreduce_final_output</title>
<path fill="none" stroke="black" d="M305186,-143.83C305186,-122.5 305186,-90 305186,-90 305186,-90 303869.53,-90 303869.53,-90"/>
<polygon fill="black" stroke="black" points="303869.53,-86.5 303859.53,-90 303869.53,-93.5 303869.53,-86.5"/>
</g>
<!-- final_output_3&#45;&gt;allreduce_final_output -->
<g id="edge1389" class="edge">
<title>final_output_3&#45;&gt;allreduce_final_output</title>
<path fill="none" stroke="black" d="M301991,-143.83C301991,-122.5 301991,-90 301991,-90 301991,-90 303306.64,-90 303306.64,-90"/>
<polygon fill="black" stroke="black" points="303306.64,-93.5 303316.64,-90 303306.64,-86.5 303306.64,-93.5"/>
</g>
<!-- final_output_4&#45;&gt;allreduce_final_output -->
<g id="edge1392" class="edge">
<title>final_output_4&#45;&gt;allreduce_final_output</title>
<path fill="none" stroke="black" d="M303763.21,-143.83C303763.21,-143.83 303763.21,-118.41 303763.21,-118.41"/>
<polygon fill="black" stroke="black" points="303766.71,-118.41 303763.21,-108.41 303759.71,-118.41 303766.71,-118.41"/>
</g>
<!-- final_output_5&#45;&gt;allreduce_final_output -->
<g id="edge1395" class="edge">
<title>final_output_5&#45;&gt;allreduce_final_output</title>
<path fill="none" stroke="black" d="M301352,-143.62C301352,-119.72 301352,-81 301352,-81 301352,-81 303271.78,-81 303271.78,-81"/>
<polygon fill="black" stroke="black" points="303271.78,-84.5 303281.78,-81 303271.78,-77.5 303271.78,-84.5"/>
</g>
<!-- final_output_6&#45;&gt;allreduce_final_output -->
<g id="edge1398" class="edge">
<title>final_output_6&#45;&gt;allreduce_final_output</title>
<path fill="none" stroke="black" d="M303413.29,-143.83C303413.29,-143.83 303413.29,-118.41 303413.29,-118.41"/>
<polygon fill="black" stroke="black" points="303416.79,-118.41 303413.29,-108.41 303409.79,-118.41 303416.79,-118.41"/>
</g>
<!-- final_output_7&#45;&gt;allreduce_final_output -->
<g id="edge1401" class="edge">
<title>final_output_7&#45;&gt;allreduce_final_output</title>
<path fill="none" stroke="black" d="M304547,-143.78C304547,-125.17 304547,-99 304547,-99 304547,-99 303904.07,-99 303904.07,-99"/>
<polygon fill="black" stroke="black" points="303904.07,-95.5 303894.07,-99 303904.07,-102.5 303904.07,-95.5"/>
</g>
<!-- final_output -->
<g id="node621" class="node">
<title>final_output</title>
<ellipse fill="lightblue" stroke="black" cx="303588" cy="-18" rx="407.89" ry="18"/>
<text text-anchor="middle" x="303588" y="-15.5" font-family="Arial" font-size="10.00">&lt;b&gt;Final Output&lt;/b&gt;&lt;br/&gt;Aggregated across 8 base GPUs&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=32000]</text>
</g>
<!-- allreduce_pos -->
<g id="node623" class="node">
<title>allreduce_pos</title>
<polygon fill="lightyellow" stroke="black" points="12985.84,-749 12443.64,-749 12304.16,-713 12846.36,-713 12985.84,-749"/>
<text text-anchor="middle" x="12645" y="-728.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_ffn_up -->
<g id="node624" class="node">
<title>allreduce_ffn_up</title>
<polygon fill="lightyellow" stroke="black" points="13685.84,-749 13143.64,-749 13004.16,-713 13546.36,-713 13685.84,-749"/>
<text text-anchor="middle" x="13345" y="-728.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_ffn_down -->
<g id="node625" class="node">
<title>allreduce_ffn_down</title>
<polygon fill="lightyellow" stroke="black" points="14385.84,-749 13843.64,-749 13704.16,-713 14246.36,-713 14385.84,-749"/>
<text text-anchor="middle" x="14045" y="-728.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 base GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_final_output&#45;&gt;final_output -->
<g id="edge1381" class="edge">
<title>allreduce_final_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M303322.84,-71.83C303322.84,-71.83 303322.84,-42.07 303322.84,-42.07"/>
<polygon fill="black" stroke="black" points="303326.34,-42.07 303322.84,-32.07 303319.34,-42.07 303326.34,-42.07"/>
</g>
<!-- allreduce_final_output&#45;&gt;final_output -->
<g id="edge1384" class="edge">
<title>allreduce_final_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M303398.6,-71.83C303398.6,-71.83 303398.6,-43.96 303398.6,-43.96"/>
<polygon fill="black" stroke="black" points="303402.1,-43.96 303398.6,-33.96 303395.1,-43.96 303402.1,-43.96"/>
</g>
<!-- allreduce_final_output&#45;&gt;final_output -->
<g id="edge1387" class="edge">
<title>allreduce_final_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M303474.36,-71.83C303474.36,-71.83 303474.36,-45.42 303474.36,-45.42"/>
<polygon fill="black" stroke="black" points="303477.86,-45.42 303474.36,-35.42 303470.86,-45.42 303477.86,-45.42"/>
</g>
<!-- allreduce_final_output&#45;&gt;final_output -->
<g id="edge1390" class="edge">
<title>allreduce_final_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M303550.12,-71.83C303550.12,-71.83 303550.12,-46.41 303550.12,-46.41"/>
<polygon fill="black" stroke="black" points="303553.62,-46.41 303550.12,-36.41 303546.62,-46.41 303553.62,-46.41"/>
</g>
<!-- allreduce_final_output&#45;&gt;final_output -->
<g id="edge1393" class="edge">
<title>allreduce_final_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M303625.88,-71.83C303625.88,-71.83 303625.88,-46.41 303625.88,-46.41"/>
<polygon fill="black" stroke="black" points="303629.38,-46.41 303625.88,-36.41 303622.38,-46.41 303629.38,-46.41"/>
</g>
<!-- allreduce_final_output&#45;&gt;final_output -->
<g id="edge1396" class="edge">
<title>allreduce_final_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M303701.64,-71.83C303701.64,-71.83 303701.64,-45.42 303701.64,-45.42"/>
<polygon fill="black" stroke="black" points="303705.14,-45.42 303701.64,-35.42 303698.14,-45.42 303705.14,-45.42"/>
</g>
<!-- allreduce_final_output&#45;&gt;final_output -->
<g id="edge1399" class="edge">
<title>allreduce_final_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M303777.4,-71.83C303777.4,-71.83 303777.4,-43.96 303777.4,-43.96"/>
<polygon fill="black" stroke="black" points="303780.9,-43.96 303777.4,-33.96 303773.9,-43.96 303780.9,-43.96"/>
</g>
<!-- allreduce_final_output&#45;&gt;final_output -->
<g id="edge1402" class="edge">
<title>allreduce_final_output&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M303853.16,-88.22C303853.16,-88.22 303853.16,-41.74 303853.16,-41.74"/>
<polygon fill="black" stroke="black" points="303856.66,-41.74 303853.16,-31.74 303849.66,-41.74 303856.66,-41.74"/>
</g>
</g>
</svg>
