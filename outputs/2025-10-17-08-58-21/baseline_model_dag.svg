<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_model_dag Pages: 1 -->
<svg width="2160pt" height="271pt"
 viewBox="0.00 0.00 2160.00 270.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.09 0.09) rotate(0) translate(4 3158)">
<title>baseline_model_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3158 25221.21,-3158 25221.21,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_embedding</title>
<path fill="none" stroke="black" d="M6682,-2965C6682,-2965 11760,-2965 11760,-2965 11766,-2965 11772,-2971 11772,-2977 11772,-2977 11772,-3098 11772,-3098 11772,-3104 11766,-3110 11760,-3110 11760,-3110 6682,-3110 6682,-3110 6676,-3110 6670,-3104 6670,-3098 6670,-3098 6670,-2977 6670,-2977 6670,-2971 6676,-2965 6682,-2965"/>
<text text-anchor="middle" x="9221" y="-3096.4" font-family="Times,serif" font-size="12.00">Embedding Layer (Pipeline Stage 0, TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<path fill="none" stroke="black" d="M20,-2308C20,-2308 15250,-2308 15250,-2308 15256,-2308 15262,-2314 15262,-2320 15262,-2320 15262,-2945 15262,-2945 15262,-2951 15256,-2957 15250,-2957 15250,-2957 20,-2957 20,-2957 14,-2957 8,-2951 8,-2945 8,-2945 8,-2320 8,-2320 8,-2314 14,-2308 20,-2308"/>
<text text-anchor="middle" x="7635" y="-2943.4" font-family="Times,serif" font-size="12.00">Layer 0 (Pipeline Stage 0, TP=8)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M283,-1587C283,-1587 15606,-1587 15606,-1587 15612,-1587 15618,-1593 15618,-1599 15618,-1599 15618,-2224 15618,-2224 15618,-2230 15612,-2236 15606,-2236 15606,-2236 283,-2236 283,-2236 277,-2236 271,-2230 271,-2224 271,-2224 271,-1599 271,-1599 271,-1593 277,-1587 283,-1587"/>
<text text-anchor="middle" x="7944.5" y="-2222.4" font-family="Times,serif" font-size="12.00">Layer 1 (Pipeline Stage 1, TP=8)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M1312,-866C1312,-866 16539,-866 16539,-866 16545,-866 16551,-872 16551,-878 16551,-878 16551,-1503 16551,-1503 16551,-1509 16545,-1515 16539,-1515 16539,-1515 1312,-1515 1312,-1515 1306,-1515 1300,-1509 1300,-1503 1300,-1503 1300,-878 1300,-878 1300,-872 1306,-866 1312,-866"/>
<text text-anchor="middle" x="8925.5" y="-1501.4" font-family="Times,serif" font-size="12.00">Layer 2 (Pipeline Stage 0, TP=8)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M2144,-145C2144,-145 17467,-145 17467,-145 17473,-145 17479,-151 17479,-157 17479,-157 17479,-782 17479,-782 17479,-788 17473,-794 17467,-794 17467,-794 2144,-794 2144,-794 2138,-794 2132,-788 2132,-782 2132,-782 2132,-157 2132,-157 2132,-151 2138,-145 2144,-145"/>
<text text-anchor="middle" x="9805.5" y="-780.4" font-family="Times,serif" font-size="12.00">Layer 3 (Pipeline Stage 1, TP=8)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M10878,-64C10878,-64 15788,-64 15788,-64 15794,-64 15800,-70 15800,-76 15800,-76 15800,-125 15800,-125 15800,-131 15794,-137 15788,-137 15788,-137 10878,-137 10878,-137 10872,-137 10866,-131 10866,-125 10866,-125 10866,-76 10866,-76 10866,-70 10872,-64 10878,-64"/>
<text text-anchor="middle" x="13333" y="-123.4" font-family="Times,serif" font-size="12.00">Output Layer (Pipeline Stage 1, TP=8)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="9221" cy="-3136" rx="203.85" ry="18"/>
<text text-anchor="middle" x="9221" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;Input&lt;/b&gt;&lt;br/&gt;Input: [batch_size=1024, seq_len=?, vocab_size=32000]</text>
</g>
<!-- embed_0 -->
<g id="node2" class="node">
<title>embed_0</title>
<polygon fill="lightgreen" stroke="black" points="7298,-3081 6678,-3081 6678,-3045 7298,-3045 7298,-3081"/>
<text text-anchor="middle" x="6988" y="-3060.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;embed_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M9044.38,-3145C8516.66,-3145 6988,-3145 6988,-3145 6988,-3145 6988,-3091.2 6988,-3091.2"/>
<polygon fill="black" stroke="black" points="6991.5,-3091.2 6988,-3081.2 6984.5,-3091.2 6991.5,-3091.2"/>
</g>
<!-- embed_1 -->
<g id="node3" class="node">
<title>embed_1</title>
<polygon fill="lightgreen" stroke="black" points="7936,-3081 7316,-3081 7316,-3045 7936,-3045 7936,-3081"/>
<text text-anchor="middle" x="7626" y="-3060.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;embed_1 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;embed_1</title>
<path fill="none" stroke="black" d="M9016.97,-3136C8586.78,-3136 7626,-3136 7626,-3136 7626,-3136 7626,-3091.04 7626,-3091.04"/>
<polygon fill="black" stroke="black" points="7629.5,-3091.04 7626,-3081.04 7622.5,-3091.04 7629.5,-3091.04"/>
</g>
<!-- embed_2 -->
<g id="node4" class="node">
<title>embed_2</title>
<polygon fill="lightgreen" stroke="black" points="8574,-3081 7954,-3081 7954,-3045 8574,-3045 8574,-3081"/>
<text text-anchor="middle" x="8264" y="-3060.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;embed_2 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;embed_2</title>
<path fill="none" stroke="black" d="M9044.36,-3127C8767.84,-3127 8264,-3127 8264,-3127 8264,-3127 8264,-3091.17 8264,-3091.17"/>
<polygon fill="black" stroke="black" points="8267.5,-3091.17 8264,-3081.17 8260.5,-3091.17 8267.5,-3091.17"/>
</g>
<!-- embed_3 -->
<g id="node5" class="node">
<title>embed_3</title>
<polygon fill="lightgreen" stroke="black" points="9212,-3081 8592,-3081 8592,-3045 9212,-3045 9212,-3081"/>
<text text-anchor="middle" x="8902" y="-3060.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;embed_3 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;embed_3</title>
<path fill="none" stroke="black" d="M9114.66,-3120.52C9114.66,-3120.52 9114.66,-3091.03 9114.66,-3091.03"/>
<polygon fill="black" stroke="black" points="9118.16,-3091.03 9114.66,-3081.03 9111.16,-3091.03 9118.16,-3091.03"/>
</g>
<!-- embed_4 -->
<g id="node6" class="node">
<title>embed_4</title>
<polygon fill="lightgreen" stroke="black" points="9850,-3081 9230,-3081 9230,-3045 9850,-3045 9850,-3081"/>
<text text-anchor="middle" x="9540" y="-3060.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;embed_4 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;embed_4</title>
<path fill="none" stroke="black" d="M9268.94,-3118.33C9268.94,-3118.33 9268.94,-3091.02 9268.94,-3091.02"/>
<polygon fill="black" stroke="black" points="9272.44,-3091.02 9268.94,-3081.02 9265.44,-3091.02 9272.44,-3091.02"/>
</g>
<!-- embed_5 -->
<g id="node7" class="node">
<title>embed_5</title>
<polygon fill="lightgreen" stroke="black" points="10488,-3081 9868,-3081 9868,-3045 10488,-3045 10488,-3081"/>
<text text-anchor="middle" x="10178" y="-3060.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;embed_5 -->
<g id="edge11" class="edge">
<title>input&#45;&gt;embed_5</title>
<path fill="none" stroke="black" d="M9307.87,-3119.65C9307.87,-3106.43 9307.87,-3090 9307.87,-3090 9307.87,-3090 9975.6,-3090 9975.6,-3090 9975.6,-3090 9975.6,-3089.12 9975.6,-3089.12"/>
<polygon fill="black" stroke="black" points="9979.1,-3091.16 9975.6,-3081.16 9972.1,-3091.16 9979.1,-3091.16"/>
</g>
<!-- embed_6 -->
<g id="node8" class="node">
<title>embed_6</title>
<polygon fill="lightgreen" stroke="black" points="11126,-3081 10506,-3081 10506,-3045 11126,-3045 11126,-3081"/>
<text text-anchor="middle" x="10816" y="-3060.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;embed_6 -->
<g id="edge13" class="edge">
<title>input&#45;&gt;embed_6</title>
<path fill="none" stroke="black" d="M9346.81,-3121.8C9346.81,-3111.37 9346.81,-3099 9346.81,-3099 9346.81,-3099 10623.6,-3099 10623.6,-3099 10623.6,-3099 10623.6,-3091.42 10623.6,-3091.42"/>
<polygon fill="black" stroke="black" points="10627.1,-3091.42 10623.6,-3081.42 10620.1,-3091.42 10627.1,-3091.42"/>
</g>
<!-- embed_7 -->
<g id="node9" class="node">
<title>embed_7</title>
<polygon fill="lightgreen" stroke="black" points="11764,-3081 11144,-3081 11144,-3045 11764,-3045 11764,-3081"/>
<text text-anchor="middle" x="11454" y="-3060.5" font-family="Arial" font-size="10.00">&lt;b&gt;Token Embedding&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- input&#45;&gt;embed_7 -->
<g id="edge15" class="edge">
<title>input&#45;&gt;embed_7</title>
<path fill="none" stroke="black" d="M9385.74,-3125.25C9385.74,-3117.36 9385.74,-3108 9385.74,-3108 9385.74,-3108 11271.6,-3108 11271.6,-3108 11271.6,-3108 11271.6,-3091.04 11271.6,-3091.04"/>
<polygon fill="black" stroke="black" points="11275.1,-3091.04 11271.6,-3081.04 11268.1,-3091.04 11275.1,-3091.04"/>
</g>
<!-- pos_enc_0 -->
<g id="node10" class="node">
<title>pos_enc_0</title>
<polygon fill="lightgreen" stroke="black" points="7298,-3009 6678,-3009 6678,-2973 7298,-2973 7298,-3009"/>
<text text-anchor="middle" x="6988" y="-2988.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- embed_0&#45;&gt;pos_enc_0 -->
<g id="edge2" class="edge">
<title>embed_0&#45;&gt;pos_enc_0</title>
<path fill="none" stroke="black" d="M6988,-3044.83C6988,-3044.83 6988,-3019.41 6988,-3019.41"/>
<polygon fill="black" stroke="black" points="6991.5,-3019.41 6988,-3009.41 6984.5,-3019.41 6991.5,-3019.41"/>
</g>
<!-- pos_enc_1 -->
<g id="node11" class="node">
<title>pos_enc_1</title>
<polygon fill="lightgreen" stroke="black" points="7936,-3009 7316,-3009 7316,-2973 7936,-2973 7936,-3009"/>
<text text-anchor="middle" x="7626" y="-2988.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- embed_1&#45;&gt;pos_enc_1 -->
<g id="edge4" class="edge">
<title>embed_1&#45;&gt;pos_enc_1</title>
<path fill="none" stroke="black" d="M7626,-3044.83C7626,-3044.83 7626,-3019.41 7626,-3019.41"/>
<polygon fill="black" stroke="black" points="7629.5,-3019.41 7626,-3009.41 7622.5,-3019.41 7629.5,-3019.41"/>
</g>
<!-- pos_enc_2 -->
<g id="node12" class="node">
<title>pos_enc_2</title>
<polygon fill="lightgreen" stroke="black" points="8574,-3009 7954,-3009 7954,-2973 8574,-2973 8574,-3009"/>
<text text-anchor="middle" x="8264" y="-2988.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- embed_2&#45;&gt;pos_enc_2 -->
<g id="edge6" class="edge">
<title>embed_2&#45;&gt;pos_enc_2</title>
<path fill="none" stroke="black" d="M8264,-3044.83C8264,-3044.83 8264,-3019.41 8264,-3019.41"/>
<polygon fill="black" stroke="black" points="8267.5,-3019.41 8264,-3009.41 8260.5,-3019.41 8267.5,-3019.41"/>
</g>
<!-- pos_enc_3 -->
<g id="node13" class="node">
<title>pos_enc_3</title>
<polygon fill="lightgreen" stroke="black" points="9212,-3009 8592,-3009 8592,-2973 9212,-2973 9212,-3009"/>
<text text-anchor="middle" x="8902" y="-2988.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- embed_3&#45;&gt;pos_enc_3 -->
<g id="edge8" class="edge">
<title>embed_3&#45;&gt;pos_enc_3</title>
<path fill="none" stroke="black" d="M8902,-3044.83C8902,-3044.83 8902,-3019.41 8902,-3019.41"/>
<polygon fill="black" stroke="black" points="8905.5,-3019.41 8902,-3009.41 8898.5,-3019.41 8905.5,-3019.41"/>
</g>
<!-- pos_enc_4 -->
<g id="node14" class="node">
<title>pos_enc_4</title>
<polygon fill="lightgreen" stroke="black" points="9850,-3009 9230,-3009 9230,-2973 9850,-2973 9850,-3009"/>
<text text-anchor="middle" x="9540" y="-2988.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- embed_4&#45;&gt;pos_enc_4 -->
<g id="edge10" class="edge">
<title>embed_4&#45;&gt;pos_enc_4</title>
<path fill="none" stroke="black" d="M9540,-3044.83C9540,-3044.83 9540,-3019.41 9540,-3019.41"/>
<polygon fill="black" stroke="black" points="9543.5,-3019.41 9540,-3009.41 9536.5,-3019.41 9543.5,-3019.41"/>
</g>
<!-- pos_enc_5 -->
<g id="node15" class="node">
<title>pos_enc_5</title>
<polygon fill="lightgreen" stroke="black" points="10488,-3009 9868,-3009 9868,-2973 10488,-2973 10488,-3009"/>
<text text-anchor="middle" x="10178" y="-2988.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- embed_5&#45;&gt;pos_enc_5 -->
<g id="edge12" class="edge">
<title>embed_5&#45;&gt;pos_enc_5</title>
<path fill="none" stroke="black" d="M10178,-3044.83C10178,-3044.83 10178,-3019.41 10178,-3019.41"/>
<polygon fill="black" stroke="black" points="10181.5,-3019.41 10178,-3009.41 10174.5,-3019.41 10181.5,-3019.41"/>
</g>
<!-- pos_enc_6 -->
<g id="node16" class="node">
<title>pos_enc_6</title>
<polygon fill="lightgreen" stroke="black" points="11126,-3009 10506,-3009 10506,-2973 11126,-2973 11126,-3009"/>
<text text-anchor="middle" x="10816" y="-2988.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- embed_6&#45;&gt;pos_enc_6 -->
<g id="edge14" class="edge">
<title>embed_6&#45;&gt;pos_enc_6</title>
<path fill="none" stroke="black" d="M10816,-3044.83C10816,-3044.83 10816,-3019.41 10816,-3019.41"/>
<polygon fill="black" stroke="black" points="10819.5,-3019.41 10816,-3009.41 10812.5,-3019.41 10819.5,-3019.41"/>
</g>
<!-- pos_enc_7 -->
<g id="node17" class="node">
<title>pos_enc_7</title>
<polygon fill="lightgreen" stroke="black" points="11764,-3009 11144,-3009 11144,-2973 11764,-2973 11764,-3009"/>
<text text-anchor="middle" x="11454" y="-2988.5" font-family="Arial" font-size="10.00">&lt;b&gt;Positional Encoding&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- embed_7&#45;&gt;pos_enc_7 -->
<g id="edge16" class="edge">
<title>embed_7&#45;&gt;pos_enc_7</title>
<path fill="none" stroke="black" d="M11454,-3044.83C11454,-3044.83 11454,-3019.41 11454,-3019.41"/>
<polygon fill="black" stroke="black" points="11457.5,-3019.41 11454,-3009.41 11450.5,-3019.41 11457.5,-3019.41"/>
</g>
<!-- l0_q_proj_0 -->
<g id="node18" class="node">
<title>l0_q_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="1905,-2928 1287,-2928 1287,-2892 1905,-2892 1905,-2928"/>
<text text-anchor="middle" x="1596" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_0&#45;&gt;l0_q_proj_0 -->
<g id="edge17" class="edge">
<title>pos_enc_0&#45;&gt;l0_q_proj_0</title>
<path fill="none" stroke="black" d="M6677.75,-2982C5530.76,-2982 1596,-2982 1596,-2982 1596,-2982 1596,-2938.17 1596,-2938.17"/>
<polygon fill="black" stroke="black" points="1599.5,-2938.17 1596,-2928.17 1592.5,-2938.17 1599.5,-2938.17"/>
</g>
<!-- l0_k_proj_0 -->
<g id="node19" class="node">
<title>l0_k_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="1268.5,-2928 651.5,-2928 651.5,-2892 1268.5,-2892 1268.5,-2928"/>
<text text-anchor="middle" x="960" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_0&#45;&gt;l0_k_proj_0 -->
<g id="edge18" class="edge">
<title>pos_enc_0&#45;&gt;l0_k_proj_0</title>
<path fill="none" stroke="black" d="M6677.91,-2991C5445.41,-2991 960,-2991 960,-2991 960,-2991 960,-2938.38 960,-2938.38"/>
<polygon fill="black" stroke="black" points="963.5,-2938.38 960,-2928.38 956.5,-2938.38 963.5,-2938.38"/>
</g>
<!-- l0_v_proj_0 -->
<g id="node20" class="node">
<title>l0_v_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="633.5,-2928 16.5,-2928 16.5,-2892 633.5,-2892 633.5,-2928"/>
<text text-anchor="middle" x="325" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- pos_enc_0&#45;&gt;l0_v_proj_0 -->
<g id="edge19" class="edge">
<title>pos_enc_0&#45;&gt;l0_v_proj_0</title>
<path fill="none" stroke="black" d="M6677.78,-3000C5363.92,-3000 325,-3000 325,-3000 325,-3000 325,-2938.21 325,-2938.21"/>
<polygon fill="black" stroke="black" points="328.5,-2938.21 325,-2928.21 321.5,-2938.21 328.5,-2938.21"/>
</g>
<!-- l0_res_0 -->
<g id="node23" class="node">
<title>l0_res_0</title>
<polygon fill="lightgray" stroke="black" points="7030,-2712 6523.69,-2694 7030,-2676 7536.31,-2694 7030,-2712"/>
<text text-anchor="middle" x="7030" y="-2691.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- pos_enc_0&#45;&gt;l0_res_0 -->
<g id="edge25" class="edge">
<title>pos_enc_0&#45;&gt;l0_res_0</title>
<path fill="none" stroke="black" d="M6998.75,-2972.79C6998.75,-2937.23 6998.75,-2862 6998.75,-2862 6998.75,-2862 6588.92,-2862 6588.92,-2862 6588.92,-2862 6588.92,-2706.37 6588.92,-2706.37"/>
<polygon fill="black" stroke="black" points="6592.42,-2706.37 6588.92,-2696.37 6585.42,-2706.37 6592.42,-2706.37"/>
</g>
<!-- l0_q_proj_1 -->
<g id="node29" class="node">
<title>l0_q_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="3812,-2928 3194,-2928 3194,-2892 3812,-2892 3812,-2928"/>
<text text-anchor="middle" x="3503" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_1&#45;&gt;l0_q_proj_1 -->
<g id="edge32" class="edge">
<title>pos_enc_1&#45;&gt;l0_q_proj_1</title>
<path fill="none" stroke="black" d="M7502,-2972.84C7502,-2967.96 7502,-2964 7502,-2964 7502,-2964 3503,-2964 3503,-2964 3503,-2964 3503,-2938.28 3503,-2938.28"/>
<polygon fill="black" stroke="black" points="3506.5,-2938.28 3503,-2928.28 3499.5,-2938.28 3506.5,-2938.28"/>
</g>
<!-- l0_k_proj_1 -->
<g id="node30" class="node">
<title>l0_k_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="3175.5,-2928 2558.5,-2928 2558.5,-2892 3175.5,-2892 3175.5,-2928"/>
<text text-anchor="middle" x="2867" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_1&#45;&gt;l0_k_proj_1 -->
<g id="edge33" class="edge">
<title>pos_enc_1&#45;&gt;l0_k_proj_1</title>
<path fill="none" stroke="black" d="M7440,-2972.81C7440,-2969.46 7440,-2967 7440,-2967 7440,-2967 2867,-2967 2867,-2967 2867,-2967 2867,-2938.04 2867,-2938.04"/>
<polygon fill="black" stroke="black" points="2870.5,-2938.04 2867,-2928.04 2863.5,-2938.04 2870.5,-2938.04"/>
</g>
<!-- l0_v_proj_1 -->
<g id="node31" class="node">
<title>l0_v_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="2540.5,-2928 1923.5,-2928 1923.5,-2892 2540.5,-2892 2540.5,-2928"/>
<text text-anchor="middle" x="2232" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- pos_enc_1&#45;&gt;l0_v_proj_1 -->
<g id="edge34" class="edge">
<title>pos_enc_1&#45;&gt;l0_v_proj_1</title>
<path fill="none" stroke="black" d="M7378,-2972.92C7378,-2971.15 7378,-2970 7378,-2970 7378,-2970 2232,-2970 2232,-2970 2232,-2970 2232,-2938 2232,-2938"/>
<polygon fill="black" stroke="black" points="2235.5,-2938 2232,-2928 2228.5,-2938 2235.5,-2938"/>
</g>
<!-- l0_res_1 -->
<g id="node34" class="node">
<title>l0_res_1</title>
<polygon fill="lightgray" stroke="black" points="8165,-2712 7658.69,-2694 8165,-2676 8671.31,-2694 8165,-2712"/>
<text text-anchor="middle" x="8165" y="-2691.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- pos_enc_1&#45;&gt;l0_res_1 -->
<g id="edge40" class="edge">
<title>pos_enc_1&#45;&gt;l0_res_1</title>
<path fill="none" stroke="black" d="M7635.25,-2972.87C7635.25,-2908.39 7635.25,-2694 7635.25,-2694 7635.25,-2694 7648.7,-2694 7648.7,-2694"/>
<polygon fill="black" stroke="black" points="7648.7,-2697.5 7658.7,-2694 7648.7,-2690.5 7648.7,-2697.5"/>
</g>
<!-- l0_q_proj_2 -->
<g id="node40" class="node">
<title>l0_q_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="5719,-2928 5101,-2928 5101,-2892 5719,-2892 5719,-2928"/>
<text text-anchor="middle" x="5410" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_2&#45;&gt;l0_q_proj_2 -->
<g id="edge47" class="edge">
<title>pos_enc_2&#45;&gt;l0_q_proj_2</title>
<path fill="none" stroke="black" d="M8138.5,-2972.58C8138.5,-2963.72 8138.5,-2955 8138.5,-2955 8138.5,-2955 5410,-2955 5410,-2955 5410,-2955 5410,-2938.04 5410,-2938.04"/>
<polygon fill="black" stroke="black" points="5413.5,-2938.04 5410,-2928.04 5406.5,-2938.04 5413.5,-2938.04"/>
</g>
<!-- l0_k_proj_2 -->
<g id="node41" class="node">
<title>l0_k_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="5082.5,-2928 4465.5,-2928 4465.5,-2892 5082.5,-2892 5082.5,-2928"/>
<text text-anchor="middle" x="4774" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_2&#45;&gt;l0_k_proj_2 -->
<g id="edge48" class="edge">
<title>pos_enc_2&#45;&gt;l0_k_proj_2</title>
<path fill="none" stroke="black" d="M8077,-2972.96C8077,-2965.25 8077,-2958 8077,-2958 8077,-2958 4774,-2958 4774,-2958 4774,-2958 4774,-2938.15 4774,-2938.15"/>
<polygon fill="black" stroke="black" points="4777.5,-2938.15 4774,-2928.15 4770.5,-2938.15 4777.5,-2938.15"/>
</g>
<!-- l0_v_proj_2 -->
<g id="node42" class="node">
<title>l0_v_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="4447.5,-2928 3830.5,-2928 3830.5,-2892 4447.5,-2892 4447.5,-2928"/>
<text text-anchor="middle" x="4139" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- pos_enc_2&#45;&gt;l0_v_proj_2 -->
<g id="edge49" class="edge">
<title>pos_enc_2&#45;&gt;l0_v_proj_2</title>
<path fill="none" stroke="black" d="M8015.5,-2972.86C8015.5,-2966.54 8015.5,-2961 8015.5,-2961 8015.5,-2961 4139,-2961 4139,-2961 4139,-2961 4139,-2938.12 4139,-2938.12"/>
<polygon fill="black" stroke="black" points="4142.5,-2938.12 4139,-2928.12 4135.5,-2938.12 4142.5,-2938.12"/>
</g>
<!-- l0_res_2 -->
<g id="node45" class="node">
<title>l0_res_2</title>
<polygon fill="lightgray" stroke="black" points="9204,-2712 8697.69,-2694 9204,-2676 9710.31,-2694 9204,-2712"/>
<text text-anchor="middle" x="9204" y="-2691.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- pos_enc_2&#45;&gt;l0_res_2 -->
<g id="edge55" class="edge">
<title>pos_enc_2&#45;&gt;l0_res_2</title>
<path fill="none" stroke="black" d="M8270.5,-2972.87C8270.5,-2912.33 8270.5,-2721 8270.5,-2721 8270.5,-2721 8880.56,-2721 8880.56,-2721 8880.56,-2721 8880.56,-2710.54 8880.56,-2710.54"/>
<polygon fill="black" stroke="black" points="8884.06,-2710.54 8880.56,-2700.54 8877.06,-2710.54 8884.06,-2710.54"/>
</g>
<!-- l0_q_proj_3 -->
<g id="node51" class="node">
<title>l0_q_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="7626,-2928 7008,-2928 7008,-2892 7626,-2892 7626,-2928"/>
<text text-anchor="middle" x="7317" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_3&#45;&gt;l0_q_proj_3 -->
<g id="edge62" class="edge">
<title>pos_enc_3&#45;&gt;l0_q_proj_3</title>
<path fill="none" stroke="black" d="M8774.7,-2972.85C8774.7,-2959.26 8774.7,-2943 8774.7,-2943 8774.7,-2943 7564,-2943 7564,-2943 7564,-2943 7564,-2938.04 7564,-2938.04"/>
<polygon fill="black" stroke="black" points="7567.5,-2938.04 7564,-2928.04 7560.5,-2938.04 7567.5,-2938.04"/>
</g>
<!-- l0_k_proj_3 -->
<g id="node52" class="node">
<title>l0_k_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="6989.5,-2928 6372.5,-2928 6372.5,-2892 6989.5,-2892 6989.5,-2928"/>
<text text-anchor="middle" x="6681" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_3&#45;&gt;l0_k_proj_3 -->
<g id="edge63" class="edge">
<title>pos_enc_3&#45;&gt;l0_k_proj_3</title>
<path fill="none" stroke="black" d="M8713.8,-2972.96C8713.8,-2960.44 8713.8,-2946 8713.8,-2946 8713.8,-2946 6833.75,-2946 6833.75,-2946 6833.75,-2946 6833.75,-2938.42 6833.75,-2938.42"/>
<polygon fill="black" stroke="black" points="6837.25,-2938.42 6833.75,-2928.42 6830.25,-2938.42 6837.25,-2938.42"/>
</g>
<!-- l0_v_proj_3 -->
<g id="node53" class="node">
<title>l0_v_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="6354.5,-2928 5737.5,-2928 5737.5,-2892 6354.5,-2892 6354.5,-2928"/>
<text text-anchor="middle" x="6046" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- pos_enc_3&#45;&gt;l0_v_proj_3 -->
<g id="edge64" class="edge">
<title>pos_enc_3&#45;&gt;l0_v_proj_3</title>
<path fill="none" stroke="black" d="M8652.9,-2972.87C8652.9,-2962.69 8652.9,-2952 8652.9,-2952 8652.9,-2952 6046,-2952 6046,-2952 6046,-2952 6046,-2938.06 6046,-2938.06"/>
<polygon fill="black" stroke="black" points="6049.5,-2938.06 6046,-2928.06 6042.5,-2938.06 6049.5,-2938.06"/>
</g>
<!-- l0_res_3 -->
<g id="node56" class="node">
<title>l0_res_3</title>
<polygon fill="lightgray" stroke="black" points="10405,-2712 9898.69,-2694 10405,-2676 10911.31,-2694 10405,-2712"/>
<text text-anchor="middle" x="10405" y="-2691.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- pos_enc_3&#45;&gt;l0_res_3 -->
<g id="edge70" class="edge">
<title>pos_enc_3&#45;&gt;l0_res_3</title>
<path fill="none" stroke="black" d="M8905.75,-2972.85C8905.75,-2938.64 8905.75,-2868 8905.75,-2868 8905.75,-2868 10382,-2868 10382,-2868 10382,-2868 10382,-2721.32 10382,-2721.32"/>
<polygon fill="black" stroke="black" points="10385.5,-2721.32 10382,-2711.32 10378.5,-2721.32 10385.5,-2721.32"/>
</g>
<!-- l0_q_proj_4 -->
<g id="node62" class="node">
<title>l0_q_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="9533,-2928 8915,-2928 8915,-2892 9533,-2892 9533,-2928"/>
<text text-anchor="middle" x="9224" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_4&#45;&gt;l0_q_proj_4 -->
<g id="edge77" class="edge">
<title>pos_enc_4&#45;&gt;l0_q_proj_4</title>
<path fill="none" stroke="black" d="M9457.25,-2972.62C9457.25,-2972.62 9457.25,-2938.03 9457.25,-2938.03"/>
<polygon fill="black" stroke="black" points="9460.75,-2938.03 9457.25,-2928.03 9453.75,-2938.03 9460.75,-2938.03"/>
</g>
<!-- l0_k_proj_4 -->
<g id="node63" class="node">
<title>l0_k_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="8896.5,-2928 8279.5,-2928 8279.5,-2892 8896.5,-2892 8896.5,-2928"/>
<text text-anchor="middle" x="8588" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_4&#45;&gt;l0_k_proj_4 -->
<g id="edge78" class="edge">
<title>pos_enc_4&#45;&gt;l0_k_proj_4</title>
<path fill="none" stroke="black" d="M9381.5,-2972.72C9381.5,-2957.05 9381.5,-2937 9381.5,-2937 9381.5,-2937 8835.6,-2937 8835.6,-2937 8835.6,-2937 8835.6,-2936.12 8835.6,-2936.12"/>
<polygon fill="black" stroke="black" points="8839.1,-2938.16 8835.6,-2928.16 8832.1,-2938.16 8839.1,-2938.16"/>
</g>
<!-- l0_v_proj_4 -->
<g id="node64" class="node">
<title>l0_v_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="8261.5,-2928 7644.5,-2928 7644.5,-2892 8261.5,-2892 8261.5,-2928"/>
<text text-anchor="middle" x="7953" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- pos_enc_4&#45;&gt;l0_v_proj_4 -->
<g id="edge79" class="edge">
<title>pos_enc_4&#45;&gt;l0_v_proj_4</title>
<path fill="none" stroke="black" d="M9305.75,-2972.88C9305.75,-2958.22 9305.75,-2940 9305.75,-2940 9305.75,-2940 8200,-2940 8200,-2940 8200,-2940 8200,-2938.14 8200,-2938.14"/>
<polygon fill="black" stroke="black" points="8203.5,-2938.14 8200,-2928.14 8196.5,-2938.14 8203.5,-2938.14"/>
</g>
<!-- l0_res_4 -->
<g id="node67" class="node">
<title>l0_res_4</title>
<polygon fill="lightgray" stroke="black" points="11452,-2712 10945.69,-2694 11452,-2676 11958.31,-2694 11452,-2712"/>
<text text-anchor="middle" x="11452" y="-2691.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- pos_enc_4&#45;&gt;l0_res_4 -->
<g id="edge85" class="edge">
<title>pos_enc_4&#45;&gt;l0_res_4</title>
<path fill="none" stroke="black" d="M9542.25,-2972.65C9542.25,-2913.24 9542.25,-2730 9542.25,-2730 9542.25,-2730 11076.56,-2730 11076.56,-2730 11076.56,-2730 11076.56,-2708.71 11076.56,-2708.71"/>
<polygon fill="black" stroke="black" points="11080.06,-2708.71 11076.56,-2698.71 11073.06,-2708.71 11080.06,-2708.71"/>
</g>
<!-- l0_q_proj_5 -->
<g id="node73" class="node">
<title>l0_q_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="11440,-2928 10822,-2928 10822,-2892 11440,-2892 11440,-2928"/>
<text text-anchor="middle" x="11131" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_5&#45;&gt;l0_q_proj_5 -->
<g id="edge92" class="edge">
<title>pos_enc_5&#45;&gt;l0_q_proj_5</title>
<path fill="none" stroke="black" d="M10387.5,-2973C10387.5,-2955.32 10387.5,-2931 10387.5,-2931 10387.5,-2931 10898,-2931 10898,-2931 10898,-2931 10898,-2930.71 10898,-2930.71"/>
<polygon fill="black" stroke="black" points="10901.5,-2938.08 10898,-2928.08 10894.5,-2938.08 10901.5,-2938.08"/>
</g>
<!-- l0_k_proj_5 -->
<g id="node74" class="node">
<title>l0_k_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="10803.5,-2928 10186.5,-2928 10186.5,-2892 10803.5,-2892 10803.5,-2928"/>
<text text-anchor="middle" x="10495" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_5&#45;&gt;l0_k_proj_5 -->
<g id="edge93" class="edge">
<title>pos_enc_5&#45;&gt;l0_k_proj_5</title>
<path fill="none" stroke="black" d="M10287,-2972.62C10287,-2972.62 10287,-2938.03 10287,-2938.03"/>
<polygon fill="black" stroke="black" points="10290.5,-2938.03 10287,-2928.03 10283.5,-2938.03 10290.5,-2938.03"/>
</g>
<!-- l0_v_proj_5 -->
<g id="node75" class="node">
<title>l0_v_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="10168.5,-2928 9551.5,-2928 9551.5,-2892 10168.5,-2892 10168.5,-2928"/>
<text text-anchor="middle" x="9860" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- pos_enc_5&#45;&gt;l0_v_proj_5 -->
<g id="edge94" class="edge">
<title>pos_enc_5&#45;&gt;l0_v_proj_5</title>
<path fill="none" stroke="black" d="M10018.25,-2972.62C10018.25,-2972.62 10018.25,-2938.03 10018.25,-2938.03"/>
<polygon fill="black" stroke="black" points="10021.75,-2938.03 10018.25,-2928.03 10014.75,-2938.03 10021.75,-2938.03"/>
</g>
<!-- l0_res_5 -->
<g id="node78" class="node">
<title>l0_res_5</title>
<polygon fill="lightgray" stroke="black" points="12488,-2712 11981.69,-2694 12488,-2676 12994.31,-2694 12488,-2712"/>
<text text-anchor="middle" x="12488" y="-2691.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- pos_enc_5&#45;&gt;l0_res_5 -->
<g id="edge100" class="edge">
<title>pos_enc_5&#45;&gt;l0_res_5</title>
<path fill="none" stroke="black" d="M10177.5,-2972.98C10177.5,-2940.16 10177.5,-2874 10177.5,-2874 10177.5,-2874 12254.5,-2874 12254.5,-2874 12254.5,-2874 12254.5,-2713.93 12254.5,-2713.93"/>
<polygon fill="black" stroke="black" points="12258,-2713.93 12254.5,-2703.93 12251,-2713.93 12258,-2713.93"/>
</g>
<!-- l0_q_proj_6 -->
<g id="node84" class="node">
<title>l0_q_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="13347,-2928 12729,-2928 12729,-2892 13347,-2892 13347,-2928"/>
<text text-anchor="middle" x="13038" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_6&#45;&gt;l0_q_proj_6 -->
<g id="edge107" class="edge">
<title>pos_enc_6&#45;&gt;l0_q_proj_6</title>
<path fill="none" stroke="black" d="M11050,-2972.94C11050,-2961.56 11050,-2949 11050,-2949 11050,-2949 13039.9,-2949 13039.9,-2949 13039.9,-2949 13039.9,-2938.13 13039.9,-2938.13"/>
<polygon fill="black" stroke="black" points="13043.4,-2938.13 13039.9,-2928.13 13036.4,-2938.13 13043.4,-2938.13"/>
</g>
<!-- l0_k_proj_6 -->
<g id="node85" class="node">
<title>l0_k_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="12710.5,-2928 12093.5,-2928 12093.5,-2892 12710.5,-2892 12710.5,-2928"/>
<text text-anchor="middle" x="12402" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_6&#45;&gt;l0_k_proj_6 -->
<g id="edge108" class="edge">
<title>pos_enc_6&#45;&gt;l0_k_proj_6</title>
<path fill="none" stroke="black" d="M10815.83,-2972.71C10815.83,-2942.63 10815.83,-2886 10815.83,-2886 10815.83,-2886 12121.25,-2886 12121.25,-2886 12121.25,-2886 12121.25,-2886.58 12121.25,-2886.58"/>
<polygon fill="black" stroke="black" points="12117.75,-2881.81 12121.25,-2891.81 12124.75,-2881.81 12117.75,-2881.81"/>
</g>
<!-- l0_v_proj_6 -->
<g id="node86" class="node">
<title>l0_v_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="12075.5,-2928 11458.5,-2928 11458.5,-2892 12075.5,-2892 12075.5,-2928"/>
<text text-anchor="middle" x="11767" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- pos_enc_6&#45;&gt;l0_v_proj_6 -->
<g id="edge109" class="edge">
<title>pos_enc_6&#45;&gt;l0_v_proj_6</title>
<path fill="none" stroke="black" d="M10974,-2972.96C10974,-2956.27 10974,-2934 10974,-2934 10974,-2934 11611.25,-2934 11611.25,-2934 11611.25,-2934 11611.25,-2933.42 11611.25,-2933.42"/>
<polygon fill="black" stroke="black" points="11614.75,-2938.19 11611.25,-2928.19 11607.75,-2938.19 11614.75,-2938.19"/>
</g>
<!-- l0_res_6 -->
<g id="node89" class="node">
<title>l0_res_6</title>
<polygon fill="lightgray" stroke="black" points="13536,-2712 13029.69,-2694 13536,-2676 14042.31,-2694 13536,-2712"/>
<text text-anchor="middle" x="13536" y="-2691.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- pos_enc_6&#45;&gt;l0_res_6 -->
<g id="edge115" class="edge">
<title>pos_enc_6&#45;&gt;l0_res_6</title>
<path fill="none" stroke="black" d="M10809.67,-2972.67C10809.67,-2941.14 10809.67,-2880 10809.67,-2880 10809.67,-2880 13727.25,-2880 13727.25,-2880 13727.25,-2880 13727.25,-2715.36 13727.25,-2715.36"/>
<polygon fill="black" stroke="black" points="13730.75,-2715.36 13727.25,-2705.36 13723.75,-2715.36 13730.75,-2715.36"/>
</g>
<!-- l0_q_proj_7 -->
<g id="node95" class="node">
<title>l0_q_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="15254,-2928 14636,-2928 14636,-2892 15254,-2892 15254,-2928"/>
<text text-anchor="middle" x="14945" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_7&#45;&gt;l0_q_proj_7 -->
<g id="edge122" class="edge">
<title>pos_enc_7&#45;&gt;l0_q_proj_7</title>
<path fill="none" stroke="black" d="M11764.2,-3000C12569.17,-3000 14662.6,-3000 14662.6,-3000 14662.6,-3000 14662.6,-2938.21 14662.6,-2938.21"/>
<polygon fill="black" stroke="black" points="14666.1,-2938.21 14662.6,-2928.21 14659.1,-2938.21 14666.1,-2938.21"/>
</g>
<!-- l0_k_proj_7 -->
<g id="node96" class="node">
<title>l0_k_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="14617.5,-2928 14000.5,-2928 14000.5,-2892 14617.5,-2892 14617.5,-2928"/>
<text text-anchor="middle" x="14309" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- pos_enc_7&#45;&gt;l0_k_proj_7 -->
<g id="edge123" class="edge">
<title>pos_enc_7&#45;&gt;l0_k_proj_7</title>
<path fill="none" stroke="black" d="M11764.29,-2991C12446.35,-2991 14015.85,-2991 14015.85,-2991 14015.85,-2991 14015.85,-2938.38 14015.85,-2938.38"/>
<polygon fill="black" stroke="black" points="14019.35,-2938.38 14015.85,-2928.38 14012.35,-2938.38 14019.35,-2938.38"/>
</g>
<!-- l0_v_proj_7 -->
<g id="node97" class="node">
<title>l0_v_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="13982.5,-2928 13365.5,-2928 13365.5,-2892 13982.5,-2892 13982.5,-2928"/>
<text text-anchor="middle" x="13674" y="-2907.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- pos_enc_7&#45;&gt;l0_v_proj_7 -->
<g id="edge124" class="edge">
<title>pos_enc_7&#45;&gt;l0_v_proj_7</title>
<path fill="none" stroke="black" d="M11764.13,-2982C12306.3,-2982 13369.35,-2982 13369.35,-2982 13369.35,-2982 13369.35,-2938.17 13369.35,-2938.17"/>
<polygon fill="black" stroke="black" points="13372.85,-2938.17 13369.35,-2928.17 13365.85,-2938.17 13372.85,-2938.17"/>
</g>
<!-- l0_res_7 -->
<g id="node100" class="node">
<title>l0_res_7</title>
<polygon fill="lightgray" stroke="black" points="14573,-2712 14066.69,-2694 14573,-2676 15079.31,-2694 14573,-2712"/>
<text text-anchor="middle" x="14573" y="-2691.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- pos_enc_7&#45;&gt;l0_res_7 -->
<g id="edge130" class="edge">
<title>pos_enc_7&#45;&gt;l0_res_7</title>
<path fill="none" stroke="black" d="M11449.25,-2972.88C11449.25,-2925.57 11449.25,-2802 11449.25,-2802 11449.25,-2802 14119.92,-2802 14119.92,-2802 14119.92,-2802 14119.92,-2706.26 14119.92,-2706.26"/>
<polygon fill="black" stroke="black" points="14123.42,-2706.26 14119.92,-2696.26 14116.42,-2706.26 14123.42,-2706.26"/>
</g>
<!-- l0_attn_0 -->
<g id="node21" class="node">
<title>l0_attn_0</title>
<polygon fill="lightgreen" stroke="black" points="1623,-2856 933,-2856 933,-2820 1623,-2820 1623,-2856"/>
<text text-anchor="middle" x="1278" y="-2835.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l0_q_proj_0&#45;&gt;l0_attn_0 -->
<g id="edge20" class="edge">
<title>l0_q_proj_0&#45;&gt;l0_attn_0</title>
<path fill="none" stroke="black" d="M1455,-2891.83C1455,-2891.83 1455,-2866.41 1455,-2866.41"/>
<polygon fill="black" stroke="black" points="1458.5,-2866.41 1455,-2856.41 1451.5,-2866.41 1458.5,-2866.41"/>
</g>
<!-- l0_k_proj_0&#45;&gt;l0_attn_0 -->
<g id="edge21" class="edge">
<title>l0_k_proj_0&#45;&gt;l0_attn_0</title>
<path fill="none" stroke="black" d="M1100.75,-2891.83C1100.75,-2891.83 1100.75,-2866.41 1100.75,-2866.41"/>
<polygon fill="black" stroke="black" points="1104.25,-2866.41 1100.75,-2856.41 1097.25,-2866.41 1104.25,-2866.41"/>
</g>
<!-- l0_v_proj_0&#45;&gt;l0_attn_0 -->
<g id="edge22" class="edge">
<title>l0_v_proj_0&#45;&gt;l0_attn_0</title>
<path fill="none" stroke="black" d="M456,-2891.83C456,-2870.5 456,-2838 456,-2838 456,-2838 922.97,-2838 922.97,-2838"/>
<polygon fill="black" stroke="black" points="922.97,-2841.5 932.97,-2838 922.97,-2834.5 922.97,-2841.5"/>
</g>
<!-- l0_out_proj_0 -->
<g id="node22" class="node">
<title>l0_out_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="1904,-2784 1264,-2784 1264,-2748 1904,-2748 1904,-2784"/>
<text text-anchor="middle" x="1584" y="-2763.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_attn_0&#45;&gt;l0_out_proj_0 -->
<g id="edge23" class="edge">
<title>l0_attn_0&#45;&gt;l0_out_proj_0</title>
<path fill="none" stroke="black" d="M1443.5,-2819.83C1443.5,-2819.83 1443.5,-2794.41 1443.5,-2794.41"/>
<polygon fill="black" stroke="black" points="1447,-2794.41 1443.5,-2784.41 1440,-2794.41 1447,-2794.41"/>
</g>
<!-- l0_out_proj_0&#45;&gt;l0_res_0 -->
<g id="edge24" class="edge">
<title>l0_out_proj_0&#45;&gt;l0_res_0</title>
<path fill="none" stroke="black" d="M1732.25,-2747.83C1732.25,-2726.5 1732.25,-2694 1732.25,-2694 1732.25,-2694 6513.83,-2694 6513.83,-2694"/>
<polygon fill="black" stroke="black" points="6513.83,-2697.5 6523.83,-2694 6513.83,-2690.5 6513.83,-2697.5"/>
</g>
<!-- l0_ln1_0 -->
<g id="node24" class="node">
<title>l0_ln1_0</title>
<polygon fill="lightgreen" stroke="black" points="7326.5,-2640 6733.5,-2640 6733.5,-2604 7326.5,-2604 7326.5,-2640"/>
<text text-anchor="middle" x="7030" y="-2619.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res_0&#45;&gt;l0_ln1_0 -->
<g id="edge26" class="edge">
<title>l0_res_0&#45;&gt;l0_ln1_0</title>
<path fill="none" stroke="black" d="M7030,-2675.83C7030,-2675.83 7030,-2650.41 7030,-2650.41"/>
<polygon fill="black" stroke="black" points="7033.5,-2650.41 7030,-2640.41 7026.5,-2650.41 7033.5,-2650.41"/>
</g>
<!-- l0_ffn_up_0 -->
<g id="node25" class="node">
<title>l0_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="7326.5,-2568 6703.5,-2568 6703.5,-2532 7326.5,-2532 7326.5,-2568"/>
<text text-anchor="middle" x="7015" y="-2547.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ln1_0&#45;&gt;l0_ffn_up_0 -->
<g id="edge27" class="edge">
<title>l0_ln1_0&#45;&gt;l0_ffn_up_0</title>
<path fill="none" stroke="black" d="M7030,-2603.83C7030,-2603.83 7030,-2578.41 7030,-2578.41"/>
<polygon fill="black" stroke="black" points="7033.5,-2578.41 7030,-2568.41 7026.5,-2578.41 7033.5,-2578.41"/>
</g>
<!-- l0_res2_0 -->
<g id="node27" class="node">
<title>l0_res2_0</title>
<polygon fill="lightgray" stroke="black" points="7345,-2424 6831.2,-2406 7345,-2388 7858.8,-2406 7345,-2424"/>
<text text-anchor="middle" x="7345" y="-2403.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln1_0&#45;&gt;l0_res2_0 -->
<g id="edge30" class="edge">
<title>l0_ln1_0&#45;&gt;l0_res2_0</title>
<path fill="none" stroke="black" d="M7326.65,-2622C7387.32,-2622 7433.08,-2622 7433.08,-2622 7433.08,-2622 7433.08,-2431.19 7433.08,-2431.19"/>
<polygon fill="black" stroke="black" points="7436.58,-2431.19 7433.08,-2421.19 7429.58,-2431.19 7436.58,-2431.19"/>
</g>
<!-- l0_ffn_down_0 -->
<g id="node26" class="node">
<title>l0_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="7330,-2496 6694,-2496 6694,-2460 7330,-2460 7330,-2496"/>
<text text-anchor="middle" x="7012" y="-2475.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_0&#45;&gt;l0_ffn_down_0 -->
<g id="edge28" class="edge">
<title>l0_ffn_up_0&#45;&gt;l0_ffn_down_0</title>
<path fill="none" stroke="black" d="M7015,-2531.83C7015,-2531.83 7015,-2506.41 7015,-2506.41"/>
<polygon fill="black" stroke="black" points="7018.5,-2506.41 7015,-2496.41 7011.5,-2506.41 7018.5,-2506.41"/>
</g>
<!-- l0_ffn_down_0&#45;&gt;l0_res2_0 -->
<g id="edge29" class="edge">
<title>l0_ffn_down_0&#45;&gt;l0_res2_0</title>
<path fill="none" stroke="black" d="M7080.68,-2459.83C7080.68,-2459.83 7080.68,-2424.96 7080.68,-2424.96"/>
<polygon fill="black" stroke="black" points="7084.18,-2424.96 7080.68,-2414.96 7077.18,-2424.96 7084.18,-2424.96"/>
</g>
<!-- l0_ln2_0 -->
<g id="node28" class="node">
<title>l0_ln2_0</title>
<polygon fill="lightgreen" stroke="black" points="7912.5,-2352 7319.5,-2352 7319.5,-2316 7912.5,-2316 7912.5,-2352"/>
<text text-anchor="middle" x="7616" y="-2331.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res2_0&#45;&gt;l0_ln2_0 -->
<g id="edge31" class="edge">
<title>l0_res2_0&#45;&gt;l0_ln2_0</title>
<path fill="none" stroke="black" d="M7589.07,-2396.29C7589.07,-2396.29 7589.07,-2362.12 7589.07,-2362.12"/>
<polygon fill="black" stroke="black" points="7592.57,-2362.12 7589.07,-2352.12 7585.57,-2362.12 7592.57,-2362.12"/>
</g>
<!-- comm_stage0_to_stage1 -->
<g id="node106" class="node">
<title>comm_stage0_to_stage1</title>
<polygon fill="lightyellow" stroke="black" points="11019.15,-2280 10350.78,-2280 10178.85,-2244 10847.22,-2244 11019.15,-2280"/>
<text text-anchor="middle" x="10599" y="-2259.5" font-family="Arial" font-size="10.00">&lt;b&gt;Pipeline Communication&lt;/b&gt;&lt;br/&gt;All GPUs 0&#45;7 to All GPUs 8&#45;15&lt;br/&gt;[batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln2_0&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge137" class="edge">
<title>l0_ln2_0&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M7616,-2315.97C7616,-2298.94 7616,-2276 7616,-2276 7616,-2276 10321.65,-2276 10321.65,-2276"/>
<polygon fill="black" stroke="black" points="10321.65,-2279.5 10331.65,-2276 10321.65,-2272.5 10321.65,-2279.5"/>
</g>
<!-- l0_attn_1 -->
<g id="node32" class="node">
<title>l0_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="3530,-2856 2840,-2856 2840,-2820 3530,-2820 3530,-2856"/>
<text text-anchor="middle" x="3185" y="-2835.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l0_q_proj_1&#45;&gt;l0_attn_1 -->
<g id="edge35" class="edge">
<title>l0_q_proj_1&#45;&gt;l0_attn_1</title>
<path fill="none" stroke="black" d="M3362,-2891.83C3362,-2891.83 3362,-2866.41 3362,-2866.41"/>
<polygon fill="black" stroke="black" points="3365.5,-2866.41 3362,-2856.41 3358.5,-2866.41 3365.5,-2866.41"/>
</g>
<!-- l0_k_proj_1&#45;&gt;l0_attn_1 -->
<g id="edge36" class="edge">
<title>l0_k_proj_1&#45;&gt;l0_attn_1</title>
<path fill="none" stroke="black" d="M3007.75,-2891.83C3007.75,-2891.83 3007.75,-2866.41 3007.75,-2866.41"/>
<polygon fill="black" stroke="black" points="3011.25,-2866.41 3007.75,-2856.41 3004.25,-2866.41 3011.25,-2866.41"/>
</g>
<!-- l0_v_proj_1&#45;&gt;l0_attn_1 -->
<g id="edge37" class="edge">
<title>l0_v_proj_1&#45;&gt;l0_attn_1</title>
<path fill="none" stroke="black" d="M2371,-2891.83C2371,-2870.5 2371,-2838 2371,-2838 2371,-2838 2829.79,-2838 2829.79,-2838"/>
<polygon fill="black" stroke="black" points="2829.79,-2841.5 2839.79,-2838 2829.79,-2834.5 2829.79,-2841.5"/>
</g>
<!-- l0_out_proj_1 -->
<g id="node33" class="node">
<title>l0_out_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="6034,-2784 5394,-2784 5394,-2748 6034,-2748 6034,-2784"/>
<text text-anchor="middle" x="5714" y="-2763.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_attn_1&#45;&gt;l0_out_proj_1 -->
<g id="edge38" class="edge">
<title>l0_attn_1&#45;&gt;l0_out_proj_1</title>
<path fill="none" stroke="black" d="M3501,-2819.83C3501,-2798.5 3501,-2766 3501,-2766 3501,-2766 5383.98,-2766 5383.98,-2766"/>
<polygon fill="black" stroke="black" points="5383.98,-2769.5 5393.98,-2766 5383.98,-2762.5 5383.98,-2769.5"/>
</g>
<!-- l0_out_proj_1&#45;&gt;l0_res_1 -->
<g id="edge39" class="edge">
<title>l0_out_proj_1&#45;&gt;l0_res_1</title>
<path fill="none" stroke="black" d="M6034.08,-2760C6632.24,-2760 7859.73,-2760 7859.73,-2760 7859.73,-2760 7859.73,-2711.32 7859.73,-2711.32"/>
<polygon fill="black" stroke="black" points="7863.23,-2711.32 7859.73,-2701.32 7856.23,-2711.32 7863.23,-2711.32"/>
</g>
<!-- l0_ln1_1 -->
<g id="node35" class="node">
<title>l0_ln1_1</title>
<polygon fill="lightgreen" stroke="black" points="8461.5,-2640 7868.5,-2640 7868.5,-2604 8461.5,-2604 8461.5,-2640"/>
<text text-anchor="middle" x="8165" y="-2619.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res_1&#45;&gt;l0_ln1_1 -->
<g id="edge41" class="edge">
<title>l0_res_1&#45;&gt;l0_ln1_1</title>
<path fill="none" stroke="black" d="M8165,-2675.83C8165,-2675.83 8165,-2650.41 8165,-2650.41"/>
<polygon fill="black" stroke="black" points="8168.5,-2650.41 8165,-2640.41 8161.5,-2650.41 8168.5,-2650.41"/>
</g>
<!-- l0_ffn_up_1 -->
<g id="node36" class="node">
<title>l0_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="8371.5,-2568 7748.5,-2568 7748.5,-2532 8371.5,-2532 8371.5,-2568"/>
<text text-anchor="middle" x="8060" y="-2547.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ln1_1&#45;&gt;l0_ffn_up_1 -->
<g id="edge42" class="edge">
<title>l0_ln1_1&#45;&gt;l0_ffn_up_1</title>
<path fill="none" stroke="black" d="M8120,-2603.83C8120,-2603.83 8120,-2578.41 8120,-2578.41"/>
<polygon fill="black" stroke="black" points="8123.5,-2578.41 8120,-2568.41 8116.5,-2578.41 8123.5,-2578.41"/>
</g>
<!-- l0_res2_1 -->
<g id="node38" class="node">
<title>l0_res2_1</title>
<polygon fill="lightgray" stroke="black" points="8390,-2424 7876.2,-2406 8390,-2388 8903.8,-2406 8390,-2424"/>
<text text-anchor="middle" x="8390" y="-2403.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln1_1&#45;&gt;l0_res2_1 -->
<g id="edge45" class="edge">
<title>l0_ln1_1&#45;&gt;l0_res2_1</title>
<path fill="none" stroke="black" d="M8418.25,-2603.96C8418.25,-2603.96 8418.25,-2433.24 8418.25,-2433.24"/>
<polygon fill="black" stroke="black" points="8421.75,-2433.24 8418.25,-2423.24 8414.75,-2433.24 8421.75,-2433.24"/>
</g>
<!-- l0_ffn_down_1 -->
<g id="node37" class="node">
<title>l0_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="8375,-2496 7739,-2496 7739,-2460 8375,-2460 8375,-2496"/>
<text text-anchor="middle" x="8057" y="-2475.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_1&#45;&gt;l0_ffn_down_1 -->
<g id="edge43" class="edge">
<title>l0_ffn_up_1&#45;&gt;l0_ffn_down_1</title>
<path fill="none" stroke="black" d="M8060,-2531.83C8060,-2531.83 8060,-2506.41 8060,-2506.41"/>
<polygon fill="black" stroke="black" points="8063.5,-2506.41 8060,-2496.41 8056.5,-2506.41 8063.5,-2506.41"/>
</g>
<!-- l0_ffn_down_1&#45;&gt;l0_res2_1 -->
<g id="edge44" class="edge">
<title>l0_ffn_down_1&#45;&gt;l0_res2_1</title>
<path fill="none" stroke="black" d="M8125.68,-2459.83C8125.68,-2459.83 8125.68,-2424.96 8125.68,-2424.96"/>
<polygon fill="black" stroke="black" points="8129.18,-2424.96 8125.68,-2414.96 8122.18,-2424.96 8129.18,-2424.96"/>
</g>
<!-- l0_ln2_1 -->
<g id="node39" class="node">
<title>l0_ln2_1</title>
<polygon fill="lightgreen" stroke="black" points="9174.5,-2352 8581.5,-2352 8581.5,-2316 9174.5,-2316 9174.5,-2352"/>
<text text-anchor="middle" x="8878" y="-2331.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res2_1&#45;&gt;l0_ln2_1 -->
<g id="edge46" class="edge">
<title>l0_res2_1&#45;&gt;l0_ln2_1</title>
<path fill="none" stroke="black" d="M8742.57,-2400.35C8742.57,-2400.35 8742.57,-2362.04 8742.57,-2362.04"/>
<polygon fill="black" stroke="black" points="8746.07,-2362.04 8742.57,-2352.04 8739.07,-2362.04 8746.07,-2362.04"/>
</g>
<!-- l0_ln2_1&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge138" class="edge">
<title>l0_ln2_1&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M8884.5,-2315.97C8884.5,-2299.6 8884.5,-2278 8884.5,-2278 8884.5,-2278 10330.93,-2278 10330.93,-2278"/>
<polygon fill="black" stroke="black" points="10330.93,-2281.5 10340.93,-2278 10330.93,-2274.5 10330.93,-2281.5"/>
</g>
<!-- l0_attn_2 -->
<g id="node43" class="node">
<title>l0_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="5437,-2856 4747,-2856 4747,-2820 5437,-2820 5437,-2856"/>
<text text-anchor="middle" x="5092" y="-2835.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l0_q_proj_2&#45;&gt;l0_attn_2 -->
<g id="edge50" class="edge">
<title>l0_q_proj_2&#45;&gt;l0_attn_2</title>
<path fill="none" stroke="black" d="M5269,-2891.83C5269,-2891.83 5269,-2866.41 5269,-2866.41"/>
<polygon fill="black" stroke="black" points="5272.5,-2866.41 5269,-2856.41 5265.5,-2866.41 5272.5,-2866.41"/>
</g>
<!-- l0_k_proj_2&#45;&gt;l0_attn_2 -->
<g id="edge51" class="edge">
<title>l0_k_proj_2&#45;&gt;l0_attn_2</title>
<path fill="none" stroke="black" d="M4914.75,-2891.83C4914.75,-2891.83 4914.75,-2866.41 4914.75,-2866.41"/>
<polygon fill="black" stroke="black" points="4918.25,-2866.41 4914.75,-2856.41 4911.25,-2866.41 4918.25,-2866.41"/>
</g>
<!-- l0_v_proj_2&#45;&gt;l0_attn_2 -->
<g id="edge52" class="edge">
<title>l0_v_proj_2&#45;&gt;l0_attn_2</title>
<path fill="none" stroke="black" d="M4277.5,-2891.83C4277.5,-2870.5 4277.5,-2838 4277.5,-2838 4277.5,-2838 4736.87,-2838 4736.87,-2838"/>
<polygon fill="black" stroke="black" points="4736.87,-2841.5 4746.87,-2838 4736.87,-2834.5 4736.87,-2841.5"/>
</g>
<!-- l0_out_proj_2 -->
<g id="node44" class="node">
<title>l0_out_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="9246,-2784 8606,-2784 8606,-2748 9246,-2748 9246,-2784"/>
<text text-anchor="middle" x="8926" y="-2763.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_attn_2&#45;&gt;l0_out_proj_2 -->
<g id="edge53" class="edge">
<title>l0_attn_2&#45;&gt;l0_out_proj_2</title>
<path fill="none" stroke="black" d="M5437.29,-2832C5839.08,-2832 6448.17,-2832 6448.17,-2832 6448.17,-2832 6448.17,-2772 6448.17,-2772 6448.17,-2772 8595.87,-2772 8595.87,-2772"/>
<polygon fill="black" stroke="black" points="8595.87,-2775.5 8605.87,-2772 8595.87,-2768.5 8595.87,-2775.5"/>
</g>
<!-- l0_out_proj_2&#45;&gt;l0_res_2 -->
<g id="edge54" class="edge">
<title>l0_out_proj_2&#45;&gt;l0_res_2</title>
<path fill="none" stroke="black" d="M9063.28,-2747.83C9063.28,-2747.83 9063.28,-2717.16 9063.28,-2717.16"/>
<polygon fill="black" stroke="black" points="9066.78,-2717.16 9063.28,-2707.16 9059.78,-2717.16 9066.78,-2717.16"/>
</g>
<!-- l0_ln1_2 -->
<g id="node46" class="node">
<title>l0_ln1_2</title>
<polygon fill="lightgreen" stroke="black" points="9500.5,-2640 8907.5,-2640 8907.5,-2604 9500.5,-2604 9500.5,-2640"/>
<text text-anchor="middle" x="9204" y="-2619.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res_2&#45;&gt;l0_ln1_2 -->
<g id="edge56" class="edge">
<title>l0_res_2&#45;&gt;l0_ln1_2</title>
<path fill="none" stroke="black" d="M9204,-2675.83C9204,-2675.83 9204,-2650.41 9204,-2650.41"/>
<polygon fill="black" stroke="black" points="9207.5,-2650.41 9204,-2640.41 9200.5,-2650.41 9207.5,-2650.41"/>
</g>
<!-- l0_ffn_up_2 -->
<g id="node47" class="node">
<title>l0_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="9429.5,-2568 8806.5,-2568 8806.5,-2532 9429.5,-2532 9429.5,-2568"/>
<text text-anchor="middle" x="9118" y="-2547.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ln1_2&#45;&gt;l0_ffn_up_2 -->
<g id="edge57" class="edge">
<title>l0_ln1_2&#45;&gt;l0_ffn_up_2</title>
<path fill="none" stroke="black" d="M9168.5,-2603.83C9168.5,-2603.83 9168.5,-2578.41 9168.5,-2578.41"/>
<polygon fill="black" stroke="black" points="9172,-2578.41 9168.5,-2568.41 9165,-2578.41 9172,-2578.41"/>
</g>
<!-- l0_res2_2 -->
<g id="node49" class="node">
<title>l0_res2_2</title>
<polygon fill="lightgray" stroke="black" points="9435,-2424 8921.2,-2406 9435,-2388 9948.8,-2406 9435,-2424"/>
<text text-anchor="middle" x="9435" y="-2403.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln1_2&#45;&gt;l0_res2_2 -->
<g id="edge60" class="edge">
<title>l0_ln1_2&#45;&gt;l0_res2_2</title>
<path fill="none" stroke="black" d="M9466.75,-2603.96C9466.75,-2603.96 9466.75,-2432.94 9466.75,-2432.94"/>
<polygon fill="black" stroke="black" points="9470.25,-2432.94 9466.75,-2422.94 9463.25,-2432.94 9470.25,-2432.94"/>
</g>
<!-- l0_ffn_down_2 -->
<g id="node48" class="node">
<title>l0_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="9433,-2496 8797,-2496 8797,-2460 9433,-2460 9433,-2496"/>
<text text-anchor="middle" x="9115" y="-2475.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_2&#45;&gt;l0_ffn_down_2 -->
<g id="edge58" class="edge">
<title>l0_ffn_up_2&#45;&gt;l0_ffn_down_2</title>
<path fill="none" stroke="black" d="M9118,-2531.83C9118,-2531.83 9118,-2506.41 9118,-2506.41"/>
<polygon fill="black" stroke="black" points="9121.5,-2506.41 9118,-2496.41 9114.5,-2506.41 9121.5,-2506.41"/>
</g>
<!-- l0_ffn_down_2&#45;&gt;l0_res2_2 -->
<g id="edge59" class="edge">
<title>l0_ffn_down_2&#45;&gt;l0_res2_2</title>
<path fill="none" stroke="black" d="M9177.18,-2459.83C9177.18,-2459.83 9177.18,-2425.35 9177.18,-2425.35"/>
<polygon fill="black" stroke="black" points="9180.68,-2425.35 9177.18,-2415.35 9173.68,-2425.35 9180.68,-2425.35"/>
</g>
<!-- l0_ln2_2 -->
<g id="node50" class="node">
<title>l0_ln2_2</title>
<polygon fill="lightgreen" stroke="black" points="10110.5,-2352 9517.5,-2352 9517.5,-2316 10110.5,-2316 10110.5,-2352"/>
<text text-anchor="middle" x="9814" y="-2331.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res2_2&#45;&gt;l0_ln2_2 -->
<g id="edge61" class="edge">
<title>l0_res2_2&#45;&gt;l0_ln2_2</title>
<path fill="none" stroke="black" d="M9733.07,-2398.29C9733.07,-2398.29 9733.07,-2362.05 9733.07,-2362.05"/>
<polygon fill="black" stroke="black" points="9736.57,-2362.05 9733.07,-2352.05 9729.57,-2362.05 9736.57,-2362.05"/>
</g>
<!-- l0_ln2_2&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge139" class="edge">
<title>l0_ln2_2&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M10110.74,-2334C10180.56,-2334 10235.09,-2334 10235.09,-2334 10235.09,-2334 10235.09,-2272.05 10235.09,-2272.05"/>
<polygon fill="black" stroke="black" points="10238.59,-2272.05 10235.09,-2262.05 10231.59,-2272.05 10238.59,-2272.05"/>
</g>
<!-- l0_attn_3 -->
<g id="node54" class="node">
<title>l0_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="7344,-2856 6654,-2856 6654,-2820 7344,-2820 7344,-2856"/>
<text text-anchor="middle" x="6999" y="-2835.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l0_q_proj_3&#45;&gt;l0_attn_3 -->
<g id="edge65" class="edge">
<title>l0_q_proj_3&#45;&gt;l0_attn_3</title>
<path fill="none" stroke="black" d="M7176,-2891.83C7176,-2891.83 7176,-2866.41 7176,-2866.41"/>
<polygon fill="black" stroke="black" points="7179.5,-2866.41 7176,-2856.41 7172.5,-2866.41 7179.5,-2866.41"/>
</g>
<!-- l0_k_proj_3&#45;&gt;l0_attn_3 -->
<g id="edge66" class="edge">
<title>l0_k_proj_3&#45;&gt;l0_attn_3</title>
<path fill="none" stroke="black" d="M6821.75,-2891.83C6821.75,-2891.83 6821.75,-2866.41 6821.75,-2866.41"/>
<polygon fill="black" stroke="black" points="6825.25,-2866.41 6821.75,-2856.41 6818.25,-2866.41 6825.25,-2866.41"/>
</g>
<!-- l0_v_proj_3&#45;&gt;l0_attn_3 -->
<g id="edge67" class="edge">
<title>l0_v_proj_3&#45;&gt;l0_attn_3</title>
<path fill="none" stroke="black" d="M6194.25,-2891.97C6194.25,-2872.42 6194.25,-2844 6194.25,-2844 6194.25,-2844 6643.92,-2844 6643.92,-2844"/>
<polygon fill="black" stroke="black" points="6643.92,-2847.5 6653.92,-2844 6643.92,-2840.5 6643.92,-2847.5"/>
</g>
<!-- l0_out_proj_3 -->
<g id="node55" class="node">
<title>l0_out_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="10210,-2784 9570,-2784 9570,-2748 10210,-2748 10210,-2784"/>
<text text-anchor="middle" x="9890" y="-2763.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_attn_3&#45;&gt;l0_out_proj_3 -->
<g id="edge68" class="edge">
<title>l0_attn_3&#45;&gt;l0_out_proj_3</title>
<path fill="none" stroke="black" d="M6999,-2819.84C6999,-2791.26 6999,-2739 6999,-2739 6999,-2739 9640.08,-2739 9640.08,-2739 9640.08,-2739 9640.08,-2739.88 9640.08,-2739.88"/>
<polygon fill="black" stroke="black" points="9636.58,-2737.84 9640.08,-2747.84 9643.58,-2737.84 9636.58,-2737.84"/>
</g>
<!-- l0_out_proj_3&#45;&gt;l0_res_3 -->
<g id="edge69" class="edge">
<title>l0_out_proj_3&#45;&gt;l0_res_3</title>
<path fill="none" stroke="black" d="M10054.42,-2747.83C10054.42,-2747.83 10054.42,-2709.73 10054.42,-2709.73"/>
<polygon fill="black" stroke="black" points="10057.92,-2709.73 10054.42,-2699.73 10050.92,-2709.73 10057.92,-2709.73"/>
</g>
<!-- l0_ln1_3 -->
<g id="node57" class="node">
<title>l0_ln1_3</title>
<polygon fill="lightgreen" stroke="black" points="10701.5,-2640 10108.5,-2640 10108.5,-2604 10701.5,-2604 10701.5,-2640"/>
<text text-anchor="middle" x="10405" y="-2619.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res_3&#45;&gt;l0_ln1_3 -->
<g id="edge71" class="edge">
<title>l0_res_3&#45;&gt;l0_ln1_3</title>
<path fill="none" stroke="black" d="M10405,-2675.83C10405,-2675.83 10405,-2650.41 10405,-2650.41"/>
<polygon fill="black" stroke="black" points="10408.5,-2650.41 10405,-2640.41 10401.5,-2650.41 10408.5,-2650.41"/>
</g>
<!-- l0_ffn_up_3 -->
<g id="node58" class="node">
<title>l0_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="10629.5,-2568 10006.5,-2568 10006.5,-2532 10629.5,-2532 10629.5,-2568"/>
<text text-anchor="middle" x="10318" y="-2547.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ln1_3&#45;&gt;l0_ffn_up_3 -->
<g id="edge72" class="edge">
<title>l0_ln1_3&#45;&gt;l0_ffn_up_3</title>
<path fill="none" stroke="black" d="M10369,-2603.83C10369,-2603.83 10369,-2578.41 10369,-2578.41"/>
<polygon fill="black" stroke="black" points="10372.5,-2578.41 10369,-2568.41 10365.5,-2578.41 10372.5,-2578.41"/>
</g>
<!-- l0_res2_3 -->
<g id="node60" class="node">
<title>l0_res2_3</title>
<polygon fill="lightgray" stroke="black" points="10480,-2424 9966.2,-2406 10480,-2388 10993.8,-2406 10480,-2424"/>
<text text-anchor="middle" x="10480" y="-2403.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln1_3&#45;&gt;l0_res2_3 -->
<g id="edge75" class="edge">
<title>l0_ln1_3&#45;&gt;l0_res2_3</title>
<path fill="none" stroke="black" d="M10666.75,-2603.96C10666.75,-2603.96 10666.75,-2427.72 10666.75,-2427.72"/>
<polygon fill="black" stroke="black" points="10670.25,-2427.72 10666.75,-2417.72 10663.25,-2427.72 10670.25,-2427.72"/>
</g>
<!-- l0_ffn_down_3 -->
<g id="node59" class="node">
<title>l0_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="10632,-2496 9996,-2496 9996,-2460 10632,-2460 10632,-2496"/>
<text text-anchor="middle" x="10314" y="-2475.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_3&#45;&gt;l0_ffn_down_3 -->
<g id="edge73" class="edge">
<title>l0_ffn_up_3&#45;&gt;l0_ffn_down_3</title>
<path fill="none" stroke="black" d="M10318,-2531.83C10318,-2531.83 10318,-2506.41 10318,-2506.41"/>
<polygon fill="black" stroke="black" points="10321.5,-2506.41 10318,-2496.41 10314.5,-2506.41 10321.5,-2506.41"/>
</g>
<!-- l0_ffn_down_3&#45;&gt;l0_res2_3 -->
<g id="edge74" class="edge">
<title>l0_ffn_down_3&#45;&gt;l0_res2_3</title>
<path fill="none" stroke="black" d="M10314,-2459.83C10314,-2459.83 10314,-2428.28 10314,-2428.28"/>
<polygon fill="black" stroke="black" points="10317.5,-2428.27 10314,-2418.28 10310.5,-2428.28 10317.5,-2428.27"/>
</g>
<!-- l0_ln2_3 -->
<g id="node61" class="node">
<title>l0_ln2_3</title>
<polygon fill="lightgreen" stroke="black" points="10884.5,-2352 10291.5,-2352 10291.5,-2316 10884.5,-2316 10884.5,-2352"/>
<text text-anchor="middle" x="10588" y="-2331.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res2_3&#45;&gt;l0_ln2_3 -->
<g id="edge76" class="edge">
<title>l0_res2_3&#45;&gt;l0_ln2_3</title>
<path fill="none" stroke="black" d="M10588,-2391.78C10588,-2391.78 10588,-2362.03 10588,-2362.03"/>
<polygon fill="black" stroke="black" points="10591.5,-2362.03 10588,-2352.03 10584.5,-2362.03 10591.5,-2362.03"/>
</g>
<!-- l0_ln2_3&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge140" class="edge">
<title>l0_ln2_3&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M10588,-2315.83C10588,-2315.83 10588,-2290.41 10588,-2290.41"/>
<polygon fill="black" stroke="black" points="10591.5,-2290.41 10588,-2280.41 10584.5,-2290.41 10591.5,-2290.41"/>
</g>
<!-- l0_attn_4 -->
<g id="node65" class="node">
<title>l0_attn_4</title>
<polygon fill="lightgreen" stroke="black" points="9251,-2856 8561,-2856 8561,-2820 9251,-2820 9251,-2856"/>
<text text-anchor="middle" x="8906" y="-2835.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l0_q_proj_4&#45;&gt;l0_attn_4 -->
<g id="edge80" class="edge">
<title>l0_q_proj_4&#45;&gt;l0_attn_4</title>
<path fill="none" stroke="black" d="M9083,-2891.83C9083,-2891.83 9083,-2866.41 9083,-2866.41"/>
<polygon fill="black" stroke="black" points="9086.5,-2866.41 9083,-2856.41 9079.5,-2866.41 9086.5,-2866.41"/>
</g>
<!-- l0_k_proj_4&#45;&gt;l0_attn_4 -->
<g id="edge81" class="edge">
<title>l0_k_proj_4&#45;&gt;l0_attn_4</title>
<path fill="none" stroke="black" d="M8728.75,-2891.83C8728.75,-2891.83 8728.75,-2866.41 8728.75,-2866.41"/>
<polygon fill="black" stroke="black" points="8732.25,-2866.41 8728.75,-2856.41 8725.25,-2866.41 8732.25,-2866.41"/>
</g>
<!-- l0_v_proj_4&#45;&gt;l0_attn_4 -->
<g id="edge82" class="edge">
<title>l0_v_proj_4&#45;&gt;l0_attn_4</title>
<path fill="none" stroke="black" d="M8060.61,-2891.83C8060.61,-2870.5 8060.61,-2838 8060.61,-2838 8060.61,-2838 8550.93,-2838 8550.93,-2838"/>
<polygon fill="black" stroke="black" points="8550.93,-2841.5 8560.93,-2838 8550.93,-2834.5 8550.93,-2841.5"/>
</g>
<!-- l0_out_proj_4 -->
<g id="node66" class="node">
<title>l0_out_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="11338,-2784 10698,-2784 10698,-2748 11338,-2748 11338,-2784"/>
<text text-anchor="middle" x="11018" y="-2763.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_attn_4&#45;&gt;l0_out_proj_4 -->
<g id="edge83" class="edge">
<title>l0_attn_4&#45;&gt;l0_out_proj_4</title>
<path fill="none" stroke="black" d="M9251.38,-2832C9663.05,-2832 10296,-2832 10296,-2832 10296,-2832 10296,-2766 10296,-2766 10296,-2766 10687.9,-2766 10687.9,-2766"/>
<polygon fill="black" stroke="black" points="10687.9,-2769.5 10697.9,-2766 10687.9,-2762.5 10687.9,-2769.5"/>
</g>
<!-- l0_out_proj_4&#45;&gt;l0_res_4 -->
<g id="edge84" class="edge">
<title>l0_out_proj_4&#45;&gt;l0_res_4</title>
<path fill="none" stroke="black" d="M11207.28,-2747.83C11207.28,-2747.83 11207.28,-2713.35 11207.28,-2713.35"/>
<polygon fill="black" stroke="black" points="11210.78,-2713.35 11207.28,-2703.35 11203.78,-2713.35 11210.78,-2713.35"/>
</g>
<!-- l0_ln1_4 -->
<g id="node68" class="node">
<title>l0_ln1_4</title>
<polygon fill="lightgreen" stroke="black" points="11748.5,-2640 11155.5,-2640 11155.5,-2604 11748.5,-2604 11748.5,-2640"/>
<text text-anchor="middle" x="11452" y="-2619.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res_4&#45;&gt;l0_ln1_4 -->
<g id="edge86" class="edge">
<title>l0_res_4&#45;&gt;l0_ln1_4</title>
<path fill="none" stroke="black" d="M11452,-2675.83C11452,-2675.83 11452,-2650.41 11452,-2650.41"/>
<polygon fill="black" stroke="black" points="11455.5,-2650.41 11452,-2640.41 11448.5,-2650.41 11455.5,-2650.41"/>
</g>
<!-- l0_ffn_up_4 -->
<g id="node69" class="node">
<title>l0_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="11514.5,-2568 10891.5,-2568 10891.5,-2532 11514.5,-2532 11514.5,-2568"/>
<text text-anchor="middle" x="11203" y="-2547.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ln1_4&#45;&gt;l0_ffn_up_4 -->
<g id="edge87" class="edge">
<title>l0_ln1_4&#45;&gt;l0_ffn_up_4</title>
<path fill="none" stroke="black" d="M11335,-2603.83C11335,-2603.83 11335,-2578.41 11335,-2578.41"/>
<polygon fill="black" stroke="black" points="11338.5,-2578.41 11335,-2568.41 11331.5,-2578.41 11338.5,-2578.41"/>
</g>
<!-- l0_res2_4 -->
<g id="node71" class="node">
<title>l0_res2_4</title>
<polygon fill="lightgray" stroke="black" points="11525,-2424 11011.2,-2406 11525,-2388 12038.8,-2406 11525,-2424"/>
<text text-anchor="middle" x="11525" y="-2403.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln1_4&#45;&gt;l0_res2_4 -->
<g id="edge90" class="edge">
<title>l0_ln1_4&#45;&gt;l0_res2_4</title>
<path fill="none" stroke="black" d="M11633.25,-2603.96C11633.25,-2603.96 11633.25,-2430.37 11633.25,-2430.37"/>
<polygon fill="black" stroke="black" points="11636.75,-2430.37 11633.25,-2420.37 11629.75,-2430.37 11636.75,-2430.37"/>
</g>
<!-- l0_ffn_down_4 -->
<g id="node70" class="node">
<title>l0_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="11518,-2496 10882,-2496 10882,-2460 11518,-2460 11518,-2496"/>
<text text-anchor="middle" x="11200" y="-2475.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_4&#45;&gt;l0_ffn_down_4 -->
<g id="edge88" class="edge">
<title>l0_ffn_up_4&#45;&gt;l0_ffn_down_4</title>
<path fill="none" stroke="black" d="M11203,-2531.83C11203,-2531.83 11203,-2506.41 11203,-2506.41"/>
<polygon fill="black" stroke="black" points="11206.5,-2506.41 11203,-2496.41 11199.5,-2506.41 11206.5,-2506.41"/>
</g>
<!-- l0_ffn_down_4&#45;&gt;l0_res2_4 -->
<g id="edge89" class="edge">
<title>l0_ffn_down_4&#45;&gt;l0_res2_4</title>
<path fill="none" stroke="black" d="M11264.68,-2459.83C11264.68,-2459.83 11264.68,-2424.96 11264.68,-2424.96"/>
<polygon fill="black" stroke="black" points="11268.18,-2424.96 11264.68,-2414.96 11261.18,-2424.96 11268.18,-2424.96"/>
</g>
<!-- l0_ln2_4 -->
<g id="node72" class="node">
<title>l0_ln2_4</title>
<polygon fill="lightgreen" stroke="black" points="11712.5,-2352 11119.5,-2352 11119.5,-2316 11712.5,-2316 11712.5,-2352"/>
<text text-anchor="middle" x="11416" y="-2331.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res2_4&#45;&gt;l0_ln2_4 -->
<g id="edge91" class="edge">
<title>l0_res2_4&#45;&gt;l0_ln2_4</title>
<path fill="none" stroke="black" d="M11416,-2391.78C11416,-2391.78 11416,-2362.03 11416,-2362.03"/>
<polygon fill="black" stroke="black" points="11419.5,-2362.03 11416,-2352.03 11412.5,-2362.03 11419.5,-2362.03"/>
</g>
<!-- l0_ln2_4&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge141" class="edge">
<title>l0_ln2_4&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M11119.3,-2334C11059.9,-2334 11015.34,-2334 11015.34,-2334 11015.34,-2334 11015.34,-2272.05 11015.34,-2272.05"/>
<polygon fill="black" stroke="black" points="11018.84,-2272.05 11015.34,-2262.05 11011.84,-2272.05 11018.84,-2272.05"/>
</g>
<!-- l0_attn_5 -->
<g id="node76" class="node">
<title>l0_attn_5</title>
<polygon fill="lightgreen" stroke="black" points="11158,-2856 10468,-2856 10468,-2820 11158,-2820 11158,-2856"/>
<text text-anchor="middle" x="10813" y="-2835.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l0_q_proj_5&#45;&gt;l0_attn_5 -->
<g id="edge95" class="edge">
<title>l0_q_proj_5&#45;&gt;l0_attn_5</title>
<path fill="none" stroke="black" d="M10990,-2891.83C10990,-2891.83 10990,-2866.41 10990,-2866.41"/>
<polygon fill="black" stroke="black" points="10993.5,-2866.41 10990,-2856.41 10986.5,-2866.41 10993.5,-2866.41"/>
</g>
<!-- l0_k_proj_5&#45;&gt;l0_attn_5 -->
<g id="edge96" class="edge">
<title>l0_k_proj_5&#45;&gt;l0_attn_5</title>
<path fill="none" stroke="black" d="M10635.75,-2891.83C10635.75,-2891.83 10635.75,-2866.41 10635.75,-2866.41"/>
<polygon fill="black" stroke="black" points="10639.25,-2866.41 10635.75,-2856.41 10632.25,-2866.41 10639.25,-2866.41"/>
</g>
<!-- l0_v_proj_5&#45;&gt;l0_attn_5 -->
<g id="edge97" class="edge">
<title>l0_v_proj_5&#45;&gt;l0_attn_5</title>
<path fill="none" stroke="black" d="M9869.25,-2891.97C9869.25,-2872.42 9869.25,-2844 9869.25,-2844 9869.25,-2844 10457.94,-2844 10457.94,-2844"/>
<polygon fill="black" stroke="black" points="10457.94,-2847.5 10467.94,-2844 10457.94,-2840.5 10457.94,-2847.5"/>
</g>
<!-- l0_out_proj_5 -->
<g id="node77" class="node">
<title>l0_out_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="12149,-2784 11509,-2784 11509,-2748 12149,-2748 12149,-2784"/>
<text text-anchor="middle" x="11829" y="-2763.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_attn_5&#45;&gt;l0_out_proj_5 -->
<g id="edge98" class="edge">
<title>l0_attn_5&#45;&gt;l0_out_proj_5</title>
<path fill="none" stroke="black" d="M11158.27,-2832C11406.58,-2832 11697.83,-2832 11697.83,-2832 11697.83,-2832 11697.83,-2794.03 11697.83,-2794.03"/>
<polygon fill="black" stroke="black" points="11701.33,-2794.03 11697.83,-2784.03 11694.33,-2794.03 11701.33,-2794.03"/>
</g>
<!-- l0_out_proj_5&#45;&gt;l0_res_5 -->
<g id="edge99" class="edge">
<title>l0_out_proj_5&#45;&gt;l0_res_5</title>
<path fill="none" stroke="black" d="M12065.42,-2747.83C12065.42,-2747.83 12065.42,-2707.14 12065.42,-2707.14"/>
<polygon fill="black" stroke="black" points="12068.92,-2707.14 12065.42,-2697.14 12061.92,-2707.14 12068.92,-2707.14"/>
</g>
<!-- l0_ln1_5 -->
<g id="node79" class="node">
<title>l0_ln1_5</title>
<polygon fill="lightgreen" stroke="black" points="12784.5,-2640 12191.5,-2640 12191.5,-2604 12784.5,-2604 12784.5,-2640"/>
<text text-anchor="middle" x="12488" y="-2619.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res_5&#45;&gt;l0_ln1_5 -->
<g id="edge101" class="edge">
<title>l0_res_5&#45;&gt;l0_ln1_5</title>
<path fill="none" stroke="black" d="M12488,-2675.83C12488,-2675.83 12488,-2650.41 12488,-2650.41"/>
<polygon fill="black" stroke="black" points="12491.5,-2650.41 12488,-2640.41 12484.5,-2650.41 12491.5,-2650.41"/>
</g>
<!-- l0_ffn_up_5 -->
<g id="node80" class="node">
<title>l0_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="12715.5,-2568 12092.5,-2568 12092.5,-2532 12715.5,-2532 12715.5,-2568"/>
<text text-anchor="middle" x="12404" y="-2547.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ln1_5&#45;&gt;l0_ffn_up_5 -->
<g id="edge102" class="edge">
<title>l0_ln1_5&#45;&gt;l0_ffn_up_5</title>
<path fill="none" stroke="black" d="M12453.5,-2603.83C12453.5,-2603.83 12453.5,-2578.41 12453.5,-2578.41"/>
<polygon fill="black" stroke="black" points="12457,-2578.41 12453.5,-2568.41 12450,-2578.41 12457,-2578.41"/>
</g>
<!-- l0_res2_5 -->
<g id="node82" class="node">
<title>l0_res2_5</title>
<polygon fill="lightgray" stroke="black" points="12570,-2424 12056.2,-2406 12570,-2388 13083.8,-2406 12570,-2424"/>
<text text-anchor="middle" x="12570" y="-2403.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln1_5&#45;&gt;l0_res2_5 -->
<g id="edge105" class="edge">
<title>l0_ln1_5&#45;&gt;l0_res2_5</title>
<path fill="none" stroke="black" d="M12751.75,-2603.96C12751.75,-2603.96 12751.75,-2427.72 12751.75,-2427.72"/>
<polygon fill="black" stroke="black" points="12755.25,-2427.72 12751.75,-2417.72 12748.25,-2427.72 12755.25,-2427.72"/>
</g>
<!-- l0_ffn_down_5 -->
<g id="node81" class="node">
<title>l0_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="12719,-2496 12083,-2496 12083,-2460 12719,-2460 12719,-2496"/>
<text text-anchor="middle" x="12401" y="-2475.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_5&#45;&gt;l0_ffn_down_5 -->
<g id="edge103" class="edge">
<title>l0_ffn_up_5&#45;&gt;l0_ffn_down_5</title>
<path fill="none" stroke="black" d="M12404,-2531.83C12404,-2531.83 12404,-2506.41 12404,-2506.41"/>
<polygon fill="black" stroke="black" points="12407.5,-2506.41 12404,-2496.41 12400.5,-2506.41 12407.5,-2506.41"/>
</g>
<!-- l0_ffn_down_5&#45;&gt;l0_res2_5 -->
<g id="edge104" class="edge">
<title>l0_ffn_down_5&#45;&gt;l0_res2_5</title>
<path fill="none" stroke="black" d="M12401,-2459.83C12401,-2459.83 12401,-2428.28 12401,-2428.28"/>
<polygon fill="black" stroke="black" points="12404.5,-2428.27 12401,-2418.28 12397.5,-2428.28 12404.5,-2428.27"/>
</g>
<!-- l0_ln2_5 -->
<g id="node83" class="node">
<title>l0_ln2_5</title>
<polygon fill="lightgreen" stroke="black" points="12648.5,-2352 12055.5,-2352 12055.5,-2316 12648.5,-2316 12648.5,-2352"/>
<text text-anchor="middle" x="12352" y="-2331.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res2_5&#45;&gt;l0_ln2_5 -->
<g id="edge106" class="edge">
<title>l0_res2_5&#45;&gt;l0_ln2_5</title>
<path fill="none" stroke="black" d="M12352.43,-2395.38C12352.43,-2395.38 12352.43,-2362.21 12352.43,-2362.21"/>
<polygon fill="black" stroke="black" points="12355.93,-2362.21 12352.43,-2352.21 12348.93,-2362.21 12355.93,-2362.21"/>
</g>
<!-- l0_ln2_5&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge142" class="edge">
<title>l0_ln2_5&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M12230.5,-2315.96C12230.5,-2299.27 12230.5,-2277 12230.5,-2277 12230.5,-2277 11014.91,-2277 11014.91,-2277"/>
<polygon fill="black" stroke="black" points="11014.91,-2273.5 11004.91,-2277 11014.91,-2280.5 11014.91,-2273.5"/>
</g>
<!-- l0_attn_6 -->
<g id="node87" class="node">
<title>l0_attn_6</title>
<polygon fill="lightgreen" stroke="black" points="13050,-2856 12360,-2856 12360,-2820 13050,-2820 13050,-2856"/>
<text text-anchor="middle" x="12705" y="-2835.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l0_q_proj_6&#45;&gt;l0_attn_6 -->
<g id="edge110" class="edge">
<title>l0_q_proj_6&#45;&gt;l0_attn_6</title>
<path fill="none" stroke="black" d="M12889.5,-2891.83C12889.5,-2891.83 12889.5,-2866.41 12889.5,-2866.41"/>
<polygon fill="black" stroke="black" points="12893,-2866.41 12889.5,-2856.41 12886,-2866.41 12893,-2866.41"/>
</g>
<!-- l0_k_proj_6&#45;&gt;l0_attn_6 -->
<g id="edge111" class="edge">
<title>l0_k_proj_6&#45;&gt;l0_attn_6</title>
<path fill="none" stroke="black" d="M12535.25,-2891.83C12535.25,-2891.83 12535.25,-2866.41 12535.25,-2866.41"/>
<polygon fill="black" stroke="black" points="12538.75,-2866.41 12535.25,-2856.41 12531.75,-2866.41 12538.75,-2866.41"/>
</g>
<!-- l0_v_proj_6&#45;&gt;l0_attn_6 -->
<g id="edge112" class="edge">
<title>l0_v_proj_6&#45;&gt;l0_attn_6</title>
<path fill="none" stroke="black" d="M11886.67,-2891.97C11886.67,-2872.42 11886.67,-2844 11886.67,-2844 11886.67,-2844 12349.73,-2844 12349.73,-2844"/>
<polygon fill="black" stroke="black" points="12349.73,-2847.5 12359.73,-2844 12349.73,-2840.5 12349.73,-2847.5"/>
</g>
<!-- l0_out_proj_6 -->
<g id="node88" class="node">
<title>l0_out_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="13472,-2784 12832,-2784 12832,-2748 13472,-2748 13472,-2784"/>
<text text-anchor="middle" x="13152" y="-2763.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_attn_6&#45;&gt;l0_out_proj_6 -->
<g id="edge113" class="edge">
<title>l0_attn_6&#45;&gt;l0_out_proj_6</title>
<path fill="none" stroke="black" d="M12941,-2819.83C12941,-2819.83 12941,-2794.41 12941,-2794.41"/>
<polygon fill="black" stroke="black" points="12944.5,-2794.41 12941,-2784.41 12937.5,-2794.41 12944.5,-2794.41"/>
</g>
<!-- l0_out_proj_6&#45;&gt;l0_res_6 -->
<g id="edge114" class="edge">
<title>l0_out_proj_6&#45;&gt;l0_res_6</title>
<path fill="none" stroke="black" d="M13250.92,-2747.83C13250.92,-2747.83 13250.92,-2712.19 13250.92,-2712.19"/>
<polygon fill="black" stroke="black" points="13254.42,-2712.19 13250.92,-2702.19 13247.42,-2712.19 13254.42,-2712.19"/>
</g>
<!-- l0_ln1_6 -->
<g id="node90" class="node">
<title>l0_ln1_6</title>
<polygon fill="lightgreen" stroke="black" points="13832.5,-2640 13239.5,-2640 13239.5,-2604 13832.5,-2604 13832.5,-2640"/>
<text text-anchor="middle" x="13536" y="-2619.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res_6&#45;&gt;l0_ln1_6 -->
<g id="edge116" class="edge">
<title>l0_res_6&#45;&gt;l0_ln1_6</title>
<path fill="none" stroke="black" d="M13536,-2675.83C13536,-2675.83 13536,-2650.41 13536,-2650.41"/>
<polygon fill="black" stroke="black" points="13539.5,-2650.41 13536,-2640.41 13532.5,-2650.41 13539.5,-2650.41"/>
</g>
<!-- l0_ffn_up_6 -->
<g id="node91" class="node">
<title>l0_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="13843.5,-2568 13220.5,-2568 13220.5,-2532 13843.5,-2532 13843.5,-2568"/>
<text text-anchor="middle" x="13532" y="-2547.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ln1_6&#45;&gt;l0_ffn_up_6 -->
<g id="edge117" class="edge">
<title>l0_ln1_6&#45;&gt;l0_ffn_up_6</title>
<path fill="none" stroke="black" d="M13536,-2603.83C13536,-2603.83 13536,-2578.41 13536,-2578.41"/>
<polygon fill="black" stroke="black" points="13539.5,-2578.41 13536,-2568.41 13532.5,-2578.41 13539.5,-2578.41"/>
</g>
<!-- l0_res2_6 -->
<g id="node93" class="node">
<title>l0_res2_6</title>
<polygon fill="lightgray" stroke="black" points="13615,-2424 13101.2,-2406 13615,-2388 14128.8,-2406 13615,-2424"/>
<text text-anchor="middle" x="13615" y="-2403.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln1_6&#45;&gt;l0_res2_6 -->
<g id="edge120" class="edge">
<title>l0_ln1_6&#45;&gt;l0_res2_6</title>
<path fill="none" stroke="black" d="M13239.14,-2622C13190.53,-2622 13155.68,-2622 13155.68,-2622 13155.68,-2622 13155.68,-2418.43 13155.68,-2418.43"/>
<polygon fill="black" stroke="black" points="13159.18,-2418.43 13155.68,-2408.43 13152.18,-2418.43 13159.18,-2418.43"/>
</g>
<!-- l0_ffn_down_6 -->
<g id="node92" class="node">
<title>l0_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="13846,-2496 13210,-2496 13210,-2460 13846,-2460 13846,-2496"/>
<text text-anchor="middle" x="13528" y="-2475.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_6&#45;&gt;l0_ffn_down_6 -->
<g id="edge118" class="edge">
<title>l0_ffn_up_6&#45;&gt;l0_ffn_down_6</title>
<path fill="none" stroke="black" d="M13532,-2531.83C13532,-2531.83 13532,-2506.41 13532,-2506.41"/>
<polygon fill="black" stroke="black" points="13535.5,-2506.41 13532,-2496.41 13528.5,-2506.41 13535.5,-2506.41"/>
</g>
<!-- l0_ffn_down_6&#45;&gt;l0_res2_6 -->
<g id="edge119" class="edge">
<title>l0_ffn_down_6&#45;&gt;l0_res2_6</title>
<path fill="none" stroke="black" d="M13528,-2459.83C13528,-2459.83 13528,-2431.01 13528,-2431.01"/>
<polygon fill="black" stroke="black" points="13531.5,-2431.01 13528,-2421.01 13524.5,-2431.01 13531.5,-2431.01"/>
</g>
<!-- l0_ln2_6 -->
<g id="node94" class="node">
<title>l0_ln2_6</title>
<polygon fill="lightgreen" stroke="black" points="13639.5,-2352 13046.5,-2352 13046.5,-2316 13639.5,-2316 13639.5,-2352"/>
<text text-anchor="middle" x="13343" y="-2331.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res2_6&#45;&gt;l0_ln2_6 -->
<g id="edge121" class="edge">
<title>l0_res2_6&#45;&gt;l0_ln2_6</title>
<path fill="none" stroke="black" d="M13370.43,-2396.29C13370.43,-2396.29 13370.43,-2362.12 13370.43,-2362.12"/>
<polygon fill="black" stroke="black" points="13373.93,-2362.12 13370.43,-2352.12 13366.93,-2362.12 13373.93,-2362.12"/>
</g>
<!-- l0_ln2_6&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge143" class="edge">
<title>l0_ln2_6&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M13055.5,-2316C13055.5,-2298.32 13055.5,-2274 13055.5,-2274 13055.5,-2274 11000.62,-2274 11000.62,-2274"/>
<polygon fill="black" stroke="black" points="11000.62,-2270.5 10990.62,-2274 11000.62,-2277.5 11000.62,-2270.5"/>
</g>
<!-- l0_attn_7 -->
<g id="node98" class="node">
<title>l0_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="14679,-2856 13989,-2856 13989,-2820 14679,-2820 14679,-2856"/>
<text text-anchor="middle" x="14334" y="-2835.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l0_q_proj_7&#45;&gt;l0_attn_7 -->
<g id="edge125" class="edge">
<title>l0_q_proj_7&#45;&gt;l0_attn_7</title>
<path fill="none" stroke="black" d="M14657.5,-2891.83C14657.5,-2891.83 14657.5,-2866.41 14657.5,-2866.41"/>
<polygon fill="black" stroke="black" points="14661,-2866.41 14657.5,-2856.41 14654,-2866.41 14661,-2866.41"/>
</g>
<!-- l0_k_proj_7&#45;&gt;l0_attn_7 -->
<g id="edge126" class="edge">
<title>l0_k_proj_7&#45;&gt;l0_attn_7</title>
<path fill="none" stroke="black" d="M14309,-2891.83C14309,-2891.83 14309,-2866.41 14309,-2866.41"/>
<polygon fill="black" stroke="black" points="14312.5,-2866.41 14309,-2856.41 14305.5,-2866.41 14312.5,-2866.41"/>
</g>
<!-- l0_v_proj_7&#45;&gt;l0_attn_7 -->
<g id="edge127" class="edge">
<title>l0_v_proj_7&#45;&gt;l0_attn_7</title>
<path fill="none" stroke="black" d="M13982.57,-2910C13990.35,-2910 13994.75,-2910 13994.75,-2910 13994.75,-2910 13994.75,-2866.17 13994.75,-2866.17"/>
<polygon fill="black" stroke="black" points="13998.25,-2866.17 13994.75,-2856.17 13991.25,-2866.17 13998.25,-2866.17"/>
</g>
<!-- l0_out_proj_7 -->
<g id="node99" class="node">
<title>l0_out_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="14813,-2784 14173,-2784 14173,-2748 14813,-2748 14813,-2784"/>
<text text-anchor="middle" x="14493" y="-2763.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_attn_7&#45;&gt;l0_out_proj_7 -->
<g id="edge128" class="edge">
<title>l0_attn_7&#45;&gt;l0_out_proj_7</title>
<path fill="none" stroke="black" d="M14426,-2819.83C14426,-2819.83 14426,-2794.41 14426,-2794.41"/>
<polygon fill="black" stroke="black" points="14429.5,-2794.41 14426,-2784.41 14422.5,-2794.41 14429.5,-2794.41"/>
</g>
<!-- l0_out_proj_7&#45;&gt;l0_res_7 -->
<g id="edge129" class="edge">
<title>l0_out_proj_7&#45;&gt;l0_res_7</title>
<path fill="none" stroke="black" d="M14493,-2747.83C14493,-2747.83 14493,-2719.48 14493,-2719.48"/>
<polygon fill="black" stroke="black" points="14496.5,-2719.48 14493,-2709.48 14489.5,-2719.48 14496.5,-2719.48"/>
</g>
<!-- l0_ln1_7 -->
<g id="node101" class="node">
<title>l0_ln1_7</title>
<polygon fill="lightgreen" stroke="black" points="14869.5,-2640 14276.5,-2640 14276.5,-2604 14869.5,-2604 14869.5,-2640"/>
<text text-anchor="middle" x="14573" y="-2619.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res_7&#45;&gt;l0_ln1_7 -->
<g id="edge131" class="edge">
<title>l0_res_7&#45;&gt;l0_ln1_7</title>
<path fill="none" stroke="black" d="M14573,-2675.83C14573,-2675.83 14573,-2650.41 14573,-2650.41"/>
<polygon fill="black" stroke="black" points="14576.5,-2650.41 14573,-2640.41 14569.5,-2650.41 14576.5,-2650.41"/>
</g>
<!-- l0_ffn_up_7 -->
<g id="node102" class="node">
<title>l0_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="14800.5,-2568 14177.5,-2568 14177.5,-2532 14800.5,-2532 14800.5,-2568"/>
<text text-anchor="middle" x="14489" y="-2547.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l0_ln1_7&#45;&gt;l0_ffn_up_7 -->
<g id="edge132" class="edge">
<title>l0_ln1_7&#45;&gt;l0_ffn_up_7</title>
<path fill="none" stroke="black" d="M14538.5,-2603.83C14538.5,-2603.83 14538.5,-2578.41 14538.5,-2578.41"/>
<polygon fill="black" stroke="black" points="14542,-2578.41 14538.5,-2568.41 14535,-2578.41 14542,-2578.41"/>
</g>
<!-- l0_res2_7 -->
<g id="node104" class="node">
<title>l0_res2_7</title>
<polygon fill="lightgray" stroke="black" points="14660,-2424 14146.2,-2406 14660,-2388 15173.8,-2406 14660,-2424"/>
<text text-anchor="middle" x="14660" y="-2403.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ln1_7&#45;&gt;l0_res2_7 -->
<g id="edge135" class="edge">
<title>l0_ln1_7&#45;&gt;l0_res2_7</title>
<path fill="none" stroke="black" d="M14836.25,-2603.96C14836.25,-2603.96 14836.25,-2427.98 14836.25,-2427.98"/>
<polygon fill="black" stroke="black" points="14839.75,-2427.98 14836.25,-2417.98 14832.75,-2427.98 14839.75,-2427.98"/>
</g>
<!-- l0_ffn_down_7 -->
<g id="node103" class="node">
<title>l0_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="14803,-2496 14167,-2496 14167,-2460 14803,-2460 14803,-2496"/>
<text text-anchor="middle" x="14485" y="-2475.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_ffn_up_7&#45;&gt;l0_ffn_down_7 -->
<g id="edge133" class="edge">
<title>l0_ffn_up_7&#45;&gt;l0_ffn_down_7</title>
<path fill="none" stroke="black" d="M14489,-2531.83C14489,-2531.83 14489,-2506.41 14489,-2506.41"/>
<polygon fill="black" stroke="black" points="14492.5,-2506.41 14489,-2496.41 14485.5,-2506.41 14492.5,-2506.41"/>
</g>
<!-- l0_ffn_down_7&#45;&gt;l0_res2_7 -->
<g id="edge134" class="edge">
<title>l0_ffn_down_7&#45;&gt;l0_res2_7</title>
<path fill="none" stroke="black" d="M14485,-2459.83C14485,-2459.83 14485,-2428.28 14485,-2428.28"/>
<polygon fill="black" stroke="black" points="14488.5,-2428.27 14485,-2418.28 14481.5,-2428.28 14488.5,-2428.27"/>
</g>
<!-- l0_ln2_7 -->
<g id="node105" class="node">
<title>l0_ln2_7</title>
<polygon fill="lightgreen" stroke="black" points="14657.5,-2352 14064.5,-2352 14064.5,-2316 14657.5,-2316 14657.5,-2352"/>
<text text-anchor="middle" x="14361" y="-2331.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l0_res2_7&#45;&gt;l0_ln2_7 -->
<g id="edge136" class="edge">
<title>l0_res2_7&#45;&gt;l0_ln2_7</title>
<path fill="none" stroke="black" d="M14401.93,-2396.88C14401.93,-2396.88 14401.93,-2362.15 14401.93,-2362.15"/>
<polygon fill="black" stroke="black" points="14405.43,-2362.15 14401.93,-2352.15 14398.43,-2362.15 14405.43,-2362.15"/>
</g>
<!-- l0_ln2_7&#45;&gt;comm_stage0_to_stage1 -->
<g id="edge144" class="edge">
<title>l0_ln2_7&#45;&gt;comm_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M14196.5,-2315.78C14196.5,-2297.17 14196.5,-2271 14196.5,-2271 14196.5,-2271 10986.35,-2271 10986.35,-2271"/>
<polygon fill="black" stroke="black" points="10986.35,-2267.5 10976.35,-2271 10986.35,-2274.5 10986.35,-2267.5"/>
</g>
<!-- l1_q_proj_0 -->
<g id="node107" class="node">
<title>l1_q_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="10494,-2207 9876,-2207 9876,-2171 10494,-2171 10494,-2207"/>
<text text-anchor="middle" x="10185" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_q_proj_0 -->
<g id="edge145" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_q_proj_0</title>
<path fill="none" stroke="black" d="M10336.34,-2243.96C10336.34,-2243.96 10336.34,-2217.09 10336.34,-2217.09"/>
<polygon fill="black" stroke="black" points="10339.84,-2217.09 10336.34,-2207.09 10332.84,-2217.09 10339.84,-2217.09"/>
</g>
<!-- l1_k_proj_0 -->
<g id="node108" class="node">
<title>l1_k_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="11764.5,-2207 11147.5,-2207 11147.5,-2171 11764.5,-2171 11764.5,-2207"/>
<text text-anchor="middle" x="11456" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_k_proj_0 -->
<g id="edge146" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_k_proj_0</title>
<path fill="none" stroke="black" d="M10856.81,-2246C11100.81,-2246 11430,-2246 11430,-2246 11430,-2246 11430,-2217.04 11430,-2217.04"/>
<polygon fill="black" stroke="black" points="11433.5,-2217.04 11430,-2207.04 11426.5,-2217.04 11433.5,-2217.04"/>
</g>
<!-- l1_v_proj_0 -->
<g id="node109" class="node">
<title>l1_v_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="11129.5,-2207 10512.5,-2207 10512.5,-2171 11129.5,-2171 11129.5,-2207"/>
<text text-anchor="middle" x="10821" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_v_proj_0 -->
<g id="edge147" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_v_proj_0</title>
<path fill="none" stroke="black" d="M10765.91,-2243.96C10765.91,-2243.96 10765.91,-2217.09 10765.91,-2217.09"/>
<polygon fill="black" stroke="black" points="10769.41,-2217.09 10765.91,-2207.09 10762.41,-2217.09 10769.41,-2217.09"/>
</g>
<!-- l1_res_0 -->
<g id="node112" class="node">
<title>l1_res_0</title>
<polygon fill="lightgray" stroke="black" points="12917,-1991 12410.69,-1973 12917,-1955 13423.31,-1973 12917,-1991"/>
<text text-anchor="middle" x="12917" y="-1970.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_res_0 -->
<g id="edge153" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_res_0</title>
<path fill="none" stroke="black" d="M10506.33,-2243.91C10506.33,-2187.1 10506.33,-2016 10506.33,-2016 10506.33,-2016 12484.56,-2016 12484.56,-2016 12484.56,-2016 12484.56,-1985.82 12484.56,-1985.82"/>
<polygon fill="black" stroke="black" points="12488.06,-1985.82 12484.56,-1975.82 12481.06,-1985.82 12488.06,-1985.82"/>
</g>
<!-- l1_q_proj_1 -->
<g id="node118" class="node">
<title>l1_q_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="4090,-2207 3472,-2207 3472,-2171 4090,-2171 4090,-2207"/>
<text text-anchor="middle" x="3781" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_q_proj_1 -->
<g id="edge160" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_q_proj_1</title>
<path fill="none" stroke="black" d="M10274.31,-2264C8941.45,-2264 3960.25,-2264 3960.25,-2264 3960.25,-2264 3960.25,-2217.16 3960.25,-2217.16"/>
<polygon fill="black" stroke="black" points="3963.75,-2217.16 3960.25,-2207.16 3956.75,-2217.16 3963.75,-2217.16"/>
</g>
<!-- l1_k_proj_1 -->
<g id="node119" class="node">
<title>l1_k_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="3453.5,-2207 2836.5,-2207 2836.5,-2171 3453.5,-2171 3453.5,-2207"/>
<text text-anchor="middle" x="3145" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_k_proj_1 -->
<g id="edge161" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_k_proj_1</title>
<path fill="none" stroke="black" d="M10283.84,-2266C8865.92,-2266 3146.75,-2266 3146.75,-2266 3146.75,-2266 3146.75,-2217.25 3146.75,-2217.25"/>
<polygon fill="black" stroke="black" points="3150.25,-2217.25 3146.75,-2207.25 3143.25,-2217.25 3150.25,-2217.25"/>
</g>
<!-- l1_v_proj_1 -->
<g id="node120" class="node">
<title>l1_v_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="2818.5,-2207 2201.5,-2207 2201.5,-2171 2818.5,-2171 2818.5,-2207"/>
<text text-anchor="middle" x="2510" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_v_proj_1 -->
<g id="edge162" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_v_proj_1</title>
<path fill="none" stroke="black" d="M10293.44,-2268C8839.13,-2268 2688.5,-2268 2688.5,-2268 2688.5,-2268 2688.5,-2217.32 2688.5,-2217.32"/>
<polygon fill="black" stroke="black" points="2692,-2217.32 2688.5,-2207.32 2685,-2217.32 2692,-2217.32"/>
</g>
<!-- l1_res_1 -->
<g id="node123" class="node">
<title>l1_res_1</title>
<polygon fill="lightgray" stroke="black" points="8569,-1991 8062.69,-1973 8569,-1955 9075.31,-1973 8569,-1991"/>
<text text-anchor="middle" x="8569" y="-1970.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_res_1 -->
<g id="edge168" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_res_1</title>
<path fill="none" stroke="black" d="M10497.08,-2243.95C10497.08,-2186.4 10497.08,-2011 10497.08,-2011 10497.08,-2011 8812.83,-2011 8812.83,-2011 8812.83,-2011 8812.83,-1992.59 8812.83,-1992.59"/>
<polygon fill="black" stroke="black" points="8816.33,-1992.59 8812.83,-1982.59 8809.33,-1992.59 8816.33,-1992.59"/>
</g>
<!-- l1_q_proj_2 -->
<g id="node129" class="node">
<title>l1_q_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="6653.5,-2207 6030.5,-2207 6030.5,-2171 6653.5,-2171 6653.5,-2207"/>
<text text-anchor="middle" x="6342" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_q_proj_2 -->
<g id="edge175" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_q_proj_2</title>
<path fill="none" stroke="black" d="M10240.91,-2257C9257.64,-2257 6588.67,-2257 6588.67,-2257 6588.67,-2257 6588.67,-2217.22 6588.67,-2217.22"/>
<polygon fill="black" stroke="black" points="6592.17,-2217.22 6588.67,-2207.22 6585.17,-2217.22 6592.17,-2217.22"/>
</g>
<!-- l1_k_proj_2 -->
<g id="node130" class="node">
<title>l1_k_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="7935.5,-2207 7312.5,-2207 7312.5,-2171 7935.5,-2171 7935.5,-2207"/>
<text text-anchor="middle" x="7624" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_k_proj_2 -->
<g id="edge176" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_k_proj_2</title>
<path fill="none" stroke="black" d="M10221.76,-2253C9484.54,-2253 7924,-2253 7924,-2253 7924,-2253 7924,-2217.17 7924,-2217.17"/>
<polygon fill="black" stroke="black" points="7927.5,-2217.17 7924,-2207.17 7920.5,-2217.17 7927.5,-2217.17"/>
</g>
<!-- l1_v_proj_2 -->
<g id="node131" class="node">
<title>l1_v_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="7294.5,-2207 6671.5,-2207 6671.5,-2171 7294.5,-2171 7294.5,-2207"/>
<text text-anchor="middle" x="6983" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_v_proj_2 -->
<g id="edge177" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_v_proj_2</title>
<path fill="none" stroke="black" d="M10231,-2255C9325.6,-2255 7062.93,-2255 7062.93,-2255 7062.93,-2255 7062.93,-2217.03 7062.93,-2217.03"/>
<polygon fill="black" stroke="black" points="7066.43,-2217.03 7062.93,-2207.03 7059.43,-2217.03 7066.43,-2217.03"/>
</g>
<!-- l1_res_2 -->
<g id="node134" class="node">
<title>l1_res_2</title>
<polygon fill="lightgray" stroke="black" points="10713,-1991 10201.7,-1973 10713,-1955 11224.3,-1973 10713,-1991"/>
<text text-anchor="middle" x="10713" y="-1970.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_res_2 -->
<g id="edge183" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_res_2</title>
<path fill="none" stroke="black" d="M10503.25,-2243.92C10503.25,-2243.92 10503.25,-1993.74 10503.25,-1993.74"/>
<polygon fill="black" stroke="black" points="10506.75,-1993.74 10503.25,-1983.74 10499.75,-1993.74 10506.75,-1993.74"/>
</g>
<!-- l1_q_proj_3 -->
<g id="node140" class="node">
<title>l1_q_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="6012.5,-2207 5389.5,-2207 5389.5,-2171 6012.5,-2171 6012.5,-2207"/>
<text text-anchor="middle" x="5701" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_q_proj_3 -->
<g id="edge190" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_q_proj_3</title>
<path fill="none" stroke="black" d="M10250.34,-2259C9131.36,-2259 5703.25,-2259 5703.25,-2259 5703.25,-2259 5703.25,-2217.03 5703.25,-2217.03"/>
<polygon fill="black" stroke="black" points="5706.75,-2217.03 5703.25,-2207.03 5699.75,-2217.03 5706.75,-2217.03"/>
</g>
<!-- l1_k_proj_3 -->
<g id="node141" class="node">
<title>l1_k_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="5371.5,-2207 4748.5,-2207 4748.5,-2171 5371.5,-2171 5371.5,-2207"/>
<text text-anchor="middle" x="5060" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_k_proj_3 -->
<g id="edge191" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_k_proj_3</title>
<path fill="none" stroke="black" d="M10259.81,-2261C9055.95,-2261 5060,-2261 5060,-2261 5060,-2261 5060,-2217.17 5060,-2217.17"/>
<polygon fill="black" stroke="black" points="5063.5,-2217.17 5060,-2207.17 5056.5,-2217.17 5063.5,-2217.17"/>
</g>
<!-- l1_v_proj_3 -->
<g id="node142" class="node">
<title>l1_v_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="4730.5,-2207 4107.5,-2207 4107.5,-2171 4730.5,-2171 4730.5,-2207"/>
<text text-anchor="middle" x="4419" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_v_proj_3 -->
<g id="edge192" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_v_proj_3</title>
<path fill="none" stroke="black" d="M10264.58,-2262C9002.23,-2262 4598,-2262 4598,-2262 4598,-2262 4598,-2217.04 4598,-2217.04"/>
<polygon fill="black" stroke="black" points="4601.5,-2217.04 4598,-2207.04 4594.5,-2217.04 4601.5,-2217.04"/>
</g>
<!-- l1_res_3 -->
<g id="node145" class="node">
<title>l1_res_3</title>
<polygon fill="lightgray" stroke="black" points="9606,-1991 9094.7,-1973 9606,-1955 10117.3,-1973 9606,-1991"/>
<text text-anchor="middle" x="9606" y="-1970.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_res_3 -->
<g id="edge198" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_res_3</title>
<path fill="none" stroke="black" d="M10500.17,-2243.72C10500.17,-2183.62 10500.17,-1996 10500.17,-1996 10500.17,-1996 9980.33,-1996 9980.33,-1996 9980.33,-1996 9980.33,-1987.88 9980.33,-1987.88"/>
<polygon fill="black" stroke="black" points="9983.83,-1987.88 9980.33,-1977.88 9976.83,-1987.88 9983.83,-1987.88"/>
</g>
<!-- l1_q_proj_4 -->
<g id="node151" class="node">
<title>l1_q_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="9858.5,-2207 9235.5,-2207 9235.5,-2171 9858.5,-2171 9858.5,-2207"/>
<text text-anchor="middle" x="9547" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_q_proj_4 -->
<g id="edge205" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_q_proj_4</title>
<path fill="none" stroke="black" d="M10183.49,-2245C9943.22,-2245 9688,-2245 9688,-2245 9688,-2245 9688,-2217.03 9688,-2217.03"/>
<polygon fill="black" stroke="black" points="9691.5,-2217.03 9688,-2207.03 9684.5,-2217.03 9691.5,-2217.03"/>
</g>
<!-- l1_k_proj_4 -->
<g id="node152" class="node">
<title>l1_k_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="9217.5,-2207 8594.5,-2207 8594.5,-2171 9217.5,-2171 9217.5,-2207"/>
<text text-anchor="middle" x="8906" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_k_proj_4 -->
<g id="edge206" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_k_proj_4</title>
<path fill="none" stroke="black" d="M10192.72,-2247C9778.39,-2247 9196,-2247 9196,-2247 9196,-2247 9196,-2217.03 9196,-2217.03"/>
<polygon fill="black" stroke="black" points="9199.5,-2217.03 9196,-2207.03 9192.5,-2217.03 9199.5,-2217.03"/>
</g>
<!-- l1_v_proj_4 -->
<g id="node153" class="node">
<title>l1_v_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="8576.5,-2207 7953.5,-2207 7953.5,-2171 8576.5,-2171 8576.5,-2207"/>
<text text-anchor="middle" x="8265" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_v_proj_4 -->
<g id="edge207" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_v_proj_4</title>
<path fill="none" stroke="black" d="M10202.41,-2249C9536.33,-2249 8265,-2249 8265,-2249 8265,-2249 8265,-2217 8265,-2217"/>
<polygon fill="black" stroke="black" points="8268.5,-2217 8265,-2207 8261.5,-2217 8268.5,-2217"/>
</g>
<!-- l1_res_4 -->
<g id="node156" class="node">
<title>l1_res_4</title>
<polygon fill="lightgray" stroke="black" points="11841,-1991 11329.7,-1973 11841,-1955 12352.3,-1973 11841,-1991"/>
<text text-anchor="middle" x="11841" y="-1970.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_res_4 -->
<g id="edge213" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_res_4</title>
<path fill="none" stroke="black" d="M10871.41,-2249C11218.37,-2249 11773.5,-2249 11773.5,-2249 11773.5,-2249 11773.5,-1998.63 11773.5,-1998.63"/>
<polygon fill="black" stroke="black" points="11777,-1998.63 11773.5,-1988.63 11770,-1998.63 11777,-1998.63"/>
</g>
<!-- l1_q_proj_5 -->
<g id="node162" class="node">
<title>l1_q_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="901.5,-2207 278.5,-2207 278.5,-2171 901.5,-2171 901.5,-2207"/>
<text text-anchor="middle" x="590" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_q_proj_5 -->
<g id="edge220" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_q_proj_5</title>
<path fill="none" stroke="black" d="M10321.83,-2274C8725.6,-2274 776.5,-2274 776.5,-2274 776.5,-2274 776.5,-2217.03 776.5,-2217.03"/>
<polygon fill="black" stroke="black" points="780,-2217.03 776.5,-2207.03 773,-2217.03 780,-2217.03"/>
</g>
<!-- l1_k_proj_5 -->
<g id="node163" class="node">
<title>l1_k_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="2183.5,-2207 1560.5,-2207 1560.5,-2171 2183.5,-2171 2183.5,-2207"/>
<text text-anchor="middle" x="1872" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_k_proj_5 -->
<g id="edge221" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_k_proj_5</title>
<path fill="none" stroke="black" d="M10302.98,-2270C8796.64,-2270 2053.5,-2270 2053.5,-2270 2053.5,-2270 2053.5,-2217.38 2053.5,-2217.38"/>
<polygon fill="black" stroke="black" points="2057,-2217.38 2053.5,-2207.38 2050,-2217.38 2057,-2217.38"/>
</g>
<!-- l1_v_proj_5 -->
<g id="node164" class="node">
<title>l1_v_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="1542.5,-2207 919.5,-2207 919.5,-2171 1542.5,-2171 1542.5,-2207"/>
<text text-anchor="middle" x="1231" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_v_proj_5 -->
<g id="edge222" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_v_proj_5</title>
<path fill="none" stroke="black" d="M10312.43,-2272C8757.55,-2272 1403.25,-2272 1403.25,-2272 1403.25,-2272 1403.25,-2217.01 1403.25,-2217.01"/>
<polygon fill="black" stroke="black" points="1406.75,-2217.01 1403.25,-2207.01 1399.75,-2217.01 1406.75,-2217.01"/>
</g>
<!-- l1_res_5 -->
<g id="node167" class="node">
<title>l1_res_5</title>
<polygon fill="lightgray" stroke="black" points="7520,-1991 7008.7,-1973 7520,-1955 8031.3,-1973 7520,-1991"/>
<text text-anchor="middle" x="7520" y="-1970.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_res_5 -->
<g id="edge228" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_res_5</title>
<path fill="none" stroke="black" d="M10211.95,-2251C9475.32,-2251 7944.5,-2251 7944.5,-2251 7944.5,-2251 7944.5,-1986.12 7944.5,-1986.12"/>
<polygon fill="black" stroke="black" points="7948,-1986.12 7944.5,-1976.12 7941,-1986.12 7948,-1986.12"/>
</g>
<!-- l1_q_proj_6 -->
<g id="node173" class="node">
<title>l1_q_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="15610.5,-2207 14987.5,-2207 14987.5,-2171 15610.5,-2171 15610.5,-2207"/>
<text text-anchor="middle" x="15299" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_q_proj_6 -->
<g id="edge235" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_q_proj_6</title>
<path fill="none" stroke="black" d="M10961.95,-2268C12028.86,-2268 15080.57,-2268 15080.57,-2268 15080.57,-2268 15080.57,-2217.32 15080.57,-2217.32"/>
<polygon fill="black" stroke="black" points="15084.07,-2217.32 15080.57,-2207.32 15077.07,-2217.32 15084.07,-2217.32"/>
</g>
<!-- l1_k_proj_6 -->
<g id="node174" class="node">
<title>l1_k_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="14969.5,-2207 14346.5,-2207 14346.5,-2171 14969.5,-2171 14969.5,-2207"/>
<text text-anchor="middle" x="14658" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_k_proj_6 -->
<g id="edge236" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_k_proj_6</title>
<path fill="none" stroke="black" d="M10952.68,-2266C11913.78,-2266 14502,-2266 14502,-2266 14502,-2266 14502,-2217.25 14502,-2217.25"/>
<polygon fill="black" stroke="black" points="14505.5,-2217.25 14502,-2207.25 14498.5,-2217.25 14505.5,-2217.25"/>
</g>
<!-- l1_v_proj_6 -->
<g id="node175" class="node">
<title>l1_v_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="14328.5,-2207 13705.5,-2207 13705.5,-2171 14328.5,-2171 14328.5,-2207"/>
<text text-anchor="middle" x="14017" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_v_proj_6 -->
<g id="edge237" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_v_proj_6</title>
<path fill="none" stroke="black" d="M10923.82,-2260C11753.37,-2260 13885,-2260 13885,-2260 13885,-2260 13885,-2217.28 13885,-2217.28"/>
<polygon fill="black" stroke="black" points="13888.5,-2217.28 13885,-2207.28 13881.5,-2217.28 13888.5,-2217.28"/>
</g>
<!-- l1_res_6 -->
<g id="node178" class="node">
<title>l1_res_6</title>
<polygon fill="lightgray" stroke="black" points="15032,-1991 14520.7,-1973 15032,-1955 15543.3,-1973 15032,-1991"/>
<text text-anchor="middle" x="15032" y="-1970.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_res_6 -->
<g id="edge243" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_res_6</title>
<path fill="none" stroke="black" d="M10509.42,-2243.89C10509.42,-2187.84 10509.42,-2021 10509.42,-2021 10509.42,-2021 14588.67,-2021 14588.67,-2021 14588.67,-2021 14588.67,-1985.58 14588.67,-1985.58"/>
<polygon fill="black" stroke="black" points="14592.17,-1985.58 14588.67,-1975.58 14585.17,-1985.58 14592.17,-1985.58"/>
</g>
<!-- l1_q_proj_7 -->
<g id="node184" class="node">
<title>l1_q_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="13687.5,-2207 13064.5,-2207 13064.5,-2171 13687.5,-2171 13687.5,-2207"/>
<text text-anchor="middle" x="13376" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_q_proj_7 -->
<g id="edge250" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_q_proj_7</title>
<path fill="none" stroke="black" d="M10909.45,-2257C11629.43,-2257 13352,-2257 13352,-2257 13352,-2257 13352,-2217.22 13352,-2217.22"/>
<polygon fill="black" stroke="black" points="13355.5,-2217.22 13352,-2207.22 13348.5,-2217.22 13355.5,-2217.22"/>
</g>
<!-- l1_k_proj_7 -->
<g id="node185" class="node">
<title>l1_k_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="13046.5,-2207 12423.5,-2207 12423.5,-2171 13046.5,-2171 13046.5,-2207"/>
<text text-anchor="middle" x="12735" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_k_proj_7 -->
<g id="edge251" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_k_proj_7</title>
<path fill="none" stroke="black" d="M10899.8,-2255C11443.95,-2255 12536,-2255 12536,-2255 12536,-2255 12536,-2217.03 12536,-2217.03"/>
<polygon fill="black" stroke="black" points="12539.5,-2217.03 12536,-2207.03 12532.5,-2217.03 12539.5,-2217.03"/>
</g>
<!-- l1_v_proj_7 -->
<g id="node186" class="node">
<title>l1_v_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="12405.5,-2207 11782.5,-2207 11782.5,-2171 12405.5,-2171 12405.5,-2207"/>
<text text-anchor="middle" x="12094" y="-2186.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_v_proj_7 -->
<g id="edge252" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_v_proj_7</title>
<path fill="none" stroke="black" d="M10885.61,-2252C11271.57,-2252 11910.57,-2252 11910.57,-2252 11910.57,-2252 11910.57,-2217.22 11910.57,-2217.22"/>
<polygon fill="black" stroke="black" points="11914.07,-2217.22 11910.57,-2207.22 11907.07,-2217.22 11914.07,-2217.22"/>
</g>
<!-- l1_res_7 -->
<g id="node189" class="node">
<title>l1_res_7</title>
<polygon fill="lightgray" stroke="black" points="13983,-1991 13471.7,-1973 13983,-1955 14494.3,-1973 13983,-1991"/>
<text text-anchor="middle" x="13983" y="-1970.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1&#45;&gt;l1_res_7 -->
<g id="edge258" class="edge">
<title>comm_stage0_to_stage1&#45;&gt;l1_res_7</title>
<path fill="none" stroke="black" d="M10938.19,-2263C11859.11,-2263 14337.5,-2263 14337.5,-2263 14337.5,-2263 14337.5,-1988.53 14337.5,-1988.53"/>
<polygon fill="black" stroke="black" points="14341,-1988.53 14337.5,-1978.53 14334,-1988.53 14341,-1988.53"/>
</g>
<!-- l1_attn_0 -->
<g id="node110" class="node">
<title>l1_attn_0</title>
<polygon fill="lightgreen" stroke="black" points="11483,-2135 10793,-2135 10793,-2099 11483,-2099 11483,-2135"/>
<text text-anchor="middle" x="11138" y="-2114.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l1_q_proj_0&#45;&gt;l1_attn_0 -->
<g id="edge148" class="edge">
<title>l1_q_proj_0&#45;&gt;l1_attn_0</title>
<path fill="none" stroke="black" d="M10182.25,-2170.97C10182.25,-2151.42 10182.25,-2123 10182.25,-2123 10182.25,-2123 10782.95,-2123 10782.95,-2123"/>
<polygon fill="black" stroke="black" points="10782.95,-2126.5 10792.95,-2123 10782.95,-2119.5 10782.95,-2126.5"/>
</g>
<!-- l1_k_proj_0&#45;&gt;l1_attn_0 -->
<g id="edge149" class="edge">
<title>l1_k_proj_0&#45;&gt;l1_attn_0</title>
<path fill="none" stroke="black" d="M11315.25,-2170.83C11315.25,-2170.83 11315.25,-2145.41 11315.25,-2145.41"/>
<polygon fill="black" stroke="black" points="11318.75,-2145.41 11315.25,-2135.41 11311.75,-2145.41 11318.75,-2145.41"/>
</g>
<!-- l1_v_proj_0&#45;&gt;l1_attn_0 -->
<g id="edge150" class="edge">
<title>l1_v_proj_0&#45;&gt;l1_attn_0</title>
<path fill="none" stroke="black" d="M10961.25,-2170.83C10961.25,-2170.83 10961.25,-2145.41 10961.25,-2145.41"/>
<polygon fill="black" stroke="black" points="10964.75,-2145.41 10961.25,-2135.41 10957.75,-2145.41 10964.75,-2145.41"/>
</g>
<!-- l1_out_proj_0 -->
<g id="node111" class="node">
<title>l1_out_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="12632,-2063 11992,-2063 11992,-2027 12632,-2027 12632,-2063"/>
<text text-anchor="middle" x="12312" y="-2042.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_attn_0&#45;&gt;l1_out_proj_0 -->
<g id="edge151" class="edge">
<title>l1_attn_0&#45;&gt;l1_out_proj_0</title>
<path fill="none" stroke="black" d="M11431.95,-2098.97C11431.95,-2079.42 11431.95,-2051 11431.95,-2051 11431.95,-2051 11981.79,-2051 11981.79,-2051"/>
<polygon fill="black" stroke="black" points="11981.79,-2054.5 11991.79,-2051 11981.79,-2047.5 11981.79,-2054.5"/>
</g>
<!-- l1_out_proj_0&#45;&gt;l1_res_0 -->
<g id="edge152" class="edge">
<title>l1_out_proj_0&#45;&gt;l1_res_0</title>
<path fill="none" stroke="black" d="M12558.28,-2026.83C12558.28,-2026.83 12558.28,-1988.41 12558.28,-1988.41"/>
<polygon fill="black" stroke="black" points="12561.78,-1988.41 12558.28,-1978.41 12554.78,-1988.41 12561.78,-1988.41"/>
</g>
<!-- l1_ln1_0 -->
<g id="node113" class="node">
<title>l1_ln1_0</title>
<polygon fill="lightgreen" stroke="black" points="13213.5,-1919 12620.5,-1919 12620.5,-1883 13213.5,-1883 13213.5,-1919"/>
<text text-anchor="middle" x="12917" y="-1898.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res_0&#45;&gt;l1_ln1_0 -->
<g id="edge154" class="edge">
<title>l1_res_0&#45;&gt;l1_ln1_0</title>
<path fill="none" stroke="black" d="M12917,-1954.83C12917,-1954.83 12917,-1929.41 12917,-1929.41"/>
<polygon fill="black" stroke="black" points="12920.5,-1929.41 12917,-1919.41 12913.5,-1929.41 12920.5,-1929.41"/>
</g>
<!-- l1_ffn_up_0 -->
<g id="node114" class="node">
<title>l1_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="13198.5,-1847 12575.5,-1847 12575.5,-1811 13198.5,-1811 13198.5,-1847"/>
<text text-anchor="middle" x="12887" y="-1826.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ln1_0&#45;&gt;l1_ffn_up_0 -->
<g id="edge155" class="edge">
<title>l1_ln1_0&#45;&gt;l1_ffn_up_0</title>
<path fill="none" stroke="black" d="M12909.5,-1882.83C12909.5,-1882.83 12909.5,-1857.41 12909.5,-1857.41"/>
<polygon fill="black" stroke="black" points="12913,-1857.41 12909.5,-1847.41 12906,-1857.41 12913,-1857.41"/>
</g>
<!-- l1_res2_0 -->
<g id="node116" class="node">
<title>l1_res2_0</title>
<polygon fill="lightgray" stroke="black" points="12935,-1703 12421.2,-1685 12935,-1667 13448.8,-1685 12935,-1703"/>
<text text-anchor="middle" x="12935" y="-1682.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln1_0&#45;&gt;l1_res2_0 -->
<g id="edge158" class="edge">
<title>l1_ln1_0&#45;&gt;l1_res2_0</title>
<path fill="none" stroke="black" d="M13207.25,-1882.96C13207.25,-1882.96 13207.25,-1703.87 13207.25,-1703.87"/>
<polygon fill="black" stroke="black" points="13210.75,-1703.87 13207.25,-1693.87 13203.75,-1703.87 13210.75,-1703.87"/>
</g>
<!-- l1_ffn_down_0 -->
<g id="node115" class="node">
<title>l1_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="13201,-1775 12565,-1775 12565,-1739 13201,-1739 13201,-1775"/>
<text text-anchor="middle" x="12883" y="-1754.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_0&#45;&gt;l1_ffn_down_0 -->
<g id="edge156" class="edge">
<title>l1_ffn_up_0&#45;&gt;l1_ffn_down_0</title>
<path fill="none" stroke="black" d="M12887,-1810.83C12887,-1810.83 12887,-1785.41 12887,-1785.41"/>
<polygon fill="black" stroke="black" points="12890.5,-1785.41 12887,-1775.41 12883.5,-1785.41 12890.5,-1785.41"/>
</g>
<!-- l1_ffn_down_0&#45;&gt;l1_res2_0 -->
<g id="edge157" class="edge">
<title>l1_ffn_down_0&#45;&gt;l1_res2_0</title>
<path fill="none" stroke="black" d="M12883,-1738.83C12883,-1738.83 12883,-1711.44 12883,-1711.44"/>
<polygon fill="black" stroke="black" points="12886.5,-1711.44 12883,-1701.44 12879.5,-1711.44 12886.5,-1711.44"/>
</g>
<!-- l1_ln2_0 -->
<g id="node117" class="node">
<title>l1_ln2_0</title>
<polygon fill="lightgreen" stroke="black" points="12958.5,-1631 12365.5,-1631 12365.5,-1595 12958.5,-1595 12958.5,-1631"/>
<text text-anchor="middle" x="12662" y="-1610.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res2_0&#45;&gt;l1_ln2_0 -->
<g id="edge159" class="edge">
<title>l1_res2_0&#45;&gt;l1_ln2_0</title>
<path fill="none" stroke="black" d="M12689.93,-1675.29C12689.93,-1675.29 12689.93,-1641.12 12689.93,-1641.12"/>
<polygon fill="black" stroke="black" points="12693.43,-1641.12 12689.93,-1631.12 12686.43,-1641.12 12693.43,-1641.12"/>
</g>
<!-- comm_stage1_to_stage0 -->
<g id="node195" class="node">
<title>comm_stage1_to_stage0</title>
<polygon fill="lightyellow" stroke="black" points="11888.15,-1559 11219.78,-1559 11047.85,-1523 11716.22,-1523 11888.15,-1559"/>
<text text-anchor="middle" x="11468" y="-1538.5" font-family="Arial" font-size="10.00">&lt;b&gt;Pipeline Communication&lt;/b&gt;&lt;br/&gt;All GPUs 8&#45;15 to All GPUs 0&#45;7&lt;br/&gt;[batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln2_0&#45;&gt;comm_stage1_to_stage0 -->
<g id="edge265" class="edge">
<title>l1_ln2_0&#45;&gt;comm_stage1_to_stage0</title>
<path fill="none" stroke="black" d="M12547.5,-1594.96C12547.5,-1578.27 12547.5,-1556 12547.5,-1556 12547.5,-1556 11884.19,-1556 11884.19,-1556"/>
<polygon fill="black" stroke="black" points="11884.19,-1552.5 11874.19,-1556 11884.19,-1559.5 11884.19,-1552.5"/>
</g>
<!-- l1_attn_1 -->
<g id="node121" class="node">
<title>l1_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="3808,-2135 3118,-2135 3118,-2099 3808,-2099 3808,-2135"/>
<text text-anchor="middle" x="3463" y="-2114.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l1_q_proj_1&#45;&gt;l1_attn_1 -->
<g id="edge163" class="edge">
<title>l1_q_proj_1&#45;&gt;l1_attn_1</title>
<path fill="none" stroke="black" d="M3640,-2170.83C3640,-2170.83 3640,-2145.41 3640,-2145.41"/>
<polygon fill="black" stroke="black" points="3643.5,-2145.41 3640,-2135.41 3636.5,-2145.41 3643.5,-2145.41"/>
</g>
<!-- l1_k_proj_1&#45;&gt;l1_attn_1 -->
<g id="edge164" class="edge">
<title>l1_k_proj_1&#45;&gt;l1_attn_1</title>
<path fill="none" stroke="black" d="M3285.75,-2170.83C3285.75,-2170.83 3285.75,-2145.41 3285.75,-2145.41"/>
<polygon fill="black" stroke="black" points="3289.25,-2145.41 3285.75,-2135.41 3282.25,-2145.41 3289.25,-2145.41"/>
</g>
<!-- l1_v_proj_1&#45;&gt;l1_attn_1 -->
<g id="edge165" class="edge">
<title>l1_v_proj_1&#45;&gt;l1_attn_1</title>
<path fill="none" stroke="black" d="M2735,-2170.97C2735,-2151.42 2735,-2123 2735,-2123 2735,-2123 3107.92,-2123 3107.92,-2123"/>
<polygon fill="black" stroke="black" points="3107.92,-2126.5 3117.92,-2123 3107.92,-2119.5 3107.92,-2126.5"/>
</g>
<!-- l1_out_proj_1 -->
<g id="node122" class="node">
<title>l1_out_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="4725,-2063 4085,-2063 4085,-2027 4725,-2027 4725,-2063"/>
<text text-anchor="middle" x="4405" y="-2042.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_attn_1&#45;&gt;l1_out_proj_1 -->
<g id="edge166" class="edge">
<title>l1_attn_1&#45;&gt;l1_out_proj_1</title>
<path fill="none" stroke="black" d="M3808.32,-2111C3957.6,-2111 4098.75,-2111 4098.75,-2111 4098.75,-2111 4098.75,-2073.03 4098.75,-2073.03"/>
<polygon fill="black" stroke="black" points="4102.25,-2073.03 4098.75,-2063.03 4095.25,-2073.03 4102.25,-2073.03"/>
</g>
<!-- l1_out_proj_1&#45;&gt;l1_res_1 -->
<g id="edge167" class="edge">
<title>l1_out_proj_1&#45;&gt;l1_res_1</title>
<path fill="none" stroke="black" d="M4605,-2026.68C4605,-1995.87 4605,-1937 4605,-1937 4605,-1937 8068.92,-1937 8068.92,-1937 8068.92,-1937 8068.92,-1962.6 8068.92,-1962.6"/>
<polygon fill="black" stroke="black" points="8065.42,-1962.6 8068.92,-1972.6 8072.42,-1962.6 8065.42,-1962.6"/>
</g>
<!-- l1_ln1_1 -->
<g id="node124" class="node">
<title>l1_ln1_1</title>
<polygon fill="lightgreen" stroke="black" points="8865.5,-1919 8272.5,-1919 8272.5,-1883 8865.5,-1883 8865.5,-1919"/>
<text text-anchor="middle" x="8569" y="-1898.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res_1&#45;&gt;l1_ln1_1 -->
<g id="edge169" class="edge">
<title>l1_res_1&#45;&gt;l1_ln1_1</title>
<path fill="none" stroke="black" d="M8569,-1954.83C8569,-1954.83 8569,-1929.41 8569,-1929.41"/>
<polygon fill="black" stroke="black" points="8572.5,-1929.41 8569,-1919.41 8565.5,-1929.41 8572.5,-1929.41"/>
</g>
<!-- l1_ffn_up_1 -->
<g id="node125" class="node">
<title>l1_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="8708.5,-1847 8085.5,-1847 8085.5,-1811 8708.5,-1811 8708.5,-1847"/>
<text text-anchor="middle" x="8397" y="-1826.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ln1_1&#45;&gt;l1_ffn_up_1 -->
<g id="edge170" class="edge">
<title>l1_ln1_1&#45;&gt;l1_ffn_up_1</title>
<path fill="none" stroke="black" d="M8490.5,-1882.83C8490.5,-1882.83 8490.5,-1857.41 8490.5,-1857.41"/>
<polygon fill="black" stroke="black" points="8494,-1857.41 8490.5,-1847.41 8487,-1857.41 8494,-1857.41"/>
</g>
<!-- l1_res2_1 -->
<g id="node127" class="node">
<title>l1_res2_1</title>
<polygon fill="lightgray" stroke="black" points="8729,-1703 8215.2,-1685 8729,-1667 9242.8,-1685 8729,-1703"/>
<text text-anchor="middle" x="8729" y="-1682.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln1_1&#45;&gt;l1_res2_1 -->
<g id="edge173" class="edge">
<title>l1_ln1_1&#45;&gt;l1_res2_1</title>
<path fill="none" stroke="black" d="M8788.25,-1882.96C8788.25,-1882.96 8788.25,-1711.06 8788.25,-1711.06"/>
<polygon fill="black" stroke="black" points="8791.75,-1711.06 8788.25,-1701.06 8784.75,-1711.06 8791.75,-1711.06"/>
</g>
<!-- l1_ffn_down_1 -->
<g id="node126" class="node">
<title>l1_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="8711,-1775 8075,-1775 8075,-1739 8711,-1739 8711,-1775"/>
<text text-anchor="middle" x="8393" y="-1754.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_1&#45;&gt;l1_ffn_down_1 -->
<g id="edge171" class="edge">
<title>l1_ffn_up_1&#45;&gt;l1_ffn_down_1</title>
<path fill="none" stroke="black" d="M8397,-1810.83C8397,-1810.83 8397,-1785.41 8397,-1785.41"/>
<polygon fill="black" stroke="black" points="8400.5,-1785.41 8397,-1775.41 8393.5,-1785.41 8400.5,-1785.41"/>
</g>
<!-- l1_ffn_down_1&#45;&gt;l1_res2_1 -->
<g id="edge172" class="edge">
<title>l1_ffn_down_1&#45;&gt;l1_res2_1</title>
<path fill="none" stroke="black" d="M8463.18,-1738.83C8463.18,-1738.83 8463.18,-1703.96 8463.18,-1703.96"/>
<polygon fill="black" stroke="black" points="8466.68,-1703.96 8463.18,-1693.96 8459.68,-1703.96 8466.68,-1703.96"/>
</g>
<!-- l1_ln2_1 -->
<g id="node128" class="node">
<title>l1_ln2_1</title>
<polygon fill="lightgreen" stroke="black" points="9518.5,-1631 8925.5,-1631 8925.5,-1595 9518.5,-1595 9518.5,-1631"/>
<text text-anchor="middle" x="9222" y="-1610.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res2_1&#45;&gt;l1_ln2_1 -->
<g id="edge174" class="edge">
<title>l1_res2_1&#45;&gt;l1_ln2_1</title>
<path fill="none" stroke="black" d="M9084.07,-1679.35C9084.07,-1679.35 9084.07,-1641.04 9084.07,-1641.04"/>
<polygon fill="black" stroke="black" points="9087.57,-1641.04 9084.07,-1631.04 9080.57,-1641.04 9087.57,-1641.04"/>
</g>
<!-- l1_ln2_1&#45;&gt;comm_stage1_to_stage0 -->
<g id="edge266" class="edge">
<title>l1_ln2_1&#45;&gt;comm_stage1_to_stage0</title>
<path fill="none" stroke="black" d="M9226.5,-1594.97C9226.5,-1577.94 9226.5,-1555 9226.5,-1555 9226.5,-1555 11190.4,-1555 11190.4,-1555"/>
<polygon fill="black" stroke="black" points="11190.4,-1558.5 11200.4,-1555 11190.4,-1551.5 11190.4,-1558.5"/>
</g>
<!-- l1_attn_2 -->
<g id="node132" class="node">
<title>l1_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="7650.5,-2135 6955.5,-2135 6955.5,-2099 7650.5,-2099 7650.5,-2135"/>
<text text-anchor="middle" x="7303" y="-2114.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l1_q_proj_2&#45;&gt;l1_attn_2 -->
<g id="edge178" class="edge">
<title>l1_q_proj_2&#45;&gt;l1_attn_2</title>
<path fill="none" stroke="black" d="M6644.83,-2170.97C6644.83,-2151.42 6644.83,-2123 6644.83,-2123 6644.83,-2123 6945.13,-2123 6945.13,-2123"/>
<polygon fill="black" stroke="black" points="6945.13,-2126.5 6955.13,-2123 6945.13,-2119.5 6945.13,-2126.5"/>
</g>
<!-- l1_k_proj_2&#45;&gt;l1_attn_2 -->
<g id="edge179" class="edge">
<title>l1_k_proj_2&#45;&gt;l1_attn_2</title>
<path fill="none" stroke="black" d="M7481.5,-2170.83C7481.5,-2170.83 7481.5,-2145.41 7481.5,-2145.41"/>
<polygon fill="black" stroke="black" points="7485,-2145.41 7481.5,-2135.41 7478,-2145.41 7485,-2145.41"/>
</g>
<!-- l1_v_proj_2&#45;&gt;l1_attn_2 -->
<g id="edge180" class="edge">
<title>l1_v_proj_2&#45;&gt;l1_attn_2</title>
<path fill="none" stroke="black" d="M7125,-2170.83C7125,-2170.83 7125,-2145.41 7125,-2145.41"/>
<polygon fill="black" stroke="black" points="7128.5,-2145.41 7125,-2135.41 7121.5,-2145.41 7128.5,-2145.41"/>
</g>
<!-- l1_out_proj_2 -->
<g id="node133" class="node">
<title>l1_out_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="9195.5,-2063 8550.5,-2063 8550.5,-2027 9195.5,-2027 9195.5,-2063"/>
<text text-anchor="middle" x="8873" y="-2042.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_attn_2&#45;&gt;l1_out_proj_2 -->
<g id="edge181" class="edge">
<title>l1_attn_2&#45;&gt;l1_out_proj_2</title>
<path fill="none" stroke="black" d="M7650.83,-2111C8022.6,-2111 8559.17,-2111 8559.17,-2111 8559.17,-2111 8559.17,-2073.03 8559.17,-2073.03"/>
<polygon fill="black" stroke="black" points="8562.67,-2073.03 8559.17,-2063.03 8555.67,-2073.03 8562.67,-2073.03"/>
</g>
<!-- l1_out_proj_2&#45;&gt;l1_res_2 -->
<g id="edge182" class="edge">
<title>l1_out_proj_2&#45;&gt;l1_res_2</title>
<path fill="none" stroke="black" d="M9161.95,-2026.87C9161.95,-2016.69 9161.95,-2006 9161.95,-2006 9161.95,-2006 10345.17,-2006 10345.17,-2006 10345.17,-2006 10345.17,-1988.16 10345.17,-1988.16"/>
<polygon fill="black" stroke="black" points="10348.67,-1988.16 10345.17,-1978.16 10341.67,-1988.16 10348.67,-1988.16"/>
</g>
<!-- l1_ln1_2 -->
<g id="node135" class="node">
<title>l1_ln1_2</title>
<polygon fill="lightgreen" stroke="black" points="11012,-1919 10414,-1919 10414,-1883 11012,-1883 11012,-1919"/>
<text text-anchor="middle" x="10713" y="-1898.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res_2&#45;&gt;l1_ln1_2 -->
<g id="edge184" class="edge">
<title>l1_res_2&#45;&gt;l1_ln1_2</title>
<path fill="none" stroke="black" d="M10713,-1954.83C10713,-1954.83 10713,-1929.41 10713,-1929.41"/>
<polygon fill="black" stroke="black" points="10716.5,-1929.41 10713,-1919.41 10709.5,-1929.41 10716.5,-1929.41"/>
</g>
<!-- l1_ffn_up_2 -->
<g id="node136" class="node">
<title>l1_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="10987.5,-1847 10358.5,-1847 10358.5,-1811 10987.5,-1811 10987.5,-1847"/>
<text text-anchor="middle" x="10673" y="-1826.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ln1_2&#45;&gt;l1_ffn_up_2 -->
<g id="edge185" class="edge">
<title>l1_ln1_2&#45;&gt;l1_ffn_up_2</title>
<path fill="none" stroke="black" d="M10700.75,-1882.83C10700.75,-1882.83 10700.75,-1857.41 10700.75,-1857.41"/>
<polygon fill="black" stroke="black" points="10704.25,-1857.41 10700.75,-1847.41 10697.25,-1857.41 10704.25,-1857.41"/>
</g>
<!-- l1_res2_2 -->
<g id="node138" class="node">
<title>l1_res2_2</title>
<polygon fill="lightgray" stroke="black" points="10832,-1703 10314.38,-1685 10832,-1667 11349.62,-1685 10832,-1703"/>
<text text-anchor="middle" x="10832" y="-1682.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln1_2&#45;&gt;l1_res2_2 -->
<g id="edge188" class="edge">
<title>l1_ln1_2&#45;&gt;l1_res2_2</title>
<path fill="none" stroke="black" d="M11001.25,-1882.96C11001.25,-1882.96 11001.25,-1707.23 11001.25,-1707.23"/>
<polygon fill="black" stroke="black" points="11004.75,-1707.23 11001.25,-1697.23 10997.75,-1707.23 11004.75,-1707.23"/>
</g>
<!-- l1_ffn_down_2 -->
<g id="node137" class="node">
<title>l1_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="10990.5,-1775 10349.5,-1775 10349.5,-1739 10990.5,-1739 10990.5,-1775"/>
<text text-anchor="middle" x="10670" y="-1754.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_2&#45;&gt;l1_ffn_down_2 -->
<g id="edge186" class="edge">
<title>l1_ffn_up_2&#45;&gt;l1_ffn_down_2</title>
<path fill="none" stroke="black" d="M10673,-1810.83C10673,-1810.83 10673,-1785.41 10673,-1785.41"/>
<polygon fill="black" stroke="black" points="10676.5,-1785.41 10673,-1775.41 10669.5,-1785.41 10676.5,-1785.41"/>
</g>
<!-- l1_ffn_down_2&#45;&gt;l1_res2_2 -->
<g id="edge187" class="edge">
<title>l1_ffn_down_2&#45;&gt;l1_res2_2</title>
<path fill="none" stroke="black" d="M10670,-1738.83C10670,-1738.83 10670,-1707.72 10670,-1707.72"/>
<polygon fill="black" stroke="black" points="10673.5,-1707.72 10670,-1697.72 10666.5,-1707.72 10673.5,-1707.72"/>
</g>
<!-- l1_ln2_2 -->
<g id="node139" class="node">
<title>l1_ln2_2</title>
<polygon fill="lightgreen" stroke="black" points="11405,-1631 10807,-1631 10807,-1595 11405,-1595 11405,-1631"/>
<text text-anchor="middle" x="11106" y="-1610.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res2_2&#45;&gt;l1_ln2_2 -->
<g id="edge189" class="edge">
<title>l1_res2_2&#45;&gt;l1_ln2_2</title>
<path fill="none" stroke="black" d="M11078.41,-1675.29C11078.41,-1675.29 11078.41,-1641.12 11078.41,-1641.12"/>
<polygon fill="black" stroke="black" points="11081.91,-1641.12 11078.41,-1631.12 11074.91,-1641.12 11081.91,-1641.12"/>
</g>
<!-- l1_ln2_2&#45;&gt;comm_stage1_to_stage0 -->
<g id="edge267" class="edge">
<title>l1_ln2_2&#45;&gt;comm_stage1_to_stage0</title>
<path fill="none" stroke="black" d="M11226.34,-1594.83C11226.34,-1594.83 11226.34,-1569.41 11226.34,-1569.41"/>
<polygon fill="black" stroke="black" points="11229.84,-1569.41 11226.34,-1559.41 11222.84,-1569.41 11229.84,-1569.41"/>
</g>
<!-- l1_attn_3 -->
<g id="node143" class="node">
<title>l1_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="5727.5,-2135 5032.5,-2135 5032.5,-2099 5727.5,-2099 5727.5,-2135"/>
<text text-anchor="middle" x="5380" y="-2114.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l1_q_proj_3&#45;&gt;l1_attn_3 -->
<g id="edge193" class="edge">
<title>l1_q_proj_3&#45;&gt;l1_attn_3</title>
<path fill="none" stroke="black" d="M5558.5,-2170.83C5558.5,-2170.83 5558.5,-2145.41 5558.5,-2145.41"/>
<polygon fill="black" stroke="black" points="5562,-2145.41 5558.5,-2135.41 5555,-2145.41 5562,-2145.41"/>
</g>
<!-- l1_k_proj_3&#45;&gt;l1_attn_3 -->
<g id="edge194" class="edge">
<title>l1_k_proj_3&#45;&gt;l1_attn_3</title>
<path fill="none" stroke="black" d="M5202,-2170.83C5202,-2170.83 5202,-2145.41 5202,-2145.41"/>
<polygon fill="black" stroke="black" points="5205.5,-2145.41 5202,-2135.41 5198.5,-2145.41 5205.5,-2145.41"/>
</g>
<!-- l1_v_proj_3&#45;&gt;l1_attn_3 -->
<g id="edge195" class="edge">
<title>l1_v_proj_3&#45;&gt;l1_attn_3</title>
<path fill="none" stroke="black" d="M4416.25,-2170.97C4416.25,-2151.42 4416.25,-2123 4416.25,-2123 4416.25,-2123 5022.4,-2123 5022.4,-2123"/>
<polygon fill="black" stroke="black" points="5022.4,-2126.5 5032.4,-2123 5022.4,-2119.5 5022.4,-2126.5"/>
</g>
<!-- l1_out_proj_3 -->
<g id="node144" class="node">
<title>l1_out_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="7272.5,-2063 6627.5,-2063 6627.5,-2027 7272.5,-2027 7272.5,-2063"/>
<text text-anchor="middle" x="6950" y="-2042.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_attn_3&#45;&gt;l1_out_proj_3 -->
<g id="edge196" class="edge">
<title>l1_attn_3&#45;&gt;l1_out_proj_3</title>
<path fill="none" stroke="black" d="M5727.83,-2111C6099.6,-2111 6636.17,-2111 6636.17,-2111 6636.17,-2111 6636.17,-2073.03 6636.17,-2073.03"/>
<polygon fill="black" stroke="black" points="6639.67,-2073.03 6636.17,-2063.03 6632.67,-2073.03 6639.67,-2073.03"/>
</g>
<!-- l1_out_proj_3&#45;&gt;l1_res_3 -->
<g id="edge197" class="edge">
<title>l1_out_proj_3&#45;&gt;l1_res_3</title>
<path fill="none" stroke="black" d="M7140.67,-2026.85C7140.67,-2014.73 7140.67,-2001 7140.67,-2001 7140.67,-2001 9128.4,-2001 9128.4,-2001 9128.4,-2001 9128.4,-1984.2 9128.4,-1984.2"/>
<polygon fill="black" stroke="black" points="9131.9,-1984.2 9128.4,-1974.2 9124.9,-1984.2 9131.9,-1984.2"/>
</g>
<!-- l1_ln1_3 -->
<g id="node146" class="node">
<title>l1_ln1_3</title>
<polygon fill="lightgreen" stroke="black" points="9905,-1919 9307,-1919 9307,-1883 9905,-1883 9905,-1919"/>
<text text-anchor="middle" x="9606" y="-1898.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res_3&#45;&gt;l1_ln1_3 -->
<g id="edge199" class="edge">
<title>l1_res_3&#45;&gt;l1_ln1_3</title>
<path fill="none" stroke="black" d="M9606,-1954.83C9606,-1954.83 9606,-1929.41 9606,-1929.41"/>
<polygon fill="black" stroke="black" points="9609.5,-1929.41 9606,-1919.41 9602.5,-1929.41 9609.5,-1929.41"/>
</g>
<!-- l1_ffn_up_3 -->
<g id="node147" class="node">
<title>l1_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="9853.5,-1847 9224.5,-1847 9224.5,-1811 9853.5,-1811 9853.5,-1847"/>
<text text-anchor="middle" x="9539" y="-1826.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ln1_3&#45;&gt;l1_ffn_up_3 -->
<g id="edge200" class="edge">
<title>l1_ln1_3&#45;&gt;l1_ffn_up_3</title>
<path fill="none" stroke="black" d="M9580.25,-1882.83C9580.25,-1882.83 9580.25,-1857.41 9580.25,-1857.41"/>
<polygon fill="black" stroke="black" points="9583.75,-1857.41 9580.25,-1847.41 9576.75,-1857.41 9583.75,-1857.41"/>
</g>
<!-- l1_res2_3 -->
<g id="node149" class="node">
<title>l1_res2_3</title>
<polygon fill="lightgray" stroke="black" points="9778,-1703 9260.38,-1685 9778,-1667 10295.62,-1685 9778,-1703"/>
<text text-anchor="middle" x="9778" y="-1682.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln1_3&#45;&gt;l1_res2_3 -->
<g id="edge203" class="edge">
<title>l1_ln1_3&#45;&gt;l1_res2_3</title>
<path fill="none" stroke="black" d="M9881.25,-1882.96C9881.25,-1882.96 9881.25,-1709.64 9881.25,-1709.64"/>
<polygon fill="black" stroke="black" points="9884.75,-1709.64 9881.25,-1699.64 9877.75,-1709.64 9884.75,-1709.64"/>
</g>
<!-- l1_ffn_down_3 -->
<g id="node148" class="node">
<title>l1_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="9857.5,-1775 9216.5,-1775 9216.5,-1739 9857.5,-1739 9857.5,-1775"/>
<text text-anchor="middle" x="9537" y="-1754.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_3&#45;&gt;l1_ffn_down_3 -->
<g id="edge201" class="edge">
<title>l1_ffn_up_3&#45;&gt;l1_ffn_down_3</title>
<path fill="none" stroke="black" d="M9539,-1810.83C9539,-1810.83 9539,-1785.41 9539,-1785.41"/>
<polygon fill="black" stroke="black" points="9542.5,-1785.41 9539,-1775.41 9535.5,-1785.41 9542.5,-1785.41"/>
</g>
<!-- l1_ffn_down_3&#45;&gt;l1_res2_3 -->
<g id="edge202" class="edge">
<title>l1_ffn_down_3&#45;&gt;l1_res2_3</title>
<path fill="none" stroke="black" d="M9558.84,-1738.83C9558.84,-1738.83 9558.84,-1705.57 9558.84,-1705.57"/>
<polygon fill="black" stroke="black" points="9562.34,-1705.57 9558.84,-1695.57 9555.34,-1705.57 9562.34,-1705.57"/>
</g>
<!-- l1_ln2_3 -->
<g id="node150" class="node">
<title>l1_ln2_3</title>
<polygon fill="lightgreen" stroke="black" points="10571,-1631 9973,-1631 9973,-1595 10571,-1595 10571,-1631"/>
<text text-anchor="middle" x="10272" y="-1610.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res2_3&#45;&gt;l1_ln2_3 -->
<g id="edge204" class="edge">
<title>l1_res2_3&#45;&gt;l1_ln2_3</title>
<path fill="none" stroke="black" d="M10134.41,-1679.35C10134.41,-1679.35 10134.41,-1641.04 10134.41,-1641.04"/>
<polygon fill="black" stroke="black" points="10137.91,-1641.04 10134.41,-1631.04 10130.91,-1641.04 10137.91,-1641.04"/>
</g>
<!-- l1_ln2_3&#45;&gt;comm_stage1_to_stage0 -->
<g id="edge268" class="edge">
<title>l1_ln2_3&#45;&gt;comm_stage1_to_stage0</title>
<path fill="none" stroke="black" d="M10388,-1594.97C10388,-1578.6 10388,-1557 10388,-1557 10388,-1557 11200,-1557 11200,-1557"/>
<polygon fill="black" stroke="black" points="11200,-1560.5 11210,-1557 11200,-1553.5 11200,-1560.5"/>
</g>
<!-- l1_attn_4 -->
<g id="node154" class="node">
<title>l1_attn_4</title>
<polygon fill="lightgreen" stroke="black" points="9573.5,-2135 8878.5,-2135 8878.5,-2099 9573.5,-2099 9573.5,-2135"/>
<text text-anchor="middle" x="9226" y="-2114.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l1_q_proj_4&#45;&gt;l1_attn_4 -->
<g id="edge208" class="edge">
<title>l1_q_proj_4&#45;&gt;l1_attn_4</title>
<path fill="none" stroke="black" d="M9404.5,-2170.83C9404.5,-2170.83 9404.5,-2145.41 9404.5,-2145.41"/>
<polygon fill="black" stroke="black" points="9408,-2145.41 9404.5,-2135.41 9401,-2145.41 9408,-2145.41"/>
</g>
<!-- l1_k_proj_4&#45;&gt;l1_attn_4 -->
<g id="edge209" class="edge">
<title>l1_k_proj_4&#45;&gt;l1_attn_4</title>
<path fill="none" stroke="black" d="M9048,-2170.83C9048,-2170.83 9048,-2145.41 9048,-2145.41"/>
<polygon fill="black" stroke="black" points="9051.5,-2145.41 9048,-2135.41 9044.5,-2145.41 9051.5,-2145.41"/>
</g>
<!-- l1_v_proj_4&#45;&gt;l1_attn_4 -->
<g id="edge210" class="edge">
<title>l1_v_proj_4&#45;&gt;l1_attn_4</title>
<path fill="none" stroke="black" d="M8567.83,-2170.97C8567.83,-2151.42 8567.83,-2123 8567.83,-2123 8567.83,-2123 8868.13,-2123 8868.13,-2123"/>
<polygon fill="black" stroke="black" points="8868.13,-2126.5 8878.13,-2123 8868.13,-2119.5 8868.13,-2126.5"/>
</g>
<!-- l1_out_proj_4 -->
<g id="node155" class="node">
<title>l1_out_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="10488.5,-2063 9843.5,-2063 9843.5,-2027 10488.5,-2027 10488.5,-2063"/>
<text text-anchor="middle" x="10166" y="-2042.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_attn_4&#45;&gt;l1_out_proj_4 -->
<g id="edge211" class="edge">
<title>l1_attn_4&#45;&gt;l1_out_proj_4</title>
<path fill="none" stroke="black" d="M9573.68,-2111C9717.37,-2111 9851,-2111 9851,-2111 9851,-2111 9851,-2073.03 9851,-2073.03"/>
<polygon fill="black" stroke="black" points="9854.5,-2073.03 9851,-2063.03 9847.5,-2073.03 9854.5,-2073.03"/>
</g>
<!-- l1_out_proj_4&#45;&gt;l1_res_4 -->
<g id="edge212" class="edge">
<title>l1_out_proj_4&#45;&gt;l1_res_4</title>
<path fill="none" stroke="black" d="M10488.78,-2039C10848.69,-2039 11380.9,-2039 11380.9,-2039 11380.9,-2039 11380.9,-1984.9 11380.9,-1984.9"/>
<polygon fill="black" stroke="black" points="11384.4,-1984.9 11380.9,-1974.9 11377.4,-1984.9 11384.4,-1984.9"/>
</g>
<!-- l1_ln1_4 -->
<g id="node157" class="node">
<title>l1_ln1_4</title>
<polygon fill="lightgreen" stroke="black" points="12140,-1919 11542,-1919 11542,-1883 12140,-1883 12140,-1919"/>
<text text-anchor="middle" x="11841" y="-1898.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res_4&#45;&gt;l1_ln1_4 -->
<g id="edge214" class="edge">
<title>l1_res_4&#45;&gt;l1_ln1_4</title>
<path fill="none" stroke="black" d="M11841,-1954.83C11841,-1954.83 11841,-1929.41 11841,-1929.41"/>
<polygon fill="black" stroke="black" points="11844.5,-1929.41 11841,-1919.41 11837.5,-1929.41 11844.5,-1929.41"/>
</g>
<!-- l1_ffn_up_4 -->
<g id="node158" class="node">
<title>l1_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="12010.5,-1847 11381.5,-1847 11381.5,-1811 12010.5,-1811 12010.5,-1847"/>
<text text-anchor="middle" x="11696" y="-1826.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ln1_4&#45;&gt;l1_ffn_up_4 -->
<g id="edge215" class="edge">
<title>l1_ln1_4&#45;&gt;l1_ffn_up_4</title>
<path fill="none" stroke="black" d="M11776.25,-1882.83C11776.25,-1882.83 11776.25,-1857.41 11776.25,-1857.41"/>
<polygon fill="black" stroke="black" points="11779.75,-1857.41 11776.25,-1847.41 11772.75,-1857.41 11779.75,-1857.41"/>
</g>
<!-- l1_res2_4 -->
<g id="node160" class="node">
<title>l1_res2_4</title>
<polygon fill="lightgray" stroke="black" points="11886,-1703 11368.38,-1685 11886,-1667 12403.62,-1685 11886,-1703"/>
<text text-anchor="middle" x="11886" y="-1682.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln1_4&#45;&gt;l1_res2_4 -->
<g id="edge218" class="edge">
<title>l1_ln1_4&#45;&gt;l1_res2_4</title>
<path fill="none" stroke="black" d="M12076.75,-1882.96C12076.75,-1882.96 12076.75,-1706.72 12076.75,-1706.72"/>
<polygon fill="black" stroke="black" points="12080.25,-1706.72 12076.75,-1696.72 12073.25,-1706.72 12080.25,-1706.72"/>
</g>
<!-- l1_ffn_down_4 -->
<g id="node159" class="node">
<title>l1_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="12013.5,-1775 11372.5,-1775 11372.5,-1739 12013.5,-1739 12013.5,-1775"/>
<text text-anchor="middle" x="11693" y="-1754.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_4&#45;&gt;l1_ffn_down_4 -->
<g id="edge216" class="edge">
<title>l1_ffn_up_4&#45;&gt;l1_ffn_down_4</title>
<path fill="none" stroke="black" d="M11696,-1810.83C11696,-1810.83 11696,-1785.41 11696,-1785.41"/>
<polygon fill="black" stroke="black" points="11699.5,-1785.41 11696,-1775.41 11692.5,-1785.41 11699.5,-1785.41"/>
</g>
<!-- l1_ffn_down_4&#45;&gt;l1_res2_4 -->
<g id="edge217" class="edge">
<title>l1_ffn_down_4&#45;&gt;l1_res2_4</title>
<path fill="none" stroke="black" d="M11693,-1738.83C11693,-1738.83 11693,-1706.41 11693,-1706.41"/>
<polygon fill="black" stroke="black" points="11696.5,-1706.41 11693,-1696.41 11689.5,-1706.41 11696.5,-1706.41"/>
</g>
<!-- l1_ln2_4 -->
<g id="node161" class="node">
<title>l1_ln2_4</title>
<polygon fill="lightgreen" stroke="black" points="12130,-1631 11532,-1631 11532,-1595 12130,-1595 12130,-1631"/>
<text text-anchor="middle" x="11831" y="-1610.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res2_4&#45;&gt;l1_ln2_4 -->
<g id="edge219" class="edge">
<title>l1_res2_4&#45;&gt;l1_ln2_4</title>
<path fill="none" stroke="black" d="M11831,-1668.66C11831,-1668.66 11831,-1641.04 11831,-1641.04"/>
<polygon fill="black" stroke="black" points="11834.5,-1641.04 11831,-1631.04 11827.5,-1641.04 11834.5,-1641.04"/>
</g>
<!-- l1_ln2_4&#45;&gt;comm_stage1_to_stage0 -->
<g id="edge269" class="edge">
<title>l1_ln2_4&#45;&gt;comm_stage1_to_stage0</title>
<path fill="none" stroke="black" d="M11710.16,-1594.83C11710.16,-1594.83 11710.16,-1569.41 11710.16,-1569.41"/>
<polygon fill="black" stroke="black" points="11713.66,-1569.41 11710.16,-1559.41 11706.66,-1569.41 11713.66,-1569.41"/>
</g>
<!-- l1_attn_5 -->
<g id="node165" class="node">
<title>l1_attn_5</title>
<polygon fill="lightgreen" stroke="black" points="1899.5,-2135 1204.5,-2135 1204.5,-2099 1899.5,-2099 1899.5,-2135"/>
<text text-anchor="middle" x="1552" y="-2114.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l1_q_proj_5&#45;&gt;l1_attn_5 -->
<g id="edge223" class="edge">
<title>l1_q_proj_5&#45;&gt;l1_attn_5</title>
<path fill="none" stroke="black" d="M590,-2170.83C590,-2149.5 590,-2117 590,-2117 590,-2117 1194.36,-2117 1194.36,-2117"/>
<polygon fill="black" stroke="black" points="1194.36,-2120.5 1204.36,-2117 1194.36,-2113.5 1194.36,-2120.5"/>
</g>
<!-- l1_k_proj_5&#45;&gt;l1_attn_5 -->
<g id="edge224" class="edge">
<title>l1_k_proj_5&#45;&gt;l1_attn_5</title>
<path fill="none" stroke="black" d="M1730,-2170.83C1730,-2170.83 1730,-2145.41 1730,-2145.41"/>
<polygon fill="black" stroke="black" points="1733.5,-2145.41 1730,-2135.41 1726.5,-2145.41 1733.5,-2145.41"/>
</g>
<!-- l1_v_proj_5&#45;&gt;l1_attn_5 -->
<g id="edge225" class="edge">
<title>l1_v_proj_5&#45;&gt;l1_attn_5</title>
<path fill="none" stroke="black" d="M1373.5,-2170.83C1373.5,-2170.83 1373.5,-2145.41 1373.5,-2145.41"/>
<polygon fill="black" stroke="black" points="1377,-2145.41 1373.5,-2135.41 1370,-2145.41 1377,-2145.41"/>
</g>
<!-- l1_out_proj_5 -->
<g id="node166" class="node">
<title>l1_out_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="2651.5,-2063 2006.5,-2063 2006.5,-2027 2651.5,-2027 2651.5,-2063"/>
<text text-anchor="middle" x="2329" y="-2042.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_attn_5&#45;&gt;l1_out_proj_5 -->
<g id="edge226" class="edge">
<title>l1_attn_5&#45;&gt;l1_out_proj_5</title>
<path fill="none" stroke="black" d="M1899.73,-2111C2005.81,-2111 2095,-2111 2095,-2111 2095,-2111 2095,-2073.03 2095,-2073.03"/>
<polygon fill="black" stroke="black" points="2098.5,-2073.03 2095,-2063.03 2091.5,-2073.03 2098.5,-2073.03"/>
</g>
<!-- l1_out_proj_5&#45;&gt;l1_res_5 -->
<g id="edge227" class="edge">
<title>l1_out_proj_5&#45;&gt;l1_res_5</title>
<path fill="none" stroke="black" d="M2615.5,-2026.83C2615.5,-2005.5 2615.5,-1973 2615.5,-1973 2615.5,-1973 6998.72,-1973 6998.72,-1973"/>
<polygon fill="black" stroke="black" points="6998.72,-1976.5 7008.72,-1973 6998.72,-1969.5 6998.72,-1976.5"/>
</g>
<!-- l1_ln1_5 -->
<g id="node168" class="node">
<title>l1_ln1_5</title>
<polygon fill="lightgreen" stroke="black" points="7819,-1919 7221,-1919 7221,-1883 7819,-1883 7819,-1919"/>
<text text-anchor="middle" x="7520" y="-1898.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res_5&#45;&gt;l1_ln1_5 -->
<g id="edge229" class="edge">
<title>l1_res_5&#45;&gt;l1_ln1_5</title>
<path fill="none" stroke="black" d="M7520,-1954.83C7520,-1954.83 7520,-1929.41 7520,-1929.41"/>
<polygon fill="black" stroke="black" points="7523.5,-1929.41 7520,-1919.41 7516.5,-1929.41 7523.5,-1929.41"/>
</g>
<!-- l1_ffn_up_5 -->
<g id="node169" class="node">
<title>l1_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="7746.5,-1847 7117.5,-1847 7117.5,-1811 7746.5,-1811 7746.5,-1847"/>
<text text-anchor="middle" x="7432" y="-1826.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ln1_5&#45;&gt;l1_ffn_up_5 -->
<g id="edge230" class="edge">
<title>l1_ln1_5&#45;&gt;l1_ffn_up_5</title>
<path fill="none" stroke="black" d="M7483.75,-1882.83C7483.75,-1882.83 7483.75,-1857.41 7483.75,-1857.41"/>
<polygon fill="black" stroke="black" points="7487.25,-1857.41 7483.75,-1847.41 7480.25,-1857.41 7487.25,-1857.41"/>
</g>
<!-- l1_res2_5 -->
<g id="node171" class="node">
<title>l1_res2_5</title>
<polygon fill="lightgray" stroke="black" points="7680,-1703 7162.38,-1685 7680,-1667 8197.62,-1685 7680,-1703"/>
<text text-anchor="middle" x="7680" y="-1682.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln1_5&#45;&gt;l1_res2_5 -->
<g id="edge233" class="edge">
<title>l1_ln1_5&#45;&gt;l1_res2_5</title>
<path fill="none" stroke="black" d="M7784.75,-1882.96C7784.75,-1882.96 7784.75,-1709.37 7784.75,-1709.37"/>
<polygon fill="black" stroke="black" points="7788.25,-1709.37 7784.75,-1699.37 7781.25,-1709.37 7788.25,-1709.37"/>
</g>
<!-- l1_ffn_down_5 -->
<g id="node170" class="node">
<title>l1_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="7750.5,-1775 7109.5,-1775 7109.5,-1739 7750.5,-1739 7750.5,-1775"/>
<text text-anchor="middle" x="7430" y="-1754.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_5&#45;&gt;l1_ffn_down_5 -->
<g id="edge231" class="edge">
<title>l1_ffn_up_5&#45;&gt;l1_ffn_down_5</title>
<path fill="none" stroke="black" d="M7432,-1810.83C7432,-1810.83 7432,-1785.41 7432,-1785.41"/>
<polygon fill="black" stroke="black" points="7435.5,-1785.41 7432,-1775.41 7428.5,-1785.41 7435.5,-1785.41"/>
</g>
<!-- l1_ffn_down_5&#45;&gt;l1_res2_5 -->
<g id="edge232" class="edge">
<title>l1_ffn_down_5&#45;&gt;l1_res2_5</title>
<path fill="none" stroke="black" d="M7456.34,-1738.83C7456.34,-1738.83 7456.34,-1705.57 7456.34,-1705.57"/>
<polygon fill="black" stroke="black" points="7459.84,-1705.57 7456.34,-1695.57 7452.84,-1705.57 7459.84,-1705.57"/>
</g>
<!-- l1_ln2_5 -->
<g id="node172" class="node">
<title>l1_ln2_5</title>
<polygon fill="lightgreen" stroke="black" points="8034,-1631 7436,-1631 7436,-1595 8034,-1595 8034,-1631"/>
<text text-anchor="middle" x="7735" y="-1610.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res2_5&#45;&gt;l1_ln2_5 -->
<g id="edge234" class="edge">
<title>l1_res2_5&#45;&gt;l1_ln2_5</title>
<path fill="none" stroke="black" d="M7735,-1668.66C7735,-1668.66 7735,-1641.04 7735,-1641.04"/>
<polygon fill="black" stroke="black" points="7738.5,-1641.04 7735,-1631.04 7731.5,-1641.04 7738.5,-1641.04"/>
</g>
<!-- l1_ln2_5&#45;&gt;comm_stage1_to_stage0 -->
<g id="edge270" class="edge">
<title>l1_ln2_5&#45;&gt;comm_stage1_to_stage0</title>
<path fill="none" stroke="black" d="M7849.25,-1595C7849.25,-1577.32 7849.25,-1553 7849.25,-1553 7849.25,-1553 11180.8,-1553 11180.8,-1553"/>
<polygon fill="black" stroke="black" points="11180.8,-1556.5 11190.8,-1553 11180.8,-1549.5 11180.8,-1556.5"/>
</g>
<!-- l1_attn_6 -->
<g id="node176" class="node">
<title>l1_attn_6</title>
<polygon fill="lightgreen" stroke="black" points="15112.5,-2135 14417.5,-2135 14417.5,-2099 15112.5,-2099 15112.5,-2135"/>
<text text-anchor="middle" x="14765" y="-2114.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l1_q_proj_6&#45;&gt;l1_attn_6 -->
<g id="edge238" class="edge">
<title>l1_q_proj_6&#45;&gt;l1_attn_6</title>
<path fill="none" stroke="black" d="M15050,-2170.83C15050,-2170.83 15050,-2145.41 15050,-2145.41"/>
<polygon fill="black" stroke="black" points="15053.5,-2145.41 15050,-2135.41 15046.5,-2145.41 15053.5,-2145.41"/>
</g>
<!-- l1_k_proj_6&#45;&gt;l1_attn_6 -->
<g id="edge239" class="edge">
<title>l1_k_proj_6&#45;&gt;l1_attn_6</title>
<path fill="none" stroke="black" d="M14693.5,-2170.83C14693.5,-2170.83 14693.5,-2145.41 14693.5,-2145.41"/>
<polygon fill="black" stroke="black" points="14697,-2145.41 14693.5,-2135.41 14690,-2145.41 14697,-2145.41"/>
</g>
<!-- l1_v_proj_6&#45;&gt;l1_attn_6 -->
<g id="edge240" class="edge">
<title>l1_v_proj_6&#45;&gt;l1_attn_6</title>
<path fill="none" stroke="black" d="M14125,-2170.83C14125,-2149.5 14125,-2117 14125,-2117 14125,-2117 14407.37,-2117 14407.37,-2117"/>
<polygon fill="black" stroke="black" points="14407.37,-2120.5 14417.37,-2117 14407.37,-2113.5 14407.37,-2120.5"/>
</g>
<!-- l1_out_proj_6 -->
<g id="node177" class="node">
<title>l1_out_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="15301.5,-2063 14656.5,-2063 14656.5,-2027 15301.5,-2027 15301.5,-2063"/>
<text text-anchor="middle" x="14979" y="-2042.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_attn_6&#45;&gt;l1_out_proj_6 -->
<g id="edge241" class="edge">
<title>l1_attn_6&#45;&gt;l1_out_proj_6</title>
<path fill="none" stroke="black" d="M14884.5,-2098.83C14884.5,-2098.83 14884.5,-2073.41 14884.5,-2073.41"/>
<polygon fill="black" stroke="black" points="14888,-2073.41 14884.5,-2063.41 14881,-2073.41 14888,-2073.41"/>
</g>
<!-- l1_out_proj_6&#45;&gt;l1_res_6 -->
<g id="edge242" class="edge">
<title>l1_out_proj_6&#45;&gt;l1_res_6</title>
<path fill="none" stroke="black" d="M14979,-2026.83C14979,-2026.83 14979,-1999.44 14979,-1999.44"/>
<polygon fill="black" stroke="black" points="14982.5,-1999.44 14979,-1989.44 14975.5,-1999.44 14982.5,-1999.44"/>
</g>
<!-- l1_ln1_6 -->
<g id="node179" class="node">
<title>l1_ln1_6</title>
<polygon fill="lightgreen" stroke="black" points="15331,-1919 14733,-1919 14733,-1883 15331,-1883 15331,-1919"/>
<text text-anchor="middle" x="15032" y="-1898.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res_6&#45;&gt;l1_ln1_6 -->
<g id="edge244" class="edge">
<title>l1_res_6&#45;&gt;l1_ln1_6</title>
<path fill="none" stroke="black" d="M15032,-1954.83C15032,-1954.83 15032,-1929.41 15032,-1929.41"/>
<polygon fill="black" stroke="black" points="15035.5,-1929.41 15032,-1919.41 15028.5,-1929.41 15035.5,-1929.41"/>
</g>
<!-- l1_ffn_up_6 -->
<g id="node180" class="node">
<title>l1_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="15181.5,-1847 14552.5,-1847 14552.5,-1811 15181.5,-1811 15181.5,-1847"/>
<text text-anchor="middle" x="14867" y="-1826.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ln1_6&#45;&gt;l1_ffn_up_6 -->
<g id="edge245" class="edge">
<title>l1_ln1_6&#45;&gt;l1_ffn_up_6</title>
<path fill="none" stroke="black" d="M14957.25,-1882.83C14957.25,-1882.83 14957.25,-1857.41 14957.25,-1857.41"/>
<polygon fill="black" stroke="black" points="14960.75,-1857.41 14957.25,-1847.41 14953.75,-1857.41 14960.75,-1857.41"/>
</g>
<!-- l1_res2_6 -->
<g id="node182" class="node">
<title>l1_res2_6</title>
<polygon fill="lightgray" stroke="black" points="15038,-1703 14520.38,-1685 15038,-1667 15555.62,-1685 15038,-1703"/>
<text text-anchor="middle" x="15038" y="-1682.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln1_6&#45;&gt;l1_res2_6 -->
<g id="edge248" class="edge">
<title>l1_ln1_6&#45;&gt;l1_res2_6</title>
<path fill="none" stroke="black" d="M15257.75,-1882.96C15257.75,-1882.96 15257.75,-1705.73 15257.75,-1705.73"/>
<polygon fill="black" stroke="black" points="15261.25,-1705.73 15257.75,-1695.73 15254.25,-1705.73 15261.25,-1705.73"/>
</g>
<!-- l1_ffn_down_6 -->
<g id="node181" class="node">
<title>l1_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="15184.5,-1775 14543.5,-1775 14543.5,-1739 15184.5,-1739 15184.5,-1775"/>
<text text-anchor="middle" x="14864" y="-1754.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_6&#45;&gt;l1_ffn_down_6 -->
<g id="edge246" class="edge">
<title>l1_ffn_up_6&#45;&gt;l1_ffn_down_6</title>
<path fill="none" stroke="black" d="M14867,-1810.83C14867,-1810.83 14867,-1785.41 14867,-1785.41"/>
<polygon fill="black" stroke="black" points="14870.5,-1785.41 14867,-1775.41 14863.5,-1785.41 14870.5,-1785.41"/>
</g>
<!-- l1_ffn_down_6&#45;&gt;l1_res2_6 -->
<g id="edge247" class="edge">
<title>l1_ffn_down_6&#45;&gt;l1_res2_6</title>
<path fill="none" stroke="black" d="M14864,-1738.83C14864,-1738.83 14864,-1707.28 14864,-1707.28"/>
<polygon fill="black" stroke="black" points="14867.5,-1707.27 14864,-1697.28 14860.5,-1707.28 14867.5,-1707.27"/>
</g>
<!-- l1_ln2_6 -->
<g id="node183" class="node">
<title>l1_ln2_6</title>
<polygon fill="lightgreen" stroke="black" points="14899,-1631 14301,-1631 14301,-1595 14899,-1595 14899,-1631"/>
<text text-anchor="middle" x="14600" y="-1610.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res2_6&#45;&gt;l1_ln2_6 -->
<g id="edge249" class="edge">
<title>l1_res2_6&#45;&gt;l1_ln2_6</title>
<path fill="none" stroke="black" d="M14709.59,-1678.36C14709.59,-1678.36 14709.59,-1641.05 14709.59,-1641.05"/>
<polygon fill="black" stroke="black" points="14713.09,-1641.05 14709.59,-1631.05 14706.09,-1641.05 14713.09,-1641.05"/>
</g>
<!-- l1_ln2_6&#45;&gt;comm_stage1_to_stage0 -->
<g id="edge271" class="edge">
<title>l1_ln2_6&#45;&gt;comm_stage1_to_stage0</title>
<path fill="none" stroke="black" d="M14468.5,-1594.78C14468.5,-1576.17 14468.5,-1550 14468.5,-1550 14468.5,-1550 11855.36,-1550 11855.36,-1550"/>
<polygon fill="black" stroke="black" points="11855.36,-1546.5 11845.36,-1550 11855.36,-1553.5 11855.36,-1546.5"/>
</g>
<!-- l1_attn_7 -->
<g id="node187" class="node">
<title>l1_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="13402.5,-2135 12707.5,-2135 12707.5,-2099 13402.5,-2099 13402.5,-2135"/>
<text text-anchor="middle" x="13055" y="-2114.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l1_q_proj_7&#45;&gt;l1_attn_7 -->
<g id="edge253" class="edge">
<title>l1_q_proj_7&#45;&gt;l1_attn_7</title>
<path fill="none" stroke="black" d="M13233.5,-2170.83C13233.5,-2170.83 13233.5,-2145.41 13233.5,-2145.41"/>
<polygon fill="black" stroke="black" points="13237,-2145.41 13233.5,-2135.41 13230,-2145.41 13237,-2145.41"/>
</g>
<!-- l1_k_proj_7&#45;&gt;l1_attn_7 -->
<g id="edge254" class="edge">
<title>l1_k_proj_7&#45;&gt;l1_attn_7</title>
<path fill="none" stroke="black" d="M12877,-2170.83C12877,-2170.83 12877,-2145.41 12877,-2145.41"/>
<polygon fill="black" stroke="black" points="12880.5,-2145.41 12877,-2135.41 12873.5,-2145.41 12880.5,-2145.41"/>
</g>
<!-- l1_v_proj_7&#45;&gt;l1_attn_7 -->
<g id="edge255" class="edge">
<title>l1_v_proj_7&#45;&gt;l1_attn_7</title>
<path fill="none" stroke="black" d="M12198.75,-2170.83C12198.75,-2149.5 12198.75,-2117 12198.75,-2117 12198.75,-2117 12697.35,-2117 12697.35,-2117"/>
<polygon fill="black" stroke="black" points="12697.35,-2120.5 12707.35,-2117 12697.35,-2113.5 12697.35,-2120.5"/>
</g>
<!-- l1_out_proj_7 -->
<g id="node188" class="node">
<title>l1_out_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="13921.5,-2063 13276.5,-2063 13276.5,-2027 13921.5,-2027 13921.5,-2063"/>
<text text-anchor="middle" x="13599" y="-2042.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_attn_7&#45;&gt;l1_out_proj_7 -->
<g id="edge256" class="edge">
<title>l1_attn_7&#45;&gt;l1_out_proj_7</title>
<path fill="none" stroke="black" d="M13339.5,-2098.83C13339.5,-2098.83 13339.5,-2073.41 13339.5,-2073.41"/>
<polygon fill="black" stroke="black" points="13343,-2073.41 13339.5,-2063.41 13336,-2073.41 13343,-2073.41"/>
</g>
<!-- l1_out_proj_7&#45;&gt;l1_res_7 -->
<g id="edge257" class="edge">
<title>l1_out_proj_7&#45;&gt;l1_res_7</title>
<path fill="none" stroke="black" d="M13696.67,-2026.83C13696.67,-2026.83 13696.67,-1991.19 13696.67,-1991.19"/>
<polygon fill="black" stroke="black" points="13700.17,-1991.19 13696.67,-1981.19 13693.17,-1991.19 13700.17,-1991.19"/>
</g>
<!-- l1_ln1_7 -->
<g id="node190" class="node">
<title>l1_ln1_7</title>
<polygon fill="lightgreen" stroke="black" points="14282,-1919 13684,-1919 13684,-1883 14282,-1883 14282,-1919"/>
<text text-anchor="middle" x="13983" y="-1898.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res_7&#45;&gt;l1_ln1_7 -->
<g id="edge259" class="edge">
<title>l1_res_7&#45;&gt;l1_ln1_7</title>
<path fill="none" stroke="black" d="M13983,-1954.83C13983,-1954.83 13983,-1929.41 13983,-1929.41"/>
<polygon fill="black" stroke="black" points="13986.5,-1929.41 13983,-1919.41 13979.5,-1929.41 13986.5,-1929.41"/>
</g>
<!-- l1_ffn_up_7 -->
<g id="node191" class="node">
<title>l1_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="13967.5,-1847 13338.5,-1847 13338.5,-1811 13967.5,-1811 13967.5,-1847"/>
<text text-anchor="middle" x="13653" y="-1826.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l1_ln1_7&#45;&gt;l1_ffn_up_7 -->
<g id="edge260" class="edge">
<title>l1_ln1_7&#45;&gt;l1_ffn_up_7</title>
<path fill="none" stroke="black" d="M13825.75,-1882.83C13825.75,-1882.83 13825.75,-1857.41 13825.75,-1857.41"/>
<polygon fill="black" stroke="black" points="13829.25,-1857.41 13825.75,-1847.41 13822.25,-1857.41 13829.25,-1857.41"/>
</g>
<!-- l1_res2_7 -->
<g id="node193" class="node">
<title>l1_res2_7</title>
<polygon fill="lightgray" stroke="black" points="13984,-1703 13466.38,-1685 13984,-1667 14501.62,-1685 13984,-1703"/>
<text text-anchor="middle" x="13984" y="-1682.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ln1_7&#45;&gt;l1_res2_7 -->
<g id="edge263" class="edge">
<title>l1_ln1_7&#45;&gt;l1_res2_7</title>
<path fill="none" stroke="black" d="M14126.25,-1882.96C14126.25,-1882.96 14126.25,-1708.28 14126.25,-1708.28"/>
<polygon fill="black" stroke="black" points="14129.75,-1708.28 14126.25,-1698.28 14122.75,-1708.28 14129.75,-1708.28"/>
</g>
<!-- l1_ffn_down_7 -->
<g id="node192" class="node">
<title>l1_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="13970.5,-1775 13329.5,-1775 13329.5,-1739 13970.5,-1739 13970.5,-1775"/>
<text text-anchor="middle" x="13650" y="-1754.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_ffn_up_7&#45;&gt;l1_ffn_down_7 -->
<g id="edge261" class="edge">
<title>l1_ffn_up_7&#45;&gt;l1_ffn_down_7</title>
<path fill="none" stroke="black" d="M13653,-1810.83C13653,-1810.83 13653,-1785.41 13653,-1785.41"/>
<polygon fill="black" stroke="black" points="13656.5,-1785.41 13653,-1775.41 13649.5,-1785.41 13656.5,-1785.41"/>
</g>
<!-- l1_ffn_down_7&#45;&gt;l1_res2_7 -->
<g id="edge262" class="edge">
<title>l1_ffn_down_7&#45;&gt;l1_res2_7</title>
<path fill="none" stroke="black" d="M13718.34,-1738.83C13718.34,-1738.83 13718.34,-1703.96 13718.34,-1703.96"/>
<polygon fill="black" stroke="black" points="13721.84,-1703.96 13718.34,-1693.96 13714.84,-1703.96 13721.84,-1703.96"/>
</g>
<!-- l1_ln2_7 -->
<g id="node194" class="node">
<title>l1_ln2_7</title>
<polygon fill="lightgreen" stroke="black" points="13901,-1631 13303,-1631 13303,-1595 13901,-1595 13901,-1631"/>
<text text-anchor="middle" x="13602" y="-1610.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l1_res2_7&#45;&gt;l1_ln2_7 -->
<g id="edge264" class="edge">
<title>l1_res2_7&#45;&gt;l1_ln2_7</title>
<path fill="none" stroke="black" d="M13683.59,-1677.29C13683.59,-1677.29 13683.59,-1641.05 13683.59,-1641.05"/>
<polygon fill="black" stroke="black" points="13687.09,-1641.05 13683.59,-1631.05 13680.09,-1641.05 13687.09,-1641.05"/>
</g>
<!-- l1_ln2_7&#45;&gt;comm_stage1_to_stage0 -->
<g id="edge272" class="edge">
<title>l1_ln2_7&#45;&gt;comm_stage1_to_stage0</title>
<path fill="none" stroke="black" d="M13333.75,-1595C13333.75,-1577.32 13333.75,-1553 13333.75,-1553 13333.75,-1553 11869.69,-1553 11869.69,-1553"/>
<polygon fill="black" stroke="black" points="11869.69,-1549.5 11859.69,-1553 11869.69,-1556.5 11869.69,-1549.5"/>
</g>
<!-- l2_q_proj_0 -->
<g id="node196" class="node">
<title>l2_q_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="11459,-1486 10841,-1486 10841,-1450 11459,-1450 11459,-1486"/>
<text text-anchor="middle" x="11150" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_q_proj_0 -->
<g id="edge273" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_q_proj_0</title>
<path fill="none" stroke="black" d="M11321.89,-1522.96C11321.89,-1522.96 11321.89,-1496.09 11321.89,-1496.09"/>
<polygon fill="black" stroke="black" points="11325.39,-1496.09 11321.89,-1486.09 11318.39,-1496.09 11325.39,-1496.09"/>
</g>
<!-- l2_k_proj_0 -->
<g id="node197" class="node">
<title>l2_k_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="12729.5,-1486 12112.5,-1486 12112.5,-1450 12729.5,-1450 12729.5,-1486"/>
<text text-anchor="middle" x="12421" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_k_proj_0 -->
<g id="edge274" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_k_proj_0</title>
<path fill="none" stroke="black" d="M11726.18,-1525C11908.78,-1525 12121.25,-1525 12121.25,-1525 12121.25,-1525 12121.25,-1496.04 12121.25,-1496.04"/>
<polygon fill="black" stroke="black" points="12124.75,-1496.04 12121.25,-1486.04 12117.75,-1496.04 12124.75,-1496.04"/>
</g>
<!-- l2_v_proj_0 -->
<g id="node198" class="node">
<title>l2_v_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="12094.5,-1486 11477.5,-1486 11477.5,-1450 12094.5,-1450 12094.5,-1486"/>
<text text-anchor="middle" x="11786" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_v_proj_0 -->
<g id="edge275" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_v_proj_0</title>
<path fill="none" stroke="black" d="M11682.91,-1522.96C11682.91,-1522.96 11682.91,-1496.09 11682.91,-1496.09"/>
<polygon fill="black" stroke="black" points="11686.41,-1496.09 11682.91,-1486.09 11679.41,-1496.09 11686.41,-1496.09"/>
</g>
<!-- l2_res_0 -->
<g id="node201" class="node">
<title>l2_res_0</title>
<polygon fill="lightgray" stroke="black" points="13881,-1270 13374.69,-1252 13881,-1234 14387.31,-1252 13881,-1270"/>
<text text-anchor="middle" x="13881" y="-1249.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_res_0 -->
<g id="edge281" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_res_0</title>
<path fill="none" stroke="black" d="M11754.5,-1531C12287.96,-1531 13379.95,-1531 13379.95,-1531 13379.95,-1531 13379.95,-1262.2 13379.95,-1262.2"/>
<polygon fill="black" stroke="black" points="13383.45,-1262.2 13379.95,-1252.2 13376.45,-1262.2 13383.45,-1262.2"/>
</g>
<!-- l2_q_proj_1 -->
<g id="node207" class="node">
<title>l2_q_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="5103,-1486 4485,-1486 4485,-1450 5103,-1450 5103,-1486"/>
<text text-anchor="middle" x="4794" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_q_proj_1 -->
<g id="edge288" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_q_proj_1</title>
<path fill="none" stroke="black" d="M11152.79,-1545C9864.58,-1545 5067.75,-1545 5067.75,-1545 5067.75,-1545 5067.75,-1496.25 5067.75,-1496.25"/>
<polygon fill="black" stroke="black" points="5071.25,-1496.25 5067.75,-1486.25 5064.25,-1496.25 5071.25,-1496.25"/>
</g>
<!-- l2_k_proj_1 -->
<g id="node208" class="node">
<title>l2_k_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="4466.5,-1486 3849.5,-1486 3849.5,-1450 4466.5,-1450 4466.5,-1486"/>
<text text-anchor="middle" x="4158" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_k_proj_1 -->
<g id="edge289" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_k_proj_1</title>
<path fill="none" stroke="black" d="M11162.41,-1547C9791.54,-1547 4275.75,-1547 4275.75,-1547 4275.75,-1547 4275.75,-1496.32 4275.75,-1496.32"/>
<polygon fill="black" stroke="black" points="4279.25,-1496.32 4275.75,-1486.32 4272.25,-1496.32 4279.25,-1496.32"/>
</g>
<!-- l2_v_proj_1 -->
<g id="node209" class="node">
<title>l2_v_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="3831.5,-1486 3214.5,-1486 3214.5,-1450 3831.5,-1450 3831.5,-1486"/>
<text text-anchor="middle" x="3523" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_v_proj_1 -->
<g id="edge290" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_v_proj_1</title>
<path fill="none" stroke="black" d="M11167,-1548C9750.84,-1548 3819.75,-1548 3819.75,-1548 3819.75,-1548 3819.75,-1496.15 3819.75,-1496.15"/>
<polygon fill="black" stroke="black" points="3823.25,-1496.15 3819.75,-1486.15 3816.25,-1496.15 3823.25,-1496.15"/>
</g>
<!-- l2_res_1 -->
<g id="node212" class="node">
<title>l2_res_1</title>
<polygon fill="lightgray" stroke="black" points="9474,-1270 8967.69,-1252 9474,-1234 9980.31,-1252 9474,-1270"/>
<text text-anchor="middle" x="9474" y="-1249.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_res_1 -->
<g id="edge296" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_res_1</title>
<path fill="none" stroke="black" d="M11076.23,-1529C10518,-1529 9560.5,-1529 9560.5,-1529 9560.5,-1529 9560.5,-1277.29 9560.5,-1277.29"/>
<polygon fill="black" stroke="black" points="9564,-1277.29 9560.5,-1267.29 9557,-1277.29 9564,-1277.29"/>
</g>
<!-- l2_q_proj_2 -->
<g id="node218" class="node">
<title>l2_q_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="7646,-1486 7028,-1486 7028,-1450 7646,-1450 7646,-1486"/>
<text text-anchor="middle" x="7337" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_q_proj_2 -->
<g id="edge303" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_q_proj_2</title>
<path fill="none" stroke="black" d="M11119.07,-1538C10157.64,-1538 7541,-1538 7541,-1538 7541,-1538 7541,-1496.03 7541,-1496.03"/>
<polygon fill="black" stroke="black" points="7544.5,-1496.03 7541,-1486.03 7537.5,-1496.03 7544.5,-1496.03"/>
</g>
<!-- l2_k_proj_2 -->
<g id="node219" class="node">
<title>l2_k_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="8916.5,-1486 8299.5,-1486 8299.5,-1450 8916.5,-1450 8916.5,-1486"/>
<text text-anchor="middle" x="8608" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_k_proj_2 -->
<g id="edge304" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_k_proj_2</title>
<path fill="none" stroke="black" d="M11105.05,-1535C10335.11,-1535 8608,-1535 8608,-1535 8608,-1535 8608,-1496.31 8608,-1496.31"/>
<polygon fill="black" stroke="black" points="8611.5,-1496.31 8608,-1486.31 8604.5,-1496.31 8611.5,-1496.31"/>
</g>
<!-- l2_v_proj_2 -->
<g id="node220" class="node">
<title>l2_v_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="8281.5,-1486 7664.5,-1486 7664.5,-1450 8281.5,-1450 8281.5,-1486"/>
<text text-anchor="middle" x="7973" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_v_proj_2 -->
<g id="edge305" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_v_proj_2</title>
<path fill="none" stroke="black" d="M11109.6,-1536C10270.4,-1536 8248.43,-1536 8248.43,-1536 8248.43,-1536 8248.43,-1496.22 8248.43,-1496.22"/>
<polygon fill="black" stroke="black" points="8251.93,-1496.22 8248.43,-1486.22 8244.93,-1496.22 8251.93,-1496.22"/>
</g>
<!-- l2_res_2 -->
<g id="node223" class="node">
<title>l2_res_2</title>
<polygon fill="lightgray" stroke="black" points="11770,-1270 11263.69,-1252 11770,-1234 12276.31,-1252 11770,-1270"/>
<text text-anchor="middle" x="11770" y="-1249.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_res_2 -->
<g id="edge311" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_res_2</title>
<path fill="none" stroke="black" d="M11463.62,-1522.92C11463.62,-1522.92 11463.62,-1269.24 11463.62,-1269.24"/>
<polygon fill="black" stroke="black" points="11467.13,-1269.24 11463.62,-1259.24 11460.13,-1269.24 11467.13,-1269.24"/>
</g>
<!-- l2_q_proj_3 -->
<g id="node229" class="node">
<title>l2_q_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="7010,-1486 6392,-1486 6392,-1450 7010,-1450 7010,-1486"/>
<text text-anchor="middle" x="6701" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_q_proj_3 -->
<g id="edge318" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_q_proj_3</title>
<path fill="none" stroke="black" d="M11128.91,-1540C10057.95,-1540 6818.17,-1540 6818.17,-1540 6818.17,-1540 6818.17,-1496.17 6818.17,-1496.17"/>
<polygon fill="black" stroke="black" points="6821.67,-1496.17 6818.17,-1486.17 6814.67,-1496.17 6821.67,-1496.17"/>
</g>
<!-- l2_k_proj_3 -->
<g id="node230" class="node">
<title>l2_k_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="6373.5,-1486 5756.5,-1486 5756.5,-1450 6373.5,-1450 6373.5,-1486"/>
<text text-anchor="middle" x="6065" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_k_proj_3 -->
<g id="edge319" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_k_proj_3</title>
<path fill="none" stroke="black" d="M11133.59,-1541C9974.84,-1541 6202,-1541 6202,-1541 6202,-1541 6202,-1496.04 6202,-1496.04"/>
<polygon fill="black" stroke="black" points="6205.5,-1496.04 6202,-1486.04 6198.5,-1496.04 6205.5,-1496.04"/>
</g>
<!-- l2_v_proj_3 -->
<g id="node231" class="node">
<title>l2_v_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="5738.5,-1486 5121.5,-1486 5121.5,-1450 5738.5,-1450 5738.5,-1486"/>
<text text-anchor="middle" x="5430" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_v_proj_3 -->
<g id="edge320" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_v_proj_3</title>
<path fill="none" stroke="black" d="M11143.23,-1543C9930.03,-1543 5733,-1543 5733,-1543 5733,-1543 5733,-1496.16 5733,-1496.16"/>
<polygon fill="black" stroke="black" points="5736.5,-1496.16 5733,-1486.16 5729.5,-1496.16 5736.5,-1496.16"/>
</g>
<!-- l2_res_3 -->
<g id="node234" class="node">
<title>l2_res_3</title>
<polygon fill="lightgray" stroke="black" points="10646,-1270 10139.69,-1252 10646,-1234 11152.31,-1252 10646,-1270"/>
<text text-anchor="middle" x="10646" y="-1249.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_res_3 -->
<g id="edge326" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_res_3</title>
<path fill="none" stroke="black" d="M11052.21,-1524C10931.73,-1524 10832,-1524 10832,-1524 10832,-1524 10832,-1273.69 10832,-1273.69"/>
<polygon fill="black" stroke="black" points="10835.5,-1273.69 10832,-1263.69 10828.5,-1273.69 10835.5,-1273.69"/>
</g>
<!-- l2_q_proj_4 -->
<g id="node240" class="node">
<title>l2_q_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="10823,-1486 10205,-1486 10205,-1450 10823,-1450 10823,-1486"/>
<text text-anchor="middle" x="10514" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_q_proj_4 -->
<g id="edge333" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_q_proj_4</title>
<path fill="none" stroke="black" d="M11061.87,-1526C10929.08,-1526 10815,-1526 10815,-1526 10815,-1526 10815,-1496.03 10815,-1496.03"/>
<polygon fill="black" stroke="black" points="10818.5,-1496.03 10815,-1486.03 10811.5,-1496.03 10818.5,-1496.03"/>
</g>
<!-- l2_k_proj_4 -->
<g id="node241" class="node">
<title>l2_k_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="10186.5,-1486 9569.5,-1486 9569.5,-1450 10186.5,-1450 10186.5,-1486"/>
<text text-anchor="middle" x="9878" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_k_proj_4 -->
<g id="edge334" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_k_proj_4</title>
<path fill="none" stroke="black" d="M11071.58,-1528C10661.27,-1528 10079.75,-1528 10079.75,-1528 10079.75,-1528 10079.75,-1496 10079.75,-1496"/>
<polygon fill="black" stroke="black" points="10083.25,-1496 10079.75,-1486 10076.25,-1496 10083.25,-1496"/>
</g>
<!-- l2_v_proj_4 -->
<g id="node242" class="node">
<title>l2_v_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="9551.5,-1486 8934.5,-1486 8934.5,-1450 9551.5,-1450 9551.5,-1486"/>
<text text-anchor="middle" x="9243" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_v_proj_4 -->
<g id="edge335" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_v_proj_4</title>
<path fill="none" stroke="black" d="M11085.81,-1531C10522.43,-1531 9535,-1531 9535,-1531 9535,-1531 9535,-1496.22 9535,-1496.22"/>
<polygon fill="black" stroke="black" points="9538.5,-1496.22 9535,-1486.22 9531.5,-1496.22 9538.5,-1496.22"/>
</g>
<!-- l2_res_4 -->
<g id="node245" class="node">
<title>l2_res_4</title>
<polygon fill="lightgray" stroke="black" points="12847,-1270 12340.69,-1252 12847,-1234 13353.31,-1252 12847,-1270"/>
<text text-anchor="middle" x="12847" y="-1249.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_res_4 -->
<g id="edge341" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_res_4</title>
<path fill="none" stroke="black" d="M11468.25,-1522.73C11468.25,-1475.68 11468.25,-1354 11468.25,-1354 11468.25,-1354 12392.28,-1354 12392.28,-1354 12392.28,-1354 12392.28,-1264.13 12392.28,-1264.13"/>
<polygon fill="black" stroke="black" points="12395.78,-1264.13 12392.28,-1254.13 12388.78,-1264.13 12395.78,-1264.13"/>
</g>
<!-- l2_q_proj_5 -->
<g id="node251" class="node">
<title>l2_q_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="1926,-1486 1308,-1486 1308,-1450 1926,-1450 1926,-1486"/>
<text text-anchor="middle" x="1617" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_q_proj_5 -->
<g id="edge348" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_q_proj_5</title>
<path fill="none" stroke="black" d="M11184.78,-1522.93C11184.78,-1513.54 11184.78,-1504 11184.78,-1504 11184.78,-1504 1912.75,-1504 1912.75,-1504 1912.75,-1504 1912.75,-1496.42 1912.75,-1496.42"/>
<polygon fill="black" stroke="black" points="1916.25,-1496.42 1912.75,-1486.42 1909.25,-1496.42 1916.25,-1496.42"/>
</g>
<!-- l2_k_proj_5 -->
<g id="node252" class="node">
<title>l2_k_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="3196.5,-1486 2579.5,-1486 2579.5,-1450 3196.5,-1450 3196.5,-1486"/>
<text text-anchor="middle" x="2888" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_k_proj_5 -->
<g id="edge349" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_k_proj_5</title>
<path fill="none" stroke="black" d="M11176.79,-1550C9705.25,-1550 3157.25,-1550 3157.25,-1550 3157.25,-1550 3157.25,-1496.2 3157.25,-1496.2"/>
<polygon fill="black" stroke="black" points="3160.75,-1496.2 3157.25,-1486.2 3153.75,-1496.2 3160.75,-1496.2"/>
</g>
<!-- l2_v_proj_5 -->
<g id="node253" class="node">
<title>l2_v_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="2561.5,-1486 1944.5,-1486 1944.5,-1450 2561.5,-1450 2561.5,-1486"/>
<text text-anchor="middle" x="2253" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_v_proj_5 -->
<g id="edge350" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_v_proj_5</title>
<path fill="none" stroke="black" d="M11186.24,-1552C9642.94,-1552 2284,-1552 2284,-1552 2284,-1552 2284,-1496.23 2284,-1496.23"/>
<polygon fill="black" stroke="black" points="2287.5,-1496.23 2284,-1486.23 2280.5,-1496.23 2287.5,-1496.23"/>
</g>
<!-- l2_res_5 -->
<g id="node256" class="node">
<title>l2_res_5</title>
<polygon fill="lightgray" stroke="black" points="8436,-1270 7929.69,-1252 8436,-1234 8942.31,-1252 8436,-1270"/>
<text text-anchor="middle" x="8436" y="-1249.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_res_5 -->
<g id="edge356" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_res_5</title>
<path fill="none" stroke="black" d="M11095.55,-1533C10390.34,-1533 8930,-1533 8930,-1533 8930,-1533 8930,-1262.46 8930,-1262.46"/>
<polygon fill="black" stroke="black" points="8933.5,-1262.46 8930,-1252.46 8926.5,-1262.46 8933.5,-1262.46"/>
</g>
<!-- l2_q_proj_6 -->
<g id="node262" class="node">
<title>l2_q_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="16543,-1486 15925,-1486 15925,-1450 16543,-1450 16543,-1486"/>
<text text-anchor="middle" x="16234" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_q_proj_6 -->
<g id="edge363" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_q_proj_6</title>
<path fill="none" stroke="black" d="M11831.26,-1547C12901,-1547 15965.1,-1547 15965.1,-1547 15965.1,-1547 15965.1,-1496.32 15965.1,-1496.32"/>
<polygon fill="black" stroke="black" points="15968.6,-1496.32 15965.1,-1486.32 15961.6,-1496.32 15968.6,-1496.32"/>
</g>
<!-- l2_k_proj_6 -->
<g id="node263" class="node">
<title>l2_k_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="15906.5,-1486 15289.5,-1486 15289.5,-1450 15906.5,-1450 15906.5,-1486"/>
<text text-anchor="middle" x="15598" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_k_proj_6 -->
<g id="edge364" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_k_proj_6</title>
<path fill="none" stroke="black" d="M11821.56,-1545C12791.53,-1545 15422.66,-1545 15422.66,-1545 15422.66,-1545 15422.66,-1496.25 15422.66,-1496.25"/>
<polygon fill="black" stroke="black" points="15426.16,-1496.25 15422.66,-1486.25 15419.16,-1496.25 15426.16,-1496.25"/>
</g>
<!-- l2_v_proj_6 -->
<g id="node264" class="node">
<title>l2_v_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="15271.5,-1486 14654.5,-1486 14654.5,-1450 15271.5,-1450 15271.5,-1486"/>
<text text-anchor="middle" x="14963" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_v_proj_6 -->
<g id="edge365" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_v_proj_6</title>
<path fill="none" stroke="black" d="M11792.79,-1539C12626.45,-1539 14776.75,-1539 14776.75,-1539 14776.75,-1539 14776.75,-1496.28 14776.75,-1496.28"/>
<polygon fill="black" stroke="black" points="14780.25,-1496.28 14776.75,-1486.28 14773.25,-1496.28 14780.25,-1496.28"/>
</g>
<!-- l2_res_6 -->
<g id="node267" class="node">
<title>l2_res_6</title>
<polygon fill="lightgray" stroke="black" points="15974,-1270 15467.69,-1252 15974,-1234 16480.31,-1252 15974,-1270"/>
<text text-anchor="middle" x="15974" y="-1249.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_res_6 -->
<g id="edge371" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_res_6</title>
<path fill="none" stroke="black" d="M11472.88,-1522.93C11472.88,-1478.22 11472.88,-1366 11472.88,-1366 11472.88,-1366 15505.42,-1366 15505.42,-1366 15505.42,-1366 15505.42,-1263.61 15505.42,-1263.61"/>
<polygon fill="black" stroke="black" points="15508.92,-1263.61 15505.42,-1253.61 15501.92,-1263.61 15508.92,-1263.61"/>
</g>
<!-- l2_q_proj_7 -->
<g id="node273" class="node">
<title>l2_q_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="14636,-1486 14018,-1486 14018,-1450 14636,-1450 14636,-1486"/>
<text text-anchor="middle" x="14327" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_q_proj_7 -->
<g id="edge378" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_q_proj_7</title>
<path fill="none" stroke="black" d="M11778.39,-1536C12486.31,-1536 14159.5,-1536 14159.5,-1536 14159.5,-1536 14159.5,-1496.22 14159.5,-1496.22"/>
<polygon fill="black" stroke="black" points="14163,-1496.22 14159.5,-1486.22 14156,-1496.22 14163,-1496.22"/>
</g>
<!-- l2_k_proj_7 -->
<g id="node274" class="node">
<title>l2_k_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="13999.5,-1486 13382.5,-1486 13382.5,-1450 13999.5,-1450 13999.5,-1486"/>
<text text-anchor="middle" x="13691" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_k_proj_7 -->
<g id="edge379" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_k_proj_7</title>
<path fill="none" stroke="black" d="M11768.82,-1534C12365.51,-1534 13641.75,-1534 13641.75,-1534 13641.75,-1534 13641.75,-1496.03 13641.75,-1496.03"/>
<polygon fill="black" stroke="black" points="13645.25,-1496.03 13641.75,-1486.03 13638.25,-1496.03 13645.25,-1496.03"/>
</g>
<!-- l2_v_proj_7 -->
<g id="node275" class="node">
<title>l2_v_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="13364.5,-1486 12747.5,-1486 12747.5,-1450 13364.5,-1450 13364.5,-1486"/>
<text text-anchor="middle" x="13056" y="-1465.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_v_proj_7 -->
<g id="edge380" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_v_proj_7</title>
<path fill="none" stroke="black" d="M11740.39,-1528C12143.81,-1528 12853,-1528 12853,-1528 12853,-1528 12853,-1496 12853,-1496"/>
<polygon fill="black" stroke="black" points="12856.5,-1496 12853,-1486 12849.5,-1496 12856.5,-1496"/>
</g>
<!-- l2_res_7 -->
<g id="node278" class="node">
<title>l2_res_7</title>
<polygon fill="lightgray" stroke="black" points="14926,-1270 14419.69,-1252 14926,-1234 15432.31,-1252 14926,-1270"/>
<text text-anchor="middle" x="14926" y="-1249.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage1_to_stage0&#45;&gt;l2_res_7 -->
<g id="edge386" class="edge">
<title>comm_stage1_to_stage0&#45;&gt;l2_res_7</title>
<path fill="none" stroke="black" d="M11807.17,-1542C12740.92,-1542 15280.5,-1542 15280.5,-1542 15280.5,-1542 15280.5,-1267.53 15280.5,-1267.53"/>
<polygon fill="black" stroke="black" points="15284,-1267.53 15280.5,-1257.53 15277,-1267.53 15284,-1267.53"/>
</g>
<!-- l2_attn_0 -->
<g id="node199" class="node">
<title>l2_attn_0</title>
<polygon fill="lightgreen" stroke="black" points="12448,-1414 11758,-1414 11758,-1378 12448,-1378 12448,-1414"/>
<text text-anchor="middle" x="12103" y="-1393.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l2_q_proj_0&#45;&gt;l2_attn_0 -->
<g id="edge276" class="edge">
<title>l2_q_proj_0&#45;&gt;l2_attn_0</title>
<path fill="none" stroke="black" d="M11393.95,-1449.83C11393.95,-1428.5 11393.95,-1396 11393.95,-1396 11393.95,-1396 11747.82,-1396 11747.82,-1396"/>
<polygon fill="black" stroke="black" points="11747.82,-1399.5 11757.82,-1396 11747.82,-1392.5 11747.82,-1399.5"/>
</g>
<!-- l2_k_proj_0&#45;&gt;l2_attn_0 -->
<g id="edge277" class="edge">
<title>l2_k_proj_0&#45;&gt;l2_attn_0</title>
<path fill="none" stroke="black" d="M12280.25,-1449.83C12280.25,-1449.83 12280.25,-1424.41 12280.25,-1424.41"/>
<polygon fill="black" stroke="black" points="12283.75,-1424.41 12280.25,-1414.41 12276.75,-1424.41 12283.75,-1424.41"/>
</g>
<!-- l2_v_proj_0&#45;&gt;l2_attn_0 -->
<g id="edge278" class="edge">
<title>l2_v_proj_0&#45;&gt;l2_attn_0</title>
<path fill="none" stroke="black" d="M11926.25,-1449.83C11926.25,-1449.83 11926.25,-1424.41 11926.25,-1424.41"/>
<polygon fill="black" stroke="black" points="11929.75,-1424.41 11926.25,-1414.41 11922.75,-1424.41 11929.75,-1424.41"/>
</g>
<!-- l2_out_proj_0 -->
<g id="node200" class="node">
<title>l2_out_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="13058,-1342 12418,-1342 12418,-1306 13058,-1306 13058,-1342"/>
<text text-anchor="middle" x="12738" y="-1321.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_attn_0&#45;&gt;l2_out_proj_0 -->
<g id="edge279" class="edge">
<title>l2_attn_0&#45;&gt;l2_out_proj_0</title>
<path fill="none" stroke="black" d="M12433,-1377.83C12433,-1377.83 12433,-1352.41 12433,-1352.41"/>
<polygon fill="black" stroke="black" points="12436.5,-1352.41 12433,-1342.41 12429.5,-1352.41 12436.5,-1352.41"/>
</g>
<!-- l2_out_proj_0&#45;&gt;l2_res_0 -->
<g id="edge280" class="edge">
<title>l2_out_proj_0&#45;&gt;l2_res_0</title>
<path fill="none" stroke="black" d="M13058.17,-1324C13217.86,-1324 13377.4,-1324 13377.4,-1324 13377.4,-1324 13377.4,-1262.21 13377.4,-1262.21"/>
<polygon fill="black" stroke="black" points="13380.9,-1262.21 13377.4,-1252.21 13373.9,-1262.21 13380.9,-1262.21"/>
</g>
<!-- l2_ln1_0 -->
<g id="node202" class="node">
<title>l2_ln1_0</title>
<polygon fill="lightgreen" stroke="black" points="14177.5,-1198 13584.5,-1198 13584.5,-1162 14177.5,-1162 14177.5,-1198"/>
<text text-anchor="middle" x="13881" y="-1177.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res_0&#45;&gt;l2_ln1_0 -->
<g id="edge282" class="edge">
<title>l2_res_0&#45;&gt;l2_ln1_0</title>
<path fill="none" stroke="black" d="M13881,-1233.83C13881,-1233.83 13881,-1208.41 13881,-1208.41"/>
<polygon fill="black" stroke="black" points="13884.5,-1208.41 13881,-1198.41 13877.5,-1208.41 13884.5,-1208.41"/>
</g>
<!-- l2_ffn_up_0 -->
<g id="node203" class="node">
<title>l2_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="14027.5,-1126 13404.5,-1126 13404.5,-1090 14027.5,-1090 14027.5,-1126"/>
<text text-anchor="middle" x="13716" y="-1105.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ln1_0&#45;&gt;l2_ffn_up_0 -->
<g id="edge283" class="edge">
<title>l2_ln1_0&#45;&gt;l2_ffn_up_0</title>
<path fill="none" stroke="black" d="M13806,-1161.83C13806,-1161.83 13806,-1136.41 13806,-1136.41"/>
<polygon fill="black" stroke="black" points="13809.5,-1136.41 13806,-1126.41 13802.5,-1136.41 13809.5,-1136.41"/>
</g>
<!-- l2_res2_0 -->
<g id="node205" class="node">
<title>l2_res2_0</title>
<polygon fill="lightgray" stroke="black" points="13932,-982 13418.2,-964 13932,-946 14445.8,-964 13932,-982"/>
<text text-anchor="middle" x="13932" y="-961.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln1_0&#45;&gt;l2_res2_0 -->
<g id="edge286" class="edge">
<title>l2_ln1_0&#45;&gt;l2_res2_0</title>
<path fill="none" stroke="black" d="M14104.25,-1161.96C14104.25,-1161.96 14104.25,-985.98 14104.25,-985.98"/>
<polygon fill="black" stroke="black" points="14107.75,-985.98 14104.25,-975.98 14100.75,-985.98 14107.75,-985.98"/>
</g>
<!-- l2_ffn_down_0 -->
<g id="node204" class="node">
<title>l2_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="14031,-1054 13395,-1054 13395,-1018 14031,-1018 14031,-1054"/>
<text text-anchor="middle" x="13713" y="-1033.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_0&#45;&gt;l2_ffn_down_0 -->
<g id="edge284" class="edge">
<title>l2_ffn_up_0&#45;&gt;l2_ffn_down_0</title>
<path fill="none" stroke="black" d="M13716,-1089.83C13716,-1089.83 13716,-1064.41 13716,-1064.41"/>
<polygon fill="black" stroke="black" points="13719.5,-1064.41 13716,-1054.41 13712.5,-1064.41 13719.5,-1064.41"/>
</g>
<!-- l2_ffn_down_0&#45;&gt;l2_res2_0 -->
<g id="edge285" class="edge">
<title>l2_ffn_down_0&#45;&gt;l2_res2_0</title>
<path fill="none" stroke="black" d="M13724.68,-1017.83C13724.68,-1017.83 13724.68,-984.98 13724.68,-984.98"/>
<polygon fill="black" stroke="black" points="13728.18,-984.98 13724.68,-974.98 13721.18,-984.98 13728.18,-984.98"/>
</g>
<!-- l2_ln2_0 -->
<g id="node206" class="node">
<title>l2_ln2_0</title>
<polygon fill="lightgreen" stroke="black" points="14010.5,-910 13417.5,-910 13417.5,-874 14010.5,-874 14010.5,-910"/>
<text text-anchor="middle" x="13714" y="-889.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_0&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res2_0&#45;&gt;l2_ln2_0 -->
<g id="edge287" class="edge">
<title>l2_res2_0&#45;&gt;l2_ln2_0</title>
<path fill="none" stroke="black" d="M13714.43,-953.38C13714.43,-953.38 13714.43,-920.21 13714.43,-920.21"/>
<polygon fill="black" stroke="black" points="13717.93,-920.21 13714.43,-910.21 13710.93,-920.21 13717.93,-920.21"/>
</g>
<!-- comm_stage0_to_stage1_2 -->
<g id="node284" class="node">
<title>comm_stage0_to_stage1_2</title>
<polygon fill="lightyellow" stroke="black" points="12784.15,-838 12115.78,-838 11943.85,-802 12612.22,-802 12784.15,-838"/>
<text text-anchor="middle" x="12364" y="-817.5" font-family="Arial" font-size="10.00">&lt;b&gt;Pipeline Communication&lt;/b&gt;&lt;br/&gt;All GPUs 0&#45;7 to All GPUs 8&#45;15&lt;br/&gt;[batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln2_0&#45;&gt;comm_stage0_to_stage1_2 -->
<g id="edge393" class="edge">
<title>l2_ln2_0&#45;&gt;comm_stage0_to_stage1_2</title>
<path fill="none" stroke="black" d="M13521.5,-873.96C13521.5,-857.27 13521.5,-835 13521.5,-835 13521.5,-835 12780.06,-835 12780.06,-835"/>
<polygon fill="black" stroke="black" points="12780.06,-831.5 12770.06,-835 12780.06,-838.5 12780.06,-831.5"/>
</g>
<!-- l2_attn_1 -->
<g id="node210" class="node">
<title>l2_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="4821,-1414 4131,-1414 4131,-1378 4821,-1378 4821,-1414"/>
<text text-anchor="middle" x="4476" y="-1393.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l2_q_proj_1&#45;&gt;l2_attn_1 -->
<g id="edge291" class="edge">
<title>l2_q_proj_1&#45;&gt;l2_attn_1</title>
<path fill="none" stroke="black" d="M4653,-1449.83C4653,-1449.83 4653,-1424.41 4653,-1424.41"/>
<polygon fill="black" stroke="black" points="4656.5,-1424.41 4653,-1414.41 4649.5,-1424.41 4656.5,-1424.41"/>
</g>
<!-- l2_k_proj_1&#45;&gt;l2_attn_1 -->
<g id="edge292" class="edge">
<title>l2_k_proj_1&#45;&gt;l2_attn_1</title>
<path fill="none" stroke="black" d="M4298.75,-1449.83C4298.75,-1449.83 4298.75,-1424.41 4298.75,-1424.41"/>
<polygon fill="black" stroke="black" points="4302.25,-1424.41 4298.75,-1414.41 4295.25,-1424.41 4302.25,-1424.41"/>
</g>
<!-- l2_v_proj_1&#45;&gt;l2_attn_1 -->
<g id="edge293" class="edge">
<title>l2_v_proj_1&#45;&gt;l2_attn_1</title>
<path fill="none" stroke="black" d="M3749.75,-1449.83C3749.75,-1428.5 3749.75,-1396 3749.75,-1396 3749.75,-1396 4120.95,-1396 4120.95,-1396"/>
<polygon fill="black" stroke="black" points="4120.95,-1399.5 4130.95,-1396 4120.95,-1392.5 4120.95,-1399.5"/>
</g>
<!-- l2_out_proj_1 -->
<g id="node211" class="node">
<title>l2_out_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="5420,-1342 4780,-1342 4780,-1306 5420,-1306 5420,-1342"/>
<text text-anchor="middle" x="5100" y="-1321.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_attn_1&#45;&gt;l2_out_proj_1 -->
<g id="edge294" class="edge">
<title>l2_attn_1&#45;&gt;l2_out_proj_1</title>
<path fill="none" stroke="black" d="M4800.5,-1377.83C4800.5,-1377.83 4800.5,-1352.41 4800.5,-1352.41"/>
<polygon fill="black" stroke="black" points="4804,-1352.41 4800.5,-1342.41 4797,-1352.41 4804,-1352.41"/>
</g>
<!-- l2_out_proj_1&#45;&gt;l2_res_1 -->
<g id="edge295" class="edge">
<title>l2_out_proj_1&#45;&gt;l2_res_1</title>
<path fill="none" stroke="black" d="M5376.5,-1305.68C5376.5,-1274.87 5376.5,-1216 5376.5,-1216 5376.5,-1216 9035.92,-1216 9035.92,-1216 9035.92,-1216 9035.92,-1239.18 9035.92,-1239.18"/>
<polygon fill="black" stroke="black" points="9032.42,-1239.18 9035.92,-1249.18 9039.42,-1239.18 9032.42,-1239.18"/>
</g>
<!-- l2_ln1_1 -->
<g id="node213" class="node">
<title>l2_ln1_1</title>
<polygon fill="lightgreen" stroke="black" points="9770.5,-1198 9177.5,-1198 9177.5,-1162 9770.5,-1162 9770.5,-1198"/>
<text text-anchor="middle" x="9474" y="-1177.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res_1&#45;&gt;l2_ln1_1 -->
<g id="edge297" class="edge">
<title>l2_res_1&#45;&gt;l2_ln1_1</title>
<path fill="none" stroke="black" d="M9474,-1233.83C9474,-1233.83 9474,-1208.41 9474,-1208.41"/>
<polygon fill="black" stroke="black" points="9477.5,-1208.41 9474,-1198.41 9470.5,-1208.41 9477.5,-1208.41"/>
</g>
<!-- l2_ffn_up_1 -->
<g id="node214" class="node">
<title>l2_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="9737.5,-1126 9114.5,-1126 9114.5,-1090 9737.5,-1090 9737.5,-1126"/>
<text text-anchor="middle" x="9426" y="-1105.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ln1_1&#45;&gt;l2_ffn_up_1 -->
<g id="edge298" class="edge">
<title>l2_ln1_1&#45;&gt;l2_ffn_up_1</title>
<path fill="none" stroke="black" d="M9457.5,-1161.83C9457.5,-1161.83 9457.5,-1136.41 9457.5,-1136.41"/>
<polygon fill="black" stroke="black" points="9461,-1136.41 9457.5,-1126.41 9454,-1136.41 9461,-1136.41"/>
</g>
<!-- l2_res2_1 -->
<g id="node216" class="node">
<title>l2_res2_1</title>
<polygon fill="lightgray" stroke="black" points="9752,-982 9238.2,-964 9752,-946 10265.8,-964 9752,-982"/>
<text text-anchor="middle" x="9752" y="-961.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln1_1&#45;&gt;l2_res2_1 -->
<g id="edge301" class="edge">
<title>l2_ln1_1&#45;&gt;l2_res2_1</title>
<path fill="none" stroke="black" d="M9755.25,-1161.96C9755.25,-1161.96 9755.25,-992.15 9755.25,-992.15"/>
<polygon fill="black" stroke="black" points="9758.75,-992.15 9755.25,-982.15 9751.75,-992.15 9758.75,-992.15"/>
</g>
<!-- l2_ffn_down_1 -->
<g id="node215" class="node">
<title>l2_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="9740,-1054 9104,-1054 9104,-1018 9740,-1018 9740,-1054"/>
<text text-anchor="middle" x="9422" y="-1033.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_1&#45;&gt;l2_ffn_down_1 -->
<g id="edge299" class="edge">
<title>l2_ffn_up_1&#45;&gt;l2_ffn_down_1</title>
<path fill="none" stroke="black" d="M9426,-1089.83C9426,-1089.83 9426,-1064.41 9426,-1064.41"/>
<polygon fill="black" stroke="black" points="9429.5,-1064.41 9426,-1054.41 9422.5,-1064.41 9429.5,-1064.41"/>
</g>
<!-- l2_ffn_down_1&#45;&gt;l2_res2_1 -->
<g id="edge300" class="edge">
<title>l2_ffn_down_1&#45;&gt;l2_res2_1</title>
<path fill="none" stroke="black" d="M9489.18,-1017.83C9489.18,-1017.83 9489.18,-982.96 9489.18,-982.96"/>
<polygon fill="black" stroke="black" points="9492.68,-982.96 9489.18,-972.96 9485.68,-982.96 9492.68,-982.96"/>
</g>
<!-- l2_ln2_1 -->
<g id="node217" class="node">
<title>l2_ln2_1</title>
<polygon fill="lightgreen" stroke="black" points="10536.5,-910 9943.5,-910 9943.5,-874 10536.5,-874 10536.5,-910"/>
<text text-anchor="middle" x="10240" y="-889.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_1&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res2_1&#45;&gt;l2_ln2_1 -->
<g id="edge302" class="edge">
<title>l2_res2_1&#45;&gt;l2_ln2_1</title>
<path fill="none" stroke="black" d="M10104.57,-958.35C10104.57,-958.35 10104.57,-920.04 10104.57,-920.04"/>
<polygon fill="black" stroke="black" points="10108.07,-920.04 10104.57,-910.04 10101.07,-920.04 10108.07,-920.04"/>
</g>
<!-- l2_ln2_1&#45;&gt;comm_stage0_to_stage1_2 -->
<g id="edge394" class="edge">
<title>l2_ln2_1&#45;&gt;comm_stage0_to_stage1_2</title>
<path fill="none" stroke="black" d="M10496,-873.97C10496,-856.94 10496,-834 10496,-834 10496,-834 12086.36,-834 12086.36,-834"/>
<polygon fill="black" stroke="black" points="12086.36,-837.5 12096.36,-834 12086.36,-830.5 12086.36,-837.5"/>
</g>
<!-- l2_attn_2 -->
<g id="node221" class="node">
<title>l2_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="8635,-1414 7945,-1414 7945,-1378 8635,-1378 8635,-1414"/>
<text text-anchor="middle" x="8290" y="-1393.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l2_q_proj_2&#45;&gt;l2_attn_2 -->
<g id="edge306" class="edge">
<title>l2_q_proj_2&#45;&gt;l2_attn_2</title>
<path fill="none" stroke="black" d="M7643,-1449.97C7643,-1430.42 7643,-1402 7643,-1402 7643,-1402 7934.72,-1402 7934.72,-1402"/>
<polygon fill="black" stroke="black" points="7934.72,-1405.5 7944.72,-1402 7934.72,-1398.5 7934.72,-1405.5"/>
</g>
<!-- l2_k_proj_2&#45;&gt;l2_attn_2 -->
<g id="edge307" class="edge">
<title>l2_k_proj_2&#45;&gt;l2_attn_2</title>
<path fill="none" stroke="black" d="M8467.25,-1449.83C8467.25,-1449.83 8467.25,-1424.41 8467.25,-1424.41"/>
<polygon fill="black" stroke="black" points="8470.75,-1424.41 8467.25,-1414.41 8463.75,-1424.41 8470.75,-1424.41"/>
</g>
<!-- l2_v_proj_2&#45;&gt;l2_attn_2 -->
<g id="edge308" class="edge">
<title>l2_v_proj_2&#45;&gt;l2_attn_2</title>
<path fill="none" stroke="black" d="M8113.25,-1449.83C8113.25,-1449.83 8113.25,-1424.41 8113.25,-1424.41"/>
<polygon fill="black" stroke="black" points="8116.75,-1424.41 8113.25,-1414.41 8109.75,-1424.41 8116.75,-1424.41"/>
</g>
<!-- l2_out_proj_2 -->
<g id="node222" class="node">
<title>l2_out_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="10508,-1342 9868,-1342 9868,-1306 10508,-1306 10508,-1342"/>
<text text-anchor="middle" x="10188" y="-1321.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_attn_2&#45;&gt;l2_out_proj_2 -->
<g id="edge309" class="edge">
<title>l2_attn_2&#45;&gt;l2_out_proj_2</title>
<path fill="none" stroke="black" d="M8456,-1377.83C8456,-1356.5 8456,-1324 8456,-1324 8456,-1324 9857.8,-1324 9857.8,-1324"/>
<polygon fill="black" stroke="black" points="9857.8,-1327.5 9867.8,-1324 9857.8,-1320.5 9857.8,-1327.5"/>
</g>
<!-- l2_out_proj_2&#45;&gt;l2_res_2 -->
<g id="edge310" class="edge">
<title>l2_out_proj_2&#45;&gt;l2_res_2</title>
<path fill="none" stroke="black" d="M10508.08,-1318C10845.56,-1318 11328.9,-1318 11328.9,-1318 11328.9,-1318 11328.9,-1264.51 11328.9,-1264.51"/>
<polygon fill="black" stroke="black" points="11332.4,-1264.51 11328.9,-1254.51 11325.4,-1264.51 11332.4,-1264.51"/>
</g>
<!-- l2_ln1_2 -->
<g id="node224" class="node">
<title>l2_ln1_2</title>
<polygon fill="lightgreen" stroke="black" points="12066.5,-1198 11473.5,-1198 11473.5,-1162 12066.5,-1162 12066.5,-1198"/>
<text text-anchor="middle" x="11770" y="-1177.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res_2&#45;&gt;l2_ln1_2 -->
<g id="edge312" class="edge">
<title>l2_res_2&#45;&gt;l2_ln1_2</title>
<path fill="none" stroke="black" d="M11770,-1233.83C11770,-1233.83 11770,-1208.41 11770,-1208.41"/>
<polygon fill="black" stroke="black" points="11773.5,-1208.41 11770,-1198.41 11766.5,-1208.41 11773.5,-1208.41"/>
</g>
<!-- l2_ffn_up_2 -->
<g id="node225" class="node">
<title>l2_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="11987.5,-1126 11364.5,-1126 11364.5,-1090 11987.5,-1090 11987.5,-1126"/>
<text text-anchor="middle" x="11676" y="-1105.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ln1_2&#45;&gt;l2_ffn_up_2 -->
<g id="edge313" class="edge">
<title>l2_ln1_2&#45;&gt;l2_ffn_up_2</title>
<path fill="none" stroke="black" d="M11730.5,-1161.83C11730.5,-1161.83 11730.5,-1136.41 11730.5,-1136.41"/>
<polygon fill="black" stroke="black" points="11734,-1136.41 11730.5,-1126.41 11727,-1136.41 11734,-1136.41"/>
</g>
<!-- l2_res2_2 -->
<g id="node227" class="node">
<title>l2_res2_2</title>
<polygon fill="lightgray" stroke="black" points="11842,-982 11328.2,-964 11842,-946 12355.8,-964 11842,-982"/>
<text text-anchor="middle" x="11842" y="-961.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln1_2&#45;&gt;l2_res2_2 -->
<g id="edge316" class="edge">
<title>l2_ln1_2&#45;&gt;l2_res2_2</title>
<path fill="none" stroke="black" d="M12028.75,-1161.96C12028.75,-1161.96 12028.75,-985.72 12028.75,-985.72"/>
<polygon fill="black" stroke="black" points="12032.25,-985.72 12028.75,-975.72 12025.25,-985.72 12032.25,-985.72"/>
</g>
<!-- l2_ffn_down_2 -->
<g id="node226" class="node">
<title>l2_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="11991,-1054 11355,-1054 11355,-1018 11991,-1018 11991,-1054"/>
<text text-anchor="middle" x="11673" y="-1033.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_2&#45;&gt;l2_ffn_down_2 -->
<g id="edge314" class="edge">
<title>l2_ffn_up_2&#45;&gt;l2_ffn_down_2</title>
<path fill="none" stroke="black" d="M11676,-1089.83C11676,-1089.83 11676,-1064.41 11676,-1064.41"/>
<polygon fill="black" stroke="black" points="11679.5,-1064.41 11676,-1054.41 11672.5,-1064.41 11679.5,-1064.41"/>
</g>
<!-- l2_ffn_down_2&#45;&gt;l2_res2_2 -->
<g id="edge315" class="edge">
<title>l2_ffn_down_2&#45;&gt;l2_res2_2</title>
<path fill="none" stroke="black" d="M11673,-1017.83C11673,-1017.83 11673,-986.28 11673,-986.28"/>
<polygon fill="black" stroke="black" points="11676.5,-986.27 11673,-976.28 11669.5,-986.28 11676.5,-986.27"/>
</g>
<!-- l2_ln2_2 -->
<g id="node228" class="node">
<title>l2_ln2_2</title>
<polygon fill="lightgreen" stroke="black" points="12246.5,-910 11653.5,-910 11653.5,-874 12246.5,-874 12246.5,-910"/>
<text text-anchor="middle" x="11950" y="-889.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_2&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res2_2&#45;&gt;l2_ln2_2 -->
<g id="edge317" class="edge">
<title>l2_res2_2&#45;&gt;l2_ln2_2</title>
<path fill="none" stroke="black" d="M11950,-949.78C11950,-949.78 11950,-920.03 11950,-920.03"/>
<polygon fill="black" stroke="black" points="11953.5,-920.03 11950,-910.03 11946.5,-920.03 11953.5,-920.03"/>
</g>
<!-- l2_ln2_2&#45;&gt;comm_stage0_to_stage1_2 -->
<g id="edge395" class="edge">
<title>l2_ln2_2&#45;&gt;comm_stage0_to_stage1_2</title>
<path fill="none" stroke="black" d="M12095.09,-873.83C12095.09,-873.83 12095.09,-844.07 12095.09,-844.07"/>
<polygon fill="black" stroke="black" points="12098.59,-844.07 12095.09,-834.07 12091.59,-844.07 12098.59,-844.07"/>
</g>
<!-- l2_attn_3 -->
<g id="node232" class="node">
<title>l2_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="6728,-1414 6038,-1414 6038,-1378 6728,-1378 6728,-1414"/>
<text text-anchor="middle" x="6383" y="-1393.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l2_q_proj_3&#45;&gt;l2_attn_3 -->
<g id="edge321" class="edge">
<title>l2_q_proj_3&#45;&gt;l2_attn_3</title>
<path fill="none" stroke="black" d="M6560,-1449.83C6560,-1449.83 6560,-1424.41 6560,-1424.41"/>
<polygon fill="black" stroke="black" points="6563.5,-1424.41 6560,-1414.41 6556.5,-1424.41 6563.5,-1424.41"/>
</g>
<!-- l2_k_proj_3&#45;&gt;l2_attn_3 -->
<g id="edge322" class="edge">
<title>l2_k_proj_3&#45;&gt;l2_attn_3</title>
<path fill="none" stroke="black" d="M6205.75,-1449.83C6205.75,-1449.83 6205.75,-1424.41 6205.75,-1424.41"/>
<polygon fill="black" stroke="black" points="6209.25,-1424.41 6205.75,-1414.41 6202.25,-1424.41 6209.25,-1424.41"/>
</g>
<!-- l2_v_proj_3&#45;&gt;l2_attn_3 -->
<g id="edge323" class="edge">
<title>l2_v_proj_3&#45;&gt;l2_attn_3</title>
<path fill="none" stroke="black" d="M5579.25,-1449.83C5579.25,-1428.5 5579.25,-1396 5579.25,-1396 5579.25,-1396 6027.76,-1396 6027.76,-1396"/>
<polygon fill="black" stroke="black" points="6027.76,-1399.5 6037.76,-1396 6027.76,-1392.5 6027.76,-1399.5"/>
</g>
<!-- l2_out_proj_3 -->
<g id="node233" class="node">
<title>l2_out_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="8277,-1342 7637,-1342 7637,-1306 8277,-1306 8277,-1342"/>
<text text-anchor="middle" x="7957" y="-1321.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_attn_3&#45;&gt;l2_out_proj_3 -->
<g id="edge324" class="edge">
<title>l2_attn_3&#45;&gt;l2_out_proj_3</title>
<path fill="none" stroke="black" d="M6728.14,-1390C7100.27,-1390 7640,-1390 7640,-1390 7640,-1390 7640,-1352.03 7640,-1352.03"/>
<polygon fill="black" stroke="black" points="7643.5,-1352.03 7640,-1342.03 7636.5,-1352.03 7643.5,-1352.03"/>
</g>
<!-- l2_out_proj_3&#45;&gt;l2_res_3 -->
<g id="edge325" class="edge">
<title>l2_out_proj_3&#45;&gt;l2_res_3</title>
<path fill="none" stroke="black" d="M8103.42,-1305.58C8103.42,-1296.72 8103.42,-1288 8103.42,-1288 8103.42,-1288 10323.92,-1288 10323.92,-1288 10323.92,-1288 10323.92,-1268.6 10323.92,-1268.6"/>
<polygon fill="black" stroke="black" points="10327.42,-1268.6 10323.92,-1258.6 10320.42,-1268.6 10327.42,-1268.6"/>
</g>
<!-- l2_ln1_3 -->
<g id="node235" class="node">
<title>l2_ln1_3</title>
<polygon fill="lightgreen" stroke="black" points="10942.5,-1198 10349.5,-1198 10349.5,-1162 10942.5,-1162 10942.5,-1198"/>
<text text-anchor="middle" x="10646" y="-1177.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res_3&#45;&gt;l2_ln1_3 -->
<g id="edge327" class="edge">
<title>l2_res_3&#45;&gt;l2_ln1_3</title>
<path fill="none" stroke="black" d="M10646,-1233.83C10646,-1233.83 10646,-1208.41 10646,-1208.41"/>
<polygon fill="black" stroke="black" points="10649.5,-1208.41 10646,-1198.41 10642.5,-1208.41 10649.5,-1208.41"/>
</g>
<!-- l2_ffn_up_3 -->
<g id="node236" class="node">
<title>l2_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="10864.5,-1126 10241.5,-1126 10241.5,-1090 10864.5,-1090 10864.5,-1126"/>
<text text-anchor="middle" x="10553" y="-1105.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ln1_3&#45;&gt;l2_ffn_up_3 -->
<g id="edge328" class="edge">
<title>l2_ln1_3&#45;&gt;l2_ffn_up_3</title>
<path fill="none" stroke="black" d="M10607,-1161.83C10607,-1161.83 10607,-1136.41 10607,-1136.41"/>
<polygon fill="black" stroke="black" points="10610.5,-1136.41 10607,-1126.41 10603.5,-1136.41 10610.5,-1136.41"/>
</g>
<!-- l2_res2_3 -->
<g id="node238" class="node">
<title>l2_res2_3</title>
<polygon fill="lightgray" stroke="black" points="10797,-982 10283.2,-964 10797,-946 11310.8,-964 10797,-982"/>
<text text-anchor="middle" x="10797" y="-961.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln1_3&#45;&gt;l2_res2_3 -->
<g id="edge331" class="edge">
<title>l2_ln1_3&#45;&gt;l2_res2_3</title>
<path fill="none" stroke="black" d="M10904.75,-1161.96C10904.75,-1161.96 10904.75,-988.37 10904.75,-988.37"/>
<polygon fill="black" stroke="black" points="10908.25,-988.37 10904.75,-978.37 10901.25,-988.37 10908.25,-988.37"/>
</g>
<!-- l2_ffn_down_3 -->
<g id="node237" class="node">
<title>l2_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="10867,-1054 10231,-1054 10231,-1018 10867,-1018 10867,-1054"/>
<text text-anchor="middle" x="10549" y="-1033.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_3&#45;&gt;l2_ffn_down_3 -->
<g id="edge329" class="edge">
<title>l2_ffn_up_3&#45;&gt;l2_ffn_down_3</title>
<path fill="none" stroke="black" d="M10553,-1089.83C10553,-1089.83 10553,-1064.41 10553,-1064.41"/>
<polygon fill="black" stroke="black" points="10556.5,-1064.41 10553,-1054.41 10549.5,-1064.41 10556.5,-1064.41"/>
</g>
<!-- l2_ffn_down_3&#45;&gt;l2_res2_3 -->
<g id="edge330" class="edge">
<title>l2_ffn_down_3&#45;&gt;l2_res2_3</title>
<path fill="none" stroke="black" d="M10575.18,-1017.83C10575.18,-1017.83 10575.18,-984.57 10575.18,-984.57"/>
<polygon fill="black" stroke="black" points="10578.68,-984.57 10575.18,-974.57 10571.68,-984.57 10578.68,-984.57"/>
</g>
<!-- l2_ln2_3 -->
<g id="node239" class="node">
<title>l2_ln2_3</title>
<polygon fill="lightgreen" stroke="black" points="11364.5,-910 10771.5,-910 10771.5,-874 11364.5,-874 11364.5,-910"/>
<text text-anchor="middle" x="11068" y="-889.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_3&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res2_3&#45;&gt;l2_ln2_3 -->
<g id="edge332" class="edge">
<title>l2_res2_3&#45;&gt;l2_ln2_3</title>
<path fill="none" stroke="black" d="M11041.07,-954.29C11041.07,-954.29 11041.07,-920.12 11041.07,-920.12"/>
<polygon fill="black" stroke="black" points="11044.57,-920.12 11041.07,-910.12 11037.57,-920.12 11044.57,-920.12"/>
</g>
<!-- l2_ln2_3&#45;&gt;comm_stage0_to_stage1_2 -->
<g id="edge396" class="edge">
<title>l2_ln2_3&#45;&gt;comm_stage0_to_stage1_2</title>
<path fill="none" stroke="black" d="M11230.5,-873.97C11230.5,-857.6 11230.5,-836 11230.5,-836 11230.5,-836 12096.08,-836 12096.08,-836"/>
<polygon fill="black" stroke="black" points="12096.08,-839.5 12106.08,-836 12096.08,-832.5 12096.08,-839.5"/>
</g>
<!-- l2_attn_4 -->
<g id="node243" class="node">
<title>l2_attn_4</title>
<polygon fill="lightgreen" stroke="black" points="10541,-1414 9851,-1414 9851,-1378 10541,-1378 10541,-1414"/>
<text text-anchor="middle" x="10196" y="-1393.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l2_q_proj_4&#45;&gt;l2_attn_4 -->
<g id="edge336" class="edge">
<title>l2_q_proj_4&#45;&gt;l2_attn_4</title>
<path fill="none" stroke="black" d="M10373,-1449.83C10373,-1449.83 10373,-1424.41 10373,-1424.41"/>
<polygon fill="black" stroke="black" points="10376.5,-1424.41 10373,-1414.41 10369.5,-1424.41 10376.5,-1424.41"/>
</g>
<!-- l2_k_proj_4&#45;&gt;l2_attn_4 -->
<g id="edge337" class="edge">
<title>l2_k_proj_4&#45;&gt;l2_attn_4</title>
<path fill="none" stroke="black" d="M10018.75,-1449.83C10018.75,-1449.83 10018.75,-1424.41 10018.75,-1424.41"/>
<polygon fill="black" stroke="black" points="10022.25,-1424.41 10018.75,-1414.41 10015.25,-1424.41 10022.25,-1424.41"/>
</g>
<!-- l2_v_proj_4&#45;&gt;l2_attn_4 -->
<g id="edge338" class="edge">
<title>l2_v_proj_4&#45;&gt;l2_attn_4</title>
<path fill="none" stroke="black" d="M9259.67,-1449.83C9259.67,-1428.5 9259.67,-1396 9259.67,-1396 9259.67,-1396 9840.67,-1396 9840.67,-1396"/>
<polygon fill="black" stroke="black" points="9840.67,-1399.5 9850.67,-1396 9840.67,-1392.5 9840.67,-1399.5"/>
</g>
<!-- l2_out_proj_4 -->
<g id="node244" class="node">
<title>l2_out_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="12216,-1342 11576,-1342 11576,-1306 12216,-1306 12216,-1342"/>
<text text-anchor="middle" x="11896" y="-1321.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_attn_4&#45;&gt;l2_out_proj_4 -->
<g id="edge339" class="edge">
<title>l2_attn_4&#45;&gt;l2_out_proj_4</title>
<path fill="none" stroke="black" d="M10524.5,-1377.97C10524.5,-1358.42 10524.5,-1330 10524.5,-1330 10524.5,-1330 11565.74,-1330 11565.74,-1330"/>
<polygon fill="black" stroke="black" points="11565.74,-1333.5 11575.74,-1330 11565.74,-1326.5 11565.74,-1333.5"/>
</g>
<!-- l2_out_proj_4&#45;&gt;l2_res_4 -->
<g id="edge340" class="edge">
<title>l2_out_proj_4&#45;&gt;l2_res_4</title>
<path fill="none" stroke="black" d="M12216.06,-1324C12299.52,-1324 12366.56,-1324 12366.56,-1324 12366.56,-1324 12366.56,-1263.02 12366.56,-1263.02"/>
<polygon fill="black" stroke="black" points="12370.06,-1263.02 12366.56,-1253.02 12363.06,-1263.02 12370.06,-1263.02"/>
</g>
<!-- l2_ln1_4 -->
<g id="node246" class="node">
<title>l2_ln1_4</title>
<polygon fill="lightgreen" stroke="black" points="13143.5,-1198 12550.5,-1198 12550.5,-1162 13143.5,-1162 13143.5,-1198"/>
<text text-anchor="middle" x="12847" y="-1177.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res_4&#45;&gt;l2_ln1_4 -->
<g id="edge342" class="edge">
<title>l2_res_4&#45;&gt;l2_ln1_4</title>
<path fill="none" stroke="black" d="M12847,-1233.83C12847,-1233.83 12847,-1208.41 12847,-1208.41"/>
<polygon fill="black" stroke="black" points="12850.5,-1208.41 12847,-1198.41 12843.5,-1208.41 12850.5,-1208.41"/>
</g>
<!-- l2_ffn_up_4 -->
<g id="node247" class="node">
<title>l2_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="12871.5,-1126 12248.5,-1126 12248.5,-1090 12871.5,-1090 12871.5,-1126"/>
<text text-anchor="middle" x="12560" y="-1105.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ln1_4&#45;&gt;l2_ffn_up_4 -->
<g id="edge343" class="edge">
<title>l2_ln1_4&#45;&gt;l2_ffn_up_4</title>
<path fill="none" stroke="black" d="M12711,-1161.83C12711,-1161.83 12711,-1136.41 12711,-1136.41"/>
<polygon fill="black" stroke="black" points="12714.5,-1136.41 12711,-1126.41 12707.5,-1136.41 12714.5,-1136.41"/>
</g>
<!-- l2_res2_4 -->
<g id="node249" class="node">
<title>l2_res2_4</title>
<polygon fill="lightgray" stroke="black" points="12887,-982 12373.2,-964 12887,-946 13400.8,-964 12887,-982"/>
<text text-anchor="middle" x="12887" y="-961.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln1_4&#45;&gt;l2_res2_4 -->
<g id="edge346" class="edge">
<title>l2_ln1_4&#45;&gt;l2_res2_4</title>
<path fill="none" stroke="black" d="M13009.25,-1161.96C13009.25,-1161.96 13009.25,-987.82 13009.25,-987.82"/>
<polygon fill="black" stroke="black" points="13012.75,-987.82 13009.25,-977.82 13005.75,-987.82 13012.75,-987.82"/>
</g>
<!-- l2_ffn_down_4 -->
<g id="node248" class="node">
<title>l2_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="12875,-1054 12239,-1054 12239,-1018 12875,-1018 12875,-1054"/>
<text text-anchor="middle" x="12557" y="-1033.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_4&#45;&gt;l2_ffn_down_4 -->
<g id="edge344" class="edge">
<title>l2_ffn_up_4&#45;&gt;l2_ffn_down_4</title>
<path fill="none" stroke="black" d="M12560,-1089.83C12560,-1089.83 12560,-1064.41 12560,-1064.41"/>
<polygon fill="black" stroke="black" points="12563.5,-1064.41 12560,-1054.41 12556.5,-1064.41 12563.5,-1064.41"/>
</g>
<!-- l2_ffn_down_4&#45;&gt;l2_res2_4 -->
<g id="edge345" class="edge">
<title>l2_ffn_down_4&#45;&gt;l2_res2_4</title>
<path fill="none" stroke="black" d="M12624.18,-1017.83C12624.18,-1017.83 12624.18,-982.96 12624.18,-982.96"/>
<polygon fill="black" stroke="black" points="12627.68,-982.96 12624.18,-972.96 12620.68,-982.96 12627.68,-982.96"/>
</g>
<!-- l2_ln2_4 -->
<g id="node250" class="node">
<title>l2_ln2_4</title>
<polygon fill="lightgreen" stroke="black" points="13074.5,-910 12481.5,-910 12481.5,-874 13074.5,-874 13074.5,-910"/>
<text text-anchor="middle" x="12778" y="-889.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_4&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res2_4&#45;&gt;l2_ln2_4 -->
<g id="edge347" class="edge">
<title>l2_res2_4&#45;&gt;l2_ln2_4</title>
<path fill="none" stroke="black" d="M12778,-949.78C12778,-949.78 12778,-920.03 12778,-920.03"/>
<polygon fill="black" stroke="black" points="12781.5,-920.03 12778,-910.03 12774.5,-920.03 12781.5,-920.03"/>
</g>
<!-- l2_ln2_4&#45;&gt;comm_stage0_to_stage1_2 -->
<g id="edge397" class="edge">
<title>l2_ln2_4&#45;&gt;comm_stage0_to_stage1_2</title>
<path fill="none" stroke="black" d="M12632.91,-873.83C12632.91,-873.83 12632.91,-848.41 12632.91,-848.41"/>
<polygon fill="black" stroke="black" points="12636.41,-848.41 12632.91,-838.41 12629.41,-848.41 12636.41,-848.41"/>
</g>
<!-- l2_attn_5 -->
<g id="node254" class="node">
<title>l2_attn_5</title>
<polygon fill="lightgreen" stroke="black" points="2915,-1414 2225,-1414 2225,-1378 2915,-1378 2915,-1414"/>
<text text-anchor="middle" x="2570" y="-1393.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l2_q_proj_5&#45;&gt;l2_attn_5 -->
<g id="edge351" class="edge">
<title>l2_q_proj_5&#45;&gt;l2_attn_5</title>
<path fill="none" stroke="black" d="M1617,-1449.83C1617,-1428.5 1617,-1396 1617,-1396 1617,-1396 2214.93,-1396 2214.93,-1396"/>
<polygon fill="black" stroke="black" points="2214.93,-1399.5 2224.93,-1396 2214.93,-1392.5 2214.93,-1399.5"/>
</g>
<!-- l2_k_proj_5&#45;&gt;l2_attn_5 -->
<g id="edge352" class="edge">
<title>l2_k_proj_5&#45;&gt;l2_attn_5</title>
<path fill="none" stroke="black" d="M2747.25,-1449.83C2747.25,-1449.83 2747.25,-1424.41 2747.25,-1424.41"/>
<polygon fill="black" stroke="black" points="2750.75,-1424.41 2747.25,-1414.41 2743.75,-1424.41 2750.75,-1424.41"/>
</g>
<!-- l2_v_proj_5&#45;&gt;l2_attn_5 -->
<g id="edge353" class="edge">
<title>l2_v_proj_5&#45;&gt;l2_attn_5</title>
<path fill="none" stroke="black" d="M2393.25,-1449.83C2393.25,-1449.83 2393.25,-1424.41 2393.25,-1424.41"/>
<polygon fill="black" stroke="black" points="2396.75,-1424.41 2393.25,-1414.41 2389.75,-1424.41 2396.75,-1424.41"/>
</g>
<!-- l2_out_proj_5 -->
<g id="node255" class="node">
<title>l2_out_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="3668,-1342 3028,-1342 3028,-1306 3668,-1306 3668,-1342"/>
<text text-anchor="middle" x="3348" y="-1321.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_attn_5&#45;&gt;l2_out_proj_5 -->
<g id="edge354" class="edge">
<title>l2_attn_5&#45;&gt;l2_out_proj_5</title>
<path fill="none" stroke="black" d="M2847.75,-1377.83C2847.75,-1356.5 2847.75,-1324 2847.75,-1324 2847.75,-1324 3018,-1324 3018,-1324"/>
<polygon fill="black" stroke="black" points="3018,-1327.5 3028,-1324 3018,-1320.5 3018,-1327.5"/>
</g>
<!-- l2_out_proj_5&#45;&gt;l2_res_5 -->
<g id="edge355" class="edge">
<title>l2_out_proj_5&#45;&gt;l2_res_5</title>
<path fill="none" stroke="black" d="M3544.75,-1305.83C3544.75,-1284.5 3544.75,-1252 3544.75,-1252 3544.75,-1252 7919.83,-1252 7919.83,-1252"/>
<polygon fill="black" stroke="black" points="7919.83,-1255.5 7929.83,-1252 7919.83,-1248.5 7919.83,-1255.5"/>
</g>
<!-- l2_ln1_5 -->
<g id="node257" class="node">
<title>l2_ln1_5</title>
<polygon fill="lightgreen" stroke="black" points="8732.5,-1198 8139.5,-1198 8139.5,-1162 8732.5,-1162 8732.5,-1198"/>
<text text-anchor="middle" x="8436" y="-1177.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res_5&#45;&gt;l2_ln1_5 -->
<g id="edge357" class="edge">
<title>l2_res_5&#45;&gt;l2_ln1_5</title>
<path fill="none" stroke="black" d="M8436,-1233.83C8436,-1233.83 8436,-1208.41 8436,-1208.41"/>
<polygon fill="black" stroke="black" points="8439.5,-1208.41 8436,-1198.41 8432.5,-1208.41 8439.5,-1208.41"/>
</g>
<!-- l2_ffn_up_5 -->
<g id="node258" class="node">
<title>l2_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="8716.5,-1126 8093.5,-1126 8093.5,-1090 8716.5,-1090 8716.5,-1126"/>
<text text-anchor="middle" x="8405" y="-1105.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ln1_5&#45;&gt;l2_ffn_up_5 -->
<g id="edge358" class="edge">
<title>l2_ln1_5&#45;&gt;l2_ffn_up_5</title>
<path fill="none" stroke="black" d="M8428,-1161.83C8428,-1161.83 8428,-1136.41 8428,-1136.41"/>
<polygon fill="black" stroke="black" points="8431.5,-1136.41 8428,-1126.41 8424.5,-1136.41 8431.5,-1136.41"/>
</g>
<!-- l2_res2_5 -->
<g id="node260" class="node">
<title>l2_res2_5</title>
<polygon fill="lightgray" stroke="black" points="8707,-982 8193.2,-964 8707,-946 9220.8,-964 8707,-982"/>
<text text-anchor="middle" x="8707" y="-961.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln1_5&#45;&gt;l2_res2_5 -->
<g id="edge361" class="edge">
<title>l2_ln1_5&#45;&gt;l2_res2_5</title>
<path fill="none" stroke="black" d="M8726.25,-1161.96C8726.25,-1161.96 8726.25,-991.54 8726.25,-991.54"/>
<polygon fill="black" stroke="black" points="8729.75,-991.54 8726.25,-981.54 8722.75,-991.54 8729.75,-991.54"/>
</g>
<!-- l2_ffn_down_5 -->
<g id="node259" class="node">
<title>l2_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="8720,-1054 8084,-1054 8084,-1018 8720,-1018 8720,-1054"/>
<text text-anchor="middle" x="8402" y="-1033.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_5&#45;&gt;l2_ffn_down_5 -->
<g id="edge359" class="edge">
<title>l2_ffn_up_5&#45;&gt;l2_ffn_down_5</title>
<path fill="none" stroke="black" d="M8405,-1089.83C8405,-1089.83 8405,-1064.41 8405,-1064.41"/>
<polygon fill="black" stroke="black" points="8408.5,-1064.41 8405,-1054.41 8401.5,-1064.41 8408.5,-1064.41"/>
</g>
<!-- l2_ffn_down_5&#45;&gt;l2_res2_5 -->
<g id="edge360" class="edge">
<title>l2_ffn_down_5&#45;&gt;l2_res2_5</title>
<path fill="none" stroke="black" d="M8456.68,-1017.83C8456.68,-1017.83 8456.68,-983.35 8456.68,-983.35"/>
<polygon fill="black" stroke="black" points="8460.18,-983.35 8456.68,-973.35 8453.18,-983.35 8460.18,-983.35"/>
</g>
<!-- l2_ln2_5 -->
<g id="node261" class="node">
<title>l2_ln2_5</title>
<polygon fill="lightgreen" stroke="black" points="9491.5,-910 8898.5,-910 8898.5,-874 9491.5,-874 9491.5,-910"/>
<text text-anchor="middle" x="9195" y="-889.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_5&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res2_5&#45;&gt;l2_ln2_5 -->
<g id="edge362" class="edge">
<title>l2_res2_5&#45;&gt;l2_ln2_5</title>
<path fill="none" stroke="black" d="M9059.57,-958.35C9059.57,-958.35 9059.57,-920.04 9059.57,-920.04"/>
<polygon fill="black" stroke="black" points="9063.07,-920.04 9059.57,-910.04 9056.07,-920.04 9063.07,-920.04"/>
</g>
<!-- l2_ln2_5&#45;&gt;comm_stage0_to_stage1_2 -->
<g id="edge398" class="edge">
<title>l2_ln2_5&#45;&gt;comm_stage0_to_stage1_2</title>
<path fill="none" stroke="black" d="M9332.5,-874C9332.5,-856.32 9332.5,-832 9332.5,-832 9332.5,-832 12076.94,-832 12076.94,-832"/>
<polygon fill="black" stroke="black" points="12076.94,-835.5 12086.94,-832 12076.94,-828.5 12076.94,-835.5"/>
</g>
<!-- l2_attn_6 -->
<g id="node265" class="node">
<title>l2_attn_6</title>
<polygon fill="lightgreen" stroke="black" points="16031,-1414 15341,-1414 15341,-1378 16031,-1378 16031,-1414"/>
<text text-anchor="middle" x="15686" y="-1393.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l2_q_proj_6&#45;&gt;l2_attn_6 -->
<g id="edge366" class="edge">
<title>l2_q_proj_6&#45;&gt;l2_attn_6</title>
<path fill="none" stroke="black" d="M15978,-1449.83C15978,-1449.83 15978,-1424.41 15978,-1424.41"/>
<polygon fill="black" stroke="black" points="15981.5,-1424.41 15978,-1414.41 15974.5,-1424.41 15981.5,-1424.41"/>
</g>
<!-- l2_k_proj_6&#45;&gt;l2_attn_6 -->
<g id="edge367" class="edge">
<title>l2_k_proj_6&#45;&gt;l2_attn_6</title>
<path fill="none" stroke="black" d="M15623.75,-1449.83C15623.75,-1449.83 15623.75,-1424.41 15623.75,-1424.41"/>
<polygon fill="black" stroke="black" points="15627.25,-1424.41 15623.75,-1414.41 15620.25,-1424.41 15627.25,-1424.41"/>
</g>
<!-- l2_v_proj_6&#45;&gt;l2_attn_6 -->
<g id="edge368" class="edge">
<title>l2_v_proj_6&#45;&gt;l2_attn_6</title>
<path fill="none" stroke="black" d="M15214.25,-1449.91C15214.25,-1426.87 15214.25,-1390 15214.25,-1390 15214.25,-1390 15330.98,-1390 15330.98,-1390"/>
<polygon fill="black" stroke="black" points="15330.98,-1393.5 15340.98,-1390 15330.98,-1386.5 15330.98,-1393.5"/>
</g>
<!-- l2_out_proj_6 -->
<g id="node266" class="node">
<title>l2_out_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="16183,-1342 15543,-1342 15543,-1306 16183,-1306 16183,-1342"/>
<text text-anchor="middle" x="15863" y="-1321.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_attn_6&#45;&gt;l2_out_proj_6 -->
<g id="edge369" class="edge">
<title>l2_attn_6&#45;&gt;l2_out_proj_6</title>
<path fill="none" stroke="black" d="M15787,-1377.83C15787,-1377.83 15787,-1352.41 15787,-1352.41"/>
<polygon fill="black" stroke="black" points="15790.5,-1352.41 15787,-1342.41 15783.5,-1352.41 15790.5,-1352.41"/>
</g>
<!-- l2_out_proj_6&#45;&gt;l2_res_6 -->
<g id="edge370" class="edge">
<title>l2_out_proj_6&#45;&gt;l2_res_6</title>
<path fill="none" stroke="black" d="M15863,-1305.83C15863,-1305.83 15863,-1276.07 15863,-1276.07"/>
<polygon fill="black" stroke="black" points="15866.5,-1276.07 15863,-1266.07 15859.5,-1276.07 15866.5,-1276.07"/>
</g>
<!-- l2_ln1_6 -->
<g id="node268" class="node">
<title>l2_ln1_6</title>
<polygon fill="lightgreen" stroke="black" points="16270.5,-1198 15677.5,-1198 15677.5,-1162 16270.5,-1162 16270.5,-1198"/>
<text text-anchor="middle" x="15974" y="-1177.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res_6&#45;&gt;l2_ln1_6 -->
<g id="edge372" class="edge">
<title>l2_res_6&#45;&gt;l2_ln1_6</title>
<path fill="none" stroke="black" d="M15974,-1233.83C15974,-1233.83 15974,-1208.41 15974,-1208.41"/>
<polygon fill="black" stroke="black" points="15977.5,-1208.41 15974,-1198.41 15970.5,-1208.41 15977.5,-1208.41"/>
</g>
<!-- l2_ffn_up_6 -->
<g id="node269" class="node">
<title>l2_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="16143.5,-1126 15520.5,-1126 15520.5,-1090 16143.5,-1090 16143.5,-1126"/>
<text text-anchor="middle" x="15832" y="-1105.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ln1_6&#45;&gt;l2_ffn_up_6 -->
<g id="edge373" class="edge">
<title>l2_ln1_6&#45;&gt;l2_ffn_up_6</title>
<path fill="none" stroke="black" d="M15910.5,-1161.83C15910.5,-1161.83 15910.5,-1136.41 15910.5,-1136.41"/>
<polygon fill="black" stroke="black" points="15914,-1136.41 15910.5,-1126.41 15907,-1136.41 15914,-1136.41"/>
</g>
<!-- l2_res2_6 -->
<g id="node271" class="node">
<title>l2_res2_6</title>
<polygon fill="lightgray" stroke="black" points="16022,-982 15508.2,-964 16022,-946 16535.8,-964 16022,-982"/>
<text text-anchor="middle" x="16022" y="-961.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln1_6&#45;&gt;l2_res2_6 -->
<g id="edge376" class="edge">
<title>l2_ln1_6&#45;&gt;l2_res2_6</title>
<path fill="none" stroke="black" d="M16208.25,-1161.96C16208.25,-1161.96 16208.25,-985.72 16208.25,-985.72"/>
<polygon fill="black" stroke="black" points="16211.75,-985.72 16208.25,-975.72 16204.75,-985.72 16211.75,-985.72"/>
</g>
<!-- l2_ffn_down_6 -->
<g id="node270" class="node">
<title>l2_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="16146,-1054 15510,-1054 15510,-1018 16146,-1018 16146,-1054"/>
<text text-anchor="middle" x="15828" y="-1033.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_6&#45;&gt;l2_ffn_down_6 -->
<g id="edge374" class="edge">
<title>l2_ffn_up_6&#45;&gt;l2_ffn_down_6</title>
<path fill="none" stroke="black" d="M15832,-1089.83C15832,-1089.83 15832,-1064.41 15832,-1064.41"/>
<polygon fill="black" stroke="black" points="15835.5,-1064.41 15832,-1054.41 15828.5,-1064.41 15835.5,-1064.41"/>
</g>
<!-- l2_ffn_down_6&#45;&gt;l2_res2_6 -->
<g id="edge375" class="edge">
<title>l2_ffn_down_6&#45;&gt;l2_res2_6</title>
<path fill="none" stroke="black" d="M15828,-1017.83C15828,-1017.83 15828,-985.41 15828,-985.41"/>
<polygon fill="black" stroke="black" points="15831.5,-985.41 15828,-975.41 15824.5,-985.41 15831.5,-985.41"/>
</g>
<!-- l2_ln2_6 -->
<g id="node272" class="node">
<title>l2_ln2_6</title>
<polygon fill="lightgreen" stroke="black" points="16019.5,-910 15426.5,-910 15426.5,-874 16019.5,-874 16019.5,-910"/>
<text text-anchor="middle" x="15723" y="-889.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_6&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res2_6&#45;&gt;l2_ln2_6 -->
<g id="edge377" class="edge">
<title>l2_res2_6&#45;&gt;l2_ln2_6</title>
<path fill="none" stroke="black" d="M15763.93,-954.88C15763.93,-954.88 15763.93,-920.15 15763.93,-920.15"/>
<polygon fill="black" stroke="black" points="15767.43,-920.15 15763.93,-910.15 15760.43,-920.15 15767.43,-920.15"/>
</g>
<!-- l2_ln2_6&#45;&gt;comm_stage0_to_stage1_2 -->
<g id="edge399" class="edge">
<title>l2_ln2_6&#45;&gt;comm_stage0_to_stage1_2</title>
<path fill="none" stroke="black" d="M15487.5,-873.78C15487.5,-855.17 15487.5,-829 15487.5,-829 15487.5,-829 12751.54,-829 12751.54,-829"/>
<polygon fill="black" stroke="black" points="12751.54,-825.5 12741.54,-829 12751.54,-832.5 12751.54,-825.5"/>
</g>
<!-- l2_attn_7 -->
<g id="node276" class="node">
<title>l2_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="14354,-1414 13664,-1414 13664,-1378 14354,-1378 14354,-1414"/>
<text text-anchor="middle" x="14009" y="-1393.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l2_q_proj_7&#45;&gt;l2_attn_7 -->
<g id="edge381" class="edge">
<title>l2_q_proj_7&#45;&gt;l2_attn_7</title>
<path fill="none" stroke="black" d="M14186,-1449.83C14186,-1449.83 14186,-1424.41 14186,-1424.41"/>
<polygon fill="black" stroke="black" points="14189.5,-1424.41 14186,-1414.41 14182.5,-1424.41 14189.5,-1424.41"/>
</g>
<!-- l2_k_proj_7&#45;&gt;l2_attn_7 -->
<g id="edge382" class="edge">
<title>l2_k_proj_7&#45;&gt;l2_attn_7</title>
<path fill="none" stroke="black" d="M13831.75,-1449.83C13831.75,-1449.83 13831.75,-1424.41 13831.75,-1424.41"/>
<polygon fill="black" stroke="black" points="13835.25,-1424.41 13831.75,-1414.41 13828.25,-1424.41 13835.25,-1424.41"/>
</g>
<!-- l2_v_proj_7&#45;&gt;l2_attn_7 -->
<g id="edge383" class="edge">
<title>l2_v_proj_7&#45;&gt;l2_attn_7</title>
<path fill="none" stroke="black" d="M13358.83,-1449.83C13358.83,-1428.5 13358.83,-1396 13358.83,-1396 13358.83,-1396 13653.93,-1396 13653.93,-1396"/>
<polygon fill="black" stroke="black" points="13653.93,-1399.5 13663.93,-1396 13653.93,-1392.5 13653.93,-1399.5"/>
</g>
<!-- l2_out_proj_7 -->
<g id="node277" class="node">
<title>l2_out_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="15157,-1342 14517,-1342 14517,-1306 15157,-1306 15157,-1342"/>
<text text-anchor="middle" x="14837" y="-1321.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_attn_7&#45;&gt;l2_out_proj_7 -->
<g id="edge384" class="edge">
<title>l2_attn_7&#45;&gt;l2_out_proj_7</title>
<path fill="none" stroke="black" d="M14354.24,-1402C14472.91,-1402 14576.5,-1402 14576.5,-1402 14576.5,-1402 14576.5,-1352.09 14576.5,-1352.09"/>
<polygon fill="black" stroke="black" points="14580,-1352.09 14576.5,-1342.09 14573,-1352.09 14580,-1352.09"/>
</g>
<!-- l2_out_proj_7&#45;&gt;l2_res_7 -->
<g id="edge385" class="edge">
<title>l2_out_proj_7&#45;&gt;l2_res_7</title>
<path fill="none" stroke="black" d="M14837,-1305.83C14837,-1305.83 14837,-1277.01 14837,-1277.01"/>
<polygon fill="black" stroke="black" points="14840.5,-1277.01 14837,-1267.01 14833.5,-1277.01 14840.5,-1277.01"/>
</g>
<!-- l2_ln1_7 -->
<g id="node279" class="node">
<title>l2_ln1_7</title>
<polygon fill="lightgreen" stroke="black" points="15222.5,-1198 14629.5,-1198 14629.5,-1162 15222.5,-1162 15222.5,-1198"/>
<text text-anchor="middle" x="14926" y="-1177.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res_7&#45;&gt;l2_ln1_7 -->
<g id="edge387" class="edge">
<title>l2_res_7&#45;&gt;l2_ln1_7</title>
<path fill="none" stroke="black" d="M14926,-1233.83C14926,-1233.83 14926,-1208.41 14926,-1208.41"/>
<polygon fill="black" stroke="black" points="14929.5,-1208.41 14926,-1198.41 14922.5,-1208.41 14929.5,-1208.41"/>
</g>
<!-- l2_ffn_up_7 -->
<g id="node280" class="node">
<title>l2_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="15096.5,-1126 14473.5,-1126 14473.5,-1090 15096.5,-1090 15096.5,-1126"/>
<text text-anchor="middle" x="14785" y="-1105.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l2_ln1_7&#45;&gt;l2_ffn_up_7 -->
<g id="edge388" class="edge">
<title>l2_ln1_7&#45;&gt;l2_ffn_up_7</title>
<path fill="none" stroke="black" d="M14863,-1161.83C14863,-1161.83 14863,-1136.41 14863,-1136.41"/>
<polygon fill="black" stroke="black" points="14866.5,-1136.41 14863,-1126.41 14859.5,-1136.41 14866.5,-1136.41"/>
</g>
<!-- l2_res2_7 -->
<g id="node282" class="node">
<title>l2_res2_7</title>
<polygon fill="lightgray" stroke="black" points="14977,-982 14463.2,-964 14977,-946 15490.8,-964 14977,-982"/>
<text text-anchor="middle" x="14977" y="-961.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ln1_7&#45;&gt;l2_res2_7 -->
<g id="edge391" class="edge">
<title>l2_ln1_7&#45;&gt;l2_res2_7</title>
<path fill="none" stroke="black" d="M15161.25,-1161.96C15161.25,-1161.96 15161.25,-985.72 15161.25,-985.72"/>
<polygon fill="black" stroke="black" points="15164.75,-985.72 15161.25,-975.72 15157.75,-985.72 15164.75,-985.72"/>
</g>
<!-- l2_ffn_down_7 -->
<g id="node281" class="node">
<title>l2_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="15100,-1054 14464,-1054 14464,-1018 15100,-1018 15100,-1054"/>
<text text-anchor="middle" x="14782" y="-1033.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_ffn_up_7&#45;&gt;l2_ffn_down_7 -->
<g id="edge389" class="edge">
<title>l2_ffn_up_7&#45;&gt;l2_ffn_down_7</title>
<path fill="none" stroke="black" d="M14785,-1089.83C14785,-1089.83 14785,-1064.41 14785,-1064.41"/>
<polygon fill="black" stroke="black" points="14788.5,-1064.41 14785,-1054.41 14781.5,-1064.41 14788.5,-1064.41"/>
</g>
<!-- l2_ffn_down_7&#45;&gt;l2_res2_7 -->
<g id="edge390" class="edge">
<title>l2_ffn_down_7&#45;&gt;l2_res2_7</title>
<path fill="none" stroke="black" d="M14782,-1017.83C14782,-1017.83 14782,-985.41 14782,-985.41"/>
<polygon fill="black" stroke="black" points="14785.5,-985.41 14782,-975.41 14778.5,-985.41 14785.5,-985.41"/>
</g>
<!-- l2_ln2_7 -->
<g id="node283" class="node">
<title>l2_ln2_7</title>
<polygon fill="lightgreen" stroke="black" points="15001.5,-910 14408.5,-910 14408.5,-874 15001.5,-874 15001.5,-910"/>
<text text-anchor="middle" x="14705" y="-889.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_7&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l2_res2_7&#45;&gt;l2_ln2_7 -->
<g id="edge392" class="edge">
<title>l2_res2_7&#45;&gt;l2_ln2_7</title>
<path fill="none" stroke="black" d="M14732.43,-954.29C14732.43,-954.29 14732.43,-920.12 14732.43,-920.12"/>
<polygon fill="black" stroke="black" points="14735.93,-920.12 14732.43,-910.12 14728.93,-920.12 14735.93,-920.12"/>
</g>
<!-- l2_ln2_7&#45;&gt;comm_stage0_to_stage1_2 -->
<g id="edge400" class="edge">
<title>l2_ln2_7&#45;&gt;comm_stage0_to_stage1_2</title>
<path fill="none" stroke="black" d="M14658,-874C14658,-856.32 14658,-832 14658,-832 14658,-832 12765.75,-832 12765.75,-832"/>
<polygon fill="black" stroke="black" points="12765.75,-828.5 12755.75,-832 12765.75,-835.5 12765.75,-828.5"/>
</g>
<!-- l3_q_proj_0 -->
<g id="node285" class="node">
<title>l3_q_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="12355,-765 11737,-765 11737,-729 12355,-729 12355,-765"/>
<text text-anchor="middle" x="12046" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_0 -->
<g id="edge401" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_0</title>
<path fill="none" stroke="black" d="M12149.34,-801.96C12149.34,-801.96 12149.34,-775.09 12149.34,-775.09"/>
<polygon fill="black" stroke="black" points="12152.84,-775.09 12149.34,-765.09 12145.84,-775.09 12152.84,-775.09"/>
</g>
<!-- l3_k_proj_0 -->
<g id="node286" class="node">
<title>l3_k_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="13625.5,-765 13008.5,-765 13008.5,-729 13625.5,-729 13625.5,-765"/>
<text text-anchor="middle" x="13317" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_0 -->
<g id="edge402" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_0</title>
<path fill="none" stroke="black" d="M12626.91,-805C12817.35,-805 13041.5,-805 13041.5,-805 13041.5,-805 13041.5,-775.03 13041.5,-775.03"/>
<polygon fill="black" stroke="black" points="13045,-775.03 13041.5,-765.03 13038,-775.03 13045,-775.03"/>
</g>
<!-- l3_v_proj_0 -->
<g id="node287" class="node">
<title>l3_v_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="12990.5,-765 12373.5,-765 12373.5,-729 12990.5,-729 12990.5,-765"/>
<text text-anchor="middle" x="12682" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_0 -->
<g id="edge403" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_0</title>
<path fill="none" stroke="black" d="M12578.91,-801.96C12578.91,-801.96 12578.91,-775.09 12578.91,-775.09"/>
<polygon fill="black" stroke="black" points="12582.41,-775.09 12578.91,-765.09 12575.41,-775.09 12582.41,-775.09"/>
</g>
<!-- l3_res_0 -->
<g id="node290" class="node">
<title>l3_res_0</title>
<polygon fill="lightgray" stroke="black" points="14723,-549 14216.69,-531 14723,-513 15229.31,-531 14723,-549"/>
<text text-anchor="middle" x="14723" y="-528.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_res_0 -->
<g id="edge409" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_res_0</title>
<path fill="none" stroke="black" d="M12655.36,-811C13190.46,-811 14275.5,-811 14275.5,-811 14275.5,-811 14275.5,-543.09 14275.5,-543.09"/>
<polygon fill="black" stroke="black" points="14279,-543.09 14275.5,-533.09 14272,-543.09 14279,-543.09"/>
</g>
<!-- l3_q_proj_1 -->
<g id="node296" class="node">
<title>l3_q_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="5951,-765 5333,-765 5333,-729 5951,-729 5951,-765"/>
<text text-anchor="middle" x="5642" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_1 -->
<g id="edge416" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_1</title>
<path fill="none" stroke="black" d="M12034.45,-821C10711.03,-821 5853.75,-821 5853.75,-821 5853.75,-821 5853.75,-775.29 5853.75,-775.29"/>
<polygon fill="black" stroke="black" points="5857.25,-775.29 5853.75,-765.29 5850.25,-775.29 5857.25,-775.29"/>
</g>
<!-- l3_k_proj_1 -->
<g id="node297" class="node">
<title>l3_k_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="5314.5,-765 4697.5,-765 4697.5,-729 5314.5,-729 5314.5,-765"/>
<text text-anchor="middle" x="5006" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_1 -->
<g id="edge417" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_1</title>
<path fill="none" stroke="black" d="M12044.02,-823C10634.3,-823 5047.25,-823 5047.25,-823 5047.25,-823 5047.25,-775.01 5047.25,-775.01"/>
<polygon fill="black" stroke="black" points="5050.75,-775.01 5047.25,-765.01 5043.75,-775.01 5050.75,-775.01"/>
</g>
<!-- l3_v_proj_1 -->
<g id="node298" class="node">
<title>l3_v_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="4679.5,-765 4062.5,-765 4062.5,-729 4679.5,-729 4679.5,-765"/>
<text text-anchor="middle" x="4371" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_1 -->
<g id="edge418" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_1</title>
<path fill="none" stroke="black" d="M12053.54,-825C10584.83,-825 4405.25,-825 4405.25,-825 4405.25,-825 4405.25,-775.09 4405.25,-775.09"/>
<polygon fill="black" stroke="black" points="4408.75,-775.09 4405.25,-765.09 4401.75,-775.09 4408.75,-775.09"/>
</g>
<!-- l3_res_1 -->
<g id="node301" class="node">
<title>l3_res_1</title>
<polygon fill="lightgray" stroke="black" points="10274,-549 9767.69,-531 10274,-513 10780.31,-531 10274,-549"/>
<text text-anchor="middle" x="10274" y="-528.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_res_1 -->
<g id="edge424" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_res_1</title>
<path fill="none" stroke="black" d="M11967.57,-807C11406.04,-807 10446.5,-807 10446.5,-807 10446.5,-807 10446.5,-553.22 10446.5,-553.22"/>
<polygon fill="black" stroke="black" points="10450,-553.22 10446.5,-543.22 10443,-553.22 10450,-553.22"/>
</g>
<!-- l3_q_proj_2 -->
<g id="node307" class="node">
<title>l3_q_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="8514.5,-765 7891.5,-765 7891.5,-729 8514.5,-729 8514.5,-765"/>
<text text-anchor="middle" x="8203" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_2 -->
<g id="edge431" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_2</title>
<path fill="none" stroke="black" d="M12001.06,-814C11013.94,-814 8353.93,-814 8353.93,-814 8353.93,-814 8353.93,-775.31 8353.93,-775.31"/>
<polygon fill="black" stroke="black" points="8357.43,-775.31 8353.93,-765.31 8350.43,-775.31 8357.43,-775.31"/>
</g>
<!-- l3_k_proj_2 -->
<g id="node308" class="node">
<title>l3_k_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="9796.5,-765 9173.5,-765 9173.5,-729 9796.5,-729 9796.5,-765"/>
<text text-anchor="middle" x="9485" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_2 -->
<g id="edge432" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_2</title>
<path fill="none" stroke="black" d="M11986.51,-811C11239.43,-811 9644,-811 9644,-811 9644,-811 9644,-775.17 9644,-775.17"/>
<polygon fill="black" stroke="black" points="9647.5,-775.17 9644,-765.17 9640.5,-775.17 9647.5,-775.17"/>
</g>
<!-- l3_v_proj_2 -->
<g id="node309" class="node">
<title>l3_v_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="9155.5,-765 8532.5,-765 8532.5,-729 9155.5,-729 9155.5,-765"/>
<text text-anchor="middle" x="8844" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_2 -->
<g id="edge433" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_2</title>
<path fill="none" stroke="black" d="M11991.32,-812C11120.78,-812 9027,-812 9027,-812 9027,-812 9027,-775.11 9027,-775.11"/>
<polygon fill="black" stroke="black" points="9030.5,-775.11 9027,-765.11 9023.5,-775.11 9030.5,-775.11"/>
</g>
<!-- l3_res_2 -->
<g id="node312" class="node">
<title>l3_res_2</title>
<polygon fill="lightgray" stroke="black" points="12378,-549 11866.7,-531 12378,-513 12889.3,-531 12378,-549"/>
<text text-anchor="middle" x="12378" y="-528.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_res_2 -->
<g id="edge439" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_res_2</title>
<path fill="none" stroke="black" d="M12362.93,-801.92C12362.93,-801.92 12362.93,-558.7 12362.93,-558.7"/>
<polygon fill="black" stroke="black" points="12366.43,-558.7 12362.93,-548.7 12359.43,-558.7 12366.43,-558.7"/>
</g>
<!-- l3_q_proj_3 -->
<g id="node318" class="node">
<title>l3_q_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="7873.5,-765 7250.5,-765 7250.5,-729 7873.5,-729 7873.5,-765"/>
<text text-anchor="middle" x="7562" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_3 -->
<g id="edge446" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_3</title>
<path fill="none" stroke="black" d="M12010.49,-816C10931.75,-816 7755.25,-816 7755.25,-816 7755.25,-816 7755.25,-775.13 7755.25,-775.13"/>
<polygon fill="black" stroke="black" points="7758.75,-775.13 7755.25,-765.13 7751.75,-775.13 7758.75,-775.13"/>
</g>
<!-- l3_k_proj_3 -->
<g id="node319" class="node">
<title>l3_k_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="7232.5,-765 6609.5,-765 6609.5,-729 7232.5,-729 7232.5,-765"/>
<text text-anchor="middle" x="6921" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_3 -->
<g id="edge447" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_3</title>
<path fill="none" stroke="black" d="M12020.09,-818C10855.15,-818 7130.25,-818 7130.25,-818 7130.25,-818 7130.25,-775.28 7130.25,-775.28"/>
<polygon fill="black" stroke="black" points="7133.75,-775.28 7130.25,-765.28 7126.75,-775.28 7133.75,-775.28"/>
</g>
<!-- l3_v_proj_3 -->
<g id="node320" class="node">
<title>l3_v_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="6591.5,-765 5968.5,-765 5968.5,-729 6591.5,-729 6591.5,-765"/>
<text text-anchor="middle" x="6280" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_3 -->
<g id="edge448" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_3</title>
<path fill="none" stroke="black" d="M12029.61,-820C10760.72,-820 6314.75,-820 6314.75,-820 6314.75,-820 6314.75,-775.04 6314.75,-775.04"/>
<polygon fill="black" stroke="black" points="6318.25,-775.04 6314.75,-765.04 6311.25,-775.04 6318.25,-775.04"/>
</g>
<!-- l3_res_3 -->
<g id="node323" class="node">
<title>l3_res_3</title>
<polygon fill="lightgray" stroke="black" points="11327,-549 10815.7,-531 11327,-513 11838.3,-531 11327,-549"/>
<text text-anchor="middle" x="11327" y="-528.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_res_3 -->
<g id="edge454" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_res_3</title>
<path fill="none" stroke="black" d="M12360.29,-801.79C12360.29,-741.91 12360.29,-555 12360.29,-555 12360.29,-555 11722.83,-555 11722.83,-555 11722.83,-555 11722.83,-545.18 11722.83,-545.18"/>
<polygon fill="black" stroke="black" points="11726.33,-545.18 11722.83,-535.18 11719.33,-545.18 11726.33,-545.18"/>
</g>
<!-- l3_q_proj_4 -->
<g id="node329" class="node">
<title>l3_q_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="11719.5,-765 11096.5,-765 11096.5,-729 11719.5,-729 11719.5,-765"/>
<text text-anchor="middle" x="11408" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_4 -->
<g id="edge461" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_4</title>
<path fill="none" stroke="black" d="M11948.44,-803C11808.2,-803 11686.5,-803 11686.5,-803 11686.5,-803 11686.5,-775.03 11686.5,-775.03"/>
<polygon fill="black" stroke="black" points="11690,-775.03 11686.5,-765.03 11683,-775.03 11690,-775.03"/>
</g>
<!-- l3_k_proj_4 -->
<g id="node330" class="node">
<title>l3_k_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="11078.5,-765 10455.5,-765 10455.5,-729 11078.5,-729 11078.5,-765"/>
<text text-anchor="middle" x="10767" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_4 -->
<g id="edge462" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_4</title>
<path fill="none" stroke="black" d="M11957.89,-805C11532.34,-805 10925,-805 10925,-805 10925,-805 10925,-775.03 10925,-775.03"/>
<polygon fill="black" stroke="black" points="10928.5,-775.03 10925,-765.03 10921.5,-775.03 10928.5,-775.03"/>
</g>
<!-- l3_v_proj_4 -->
<g id="node331" class="node">
<title>l3_v_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="10437.5,-765 9814.5,-765 9814.5,-729 10437.5,-729 10437.5,-765"/>
<text text-anchor="middle" x="10126" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_4 -->
<g id="edge463" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_4</title>
<path fill="none" stroke="black" d="M11976.99,-809C11352.19,-809 10190.5,-809 10190.5,-809 10190.5,-809 10190.5,-775.27 10190.5,-775.27"/>
<polygon fill="black" stroke="black" points="10194,-775.27 10190.5,-765.27 10187,-775.27 10194,-775.27"/>
</g>
<!-- l3_res_4 -->
<g id="node334" class="node">
<title>l3_res_4</title>
<polygon fill="lightgray" stroke="black" points="13516,-549 13004.7,-531 13516,-513 14027.3,-531 13516,-549"/>
<text text-anchor="middle" x="13516" y="-528.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_res_4 -->
<g id="edge469" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_res_4</title>
<path fill="none" stroke="black" d="M12365.57,-801.78C12365.57,-754.23 12365.57,-630 12365.57,-630 12365.57,-630 13074.95,-630 13074.95,-630 13074.95,-630 13074.95,-543.86 13074.95,-543.86"/>
<polygon fill="black" stroke="black" points="13078.45,-543.86 13074.95,-533.86 13071.45,-543.86 13078.45,-543.86"/>
</g>
<!-- l3_q_proj_5 -->
<g id="node340" class="node">
<title>l3_q_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="2762.5,-765 2139.5,-765 2139.5,-729 2762.5,-729 2762.5,-765"/>
<text text-anchor="middle" x="2451" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_5 -->
<g id="edge476" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_5</title>
<path fill="none" stroke="black" d="M12077.27,-830C10454.42,-830 2493.75,-830 2493.75,-830 2493.75,-830 2493.75,-775.01 2493.75,-775.01"/>
<polygon fill="black" stroke="black" points="2497.25,-775.01 2493.75,-765.01 2490.25,-775.01 2497.25,-775.01"/>
</g>
<!-- l3_k_proj_5 -->
<g id="node341" class="node">
<title>l3_k_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="4044.5,-765 3421.5,-765 3421.5,-729 4044.5,-729 4044.5,-765"/>
<text text-anchor="middle" x="3733" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_5 -->
<g id="edge477" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_5</title>
<path fill="none" stroke="black" d="M12063.19,-827C10561.39,-827 3947,-827 3947,-827 3947,-827 3947,-775.15 3947,-775.15"/>
<polygon fill="black" stroke="black" points="3950.5,-775.15 3947,-765.15 3943.5,-775.15 3950.5,-775.15"/>
</g>
<!-- l3_v_proj_5 -->
<g id="node342" class="node">
<title>l3_v_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="3403.5,-765 2780.5,-765 2780.5,-729 3403.5,-729 3403.5,-765"/>
<text text-anchor="middle" x="3092" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_5 -->
<g id="edge478" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_5</title>
<path fill="none" stroke="black" d="M12072.55,-829C10512.1,-829 3215.75,-829 3215.75,-829 3215.75,-829 3215.75,-775.2 3215.75,-775.2"/>
<polygon fill="black" stroke="black" points="3219.25,-775.2 3215.75,-765.2 3212.25,-775.2 3219.25,-775.2"/>
</g>
<!-- l3_res_5 -->
<g id="node345" class="node">
<title>l3_res_5</title>
<polygon fill="lightgray" stroke="black" points="9229,-549 8717.7,-531 9229,-513 9740.3,-531 9229,-549"/>
<text text-anchor="middle" x="9229" y="-528.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_res_5 -->
<g id="edge484" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_res_5</title>
<path fill="none" stroke="black" d="M12357.64,-801.89C12357.64,-745.84 12357.64,-579 12357.64,-579 12357.64,-579 9527.83,-579 9527.83,-579 9527.83,-579 9527.83,-548.5 9527.83,-548.5"/>
<polygon fill="black" stroke="black" points="9531.33,-548.5 9527.83,-538.5 9524.33,-548.5 9531.33,-548.5"/>
</g>
<!-- l3_q_proj_6 -->
<g id="node351" class="node">
<title>l3_q_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="17471.5,-765 16848.5,-765 16848.5,-729 17471.5,-729 17471.5,-765"/>
<text text-anchor="middle" x="17160" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_6 -->
<g id="edge491" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_6</title>
<path fill="none" stroke="black" d="M12727.09,-826C13833,-826 17084.85,-826 17084.85,-826 17084.85,-826 17084.85,-775.32 17084.85,-775.32"/>
<polygon fill="black" stroke="black" points="17088.35,-775.32 17084.85,-765.32 17081.35,-775.32 17088.35,-775.32"/>
</g>
<!-- l3_k_proj_6 -->
<g id="node352" class="node">
<title>l3_k_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="16830.5,-765 16207.5,-765 16207.5,-729 16830.5,-729 16830.5,-765"/>
<text text-anchor="middle" x="16519" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_6 -->
<g id="edge492" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_6</title>
<path fill="none" stroke="black" d="M12712.64,-823C13687.65,-823 16371.57,-823 16371.57,-823 16371.57,-823 16371.57,-775.01 16371.57,-775.01"/>
<polygon fill="black" stroke="black" points="16375.07,-775.01 16371.57,-765.01 16368.07,-775.01 16375.07,-775.01"/>
</g>
<!-- l3_v_proj_6 -->
<g id="node353" class="node">
<title>l3_v_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="16189.5,-765 15566.5,-765 15566.5,-729 16189.5,-729 16189.5,-765"/>
<text text-anchor="middle" x="15878" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_6 -->
<g id="edge493" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_6</title>
<path fill="none" stroke="black" d="M12698.25,-820C13560.5,-820 15793,-820 15793,-820 15793,-820 15793,-775.04 15793,-775.04"/>
<polygon fill="black" stroke="black" points="15796.5,-775.04 15793,-765.04 15789.5,-775.04 15796.5,-775.04"/>
</g>
<!-- l3_res_6 -->
<g id="node356" class="node">
<title>l3_res_6</title>
<polygon fill="lightgray" stroke="black" points="16816,-549 16304.7,-531 16816,-513 17327.3,-531 16816,-549"/>
<text text-anchor="middle" x="16816" y="-528.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_res_6 -->
<g id="edge499" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_res_6</title>
<path fill="none" stroke="black" d="M12370.86,-801.92C12370.86,-757.76 12370.86,-648 12370.86,-648 12370.86,-648 16361.67,-648 16361.67,-648 16361.67,-648 16361.67,-543.03 16361.67,-543.03"/>
<polygon fill="black" stroke="black" points="16365.17,-543.03 16361.67,-533.03 16358.17,-543.03 16365.17,-543.03"/>
</g>
<!-- l3_q_proj_7 -->
<g id="node362" class="node">
<title>l3_q_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="15548.5,-765 14925.5,-765 14925.5,-729 15548.5,-729 15548.5,-765"/>
<text text-anchor="middle" x="15237" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;Q Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_7 -->
<g id="edge506" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_q_proj_7</title>
<path fill="none" stroke="black" d="M12684.05,-817C13378.87,-817 14963.5,-817 14963.5,-817 14963.5,-817 14963.5,-775.03 14963.5,-775.03"/>
<polygon fill="black" stroke="black" points="14967,-775.03 14963.5,-765.03 14960,-775.03 14967,-775.03"/>
</g>
<!-- l3_k_proj_7 -->
<g id="node363" class="node">
<title>l3_k_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="14907.5,-765 14284.5,-765 14284.5,-729 14907.5,-729 14907.5,-765"/>
<text text-anchor="middle" x="14596" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;K Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_k=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_7 -->
<g id="edge507" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_k_proj_7</title>
<path fill="none" stroke="black" d="M12669.69,-814C13225.89,-814 14346.5,-814 14346.5,-814 14346.5,-814 14346.5,-775.31 14346.5,-775.31"/>
<polygon fill="black" stroke="black" points="14350,-775.31 14346.5,-765.31 14343,-775.31 14350,-775.31"/>
</g>
<!-- l3_v_proj_7 -->
<g id="node364" class="node">
<title>l3_v_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="14266.5,-765 13643.5,-765 13643.5,-729 14266.5,-729 14266.5,-765"/>
<text text-anchor="middle" x="13955" y="-744.5" font-family="Arial" font-size="10.00">&lt;b&gt;V Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_7 -->
<g id="edge508" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_v_proj_7</title>
<path fill="none" stroke="black" d="M12640.9,-808C13065.04,-808 13827,-808 13827,-808 13827,-808 13827,-775.3 13827,-775.3"/>
<polygon fill="black" stroke="black" points="13830.5,-775.3 13827,-765.3 13823.5,-775.3 13830.5,-775.3"/>
</g>
<!-- l3_res_7 -->
<g id="node367" class="node">
<title>l3_res_7</title>
<polygon fill="lightgray" stroke="black" points="15773,-549 15261.7,-531 15773,-513 16284.3,-531 15773,-549"/>
<text text-anchor="middle" x="15773" y="-528.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- comm_stage0_to_stage1_2&#45;&gt;l3_res_7 -->
<g id="edge514" class="edge">
<title>comm_stage0_to_stage1_2&#45;&gt;l3_res_7</title>
<path fill="none" stroke="black" d="M12368.21,-801.98C12368.21,-756.2 12368.21,-639 12368.21,-639 12368.21,-639 15273,-639 15273,-639 15273,-639 15273,-541.69 15273,-541.69"/>
<polygon fill="black" stroke="black" points="15276.5,-541.69 15273,-531.69 15269.5,-541.69 15276.5,-541.69"/>
</g>
<!-- l3_attn_0 -->
<g id="node288" class="node">
<title>l3_attn_0</title>
<polygon fill="lightgreen" stroke="black" points="13345,-693 12655,-693 12655,-657 13345,-657 13345,-693"/>
<text text-anchor="middle" x="13000" y="-672.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l3_q_proj_0&#45;&gt;l3_attn_0 -->
<g id="edge404" class="edge">
<title>l3_q_proj_0&#45;&gt;l3_attn_0</title>
<path fill="none" stroke="black" d="M12303.75,-728.97C12303.75,-709.42 12303.75,-681 12303.75,-681 12303.75,-681 12644.93,-681 12644.93,-681"/>
<polygon fill="black" stroke="black" points="12644.93,-684.5 12654.93,-681 12644.93,-677.5 12644.93,-684.5"/>
</g>
<!-- l3_k_proj_0&#45;&gt;l3_attn_0 -->
<g id="edge405" class="edge">
<title>l3_k_proj_0&#45;&gt;l3_attn_0</title>
<path fill="none" stroke="black" d="M13176.75,-728.83C13176.75,-728.83 13176.75,-703.41 13176.75,-703.41"/>
<polygon fill="black" stroke="black" points="13180.25,-703.41 13176.75,-693.41 13173.25,-703.41 13180.25,-703.41"/>
</g>
<!-- l3_v_proj_0&#45;&gt;l3_attn_0 -->
<g id="edge406" class="edge">
<title>l3_v_proj_0&#45;&gt;l3_attn_0</title>
<path fill="none" stroke="black" d="M12822.75,-728.83C12822.75,-728.83 12822.75,-703.41 12822.75,-703.41"/>
<polygon fill="black" stroke="black" points="12826.25,-703.41 12822.75,-693.41 12819.25,-703.41 12826.25,-703.41"/>
</g>
<!-- l3_out_proj_0 -->
<g id="node289" class="node">
<title>l3_out_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="13750,-621 13110,-621 13110,-585 13750,-585 13750,-621"/>
<text text-anchor="middle" x="13430" y="-600.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_attn_0&#45;&gt;l3_out_proj_0 -->
<g id="edge407" class="edge">
<title>l3_attn_0&#45;&gt;l3_out_proj_0</title>
<path fill="none" stroke="black" d="M13227.5,-656.83C13227.5,-656.83 13227.5,-631.41 13227.5,-631.41"/>
<polygon fill="black" stroke="black" points="13231,-631.41 13227.5,-621.41 13224,-631.41 13231,-631.41"/>
</g>
<!-- l3_out_proj_0&#45;&gt;l3_res_0 -->
<g id="edge408" class="edge">
<title>l3_out_proj_0&#45;&gt;l3_res_0</title>
<path fill="none" stroke="black" d="M13750.12,-609C13974.1,-609 14233.4,-609 14233.4,-609 14233.4,-609 14233.4,-541.88 14233.4,-541.88"/>
<polygon fill="black" stroke="black" points="14236.9,-541.88 14233.4,-531.88 14229.9,-541.88 14236.9,-541.88"/>
</g>
<!-- l3_ln1_0 -->
<g id="node291" class="node">
<title>l3_ln1_0</title>
<polygon fill="lightgreen" stroke="black" points="15019.5,-477 14426.5,-477 14426.5,-441 15019.5,-441 15019.5,-477"/>
<text text-anchor="middle" x="14723" y="-456.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res_0&#45;&gt;l3_ln1_0 -->
<g id="edge410" class="edge">
<title>l3_res_0&#45;&gt;l3_ln1_0</title>
<path fill="none" stroke="black" d="M14723,-512.83C14723,-512.83 14723,-487.41 14723,-487.41"/>
<polygon fill="black" stroke="black" points="14726.5,-487.41 14723,-477.41 14719.5,-487.41 14726.5,-487.41"/>
</g>
<!-- l3_ffn_up_0 -->
<g id="node292" class="node">
<title>l3_ffn_up_0</title>
<polygon fill="lightgreen" stroke="black" points="14783.5,-405 14160.5,-405 14160.5,-369 14783.5,-369 14783.5,-405"/>
<text text-anchor="middle" x="14472" y="-384.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ln1_0&#45;&gt;l3_ffn_up_0 -->
<g id="edge411" class="edge">
<title>l3_ln1_0&#45;&gt;l3_ffn_up_0</title>
<path fill="none" stroke="black" d="M14605,-440.83C14605,-440.83 14605,-415.41 14605,-415.41"/>
<polygon fill="black" stroke="black" points="14608.5,-415.41 14605,-405.41 14601.5,-415.41 14608.5,-415.41"/>
</g>
<!-- l3_res2_0 -->
<g id="node294" class="node">
<title>l3_res2_0</title>
<polygon fill="lightgray" stroke="black" points="14801,-261 14287.2,-243 14801,-225 15314.8,-243 14801,-261"/>
<text text-anchor="middle" x="14801" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ln1_0&#45;&gt;l3_res2_0 -->
<g id="edge414" class="edge">
<title>l3_ln1_0&#45;&gt;l3_res2_0</title>
<path fill="none" stroke="black" d="M14903.25,-440.96C14903.25,-440.96 14903.25,-267.64 14903.25,-267.64"/>
<polygon fill="black" stroke="black" points="14906.75,-267.64 14903.25,-257.64 14899.75,-267.64 14906.75,-267.64"/>
</g>
<!-- l3_ffn_down_0 -->
<g id="node293" class="node">
<title>l3_ffn_down_0</title>
<polygon fill="lightgreen" stroke="black" points="14787,-333 14151,-333 14151,-297 14787,-297 14787,-333"/>
<text text-anchor="middle" x="14469" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_0&#45;&gt;l3_ffn_down_0 -->
<g id="edge412" class="edge">
<title>l3_ffn_up_0&#45;&gt;l3_ffn_down_0</title>
<path fill="none" stroke="black" d="M14472,-368.83C14472,-368.83 14472,-343.41 14472,-343.41"/>
<polygon fill="black" stroke="black" points="14475.5,-343.41 14472,-333.41 14468.5,-343.41 14475.5,-343.41"/>
</g>
<!-- l3_ffn_down_0&#45;&gt;l3_res2_0 -->
<g id="edge413" class="edge">
<title>l3_ffn_down_0&#45;&gt;l3_res2_0</title>
<path fill="none" stroke="black" d="M14537.18,-296.83C14537.18,-296.83 14537.18,-261.96 14537.18,-261.96"/>
<polygon fill="black" stroke="black" points="14540.68,-261.96 14537.18,-251.96 14533.68,-261.96 14540.68,-261.96"/>
</g>
<!-- l3_ln2_0 -->
<g id="node295" class="node">
<title>l3_ln2_0</title>
<polygon fill="lightgreen" stroke="black" points="14555.5,-189 13962.5,-189 13962.5,-153 14555.5,-153 14555.5,-189"/>
<text text-anchor="middle" x="14259" y="-168.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res2_0&#45;&gt;l3_ln2_0 -->
<g id="edge415" class="edge">
<title>l3_res2_0&#45;&gt;l3_ln2_0</title>
<path fill="none" stroke="black" d="M14421.43,-238.28C14421.43,-238.28 14421.43,-199.31 14421.43,-199.31"/>
<polygon fill="black" stroke="black" points="14424.93,-199.31 14421.43,-189.31 14417.93,-199.31 14424.93,-199.31"/>
</g>
<!-- output_0 -->
<g id="node373" class="node">
<title>output_0</title>
<polygon fill="lightgreen" stroke="black" points="14555.5,-108 13960.5,-108 13960.5,-72 14555.5,-72 14555.5,-108"/>
<text text-anchor="middle" x="14258" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: gpu_8&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ln2_0&#45;&gt;output_0 -->
<g id="edge521" class="edge">
<title>l3_ln2_0&#45;&gt;output_0</title>
<path fill="none" stroke="black" d="M14259,-152.62C14259,-152.62 14259,-118.03 14259,-118.03"/>
<polygon fill="black" stroke="black" points="14262.5,-118.03 14259,-108.03 14255.5,-118.03 14262.5,-118.03"/>
</g>
<!-- l3_attn_1 -->
<g id="node299" class="node">
<title>l3_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="5669,-693 4979,-693 4979,-657 5669,-657 5669,-693"/>
<text text-anchor="middle" x="5324" y="-672.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l3_q_proj_1&#45;&gt;l3_attn_1 -->
<g id="edge419" class="edge">
<title>l3_q_proj_1&#45;&gt;l3_attn_1</title>
<path fill="none" stroke="black" d="M5501,-728.83C5501,-728.83 5501,-703.41 5501,-703.41"/>
<polygon fill="black" stroke="black" points="5504.5,-703.41 5501,-693.41 5497.5,-703.41 5504.5,-703.41"/>
</g>
<!-- l3_k_proj_1&#45;&gt;l3_attn_1 -->
<g id="edge420" class="edge">
<title>l3_k_proj_1&#45;&gt;l3_attn_1</title>
<path fill="none" stroke="black" d="M5146.75,-728.83C5146.75,-728.83 5146.75,-703.41 5146.75,-703.41"/>
<polygon fill="black" stroke="black" points="5150.25,-703.41 5146.75,-693.41 5143.25,-703.41 5150.25,-703.41"/>
</g>
<!-- l3_v_proj_1&#45;&gt;l3_attn_1 -->
<g id="edge421" class="edge">
<title>l3_v_proj_1&#45;&gt;l3_attn_1</title>
<path fill="none" stroke="black" d="M4596,-728.97C4596,-709.42 4596,-681 4596,-681 4596,-681 4968.92,-681 4968.92,-681"/>
<polygon fill="black" stroke="black" points="4968.92,-684.5 4978.92,-681 4968.92,-677.5 4968.92,-684.5"/>
</g>
<!-- l3_out_proj_1 -->
<g id="node300" class="node">
<title>l3_out_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="6586,-621 5946,-621 5946,-585 6586,-585 6586,-621"/>
<text text-anchor="middle" x="6266" y="-600.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_attn_1&#45;&gt;l3_out_proj_1 -->
<g id="edge422" class="edge">
<title>l3_attn_1&#45;&gt;l3_out_proj_1</title>
<path fill="none" stroke="black" d="M5669.32,-669C5818.6,-669 5959.75,-669 5959.75,-669 5959.75,-669 5959.75,-631.03 5959.75,-631.03"/>
<polygon fill="black" stroke="black" points="5963.25,-631.03 5959.75,-621.03 5956.25,-631.03 5963.25,-631.03"/>
</g>
<!-- l3_out_proj_1&#45;&gt;l3_res_1 -->
<g id="edge423" class="edge">
<title>l3_out_proj_1&#45;&gt;l3_res_1</title>
<path fill="none" stroke="black" d="M6266,-584.94C6266,-573.56 6266,-561 6266,-561 6266,-561 9832.06,-561 9832.06,-561 9832.06,-561 9832.06,-543.35 9832.06,-543.35"/>
<polygon fill="black" stroke="black" points="9835.56,-543.35 9832.06,-533.35 9828.56,-543.35 9835.56,-543.35"/>
</g>
<!-- l3_ln1_1 -->
<g id="node302" class="node">
<title>l3_ln1_1</title>
<polygon fill="lightgreen" stroke="black" points="10570.5,-477 9977.5,-477 9977.5,-441 10570.5,-441 10570.5,-477"/>
<text text-anchor="middle" x="10274" y="-456.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res_1&#45;&gt;l3_ln1_1 -->
<g id="edge425" class="edge">
<title>l3_res_1&#45;&gt;l3_ln1_1</title>
<path fill="none" stroke="black" d="M10274,-512.83C10274,-512.83 10274,-487.41 10274,-487.41"/>
<polygon fill="black" stroke="black" points="10277.5,-487.41 10274,-477.41 10270.5,-487.41 10277.5,-487.41"/>
</g>
<!-- l3_ffn_up_1 -->
<g id="node303" class="node">
<title>l3_ffn_up_1</title>
<polygon fill="lightgreen" stroke="black" points="10577.5,-405 9954.5,-405 9954.5,-369 10577.5,-369 10577.5,-405"/>
<text text-anchor="middle" x="10266" y="-384.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ln1_1&#45;&gt;l3_ffn_up_1 -->
<g id="edge426" class="edge">
<title>l3_ln1_1&#45;&gt;l3_ffn_up_1</title>
<path fill="none" stroke="black" d="M10274,-440.83C10274,-440.83 10274,-415.41 10274,-415.41"/>
<polygon fill="black" stroke="black" points="10277.5,-415.41 10274,-405.41 10270.5,-415.41 10277.5,-415.41"/>
</g>
<!-- l3_res2_1 -->
<g id="node305" class="node">
<title>l3_res2_1</title>
<polygon fill="lightgray" stroke="black" points="10595,-261 10081.2,-243 10595,-225 11108.8,-243 10595,-261"/>
<text text-anchor="middle" x="10595" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ln1_1&#45;&gt;l3_res2_1 -->
<g id="edge429" class="edge">
<title>l3_ln1_1&#45;&gt;l3_res2_1</title>
<path fill="none" stroke="black" d="M10570.72,-459C10632.91,-459 10680.08,-459 10680.08,-459 10680.08,-459 10680.08,-268.19 10680.08,-268.19"/>
<polygon fill="black" stroke="black" points="10683.58,-268.19 10680.08,-258.19 10676.58,-268.19 10683.58,-268.19"/>
</g>
<!-- l3_ffn_down_1 -->
<g id="node304" class="node">
<title>l3_ffn_down_1</title>
<polygon fill="lightgreen" stroke="black" points="10580,-333 9944,-333 9944,-297 10580,-297 10580,-333"/>
<text text-anchor="middle" x="10262" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_1&#45;&gt;l3_ffn_down_1 -->
<g id="edge427" class="edge">
<title>l3_ffn_up_1&#45;&gt;l3_ffn_down_1</title>
<path fill="none" stroke="black" d="M10266,-368.83C10266,-368.83 10266,-343.41 10266,-343.41"/>
<polygon fill="black" stroke="black" points="10269.5,-343.41 10266,-333.41 10262.5,-343.41 10269.5,-343.41"/>
</g>
<!-- l3_ffn_down_1&#45;&gt;l3_res2_1 -->
<g id="edge428" class="edge">
<title>l3_ffn_down_1&#45;&gt;l3_res2_1</title>
<path fill="none" stroke="black" d="M10330.68,-296.83C10330.68,-296.83 10330.68,-261.96 10330.68,-261.96"/>
<polygon fill="black" stroke="black" points="10334.18,-261.96 10330.68,-251.96 10327.18,-261.96 10334.18,-261.96"/>
</g>
<!-- l3_ln2_1 -->
<g id="node306" class="node">
<title>l3_ln2_1</title>
<polygon fill="lightgreen" stroke="black" points="11108.5,-189 10515.5,-189 10515.5,-153 11108.5,-153 11108.5,-189"/>
<text text-anchor="middle" x="10812" y="-168.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res2_1&#45;&gt;l3_ln2_1 -->
<g id="edge430" class="edge">
<title>l3_res2_1&#45;&gt;l3_ln2_1</title>
<path fill="none" stroke="black" d="M10812,-232.38C10812,-232.38 10812,-199.21 10812,-199.21"/>
<polygon fill="black" stroke="black" points="10815.5,-199.21 10812,-189.21 10808.5,-199.21 10815.5,-199.21"/>
</g>
<!-- output_1 -->
<g id="node374" class="node">
<title>output_1</title>
<polygon fill="lightgreen" stroke="black" points="12087.5,-108 11492.5,-108 11492.5,-72 12087.5,-72 12087.5,-108"/>
<text text-anchor="middle" x="11790" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: gpu_9&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ln2_1&#45;&gt;output_1 -->
<g id="edge523" class="edge">
<title>l3_ln2_1&#45;&gt;output_1</title>
<path fill="none" stroke="black" d="M11108.69,-171C11315.77,-171 11555.25,-171 11555.25,-171 11555.25,-171 11555.25,-118.38 11555.25,-118.38"/>
<polygon fill="black" stroke="black" points="11558.75,-118.38 11555.25,-108.38 11551.75,-118.38 11558.75,-118.38"/>
</g>
<!-- l3_attn_2 -->
<g id="node310" class="node">
<title>l3_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="9511.5,-693 8816.5,-693 8816.5,-657 9511.5,-657 9511.5,-693"/>
<text text-anchor="middle" x="9164" y="-672.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l3_q_proj_2&#45;&gt;l3_attn_2 -->
<g id="edge434" class="edge">
<title>l3_q_proj_2&#45;&gt;l3_attn_2</title>
<path fill="none" stroke="black" d="M8203,-728.83C8203,-707.5 8203,-675 8203,-675 8203,-675 8806.38,-675 8806.38,-675"/>
<polygon fill="black" stroke="black" points="8806.38,-678.5 8816.38,-675 8806.38,-671.5 8806.38,-678.5"/>
</g>
<!-- l3_k_proj_2&#45;&gt;l3_attn_2 -->
<g id="edge435" class="edge">
<title>l3_k_proj_2&#45;&gt;l3_attn_2</title>
<path fill="none" stroke="black" d="M9342.5,-728.83C9342.5,-728.83 9342.5,-703.41 9342.5,-703.41"/>
<polygon fill="black" stroke="black" points="9346,-703.41 9342.5,-693.41 9339,-703.41 9346,-703.41"/>
</g>
<!-- l3_v_proj_2&#45;&gt;l3_attn_2 -->
<g id="edge436" class="edge">
<title>l3_v_proj_2&#45;&gt;l3_attn_2</title>
<path fill="none" stroke="black" d="M8986,-728.83C8986,-728.83 8986,-703.41 8986,-703.41"/>
<polygon fill="black" stroke="black" points="8989.5,-703.41 8986,-693.41 8982.5,-703.41 8989.5,-703.41"/>
</g>
<!-- l3_out_proj_2 -->
<g id="node311" class="node">
<title>l3_out_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="11253.5,-621 10608.5,-621 10608.5,-585 11253.5,-585 11253.5,-621"/>
<text text-anchor="middle" x="10931" y="-600.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_attn_2&#45;&gt;l3_out_proj_2 -->
<g id="edge437" class="edge">
<title>l3_attn_2&#45;&gt;l3_out_proj_2</title>
<path fill="none" stroke="black" d="M9511.96,-669C9958.02,-669 10674.5,-669 10674.5,-669 10674.5,-669 10674.5,-631.03 10674.5,-631.03"/>
<polygon fill="black" stroke="black" points="10678,-631.03 10674.5,-621.03 10671,-631.03 10678,-631.03"/>
</g>
<!-- l3_out_proj_2&#45;&gt;l3_res_2 -->
<g id="edge438" class="edge">
<title>l3_out_proj_2&#45;&gt;l3_res_2</title>
<path fill="none" stroke="black" d="M11107.62,-584.86C11107.62,-578.54 11107.62,-573 11107.62,-573 11107.62,-573 12059.67,-573 12059.67,-573 12059.67,-573 12059.67,-547.94 12059.67,-547.94"/>
<polygon fill="black" stroke="black" points="12063.17,-547.94 12059.67,-537.94 12056.17,-547.94 12063.17,-547.94"/>
</g>
<!-- l3_ln1_2 -->
<g id="node313" class="node">
<title>l3_ln1_2</title>
<polygon fill="lightgreen" stroke="black" points="12677,-477 12079,-477 12079,-441 12677,-441 12677,-477"/>
<text text-anchor="middle" x="12378" y="-456.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res_2&#45;&gt;l3_ln1_2 -->
<g id="edge440" class="edge">
<title>l3_res_2&#45;&gt;l3_ln1_2</title>
<path fill="none" stroke="black" d="M12378,-512.83C12378,-512.83 12378,-487.41 12378,-487.41"/>
<polygon fill="black" stroke="black" points="12381.5,-487.41 12378,-477.41 12374.5,-487.41 12381.5,-487.41"/>
</g>
<!-- l3_ffn_up_2 -->
<g id="node314" class="node">
<title>l3_ffn_up_2</title>
<polygon fill="lightgreen" stroke="black" points="12682.5,-405 12053.5,-405 12053.5,-369 12682.5,-369 12682.5,-405"/>
<text text-anchor="middle" x="12368" y="-384.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ln1_2&#45;&gt;l3_ffn_up_2 -->
<g id="edge441" class="edge">
<title>l3_ln1_2&#45;&gt;l3_ffn_up_2</title>
<path fill="none" stroke="black" d="M12378,-440.83C12378,-440.83 12378,-415.41 12378,-415.41"/>
<polygon fill="black" stroke="black" points="12381.5,-415.41 12378,-405.41 12374.5,-415.41 12381.5,-415.41"/>
</g>
<!-- l3_res2_2 -->
<g id="node316" class="node">
<title>l3_res2_2</title>
<polygon fill="lightgray" stroke="black" points="12698,-261 12180.38,-243 12698,-225 13215.62,-243 12698,-261"/>
<text text-anchor="middle" x="12698" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ln1_2&#45;&gt;l3_res2_2 -->
<g id="edge444" class="edge">
<title>l3_ln1_2&#45;&gt;l3_res2_2</title>
<path fill="none" stroke="black" d="M12677.19,-459C12740.08,-459 12787.83,-459 12787.83,-459 12787.83,-459 12787.83,-268.19 12787.83,-268.19"/>
<polygon fill="black" stroke="black" points="12791.33,-268.19 12787.83,-258.19 12784.33,-268.19 12791.33,-268.19"/>
</g>
<!-- l3_ffn_down_2 -->
<g id="node315" class="node">
<title>l3_ffn_down_2</title>
<polygon fill="lightgreen" stroke="black" points="12686.5,-333 12045.5,-333 12045.5,-297 12686.5,-297 12686.5,-333"/>
<text text-anchor="middle" x="12366" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_2&#45;&gt;l3_ffn_down_2 -->
<g id="edge442" class="edge">
<title>l3_ffn_up_2&#45;&gt;l3_ffn_down_2</title>
<path fill="none" stroke="black" d="M12368,-368.83C12368,-368.83 12368,-343.41 12368,-343.41"/>
<polygon fill="black" stroke="black" points="12371.5,-343.41 12368,-333.41 12364.5,-343.41 12371.5,-343.41"/>
</g>
<!-- l3_ffn_down_2&#45;&gt;l3_res2_2 -->
<g id="edge443" class="edge">
<title>l3_ffn_down_2&#45;&gt;l3_res2_2</title>
<path fill="none" stroke="black" d="M12433.34,-296.83C12433.34,-296.83 12433.34,-261.96 12433.34,-261.96"/>
<polygon fill="black" stroke="black" points="12436.84,-261.96 12433.34,-251.96 12429.84,-261.96 12436.84,-261.96"/>
</g>
<!-- l3_ln2_2 -->
<g id="node317" class="node">
<title>l3_ln2_2</title>
<polygon fill="lightgreen" stroke="black" points="13105,-189 12507,-189 12507,-153 13105,-153 13105,-189"/>
<text text-anchor="middle" x="12806" y="-168.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res2_2&#45;&gt;l3_ln2_2 -->
<g id="edge445" class="edge">
<title>l3_res2_2&#45;&gt;l3_ln2_2</title>
<path fill="none" stroke="black" d="M12806,-228.43C12806,-228.43 12806,-199.13 12806,-199.13"/>
<polygon fill="black" stroke="black" points="12809.5,-199.13 12806,-189.13 12802.5,-199.13 12809.5,-199.13"/>
</g>
<!-- output_2 -->
<g id="node375" class="node">
<title>output_2</title>
<polygon fill="lightgreen" stroke="black" points="13324,-108 12724,-108 12724,-72 13324,-72 13324,-108"/>
<text text-anchor="middle" x="13024" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: gpu_10&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ln2_2&#45;&gt;output_2 -->
<g id="edge525" class="edge">
<title>l3_ln2_2&#45;&gt;output_2</title>
<path fill="none" stroke="black" d="M12914.5,-152.62C12914.5,-152.62 12914.5,-118.03 12914.5,-118.03"/>
<polygon fill="black" stroke="black" points="12918,-118.03 12914.5,-108.03 12911,-118.03 12918,-118.03"/>
</g>
<!-- l3_attn_3 -->
<g id="node321" class="node">
<title>l3_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="7588.5,-693 6893.5,-693 6893.5,-657 7588.5,-657 7588.5,-693"/>
<text text-anchor="middle" x="7241" y="-672.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l3_q_proj_3&#45;&gt;l3_attn_3 -->
<g id="edge449" class="edge">
<title>l3_q_proj_3&#45;&gt;l3_attn_3</title>
<path fill="none" stroke="black" d="M7419.5,-728.83C7419.5,-728.83 7419.5,-703.41 7419.5,-703.41"/>
<polygon fill="black" stroke="black" points="7423,-703.41 7419.5,-693.41 7416,-703.41 7423,-703.41"/>
</g>
<!-- l3_k_proj_3&#45;&gt;l3_attn_3 -->
<g id="edge450" class="edge">
<title>l3_k_proj_3&#45;&gt;l3_attn_3</title>
<path fill="none" stroke="black" d="M7063,-728.83C7063,-728.83 7063,-703.41 7063,-703.41"/>
<polygon fill="black" stroke="black" points="7066.5,-703.41 7063,-693.41 7059.5,-703.41 7066.5,-703.41"/>
</g>
<!-- l3_v_proj_3&#45;&gt;l3_attn_3 -->
<g id="edge451" class="edge">
<title>l3_v_proj_3&#45;&gt;l3_attn_3</title>
<path fill="none" stroke="black" d="M6277.25,-728.97C6277.25,-709.42 6277.25,-681 6277.25,-681 6277.25,-681 6883.4,-681 6883.4,-681"/>
<polygon fill="black" stroke="black" points="6883.4,-684.5 6893.4,-681 6883.4,-677.5 6883.4,-684.5"/>
</g>
<!-- l3_out_proj_3 -->
<g id="node322" class="node">
<title>l3_out_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="9960.5,-621 9315.5,-621 9315.5,-585 9960.5,-585 9960.5,-621"/>
<text text-anchor="middle" x="9638" y="-600.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_attn_3&#45;&gt;l3_out_proj_3 -->
<g id="edge452" class="edge">
<title>l3_attn_3&#45;&gt;l3_out_proj_3</title>
<path fill="none" stroke="black" d="M7241,-656.83C7241,-635.5 7241,-603 7241,-603 7241,-603 9305.35,-603 9305.35,-603"/>
<polygon fill="black" stroke="black" points="9305.35,-606.5 9315.35,-603 9305.35,-599.5 9305.35,-606.5"/>
</g>
<!-- l3_out_proj_3&#45;&gt;l3_res_3 -->
<g id="edge453" class="edge">
<title>l3_out_proj_3&#45;&gt;l3_res_3</title>
<path fill="none" stroke="black" d="M9896.28,-584.58C9896.28,-575.72 9896.28,-567 9896.28,-567 9896.28,-567 10961.73,-567 10961.73,-567 10961.73,-567 10961.73,-546.31 10961.73,-546.31"/>
<polygon fill="black" stroke="black" points="10965.23,-546.31 10961.73,-536.31 10958.23,-546.31 10965.23,-546.31"/>
</g>
<!-- l3_ln1_3 -->
<g id="node324" class="node">
<title>l3_ln1_3</title>
<polygon fill="lightgreen" stroke="black" points="11626,-477 11028,-477 11028,-441 11626,-441 11626,-477"/>
<text text-anchor="middle" x="11327" y="-456.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res_3&#45;&gt;l3_ln1_3 -->
<g id="edge455" class="edge">
<title>l3_res_3&#45;&gt;l3_ln1_3</title>
<path fill="none" stroke="black" d="M11327,-512.83C11327,-512.83 11327,-487.41 11327,-487.41"/>
<polygon fill="black" stroke="black" points="11330.5,-487.41 11327,-477.41 11323.5,-487.41 11330.5,-487.41"/>
</g>
<!-- l3_ffn_up_3 -->
<g id="node325" class="node">
<title>l3_ffn_up_3</title>
<polygon fill="lightgreen" stroke="black" points="11631.5,-405 11002.5,-405 11002.5,-369 11631.5,-369 11631.5,-405"/>
<text text-anchor="middle" x="11317" y="-384.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ln1_3&#45;&gt;l3_ffn_up_3 -->
<g id="edge456" class="edge">
<title>l3_ln1_3&#45;&gt;l3_ffn_up_3</title>
<path fill="none" stroke="black" d="M11327,-440.83C11327,-440.83 11327,-415.41 11327,-415.41"/>
<polygon fill="black" stroke="black" points="11330.5,-415.41 11327,-405.41 11323.5,-415.41 11330.5,-415.41"/>
</g>
<!-- l3_res2_3 -->
<g id="node327" class="node">
<title>l3_res2_3</title>
<polygon fill="lightgray" stroke="black" points="11644,-261 11126.38,-243 11644,-225 12161.62,-243 11644,-261"/>
<text text-anchor="middle" x="11644" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ln1_3&#45;&gt;l3_res2_3 -->
<g id="edge459" class="edge">
<title>l3_ln1_3&#45;&gt;l3_res2_3</title>
<path fill="none" stroke="black" d="M11626.19,-459C11689.08,-459 11736.83,-459 11736.83,-459 11736.83,-459 11736.83,-267.85 11736.83,-267.85"/>
<polygon fill="black" stroke="black" points="11740.33,-267.85 11736.83,-257.85 11733.33,-267.85 11740.33,-267.85"/>
</g>
<!-- l3_ffn_down_3 -->
<g id="node326" class="node">
<title>l3_ffn_down_3</title>
<polygon fill="lightgreen" stroke="black" points="11635.5,-333 10994.5,-333 10994.5,-297 11635.5,-297 11635.5,-333"/>
<text text-anchor="middle" x="11315" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_3&#45;&gt;l3_ffn_down_3 -->
<g id="edge457" class="edge">
<title>l3_ffn_up_3&#45;&gt;l3_ffn_down_3</title>
<path fill="none" stroke="black" d="M11317,-368.83C11317,-368.83 11317,-343.41 11317,-343.41"/>
<polygon fill="black" stroke="black" points="11320.5,-343.41 11317,-333.41 11313.5,-343.41 11320.5,-343.41"/>
</g>
<!-- l3_ffn_down_3&#45;&gt;l3_res2_3 -->
<g id="edge458" class="edge">
<title>l3_ffn_down_3&#45;&gt;l3_res2_3</title>
<path fill="none" stroke="black" d="M11380.84,-296.83C11380.84,-296.83 11380.84,-261.96 11380.84,-261.96"/>
<polygon fill="black" stroke="black" points="11384.34,-261.96 11380.84,-251.96 11377.34,-261.96 11384.34,-261.96"/>
</g>
<!-- l3_ln2_3 -->
<g id="node328" class="node">
<title>l3_ln2_3</title>
<polygon fill="lightgreen" stroke="black" points="12216,-189 11618,-189 11618,-153 12216,-153 12216,-189"/>
<text text-anchor="middle" x="11917" y="-168.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res2_3&#45;&gt;l3_ln2_3 -->
<g id="edge460" class="edge">
<title>l3_res2_3&#45;&gt;l3_ln2_3</title>
<path fill="none" stroke="black" d="M11889.91,-233.29C11889.91,-233.29 11889.91,-199.12 11889.91,-199.12"/>
<polygon fill="black" stroke="black" points="11893.41,-199.12 11889.91,-189.12 11886.41,-199.12 11893.41,-199.12"/>
</g>
<!-- output_3 -->
<g id="node376" class="node">
<title>output_3</title>
<polygon fill="lightgreen" stroke="black" points="12706,-108 12106,-108 12106,-72 12706,-72 12706,-108"/>
<text text-anchor="middle" x="12406" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: gpu_11&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ln2_3&#45;&gt;output_3 -->
<g id="edge527" class="edge">
<title>l3_ln2_3&#45;&gt;output_3</title>
<path fill="none" stroke="black" d="M12161,-152.62C12161,-152.62 12161,-118.03 12161,-118.03"/>
<polygon fill="black" stroke="black" points="12164.5,-118.03 12161,-108.03 12157.5,-118.03 12164.5,-118.03"/>
</g>
<!-- l3_attn_4 -->
<g id="node332" class="node">
<title>l3_attn_4</title>
<polygon fill="lightgreen" stroke="black" points="11435.5,-693 10740.5,-693 10740.5,-657 11435.5,-657 11435.5,-693"/>
<text text-anchor="middle" x="11088" y="-672.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l3_q_proj_4&#45;&gt;l3_attn_4 -->
<g id="edge464" class="edge">
<title>l3_q_proj_4&#45;&gt;l3_attn_4</title>
<path fill="none" stroke="black" d="M11266,-728.83C11266,-728.83 11266,-703.41 11266,-703.41"/>
<polygon fill="black" stroke="black" points="11269.5,-703.41 11266,-693.41 11262.5,-703.41 11269.5,-703.41"/>
</g>
<!-- l3_k_proj_4&#45;&gt;l3_attn_4 -->
<g id="edge465" class="edge">
<title>l3_k_proj_4&#45;&gt;l3_attn_4</title>
<path fill="none" stroke="black" d="M10909.5,-728.83C10909.5,-728.83 10909.5,-703.41 10909.5,-703.41"/>
<polygon fill="black" stroke="black" points="10913,-703.41 10909.5,-693.41 10906,-703.41 10913,-703.41"/>
</g>
<!-- l3_v_proj_4&#45;&gt;l3_attn_4 -->
<g id="edge466" class="edge">
<title>l3_v_proj_4&#45;&gt;l3_attn_4</title>
<path fill="none" stroke="black" d="M10199,-728.97C10199,-709.42 10199,-681 10199,-681 10199,-681 10730.47,-681 10730.47,-681"/>
<polygon fill="black" stroke="black" points="10730.47,-684.5 10740.47,-681 10730.47,-677.5 10730.47,-684.5"/>
</g>
<!-- l3_out_proj_4 -->
<g id="node333" class="node">
<title>l3_out_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="12252.5,-621 11607.5,-621 11607.5,-585 12252.5,-585 12252.5,-621"/>
<text text-anchor="middle" x="11930" y="-600.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_attn_4&#45;&gt;l3_out_proj_4 -->
<g id="edge467" class="edge">
<title>l3_attn_4&#45;&gt;l3_out_proj_4</title>
<path fill="none" stroke="black" d="M11435.63,-669C11557,-669 11663.5,-669 11663.5,-669 11663.5,-669 11663.5,-631.03 11663.5,-631.03"/>
<polygon fill="black" stroke="black" points="11667,-631.03 11663.5,-621.03 11660,-631.03 11667,-631.03"/>
</g>
<!-- l3_out_proj_4&#45;&gt;l3_res_4 -->
<g id="edge468" class="edge">
<title>l3_out_proj_4&#45;&gt;l3_res_4</title>
<path fill="none" stroke="black" d="M12252.52,-603C12580.22,-603 13039.9,-603 13039.9,-603 13039.9,-603 13039.9,-542.25 13039.9,-542.25"/>
<polygon fill="black" stroke="black" points="13043.4,-542.25 13039.9,-532.25 13036.4,-542.25 13043.4,-542.25"/>
</g>
<!-- l3_ln1_4 -->
<g id="node335" class="node">
<title>l3_ln1_4</title>
<polygon fill="lightgreen" stroke="black" points="13815,-477 13217,-477 13217,-441 13815,-441 13815,-477"/>
<text text-anchor="middle" x="13516" y="-456.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res_4&#45;&gt;l3_ln1_4 -->
<g id="edge470" class="edge">
<title>l3_res_4&#45;&gt;l3_ln1_4</title>
<path fill="none" stroke="black" d="M13516,-512.83C13516,-512.83 13516,-487.41 13516,-487.41"/>
<polygon fill="black" stroke="black" points="13519.5,-487.41 13516,-477.41 13512.5,-487.41 13519.5,-487.41"/>
</g>
<!-- l3_ffn_up_4 -->
<g id="node336" class="node">
<title>l3_ffn_up_4</title>
<polygon fill="lightgreen" stroke="black" points="13742.5,-405 13113.5,-405 13113.5,-369 13742.5,-369 13742.5,-405"/>
<text text-anchor="middle" x="13428" y="-384.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ln1_4&#45;&gt;l3_ffn_up_4 -->
<g id="edge471" class="edge">
<title>l3_ln1_4&#45;&gt;l3_ffn_up_4</title>
<path fill="none" stroke="black" d="M13479.75,-440.83C13479.75,-440.83 13479.75,-415.41 13479.75,-415.41"/>
<polygon fill="black" stroke="black" points="13483.25,-415.41 13479.75,-405.41 13476.25,-415.41 13483.25,-415.41"/>
</g>
<!-- l3_res2_4 -->
<g id="node338" class="node">
<title>l3_res2_4</title>
<polygon fill="lightgray" stroke="black" points="13752,-261 13234.38,-243 13752,-225 14269.62,-243 13752,-261"/>
<text text-anchor="middle" x="13752" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ln1_4&#45;&gt;l3_res2_4 -->
<g id="edge474" class="edge">
<title>l3_ln1_4&#45;&gt;l3_res2_4</title>
<path fill="none" stroke="black" d="M13780.75,-440.96C13780.75,-440.96 13780.75,-270.24 13780.75,-270.24"/>
<polygon fill="black" stroke="black" points="13784.25,-270.24 13780.75,-260.24 13777.25,-270.24 13784.25,-270.24"/>
</g>
<!-- l3_ffn_down_4 -->
<g id="node337" class="node">
<title>l3_ffn_down_4</title>
<polygon fill="lightgreen" stroke="black" points="13746.5,-333 13105.5,-333 13105.5,-297 13746.5,-297 13746.5,-333"/>
<text text-anchor="middle" x="13426" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_4&#45;&gt;l3_ffn_down_4 -->
<g id="edge472" class="edge">
<title>l3_ffn_up_4&#45;&gt;l3_ffn_down_4</title>
<path fill="none" stroke="black" d="M13428,-368.83C13428,-368.83 13428,-343.41 13428,-343.41"/>
<polygon fill="black" stroke="black" points="13431.5,-343.41 13428,-333.41 13424.5,-343.41 13431.5,-343.41"/>
</g>
<!-- l3_ffn_down_4&#45;&gt;l3_res2_4 -->
<g id="edge473" class="edge">
<title>l3_ffn_down_4&#45;&gt;l3_res2_4</title>
<path fill="none" stroke="black" d="M13490.34,-296.83C13490.34,-296.83 13490.34,-261.96 13490.34,-261.96"/>
<polygon fill="black" stroke="black" points="13493.84,-261.96 13490.34,-251.96 13486.84,-261.96 13493.84,-261.96"/>
</g>
<!-- l3_ln2_4 -->
<g id="node339" class="node">
<title>l3_ln2_4</title>
<polygon fill="lightgreen" stroke="black" points="13942,-189 13344,-189 13344,-153 13942,-153 13942,-189"/>
<text text-anchor="middle" x="13643" y="-168.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res2_4&#45;&gt;l3_ln2_4 -->
<g id="edge475" class="edge">
<title>l3_res2_4&#45;&gt;l3_ln2_4</title>
<path fill="none" stroke="black" d="M13643,-228.78C13643,-228.78 13643,-199.03 13643,-199.03"/>
<polygon fill="black" stroke="black" points="13646.5,-199.03 13643,-189.03 13639.5,-199.03 13646.5,-199.03"/>
</g>
<!-- output_4 -->
<g id="node377" class="node">
<title>output_4</title>
<polygon fill="lightgreen" stroke="black" points="13942,-108 13342,-108 13342,-72 13942,-72 13942,-108"/>
<text text-anchor="middle" x="13642" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: gpu_12&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ln2_4&#45;&gt;output_4 -->
<g id="edge529" class="edge">
<title>l3_ln2_4&#45;&gt;output_4</title>
<path fill="none" stroke="black" d="M13643,-152.62C13643,-152.62 13643,-118.03 13643,-118.03"/>
<polygon fill="black" stroke="black" points="13646.5,-118.03 13643,-108.03 13639.5,-118.03 13646.5,-118.03"/>
</g>
<!-- l3_attn_5 -->
<g id="node343" class="node">
<title>l3_attn_5</title>
<polygon fill="lightgreen" stroke="black" points="3760.5,-693 3065.5,-693 3065.5,-657 3760.5,-657 3760.5,-693"/>
<text text-anchor="middle" x="3413" y="-672.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l3_q_proj_5&#45;&gt;l3_attn_5 -->
<g id="edge479" class="edge">
<title>l3_q_proj_5&#45;&gt;l3_attn_5</title>
<path fill="none" stroke="black" d="M2451,-728.83C2451,-707.5 2451,-675 2451,-675 2451,-675 3055.36,-675 3055.36,-675"/>
<polygon fill="black" stroke="black" points="3055.36,-678.5 3065.36,-675 3055.36,-671.5 3055.36,-678.5"/>
</g>
<!-- l3_k_proj_5&#45;&gt;l3_attn_5 -->
<g id="edge480" class="edge">
<title>l3_k_proj_5&#45;&gt;l3_attn_5</title>
<path fill="none" stroke="black" d="M3591,-728.83C3591,-728.83 3591,-703.41 3591,-703.41"/>
<polygon fill="black" stroke="black" points="3594.5,-703.41 3591,-693.41 3587.5,-703.41 3594.5,-703.41"/>
</g>
<!-- l3_v_proj_5&#45;&gt;l3_attn_5 -->
<g id="edge481" class="edge">
<title>l3_v_proj_5&#45;&gt;l3_attn_5</title>
<path fill="none" stroke="black" d="M3234.5,-728.83C3234.5,-728.83 3234.5,-703.41 3234.5,-703.41"/>
<polygon fill="black" stroke="black" points="3238,-703.41 3234.5,-693.41 3231,-703.41 3238,-703.41"/>
</g>
<!-- l3_out_proj_5 -->
<g id="node344" class="node">
<title>l3_out_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="4512.5,-621 3867.5,-621 3867.5,-585 4512.5,-585 4512.5,-621"/>
<text text-anchor="middle" x="4190" y="-600.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_attn_5&#45;&gt;l3_out_proj_5 -->
<g id="edge482" class="edge">
<title>l3_attn_5&#45;&gt;l3_out_proj_5</title>
<path fill="none" stroke="black" d="M3760.73,-669C3866.81,-669 3956,-669 3956,-669 3956,-669 3956,-631.03 3956,-631.03"/>
<polygon fill="black" stroke="black" points="3959.5,-631.03 3956,-621.03 3952.5,-631.03 3959.5,-631.03"/>
</g>
<!-- l3_out_proj_5&#45;&gt;l3_res_5 -->
<g id="edge483" class="edge">
<title>l3_out_proj_5&#45;&gt;l3_res_5</title>
<path fill="none" stroke="black" d="M4190,-584.83C4190,-563.5 4190,-531 4190,-531 4190,-531 8707.81,-531 8707.81,-531"/>
<polygon fill="black" stroke="black" points="8707.81,-534.5 8717.81,-531 8707.81,-527.5 8707.81,-534.5"/>
</g>
<!-- l3_ln1_5 -->
<g id="node346" class="node">
<title>l3_ln1_5</title>
<polygon fill="lightgreen" stroke="black" points="9528,-477 8930,-477 8930,-441 9528,-441 9528,-477"/>
<text text-anchor="middle" x="9229" y="-456.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res_5&#45;&gt;l3_ln1_5 -->
<g id="edge485" class="edge">
<title>l3_res_5&#45;&gt;l3_ln1_5</title>
<path fill="none" stroke="black" d="M9229,-512.83C9229,-512.83 9229,-487.41 9229,-487.41"/>
<polygon fill="black" stroke="black" points="9232.5,-487.41 9229,-477.41 9225.5,-487.41 9232.5,-487.41"/>
</g>
<!-- l3_ffn_up_5 -->
<g id="node347" class="node">
<title>l3_ffn_up_5</title>
<polygon fill="lightgreen" stroke="black" points="9534.5,-405 8905.5,-405 8905.5,-369 9534.5,-369 9534.5,-405"/>
<text text-anchor="middle" x="9220" y="-384.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ln1_5&#45;&gt;l3_ffn_up_5 -->
<g id="edge486" class="edge">
<title>l3_ln1_5&#45;&gt;l3_ffn_up_5</title>
<path fill="none" stroke="black" d="M9229,-440.83C9229,-440.83 9229,-415.41 9229,-415.41"/>
<polygon fill="black" stroke="black" points="9232.5,-415.41 9229,-405.41 9225.5,-415.41 9232.5,-415.41"/>
</g>
<!-- l3_res2_5 -->
<g id="node349" class="node">
<title>l3_res2_5</title>
<polygon fill="lightgray" stroke="black" points="9546,-261 9028.38,-243 9546,-225 10063.62,-243 9546,-261"/>
<text text-anchor="middle" x="9546" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ln1_5&#45;&gt;l3_res2_5 -->
<g id="edge489" class="edge">
<title>l3_ln1_5&#45;&gt;l3_res2_5</title>
<path fill="none" stroke="black" d="M9528.02,-459C9591.25,-459 9639.33,-459 9639.33,-459 9639.33,-459 9639.33,-267.85 9639.33,-267.85"/>
<polygon fill="black" stroke="black" points="9642.83,-267.85 9639.33,-257.85 9635.83,-267.85 9642.83,-267.85"/>
</g>
<!-- l3_ffn_down_5 -->
<g id="node348" class="node">
<title>l3_ffn_down_5</title>
<polygon fill="lightgreen" stroke="black" points="9538.5,-333 8897.5,-333 8897.5,-297 9538.5,-297 9538.5,-333"/>
<text text-anchor="middle" x="9218" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_5&#45;&gt;l3_ffn_down_5 -->
<g id="edge487" class="edge">
<title>l3_ffn_up_5&#45;&gt;l3_ffn_down_5</title>
<path fill="none" stroke="black" d="M9220,-368.83C9220,-368.83 9220,-343.41 9220,-343.41"/>
<polygon fill="black" stroke="black" points="9223.5,-343.41 9220,-333.41 9216.5,-343.41 9223.5,-343.41"/>
</g>
<!-- l3_ffn_down_5&#45;&gt;l3_res2_5 -->
<g id="edge488" class="edge">
<title>l3_ffn_down_5&#45;&gt;l3_res2_5</title>
<path fill="none" stroke="black" d="M9283.34,-296.83C9283.34,-296.83 9283.34,-261.96 9283.34,-261.96"/>
<polygon fill="black" stroke="black" points="9286.84,-261.96 9283.34,-251.96 9279.84,-261.96 9286.84,-261.96"/>
</g>
<!-- l3_ln2_5 -->
<g id="node350" class="node">
<title>l3_ln2_5</title>
<polygon fill="lightgreen" stroke="black" points="10171,-189 9573,-189 9573,-153 10171,-153 10171,-189"/>
<text text-anchor="middle" x="9872" y="-168.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res2_5&#45;&gt;l3_ln2_5 -->
<g id="edge490" class="edge">
<title>l3_res2_5&#45;&gt;l3_ln2_5</title>
<path fill="none" stroke="black" d="M9818.41,-234.46C9818.41,-234.46 9818.41,-199.17 9818.41,-199.17"/>
<polygon fill="black" stroke="black" points="9821.91,-199.17 9818.41,-189.17 9814.91,-199.17 9821.91,-199.17"/>
</g>
<!-- output_5 -->
<g id="node378" class="node">
<title>output_5</title>
<polygon fill="lightgreen" stroke="black" points="11474,-108 10874,-108 10874,-72 11474,-72 11474,-108"/>
<text text-anchor="middle" x="11174" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: gpu_13&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ln2_5&#45;&gt;output_5 -->
<g id="edge531" class="edge">
<title>l3_ln2_5&#45;&gt;output_5</title>
<path fill="none" stroke="black" d="M9872,-152.62C9872,-128.72 9872,-90 9872,-90 9872,-90 10863.66,-90 10863.66,-90"/>
<polygon fill="black" stroke="black" points="10863.66,-93.5 10873.66,-90 10863.66,-86.5 10863.66,-93.5"/>
</g>
<!-- l3_attn_6 -->
<g id="node354" class="node">
<title>l3_attn_6</title>
<polygon fill="lightgreen" stroke="black" points="16940.5,-693 16245.5,-693 16245.5,-657 16940.5,-657 16940.5,-693"/>
<text text-anchor="middle" x="16593" y="-672.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l3_q_proj_6&#45;&gt;l3_attn_6 -->
<g id="edge494" class="edge">
<title>l3_q_proj_6&#45;&gt;l3_attn_6</title>
<path fill="none" stroke="black" d="M16894.5,-728.83C16894.5,-728.83 16894.5,-703.41 16894.5,-703.41"/>
<polygon fill="black" stroke="black" points="16898,-703.41 16894.5,-693.41 16891,-703.41 16898,-703.41"/>
</g>
<!-- l3_k_proj_6&#45;&gt;l3_attn_6 -->
<g id="edge495" class="edge">
<title>l3_k_proj_6&#45;&gt;l3_attn_6</title>
<path fill="none" stroke="black" d="M16538,-728.83C16538,-728.83 16538,-703.41 16538,-703.41"/>
<polygon fill="black" stroke="black" points="16541.5,-703.41 16538,-693.41 16534.5,-703.41 16541.5,-703.41"/>
</g>
<!-- l3_v_proj_6&#45;&gt;l3_attn_6 -->
<g id="edge496" class="edge">
<title>l3_v_proj_6&#45;&gt;l3_attn_6</title>
<path fill="none" stroke="black" d="M16058,-728.83C16058,-707.5 16058,-675 16058,-675 16058,-675 16235.49,-675 16235.49,-675"/>
<polygon fill="black" stroke="black" points="16235.49,-678.5 16245.49,-675 16235.49,-671.5 16235.49,-678.5"/>
</g>
<!-- l3_out_proj_6 -->
<g id="node355" class="node">
<title>l3_out_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="17063.5,-621 16418.5,-621 16418.5,-585 17063.5,-585 17063.5,-621"/>
<text text-anchor="middle" x="16741" y="-600.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_attn_6&#45;&gt;l3_out_proj_6 -->
<g id="edge497" class="edge">
<title>l3_attn_6&#45;&gt;l3_out_proj_6</title>
<path fill="none" stroke="black" d="M16679.5,-656.83C16679.5,-656.83 16679.5,-631.41 16679.5,-631.41"/>
<polygon fill="black" stroke="black" points="16683,-631.41 16679.5,-621.41 16676,-631.41 16683,-631.41"/>
</g>
<!-- l3_out_proj_6&#45;&gt;l3_res_6 -->
<g id="edge498" class="edge">
<title>l3_out_proj_6&#45;&gt;l3_res_6</title>
<path fill="none" stroke="black" d="M16741,-584.83C16741,-584.83 16741,-556.48 16741,-556.48"/>
<polygon fill="black" stroke="black" points="16744.5,-556.48 16741,-546.48 16737.5,-556.48 16744.5,-556.48"/>
</g>
<!-- l3_ln1_6 -->
<g id="node357" class="node">
<title>l3_ln1_6</title>
<polygon fill="lightgreen" stroke="black" points="17115,-477 16517,-477 16517,-441 17115,-441 17115,-477"/>
<text text-anchor="middle" x="16816" y="-456.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res_6&#45;&gt;l3_ln1_6 -->
<g id="edge500" class="edge">
<title>l3_res_6&#45;&gt;l3_ln1_6</title>
<path fill="none" stroke="black" d="M16816,-512.83C16816,-512.83 16816,-487.41 16816,-487.41"/>
<polygon fill="black" stroke="black" points="16819.5,-487.41 16816,-477.41 16812.5,-487.41 16819.5,-487.41"/>
</g>
<!-- l3_ffn_up_6 -->
<g id="node358" class="node">
<title>l3_ffn_up_6</title>
<polygon fill="lightgreen" stroke="black" points="17047.5,-405 16418.5,-405 16418.5,-369 17047.5,-369 17047.5,-405"/>
<text text-anchor="middle" x="16733" y="-384.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ln1_6&#45;&gt;l3_ffn_up_6 -->
<g id="edge501" class="edge">
<title>l3_ln1_6&#45;&gt;l3_ffn_up_6</title>
<path fill="none" stroke="black" d="M16782.25,-440.83C16782.25,-440.83 16782.25,-415.41 16782.25,-415.41"/>
<polygon fill="black" stroke="black" points="16785.75,-415.41 16782.25,-405.41 16778.75,-415.41 16785.75,-415.41"/>
</g>
<!-- l3_res2_6 -->
<g id="node360" class="node">
<title>l3_res2_6</title>
<polygon fill="lightgray" stroke="black" points="16904,-261 16386.38,-243 16904,-225 17421.62,-243 16904,-261"/>
<text text-anchor="middle" x="16904" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ln1_6&#45;&gt;l3_res2_6 -->
<g id="edge504" class="edge">
<title>l3_ln1_6&#45;&gt;l3_res2_6</title>
<path fill="none" stroke="black" d="M17082.75,-440.96C17082.75,-440.96 17082.75,-264.98 17082.75,-264.98"/>
<polygon fill="black" stroke="black" points="17086.25,-264.98 17082.75,-254.98 17079.25,-264.98 17086.25,-264.98"/>
</g>
<!-- l3_ffn_down_6 -->
<g id="node359" class="node">
<title>l3_ffn_down_6</title>
<polygon fill="lightgreen" stroke="black" points="17050.5,-333 16409.5,-333 16409.5,-297 17050.5,-297 17050.5,-333"/>
<text text-anchor="middle" x="16730" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_6&#45;&gt;l3_ffn_down_6 -->
<g id="edge502" class="edge">
<title>l3_ffn_up_6&#45;&gt;l3_ffn_down_6</title>
<path fill="none" stroke="black" d="M16733,-368.83C16733,-368.83 16733,-343.41 16733,-343.41"/>
<polygon fill="black" stroke="black" points="16736.5,-343.41 16733,-333.41 16729.5,-343.41 16736.5,-343.41"/>
</g>
<!-- l3_ffn_down_6&#45;&gt;l3_res2_6 -->
<g id="edge503" class="edge">
<title>l3_ffn_down_6&#45;&gt;l3_res2_6</title>
<path fill="none" stroke="black" d="M16730,-296.83C16730,-296.83 16730,-265.28 16730,-265.28"/>
<polygon fill="black" stroke="black" points="16733.5,-265.27 16730,-255.28 16726.5,-265.28 16733.5,-265.27"/>
</g>
<!-- l3_ln2_6 -->
<g id="node361" class="node">
<title>l3_ln2_6</title>
<polygon fill="lightgreen" stroke="black" points="16332,-189 15734,-189 15734,-153 16332,-153 16332,-189"/>
<text text-anchor="middle" x="16033" y="-168.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res2_6&#45;&gt;l3_ln2_6 -->
<g id="edge505" class="edge">
<title>l3_res2_6&#45;&gt;l3_ln2_6</title>
<path fill="none" stroke="black" d="M16904,-224.83C16904,-203.5 16904,-171 16904,-171 16904,-171 16342.14,-171 16342.14,-171"/>
<polygon fill="black" stroke="black" points="16342.14,-167.5 16332.14,-171 16342.14,-174.5 16342.14,-167.5"/>
</g>
<!-- output_6 -->
<g id="node379" class="node">
<title>output_6</title>
<polygon fill="lightgreen" stroke="black" points="15792,-108 15192,-108 15192,-72 15792,-72 15792,-108"/>
<text text-anchor="middle" x="15492" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: gpu_14&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ln2_6&#45;&gt;output_6 -->
<g id="edge533" class="edge">
<title>l3_ln2_6&#45;&gt;output_6</title>
<path fill="none" stroke="black" d="M15763,-152.62C15763,-152.62 15763,-118.03 15763,-118.03"/>
<polygon fill="black" stroke="black" points="15766.5,-118.03 15763,-108.03 15759.5,-118.03 15766.5,-118.03"/>
</g>
<!-- l3_attn_7 -->
<g id="node365" class="node">
<title>l3_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="15264.5,-693 14569.5,-693 14569.5,-657 15264.5,-657 15264.5,-693"/>
<text text-anchor="middle" x="14917" y="-672.5" font-family="Arial" font-size="10.00">&lt;b&gt;Flash Attention&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: Q,K,V [batch=1024, seq=?, heads=32, d_k=16]&lt;br/&gt;Output: [batch=1024, seq=?, heads=32, d_v=16]</text>
</g>
<!-- l3_q_proj_7&#45;&gt;l3_attn_7 -->
<g id="edge509" class="edge">
<title>l3_q_proj_7&#45;&gt;l3_attn_7</title>
<path fill="none" stroke="black" d="M15095,-728.83C15095,-728.83 15095,-703.41 15095,-703.41"/>
<polygon fill="black" stroke="black" points="15098.5,-703.41 15095,-693.41 15091.5,-703.41 15098.5,-703.41"/>
</g>
<!-- l3_k_proj_7&#45;&gt;l3_attn_7 -->
<g id="edge510" class="edge">
<title>l3_k_proj_7&#45;&gt;l3_attn_7</title>
<path fill="none" stroke="black" d="M14738.5,-728.83C14738.5,-728.83 14738.5,-703.41 14738.5,-703.41"/>
<polygon fill="black" stroke="black" points="14742,-703.41 14738.5,-693.41 14735,-703.41 14742,-703.41"/>
</g>
<!-- l3_v_proj_7&#45;&gt;l3_attn_7 -->
<g id="edge511" class="edge">
<title>l3_v_proj_7&#45;&gt;l3_attn_7</title>
<path fill="none" stroke="black" d="M14249.95,-728.83C14249.95,-707.5 14249.95,-675 14249.95,-675 14249.95,-675 14559.31,-675 14559.31,-675"/>
<polygon fill="black" stroke="black" points="14559.31,-678.5 14569.31,-675 14559.31,-671.5 14559.31,-678.5"/>
</g>
<!-- l3_out_proj_7 -->
<g id="node366" class="node">
<title>l3_out_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="15926.5,-621 15281.5,-621 15281.5,-585 15926.5,-585 15926.5,-621"/>
<text text-anchor="middle" x="15604" y="-600.5" font-family="Arial" font-size="10.00">&lt;b&gt;Output Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, heads=32, d_v=16]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_attn_7&#45;&gt;l3_out_proj_7 -->
<g id="edge512" class="edge">
<title>l3_attn_7&#45;&gt;l3_out_proj_7</title>
<path fill="none" stroke="black" d="M15245.5,-656.91C15245.5,-633.87 15245.5,-597 15245.5,-597 15245.5,-597 15271.19,-597 15271.19,-597"/>
<polygon fill="black" stroke="black" points="15271.19,-600.5 15281.19,-597 15271.19,-593.5 15271.19,-600.5"/>
</g>
<!-- l3_out_proj_7&#45;&gt;l3_res_7 -->
<g id="edge513" class="edge">
<title>l3_out_proj_7&#45;&gt;l3_res_7</title>
<path fill="none" stroke="black" d="M15604,-584.83C15604,-584.83 15604,-553.28 15604,-553.28"/>
<polygon fill="black" stroke="black" points="15607.5,-553.27 15604,-543.28 15600.5,-553.28 15607.5,-553.27"/>
</g>
<!-- l3_ln1_7 -->
<g id="node368" class="node">
<title>l3_ln1_7</title>
<polygon fill="lightgreen" stroke="black" points="16072,-477 15474,-477 15474,-441 16072,-441 16072,-477"/>
<text text-anchor="middle" x="15773" y="-456.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 1&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res_7&#45;&gt;l3_ln1_7 -->
<g id="edge515" class="edge">
<title>l3_res_7&#45;&gt;l3_ln1_7</title>
<path fill="none" stroke="black" d="M15773,-512.83C15773,-512.83 15773,-487.41 15773,-487.41"/>
<polygon fill="black" stroke="black" points="15776.5,-487.41 15773,-477.41 15769.5,-487.41 15776.5,-487.41"/>
</g>
<!-- l3_ffn_up_7 -->
<g id="node369" class="node">
<title>l3_ffn_up_7</title>
<polygon fill="lightgreen" stroke="black" points="15835.5,-405 15206.5,-405 15206.5,-369 15835.5,-369 15835.5,-405"/>
<text text-anchor="middle" x="15521" y="-384.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Up Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, ffn_dim=2048]</text>
</g>
<!-- l3_ln1_7&#45;&gt;l3_ffn_up_7 -->
<g id="edge516" class="edge">
<title>l3_ln1_7&#45;&gt;l3_ffn_up_7</title>
<path fill="none" stroke="black" d="M15654.75,-440.83C15654.75,-440.83 15654.75,-415.41 15654.75,-415.41"/>
<polygon fill="black" stroke="black" points="15658.25,-415.41 15654.75,-405.41 15651.25,-415.41 15658.25,-415.41"/>
</g>
<!-- l3_res2_7 -->
<g id="node371" class="node">
<title>l3_res2_7</title>
<polygon fill="lightgray" stroke="black" points="15850,-261 15332.38,-243 15850,-225 16367.62,-243 15850,-261"/>
<text text-anchor="middle" x="15850" y="-240.5" font-family="Arial" font-size="10.00">&lt;b&gt;Residual Add 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512] × 2&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ln1_7&#45;&gt;l3_res2_7 -->
<g id="edge519" class="edge">
<title>l3_ln1_7&#45;&gt;l3_res2_7</title>
<path fill="none" stroke="black" d="M15955.25,-440.96C15955.25,-440.96 15955.25,-267.37 15955.25,-267.37"/>
<polygon fill="black" stroke="black" points="15958.75,-267.37 15955.25,-257.37 15951.75,-267.37 15958.75,-267.37"/>
</g>
<!-- l3_ffn_down_7 -->
<g id="node370" class="node">
<title>l3_ffn_down_7</title>
<polygon fill="lightgreen" stroke="black" points="15838.5,-333 15197.5,-333 15197.5,-297 15838.5,-297 15838.5,-333"/>
<text text-anchor="middle" x="15518" y="-312.5" font-family="Arial" font-size="10.00">&lt;b&gt;FFN Down Projection&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, ffn_dim=2048]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_ffn_up_7&#45;&gt;l3_ffn_down_7 -->
<g id="edge517" class="edge">
<title>l3_ffn_up_7&#45;&gt;l3_ffn_down_7</title>
<path fill="none" stroke="black" d="M15521,-368.83C15521,-368.83 15521,-343.41 15521,-343.41"/>
<polygon fill="black" stroke="black" points="15524.5,-343.41 15521,-333.41 15517.5,-343.41 15524.5,-343.41"/>
</g>
<!-- l3_ffn_down_7&#45;&gt;l3_res2_7 -->
<g id="edge518" class="edge">
<title>l3_ffn_down_7&#45;&gt;l3_res2_7</title>
<path fill="none" stroke="black" d="M15585.34,-296.83C15585.34,-296.83 15585.34,-261.96 15585.34,-261.96"/>
<polygon fill="black" stroke="black" points="15588.84,-261.96 15585.34,-251.96 15581.84,-261.96 15588.84,-261.96"/>
</g>
<!-- l3_ln2_7 -->
<g id="node372" class="node">
<title>l3_ln2_7</title>
<polygon fill="lightgreen" stroke="black" points="15715,-189 15117,-189 15117,-153 15715,-153 15715,-189"/>
<text text-anchor="middle" x="15416" y="-168.5" font-family="Arial" font-size="10.00">&lt;b&gt;Layer Norm 2&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, hidden=512]</text>
</g>
<!-- l3_res2_7&#45;&gt;l3_ln2_7 -->
<g id="edge520" class="edge">
<title>l3_res2_7&#45;&gt;l3_ln2_7</title>
<path fill="none" stroke="black" d="M15523.59,-236.1C15523.59,-236.1 15523.59,-199.2 15523.59,-199.2"/>
<polygon fill="black" stroke="black" points="15527.09,-199.2 15523.59,-189.2 15520.09,-199.2 15527.09,-199.2"/>
</g>
<!-- output_7 -->
<g id="node380" class="node">
<title>output_7</title>
<polygon fill="lightgreen" stroke="black" points="15174,-108 14574,-108 14574,-72 15174,-72 15174,-108"/>
<text text-anchor="middle" x="14874" y="-87.5" font-family="Arial" font-size="10.00">&lt;b&gt;Linear Output&lt;/b&gt;&lt;br/&gt;GPU: gpu_15&lt;br/&gt;Input: [batch=1024, seq=?, hidden=512]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=4000]</text>
</g>
<!-- l3_ln2_7&#45;&gt;output_7 -->
<g id="edge535" class="edge">
<title>l3_ln2_7&#45;&gt;output_7</title>
<path fill="none" stroke="black" d="M15145.5,-152.62C15145.5,-152.62 15145.5,-118.03 15145.5,-118.03"/>
<polygon fill="black" stroke="black" points="15149,-118.03 15145.5,-108.03 15142,-118.03 15149,-118.03"/>
</g>
<!-- output -->
<g id="node381" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="13333" cy="-18" rx="309.77" ry="18"/>
<text text-anchor="middle" x="13333" y="-15.5" font-family="Arial" font-size="10.00">&lt;b&gt;Final Output&lt;/b&gt;&lt;br/&gt;Input: [batch=1024, seq=?, vocab=32000]&lt;br/&gt;Output: [batch=1024, seq=?, vocab=32000]</text>
</g>
<!-- output_0&#45;&gt;output -->
<g id="edge522" class="edge">
<title>output_0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14258,-71.78C14258,-53.17 14258,-27 14258,-27 14258,-27 13611.17,-27 13611.17,-27"/>
<polygon fill="black" stroke="black" points="13611.17,-23.5 13601.17,-27 13611.17,-30.5 13611.17,-23.5"/>
</g>
<!-- output_1&#45;&gt;output -->
<g id="edge524" class="edge">
<title>output_1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11790,-71.83C11790,-50.5 11790,-18 11790,-18 11790,-18 13013.07,-18 13013.07,-18"/>
<polygon fill="black" stroke="black" points="13013.07,-21.5 13023.07,-18 13013.07,-14.5 13013.07,-21.5"/>
</g>
<!-- output_2&#45;&gt;output -->
<g id="edge526" class="edge">
<title>output_2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M13173.68,-71.83C13173.68,-71.83 13173.68,-43.48 13173.68,-43.48"/>
<polygon fill="black" stroke="black" points="13177.18,-43.48 13173.68,-33.48 13170.18,-43.48 13177.18,-43.48"/>
</g>
<!-- output_3&#45;&gt;output -->
<g id="edge528" class="edge">
<title>output_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12406,-71.78C12406,-53.17 12406,-27 12406,-27 12406,-27 13054.56,-27 13054.56,-27"/>
<polygon fill="black" stroke="black" points="13054.56,-30.5 13064.56,-27 13054.56,-23.5 13054.56,-30.5"/>
</g>
<!-- output_4&#45;&gt;output -->
<g id="edge530" class="edge">
<title>output_4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M13492.32,-71.83C13492.32,-71.83 13492.32,-43.48 13492.32,-43.48"/>
<polygon fill="black" stroke="black" points="13495.82,-43.48 13492.32,-33.48 13488.82,-43.48 13495.82,-43.48"/>
</g>
<!-- output_5&#45;&gt;output -->
<g id="edge532" class="edge">
<title>output_5&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11174,-71.62C11174,-47.72 11174,-9 11174,-9 11174,-9 13054.74,-9 13054.74,-9"/>
<polygon fill="black" stroke="black" points="13054.74,-12.5 13064.74,-9 13054.74,-5.5 13054.74,-12.5"/>
</g>
<!-- output_6&#45;&gt;output -->
<g id="edge534" class="edge">
<title>output_6&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15492,-71.62C15492,-47.72 15492,-9 15492,-9 15492,-9 13611.26,-9 13611.26,-9"/>
<polygon fill="black" stroke="black" points="13611.26,-5.5 13601.26,-9 13611.26,-12.5 13611.26,-5.5"/>
</g>
<!-- output_7&#45;&gt;output -->
<g id="edge536" class="edge">
<title>output_7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14874,-71.83C14874,-50.5 14874,-18 14874,-18 14874,-18 13652.99,-18 13652.99,-18"/>
<polygon fill="black" stroke="black" points="13652.99,-14.5 13642.99,-18 13652.99,-21.5 13652.99,-14.5"/>
</g>
<!-- allreduce_0_q_proj -->
<g id="node382" class="node">
<title>allreduce_0_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="10083.41,-3154 9573.71,-3154 9442.59,-3118 9952.29,-3118 10083.41,-3154"/>
<text text-anchor="middle" x="9763" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_0_k_proj -->
<g id="node383" class="node">
<title>allreduce_0_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="10741.41,-3154 10231.71,-3154 10100.59,-3118 10610.29,-3118 10741.41,-3154"/>
<text text-anchor="middle" x="10421" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_0_v_proj -->
<g id="node384" class="node">
<title>allreduce_0_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="11399.41,-3154 10889.71,-3154 10758.59,-3118 11268.29,-3118 11399.41,-3154"/>
<text text-anchor="middle" x="11079" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_0_out_proj -->
<g id="node385" class="node">
<title>allreduce_0_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="12057.41,-3154 11547.71,-3154 11416.59,-3118 11926.29,-3118 12057.41,-3154"/>
<text text-anchor="middle" x="11737" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_0_ffn_up -->
<g id="node386" class="node">
<title>allreduce_0_ffn_up</title>
<polygon fill="lightyellow" stroke="black" points="12715.41,-3154 12205.71,-3154 12074.59,-3118 12584.29,-3118 12715.41,-3154"/>
<text text-anchor="middle" x="12395" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_0_ffn_down -->
<g id="node387" class="node">
<title>allreduce_0_ffn_down</title>
<polygon fill="lightyellow" stroke="black" points="13373.41,-3154 12863.71,-3154 12732.59,-3118 13242.29,-3118 13373.41,-3154"/>
<text text-anchor="middle" x="13053" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_1_q_proj -->
<g id="node388" class="node">
<title>allreduce_1_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="14031.41,-3154 13521.71,-3154 13390.59,-3118 13900.29,-3118 14031.41,-3154"/>
<text text-anchor="middle" x="13711" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_1_k_proj -->
<g id="node389" class="node">
<title>allreduce_1_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="14689.41,-3154 14179.71,-3154 14048.59,-3118 14558.29,-3118 14689.41,-3154"/>
<text text-anchor="middle" x="14369" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_1_v_proj -->
<g id="node390" class="node">
<title>allreduce_1_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="15347.41,-3154 14837.71,-3154 14706.59,-3118 15216.29,-3118 15347.41,-3154"/>
<text text-anchor="middle" x="15027" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_1_out_proj -->
<g id="node391" class="node">
<title>allreduce_1_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="16005.41,-3154 15495.71,-3154 15364.59,-3118 15874.29,-3118 16005.41,-3154"/>
<text text-anchor="middle" x="15685" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_1_ffn_up -->
<g id="node392" class="node">
<title>allreduce_1_ffn_up</title>
<polygon fill="lightyellow" stroke="black" points="16663.41,-3154 16153.71,-3154 16022.59,-3118 16532.29,-3118 16663.41,-3154"/>
<text text-anchor="middle" x="16343" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_1_ffn_down -->
<g id="node393" class="node">
<title>allreduce_1_ffn_down</title>
<polygon fill="lightyellow" stroke="black" points="17321.41,-3154 16811.71,-3154 16680.59,-3118 17190.29,-3118 17321.41,-3154"/>
<text text-anchor="middle" x="17001" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_2_q_proj -->
<g id="node394" class="node">
<title>allreduce_2_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="17979.41,-3154 17469.71,-3154 17338.59,-3118 17848.29,-3118 17979.41,-3154"/>
<text text-anchor="middle" x="17659" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_2_k_proj -->
<g id="node395" class="node">
<title>allreduce_2_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="18637.41,-3154 18127.71,-3154 17996.59,-3118 18506.29,-3118 18637.41,-3154"/>
<text text-anchor="middle" x="18317" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_2_v_proj -->
<g id="node396" class="node">
<title>allreduce_2_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="19295.41,-3154 18785.71,-3154 18654.59,-3118 19164.29,-3118 19295.41,-3154"/>
<text text-anchor="middle" x="18975" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_2_out_proj -->
<g id="node397" class="node">
<title>allreduce_2_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="19953.41,-3154 19443.71,-3154 19312.59,-3118 19822.29,-3118 19953.41,-3154"/>
<text text-anchor="middle" x="19633" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_2_ffn_up -->
<g id="node398" class="node">
<title>allreduce_2_ffn_up</title>
<polygon fill="lightyellow" stroke="black" points="20611.41,-3154 20101.71,-3154 19970.59,-3118 20480.29,-3118 20611.41,-3154"/>
<text text-anchor="middle" x="20291" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_2_ffn_down -->
<g id="node399" class="node">
<title>allreduce_2_ffn_down</title>
<polygon fill="lightyellow" stroke="black" points="21269.41,-3154 20759.71,-3154 20628.59,-3118 21138.29,-3118 21269.41,-3154"/>
<text text-anchor="middle" x="20949" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_3_q_proj -->
<g id="node400" class="node">
<title>allreduce_3_q_proj</title>
<polygon fill="lightyellow" stroke="black" points="21927.41,-3154 21417.71,-3154 21286.59,-3118 21796.29,-3118 21927.41,-3154"/>
<text text-anchor="middle" x="21607" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_3_k_proj -->
<g id="node401" class="node">
<title>allreduce_3_k_proj</title>
<polygon fill="lightyellow" stroke="black" points="22585.41,-3154 22075.71,-3154 21944.59,-3118 22454.29,-3118 22585.41,-3154"/>
<text text-anchor="middle" x="22265" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_3_v_proj -->
<g id="node402" class="node">
<title>allreduce_3_v_proj</title>
<polygon fill="lightyellow" stroke="black" points="23243.41,-3154 22733.71,-3154 22602.59,-3118 23112.29,-3118 23243.41,-3154"/>
<text text-anchor="middle" x="22923" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_3_out_proj -->
<g id="node403" class="node">
<title>allreduce_3_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="23901.41,-3154 23391.71,-3154 23260.59,-3118 23770.29,-3118 23901.41,-3154"/>
<text text-anchor="middle" x="23581" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_3_ffn_up -->
<g id="node404" class="node">
<title>allreduce_3_ffn_up</title>
<polygon fill="lightyellow" stroke="black" points="24559.41,-3154 24049.71,-3154 23918.59,-3118 24428.29,-3118 24559.41,-3154"/>
<text text-anchor="middle" x="24239" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
<!-- allreduce_3_ffn_down -->
<g id="node405" class="node">
<title>allreduce_3_ffn_down</title>
<polygon fill="lightyellow" stroke="black" points="25217.41,-3154 24707.71,-3154 24576.59,-3118 25086.29,-3118 25217.41,-3154"/>
<text text-anchor="middle" x="24897" y="-3133.5" font-family="Arial" font-size="10.00">&lt;b&gt;All&#45;Reduce&lt;/b&gt;&lt;br/&gt;TP across 8 GPUs&lt;br/&gt;[batch=1024, seq=?, dim=4096]</text>
</g>
</g>
</svg>
