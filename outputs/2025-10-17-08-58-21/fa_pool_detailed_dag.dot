digraph fa_pool_detailed_dag {
	graph [bb="0,0,4101.5,42418",
		rankdir=LR,
		size="50,30",
		splines=ortho
	];
	node [fillcolor=lightcoral,
		fontname=Arial,
		fontsize=9,
		label="\N",
		shape=hexagon,
		style=filled
	];
	subgraph cluster_base_components {
		graph [bb="2984,4738,3578,7019",
			fontsize=12,
			label="Base Layer (8 GPUs - Always Active)",
			lheight=0.18,
			lp="3281,7008.5",
			lwidth=3.08,
			style=rounded
		];
		subgraph cluster_base_ffn_l0 {
			graph [bb="3018.5,6541,3570,6990",
				fontsize=10,
				label="Layer 0 FFN",
				lheight=0.15,
				lp="3294.2,6980.5",
				lwidth=0.89,
				style=dashed
			];
			base_ffn_up_l0_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_0<br/>[512→2048]",
				pos="3139.5,6675",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l0_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_0<br/>[2048→512]",
				pos="3443,6675",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l0_0 -> base_ffn_down_l0_0	[pos="e,3323.8,6684 3252.5,6684 3252.5,6684 3313.8,6684 3313.8,6684"];
			base_ffn_up_l0_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_1<br/>[512→2048]",
				pos="3139.5,6729",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l0_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_1<br/>[2048→512]",
				pos="3443,6729",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l0_1 -> base_ffn_down_l0_1	[pos="e,3323.8,6738 3252.5,6738 3252.5,6738 3313.8,6738 3313.8,6738"];
			base_ffn_up_l0_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_2<br/>[512→2048]",
				pos="3139.5,6621",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l0_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_2<br/>[2048→512]",
				pos="3443,6621",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l0_2 -> base_ffn_down_l0_2	[pos="e,3323.8,6630 3252.5,6630 3252.5,6630 3313.8,6630 3313.8,6630"];
			base_ffn_up_l0_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_3<br/>[512→2048]",
				pos="3139.5,6945",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l0_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_3<br/>[2048→512]",
				pos="3443,6945",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l0_3 -> base_ffn_down_l0_3	[pos="e,3323.8,6945 3252.5,6945 3252.5,6945 3313.8,6945 3313.8,6945"];
			base_ffn_up_l0_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_4<br/>[512→2048]",
				pos="3139.5,6891",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l0_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_4<br/>[2048→512]",
				pos="3443,6891",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l0_4 -> base_ffn_down_l0_4	[pos="e,3323.8,6891 3252.5,6891 3252.5,6891 3313.8,6891 3313.8,6891"];
			base_ffn_up_l0_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_5<br/>[512→2048]",
				pos="3139.5,6783",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l0_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_5<br/>[2048→512]",
				pos="3443,6783",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l0_5 -> base_ffn_down_l0_5	[pos="e,3323.8,6792 3252.5,6792 3252.5,6792 3313.8,6792 3313.8,6792"];
			base_ffn_up_l0_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_6<br/>[512→2048]",
				pos="3139.5,6837",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l0_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_6<br/>[2048→512]",
				pos="3443,6837",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l0_6 -> base_ffn_down_l0_6	[pos="e,3323.8,6846 3252.5,6846 3252.5,6846 3313.8,6846 3313.8,6846"];
			base_ffn_up_l0_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_7<br/>[512→2048]",
				pos="3139.5,6567",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l0_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_7<br/>[2048→512]",
				pos="3443,6567",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l0_7 -> base_ffn_down_l0_7	[pos="e,3323.8,6576 3252.5,6576 3252.5,6576 3313.8,6576 3313.8,6576"];
		}
		subgraph cluster_base_ffn_l1 {
			graph [bb="3018.5,6084,3570,6533",
				fontsize=10,
				label="Layer 1 FFN",
				lheight=0.15,
				lp="3294.2,6523.5",
				lwidth=0.89,
				style=dashed
			];
			base_ffn_up_l1_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_0<br/>[512→2048]",
				pos="3139.5,6218",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l1_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_0<br/>[2048→512]",
				pos="3443,6218",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l1_0 -> base_ffn_down_l1_0	[pos="e,3323.8,6224 3252.5,6224 3252.5,6224 3313.8,6224 3313.8,6224"];
			base_ffn_up_l1_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_1<br/>[512→2048]",
				pos="3139.5,6272",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l1_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_1<br/>[2048→512]",
				pos="3443,6272",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l1_1 -> base_ffn_down_l1_1	[pos="e,3323.8,6278 3252.5,6278 3252.5,6278 3313.8,6278 3313.8,6278"];
			base_ffn_up_l1_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_2<br/>[512→2048]",
				pos="3139.5,6164",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l1_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_2<br/>[2048→512]",
				pos="3443,6164",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l1_2 -> base_ffn_down_l1_2	[pos="e,3323.8,6170 3252.5,6170 3252.5,6170 3313.8,6170 3313.8,6170"];
			base_ffn_up_l1_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_3<br/>[512→2048]",
				pos="3139.5,6488",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l1_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_3<br/>[2048→512]",
				pos="3443,6488",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l1_3 -> base_ffn_down_l1_3	[pos="e,3323.8,6494 3252.5,6494 3252.5,6494 3313.8,6494 3313.8,6494"];
			base_ffn_up_l1_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_4<br/>[512→2048]",
				pos="3139.5,6434",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l1_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_4<br/>[2048→512]",
				pos="3443,6434",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l1_4 -> base_ffn_down_l1_4	[pos="e,3323.8,6440 3252.5,6440 3252.5,6440 3313.8,6440 3313.8,6440"];
			base_ffn_up_l1_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_5<br/>[512→2048]",
				pos="3139.5,6326",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l1_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_5<br/>[2048→512]",
				pos="3443,6326",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l1_5 -> base_ffn_down_l1_5	[pos="e,3323.8,6332 3252.5,6332 3252.5,6332 3313.8,6332 3313.8,6332"];
			base_ffn_up_l1_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_6<br/>[512→2048]",
				pos="3139.5,6380",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l1_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_6<br/>[2048→512]",
				pos="3443,6380",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l1_6 -> base_ffn_down_l1_6	[pos="e,3323.8,6386 3252.5,6386 3252.5,6386 3313.8,6386 3313.8,6386"];
			base_ffn_up_l1_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_7<br/>[512→2048]",
				pos="3139.5,6110",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l1_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_7<br/>[2048→512]",
				pos="3443,6110",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l1_7 -> base_ffn_down_l1_7	[pos="e,3323.8,6116 3252.5,6116 3252.5,6116 3313.8,6116 3313.8,6116"];
		}
		subgraph cluster_base_ffn_l2 {
			graph [bb="3018.5,5627,3570,6076",
				fontsize=10,
				label="Layer 2 FFN",
				lheight=0.15,
				lp="3294.2,6066.5",
				lwidth=0.89,
				style=dashed
			];
			base_ffn_up_l2_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_0<br/>[512→2048]",
				pos="3139.5,5761",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l2_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_0<br/>[2048→512]",
				pos="3443,5761",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l2_0 -> base_ffn_down_l2_0	[pos="e,3323.8,5761 3252.5,5761 3252.5,5761 3313.8,5761 3313.8,5761"];
			base_ffn_up_l2_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_1<br/>[512→2048]",
				pos="3139.5,5815",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l2_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_1<br/>[2048→512]",
				pos="3443,5815",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l2_1 -> base_ffn_down_l2_1	[pos="e,3323.8,5815 3252.5,5815 3252.5,5815 3313.8,5815 3313.8,5815"];
			base_ffn_up_l2_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_2<br/>[512→2048]",
				pos="3139.5,5707",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l2_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_2<br/>[2048→512]",
				pos="3443,5707",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l2_2 -> base_ffn_down_l2_2	[pos="e,3323.8,5707 3252.5,5707 3252.5,5707 3313.8,5707 3313.8,5707"];
			base_ffn_up_l2_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_3<br/>[512→2048]",
				pos="3139.5,6031",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l2_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_3<br/>[2048→512]",
				pos="3443,6031",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l2_3 -> base_ffn_down_l2_3	[pos="e,3323.8,6031 3252.5,6031 3252.5,6031 3313.8,6031 3313.8,6031"];
			base_ffn_up_l2_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_4<br/>[512→2048]",
				pos="3139.5,5977",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l2_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_4<br/>[2048→512]",
				pos="3443,5977",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l2_4 -> base_ffn_down_l2_4	[pos="e,3323.8,5977 3252.5,5977 3252.5,5977 3313.8,5977 3313.8,5977"];
			base_ffn_up_l2_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_5<br/>[512→2048]",
				pos="3139.5,5869",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l2_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_5<br/>[2048→512]",
				pos="3443,5869",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l2_5 -> base_ffn_down_l2_5	[pos="e,3323.8,5869 3252.5,5869 3252.5,5869 3313.8,5869 3313.8,5869"];
			base_ffn_up_l2_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_6<br/>[512→2048]",
				pos="3139.5,5923",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l2_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_6<br/>[2048→512]",
				pos="3443,5923",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l2_6 -> base_ffn_down_l2_6	[pos="e,3323.8,5923 3252.5,5923 3252.5,5923 3313.8,5923 3313.8,5923"];
			base_ffn_up_l2_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_7<br/>[512→2048]",
				pos="3139.5,5653",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l2_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_7<br/>[2048→512]",
				pos="3443,5653",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l2_7 -> base_ffn_down_l2_7	[pos="e,3323.8,5653 3252.5,5653 3252.5,5653 3313.8,5653 3313.8,5653"];
		}
		subgraph cluster_base_ffn_l3 {
			graph [bb="3018.5,5170,3570,5619",
				fontsize=10,
				label="Layer 3 FFN",
				lheight=0.15,
				lp="3294.2,5609.5",
				lwidth=0.89,
				style=dashed
			];
			base_ffn_up_l3_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_0<br/>[512→2048]",
				pos="3139.5,5304",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l3_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_0<br/>[2048→512]",
				pos="3443,5304",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l3_0 -> base_ffn_down_l3_0	[pos="e,3323.8,5304 3252.5,5304 3252.5,5304 3313.8,5304 3313.8,5304"];
			base_ffn_up_l3_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_1<br/>[512→2048]",
				pos="3139.5,5358",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l3_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_1<br/>[2048→512]",
				pos="3443,5358",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l3_1 -> base_ffn_down_l3_1	[pos="e,3323.8,5358 3252.5,5358 3252.5,5358 3313.8,5358 3313.8,5358"];
			base_ffn_up_l3_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_2<br/>[512→2048]",
				pos="3139.5,5250",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l3_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_2<br/>[2048→512]",
				pos="3443,5250",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l3_2 -> base_ffn_down_l3_2	[pos="e,3323.8,5250 3252.5,5250 3252.5,5250 3313.8,5250 3313.8,5250"];
			base_ffn_up_l3_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_3<br/>[512→2048]",
				pos="3139.5,5574",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l3_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_3<br/>[2048→512]",
				pos="3443,5574",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l3_3 -> base_ffn_down_l3_3	[pos="e,3323.8,5574 3252.5,5574 3252.5,5574 3313.8,5574 3313.8,5574"];
			base_ffn_up_l3_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_4<br/>[512→2048]",
				pos="3139.5,5520",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l3_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_4<br/>[2048→512]",
				pos="3443,5520",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l3_4 -> base_ffn_down_l3_4	[pos="e,3323.8,5520 3252.5,5520 3252.5,5520 3313.8,5520 3313.8,5520"];
			base_ffn_up_l3_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_5<br/>[512→2048]",
				pos="3139.5,5412",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l3_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_5<br/>[2048→512]",
				pos="3443,5412",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l3_5 -> base_ffn_down_l3_5	[pos="e,3323.8,5412 3252.5,5412 3252.5,5412 3313.8,5412 3313.8,5412"];
			base_ffn_up_l3_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_6<br/>[512→2048]",
				pos="3139.5,5466",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l3_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_6<br/>[2048→512]",
				pos="3443,5466",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l3_6 -> base_ffn_down_l3_6	[pos="e,3323.8,5466 3252.5,5466 3252.5,5466 3313.8,5466 3313.8,5466"];
			base_ffn_up_l3_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Up</b><br/>base_gpu_7<br/>[512→2048]",
				pos="3139.5,5196",
				shape=rectangle,
				width=3.1389];
			base_ffn_down_l3_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>FFN Down</b><br/>base_gpu_7<br/>[2048→512]",
				pos="3443,5196",
				shape=rectangle,
				width=3.3056];
			base_ffn_up_l3_7 -> base_ffn_down_l3_7	[pos="e,3323.8,5196 3252.5,5196 3252.5,5196 3313.8,5196 3313.8,5196"];
		}
		base_embed_0	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Embedding</b><br/>base_gpu_0<br/>[batch=1024, seq=?, 512]",
			pos="3139.5,5142",
			shape=rectangle,
			width=4.0972];
		base_embed_1	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Embedding</b><br/>base_gpu_1<br/>[batch=1024, seq=?, 512]",
			pos="3139.5,5088",
			shape=rectangle,
			width=4.0972];
		base_embed_2	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Embedding</b><br/>base_gpu_2<br/>[batch=1024, seq=?, 512]",
			pos="3139.5,5034",
			shape=rectangle,
			width=4.0972];
		base_embed_3	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Embedding</b><br/>base_gpu_3<br/>[batch=1024, seq=?, 512]",
			pos="3139.5,4980",
			shape=rectangle,
			width=4.0972];
		base_embed_4	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Embedding</b><br/>base_gpu_4<br/>[batch=1024, seq=?, 512]",
			pos="3139.5,4926",
			shape=rectangle,
			width=4.0972];
		base_embed_5	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Embedding</b><br/>base_gpu_5<br/>[batch=1024, seq=?, 512]",
			pos="3139.5,4872",
			shape=rectangle,
			width=4.0972];
		base_embed_6	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Embedding</b><br/>base_gpu_6<br/>[batch=1024, seq=?, 512]",
			pos="3139.5,4818",
			shape=rectangle,
			width=4.0972];
		base_embed_7	[fillcolor=lightgreen,
			height=0.5,
			label="<b>Embedding</b><br/>base_gpu_7<br/>[batch=1024, seq=?, 512]",
			pos="3139.5,4764",
			shape=rectangle,
			width=4.0972];
	}
	subgraph cluster_short_scenario {
		graph [bb="1334,8,2255.7,5320",
			color=lightblue,
			fontsize=11,
			label="< 4096 tokens (Base)",
			lheight=0.17,
			lp="1794.9,5310",
			lwidth=1.69,
			style=rounded
		];
		subgraph cluster_layer0_short {
			graph [bb="1342,2658,2247.7,3971",
				fontsize=10,
				label="Layer 0",
				lheight=0.15,
				lp="1794.9,3961.5",
				lwidth=0.54
			];
			q_proj_0_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,3116",
				shape=rectangle,
				width=3.2083];
			flash_attn_0_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_0<br/>Block: 1/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,3116",
				shape=rectangle,
				width=5.7222];
			q_proj_0_short_0 -> flash_attn_0_short_0	[pos="e,1827.7,3110 1581.2,3110 1581.2,3110 1817.7,3110 1817.7,3110"];
			k_proj_0_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,3062",
				shape=rectangle,
				width=3.1944];
			k_proj_0_short_0 -> flash_attn_0_short_0	[pos="e,1965.5,3097.7 1580.5,3062 1728.1,3062 1965.5,3062 1965.5,3062 1965.5,3062 1965.5,3087.7 1965.5,3087.7"];
			v_proj_0_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,3008",
				shape=rectangle,
				width=3.1944];
			v_proj_0_short_0 -> flash_attn_0_short_0	[pos="e,2102.5,3097.7 1580.8,3008 1764.4,3008 2102.5,3008 2102.5,3008 2102.5,3008 2102.5,3087.7 2102.5,3087.7"];
			q_proj_0_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,3278",
				shape=rectangle,
				width=3.2083];
			flash_attn_0_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_1<br/>Block: 2/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,3278",
				shape=rectangle,
				width=5.7222];
			q_proj_0_short_1 -> flash_attn_0_short_1	[pos="e,1827.7,3272 1581.2,3272 1581.2,3272 1817.7,3272 1817.7,3272"];
			k_proj_0_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,3224",
				shape=rectangle,
				width=3.1944];
			k_proj_0_short_1 -> flash_attn_0_short_1	[pos="e,1965.5,3259.7 1580.5,3224 1728.1,3224 1965.5,3224 1965.5,3224 1965.5,3224 1965.5,3249.7 1965.5,3249.7"];
			v_proj_0_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,3170",
				shape=rectangle,
				width=3.1944];
			v_proj_0_short_1 -> flash_attn_0_short_1	[pos="e,2102.5,3259.7 1580.8,3170 1764.4,3170 2102.5,3170 2102.5,3170 2102.5,3170 2102.5,3249.7 2102.5,3249.7"];
			q_proj_0_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,2954",
				shape=rectangle,
				width=3.2083];
			flash_attn_0_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_2<br/>Block: 3/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,2954",
				shape=rectangle,
				width=5.7222];
			q_proj_0_short_2 -> flash_attn_0_short_2	[pos="e,1827.7,2948 1581.2,2948 1581.2,2948 1817.7,2948 1817.7,2948"];
			k_proj_0_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,2900",
				shape=rectangle,
				width=3.1944];
			k_proj_0_short_2 -> flash_attn_0_short_2	[pos="e,1965.5,2935.7 1580.5,2900 1728.1,2900 1965.5,2900 1965.5,2900 1965.5,2900 1965.5,2925.7 1965.5,2925.7"];
			v_proj_0_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,2846",
				shape=rectangle,
				width=3.1944];
			v_proj_0_short_2 -> flash_attn_0_short_2	[pos="e,2102.5,2935.7 1580.8,2846 1764.4,2846 2102.5,2846 2102.5,2846 2102.5,2846 2102.5,2925.7 2102.5,2925.7"];
			q_proj_0_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,3926",
				shape=rectangle,
				width=3.2083];
			flash_attn_0_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_3<br/>Block: 4/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,3926",
				shape=rectangle,
				width=5.7222];
			q_proj_0_short_3 -> flash_attn_0_short_3	[pos="e,1827.7,3920 1581.2,3920 1581.2,3920 1817.7,3920 1817.7,3920"];
			k_proj_0_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,3872",
				shape=rectangle,
				width=3.1944];
			k_proj_0_short_3 -> flash_attn_0_short_3	[pos="e,1965.5,3907.7 1580.5,3872 1728.1,3872 1965.5,3872 1965.5,3872 1965.5,3872 1965.5,3897.7 1965.5,3897.7"];
			v_proj_0_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,3818",
				shape=rectangle,
				width=3.1944];
			v_proj_0_short_3 -> flash_attn_0_short_3	[pos="e,2102.5,3907.7 1580.8,3818 1764.4,3818 2102.5,3818 2102.5,3818 2102.5,3818 2102.5,3897.7 2102.5,3897.7"];
			q_proj_0_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,3764",
				shape=rectangle,
				width=3.2083];
			flash_attn_0_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_4<br/>Block: 5/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,3764",
				shape=rectangle,
				width=5.7222];
			q_proj_0_short_4 -> flash_attn_0_short_4	[pos="e,1827.7,3758 1581.2,3758 1581.2,3758 1817.7,3758 1817.7,3758"];
			k_proj_0_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,3710",
				shape=rectangle,
				width=3.1944];
			k_proj_0_short_4 -> flash_attn_0_short_4	[pos="e,1965.5,3745.7 1580.5,3710 1728.1,3710 1965.5,3710 1965.5,3710 1965.5,3710 1965.5,3735.7 1965.5,3735.7"];
			v_proj_0_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,3656",
				shape=rectangle,
				width=3.1944];
			v_proj_0_short_4 -> flash_attn_0_short_4	[pos="e,2102.5,3745.7 1580.8,3656 1764.4,3656 2102.5,3656 2102.5,3656 2102.5,3656 2102.5,3735.7 2102.5,3735.7"];
			q_proj_0_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,3440",
				shape=rectangle,
				width=3.2083];
			flash_attn_0_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_5<br/>Block: 6/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,3440",
				shape=rectangle,
				width=5.7222];
			q_proj_0_short_5 -> flash_attn_0_short_5	[pos="e,1827.7,3434 1581.2,3434 1581.2,3434 1817.7,3434 1817.7,3434"];
			k_proj_0_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,3386",
				shape=rectangle,
				width=3.1944];
			k_proj_0_short_5 -> flash_attn_0_short_5	[pos="e,1965.5,3421.7 1580.5,3386 1728.1,3386 1965.5,3386 1965.5,3386 1965.5,3386 1965.5,3411.7 1965.5,3411.7"];
			v_proj_0_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,3332",
				shape=rectangle,
				width=3.1944];
			v_proj_0_short_5 -> flash_attn_0_short_5	[pos="e,2102.5,3421.7 1580.8,3332 1764.4,3332 2102.5,3332 2102.5,3332 2102.5,3332 2102.5,3411.7 2102.5,3411.7"];
			q_proj_0_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,3602",
				shape=rectangle,
				width=3.2083];
			flash_attn_0_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_6<br/>Block: 7/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,3602",
				shape=rectangle,
				width=5.7222];
			q_proj_0_short_6 -> flash_attn_0_short_6	[pos="e,1827.7,3596 1581.2,3596 1581.2,3596 1817.7,3596 1817.7,3596"];
			k_proj_0_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,3548",
				shape=rectangle,
				width=3.1944];
			k_proj_0_short_6 -> flash_attn_0_short_6	[pos="e,1965.5,3583.7 1580.5,3548 1728.1,3548 1965.5,3548 1965.5,3548 1965.5,3548 1965.5,3573.7 1965.5,3573.7"];
			v_proj_0_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,3494",
				shape=rectangle,
				width=3.1944];
			v_proj_0_short_6 -> flash_attn_0_short_6	[pos="e,2102.5,3583.7 1580.8,3494 1764.4,3494 2102.5,3494 2102.5,3494 2102.5,3494 2102.5,3573.7 2102.5,3573.7"];
			q_proj_0_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,2792",
				shape=rectangle,
				width=3.2083];
			flash_attn_0_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_7<br/>Block: 8/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,2792",
				shape=rectangle,
				width=5.7222];
			q_proj_0_short_7 -> flash_attn_0_short_7	[pos="e,1827.7,2786 1581.2,2786 1581.2,2786 1817.7,2786 1817.7,2786"];
			k_proj_0_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,2738",
				shape=rectangle,
				width=3.1944];
			k_proj_0_short_7 -> flash_attn_0_short_7	[pos="e,1965.5,2773.7 1580.5,2738 1728.1,2738 1965.5,2738 1965.5,2738 1965.5,2738 1965.5,2763.7 1965.5,2763.7"];
			v_proj_0_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,2684",
				shape=rectangle,
				width=3.1944];
			v_proj_0_short_7 -> flash_attn_0_short_7	[pos="e,2102.5,2773.7 1580.8,2684 1764.4,2684 2102.5,2684 2102.5,2684 2102.5,2684 2102.5,2763.7 2102.5,2763.7"];
		}
		subgraph cluster_layer1_short {
			graph [bb="1342,1337,2247.7,2650",
				fontsize=10,
				label="Layer 1",
				lheight=0.15,
				lp="1794.9,2640.5",
				lwidth=0.54
			];
			q_proj_1_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,1795",
				shape=rectangle,
				width=3.2083];
			flash_attn_1_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_0<br/>Block: 1/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,1795",
				shape=rectangle,
				width=5.7222];
			q_proj_1_short_0 -> flash_attn_1_short_0	[pos="e,1827.7,1795 1581.2,1795 1581.2,1795 1817.7,1795 1817.7,1795"];
			k_proj_1_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,1741",
				shape=rectangle,
				width=3.1944];
			k_proj_1_short_0 -> flash_attn_1_short_0	[pos="e,1931.5,1776.7 1580.7,1741 1718.7,1741 1931.5,1741 1931.5,1741 1931.5,1741 1931.5,1766.7 1931.5,1766.7"];
			v_proj_1_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,1687",
				shape=rectangle,
				width=3.1944];
			v_proj_1_short_0 -> flash_attn_1_short_0	[pos="e,2034.5,1776.7 1580.6,1687 1746.9,1687 2034.5,1687 2034.5,1687 2034.5,1687 2034.5,1766.7 2034.5,1766.7"];
			q_proj_1_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,1957",
				shape=rectangle,
				width=3.2083];
			flash_attn_1_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_1<br/>Block: 2/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,1957",
				shape=rectangle,
				width=5.7222];
			q_proj_1_short_1 -> flash_attn_1_short_1	[pos="e,1827.7,1957 1581.2,1957 1581.2,1957 1817.7,1957 1817.7,1957"];
			k_proj_1_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,1903",
				shape=rectangle,
				width=3.1944];
			k_proj_1_short_1 -> flash_attn_1_short_1	[pos="e,1931.5,1938.7 1580.7,1903 1718.7,1903 1931.5,1903 1931.5,1903 1931.5,1903 1931.5,1928.7 1931.5,1928.7"];
			v_proj_1_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,1849",
				shape=rectangle,
				width=3.1944];
			v_proj_1_short_1 -> flash_attn_1_short_1	[pos="e,2034.5,1938.7 1580.6,1849 1746.9,1849 2034.5,1849 2034.5,1849 2034.5,1849 2034.5,1928.7 2034.5,1928.7"];
			q_proj_1_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,1633",
				shape=rectangle,
				width=3.2083];
			flash_attn_1_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_2<br/>Block: 3/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,1633",
				shape=rectangle,
				width=5.7222];
			q_proj_1_short_2 -> flash_attn_1_short_2	[pos="e,1827.7,1633 1581.2,1633 1581.2,1633 1817.7,1633 1817.7,1633"];
			k_proj_1_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,1579",
				shape=rectangle,
				width=3.1944];
			k_proj_1_short_2 -> flash_attn_1_short_2	[pos="e,1931.5,1614.7 1580.7,1579 1718.7,1579 1931.5,1579 1931.5,1579 1931.5,1579 1931.5,1604.7 1931.5,1604.7"];
			v_proj_1_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,1525",
				shape=rectangle,
				width=3.1944];
			v_proj_1_short_2 -> flash_attn_1_short_2	[pos="e,2034.5,1614.7 1580.6,1525 1746.9,1525 2034.5,1525 2034.5,1525 2034.5,1525 2034.5,1604.7 2034.5,1604.7"];
			q_proj_1_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,2605",
				shape=rectangle,
				width=3.2083];
			flash_attn_1_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_3<br/>Block: 4/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,2605",
				shape=rectangle,
				width=5.7222];
			q_proj_1_short_3 -> flash_attn_1_short_3	[pos="e,1827.7,2599 1581.2,2599 1581.2,2599 1817.7,2599 1817.7,2599"];
			k_proj_1_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,2551",
				shape=rectangle,
				width=3.1944];
			k_proj_1_short_3 -> flash_attn_1_short_3	[pos="e,1965.5,2586.7 1580.5,2551 1728.1,2551 1965.5,2551 1965.5,2551 1965.5,2551 1965.5,2576.7 1965.5,2576.7"];
			v_proj_1_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,2497",
				shape=rectangle,
				width=3.1944];
			v_proj_1_short_3 -> flash_attn_1_short_3	[pos="e,2102.5,2586.7 1580.8,2497 1764.4,2497 2102.5,2497 2102.5,2497 2102.5,2497 2102.5,2576.7 2102.5,2576.7"];
			q_proj_1_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,2443",
				shape=rectangle,
				width=3.2083];
			flash_attn_1_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_4<br/>Block: 5/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,2443",
				shape=rectangle,
				width=5.7222];
			q_proj_1_short_4 -> flash_attn_1_short_4	[pos="e,1827.7,2437 1581.2,2437 1581.2,2437 1817.7,2437 1817.7,2437"];
			k_proj_1_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,2389",
				shape=rectangle,
				width=3.1944];
			k_proj_1_short_4 -> flash_attn_1_short_4	[pos="e,1965.5,2424.7 1580.5,2389 1728.1,2389 1965.5,2389 1965.5,2389 1965.5,2389 1965.5,2414.7 1965.5,2414.7"];
			v_proj_1_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,2335",
				shape=rectangle,
				width=3.1944];
			v_proj_1_short_4 -> flash_attn_1_short_4	[pos="e,2102.5,2424.7 1580.8,2335 1764.4,2335 2102.5,2335 2102.5,2335 2102.5,2335 2102.5,2414.7 2102.5,2414.7"];
			q_proj_1_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,2119",
				shape=rectangle,
				width=3.2083];
			flash_attn_1_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_5<br/>Block: 6/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,2119",
				shape=rectangle,
				width=5.7222];
			q_proj_1_short_5 -> flash_attn_1_short_5	[pos="e,1827.7,2119 1581.2,2119 1581.2,2119 1817.7,2119 1817.7,2119"];
			k_proj_1_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,2065",
				shape=rectangle,
				width=3.1944];
			k_proj_1_short_5 -> flash_attn_1_short_5	[pos="e,1931.5,2100.7 1580.7,2065 1718.7,2065 1931.5,2065 1931.5,2065 1931.5,2065 1931.5,2090.7 1931.5,2090.7"];
			v_proj_1_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,2011",
				shape=rectangle,
				width=3.1944];
			v_proj_1_short_5 -> flash_attn_1_short_5	[pos="e,2034.5,2100.7 1580.6,2011 1746.9,2011 2034.5,2011 2034.5,2011 2034.5,2011 2034.5,2090.7 2034.5,2090.7"];
			q_proj_1_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,2281",
				shape=rectangle,
				width=3.2083];
			flash_attn_1_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_6<br/>Block: 7/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,2281",
				shape=rectangle,
				width=5.7222];
			q_proj_1_short_6 -> flash_attn_1_short_6	[pos="e,1827.7,2275 1581.2,2275 1581.2,2275 1817.7,2275 1817.7,2275"];
			k_proj_1_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,2227",
				shape=rectangle,
				width=3.1944];
			k_proj_1_short_6 -> flash_attn_1_short_6	[pos="e,1931.5,2262.7 1580.7,2227 1718.7,2227 1931.5,2227 1931.5,2227 1931.5,2227 1931.5,2252.7 1931.5,2252.7"];
			v_proj_1_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,2173",
				shape=rectangle,
				width=3.1944];
			v_proj_1_short_6 -> flash_attn_1_short_6	[pos="e,2034.5,2262.7 1580.6,2173 1746.9,2173 2034.5,2173 2034.5,2173 2034.5,2173 2034.5,2252.7 2034.5,2252.7"];
			q_proj_1_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,1471",
				shape=rectangle,
				width=3.2083];
			flash_attn_1_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_7<br/>Block: 8/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,1471",
				shape=rectangle,
				width=5.7222];
			q_proj_1_short_7 -> flash_attn_1_short_7	[pos="e,1827.7,1471 1581.2,1471 1581.2,1471 1817.7,1471 1817.7,1471"];
			k_proj_1_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,1417",
				shape=rectangle,
				width=3.1944];
			k_proj_1_short_7 -> flash_attn_1_short_7	[pos="e,2034.5,1452.7 1580.6,1417 1746.9,1417 2034.5,1417 2034.5,1417 2034.5,1417 2034.5,1442.7 2034.5,1442.7"];
			v_proj_1_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,1363",
				shape=rectangle,
				width=3.1944];
			v_proj_1_short_7 -> flash_attn_1_short_7	[pos="e,2137.5,1452.7 1580.6,1363 1772.7,1363 2137.5,1363 2137.5,1363 2137.5,1363 2137.5,1442.7 2137.5,1442.7"];
		}
		subgraph cluster_layer2_short {
			graph [bb="1342,16,2247.7,1329",
				fontsize=10,
				label="Layer 2",
				lheight=0.15,
				lp="1794.9,1319.5",
				lwidth=0.54
			];
			q_proj_2_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,474",
				shape=rectangle,
				width=3.2083];
			flash_attn_2_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_0<br/>Block: 1/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,474",
				shape=rectangle,
				width=5.7222];
			q_proj_2_short_0 -> flash_attn_2_short_0	[pos="e,1827.7,474 1581.2,474 1581.2,474 1817.7,474 1817.7,474"];
			k_proj_2_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,420",
				shape=rectangle,
				width=3.1944];
			k_proj_2_short_0 -> flash_attn_2_short_0	[pos="e,1931.5,455.72 1580.7,420 1718.7,420 1931.5,420 1931.5,420 1931.5,420 1931.5,445.72 1931.5,445.72"];
			v_proj_2_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,366",
				shape=rectangle,
				width=3.1944];
			v_proj_2_short_0 -> flash_attn_2_short_0	[pos="e,2034.5,455.68 1580.6,366 1746.9,366 2034.5,366 2034.5,366 2034.5,366 2034.5,445.68 2034.5,445.68"];
			q_proj_2_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,636",
				shape=rectangle,
				width=3.2083];
			flash_attn_2_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_1<br/>Block: 2/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,636",
				shape=rectangle,
				width=5.7222];
			q_proj_2_short_1 -> flash_attn_2_short_1	[pos="e,1827.7,636 1581.2,636 1581.2,636 1817.7,636 1817.7,636"];
			k_proj_2_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,582",
				shape=rectangle,
				width=3.1944];
			k_proj_2_short_1 -> flash_attn_2_short_1	[pos="e,1931.5,617.72 1580.7,582 1718.7,582 1931.5,582 1931.5,582 1931.5,582 1931.5,607.72 1931.5,607.72"];
			v_proj_2_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,528",
				shape=rectangle,
				width=3.1944];
			v_proj_2_short_1 -> flash_attn_2_short_1	[pos="e,2034.5,617.68 1580.6,528 1746.9,528 2034.5,528 2034.5,528 2034.5,528 2034.5,607.68 2034.5,607.68"];
			q_proj_2_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,312",
				shape=rectangle,
				width=3.2083];
			flash_attn_2_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_2<br/>Block: 3/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,312",
				shape=rectangle,
				width=5.7222];
			q_proj_2_short_2 -> flash_attn_2_short_2	[pos="e,1827.7,312 1581.2,312 1581.2,312 1817.7,312 1817.7,312"];
			k_proj_2_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,258",
				shape=rectangle,
				width=3.1944];
			k_proj_2_short_2 -> flash_attn_2_short_2	[pos="e,1931.5,293.72 1580.7,258 1718.7,258 1931.5,258 1931.5,258 1931.5,258 1931.5,283.72 1931.5,283.72"];
			v_proj_2_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,204",
				shape=rectangle,
				width=3.1944];
			v_proj_2_short_2 -> flash_attn_2_short_2	[pos="e,2034.5,293.68 1580.6,204 1746.9,204 2034.5,204 2034.5,204 2034.5,204 2034.5,283.68 2034.5,283.68"];
			q_proj_2_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,1284",
				shape=rectangle,
				width=3.2083];
			flash_attn_2_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_3<br/>Block: 4/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,1284",
				shape=rectangle,
				width=5.7222];
			q_proj_2_short_3 -> flash_attn_2_short_3	[pos="e,1827.7,1284 1581.2,1284 1581.2,1284 1817.7,1284 1817.7,1284"];
			k_proj_2_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,1230",
				shape=rectangle,
				width=3.1944];
			k_proj_2_short_3 -> flash_attn_2_short_3	[pos="e,1931.5,1265.7 1580.7,1230 1718.7,1230 1931.5,1230 1931.5,1230 1931.5,1230 1931.5,1255.7 1931.5,1255.7"];
			v_proj_2_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,1176",
				shape=rectangle,
				width=3.1944];
			v_proj_2_short_3 -> flash_attn_2_short_3	[pos="e,2034.5,1265.7 1580.6,1176 1746.9,1176 2034.5,1176 2034.5,1176 2034.5,1176 2034.5,1255.7 2034.5,1255.7"];
			q_proj_2_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,1122",
				shape=rectangle,
				width=3.2083];
			flash_attn_2_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_4<br/>Block: 5/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,1122",
				shape=rectangle,
				width=5.7222];
			q_proj_2_short_4 -> flash_attn_2_short_4	[pos="e,1827.7,1122 1581.2,1122 1581.2,1122 1817.7,1122 1817.7,1122"];
			k_proj_2_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,1068",
				shape=rectangle,
				width=3.1944];
			k_proj_2_short_4 -> flash_attn_2_short_4	[pos="e,1931.5,1103.7 1580.7,1068 1718.7,1068 1931.5,1068 1931.5,1068 1931.5,1068 1931.5,1093.7 1931.5,1093.7"];
			v_proj_2_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,1014",
				shape=rectangle,
				width=3.1944];
			v_proj_2_short_4 -> flash_attn_2_short_4	[pos="e,2034.5,1103.7 1580.6,1014 1746.9,1014 2034.5,1014 2034.5,1014 2034.5,1014 2034.5,1093.7 2034.5,1093.7"];
			q_proj_2_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,798",
				shape=rectangle,
				width=3.2083];
			flash_attn_2_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_5<br/>Block: 6/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,798",
				shape=rectangle,
				width=5.7222];
			q_proj_2_short_5 -> flash_attn_2_short_5	[pos="e,1827.7,798 1581.2,798 1581.2,798 1817.7,798 1817.7,798"];
			k_proj_2_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,744",
				shape=rectangle,
				width=3.1944];
			k_proj_2_short_5 -> flash_attn_2_short_5	[pos="e,1931.5,779.72 1580.7,744 1718.7,744 1931.5,744 1931.5,744 1931.5,744 1931.5,769.72 1931.5,769.72"];
			v_proj_2_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,690",
				shape=rectangle,
				width=3.1944];
			v_proj_2_short_5 -> flash_attn_2_short_5	[pos="e,2034.5,779.68 1580.6,690 1746.9,690 2034.5,690 2034.5,690 2034.5,690 2034.5,769.68 2034.5,769.68"];
			q_proj_2_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,960",
				shape=rectangle,
				width=3.2083];
			flash_attn_2_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_6<br/>Block: 7/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,960",
				shape=rectangle,
				width=5.7222];
			q_proj_2_short_6 -> flash_attn_2_short_6	[pos="e,1827.7,960 1581.2,960 1581.2,960 1817.7,960 1817.7,960"];
			k_proj_2_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,906",
				shape=rectangle,
				width=3.1944];
			k_proj_2_short_6 -> flash_attn_2_short_6	[pos="e,1931.5,941.72 1580.7,906 1718.7,906 1931.5,906 1931.5,906 1931.5,906 1931.5,931.72 1931.5,931.72"];
			v_proj_2_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,852",
				shape=rectangle,
				width=3.1944];
			v_proj_2_short_6 -> flash_attn_2_short_6	[pos="e,2034.5,941.68 1580.6,852 1746.9,852 2034.5,852 2034.5,852 2034.5,852 2034.5,931.68 2034.5,931.68"];
			q_proj_2_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,150",
				shape=rectangle,
				width=3.2083];
			flash_attn_2_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_7<br/>Block: 8/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,150",
				shape=rectangle,
				width=5.7222];
			q_proj_2_short_7 -> flash_attn_2_short_7	[pos="e,1827.7,150 1581.2,150 1581.2,150 1817.7,150 1817.7,150"];
			k_proj_2_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,96",
				shape=rectangle,
				width=3.1944];
			k_proj_2_short_7 -> flash_attn_2_short_7	[pos="e,1965.5,131.72 1580.5,96 1728.1,96 1965.5,96 1965.5,96 1965.5,96 1965.5,121.72 1965.5,121.72"];
			v_proj_2_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,42",
				shape=rectangle,
				width=3.1944];
			v_proj_2_short_7 -> flash_attn_2_short_7	[pos="e,2102.5,131.68 1580.8,42 1764.4,42 2102.5,42 2102.5,42 2102.5,42 2102.5,121.68 2102.5,121.68"];
		}
		subgraph cluster_layer3_short {
			graph [bb="1342,3979,2247.7,5292",
				fontsize=10,
				label="Layer 3",
				lheight=0.15,
				lp="1794.9,5282.5",
				lwidth=0.54
			];
			q_proj_3_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,4437",
				shape=rectangle,
				width=3.2083];
			flash_attn_3_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_0<br/>Block: 1/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,4383",
				shape=rectangle,
				width=5.7222];
			q_proj_3_short_0 -> flash_attn_3_short_0	[pos="e,2102.5,4401.3 1581.2,4437 1764.9,4437 2102.5,4437 2102.5,4437 2102.5,4437 2102.5,4411.3 2102.5,4411.3"];
			k_proj_3_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,4383",
				shape=rectangle,
				width=3.1944];
			k_proj_3_short_0 -> flash_attn_3_short_0	[pos="e,1827.5,4377 1580.8,4377 1580.8,4377 1817.5,4377 1817.5,4377"];
			v_proj_3_short_0	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,4329",
				shape=rectangle,
				width=3.1944];
			v_proj_3_short_0 -> flash_attn_3_short_0	[pos="e,2102.5,4364.7 1580.8,4329 1764.4,4329 2102.5,4329 2102.5,4329 2102.5,4329 2102.5,4354.7 2102.5,4354.7"];
			q_proj_3_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,4599",
				shape=rectangle,
				width=3.2083];
			flash_attn_3_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_1<br/>Block: 2/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,4545",
				shape=rectangle,
				width=5.7222];
			q_proj_3_short_1 -> flash_attn_3_short_1	[pos="e,2102.5,4563.3 1581.2,4599 1764.9,4599 2102.5,4599 2102.5,4599 2102.5,4599 2102.5,4573.3 2102.5,4573.3"];
			k_proj_3_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,4545",
				shape=rectangle,
				width=3.1944];
			k_proj_3_short_1 -> flash_attn_3_short_1	[pos="e,1827.5,4539 1580.8,4539 1580.8,4539 1817.5,4539 1817.5,4539"];
			v_proj_3_short_1	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,4491",
				shape=rectangle,
				width=3.1944];
			v_proj_3_short_1 -> flash_attn_3_short_1	[pos="e,1965.5,4526.7 1580.5,4491 1728.1,4491 1965.5,4491 1965.5,4491 1965.5,4491 1965.5,4516.7 1965.5,4516.7"];
			q_proj_3_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,4275",
				shape=rectangle,
				width=3.2083];
			flash_attn_3_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_2<br/>Block: 3/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,4221",
				shape=rectangle,
				width=5.7222];
			q_proj_3_short_2 -> flash_attn_3_short_2	[pos="e,1965.5,4239.3 1581.1,4275 1728.8,4275 1965.5,4275 1965.5,4275 1965.5,4275 1965.5,4249.3 1965.5,4249.3"];
			k_proj_3_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,4221",
				shape=rectangle,
				width=3.1944];
			k_proj_3_short_2 -> flash_attn_3_short_2	[pos="e,1827.5,4215 1580.8,4215 1580.8,4215 1817.5,4215 1817.5,4215"];
			v_proj_3_short_2	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,4167",
				shape=rectangle,
				width=3.1944];
			v_proj_3_short_2 -> flash_attn_3_short_2	[pos="e,2034.5,4202.7 1580.6,4167 1746.9,4167 2034.5,4167 2034.5,4167 2034.5,4167 2034.5,4192.7 2034.5,4192.7"];
			q_proj_3_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,5247",
				shape=rectangle,
				width=3.2083];
			flash_attn_3_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_3<br/>Block: 4/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,5193",
				shape=rectangle,
				width=5.7222];
			q_proj_3_short_3 -> flash_attn_3_short_3	[pos="e,1965.5,5211 1581.1,5241.4 1728.8,5241.4 1965.5,5241.4 1965.5,5241.4 1965.5,5241.4 1965.5,5221 1965.5,5221"];
			k_proj_3_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,5193",
				shape=rectangle,
				width=3.1944];
			k_proj_3_short_3 -> flash_attn_3_short_3	[pos="e,1827.5,5187 1580.8,5187 1580.8,5187 1817.5,5187 1817.5,5187"];
			v_proj_3_short_3	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,5139",
				shape=rectangle,
				width=3.1944];
			v_proj_3_short_3 -> flash_attn_3_short_3	[pos="e,2102.5,5174.9 1580.8,5140.5 1764.4,5140.5 2102.5,5140.5 2102.5,5140.5 2102.5,5140.5 2102.5,5164.9 2102.5,5164.9"];
			q_proj_3_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,5085",
				shape=rectangle,
				width=3.2083];
			flash_attn_3_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_4<br/>Block: 5/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,5031",
				shape=rectangle,
				width=5.7222];
			q_proj_3_short_4 -> flash_attn_3_short_4	[pos="e,1965.5,5049.2 1581.1,5086.5 1728.8,5086.5 1965.5,5086.5 1965.5,5086.5 1965.5,5086.5 1965.5,5059.2 1965.5,5059.2"];
			k_proj_3_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,5031",
				shape=rectangle,
				width=3.1944];
			k_proj_3_short_4 -> flash_attn_3_short_4	[pos="e,1827.5,5025 1580.8,5025 1580.8,5025 1817.5,5025 1817.5,5025"];
			v_proj_3_short_4	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,4977",
				shape=rectangle,
				width=3.1944];
			v_proj_3_short_4 -> flash_attn_3_short_4	[pos="e,2102.5,5012.9 1580.8,4978.5 1764.4,4978.5 2102.5,4978.5 2102.5,4978.5 2102.5,4978.5 2102.5,5002.9 2102.5,5002.9"];
			q_proj_3_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,4761",
				shape=rectangle,
				width=3.2083];
			flash_attn_3_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_5<br/>Block: 6/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,4707",
				shape=rectangle,
				width=5.7222];
			q_proj_3_short_5 -> flash_attn_3_short_5	[pos="e,2102.5,4725.2 1581.2,4762.5 1764.9,4762.5 2102.5,4762.5 2102.5,4762.5 2102.5,4762.5 2102.5,4735.2 2102.5,4735.2"];
			k_proj_3_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,4707",
				shape=rectangle,
				width=3.1944];
			k_proj_3_short_5 -> flash_attn_3_short_5	[pos="e,1827.5,4701 1580.8,4701 1580.8,4701 1817.5,4701 1817.5,4701"];
			v_proj_3_short_5	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,4653",
				shape=rectangle,
				width=3.1944];
			v_proj_3_short_5 -> flash_attn_3_short_5	[pos="e,1965.5,4688.7 1580.5,4653 1728.1,4653 1965.5,4653 1965.5,4653 1965.5,4653 1965.5,4678.7 1965.5,4678.7"];
			q_proj_3_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,4923",
				shape=rectangle,
				width=3.2083];
			flash_attn_3_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_6<br/>Block: 7/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,4869",
				shape=rectangle,
				width=5.7222];
			q_proj_3_short_6 -> flash_attn_3_short_6	[pos="e,1965.5,4887.2 1581.1,4924.5 1728.8,4924.5 1965.5,4924.5 1965.5,4924.5 1965.5,4924.5 1965.5,4897.2 1965.5,4897.2"];
			k_proj_3_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,4869",
				shape=rectangle,
				width=3.1944];
			k_proj_3_short_6 -> flash_attn_3_short_6	[pos="e,1827.5,4863 1580.8,4863 1580.8,4863 1817.5,4863 1817.5,4863"];
			v_proj_3_short_6	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,4815",
				shape=rectangle,
				width=3.1944];
			v_proj_3_short_6 -> flash_attn_3_short_6	[pos="e,1965.5,4850.9 1580.5,4816.5 1728.1,4816.5 1965.5,4816.5 1965.5,4816.5 1965.5,4816.5 1965.5,4840.9 1965.5,4840.9"];
			q_proj_3_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>Q Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,4113",
				shape=rectangle,
				width=3.2083];
			flash_attn_3_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>Flash Attention</b><br/>base_gpu_7<br/>Block: 8/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,4083",
				shape=rectangle,
				width=5.7222];
			q_proj_3_short_7 -> flash_attn_3_short_7	[pos="e,1827.4,4083 1465.5,4094.9 1465.5,4088.5 1465.5,4083 1465.5,4083 1465.5,4083 1817.4,4083 1817.4,4083"];
			k_proj_3_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>K Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,4059",
				shape=rectangle,
				width=3.1944];
			k_proj_3_short_7 -> flash_attn_3_short_7	[pos="e,1827.5,4071 1580.8,4071 1580.8,4071 1817.5,4071 1817.5,4071"];
			v_proj_3_short_7	[fillcolor=lightblue,
				height=0.5,
				label="<b>V Proj</b><br/>base_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,4005",
				shape=rectangle,
				width=3.1944];
			v_proj_3_short_7 -> flash_attn_3_short_7	[pos="e,2034.5,4064.9 1580.6,4005 1746.9,4005 2034.5,4005 2034.5,4005 2034.5,4005 2034.5,4054.9 2034.5,4054.9"];
		}
	}
	subgraph cluster_medium_scenario {
		graph [bb="1335,37098,2884,42410",
			color=lightgreen,
			fontsize=11,
			label="4096-8192 tokens (8 pool GPUs)",
			lheight=0.17,
			lp="2109.5,42400",
			lwidth=2.53,
			style=rounded
		];
		subgraph cluster_layer0_medium {
			graph [bb="1343,41069,2876,42382",
				fontsize=10,
				label="Layer 0",
				lheight=0.15,
				lp="2109.5,42372",
				lwidth=0.54
			];
			q_proj_0_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,42337",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,42229",
				shape=rectangle,
				width=5.6944];
			q_proj_0_medium_0 -> flash_attn_0_medium_0	[pos="e,2102.5,42247 1580.1,42337 1763.5,42337 2102.5,42337 2102.5,42337 2102.5,42337 2102.5,42257 2102.5,42257"];
			k_proj_0_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,42283",
				shape=rectangle,
				width=3.1667];
			k_proj_0_medium_0 -> flash_attn_0_medium_0	[pos="e,1965.5,42247 1579.6,42283 1727.1,42283 1965.5,42283 1965.5,42283 1965.5,42283 1965.5,42257 1965.5,42257"];
			v_proj_0_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,42229",
				shape=rectangle,
				width=3.1667];
			v_proj_0_medium_0 -> flash_attn_0_medium_0	[pos="e,1828.5,42235 1579.8,42235 1579.8,42235 1818.5,42235 1818.5,42235"];
			reduce_0_medium	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>8→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,41095",
				shape=diamond,
				width=6.8722];
			flash_attn_0_medium_0 -> reduce_0_medium	[pos="e,2806.5,41100 2238.8,42229 2467.7,42229 2806.5,42229 2806.5,42229 2806.5,42229 2806.5,41110 2806.5,41110"];
			q_proj_0_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,42175",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,42067",
				shape=rectangle,
				width=5.6944];
			q_proj_0_medium_1 -> flash_attn_0_medium_1	[pos="e,2102.5,42085 1580.1,42175 1763.5,42175 2102.5,42175 2102.5,42175 2102.5,42175 2102.5,42095 2102.5,42095"];
			k_proj_0_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,42121",
				shape=rectangle,
				width=3.1667];
			k_proj_0_medium_1 -> flash_attn_0_medium_1	[pos="e,1965.5,42085 1579.6,42121 1727.1,42121 1965.5,42121 1965.5,42121 1965.5,42121 1965.5,42095 1965.5,42095"];
			v_proj_0_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,42067",
				shape=rectangle,
				width=3.1667];
			v_proj_0_medium_1 -> flash_attn_0_medium_1	[pos="e,1828.5,42073 1579.8,42073 1579.8,42073 1818.5,42073 1818.5,42073"];
			flash_attn_0_medium_1 -> reduce_0_medium	[pos="e,2744.5,41104 2238.8,42067 2448.8,42067 2744.5,42067 2744.5,42067 2744.5,42067 2744.5,41114 2744.5,41114"];
			q_proj_0_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,42013",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,41905",
				shape=rectangle,
				width=5.6944];
			q_proj_0_medium_2 -> flash_attn_0_medium_2	[pos="e,2102.5,41923 1580.1,42013 1763.5,42013 2102.5,42013 2102.5,42013 2102.5,42013 2102.5,41933 2102.5,41933"];
			k_proj_0_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,41959",
				shape=rectangle,
				width=3.1667];
			k_proj_0_medium_2 -> flash_attn_0_medium_2	[pos="e,1965.5,41923 1579.6,41959 1727.1,41959 1965.5,41959 1965.5,41959 1965.5,41959 1965.5,41933 1965.5,41933"];
			v_proj_0_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,41905",
				shape=rectangle,
				width=3.1667];
			v_proj_0_medium_2 -> flash_attn_0_medium_2	[pos="e,1828.5,41911 1579.8,41911 1579.8,41911 1818.5,41911 1818.5,41911"];
			flash_attn_0_medium_2 -> reduce_0_medium	[pos="e,2682.5,41109 2239,41905 2429.1,41905 2682.5,41905 2682.5,41905 2682.5,41905 2682.5,41119 2682.5,41119"];
			q_proj_0_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,41851",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,41743",
				shape=rectangle,
				width=5.6944];
			q_proj_0_medium_3 -> flash_attn_0_medium_3	[pos="e,2102.5,41761 1580.1,41851 1763.5,41851 2102.5,41851 2102.5,41851 2102.5,41851 2102.5,41771 2102.5,41771"];
			k_proj_0_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,41797",
				shape=rectangle,
				width=3.1667];
			k_proj_0_medium_3 -> flash_attn_0_medium_3	[pos="e,1965.5,41761 1579.6,41797 1727.1,41797 1965.5,41797 1965.5,41797 1965.5,41797 1965.5,41771 1965.5,41771"];
			v_proj_0_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,41743",
				shape=rectangle,
				width=3.1667];
			v_proj_0_medium_3 -> flash_attn_0_medium_3	[pos="e,1828.5,41749 1579.8,41749 1579.8,41749 1818.5,41749 1818.5,41749"];
			flash_attn_0_medium_3 -> reduce_0_medium	[pos="e,2621.5,41113 2238.9,41743 2408.4,41743 2621.5,41743 2621.5,41743 2621.5,41743 2621.5,41123 2621.5,41123"];
			q_proj_0_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,41689",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,41581",
				shape=rectangle,
				width=5.6944];
			q_proj_0_medium_4 -> flash_attn_0_medium_4	[pos="e,2102.5,41599 1580.1,41689 1763.5,41689 2102.5,41689 2102.5,41689 2102.5,41689 2102.5,41609 2102.5,41609"];
			k_proj_0_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,41635",
				shape=rectangle,
				width=3.1667];
			k_proj_0_medium_4 -> flash_attn_0_medium_4	[pos="e,1965.5,41599 1579.6,41635 1727.1,41635 1965.5,41635 1965.5,41635 1965.5,41635 1965.5,41609 1965.5,41609"];
			v_proj_0_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,41581",
				shape=rectangle,
				width=3.1667];
			v_proj_0_medium_4 -> flash_attn_0_medium_4	[pos="e,1828.5,41587 1579.8,41587 1579.8,41587 1818.5,41587 1818.5,41587"];
			flash_attn_0_medium_4 -> reduce_0_medium	[pos="e,2559.5,41109 2238.9,41581 2386.4,41581 2559.5,41581 2559.5,41581 2559.5,41581 2559.5,41119 2559.5,41119"];
			q_proj_0_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,41527",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,41419",
				shape=rectangle,
				width=5.6944];
			q_proj_0_medium_5 -> flash_attn_0_medium_5	[pos="e,2102.5,41437 1580.1,41527 1763.5,41527 2102.5,41527 2102.5,41527 2102.5,41527 2102.5,41447 2102.5,41447"];
			k_proj_0_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,41473",
				shape=rectangle,
				width=3.1667];
			k_proj_0_medium_5 -> flash_attn_0_medium_5	[pos="e,1965.5,41437 1579.6,41473 1727.1,41473 1965.5,41473 1965.5,41473 1965.5,41473 1965.5,41447 1965.5,41447"];
			v_proj_0_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,41419",
				shape=rectangle,
				width=3.1667];
			v_proj_0_medium_5 -> flash_attn_0_medium_5	[pos="e,1828.5,41425 1579.8,41425 1579.8,41425 1818.5,41425 1818.5,41425"];
			flash_attn_0_medium_5 -> reduce_0_medium	[pos="e,2497.5,41104 2238.8,41419 2363,41419 2497.5,41419 2497.5,41419 2497.5,41419 2497.5,41114 2497.5,41114"];
			q_proj_0_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,41365",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,41257",
				shape=rectangle,
				width=5.6944];
			q_proj_0_medium_6 -> flash_attn_0_medium_6	[pos="e,2102.5,41275 1580.1,41365 1763.5,41365 2102.5,41365 2102.5,41365 2102.5,41365 2102.5,41285 2102.5,41285"];
			k_proj_0_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,41311",
				shape=rectangle,
				width=3.1667];
			k_proj_0_medium_6 -> flash_attn_0_medium_6	[pos="e,1965.5,41275 1579.6,41311 1727.1,41311 1965.5,41311 1965.5,41311 1965.5,41311 1965.5,41285 1965.5,41285"];
			v_proj_0_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,41257",
				shape=rectangle,
				width=3.1667];
			v_proj_0_medium_6 -> flash_attn_0_medium_6	[pos="e,1828.5,41263 1579.8,41263 1579.8,41263 1818.5,41263 1818.5,41263"];
			flash_attn_0_medium_6 -> reduce_0_medium	[pos="e,2435.5,41100 2239,41257 2338,41257 2435.5,41257 2435.5,41257 2435.5,41257 2435.5,41110 2435.5,41110"];
			q_proj_0_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,41203",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,41095",
				shape=rectangle,
				width=5.6944];
			q_proj_0_medium_7 -> flash_attn_0_medium_7	[pos="e,2102.5,41113 1580.1,41203 1763.5,41203 2102.5,41203 2102.5,41203 2102.5,41203 2102.5,41123 2102.5,41123"];
			k_proj_0_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,41149",
				shape=rectangle,
				width=3.1667];
			k_proj_0_medium_7 -> flash_attn_0_medium_7	[pos="e,1965.5,41113 1579.6,41149 1727.1,41149 1965.5,41149 1965.5,41149 1965.5,41149 1965.5,41123 1965.5,41123"];
			v_proj_0_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,41095",
				shape=rectangle,
				width=3.1667];
			v_proj_0_medium_7 -> flash_attn_0_medium_7	[pos="e,1828.5,41101 1579.8,41101 1579.8,41101 1818.5,41101 1818.5,41101"];
			flash_attn_0_medium_7 -> reduce_0_medium	[pos="e,2373.1,41095 2239,41095 2239,41095 2363.1,41095 2363.1,41095"];
		}
		subgraph cluster_layer1_medium {
			graph [bb="1343,39748,2876,41061",
				fontsize=10,
				label="Layer 1",
				lheight=0.15,
				lp="2109.5,41052",
				lwidth=0.54
			];
			q_proj_1_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,41016",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,40908",
				shape=rectangle,
				width=5.6944];
			q_proj_1_medium_0 -> flash_attn_1_medium_0	[pos="e,2102.5,40926 1580.1,41016 1763.5,41016 2102.5,41016 2102.5,41016 2102.5,41016 2102.5,40936 2102.5,40936"];
			k_proj_1_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,40962",
				shape=rectangle,
				width=3.1667];
			k_proj_1_medium_0 -> flash_attn_1_medium_0	[pos="e,1965.5,40926 1579.6,40962 1727.1,40962 1965.5,40962 1965.5,40962 1965.5,40962 1965.5,40936 1965.5,40936"];
			v_proj_1_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,40908",
				shape=rectangle,
				width=3.1667];
			v_proj_1_medium_0 -> flash_attn_1_medium_0	[pos="e,1828.5,40914 1579.8,40914 1579.8,40914 1818.5,40914 1818.5,40914"];
			reduce_1_medium	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>8→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,39774",
				shape=diamond,
				width=6.8722];
			flash_attn_1_medium_0 -> reduce_1_medium	[pos="e,2806.5,39779 2238.8,40908 2467.7,40908 2806.5,40908 2806.5,40908 2806.5,40908 2806.5,39789 2806.5,39789"];
			q_proj_1_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,40854",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,40746",
				shape=rectangle,
				width=5.6944];
			q_proj_1_medium_1 -> flash_attn_1_medium_1	[pos="e,2102.5,40764 1580.1,40854 1763.5,40854 2102.5,40854 2102.5,40854 2102.5,40854 2102.5,40774 2102.5,40774"];
			k_proj_1_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,40800",
				shape=rectangle,
				width=3.1667];
			k_proj_1_medium_1 -> flash_attn_1_medium_1	[pos="e,1965.5,40764 1579.6,40800 1727.1,40800 1965.5,40800 1965.5,40800 1965.5,40800 1965.5,40774 1965.5,40774"];
			v_proj_1_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,40746",
				shape=rectangle,
				width=3.1667];
			v_proj_1_medium_1 -> flash_attn_1_medium_1	[pos="e,1828.5,40752 1579.8,40752 1579.8,40752 1818.5,40752 1818.5,40752"];
			flash_attn_1_medium_1 -> reduce_1_medium	[pos="e,2744.5,39783 2238.8,40746 2448.8,40746 2744.5,40746 2744.5,40746 2744.5,40746 2744.5,39793 2744.5,39793"];
			q_proj_1_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,40692",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,40584",
				shape=rectangle,
				width=5.6944];
			q_proj_1_medium_2 -> flash_attn_1_medium_2	[pos="e,2102.5,40602 1580.1,40692 1763.5,40692 2102.5,40692 2102.5,40692 2102.5,40692 2102.5,40612 2102.5,40612"];
			k_proj_1_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,40638",
				shape=rectangle,
				width=3.1667];
			k_proj_1_medium_2 -> flash_attn_1_medium_2	[pos="e,1965.5,40602 1579.6,40638 1727.1,40638 1965.5,40638 1965.5,40638 1965.5,40638 1965.5,40612 1965.5,40612"];
			v_proj_1_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,40584",
				shape=rectangle,
				width=3.1667];
			v_proj_1_medium_2 -> flash_attn_1_medium_2	[pos="e,1828.5,40590 1579.8,40590 1579.8,40590 1818.5,40590 1818.5,40590"];
			flash_attn_1_medium_2 -> reduce_1_medium	[pos="e,2682.5,39788 2239,40584 2429.1,40584 2682.5,40584 2682.5,40584 2682.5,40584 2682.5,39798 2682.5,39798"];
			q_proj_1_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,40530",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,40422",
				shape=rectangle,
				width=5.6944];
			q_proj_1_medium_3 -> flash_attn_1_medium_3	[pos="e,2102.5,40440 1580.1,40530 1763.5,40530 2102.5,40530 2102.5,40530 2102.5,40530 2102.5,40450 2102.5,40450"];
			k_proj_1_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,40476",
				shape=rectangle,
				width=3.1667];
			k_proj_1_medium_3 -> flash_attn_1_medium_3	[pos="e,1965.5,40440 1579.6,40476 1727.1,40476 1965.5,40476 1965.5,40476 1965.5,40476 1965.5,40450 1965.5,40450"];
			v_proj_1_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,40422",
				shape=rectangle,
				width=3.1667];
			v_proj_1_medium_3 -> flash_attn_1_medium_3	[pos="e,1828.5,40428 1579.8,40428 1579.8,40428 1818.5,40428 1818.5,40428"];
			flash_attn_1_medium_3 -> reduce_1_medium	[pos="e,2621.5,39792 2238.9,40422 2408.4,40422 2621.5,40422 2621.5,40422 2621.5,40422 2621.5,39802 2621.5,39802"];
			q_proj_1_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,40368",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,40260",
				shape=rectangle,
				width=5.6944];
			q_proj_1_medium_4 -> flash_attn_1_medium_4	[pos="e,2102.5,40278 1580.1,40368 1763.5,40368 2102.5,40368 2102.5,40368 2102.5,40368 2102.5,40288 2102.5,40288"];
			k_proj_1_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,40314",
				shape=rectangle,
				width=3.1667];
			k_proj_1_medium_4 -> flash_attn_1_medium_4	[pos="e,1965.5,40278 1579.6,40314 1727.1,40314 1965.5,40314 1965.5,40314 1965.5,40314 1965.5,40288 1965.5,40288"];
			v_proj_1_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,40260",
				shape=rectangle,
				width=3.1667];
			v_proj_1_medium_4 -> flash_attn_1_medium_4	[pos="e,1828.5,40266 1579.8,40266 1579.8,40266 1818.5,40266 1818.5,40266"];
			flash_attn_1_medium_4 -> reduce_1_medium	[pos="e,2559.5,39788 2238.9,40260 2386.4,40260 2559.5,40260 2559.5,40260 2559.5,40260 2559.5,39798 2559.5,39798"];
			q_proj_1_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,40206",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,40098",
				shape=rectangle,
				width=5.6944];
			q_proj_1_medium_5 -> flash_attn_1_medium_5	[pos="e,2102.5,40116 1580.1,40206 1763.5,40206 2102.5,40206 2102.5,40206 2102.5,40206 2102.5,40126 2102.5,40126"];
			k_proj_1_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,40152",
				shape=rectangle,
				width=3.1667];
			k_proj_1_medium_5 -> flash_attn_1_medium_5	[pos="e,1965.5,40116 1579.6,40152 1727.1,40152 1965.5,40152 1965.5,40152 1965.5,40152 1965.5,40126 1965.5,40126"];
			v_proj_1_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,40098",
				shape=rectangle,
				width=3.1667];
			v_proj_1_medium_5 -> flash_attn_1_medium_5	[pos="e,1828.5,40104 1579.8,40104 1579.8,40104 1818.5,40104 1818.5,40104"];
			flash_attn_1_medium_5 -> reduce_1_medium	[pos="e,2497.5,39783 2238.8,40098 2363,40098 2497.5,40098 2497.5,40098 2497.5,40098 2497.5,39793 2497.5,39793"];
			q_proj_1_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,40044",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,39936",
				shape=rectangle,
				width=5.6944];
			q_proj_1_medium_6 -> flash_attn_1_medium_6	[pos="e,2102.5,39954 1580.1,40044 1763.5,40044 2102.5,40044 2102.5,40044 2102.5,40044 2102.5,39964 2102.5,39964"];
			k_proj_1_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,39990",
				shape=rectangle,
				width=3.1667];
			k_proj_1_medium_6 -> flash_attn_1_medium_6	[pos="e,1965.5,39954 1579.6,39990 1727.1,39990 1965.5,39990 1965.5,39990 1965.5,39990 1965.5,39964 1965.5,39964"];
			v_proj_1_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,39936",
				shape=rectangle,
				width=3.1667];
			v_proj_1_medium_6 -> flash_attn_1_medium_6	[pos="e,1828.5,39942 1579.8,39942 1579.8,39942 1818.5,39942 1818.5,39942"];
			flash_attn_1_medium_6 -> reduce_1_medium	[pos="e,2435.5,39779 2239,39936 2338,39936 2435.5,39936 2435.5,39936 2435.5,39936 2435.5,39789 2435.5,39789"];
			q_proj_1_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,39882",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,39774",
				shape=rectangle,
				width=5.6944];
			q_proj_1_medium_7 -> flash_attn_1_medium_7	[pos="e,2102.5,39792 1580.1,39882 1763.5,39882 2102.5,39882 2102.5,39882 2102.5,39882 2102.5,39802 2102.5,39802"];
			k_proj_1_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,39828",
				shape=rectangle,
				width=3.1667];
			k_proj_1_medium_7 -> flash_attn_1_medium_7	[pos="e,1965.5,39792 1579.6,39828 1727.1,39828 1965.5,39828 1965.5,39828 1965.5,39828 1965.5,39802 1965.5,39802"];
			v_proj_1_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,39774",
				shape=rectangle,
				width=3.1667];
			v_proj_1_medium_7 -> flash_attn_1_medium_7	[pos="e,1828.5,39780 1579.8,39780 1579.8,39780 1818.5,39780 1818.5,39780"];
			flash_attn_1_medium_7 -> reduce_1_medium	[pos="e,2373.1,39774 2239,39774 2239,39774 2363.1,39774 2363.1,39774"];
		}
		subgraph cluster_layer2_medium {
			graph [bb="1343,38427,2876,39740",
				fontsize=10,
				label="Layer 2",
				lheight=0.15,
				lp="2109.5,39730",
				lwidth=0.54
			];
			q_proj_2_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,39695",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,39587",
				shape=rectangle,
				width=5.6944];
			q_proj_2_medium_0 -> flash_attn_2_medium_0	[pos="e,2102.5,39605 1580.1,39695 1763.5,39695 2102.5,39695 2102.5,39695 2102.5,39695 2102.5,39615 2102.5,39615"];
			k_proj_2_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,39641",
				shape=rectangle,
				width=3.1667];
			k_proj_2_medium_0 -> flash_attn_2_medium_0	[pos="e,1965.5,39605 1579.6,39641 1727.1,39641 1965.5,39641 1965.5,39641 1965.5,39641 1965.5,39615 1965.5,39615"];
			v_proj_2_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,39587",
				shape=rectangle,
				width=3.1667];
			v_proj_2_medium_0 -> flash_attn_2_medium_0	[pos="e,1828.5,39593 1579.8,39593 1579.8,39593 1818.5,39593 1818.5,39593"];
			reduce_2_medium	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>8→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,38453",
				shape=diamond,
				width=6.8722];
			flash_attn_2_medium_0 -> reduce_2_medium	[pos="e,2806.5,38458 2238.8,39587 2467.7,39587 2806.5,39587 2806.5,39587 2806.5,39587 2806.5,38468 2806.5,38468"];
			q_proj_2_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,39533",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,39425",
				shape=rectangle,
				width=5.6944];
			q_proj_2_medium_1 -> flash_attn_2_medium_1	[pos="e,2102.5,39443 1580.1,39533 1763.5,39533 2102.5,39533 2102.5,39533 2102.5,39533 2102.5,39453 2102.5,39453"];
			k_proj_2_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,39479",
				shape=rectangle,
				width=3.1667];
			k_proj_2_medium_1 -> flash_attn_2_medium_1	[pos="e,1965.5,39443 1579.6,39479 1727.1,39479 1965.5,39479 1965.5,39479 1965.5,39479 1965.5,39453 1965.5,39453"];
			v_proj_2_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,39425",
				shape=rectangle,
				width=3.1667];
			v_proj_2_medium_1 -> flash_attn_2_medium_1	[pos="e,1828.5,39431 1579.8,39431 1579.8,39431 1818.5,39431 1818.5,39431"];
			flash_attn_2_medium_1 -> reduce_2_medium	[pos="e,2744.5,38462 2238.8,39425 2448.8,39425 2744.5,39425 2744.5,39425 2744.5,39425 2744.5,38472 2744.5,38472"];
			q_proj_2_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,39371",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,39263",
				shape=rectangle,
				width=5.6944];
			q_proj_2_medium_2 -> flash_attn_2_medium_2	[pos="e,2102.5,39281 1580.1,39371 1763.5,39371 2102.5,39371 2102.5,39371 2102.5,39371 2102.5,39291 2102.5,39291"];
			k_proj_2_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,39317",
				shape=rectangle,
				width=3.1667];
			k_proj_2_medium_2 -> flash_attn_2_medium_2	[pos="e,1965.5,39281 1579.6,39317 1727.1,39317 1965.5,39317 1965.5,39317 1965.5,39317 1965.5,39291 1965.5,39291"];
			v_proj_2_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,39263",
				shape=rectangle,
				width=3.1667];
			v_proj_2_medium_2 -> flash_attn_2_medium_2	[pos="e,1828.5,39269 1579.8,39269 1579.8,39269 1818.5,39269 1818.5,39269"];
			flash_attn_2_medium_2 -> reduce_2_medium	[pos="e,2682.5,38467 2239,39263 2429.1,39263 2682.5,39263 2682.5,39263 2682.5,39263 2682.5,38477 2682.5,38477"];
			q_proj_2_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,39209",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,39101",
				shape=rectangle,
				width=5.6944];
			q_proj_2_medium_3 -> flash_attn_2_medium_3	[pos="e,2102.5,39119 1580.1,39209 1763.5,39209 2102.5,39209 2102.5,39209 2102.5,39209 2102.5,39129 2102.5,39129"];
			k_proj_2_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,39155",
				shape=rectangle,
				width=3.1667];
			k_proj_2_medium_3 -> flash_attn_2_medium_3	[pos="e,1965.5,39119 1579.6,39155 1727.1,39155 1965.5,39155 1965.5,39155 1965.5,39155 1965.5,39129 1965.5,39129"];
			v_proj_2_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,39101",
				shape=rectangle,
				width=3.1667];
			v_proj_2_medium_3 -> flash_attn_2_medium_3	[pos="e,1828.5,39107 1579.8,39107 1579.8,39107 1818.5,39107 1818.5,39107"];
			flash_attn_2_medium_3 -> reduce_2_medium	[pos="e,2621.5,38471 2238.9,39101 2408.4,39101 2621.5,39101 2621.5,39101 2621.5,39101 2621.5,38481 2621.5,38481"];
			q_proj_2_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,39047",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,38939",
				shape=rectangle,
				width=5.6944];
			q_proj_2_medium_4 -> flash_attn_2_medium_4	[pos="e,2102.5,38957 1580.1,39047 1763.5,39047 2102.5,39047 2102.5,39047 2102.5,39047 2102.5,38967 2102.5,38967"];
			k_proj_2_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,38993",
				shape=rectangle,
				width=3.1667];
			k_proj_2_medium_4 -> flash_attn_2_medium_4	[pos="e,1965.5,38957 1579.6,38993 1727.1,38993 1965.5,38993 1965.5,38993 1965.5,38993 1965.5,38967 1965.5,38967"];
			v_proj_2_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,38939",
				shape=rectangle,
				width=3.1667];
			v_proj_2_medium_4 -> flash_attn_2_medium_4	[pos="e,1828.5,38945 1579.8,38945 1579.8,38945 1818.5,38945 1818.5,38945"];
			flash_attn_2_medium_4 -> reduce_2_medium	[pos="e,2559.5,38467 2238.9,38939 2386.4,38939 2559.5,38939 2559.5,38939 2559.5,38939 2559.5,38477 2559.5,38477"];
			q_proj_2_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,38885",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,38777",
				shape=rectangle,
				width=5.6944];
			q_proj_2_medium_5 -> flash_attn_2_medium_5	[pos="e,2102.5,38795 1580.1,38885 1763.5,38885 2102.5,38885 2102.5,38885 2102.5,38885 2102.5,38805 2102.5,38805"];
			k_proj_2_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,38831",
				shape=rectangle,
				width=3.1667];
			k_proj_2_medium_5 -> flash_attn_2_medium_5	[pos="e,1965.5,38795 1579.6,38831 1727.1,38831 1965.5,38831 1965.5,38831 1965.5,38831 1965.5,38805 1965.5,38805"];
			v_proj_2_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,38777",
				shape=rectangle,
				width=3.1667];
			v_proj_2_medium_5 -> flash_attn_2_medium_5	[pos="e,1828.5,38783 1579.8,38783 1579.8,38783 1818.5,38783 1818.5,38783"];
			flash_attn_2_medium_5 -> reduce_2_medium	[pos="e,2497.5,38462 2238.8,38777 2363,38777 2497.5,38777 2497.5,38777 2497.5,38777 2497.5,38472 2497.5,38472"];
			q_proj_2_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,38723",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,38615",
				shape=rectangle,
				width=5.6944];
			q_proj_2_medium_6 -> flash_attn_2_medium_6	[pos="e,2102.5,38633 1580.1,38723 1763.5,38723 2102.5,38723 2102.5,38723 2102.5,38723 2102.5,38643 2102.5,38643"];
			k_proj_2_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,38669",
				shape=rectangle,
				width=3.1667];
			k_proj_2_medium_6 -> flash_attn_2_medium_6	[pos="e,1965.5,38633 1579.6,38669 1727.1,38669 1965.5,38669 1965.5,38669 1965.5,38669 1965.5,38643 1965.5,38643"];
			v_proj_2_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,38615",
				shape=rectangle,
				width=3.1667];
			v_proj_2_medium_6 -> flash_attn_2_medium_6	[pos="e,1828.5,38621 1579.8,38621 1579.8,38621 1818.5,38621 1818.5,38621"];
			flash_attn_2_medium_6 -> reduce_2_medium	[pos="e,2435.5,38458 2239,38615 2338,38615 2435.5,38615 2435.5,38615 2435.5,38615 2435.5,38468 2435.5,38468"];
			q_proj_2_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,38561",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,38453",
				shape=rectangle,
				width=5.6944];
			q_proj_2_medium_7 -> flash_attn_2_medium_7	[pos="e,2102.5,38471 1580.1,38561 1763.5,38561 2102.5,38561 2102.5,38561 2102.5,38561 2102.5,38481 2102.5,38481"];
			k_proj_2_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,38507",
				shape=rectangle,
				width=3.1667];
			k_proj_2_medium_7 -> flash_attn_2_medium_7	[pos="e,1965.5,38471 1579.6,38507 1727.1,38507 1965.5,38507 1965.5,38507 1965.5,38507 1965.5,38481 1965.5,38481"];
			v_proj_2_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,38453",
				shape=rectangle,
				width=3.1667];
			v_proj_2_medium_7 -> flash_attn_2_medium_7	[pos="e,1828.5,38459 1579.8,38459 1579.8,38459 1818.5,38459 1818.5,38459"];
			flash_attn_2_medium_7 -> reduce_2_medium	[pos="e,2373.1,38453 2239,38453 2239,38453 2363.1,38453 2363.1,38453"];
		}
		subgraph cluster_layer3_medium {
			graph [bb="1343,37106,2876,38419",
				fontsize=10,
				label="Layer 3",
				lheight=0.15,
				lp="2109.5,38410",
				lwidth=0.54
			];
			q_proj_3_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,38374",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,38266",
				shape=rectangle,
				width=5.6944];
			q_proj_3_medium_0 -> flash_attn_3_medium_0	[pos="e,2102.5,38284 1580.1,38374 1763.5,38374 2102.5,38374 2102.5,38374 2102.5,38374 2102.5,38294 2102.5,38294"];
			k_proj_3_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,38320",
				shape=rectangle,
				width=3.1667];
			k_proj_3_medium_0 -> flash_attn_3_medium_0	[pos="e,1965.5,38284 1579.6,38320 1727.1,38320 1965.5,38320 1965.5,38320 1965.5,38320 1965.5,38294 1965.5,38294"];
			v_proj_3_medium_0	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,38266",
				shape=rectangle,
				width=3.1667];
			v_proj_3_medium_0 -> flash_attn_3_medium_0	[pos="e,1828.5,38272 1579.8,38272 1579.8,38272 1818.5,38272 1818.5,38272"];
			reduce_3_medium	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>8→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,37132",
				shape=diamond,
				width=6.8722];
			flash_attn_3_medium_0 -> reduce_3_medium	[pos="e,2806.5,37137 2238.8,38266 2467.7,38266 2806.5,38266 2806.5,38266 2806.5,38266 2806.5,37147 2806.5,37147"];
			q_proj_3_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,38212",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,38104",
				shape=rectangle,
				width=5.6944];
			q_proj_3_medium_1 -> flash_attn_3_medium_1	[pos="e,2102.5,38122 1580.1,38212 1763.5,38212 2102.5,38212 2102.5,38212 2102.5,38212 2102.5,38132 2102.5,38132"];
			k_proj_3_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,38158",
				shape=rectangle,
				width=3.1667];
			k_proj_3_medium_1 -> flash_attn_3_medium_1	[pos="e,1965.5,38122 1579.6,38158 1727.1,38158 1965.5,38158 1965.5,38158 1965.5,38158 1965.5,38132 1965.5,38132"];
			v_proj_3_medium_1	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,38104",
				shape=rectangle,
				width=3.1667];
			v_proj_3_medium_1 -> flash_attn_3_medium_1	[pos="e,1828.5,38110 1579.8,38110 1579.8,38110 1818.5,38110 1818.5,38110"];
			flash_attn_3_medium_1 -> reduce_3_medium	[pos="e,2744.5,37141 2238.8,38104 2448.8,38104 2744.5,38104 2744.5,38104 2744.5,38104 2744.5,37151 2744.5,37151"];
			q_proj_3_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,38050",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,37942",
				shape=rectangle,
				width=5.6944];
			q_proj_3_medium_2 -> flash_attn_3_medium_2	[pos="e,2102.5,37960 1580.1,38050 1763.5,38050 2102.5,38050 2102.5,38050 2102.5,38050 2102.5,37970 2102.5,37970"];
			k_proj_3_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,37996",
				shape=rectangle,
				width=3.1667];
			k_proj_3_medium_2 -> flash_attn_3_medium_2	[pos="e,1965.5,37960 1579.6,37996 1727.1,37996 1965.5,37996 1965.5,37996 1965.5,37996 1965.5,37970 1965.5,37970"];
			v_proj_3_medium_2	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,37942",
				shape=rectangle,
				width=3.1667];
			v_proj_3_medium_2 -> flash_attn_3_medium_2	[pos="e,1828.5,37948 1579.8,37948 1579.8,37948 1818.5,37948 1818.5,37948"];
			flash_attn_3_medium_2 -> reduce_3_medium	[pos="e,2682.5,37146 2239,37942 2429.1,37942 2682.5,37942 2682.5,37942 2682.5,37942 2682.5,37156 2682.5,37156"];
			q_proj_3_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,37888",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,37780",
				shape=rectangle,
				width=5.6944];
			q_proj_3_medium_3 -> flash_attn_3_medium_3	[pos="e,2102.5,37798 1580.1,37888 1763.5,37888 2102.5,37888 2102.5,37888 2102.5,37888 2102.5,37808 2102.5,37808"];
			k_proj_3_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,37834",
				shape=rectangle,
				width=3.1667];
			k_proj_3_medium_3 -> flash_attn_3_medium_3	[pos="e,1965.5,37798 1579.6,37834 1727.1,37834 1965.5,37834 1965.5,37834 1965.5,37834 1965.5,37808 1965.5,37808"];
			v_proj_3_medium_3	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,37780",
				shape=rectangle,
				width=3.1667];
			v_proj_3_medium_3 -> flash_attn_3_medium_3	[pos="e,1828.5,37786 1579.8,37786 1579.8,37786 1818.5,37786 1818.5,37786"];
			flash_attn_3_medium_3 -> reduce_3_medium	[pos="e,2621.5,37150 2238.9,37780 2408.4,37780 2621.5,37780 2621.5,37780 2621.5,37780 2621.5,37160 2621.5,37160"];
			q_proj_3_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,37726",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,37618",
				shape=rectangle,
				width=5.6944];
			q_proj_3_medium_4 -> flash_attn_3_medium_4	[pos="e,2102.5,37636 1580.1,37726 1763.5,37726 2102.5,37726 2102.5,37726 2102.5,37726 2102.5,37646 2102.5,37646"];
			k_proj_3_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,37672",
				shape=rectangle,
				width=3.1667];
			k_proj_3_medium_4 -> flash_attn_3_medium_4	[pos="e,1965.5,37636 1579.6,37672 1727.1,37672 1965.5,37672 1965.5,37672 1965.5,37672 1965.5,37646 1965.5,37646"];
			v_proj_3_medium_4	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,37618",
				shape=rectangle,
				width=3.1667];
			v_proj_3_medium_4 -> flash_attn_3_medium_4	[pos="e,1828.5,37624 1579.8,37624 1579.8,37624 1818.5,37624 1818.5,37624"];
			flash_attn_3_medium_4 -> reduce_3_medium	[pos="e,2559.5,37146 2238.9,37618 2386.4,37618 2559.5,37618 2559.5,37618 2559.5,37618 2559.5,37156 2559.5,37156"];
			q_proj_3_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,37564",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,37456",
				shape=rectangle,
				width=5.6944];
			q_proj_3_medium_5 -> flash_attn_3_medium_5	[pos="e,2102.5,37474 1580.1,37564 1763.5,37564 2102.5,37564 2102.5,37564 2102.5,37564 2102.5,37484 2102.5,37484"];
			k_proj_3_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,37510",
				shape=rectangle,
				width=3.1667];
			k_proj_3_medium_5 -> flash_attn_3_medium_5	[pos="e,1965.5,37474 1579.6,37510 1727.1,37510 1965.5,37510 1965.5,37510 1965.5,37510 1965.5,37484 1965.5,37484"];
			v_proj_3_medium_5	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,37456",
				shape=rectangle,
				width=3.1667];
			v_proj_3_medium_5 -> flash_attn_3_medium_5	[pos="e,1828.5,37462 1579.8,37462 1579.8,37462 1818.5,37462 1818.5,37462"];
			flash_attn_3_medium_5 -> reduce_3_medium	[pos="e,2497.5,37141 2238.8,37456 2363,37456 2497.5,37456 2497.5,37456 2497.5,37456 2497.5,37151 2497.5,37151"];
			q_proj_3_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,37402",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,37294",
				shape=rectangle,
				width=5.6944];
			q_proj_3_medium_6 -> flash_attn_3_medium_6	[pos="e,2102.5,37312 1580.1,37402 1763.5,37402 2102.5,37402 2102.5,37402 2102.5,37402 2102.5,37322 2102.5,37322"];
			k_proj_3_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,37348",
				shape=rectangle,
				width=3.1667];
			k_proj_3_medium_6 -> flash_attn_3_medium_6	[pos="e,1965.5,37312 1579.6,37348 1727.1,37348 1965.5,37348 1965.5,37348 1965.5,37348 1965.5,37322 1965.5,37322"];
			v_proj_3_medium_6	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,37294",
				shape=rectangle,
				width=3.1667];
			v_proj_3_medium_6 -> flash_attn_3_medium_6	[pos="e,1828.5,37300 1579.8,37300 1579.8,37300 1818.5,37300 1818.5,37300"];
			flash_attn_3_medium_6 -> reduce_3_medium	[pos="e,2435.5,37137 2239,37294 2338,37294 2435.5,37294 2435.5,37294 2435.5,37294 2435.5,37147 2435.5,37147"];
			q_proj_3_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,37240",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/8<br/>[batch=1024, seq=ceil(seq/8), 4096]",
				pos="2033.7,37132",
				shape=rectangle,
				width=5.6944];
			q_proj_3_medium_7 -> flash_attn_3_medium_7	[pos="e,2102.5,37150 1580.1,37240 1763.5,37240 2102.5,37240 2102.5,37240 2102.5,37240 2102.5,37160 2102.5,37160"];
			k_proj_3_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,37186",
				shape=rectangle,
				width=3.1667];
			k_proj_3_medium_7 -> flash_attn_3_medium_7	[pos="e,1965.5,37150 1579.6,37186 1727.1,37186 1965.5,37186 1965.5,37186 1965.5,37186 1965.5,37160 1965.5,37160"];
			v_proj_3_medium_7	[fillcolor=lightgreen,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,37132",
				shape=rectangle,
				width=3.1667];
			v_proj_3_medium_7 -> flash_attn_3_medium_7	[pos="e,1828.5,37138 1579.8,37138 1579.8,37138 1818.5,37138 1818.5,37138"];
			flash_attn_3_medium_7 -> reduce_3_medium	[pos="e,2373.1,37132 2239,37132 2239,37132 2363.1,37132 2363.1,37132"];
		}
	}
	subgraph cluster_long_scenario {
		graph [bb="1332.5,26594,2888.1,37090",
			color=lightyellow,
			fontsize=11,
			label="8192-16384 tokens (16 pool GPUs)",
			lheight=0.17,
			lp="2110.3,37080",
			lwidth=2.72,
			style=rounded
		];
		subgraph cluster_layer0_long {
			graph [bb="1340.5,34453,2880.1,37062",
				fontsize=10,
				label="Layer 0",
				lheight=0.15,
				lp="2110.3,37052",
				lwidth=0.54
			];
			q_proj_0_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,37017",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,36909",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_0 -> flash_attn_0_long_0	[pos="e,2102.5,36927 1580.1,37017 1763.5,37017 2102.5,37017 2102.5,37017 2102.5,37017 2102.5,36937 2102.5,36937"];
			k_proj_0_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,36963",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_0 -> flash_attn_0_long_0	[pos="e,1965.5,36927 1579.6,36963 1727.1,36963 1965.5,36963 1965.5,36963 1965.5,36963 1965.5,36937 1965.5,36937"];
			v_proj_0_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,36909",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_0 -> flash_attn_0_long_0	[pos="e,1823.6,36915 1579.8,36915 1579.8,36915 1813.6,36915 1813.6,36915"];
			reduce_0_long	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>16→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,35072",
				shape=diamond,
				width=6.9856];
			flash_attn_0_long_0 -> reduce_0_long	[pos="e,2827.5,35075 2243.8,36909 2479,36909 2827.5,36909 2827.5,36909 2827.5,36909 2827.5,35085 2827.5,35085"];
			q_proj_0_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,36855",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,36747",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_1 -> flash_attn_0_long_1	[pos="e,2104.5,36765 1580.1,36855 1764,36855 2104.5,36855 2104.5,36855 2104.5,36855 2104.5,36775 2104.5,36775"];
			k_proj_0_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,36801",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_1 -> flash_attn_0_long_1	[pos="e,1964.5,36765 1579.6,36801 1726.9,36801 1964.5,36801 1964.5,36801 1964.5,36801 1964.5,36775 1964.5,36775"];
			v_proj_0_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,36747",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_1 -> flash_attn_0_long_1	[pos="e,1823.6,36753 1579.8,36753 1579.8,36753 1813.6,36753 1813.6,36753"];
			flash_attn_0_long_1 -> reduce_0_long	[pos="e,2786.5,35078 2243.9,36747 2466.6,36747 2786.5,36747 2786.5,36747 2786.5,36747 2786.5,35088 2786.5,35088"];
			q_proj_0_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,36693",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,36585",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_2 -> flash_attn_0_long_2	[pos="e,2104.5,36603 1580.1,36693 1764,36693 2104.5,36693 2104.5,36693 2104.5,36693 2104.5,36613 2104.5,36613"];
			k_proj_0_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,36639",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_2 -> flash_attn_0_long_2	[pos="e,1964.5,36603 1579.6,36639 1726.9,36639 1964.5,36639 1964.5,36639 1964.5,36639 1964.5,36613 1964.5,36613"];
			v_proj_0_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,36585",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_2 -> flash_attn_0_long_2	[pos="e,1823.6,36591 1579.8,36591 1579.8,36591 1813.6,36591 1813.6,36591"];
			flash_attn_0_long_2 -> reduce_0_long	[pos="e,2744.5,35081 2244.1,36585 2453.7,36585 2744.5,36585 2744.5,36585 2744.5,36585 2744.5,35091 2744.5,35091"];
			q_proj_0_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,36531",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,36423",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_3 -> flash_attn_0_long_3	[pos="e,2104.5,36441 1580.1,36531 1764,36531 2104.5,36531 2104.5,36531 2104.5,36531 2104.5,36451 2104.5,36451"];
			k_proj_0_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,36477",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_3 -> flash_attn_0_long_3	[pos="e,1964.5,36441 1579.6,36477 1726.9,36477 1964.5,36477 1964.5,36477 1964.5,36477 1964.5,36451 1964.5,36451"];
			v_proj_0_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,36423",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_3 -> flash_attn_0_long_3	[pos="e,1823.6,36429 1579.8,36429 1579.8,36429 1813.6,36429 1813.6,36429"];
			flash_attn_0_long_3 -> reduce_0_long	[pos="e,2703.5,35084 2243.8,36423 2440.2,36423 2703.5,36423 2703.5,36423 2703.5,36423 2703.5,35094 2703.5,35094"];
			q_proj_0_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,36369",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,36261",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_4 -> flash_attn_0_long_4	[pos="e,2104.5,36279 1580.1,36369 1764,36369 2104.5,36369 2104.5,36369 2104.5,36369 2104.5,36289 2104.5,36289"];
			k_proj_0_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,36315",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_4 -> flash_attn_0_long_4	[pos="e,1964.5,36279 1579.6,36315 1726.9,36315 1964.5,36315 1964.5,36315 1964.5,36315 1964.5,36289 1964.5,36289"];
			v_proj_0_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,36261",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_4 -> flash_attn_0_long_4	[pos="e,1823.6,36267 1579.8,36267 1579.8,36267 1813.6,36267 1813.6,36267"];
			flash_attn_0_long_4 -> reduce_0_long	[pos="e,2662.5,35087 2244,36261 2426.8,36261 2662.5,36261 2662.5,36261 2662.5,36261 2662.5,35097 2662.5,35097"];
			q_proj_0_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,36207",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,36099",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_5 -> flash_attn_0_long_5	[pos="e,2104.5,36117 1580.1,36207 1764,36207 2104.5,36207 2104.5,36207 2104.5,36207 2104.5,36127 2104.5,36127"];
			k_proj_0_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,36153",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_5 -> flash_attn_0_long_5	[pos="e,1964.5,36117 1579.6,36153 1726.9,36153 1964.5,36153 1964.5,36153 1964.5,36153 1964.5,36127 1964.5,36127"];
			v_proj_0_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,36099",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_5 -> flash_attn_0_long_5	[pos="e,1823.6,36105 1579.8,36105 1579.8,36105 1813.6,36105 1813.6,36105"];
			flash_attn_0_long_5 -> reduce_0_long	[pos="e,2621.5,35090 2243.8,36099 2412.6,36099 2621.5,36099 2621.5,36099 2621.5,36099 2621.5,35100 2621.5,35100"];
			q_proj_0_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,36045",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,35937",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_6 -> flash_attn_0_long_6	[pos="e,2104.5,35955 1580.1,36045 1764,36045 2104.5,36045 2104.5,36045 2104.5,36045 2104.5,35965 2104.5,35965"];
			k_proj_0_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,35991",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_6 -> flash_attn_0_long_6	[pos="e,1964.5,35955 1579.6,35991 1726.9,35991 1964.5,35991 1964.5,35991 1964.5,35991 1964.5,35965 1964.5,35965"];
			v_proj_0_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,35937",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_6 -> flash_attn_0_long_6	[pos="e,1823.6,35943 1579.8,35943 1579.8,35943 1813.6,35943 1813.6,35943"];
			flash_attn_0_long_6 -> reduce_0_long	[pos="e,2579.5,35087 2243.9,35937 2397.7,35937 2579.5,35937 2579.5,35937 2579.5,35937 2579.5,35097 2579.5,35097"];
			q_proj_0_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,35883",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,35775",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_7 -> flash_attn_0_long_7	[pos="e,2104.5,35793 1580.1,35883 1764,35883 2104.5,35883 2104.5,35883 2104.5,35883 2104.5,35803 2104.5,35803"];
			k_proj_0_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,35829",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_7 -> flash_attn_0_long_7	[pos="e,1964.5,35793 1579.6,35829 1726.9,35829 1964.5,35829 1964.5,35829 1964.5,35829 1964.5,35803 1964.5,35803"];
			v_proj_0_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,35775",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_7 -> flash_attn_0_long_7	[pos="e,1823.6,35781 1579.8,35781 1579.8,35781 1813.6,35781 1813.6,35781"];
			flash_attn_0_long_7 -> reduce_0_long	[pos="e,2538.5,35084 2243.8,35775 2382.4,35775 2538.5,35775 2538.5,35775 2538.5,35775 2538.5,35094 2538.5,35094"];
			q_proj_0_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,35721",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_8<br/>Block: 9/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,35613",
				shape=rectangle,
				width=5.8333];
			q_proj_0_long_8 -> flash_attn_0_long_8	[pos="e,2104.5,35631 1580.1,35721 1764,35721 2104.5,35721 2104.5,35721 2104.5,35721 2104.5,35641 2104.5,35641"];
			k_proj_0_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,35667",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_8 -> flash_attn_0_long_8	[pos="e,1964.5,35631 1579.6,35667 1726.9,35667 1964.5,35667 1964.5,35667 1964.5,35667 1964.5,35641 1964.5,35641"];
			v_proj_0_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,35613",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_8 -> flash_attn_0_long_8	[pos="e,1823.6,35619 1579.8,35619 1579.8,35619 1813.6,35619 1813.6,35619"];
			flash_attn_0_long_8 -> reduce_0_long	[pos="e,2497.5,35081 2243.9,35613 2366.6,35613 2497.5,35613 2497.5,35613 2497.5,35613 2497.5,35091 2497.5,35091"];
			q_proj_0_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,35559",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_9<br/>Block: 10/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,35451",
				shape=rectangle,
				width=5.9028];
			q_proj_0_long_9 -> flash_attn_0_long_9	[pos="e,2104.5,35469 1580.1,35559 1764,35559 2104.5,35559 2104.5,35559 2104.5,35559 2104.5,35479 2104.5,35479"];
			k_proj_0_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,35505",
				shape=rectangle,
				width=3.1667];
			k_proj_0_long_9 -> flash_attn_0_long_9	[pos="e,1964.5,35469 1579.6,35505 1726.9,35505 1964.5,35505 1964.5,35505 1964.5,35505 1964.5,35479 1964.5,35479"];
			v_proj_0_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,35451",
				shape=rectangle,
				width=3.1667];
			v_proj_0_long_9 -> flash_attn_0_long_9	[pos="e,1821,35457 1579.8,35457 1579.8,35457 1811,35457 1811,35457"];
			flash_attn_0_long_9 -> reduce_0_long	[pos="e,2456.5,35078 2246.3,35451 2351.6,35451 2456.5,35451 2456.5,35451 2456.5,35451 2456.5,35088 2456.5,35088"];
			q_proj_0_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,35397",
				shape=rectangle,
				width=3.25];
			flash_attn_0_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_10<br/>Block: 11/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,35289",
				shape=rectangle,
				width=5.9861];
			q_proj_0_long_10 -> flash_attn_0_long_10	[pos="e,2105.5,35307 1582.5,35397 1767.2,35397 2105.5,35397 2105.5,35397 2105.5,35397 2105.5,35317 2105.5,35317"];
			k_proj_0_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,35343",
				shape=rectangle,
				width=3.2361];
			k_proj_0_long_10 -> flash_attn_0_long_10	[pos="e,1963.5,35307 1582.2,35343 1729.4,35343 1963.5,35343 1963.5,35343 1963.5,35343 1963.5,35317 1963.5,35317"];
			v_proj_0_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,35289",
				shape=rectangle,
				width=3.2361];
			v_proj_0_long_10 -> flash_attn_0_long_10	[pos="e,1818.1,35295 1582.2,35295 1582.2,35295 1808.1,35295 1808.1,35295"];
			flash_attn_0_long_10 -> reduce_0_long	[pos="e,2414.5,35075 2249.4,35289 2335.5,35289 2414.5,35289 2414.5,35289 2414.5,35289 2414.5,35085 2414.5,35085"];
			q_proj_0_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,35235",
				shape=rectangle,
				width=3.25];
			flash_attn_0_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_11<br/>Block: 12/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,35127",
				shape=rectangle,
				width=5.9861];
			q_proj_0_long_11 -> flash_attn_0_long_11	[pos="e,2106.5,35145 1582.7,35235 1767.6,35235 2106.5,35235 2106.5,35235 2106.5,35235 2106.5,35155 2106.5,35155"];
			k_proj_0_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,35181",
				shape=rectangle,
				width=3.2361];
			k_proj_0_long_11 -> flash_attn_0_long_11	[pos="e,1962.5,35145 1582,35181 1728.9,35181 1962.5,35181 1962.5,35181 1962.5,35181 1962.5,35155 1962.5,35155"];
			v_proj_0_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,35127",
				shape=rectangle,
				width=3.2361];
			v_proj_0_long_11 -> flash_attn_0_long_11	[pos="e,1818.1,35133 1582.2,35133 1582.2,35133 1808.1,35133 1808.1,35133"];
			flash_attn_0_long_11 -> reduce_0_long	[pos="e,2498.1,35081 2034.5,35109 2034.5,35096 2034.5,35081 2034.5,35081 2034.5,35081 2488.1,35081 2488.1,35081"];
			q_proj_0_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,35073",
				shape=rectangle,
				width=3.25];
			flash_attn_0_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_12<br/>Block: 13/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,35019",
				shape=rectangle,
				width=5.9861];
			q_proj_0_long_12 -> flash_attn_0_long_12	[pos="e,1926.5,35037 1582.7,35072 1719.3,35072 1926.5,35072 1926.5,35072 1926.5,35072 1926.5,35047 1926.5,35047"];
			k_proj_0_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,35019",
				shape=rectangle,
				width=3.2361];
			k_proj_0_long_12 -> flash_attn_0_long_12	[pos="e,1818.1,35025 1582.2,35025 1582.2,35025 1808.1,35025 1808.1,35025"];
			v_proj_0_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,34965",
				shape=rectangle,
				width=3.2361];
			v_proj_0_long_12 -> flash_attn_0_long_12	[pos="e,2106.5,35001 1582.3,34965 1767.2,34965 2106.5,34965 2106.5,34965 2106.5,34965 2106.5,34991 2106.5,34991"];
			flash_attn_0_long_12 -> reduce_0_long	[pos="e,2484.3,35064 2141.5,35037 2141.5,35050 2141.5,35064 2141.5,35064 2141.5,35064 2474.3,35064 2474.3,35064"];
			q_proj_0_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,34911",
				shape=rectangle,
				width=3.25];
			flash_attn_0_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_13<br/>Block: 14/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,34857",
				shape=rectangle,
				width=5.9861];
			q_proj_0_long_13 -> flash_attn_0_long_13	[pos="e,1962.5,34875 1582.6,34911 1729.6,34911 1962.5,34911 1962.5,34911 1962.5,34911 1962.5,34885 1962.5,34885"];
			k_proj_0_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,34857",
				shape=rectangle,
				width=3.2361];
			k_proj_0_long_13 -> flash_attn_0_long_13	[pos="e,1818.1,34863 1582.2,34863 1582.2,34863 1808.1,34863 1808.1,34863"];
			v_proj_0_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,34803",
				shape=rectangle,
				width=3.2361];
			v_proj_0_long_13 -> flash_attn_0_long_13	[pos="e,2106.5,34839 1582.3,34803 1767.2,34803 2106.5,34803 2106.5,34803 2106.5,34803 2106.5,34829 2106.5,34829"];
			flash_attn_0_long_13 -> reduce_0_long	[pos="e,2771.5,35065 2249.6,34857 2467.3,34857 2771.5,34857 2771.5,34857 2771.5,34857 2771.5,35055 2771.5,35055"];
			q_proj_0_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,34749",
				shape=rectangle,
				width=3.25];
			flash_attn_0_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_14<br/>Block: 15/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,34695",
				shape=rectangle,
				width=5.9861];
			q_proj_0_long_14 -> flash_attn_0_long_14	[pos="e,1962.5,34713 1582.6,34749 1729.6,34749 1962.5,34749 1962.5,34749 1962.5,34749 1962.5,34723 1962.5,34723"];
			k_proj_0_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,34695",
				shape=rectangle,
				width=3.2361];
			k_proj_0_long_14 -> flash_attn_0_long_14	[pos="e,1818.1,34701 1582.2,34701 1582.2,34701 1808.1,34701 1808.1,34701"];
			v_proj_0_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,34641",
				shape=rectangle,
				width=3.2361];
			v_proj_0_long_14 -> flash_attn_0_long_14	[pos="e,2106.5,34677 1582.3,34641 1767.2,34641 2106.5,34641 2106.5,34641 2106.5,34641 2106.5,34667 2106.5,34667"];
			flash_attn_0_long_14 -> reduce_0_long	[pos="e,2805.5,35067 2249.5,34695 2477.8,34695 2805.5,34695 2805.5,34695 2805.5,34695 2805.5,35057 2805.5,35057"];
			q_proj_0_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,34587",
				shape=rectangle,
				width=3.25];
			flash_attn_0_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_15<br/>Block: 16/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,34533",
				shape=rectangle,
				width=5.9861];
			q_proj_0_long_15 -> flash_attn_0_long_15	[pos="e,1962.5,34551 1582.6,34587 1729.6,34587 1962.5,34587 1962.5,34587 1962.5,34587 1962.5,34561 1962.5,34561"];
			k_proj_0_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,34533",
				shape=rectangle,
				width=3.2361];
			k_proj_0_long_15 -> flash_attn_0_long_15	[pos="e,1818.1,34539 1582.2,34539 1582.2,34539 1808.1,34539 1808.1,34539"];
			v_proj_0_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,34479",
				shape=rectangle,
				width=3.2361];
			v_proj_0_long_15 -> flash_attn_0_long_15	[pos="e,2139.5,34515 1582.1,34479 1775,34479 2139.5,34479 2139.5,34479 2139.5,34479 2139.5,34505 2139.5,34505"];
			flash_attn_0_long_15 -> reduce_0_long	[pos="e,2839.5,35070 2249.4,34533 2488.1,34533 2839.5,34533 2839.5,34533 2839.5,34533 2839.5,35060 2839.5,35060"];
		}
		subgraph cluster_layer1_long {
			graph [bb="1340.5,31836,2880.1,34445",
				fontsize=10,
				label="Layer 1",
				lheight=0.15,
				lp="2110.3,34436",
				lwidth=0.54
			];
			q_proj_1_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,34400",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,34292",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_0 -> flash_attn_1_long_0	[pos="e,2034.5,34310 1580.3,34400 1746.5,34400 2034.5,34400 2034.5,34400 2034.5,34400 2034.5,34320 2034.5,34320"];
			k_proj_1_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,34346",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_0 -> flash_attn_1_long_0	[pos="e,1929.5,34310 1579.6,34346 1717,34346 1929.5,34346 1929.5,34346 1929.5,34346 1929.5,34320 1929.5,34320"];
			v_proj_1_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,34292",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_0 -> flash_attn_1_long_0	[pos="e,1823.6,34298 1579.8,34298 1579.8,34298 1813.6,34298 1813.6,34298"];
			reduce_1_long	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>16→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,32455",
				shape=diamond,
				width=6.9856];
			flash_attn_1_long_0 -> reduce_1_long	[pos="e,2738.5,32465 2243.7,34292 2451.5,34292 2738.5,34292 2738.5,34292 2738.5,34292 2738.5,32475 2738.5,32475"];
			q_proj_1_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,34238",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,34130",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_1 -> flash_attn_1_long_1	[pos="e,2104.5,34148 1580.1,34238 1764,34238 2104.5,34238 2104.5,34238 2104.5,34238 2104.5,34158 2104.5,34158"];
			k_proj_1_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,34184",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_1 -> flash_attn_1_long_1	[pos="e,1964.5,34148 1579.6,34184 1726.9,34184 1964.5,34184 1964.5,34184 1964.5,34184 1964.5,34158 1964.5,34158"];
			v_proj_1_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,34130",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_1 -> flash_attn_1_long_1	[pos="e,1823.6,34136 1579.8,34136 1579.8,34136 1813.6,34136 1813.6,34136"];
			flash_attn_1_long_1 -> reduce_1_long	[pos="e,2704.5,32467 2244.1,34130 2440.8,34130 2704.5,34130 2704.5,34130 2704.5,34130 2704.5,32477 2704.5,32477"];
			q_proj_1_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,34076",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,33968",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_2 -> flash_attn_1_long_2	[pos="e,2104.5,33986 1580.1,34076 1764,34076 2104.5,34076 2104.5,34076 2104.5,34076 2104.5,33996 2104.5,33996"];
			k_proj_1_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,34022",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_2 -> flash_attn_1_long_2	[pos="e,1964.5,33986 1579.6,34022 1726.9,34022 1964.5,34022 1964.5,34022 1964.5,34022 1964.5,33996 1964.5,33996"];
			v_proj_1_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,33968",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_2 -> flash_attn_1_long_2	[pos="e,1823.6,33974 1579.8,33974 1579.8,33974 1813.6,33974 1813.6,33974"];
			flash_attn_1_long_2 -> reduce_1_long	[pos="e,2671.5,32469 2243.9,33968 2429.7,33968 2671.5,33968 2671.5,33968 2671.5,33968 2671.5,32479 2671.5,32479"];
			q_proj_1_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,33914",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,33806",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_3 -> flash_attn_1_long_3	[pos="e,2104.5,33824 1580.1,33914 1764,33914 2104.5,33914 2104.5,33914 2104.5,33914 2104.5,33834 2104.5,33834"];
			k_proj_1_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,33860",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_3 -> flash_attn_1_long_3	[pos="e,1964.5,33824 1579.6,33860 1726.9,33860 1964.5,33860 1964.5,33860 1964.5,33860 1964.5,33834 1964.5,33834"];
			v_proj_1_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,33806",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_3 -> flash_attn_1_long_3	[pos="e,1823.6,33812 1579.8,33812 1579.8,33812 1813.6,33812 1813.6,33812"];
			flash_attn_1_long_3 -> reduce_1_long	[pos="e,2637.5,32472 2244,33806 2418.3,33806 2637.5,33806 2637.5,33806 2637.5,33806 2637.5,32482 2637.5,32482"];
			q_proj_1_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,33752",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,33644",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_4 -> flash_attn_1_long_4	[pos="e,2104.5,33662 1580.1,33752 1764,33752 2104.5,33752 2104.5,33752 2104.5,33752 2104.5,33672 2104.5,33672"];
			k_proj_1_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,33698",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_4 -> flash_attn_1_long_4	[pos="e,1964.5,33662 1579.6,33698 1726.9,33698 1964.5,33698 1964.5,33698 1964.5,33698 1964.5,33672 1964.5,33672"];
			v_proj_1_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,33644",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_4 -> flash_attn_1_long_4	[pos="e,1823.6,33650 1579.8,33650 1579.8,33650 1813.6,33650 1813.6,33650"];
			flash_attn_1_long_4 -> reduce_1_long	[pos="e,2604.5,32472 2243.8,33644 2406.6,33644 2604.5,33644 2604.5,33644 2604.5,33644 2604.5,32482 2604.5,32482"];
			q_proj_1_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,33590",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,33482",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_5 -> flash_attn_1_long_5	[pos="e,2104.5,33500 1580.1,33590 1764,33590 2104.5,33590 2104.5,33590 2104.5,33590 2104.5,33510 2104.5,33510"];
			k_proj_1_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,33536",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_5 -> flash_attn_1_long_5	[pos="e,1964.5,33500 1579.6,33536 1726.9,33536 1964.5,33536 1964.5,33536 1964.5,33536 1964.5,33510 1964.5,33510"];
			v_proj_1_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,33482",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_5 -> flash_attn_1_long_5	[pos="e,1823.6,33488 1579.8,33488 1579.8,33488 1813.6,33488 1813.6,33488"];
			flash_attn_1_long_5 -> reduce_1_long	[pos="e,2570.5,32470 2243.9,33482 2394.4,33482 2570.5,33482 2570.5,33482 2570.5,33482 2570.5,32480 2570.5,32480"];
			q_proj_1_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,33428",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,33320",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_6 -> flash_attn_1_long_6	[pos="e,2104.5,33338 1580.1,33428 1764,33428 2104.5,33428 2104.5,33428 2104.5,33428 2104.5,33348 2104.5,33348"];
			k_proj_1_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,33374",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_6 -> flash_attn_1_long_6	[pos="e,1964.5,33338 1579.6,33374 1726.9,33374 1964.5,33374 1964.5,33374 1964.5,33374 1964.5,33348 1964.5,33348"];
			v_proj_1_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,33320",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_6 -> flash_attn_1_long_6	[pos="e,1823.6,33326 1579.8,33326 1579.8,33326 1813.6,33326 1813.6,33326"];
			flash_attn_1_long_6 -> reduce_1_long	[pos="e,2537.5,32467 2244.1,33320 2382.2,33320 2537.5,33320 2537.5,33320 2537.5,33320 2537.5,32477 2537.5,32477"];
			q_proj_1_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,33266",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,33158",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_7 -> flash_attn_1_long_7	[pos="e,2104.5,33176 1580.1,33266 1764,33266 2104.5,33266 2104.5,33266 2104.5,33266 2104.5,33186 2104.5,33186"];
			k_proj_1_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,33212",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_7 -> flash_attn_1_long_7	[pos="e,1964.5,33176 1579.6,33212 1726.9,33212 1964.5,33212 1964.5,33212 1964.5,33212 1964.5,33186 1964.5,33186"];
			v_proj_1_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,33158",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_7 -> flash_attn_1_long_7	[pos="e,1823.6,33164 1579.8,33164 1579.8,33164 1813.6,33164 1813.6,33164"];
			flash_attn_1_long_7 -> reduce_1_long	[pos="e,2503.5,32465 2243.9,33158 2368.9,33158 2503.5,33158 2503.5,33158 2503.5,33158 2503.5,32475 2503.5,32475"];
			q_proj_1_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,33104",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_8<br/>Block: 9/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,32996",
				shape=rectangle,
				width=5.8333];
			q_proj_1_long_8 -> flash_attn_1_long_8	[pos="e,2104.5,33014 1580.1,33104 1764,33104 2104.5,33104 2104.5,33104 2104.5,33104 2104.5,33024 2104.5,33024"];
			k_proj_1_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,33050",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_8 -> flash_attn_1_long_8	[pos="e,1964.5,33014 1579.6,33050 1726.9,33050 1964.5,33050 1964.5,33050 1964.5,33050 1964.5,33024 1964.5,33024"];
			v_proj_1_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,32996",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_8 -> flash_attn_1_long_8	[pos="e,1823.6,33002 1579.8,33002 1579.8,33002 1813.6,33002 1813.6,33002"];
			flash_attn_1_long_8 -> reduce_1_long	[pos="e,2470.5,32463 2243.8,32996 2355.7,32996 2470.5,32996 2470.5,32996 2470.5,32996 2470.5,32473 2470.5,32473"];
			q_proj_1_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,32942",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_9<br/>Block: 10/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,32834",
				shape=rectangle,
				width=5.9028];
			q_proj_1_long_9 -> flash_attn_1_long_9	[pos="e,2104.5,32852 1580.1,32942 1764,32942 2104.5,32942 2104.5,32942 2104.5,32942 2104.5,32862 2104.5,32862"];
			k_proj_1_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,32888",
				shape=rectangle,
				width=3.1667];
			k_proj_1_long_9 -> flash_attn_1_long_9	[pos="e,1964.5,32852 1579.6,32888 1726.9,32888 1964.5,32888 1964.5,32888 1964.5,32888 1964.5,32862 1964.5,32862"];
			v_proj_1_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,32834",
				shape=rectangle,
				width=3.1667];
			v_proj_1_long_9 -> flash_attn_1_long_9	[pos="e,1821,32840 1579.8,32840 1579.8,32840 1811,32840 1811,32840"];
			flash_attn_1_long_9 -> reduce_1_long	[pos="e,2436.5,32460 2246.3,32834 2343.1,32834 2436.5,32834 2436.5,32834 2436.5,32834 2436.5,32470 2436.5,32470"];
			q_proj_1_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,32780",
				shape=rectangle,
				width=3.25];
			flash_attn_1_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_10<br/>Block: 11/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,32672",
				shape=rectangle,
				width=5.9861];
			q_proj_1_long_10 -> flash_attn_1_long_10	[pos="e,2105.5,32690 1582.5,32780 1767.2,32780 2105.5,32780 2105.5,32780 2105.5,32780 2105.5,32700 2105.5,32700"];
			k_proj_1_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,32726",
				shape=rectangle,
				width=3.2361];
			k_proj_1_long_10 -> flash_attn_1_long_10	[pos="e,1963.5,32690 1582.2,32726 1729.4,32726 1963.5,32726 1963.5,32726 1963.5,32726 1963.5,32700 1963.5,32700"];
			v_proj_1_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,32672",
				shape=rectangle,
				width=3.2361];
			v_proj_1_long_10 -> flash_attn_1_long_10	[pos="e,1818.1,32678 1582.2,32678 1582.2,32678 1808.1,32678 1808.1,32678"];
			flash_attn_1_long_10 -> reduce_1_long	[pos="e,2403.5,32458 2249.4,32672 2330.5,32672 2403.5,32672 2403.5,32672 2403.5,32672 2403.5,32468 2403.5,32468"];
			q_proj_1_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,32618",
				shape=rectangle,
				width=3.25];
			flash_attn_1_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_11<br/>Block: 12/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,32510",
				shape=rectangle,
				width=5.9861];
			q_proj_1_long_11 -> flash_attn_1_long_11	[pos="e,2106.5,32528 1582.7,32618 1767.6,32618 2106.5,32618 2106.5,32618 2106.5,32618 2106.5,32538 2106.5,32538"];
			k_proj_1_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,32564",
				shape=rectangle,
				width=3.2361];
			k_proj_1_long_11 -> flash_attn_1_long_11	[pos="e,1962.5,32528 1582,32564 1728.9,32564 1962.5,32564 1962.5,32564 1962.5,32564 1962.5,32538 1962.5,32538"];
			v_proj_1_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,32510",
				shape=rectangle,
				width=3.2361];
			v_proj_1_long_11 -> flash_attn_1_long_11	[pos="e,1818.1,32516 1582.2,32516 1582.2,32516 1808.1,32516 1808.1,32516"];
			flash_attn_1_long_11 -> reduce_1_long	[pos="e,2498.1,32464 2034.5,32492 2034.5,32479 2034.5,32464 2034.5,32464 2034.5,32464 2488.1,32464 2488.1,32464"];
			q_proj_1_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,32456",
				shape=rectangle,
				width=3.25];
			flash_attn_1_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_12<br/>Block: 13/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,32402",
				shape=rectangle,
				width=5.9861];
			q_proj_1_long_12 -> flash_attn_1_long_12	[pos="e,1926.5,32420 1582.7,32456 1719.3,32456 1926.5,32456 1926.5,32456 1926.5,32456 1926.5,32430 1926.5,32430"];
			k_proj_1_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,32402",
				shape=rectangle,
				width=3.2361];
			k_proj_1_long_12 -> flash_attn_1_long_12	[pos="e,1818.1,32408 1582.2,32408 1582.2,32408 1808.1,32408 1808.1,32408"];
			v_proj_1_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,32348",
				shape=rectangle,
				width=3.2361];
			v_proj_1_long_12 -> flash_attn_1_long_12	[pos="e,2106.5,32384 1582.3,32348 1767.2,32348 2106.5,32348 2106.5,32348 2106.5,32348 2106.5,32374 2106.5,32374"];
			flash_attn_1_long_12 -> reduce_1_long	[pos="e,2484.3,32447 2141.5,32420 2141.5,32433 2141.5,32447 2141.5,32447 2141.5,32447 2474.3,32447 2474.3,32447"];
			q_proj_1_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,32294",
				shape=rectangle,
				width=3.25];
			flash_attn_1_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_13<br/>Block: 14/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,32240",
				shape=rectangle,
				width=5.9861];
			q_proj_1_long_13 -> flash_attn_1_long_13	[pos="e,1962.5,32258 1582.6,32294 1729.6,32294 1962.5,32294 1962.5,32294 1962.5,32294 1962.5,32268 1962.5,32268"];
			k_proj_1_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,32240",
				shape=rectangle,
				width=3.2361];
			k_proj_1_long_13 -> flash_attn_1_long_13	[pos="e,1818.1,32246 1582.2,32246 1582.2,32246 1808.1,32246 1808.1,32246"];
			v_proj_1_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,32186",
				shape=rectangle,
				width=3.2361];
			v_proj_1_long_13 -> flash_attn_1_long_13	[pos="e,2106.5,32222 1582.3,32186 1767.2,32186 2106.5,32186 2106.5,32186 2106.5,32186 2106.5,32212 2106.5,32212"];
			flash_attn_1_long_13 -> reduce_1_long	[pos="e,2771.5,32448 2249.6,32240 2467.3,32240 2771.5,32240 2771.5,32240 2771.5,32240 2771.5,32438 2771.5,32438"];
			q_proj_1_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,32132",
				shape=rectangle,
				width=3.25];
			flash_attn_1_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_14<br/>Block: 15/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,32078",
				shape=rectangle,
				width=5.9861];
			q_proj_1_long_14 -> flash_attn_1_long_14	[pos="e,1962.5,32096 1582.6,32132 1729.6,32132 1962.5,32132 1962.5,32132 1962.5,32132 1962.5,32106 1962.5,32106"];
			k_proj_1_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,32078",
				shape=rectangle,
				width=3.2361];
			k_proj_1_long_14 -> flash_attn_1_long_14	[pos="e,1818.1,32084 1582.2,32084 1582.2,32084 1808.1,32084 1808.1,32084"];
			v_proj_1_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,32024",
				shape=rectangle,
				width=3.2361];
			v_proj_1_long_14 -> flash_attn_1_long_14	[pos="e,2106.5,32060 1582.3,32024 1767.2,32024 2106.5,32024 2106.5,32024 2106.5,32024 2106.5,32050 2106.5,32050"];
			flash_attn_1_long_14 -> reduce_1_long	[pos="e,2805.5,32450 2249.5,32078 2477.8,32078 2805.5,32078 2805.5,32078 2805.5,32078 2805.5,32440 2805.5,32440"];
			q_proj_1_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,31970",
				shape=rectangle,
				width=3.25];
			flash_attn_1_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_15<br/>Block: 16/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,31916",
				shape=rectangle,
				width=5.9861];
			q_proj_1_long_15 -> flash_attn_1_long_15	[pos="e,1962.5,31934 1582.6,31970 1729.6,31970 1962.5,31970 1962.5,31970 1962.5,31970 1962.5,31944 1962.5,31944"];
			k_proj_1_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,31916",
				shape=rectangle,
				width=3.2361];
			k_proj_1_long_15 -> flash_attn_1_long_15	[pos="e,1818.1,31922 1582.2,31922 1582.2,31922 1808.1,31922 1808.1,31922"];
			v_proj_1_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,31862",
				shape=rectangle,
				width=3.2361];
			v_proj_1_long_15 -> flash_attn_1_long_15	[pos="e,2139.5,31898 1582.1,31862 1775,31862 2139.5,31862 2139.5,31862 2139.5,31862 2139.5,31888 2139.5,31888"];
			flash_attn_1_long_15 -> reduce_1_long	[pos="e,2839.5,32453 2249.4,31916 2488.1,31916 2839.5,31916 2839.5,31916 2839.5,31916 2839.5,32443 2839.5,32443"];
		}
		subgraph cluster_layer2_long {
			graph [bb="1340.5,29219,2880.1,31828",
				fontsize=10,
				label="Layer 2",
				lheight=0.15,
				lp="2110.3,31818",
				lwidth=0.54
			];
			q_proj_2_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,31783",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,31675",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_0 -> flash_attn_2_long_0	[pos="e,2034.5,31693 1580.3,31783 1746.5,31783 2034.5,31783 2034.5,31783 2034.5,31783 2034.5,31703 2034.5,31703"];
			k_proj_2_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,31729",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_0 -> flash_attn_2_long_0	[pos="e,1929.5,31693 1579.6,31729 1717,31729 1929.5,31729 1929.5,31729 1929.5,31729 1929.5,31703 1929.5,31703"];
			v_proj_2_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,31675",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_0 -> flash_attn_2_long_0	[pos="e,1823.6,31681 1579.8,31681 1579.8,31681 1813.6,31681 1813.6,31681"];
			reduce_2_long	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>16→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,29838",
				shape=diamond,
				width=6.9856];
			flash_attn_2_long_0 -> reduce_2_long	[pos="e,2738.5,29848 2243.7,31675 2451.5,31675 2738.5,31675 2738.5,31675 2738.5,31675 2738.5,29858 2738.5,29858"];
			q_proj_2_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,31621",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,31513",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_1 -> flash_attn_2_long_1	[pos="e,2104.5,31531 1580.1,31621 1764,31621 2104.5,31621 2104.5,31621 2104.5,31621 2104.5,31541 2104.5,31541"];
			k_proj_2_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,31567",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_1 -> flash_attn_2_long_1	[pos="e,1964.5,31531 1579.6,31567 1726.9,31567 1964.5,31567 1964.5,31567 1964.5,31567 1964.5,31541 1964.5,31541"];
			v_proj_2_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,31513",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_1 -> flash_attn_2_long_1	[pos="e,1823.6,31519 1579.8,31519 1579.8,31519 1813.6,31519 1813.6,31519"];
			flash_attn_2_long_1 -> reduce_2_long	[pos="e,2704.5,29850 2244.1,31513 2440.8,31513 2704.5,31513 2704.5,31513 2704.5,31513 2704.5,29860 2704.5,29860"];
			q_proj_2_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,31459",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,31351",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_2 -> flash_attn_2_long_2	[pos="e,2104.5,31369 1580.1,31459 1764,31459 2104.5,31459 2104.5,31459 2104.5,31459 2104.5,31379 2104.5,31379"];
			k_proj_2_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,31405",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_2 -> flash_attn_2_long_2	[pos="e,1964.5,31369 1579.6,31405 1726.9,31405 1964.5,31405 1964.5,31405 1964.5,31405 1964.5,31379 1964.5,31379"];
			v_proj_2_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,31351",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_2 -> flash_attn_2_long_2	[pos="e,1823.6,31357 1579.8,31357 1579.8,31357 1813.6,31357 1813.6,31357"];
			flash_attn_2_long_2 -> reduce_2_long	[pos="e,2671.5,29852 2243.9,31351 2429.7,31351 2671.5,31351 2671.5,31351 2671.5,31351 2671.5,29862 2671.5,29862"];
			q_proj_2_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,31297",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,31189",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_3 -> flash_attn_2_long_3	[pos="e,2104.5,31207 1580.1,31297 1764,31297 2104.5,31297 2104.5,31297 2104.5,31297 2104.5,31217 2104.5,31217"];
			k_proj_2_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,31243",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_3 -> flash_attn_2_long_3	[pos="e,1964.5,31207 1579.6,31243 1726.9,31243 1964.5,31243 1964.5,31243 1964.5,31243 1964.5,31217 1964.5,31217"];
			v_proj_2_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,31189",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_3 -> flash_attn_2_long_3	[pos="e,1823.6,31195 1579.8,31195 1579.8,31195 1813.6,31195 1813.6,31195"];
			flash_attn_2_long_3 -> reduce_2_long	[pos="e,2637.5,29855 2244,31189 2418.3,31189 2637.5,31189 2637.5,31189 2637.5,31189 2637.5,29865 2637.5,29865"];
			q_proj_2_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,31135",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,31027",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_4 -> flash_attn_2_long_4	[pos="e,2104.5,31045 1580.1,31135 1764,31135 2104.5,31135 2104.5,31135 2104.5,31135 2104.5,31055 2104.5,31055"];
			k_proj_2_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,31081",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_4 -> flash_attn_2_long_4	[pos="e,1964.5,31045 1579.6,31081 1726.9,31081 1964.5,31081 1964.5,31081 1964.5,31081 1964.5,31055 1964.5,31055"];
			v_proj_2_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,31027",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_4 -> flash_attn_2_long_4	[pos="e,1823.6,31033 1579.8,31033 1579.8,31033 1813.6,31033 1813.6,31033"];
			flash_attn_2_long_4 -> reduce_2_long	[pos="e,2604.5,29855 2243.8,31027 2406.6,31027 2604.5,31027 2604.5,31027 2604.5,31027 2604.5,29865 2604.5,29865"];
			q_proj_2_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,30973",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,30865",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_5 -> flash_attn_2_long_5	[pos="e,2104.5,30883 1580.1,30973 1764,30973 2104.5,30973 2104.5,30973 2104.5,30973 2104.5,30893 2104.5,30893"];
			k_proj_2_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,30919",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_5 -> flash_attn_2_long_5	[pos="e,1964.5,30883 1579.6,30919 1726.9,30919 1964.5,30919 1964.5,30919 1964.5,30919 1964.5,30893 1964.5,30893"];
			v_proj_2_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,30865",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_5 -> flash_attn_2_long_5	[pos="e,1823.6,30871 1579.8,30871 1579.8,30871 1813.6,30871 1813.6,30871"];
			flash_attn_2_long_5 -> reduce_2_long	[pos="e,2570.5,29853 2243.9,30865 2394.4,30865 2570.5,30865 2570.5,30865 2570.5,30865 2570.5,29863 2570.5,29863"];
			q_proj_2_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,30811",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,30703",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_6 -> flash_attn_2_long_6	[pos="e,2104.5,30721 1580.1,30811 1764,30811 2104.5,30811 2104.5,30811 2104.5,30811 2104.5,30731 2104.5,30731"];
			k_proj_2_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,30757",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_6 -> flash_attn_2_long_6	[pos="e,1964.5,30721 1579.6,30757 1726.9,30757 1964.5,30757 1964.5,30757 1964.5,30757 1964.5,30731 1964.5,30731"];
			v_proj_2_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,30703",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_6 -> flash_attn_2_long_6	[pos="e,1823.6,30709 1579.8,30709 1579.8,30709 1813.6,30709 1813.6,30709"];
			flash_attn_2_long_6 -> reduce_2_long	[pos="e,2537.5,29850 2244.1,30703 2382.2,30703 2537.5,30703 2537.5,30703 2537.5,30703 2537.5,29860 2537.5,29860"];
			q_proj_2_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,30649",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,30541",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_7 -> flash_attn_2_long_7	[pos="e,2104.5,30559 1580.1,30649 1764,30649 2104.5,30649 2104.5,30649 2104.5,30649 2104.5,30569 2104.5,30569"];
			k_proj_2_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,30595",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_7 -> flash_attn_2_long_7	[pos="e,1964.5,30559 1579.6,30595 1726.9,30595 1964.5,30595 1964.5,30595 1964.5,30595 1964.5,30569 1964.5,30569"];
			v_proj_2_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,30541",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_7 -> flash_attn_2_long_7	[pos="e,1823.6,30547 1579.8,30547 1579.8,30547 1813.6,30547 1813.6,30547"];
			flash_attn_2_long_7 -> reduce_2_long	[pos="e,2503.5,29848 2243.9,30541 2368.9,30541 2503.5,30541 2503.5,30541 2503.5,30541 2503.5,29858 2503.5,29858"];
			q_proj_2_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,30487",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_8<br/>Block: 9/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,30379",
				shape=rectangle,
				width=5.8333];
			q_proj_2_long_8 -> flash_attn_2_long_8	[pos="e,2104.5,30397 1580.1,30487 1764,30487 2104.5,30487 2104.5,30487 2104.5,30487 2104.5,30407 2104.5,30407"];
			k_proj_2_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,30433",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_8 -> flash_attn_2_long_8	[pos="e,1964.5,30397 1579.6,30433 1726.9,30433 1964.5,30433 1964.5,30433 1964.5,30433 1964.5,30407 1964.5,30407"];
			v_proj_2_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,30379",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_8 -> flash_attn_2_long_8	[pos="e,1823.6,30385 1579.8,30385 1579.8,30385 1813.6,30385 1813.6,30385"];
			flash_attn_2_long_8 -> reduce_2_long	[pos="e,2470.5,29846 2243.8,30379 2355.7,30379 2470.5,30379 2470.5,30379 2470.5,30379 2470.5,29856 2470.5,29856"];
			q_proj_2_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,30325",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_9<br/>Block: 10/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,30217",
				shape=rectangle,
				width=5.9028];
			q_proj_2_long_9 -> flash_attn_2_long_9	[pos="e,2104.5,30235 1580.1,30325 1764,30325 2104.5,30325 2104.5,30325 2104.5,30325 2104.5,30245 2104.5,30245"];
			k_proj_2_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,30271",
				shape=rectangle,
				width=3.1667];
			k_proj_2_long_9 -> flash_attn_2_long_9	[pos="e,1964.5,30235 1579.6,30271 1726.9,30271 1964.5,30271 1964.5,30271 1964.5,30271 1964.5,30245 1964.5,30245"];
			v_proj_2_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,30217",
				shape=rectangle,
				width=3.1667];
			v_proj_2_long_9 -> flash_attn_2_long_9	[pos="e,1821,30223 1579.8,30223 1579.8,30223 1811,30223 1811,30223"];
			flash_attn_2_long_9 -> reduce_2_long	[pos="e,2436.5,29843 2246.3,30217 2343.1,30217 2436.5,30217 2436.5,30217 2436.5,30217 2436.5,29853 2436.5,29853"];
			q_proj_2_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,30163",
				shape=rectangle,
				width=3.25];
			flash_attn_2_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_10<br/>Block: 11/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,30055",
				shape=rectangle,
				width=5.9861];
			q_proj_2_long_10 -> flash_attn_2_long_10	[pos="e,2105.5,30073 1582.5,30163 1767.2,30163 2105.5,30163 2105.5,30163 2105.5,30163 2105.5,30083 2105.5,30083"];
			k_proj_2_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,30109",
				shape=rectangle,
				width=3.2361];
			k_proj_2_long_10 -> flash_attn_2_long_10	[pos="e,1963.5,30073 1582.2,30109 1729.4,30109 1963.5,30109 1963.5,30109 1963.5,30109 1963.5,30083 1963.5,30083"];
			v_proj_2_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,30055",
				shape=rectangle,
				width=3.2361];
			v_proj_2_long_10 -> flash_attn_2_long_10	[pos="e,1818.1,30061 1582.2,30061 1582.2,30061 1808.1,30061 1808.1,30061"];
			flash_attn_2_long_10 -> reduce_2_long	[pos="e,2403.5,29841 2249.4,30055 2330.5,30055 2403.5,30055 2403.5,30055 2403.5,30055 2403.5,29851 2403.5,29851"];
			q_proj_2_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,30001",
				shape=rectangle,
				width=3.25];
			flash_attn_2_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_11<br/>Block: 12/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,29893",
				shape=rectangle,
				width=5.9861];
			q_proj_2_long_11 -> flash_attn_2_long_11	[pos="e,2106.5,29911 1582.7,30001 1767.6,30001 2106.5,30001 2106.5,30001 2106.5,30001 2106.5,29921 2106.5,29921"];
			k_proj_2_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,29947",
				shape=rectangle,
				width=3.2361];
			k_proj_2_long_11 -> flash_attn_2_long_11	[pos="e,1962.5,29911 1582,29947 1728.9,29947 1962.5,29947 1962.5,29947 1962.5,29947 1962.5,29921 1962.5,29921"];
			v_proj_2_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,29893",
				shape=rectangle,
				width=3.2361];
			v_proj_2_long_11 -> flash_attn_2_long_11	[pos="e,1818.1,29899 1582.2,29899 1582.2,29899 1808.1,29899 1808.1,29899"];
			flash_attn_2_long_11 -> reduce_2_long	[pos="e,2498.1,29847 2034.5,29875 2034.5,29862 2034.5,29847 2034.5,29847 2034.5,29847 2488.1,29847 2488.1,29847"];
			q_proj_2_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,29839",
				shape=rectangle,
				width=3.25];
			flash_attn_2_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_12<br/>Block: 13/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,29785",
				shape=rectangle,
				width=5.9861];
			q_proj_2_long_12 -> flash_attn_2_long_12	[pos="e,1926.5,29803 1582.7,29838 1719.3,29838 1926.5,29838 1926.5,29838 1926.5,29838 1926.5,29813 1926.5,29813"];
			k_proj_2_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,29785",
				shape=rectangle,
				width=3.2361];
			k_proj_2_long_12 -> flash_attn_2_long_12	[pos="e,1818.1,29791 1582.2,29791 1582.2,29791 1808.1,29791 1808.1,29791"];
			v_proj_2_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,29731",
				shape=rectangle,
				width=3.2361];
			v_proj_2_long_12 -> flash_attn_2_long_12	[pos="e,2106.5,29767 1582.3,29731 1767.2,29731 2106.5,29731 2106.5,29731 2106.5,29731 2106.5,29757 2106.5,29757"];
			flash_attn_2_long_12 -> reduce_2_long	[pos="e,2484.3,29830 2141.5,29803 2141.5,29816 2141.5,29830 2141.5,29830 2141.5,29830 2474.3,29830 2474.3,29830"];
			q_proj_2_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,29677",
				shape=rectangle,
				width=3.25];
			flash_attn_2_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_13<br/>Block: 14/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,29623",
				shape=rectangle,
				width=5.9861];
			q_proj_2_long_13 -> flash_attn_2_long_13	[pos="e,1962.5,29641 1582.6,29677 1729.6,29677 1962.5,29677 1962.5,29677 1962.5,29677 1962.5,29651 1962.5,29651"];
			k_proj_2_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,29623",
				shape=rectangle,
				width=3.2361];
			k_proj_2_long_13 -> flash_attn_2_long_13	[pos="e,1818.1,29629 1582.2,29629 1582.2,29629 1808.1,29629 1808.1,29629"];
			v_proj_2_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,29569",
				shape=rectangle,
				width=3.2361];
			v_proj_2_long_13 -> flash_attn_2_long_13	[pos="e,2106.5,29605 1582.3,29569 1767.2,29569 2106.5,29569 2106.5,29569 2106.5,29569 2106.5,29595 2106.5,29595"];
			flash_attn_2_long_13 -> reduce_2_long	[pos="e,2771.5,29831 2249.6,29623 2467.3,29623 2771.5,29623 2771.5,29623 2771.5,29623 2771.5,29821 2771.5,29821"];
			q_proj_2_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,29515",
				shape=rectangle,
				width=3.25];
			flash_attn_2_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_14<br/>Block: 15/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,29461",
				shape=rectangle,
				width=5.9861];
			q_proj_2_long_14 -> flash_attn_2_long_14	[pos="e,1962.5,29479 1582.6,29515 1729.6,29515 1962.5,29515 1962.5,29515 1962.5,29515 1962.5,29489 1962.5,29489"];
			k_proj_2_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,29461",
				shape=rectangle,
				width=3.2361];
			k_proj_2_long_14 -> flash_attn_2_long_14	[pos="e,1818.1,29467 1582.2,29467 1582.2,29467 1808.1,29467 1808.1,29467"];
			v_proj_2_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,29407",
				shape=rectangle,
				width=3.2361];
			v_proj_2_long_14 -> flash_attn_2_long_14	[pos="e,2106.5,29443 1582.3,29407 1767.2,29407 2106.5,29407 2106.5,29407 2106.5,29407 2106.5,29433 2106.5,29433"];
			flash_attn_2_long_14 -> reduce_2_long	[pos="e,2805.5,29833 2249.5,29461 2477.8,29461 2805.5,29461 2805.5,29461 2805.5,29461 2805.5,29823 2805.5,29823"];
			q_proj_2_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,29353",
				shape=rectangle,
				width=3.25];
			flash_attn_2_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_15<br/>Block: 16/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,29299",
				shape=rectangle,
				width=5.9861];
			q_proj_2_long_15 -> flash_attn_2_long_15	[pos="e,1962.5,29317 1582.6,29353 1729.6,29353 1962.5,29353 1962.5,29353 1962.5,29353 1962.5,29327 1962.5,29327"];
			k_proj_2_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,29299",
				shape=rectangle,
				width=3.2361];
			k_proj_2_long_15 -> flash_attn_2_long_15	[pos="e,1818.1,29305 1582.2,29305 1582.2,29305 1808.1,29305 1808.1,29305"];
			v_proj_2_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,29245",
				shape=rectangle,
				width=3.2361];
			v_proj_2_long_15 -> flash_attn_2_long_15	[pos="e,2139.5,29281 1582.1,29245 1775,29245 2139.5,29245 2139.5,29245 2139.5,29245 2139.5,29271 2139.5,29271"];
			flash_attn_2_long_15 -> reduce_2_long	[pos="e,2839.5,29836 2249.4,29299 2488.1,29299 2839.5,29299 2839.5,29299 2839.5,29299 2839.5,29826 2839.5,29826"];
		}
		subgraph cluster_layer3_long {
			graph [bb="1340.5,26602,2880.1,29211",
				fontsize=10,
				label="Layer 3",
				lheight=0.15,
				lp="2110.3,29202",
				lwidth=0.54
			];
			q_proj_3_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,29166",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,29058",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_0 -> flash_attn_3_long_0	[pos="e,2034.5,29076 1580.3,29166 1746.5,29166 2034.5,29166 2034.5,29166 2034.5,29166 2034.5,29086 2034.5,29086"];
			k_proj_3_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,29112",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_0 -> flash_attn_3_long_0	[pos="e,1929.5,29076 1579.6,29112 1717,29112 1929.5,29112 1929.5,29112 1929.5,29112 1929.5,29086 1929.5,29086"];
			v_proj_3_long_0	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,29058",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_0 -> flash_attn_3_long_0	[pos="e,1823.6,29064 1579.8,29064 1579.8,29064 1813.6,29064 1813.6,29064"];
			reduce_3_long	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>16→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,27221",
				shape=diamond,
				width=6.9856];
			flash_attn_3_long_0 -> reduce_3_long	[pos="e,2738.5,27231 2243.7,29058 2451.5,29058 2738.5,29058 2738.5,29058 2738.5,29058 2738.5,27241 2738.5,27241"];
			q_proj_3_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,29004",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,28896",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_1 -> flash_attn_3_long_1	[pos="e,2104.5,28914 1580.1,29004 1764,29004 2104.5,29004 2104.5,29004 2104.5,29004 2104.5,28924 2104.5,28924"];
			k_proj_3_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,28950",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_1 -> flash_attn_3_long_1	[pos="e,1964.5,28914 1579.6,28950 1726.9,28950 1964.5,28950 1964.5,28950 1964.5,28950 1964.5,28924 1964.5,28924"];
			v_proj_3_long_1	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,28896",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_1 -> flash_attn_3_long_1	[pos="e,1823.6,28902 1579.8,28902 1579.8,28902 1813.6,28902 1813.6,28902"];
			flash_attn_3_long_1 -> reduce_3_long	[pos="e,2704.5,27233 2244.1,28896 2440.8,28896 2704.5,28896 2704.5,28896 2704.5,28896 2704.5,27243 2704.5,27243"];
			q_proj_3_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,28842",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,28734",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_2 -> flash_attn_3_long_2	[pos="e,2104.5,28752 1580.1,28842 1764,28842 2104.5,28842 2104.5,28842 2104.5,28842 2104.5,28762 2104.5,28762"];
			k_proj_3_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,28788",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_2 -> flash_attn_3_long_2	[pos="e,1964.5,28752 1579.6,28788 1726.9,28788 1964.5,28788 1964.5,28788 1964.5,28788 1964.5,28762 1964.5,28762"];
			v_proj_3_long_2	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,28734",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_2 -> flash_attn_3_long_2	[pos="e,1823.6,28740 1579.8,28740 1579.8,28740 1813.6,28740 1813.6,28740"];
			flash_attn_3_long_2 -> reduce_3_long	[pos="e,2671.5,27235 2243.9,28734 2429.7,28734 2671.5,28734 2671.5,28734 2671.5,28734 2671.5,27245 2671.5,27245"];
			q_proj_3_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,28680",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,28572",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_3 -> flash_attn_3_long_3	[pos="e,2104.5,28590 1580.1,28680 1764,28680 2104.5,28680 2104.5,28680 2104.5,28680 2104.5,28600 2104.5,28600"];
			k_proj_3_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,28626",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_3 -> flash_attn_3_long_3	[pos="e,1964.5,28590 1579.6,28626 1726.9,28626 1964.5,28626 1964.5,28626 1964.5,28626 1964.5,28600 1964.5,28600"];
			v_proj_3_long_3	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,28572",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_3 -> flash_attn_3_long_3	[pos="e,1823.6,28578 1579.8,28578 1579.8,28578 1813.6,28578 1813.6,28578"];
			flash_attn_3_long_3 -> reduce_3_long	[pos="e,2637.5,27238 2244,28572 2418.3,28572 2637.5,28572 2637.5,28572 2637.5,28572 2637.5,27248 2637.5,27248"];
			q_proj_3_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,28518",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,28410",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_4 -> flash_attn_3_long_4	[pos="e,2104.5,28428 1580.1,28518 1764,28518 2104.5,28518 2104.5,28518 2104.5,28518 2104.5,28438 2104.5,28438"];
			k_proj_3_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,28464",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_4 -> flash_attn_3_long_4	[pos="e,1964.5,28428 1579.6,28464 1726.9,28464 1964.5,28464 1964.5,28464 1964.5,28464 1964.5,28438 1964.5,28438"];
			v_proj_3_long_4	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,28410",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_4 -> flash_attn_3_long_4	[pos="e,1823.6,28416 1579.8,28416 1579.8,28416 1813.6,28416 1813.6,28416"];
			flash_attn_3_long_4 -> reduce_3_long	[pos="e,2604.5,27238 2243.8,28410 2406.6,28410 2604.5,28410 2604.5,28410 2604.5,28410 2604.5,27248 2604.5,27248"];
			q_proj_3_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,28356",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,28248",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_5 -> flash_attn_3_long_5	[pos="e,2104.5,28266 1580.1,28356 1764,28356 2104.5,28356 2104.5,28356 2104.5,28356 2104.5,28276 2104.5,28276"];
			k_proj_3_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,28302",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_5 -> flash_attn_3_long_5	[pos="e,1964.5,28266 1579.6,28302 1726.9,28302 1964.5,28302 1964.5,28302 1964.5,28302 1964.5,28276 1964.5,28276"];
			v_proj_3_long_5	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,28248",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_5 -> flash_attn_3_long_5	[pos="e,1823.6,28254 1579.8,28254 1579.8,28254 1813.6,28254 1813.6,28254"];
			flash_attn_3_long_5 -> reduce_3_long	[pos="e,2570.5,27236 2243.9,28248 2394.4,28248 2570.5,28248 2570.5,28248 2570.5,28248 2570.5,27246 2570.5,27246"];
			q_proj_3_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,28194",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,28086",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_6 -> flash_attn_3_long_6	[pos="e,2104.5,28104 1580.1,28194 1764,28194 2104.5,28194 2104.5,28194 2104.5,28194 2104.5,28114 2104.5,28114"];
			k_proj_3_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,28140",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_6 -> flash_attn_3_long_6	[pos="e,1964.5,28104 1579.6,28140 1726.9,28140 1964.5,28140 1964.5,28140 1964.5,28140 1964.5,28114 1964.5,28114"];
			v_proj_3_long_6	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,28086",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_6 -> flash_attn_3_long_6	[pos="e,1823.6,28092 1579.8,28092 1579.8,28092 1813.6,28092 1813.6,28092"];
			flash_attn_3_long_6 -> reduce_3_long	[pos="e,2537.5,27233 2244.1,28086 2382.2,28086 2537.5,28086 2537.5,28086 2537.5,28086 2537.5,27243 2537.5,27243"];
			q_proj_3_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,28032",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,27924",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_7 -> flash_attn_3_long_7	[pos="e,2104.5,27942 1580.1,28032 1764,28032 2104.5,28032 2104.5,28032 2104.5,28032 2104.5,27952 2104.5,27952"];
			k_proj_3_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,27978",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_7 -> flash_attn_3_long_7	[pos="e,1964.5,27942 1579.6,27978 1726.9,27978 1964.5,27978 1964.5,27978 1964.5,27978 1964.5,27952 1964.5,27952"];
			v_proj_3_long_7	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,27924",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_7 -> flash_attn_3_long_7	[pos="e,1823.6,27930 1579.8,27930 1579.8,27930 1813.6,27930 1813.6,27930"];
			flash_attn_3_long_7 -> reduce_3_long	[pos="e,2503.5,27231 2243.9,27924 2368.9,27924 2503.5,27924 2503.5,27924 2503.5,27924 2503.5,27241 2503.5,27241"];
			q_proj_3_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,27870",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_8<br/>Block: 9/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,27762",
				shape=rectangle,
				width=5.8333];
			q_proj_3_long_8 -> flash_attn_3_long_8	[pos="e,2104.5,27780 1580.1,27870 1764,27870 2104.5,27870 2104.5,27870 2104.5,27870 2104.5,27790 2104.5,27790"];
			k_proj_3_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,27816",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_8 -> flash_attn_3_long_8	[pos="e,1964.5,27780 1579.6,27816 1726.9,27816 1964.5,27816 1964.5,27816 1964.5,27816 1964.5,27790 1964.5,27790"];
			v_proj_3_long_8	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,27762",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_8 -> flash_attn_3_long_8	[pos="e,1823.6,27768 1579.8,27768 1579.8,27768 1813.6,27768 1813.6,27768"];
			flash_attn_3_long_8 -> reduce_3_long	[pos="e,2470.5,27229 2243.8,27762 2355.7,27762 2470.5,27762 2470.5,27762 2470.5,27762 2470.5,27239 2470.5,27239"];
			q_proj_3_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,27708",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_9<br/>Block: 10/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,27600",
				shape=rectangle,
				width=5.9028];
			q_proj_3_long_9 -> flash_attn_3_long_9	[pos="e,2104.5,27618 1580.1,27708 1764,27708 2104.5,27708 2104.5,27708 2104.5,27708 2104.5,27628 2104.5,27628"];
			k_proj_3_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,27654",
				shape=rectangle,
				width=3.1667];
			k_proj_3_long_9 -> flash_attn_3_long_9	[pos="e,1964.5,27618 1579.6,27654 1726.9,27654 1964.5,27654 1964.5,27654 1964.5,27654 1964.5,27628 1964.5,27628"];
			v_proj_3_long_9	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,27600",
				shape=rectangle,
				width=3.1667];
			v_proj_3_long_9 -> flash_attn_3_long_9	[pos="e,1821,27606 1579.8,27606 1579.8,27606 1811,27606 1811,27606"];
			flash_attn_3_long_9 -> reduce_3_long	[pos="e,2436.5,27226 2246.3,27600 2343.1,27600 2436.5,27600 2436.5,27600 2436.5,27600 2436.5,27236 2436.5,27236"];
			q_proj_3_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,27546",
				shape=rectangle,
				width=3.25];
			flash_attn_3_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_10<br/>Block: 11/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,27438",
				shape=rectangle,
				width=5.9861];
			q_proj_3_long_10 -> flash_attn_3_long_10	[pos="e,2105.5,27456 1582.5,27546 1767.2,27546 2105.5,27546 2105.5,27546 2105.5,27546 2105.5,27466 2105.5,27466"];
			k_proj_3_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,27492",
				shape=rectangle,
				width=3.2361];
			k_proj_3_long_10 -> flash_attn_3_long_10	[pos="e,1963.5,27456 1582.2,27492 1729.4,27492 1963.5,27492 1963.5,27492 1963.5,27492 1963.5,27466 1963.5,27466"];
			v_proj_3_long_10	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,27438",
				shape=rectangle,
				width=3.2361];
			v_proj_3_long_10 -> flash_attn_3_long_10	[pos="e,1818.1,27444 1582.2,27444 1582.2,27444 1808.1,27444 1808.1,27444"];
			flash_attn_3_long_10 -> reduce_3_long	[pos="e,2403.5,27224 2249.4,27438 2330.5,27438 2403.5,27438 2403.5,27438 2403.5,27438 2403.5,27234 2403.5,27234"];
			q_proj_3_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,27384",
				shape=rectangle,
				width=3.25];
			flash_attn_3_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_11<br/>Block: 12/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,27276",
				shape=rectangle,
				width=5.9861];
			q_proj_3_long_11 -> flash_attn_3_long_11	[pos="e,2106.5,27294 1582.7,27384 1767.6,27384 2106.5,27384 2106.5,27384 2106.5,27384 2106.5,27304 2106.5,27304"];
			k_proj_3_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,27330",
				shape=rectangle,
				width=3.2361];
			k_proj_3_long_11 -> flash_attn_3_long_11	[pos="e,1962.5,27294 1582,27330 1728.9,27330 1962.5,27330 1962.5,27330 1962.5,27330 1962.5,27304 1962.5,27304"];
			v_proj_3_long_11	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,27276",
				shape=rectangle,
				width=3.2361];
			v_proj_3_long_11 -> flash_attn_3_long_11	[pos="e,1818.1,27282 1582.2,27282 1582.2,27282 1808.1,27282 1808.1,27282"];
			flash_attn_3_long_11 -> reduce_3_long	[pos="e,2498.1,27230 2034.5,27258 2034.5,27245 2034.5,27230 2034.5,27230 2034.5,27230 2488.1,27230 2488.1,27230"];
			q_proj_3_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,27222",
				shape=rectangle,
				width=3.25];
			flash_attn_3_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_12<br/>Block: 13/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,27168",
				shape=rectangle,
				width=5.9861];
			q_proj_3_long_12 -> flash_attn_3_long_12	[pos="e,1926.5,27186 1582.7,27222 1719.3,27222 1926.5,27222 1926.5,27222 1926.5,27222 1926.5,27196 1926.5,27196"];
			k_proj_3_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,27168",
				shape=rectangle,
				width=3.2361];
			k_proj_3_long_12 -> flash_attn_3_long_12	[pos="e,1818.1,27174 1582.2,27174 1582.2,27174 1808.1,27174 1808.1,27174"];
			v_proj_3_long_12	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,27114",
				shape=rectangle,
				width=3.2361];
			v_proj_3_long_12 -> flash_attn_3_long_12	[pos="e,2106.5,27150 1582.3,27114 1767.2,27114 2106.5,27114 2106.5,27114 2106.5,27114 2106.5,27140 2106.5,27140"];
			flash_attn_3_long_12 -> reduce_3_long	[pos="e,2484.3,27213 2141.5,27186 2141.5,27199 2141.5,27213 2141.5,27213 2141.5,27213 2474.3,27213 2474.3,27213"];
			q_proj_3_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,27060",
				shape=rectangle,
				width=3.25];
			flash_attn_3_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_13<br/>Block: 14/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,27006",
				shape=rectangle,
				width=5.9861];
			q_proj_3_long_13 -> flash_attn_3_long_13	[pos="e,1962.5,27024 1582.6,27060 1729.6,27060 1962.5,27060 1962.5,27060 1962.5,27060 1962.5,27034 1962.5,27034"];
			k_proj_3_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,27006",
				shape=rectangle,
				width=3.2361];
			k_proj_3_long_13 -> flash_attn_3_long_13	[pos="e,1818.1,27012 1582.2,27012 1582.2,27012 1808.1,27012 1808.1,27012"];
			v_proj_3_long_13	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,26952",
				shape=rectangle,
				width=3.2361];
			v_proj_3_long_13 -> flash_attn_3_long_13	[pos="e,2106.5,26988 1582.3,26952 1767.2,26952 2106.5,26952 2106.5,26952 2106.5,26952 2106.5,26978 2106.5,26978"];
			flash_attn_3_long_13 -> reduce_3_long	[pos="e,2793.5,27215 2249.4,27006 2474,27006 2793.5,27006 2793.5,27006 2793.5,27006 2793.5,27205 2793.5,27205"];
			q_proj_3_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,26898",
				shape=rectangle,
				width=3.25];
			flash_attn_3_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_14<br/>Block: 15/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,26844",
				shape=rectangle,
				width=5.9861];
			q_proj_3_long_14 -> flash_attn_3_long_14	[pos="e,1962.5,26862 1582.6,26898 1729.6,26898 1962.5,26898 1962.5,26898 1962.5,26898 1962.5,26872 1962.5,26872"];
			k_proj_3_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,26844",
				shape=rectangle,
				width=3.2361];
			k_proj_3_long_14 -> flash_attn_3_long_14	[pos="e,1818.1,26850 1582.2,26850 1582.2,26850 1808.1,26850 1808.1,26850"];
			v_proj_3_long_14	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,26790",
				shape=rectangle,
				width=3.2361];
			v_proj_3_long_14 -> flash_attn_3_long_14	[pos="e,2106.5,26826 1582.3,26790 1767.2,26790 2106.5,26790 2106.5,26790 2106.5,26790 2106.5,26816 2106.5,26816"];
			flash_attn_3_long_14 -> reduce_3_long	[pos="e,2819.5,27217 2249.5,26844 2482.1,26844 2819.5,26844 2819.5,26844 2819.5,26844 2819.5,27207 2819.5,27207"];
			q_proj_3_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,26736",
				shape=rectangle,
				width=3.25];
			flash_attn_3_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_15<br/>Block: 16/16<br/>[batch=1024, seq=ceil(seq/16), 4096]",
				pos="2033.7,26682",
				shape=rectangle,
				width=5.9861];
			q_proj_3_long_15 -> flash_attn_3_long_15	[pos="e,1962.5,26700 1582.6,26736 1729.6,26736 1962.5,26736 1962.5,26736 1962.5,26736 1962.5,26710 1962.5,26710"];
			k_proj_3_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,26682",
				shape=rectangle,
				width=3.2361];
			k_proj_3_long_15 -> flash_attn_3_long_15	[pos="e,1818.1,26688 1582.2,26688 1582.2,26688 1808.1,26688 1808.1,26688"];
			v_proj_3_long_15	[fillcolor=lightyellow,
				height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,26628",
				shape=rectangle,
				width=3.2361];
			v_proj_3_long_15 -> flash_attn_3_long_15	[pos="e,2104.5,26664 1582.3,26628 1766.7,26628 2104.5,26628 2104.5,26628 2104.5,26628 2104.5,26654 2104.5,26654"];
			flash_attn_3_long_15 -> reduce_3_long	[pos="e,2846.5,27219 2249.4,26682 2490.2,26682 2846.5,26682 2846.5,26682 2846.5,26682 2846.5,27209 2846.5,27209"];
		}
	}
	subgraph cluster_very_long_scenario {
		graph [bb="1332.5,6078,2888.1,21758",
			color=lightcoral,
			fontsize=11,
			label="> 16384 tokens (24 pool GPUs)",
			lheight=0.17,
			lp="2110.3,21748",
			lwidth=2.47,
			style=rounded
		];
		subgraph cluster_layer0_very_long {
			graph [bb="1340.5,17825,2880.1,21730",
				fontsize=10,
				label="Layer 0",
				lheight=0.15,
				lp="2110.3,21720",
				lwidth=0.54
			];
			q_proj_0_very_long_0	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,21685",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_0	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,21631",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_0 -> flash_attn_0_very_long_0	[pos="e,1964.5,21649 1580.3,21685 1727.6,21685 1964.5,21685 1964.5,21685 1964.5,21685 1964.5,21659 1964.5,21659"];
			k_proj_0_very_long_0	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,21631",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_0 -> flash_attn_0_very_long_0	[pos="e,1823.6,21625 1579.8,21625 1579.8,21625 1813.6,21625 1813.6,21625"];
			v_proj_0_very_long_0	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,21577",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_0 -> flash_attn_0_very_long_0	[pos="e,2104.5,21613 1579.7,21577 1763.5,21577 2104.5,21577 2104.5,21577 2104.5,21577 2104.5,21603 2104.5,21603"];
			reduce_0_very_long	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>24→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,19146",
				shape=diamond,
				width=6.9856];
			flash_attn_0_very_long_0 -> reduce_0_very_long	[pos="e,2766.5,19154 2244.2,21631 2460.7,21631 2766.5,21631 2766.5,21631 2766.5,21631 2766.5,19164 2766.5,19164"];
			q_proj_0_very_long_1	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,21523",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_1	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,21469",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_1 -> flash_attn_0_very_long_1	[pos="e,1964.5,21487 1580.3,21523 1727.6,21523 1964.5,21523 1964.5,21523 1964.5,21523 1964.5,21497 1964.5,21497"];
			k_proj_0_very_long_1	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,21469",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_1 -> flash_attn_0_very_long_1	[pos="e,1823.6,21463 1579.8,21463 1579.8,21463 1813.6,21463 1813.6,21463"];
			v_proj_0_very_long_1	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,21415",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_1 -> flash_attn_0_very_long_1	[pos="e,2104.5,21451 1579.7,21415 1763.5,21415 2104.5,21415 2104.5,21415 2104.5,21415 2104.5,21441 2104.5,21441"];
			flash_attn_0_very_long_1 -> reduce_0_very_long	[pos="e,2740.5,19156 2243.9,21469 2452.2,21469 2740.5,21469 2740.5,21469 2740.5,21469 2740.5,19166 2740.5,19166"];
			q_proj_0_very_long_2	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,21361",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_2	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,21307",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_2 -> flash_attn_0_very_long_2	[pos="e,1964.5,21325 1580.3,21361 1727.6,21361 1964.5,21361 1964.5,21361 1964.5,21361 1964.5,21335 1964.5,21335"];
			k_proj_0_very_long_2	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,21307",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_2 -> flash_attn_0_very_long_2	[pos="e,1823.6,21301 1579.8,21301 1579.8,21301 1813.6,21301 1813.6,21301"];
			v_proj_0_very_long_2	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,21253",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_2 -> flash_attn_0_very_long_2	[pos="e,2104.5,21289 1579.7,21253 1763.5,21253 2104.5,21253 2104.5,21253 2104.5,21253 2104.5,21279 2104.5,21279"];
			flash_attn_0_very_long_2 -> reduce_0_very_long	[pos="e,2713.5,19157 2244.2,21307 2443.8,21307 2713.5,21307 2713.5,21307 2713.5,21307 2713.5,19167 2713.5,19167"];
			q_proj_0_very_long_3	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,21199",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_3	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,21145",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_3 -> flash_attn_0_very_long_3	[pos="e,1964.5,21163 1580.3,21199 1727.6,21199 1964.5,21199 1964.5,21199 1964.5,21199 1964.5,21173 1964.5,21173"];
			k_proj_0_very_long_3	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,21145",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_3 -> flash_attn_0_very_long_3	[pos="e,1823.6,21139 1579.8,21139 1579.8,21139 1813.6,21139 1813.6,21139"];
			v_proj_0_very_long_3	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,21091",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_3 -> flash_attn_0_very_long_3	[pos="e,2104.5,21127 1579.7,21091 1763.5,21091 2104.5,21091 2104.5,21091 2104.5,21091 2104.5,21117 2104.5,21117"];
			flash_attn_0_very_long_3 -> reduce_0_very_long	[pos="e,2687.5,19159 2243.7,21145 2434.9,21145 2687.5,21145 2687.5,21145 2687.5,21145 2687.5,19169 2687.5,19169"];
			q_proj_0_very_long_4	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,21037",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_4	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,20983",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_4 -> flash_attn_0_very_long_4	[pos="e,1964.5,21001 1580.3,21037 1727.6,21037 1964.5,21037 1964.5,21037 1964.5,21037 1964.5,21011 1964.5,21011"];
			k_proj_0_very_long_4	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,20983",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_4 -> flash_attn_0_very_long_4	[pos="e,1823.6,20977 1579.8,20977 1579.8,20977 1813.6,20977 1813.6,20977"];
			v_proj_0_very_long_4	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,20929",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_4 -> flash_attn_0_very_long_4	[pos="e,2104.5,20965 1579.7,20929 1763.5,20929 2104.5,20929 2104.5,20929 2104.5,20929 2104.5,20955 2104.5,20955"];
			flash_attn_0_very_long_4 -> reduce_0_very_long	[pos="e,2660.5,19161 2243.7,20983 2425.9,20983 2660.5,20983 2660.5,20983 2660.5,20983 2660.5,19171 2660.5,19171"];
			q_proj_0_very_long_5	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,20875",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_5	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,20821",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_5 -> flash_attn_0_very_long_5	[pos="e,1964.5,20839 1580.3,20875 1727.6,20875 1964.5,20875 1964.5,20875 1964.5,20875 1964.5,20849 1964.5,20849"];
			k_proj_0_very_long_5	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,20821",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_5 -> flash_attn_0_very_long_5	[pos="e,1823.6,20815 1579.8,20815 1579.8,20815 1813.6,20815 1813.6,20815"];
			v_proj_0_very_long_5	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,20767",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_5 -> flash_attn_0_very_long_5	[pos="e,2104.5,20803 1579.7,20767 1763.5,20767 2104.5,20767 2104.5,20767 2104.5,20767 2104.5,20793 2104.5,20793"];
			flash_attn_0_very_long_5 -> reduce_0_very_long	[pos="e,2634.5,19163 2243.8,20821 2417.1,20821 2634.5,20821 2634.5,20821 2634.5,20821 2634.5,19173 2634.5,19173"];
			q_proj_0_very_long_6	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,20713",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_6	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,20659",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_6 -> flash_attn_0_very_long_6	[pos="e,1964.5,20677 1580.3,20713 1727.6,20713 1964.5,20713 1964.5,20713 1964.5,20713 1964.5,20687 1964.5,20687"];
			k_proj_0_very_long_6	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,20659",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_6 -> flash_attn_0_very_long_6	[pos="e,1823.6,20653 1579.8,20653 1579.8,20653 1813.6,20653 1813.6,20653"];
			v_proj_0_very_long_6	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,20605",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_6 -> flash_attn_0_very_long_6	[pos="e,2104.5,20641 1579.7,20605 1763.5,20605 2104.5,20605 2104.5,20605 2104.5,20605 2104.5,20631 2104.5,20631"];
			flash_attn_0_very_long_6 -> reduce_0_very_long	[pos="e,2607.5,19163 2244.1,20659 2407.9,20659 2607.5,20659 2607.5,20659 2607.5,20659 2607.5,19173 2607.5,19173"];
			q_proj_0_very_long_7	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,20551",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_7	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,20497",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_7 -> flash_attn_0_very_long_7	[pos="e,1964.5,20515 1580.3,20551 1727.6,20551 1964.5,20551 1964.5,20551 1964.5,20551 1964.5,20525 1964.5,20525"];
			k_proj_0_very_long_7	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,20497",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_7 -> flash_attn_0_very_long_7	[pos="e,1823.6,20491 1579.8,20491 1579.8,20491 1813.6,20491 1813.6,20491"];
			v_proj_0_very_long_7	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,20443",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_7 -> flash_attn_0_very_long_7	[pos="e,2104.5,20479 1579.7,20443 1763.5,20443 2104.5,20443 2104.5,20443 2104.5,20443 2104.5,20469 2104.5,20469"];
			flash_attn_0_very_long_7 -> reduce_0_very_long	[pos="e,2581.5,19162 2243.9,20497 2398.4,20497 2581.5,20497 2581.5,20497 2581.5,20497 2581.5,19172 2581.5,19172"];
			q_proj_0_very_long_8	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,20389",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_8	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_8<br/>Block: 9/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,20335",
				shape=rectangle,
				width=5.8333];
			q_proj_0_very_long_8 -> flash_attn_0_very_long_8	[pos="e,1964.5,20353 1580.3,20389 1727.6,20389 1964.5,20389 1964.5,20389 1964.5,20389 1964.5,20363 1964.5,20363"];
			k_proj_0_very_long_8	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,20335",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_8 -> flash_attn_0_very_long_8	[pos="e,1823.6,20329 1579.8,20329 1579.8,20329 1813.6,20329 1813.6,20329"];
			v_proj_0_very_long_8	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,20281",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_8 -> flash_attn_0_very_long_8	[pos="e,2104.5,20317 1579.7,20281 1763.5,20281 2104.5,20281 2104.5,20281 2104.5,20281 2104.5,20307 2104.5,20307"];
			flash_attn_0_very_long_8 -> reduce_0_very_long	[pos="e,2554.5,19159 2244,20335 2388.6,20335 2554.5,20335 2554.5,20335 2554.5,20335 2554.5,19169 2554.5,19169"];
			q_proj_0_very_long_9	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,20227",
				shape=rectangle,
				width=3.1806];
			flash_attn_0_very_long_9	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_9<br/>Block: 10/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,20173",
				shape=rectangle,
				width=5.9028];
			q_proj_0_very_long_9 -> flash_attn_0_very_long_9	[pos="e,1964.5,20191 1580.3,20227 1727.6,20227 1964.5,20227 1964.5,20227 1964.5,20227 1964.5,20201 1964.5,20201"];
			k_proj_0_very_long_9	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,20173",
				shape=rectangle,
				width=3.1667];
			k_proj_0_very_long_9 -> flash_attn_0_very_long_9	[pos="e,1821,20167 1579.8,20167 1579.8,20167 1811,20167 1811,20167"];
			v_proj_0_very_long_9	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,20119",
				shape=rectangle,
				width=3.1667];
			v_proj_0_very_long_9 -> flash_attn_0_very_long_9	[pos="e,2105.5,20155 1579.5,20119 1763.5,20119 2105.5,20119 2105.5,20119 2105.5,20119 2105.5,20145 2105.5,20145"];
			flash_attn_0_very_long_9 -> reduce_0_very_long	[pos="e,2528.5,19158 2246.4,20173 2380.5,20173 2528.5,20173 2528.5,20173 2528.5,20173 2528.5,19168 2528.5,19168"];
			q_proj_0_very_long_10	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,20065",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_10	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_10<br/>Block: 11/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,20011",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_10 -> flash_attn_0_very_long_10	[pos="e,1963.5,20029 1582.6,20065 1729.8,20065 1963.5,20065 1963.5,20065 1963.5,20065 1963.5,20039 1963.5,20039"];
			k_proj_0_very_long_10	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,20011",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_10 -> flash_attn_0_very_long_10	[pos="e,1818.1,20005 1582.2,20005 1582.2,20005 1808.1,20005 1808.1,20005"];
			v_proj_0_very_long_10	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,19957",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_10 -> flash_attn_0_very_long_10	[pos="e,2106.5,19993 1582.3,19957 1767.2,19957 2106.5,19957 2106.5,19957 2106.5,19957 2106.5,19983 2106.5,19983"];
			flash_attn_0_very_long_10 -> reduce_0_very_long	[pos="e,2501.5,19156 2249.5,20011 2372.1,20011 2501.5,20011 2501.5,20011 2501.5,20011 2501.5,19166 2501.5,19166"];
			q_proj_0_very_long_11	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,19903",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_11	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_11<br/>Block: 12/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,19849",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_11 -> flash_attn_0_very_long_11	[pos="e,1962.5,19867 1582.6,19903 1729.6,19903 1962.5,19903 1962.5,19903 1962.5,19903 1962.5,19877 1962.5,19877"];
			k_proj_0_very_long_11	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,19849",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_11 -> flash_attn_0_very_long_11	[pos="e,1818.1,19843 1582.2,19843 1582.2,19843 1808.1,19843 1808.1,19843"];
			v_proj_0_very_long_11	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,19795",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_11 -> flash_attn_0_very_long_11	[pos="e,2106.5,19831 1582.3,19795 1767.2,19795 2106.5,19795 2106.5,19795 2106.5,19795 2106.5,19821 2106.5,19821"];
			flash_attn_0_very_long_11 -> reduce_0_very_long	[pos="e,2475.5,19154 2249.4,19849 2361.6,19849 2475.5,19849 2475.5,19849 2475.5,19849 2475.5,19164 2475.5,19164"];
			q_proj_0_very_long_12	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,19741",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_12	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_12<br/>Block: 13/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,19687",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_12 -> flash_attn_0_very_long_12	[pos="e,1962.5,19705 1582.6,19741 1729.6,19741 1962.5,19741 1962.5,19741 1962.5,19741 1962.5,19715 1962.5,19715"];
			k_proj_0_very_long_12	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,19687",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_12 -> flash_attn_0_very_long_12	[pos="e,1818.1,19681 1582.2,19681 1582.2,19681 1808.1,19681 1808.1,19681"];
			v_proj_0_very_long_12	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,19633",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_12 -> flash_attn_0_very_long_12	[pos="e,2106.5,19669 1582.3,19633 1767.2,19633 2106.5,19633 2106.5,19633 2106.5,19633 2106.5,19659 2106.5,19659"];
			flash_attn_0_very_long_12 -> reduce_0_very_long	[pos="e,2449.5,19152 2249.5,19687 2350.8,19687 2449.5,19687 2449.5,19687 2449.5,19687 2449.5,19162 2449.5,19162"];
			q_proj_0_very_long_13	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,19579",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_13	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_13<br/>Block: 14/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,19525",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_13 -> flash_attn_0_very_long_13	[pos="e,1962.5,19543 1582.6,19579 1729.6,19579 1962.5,19579 1962.5,19579 1962.5,19579 1962.5,19553 1962.5,19553"];
			k_proj_0_very_long_13	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,19525",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_13 -> flash_attn_0_very_long_13	[pos="e,1818.1,19519 1582.2,19519 1582.2,19519 1808.1,19519 1808.1,19519"];
			v_proj_0_very_long_13	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,19471",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_13 -> flash_attn_0_very_long_13	[pos="e,2106.5,19507 1582.3,19471 1767.2,19471 2106.5,19471 2106.5,19471 2106.5,19471 2106.5,19497 2106.5,19497"];
			flash_attn_0_very_long_13 -> reduce_0_very_long	[pos="e,2422.5,19150 2249.4,19525 2339,19525 2422.5,19525 2422.5,19525 2422.5,19525 2422.5,19160 2422.5,19160"];
			q_proj_0_very_long_14	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,19417",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_14	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_14<br/>Block: 15/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,19363",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_14 -> flash_attn_0_very_long_14	[pos="e,1962.5,19381 1582.6,19417 1729.6,19417 1962.5,19417 1962.5,19417 1962.5,19417 1962.5,19391 1962.5,19391"];
			k_proj_0_very_long_14	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,19363",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_14 -> flash_attn_0_very_long_14	[pos="e,1818.1,19357 1582.2,19357 1582.2,19357 1808.1,19357 1808.1,19357"];
			v_proj_0_very_long_14	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,19309",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_14 -> flash_attn_0_very_long_14	[pos="e,2106.5,19345 1582.3,19309 1767.2,19309 2106.5,19309 2106.5,19309 2106.5,19309 2106.5,19335 2106.5,19335"];
			flash_attn_0_very_long_14 -> reduce_0_very_long	[pos="e,2396.5,19148 2249.5,19363 2327.4,19363 2396.5,19363 2396.5,19363 2396.5,19363 2396.5,19158 2396.5,19158"];
			q_proj_0_very_long_15	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,19255",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_15	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_15<br/>Block: 16/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,19201",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_15 -> flash_attn_0_very_long_15	[pos="e,1962.5,19219 1582.6,19255 1729.6,19255 1962.5,19255 1962.5,19255 1962.5,19255 1962.5,19229 1962.5,19229"];
			k_proj_0_very_long_15	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,19201",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_15 -> flash_attn_0_very_long_15	[pos="e,1818.1,19195 1582.2,19195 1582.2,19195 1808.1,19195 1808.1,19195"];
			v_proj_0_very_long_15	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,19147",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_15 -> flash_attn_0_very_long_15	[pos="e,1926.5,19183 1582.1,19155 1718.7,19155 1926.5,19155 1926.5,19155 1926.5,19155 1926.5,19173 1926.5,19173"];
			flash_attn_0_very_long_15 -> reduce_0_very_long	[pos="e,2375.9,19146 2034.5,19183 2034.5,19167 2034.5,19146 2034.5,19146 2034.5,19146 2365.9,19146 2365.9,19146"];
			q_proj_0_very_long_16	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,19093",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_16	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_16<br/>Block: 17/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,19093",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_16 -> flash_attn_0_very_long_16	[pos="e,1818,19087 1582.5,19087 1582.5,19087 1808,19087 1808,19087"];
			k_proj_0_very_long_16	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,19039",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_16 -> flash_attn_0_very_long_16	[pos="e,1962.5,19075 1582,19039 1728.9,19039 1962.5,19039 1962.5,19039 1962.5,19039 1962.5,19065 1962.5,19065"];
			v_proj_0_very_long_16	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,18985",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_16 -> flash_attn_0_very_long_16	[pos="e,2106.5,19075 1582.3,18985 1767.2,18985 2106.5,18985 2106.5,18985 2106.5,18985 2106.5,19065 2106.5,19065"];
			flash_attn_0_very_long_16 -> reduce_0_very_long	[pos="e,2484.3,19138 2141.5,19111 2141.5,19124 2141.5,19138 2141.5,19138 2141.5,19138 2474.3,19138 2474.3,19138"];
			q_proj_0_very_long_17	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,18931",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_17	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_17<br/>Block: 18/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,18931",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_17 -> flash_attn_0_very_long_17	[pos="e,1818,18925 1582.5,18925 1582.5,18925 1808,18925 1808,18925"];
			k_proj_0_very_long_17	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,18877",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_17 -> flash_attn_0_very_long_17	[pos="e,1962.5,18913 1582,18877 1728.9,18877 1962.5,18877 1962.5,18877 1962.5,18877 1962.5,18903 1962.5,18903"];
			v_proj_0_very_long_17	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,18823",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_17 -> flash_attn_0_very_long_17	[pos="e,2106.5,18913 1582.3,18823 1767.2,18823 2106.5,18823 2106.5,18823 2106.5,18823 2106.5,18903 2106.5,18903"];
			flash_attn_0_very_long_17 -> reduce_0_very_long	[pos="e,2719.5,19135 2249.3,18931 2450.4,18931 2719.5,18931 2719.5,18931 2719.5,18931 2719.5,19125 2719.5,19125"];
			q_proj_0_very_long_18	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,18769",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_18	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_18<br/>Block: 19/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,18769",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_18 -> flash_attn_0_very_long_18	[pos="e,1818,18763 1582.5,18763 1582.5,18763 1808,18763 1808,18763"];
			k_proj_0_very_long_18	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,18715",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_18 -> flash_attn_0_very_long_18	[pos="e,1962.5,18751 1582,18715 1728.9,18715 1962.5,18715 1962.5,18715 1962.5,18715 1962.5,18741 1962.5,18741"];
			v_proj_0_very_long_18	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,18661",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_18 -> flash_attn_0_very_long_18	[pos="e,2106.5,18751 1582.3,18661 1767.2,18661 2106.5,18661 2106.5,18661 2106.5,18661 2106.5,18741 2106.5,18741"];
			flash_attn_0_very_long_18 -> reduce_0_very_long	[pos="e,2741.5,19136 2249.4,18769 2457.6,18769 2741.5,18769 2741.5,18769 2741.5,18769 2741.5,19126 2741.5,19126"];
			q_proj_0_very_long_19	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,18607",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_19	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_19<br/>Block: 20/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,18607",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_19 -> flash_attn_0_very_long_19	[pos="e,1818,18601 1582.5,18601 1582.5,18601 1808,18601 1808,18601"];
			k_proj_0_very_long_19	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,18553",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_19 -> flash_attn_0_very_long_19	[pos="e,1962.5,18589 1582,18553 1728.9,18553 1962.5,18553 1962.5,18553 1962.5,18553 1962.5,18579 1962.5,18579"];
			v_proj_0_very_long_19	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,18499",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_19 -> flash_attn_0_very_long_19	[pos="e,2106.5,18589 1582.3,18499 1767.2,18499 2106.5,18499 2106.5,18499 2106.5,18499 2106.5,18579 2106.5,18579"];
			flash_attn_0_very_long_19 -> reduce_0_very_long	[pos="e,2763.5,19138 2249.7,18607 2464.9,18607 2763.5,18607 2763.5,18607 2763.5,18607 2763.5,19128 2763.5,19128"];
			q_proj_0_very_long_20	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,18445",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_20	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_20<br/>Block: 21/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,18445",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_20 -> flash_attn_0_very_long_20	[pos="e,1818,18439 1582.5,18439 1582.5,18439 1808,18439 1808,18439"];
			k_proj_0_very_long_20	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,18391",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_20 -> flash_attn_0_very_long_20	[pos="e,1962.5,18427 1582,18391 1728.9,18391 1962.5,18391 1962.5,18391 1962.5,18391 1962.5,18417 1962.5,18417"];
			v_proj_0_very_long_20	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,18337",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_20 -> flash_attn_0_very_long_20	[pos="e,2106.5,18427 1582.3,18337 1767.2,18337 2106.5,18337 2106.5,18337 2106.5,18337 2106.5,18417 2106.5,18417"];
			flash_attn_0_very_long_20 -> reduce_0_very_long	[pos="e,2785.5,19140 2249.4,18445 2471.5,18445 2785.5,18445 2785.5,18445 2785.5,18445 2785.5,19130 2785.5,19130"];
			q_proj_0_very_long_21	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,18283",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_21	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_21<br/>Block: 22/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,18283",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_21 -> flash_attn_0_very_long_21	[pos="e,1818,18277 1582.5,18277 1582.5,18277 1808,18277 1808,18277"];
			k_proj_0_very_long_21	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,18229",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_21 -> flash_attn_0_very_long_21	[pos="e,1962.5,18265 1582,18229 1728.9,18229 1962.5,18229 1962.5,18229 1962.5,18229 1962.5,18255 1962.5,18255"];
			v_proj_0_very_long_21	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,18175",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_21 -> flash_attn_0_very_long_21	[pos="e,2106.5,18265 1582.3,18175 1767.2,18175 2106.5,18175 2106.5,18175 2106.5,18175 2106.5,18255 2106.5,18255"];
			flash_attn_0_very_long_21 -> reduce_0_very_long	[pos="e,2806.5,19141 2249.2,18283 2477.9,18283 2806.5,18283 2806.5,18283 2806.5,18283 2806.5,19131 2806.5,19131"];
			q_proj_0_very_long_22	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,18121",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_22	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_22<br/>Block: 23/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,18121",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_22 -> flash_attn_0_very_long_22	[pos="e,1818,18115 1582.5,18115 1582.5,18115 1808,18115 1808,18115"];
			k_proj_0_very_long_22	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,18067",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_22 -> flash_attn_0_very_long_22	[pos="e,1962.5,18103 1582,18067 1728.9,18067 1962.5,18067 1962.5,18067 1962.5,18067 1962.5,18093 1962.5,18093"];
			v_proj_0_very_long_22	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,18013",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_22 -> flash_attn_0_very_long_22	[pos="e,2106.5,18103 1582.3,18013 1767.2,18013 2106.5,18013 2106.5,18013 2106.5,18013 2106.5,18093 2106.5,18093"];
			flash_attn_0_very_long_22 -> reduce_0_very_long	[pos="e,2828.5,19143 2249.3,18121 2484.7,18121 2828.5,18121 2828.5,18121 2828.5,18121 2828.5,19133 2828.5,19133"];
			q_proj_0_very_long_23	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,17959",
				shape=rectangle,
				width=3.25];
			flash_attn_0_very_long_23	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_23<br/>Block: 24/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,17959",
				shape=rectangle,
				width=5.9861];
			q_proj_0_very_long_23 -> flash_attn_0_very_long_23	[pos="e,1818,17953 1582.5,17953 1582.5,17953 1808,17953 1808,17953"];
			k_proj_0_very_long_23	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,17905",
				shape=rectangle,
				width=3.2361];
			k_proj_0_very_long_23 -> flash_attn_0_very_long_23	[pos="e,2034.5,17941 1582,17905 1748.5,17905 2034.5,17905 2034.5,17905 2034.5,17905 2034.5,17931 2034.5,17931"];
			v_proj_0_very_long_23	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,17851",
				shape=rectangle,
				width=3.2361];
			v_proj_0_very_long_23 -> flash_attn_0_very_long_23	[pos="e,2139.5,17941 1582.1,17851 1775,17851 2139.5,17851 2139.5,17851 2139.5,17851 2139.5,17931 2139.5,17931"];
			flash_attn_0_very_long_23 -> reduce_0_very_long	[pos="e,2850.5,19144 2249.4,17959 2491.4,17959 2850.5,17959 2850.5,17959 2850.5,17959 2850.5,19134 2850.5,19134"];
		}
		subgraph cluster_layer1_very_long {
			graph [bb="1340.5,13912,2880.1,17817",
				fontsize=10,
				label="Layer 1",
				lheight=0.15,
				lp="2110.3,17808",
				lwidth=0.54
			];
			q_proj_1_very_long_0	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,17772",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_0	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,17718",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_0 -> flash_attn_1_very_long_0	[pos="e,1929.5,17736 1580.2,17772 1717.6,17772 1929.5,17772 1929.5,17772 1929.5,17772 1929.5,17746 1929.5,17746"];
			k_proj_1_very_long_0	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,17718",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_0 -> flash_attn_1_very_long_0	[pos="e,1823.6,17712 1579.8,17712 1579.8,17712 1813.6,17712 1813.6,17712"];
			v_proj_1_very_long_0	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,17664",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_0 -> flash_attn_1_very_long_0	[pos="e,2104.5,17700 1579.7,17664 1763.5,17664 2104.5,17664 2104.5,17664 2104.5,17664 2104.5,17690 2104.5,17690"];
			reduce_1_very_long	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>24→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,15233",
				shape=diamond,
				width=6.9856];
			flash_attn_1_very_long_0 -> reduce_1_very_long	[pos="e,2697.5,15246 2243.7,17718 2438.2,17718 2697.5,17718 2697.5,17718 2697.5,17718 2697.5,15256 2697.5,15256"];
			q_proj_1_very_long_1	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,17610",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_1	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,17556",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_1 -> flash_attn_1_very_long_1	[pos="e,1964.5,17574 1580.3,17610 1727.6,17610 1964.5,17610 1964.5,17610 1964.5,17610 1964.5,17584 1964.5,17584"];
			k_proj_1_very_long_1	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,17556",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_1 -> flash_attn_1_very_long_1	[pos="e,1823.6,17550 1579.8,17550 1579.8,17550 1813.6,17550 1813.6,17550"];
			v_proj_1_very_long_1	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,17502",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_1 -> flash_attn_1_very_long_1	[pos="e,2104.5,17538 1579.7,17502 1763.5,17502 2104.5,17502 2104.5,17502 2104.5,17502 2104.5,17528 2104.5,17528"];
			flash_attn_1_very_long_1 -> reduce_1_very_long	[pos="e,2675.5,15247 2243.9,17556 2431,17556 2675.5,17556 2675.5,17556 2675.5,17556 2675.5,15257 2675.5,15257"];
			q_proj_1_very_long_2	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,17448",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_2	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,17394",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_2 -> flash_attn_1_very_long_2	[pos="e,1964.5,17412 1580.3,17448 1727.6,17448 1964.5,17448 1964.5,17448 1964.5,17448 1964.5,17422 1964.5,17422"];
			k_proj_1_very_long_2	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,17394",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_2 -> flash_attn_1_very_long_2	[pos="e,1823.6,17388 1579.8,17388 1579.8,17388 1813.6,17388 1813.6,17388"];
			v_proj_1_very_long_2	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,17340",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_2 -> flash_attn_1_very_long_2	[pos="e,2104.5,17376 1579.7,17340 1763.5,17340 2104.5,17340 2104.5,17340 2104.5,17340 2104.5,17366 2104.5,17366"];
			flash_attn_1_very_long_2 -> reduce_1_very_long	[pos="e,2653.5,15249 2244,17394 2423.7,17394 2653.5,17394 2653.5,17394 2653.5,17394 2653.5,15259 2653.5,15259"];
			q_proj_1_very_long_3	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,17286",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_3	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,17232",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_3 -> flash_attn_1_very_long_3	[pos="e,1964.5,17250 1580.3,17286 1727.6,17286 1964.5,17286 1964.5,17286 1964.5,17286 1964.5,17260 1964.5,17260"];
			k_proj_1_very_long_3	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,17232",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_3 -> flash_attn_1_very_long_3	[pos="e,1823.6,17226 1579.8,17226 1579.8,17226 1813.6,17226 1813.6,17226"];
			v_proj_1_very_long_3	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,17178",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_3 -> flash_attn_1_very_long_3	[pos="e,2104.5,17214 1579.7,17178 1763.5,17178 2104.5,17178 2104.5,17178 2104.5,17178 2104.5,17204 2104.5,17204"];
			flash_attn_1_very_long_3 -> reduce_1_very_long	[pos="e,2632.5,15250 2244,17232 2416.5,17232 2632.5,17232 2632.5,17232 2632.5,17232 2632.5,15260 2632.5,15260"];
			q_proj_1_very_long_4	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,17124",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_4	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,17070",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_4 -> flash_attn_1_very_long_4	[pos="e,1964.5,17088 1580.3,17124 1727.6,17124 1964.5,17124 1964.5,17124 1964.5,17124 1964.5,17098 1964.5,17098"];
			k_proj_1_very_long_4	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,17070",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_4 -> flash_attn_1_very_long_4	[pos="e,1823.6,17064 1579.8,17064 1579.8,17064 1813.6,17064 1813.6,17064"];
			v_proj_1_very_long_4	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,17016",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_4 -> flash_attn_1_very_long_4	[pos="e,2104.5,17052 1579.7,17016 1763.5,17016 2104.5,17016 2104.5,17016 2104.5,17016 2104.5,17042 2104.5,17042"];
			flash_attn_1_very_long_4 -> reduce_1_very_long	[pos="e,2610.5,15250 2244,17070 2408.8,17070 2610.5,17070 2610.5,17070 2610.5,17070 2610.5,15260 2610.5,15260"];
			q_proj_1_very_long_5	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,16962",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_5	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,16908",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_5 -> flash_attn_1_very_long_5	[pos="e,1964.5,16926 1580.3,16962 1727.6,16962 1964.5,16962 1964.5,16962 1964.5,16962 1964.5,16936 1964.5,16936"];
			k_proj_1_very_long_5	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,16908",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_5 -> flash_attn_1_very_long_5	[pos="e,1823.6,16902 1579.8,16902 1579.8,16902 1813.6,16902 1813.6,16902"];
			v_proj_1_very_long_5	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,16854",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_5 -> flash_attn_1_very_long_5	[pos="e,2104.5,16890 1579.7,16854 1763.5,16854 2104.5,16854 2104.5,16854 2104.5,16854 2104.5,16880 2104.5,16880"];
			flash_attn_1_very_long_5 -> reduce_1_very_long	[pos="e,2588.5,15249 2243.9,16908 2400.9,16908 2588.5,16908 2588.5,16908 2588.5,16908 2588.5,15259 2588.5,15259"];
			q_proj_1_very_long_6	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,16800",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_6	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,16746",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_6 -> flash_attn_1_very_long_6	[pos="e,1964.5,16764 1580.3,16800 1727.6,16800 1964.5,16800 1964.5,16800 1964.5,16800 1964.5,16774 1964.5,16774"];
			k_proj_1_very_long_6	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,16746",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_6 -> flash_attn_1_very_long_6	[pos="e,1823.6,16740 1579.8,16740 1579.8,16740 1813.6,16740 1813.6,16740"];
			v_proj_1_very_long_6	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,16692",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_6 -> flash_attn_1_very_long_6	[pos="e,2104.5,16728 1579.7,16692 1763.5,16692 2104.5,16692 2104.5,16692 2104.5,16692 2104.5,16718 2104.5,16718"];
			flash_attn_1_very_long_6 -> reduce_1_very_long	[pos="e,2566.5,15247 2243.9,16746 2392.9,16746 2566.5,16746 2566.5,16746 2566.5,16746 2566.5,15257 2566.5,15257"];
			q_proj_1_very_long_7	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,16638",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_7	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,16584",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_7 -> flash_attn_1_very_long_7	[pos="e,1964.5,16602 1580.3,16638 1727.6,16638 1964.5,16638 1964.5,16638 1964.5,16638 1964.5,16612 1964.5,16612"];
			k_proj_1_very_long_7	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,16584",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_7 -> flash_attn_1_very_long_7	[pos="e,1823.6,16578 1579.8,16578 1579.8,16578 1813.6,16578 1813.6,16578"];
			v_proj_1_very_long_7	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,16530",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_7 -> flash_attn_1_very_long_7	[pos="e,2104.5,16566 1579.7,16530 1763.5,16530 2104.5,16530 2104.5,16530 2104.5,16530 2104.5,16556 2104.5,16556"];
			flash_attn_1_very_long_7 -> reduce_1_very_long	[pos="e,2544.5,15246 2244.1,16584 2384.8,16584 2544.5,16584 2544.5,16584 2544.5,16584 2544.5,15256 2544.5,15256"];
			q_proj_1_very_long_8	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,16476",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_8	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_8<br/>Block: 9/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,16422",
				shape=rectangle,
				width=5.8333];
			q_proj_1_very_long_8 -> flash_attn_1_very_long_8	[pos="e,1964.5,16440 1580.3,16476 1727.6,16476 1964.5,16476 1964.5,16476 1964.5,16476 1964.5,16450 1964.5,16450"];
			k_proj_1_very_long_8	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,16422",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_8 -> flash_attn_1_very_long_8	[pos="e,1823.6,16416 1579.8,16416 1579.8,16416 1813.6,16416 1813.6,16416"];
			v_proj_1_very_long_8	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,16368",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_8 -> flash_attn_1_very_long_8	[pos="e,2104.5,16404 1579.7,16368 1763.5,16368 2104.5,16368 2104.5,16368 2104.5,16368 2104.5,16394 2104.5,16394"];
			flash_attn_1_very_long_8 -> reduce_1_very_long	[pos="e,2522.5,15244 2243.8,16422 2376.3,16422 2522.5,16422 2522.5,16422 2522.5,16422 2522.5,15254 2522.5,15254"];
			q_proj_1_very_long_9	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,16314",
				shape=rectangle,
				width=3.1806];
			flash_attn_1_very_long_9	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_9<br/>Block: 10/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,16260",
				shape=rectangle,
				width=5.9028];
			q_proj_1_very_long_9 -> flash_attn_1_very_long_9	[pos="e,1964.5,16278 1580.3,16314 1727.6,16314 1964.5,16314 1964.5,16314 1964.5,16314 1964.5,16288 1964.5,16288"];
			k_proj_1_very_long_9	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,16260",
				shape=rectangle,
				width=3.1667];
			k_proj_1_very_long_9 -> flash_attn_1_very_long_9	[pos="e,1821,16254 1579.8,16254 1579.8,16254 1811,16254 1811,16254"];
			v_proj_1_very_long_9	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,16206",
				shape=rectangle,
				width=3.1667];
			v_proj_1_very_long_9 -> flash_attn_1_very_long_9	[pos="e,2105.5,16242 1579.5,16206 1763.5,16206 2105.5,16206 2105.5,16206 2105.5,16206 2105.5,16232 2105.5,16232"];
			flash_attn_1_very_long_9 -> reduce_1_very_long	[pos="e,2500.5,15243 2246.3,16260 2369.5,16260 2500.5,16260 2500.5,16260 2500.5,16260 2500.5,15253 2500.5,15253"];
			q_proj_1_very_long_10	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,16152",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_10	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_10<br/>Block: 11/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,16098",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_10 -> flash_attn_1_very_long_10	[pos="e,1963.5,16116 1582.6,16152 1729.8,16152 1963.5,16152 1963.5,16152 1963.5,16152 1963.5,16126 1963.5,16126"];
			k_proj_1_very_long_10	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,16098",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_10 -> flash_attn_1_very_long_10	[pos="e,1818.1,16092 1582.2,16092 1582.2,16092 1808.1,16092 1808.1,16092"];
			v_proj_1_very_long_10	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,16044",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_10 -> flash_attn_1_very_long_10	[pos="e,2106.5,16080 1582.3,16044 1767.2,16044 2106.5,16044 2106.5,16044 2106.5,16044 2106.5,16070 2106.5,16070"];
			flash_attn_1_very_long_10 -> reduce_1_very_long	[pos="e,2478.5,15241 2249.3,16098 2362.7,16098 2478.5,16098 2478.5,16098 2478.5,16098 2478.5,15251 2478.5,15251"];
			q_proj_1_very_long_11	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,15990",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_11	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_11<br/>Block: 12/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,15936",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_11 -> flash_attn_1_very_long_11	[pos="e,1962.5,15954 1582.6,15990 1729.6,15990 1962.5,15990 1962.5,15990 1962.5,15990 1962.5,15964 1962.5,15964"];
			k_proj_1_very_long_11	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,15936",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_11 -> flash_attn_1_very_long_11	[pos="e,1818.1,15930 1582.2,15930 1582.2,15930 1808.1,15930 1808.1,15930"];
			v_proj_1_very_long_11	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,15882",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_11 -> flash_attn_1_very_long_11	[pos="e,2106.5,15918 1582.3,15882 1767.2,15882 2106.5,15882 2106.5,15882 2106.5,15882 2106.5,15908 2106.5,15908"];
			flash_attn_1_very_long_11 -> reduce_1_very_long	[pos="e,2457.5,15240 2249.3,15936 2354,15936 2457.5,15936 2457.5,15936 2457.5,15936 2457.5,15250 2457.5,15250"];
			q_proj_1_very_long_12	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,15828",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_12	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_12<br/>Block: 13/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,15774",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_12 -> flash_attn_1_very_long_12	[pos="e,1962.5,15792 1582.6,15828 1729.6,15828 1962.5,15828 1962.5,15828 1962.5,15828 1962.5,15802 1962.5,15802"];
			k_proj_1_very_long_12	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,15774",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_12 -> flash_attn_1_very_long_12	[pos="e,1818.1,15768 1582.2,15768 1582.2,15768 1808.1,15768 1808.1,15768"];
			v_proj_1_very_long_12	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,15720",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_12 -> flash_attn_1_very_long_12	[pos="e,2106.5,15756 1582.3,15720 1767.2,15720 2106.5,15720 2106.5,15720 2106.5,15720 2106.5,15746 2106.5,15746"];
			flash_attn_1_very_long_12 -> reduce_1_very_long	[pos="e,2435.5,15238 2249.3,15774 2344.6,15774 2435.5,15774 2435.5,15774 2435.5,15774 2435.5,15248 2435.5,15248"];
			q_proj_1_very_long_13	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,15666",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_13	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_13<br/>Block: 14/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,15612",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_13 -> flash_attn_1_very_long_13	[pos="e,1962.5,15630 1582.6,15666 1729.6,15666 1962.5,15666 1962.5,15666 1962.5,15666 1962.5,15640 1962.5,15640"];
			k_proj_1_very_long_13	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,15612",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_13 -> flash_attn_1_very_long_13	[pos="e,1818.1,15606 1582.2,15606 1582.2,15606 1808.1,15606 1808.1,15606"];
			v_proj_1_very_long_13	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,15558",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_13 -> flash_attn_1_very_long_13	[pos="e,2106.5,15594 1582.3,15558 1767.2,15558 2106.5,15558 2106.5,15558 2106.5,15558 2106.5,15584 2106.5,15584"];
			flash_attn_1_very_long_13 -> reduce_1_very_long	[pos="e,2413.5,15236 2249.4,15612 2335,15612 2413.5,15612 2413.5,15612 2413.5,15612 2413.5,15246 2413.5,15246"];
			q_proj_1_very_long_14	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,15504",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_14	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_14<br/>Block: 15/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,15450",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_14 -> flash_attn_1_very_long_14	[pos="e,1962.5,15468 1582.6,15504 1729.6,15504 1962.5,15504 1962.5,15504 1962.5,15504 1962.5,15478 1962.5,15478"];
			k_proj_1_very_long_14	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,15450",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_14 -> flash_attn_1_very_long_14	[pos="e,1818.1,15444 1582.2,15444 1582.2,15444 1808.1,15444 1808.1,15444"];
			v_proj_1_very_long_14	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,15396",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_14 -> flash_attn_1_very_long_14	[pos="e,2106.5,15432 1582.3,15396 1767.2,15396 2106.5,15396 2106.5,15396 2106.5,15396 2106.5,15422 2106.5,15422"];
			flash_attn_1_very_long_14 -> reduce_1_very_long	[pos="e,2391.5,15235 2249.3,15450 2325,15450 2391.5,15450 2391.5,15450 2391.5,15450 2391.5,15245 2391.5,15245"];
			q_proj_1_very_long_15	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,15342",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_15	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_15<br/>Block: 16/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,15288",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_15 -> flash_attn_1_very_long_15	[pos="e,1962.5,15306 1582.6,15342 1729.6,15342 1962.5,15342 1962.5,15342 1962.5,15342 1962.5,15316 1962.5,15316"];
			k_proj_1_very_long_15	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,15288",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_15 -> flash_attn_1_very_long_15	[pos="e,1818.1,15282 1582.2,15282 1582.2,15282 1808.1,15282 1808.1,15282"];
			v_proj_1_very_long_15	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,15234",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_15 -> flash_attn_1_very_long_15	[pos="e,1926.5,15270 1582.1,15242 1718.7,15242 1926.5,15242 1926.5,15242 1926.5,15242 1926.5,15260 1926.5,15260"];
			flash_attn_1_very_long_15 -> reduce_1_very_long	[pos="e,2375.9,15234 2034.5,15270 2034.5,15254 2034.5,15234 2034.5,15234 2034.5,15234 2365.9,15234 2365.9,15234"];
			q_proj_1_very_long_16	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,15180",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_16	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_16<br/>Block: 17/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,15180",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_16 -> flash_attn_1_very_long_16	[pos="e,1818,15174 1582.5,15174 1582.5,15174 1808,15174 1808,15174"];
			k_proj_1_very_long_16	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,15126",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_16 -> flash_attn_1_very_long_16	[pos="e,1962.5,15162 1582,15126 1728.9,15126 1962.5,15126 1962.5,15126 1962.5,15126 1962.5,15152 1962.5,15152"];
			v_proj_1_very_long_16	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,15072",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_16 -> flash_attn_1_very_long_16	[pos="e,2106.5,15162 1582.3,15072 1767.2,15072 2106.5,15072 2106.5,15072 2106.5,15072 2106.5,15152 2106.5,15152"];
			flash_attn_1_very_long_16 -> reduce_1_very_long	[pos="e,2484.3,15225 2141.5,15198 2141.5,15211 2141.5,15225 2141.5,15225 2141.5,15225 2474.3,15225 2474.3,15225"];
			q_proj_1_very_long_17	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,15018",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_17	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_17<br/>Block: 18/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,15018",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_17 -> flash_attn_1_very_long_17	[pos="e,1818,15012 1582.5,15012 1582.5,15012 1808,15012 1808,15012"];
			k_proj_1_very_long_17	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,14964",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_17 -> flash_attn_1_very_long_17	[pos="e,1962.5,15000 1582,14964 1728.9,14964 1962.5,14964 1962.5,14964 1962.5,14964 1962.5,14990 1962.5,14990"];
			v_proj_1_very_long_17	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,14910",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_17 -> flash_attn_1_very_long_17	[pos="e,2106.5,15000 1582.3,14910 1767.2,14910 2106.5,14910 2106.5,14910 2106.5,14910 2106.5,14990 2106.5,14990"];
			flash_attn_1_very_long_17 -> reduce_1_very_long	[pos="e,2719.5,15222 2249.3,15018 2450.4,15018 2719.5,15018 2719.5,15018 2719.5,15018 2719.5,15212 2719.5,15212"];
			q_proj_1_very_long_18	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,14856",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_18	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_18<br/>Block: 19/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,14856",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_18 -> flash_attn_1_very_long_18	[pos="e,1818,14850 1582.5,14850 1582.5,14850 1808,14850 1808,14850"];
			k_proj_1_very_long_18	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,14802",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_18 -> flash_attn_1_very_long_18	[pos="e,1962.5,14838 1582,14802 1728.9,14802 1962.5,14802 1962.5,14802 1962.5,14802 1962.5,14828 1962.5,14828"];
			v_proj_1_very_long_18	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,14748",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_18 -> flash_attn_1_very_long_18	[pos="e,2106.5,14838 1582.3,14748 1767.2,14748 2106.5,14748 2106.5,14748 2106.5,14748 2106.5,14828 2106.5,14828"];
			flash_attn_1_very_long_18 -> reduce_1_very_long	[pos="e,2741.5,15223 2249.4,14856 2457.6,14856 2741.5,14856 2741.5,14856 2741.5,14856 2741.5,15213 2741.5,15213"];
			q_proj_1_very_long_19	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,14694",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_19	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_19<br/>Block: 20/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,14694",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_19 -> flash_attn_1_very_long_19	[pos="e,1818,14688 1582.5,14688 1582.5,14688 1808,14688 1808,14688"];
			k_proj_1_very_long_19	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,14640",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_19 -> flash_attn_1_very_long_19	[pos="e,1962.5,14676 1582,14640 1728.9,14640 1962.5,14640 1962.5,14640 1962.5,14640 1962.5,14666 1962.5,14666"];
			v_proj_1_very_long_19	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,14586",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_19 -> flash_attn_1_very_long_19	[pos="e,2106.5,14676 1582.3,14586 1767.2,14586 2106.5,14586 2106.5,14586 2106.5,14586 2106.5,14666 2106.5,14666"];
			flash_attn_1_very_long_19 -> reduce_1_very_long	[pos="e,2763.5,15225 2249.7,14694 2464.9,14694 2763.5,14694 2763.5,14694 2763.5,14694 2763.5,15215 2763.5,15215"];
			q_proj_1_very_long_20	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,14532",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_20	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_20<br/>Block: 21/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,14532",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_20 -> flash_attn_1_very_long_20	[pos="e,1818,14526 1582.5,14526 1582.5,14526 1808,14526 1808,14526"];
			k_proj_1_very_long_20	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,14478",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_20 -> flash_attn_1_very_long_20	[pos="e,1962.5,14514 1582,14478 1728.9,14478 1962.5,14478 1962.5,14478 1962.5,14478 1962.5,14504 1962.5,14504"];
			v_proj_1_very_long_20	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,14424",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_20 -> flash_attn_1_very_long_20	[pos="e,2106.5,14514 1582.3,14424 1767.2,14424 2106.5,14424 2106.5,14424 2106.5,14424 2106.5,14504 2106.5,14504"];
			flash_attn_1_very_long_20 -> reduce_1_very_long	[pos="e,2785.5,15227 2249.4,14532 2471.5,14532 2785.5,14532 2785.5,14532 2785.5,14532 2785.5,15217 2785.5,15217"];
			q_proj_1_very_long_21	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,14370",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_21	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_21<br/>Block: 22/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,14370",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_21 -> flash_attn_1_very_long_21	[pos="e,1818,14364 1582.5,14364 1582.5,14364 1808,14364 1808,14364"];
			k_proj_1_very_long_21	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,14316",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_21 -> flash_attn_1_very_long_21	[pos="e,1962.5,14352 1582,14316 1728.9,14316 1962.5,14316 1962.5,14316 1962.5,14316 1962.5,14342 1962.5,14342"];
			v_proj_1_very_long_21	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,14262",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_21 -> flash_attn_1_very_long_21	[pos="e,2106.5,14352 1582.3,14262 1767.2,14262 2106.5,14262 2106.5,14262 2106.5,14262 2106.5,14342 2106.5,14342"];
			flash_attn_1_very_long_21 -> reduce_1_very_long	[pos="e,2806.5,15228 2249.2,14370 2477.9,14370 2806.5,14370 2806.5,14370 2806.5,14370 2806.5,15218 2806.5,15218"];
			q_proj_1_very_long_22	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,14208",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_22	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_22<br/>Block: 23/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,14208",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_22 -> flash_attn_1_very_long_22	[pos="e,1818,14202 1582.5,14202 1582.5,14202 1808,14202 1808,14202"];
			k_proj_1_very_long_22	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,14154",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_22 -> flash_attn_1_very_long_22	[pos="e,1962.5,14190 1582,14154 1728.9,14154 1962.5,14154 1962.5,14154 1962.5,14154 1962.5,14180 1962.5,14180"];
			v_proj_1_very_long_22	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,14100",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_22 -> flash_attn_1_very_long_22	[pos="e,2106.5,14190 1582.3,14100 1767.2,14100 2106.5,14100 2106.5,14100 2106.5,14100 2106.5,14180 2106.5,14180"];
			flash_attn_1_very_long_22 -> reduce_1_very_long	[pos="e,2828.5,15230 2249.3,14208 2484.7,14208 2828.5,14208 2828.5,14208 2828.5,14208 2828.5,15220 2828.5,15220"];
			q_proj_1_very_long_23	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,14046",
				shape=rectangle,
				width=3.25];
			flash_attn_1_very_long_23	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_23<br/>Block: 24/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,14046",
				shape=rectangle,
				width=5.9861];
			q_proj_1_very_long_23 -> flash_attn_1_very_long_23	[pos="e,1818,14040 1582.5,14040 1582.5,14040 1808,14040 1808,14040"];
			k_proj_1_very_long_23	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,13992",
				shape=rectangle,
				width=3.2361];
			k_proj_1_very_long_23 -> flash_attn_1_very_long_23	[pos="e,2034.5,14028 1582,13992 1748.5,13992 2034.5,13992 2034.5,13992 2034.5,13992 2034.5,14018 2034.5,14018"];
			v_proj_1_very_long_23	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,13938",
				shape=rectangle,
				width=3.2361];
			v_proj_1_very_long_23 -> flash_attn_1_very_long_23	[pos="e,2139.5,14028 1582.1,13938 1775,13938 2139.5,13938 2139.5,13938 2139.5,13938 2139.5,14018 2139.5,14018"];
			flash_attn_1_very_long_23 -> reduce_1_very_long	[pos="e,2850.5,15231 2249.4,14046 2491.4,14046 2850.5,14046 2850.5,14046 2850.5,14046 2850.5,15221 2850.5,15221"];
		}
		subgraph cluster_layer2_very_long {
			graph [bb="1340.5,9999,2880.1,13904",
				fontsize=10,
				label="Layer 2",
				lheight=0.15,
				lp="2110.3,13894",
				lwidth=0.54
			];
			q_proj_2_very_long_0	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,13859",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_0	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,13805",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_0 -> flash_attn_2_very_long_0	[pos="e,1929.5,13823 1580.2,13859 1717.6,13859 1929.5,13859 1929.5,13859 1929.5,13859 1929.5,13833 1929.5,13833"];
			k_proj_2_very_long_0	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,13805",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_0 -> flash_attn_2_very_long_0	[pos="e,1823.6,13799 1579.8,13799 1579.8,13799 1813.6,13799 1813.6,13799"];
			v_proj_2_very_long_0	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,13751",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_0 -> flash_attn_2_very_long_0	[pos="e,2104.5,13787 1579.7,13751 1763.5,13751 2104.5,13751 2104.5,13751 2104.5,13751 2104.5,13777 2104.5,13777"];
			reduce_2_very_long	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>24→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,11320",
				shape=diamond,
				width=6.9856];
			flash_attn_2_very_long_0 -> reduce_2_very_long	[pos="e,2697.5,11333 2243.7,13805 2438.2,13805 2697.5,13805 2697.5,13805 2697.5,13805 2697.5,11343 2697.5,11343"];
			q_proj_2_very_long_1	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,13697",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_1	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,13643",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_1 -> flash_attn_2_very_long_1	[pos="e,1964.5,13661 1580.3,13697 1727.6,13697 1964.5,13697 1964.5,13697 1964.5,13697 1964.5,13671 1964.5,13671"];
			k_proj_2_very_long_1	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,13643",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_1 -> flash_attn_2_very_long_1	[pos="e,1823.6,13637 1579.8,13637 1579.8,13637 1813.6,13637 1813.6,13637"];
			v_proj_2_very_long_1	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,13589",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_1 -> flash_attn_2_very_long_1	[pos="e,2104.5,13625 1579.7,13589 1763.5,13589 2104.5,13589 2104.5,13589 2104.5,13589 2104.5,13615 2104.5,13615"];
			flash_attn_2_very_long_1 -> reduce_2_very_long	[pos="e,2675.5,11334 2243.9,13643 2431,13643 2675.5,13643 2675.5,13643 2675.5,13643 2675.5,11344 2675.5,11344"];
			q_proj_2_very_long_2	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,13535",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_2	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,13481",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_2 -> flash_attn_2_very_long_2	[pos="e,1964.5,13499 1580.3,13535 1727.6,13535 1964.5,13535 1964.5,13535 1964.5,13535 1964.5,13509 1964.5,13509"];
			k_proj_2_very_long_2	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,13481",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_2 -> flash_attn_2_very_long_2	[pos="e,1823.6,13475 1579.8,13475 1579.8,13475 1813.6,13475 1813.6,13475"];
			v_proj_2_very_long_2	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,13427",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_2 -> flash_attn_2_very_long_2	[pos="e,2104.5,13463 1579.7,13427 1763.5,13427 2104.5,13427 2104.5,13427 2104.5,13427 2104.5,13453 2104.5,13453"];
			flash_attn_2_very_long_2 -> reduce_2_very_long	[pos="e,2653.5,11336 2244,13481 2423.7,13481 2653.5,13481 2653.5,13481 2653.5,13481 2653.5,11346 2653.5,11346"];
			q_proj_2_very_long_3	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,13373",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_3	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,13319",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_3 -> flash_attn_2_very_long_3	[pos="e,1964.5,13337 1580.3,13373 1727.6,13373 1964.5,13373 1964.5,13373 1964.5,13373 1964.5,13347 1964.5,13347"];
			k_proj_2_very_long_3	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,13319",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_3 -> flash_attn_2_very_long_3	[pos="e,1823.6,13313 1579.8,13313 1579.8,13313 1813.6,13313 1813.6,13313"];
			v_proj_2_very_long_3	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,13265",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_3 -> flash_attn_2_very_long_3	[pos="e,2104.5,13301 1579.7,13265 1763.5,13265 2104.5,13265 2104.5,13265 2104.5,13265 2104.5,13291 2104.5,13291"];
			flash_attn_2_very_long_3 -> reduce_2_very_long	[pos="e,2632.5,11337 2244,13319 2416.5,13319 2632.5,13319 2632.5,13319 2632.5,13319 2632.5,11347 2632.5,11347"];
			q_proj_2_very_long_4	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,13211",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_4	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,13157",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_4 -> flash_attn_2_very_long_4	[pos="e,1964.5,13175 1580.3,13211 1727.6,13211 1964.5,13211 1964.5,13211 1964.5,13211 1964.5,13185 1964.5,13185"];
			k_proj_2_very_long_4	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,13157",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_4 -> flash_attn_2_very_long_4	[pos="e,1823.6,13151 1579.8,13151 1579.8,13151 1813.6,13151 1813.6,13151"];
			v_proj_2_very_long_4	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,13103",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_4 -> flash_attn_2_very_long_4	[pos="e,2104.5,13139 1579.7,13103 1763.5,13103 2104.5,13103 2104.5,13103 2104.5,13103 2104.5,13129 2104.5,13129"];
			flash_attn_2_very_long_4 -> reduce_2_very_long	[pos="e,2610.5,11337 2244,13157 2408.8,13157 2610.5,13157 2610.5,13157 2610.5,13157 2610.5,11347 2610.5,11347"];
			q_proj_2_very_long_5	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,13049",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_5	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,12995",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_5 -> flash_attn_2_very_long_5	[pos="e,1964.5,13013 1580.3,13049 1727.6,13049 1964.5,13049 1964.5,13049 1964.5,13049 1964.5,13023 1964.5,13023"];
			k_proj_2_very_long_5	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,12995",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_5 -> flash_attn_2_very_long_5	[pos="e,1823.6,12989 1579.8,12989 1579.8,12989 1813.6,12989 1813.6,12989"];
			v_proj_2_very_long_5	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,12941",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_5 -> flash_attn_2_very_long_5	[pos="e,2104.5,12977 1579.7,12941 1763.5,12941 2104.5,12941 2104.5,12941 2104.5,12941 2104.5,12967 2104.5,12967"];
			flash_attn_2_very_long_5 -> reduce_2_very_long	[pos="e,2588.5,11336 2243.9,12995 2400.9,12995 2588.5,12995 2588.5,12995 2588.5,12995 2588.5,11346 2588.5,11346"];
			q_proj_2_very_long_6	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,12887",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_6	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,12833",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_6 -> flash_attn_2_very_long_6	[pos="e,1964.5,12851 1580.3,12887 1727.6,12887 1964.5,12887 1964.5,12887 1964.5,12887 1964.5,12861 1964.5,12861"];
			k_proj_2_very_long_6	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,12833",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_6 -> flash_attn_2_very_long_6	[pos="e,1823.6,12827 1579.8,12827 1579.8,12827 1813.6,12827 1813.6,12827"];
			v_proj_2_very_long_6	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,12779",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_6 -> flash_attn_2_very_long_6	[pos="e,2104.5,12815 1579.7,12779 1763.5,12779 2104.5,12779 2104.5,12779 2104.5,12779 2104.5,12805 2104.5,12805"];
			flash_attn_2_very_long_6 -> reduce_2_very_long	[pos="e,2566.5,11334 2243.9,12833 2392.9,12833 2566.5,12833 2566.5,12833 2566.5,12833 2566.5,11344 2566.5,11344"];
			q_proj_2_very_long_7	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,12725",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_7	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,12671",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_7 -> flash_attn_2_very_long_7	[pos="e,1964.5,12689 1580.3,12725 1727.6,12725 1964.5,12725 1964.5,12725 1964.5,12725 1964.5,12699 1964.5,12699"];
			k_proj_2_very_long_7	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,12671",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_7 -> flash_attn_2_very_long_7	[pos="e,1823.6,12665 1579.8,12665 1579.8,12665 1813.6,12665 1813.6,12665"];
			v_proj_2_very_long_7	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,12617",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_7 -> flash_attn_2_very_long_7	[pos="e,2104.5,12653 1579.7,12617 1763.5,12617 2104.5,12617 2104.5,12617 2104.5,12617 2104.5,12643 2104.5,12643"];
			flash_attn_2_very_long_7 -> reduce_2_very_long	[pos="e,2544.5,11333 2244.1,12671 2384.8,12671 2544.5,12671 2544.5,12671 2544.5,12671 2544.5,11343 2544.5,11343"];
			q_proj_2_very_long_8	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,12563",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_8	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_8<br/>Block: 9/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,12509",
				shape=rectangle,
				width=5.8333];
			q_proj_2_very_long_8 -> flash_attn_2_very_long_8	[pos="e,1964.5,12527 1580.3,12563 1727.6,12563 1964.5,12563 1964.5,12563 1964.5,12563 1964.5,12537 1964.5,12537"];
			k_proj_2_very_long_8	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,12509",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_8 -> flash_attn_2_very_long_8	[pos="e,1823.6,12503 1579.8,12503 1579.8,12503 1813.6,12503 1813.6,12503"];
			v_proj_2_very_long_8	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,12455",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_8 -> flash_attn_2_very_long_8	[pos="e,2104.5,12491 1579.7,12455 1763.5,12455 2104.5,12455 2104.5,12455 2104.5,12455 2104.5,12481 2104.5,12481"];
			flash_attn_2_very_long_8 -> reduce_2_very_long	[pos="e,2522.5,11331 2243.8,12509 2376.3,12509 2522.5,12509 2522.5,12509 2522.5,12509 2522.5,11341 2522.5,11341"];
			q_proj_2_very_long_9	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,12401",
				shape=rectangle,
				width=3.1806];
			flash_attn_2_very_long_9	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_9<br/>Block: 10/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,12347",
				shape=rectangle,
				width=5.9028];
			q_proj_2_very_long_9 -> flash_attn_2_very_long_9	[pos="e,1964.5,12365 1580.3,12401 1727.6,12401 1964.5,12401 1964.5,12401 1964.5,12401 1964.5,12375 1964.5,12375"];
			k_proj_2_very_long_9	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,12347",
				shape=rectangle,
				width=3.1667];
			k_proj_2_very_long_9 -> flash_attn_2_very_long_9	[pos="e,1821,12341 1579.8,12341 1579.8,12341 1811,12341 1811,12341"];
			v_proj_2_very_long_9	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,12293",
				shape=rectangle,
				width=3.1667];
			v_proj_2_very_long_9 -> flash_attn_2_very_long_9	[pos="e,2105.5,12329 1579.5,12293 1763.5,12293 2105.5,12293 2105.5,12293 2105.5,12293 2105.5,12319 2105.5,12319"];
			flash_attn_2_very_long_9 -> reduce_2_very_long	[pos="e,2500.5,11330 2246.3,12347 2369.5,12347 2500.5,12347 2500.5,12347 2500.5,12347 2500.5,11340 2500.5,11340"];
			q_proj_2_very_long_10	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,12239",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_10	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_10<br/>Block: 11/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,12185",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_10 -> flash_attn_2_very_long_10	[pos="e,1963.5,12203 1582.6,12239 1729.8,12239 1963.5,12239 1963.5,12239 1963.5,12239 1963.5,12213 1963.5,12213"];
			k_proj_2_very_long_10	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,12185",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_10 -> flash_attn_2_very_long_10	[pos="e,1818.1,12179 1582.2,12179 1582.2,12179 1808.1,12179 1808.1,12179"];
			v_proj_2_very_long_10	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,12131",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_10 -> flash_attn_2_very_long_10	[pos="e,2106.5,12167 1582.3,12131 1767.2,12131 2106.5,12131 2106.5,12131 2106.5,12131 2106.5,12157 2106.5,12157"];
			flash_attn_2_very_long_10 -> reduce_2_very_long	[pos="e,2478.5,11328 2249.3,12185 2362.7,12185 2478.5,12185 2478.5,12185 2478.5,12185 2478.5,11338 2478.5,11338"];
			q_proj_2_very_long_11	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,12077",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_11	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_11<br/>Block: 12/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,12023",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_11 -> flash_attn_2_very_long_11	[pos="e,1962.5,12041 1582.6,12077 1729.6,12077 1962.5,12077 1962.5,12077 1962.5,12077 1962.5,12051 1962.5,12051"];
			k_proj_2_very_long_11	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,12023",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_11 -> flash_attn_2_very_long_11	[pos="e,1818.1,12017 1582.2,12017 1582.2,12017 1808.1,12017 1808.1,12017"];
			v_proj_2_very_long_11	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,11969",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_11 -> flash_attn_2_very_long_11	[pos="e,2106.5,12005 1582.3,11969 1767.2,11969 2106.5,11969 2106.5,11969 2106.5,11969 2106.5,11995 2106.5,11995"];
			flash_attn_2_very_long_11 -> reduce_2_very_long	[pos="e,2457.5,11327 2249.3,12023 2354,12023 2457.5,12023 2457.5,12023 2457.5,12023 2457.5,11337 2457.5,11337"];
			q_proj_2_very_long_12	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,11915",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_12	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_12<br/>Block: 13/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,11861",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_12 -> flash_attn_2_very_long_12	[pos="e,1962.5,11879 1582.6,11915 1729.6,11915 1962.5,11915 1962.5,11915 1962.5,11915 1962.5,11889 1962.5,11889"];
			k_proj_2_very_long_12	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,11861",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_12 -> flash_attn_2_very_long_12	[pos="e,1818.1,11855 1582.2,11855 1582.2,11855 1808.1,11855 1808.1,11855"];
			v_proj_2_very_long_12	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,11807",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_12 -> flash_attn_2_very_long_12	[pos="e,2106.5,11843 1582.3,11807 1767.2,11807 2106.5,11807 2106.5,11807 2106.5,11807 2106.5,11833 2106.5,11833"];
			flash_attn_2_very_long_12 -> reduce_2_very_long	[pos="e,2435.5,11325 2249.3,11861 2344.6,11861 2435.5,11861 2435.5,11861 2435.5,11861 2435.5,11335 2435.5,11335"];
			q_proj_2_very_long_13	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,11753",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_13	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_13<br/>Block: 14/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,11699",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_13 -> flash_attn_2_very_long_13	[pos="e,1962.5,11717 1582.6,11753 1729.6,11753 1962.5,11753 1962.5,11753 1962.5,11753 1962.5,11727 1962.5,11727"];
			k_proj_2_very_long_13	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,11699",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_13 -> flash_attn_2_very_long_13	[pos="e,1818.1,11693 1582.2,11693 1582.2,11693 1808.1,11693 1808.1,11693"];
			v_proj_2_very_long_13	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,11645",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_13 -> flash_attn_2_very_long_13	[pos="e,2106.5,11681 1582.3,11645 1767.2,11645 2106.5,11645 2106.5,11645 2106.5,11645 2106.5,11671 2106.5,11671"];
			flash_attn_2_very_long_13 -> reduce_2_very_long	[pos="e,2413.5,11323 2249.4,11699 2335,11699 2413.5,11699 2413.5,11699 2413.5,11699 2413.5,11333 2413.5,11333"];
			q_proj_2_very_long_14	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,11591",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_14	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_14<br/>Block: 15/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,11537",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_14 -> flash_attn_2_very_long_14	[pos="e,1962.5,11555 1582.6,11591 1729.6,11591 1962.5,11591 1962.5,11591 1962.5,11591 1962.5,11565 1962.5,11565"];
			k_proj_2_very_long_14	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,11537",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_14 -> flash_attn_2_very_long_14	[pos="e,1818.1,11531 1582.2,11531 1582.2,11531 1808.1,11531 1808.1,11531"];
			v_proj_2_very_long_14	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,11483",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_14 -> flash_attn_2_very_long_14	[pos="e,2106.5,11519 1582.3,11483 1767.2,11483 2106.5,11483 2106.5,11483 2106.5,11483 2106.5,11509 2106.5,11509"];
			flash_attn_2_very_long_14 -> reduce_2_very_long	[pos="e,2391.5,11322 2249.3,11537 2325,11537 2391.5,11537 2391.5,11537 2391.5,11537 2391.5,11332 2391.5,11332"];
			q_proj_2_very_long_15	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,11429",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_15	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_15<br/>Block: 16/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,11375",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_15 -> flash_attn_2_very_long_15	[pos="e,1962.5,11393 1582.6,11429 1729.6,11429 1962.5,11429 1962.5,11429 1962.5,11429 1962.5,11403 1962.5,11403"];
			k_proj_2_very_long_15	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,11375",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_15 -> flash_attn_2_very_long_15	[pos="e,1818.1,11369 1582.2,11369 1582.2,11369 1808.1,11369 1808.1,11369"];
			v_proj_2_very_long_15	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,11321",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_15 -> flash_attn_2_very_long_15	[pos="e,1926.5,11357 1582.1,11329 1718.7,11329 1926.5,11329 1926.5,11329 1926.5,11329 1926.5,11347 1926.5,11347"];
			flash_attn_2_very_long_15 -> reduce_2_very_long	[pos="e,2375.9,11320 2034.5,11357 2034.5,11341 2034.5,11320 2034.5,11320 2034.5,11320 2365.9,11320 2365.9,11320"];
			q_proj_2_very_long_16	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,11267",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_16	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_16<br/>Block: 17/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,11267",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_16 -> flash_attn_2_very_long_16	[pos="e,1818,11261 1582.5,11261 1582.5,11261 1808,11261 1808,11261"];
			k_proj_2_very_long_16	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,11213",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_16 -> flash_attn_2_very_long_16	[pos="e,1962.5,11249 1582,11213 1728.9,11213 1962.5,11213 1962.5,11213 1962.5,11213 1962.5,11239 1962.5,11239"];
			v_proj_2_very_long_16	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,11159",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_16 -> flash_attn_2_very_long_16	[pos="e,2106.5,11249 1582.3,11159 1767.2,11159 2106.5,11159 2106.5,11159 2106.5,11159 2106.5,11239 2106.5,11239"];
			flash_attn_2_very_long_16 -> reduce_2_very_long	[pos="e,2484.3,11312 2141.5,11285 2141.5,11298 2141.5,11312 2141.5,11312 2141.5,11312 2474.3,11312 2474.3,11312"];
			q_proj_2_very_long_17	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,11105",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_17	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_17<br/>Block: 18/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,11105",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_17 -> flash_attn_2_very_long_17	[pos="e,1818,11099 1582.5,11099 1582.5,11099 1808,11099 1808,11099"];
			k_proj_2_very_long_17	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,11051",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_17 -> flash_attn_2_very_long_17	[pos="e,1962.5,11087 1582,11051 1728.9,11051 1962.5,11051 1962.5,11051 1962.5,11051 1962.5,11077 1962.5,11077"];
			v_proj_2_very_long_17	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,10997",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_17 -> flash_attn_2_very_long_17	[pos="e,2106.5,11087 1582.3,10997 1767.2,10997 2106.5,10997 2106.5,10997 2106.5,10997 2106.5,11077 2106.5,11077"];
			flash_attn_2_very_long_17 -> reduce_2_very_long	[pos="e,2719.5,11309 2249.3,11105 2450.4,11105 2719.5,11105 2719.5,11105 2719.5,11105 2719.5,11299 2719.5,11299"];
			q_proj_2_very_long_18	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,10943",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_18	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_18<br/>Block: 19/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,10943",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_18 -> flash_attn_2_very_long_18	[pos="e,1818,10937 1582.5,10937 1582.5,10937 1808,10937 1808,10937"];
			k_proj_2_very_long_18	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,10889",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_18 -> flash_attn_2_very_long_18	[pos="e,1962.5,10925 1582,10889 1728.9,10889 1962.5,10889 1962.5,10889 1962.5,10889 1962.5,10915 1962.5,10915"];
			v_proj_2_very_long_18	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,10835",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_18 -> flash_attn_2_very_long_18	[pos="e,2106.5,10925 1582.3,10835 1767.2,10835 2106.5,10835 2106.5,10835 2106.5,10835 2106.5,10915 2106.5,10915"];
			flash_attn_2_very_long_18 -> reduce_2_very_long	[pos="e,2741.5,11310 2249.4,10943 2457.6,10943 2741.5,10943 2741.5,10943 2741.5,10943 2741.5,11300 2741.5,11300"];
			q_proj_2_very_long_19	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,10781",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_19	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_19<br/>Block: 20/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,10781",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_19 -> flash_attn_2_very_long_19	[pos="e,1818,10775 1582.5,10775 1582.5,10775 1808,10775 1808,10775"];
			k_proj_2_very_long_19	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,10727",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_19 -> flash_attn_2_very_long_19	[pos="e,1962.5,10763 1582,10727 1728.9,10727 1962.5,10727 1962.5,10727 1962.5,10727 1962.5,10753 1962.5,10753"];
			v_proj_2_very_long_19	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,10673",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_19 -> flash_attn_2_very_long_19	[pos="e,2106.5,10763 1582.3,10673 1767.2,10673 2106.5,10673 2106.5,10673 2106.5,10673 2106.5,10753 2106.5,10753"];
			flash_attn_2_very_long_19 -> reduce_2_very_long	[pos="e,2763.5,11312 2249.7,10781 2464.9,10781 2763.5,10781 2763.5,10781 2763.5,10781 2763.5,11302 2763.5,11302"];
			q_proj_2_very_long_20	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,10619",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_20	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_20<br/>Block: 21/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,10619",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_20 -> flash_attn_2_very_long_20	[pos="e,1818,10613 1582.5,10613 1582.5,10613 1808,10613 1808,10613"];
			k_proj_2_very_long_20	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,10565",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_20 -> flash_attn_2_very_long_20	[pos="e,1962.5,10601 1582,10565 1728.9,10565 1962.5,10565 1962.5,10565 1962.5,10565 1962.5,10591 1962.5,10591"];
			v_proj_2_very_long_20	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,10511",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_20 -> flash_attn_2_very_long_20	[pos="e,2106.5,10601 1582.3,10511 1767.2,10511 2106.5,10511 2106.5,10511 2106.5,10511 2106.5,10591 2106.5,10591"];
			flash_attn_2_very_long_20 -> reduce_2_very_long	[pos="e,2785.5,11314 2249.4,10619 2471.5,10619 2785.5,10619 2785.5,10619 2785.5,10619 2785.5,11304 2785.5,11304"];
			q_proj_2_very_long_21	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,10457",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_21	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_21<br/>Block: 22/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,10457",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_21 -> flash_attn_2_very_long_21	[pos="e,1818,10451 1582.5,10451 1582.5,10451 1808,10451 1808,10451"];
			k_proj_2_very_long_21	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,10403",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_21 -> flash_attn_2_very_long_21	[pos="e,1962.5,10439 1582,10403 1728.9,10403 1962.5,10403 1962.5,10403 1962.5,10403 1962.5,10429 1962.5,10429"];
			v_proj_2_very_long_21	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,10349",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_21 -> flash_attn_2_very_long_21	[pos="e,2106.5,10439 1582.3,10349 1767.2,10349 2106.5,10349 2106.5,10349 2106.5,10349 2106.5,10429 2106.5,10429"];
			flash_attn_2_very_long_21 -> reduce_2_very_long	[pos="e,2806.5,11315 2249.2,10457 2477.9,10457 2806.5,10457 2806.5,10457 2806.5,10457 2806.5,11305 2806.5,11305"];
			q_proj_2_very_long_22	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,10295",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_22	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_22<br/>Block: 23/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,10295",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_22 -> flash_attn_2_very_long_22	[pos="e,1818,10289 1582.5,10289 1582.5,10289 1808,10289 1808,10289"];
			k_proj_2_very_long_22	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,10241",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_22 -> flash_attn_2_very_long_22	[pos="e,1962.5,10277 1582,10241 1728.9,10241 1962.5,10241 1962.5,10241 1962.5,10241 1962.5,10267 1962.5,10267"];
			v_proj_2_very_long_22	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,10187",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_22 -> flash_attn_2_very_long_22	[pos="e,2106.5,10277 1582.3,10187 1767.2,10187 2106.5,10187 2106.5,10187 2106.5,10187 2106.5,10267 2106.5,10267"];
			flash_attn_2_very_long_22 -> reduce_2_very_long	[pos="e,2828.5,11317 2249.3,10295 2484.7,10295 2828.5,10295 2828.5,10295 2828.5,10295 2828.5,11307 2828.5,11307"];
			q_proj_2_very_long_23	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,10133",
				shape=rectangle,
				width=3.25];
			flash_attn_2_very_long_23	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_23<br/>Block: 24/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,10133",
				shape=rectangle,
				width=5.9861];
			q_proj_2_very_long_23 -> flash_attn_2_very_long_23	[pos="e,1818,10127 1582.5,10127 1582.5,10127 1808,10127 1808,10127"];
			k_proj_2_very_long_23	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,10079",
				shape=rectangle,
				width=3.2361];
			k_proj_2_very_long_23 -> flash_attn_2_very_long_23	[pos="e,2034.5,10115 1582,10079 1748.5,10079 2034.5,10079 2034.5,10079 2034.5,10079 2034.5,10105 2034.5,10105"];
			v_proj_2_very_long_23	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,10025",
				shape=rectangle,
				width=3.2361];
			v_proj_2_very_long_23 -> flash_attn_2_very_long_23	[pos="e,2139.5,10115 1582.1,10025 1775,10025 2139.5,10025 2139.5,10025 2139.5,10025 2139.5,10105 2139.5,10105"];
			flash_attn_2_very_long_23 -> reduce_2_very_long	[pos="e,2850.5,11318 2249.4,10133 2491.4,10133 2850.5,10133 2850.5,10133 2850.5,10133 2850.5,11308 2850.5,11308"];
		}
		subgraph cluster_layer3_very_long {
			graph [bb="1340.5,6086,2880.1,9991",
				fontsize=10,
				label="Layer 3",
				lheight=0.15,
				lp="2110.3,9981.5",
				lwidth=0.54
			];
			q_proj_3_very_long_0	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,9946",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_0	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_0<br/>Block: 1/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,9892",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_0 -> flash_attn_3_very_long_0	[pos="e,1929.5,9910.3 1580.2,9946 1717.6,9946 1929.5,9946 1929.5,9946 1929.5,9946 1929.5,9920.3 1929.5,9920.3"];
			k_proj_3_very_long_0	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,9892",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_0 -> flash_attn_3_very_long_0	[pos="e,1823.6,9886 1579.8,9886 1579.8,9886 1813.6,9886 1813.6,9886"];
			v_proj_3_very_long_0	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_0<br/>[512→(32×16)]",
				pos="1465.5,9838",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_0 -> flash_attn_3_very_long_0	[pos="e,2104.5,9873.7 1579.7,9838 1763.5,9838 2104.5,9838 2104.5,9838 2104.5,9838 2104.5,9863.7 2104.5,9863.7"];
			reduce_3_very_long	[fillcolor=lightgray,
				height=0.5,
				label="<b>Hierarchical Reduce</b><br/>24→8 GPUs<br/>Concatenate blocks",
				pos="2620.6,7407",
				shape=diamond,
				width=6.9856];
			flash_attn_3_very_long_0 -> reduce_3_very_long	[pos="e,2697.5,7419.8 2243.7,9892 2438.2,9892 2697.5,9892 2697.5,9892 2697.5,9892 2697.5,7429.8 2697.5,7429.8"];
			q_proj_3_very_long_1	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,9784",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_1	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_1<br/>Block: 2/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,9730",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_1 -> flash_attn_3_very_long_1	[pos="e,1964.5,9748.3 1580.3,9784 1727.6,9784 1964.5,9784 1964.5,9784 1964.5,9784 1964.5,9758.3 1964.5,9758.3"];
			k_proj_3_very_long_1	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,9730",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_1 -> flash_attn_3_very_long_1	[pos="e,1823.6,9724 1579.8,9724 1579.8,9724 1813.6,9724 1813.6,9724"];
			v_proj_3_very_long_1	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_1<br/>[512→(32×16)]",
				pos="1465.5,9676",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_1 -> flash_attn_3_very_long_1	[pos="e,2104.5,9711.7 1579.7,9676 1763.5,9676 2104.5,9676 2104.5,9676 2104.5,9676 2104.5,9701.7 2104.5,9701.7"];
			flash_attn_3_very_long_1 -> reduce_3_very_long	[pos="e,2675.5,7421.2 2243.9,9730 2431,9730 2675.5,9730 2675.5,9730 2675.5,9730 2675.5,7431.2 2675.5,7431.2"];
			q_proj_3_very_long_2	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,9622",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_2	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_2<br/>Block: 3/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,9568",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_2 -> flash_attn_3_very_long_2	[pos="e,1964.5,9586.3 1580.3,9622 1727.6,9622 1964.5,9622 1964.5,9622 1964.5,9622 1964.5,9596.3 1964.5,9596.3"];
			k_proj_3_very_long_2	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,9568",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_2 -> flash_attn_3_very_long_2	[pos="e,1823.6,9562 1579.8,9562 1579.8,9562 1813.6,9562 1813.6,9562"];
			v_proj_3_very_long_2	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_2<br/>[512→(32×16)]",
				pos="1465.5,9514",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_2 -> flash_attn_3_very_long_2	[pos="e,2104.5,9549.7 1579.7,9514 1763.5,9514 2104.5,9514 2104.5,9514 2104.5,9514 2104.5,9539.7 2104.5,9539.7"];
			flash_attn_3_very_long_2 -> reduce_3_very_long	[pos="e,2653.5,7422.8 2244,9568 2423.7,9568 2653.5,9568 2653.5,9568 2653.5,9568 2653.5,7432.8 2653.5,7432.8"];
			q_proj_3_very_long_3	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,9460",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_3	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_3<br/>Block: 4/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,9406",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_3 -> flash_attn_3_very_long_3	[pos="e,1964.5,9424.3 1580.3,9460 1727.6,9460 1964.5,9460 1964.5,9460 1964.5,9460 1964.5,9434.3 1964.5,9434.3"];
			k_proj_3_very_long_3	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,9406",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_3 -> flash_attn_3_very_long_3	[pos="e,1823.6,9400 1579.8,9400 1579.8,9400 1813.6,9400 1813.6,9400"];
			v_proj_3_very_long_3	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_3<br/>[512→(32×16)]",
				pos="1465.5,9352",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_3 -> flash_attn_3_very_long_3	[pos="e,2104.5,9387.7 1579.7,9352 1763.5,9352 2104.5,9352 2104.5,9352 2104.5,9352 2104.5,9377.7 2104.5,9377.7"];
			flash_attn_3_very_long_3 -> reduce_3_very_long	[pos="e,2632.5,7424.3 2244,9406 2416.5,9406 2632.5,9406 2632.5,9406 2632.5,9406 2632.5,7434.3 2632.5,7434.3"];
			q_proj_3_very_long_4	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,9298",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_4	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_4<br/>Block: 5/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,9244",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_4 -> flash_attn_3_very_long_4	[pos="e,1964.5,9262.3 1580.3,9298 1727.6,9298 1964.5,9298 1964.5,9298 1964.5,9298 1964.5,9272.3 1964.5,9272.3"];
			k_proj_3_very_long_4	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,9244",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_4 -> flash_attn_3_very_long_4	[pos="e,1823.6,9238 1579.8,9238 1579.8,9238 1813.6,9238 1813.6,9238"];
			v_proj_3_very_long_4	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_4<br/>[512→(32×16)]",
				pos="1465.5,9190",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_4 -> flash_attn_3_very_long_4	[pos="e,2104.5,9225.7 1579.7,9190 1763.5,9190 2104.5,9190 2104.5,9190 2104.5,9190 2104.5,9215.7 2104.5,9215.7"];
			flash_attn_3_very_long_4 -> reduce_3_very_long	[pos="e,2610.5,7424.3 2244,9244 2408.8,9244 2610.5,9244 2610.5,9244 2610.5,9244 2610.5,7434.3 2610.5,7434.3"];
			q_proj_3_very_long_5	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,9136",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_5	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_5<br/>Block: 6/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,9082",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_5 -> flash_attn_3_very_long_5	[pos="e,1964.5,9100.3 1580.3,9136 1727.6,9136 1964.5,9136 1964.5,9136 1964.5,9136 1964.5,9110.3 1964.5,9110.3"];
			k_proj_3_very_long_5	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,9082",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_5 -> flash_attn_3_very_long_5	[pos="e,1823.6,9076 1579.8,9076 1579.8,9076 1813.6,9076 1813.6,9076"];
			v_proj_3_very_long_5	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_5<br/>[512→(32×16)]",
				pos="1465.5,9028",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_5 -> flash_attn_3_very_long_5	[pos="e,2104.5,9063.7 1579.7,9028 1763.5,9028 2104.5,9028 2104.5,9028 2104.5,9028 2104.5,9053.7 2104.5,9053.7"];
			flash_attn_3_very_long_5 -> reduce_3_very_long	[pos="e,2588.5,7422.8 2243.9,9082 2400.9,9082 2588.5,9082 2588.5,9082 2588.5,9082 2588.5,7432.8 2588.5,7432.8"];
			q_proj_3_very_long_6	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,8974",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_6	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_6<br/>Block: 7/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,8920",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_6 -> flash_attn_3_very_long_6	[pos="e,1964.5,8938.3 1580.3,8974 1727.6,8974 1964.5,8974 1964.5,8974 1964.5,8974 1964.5,8948.3 1964.5,8948.3"];
			k_proj_3_very_long_6	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,8920",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_6 -> flash_attn_3_very_long_6	[pos="e,1823.6,8914 1579.8,8914 1579.8,8914 1813.6,8914 1813.6,8914"];
			v_proj_3_very_long_6	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_6<br/>[512→(32×16)]",
				pos="1465.5,8866",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_6 -> flash_attn_3_very_long_6	[pos="e,2104.5,8901.7 1579.7,8866 1763.5,8866 2104.5,8866 2104.5,8866 2104.5,8866 2104.5,8891.7 2104.5,8891.7"];
			flash_attn_3_very_long_6 -> reduce_3_very_long	[pos="e,2566.5,7421.5 2243.9,8920 2392.9,8920 2566.5,8920 2566.5,8920 2566.5,8920 2566.5,7431.5 2566.5,7431.5"];
			q_proj_3_very_long_7	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,8812",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_7	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_7<br/>Block: 8/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,8758",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_7 -> flash_attn_3_very_long_7	[pos="e,1964.5,8776.3 1580.3,8812 1727.6,8812 1964.5,8812 1964.5,8812 1964.5,8812 1964.5,8786.3 1964.5,8786.3"];
			k_proj_3_very_long_7	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,8758",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_7 -> flash_attn_3_very_long_7	[pos="e,1823.6,8752 1579.8,8752 1579.8,8752 1813.6,8752 1813.6,8752"];
			v_proj_3_very_long_7	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_7<br/>[512→(32×16)]",
				pos="1465.5,8704",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_7 -> flash_attn_3_very_long_7	[pos="e,2104.5,8739.7 1579.7,8704 1763.5,8704 2104.5,8704 2104.5,8704 2104.5,8704 2104.5,8729.7 2104.5,8729.7"];
			flash_attn_3_very_long_7 -> reduce_3_very_long	[pos="e,2544.5,7419.9 2244.1,8758 2384.8,8758 2544.5,8758 2544.5,8758 2544.5,8758 2544.5,7429.9 2544.5,7429.9"];
			q_proj_3_very_long_8	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,8650",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_8	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_8<br/>Block: 9/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,8596",
				shape=rectangle,
				width=5.8333];
			q_proj_3_very_long_8 -> flash_attn_3_very_long_8	[pos="e,1964.5,8614.3 1580.3,8650 1727.6,8650 1964.5,8650 1964.5,8650 1964.5,8650 1964.5,8624.3 1964.5,8624.3"];
			k_proj_3_very_long_8	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,8596",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_8 -> flash_attn_3_very_long_8	[pos="e,1823.6,8590 1579.8,8590 1579.8,8590 1813.6,8590 1813.6,8590"];
			v_proj_3_very_long_8	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_8<br/>[512→(32×16)]",
				pos="1465.5,8542",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_8 -> flash_attn_3_very_long_8	[pos="e,2104.5,8577.7 1579.7,8542 1763.5,8542 2104.5,8542 2104.5,8542 2104.5,8542 2104.5,8567.7 2104.5,8567.7"];
			flash_attn_3_very_long_8 -> reduce_3_very_long	[pos="e,2522.5,7418 2243.8,8596 2376.3,8596 2522.5,8596 2522.5,8596 2522.5,8596 2522.5,7428 2522.5,7428"];
			q_proj_3_very_long_9	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,8488",
				shape=rectangle,
				width=3.1806];
			flash_attn_3_very_long_9	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_9<br/>Block: 10/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,8434",
				shape=rectangle,
				width=5.9028];
			q_proj_3_very_long_9 -> flash_attn_3_very_long_9	[pos="e,1964.5,8452.3 1580.3,8488 1727.6,8488 1964.5,8488 1964.5,8488 1964.5,8488 1964.5,8462.3 1964.5,8462.3"];
			k_proj_3_very_long_9	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,8434",
				shape=rectangle,
				width=3.1667];
			k_proj_3_very_long_9 -> flash_attn_3_very_long_9	[pos="e,1821,8428 1579.8,8428 1579.8,8428 1811,8428 1811,8428"];
			v_proj_3_very_long_9	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_9<br/>[512→(32×16)]",
				pos="1465.5,8380",
				shape=rectangle,
				width=3.1667];
			v_proj_3_very_long_9 -> flash_attn_3_very_long_9	[pos="e,2105.5,8415.7 1579.5,8380 1763.5,8380 2105.5,8380 2105.5,8380 2105.5,8380 2105.5,8405.7 2105.5,8405.7"];
			flash_attn_3_very_long_9 -> reduce_3_very_long	[pos="e,2500.5,7416.5 2246.3,8434 2369.5,8434 2500.5,8434 2500.5,8434 2500.5,8434 2500.5,7426.5 2500.5,7426.5"];
			q_proj_3_very_long_10	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,8326",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_10	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_10<br/>Block: 11/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,8272",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_10 -> flash_attn_3_very_long_10	[pos="e,1963.5,8290.3 1582.6,8326 1729.8,8326 1963.5,8326 1963.5,8326 1963.5,8326 1963.5,8300.3 1963.5,8300.3"];
			k_proj_3_very_long_10	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,8272",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_10 -> flash_attn_3_very_long_10	[pos="e,1818.1,8266 1582.2,8266 1582.2,8266 1808.1,8266 1808.1,8266"];
			v_proj_3_very_long_10	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_10<br/>[512→(32×16)]",
				pos="1465.5,8218",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_10 -> flash_attn_3_very_long_10	[pos="e,2106.5,8253.7 1582.3,8218 1767.2,8218 2106.5,8218 2106.5,8218 2106.5,8218 2106.5,8243.7 2106.5,8243.7"];
			flash_attn_3_very_long_10 -> reduce_3_very_long	[pos="e,2478.5,7415 2249.3,8272 2362.7,8272 2478.5,8272 2478.5,8272 2478.5,8272 2478.5,7425 2478.5,7425"];
			q_proj_3_very_long_11	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,8164",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_11	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_11<br/>Block: 12/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,8110",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_11 -> flash_attn_3_very_long_11	[pos="e,1962.5,8128.3 1582.6,8164 1729.6,8164 1962.5,8164 1962.5,8164 1962.5,8164 1962.5,8138.3 1962.5,8138.3"];
			k_proj_3_very_long_11	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,8110",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_11 -> flash_attn_3_very_long_11	[pos="e,1818.1,8104 1582.2,8104 1582.2,8104 1808.1,8104 1808.1,8104"];
			v_proj_3_very_long_11	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_11<br/>[512→(32×16)]",
				pos="1465.5,8056",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_11 -> flash_attn_3_very_long_11	[pos="e,2106.5,8091.7 1582.3,8056 1767.2,8056 2106.5,8056 2106.5,8056 2106.5,8056 2106.5,8081.7 2106.5,8081.7"];
			flash_attn_3_very_long_11 -> reduce_3_very_long	[pos="e,2457.5,7413.5 2249.3,8110 2354,8110 2457.5,8110 2457.5,8110 2457.5,8110 2457.5,7423.5 2457.5,7423.5"];
			q_proj_3_very_long_12	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,8002",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_12	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_12<br/>Block: 13/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,7948",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_12 -> flash_attn_3_very_long_12	[pos="e,1962.5,7966.3 1582.6,8002 1729.6,8002 1962.5,8002 1962.5,8002 1962.5,8002 1962.5,7976.3 1962.5,7976.3"];
			k_proj_3_very_long_12	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,7948",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_12 -> flash_attn_3_very_long_12	[pos="e,1818.1,7942 1582.2,7942 1582.2,7942 1808.1,7942 1808.1,7942"];
			v_proj_3_very_long_12	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_12<br/>[512→(32×16)]",
				pos="1465.5,7894",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_12 -> flash_attn_3_very_long_12	[pos="e,2106.5,7929.7 1582.3,7894 1767.2,7894 2106.5,7894 2106.5,7894 2106.5,7894 2106.5,7919.7 2106.5,7919.7"];
			flash_attn_3_very_long_12 -> reduce_3_very_long	[pos="e,2435.5,7412 2249.3,7948 2344.6,7948 2435.5,7948 2435.5,7948 2435.5,7948 2435.5,7422 2435.5,7422"];
			q_proj_3_very_long_13	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,7840",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_13	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_13<br/>Block: 14/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,7786",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_13 -> flash_attn_3_very_long_13	[pos="e,1962.5,7804.3 1582.6,7840 1729.6,7840 1962.5,7840 1962.5,7840 1962.5,7840 1962.5,7814.3 1962.5,7814.3"];
			k_proj_3_very_long_13	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,7786",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_13 -> flash_attn_3_very_long_13	[pos="e,1818.1,7780 1582.2,7780 1582.2,7780 1808.1,7780 1808.1,7780"];
			v_proj_3_very_long_13	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_13<br/>[512→(32×16)]",
				pos="1465.5,7732",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_13 -> flash_attn_3_very_long_13	[pos="e,2106.5,7767.7 1582.3,7732 1767.2,7732 2106.5,7732 2106.5,7732 2106.5,7732 2106.5,7757.7 2106.5,7757.7"];
			flash_attn_3_very_long_13 -> reduce_3_very_long	[pos="e,2413.5,7410.3 2249.4,7786 2335,7786 2413.5,7786 2413.5,7786 2413.5,7786 2413.5,7420.3 2413.5,7420.3"];
			q_proj_3_very_long_14	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,7678",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_14	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_14<br/>Block: 15/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,7624",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_14 -> flash_attn_3_very_long_14	[pos="e,1962.5,7642.3 1582.6,7678 1729.6,7678 1962.5,7678 1962.5,7678 1962.5,7678 1962.5,7652.3 1962.5,7652.3"];
			k_proj_3_very_long_14	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,7624",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_14 -> flash_attn_3_very_long_14	[pos="e,1818.1,7618 1582.2,7618 1582.2,7618 1808.1,7618 1808.1,7618"];
			v_proj_3_very_long_14	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_14<br/>[512→(32×16)]",
				pos="1465.5,7570",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_14 -> flash_attn_3_very_long_14	[pos="e,2106.5,7605.7 1582.3,7570 1767.2,7570 2106.5,7570 2106.5,7570 2106.5,7570 2106.5,7595.7 2106.5,7595.7"];
			flash_attn_3_very_long_14 -> reduce_3_very_long	[pos="e,2391.5,7408.9 2249.3,7624 2325,7624 2391.5,7624 2391.5,7624 2391.5,7624 2391.5,7418.9 2391.5,7418.9"];
			q_proj_3_very_long_15	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,7516",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_15	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_15<br/>Block: 16/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,7462",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_15 -> flash_attn_3_very_long_15	[pos="e,1962.5,7480.3 1582.6,7516 1729.6,7516 1962.5,7516 1962.5,7516 1962.5,7516 1962.5,7490.3 1962.5,7490.3"];
			k_proj_3_very_long_15	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,7462",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_15 -> flash_attn_3_very_long_15	[pos="e,1818.1,7456 1582.2,7456 1582.2,7456 1808.1,7456 1808.1,7456"];
			v_proj_3_very_long_15	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_15<br/>[512→(32×16)]",
				pos="1465.5,7408",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_15 -> flash_attn_3_very_long_15	[pos="e,1926.5,7443.9 1582.1,7416.2 1718.7,7416.2 1926.5,7416.2 1926.5,7416.2 1926.5,7416.2 1926.5,7433.9 1926.5,7433.9"];
			flash_attn_3_very_long_15 -> reduce_3_very_long	[pos="e,2375.9,7407.5 2034.5,7443.9 2034.5,7428 2034.5,7407.5 2034.5,7407.5 2034.5,7407.5 2365.9,7407.5 2365.9,7407.5"];
			q_proj_3_very_long_16	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,7354",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_16	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_16<br/>Block: 17/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,7354",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_16 -> flash_attn_3_very_long_16	[pos="e,1818,7348 1582.5,7348 1582.5,7348 1808,7348 1808,7348"];
			k_proj_3_very_long_16	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,7300",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_16 -> flash_attn_3_very_long_16	[pos="e,1962.5,7335.7 1582,7300 1728.9,7300 1962.5,7300 1962.5,7300 1962.5,7300 1962.5,7325.7 1962.5,7325.7"];
			v_proj_3_very_long_16	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_16<br/>[512→(32×16)]",
				pos="1465.5,7246",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_16 -> flash_attn_3_very_long_16	[pos="e,2106.5,7335.7 1582.3,7246 1767.2,7246 2106.5,7246 2106.5,7246 2106.5,7246 2106.5,7325.7 2106.5,7325.7"];
			flash_attn_3_very_long_16 -> reduce_3_very_long	[pos="e,2484.3,7398.8 2141.5,7372.2 2141.5,7384.6 2141.5,7398.8 2141.5,7398.8 2141.5,7398.8 2474.3,7398.8 2474.3,7398.8"];
			q_proj_3_very_long_17	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,7192",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_17	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_17<br/>Block: 18/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,7192",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_17 -> flash_attn_3_very_long_17	[pos="e,1818,7186 1582.5,7186 1582.5,7186 1808,7186 1808,7186"];
			k_proj_3_very_long_17	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,7138",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_17 -> flash_attn_3_very_long_17	[pos="e,1962.5,7173.7 1582,7138 1728.9,7138 1962.5,7138 1962.5,7138 1962.5,7138 1962.5,7163.7 1962.5,7163.7"];
			v_proj_3_very_long_17	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_17<br/>[512→(32×16)]",
				pos="1465.5,7084",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_17 -> flash_attn_3_very_long_17	[pos="e,2106.5,7173.7 1582.3,7084 1767.2,7084 2106.5,7084 2106.5,7084 2106.5,7084 2106.5,7163.7 2106.5,7163.7"];
			flash_attn_3_very_long_17 -> reduce_3_very_long	[pos="e,2415.5,7403.6 2249.4,7192 2335.9,7192 2415.5,7192 2415.5,7192 2415.5,7192 2415.5,7393.6 2415.5,7393.6"];
			q_proj_3_very_long_18	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,7030",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_18	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_18<br/>Block: 19/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,7030",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_18 -> flash_attn_3_very_long_18	[pos="e,1818,7024 1582.5,7024 1582.5,7024 1808,7024 1808,7024"];
			k_proj_3_very_long_18	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,6976",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_18 -> flash_attn_3_very_long_18	[pos="e,1962.5,7012 1582,6978.5 1728.9,6978.5 1962.5,6978.5 1962.5,6978.5 1962.5,6978.5 1962.5,7002 1962.5,7002"];
			v_proj_3_very_long_18	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_18<br/>[512→(32×16)]",
				pos="1465.5,6922",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_18 -> flash_attn_3_very_long_18	[pos="e,2106.5,7011.6 1582.3,6936.8 1767.2,6936.8 2106.5,6936.8 2106.5,6936.8 2106.5,6936.8 2106.5,7001.6 2106.5,7001.6"];
			flash_attn_3_very_long_18 -> reduce_3_very_long	[pos="e,2461.5,7400.1 2249.5,7030 2355.8,7030 2461.5,7030 2461.5,7030 2461.5,7030 2461.5,7390.1 2461.5,7390.1"];
			q_proj_3_very_long_19	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,6868",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_19	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_19<br/>Block: 20/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,6868",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_19 -> flash_attn_3_very_long_19	[pos="e,1818,6862 1582.5,6862 1582.5,6862 1808,6862 1808,6862"];
			k_proj_3_very_long_19	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,6814",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_19 -> flash_attn_3_very_long_19	[pos="e,1962.5,6849.8 1582,6828.8 1728.9,6828.8 1962.5,6828.8 1962.5,6828.8 1962.5,6828.8 1962.5,6839.8 1962.5,6839.8"];
			v_proj_3_very_long_19	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_19<br/>[512→(32×16)]",
				pos="1465.5,6760",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_19 -> flash_attn_3_very_long_19	[pos="e,2106.5,6849.6 1582.3,6774.8 1767.2,6774.8 2106.5,6774.8 2106.5,6774.8 2106.5,6774.8 2106.5,6839.6 2106.5,6839.6"];
			flash_attn_3_very_long_19 -> reduce_3_very_long	[pos="e,2506.5,7397 2249.4,6882.8 2374,6882.8 2506.5,6882.8 2506.5,6882.8 2506.5,6882.8 2506.5,7387 2506.5,7387"];
			q_proj_3_very_long_20	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,6706",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_20	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_20<br/>Block: 21/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,6706",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_20 -> flash_attn_3_very_long_20	[pos="e,1818,6700 1582.5,6700 1582.5,6700 1808,6700 1808,6700"];
			k_proj_3_very_long_20	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,6652",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_20 -> flash_attn_3_very_long_20	[pos="e,1962.5,6687.8 1582,6666.8 1728.9,6666.8 1962.5,6666.8 1962.5,6666.8 1962.5,6666.8 1962.5,6677.8 1962.5,6677.8"];
			v_proj_3_very_long_20	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_20<br/>[512→(32×16)]",
				pos="1465.5,6598",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_20 -> flash_attn_3_very_long_20	[pos="e,2106.5,6687.8 1582.3,6611.7 1767.2,6611.7 2106.5,6611.7 2106.5,6611.7 2106.5,6611.7 2106.5,6677.8 2106.5,6677.8"];
			flash_attn_3_very_long_20 -> reduce_3_very_long	[pos="e,2552.5,7393.6 2249.6,6720.8 2392,6720.8 2552.5,6720.8 2552.5,6720.8 2552.5,6720.8 2552.5,7383.6 2552.5,7383.6"];
			q_proj_3_very_long_21	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,6544",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_21	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_21<br/>Block: 22/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,6544",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_21 -> flash_attn_3_very_long_21	[pos="e,1818,6538 1582.5,6538 1582.5,6538 1808,6538 1808,6538"];
			k_proj_3_very_long_21	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,6490",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_21 -> flash_attn_3_very_long_21	[pos="e,1962.5,6526 1582,6500.3 1728.9,6500.3 1962.5,6500.3 1962.5,6500.3 1962.5,6500.3 1962.5,6516 1962.5,6516"];
			v_proj_3_very_long_21	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_21<br/>[512→(32×16)]",
				pos="1465.5,6436",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_21 -> flash_attn_3_very_long_21	[pos="e,2106.5,6525.6 1582.3,6446.3 1767.2,6446.3 2106.5,6446.3 2106.5,6446.3 2106.5,6446.3 2106.5,6515.6 2106.5,6515.6"];
			flash_attn_3_very_long_21 -> reduce_3_very_long	[pos="e,2598.5,7390.4 2249.3,6557.7 2408.8,6557.7 2598.5,6557.7 2598.5,6557.7 2598.5,6557.7 2598.5,7380.4 2598.5,7380.4"];
			q_proj_3_very_long_22	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,6382",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_22	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_22<br/>Block: 23/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,6382",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_22 -> flash_attn_3_very_long_22	[pos="e,1818,6376 1582.5,6376 1582.5,6376 1808,6376 1808,6376"];
			k_proj_3_very_long_22	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,6328",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_22 -> flash_attn_3_very_long_22	[pos="e,1962.5,6364 1582,6338.3 1728.9,6338.3 1962.5,6338.3 1962.5,6338.3 1962.5,6338.3 1962.5,6354 1962.5,6354"];
			v_proj_3_very_long_22	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_22<br/>[512→(32×16)]",
				pos="1465.5,6274",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_22 -> flash_attn_3_very_long_22	[pos="e,2106.5,6363.6 1582.3,6284.3 1767.2,6284.3 2106.5,6284.3 2106.5,6284.3 2106.5,6284.3 2106.5,6353.6 2106.5,6353.6"];
			flash_attn_3_very_long_22 -> reduce_3_very_long	[pos="e,2643.5,7390.2 2249.6,6392.3 2425,6392.3 2643.5,6392.3 2643.5,6392.3 2643.5,6392.3 2643.5,7380.2 2643.5,7380.2"];
			q_proj_3_very_long_23	[height=0.5,
				label="<b>Q Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,6220",
				shape=rectangle,
				width=3.25];
			flash_attn_3_very_long_23	[height=0.5,
				label="<b>Flash Attention</b><br/>pool_gpu_23<br/>Block: 24/24<br/>[batch=1024, seq=ceil(seq/24), 4096]",
				pos="2033.7,6220",
				shape=rectangle,
				width=5.9861];
			q_proj_3_very_long_23 -> flash_attn_3_very_long_23	[pos="e,1818,6214 1582.5,6214 1582.5,6214 1808,6214 1808,6214"];
			k_proj_3_very_long_23	[height=0.5,
				label="<b>K Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,6166",
				shape=rectangle,
				width=3.2361];
			k_proj_3_very_long_23 -> flash_attn_3_very_long_23	[pos="e,1821.5,6202 1582,6176.3 1685.9,6176.3 1821.5,6176.3 1821.5,6176.3 1821.5,6176.3 1821.5,6192 1821.5,6192"];
			v_proj_3_very_long_23	[height=0.5,
				label="<b>V Proj</b><br/>pool_gpu_23<br/>[512→(32×16)]",
				pos="1465.5,6112",
				shape=rectangle,
				width=3.2361];
			v_proj_3_very_long_23 -> flash_attn_3_very_long_23	[pos="e,1825.5,6201.6 1582.4,6122.3 1687.5,6122.3 1825.5,6122.3 1825.5,6122.3 1825.5,6122.3 1825.5,6191.6 1825.5,6191.6"];
			flash_attn_3_very_long_23 -> reduce_3_very_long	[pos="e,2689.5,7393.8 2249.4,6230.3 2440.5,6230.3 2689.5,6230.3 2689.5,6230.3 2689.5,6230.3 2689.5,7383.8 2689.5,7383.8"];
		}
	}
	input	[fillcolor=lightblue,
		height=0.5,
		label="<b>Model Input</b><br/>[batch=1024, seq_len=?, vocab=32000]",
		pos="162.24,24936",
		shape=ellipse,
		width=4.5065];
	seq_analyzer	[height=1.3155,
		label="<b>Sequence Length Analyzer</b><br/>Analyzes seq_len<br/>Determines GPU allocation<br/>
             < 4096: Base only<br/>
             \
4096-8192: +8 pool GPUs<br/>
             8192-16384: +16 pool GPUs<br/>
             >16384: +24 pool GPUs",
		pos="694.6,24936",
		width=9.2536];
	input -> seq_analyzer	[pos="e,361.15,24936 324.49,24936 324.49,24936 351.15,24936 351.15,24936"];
	seq_analyzer -> q_proj_0_short_0	[label="< 4096",
		lp="1088.7,15622",
		pos="e,1349.9,3116 584.49,24888 584.49,23764 584.49,3116 584.49,3116 584.49,3116 1339.9,3116 1339.9,3116"];
	seq_analyzer -> q_proj_0_medium_0	[label="4096-8192",
		lp="1088.7,39112",
		pos="e,1350.8,42337 584.49,24983 584.49,25978 584.49,42337 584.49,42337 584.49,42337 1340.8,42337 1340.8,42337"];
	seq_analyzer -> q_proj_0_long_0	[label="8192-16384",
		lp="1088.7,32610",
		pos="e,1350.7,37017 806.49,24983 806.49,25805 806.49,37017 806.49,37017 806.49,37017 1340.7,37017 1340.7,37017"];
	seq_analyzer -> q_proj_0_very_long_0	[label="> 16384",
		lp="1088.7,24924",
		pos="e,1350.7,21685 806.49,24888 806.49,24488 806.49,21685 806.49,21685 806.49,21685 1340.7,21685 1340.7,21685"];
	output_agg	[fillcolor=lightblue,
		height=0.5,
		label="<b>Output Aggregation</b><br/>Final result from base GPUs<br/>[batch=1024, seq=?, vocab=32000]",
		pos="3853.2,5384",
		shape=ellipse,
		width=6.8961];
	base_ffn_down_l3_0 -> output_agg	[pos="e,3729.5,5368.2 3562,5304 3640.7,5304 3729.5,5304 3729.5,5304 3729.5,5304 3729.5,5358.2 3729.5,5358.2"];
	base_ffn_down_l3_1 -> output_agg	[pos="e,3681.4,5371 3562.2,5371 3562.2,5371 3671.4,5371 3671.4,5371"];
	base_ffn_down_l3_2 -> output_agg	[pos="e,3853.5,5365.9 3562,5250 3683.2,5250 3853.5,5250 3853.5,5250 3853.5,5250 3853.5,5355.9 3853.5,5355.9"];
	base_ffn_down_l3_3 -> output_agg	[pos="e,3977.5,5399.9 3562.3,5574 3719.8,5574 3977.5,5574 3977.5,5574 3977.5,5574 3977.5,5409.9 3977.5,5409.9"];
	base_ffn_down_l3_4 -> output_agg	[pos="e,3853.5,5402.1 3562,5520 3683.2,5520 3853.5,5520 3853.5,5520 3853.5,5520 3853.5,5412.1 3853.5,5412.1"];
	base_ffn_down_l3_5 -> output_agg	[pos="e,3697,5398 3562.2,5398 3562.2,5398 3687,5398 3687,5398"];
	base_ffn_down_l3_6 -> output_agg	[pos="e,3729.5,5399.8 3562,5466 3640.7,5466 3729.5,5466 3729.5,5466 3729.5,5466 3729.5,5409.8 3729.5,5409.8"];
	base_ffn_down_l3_7 -> output_agg	[pos="e,3977.5,5368.3 3562.3,5196 3719.8,5196 3977.5,5196 3977.5,5196 3977.5,5196 3977.5,5358.3 3977.5,5358.3"];
	flash_attn_0_short_0 -> base_ffn_up_l0_0	[pos="e,3026.4,6663.5 2240,3116 2252.7,3116 2260.5,3116 2260.5,3116 2260.5,3116 2260.5,6663.5 2260.5,6663.5 2260.5,6663.5 3016.4,6663.5 \
3016.4,6663.5"];
	flash_attn_0_short_1 -> base_ffn_up_l0_1	[pos="e,3026.1,6717.5 2240.1,3278 2251.5,3278 2258.5,3278 2258.5,3278 2258.5,3278 2258.5,6717.5 2258.5,6717.5 2258.5,6717.5 3016.1,6717.5 \
3016.1,6717.5"];
	flash_attn_0_short_2 -> base_ffn_up_l0_2	[pos="e,3026.2,6622 2240.1,2954 2253.9,2954 2262.5,2954 2262.5,2954 2262.5,2954 2262.5,6622 2262.5,6622 2262.5,6622 3016.2,6622 3016.2,\
6622"];
	flash_attn_0_short_3 -> base_ffn_up_l0_3	[pos="e,3026.1,6933.5 2239.8,3926 2247.2,3926 2251.5,3926 2251.5,3926 2251.5,3926 2251.5,6933.5 2251.5,6933.5 2251.5,6933.5 3016.1,6933.5 \
3016.1,6933.5"];
	flash_attn_0_short_4 -> base_ffn_up_l0_4	[pos="e,3026.4,6879.5 2239.7,3764 2248.4,3764 2253.5,3764 2253.5,3764 2253.5,3764 2253.5,6879.5 2253.5,6879.5 2253.5,6879.5 3016.4,6879.5 \
3016.4,6879.5"];
	flash_attn_0_short_5 -> base_ffn_up_l0_5	[pos="e,3026.4,6771.5 2239.9,3440 2250.9,3440 2257.5,3440 2257.5,3440 2257.5,3440 2257.5,6771.5 2257.5,6771.5 2257.5,6771.5 3016.4,6771.5 \
3016.4,6771.5"];
	flash_attn_0_short_6 -> base_ffn_up_l0_6	[pos="e,3026.2,6825.5 2239.9,3602 2249.7,3602 2255.5,3602 2255.5,3602 2255.5,3602 2255.5,6825.5 2255.5,6825.5 2255.5,6825.5 3016.2,6825.5 \
3016.2,6825.5"];
	flash_attn_0_short_7 -> base_ffn_up_l0_7	[pos="e,3026.4,6568 2239.8,2792 2255,2792 2264.5,2792 2264.5,2792 2264.5,2792 2264.5,6568 2264.5,6568 2264.5,6568 3016.4,6568 3016.4,6568"];
	flash_attn_1_short_0 -> base_ffn_up_l1_0	[pos="e,3026.1,6213.3 2239.8,1795 2261.3,1795 2275.5,1795 2275.5,1795 2275.5,1795 2275.5,6213.3 2275.5,6213.3 2275.5,6213.3 3016.1,6213.3 \
3016.1,6213.3"];
	flash_attn_1_short_1 -> base_ffn_up_l1_1	[pos="e,3026.3,6267.3 2239.9,1957 2260.2,1957 2273.5,1957 2273.5,1957 2273.5,1957 2273.5,6267.3 2273.5,6267.3 2273.5,6267.3 3016.3,6267.3 \
3016.3,6267.3"];
	flash_attn_1_short_2 -> base_ffn_up_l1_2	[pos="e,3026.2,6159.3 2240.2,1633 2241,1633 2241.5,1633 2241.5,1633 2241.5,1633 2241.5,6159.3 2241.5,6159.3 2241.5,6159.3 3016.2,6159.3 \
3016.2,6159.3"];
	flash_attn_1_short_3 -> base_ffn_up_l1_3	[pos="e,3026.2,6483.3 2239.8,2605 2256.1,2605 2266.5,2605 2266.5,2605 2266.5,2605 2266.5,6483.3 2266.5,6483.3 2266.5,6483.3 3016.2,6483.3 \
3016.2,6483.3"];
	flash_attn_1_short_4 -> base_ffn_up_l1_4	[pos="e,3026,6429.3 2240.2,2443 2257.5,2443 2268.5,2443 2268.5,2443 2268.5,2443 2268.5,6429.3 2268.5,6429.3 2268.5,6429.3 3016,6429.3 \
3016,6429.3"];
	flash_attn_1_short_5 -> base_ffn_up_l1_5	[pos="e,3026.4,6321.3 2239.9,2119 2259.1,2119 2271.5,2119 2271.5,2119 2271.5,2119 2271.5,6321.3 2271.5,6321.3 2271.5,6321.3 3016.4,6321.3 \
3016.4,6321.3"];
	flash_attn_1_short_6 -> base_ffn_up_l1_6	[pos="e,3026.3,6375.3 2240,2281 2258.5,2281 2270.5,2281 2270.5,2281 2270.5,2281 2270.5,6375.3 2270.5,6375.3 2270.5,6375.3 3016.3,6375.3 \
3016.3,6375.3"];
	flash_attn_1_short_7 -> base_ffn_up_l1_7	[pos="e,3026.3,6105.3 2239.8,1471 2241.6,1471 2242.5,1471 2242.5,1471 2242.5,1471 2242.5,6105.3 2242.5,6105.3 2242.5,6105.3 3016.3,6105.3 \
3016.3,6105.3"];
	flash_attn_2_short_0 -> base_ffn_up_l2_0	[pos="e,3026.4,5749 2239.9,474 2511.9,474 2956.5,474 2956.5,474 2956.5,474 2956.5,5749 2956.5,5749 2956.5,5749 3016.4,5749 3016.4,5749"];
	flash_attn_2_short_1 -> base_ffn_up_l2_1	[pos="e,3026.4,5809 2239.7,636 2264.6,636 2281.5,636 2281.5,636 2281.5,636 2281.5,5809 2281.5,5809 2281.5,5809 3016.4,5809 3016.4,5809"];
	flash_attn_2_short_2 -> base_ffn_up_l2_2	[pos="e,3026.3,5695 2239.9,312 2512.1,312 2957.5,312 2957.5,312 2957.5,312 2957.5,5695 2957.5,5695 2957.5,5695 3016.3,5695 3016.3,5695"];
	flash_attn_2_short_3 -> base_ffn_up_l2_3	[pos="e,3026.4,6025 2239.8,1284 2242.2,1284 2243.5,1284 2243.5,1284 2243.5,1284 2243.5,6025 2243.5,6025 2243.5,6025 3016.4,6025 3016.4,\
6025"];
	flash_attn_2_short_4 -> base_ffn_up_l2_4	[pos="e,3026.1,5971 2240.1,1122 2242.9,1122 2244.5,1122 2244.5,1122 2244.5,1122 2244.5,5971 2244.5,5971 2244.5,5971 3016.1,5971 3016.1,\
5971"];
	flash_attn_2_short_5 -> base_ffn_up_l2_5	[pos="e,3026.2,5863 2239.7,798 2263.5,798 2279.5,798 2279.5,798 2279.5,798 2279.5,5863 2279.5,5863 2279.5,5863 3016.2,5863 3016.2,5863"];
	flash_attn_2_short_6 -> base_ffn_up_l2_6	[pos="e,3026.3,5917 2239.9,960 2262.5,960 2277.5,960 2277.5,960 2277.5,960 2277.5,5917 2277.5,5917 2277.5,5917 3016.3,5917 3016.3,5917"];
	flash_attn_2_short_7 -> base_ffn_up_l2_7	[pos="e,3026.4,5641 2239.8,150 2512.3,150 2958.5,150 2958.5,150 2958.5,150 2958.5,5641 2958.5,5641 2958.5,5641 3016.4,5641 3016.4,5641"];
	flash_attn_3_short_0 -> base_ffn_up_l3_0	[pos="e,3026.2,5292 2239.8,4383 2245.3,4383 2248.5,4383 2248.5,4383 2248.5,4383 2248.5,5292 2248.5,5292 2248.5,5292 3016.2,5292 3016.2,\
5292"];
	flash_attn_3_short_1 -> base_ffn_up_l3_1	[pos="e,3026,5346 2239.9,4545 2244.7,4545 2247.5,4545 2247.5,4545 2247.5,4545 2247.5,5346 2247.5,5346 2247.5,5346 3016,5346 3016,5346"];
	flash_attn_3_short_2 -> base_ffn_up_l3_2	[pos="e,3026.2,5236.7 2240,4221 2265.9,4221 2283.5,4221 2283.5,4221 2283.5,4221 2283.5,5236.7 2283.5,5236.7 2283.5,5236.7 3016.2,5236.7 \
3016.2,5236.7"];
	flash_attn_3_short_3 -> base_ffn_up_l3_3	[pos="e,3026,5568 2102.5,5211.1 2102.5,5286 2102.5,5568 2102.5,5568 2102.5,5568 3016,5568 3016,5568"];
	flash_attn_3_short_4 -> base_ffn_up_l3_4	[pos="e,3026.2,5514 2239.8,5032.5 2243.5,5032.5 2245.5,5032.5 2245.5,5032.5 2245.5,5032.5 2245.5,5514 2245.5,5514 2245.5,5514 3016.2,5514 \
3016.2,5514"];
	flash_attn_3_short_5 -> base_ffn_up_l3_5	[pos="e,3026.4,5400.4 2239.9,4707 2244.1,4707 2246.5,4707 2246.5,4707 2246.5,4707 2246.5,5400.4 2246.5,5400.4 2246.5,5400.4 3016.4,5400.4 \
3016.4,5400.4"];
	flash_attn_3_short_6 -> base_ffn_up_l3_6	[pos="e,3026.2,5452.7 2239.8,4870.5 2521.3,4870.5 2991.5,4870.5 2991.5,4870.5 2991.5,4870.5 2991.5,5452.7 2991.5,5452.7 2991.5,5452.7 \
3016.2,5452.7 3016.2,5452.7"];
	flash_attn_3_short_7 -> base_ffn_up_l3_7	[pos="e,3026.4,5183.5 2239.9,4083 2266.4,4083 2284.5,4083 2284.5,4083 2284.5,4083 2284.5,5183.5 2284.5,5183.5 2284.5,5183.5 3016.4,5183.5 \
3016.4,5183.5"];
	reduce_0_medium -> base_ffn_up_l0_0	[pos="e,3252.5,6666 2840.5,41097 3028,41097 3267.5,41097 3267.5,41097 3267.5,41097 3267.5,6666 3267.5,6666 3267.5,6666 3262.5,6666 3262.5,\
6666"];
	reduce_0_medium -> base_ffn_up_l0_1	[pos="e,3252.5,6720 2840.5,41093 3026.7,41093 3263.5,41093 3263.5,41093 3263.5,41093 3263.5,6720 3263.5,6720 3263.5,6720 3262.4,6720 3262.4,\
6720"];
	reduce_0_medium -> base_ffn_up_l0_2	[pos="e,3252.5,6612 2785.9,41101 2978.4,41101 3270.5,41101 3270.5,41101 3270.5,41101 3270.5,6612 3270.5,6612 3270.5,6612 3262.5,6612 3262.5,\
6612"];
	reduce_0_medium -> base_ffn_up_l0_3	[pos="e,3196.5,6963.3 2675.6,41081 2819.5,41081 3196.5,41081 3196.5,41081 3196.5,41081 3196.5,6973.3 3196.5,6973.3"];
	reduce_0_medium -> base_ffn_up_l0_4	[pos="e,3252.5,6900 2675.8,41109 2838.6,41109 3305.5,41109 3305.5,41109 3305.5,41109 3305.5,6900 3305.5,6900 3305.5,6900 3262.5,6900 3262.5,\
6900"];
	reduce_0_medium -> base_ffn_up_l0_5	[pos="e,3252.5,6774 2785.8,41089 2975.4,41089 3260.5,41089 3260.5,41089 3260.5,41089 3260.5,6774 3260.5,6774 3260.5,6774 3259.7,6774 3259.7,\
6774"];
	reduce_0_medium -> base_ffn_up_l0_6	[pos="e,3252.7,6828 2730.8,41085 2913.1,41085 3257.5,41085 3257.5,41085 3257.5,41085 3257.5,6828 3257.5,6828 3257.5,6828 3257,6828 3257,\
6828"];
	reduce_0_medium -> base_ffn_up_l0_7	[pos="e,3252.5,6558 2730.6,41105 2916.7,41105 3273.5,41105 3273.5,41105 3273.5,41105 3273.5,6558 3273.5,6558 3273.5,6558 3262.5,6558 3262.5,\
6558"];
	reduce_1_medium -> base_ffn_up_l1_0	[pos="e,3252.5,6212 2785.5,39780 2981.5,39780 3282.5,39780 3282.5,39780 3282.5,39780 3282.5,6212 3282.5,6212 3282.5,6212 3262.5,6212 3262.5,\
6212"];
	reduce_1_medium -> base_ffn_up_l1_1	[pos="e,3252.7,6266 2840.7,39776 3032.9,39776 3281.5,39776 3281.5,39776 3281.5,39776 3281.5,6266 3281.5,6266 3281.5,6266 3262.7,6266 3262.7,\
6266"];
	reduce_1_medium -> base_ffn_up_l1_2	[pos="e,3252.7,6158 2730.6,39784 2919.3,39784 3284.5,39784 3284.5,39784 3284.5,39784 3284.5,6158 3284.5,6158 3284.5,6158 3262.7,6158 3262.7,\
6158"];
	reduce_1_medium -> base_ffn_up_l1_3	[pos="e,3252.5,6482 2675.8,39760 2833.4,39760 3274.5,39760 3274.5,39760 3274.5,39760 3274.5,6482 3274.5,6482 3274.5,6482 3262.5,6482 3262.5,\
6482"];
	reduce_1_medium -> base_ffn_up_l1_4	[pos="e,3252.6,6428 2730.7,39764 2917.6,39764 3276.5,39764 3276.5,39764 3276.5,39764 3276.5,6428 3276.5,6428 3276.5,6428 3262.6,6428 3262.6,\
6428"];
	reduce_1_medium -> base_ffn_up_l1_5	[pos="e,3252.5,6320 2840.5,39772 3032.1,39772 3279.5,39772 3279.5,39772 3279.5,39772 3279.5,6320 3279.5,6320 3279.5,6320 3262.5,6320 3262.5,\
6320"];
	reduce_1_medium -> base_ffn_up_l1_6	[pos="e,3252.7,6374 2785.8,39768 2980.6,39768 3278.5,39768 3278.5,39768 3278.5,39768 3278.5,6374 3278.5,6374 3278.5,6374 3262.7,6374 3262.7,\
6374"];
	reduce_1_medium -> base_ffn_up_l1_7	[pos="e,3252.7,6104 2675.6,39788 2834.9,39788 3285.5,39788 3285.5,39788 3285.5,39788 3285.5,6104 3285.5,6104 3285.5,6104 3262.7,6104 3262.7,\
6104"];
	reduce_2_medium -> base_ffn_up_l2_0	[pos="e,3026.4,5773 2785.6,38447 2890.5,38447 3006.5,38447 3006.5,38447 3006.5,38447 3006.5,5773 3006.5,5773 3006.5,5773 3016.4,5773 3016.4,\
5773"];
	reduce_2_medium -> base_ffn_up_l2_1	[pos="e,3026.2,5827 2840.6,38451 2928.6,38451 3009.5,38451 3009.5,38451 3009.5,38451 3009.5,5827 3009.5,5827 3009.5,5827 3016.2,5827 3016.2,\
5827"];
	reduce_2_medium -> base_ffn_up_l2_2	[pos="e,3026.2,5719 2730.6,38443 2843.7,38443 3003.5,38443 3003.5,38443 3003.5,38443 3003.5,5719 3003.5,5719 3003.5,5719 3016.2,5719 3016.2,\
5719"];
	reduce_2_medium -> base_ffn_up_l2_3	[pos="e,3026.3,6043 2675.9,38467 2785.9,38467 3021.5,38467 3021.5,38467 3021.5,38467 3021.5,6043 3021.5,6043 3021.5,6043 3022,6043 3022,\
6043"];
	reduce_2_medium -> base_ffn_up_l2_4	[pos="e,3026.4,5989 2730.6,38463 2848.4,38463 3018.5,38463 3018.5,38463 3018.5,38463 3018.5,5989 3018.5,5989 3018.5,5989 3019.3,5989 3019.3,\
5989"];
	reduce_2_medium -> base_ffn_up_l2_5	[pos="e,3026.1,5881 2840.6,38455 2929.9,38455 3012.5,38455 3012.5,38455 3012.5,38455 3012.5,5881 3012.5,5881 3012.5,5881 3016.1,5881 3016.1,\
5881"];
	reduce_2_medium -> base_ffn_up_l2_6	[pos="e,3026.1,5935 2785.5,38459 2893.8,38459 3015.5,38459 3015.5,38459 3015.5,38459 3015.5,5935 3015.5,5935 3015.5,5935 3016.5,5935 3016.5,\
5935"];
	reduce_2_medium -> base_ffn_up_l2_7	[pos="e,3026.2,5665 2675.6,38439 2781.1,38439 3001.5,38439 3001.5,38439 3001.5,38439 3001.5,5665 3001.5,5665 3001.5,5665 3016.2,5665 3016.2,\
5665"];
	reduce_3_medium -> base_ffn_up_l3_0	[pos="e,3026.2,5316 2785.7,37126 2875.1,37126 2967.5,37126 2967.5,37126 2967.5,37126 2967.5,5316 2967.5,5316 2967.5,5316 3016.2,5316 3016.2,\
5316"];
	reduce_3_medium -> base_ffn_up_l3_1	[pos="e,3026.3,5370 2840.7,37130 2910.8,37130 2970.5,37130 2970.5,37130 2970.5,37130 2970.5,5370 2970.5,5370 2970.5,5370 3016.3,5370 3016.3,\
5370"];
	reduce_3_medium -> base_ffn_up_l3_2	[pos="e,3026.2,5260.3 2730.8,37122 2831.4,37122 2964.5,37122 2964.5,37122 2964.5,37122 2964.5,5260.3 2964.5,5260.3 2964.5,5260.3 3016.2,\
5260.3 3016.2,5260.3"];
	reduce_3_medium -> base_ffn_up_l3_3	[pos="e,3026.3,5586 2675.9,37146 2780.9,37146 2998.5,37146 2998.5,37146 2998.5,37146 2998.5,5586 2998.5,5586 2998.5,5586 3016.3,5586 3016.3,\
5586"];
	reduce_3_medium -> base_ffn_up_l3_4	[pos="e,3026.5,5532 2730.6,37142 2841.5,37142 2996.5,37142 2996.5,37142 2996.5,37142 2996.5,5532 2996.5,5532 2996.5,5532 3016.5,5532 3016.5,\
5532"];
	reduce_3_medium -> base_ffn_up_l3_5	[pos="e,3026.2,5419.6 2840.5,37134 2921.3,37134 2993.5,37134 2993.5,37134 2993.5,37134 2993.5,5419.6 2993.5,5419.6 2993.5,5419.6 3016.2,\
5419.6 3016.2,5419.6"];
	reduce_3_medium -> base_ffn_up_l3_6	[pos="e,3026.4,5478.5 2785.6,37138 2886.2,37138 2995.5,37138 2995.5,37138 2995.5,37138 2995.5,5478.5 2995.5,5478.5 2995.5,5478.5 3016.4,\
5478.5 3016.4,5478.5"];
	reduce_3_medium -> base_ffn_up_l3_7	[pos="e,3026.2,5205.5 2675.7,37118 2772.2,37118 2961.5,37118 2961.5,37118 2961.5,37118 2961.5,5205.5 2961.5,5205.5 2961.5,5205.5 3016.2,\
5205.5 3016.2,5205.5"];
	reduce_0_long -> base_ffn_up_l0_0	[pos="e,3252.5,6675 2788.3,35078 2979.4,35078 3265.5,35078 3265.5,35078 3265.5,35078 3265.5,6675 3265.5,6675 3265.5,6675 3262.5,6675 3262.5,\
6675"];
	reduce_0_long -> base_ffn_up_l0_1	[pos="e,3252.8,6729 2844.2,35074 3029.4,35074 3262.5,35074 3262.5,35074 3262.5,35074 3262.5,6729 3262.5,6729 3262.5,6729 3261.5,6729 3261.5,\
6729"];
	reduce_0_long -> base_ffn_up_l0_2	[pos="e,3252.7,6621 2732.7,35082 2918.1,35082 3268.5,35082 3268.5,35082 3268.5,35082 3268.5,6621 3268.5,6621 3268.5,6621 3262.7,6621 3262.7,\
6621"];
	reduce_0_long -> base_ffn_up_l0_3	[pos="e,3139.5,6963.2 2676.6,35058 2810.8,35058 3139.5,35058 3139.5,35058 3139.5,35058 3139.5,6973.2 3139.5,6973.2"];
	reduce_0_long -> base_ffn_up_l0_4	[pos="e,3252.5,6882 2732.5,35062 2914.4,35062 3254.5,35062 3254.5,35062 3254.5,35062 3254.5,6882 3254.5,6882 3254.5,6882 3254.3,6882 3254.3,\
6882"];
	reduce_0_long -> base_ffn_up_l0_5	[pos="e,3252.7,6783 2844.5,35070 3028.7,35070 3259.5,35070 3259.5,35070 3259.5,35070 3259.5,6783 3259.5,6783 3259.5,6783 3258.8,6783 3258.8,\
6783"];
	reduce_0_long -> base_ffn_up_l0_6	[pos="e,3252.6,6837 2788.5,35066 2976.9,35066 3256.5,35066 3256.5,35066 3256.5,35066 3256.5,6837 3256.5,6837 3256.5,6837 3256.1,6837 3256.1,\
6837"];
	reduce_0_long -> base_ffn_up_l0_7	[pos="e,3252.6,6567 2676.7,35086 2834.5,35086 3271.5,35086 3271.5,35086 3271.5,35086 3271.5,6567 3271.5,6567 3271.5,6567 3262.6,6567 3262.6,\
6567"];
	reduce_1_long -> base_ffn_up_l1_0	[pos="e,3026.3,6219 2676.6,32441 2751.4,32441 2874.5,32441 2874.5,32441 2874.5,32441 2874.5,6219 2874.5,6219 2874.5,6219 3016.3,6219 3016.3,\
6219"];
	reduce_1_long -> base_ffn_up_l1_1	[pos="e,3026.4,6273 2732.5,32445 2801.3,32445 2876.5,32445 2876.5,32445 2876.5,32445 2876.5,6273 2876.5,6273 2876.5,6273 3016.4,6273 3016.4,\
6273"];
	reduce_1_long -> base_ffn_up_l1_2	[pos="e,3026.1,6170.7 2676.8,32469 2787.7,32469 3024.5,32469 3024.5,32469 3024.5,32469 3024.5,6170.7 3024.5,6170.7 3024.5,6170.7 3024.6,\
6170.7 3024.6,6170.7"];
	reduce_1_long -> base_ffn_up_l1_3	[pos="e,3026.2,6489 2788.4,32461 2840.9,32461 2885.5,32461 2885.5,32461 2885.5,32461 2885.5,6489 2885.5,6489 2885.5,6489 3016.2,6489 3016.2,\
6489"];
	reduce_1_long -> base_ffn_up_l1_4	[pos="e,3026.4,6435 2844.1,32457 2867.8,32457 2883.5,32457 2883.5,32457 2883.5,32457 2883.5,6435 2883.5,6435 2883.5,6435 3016.4,6435 3016.4,\
6435"];
	reduce_1_long -> base_ffn_up_l1_5	[pos="e,3026.1,6327 2788.3,32449 2837.5,32449 2878.5,32449 2878.5,32449 2878.5,32449 2878.5,6327 2878.5,6327 2878.5,6327 3016.1,6327 3016.1,\
6327"];
	reduce_1_long -> base_ffn_up_l1_6	[pos="e,3026.3,6381 2844.4,32453 2866.8,32453 2881.5,32453 2881.5,32453 2881.5,32453 2881.5,6381 2881.5,6381 2881.5,6381 3016.3,6381 3016.3,\
6381"];
	reduce_1_long -> base_ffn_up_l1_7	[pos="e,3026.4,6116.7 2732.5,32465 2851.5,32465 3022.5,32465 3022.5,32465 3022.5,32465 3022.5,6116.7 3022.5,6116.7 3022.5,6116.7 3022.9,\
6116.7 3022.9,6116.7"];
	reduce_2_long -> base_ffn_up_l2_0	[pos="e,3026.4,5767 2788.3,29832 2892,29832 3005.5,29832 3005.5,29832 3005.5,29832 3005.5,5767 3005.5,5767 3005.5,5767 3016.4,5767 3016.4,\
5767"];
	reduce_2_long -> base_ffn_up_l2_1	[pos="e,3026.4,5821 2844.3,29836 2930.4,29836 3008.5,29836 3008.5,29836 3008.5,29836 3008.5,5821 3008.5,5821 3008.5,5821 3016.4,5821 3016.4,\
5821"];
	reduce_2_long -> base_ffn_up_l2_2	[pos="e,3026.3,5713 2732.6,29828 2845.3,29828 3002.5,29828 3002.5,29828 3002.5,29828 3002.5,5713 3002.5,5713 3002.5,5713 3016.3,5713 3016.3,\
5713"];
	reduce_2_long -> base_ffn_up_l2_3	[pos="e,3026.3,6037 2676.5,29852 2786.3,29852 3019.5,29852 3019.5,29852 3019.5,29852 3019.5,6037 3019.5,6037 3019.5,6037 3020.2,6037 3020.2,\
6037"];
	reduce_2_long -> base_ffn_up_l2_4	[pos="e,3026.1,5983 2732.5,29848 2849.5,29848 3016.5,29848 3016.5,29848 3016.5,29848 3016.5,5983 3016.5,5983 3016.5,5983 3017.5,5983 3017.5,\
5983"];
	reduce_2_long -> base_ffn_up_l2_5	[pos="e,3026.4,5875 2844.3,29840 2931.7,29840 3011.5,29840 3011.5,29840 3011.5,29840 3011.5,5875 3011.5,5875 3011.5,5875 3016.4,5875 3016.4,\
5875"];
	reduce_2_long -> base_ffn_up_l2_6	[pos="e,3026,5929 2788.5,29844 2895.6,29844 3014.5,29844 3014.5,29844 3014.5,29844 3014.5,5929 3014.5,5929 3014.5,5929 3016,5929 3016,\
5929"];
	reduce_2_long -> base_ffn_up_l2_7	[pos="e,3026.1,5659 2676.5,29824 2781.9,29824 2999.5,29824 2999.5,29824 2999.5,29824 2999.5,5659 2999.5,5659 2999.5,5659 3016.1,5659 3016.1,\
5659"];
	reduce_3_long -> base_ffn_up_l3_0	[pos="e,3026,5310 2788.5,27215 2876.6,27215 2966.5,27215 2966.5,27215 2966.5,27215 2966.5,5310 2966.5,5310 2966.5,5310 3016,5310 3016,\
5310"];
	reduce_3_long -> base_ffn_up_l3_1	[pos="e,3026.1,5364 2844.5,27219 2912.5,27219 2969.5,27219 2969.5,27219 2969.5,27219 2969.5,5364 2969.5,5364 2969.5,5364 3016.1,5364 3016.1,\
5364"];
	reduce_3_long -> base_ffn_up_l3_2	[pos="e,3026,5255.6 2732.4,27211 2832.5,27211 2963.5,27211 2963.5,27211 2963.5,27211 2963.5,5255.6 2963.5,5255.6 2963.5,5255.6 3016,5255.6 \
3016,5255.6"];
	reduce_3_long -> base_ffn_up_l3_3	[pos="e,3026.2,5580 2676.7,27235 2776.5,27235 2974.5,27235 2974.5,27235 2974.5,27235 2974.5,5580 2974.5,5580 2974.5,5580 3016.2,5580 3016.2,\
5580"];
	reduce_3_long -> base_ffn_up_l3_4	[pos="e,3026.5,5526 2732.7,27231 2836.1,27231 2973.5,27231 2973.5,27231 2973.5,27231 2973.5,5526 2973.5,5526 2973.5,5526 3016.5,5526 3016.5,\
5526"];
	reduce_3_long -> base_ffn_up_l3_5	[pos="e,3026.2,5413.2 2844.4,27223 2913.9,27223 2972.5,27223 2972.5,27223 2972.5,27223 2972.5,5413.2 2972.5,5413.2 2972.5,5413.2 3016.2,\
5413.2 3016.2,5413.2"];
	reduce_3_long -> base_ffn_up_l3_6	[pos="e,3026.5,5473 2788.3,27227 2879.3,27227 2973.5,27227 2973.5,27227 2973.5,27227 2973.5,5473 2973.5,5473 2973.5,5473 3016.5,5473 3016.5,\
5473"];
	reduce_3_long -> base_ffn_up_l3_7	[pos="e,3026.4,5200 2676.7,27207 2773.3,27207 2960.5,27207 2960.5,27207 2960.5,27207 2960.5,5200 2960.5,5200 2960.5,5200 3016.4,5200 3016.4,\
5200"];
	reduce_0_very_long -> base_ffn_up_l0_0	[pos="e,3026.2,6679 2732.7,19136 2806.5,19136 2889.5,19136 2889.5,19136 2889.5,19136 2889.5,6679 2889.5,6679 2889.5,6679 3016.2,6679 3016.2,\
6679"];
	reduce_0_very_long -> base_ffn_up_l0_1	[pos="e,3026.4,6733 2788.3,19140 2843.7,19140 2891.5,19140 2891.5,19140 2891.5,19140 2891.5,6733 2891.5,6733 2891.5,6733 3016.4,6733 3016.4,\
6733"];
	reduce_0_very_long -> base_ffn_up_l0_2	[pos="e,3026.4,6628 2676.5,19132 2754.8,19132 2887.5,19132 2887.5,19132 2887.5,19132 2887.5,6628 2887.5,6628 2887.5,6628 3016.4,6628 3016.4,\
6628"];
	reduce_0_very_long -> base_ffn_up_l0_3	[pos="e,3083.5,6963.2 2676.9,19160 2800.3,19160 3083.5,19160 3083.5,19160 3083.5,19160 3083.5,6973.2 3083.5,6973.2"];
	reduce_0_very_long -> base_ffn_up_l0_4	[pos="e,3026.4,6895 2788.3,19152 2846.9,19152 2898.5,19152 2898.5,19152 2898.5,19152 2898.5,6895 2898.5,6895 2898.5,6895 3016.4,6895 3016.4,\
6895"];
	reduce_0_very_long -> base_ffn_up_l0_5	[pos="e,3026.2,6787 2844.4,19144 2873.5,19144 2893.5,19144 2893.5,19144 2893.5,19144 2893.5,6787 2893.5,6787 2893.5,6787 3016.2,6787 3016.2,\
6787"];
	reduce_0_very_long -> base_ffn_up_l0_6	[pos="e,3026.4,6841 2844.4,19148 2874.6,19148 2895.5,19148 2895.5,19148 2895.5,19148 2895.5,6841 2895.5,6841 2895.5,6841 3016.4,6841 3016.4,\
6841"];
	reduce_0_very_long -> base_ffn_up_l0_7	[pos="e,3026.2,6574 2732.6,19156 2852.4,19156 3025.5,19156 3025.5,19156 3025.5,19156 3025.5,6574 3025.5,6574 3025.5,6574 3025.6,6574 3025.6,\
6574"];
	reduce_1_very_long -> base_ffn_up_l1_0	[pos="e,3026.3,6224.7 2788.4,15227 2884.2,15227 2985.5,15227 2985.5,15227 2985.5,15227 2985.5,6224.7 2985.5,6224.7 2985.5,6224.7 3016.3,\
6224.7 3016.3,6224.7"];
	reduce_1_very_long -> base_ffn_up_l1_1	[pos="e,3026.3,6278.7 2844.2,15231 2920.3,15231 2986.5,15231 2986.5,15231 2986.5,15231 2986.5,6278.7 2986.5,6278.7 2986.5,6278.7 3016.3,\
6278.7 3016.3,6278.7"];
	reduce_1_very_long -> base_ffn_up_l1_2	[pos="e,3026.4,6165 2732.7,15223 2839.7,15223 2984.5,15223 2984.5,15223 2984.5,15223 2984.5,6165 2984.5,6165 2984.5,6165 3016.4,6165 3016.4,\
6165"];
	reduce_1_very_long -> base_ffn_up_l1_3	[pos="e,3026.2,6494.7 2676.8,15247 2780.2,15247 2990.5,15247 2990.5,15247 2990.5,15247 2990.5,6494.7 2990.5,6494.7 2990.5,6494.7 3016.2,\
6494.7 3016.2,6494.7"];
	reduce_1_very_long -> base_ffn_up_l1_4	[pos="e,3026.2,6440.7 2732.5,15243 2841.1,15243 2989.5,15243 2989.5,15243 2989.5,15243 2989.5,6440.7 2989.5,6440.7 2989.5,6440.7 3016.2,\
6440.7 3016.2,6440.7"];
	reduce_1_very_long -> base_ffn_up_l1_5	[pos="e,3026.2,6332.7 2844.3,15235 2920.8,15235 2987.5,15235 2987.5,15235 2987.5,15235 2987.5,6332.7 2987.5,6332.7 2987.5,6332.7 3016.2,\
6332.7 3016.2,6332.7"];
	reduce_1_very_long -> base_ffn_up_l1_6	[pos="e,3026.2,6386.7 2788.4,15239 2885.4,15239 2988.5,15239 2988.5,15239 2988.5,15239 2988.5,6386.7 2988.5,6386.7 2988.5,6386.7 3016.2,\
6386.7 3016.2,6386.7"];
	reduce_1_very_long -> base_ffn_up_l1_7	[pos="e,3026.1,6111 2676.5,15219 2778.3,15219 2983.5,15219 2983.5,15219 2983.5,15219 2983.5,6111 2983.5,6111 2983.5,6111 3016.1,6111 3016.1,\
6111"];
	reduce_2_very_long -> base_ffn_up_l2_0	[pos="e,3026.1,5761 2788.3,11314 2881,11314 2977.5,11314 2977.5,11314 2977.5,11314 2977.5,5761 2977.5,5761 2977.5,5761 3016.1,5761 3016.1,\
5761"];
	reduce_2_very_long -> base_ffn_up_l2_1	[pos="e,3026.3,5815 2844.2,11318 2916.5,11318 2978.5,11318 2978.5,11318 2978.5,11318 2978.5,5815 2978.5,5815 2978.5,5815 3016.3,5815 3016.3,\
5815"];
	reduce_2_very_long -> base_ffn_up_l2_2	[pos="e,3026.3,5707 2732.7,11310 2837,11310 2976.5,11310 2976.5,11310 2976.5,11310 2976.5,5707 2976.5,5707 2976.5,5707 3016.3,5707 3016.3,\
5707"];
	reduce_2_very_long -> base_ffn_up_l2_3	[pos="e,3026.2,6031 2676.7,11334 2778.4,11334 2982.5,11334 2982.5,11334 2982.5,11334 2982.5,6031 2982.5,6031 2982.5,6031 3016.2,6031 3016.2,\
6031"];
	reduce_2_very_long -> base_ffn_up_l2_4	[pos="e,3026.3,5977 2732.8,11330 2838.7,11330 2981.5,11330 2981.5,11330 2981.5,11330 2981.5,5977 2981.5,5977 2981.5,5977 3016.3,5977 3016.3,\
5977"];
	reduce_2_very_long -> base_ffn_up_l2_5	[pos="e,3026.2,5869 2844.3,11322 2917.1,11322 2979.5,11322 2979.5,11322 2979.5,11322 2979.5,5869 2979.5,5869 2979.5,5869 3016.2,5869 3016.2,\
5869"];
	reduce_2_very_long -> base_ffn_up_l2_6	[pos="e,3026,5923 2788.4,11326 2882.2,11326 2980.5,11326 2980.5,11326 2980.5,11326 2980.5,5923 2980.5,5923 2980.5,5923 3016,5923 3016,\
5923"];
	reduce_2_very_long -> base_ffn_up_l2_7	[pos="e,3026,5653 2676.8,11306 2776.9,11306 2975.5,11306 2975.5,11306 2975.5,11306 2975.5,5653 2975.5,5653 2975.5,5653 3016,5653 3016,\
5653"];
	reduce_3_very_long -> base_ffn_up_l3_0	[pos="e,3026.3,5304 2872.2,7407 2925.2,7407 2965.5,7407 2965.5,7407 2965.5,7407 2965.5,5304 2965.5,5304 2965.5,5304 3016.3,5304 3016.3,\
5304"];
	reduce_3_very_long -> base_ffn_up_l3_1	[pos="e,3026.4,5358 2788.4,7413 2877.4,7413 2968.5,7413 2968.5,7413 2968.5,7413 2968.5,5358 2968.5,5358 2968.5,5358 3016.4,5358 3016.4,\
5358"];
	reduce_3_very_long -> base_ffn_up_l3_2	[pos="e,3026.4,5250.9 2788.3,7401 2874.8,7401 2962.5,7401 2962.5,7401 2962.5,7401 2962.5,5250.9 2962.5,5250.9 2962.5,5250.9 3016.4,5250.9 \
3016.4,5250.9"];
	reduce_3_very_long -> base_ffn_up_l3_3	[pos="e,3026,5574 2826.5,7403.5 2826.5,7315.1 2826.5,5574 2826.5,5574 2826.5,5574 3016,5574 3016,5574"];
	reduce_3_very_long -> base_ffn_up_l3_4	[pos="e,3026.2,5520 2781.5,7400.2 2781.5,7276.7 2781.5,5520 2781.5,5520 2781.5,5520 3016.2,5520 3016.2,5520"];
	reduce_3_very_long -> base_ffn_up_l3_5	[pos="e,3026,5406.8 2704.6,7419 2808.4,7419 2971.5,7419 2971.5,7419 2971.5,7419 2971.5,5406.8 2971.5,5406.8 2971.5,5406.8 3016,5406.8 \
3016,5406.8"];
	reduce_3_very_long -> base_ffn_up_l3_6	[pos="e,3026.4,5467.5 2735.5,7397 2735.5,7247.5 2735.5,5467.5 2735.5,5467.5 2735.5,5467.5 3016.4,5467.5 3016.4,5467.5"];
	reduce_3_very_long -> base_ffn_up_l3_7	[pos="e,3026.2,5194.5 2704.8,7395 2805.2,7395 2959.5,7395 2959.5,7395 2959.5,7395 2959.5,5194.5 2959.5,5194.5 2959.5,5194.5 3016.2,5194.5 \
3016.2,5194.5"];
	kv_broadcast	[fillcolor=lightyellow,
		height=0.5,
		label="<b>KV Cache Broadcast</b><br/>Replicates K,V tensors<br/>Across all attention GPUs",
		pos="1465.5,23788",
		shape=parallelogram,
		style=dashed,
		width=8.7707];
	kv_broadcast -> flash_attn_0_short_0	[pos="e,1827.2,3122 1695.3,23782 1750.8,23782 1794.5,23782 1794.5,23782 1794.5,23782 1794.5,3122 1794.5,3122 1794.5,3122 1817.2,3122 1817.2,\
3122"];
	kv_broadcast -> flash_attn_0_short_1	[pos="e,1827.5,3284 1702.5,23784 1755.6,23784 1796.5,23784 1796.5,23784 1796.5,23784 1796.5,3284 1796.5,3284 1796.5,3284 1817.5,3284 1817.5,\
3284"];
	kv_broadcast -> flash_attn_0_short_2	[pos="e,1827.6,2960 1688.1,23780 1746,23780 1792.5,23780 1792.5,23780 1792.5,23780 1792.5,2960 1792.5,2960 1792.5,2960 1817.6,2960 1817.6,\
2960"];
	kv_broadcast -> flash_attn_0_short_3	[pos="e,1827.3,3932 1731.3,23792 1774,23792 1804.5,23792 1804.5,23792 1804.5,23792 1804.5,3932 1804.5,3932 1804.5,3932 1817.3,3932 1817.3,\
3932"];
	kv_broadcast -> flash_attn_0_short_4	[pos="e,1827.7,3770 1724.3,23790 1769.6,23790 1802.5,23790 1802.5,23790 1802.5,23790 1802.5,3770 1802.5,3770 1802.5,3770 1817.7,3770 1817.7,\
3770"];
	kv_broadcast -> flash_attn_0_short_5	[pos="e,1827.3,3446 1709.7,23786 1760.2,23786 1798.5,23786 1798.5,23786 1798.5,23786 1798.5,3446 1798.5,3446 1798.5,3446 1817.3,3446 1817.3,\
3446"];
	kv_broadcast -> flash_attn_0_short_6	[pos="e,1827.7,3608 1717.2,23788 1765.1,23788 1800.5,23788 1800.5,23788 1800.5,23788 1800.5,3608 1800.5,3608 1800.5,3608 1817.7,3608 1817.7,\
3608"];
	kv_broadcast -> flash_attn_0_short_7	[pos="e,1827.6,2798 1681.1,23778 1740.8,23778 1789.5,23778 1789.5,23778 1789.5,23778 1789.5,2798 1789.5,2798 1789.5,2798 1817.6,2798 1817.6,\
2798"];
	kv_broadcast -> flash_attn_1_short_0	[pos="e,2137.5,1813.2 1306.5,23770 1306.5,23063 1306.5,1930 1306.5,1930 1306.5,1930 2137.5,1930 2137.5,1930 2137.5,1930 2137.5,1823.2 \
2137.5,1823.2"];
	kv_broadcast -> flash_attn_1_short_1	[pos="e,2137.5,1975.2 1320.5,23770 1320.5,23068 1320.5,2092 1320.5,2092 1320.5,2092 2137.5,2092 2137.5,2092 2137.5,2092 2137.5,1985.2 \
2137.5,1985.2"];
	kv_broadcast -> flash_attn_1_short_2	[pos="e,2137.5,1651.2 1292.5,23770 1292.5,23063 1292.5,1768 1292.5,1768 1292.5,1768 2137.5,1768 2137.5,1768 2137.5,1768 2137.5,1661.2 \
2137.5,1661.2"];
	kv_broadcast -> flash_attn_1_short_3	[pos="e,1827.6,2611 1674,23776 1735.9,23776 1787.5,23776 1787.5,23776 1787.5,23776 1787.5,2611 1787.5,2611 1787.5,2611 1817.6,2611 1817.6,\
2611"];
	kv_broadcast -> flash_attn_1_short_4	[pos="e,1827.6,2449 1666.8,23774 1730.9,23774 1785.5,23774 1785.5,23774 1785.5,23774 1785.5,2449 1785.5,2449 1785.5,2449 1817.6,2449 1817.6,\
2449"];
	kv_broadcast -> flash_attn_1_short_5	[pos="e,2137.5,2137.2 1334.5,23770 1334.5,23069 1334.5,2254 1334.5,2254 1334.5,2254 2137.5,2254 2137.5,2254 2137.5,2254 2137.5,2147.2 \
2137.5,2147.2"];
	kv_broadcast -> flash_attn_1_short_6	[pos="e,1827.6,2287 1659.6,23772 1725.8,23772 1783.5,23772 1783.5,23772 1783.5,23772 1783.5,2287 1783.5,2287 1783.5,2287 1817.6,2287 1817.6,\
2287"];
	kv_broadcast -> flash_attn_1_short_7	[pos="e,2137.5,1489.2 1278.5,23770 1278.5,23058 1278.5,1606 1278.5,1606 1278.5,1606 2137.5,1606 2137.5,1606 2137.5,1606 2137.5,1499.2 \
2137.5,1499.2"];
	kv_broadcast -> flash_attn_2_short_0	[pos="e,2137.5,492.21 1192.5,23770 1192.5,23041 1192.5,609 1192.5,609 1192.5,609 2137.5,609 2137.5,609 2137.5,609 2137.5,502.21 2137.5,\
502.21"];
	kv_broadcast -> flash_attn_2_short_1	[pos="e,2137.5,654.21 1207.5,23770 1207.5,23047 1207.5,771 1207.5,771 1207.5,771 2137.5,771 2137.5,771 2137.5,771 2137.5,664.21 2137.5,\
664.21"];
	kv_broadcast -> flash_attn_2_short_2	[pos="e,2137.5,330.21 1178.5,23770 1178.5,23036 1178.5,447 1178.5,447 1178.5,447 2137.5,447 2137.5,447 2137.5,447 2137.5,340.21 2137.5,\
340.21"];
	kv_broadcast -> flash_attn_2_short_3	[pos="e,1931.5,1302.4 1263.5,23770 1263.5,23054 1263.5,1323.5 1263.5,1323.5 1263.5,1323.5 1931.5,1323.5 1931.5,1323.5 1931.5,1323.5 1931.5,\
1312.4 1931.5,1312.4"];
	kv_broadcast -> flash_attn_2_short_4	[pos="e,2137.5,1140.2 1249.5,23770 1249.5,23052 1249.5,1257 1249.5,1257 1249.5,1257 2137.5,1257 2137.5,1257 2137.5,1257 2137.5,1150.2 \
2137.5,1150.2"];
	kv_broadcast -> flash_attn_2_short_5	[pos="e,2137.5,816.21 1221.5,23770 1221.5,23046 1221.5,933 1221.5,933 1221.5,933 2137.5,933 2137.5,933 2137.5,933 2137.5,826.21 2137.5,\
826.21"];
	kv_broadcast -> flash_attn_2_short_6	[pos="e,2137.5,978.21 1235.5,23770 1235.5,23052 1235.5,1095 1235.5,1095 1235.5,1095 2137.5,1095 2137.5,1095 2137.5,1095 2137.5,988.21 \
2137.5,988.21"];
	kv_broadcast -> flash_attn_2_short_7	[pos="e,2137.5,168.21 1164.5,23770 1164.5,23037 1164.5,285 1164.5,285 1164.5,285 2137.5,285 2137.5,285 2137.5,285 2137.5,178.21 2137.5,\
178.21"];
	kv_broadcast -> flash_attn_3_short_0	[pos="e,1827.6,4389 1752.7,23798 1787.2,23798 1810.5,23798 1810.5,23798 1810.5,23798 1810.5,4389 1810.5,4389 1810.5,4389 1817.6,4389 1817.6,\
4389"];
	kv_broadcast -> flash_attn_3_short_1	[pos="e,1827.7,4551 1760.2,23800 1791.6,23800 1812.5,23800 1812.5,23800 1812.5,23800 1812.5,4551 1812.5,4551 1812.5,4551 1817.7,4551 1817.7,\
4551"];
	kv_broadcast -> flash_attn_3_short_2	[pos="e,1827.7,4227 1745.6,23796 1782.8,23796 1808.5,23796 1808.5,23796 1808.5,23796 1808.5,4227 1808.5,4227 1808.5,4227 1817.7,4227 1817.7,\
4227"];
	kv_broadcast -> flash_attn_3_short_3	[pos="e,1827.6,5199 1587.5,23770 1587.5,23113 1587.5,5199 1587.5,5199 1587.5,5199 1817.6,5199 1817.6,5199"];
	kv_broadcast -> flash_attn_3_short_4	[pos="e,1827.6,5037 1585.5,23770 1585.5,23117 1585.5,5037 1585.5,5037 1585.5,5037 1817.6,5037 1817.6,5037"];
	kv_broadcast -> flash_attn_3_short_5	[pos="e,1827.5,4713 1767.4,23802 1795.9,23802 1814.5,23802 1814.5,23802 1814.5,23802 1814.5,4713 1814.5,4713 1814.5,4713 1817.5,4713 1817.5,\
4713"];
	kv_broadcast -> flash_attn_3_short_6	[pos="e,1827.6,4875 1774.5,23804 1800.1,23804 1816.5,23804 1816.5,23804 1816.5,23804 1816.5,4875 1816.5,4875 1816.5,4875 1817.6,4875 1817.6,\
4875"];
	kv_broadcast -> flash_attn_3_short_7	[pos="e,1827.5,4089 1738.7,23794 1778.6,23794 1806.5,23794 1806.5,23794 1806.5,23794 1806.5,4089 1806.5,4089 1806.5,4089 1817.5,4089 1817.5,\
4089"];
	kv_broadcast -> flash_attn_0_medium_0	[pos="e,1828.6,42223 1585.5,23806 1585.5,24457 1585.5,42223 1585.5,42223 1585.5,42223 1818.6,42223 1818.6,42223"];
	kv_broadcast -> flash_attn_0_medium_1	[pos="e,1828.6,42061 1587.5,23806 1587.5,24451 1587.5,42061 1587.5,42061 1587.5,42061 1818.6,42061 1818.6,42061"];
	kv_broadcast -> flash_attn_0_medium_2	[pos="e,1828.5,41899 1589.5,23806 1589.5,24454 1589.5,41899 1589.5,41899 1589.5,41899 1818.5,41899 1818.5,41899"];
	kv_broadcast -> flash_attn_0_medium_3	[pos="e,1828.5,41737 1591.5,23806 1591.5,24448 1591.5,41737 1591.5,41737 1591.5,41737 1818.5,41737 1818.5,41737"];
	kv_broadcast -> flash_attn_0_medium_4	[pos="e,1828.4,41575 1593.5,23806 1593.5,24442 1593.5,41575 1593.5,41575 1593.5,41575 1818.4,41575 1818.4,41575"];
	kv_broadcast -> flash_attn_0_medium_5	[pos="e,1828.7,41413 1595.5,23806 1595.5,24444 1595.5,41413 1595.5,41413 1595.5,41413 1818.7,41413 1818.7,41413"];
	kv_broadcast -> flash_attn_0_medium_6	[pos="e,1828.7,41251 1597.5,23806 1597.5,24438 1597.5,41251 1597.5,41251 1597.5,41251 1818.7,41251 1818.7,41251"];
	kv_broadcast -> flash_attn_0_medium_7	[pos="e,1828.7,41089 1599.5,23806 1599.5,24432 1599.5,41089 1599.5,41089 1599.5,41089 1818.7,41089 1818.7,41089"];
	kv_broadcast -> flash_attn_1_medium_0	[pos="e,1828.7,40902 1601.5,23806 1601.5,24434 1601.5,40902 1601.5,40902 1601.5,40902 1818.7,40902 1818.7,40902"];
	kv_broadcast -> flash_attn_1_medium_1	[pos="e,1828.7,40740 1603.5,23806 1603.5,24427 1603.5,40740 1603.5,40740 1603.5,40740 1818.7,40740 1818.7,40740"];
	kv_broadcast -> flash_attn_1_medium_2	[pos="e,1828.7,40578 1605.5,23806 1605.5,24421 1605.5,40578 1605.5,40578 1605.5,40578 1818.7,40578 1818.7,40578"];
	kv_broadcast -> flash_attn_1_medium_3	[pos="e,1828.7,40416 1607.5,23806 1607.5,24423 1607.5,40416 1607.5,40416 1607.5,40416 1818.7,40416 1818.7,40416"];
	kv_broadcast -> flash_attn_1_medium_4	[pos="e,1828.4,40254 1609.5,23806 1609.5,24417 1609.5,40254 1609.5,40254 1609.5,40254 1818.4,40254 1818.4,40254"];
	kv_broadcast -> flash_attn_1_medium_5	[pos="e,1828.5,40092 1611.5,23806 1611.5,24419 1611.5,40092 1611.5,40092 1611.5,40092 1818.5,40092 1818.5,40092"];
	kv_broadcast -> flash_attn_1_medium_6	[pos="e,1828.5,39930 1613.5,23806 1613.5,24412 1613.5,39930 1613.5,39930 1613.5,39930 1818.5,39930 1818.5,39930"];
	kv_broadcast -> flash_attn_1_medium_7	[pos="e,1828.6,39768 1615.5,23806 1615.5,24406 1615.5,39768 1615.5,39768 1615.5,39768 1818.6,39768 1818.6,39768"];
	kv_broadcast -> flash_attn_2_medium_0	[pos="e,1828.7,39581 1617.5,23806 1617.5,24406 1617.5,39581 1617.5,39581 1617.5,39581 1818.7,39581 1818.7,39581"];
	kv_broadcast -> flash_attn_2_medium_1	[pos="e,1828.4,39419 1619.5,23806 1619.5,24400 1619.5,39419 1619.5,39419 1619.5,39419 1818.4,39419 1818.4,39419"];
	kv_broadcast -> flash_attn_2_medium_2	[pos="e,1828.5,39257 1621.5,23806 1621.5,24401 1621.5,39257 1621.5,39257 1621.5,39257 1818.5,39257 1818.5,39257"];
	kv_broadcast -> flash_attn_2_medium_3	[pos="e,1828.6,39095 1623.5,23806 1623.5,24395 1623.5,39095 1623.5,39095 1623.5,39095 1818.6,39095 1818.6,39095"];
	kv_broadcast -> flash_attn_2_medium_4	[pos="e,1828.6,38933 1626.5,23806 1626.5,24396 1626.5,38933 1626.5,38933 1626.5,38933 1818.6,38933 1818.6,38933"];
	kv_broadcast -> flash_attn_2_medium_5	[pos="e,1828.4,38771 1628.5,23806 1628.5,24389 1628.5,38771 1628.5,38771 1628.5,38771 1818.4,38771 1818.4,38771"];
	kv_broadcast -> flash_attn_2_medium_6	[pos="e,1828.6,38609 1630.5,23806 1630.5,24383 1630.5,38609 1630.5,38609 1630.5,38609 1818.6,38609 1818.6,38609"];
	kv_broadcast -> flash_attn_2_medium_7	[pos="e,1828.7,38447 1632.5,23806 1632.5,24383 1632.5,38447 1632.5,38447 1632.5,38447 1818.7,38447 1818.7,38447"];
	kv_broadcast -> flash_attn_3_medium_0	[pos="e,1828.6,38260 1634.5,23806 1634.5,24375 1634.5,38260 1634.5,38260 1634.5,38260 1818.6,38260 1818.6,38260"];
	kv_broadcast -> flash_attn_3_medium_1	[pos="e,1828.7,38098 1636.5,23806 1636.5,24376 1636.5,38098 1636.5,38098 1636.5,38098 1818.7,38098 1818.7,38098"];
	kv_broadcast -> flash_attn_3_medium_2	[pos="e,1828.6,37936 1638.5,23806 1638.5,24369 1638.5,37936 1638.5,37936 1638.5,37936 1818.6,37936 1818.6,37936"];
	kv_broadcast -> flash_attn_3_medium_3	[pos="e,1828.5,37774 1640.5,23806 1640.5,24369 1640.5,37774 1640.5,37774 1640.5,37774 1818.5,37774 1818.5,37774"];
	kv_broadcast -> flash_attn_3_medium_4	[pos="e,1828.7,37612 1642.5,23806 1642.5,24362 1642.5,37612 1642.5,37612 1642.5,37612 1818.7,37612 1818.7,37612"];
	kv_broadcast -> flash_attn_3_medium_5	[pos="e,1828.6,37450 1644.5,23806 1644.5,24362 1644.5,37450 1644.5,37450 1644.5,37450 1818.6,37450 1818.6,37450"];
	kv_broadcast -> flash_attn_3_medium_6	[pos="e,1828.5,37288 1646.5,23806 1646.5,24355 1646.5,37288 1646.5,37288 1646.5,37288 1818.5,37288 1818.5,37288"];
	kv_broadcast -> flash_attn_3_medium_7	[pos="e,1828.7,37126 1648.5,23806 1648.5,24355 1648.5,37126 1648.5,37126 1648.5,37126 1818.7,37126 1818.7,37126"];
	kv_broadcast -> flash_attn_0_long_0	[pos="e,1823.6,36903 1650.5,23806 1650.5,24352 1650.5,36903 1650.5,36903 1650.5,36903 1813.6,36903 1813.6,36903"];
	kv_broadcast -> flash_attn_0_long_1	[pos="e,1823.6,36741 1652.5,23806 1652.5,24345 1652.5,36741 1652.5,36741 1652.5,36741 1813.6,36741 1813.6,36741"];
	kv_broadcast -> flash_attn_0_long_2	[pos="e,1823.6,36579 1654.5,23806 1654.5,24344 1654.5,36579 1654.5,36579 1654.5,36579 1813.6,36579 1813.6,36579"];
	kv_broadcast -> flash_attn_0_long_3	[pos="e,1823.6,36417 1656.5,23806 1656.5,24337 1656.5,36417 1656.5,36417 1656.5,36417 1813.6,36417 1813.6,36417"];
	kv_broadcast -> flash_attn_0_long_4	[pos="e,1823.6,36255 1658.5,23806 1658.5,24336 1658.5,36255 1658.5,36255 1658.5,36255 1813.6,36255 1813.6,36255"];
	kv_broadcast -> flash_attn_0_long_5	[pos="e,1823.7,36093 1660.5,23806 1660.5,24335 1660.5,36093 1660.5,36093 1660.5,36093 1813.7,36093 1813.7,36093"];
	kv_broadcast -> flash_attn_0_long_6	[pos="e,1823.7,35931 1662.5,23806 1662.5,24327 1662.5,35931 1662.5,35931 1662.5,35931 1813.7,35931 1813.7,35931"];
	kv_broadcast -> flash_attn_0_long_7	[pos="e,1823.5,35769 1664.5,23806 1664.5,24326 1664.5,35769 1664.5,35769 1664.5,35769 1813.5,35769 1813.5,35769"];
	kv_broadcast -> flash_attn_0_long_8	[pos="e,1823.6,35607 1666.5,23806 1666.5,24319 1666.5,35607 1666.5,35607 1666.5,35607 1813.6,35607 1813.6,35607"];
	kv_broadcast -> flash_attn_0_long_9	[pos="e,1821.1,35445 1669.5,23806 1669.5,24317 1669.5,35445 1669.5,35445 1669.5,35445 1811.1,35445 1811.1,35445"];
	kv_broadcast -> flash_attn_0_long_10	[pos="e,1818,35283 1671.5,23806 1671.5,24315 1671.5,35283 1671.5,35283 1671.5,35283 1808,35283 1808,35283"];
	kv_broadcast -> flash_attn_0_long_11	[pos="e,1818.2,35121 1673.5,23806 1673.5,24308 1673.5,35121 1673.5,35121 1673.5,35121 1808.2,35121 1808.2,35121"];
	kv_broadcast -> flash_attn_0_long_12	[pos="e,1818.1,35013 1675.5,23806 1675.5,24308 1675.5,35013 1675.5,35013 1675.5,35013 1808.1,35013 1808.1,35013"];
	kv_broadcast -> flash_attn_0_long_13	[pos="e,1818,34851 1677.5,23806 1677.5,24306 1677.5,34851 1677.5,34851 1677.5,34851 1808,34851 1808,34851"];
	kv_broadcast -> flash_attn_0_long_14	[pos="e,1818.2,34689 1679.5,23806 1679.5,24298 1679.5,34689 1679.5,34689 1679.5,34689 1808.2,34689 1808.2,34689"];
	kv_broadcast -> flash_attn_0_long_15	[pos="e,1818.2,34527 1681.5,23806 1681.5,24296 1681.5,34527 1681.5,34527 1681.5,34527 1808.2,34527 1808.2,34527"];
	kv_broadcast -> flash_attn_1_long_0	[pos="e,1823.7,34286 1683.5,23806 1683.5,24289 1683.5,34286 1683.5,34286 1683.5,34286 1813.7,34286 1813.7,34286"];
	kv_broadcast -> flash_attn_1_long_1	[pos="e,1823.6,34124 1685.5,23806 1685.5,24287 1685.5,34124 1685.5,34124 1685.5,34124 1813.6,34124 1813.6,34124"];
	kv_broadcast -> flash_attn_1_long_2	[pos="e,1823.3,33962 1687.5,23806 1687.5,24284 1687.5,33962 1687.5,33962 1687.5,33962 1813.3,33962 1813.3,33962"];
	kv_broadcast -> flash_attn_1_long_3	[pos="e,1823.6,33800 1689.5,23806 1689.5,24280 1689.5,33800 1689.5,33800 1689.5,33800 1813.6,33800 1813.6,33800"];
	kv_broadcast -> flash_attn_1_long_4	[pos="e,1823.3,33638 1691.5,23806 1691.5,24272 1691.5,33638 1691.5,33638 1691.5,33638 1813.3,33638 1813.3,33638"];
	kv_broadcast -> flash_attn_1_long_5	[pos="e,1823.6,33476 1693.5,23806 1693.5,24269 1693.5,33476 1693.5,33476 1693.5,33476 1813.6,33476 1813.6,33476"];
	kv_broadcast -> flash_attn_1_long_6	[pos="e,1823.4,33314 1695.5,23806 1695.5,24266 1695.5,33314 1695.5,33314 1695.5,33314 1813.4,33314 1813.4,33314"];
	kv_broadcast -> flash_attn_1_long_7	[pos="e,1823.6,33152 1697.5,23806 1697.5,24262 1697.5,33152 1697.5,33152 1697.5,33152 1813.6,33152 1813.6,33152"];
	kv_broadcast -> flash_attn_1_long_8	[pos="e,1823.5,32990 1699.5,23806 1699.5,24258 1699.5,32990 1699.5,32990 1699.5,32990 1813.5,32990 1813.5,32990"];
	kv_broadcast -> flash_attn_1_long_9	[pos="e,1821,32828 1701.5,23806 1701.5,24254 1701.5,32828 1701.5,32828 1701.5,32828 1811,32828 1811,32828"];
	kv_broadcast -> flash_attn_1_long_10	[pos="e,1818.1,32666 1703.5,23806 1703.5,24250 1703.5,32666 1703.5,32666 1703.5,32666 1808.1,32666 1808.1,32666"];
	kv_broadcast -> flash_attn_1_long_11	[pos="e,1818,32504 1705.5,23806 1705.5,24246 1705.5,32504 1705.5,32504 1705.5,32504 1808,32504 1808,32504"];
	kv_broadcast -> flash_attn_1_long_12	[pos="e,1817.9,32396 1707.5,23806 1707.5,24244 1707.5,32396 1707.5,32396 1707.5,32396 1807.9,32396 1807.9,32396"];
	kv_broadcast -> flash_attn_1_long_13	[pos="e,1818.1,32234 1710.5,23806 1710.5,24240 1710.5,32234 1710.5,32234 1710.5,32234 1808.1,32234 1808.1,32234"];
	kv_broadcast -> flash_attn_1_long_14	[pos="e,1818.1,32072 1712.5,23806 1712.5,24235 1712.5,32072 1712.5,32072 1712.5,32072 1808.1,32072 1808.1,32072"];
	kv_broadcast -> flash_attn_1_long_15	[pos="e,1818.1,31910 1714.5,23806 1714.5,24230 1714.5,31910 1714.5,31910 1714.5,31910 1808.1,31910 1808.1,31910"];
	kv_broadcast -> flash_attn_2_long_0	[pos="e,1823.4,31669 1716.5,23806 1716.5,24224 1716.5,31669 1716.5,31669 1716.5,31669 1813.4,31669 1813.4,31669"];
	kv_broadcast -> flash_attn_2_long_1	[pos="e,1823.5,31507 1718.5,23806 1718.5,24219 1718.5,31507 1718.5,31507 1718.5,31507 1813.5,31507 1813.5,31507"];
	kv_broadcast -> flash_attn_2_long_2	[pos="e,1823.5,31345 1720.5,23806 1720.5,24214 1720.5,31345 1720.5,31345 1720.5,31345 1813.5,31345 1813.5,31345"];
	kv_broadcast -> flash_attn_2_long_3	[pos="e,1823.5,31183 1722.5,23806 1722.5,24208 1722.5,31183 1722.5,31183 1722.5,31183 1813.5,31183 1813.5,31183"];
	kv_broadcast -> flash_attn_2_long_4	[pos="e,1823.6,31021 1724.5,23806 1724.5,24206 1724.5,31021 1724.5,31021 1724.5,31021 1813.6,31021 1813.6,31021"];
	kv_broadcast -> flash_attn_2_long_5	[pos="e,1823.7,30859 1726.5,23806 1726.5,24200 1726.5,30859 1726.5,30859 1726.5,30859 1813.7,30859 1813.7,30859"];
	kv_broadcast -> flash_attn_2_long_6	[pos="e,1823.4,30697 1728.5,23806 1728.5,24193 1728.5,30697 1728.5,30697 1728.5,30697 1813.4,30697 1813.4,30697"];
	kv_broadcast -> flash_attn_2_long_7	[pos="e,1823.5,30535 1730.5,23806 1730.5,24190 1730.5,30535 1730.5,30535 1730.5,30535 1813.5,30535 1813.5,30535"];
	kv_broadcast -> flash_attn_2_long_8	[pos="e,1823.7,30373 1732.5,23806 1732.5,24184 1732.5,30373 1732.5,30373 1732.5,30373 1813.7,30373 1813.7,30373"];
	kv_broadcast -> flash_attn_2_long_9	[pos="e,1821,30211 1734.5,23788 1734.5,23813 1734.5,30211 1734.5,30211 1734.5,30211 1811,30211 1811,30211"];
	kv_broadcast -> flash_attn_2_long_10	[pos="e,1818.1,30049 1736.5,23806 1736.5,24176 1736.5,30049 1736.5,30049 1736.5,30049 1808.1,30049 1808.1,30049"];
	kv_broadcast -> flash_attn_2_long_11	[pos="e,1818,29887 1738.5,23806 1738.5,24169 1738.5,29887 1738.5,29887 1738.5,29887 1808,29887 1808,29887"];
	kv_broadcast -> flash_attn_2_long_12	[pos="e,1817.9,29779 1740.5,23806 1740.5,24168 1740.5,29779 1740.5,29779 1740.5,29779 1807.9,29779 1807.9,29779"];
	kv_broadcast -> flash_attn_2_long_13	[pos="e,1817.9,29617 1742.5,23806 1742.5,24160 1742.5,29617 1742.5,29617 1742.5,29617 1807.9,29617 1807.9,29617"];
	kv_broadcast -> flash_attn_2_long_14	[pos="e,1818.2,29455 1744.5,23806 1744.5,24155 1744.5,29455 1744.5,29455 1744.5,29455 1808.2,29455 1808.2,29455"];
	kv_broadcast -> flash_attn_2_long_15	[pos="e,1817.9,29293 1746.5,23806 1746.5,24150 1746.5,29293 1746.5,29293 1746.5,29293 1807.9,29293 1807.9,29293"];
	kv_broadcast -> flash_attn_3_long_0	[pos="e,1823.4,29052 1748.5,23806 1748.5,24142 1748.5,29052 1748.5,29052 1748.5,29052 1813.4,29052 1813.4,29052"];
	kv_broadcast -> flash_attn_3_long_1	[pos="e,1823.4,28890 1751.5,23806 1751.5,24140 1751.5,28890 1751.5,28890 1751.5,28890 1813.4,28890 1813.4,28890"];
	kv_broadcast -> flash_attn_3_long_2	[pos="e,1823.5,28728 1753.5,23806 1753.5,24132 1753.5,28728 1753.5,28728 1753.5,28728 1813.5,28728 1813.5,28728"];
	kv_broadcast -> flash_attn_3_long_3	[pos="e,1823.6,28566 1755.5,23806 1755.5,24127 1755.5,28566 1755.5,28566 1755.5,28566 1813.6,28566 1813.6,28566"];
	kv_broadcast -> flash_attn_3_long_4	[pos="e,1823.7,28404 1757.5,23806 1757.5,24120 1757.5,28404 1757.5,28404 1757.5,28404 1813.7,28404 1813.7,28404"];
	kv_broadcast -> flash_attn_3_long_5	[pos="e,1823.4,28242 1759.5,23806 1759.5,24117 1759.5,28242 1759.5,28242 1759.5,28242 1813.4,28242 1813.4,28242"];
	kv_broadcast -> flash_attn_3_long_6	[pos="e,1823.6,28080 1761.5,23788 1761.5,23805 1761.5,28080 1761.5,28080 1761.5,28080 1813.6,28080 1813.6,28080"];
	kv_broadcast -> flash_attn_3_long_7	[pos="e,1823.5,27918 1763.5,23788 1763.5,23804 1763.5,27918 1763.5,27918 1763.5,27918 1813.5,27918 1813.5,27918"];
	kv_broadcast -> flash_attn_3_long_8	[pos="e,1823.7,27756 1765.5,23788 1765.5,23803 1765.5,27756 1765.5,27756 1765.5,27756 1813.7,27756 1813.7,27756"];
	kv_broadcast -> flash_attn_3_long_9	[pos="e,1821,27594 1767.5,23788 1767.5,23803 1767.5,27594 1767.5,27594 1767.5,27594 1811,27594 1811,27594"];
	kv_broadcast -> flash_attn_3_long_10	[pos="e,1818,27432 1769.5,23788 1769.5,23816 1769.5,27432 1769.5,27432 1769.5,27432 1808,27432 1808,27432"];
	kv_broadcast -> flash_attn_3_long_11	[pos="e,1818.1,27270 1771.5,23788 1771.5,23815 1771.5,27270 1771.5,27270 1771.5,27270 1808.1,27270 1808.1,27270"];
	kv_broadcast -> flash_attn_3_long_12	[pos="e,1818.2,27162 1773.5,23788 1773.5,23814 1773.5,27162 1773.5,27162 1773.5,27162 1808.2,27162 1808.2,27162"];
	kv_broadcast -> flash_attn_3_long_13	[pos="e,1818.1,27000 1775.5,23788 1775.5,23813 1775.5,27000 1775.5,27000 1775.5,27000 1808.1,27000 1808.1,27000"];
	kv_broadcast -> flash_attn_3_long_14	[pos="e,1818.1,26838 1777.5,23788 1777.5,23812 1777.5,26838 1777.5,26838 1777.5,26838 1808.1,26838 1808.1,26838"];
	kv_broadcast -> flash_attn_3_long_15	[pos="e,1818.1,26676 1779.5,23788 1779.5,23811 1779.5,26676 1779.5,26676 1779.5,26676 1808.1,26676 1808.1,26676"];
	kv_broadcast -> flash_attn_0_very_long_0	[pos="e,1823.5,21637 1779.5,23788 1779.5,23771 1779.5,21637 1779.5,21637 1779.5,21637 1813.5,21637 1813.5,21637"];
	kv_broadcast -> flash_attn_0_very_long_1	[pos="e,1823.6,21475 1777.5,23788 1777.5,23770 1777.5,21475 1777.5,21475 1777.5,21475 1813.6,21475 1813.6,21475"];
	kv_broadcast -> flash_attn_0_very_long_2	[pos="e,1823.5,21313 1775.5,23788 1775.5,23769 1775.5,21313 1775.5,21313 1775.5,21313 1813.5,21313 1813.5,21313"];
	kv_broadcast -> flash_attn_0_very_long_3	[pos="e,1823.7,21151 1773.5,23788 1773.5,23767 1773.5,21151 1773.5,21151 1773.5,21151 1813.7,21151 1813.7,21151"];
	kv_broadcast -> flash_attn_0_very_long_4	[pos="e,1823.6,20989 1771.5,23788 1771.5,23766 1771.5,20989 1771.5,20989 1771.5,20989 1813.6,20989 1813.6,20989"];
	kv_broadcast -> flash_attn_0_very_long_5	[pos="e,1823.6,20827 1769.5,23788 1769.5,23765 1769.5,20827 1769.5,20827 1769.5,20827 1813.6,20827 1813.6,20827"];
	kv_broadcast -> flash_attn_0_very_long_6	[pos="e,1823.6,20665 1767.5,23788 1767.5,23764 1767.5,20665 1767.5,20665 1767.5,20665 1813.6,20665 1813.6,20665"];
	kv_broadcast -> flash_attn_0_very_long_7	[pos="e,1823.7,20503 1765.5,23788 1765.5,23762 1765.5,20503 1765.5,20503 1765.5,20503 1813.7,20503 1813.7,20503"];
	kv_broadcast -> flash_attn_0_very_long_8	[pos="e,1823.5,20341 1763.5,23788 1763.5,23761 1763.5,20341 1763.5,20341 1763.5,20341 1813.5,20341 1813.5,20341"];
	kv_broadcast -> flash_attn_0_very_long_9	[pos="e,1820.9,20179 1761.5,23788 1761.5,23760 1761.5,20179 1761.5,20179 1761.5,20179 1810.9,20179 1810.9,20179"];
	kv_broadcast -> flash_attn_0_very_long_10	[pos="e,1818,20017 1759.5,23788 1759.5,23773 1759.5,20017 1759.5,20017 1759.5,20017 1808,20017 1808,20017"];
	kv_broadcast -> flash_attn_0_very_long_11	[pos="e,1818.1,19855 1757.5,23788 1757.5,23773 1757.5,19855 1757.5,19855 1757.5,19855 1808.1,19855 1808.1,19855"];
	kv_broadcast -> flash_attn_0_very_long_12	[pos="e,1817.9,19693 1755.5,23788 1755.5,23772 1755.5,19693 1755.5,19693 1755.5,19693 1807.9,19693 1807.9,19693"];
	kv_broadcast -> flash_attn_0_very_long_13	[pos="e,1818.1,19531 1753.5,23788 1753.5,23771 1753.5,19531 1753.5,19531 1753.5,19531 1808.1,19531 1808.1,19531"];
	kv_broadcast -> flash_attn_0_very_long_14	[pos="e,1818,19369 1751.5,23788 1751.5,23771 1751.5,19369 1751.5,19369 1751.5,19369 1808,19369 1808,19369"];
	kv_broadcast -> flash_attn_0_very_long_15	[pos="e,1817.9,19207 1749.5,23788 1749.5,23770 1749.5,19207 1749.5,19207 1749.5,19207 1807.9,19207 1807.9,19207"];
	kv_broadcast -> flash_attn_0_very_long_16	[pos="e,1817.9,19099 1747.5,23788 1747.5,23770 1747.5,19099 1747.5,19099 1747.5,19099 1807.9,19099 1807.9,19099"];
	kv_broadcast -> flash_attn_0_very_long_17	[pos="e,1818.2,18937 1745.5,23788 1745.5,23769 1745.5,18937 1745.5,18937 1745.5,18937 1808.2,18937 1808.2,18937"];
	kv_broadcast -> flash_attn_0_very_long_18	[pos="e,1817.9,18775 1743.5,23788 1743.5,23768 1743.5,18775 1743.5,18775 1743.5,18775 1807.9,18775 1807.9,18775"];
	kv_broadcast -> flash_attn_0_very_long_19	[pos="e,1817.9,18613 1741.5,23788 1741.5,23768 1741.5,18613 1741.5,18613 1741.5,18613 1807.9,18613 1807.9,18613"];
	kv_broadcast -> flash_attn_0_very_long_20	[pos="e,1817.9,18451 1739.5,23788 1739.5,23767 1739.5,18451 1739.5,18451 1739.5,18451 1807.9,18451 1807.9,18451"];
	kv_broadcast -> flash_attn_0_very_long_21	[pos="e,1818,18289 1737.5,23788 1737.5,23767 1737.5,18289 1737.5,18289 1737.5,18289 1808,18289 1808,18289"];
	kv_broadcast -> flash_attn_0_very_long_22	[pos="e,1818.2,18127 1735.5,23788 1735.5,23766 1735.5,18127 1735.5,18127 1735.5,18127 1808.2,18127 1808.2,18127"];
	kv_broadcast -> flash_attn_0_very_long_23	[pos="e,1817.9,17965 1733.5,23788 1733.5,23765 1733.5,17965 1733.5,17965 1733.5,17965 1807.9,17965 1807.9,17965"];
	kv_broadcast -> flash_attn_1_very_long_0	[pos="e,1823.4,17724 1731.5,23788 1731.5,23764 1731.5,17724 1731.5,17724 1731.5,17724 1813.4,17724 1813.4,17724"];
	kv_broadcast -> flash_attn_1_very_long_1	[pos="e,1823.7,17562 1729.5,23788 1729.5,23764 1729.5,17562 1729.5,17562 1729.5,17562 1813.7,17562 1813.7,17562"];
	kv_broadcast -> flash_attn_1_very_long_2	[pos="e,1823.5,17400 1727.5,23788 1727.5,23763 1727.5,17400 1727.5,17400 1727.5,17400 1813.5,17400 1813.5,17400"];
	kv_broadcast -> flash_attn_1_very_long_3	[pos="e,1823.4,17238 1725.5,23788 1725.5,23762 1725.5,17238 1725.5,17238 1725.5,17238 1813.4,17238 1813.4,17238"];
	kv_broadcast -> flash_attn_1_very_long_4	[pos="e,1823.4,17076 1723.5,23788 1723.5,23762 1723.5,17076 1723.5,17076 1723.5,17076 1813.4,17076 1813.4,17076"];
	kv_broadcast -> flash_attn_1_very_long_5	[pos="e,1823.7,16914 1721.5,23788 1721.5,23761 1721.5,16914 1721.5,16914 1721.5,16914 1813.7,16914 1813.7,16914"];
	kv_broadcast -> flash_attn_1_very_long_6	[pos="e,1823.7,16752 1719.5,23788 1719.5,23761 1719.5,16752 1719.5,16752 1719.5,16752 1813.7,16752 1813.7,16752"];
	kv_broadcast -> flash_attn_1_very_long_7	[pos="e,1823.7,16590 1717.5,23788 1717.5,23760 1717.5,16590 1717.5,16590 1717.5,16590 1813.7,16590 1813.7,16590"];
	kv_broadcast -> flash_attn_1_very_long_8	[pos="e,1823.7,16428 1715.5,23787 1715.5,23702 1715.5,16428 1715.5,16428 1715.5,16428 1813.7,16428 1813.7,16428"];
	kv_broadcast -> flash_attn_1_very_long_9	[pos="e,1821,16266 1713.5,23787 1713.5,23671 1713.5,16266 1713.5,16266 1713.5,16266 1811,16266 1811,16266"];
	kv_broadcast -> flash_attn_1_very_long_10	[pos="e,1817.9,16104 1711.5,23786 1711.5,23654 1711.5,16104 1711.5,16104 1711.5,16104 1807.9,16104 1807.9,16104"];
	kv_broadcast -> flash_attn_1_very_long_11	[pos="e,1817.9,15942 1709.5,23786 1709.5,23636 1709.5,15942 1709.5,15942 1709.5,15942 1807.9,15942 1807.9,15942"];
	kv_broadcast -> flash_attn_1_very_long_12	[pos="e,1817.9,15780 1707.5,23785 1707.5,23617 1707.5,15780 1707.5,15780 1707.5,15780 1807.9,15780 1807.9,15780"];
	kv_broadcast -> flash_attn_1_very_long_13	[pos="e,1818,15618 1705.5,23785 1705.5,23598 1705.5,15618 1705.5,15618 1705.5,15618 1808,15618 1808,15618"];
	kv_broadcast -> flash_attn_1_very_long_14	[pos="e,1818.1,15456 1703.5,23784 1703.5,23578 1703.5,15456 1703.5,15456 1703.5,15456 1808.1,15456 1808.1,15456"];
	kv_broadcast -> flash_attn_1_very_long_15	[pos="e,1818.2,15294 1701.5,23784 1701.5,23566 1701.5,15294 1701.5,15294 1701.5,15294 1808.2,15294 1808.2,15294"];
	kv_broadcast -> flash_attn_1_very_long_16	[pos="e,1817.8,15186 1699.5,23783 1699.5,23546 1699.5,15186 1699.5,15186 1699.5,15186 1807.8,15186 1807.8,15186"];
	kv_broadcast -> flash_attn_1_very_long_17	[pos="e,1817.9,15024 1697.5,23782 1697.5,23533 1697.5,15024 1697.5,15024 1697.5,15024 1807.9,15024 1807.9,15024"];
	kv_broadcast -> flash_attn_1_very_long_18	[pos="e,1818.1,14862 1695.5,23782 1695.5,23520 1695.5,14862 1695.5,14862 1695.5,14862 1808.1,14862 1808.1,14862"];
	kv_broadcast -> flash_attn_1_very_long_19	[pos="e,1817.8,14700 1693.5,23781 1693.5,23506 1693.5,14700 1693.5,14700 1693.5,14700 1807.8,14700 1807.8,14700"];
	kv_broadcast -> flash_attn_1_very_long_20	[pos="e,1818,14538 1691.5,23781 1691.5,23492 1691.5,14538 1691.5,14538 1691.5,14538 1808,14538 1808,14538"];
	kv_broadcast -> flash_attn_1_very_long_21	[pos="e,1818.2,14376 1689.5,23780 1689.5,23478 1689.5,14376 1689.5,14376 1689.5,14376 1808.2,14376 1808.2,14376"];
	kv_broadcast -> flash_attn_1_very_long_22	[pos="e,1817.9,14214 1687.5,23780 1687.5,23464 1687.5,14214 1687.5,14214 1687.5,14214 1807.9,14214 1807.9,14214"];
	kv_broadcast -> flash_attn_1_very_long_23	[pos="e,1818.1,14052 1685.5,23779 1685.5,23449 1685.5,14052 1685.5,14052 1685.5,14052 1808.1,14052 1808.1,14052"];
	kv_broadcast -> flash_attn_2_very_long_0	[pos="e,1823.7,13811 1683.5,23779 1683.5,23436 1683.5,13811 1683.5,13811 1683.5,13811 1813.7,13811 1813.7,13811"];
	kv_broadcast -> flash_attn_2_very_long_1	[pos="e,1823.5,13649 1681.5,23778 1681.5,23420 1681.5,13649 1681.5,13649 1681.5,13649 1813.5,13649 1813.5,13649"];
	kv_broadcast -> flash_attn_2_very_long_2	[pos="e,1823.6,13487 1679.5,23777 1679.5,23409 1679.5,13487 1679.5,13487 1679.5,13487 1813.6,13487 1813.6,13487"];
	kv_broadcast -> flash_attn_2_very_long_3	[pos="e,1823.7,13325 1677.5,23777 1677.5,23398 1677.5,13325 1677.5,13325 1677.5,13325 1813.7,13325 1813.7,13325"];
	kv_broadcast -> flash_attn_2_very_long_4	[pos="e,1823.5,13163 1675.5,23776 1675.5,23382 1675.5,13163 1675.5,13163 1675.5,13163 1813.5,13163 1813.5,13163"];
	kv_broadcast -> flash_attn_2_very_long_5	[pos="e,1823.7,13001 1673.5,23776 1673.5,23371 1673.5,13001 1673.5,13001 1673.5,13001 1813.7,13001 1813.7,13001"];
	kv_broadcast -> flash_attn_2_very_long_6	[pos="e,1823.5,12839 1671.5,23775 1671.5,23359 1671.5,12839 1671.5,12839 1671.5,12839 1813.5,12839 1813.5,12839"];
	kv_broadcast -> flash_attn_2_very_long_7	[pos="e,1823.7,12677 1669.5,23775 1669.5,23348 1669.5,12677 1669.5,12677 1669.5,12677 1813.7,12677 1813.7,12677"];
	kv_broadcast -> flash_attn_2_very_long_8	[pos="e,1823.6,12515 1667.5,23774 1667.5,23330 1667.5,12515 1667.5,12515 1667.5,12515 1813.6,12515 1813.6,12515"];
	kv_broadcast -> flash_attn_2_very_long_9	[pos="e,1821.1,12353 1665.5,23773 1665.5,23318 1665.5,12353 1665.5,12353 1665.5,12353 1811.1,12353 1811.1,12353"];
	kv_broadcast -> flash_attn_2_very_long_10	[pos="e,1818.1,12191 1663.5,23773 1663.5,23306 1663.5,12191 1663.5,12191 1663.5,12191 1808.1,12191 1808.1,12191"];
	kv_broadcast -> flash_attn_2_very_long_11	[pos="e,1818,12029 1661.5,23772 1661.5,23294 1661.5,12029 1661.5,12029 1661.5,12029 1808,12029 1808,12029"];
	kv_broadcast -> flash_attn_2_very_long_12	[pos="e,1818.2,11867 1659.5,23772 1659.5,23281 1659.5,11867 1659.5,11867 1659.5,11867 1808.2,11867 1808.2,11867"];
	kv_broadcast -> flash_attn_2_very_long_13	[pos="e,1818.1,11705 1657.5,23771 1657.5,23269 1657.5,11705 1657.5,11705 1657.5,11705 1808.1,11705 1808.1,11705"];
	kv_broadcast -> flash_attn_2_very_long_14	[pos="e,1818.1,11543 1655.5,23771 1655.5,23262 1655.5,11543 1655.5,11543 1655.5,11543 1808.1,11543 1808.1,11543"];
	kv_broadcast -> flash_attn_2_very_long_15	[pos="e,1818.1,11381 1653.5,23770 1653.5,23249 1653.5,11381 1653.5,11381 1653.5,11381 1808.1,11381 1808.1,11381"];
	kv_broadcast -> flash_attn_2_very_long_16	[pos="e,1818,11273 1651.5,23770 1651.5,23238 1651.5,11273 1651.5,11273 1651.5,11273 1808,11273 1808,11273"];
	kv_broadcast -> flash_attn_2_very_long_17	[pos="e,1818,11111 1649.5,23770 1649.5,23237 1649.5,11111 1649.5,11111 1649.5,11111 1808,11111 1808,11111"];
	kv_broadcast -> flash_attn_2_very_long_18	[pos="e,1818,10949 1647.5,23770 1647.5,23230 1647.5,10949 1647.5,10949 1647.5,10949 1808,10949 1808,10949"];
	kv_broadcast -> flash_attn_2_very_long_19	[pos="e,1818,10787 1645.5,23770 1645.5,23229 1645.5,10787 1645.5,10787 1645.5,10787 1808,10787 1808,10787"];
	kv_broadcast -> flash_attn_2_very_long_20	[pos="e,1818.1,10625 1643.5,23770 1643.5,23222 1643.5,10625 1643.5,10625 1643.5,10625 1808.1,10625 1808.1,10625"];
	kv_broadcast -> flash_attn_2_very_long_21	[pos="e,1818.1,10463 1641.5,23770 1641.5,23222 1641.5,10463 1641.5,10463 1641.5,10463 1808.1,10463 1808.1,10463"];
	kv_broadcast -> flash_attn_2_very_long_22	[pos="e,1818.1,10301 1639.5,23770 1639.5,23215 1639.5,10301 1639.5,10301 1639.5,10301 1808.1,10301 1808.1,10301"];
	kv_broadcast -> flash_attn_2_very_long_23	[pos="e,1818.2,10139 1637.5,23770 1637.5,23214 1637.5,10139 1637.5,10139 1637.5,10139 1808.2,10139 1808.2,10139"];
	kv_broadcast -> flash_attn_3_very_long_0	[pos="e,1823.5,9898 1635.5,23770 1635.5,23211 1635.5,9898 1635.5,9898 1635.5,9898 1813.5,9898 1813.5,9898"];
	kv_broadcast -> flash_attn_3_very_long_1	[pos="e,1823.6,9736 1633.5,23770 1633.5,23204 1633.5,9736 1633.5,9736 1633.5,9736 1813.6,9736 1813.6,9736"];
	kv_broadcast -> flash_attn_3_very_long_2	[pos="e,1823.5,9574 1631.5,23770 1631.5,23204 1631.5,9574 1631.5,9574 1631.5,9574 1813.5,9574 1813.5,9574"];
	kv_broadcast -> flash_attn_3_very_long_3	[pos="e,1823.6,9412 1629.5,23770 1629.5,23198 1629.5,9412 1629.5,9412 1629.5,9412 1813.6,9412 1813.6,9412"];
	kv_broadcast -> flash_attn_3_very_long_4	[pos="e,1823.5,9250 1627.5,23770 1627.5,23198 1627.5,9250 1627.5,9250 1627.5,9250 1813.5,9250 1813.5,9250"];
	kv_broadcast -> flash_attn_3_very_long_5	[pos="e,1823.6,9088 1625.5,23770 1625.5,23191 1625.5,9088 1625.5,9088 1625.5,9088 1813.6,9088 1813.6,9088"];
	kv_broadcast -> flash_attn_3_very_long_6	[pos="e,1823.5,8926 1623.5,23770 1623.5,23192 1623.5,8926 1623.5,8926 1623.5,8926 1813.5,8926 1813.5,8926"];
	kv_broadcast -> flash_attn_3_very_long_7	[pos="e,1823.7,8764 1621.5,23770 1621.5,23185 1621.5,8764 1621.5,8764 1621.5,8764 1813.7,8764 1813.7,8764"];
	kv_broadcast -> flash_attn_3_very_long_8	[pos="e,1823.6,8602 1619.5,23770 1619.5,23186 1619.5,8602 1619.5,8602 1619.5,8602 1813.6,8602 1813.6,8602"];
	kv_broadcast -> flash_attn_3_very_long_9	[pos="e,1821,8440 1617.5,23770 1617.5,23180 1617.5,8440 1617.5,8440 1617.5,8440 1811,8440 1811,8440"];
	kv_broadcast -> flash_attn_3_very_long_10	[pos="e,1818.2,8278 1615.5,23770 1615.5,23173 1615.5,8278 1615.5,8278 1615.5,8278 1808.2,8278 1808.2,8278"];
	kv_broadcast -> flash_attn_3_very_long_11	[pos="e,1818.1,8116 1613.5,23770 1613.5,23174 1613.5,8116 1613.5,8116 1613.5,8116 1808.1,8116 1808.1,8116"];
	kv_broadcast -> flash_attn_3_very_long_12	[pos="e,1818,7954 1611.5,23770 1611.5,23168 1611.5,7954 1611.5,7954 1611.5,7954 1808,7954 1808,7954"];
	kv_broadcast -> flash_attn_3_very_long_13	[pos="e,1818.2,7792 1609.5,23770 1609.5,23169 1609.5,7792 1609.5,7792 1609.5,7792 1808.2,7792 1808.2,7792"];
	kv_broadcast -> flash_attn_3_very_long_14	[pos="e,1818.1,7630 1607.5,23770 1607.5,23163 1607.5,7630 1607.5,7630 1607.5,7630 1808.1,7630 1808.1,7630"];
	kv_broadcast -> flash_attn_3_very_long_15	[pos="e,1818,7468 1605.5,23770 1605.5,23157 1605.5,7468 1605.5,7468 1605.5,7468 1808,7468 1808,7468"];
	kv_broadcast -> flash_attn_3_very_long_16	[pos="e,1818,7360 1603.5,23770 1603.5,23160 1603.5,7360 1603.5,7360 1603.5,7360 1808,7360 1808,7360"];
	kv_broadcast -> flash_attn_3_very_long_17	[pos="e,1817.9,7198 1601.5,23770 1601.5,23154 1601.5,7198 1601.5,7198 1601.5,7198 1807.9,7198 1807.9,7198"];
	kv_broadcast -> flash_attn_3_very_long_18	[pos="e,1818.2,7036 1599.5,23770 1599.5,23148 1599.5,7036 1599.5,7036 1599.5,7036 1808.2,7036 1808.2,7036"];
	kv_broadcast -> flash_attn_3_very_long_19	[pos="e,1818.2,6874 1597.5,23770 1597.5,23150 1597.5,6874 1597.5,6874 1597.5,6874 1808.2,6874 1808.2,6874"];
	kv_broadcast -> flash_attn_3_very_long_20	[pos="e,1818.1,6712 1595.5,23770 1595.5,23144 1595.5,6712 1595.5,6712 1595.5,6712 1808.1,6712 1808.1,6712"];
	kv_broadcast -> flash_attn_3_very_long_21	[pos="e,1818.1,6550 1593.5,23770 1593.5,23146 1593.5,6550 1593.5,6550 1593.5,6550 1808.1,6550 1808.1,6550"];
	kv_broadcast -> flash_attn_3_very_long_22	[pos="e,1818.1,6388 1591.5,23770 1591.5,23140 1591.5,6388 1591.5,6388 1591.5,6388 1808.1,6388 1808.1,6388"];
	kv_broadcast -> flash_attn_3_very_long_23	[pos="e,1818.1,6226 1589.5,23770 1589.5,23134 1589.5,6226 1589.5,6226 1589.5,6226 1808.1,6226 1808.1,6226"];
	async_overlap	[fillcolor=lightyellow,
		height=0.5,
		label="<b>Async Overlap</b><br/>Attention computation<br/>Overlaps with FFN<br/>85% efficiency",
		pos="2620.6,5444",
		shape=parallelogram,
		width=9.288];
	async_overlap -> base_ffn_up_l0_0	[pos="e,3026.3,6660.2 2910.5,5462.1 2910.5,5613.4 2910.5,6660.2 2910.5,6660.2 2910.5,6660.2 3016.3,6660.2 3016.3,6660.2"];
	async_overlap -> base_ffn_up_l0_1	[pos="e,3026.3,6714.2 2908.5,5462.4 2908.5,5618.7 2908.5,6714.2 2908.5,6714.2 2908.5,6714.2 3016.3,6714.2 3016.3,6714.2"];
	async_overlap -> base_ffn_up_l0_2	[pos="e,3026.3,6607.3 2912.5,5462.3 2912.5,5610.3 2912.5,6607.3 2912.5,6607.3 2912.5,6607.3 3016.3,6607.3 3016.3,6607.3"];
	async_overlap -> base_ffn_up_l0_3	[pos="e,3026.3,6930.2 2900.5,5462.3 2900.5,5632.1 2900.5,6930.2 2900.5,6930.2 2900.5,6930.2 3016.3,6930.2 3016.3,6930.2"];
	async_overlap -> base_ffn_up_l0_4	[pos="e,3026.2,6876.2 2902.5,5462.1 2902.5,5627.9 2902.5,6876.2 2902.5,6876.2 2902.5,6876.2 3016.2,6876.2 3016.2,6876.2"];
	async_overlap -> base_ffn_up_l0_5	[pos="e,3026.4,6768.2 2906.5,5462.2 2906.5,5621.3 2906.5,6768.2 2906.5,6768.2 2906.5,6768.2 3016.4,6768.2 3016.4,6768.2"];
	async_overlap -> base_ffn_up_l0_6	[pos="e,3026.4,6822.2 2904.5,5462.2 2904.5,5624.7 2904.5,6822.2 2904.5,6822.2 2904.5,6822.2 3016.4,6822.2 3016.4,6822.2"];
	async_overlap -> base_ffn_up_l0_7	[pos="e,3026.2,6553.3 2915.5,5462.3 2915.5,5606.6 2915.5,6553.3 2915.5,6553.3 2915.5,6553.3 3016.2,6553.3 3016.2,6553.3"];
	async_overlap -> base_ffn_up_l1_0	[pos="e,3026.3,6207.7 2927.5,5444.1 2927.5,5455.9 2927.5,6207.7 2927.5,6207.7 2927.5,6207.7 3016.3,6207.7 3016.3,6207.7"];
	async_overlap -> base_ffn_up_l1_1	[pos="e,3026.2,6261.7 2925.5,5444.1 2925.5,5456.7 2925.5,6261.7 2925.5,6261.7 2925.5,6261.7 3016.2,6261.7 3016.2,6261.7"];
	async_overlap -> base_ffn_up_l1_2	[pos="e,3026.2,6153.7 2929.5,5444.1 2929.5,5455 2929.5,6153.7 2929.5,6153.7 2929.5,6153.7 3016.2,6153.7 3016.2,6153.7"];
	async_overlap -> base_ffn_up_l1_3	[pos="e,3026.2,6477.7 2917.5,5462.4 2917.5,5601.1 2917.5,6477.7 2917.5,6477.7 2917.5,6477.7 3016.2,6477.7 3016.2,6477.7"];
	async_overlap -> base_ffn_up_l1_4	[pos="e,3026.3,6423.7 2919.5,5462.3 2919.5,5596.4 2919.5,6423.7 2919.5,6423.7 2919.5,6423.7 3016.3,6423.7 3016.3,6423.7"];
	async_overlap -> base_ffn_up_l1_5	[pos="e,3026.4,6315.7 2923.5,5462.2 2923.5,5587.4 2923.5,6315.7 2923.5,6315.7 2923.5,6315.7 3016.4,6315.7 3016.4,6315.7"];
	async_overlap -> base_ffn_up_l1_6	[pos="e,3026.3,6369.7 2921.5,5462.1 2921.5,5591.3 2921.5,6369.7 2921.5,6369.7 2921.5,6369.7 3016.3,6369.7 3016.3,6369.7"];
	async_overlap -> base_ffn_up_l1_7	[pos="e,3026.3,6099.7 2932.5,5444.1 2932.5,5454.2 2932.5,6099.7 2932.5,6099.7 2932.5,6099.7 3016.3,6099.7 3016.3,6099.7"];
	async_overlap -> base_ffn_up_l2_0	[pos="e,3026.3,5755 2944.5,5444.1 2944.5,5448.8 2944.5,5755 2944.5,5755 2944.5,5755 3016.3,5755 3016.3,5755"];
	async_overlap -> base_ffn_up_l2_1	[pos="e,3026.3,5803 2942.5,5462.3 2942.5,5535.5 2942.5,5803 2942.5,5803 2942.5,5803 3016.3,5803 3016.3,5803"];
	async_overlap -> base_ffn_up_l2_2	[pos="e,3026.4,5701 2946.5,5444 2946.5,5448 2946.5,5701 2946.5,5701 2946.5,5701 3016.4,5701 3016.4,5701"];
	async_overlap -> base_ffn_up_l2_3	[pos="e,3026.2,6019 2934.5,5444.1 2934.5,5452.9 2934.5,6019 2934.5,6019 2934.5,6019 3016.2,6019 3016.2,6019"];
	async_overlap -> base_ffn_up_l2_4	[pos="e,3026.4,5965 2936.5,5444.1 2936.5,5452.1 2936.5,5965 2936.5,5965 2936.5,5965 3016.4,5965 3016.4,5965"];
	async_overlap -> base_ffn_up_l2_5	[pos="e,3026.3,5857 2940.5,5462 2940.5,5541.5 2940.5,5857 2940.5,5857 2940.5,5857 3016.3,5857 3016.3,5857"];
	async_overlap -> base_ffn_up_l2_6	[pos="e,3026.3,5911 2938.5,5444.1 2938.5,5451.3 2938.5,5911 2938.5,5911 2938.5,5911 3016.3,5911 3016.3,5911"];
	async_overlap -> base_ffn_up_l2_7	[pos="e,3026.2,5647 2949.5,5444.1 2949.5,5450.3 2949.5,5647 2949.5,5647 2949.5,5647 3016.2,5647 3016.2,5647"];
	async_overlap -> base_ffn_up_l3_0	[pos="e,3026.3,5298 2687.5,5425.8 2687.5,5386.7 2687.5,5298 2687.5,5298 2687.5,5298 3016.3,5298 3016.3,5298"];
	async_overlap -> base_ffn_up_l3_1	[pos="e,3026.5,5352 2821.5,5426.7 2821.5,5400 2821.5,5352 2821.5,5352 2821.5,5352 3016.5,5352 3016.5,5352"];
	async_overlap -> base_ffn_up_l3_2	[pos="e,3026.3,5246.1 2554.5,5425.7 2554.5,5376.8 2554.5,5246.1 2554.5,5246.1 2554.5,5246.1 3016.3,5246.1 3016.3,5246.1"];
	async_overlap -> base_ffn_up_l3_3	[pos="e,3026.3,5562 2951.5,5444.1 2951.5,5447.7 2951.5,5562 2951.5,5562 2951.5,5562 3016.3,5562 3016.3,5562"];
	async_overlap -> base_ffn_up_l3_4	[pos="e,3026.5,5508 2953.5,5444 2953.5,5446 2953.5,5508 2953.5,5508 2953.5,5508 3016.5,5508 3016.5,5508"];
	async_overlap -> base_ffn_up_l3_5	[pos="e,3139.5,5430.2 2867.5,5439 3001.3,5439 3139.5,5439 3139.5,5439 3139.5,5439 3139.5,5438.1 3139.5,5438.1"];
	async_overlap -> base_ffn_up_l3_6	[pos="e,3026.4,5457.3 2937.4,5457.3 2937.4,5457.3 3016.4,5457.3 3016.4,5457.3"];
	async_overlap -> base_ffn_up_l3_7	[pos="e,3026.3,5189 2420.5,5425.7 2420.5,5367.2 2420.5,5189 2420.5,5189 2420.5,5189 3016.3,5189 3016.3,5189"];
}
