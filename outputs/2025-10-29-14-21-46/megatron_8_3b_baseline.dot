digraph megatron_8_3b_baseline_baseline {\n    rankdir=TB;\n    node [shape=rectangle, style=filled];\n\n    // Model input\n    input [label="Model Input\nInput: [batch_size=1, seq_len=2048]\nGPU: 0", shape=parallelogram, fillcolor=lightblue];\n\n    // Embedding\n    token_embed [label="Token Embedding\nInput: [1,2048]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    pos_embed [label="Position Embedding\nInput: [1,2048]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    embed_add [label="Add Embeddings\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    // Transformer layers (sequential)\n\n    // Layer 0\n    layernorm1_0 [label="Layer 0\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_0 [label="Layer 0\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_0 [label="Layer 0\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_0 [label="Layer 0\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_0 [label="Layer 0\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_0 [label="Layer 0\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    embed_add -> layernorm1_0;\n    layernorm1_0 -> self_attn_0;\n    self_attn_0 -> residual1_0;\n    embed_add -> residual1_0 [style=dashed];\n    residual1_0 -> layernorm2_0;\n    layernorm2_0 -> mlp_0;\n    mlp_0 -> residual2_0;\n    residual1_0 -> residual2_0 [style=dashed];\n\n    // Layer 1\n    layernorm1_1 [label="Layer 1\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_1 [label="Layer 1\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_1 [label="Layer 1\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_1 [label="Layer 1\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_1 [label="Layer 1\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_1 [label="Layer 1\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_0 -> layernorm1_1;\n    layernorm1_1 -> self_attn_1;\n    self_attn_1 -> residual1_1;\n    residual2_0 -> residual1_1 [style=dashed];\n    residual1_1 -> layernorm2_1;\n    layernorm2_1 -> mlp_1;\n    mlp_1 -> residual2_1;\n    residual1_1 -> residual2_1 [style=dashed];\n\n    // Layer 2\n    layernorm1_2 [label="Layer 2\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_2 [label="Layer 2\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_2 [label="Layer 2\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_2 [label="Layer 2\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_2 [label="Layer 2\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_2 [label="Layer 2\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_1 -> layernorm1_2;\n    layernorm1_2 -> self_attn_2;\n    self_attn_2 -> residual1_2;\n    residual2_1 -> residual1_2 [style=dashed];\n    residual1_2 -> layernorm2_2;\n    layernorm2_2 -> mlp_2;\n    mlp_2 -> residual2_2;\n    residual1_2 -> residual2_2 [style=dashed];\n\n    // Layer 3\n    layernorm1_3 [label="Layer 3\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_3 [label="Layer 3\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_3 [label="Layer 3\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_3 [label="Layer 3\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_3 [label="Layer 3\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_3 [label="Layer 3\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_2 -> layernorm1_3;\n    layernorm1_3 -> self_attn_3;\n    self_attn_3 -> residual1_3;\n    residual2_2 -> residual1_3 [style=dashed];\n    residual1_3 -> layernorm2_3;\n    layernorm2_3 -> mlp_3;\n    mlp_3 -> residual2_3;\n    residual1_3 -> residual2_3 [style=dashed];\n\n    // Layer 4\n    layernorm1_4 [label="Layer 4\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_4 [label="Layer 4\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_4 [label="Layer 4\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_4 [label="Layer 4\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_4 [label="Layer 4\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_4 [label="Layer 4\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_3 -> layernorm1_4;\n    layernorm1_4 -> self_attn_4;\n    self_attn_4 -> residual1_4;\n    residual2_3 -> residual1_4 [style=dashed];\n    residual1_4 -> layernorm2_4;\n    layernorm2_4 -> mlp_4;\n    mlp_4 -> residual2_4;\n    residual1_4 -> residual2_4 [style=dashed];\n\n    // Layer 5\n    layernorm1_5 [label="Layer 5\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_5 [label="Layer 5\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_5 [label="Layer 5\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_5 [label="Layer 5\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_5 [label="Layer 5\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_5 [label="Layer 5\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_4 -> layernorm1_5;\n    layernorm1_5 -> self_attn_5;\n    self_attn_5 -> residual1_5;\n    residual2_4 -> residual1_5 [style=dashed];\n    residual1_5 -> layernorm2_5;\n    layernorm2_5 -> mlp_5;\n    mlp_5 -> residual2_5;\n    residual1_5 -> residual2_5 [style=dashed];\n\n    // Layer 6\n    layernorm1_6 [label="Layer 6\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_6 [label="Layer 6\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_6 [label="Layer 6\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_6 [label="Layer 6\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_6 [label="Layer 6\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_6 [label="Layer 6\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_5 -> layernorm1_6;\n    layernorm1_6 -> self_attn_6;\n    self_attn_6 -> residual1_6;\n    residual2_5 -> residual1_6 [style=dashed];\n    residual1_6 -> layernorm2_6;\n    layernorm2_6 -> mlp_6;\n    mlp_6 -> residual2_6;\n    residual1_6 -> residual2_6 [style=dashed];\n\n    // Layer 7\n    layernorm1_7 [label="Layer 7\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_7 [label="Layer 7\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_7 [label="Layer 7\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_7 [label="Layer 7\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_7 [label="Layer 7\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_7 [label="Layer 7\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_6 -> layernorm1_7;\n    layernorm1_7 -> self_attn_7;\n    self_attn_7 -> residual1_7;\n    residual2_6 -> residual1_7 [style=dashed];\n    residual1_7 -> layernorm2_7;\n    layernorm2_7 -> mlp_7;\n    mlp_7 -> residual2_7;\n    residual1_7 -> residual2_7 [style=dashed];\n\n    // Layer 8\n    layernorm1_8 [label="Layer 8\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_8 [label="Layer 8\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_8 [label="Layer 8\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_8 [label="Layer 8\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_8 [label="Layer 8\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_8 [label="Layer 8\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_7 -> layernorm1_8;\n    layernorm1_8 -> self_attn_8;\n    self_attn_8 -> residual1_8;\n    residual2_7 -> residual1_8 [style=dashed];\n    residual1_8 -> layernorm2_8;\n    layernorm2_8 -> mlp_8;\n    mlp_8 -> residual2_8;\n    residual1_8 -> residual2_8 [style=dashed];\n\n    // Layer 9\n    layernorm1_9 [label="Layer 9\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_9 [label="Layer 9\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_9 [label="Layer 9\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_9 [label="Layer 9\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_9 [label="Layer 9\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_9 [label="Layer 9\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_8 -> layernorm1_9;\n    layernorm1_9 -> self_attn_9;\n    self_attn_9 -> residual1_9;\n    residual2_8 -> residual1_9 [style=dashed];\n    residual1_9 -> layernorm2_9;\n    layernorm2_9 -> mlp_9;\n    mlp_9 -> residual2_9;\n    residual1_9 -> residual2_9 [style=dashed];\n\n    // Layer 10\n    layernorm1_10 [label="Layer 10\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_10 [label="Layer 10\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_10 [label="Layer 10\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_10 [label="Layer 10\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_10 [label="Layer 10\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_10 [label="Layer 10\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_9 -> layernorm1_10;\n    layernorm1_10 -> self_attn_10;\n    self_attn_10 -> residual1_10;\n    residual2_9 -> residual1_10 [style=dashed];\n    residual1_10 -> layernorm2_10;\n    layernorm2_10 -> mlp_10;\n    mlp_10 -> residual2_10;\n    residual1_10 -> residual2_10 [style=dashed];\n\n    // Layer 11\n    layernorm1_11 [label="Layer 11\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_11 [label="Layer 11\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_11 [label="Layer 11\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_11 [label="Layer 11\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_11 [label="Layer 11\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_11 [label="Layer 11\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_10 -> layernorm1_11;\n    layernorm1_11 -> self_attn_11;\n    self_attn_11 -> residual1_11;\n    residual2_10 -> residual1_11 [style=dashed];\n    residual1_11 -> layernorm2_11;\n    layernorm2_11 -> mlp_11;\n    mlp_11 -> residual2_11;\n    residual1_11 -> residual2_11 [style=dashed];\n\n    // Layer 12\n    layernorm1_12 [label="Layer 12\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_12 [label="Layer 12\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_12 [label="Layer 12\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_12 [label="Layer 12\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_12 [label="Layer 12\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_12 [label="Layer 12\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_11 -> layernorm1_12;\n    layernorm1_12 -> self_attn_12;\n    self_attn_12 -> residual1_12;\n    residual2_11 -> residual1_12 [style=dashed];\n    residual1_12 -> layernorm2_12;\n    layernorm2_12 -> mlp_12;\n    mlp_12 -> residual2_12;\n    residual1_12 -> residual2_12 [style=dashed];\n\n    // Layer 13\n    layernorm1_13 [label="Layer 13\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_13 [label="Layer 13\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_13 [label="Layer 13\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_13 [label="Layer 13\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_13 [label="Layer 13\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_13 [label="Layer 13\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_12 -> layernorm1_13;\n    layernorm1_13 -> self_attn_13;\n    self_attn_13 -> residual1_13;\n    residual2_12 -> residual1_13 [style=dashed];\n    residual1_13 -> layernorm2_13;\n    layernorm2_13 -> mlp_13;\n    mlp_13 -> residual2_13;\n    residual1_13 -> residual2_13 [style=dashed];\n\n    // Layer 14\n    layernorm1_14 [label="Layer 14\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_14 [label="Layer 14\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_14 [label="Layer 14\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_14 [label="Layer 14\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_14 [label="Layer 14\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_14 [label="Layer 14\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_13 -> layernorm1_14;\n    layernorm1_14 -> self_attn_14;\n    self_attn_14 -> residual1_14;\n    residual2_13 -> residual1_14 [style=dashed];\n    residual1_14 -> layernorm2_14;\n    layernorm2_14 -> mlp_14;\n    mlp_14 -> residual2_14;\n    residual1_14 -> residual2_14 [style=dashed];\n\n    // Layer 15\n    layernorm1_15 [label="Layer 15\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_15 [label="Layer 15\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_15 [label="Layer 15\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_15 [label="Layer 15\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_15 [label="Layer 15\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_15 [label="Layer 15\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_14 -> layernorm1_15;\n    layernorm1_15 -> self_attn_15;\n    self_attn_15 -> residual1_15;\n    residual2_14 -> residual1_15 [style=dashed];\n    residual1_15 -> layernorm2_15;\n    layernorm2_15 -> mlp_15;\n    mlp_15 -> residual2_15;\n    residual1_15 -> residual2_15 [style=dashed];\n\n    // Layer 16\n    layernorm1_16 [label="Layer 16\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_16 [label="Layer 16\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_16 [label="Layer 16\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_16 [label="Layer 16\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_16 [label="Layer 16\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_16 [label="Layer 16\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_15 -> layernorm1_16;\n    layernorm1_16 -> self_attn_16;\n    self_attn_16 -> residual1_16;\n    residual2_15 -> residual1_16 [style=dashed];\n    residual1_16 -> layernorm2_16;\n    layernorm2_16 -> mlp_16;\n    mlp_16 -> residual2_16;\n    residual1_16 -> residual2_16 [style=dashed];\n\n    // Layer 17\n    layernorm1_17 [label="Layer 17\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_17 [label="Layer 17\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_17 [label="Layer 17\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_17 [label="Layer 17\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_17 [label="Layer 17\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_17 [label="Layer 17\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_16 -> layernorm1_17;\n    layernorm1_17 -> self_attn_17;\n    self_attn_17 -> residual1_17;\n    residual2_16 -> residual1_17 [style=dashed];\n    residual1_17 -> layernorm2_17;\n    layernorm2_17 -> mlp_17;\n    mlp_17 -> residual2_17;\n    residual1_17 -> residual2_17 [style=dashed];\n\n    // Layer 18\n    layernorm1_18 [label="Layer 18\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_18 [label="Layer 18\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_18 [label="Layer 18\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_18 [label="Layer 18\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_18 [label="Layer 18\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_18 [label="Layer 18\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_17 -> layernorm1_18;\n    layernorm1_18 -> self_attn_18;\n    self_attn_18 -> residual1_18;\n    residual2_17 -> residual1_18 [style=dashed];\n    residual1_18 -> layernorm2_18;\n    layernorm2_18 -> mlp_18;\n    mlp_18 -> residual2_18;\n    residual1_18 -> residual2_18 [style=dashed];\n\n    // Layer 19\n    layernorm1_19 [label="Layer 19\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_19 [label="Layer 19\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_19 [label="Layer 19\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_19 [label="Layer 19\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_19 [label="Layer 19\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_19 [label="Layer 19\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_18 -> layernorm1_19;\n    layernorm1_19 -> self_attn_19;\n    self_attn_19 -> residual1_19;\n    residual2_18 -> residual1_19 [style=dashed];\n    residual1_19 -> layernorm2_19;\n    layernorm2_19 -> mlp_19;\n    mlp_19 -> residual2_19;\n    residual1_19 -> residual2_19 [style=dashed];\n\n    // Layer 20\n    layernorm1_20 [label="Layer 20\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_20 [label="Layer 20\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_20 [label="Layer 20\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_20 [label="Layer 20\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_20 [label="Layer 20\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_20 [label="Layer 20\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_19 -> layernorm1_20;\n    layernorm1_20 -> self_attn_20;\n    self_attn_20 -> residual1_20;\n    residual2_19 -> residual1_20 [style=dashed];\n    residual1_20 -> layernorm2_20;\n    layernorm2_20 -> mlp_20;\n    mlp_20 -> residual2_20;\n    residual1_20 -> residual2_20 [style=dashed];\n\n    // Layer 21\n    layernorm1_21 [label="Layer 21\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_21 [label="Layer 21\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_21 [label="Layer 21\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_21 [label="Layer 21\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_21 [label="Layer 21\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_21 [label="Layer 21\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_20 -> layernorm1_21;\n    layernorm1_21 -> self_attn_21;\n    self_attn_21 -> residual1_21;\n    residual2_20 -> residual1_21 [style=dashed];\n    residual1_21 -> layernorm2_21;\n    layernorm2_21 -> mlp_21;\n    mlp_21 -> residual2_21;\n    residual1_21 -> residual2_21 [style=dashed];\n\n    // Layer 22\n    layernorm1_22 [label="Layer 22\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_22 [label="Layer 22\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_22 [label="Layer 22\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_22 [label="Layer 22\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_22 [label="Layer 22\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_22 [label="Layer 22\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_21 -> layernorm1_22;\n    layernorm1_22 -> self_attn_22;\n    self_attn_22 -> residual1_22;\n    residual2_21 -> residual1_22 [style=dashed];\n    residual1_22 -> layernorm2_22;\n    layernorm2_22 -> mlp_22;\n    mlp_22 -> residual2_22;\n    residual1_22 -> residual2_22 [style=dashed];\n\n    // Layer 23\n    layernorm1_23 [label="Layer 23\nLayerNorm 1\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    self_attn_23 [label="Layer 23\nSelf-Attention\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=orange];\n    residual1_23 [label="Layer 23\nResidual Add 1\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n    layernorm2_23 [label="Layer 23\nLayerNorm 2\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    mlp_23 [label="Layer 23\nMLP\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=lightgreen];\n    residual2_23 [label="Layer 23\nResidual Add 2\nInput: [1,2048,4096], [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=grey];\n\n    residual2_22 -> layernorm1_23;\n    layernorm1_23 -> self_attn_23;\n    self_attn_23 -> residual1_23;\n    residual2_22 -> residual1_23 [style=dashed];\n    residual1_23 -> layernorm2_23;\n    layernorm2_23 -> mlp_23;\n    mlp_23 -> residual2_23;\n    residual1_23 -> residual2_23 [style=dashed];\n\n    // Final processing\n    final_layernorm [label="Final LayerNorm\nInput: [1,2048,4096]\nOutput: [1,2048,4096]\nGPU: 0", fillcolor=yellow];\n    residual2_23 -> final_layernorm;\n\n    lm_head [label="Language Model Head\nInput: [1,2048,4096]\nOutput: [1,2048,51200]\nGPU: 0", fillcolor=orange];\n    final_layernorm -> lm_head;\n

    output [label="Model Output
Input: [batch_size=1, seq_len=2048, vocab_size=51200]
GPU: 0", shape=parallelogram, fillcolor=lightblue];
    lm_head -> output;
}