digraph LLM_TP_EP_PP_Parallelism {
	graph [bgcolor=white fontname=Arial fontsize=12 rankdir=TB]
	node [fillcolor=lightblue fontname=Arial shape=rectangle style=filled]
	input [label="Input\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen shape=ellipse]
	subgraph cluster_PP_Stage_0 {
		fillcolor=lightgray fontname="Arial Bold" label="Pipeline Stage 0 (Layers 0-3)" style="rounded,filled"
		Layer_0_QKV_TP0_PP0 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_0_QKV_TP1_PP0 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_0_QKV_AllReduce_PP0 [label="All-Reduce QKV\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_0_Attention_TP0_PP0 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_0_Attention_TP1_PP0 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_0_AttnOut_TP0_PP0 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_0_AttnOut_TP1_PP0 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_0_AttnOut_AllReduce_PP0 [label="All-Reduce Attn Output\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_0_Gate_EP0_PP0 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_0_Gate_EP1_PP0 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_0_Gate_EP2_PP0 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_0_Gate_EP3_PP0 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_0_Expert_0_EP0_TP0_PP0 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_0_EP0_TP1_PP0 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_1_EP0_TP0_PP0 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_1_EP0_TP1_PP0 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_2_EP0_TP0_PP0 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_2_EP0_TP1_PP0 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_3_EP0_TP0_PP0 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_3_EP0_TP1_PP0 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_4_EP1_TP0_PP0 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_4_EP1_TP1_PP0 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_5_EP1_TP0_PP0 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_5_EP1_TP1_PP0 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_6_EP1_TP0_PP0 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_6_EP1_TP1_PP0 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_7_EP1_TP0_PP0 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_7_EP1_TP1_PP0 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_8_EP2_TP0_PP0 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_8_EP2_TP1_PP0 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_9_EP2_TP0_PP0 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_9_EP2_TP1_PP0 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_10_EP2_TP0_PP0 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_10_EP2_TP1_PP0 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_11_EP2_TP0_PP0 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_11_EP2_TP1_PP0 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_12_EP3_TP0_PP0 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_12_EP3_TP1_PP0 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_13_EP3_TP0_PP0 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_13_EP3_TP1_PP0 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_14_EP3_TP0_PP0 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_14_EP3_TP1_PP0 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_15_EP3_TP0_PP0 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_Expert_15_EP3_TP1_PP0 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_0_A2A_Dispatch_PP0 [label="All-to-All Dispatch\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_0_A2A_Combine_PP0 [label="All-to-All Combine\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_0_MLP_Out_TP0_PP0 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_0_MLP_Out_TP1_PP0 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_0_MLP_AllReduce_PP0 [label="All-Reduce MLP Output\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_0_LayerNorm_PP0 [label="LayerNorm\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_1_QKV_TP0_PP0 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_1_QKV_TP1_PP0 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_1_QKV_AllReduce_PP0 [label="All-Reduce QKV\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_1_Attention_TP0_PP0 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_1_Attention_TP1_PP0 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_1_AttnOut_TP0_PP0 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_1_AttnOut_TP1_PP0 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_1_AttnOut_AllReduce_PP0 [label="All-Reduce Attn Output\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_1_Gate_EP0_PP0 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_1_Gate_EP1_PP0 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_1_Gate_EP2_PP0 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_1_Gate_EP3_PP0 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_1_Expert_0_EP0_TP0_PP0 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_0_EP0_TP1_PP0 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_1_EP0_TP0_PP0 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_1_EP0_TP1_PP0 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_2_EP0_TP0_PP0 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_2_EP0_TP1_PP0 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_3_EP0_TP0_PP0 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_3_EP0_TP1_PP0 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_4_EP1_TP0_PP0 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_4_EP1_TP1_PP0 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_5_EP1_TP0_PP0 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_5_EP1_TP1_PP0 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_6_EP1_TP0_PP0 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_6_EP1_TP1_PP0 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_7_EP1_TP0_PP0 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_7_EP1_TP1_PP0 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_8_EP2_TP0_PP0 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_8_EP2_TP1_PP0 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_9_EP2_TP0_PP0 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_9_EP2_TP1_PP0 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_10_EP2_TP0_PP0 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_10_EP2_TP1_PP0 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_11_EP2_TP0_PP0 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_11_EP2_TP1_PP0 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_12_EP3_TP0_PP0 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_12_EP3_TP1_PP0 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_13_EP3_TP0_PP0 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_13_EP3_TP1_PP0 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_14_EP3_TP0_PP0 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_14_EP3_TP1_PP0 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_15_EP3_TP0_PP0 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_Expert_15_EP3_TP1_PP0 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_1_A2A_Dispatch_PP0 [label="All-to-All Dispatch\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_1_A2A_Combine_PP0 [label="All-to-All Combine\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_1_MLP_Out_TP0_PP0 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_1_MLP_Out_TP1_PP0 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_1_MLP_AllReduce_PP0 [label="All-Reduce MLP Output\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_1_LayerNorm_PP0 [label="LayerNorm\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_2_QKV_TP0_PP0 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_2_QKV_TP1_PP0 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_2_QKV_AllReduce_PP0 [label="All-Reduce QKV\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_2_Attention_TP0_PP0 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_2_Attention_TP1_PP0 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_2_AttnOut_TP0_PP0 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_2_AttnOut_TP1_PP0 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_2_AttnOut_AllReduce_PP0 [label="All-Reduce Attn Output\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_2_Gate_EP0_PP0 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_2_Gate_EP1_PP0 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_2_Gate_EP2_PP0 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_2_Gate_EP3_PP0 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_2_Expert_0_EP0_TP0_PP0 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_0_EP0_TP1_PP0 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_1_EP0_TP0_PP0 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_1_EP0_TP1_PP0 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_2_EP0_TP0_PP0 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_2_EP0_TP1_PP0 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_3_EP0_TP0_PP0 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_3_EP0_TP1_PP0 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_4_EP1_TP0_PP0 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_4_EP1_TP1_PP0 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_5_EP1_TP0_PP0 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_5_EP1_TP1_PP0 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_6_EP1_TP0_PP0 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_6_EP1_TP1_PP0 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_7_EP1_TP0_PP0 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_7_EP1_TP1_PP0 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_8_EP2_TP0_PP0 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_8_EP2_TP1_PP0 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_9_EP2_TP0_PP0 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_9_EP2_TP1_PP0 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_10_EP2_TP0_PP0 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_10_EP2_TP1_PP0 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_11_EP2_TP0_PP0 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_11_EP2_TP1_PP0 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_12_EP3_TP0_PP0 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_12_EP3_TP1_PP0 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_13_EP3_TP0_PP0 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_13_EP3_TP1_PP0 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_14_EP3_TP0_PP0 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_14_EP3_TP1_PP0 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_15_EP3_TP0_PP0 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_Expert_15_EP3_TP1_PP0 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_2_A2A_Dispatch_PP0 [label="All-to-All Dispatch\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_2_A2A_Combine_PP0 [label="All-to-All Combine\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_2_MLP_Out_TP0_PP0 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_2_MLP_Out_TP1_PP0 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_2_MLP_AllReduce_PP0 [label="All-Reduce MLP Output\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_2_LayerNorm_PP0 [label="LayerNorm\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_3_QKV_TP0_PP0 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_3_QKV_TP1_PP0 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_3_QKV_AllReduce_PP0 [label="All-Reduce QKV\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_3_Attention_TP0_PP0 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_3_Attention_TP1_PP0 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_3_AttnOut_TP0_PP0 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_3_AttnOut_TP1_PP0 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_3_AttnOut_AllReduce_PP0 [label="All-Reduce Attn Output\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_3_Gate_EP0_PP0 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_3_Gate_EP1_PP0 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_3_Gate_EP2_PP0 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_3_Gate_EP3_PP0 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_3_Expert_0_EP0_TP0_PP0 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_0_EP0_TP1_PP0 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_1_EP0_TP0_PP0 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_1_EP0_TP1_PP0 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_2_EP0_TP0_PP0 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_2_EP0_TP1_PP0 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_3_EP0_TP0_PP0 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_3_EP0_TP1_PP0 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_4_EP1_TP0_PP0 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_4_EP1_TP1_PP0 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_5_EP1_TP0_PP0 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_5_EP1_TP1_PP0 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_6_EP1_TP0_PP0 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_6_EP1_TP1_PP0 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_7_EP1_TP0_PP0 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_7_EP1_TP1_PP0 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_8_EP2_TP0_PP0 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_8_EP2_TP1_PP0 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_9_EP2_TP0_PP0 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_9_EP2_TP1_PP0 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_10_EP2_TP0_PP0 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_10_EP2_TP1_PP0 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_11_EP2_TP0_PP0 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_11_EP2_TP1_PP0 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_12_EP3_TP0_PP0 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_12_EP3_TP1_PP0 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_13_EP3_TP0_PP0 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_13_EP3_TP1_PP0 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_14_EP3_TP0_PP0 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_14_EP3_TP1_PP0 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_15_EP3_TP0_PP0 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_Expert_15_EP3_TP1_PP0 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_3_A2A_Dispatch_PP0 [label="All-to-All Dispatch\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_3_A2A_Combine_PP0 [label="All-to-All Combine\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_3_MLP_Out_TP0_PP0 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_3_MLP_Out_TP1_PP0 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_3_MLP_AllReduce_PP0 [label="All-Reduce MLP Output\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_3_LayerNorm_PP0 [label="LayerNorm\nPP Stage 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
	}
	subgraph cluster_PP_Stage_1 {
		fillcolor=lightgray fontname="Arial Bold" label="Pipeline Stage 1 (Layers 4-7)" style="rounded,filled"
		Layer_4_QKV_TP0_PP1 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_4_QKV_TP1_PP1 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_4_QKV_AllReduce_PP1 [label="All-Reduce QKV\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_4_Attention_TP0_PP1 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_4_Attention_TP1_PP1 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_4_AttnOut_TP0_PP1 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_4_AttnOut_TP1_PP1 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_4_AttnOut_AllReduce_PP1 [label="All-Reduce Attn Output\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_4_Gate_EP0_PP1 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_4_Gate_EP1_PP1 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_4_Gate_EP2_PP1 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_4_Gate_EP3_PP1 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_4_Expert_0_EP0_TP0_PP1 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_0_EP0_TP1_PP1 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_1_EP0_TP0_PP1 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_1_EP0_TP1_PP1 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_2_EP0_TP0_PP1 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_2_EP0_TP1_PP1 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_3_EP0_TP0_PP1 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_3_EP0_TP1_PP1 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_4_EP1_TP0_PP1 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_4_EP1_TP1_PP1 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_5_EP1_TP0_PP1 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_5_EP1_TP1_PP1 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_6_EP1_TP0_PP1 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_6_EP1_TP1_PP1 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_7_EP1_TP0_PP1 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_7_EP1_TP1_PP1 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_8_EP2_TP0_PP1 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_8_EP2_TP1_PP1 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_9_EP2_TP0_PP1 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_9_EP2_TP1_PP1 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_10_EP2_TP0_PP1 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_10_EP2_TP1_PP1 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_11_EP2_TP0_PP1 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_11_EP2_TP1_PP1 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_12_EP3_TP0_PP1 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_12_EP3_TP1_PP1 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_13_EP3_TP0_PP1 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_13_EP3_TP1_PP1 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_14_EP3_TP0_PP1 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_14_EP3_TP1_PP1 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_15_EP3_TP0_PP1 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_Expert_15_EP3_TP1_PP1 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_4_A2A_Dispatch_PP1 [label="All-to-All Dispatch\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_4_A2A_Combine_PP1 [label="All-to-All Combine\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_4_MLP_Out_TP0_PP1 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_4_MLP_Out_TP1_PP1 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_4_MLP_AllReduce_PP1 [label="All-Reduce MLP Output\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_4_LayerNorm_PP1 [label="LayerNorm\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_5_QKV_TP0_PP1 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_5_QKV_TP1_PP1 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_5_QKV_AllReduce_PP1 [label="All-Reduce QKV\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_5_Attention_TP0_PP1 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_5_Attention_TP1_PP1 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_5_AttnOut_TP0_PP1 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_5_AttnOut_TP1_PP1 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_5_AttnOut_AllReduce_PP1 [label="All-Reduce Attn Output\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_5_Gate_EP0_PP1 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_5_Gate_EP1_PP1 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_5_Gate_EP2_PP1 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_5_Gate_EP3_PP1 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_5_Expert_0_EP0_TP0_PP1 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_0_EP0_TP1_PP1 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_1_EP0_TP0_PP1 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_1_EP0_TP1_PP1 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_2_EP0_TP0_PP1 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_2_EP0_TP1_PP1 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_3_EP0_TP0_PP1 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_3_EP0_TP1_PP1 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_4_EP1_TP0_PP1 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_4_EP1_TP1_PP1 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_5_EP1_TP0_PP1 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_5_EP1_TP1_PP1 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_6_EP1_TP0_PP1 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_6_EP1_TP1_PP1 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_7_EP1_TP0_PP1 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_7_EP1_TP1_PP1 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_8_EP2_TP0_PP1 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_8_EP2_TP1_PP1 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_9_EP2_TP0_PP1 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_9_EP2_TP1_PP1 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_10_EP2_TP0_PP1 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_10_EP2_TP1_PP1 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_11_EP2_TP0_PP1 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_11_EP2_TP1_PP1 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_12_EP3_TP0_PP1 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_12_EP3_TP1_PP1 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_13_EP3_TP0_PP1 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_13_EP3_TP1_PP1 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_14_EP3_TP0_PP1 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_14_EP3_TP1_PP1 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_15_EP3_TP0_PP1 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_Expert_15_EP3_TP1_PP1 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_5_A2A_Dispatch_PP1 [label="All-to-All Dispatch\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_5_A2A_Combine_PP1 [label="All-to-All Combine\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_5_MLP_Out_TP0_PP1 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_5_MLP_Out_TP1_PP1 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_5_MLP_AllReduce_PP1 [label="All-Reduce MLP Output\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_5_LayerNorm_PP1 [label="LayerNorm\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_6_QKV_TP0_PP1 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_6_QKV_TP1_PP1 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_6_QKV_AllReduce_PP1 [label="All-Reduce QKV\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_6_Attention_TP0_PP1 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_6_Attention_TP1_PP1 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_6_AttnOut_TP0_PP1 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_6_AttnOut_TP1_PP1 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_6_AttnOut_AllReduce_PP1 [label="All-Reduce Attn Output\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_6_Gate_EP0_PP1 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_6_Gate_EP1_PP1 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_6_Gate_EP2_PP1 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_6_Gate_EP3_PP1 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_6_Expert_0_EP0_TP0_PP1 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_0_EP0_TP1_PP1 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_1_EP0_TP0_PP1 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_1_EP0_TP1_PP1 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_2_EP0_TP0_PP1 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_2_EP0_TP1_PP1 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_3_EP0_TP0_PP1 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_3_EP0_TP1_PP1 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_4_EP1_TP0_PP1 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_4_EP1_TP1_PP1 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_5_EP1_TP0_PP1 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_5_EP1_TP1_PP1 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_6_EP1_TP0_PP1 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_6_EP1_TP1_PP1 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_7_EP1_TP0_PP1 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_7_EP1_TP1_PP1 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_8_EP2_TP0_PP1 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_8_EP2_TP1_PP1 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_9_EP2_TP0_PP1 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_9_EP2_TP1_PP1 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_10_EP2_TP0_PP1 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_10_EP2_TP1_PP1 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_11_EP2_TP0_PP1 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_11_EP2_TP1_PP1 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_12_EP3_TP0_PP1 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_12_EP3_TP1_PP1 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_13_EP3_TP0_PP1 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_13_EP3_TP1_PP1 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_14_EP3_TP0_PP1 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_14_EP3_TP1_PP1 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_15_EP3_TP0_PP1 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_Expert_15_EP3_TP1_PP1 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_6_A2A_Dispatch_PP1 [label="All-to-All Dispatch\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_6_A2A_Combine_PP1 [label="All-to-All Combine\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_6_MLP_Out_TP0_PP1 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_6_MLP_Out_TP1_PP1 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_6_MLP_AllReduce_PP1 [label="All-Reduce MLP Output\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_6_LayerNorm_PP1 [label="LayerNorm\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_7_QKV_TP0_PP1 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_7_QKV_TP1_PP1 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_7_QKV_AllReduce_PP1 [label="All-Reduce QKV\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_7_Attention_TP0_PP1 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_7_Attention_TP1_PP1 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_7_AttnOut_TP0_PP1 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_7_AttnOut_TP1_PP1 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_7_AttnOut_AllReduce_PP1 [label="All-Reduce Attn Output\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_7_Gate_EP0_PP1 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_7_Gate_EP1_PP1 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_7_Gate_EP2_PP1 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_7_Gate_EP3_PP1 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_7_Expert_0_EP0_TP0_PP1 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_0_EP0_TP1_PP1 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_1_EP0_TP0_PP1 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_1_EP0_TP1_PP1 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_2_EP0_TP0_PP1 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_2_EP0_TP1_PP1 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_3_EP0_TP0_PP1 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_3_EP0_TP1_PP1 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_4_EP1_TP0_PP1 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_4_EP1_TP1_PP1 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_5_EP1_TP0_PP1 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_5_EP1_TP1_PP1 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_6_EP1_TP0_PP1 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_6_EP1_TP1_PP1 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_7_EP1_TP0_PP1 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_7_EP1_TP1_PP1 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_8_EP2_TP0_PP1 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_8_EP2_TP1_PP1 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_9_EP2_TP0_PP1 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_9_EP2_TP1_PP1 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_10_EP2_TP0_PP1 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_10_EP2_TP1_PP1 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_11_EP2_TP0_PP1 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_11_EP2_TP1_PP1 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_12_EP3_TP0_PP1 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_12_EP3_TP1_PP1 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_13_EP3_TP0_PP1 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_13_EP3_TP1_PP1 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_14_EP3_TP0_PP1 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_14_EP3_TP1_PP1 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_15_EP3_TP0_PP1 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_Expert_15_EP3_TP1_PP1 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_7_A2A_Dispatch_PP1 [label="All-to-All Dispatch\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_7_A2A_Combine_PP1 [label="All-to-All Combine\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_7_MLP_Out_TP0_PP1 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_7_MLP_Out_TP1_PP1 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_7_MLP_AllReduce_PP1 [label="All-Reduce MLP Output\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_7_LayerNorm_PP1 [label="LayerNorm\nPP Stage 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
	}
	subgraph cluster_PP_Stage_2 {
		fillcolor=lightgray fontname="Arial Bold" label="Pipeline Stage 2 (Layers 8-11)" style="rounded,filled"
		Layer_8_QKV_TP0_PP2 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_8_QKV_TP1_PP2 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_8_QKV_AllReduce_PP2 [label="All-Reduce QKV\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_8_Attention_TP0_PP2 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_8_Attention_TP1_PP2 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_8_AttnOut_TP0_PP2 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_8_AttnOut_TP1_PP2 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_8_AttnOut_AllReduce_PP2 [label="All-Reduce Attn Output\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_8_Gate_EP0_PP2 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_8_Gate_EP1_PP2 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_8_Gate_EP2_PP2 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_8_Gate_EP3_PP2 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_8_Expert_0_EP0_TP0_PP2 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_0_EP0_TP1_PP2 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_1_EP0_TP0_PP2 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_1_EP0_TP1_PP2 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_2_EP0_TP0_PP2 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_2_EP0_TP1_PP2 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_3_EP0_TP0_PP2 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_3_EP0_TP1_PP2 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_4_EP1_TP0_PP2 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_4_EP1_TP1_PP2 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_5_EP1_TP0_PP2 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_5_EP1_TP1_PP2 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_6_EP1_TP0_PP2 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_6_EP1_TP1_PP2 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_7_EP1_TP0_PP2 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_7_EP1_TP1_PP2 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_8_EP2_TP0_PP2 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_8_EP2_TP1_PP2 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_9_EP2_TP0_PP2 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_9_EP2_TP1_PP2 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_10_EP2_TP0_PP2 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_10_EP2_TP1_PP2 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_11_EP2_TP0_PP2 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_11_EP2_TP1_PP2 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_12_EP3_TP0_PP2 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_12_EP3_TP1_PP2 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_13_EP3_TP0_PP2 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_13_EP3_TP1_PP2 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_14_EP3_TP0_PP2 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_14_EP3_TP1_PP2 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_15_EP3_TP0_PP2 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_Expert_15_EP3_TP1_PP2 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_8_A2A_Dispatch_PP2 [label="All-to-All Dispatch\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_8_A2A_Combine_PP2 [label="All-to-All Combine\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_8_MLP_Out_TP0_PP2 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_8_MLP_Out_TP1_PP2 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_8_MLP_AllReduce_PP2 [label="All-Reduce MLP Output\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_8_LayerNorm_PP2 [label="LayerNorm\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_9_QKV_TP0_PP2 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_9_QKV_TP1_PP2 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_9_QKV_AllReduce_PP2 [label="All-Reduce QKV\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_9_Attention_TP0_PP2 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_9_Attention_TP1_PP2 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_9_AttnOut_TP0_PP2 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_9_AttnOut_TP1_PP2 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_9_AttnOut_AllReduce_PP2 [label="All-Reduce Attn Output\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_9_Gate_EP0_PP2 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_9_Gate_EP1_PP2 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_9_Gate_EP2_PP2 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_9_Gate_EP3_PP2 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_9_Expert_0_EP0_TP0_PP2 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_0_EP0_TP1_PP2 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_1_EP0_TP0_PP2 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_1_EP0_TP1_PP2 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_2_EP0_TP0_PP2 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_2_EP0_TP1_PP2 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_3_EP0_TP0_PP2 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_3_EP0_TP1_PP2 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_4_EP1_TP0_PP2 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_4_EP1_TP1_PP2 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_5_EP1_TP0_PP2 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_5_EP1_TP1_PP2 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_6_EP1_TP0_PP2 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_6_EP1_TP1_PP2 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_7_EP1_TP0_PP2 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_7_EP1_TP1_PP2 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_8_EP2_TP0_PP2 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_8_EP2_TP1_PP2 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_9_EP2_TP0_PP2 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_9_EP2_TP1_PP2 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_10_EP2_TP0_PP2 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_10_EP2_TP1_PP2 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_11_EP2_TP0_PP2 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_11_EP2_TP1_PP2 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_12_EP3_TP0_PP2 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_12_EP3_TP1_PP2 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_13_EP3_TP0_PP2 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_13_EP3_TP1_PP2 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_14_EP3_TP0_PP2 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_14_EP3_TP1_PP2 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_15_EP3_TP0_PP2 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_Expert_15_EP3_TP1_PP2 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_9_A2A_Dispatch_PP2 [label="All-to-All Dispatch\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_9_A2A_Combine_PP2 [label="All-to-All Combine\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_9_MLP_Out_TP0_PP2 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_9_MLP_Out_TP1_PP2 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_9_MLP_AllReduce_PP2 [label="All-Reduce MLP Output\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_9_LayerNorm_PP2 [label="LayerNorm\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_10_QKV_TP0_PP2 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_10_QKV_TP1_PP2 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_10_QKV_AllReduce_PP2 [label="All-Reduce QKV\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_10_Attention_TP0_PP2 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_10_Attention_TP1_PP2 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_10_AttnOut_TP0_PP2 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_10_AttnOut_TP1_PP2 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_10_AttnOut_AllReduce_PP2 [label="All-Reduce Attn Output\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_10_Gate_EP0_PP2 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_10_Gate_EP1_PP2 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_10_Gate_EP2_PP2 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_10_Gate_EP3_PP2 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_10_Expert_0_EP0_TP0_PP2 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_0_EP0_TP1_PP2 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_1_EP0_TP0_PP2 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_1_EP0_TP1_PP2 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_2_EP0_TP0_PP2 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_2_EP0_TP1_PP2 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_3_EP0_TP0_PP2 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_3_EP0_TP1_PP2 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_4_EP1_TP0_PP2 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_4_EP1_TP1_PP2 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_5_EP1_TP0_PP2 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_5_EP1_TP1_PP2 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_6_EP1_TP0_PP2 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_6_EP1_TP1_PP2 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_7_EP1_TP0_PP2 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_7_EP1_TP1_PP2 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_8_EP2_TP0_PP2 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_8_EP2_TP1_PP2 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_9_EP2_TP0_PP2 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_9_EP2_TP1_PP2 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_10_EP2_TP0_PP2 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_10_EP2_TP1_PP2 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_11_EP2_TP0_PP2 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_11_EP2_TP1_PP2 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_12_EP3_TP0_PP2 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_12_EP3_TP1_PP2 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_13_EP3_TP0_PP2 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_13_EP3_TP1_PP2 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_14_EP3_TP0_PP2 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_14_EP3_TP1_PP2 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_15_EP3_TP0_PP2 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_Expert_15_EP3_TP1_PP2 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_10_A2A_Dispatch_PP2 [label="All-to-All Dispatch\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_10_A2A_Combine_PP2 [label="All-to-All Combine\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_10_MLP_Out_TP0_PP2 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_10_MLP_Out_TP1_PP2 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_10_MLP_AllReduce_PP2 [label="All-Reduce MLP Output\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_10_LayerNorm_PP2 [label="LayerNorm\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_11_QKV_TP0_PP2 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_11_QKV_TP1_PP2 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_11_QKV_AllReduce_PP2 [label="All-Reduce QKV\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_11_Attention_TP0_PP2 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_11_Attention_TP1_PP2 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_11_AttnOut_TP0_PP2 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_11_AttnOut_TP1_PP2 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_11_AttnOut_AllReduce_PP2 [label="All-Reduce Attn Output\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_11_Gate_EP0_PP2 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_11_Gate_EP1_PP2 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_11_Gate_EP2_PP2 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_11_Gate_EP3_PP2 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_11_Expert_0_EP0_TP0_PP2 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_0_EP0_TP1_PP2 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_1_EP0_TP0_PP2 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_1_EP0_TP1_PP2 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_2_EP0_TP0_PP2 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_2_EP0_TP1_PP2 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_3_EP0_TP0_PP2 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_3_EP0_TP1_PP2 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_4_EP1_TP0_PP2 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_4_EP1_TP1_PP2 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_5_EP1_TP0_PP2 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_5_EP1_TP1_PP2 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_6_EP1_TP0_PP2 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_6_EP1_TP1_PP2 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_7_EP1_TP0_PP2 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_7_EP1_TP1_PP2 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_8_EP2_TP0_PP2 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_8_EP2_TP1_PP2 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_9_EP2_TP0_PP2 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_9_EP2_TP1_PP2 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_10_EP2_TP0_PP2 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_10_EP2_TP1_PP2 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_11_EP2_TP0_PP2 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_11_EP2_TP1_PP2 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_12_EP3_TP0_PP2 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_12_EP3_TP1_PP2 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_13_EP3_TP0_PP2 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_13_EP3_TP1_PP2 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_14_EP3_TP0_PP2 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_14_EP3_TP1_PP2 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_15_EP3_TP0_PP2 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_Expert_15_EP3_TP1_PP2 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_11_A2A_Dispatch_PP2 [label="All-to-All Dispatch\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_11_A2A_Combine_PP2 [label="All-to-All Combine\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_11_MLP_Out_TP0_PP2 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_11_MLP_Out_TP1_PP2 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_11_MLP_AllReduce_PP2 [label="All-Reduce MLP Output\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_11_LayerNorm_PP2 [label="LayerNorm\nPP Stage 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
	}
	subgraph cluster_PP_Stage_3 {
		fillcolor=lightgray fontname="Arial Bold" label="Pipeline Stage 3 (Layers 12-15)" style="rounded,filled"
		Layer_12_QKV_TP0_PP3 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_12_QKV_TP1_PP3 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_12_QKV_AllReduce_PP3 [label="All-Reduce QKV\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_12_Attention_TP0_PP3 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_12_Attention_TP1_PP3 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_12_AttnOut_TP0_PP3 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_12_AttnOut_TP1_PP3 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_12_AttnOut_AllReduce_PP3 [label="All-Reduce Attn Output\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_12_Gate_EP0_PP3 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_12_Gate_EP1_PP3 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_12_Gate_EP2_PP3 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_12_Gate_EP3_PP3 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_12_Expert_0_EP0_TP0_PP3 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_0_EP0_TP1_PP3 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_1_EP0_TP0_PP3 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_1_EP0_TP1_PP3 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_2_EP0_TP0_PP3 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_2_EP0_TP1_PP3 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_3_EP0_TP0_PP3 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_3_EP0_TP1_PP3 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_4_EP1_TP0_PP3 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_4_EP1_TP1_PP3 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_5_EP1_TP0_PP3 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_5_EP1_TP1_PP3 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_6_EP1_TP0_PP3 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_6_EP1_TP1_PP3 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_7_EP1_TP0_PP3 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_7_EP1_TP1_PP3 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_8_EP2_TP0_PP3 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_8_EP2_TP1_PP3 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_9_EP2_TP0_PP3 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_9_EP2_TP1_PP3 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_10_EP2_TP0_PP3 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_10_EP2_TP1_PP3 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_11_EP2_TP0_PP3 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_11_EP2_TP1_PP3 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_12_EP3_TP0_PP3 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_12_EP3_TP1_PP3 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_13_EP3_TP0_PP3 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_13_EP3_TP1_PP3 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_14_EP3_TP0_PP3 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_14_EP3_TP1_PP3 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_15_EP3_TP0_PP3 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_Expert_15_EP3_TP1_PP3 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_12_A2A_Dispatch_PP3 [label="All-to-All Dispatch\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_12_A2A_Combine_PP3 [label="All-to-All Combine\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_12_MLP_Out_TP0_PP3 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_12_MLP_Out_TP1_PP3 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_12_MLP_AllReduce_PP3 [label="All-Reduce MLP Output\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_12_LayerNorm_PP3 [label="LayerNorm\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_13_QKV_TP0_PP3 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_13_QKV_TP1_PP3 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_13_QKV_AllReduce_PP3 [label="All-Reduce QKV\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_13_Attention_TP0_PP3 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_13_Attention_TP1_PP3 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_13_AttnOut_TP0_PP3 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_13_AttnOut_TP1_PP3 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_13_AttnOut_AllReduce_PP3 [label="All-Reduce Attn Output\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_13_Gate_EP0_PP3 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_13_Gate_EP1_PP3 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_13_Gate_EP2_PP3 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_13_Gate_EP3_PP3 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_13_Expert_0_EP0_TP0_PP3 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_0_EP0_TP1_PP3 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_1_EP0_TP0_PP3 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_1_EP0_TP1_PP3 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_2_EP0_TP0_PP3 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_2_EP0_TP1_PP3 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_3_EP0_TP0_PP3 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_3_EP0_TP1_PP3 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_4_EP1_TP0_PP3 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_4_EP1_TP1_PP3 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_5_EP1_TP0_PP3 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_5_EP1_TP1_PP3 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_6_EP1_TP0_PP3 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_6_EP1_TP1_PP3 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_7_EP1_TP0_PP3 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_7_EP1_TP1_PP3 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_8_EP2_TP0_PP3 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_8_EP2_TP1_PP3 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_9_EP2_TP0_PP3 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_9_EP2_TP1_PP3 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_10_EP2_TP0_PP3 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_10_EP2_TP1_PP3 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_11_EP2_TP0_PP3 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_11_EP2_TP1_PP3 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_12_EP3_TP0_PP3 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_12_EP3_TP1_PP3 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_13_EP3_TP0_PP3 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_13_EP3_TP1_PP3 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_14_EP3_TP0_PP3 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_14_EP3_TP1_PP3 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_15_EP3_TP0_PP3 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_Expert_15_EP3_TP1_PP3 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_13_A2A_Dispatch_PP3 [label="All-to-All Dispatch\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_13_A2A_Combine_PP3 [label="All-to-All Combine\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_13_MLP_Out_TP0_PP3 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_13_MLP_Out_TP1_PP3 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_13_MLP_AllReduce_PP3 [label="All-Reduce MLP Output\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_13_LayerNorm_PP3 [label="LayerNorm\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_14_QKV_TP0_PP3 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_14_QKV_TP1_PP3 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_14_QKV_AllReduce_PP3 [label="All-Reduce QKV\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_14_Attention_TP0_PP3 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_14_Attention_TP1_PP3 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_14_AttnOut_TP0_PP3 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_14_AttnOut_TP1_PP3 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_14_AttnOut_AllReduce_PP3 [label="All-Reduce Attn Output\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_14_Gate_EP0_PP3 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_14_Gate_EP1_PP3 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_14_Gate_EP2_PP3 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_14_Gate_EP3_PP3 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_14_Expert_0_EP0_TP0_PP3 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_0_EP0_TP1_PP3 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_1_EP0_TP0_PP3 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_1_EP0_TP1_PP3 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_2_EP0_TP0_PP3 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_2_EP0_TP1_PP3 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_3_EP0_TP0_PP3 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_3_EP0_TP1_PP3 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_4_EP1_TP0_PP3 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_4_EP1_TP1_PP3 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_5_EP1_TP0_PP3 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_5_EP1_TP1_PP3 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_6_EP1_TP0_PP3 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_6_EP1_TP1_PP3 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_7_EP1_TP0_PP3 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_7_EP1_TP1_PP3 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_8_EP2_TP0_PP3 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_8_EP2_TP1_PP3 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_9_EP2_TP0_PP3 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_9_EP2_TP1_PP3 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_10_EP2_TP0_PP3 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_10_EP2_TP1_PP3 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_11_EP2_TP0_PP3 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_11_EP2_TP1_PP3 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_12_EP3_TP0_PP3 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_12_EP3_TP1_PP3 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_13_EP3_TP0_PP3 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_13_EP3_TP1_PP3 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_14_EP3_TP0_PP3 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_14_EP3_TP1_PP3 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_15_EP3_TP0_PP3 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_Expert_15_EP3_TP1_PP3 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_14_A2A_Dispatch_PP3 [label="All-to-All Dispatch\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_14_A2A_Combine_PP3 [label="All-to-All Combine\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_14_MLP_Out_TP0_PP3 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_14_MLP_Out_TP1_PP3 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_14_MLP_AllReduce_PP3 [label="All-Reduce MLP Output\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_14_LayerNorm_PP3 [label="LayerNorm\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
		Layer_15_QKV_TP0_PP3 [label="QKV Linear\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_15_QKV_TP1_PP3 [label="QKV Linear\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_15_QKV_AllReduce_PP3 [label="All-Reduce QKV\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, heads=16, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=16, d_k=32]" fillcolor=yellow shape=ellipse]
		Layer_15_Attention_TP0_PP3 [label="Softmax Attention\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_15_Attention_TP1_PP3 [label="Softmax Attention\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, heads=8, d_k=32]" fillcolor=lightblue]
		Layer_15_AttnOut_TP0_PP3 [label="Attention Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_15_AttnOut_TP1_PP3 [label="Attention Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, heads=8, d_k=32]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_15_AttnOut_AllReduce_PP3 [label="All-Reduce Attn Output\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_15_Gate_EP0_PP3 [label="MoE Gate/Router\nEP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_15_Gate_EP1_PP3 [label="MoE Gate/Router\nEP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_15_Gate_EP2_PP3 [label="MoE Gate/Router\nEP Rank 2\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_15_Gate_EP3_PP3 [label="MoE Gate/Router\nEP Rank 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, expert_ids=2]" fillcolor=orange shape=parallelogram style=dashed]
		Layer_15_Expert_0_EP0_TP0_PP3 [label="Expert 0\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_0_EP0_TP1_PP3 [label="Expert 0\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_1_EP0_TP0_PP3 [label="Expert 1\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_1_EP0_TP1_PP3 [label="Expert 1\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_2_EP0_TP0_PP3 [label="Expert 2\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_2_EP0_TP1_PP3 [label="Expert 2\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_3_EP0_TP0_PP3 [label="Expert 3\nEP 0, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_3_EP0_TP1_PP3 [label="Expert 3\nEP 0, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_4_EP1_TP0_PP3 [label="Expert 4\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_4_EP1_TP1_PP3 [label="Expert 4\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_5_EP1_TP0_PP3 [label="Expert 5\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_5_EP1_TP1_PP3 [label="Expert 5\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_6_EP1_TP0_PP3 [label="Expert 6\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_6_EP1_TP1_PP3 [label="Expert 6\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_7_EP1_TP0_PP3 [label="Expert 7\nEP 1, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_7_EP1_TP1_PP3 [label="Expert 7\nEP 1, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_8_EP2_TP0_PP3 [label="Expert 8\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_8_EP2_TP1_PP3 [label="Expert 8\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_9_EP2_TP0_PP3 [label="Expert 9\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_9_EP2_TP1_PP3 [label="Expert 9\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_10_EP2_TP0_PP3 [label="Expert 10\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_10_EP2_TP1_PP3 [label="Expert 10\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_11_EP2_TP0_PP3 [label="Expert 11\nEP 2, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_11_EP2_TP1_PP3 [label="Expert 11\nEP 2, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_12_EP3_TP0_PP3 [label="Expert 12\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_12_EP3_TP1_PP3 [label="Expert 12\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_13_EP3_TP0_PP3 [label="Expert 13\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_13_EP3_TP1_PP3 [label="Expert 13\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_14_EP3_TP0_PP3 [label="Expert 14\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_14_EP3_TP1_PP3 [label="Expert 14\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_15_EP3_TP0_PP3 [label="Expert 15\nEP 3, TP 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_Expert_15_EP3_TP1_PP3 [label="Expert 15\nEP 3, TP 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightcoral]
		Layer_15_A2A_Dispatch_PP3 [label="All-to-All Dispatch\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_15_A2A_Combine_PP3 [label="All-to-All Combine\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_15_MLP_Out_TP0_PP3 [label="MLP Output Proj\nTP Rank 0\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_15_MLP_Out_TP1_PP3 [label="MLP Output Proj\nTP Rank 1\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=256]" fillcolor=lightblue]
		Layer_15_MLP_AllReduce_PP3 [label="All-Reduce MLP Output\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=yellow shape=ellipse]
		Layer_15_LayerNorm_PP3 [label="LayerNorm\nPP Stage 3\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen]
	}
	input -> Layer_0_QKV_TP0_PP0
	Layer_0_QKV_TP0_PP0 -> Layer_0_QKV_AllReduce_PP0
	Layer_0_QKV_AllReduce_PP0 -> Layer_0_Attention_TP0_PP0
	Layer_0_Attention_TP0_PP0 -> Layer_0_AttnOut_TP0_PP0
	Layer_0_AttnOut_TP0_PP0 -> Layer_0_AttnOut_AllReduce_PP0
	Layer_0_QKV_TP1_PP0 -> Layer_0_QKV_AllReduce_PP0
	Layer_0_QKV_AllReduce_PP0 -> Layer_0_Attention_TP1_PP0
	Layer_0_Attention_TP1_PP0 -> Layer_0_AttnOut_TP1_PP0
	Layer_0_AttnOut_TP1_PP0 -> Layer_0_AttnOut_AllReduce_PP0
	Layer_0_AttnOut_AllReduce_PP0 -> Layer_0_A2A_Dispatch_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_0_EP0_TP0_PP0
	Layer_0_Expert_0_EP0_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_0_EP0_TP1_PP0
	Layer_0_Expert_0_EP0_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_1_EP0_TP0_PP0
	Layer_0_Expert_1_EP0_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_1_EP0_TP1_PP0
	Layer_0_Expert_1_EP0_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_2_EP0_TP0_PP0
	Layer_0_Expert_2_EP0_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_2_EP0_TP1_PP0
	Layer_0_Expert_2_EP0_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_3_EP0_TP0_PP0
	Layer_0_Expert_3_EP0_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_3_EP0_TP1_PP0
	Layer_0_Expert_3_EP0_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_4_EP1_TP0_PP0
	Layer_0_Expert_4_EP1_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_4_EP1_TP1_PP0
	Layer_0_Expert_4_EP1_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_5_EP1_TP0_PP0
	Layer_0_Expert_5_EP1_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_5_EP1_TP1_PP0
	Layer_0_Expert_5_EP1_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_6_EP1_TP0_PP0
	Layer_0_Expert_6_EP1_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_6_EP1_TP1_PP0
	Layer_0_Expert_6_EP1_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_7_EP1_TP0_PP0
	Layer_0_Expert_7_EP1_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_7_EP1_TP1_PP0
	Layer_0_Expert_7_EP1_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_8_EP2_TP0_PP0
	Layer_0_Expert_8_EP2_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_8_EP2_TP1_PP0
	Layer_0_Expert_8_EP2_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_9_EP2_TP0_PP0
	Layer_0_Expert_9_EP2_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_9_EP2_TP1_PP0
	Layer_0_Expert_9_EP2_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_10_EP2_TP0_PP0
	Layer_0_Expert_10_EP2_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_10_EP2_TP1_PP0
	Layer_0_Expert_10_EP2_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_11_EP2_TP0_PP0
	Layer_0_Expert_11_EP2_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_11_EP2_TP1_PP0
	Layer_0_Expert_11_EP2_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_12_EP3_TP0_PP0
	Layer_0_Expert_12_EP3_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_12_EP3_TP1_PP0
	Layer_0_Expert_12_EP3_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_13_EP3_TP0_PP0
	Layer_0_Expert_13_EP3_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_13_EP3_TP1_PP0
	Layer_0_Expert_13_EP3_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_14_EP3_TP0_PP0
	Layer_0_Expert_14_EP3_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_14_EP3_TP1_PP0
	Layer_0_Expert_14_EP3_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_15_EP3_TP0_PP0
	Layer_0_Expert_15_EP3_TP0_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Dispatch_PP0 -> Layer_0_Expert_15_EP3_TP1_PP0
	Layer_0_Expert_15_EP3_TP1_PP0 -> Layer_0_A2A_Combine_PP0
	Layer_0_A2A_Combine_PP0 -> Layer_0_MLP_Out_TP0_PP0
	Layer_0_MLP_Out_TP0_PP0 -> Layer_0_MLP_AllReduce_PP0
	Layer_0_A2A_Combine_PP0 -> Layer_0_MLP_Out_TP1_PP0
	Layer_0_MLP_Out_TP1_PP0 -> Layer_0_MLP_AllReduce_PP0
	Layer_0_MLP_AllReduce_PP0 -> Layer_0_LayerNorm_PP0
	Layer_0_LayerNorm_PP0 -> Layer_1_QKV_TP0_PP0
	Layer_1_QKV_TP0_PP0 -> Layer_1_QKV_AllReduce_PP0
	Layer_1_QKV_AllReduce_PP0 -> Layer_1_Attention_TP0_PP0
	Layer_1_Attention_TP0_PP0 -> Layer_1_AttnOut_TP0_PP0
	Layer_1_AttnOut_TP0_PP0 -> Layer_1_AttnOut_AllReduce_PP0
	Layer_1_QKV_TP1_PP0 -> Layer_1_QKV_AllReduce_PP0
	Layer_1_QKV_AllReduce_PP0 -> Layer_1_Attention_TP1_PP0
	Layer_1_Attention_TP1_PP0 -> Layer_1_AttnOut_TP1_PP0
	Layer_1_AttnOut_TP1_PP0 -> Layer_1_AttnOut_AllReduce_PP0
	Layer_1_AttnOut_AllReduce_PP0 -> Layer_1_A2A_Dispatch_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_0_EP0_TP0_PP0
	Layer_1_Expert_0_EP0_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_0_EP0_TP1_PP0
	Layer_1_Expert_0_EP0_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_1_EP0_TP0_PP0
	Layer_1_Expert_1_EP0_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_1_EP0_TP1_PP0
	Layer_1_Expert_1_EP0_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_2_EP0_TP0_PP0
	Layer_1_Expert_2_EP0_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_2_EP0_TP1_PP0
	Layer_1_Expert_2_EP0_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_3_EP0_TP0_PP0
	Layer_1_Expert_3_EP0_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_3_EP0_TP1_PP0
	Layer_1_Expert_3_EP0_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_4_EP1_TP0_PP0
	Layer_1_Expert_4_EP1_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_4_EP1_TP1_PP0
	Layer_1_Expert_4_EP1_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_5_EP1_TP0_PP0
	Layer_1_Expert_5_EP1_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_5_EP1_TP1_PP0
	Layer_1_Expert_5_EP1_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_6_EP1_TP0_PP0
	Layer_1_Expert_6_EP1_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_6_EP1_TP1_PP0
	Layer_1_Expert_6_EP1_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_7_EP1_TP0_PP0
	Layer_1_Expert_7_EP1_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_7_EP1_TP1_PP0
	Layer_1_Expert_7_EP1_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_8_EP2_TP0_PP0
	Layer_1_Expert_8_EP2_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_8_EP2_TP1_PP0
	Layer_1_Expert_8_EP2_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_9_EP2_TP0_PP0
	Layer_1_Expert_9_EP2_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_9_EP2_TP1_PP0
	Layer_1_Expert_9_EP2_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_10_EP2_TP0_PP0
	Layer_1_Expert_10_EP2_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_10_EP2_TP1_PP0
	Layer_1_Expert_10_EP2_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_11_EP2_TP0_PP0
	Layer_1_Expert_11_EP2_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_11_EP2_TP1_PP0
	Layer_1_Expert_11_EP2_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_12_EP3_TP0_PP0
	Layer_1_Expert_12_EP3_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_12_EP3_TP1_PP0
	Layer_1_Expert_12_EP3_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_13_EP3_TP0_PP0
	Layer_1_Expert_13_EP3_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_13_EP3_TP1_PP0
	Layer_1_Expert_13_EP3_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_14_EP3_TP0_PP0
	Layer_1_Expert_14_EP3_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_14_EP3_TP1_PP0
	Layer_1_Expert_14_EP3_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_15_EP3_TP0_PP0
	Layer_1_Expert_15_EP3_TP0_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Dispatch_PP0 -> Layer_1_Expert_15_EP3_TP1_PP0
	Layer_1_Expert_15_EP3_TP1_PP0 -> Layer_1_A2A_Combine_PP0
	Layer_1_A2A_Combine_PP0 -> Layer_1_MLP_Out_TP0_PP0
	Layer_1_MLP_Out_TP0_PP0 -> Layer_1_MLP_AllReduce_PP0
	Layer_1_A2A_Combine_PP0 -> Layer_1_MLP_Out_TP1_PP0
	Layer_1_MLP_Out_TP1_PP0 -> Layer_1_MLP_AllReduce_PP0
	Layer_1_MLP_AllReduce_PP0 -> Layer_1_LayerNorm_PP0
	Layer_1_LayerNorm_PP0 -> Layer_2_QKV_TP0_PP0
	Layer_2_QKV_TP0_PP0 -> Layer_2_QKV_AllReduce_PP0
	Layer_2_QKV_AllReduce_PP0 -> Layer_2_Attention_TP0_PP0
	Layer_2_Attention_TP0_PP0 -> Layer_2_AttnOut_TP0_PP0
	Layer_2_AttnOut_TP0_PP0 -> Layer_2_AttnOut_AllReduce_PP0
	Layer_2_QKV_TP1_PP0 -> Layer_2_QKV_AllReduce_PP0
	Layer_2_QKV_AllReduce_PP0 -> Layer_2_Attention_TP1_PP0
	Layer_2_Attention_TP1_PP0 -> Layer_2_AttnOut_TP1_PP0
	Layer_2_AttnOut_TP1_PP0 -> Layer_2_AttnOut_AllReduce_PP0
	Layer_2_AttnOut_AllReduce_PP0 -> Layer_2_A2A_Dispatch_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_0_EP0_TP0_PP0
	Layer_2_Expert_0_EP0_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_0_EP0_TP1_PP0
	Layer_2_Expert_0_EP0_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_1_EP0_TP0_PP0
	Layer_2_Expert_1_EP0_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_1_EP0_TP1_PP0
	Layer_2_Expert_1_EP0_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_2_EP0_TP0_PP0
	Layer_2_Expert_2_EP0_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_2_EP0_TP1_PP0
	Layer_2_Expert_2_EP0_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_3_EP0_TP0_PP0
	Layer_2_Expert_3_EP0_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_3_EP0_TP1_PP0
	Layer_2_Expert_3_EP0_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_4_EP1_TP0_PP0
	Layer_2_Expert_4_EP1_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_4_EP1_TP1_PP0
	Layer_2_Expert_4_EP1_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_5_EP1_TP0_PP0
	Layer_2_Expert_5_EP1_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_5_EP1_TP1_PP0
	Layer_2_Expert_5_EP1_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_6_EP1_TP0_PP0
	Layer_2_Expert_6_EP1_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_6_EP1_TP1_PP0
	Layer_2_Expert_6_EP1_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_7_EP1_TP0_PP0
	Layer_2_Expert_7_EP1_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_7_EP1_TP1_PP0
	Layer_2_Expert_7_EP1_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_8_EP2_TP0_PP0
	Layer_2_Expert_8_EP2_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_8_EP2_TP1_PP0
	Layer_2_Expert_8_EP2_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_9_EP2_TP0_PP0
	Layer_2_Expert_9_EP2_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_9_EP2_TP1_PP0
	Layer_2_Expert_9_EP2_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_10_EP2_TP0_PP0
	Layer_2_Expert_10_EP2_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_10_EP2_TP1_PP0
	Layer_2_Expert_10_EP2_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_11_EP2_TP0_PP0
	Layer_2_Expert_11_EP2_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_11_EP2_TP1_PP0
	Layer_2_Expert_11_EP2_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_12_EP3_TP0_PP0
	Layer_2_Expert_12_EP3_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_12_EP3_TP1_PP0
	Layer_2_Expert_12_EP3_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_13_EP3_TP0_PP0
	Layer_2_Expert_13_EP3_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_13_EP3_TP1_PP0
	Layer_2_Expert_13_EP3_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_14_EP3_TP0_PP0
	Layer_2_Expert_14_EP3_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_14_EP3_TP1_PP0
	Layer_2_Expert_14_EP3_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_15_EP3_TP0_PP0
	Layer_2_Expert_15_EP3_TP0_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Dispatch_PP0 -> Layer_2_Expert_15_EP3_TP1_PP0
	Layer_2_Expert_15_EP3_TP1_PP0 -> Layer_2_A2A_Combine_PP0
	Layer_2_A2A_Combine_PP0 -> Layer_2_MLP_Out_TP0_PP0
	Layer_2_MLP_Out_TP0_PP0 -> Layer_2_MLP_AllReduce_PP0
	Layer_2_A2A_Combine_PP0 -> Layer_2_MLP_Out_TP1_PP0
	Layer_2_MLP_Out_TP1_PP0 -> Layer_2_MLP_AllReduce_PP0
	Layer_2_MLP_AllReduce_PP0 -> Layer_2_LayerNorm_PP0
	Layer_2_LayerNorm_PP0 -> Layer_3_QKV_TP0_PP0
	Layer_3_QKV_TP0_PP0 -> Layer_3_QKV_AllReduce_PP0
	Layer_3_QKV_AllReduce_PP0 -> Layer_3_Attention_TP0_PP0
	Layer_3_Attention_TP0_PP0 -> Layer_3_AttnOut_TP0_PP0
	Layer_3_AttnOut_TP0_PP0 -> Layer_3_AttnOut_AllReduce_PP0
	Layer_3_QKV_TP1_PP0 -> Layer_3_QKV_AllReduce_PP0
	Layer_3_QKV_AllReduce_PP0 -> Layer_3_Attention_TP1_PP0
	Layer_3_Attention_TP1_PP0 -> Layer_3_AttnOut_TP1_PP0
	Layer_3_AttnOut_TP1_PP0 -> Layer_3_AttnOut_AllReduce_PP0
	Layer_3_AttnOut_AllReduce_PP0 -> Layer_3_A2A_Dispatch_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_0_EP0_TP0_PP0
	Layer_3_Expert_0_EP0_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_0_EP0_TP1_PP0
	Layer_3_Expert_0_EP0_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_1_EP0_TP0_PP0
	Layer_3_Expert_1_EP0_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_1_EP0_TP1_PP0
	Layer_3_Expert_1_EP0_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_2_EP0_TP0_PP0
	Layer_3_Expert_2_EP0_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_2_EP0_TP1_PP0
	Layer_3_Expert_2_EP0_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_3_EP0_TP0_PP0
	Layer_3_Expert_3_EP0_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_3_EP0_TP1_PP0
	Layer_3_Expert_3_EP0_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_4_EP1_TP0_PP0
	Layer_3_Expert_4_EP1_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_4_EP1_TP1_PP0
	Layer_3_Expert_4_EP1_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_5_EP1_TP0_PP0
	Layer_3_Expert_5_EP1_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_5_EP1_TP1_PP0
	Layer_3_Expert_5_EP1_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_6_EP1_TP0_PP0
	Layer_3_Expert_6_EP1_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_6_EP1_TP1_PP0
	Layer_3_Expert_6_EP1_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_7_EP1_TP0_PP0
	Layer_3_Expert_7_EP1_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_7_EP1_TP1_PP0
	Layer_3_Expert_7_EP1_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_8_EP2_TP0_PP0
	Layer_3_Expert_8_EP2_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_8_EP2_TP1_PP0
	Layer_3_Expert_8_EP2_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_9_EP2_TP0_PP0
	Layer_3_Expert_9_EP2_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_9_EP2_TP1_PP0
	Layer_3_Expert_9_EP2_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_10_EP2_TP0_PP0
	Layer_3_Expert_10_EP2_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_10_EP2_TP1_PP0
	Layer_3_Expert_10_EP2_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_11_EP2_TP0_PP0
	Layer_3_Expert_11_EP2_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_11_EP2_TP1_PP0
	Layer_3_Expert_11_EP2_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_12_EP3_TP0_PP0
	Layer_3_Expert_12_EP3_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_12_EP3_TP1_PP0
	Layer_3_Expert_12_EP3_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_13_EP3_TP0_PP0
	Layer_3_Expert_13_EP3_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_13_EP3_TP1_PP0
	Layer_3_Expert_13_EP3_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_14_EP3_TP0_PP0
	Layer_3_Expert_14_EP3_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_14_EP3_TP1_PP0
	Layer_3_Expert_14_EP3_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_15_EP3_TP0_PP0
	Layer_3_Expert_15_EP3_TP0_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Dispatch_PP0 -> Layer_3_Expert_15_EP3_TP1_PP0
	Layer_3_Expert_15_EP3_TP1_PP0 -> Layer_3_A2A_Combine_PP0
	Layer_3_A2A_Combine_PP0 -> Layer_3_MLP_Out_TP0_PP0
	Layer_3_MLP_Out_TP0_PP0 -> Layer_3_MLP_AllReduce_PP0
	Layer_3_A2A_Combine_PP0 -> Layer_3_MLP_Out_TP1_PP0
	Layer_3_MLP_Out_TP1_PP0 -> Layer_3_MLP_AllReduce_PP0
	Layer_3_MLP_AllReduce_PP0 -> Layer_3_LayerNorm_PP0
	Layer_3_LayerNorm_PP0 -> Layer_4_QKV_TP0_PP1
	Layer_4_QKV_TP0_PP1 -> Layer_4_QKV_AllReduce_PP1
	Layer_4_QKV_AllReduce_PP1 -> Layer_4_Attention_TP0_PP1
	Layer_4_Attention_TP0_PP1 -> Layer_4_AttnOut_TP0_PP1
	Layer_4_AttnOut_TP0_PP1 -> Layer_4_AttnOut_AllReduce_PP1
	Layer_4_QKV_TP1_PP1 -> Layer_4_QKV_AllReduce_PP1
	Layer_4_QKV_AllReduce_PP1 -> Layer_4_Attention_TP1_PP1
	Layer_4_Attention_TP1_PP1 -> Layer_4_AttnOut_TP1_PP1
	Layer_4_AttnOut_TP1_PP1 -> Layer_4_AttnOut_AllReduce_PP1
	Layer_4_AttnOut_AllReduce_PP1 -> Layer_4_A2A_Dispatch_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_0_EP0_TP0_PP1
	Layer_4_Expert_0_EP0_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_0_EP0_TP1_PP1
	Layer_4_Expert_0_EP0_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_1_EP0_TP0_PP1
	Layer_4_Expert_1_EP0_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_1_EP0_TP1_PP1
	Layer_4_Expert_1_EP0_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_2_EP0_TP0_PP1
	Layer_4_Expert_2_EP0_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_2_EP0_TP1_PP1
	Layer_4_Expert_2_EP0_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_3_EP0_TP0_PP1
	Layer_4_Expert_3_EP0_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_3_EP0_TP1_PP1
	Layer_4_Expert_3_EP0_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_4_EP1_TP0_PP1
	Layer_4_Expert_4_EP1_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_4_EP1_TP1_PP1
	Layer_4_Expert_4_EP1_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_5_EP1_TP0_PP1
	Layer_4_Expert_5_EP1_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_5_EP1_TP1_PP1
	Layer_4_Expert_5_EP1_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_6_EP1_TP0_PP1
	Layer_4_Expert_6_EP1_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_6_EP1_TP1_PP1
	Layer_4_Expert_6_EP1_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_7_EP1_TP0_PP1
	Layer_4_Expert_7_EP1_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_7_EP1_TP1_PP1
	Layer_4_Expert_7_EP1_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_8_EP2_TP0_PP1
	Layer_4_Expert_8_EP2_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_8_EP2_TP1_PP1
	Layer_4_Expert_8_EP2_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_9_EP2_TP0_PP1
	Layer_4_Expert_9_EP2_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_9_EP2_TP1_PP1
	Layer_4_Expert_9_EP2_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_10_EP2_TP0_PP1
	Layer_4_Expert_10_EP2_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_10_EP2_TP1_PP1
	Layer_4_Expert_10_EP2_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_11_EP2_TP0_PP1
	Layer_4_Expert_11_EP2_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_11_EP2_TP1_PP1
	Layer_4_Expert_11_EP2_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_12_EP3_TP0_PP1
	Layer_4_Expert_12_EP3_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_12_EP3_TP1_PP1
	Layer_4_Expert_12_EP3_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_13_EP3_TP0_PP1
	Layer_4_Expert_13_EP3_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_13_EP3_TP1_PP1
	Layer_4_Expert_13_EP3_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_14_EP3_TP0_PP1
	Layer_4_Expert_14_EP3_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_14_EP3_TP1_PP1
	Layer_4_Expert_14_EP3_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_15_EP3_TP0_PP1
	Layer_4_Expert_15_EP3_TP0_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Dispatch_PP1 -> Layer_4_Expert_15_EP3_TP1_PP1
	Layer_4_Expert_15_EP3_TP1_PP1 -> Layer_4_A2A_Combine_PP1
	Layer_4_A2A_Combine_PP1 -> Layer_4_MLP_Out_TP0_PP1
	Layer_4_MLP_Out_TP0_PP1 -> Layer_4_MLP_AllReduce_PP1
	Layer_4_A2A_Combine_PP1 -> Layer_4_MLP_Out_TP1_PP1
	Layer_4_MLP_Out_TP1_PP1 -> Layer_4_MLP_AllReduce_PP1
	Layer_4_MLP_AllReduce_PP1 -> Layer_4_LayerNorm_PP1
	Layer_4_LayerNorm_PP1 -> Layer_5_QKV_TP0_PP1
	Layer_5_QKV_TP0_PP1 -> Layer_5_QKV_AllReduce_PP1
	Layer_5_QKV_AllReduce_PP1 -> Layer_5_Attention_TP0_PP1
	Layer_5_Attention_TP0_PP1 -> Layer_5_AttnOut_TP0_PP1
	Layer_5_AttnOut_TP0_PP1 -> Layer_5_AttnOut_AllReduce_PP1
	Layer_5_QKV_TP1_PP1 -> Layer_5_QKV_AllReduce_PP1
	Layer_5_QKV_AllReduce_PP1 -> Layer_5_Attention_TP1_PP1
	Layer_5_Attention_TP1_PP1 -> Layer_5_AttnOut_TP1_PP1
	Layer_5_AttnOut_TP1_PP1 -> Layer_5_AttnOut_AllReduce_PP1
	Layer_5_AttnOut_AllReduce_PP1 -> Layer_5_A2A_Dispatch_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_0_EP0_TP0_PP1
	Layer_5_Expert_0_EP0_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_0_EP0_TP1_PP1
	Layer_5_Expert_0_EP0_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_1_EP0_TP0_PP1
	Layer_5_Expert_1_EP0_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_1_EP0_TP1_PP1
	Layer_5_Expert_1_EP0_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_2_EP0_TP0_PP1
	Layer_5_Expert_2_EP0_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_2_EP0_TP1_PP1
	Layer_5_Expert_2_EP0_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_3_EP0_TP0_PP1
	Layer_5_Expert_3_EP0_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_3_EP0_TP1_PP1
	Layer_5_Expert_3_EP0_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_4_EP1_TP0_PP1
	Layer_5_Expert_4_EP1_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_4_EP1_TP1_PP1
	Layer_5_Expert_4_EP1_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_5_EP1_TP0_PP1
	Layer_5_Expert_5_EP1_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_5_EP1_TP1_PP1
	Layer_5_Expert_5_EP1_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_6_EP1_TP0_PP1
	Layer_5_Expert_6_EP1_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_6_EP1_TP1_PP1
	Layer_5_Expert_6_EP1_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_7_EP1_TP0_PP1
	Layer_5_Expert_7_EP1_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_7_EP1_TP1_PP1
	Layer_5_Expert_7_EP1_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_8_EP2_TP0_PP1
	Layer_5_Expert_8_EP2_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_8_EP2_TP1_PP1
	Layer_5_Expert_8_EP2_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_9_EP2_TP0_PP1
	Layer_5_Expert_9_EP2_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_9_EP2_TP1_PP1
	Layer_5_Expert_9_EP2_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_10_EP2_TP0_PP1
	Layer_5_Expert_10_EP2_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_10_EP2_TP1_PP1
	Layer_5_Expert_10_EP2_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_11_EP2_TP0_PP1
	Layer_5_Expert_11_EP2_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_11_EP2_TP1_PP1
	Layer_5_Expert_11_EP2_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_12_EP3_TP0_PP1
	Layer_5_Expert_12_EP3_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_12_EP3_TP1_PP1
	Layer_5_Expert_12_EP3_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_13_EP3_TP0_PP1
	Layer_5_Expert_13_EP3_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_13_EP3_TP1_PP1
	Layer_5_Expert_13_EP3_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_14_EP3_TP0_PP1
	Layer_5_Expert_14_EP3_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_14_EP3_TP1_PP1
	Layer_5_Expert_14_EP3_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_15_EP3_TP0_PP1
	Layer_5_Expert_15_EP3_TP0_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Dispatch_PP1 -> Layer_5_Expert_15_EP3_TP1_PP1
	Layer_5_Expert_15_EP3_TP1_PP1 -> Layer_5_A2A_Combine_PP1
	Layer_5_A2A_Combine_PP1 -> Layer_5_MLP_Out_TP0_PP1
	Layer_5_MLP_Out_TP0_PP1 -> Layer_5_MLP_AllReduce_PP1
	Layer_5_A2A_Combine_PP1 -> Layer_5_MLP_Out_TP1_PP1
	Layer_5_MLP_Out_TP1_PP1 -> Layer_5_MLP_AllReduce_PP1
	Layer_5_MLP_AllReduce_PP1 -> Layer_5_LayerNorm_PP1
	Layer_5_LayerNorm_PP1 -> Layer_6_QKV_TP0_PP1
	Layer_6_QKV_TP0_PP1 -> Layer_6_QKV_AllReduce_PP1
	Layer_6_QKV_AllReduce_PP1 -> Layer_6_Attention_TP0_PP1
	Layer_6_Attention_TP0_PP1 -> Layer_6_AttnOut_TP0_PP1
	Layer_6_AttnOut_TP0_PP1 -> Layer_6_AttnOut_AllReduce_PP1
	Layer_6_QKV_TP1_PP1 -> Layer_6_QKV_AllReduce_PP1
	Layer_6_QKV_AllReduce_PP1 -> Layer_6_Attention_TP1_PP1
	Layer_6_Attention_TP1_PP1 -> Layer_6_AttnOut_TP1_PP1
	Layer_6_AttnOut_TP1_PP1 -> Layer_6_AttnOut_AllReduce_PP1
	Layer_6_AttnOut_AllReduce_PP1 -> Layer_6_A2A_Dispatch_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_0_EP0_TP0_PP1
	Layer_6_Expert_0_EP0_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_0_EP0_TP1_PP1
	Layer_6_Expert_0_EP0_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_1_EP0_TP0_PP1
	Layer_6_Expert_1_EP0_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_1_EP0_TP1_PP1
	Layer_6_Expert_1_EP0_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_2_EP0_TP0_PP1
	Layer_6_Expert_2_EP0_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_2_EP0_TP1_PP1
	Layer_6_Expert_2_EP0_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_3_EP0_TP0_PP1
	Layer_6_Expert_3_EP0_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_3_EP0_TP1_PP1
	Layer_6_Expert_3_EP0_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_4_EP1_TP0_PP1
	Layer_6_Expert_4_EP1_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_4_EP1_TP1_PP1
	Layer_6_Expert_4_EP1_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_5_EP1_TP0_PP1
	Layer_6_Expert_5_EP1_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_5_EP1_TP1_PP1
	Layer_6_Expert_5_EP1_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_6_EP1_TP0_PP1
	Layer_6_Expert_6_EP1_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_6_EP1_TP1_PP1
	Layer_6_Expert_6_EP1_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_7_EP1_TP0_PP1
	Layer_6_Expert_7_EP1_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_7_EP1_TP1_PP1
	Layer_6_Expert_7_EP1_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_8_EP2_TP0_PP1
	Layer_6_Expert_8_EP2_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_8_EP2_TP1_PP1
	Layer_6_Expert_8_EP2_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_9_EP2_TP0_PP1
	Layer_6_Expert_9_EP2_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_9_EP2_TP1_PP1
	Layer_6_Expert_9_EP2_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_10_EP2_TP0_PP1
	Layer_6_Expert_10_EP2_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_10_EP2_TP1_PP1
	Layer_6_Expert_10_EP2_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_11_EP2_TP0_PP1
	Layer_6_Expert_11_EP2_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_11_EP2_TP1_PP1
	Layer_6_Expert_11_EP2_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_12_EP3_TP0_PP1
	Layer_6_Expert_12_EP3_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_12_EP3_TP1_PP1
	Layer_6_Expert_12_EP3_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_13_EP3_TP0_PP1
	Layer_6_Expert_13_EP3_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_13_EP3_TP1_PP1
	Layer_6_Expert_13_EP3_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_14_EP3_TP0_PP1
	Layer_6_Expert_14_EP3_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_14_EP3_TP1_PP1
	Layer_6_Expert_14_EP3_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_15_EP3_TP0_PP1
	Layer_6_Expert_15_EP3_TP0_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Dispatch_PP1 -> Layer_6_Expert_15_EP3_TP1_PP1
	Layer_6_Expert_15_EP3_TP1_PP1 -> Layer_6_A2A_Combine_PP1
	Layer_6_A2A_Combine_PP1 -> Layer_6_MLP_Out_TP0_PP1
	Layer_6_MLP_Out_TP0_PP1 -> Layer_6_MLP_AllReduce_PP1
	Layer_6_A2A_Combine_PP1 -> Layer_6_MLP_Out_TP1_PP1
	Layer_6_MLP_Out_TP1_PP1 -> Layer_6_MLP_AllReduce_PP1
	Layer_6_MLP_AllReduce_PP1 -> Layer_6_LayerNorm_PP1
	Layer_6_LayerNorm_PP1 -> Layer_7_QKV_TP0_PP1
	Layer_7_QKV_TP0_PP1 -> Layer_7_QKV_AllReduce_PP1
	Layer_7_QKV_AllReduce_PP1 -> Layer_7_Attention_TP0_PP1
	Layer_7_Attention_TP0_PP1 -> Layer_7_AttnOut_TP0_PP1
	Layer_7_AttnOut_TP0_PP1 -> Layer_7_AttnOut_AllReduce_PP1
	Layer_7_QKV_TP1_PP1 -> Layer_7_QKV_AllReduce_PP1
	Layer_7_QKV_AllReduce_PP1 -> Layer_7_Attention_TP1_PP1
	Layer_7_Attention_TP1_PP1 -> Layer_7_AttnOut_TP1_PP1
	Layer_7_AttnOut_TP1_PP1 -> Layer_7_AttnOut_AllReduce_PP1
	Layer_7_AttnOut_AllReduce_PP1 -> Layer_7_A2A_Dispatch_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_0_EP0_TP0_PP1
	Layer_7_Expert_0_EP0_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_0_EP0_TP1_PP1
	Layer_7_Expert_0_EP0_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_1_EP0_TP0_PP1
	Layer_7_Expert_1_EP0_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_1_EP0_TP1_PP1
	Layer_7_Expert_1_EP0_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_2_EP0_TP0_PP1
	Layer_7_Expert_2_EP0_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_2_EP0_TP1_PP1
	Layer_7_Expert_2_EP0_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_3_EP0_TP0_PP1
	Layer_7_Expert_3_EP0_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_3_EP0_TP1_PP1
	Layer_7_Expert_3_EP0_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_4_EP1_TP0_PP1
	Layer_7_Expert_4_EP1_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_4_EP1_TP1_PP1
	Layer_7_Expert_4_EP1_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_5_EP1_TP0_PP1
	Layer_7_Expert_5_EP1_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_5_EP1_TP1_PP1
	Layer_7_Expert_5_EP1_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_6_EP1_TP0_PP1
	Layer_7_Expert_6_EP1_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_6_EP1_TP1_PP1
	Layer_7_Expert_6_EP1_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_7_EP1_TP0_PP1
	Layer_7_Expert_7_EP1_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_7_EP1_TP1_PP1
	Layer_7_Expert_7_EP1_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_8_EP2_TP0_PP1
	Layer_7_Expert_8_EP2_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_8_EP2_TP1_PP1
	Layer_7_Expert_8_EP2_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_9_EP2_TP0_PP1
	Layer_7_Expert_9_EP2_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_9_EP2_TP1_PP1
	Layer_7_Expert_9_EP2_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_10_EP2_TP0_PP1
	Layer_7_Expert_10_EP2_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_10_EP2_TP1_PP1
	Layer_7_Expert_10_EP2_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_11_EP2_TP0_PP1
	Layer_7_Expert_11_EP2_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_11_EP2_TP1_PP1
	Layer_7_Expert_11_EP2_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_12_EP3_TP0_PP1
	Layer_7_Expert_12_EP3_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_12_EP3_TP1_PP1
	Layer_7_Expert_12_EP3_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_13_EP3_TP0_PP1
	Layer_7_Expert_13_EP3_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_13_EP3_TP1_PP1
	Layer_7_Expert_13_EP3_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_14_EP3_TP0_PP1
	Layer_7_Expert_14_EP3_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_14_EP3_TP1_PP1
	Layer_7_Expert_14_EP3_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_15_EP3_TP0_PP1
	Layer_7_Expert_15_EP3_TP0_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Dispatch_PP1 -> Layer_7_Expert_15_EP3_TP1_PP1
	Layer_7_Expert_15_EP3_TP1_PP1 -> Layer_7_A2A_Combine_PP1
	Layer_7_A2A_Combine_PP1 -> Layer_7_MLP_Out_TP0_PP1
	Layer_7_MLP_Out_TP0_PP1 -> Layer_7_MLP_AllReduce_PP1
	Layer_7_A2A_Combine_PP1 -> Layer_7_MLP_Out_TP1_PP1
	Layer_7_MLP_Out_TP1_PP1 -> Layer_7_MLP_AllReduce_PP1
	Layer_7_MLP_AllReduce_PP1 -> Layer_7_LayerNorm_PP1
	Layer_7_LayerNorm_PP1 -> Layer_8_QKV_TP0_PP2
	Layer_8_QKV_TP0_PP2 -> Layer_8_QKV_AllReduce_PP2
	Layer_8_QKV_AllReduce_PP2 -> Layer_8_Attention_TP0_PP2
	Layer_8_Attention_TP0_PP2 -> Layer_8_AttnOut_TP0_PP2
	Layer_8_AttnOut_TP0_PP2 -> Layer_8_AttnOut_AllReduce_PP2
	Layer_8_QKV_TP1_PP2 -> Layer_8_QKV_AllReduce_PP2
	Layer_8_QKV_AllReduce_PP2 -> Layer_8_Attention_TP1_PP2
	Layer_8_Attention_TP1_PP2 -> Layer_8_AttnOut_TP1_PP2
	Layer_8_AttnOut_TP1_PP2 -> Layer_8_AttnOut_AllReduce_PP2
	Layer_8_AttnOut_AllReduce_PP2 -> Layer_8_A2A_Dispatch_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_0_EP0_TP0_PP2
	Layer_8_Expert_0_EP0_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_0_EP0_TP1_PP2
	Layer_8_Expert_0_EP0_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_1_EP0_TP0_PP2
	Layer_8_Expert_1_EP0_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_1_EP0_TP1_PP2
	Layer_8_Expert_1_EP0_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_2_EP0_TP0_PP2
	Layer_8_Expert_2_EP0_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_2_EP0_TP1_PP2
	Layer_8_Expert_2_EP0_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_3_EP0_TP0_PP2
	Layer_8_Expert_3_EP0_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_3_EP0_TP1_PP2
	Layer_8_Expert_3_EP0_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_4_EP1_TP0_PP2
	Layer_8_Expert_4_EP1_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_4_EP1_TP1_PP2
	Layer_8_Expert_4_EP1_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_5_EP1_TP0_PP2
	Layer_8_Expert_5_EP1_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_5_EP1_TP1_PP2
	Layer_8_Expert_5_EP1_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_6_EP1_TP0_PP2
	Layer_8_Expert_6_EP1_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_6_EP1_TP1_PP2
	Layer_8_Expert_6_EP1_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_7_EP1_TP0_PP2
	Layer_8_Expert_7_EP1_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_7_EP1_TP1_PP2
	Layer_8_Expert_7_EP1_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_8_EP2_TP0_PP2
	Layer_8_Expert_8_EP2_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_8_EP2_TP1_PP2
	Layer_8_Expert_8_EP2_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_9_EP2_TP0_PP2
	Layer_8_Expert_9_EP2_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_9_EP2_TP1_PP2
	Layer_8_Expert_9_EP2_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_10_EP2_TP0_PP2
	Layer_8_Expert_10_EP2_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_10_EP2_TP1_PP2
	Layer_8_Expert_10_EP2_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_11_EP2_TP0_PP2
	Layer_8_Expert_11_EP2_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_11_EP2_TP1_PP2
	Layer_8_Expert_11_EP2_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_12_EP3_TP0_PP2
	Layer_8_Expert_12_EP3_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_12_EP3_TP1_PP2
	Layer_8_Expert_12_EP3_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_13_EP3_TP0_PP2
	Layer_8_Expert_13_EP3_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_13_EP3_TP1_PP2
	Layer_8_Expert_13_EP3_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_14_EP3_TP0_PP2
	Layer_8_Expert_14_EP3_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_14_EP3_TP1_PP2
	Layer_8_Expert_14_EP3_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_15_EP3_TP0_PP2
	Layer_8_Expert_15_EP3_TP0_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Dispatch_PP2 -> Layer_8_Expert_15_EP3_TP1_PP2
	Layer_8_Expert_15_EP3_TP1_PP2 -> Layer_8_A2A_Combine_PP2
	Layer_8_A2A_Combine_PP2 -> Layer_8_MLP_Out_TP0_PP2
	Layer_8_MLP_Out_TP0_PP2 -> Layer_8_MLP_AllReduce_PP2
	Layer_8_A2A_Combine_PP2 -> Layer_8_MLP_Out_TP1_PP2
	Layer_8_MLP_Out_TP1_PP2 -> Layer_8_MLP_AllReduce_PP2
	Layer_8_MLP_AllReduce_PP2 -> Layer_8_LayerNorm_PP2
	Layer_8_LayerNorm_PP2 -> Layer_9_QKV_TP0_PP2
	Layer_9_QKV_TP0_PP2 -> Layer_9_QKV_AllReduce_PP2
	Layer_9_QKV_AllReduce_PP2 -> Layer_9_Attention_TP0_PP2
	Layer_9_Attention_TP0_PP2 -> Layer_9_AttnOut_TP0_PP2
	Layer_9_AttnOut_TP0_PP2 -> Layer_9_AttnOut_AllReduce_PP2
	Layer_9_QKV_TP1_PP2 -> Layer_9_QKV_AllReduce_PP2
	Layer_9_QKV_AllReduce_PP2 -> Layer_9_Attention_TP1_PP2
	Layer_9_Attention_TP1_PP2 -> Layer_9_AttnOut_TP1_PP2
	Layer_9_AttnOut_TP1_PP2 -> Layer_9_AttnOut_AllReduce_PP2
	Layer_9_AttnOut_AllReduce_PP2 -> Layer_9_A2A_Dispatch_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_0_EP0_TP0_PP2
	Layer_9_Expert_0_EP0_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_0_EP0_TP1_PP2
	Layer_9_Expert_0_EP0_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_1_EP0_TP0_PP2
	Layer_9_Expert_1_EP0_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_1_EP0_TP1_PP2
	Layer_9_Expert_1_EP0_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_2_EP0_TP0_PP2
	Layer_9_Expert_2_EP0_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_2_EP0_TP1_PP2
	Layer_9_Expert_2_EP0_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_3_EP0_TP0_PP2
	Layer_9_Expert_3_EP0_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_3_EP0_TP1_PP2
	Layer_9_Expert_3_EP0_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_4_EP1_TP0_PP2
	Layer_9_Expert_4_EP1_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_4_EP1_TP1_PP2
	Layer_9_Expert_4_EP1_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_5_EP1_TP0_PP2
	Layer_9_Expert_5_EP1_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_5_EP1_TP1_PP2
	Layer_9_Expert_5_EP1_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_6_EP1_TP0_PP2
	Layer_9_Expert_6_EP1_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_6_EP1_TP1_PP2
	Layer_9_Expert_6_EP1_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_7_EP1_TP0_PP2
	Layer_9_Expert_7_EP1_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_7_EP1_TP1_PP2
	Layer_9_Expert_7_EP1_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_8_EP2_TP0_PP2
	Layer_9_Expert_8_EP2_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_8_EP2_TP1_PP2
	Layer_9_Expert_8_EP2_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_9_EP2_TP0_PP2
	Layer_9_Expert_9_EP2_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_9_EP2_TP1_PP2
	Layer_9_Expert_9_EP2_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_10_EP2_TP0_PP2
	Layer_9_Expert_10_EP2_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_10_EP2_TP1_PP2
	Layer_9_Expert_10_EP2_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_11_EP2_TP0_PP2
	Layer_9_Expert_11_EP2_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_11_EP2_TP1_PP2
	Layer_9_Expert_11_EP2_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_12_EP3_TP0_PP2
	Layer_9_Expert_12_EP3_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_12_EP3_TP1_PP2
	Layer_9_Expert_12_EP3_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_13_EP3_TP0_PP2
	Layer_9_Expert_13_EP3_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_13_EP3_TP1_PP2
	Layer_9_Expert_13_EP3_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_14_EP3_TP0_PP2
	Layer_9_Expert_14_EP3_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_14_EP3_TP1_PP2
	Layer_9_Expert_14_EP3_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_15_EP3_TP0_PP2
	Layer_9_Expert_15_EP3_TP0_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Dispatch_PP2 -> Layer_9_Expert_15_EP3_TP1_PP2
	Layer_9_Expert_15_EP3_TP1_PP2 -> Layer_9_A2A_Combine_PP2
	Layer_9_A2A_Combine_PP2 -> Layer_9_MLP_Out_TP0_PP2
	Layer_9_MLP_Out_TP0_PP2 -> Layer_9_MLP_AllReduce_PP2
	Layer_9_A2A_Combine_PP2 -> Layer_9_MLP_Out_TP1_PP2
	Layer_9_MLP_Out_TP1_PP2 -> Layer_9_MLP_AllReduce_PP2
	Layer_9_MLP_AllReduce_PP2 -> Layer_9_LayerNorm_PP2
	Layer_9_LayerNorm_PP2 -> Layer_10_QKV_TP0_PP2
	Layer_10_QKV_TP0_PP2 -> Layer_10_QKV_AllReduce_PP2
	Layer_10_QKV_AllReduce_PP2 -> Layer_10_Attention_TP0_PP2
	Layer_10_Attention_TP0_PP2 -> Layer_10_AttnOut_TP0_PP2
	Layer_10_AttnOut_TP0_PP2 -> Layer_10_AttnOut_AllReduce_PP2
	Layer_10_QKV_TP1_PP2 -> Layer_10_QKV_AllReduce_PP2
	Layer_10_QKV_AllReduce_PP2 -> Layer_10_Attention_TP1_PP2
	Layer_10_Attention_TP1_PP2 -> Layer_10_AttnOut_TP1_PP2
	Layer_10_AttnOut_TP1_PP2 -> Layer_10_AttnOut_AllReduce_PP2
	Layer_10_AttnOut_AllReduce_PP2 -> Layer_10_A2A_Dispatch_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_0_EP0_TP0_PP2
	Layer_10_Expert_0_EP0_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_0_EP0_TP1_PP2
	Layer_10_Expert_0_EP0_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_1_EP0_TP0_PP2
	Layer_10_Expert_1_EP0_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_1_EP0_TP1_PP2
	Layer_10_Expert_1_EP0_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_2_EP0_TP0_PP2
	Layer_10_Expert_2_EP0_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_2_EP0_TP1_PP2
	Layer_10_Expert_2_EP0_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_3_EP0_TP0_PP2
	Layer_10_Expert_3_EP0_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_3_EP0_TP1_PP2
	Layer_10_Expert_3_EP0_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_4_EP1_TP0_PP2
	Layer_10_Expert_4_EP1_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_4_EP1_TP1_PP2
	Layer_10_Expert_4_EP1_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_5_EP1_TP0_PP2
	Layer_10_Expert_5_EP1_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_5_EP1_TP1_PP2
	Layer_10_Expert_5_EP1_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_6_EP1_TP0_PP2
	Layer_10_Expert_6_EP1_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_6_EP1_TP1_PP2
	Layer_10_Expert_6_EP1_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_7_EP1_TP0_PP2
	Layer_10_Expert_7_EP1_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_7_EP1_TP1_PP2
	Layer_10_Expert_7_EP1_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_8_EP2_TP0_PP2
	Layer_10_Expert_8_EP2_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_8_EP2_TP1_PP2
	Layer_10_Expert_8_EP2_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_9_EP2_TP0_PP2
	Layer_10_Expert_9_EP2_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_9_EP2_TP1_PP2
	Layer_10_Expert_9_EP2_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_10_EP2_TP0_PP2
	Layer_10_Expert_10_EP2_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_10_EP2_TP1_PP2
	Layer_10_Expert_10_EP2_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_11_EP2_TP0_PP2
	Layer_10_Expert_11_EP2_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_11_EP2_TP1_PP2
	Layer_10_Expert_11_EP2_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_12_EP3_TP0_PP2
	Layer_10_Expert_12_EP3_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_12_EP3_TP1_PP2
	Layer_10_Expert_12_EP3_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_13_EP3_TP0_PP2
	Layer_10_Expert_13_EP3_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_13_EP3_TP1_PP2
	Layer_10_Expert_13_EP3_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_14_EP3_TP0_PP2
	Layer_10_Expert_14_EP3_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_14_EP3_TP1_PP2
	Layer_10_Expert_14_EP3_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_15_EP3_TP0_PP2
	Layer_10_Expert_15_EP3_TP0_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Dispatch_PP2 -> Layer_10_Expert_15_EP3_TP1_PP2
	Layer_10_Expert_15_EP3_TP1_PP2 -> Layer_10_A2A_Combine_PP2
	Layer_10_A2A_Combine_PP2 -> Layer_10_MLP_Out_TP0_PP2
	Layer_10_MLP_Out_TP0_PP2 -> Layer_10_MLP_AllReduce_PP2
	Layer_10_A2A_Combine_PP2 -> Layer_10_MLP_Out_TP1_PP2
	Layer_10_MLP_Out_TP1_PP2 -> Layer_10_MLP_AllReduce_PP2
	Layer_10_MLP_AllReduce_PP2 -> Layer_10_LayerNorm_PP2
	Layer_10_LayerNorm_PP2 -> Layer_11_QKV_TP0_PP2
	Layer_11_QKV_TP0_PP2 -> Layer_11_QKV_AllReduce_PP2
	Layer_11_QKV_AllReduce_PP2 -> Layer_11_Attention_TP0_PP2
	Layer_11_Attention_TP0_PP2 -> Layer_11_AttnOut_TP0_PP2
	Layer_11_AttnOut_TP0_PP2 -> Layer_11_AttnOut_AllReduce_PP2
	Layer_11_QKV_TP1_PP2 -> Layer_11_QKV_AllReduce_PP2
	Layer_11_QKV_AllReduce_PP2 -> Layer_11_Attention_TP1_PP2
	Layer_11_Attention_TP1_PP2 -> Layer_11_AttnOut_TP1_PP2
	Layer_11_AttnOut_TP1_PP2 -> Layer_11_AttnOut_AllReduce_PP2
	Layer_11_AttnOut_AllReduce_PP2 -> Layer_11_A2A_Dispatch_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_0_EP0_TP0_PP2
	Layer_11_Expert_0_EP0_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_0_EP0_TP1_PP2
	Layer_11_Expert_0_EP0_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_1_EP0_TP0_PP2
	Layer_11_Expert_1_EP0_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_1_EP0_TP1_PP2
	Layer_11_Expert_1_EP0_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_2_EP0_TP0_PP2
	Layer_11_Expert_2_EP0_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_2_EP0_TP1_PP2
	Layer_11_Expert_2_EP0_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_3_EP0_TP0_PP2
	Layer_11_Expert_3_EP0_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_3_EP0_TP1_PP2
	Layer_11_Expert_3_EP0_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_4_EP1_TP0_PP2
	Layer_11_Expert_4_EP1_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_4_EP1_TP1_PP2
	Layer_11_Expert_4_EP1_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_5_EP1_TP0_PP2
	Layer_11_Expert_5_EP1_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_5_EP1_TP1_PP2
	Layer_11_Expert_5_EP1_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_6_EP1_TP0_PP2
	Layer_11_Expert_6_EP1_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_6_EP1_TP1_PP2
	Layer_11_Expert_6_EP1_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_7_EP1_TP0_PP2
	Layer_11_Expert_7_EP1_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_7_EP1_TP1_PP2
	Layer_11_Expert_7_EP1_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_8_EP2_TP0_PP2
	Layer_11_Expert_8_EP2_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_8_EP2_TP1_PP2
	Layer_11_Expert_8_EP2_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_9_EP2_TP0_PP2
	Layer_11_Expert_9_EP2_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_9_EP2_TP1_PP2
	Layer_11_Expert_9_EP2_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_10_EP2_TP0_PP2
	Layer_11_Expert_10_EP2_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_10_EP2_TP1_PP2
	Layer_11_Expert_10_EP2_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_11_EP2_TP0_PP2
	Layer_11_Expert_11_EP2_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_11_EP2_TP1_PP2
	Layer_11_Expert_11_EP2_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_12_EP3_TP0_PP2
	Layer_11_Expert_12_EP3_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_12_EP3_TP1_PP2
	Layer_11_Expert_12_EP3_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_13_EP3_TP0_PP2
	Layer_11_Expert_13_EP3_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_13_EP3_TP1_PP2
	Layer_11_Expert_13_EP3_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_14_EP3_TP0_PP2
	Layer_11_Expert_14_EP3_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_14_EP3_TP1_PP2
	Layer_11_Expert_14_EP3_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_15_EP3_TP0_PP2
	Layer_11_Expert_15_EP3_TP0_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Dispatch_PP2 -> Layer_11_Expert_15_EP3_TP1_PP2
	Layer_11_Expert_15_EP3_TP1_PP2 -> Layer_11_A2A_Combine_PP2
	Layer_11_A2A_Combine_PP2 -> Layer_11_MLP_Out_TP0_PP2
	Layer_11_MLP_Out_TP0_PP2 -> Layer_11_MLP_AllReduce_PP2
	Layer_11_A2A_Combine_PP2 -> Layer_11_MLP_Out_TP1_PP2
	Layer_11_MLP_Out_TP1_PP2 -> Layer_11_MLP_AllReduce_PP2
	Layer_11_MLP_AllReduce_PP2 -> Layer_11_LayerNorm_PP2
	Layer_11_LayerNorm_PP2 -> Layer_12_QKV_TP0_PP3
	Layer_12_QKV_TP0_PP3 -> Layer_12_QKV_AllReduce_PP3
	Layer_12_QKV_AllReduce_PP3 -> Layer_12_Attention_TP0_PP3
	Layer_12_Attention_TP0_PP3 -> Layer_12_AttnOut_TP0_PP3
	Layer_12_AttnOut_TP0_PP3 -> Layer_12_AttnOut_AllReduce_PP3
	Layer_12_QKV_TP1_PP3 -> Layer_12_QKV_AllReduce_PP3
	Layer_12_QKV_AllReduce_PP3 -> Layer_12_Attention_TP1_PP3
	Layer_12_Attention_TP1_PP3 -> Layer_12_AttnOut_TP1_PP3
	Layer_12_AttnOut_TP1_PP3 -> Layer_12_AttnOut_AllReduce_PP3
	Layer_12_AttnOut_AllReduce_PP3 -> Layer_12_A2A_Dispatch_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_0_EP0_TP0_PP3
	Layer_12_Expert_0_EP0_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_0_EP0_TP1_PP3
	Layer_12_Expert_0_EP0_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_1_EP0_TP0_PP3
	Layer_12_Expert_1_EP0_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_1_EP0_TP1_PP3
	Layer_12_Expert_1_EP0_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_2_EP0_TP0_PP3
	Layer_12_Expert_2_EP0_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_2_EP0_TP1_PP3
	Layer_12_Expert_2_EP0_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_3_EP0_TP0_PP3
	Layer_12_Expert_3_EP0_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_3_EP0_TP1_PP3
	Layer_12_Expert_3_EP0_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_4_EP1_TP0_PP3
	Layer_12_Expert_4_EP1_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_4_EP1_TP1_PP3
	Layer_12_Expert_4_EP1_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_5_EP1_TP0_PP3
	Layer_12_Expert_5_EP1_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_5_EP1_TP1_PP3
	Layer_12_Expert_5_EP1_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_6_EP1_TP0_PP3
	Layer_12_Expert_6_EP1_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_6_EP1_TP1_PP3
	Layer_12_Expert_6_EP1_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_7_EP1_TP0_PP3
	Layer_12_Expert_7_EP1_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_7_EP1_TP1_PP3
	Layer_12_Expert_7_EP1_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_8_EP2_TP0_PP3
	Layer_12_Expert_8_EP2_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_8_EP2_TP1_PP3
	Layer_12_Expert_8_EP2_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_9_EP2_TP0_PP3
	Layer_12_Expert_9_EP2_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_9_EP2_TP1_PP3
	Layer_12_Expert_9_EP2_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_10_EP2_TP0_PP3
	Layer_12_Expert_10_EP2_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_10_EP2_TP1_PP3
	Layer_12_Expert_10_EP2_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_11_EP2_TP0_PP3
	Layer_12_Expert_11_EP2_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_11_EP2_TP1_PP3
	Layer_12_Expert_11_EP2_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_12_EP3_TP0_PP3
	Layer_12_Expert_12_EP3_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_12_EP3_TP1_PP3
	Layer_12_Expert_12_EP3_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_13_EP3_TP0_PP3
	Layer_12_Expert_13_EP3_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_13_EP3_TP1_PP3
	Layer_12_Expert_13_EP3_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_14_EP3_TP0_PP3
	Layer_12_Expert_14_EP3_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_14_EP3_TP1_PP3
	Layer_12_Expert_14_EP3_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_15_EP3_TP0_PP3
	Layer_12_Expert_15_EP3_TP0_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Dispatch_PP3 -> Layer_12_Expert_15_EP3_TP1_PP3
	Layer_12_Expert_15_EP3_TP1_PP3 -> Layer_12_A2A_Combine_PP3
	Layer_12_A2A_Combine_PP3 -> Layer_12_MLP_Out_TP0_PP3
	Layer_12_MLP_Out_TP0_PP3 -> Layer_12_MLP_AllReduce_PP3
	Layer_12_A2A_Combine_PP3 -> Layer_12_MLP_Out_TP1_PP3
	Layer_12_MLP_Out_TP1_PP3 -> Layer_12_MLP_AllReduce_PP3
	Layer_12_MLP_AllReduce_PP3 -> Layer_12_LayerNorm_PP3
	Layer_12_LayerNorm_PP3 -> Layer_13_QKV_TP0_PP3
	Layer_13_QKV_TP0_PP3 -> Layer_13_QKV_AllReduce_PP3
	Layer_13_QKV_AllReduce_PP3 -> Layer_13_Attention_TP0_PP3
	Layer_13_Attention_TP0_PP3 -> Layer_13_AttnOut_TP0_PP3
	Layer_13_AttnOut_TP0_PP3 -> Layer_13_AttnOut_AllReduce_PP3
	Layer_13_QKV_TP1_PP3 -> Layer_13_QKV_AllReduce_PP3
	Layer_13_QKV_AllReduce_PP3 -> Layer_13_Attention_TP1_PP3
	Layer_13_Attention_TP1_PP3 -> Layer_13_AttnOut_TP1_PP3
	Layer_13_AttnOut_TP1_PP3 -> Layer_13_AttnOut_AllReduce_PP3
	Layer_13_AttnOut_AllReduce_PP3 -> Layer_13_A2A_Dispatch_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_0_EP0_TP0_PP3
	Layer_13_Expert_0_EP0_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_0_EP0_TP1_PP3
	Layer_13_Expert_0_EP0_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_1_EP0_TP0_PP3
	Layer_13_Expert_1_EP0_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_1_EP0_TP1_PP3
	Layer_13_Expert_1_EP0_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_2_EP0_TP0_PP3
	Layer_13_Expert_2_EP0_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_2_EP0_TP1_PP3
	Layer_13_Expert_2_EP0_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_3_EP0_TP0_PP3
	Layer_13_Expert_3_EP0_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_3_EP0_TP1_PP3
	Layer_13_Expert_3_EP0_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_4_EP1_TP0_PP3
	Layer_13_Expert_4_EP1_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_4_EP1_TP1_PP3
	Layer_13_Expert_4_EP1_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_5_EP1_TP0_PP3
	Layer_13_Expert_5_EP1_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_5_EP1_TP1_PP3
	Layer_13_Expert_5_EP1_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_6_EP1_TP0_PP3
	Layer_13_Expert_6_EP1_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_6_EP1_TP1_PP3
	Layer_13_Expert_6_EP1_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_7_EP1_TP0_PP3
	Layer_13_Expert_7_EP1_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_7_EP1_TP1_PP3
	Layer_13_Expert_7_EP1_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_8_EP2_TP0_PP3
	Layer_13_Expert_8_EP2_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_8_EP2_TP1_PP3
	Layer_13_Expert_8_EP2_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_9_EP2_TP0_PP3
	Layer_13_Expert_9_EP2_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_9_EP2_TP1_PP3
	Layer_13_Expert_9_EP2_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_10_EP2_TP0_PP3
	Layer_13_Expert_10_EP2_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_10_EP2_TP1_PP3
	Layer_13_Expert_10_EP2_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_11_EP2_TP0_PP3
	Layer_13_Expert_11_EP2_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_11_EP2_TP1_PP3
	Layer_13_Expert_11_EP2_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_12_EP3_TP0_PP3
	Layer_13_Expert_12_EP3_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_12_EP3_TP1_PP3
	Layer_13_Expert_12_EP3_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_13_EP3_TP0_PP3
	Layer_13_Expert_13_EP3_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_13_EP3_TP1_PP3
	Layer_13_Expert_13_EP3_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_14_EP3_TP0_PP3
	Layer_13_Expert_14_EP3_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_14_EP3_TP1_PP3
	Layer_13_Expert_14_EP3_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_15_EP3_TP0_PP3
	Layer_13_Expert_15_EP3_TP0_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Dispatch_PP3 -> Layer_13_Expert_15_EP3_TP1_PP3
	Layer_13_Expert_15_EP3_TP1_PP3 -> Layer_13_A2A_Combine_PP3
	Layer_13_A2A_Combine_PP3 -> Layer_13_MLP_Out_TP0_PP3
	Layer_13_MLP_Out_TP0_PP3 -> Layer_13_MLP_AllReduce_PP3
	Layer_13_A2A_Combine_PP3 -> Layer_13_MLP_Out_TP1_PP3
	Layer_13_MLP_Out_TP1_PP3 -> Layer_13_MLP_AllReduce_PP3
	Layer_13_MLP_AllReduce_PP3 -> Layer_13_LayerNorm_PP3
	Layer_13_LayerNorm_PP3 -> Layer_14_QKV_TP0_PP3
	Layer_14_QKV_TP0_PP3 -> Layer_14_QKV_AllReduce_PP3
	Layer_14_QKV_AllReduce_PP3 -> Layer_14_Attention_TP0_PP3
	Layer_14_Attention_TP0_PP3 -> Layer_14_AttnOut_TP0_PP3
	Layer_14_AttnOut_TP0_PP3 -> Layer_14_AttnOut_AllReduce_PP3
	Layer_14_QKV_TP1_PP3 -> Layer_14_QKV_AllReduce_PP3
	Layer_14_QKV_AllReduce_PP3 -> Layer_14_Attention_TP1_PP3
	Layer_14_Attention_TP1_PP3 -> Layer_14_AttnOut_TP1_PP3
	Layer_14_AttnOut_TP1_PP3 -> Layer_14_AttnOut_AllReduce_PP3
	Layer_14_AttnOut_AllReduce_PP3 -> Layer_14_A2A_Dispatch_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_0_EP0_TP0_PP3
	Layer_14_Expert_0_EP0_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_0_EP0_TP1_PP3
	Layer_14_Expert_0_EP0_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_1_EP0_TP0_PP3
	Layer_14_Expert_1_EP0_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_1_EP0_TP1_PP3
	Layer_14_Expert_1_EP0_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_2_EP0_TP0_PP3
	Layer_14_Expert_2_EP0_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_2_EP0_TP1_PP3
	Layer_14_Expert_2_EP0_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_3_EP0_TP0_PP3
	Layer_14_Expert_3_EP0_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_3_EP0_TP1_PP3
	Layer_14_Expert_3_EP0_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_4_EP1_TP0_PP3
	Layer_14_Expert_4_EP1_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_4_EP1_TP1_PP3
	Layer_14_Expert_4_EP1_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_5_EP1_TP0_PP3
	Layer_14_Expert_5_EP1_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_5_EP1_TP1_PP3
	Layer_14_Expert_5_EP1_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_6_EP1_TP0_PP3
	Layer_14_Expert_6_EP1_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_6_EP1_TP1_PP3
	Layer_14_Expert_6_EP1_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_7_EP1_TP0_PP3
	Layer_14_Expert_7_EP1_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_7_EP1_TP1_PP3
	Layer_14_Expert_7_EP1_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_8_EP2_TP0_PP3
	Layer_14_Expert_8_EP2_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_8_EP2_TP1_PP3
	Layer_14_Expert_8_EP2_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_9_EP2_TP0_PP3
	Layer_14_Expert_9_EP2_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_9_EP2_TP1_PP3
	Layer_14_Expert_9_EP2_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_10_EP2_TP0_PP3
	Layer_14_Expert_10_EP2_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_10_EP2_TP1_PP3
	Layer_14_Expert_10_EP2_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_11_EP2_TP0_PP3
	Layer_14_Expert_11_EP2_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_11_EP2_TP1_PP3
	Layer_14_Expert_11_EP2_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_12_EP3_TP0_PP3
	Layer_14_Expert_12_EP3_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_12_EP3_TP1_PP3
	Layer_14_Expert_12_EP3_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_13_EP3_TP0_PP3
	Layer_14_Expert_13_EP3_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_13_EP3_TP1_PP3
	Layer_14_Expert_13_EP3_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_14_EP3_TP0_PP3
	Layer_14_Expert_14_EP3_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_14_EP3_TP1_PP3
	Layer_14_Expert_14_EP3_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_15_EP3_TP0_PP3
	Layer_14_Expert_15_EP3_TP0_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Dispatch_PP3 -> Layer_14_Expert_15_EP3_TP1_PP3
	Layer_14_Expert_15_EP3_TP1_PP3 -> Layer_14_A2A_Combine_PP3
	Layer_14_A2A_Combine_PP3 -> Layer_14_MLP_Out_TP0_PP3
	Layer_14_MLP_Out_TP0_PP3 -> Layer_14_MLP_AllReduce_PP3
	Layer_14_A2A_Combine_PP3 -> Layer_14_MLP_Out_TP1_PP3
	Layer_14_MLP_Out_TP1_PP3 -> Layer_14_MLP_AllReduce_PP3
	Layer_14_MLP_AllReduce_PP3 -> Layer_14_LayerNorm_PP3
	Layer_14_LayerNorm_PP3 -> Layer_15_QKV_TP0_PP3
	Layer_15_QKV_TP0_PP3 -> Layer_15_QKV_AllReduce_PP3
	Layer_15_QKV_AllReduce_PP3 -> Layer_15_Attention_TP0_PP3
	Layer_15_Attention_TP0_PP3 -> Layer_15_AttnOut_TP0_PP3
	Layer_15_AttnOut_TP0_PP3 -> Layer_15_AttnOut_AllReduce_PP3
	Layer_15_QKV_TP1_PP3 -> Layer_15_QKV_AllReduce_PP3
	Layer_15_QKV_AllReduce_PP3 -> Layer_15_Attention_TP1_PP3
	Layer_15_Attention_TP1_PP3 -> Layer_15_AttnOut_TP1_PP3
	Layer_15_AttnOut_TP1_PP3 -> Layer_15_AttnOut_AllReduce_PP3
	Layer_15_AttnOut_AllReduce_PP3 -> Layer_15_A2A_Dispatch_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_0_EP0_TP0_PP3
	Layer_15_Expert_0_EP0_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_0_EP0_TP1_PP3
	Layer_15_Expert_0_EP0_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_1_EP0_TP0_PP3
	Layer_15_Expert_1_EP0_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_1_EP0_TP1_PP3
	Layer_15_Expert_1_EP0_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_2_EP0_TP0_PP3
	Layer_15_Expert_2_EP0_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_2_EP0_TP1_PP3
	Layer_15_Expert_2_EP0_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_3_EP0_TP0_PP3
	Layer_15_Expert_3_EP0_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_3_EP0_TP1_PP3
	Layer_15_Expert_3_EP0_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_4_EP1_TP0_PP3
	Layer_15_Expert_4_EP1_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_4_EP1_TP1_PP3
	Layer_15_Expert_4_EP1_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_5_EP1_TP0_PP3
	Layer_15_Expert_5_EP1_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_5_EP1_TP1_PP3
	Layer_15_Expert_5_EP1_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_6_EP1_TP0_PP3
	Layer_15_Expert_6_EP1_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_6_EP1_TP1_PP3
	Layer_15_Expert_6_EP1_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_7_EP1_TP0_PP3
	Layer_15_Expert_7_EP1_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_7_EP1_TP1_PP3
	Layer_15_Expert_7_EP1_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_8_EP2_TP0_PP3
	Layer_15_Expert_8_EP2_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_8_EP2_TP1_PP3
	Layer_15_Expert_8_EP2_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_9_EP2_TP0_PP3
	Layer_15_Expert_9_EP2_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_9_EP2_TP1_PP3
	Layer_15_Expert_9_EP2_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_10_EP2_TP0_PP3
	Layer_15_Expert_10_EP2_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_10_EP2_TP1_PP3
	Layer_15_Expert_10_EP2_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_11_EP2_TP0_PP3
	Layer_15_Expert_11_EP2_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_11_EP2_TP1_PP3
	Layer_15_Expert_11_EP2_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_12_EP3_TP0_PP3
	Layer_15_Expert_12_EP3_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_12_EP3_TP1_PP3
	Layer_15_Expert_12_EP3_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_13_EP3_TP0_PP3
	Layer_15_Expert_13_EP3_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_13_EP3_TP1_PP3
	Layer_15_Expert_13_EP3_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_14_EP3_TP0_PP3
	Layer_15_Expert_14_EP3_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_14_EP3_TP1_PP3
	Layer_15_Expert_14_EP3_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_15_EP3_TP0_PP3
	Layer_15_Expert_15_EP3_TP0_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Dispatch_PP3 -> Layer_15_Expert_15_EP3_TP1_PP3
	Layer_15_Expert_15_EP3_TP1_PP3 -> Layer_15_A2A_Combine_PP3
	Layer_15_A2A_Combine_PP3 -> Layer_15_MLP_Out_TP0_PP3
	Layer_15_MLP_Out_TP0_PP3 -> Layer_15_MLP_AllReduce_PP3
	Layer_15_A2A_Combine_PP3 -> Layer_15_MLP_Out_TP1_PP3
	Layer_15_MLP_Out_TP1_PP3 -> Layer_15_MLP_AllReduce_PP3
	Layer_15_MLP_AllReduce_PP3 -> Layer_15_LayerNorm_PP3
	output [label="Output\nInput: [batch_size=128, seq_len=10240, hidden_dim=512]\nOutput: [batch_size=128, seq_len=10240, hidden_dim=512]" fillcolor=lightgreen shape=ellipse]
	Layer_15_LayerNorm_PP3 -> output
}
