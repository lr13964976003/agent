<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: LLM_TP_EP_PP_Parallelism Pages: 1 -->
<svg width="33179pt" height="21051pt"
 viewBox="0.00 0.00 33178.58 21051.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 21047.23)">
<title>LLM_TP_EP_PP_Parallelism</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-21047.23 33174.58,-21047.23 33174.58,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_PP_Stage_0</title>
<path fill="lightgray" stroke="black" d="M19887,-15751.94C19887,-15751.94 33090,-15751.94 33090,-15751.94 33096,-15751.94 33102,-15757.94 33102,-15763.94 33102,-15763.94 33102,-20948.28 33102,-20948.28 33102,-20954.28 33096,-20960.28 33090,-20960.28 33090,-20960.28 19887,-20960.28 19887,-20960.28 19881,-20960.28 19875,-20954.28 19875,-20948.28 19875,-20948.28 19875,-15763.94 19875,-15763.94 19875,-15757.94 19881,-15751.94 19887,-15751.94"/>
<text text-anchor="middle" x="26488.5" y="-20946.68" font-family="Arial Bold" font-size="12.00">Pipeline Stage 0 (Layers 0&#45;3)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_PP_Stage_1</title>
<path fill="lightgray" stroke="black" d="M13215,-10535.61C13215,-10535.61 26418,-10535.61 26418,-10535.61 26424,-10535.61 26430,-10541.61 26430,-10547.61 26430,-10547.61 26430,-15731.94 26430,-15731.94 26430,-15737.94 26424,-15743.94 26418,-15743.94 26418,-15743.94 13215,-15743.94 13215,-15743.94 13209,-15743.94 13203,-15737.94 13203,-15731.94 13203,-15731.94 13203,-10547.61 13203,-10547.61 13203,-10541.61 13209,-10535.61 13215,-10535.61"/>
<text text-anchor="middle" x="19816.5" y="-15730.34" font-family="Arial Bold" font-size="12.00">Pipeline Stage 1 (Layers 4&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_PP_Stage_2</title>
<path fill="lightgray" stroke="black" d="M6605,-5319.28C6605,-5319.28 19808,-5319.28 19808,-5319.28 19814,-5319.28 19820,-5325.28 19820,-5331.28 19820,-5331.28 19820,-10515.61 19820,-10515.61 19820,-10521.61 19814,-10527.61 19808,-10527.61 19808,-10527.61 6605,-10527.61 6605,-10527.61 6599,-10527.61 6593,-10521.61 6593,-10515.61 6593,-10515.61 6593,-5331.28 6593,-5331.28 6593,-5325.28 6599,-5319.28 6605,-5319.28"/>
<text text-anchor="middle" x="13206.5" y="-10514.01" font-family="Arial Bold" font-size="12.00">Pipeline Stage 2 (Layers 8&#45;11)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_PP_Stage_3</title>
<path fill="lightgray" stroke="black" d="M20,-102.95C20,-102.95 13223,-102.95 13223,-102.95 13229,-102.95 13235,-108.95 13235,-114.95 13235,-114.95 13235,-5299.28 13235,-5299.28 13235,-5305.28 13229,-5311.28 13223,-5311.28 13223,-5311.28 20,-5311.28 20,-5311.28 14,-5311.28 8,-5305.28 8,-5299.28 8,-5299.28 8,-114.95 8,-114.95 8,-108.95 14,-102.95 20,-102.95"/>
<text text-anchor="middle" x="6621.5" y="-5297.68" font-family="Arial Bold" font-size="12.00">Pipeline Stage 3 (Layers 12&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="32904" cy="-21005.75" rx="266.66" ry="37.45"/>
<text text-anchor="middle" x="32904" y="-21017.05" font-family="Arial" font-size="14.00">Input</text>
<text text-anchor="middle" x="32904" y="-21002.05" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32904" y="-20987.05" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_0_QKV_TP0_PP0 -->
<g id="node2" class="node">
<title>Layer_0_QKV_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="33094.5,-20897.28 32713.5,-20897.28 32713.5,-20829.28 33094.5,-20829.28 33094.5,-20897.28"/>
<text text-anchor="middle" x="32904" y="-20882.08" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="32904" y="-20867.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="32904" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32904" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- input&#45;&gt;Layer_0_QKV_TP0_PP0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;Layer_0_QKV_TP0_PP0</title>
<path fill="none" stroke="black" d="M32904,-20968.21C32904,-20949.74 32904,-20927.2 32904,-20907.84"/>
<polygon fill="black" stroke="black" points="32907.5,-20907.75 32904,-20897.75 32900.5,-20907.75 32907.5,-20907.75"/>
</g>
<!-- Layer_0_QKV_AllReduce_PP0 -->
<g id="node4" class="node">
<title>Layer_0_QKV_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="32505" cy="-20711.19" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="32505" y="-20729.99" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="32505" y="-20714.99" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="32505" y="-20699.99" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="32505" y="-20684.99" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_0_QKV_TP0_PP0&#45;&gt;Layer_0_QKV_AllReduce_PP0 -->
<g id="edge2" class="edge">
<title>Layer_0_QKV_TP0_PP0&#45;&gt;Layer_0_QKV_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M32815.94,-20829.15C32760.94,-20808.46 32689.29,-20781.51 32628.64,-20758.7"/>
<polygon fill="black" stroke="black" points="32629.6,-20755.32 32619,-20755.07 32627.13,-20761.87 32629.6,-20755.32"/>
</g>
<!-- Layer_0_QKV_TP1_PP0 -->
<g id="node3" class="node">
<title>Layer_0_QKV_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="32695.5,-20897.28 32314.5,-20897.28 32314.5,-20829.28 32695.5,-20829.28 32695.5,-20897.28"/>
<text text-anchor="middle" x="32505" y="-20882.08" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="32505" y="-20867.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="32505" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32505" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_0_QKV_TP1_PP0&#45;&gt;Layer_0_QKV_AllReduce_PP0 -->
<g id="edge6" class="edge">
<title>Layer_0_QKV_TP1_PP0&#45;&gt;Layer_0_QKV_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M32505,-20828.97C32505,-20811.46 32505,-20789.5 32505,-20769.37"/>
<polygon fill="black" stroke="black" points="32508.5,-20769.35 32505,-20759.35 32501.5,-20769.35 32508.5,-20769.35"/>
</g>
<!-- Layer_0_Attention_TP0_PP0 -->
<g id="node5" class="node">
<title>Layer_0_Attention_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="32296.5,-20627.11 31915.5,-20627.11 31915.5,-20559.11 32296.5,-20559.11 32296.5,-20627.11"/>
<text text-anchor="middle" x="32106" y="-20611.91" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="32106" y="-20596.91" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="32106" y="-20581.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="32106" y="-20566.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_0_QKV_AllReduce_PP0&#45;&gt;Layer_0_Attention_TP0_PP0 -->
<g id="edge3" class="edge">
<title>Layer_0_QKV_AllReduce_PP0&#45;&gt;Layer_0_Attention_TP0_PP0</title>
<path fill="none" stroke="black" d="M32365.73,-20669.67C32321.31,-20656.75 32272.51,-20642.55 32229.31,-20629.98"/>
<polygon fill="black" stroke="black" points="32230.18,-20626.59 32219.61,-20627.16 32228.23,-20633.31 32230.18,-20626.59"/>
</g>
<!-- Layer_0_Attention_TP1_PP0 -->
<g id="node6" class="node">
<title>Layer_0_Attention_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="32695.5,-20627.11 32314.5,-20627.11 32314.5,-20559.11 32695.5,-20559.11 32695.5,-20627.11"/>
<text text-anchor="middle" x="32505" y="-20611.91" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="32505" y="-20596.91" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="32505" y="-20581.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="32505" y="-20566.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_0_QKV_AllReduce_PP0&#45;&gt;Layer_0_Attention_TP1_PP0 -->
<g id="edge7" class="edge">
<title>Layer_0_QKV_AllReduce_PP0&#45;&gt;Layer_0_Attention_TP1_PP0</title>
<path fill="none" stroke="black" d="M32505,-20662.98C32505,-20654.59 32505,-20645.89 32505,-20637.62"/>
<polygon fill="black" stroke="black" points="32508.5,-20637.41 32505,-20627.41 32501.5,-20637.41 32508.5,-20637.41"/>
</g>
<!-- Layer_0_AttnOut_TP0_PP0 -->
<g id="node7" class="node">
<title>Layer_0_AttnOut_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="32294.5,-20523.11 31917.5,-20523.11 31917.5,-20455.11 32294.5,-20455.11 32294.5,-20523.11"/>
<text text-anchor="middle" x="32106" y="-20507.91" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="32106" y="-20492.91" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="32106" y="-20477.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="32106" y="-20462.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Attention_TP0_PP0&#45;&gt;Layer_0_AttnOut_TP0_PP0 -->
<g id="edge4" class="edge">
<title>Layer_0_Attention_TP0_PP0&#45;&gt;Layer_0_AttnOut_TP0_PP0</title>
<path fill="none" stroke="black" d="M32106,-20558.99C32106,-20550.89 32106,-20542.09 32106,-20533.58"/>
<polygon fill="black" stroke="black" points="32109.5,-20533.41 32106,-20523.41 32102.5,-20533.41 32109.5,-20533.41"/>
</g>
<!-- Layer_0_AttnOut_TP1_PP0 -->
<g id="node8" class="node">
<title>Layer_0_AttnOut_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="32691.5,-20523.11 32314.5,-20523.11 32314.5,-20455.11 32691.5,-20455.11 32691.5,-20523.11"/>
<text text-anchor="middle" x="32503" y="-20507.91" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="32503" y="-20492.91" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="32503" y="-20477.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="32503" y="-20462.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Attention_TP1_PP0&#45;&gt;Layer_0_AttnOut_TP1_PP0 -->
<g id="edge8" class="edge">
<title>Layer_0_Attention_TP1_PP0&#45;&gt;Layer_0_AttnOut_TP1_PP0</title>
<path fill="none" stroke="black" d="M32504.35,-20558.99C32504.19,-20550.89 32504.02,-20542.09 32503.85,-20533.58"/>
<polygon fill="black" stroke="black" points="32507.35,-20533.34 32503.65,-20523.41 32500.35,-20533.47 32507.35,-20533.34"/>
</g>
<!-- Layer_0_AttnOut_AllReduce_PP0 -->
<g id="node9" class="node">
<title>Layer_0_AttnOut_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="32106" cy="-20371.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="32106" y="-20389.83" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="32106" y="-20374.83" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="32106" y="-20359.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32106" y="-20344.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_0_AttnOut_TP0_PP0&#45;&gt;Layer_0_AttnOut_AllReduce_PP0 -->
<g id="edge5" class="edge">
<title>Layer_0_AttnOut_TP0_PP0&#45;&gt;Layer_0_AttnOut_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M32106,-20454.84C32106,-20446.85 32106,-20438.08 32106,-20429.34"/>
<polygon fill="black" stroke="black" points="32109.5,-20429.13 32106,-20419.13 32102.5,-20429.13 32109.5,-20429.13"/>
</g>
<!-- Layer_0_AttnOut_TP1_PP0&#45;&gt;Layer_0_AttnOut_AllReduce_PP0 -->
<g id="edge9" class="edge">
<title>Layer_0_AttnOut_TP1_PP0&#45;&gt;Layer_0_AttnOut_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M32390.03,-20455.08C32347.54,-20442.65 32298.58,-20428.33 32253.4,-20415.13"/>
<polygon fill="black" stroke="black" points="32254.1,-20411.68 32243.52,-20412.24 32252.14,-20418.4 32254.1,-20411.68"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0 -->
<g id="node46" class="node">
<title>Layer_0_A2A_Dispatch_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26980" cy="-20238.86" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26980" y="-20257.66" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="26980" y="-20242.66" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26980" y="-20227.66" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26980" y="-20212.66" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_0_AttnOut_AllReduce_PP0&#45;&gt;Layer_0_A2A_Dispatch_PP0 -->
<g id="edge10" class="edge">
<title>Layer_0_AttnOut_AllReduce_PP0&#45;&gt;Layer_0_A2A_Dispatch_PP0</title>
<path fill="none" stroke="black" d="M31842.53,-20363.34C30964.89,-20341.05 28145.8,-20269.46 27253.52,-20246.8"/>
<polygon fill="black" stroke="black" points="27253.52,-20243.3 27243.43,-20246.55 27253.34,-20250.3 27253.52,-20243.3"/>
</g>
<!-- Layer_0_Gate_EP0_PP0 -->
<g id="node10" class="node">
<title>Layer_0_Gate_EP0_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="32296.4,-20931.28 31692.86,-20931.28 31537.6,-20795.28 32141.14,-20795.28 32296.4,-20931.28"/>
<text text-anchor="middle" x="31917" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="31917" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="31917" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31917" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_0_Gate_EP1_PP0 -->
<g id="node11" class="node">
<title>Layer_0_Gate_EP1_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="31519.4,-20931.28 30915.86,-20931.28 30760.6,-20795.28 31364.14,-20795.28 31519.4,-20931.28"/>
<text text-anchor="middle" x="31140" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="31140" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="31140" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31140" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_0_Gate_EP2_PP0 -->
<g id="node12" class="node">
<title>Layer_0_Gate_EP2_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30742.4,-20931.28 30138.86,-20931.28 29983.6,-20795.28 30587.14,-20795.28 30742.4,-20931.28"/>
<text text-anchor="middle" x="30363" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="30363" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="30363" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30363" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_0_Gate_EP3_PP0 -->
<g id="node13" class="node">
<title>Layer_0_Gate_EP3_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="29965.4,-20931.28 29361.86,-20931.28 29206.6,-20795.28 29810.14,-20795.28 29965.4,-20931.28"/>
<text text-anchor="middle" x="29586" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="29586" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="29586" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29586" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_0_Expert_0_EP0_TP0_PP0 -->
<g id="node14" class="node">
<title>Layer_0_Expert_0_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="20848.5,-20154.78 20471.5,-20154.78 20471.5,-20086.78 20848.5,-20086.78 20848.5,-20154.78"/>
<text text-anchor="middle" x="20660" y="-20139.58" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20660" y="-20124.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="20660" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20660" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_A2A_Combine_PP0 -->
<g id="node47" class="node">
<title>Layer_0_A2A_Combine_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26711" cy="-20002.69" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26711" y="-20021.49" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="26711" y="-20006.49" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26711" y="-19991.49" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26711" y="-19976.49" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_0_Expert_0_EP0_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge12" class="edge">
<title>Layer_0_Expert_0_EP0_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M20848.66,-20087.57C20851.45,-20087.29 20854.24,-20087.03 20857,-20086.78 21414.6,-20036.41 25348.69,-20011.2 26434.19,-20005.15"/>
<polygon fill="black" stroke="black" points="26434.49,-20008.65 26444.47,-20005.09 26434.45,-20001.65 26434.49,-20008.65"/>
</g>
<!-- Layer_0_Expert_0_EP0_TP1_PP0 -->
<g id="node15" class="node">
<title>Layer_0_Expert_0_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21243.5,-20154.78 20866.5,-20154.78 20866.5,-20086.78 21243.5,-20086.78 21243.5,-20154.78"/>
<text text-anchor="middle" x="21055" y="-20139.58" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="21055" y="-20124.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="21055" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21055" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_0_EP0_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge14" class="edge">
<title>Layer_0_Expert_0_EP0_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21243.66,-20087.58C21246.45,-20087.29 21249.24,-20087.03 21252,-20086.78 21768.88,-20039.82 25397.29,-20012.4 26434.61,-20005.45"/>
<polygon fill="black" stroke="black" points="26434.84,-20008.95 26444.82,-20005.38 26434.8,-20001.95 26434.84,-20008.95"/>
</g>
<!-- Layer_0_Expert_1_EP0_TP0_PP0 -->
<g id="node16" class="node">
<title>Layer_0_Expert_1_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21638.5,-20154.78 21261.5,-20154.78 21261.5,-20086.78 21638.5,-20086.78 21638.5,-20154.78"/>
<text text-anchor="middle" x="21450" y="-20139.58" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="21450" y="-20124.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="21450" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21450" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_1_EP0_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge16" class="edge">
<title>Layer_0_Expert_1_EP0_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21638.66,-20087.58C21641.45,-20087.3 21644.24,-20087.03 21647,-20086.78 22123.2,-20043.23 25446.66,-20013.7 26434.63,-20005.81"/>
<polygon fill="black" stroke="black" points="26434.74,-20009.31 26444.72,-20005.73 26434.69,-20002.31 26434.74,-20009.31"/>
</g>
<!-- Layer_0_Expert_1_EP0_TP1_PP0 -->
<g id="node17" class="node">
<title>Layer_0_Expert_1_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22033.5,-20154.78 21656.5,-20154.78 21656.5,-20086.78 22033.5,-20086.78 22033.5,-20154.78"/>
<text text-anchor="middle" x="21845" y="-20139.58" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="21845" y="-20124.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="21845" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21845" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_1_EP0_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge18" class="edge">
<title>Layer_0_Expert_1_EP0_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22033.66,-20087.59C22036.46,-20087.3 22039.24,-20087.03 22042,-20086.78 22902.18,-20007.52 25565.61,-20002.64 26434.08,-20003.23"/>
<polygon fill="black" stroke="black" points="26434.22,-20006.73 26444.22,-20003.24 26434.22,-19999.73 26434.22,-20006.73"/>
</g>
<!-- Layer_0_Expert_2_EP0_TP0_PP0 -->
<g id="node18" class="node">
<title>Layer_0_Expert_2_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22428.5,-20154.78 22051.5,-20154.78 22051.5,-20086.78 22428.5,-20086.78 22428.5,-20154.78"/>
<text text-anchor="middle" x="22240" y="-20139.58" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="22240" y="-20124.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="22240" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22240" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_2_EP0_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge20" class="edge">
<title>Layer_0_Expert_2_EP0_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22428.66,-20087.59C22431.46,-20087.31 22434.24,-20087.03 22437,-20086.78 23216.82,-20014.27 25615.88,-20004.85 26434.18,-20003.77"/>
<polygon fill="black" stroke="black" points="26434.34,-20007.27 26444.33,-20003.76 26434.33,-20000.27 26434.34,-20007.27"/>
</g>
<!-- Layer_0_Expert_2_EP0_TP1_PP0 -->
<g id="node19" class="node">
<title>Layer_0_Expert_2_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22823.5,-20154.78 22446.5,-20154.78 22446.5,-20086.78 22823.5,-20086.78 22823.5,-20154.78"/>
<text text-anchor="middle" x="22635" y="-20139.58" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="22635" y="-20124.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="22635" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22635" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_2_EP0_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge22" class="edge">
<title>Layer_0_Expert_2_EP0_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22823.66,-20087.6C22826.46,-20087.31 22829.24,-20087.04 22832,-20086.78 23531.82,-20021.01 25668.69,-20007.26 26434.38,-20004.42"/>
<polygon fill="black" stroke="black" points="26434.45,-20007.92 26444.44,-20004.38 26434.43,-20000.92 26434.45,-20007.92"/>
</g>
<!-- Layer_0_Expert_3_EP0_TP0_PP0 -->
<g id="node20" class="node">
<title>Layer_0_Expert_3_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23218.5,-20154.78 22841.5,-20154.78 22841.5,-20086.78 23218.5,-20086.78 23218.5,-20154.78"/>
<text text-anchor="middle" x="23030" y="-20139.58" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="23030" y="-20124.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="23030" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23030" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_3_EP0_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge24" class="edge">
<title>Layer_0_Expert_3_EP0_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23218.66,-20087.61C23221.46,-20087.32 23224.24,-20087.04 23227,-20086.78 23847.14,-20027.74 25723.87,-20009.92 26434.39,-20005.21"/>
<polygon fill="black" stroke="black" points="26434.52,-20008.71 26444.5,-20005.14 26434.48,-20001.71 26434.52,-20008.71"/>
</g>
<!-- Layer_0_Expert_3_EP0_TP1_PP0 -->
<g id="node21" class="node">
<title>Layer_0_Expert_3_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23613.5,-20154.78 23236.5,-20154.78 23236.5,-20086.78 23613.5,-20086.78 23613.5,-20154.78"/>
<text text-anchor="middle" x="23425" y="-20139.58" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="23425" y="-20124.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="23425" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23425" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_3_EP0_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge26" class="edge">
<title>Layer_0_Expert_3_EP0_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23613.66,-20087.62C23616.46,-20087.33 23619.24,-20087.04 23622,-20086.78 24163.04,-20034.44 25783.07,-20012.9 26434.88,-20006.19"/>
<polygon fill="black" stroke="black" points="26434.92,-20009.69 26444.88,-20006.09 26434.84,-20002.7 26434.92,-20009.69"/>
</g>
<!-- Layer_0_Expert_4_EP1_TP0_PP0 -->
<g id="node22" class="node">
<title>Layer_0_Expert_4_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24008.5,-20154.78 23631.5,-20154.78 23631.5,-20086.78 24008.5,-20086.78 24008.5,-20154.78"/>
<text text-anchor="middle" x="23820" y="-20139.58" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="23820" y="-20124.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="23820" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23820" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_4_EP1_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge28" class="edge">
<title>Layer_0_Expert_4_EP1_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24008.66,-20087.64C24011.46,-20087.34 24014.24,-20087.05 24017,-20086.78 24479.43,-20041.12 25845.86,-20016.3 26435.26,-20007.46"/>
<polygon fill="black" stroke="black" points="26435.65,-20010.96 26445.6,-20007.31 26435.55,-20003.96 26435.65,-20010.96"/>
</g>
<!-- Layer_0_Expert_4_EP1_TP1_PP0 -->
<g id="node23" class="node">
<title>Layer_0_Expert_4_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24403.5,-20154.78 24026.5,-20154.78 24026.5,-20086.78 24403.5,-20086.78 24403.5,-20154.78"/>
<text text-anchor="middle" x="24215" y="-20139.58" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="24215" y="-20124.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="24215" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24215" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_4_EP1_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge30" class="edge">
<title>Layer_0_Expert_4_EP1_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24403.66,-20087.66C24406.46,-20087.35 24409.24,-20087.06 24412,-20086.78 24796.62,-20047.78 25914.23,-20020.25 26436.29,-20009.15"/>
<polygon fill="black" stroke="black" points="26436.68,-20012.64 26446.61,-20008.93 26436.53,-20005.64 26436.68,-20012.64"/>
</g>
<!-- Layer_0_Expert_5_EP1_TP0_PP0 -->
<g id="node24" class="node">
<title>Layer_0_Expert_5_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24798.5,-20154.78 24421.5,-20154.78 24421.5,-20086.78 24798.5,-20086.78 24798.5,-20154.78"/>
<text text-anchor="middle" x="24610" y="-20139.58" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="24610" y="-20124.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="24610" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24610" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_5_EP1_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge32" class="edge">
<title>Layer_0_Expert_5_EP1_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24798.67,-20087.69C24801.46,-20087.37 24804.24,-20087.07 24807,-20086.78 25383.76,-20026.11 26063.29,-20009.57 26434.49,-20005.17"/>
<polygon fill="black" stroke="black" points="26434.61,-20008.67 26444.57,-20005.05 26434.53,-20001.67 26434.61,-20008.67"/>
</g>
<!-- Layer_0_Expert_5_EP1_TP1_PP0 -->
<g id="node25" class="node">
<title>Layer_0_Expert_5_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25193.5,-20154.78 24816.5,-20154.78 24816.5,-20086.78 25193.5,-20086.78 25193.5,-20154.78"/>
<text text-anchor="middle" x="25005" y="-20139.58" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="25005" y="-20124.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="25005" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25005" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_5_EP1_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge34" class="edge">
<title>Layer_0_Expert_5_EP1_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25193.67,-20087.73C25196.47,-20087.4 25199.24,-20087.08 25202,-20086.78 25631.8,-20039.09 26133.65,-20018.37 26436.63,-20009.66"/>
<polygon fill="black" stroke="black" points="26436.98,-20013.15 26446.87,-20009.37 26436.78,-20006.15 26436.98,-20013.15"/>
</g>
<!-- Layer_0_Expert_6_EP1_TP0_PP0 -->
<g id="node26" class="node">
<title>Layer_0_Expert_6_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25588.5,-20154.78 25211.5,-20154.78 25211.5,-20086.78 25588.5,-20086.78 25588.5,-20154.78"/>
<text text-anchor="middle" x="25400" y="-20139.58" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="25400" y="-20124.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="25400" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25400" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_6_EP1_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge36" class="edge">
<title>Layer_0_Expert_6_EP1_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25588.68,-20087.81C25591.47,-20087.45 25594.25,-20087.11 25597,-20086.78 25885.85,-20051.89 26218.72,-20029.36 26444.82,-20016.68"/>
<polygon fill="black" stroke="black" points="26445.05,-20020.17 26454.84,-20016.12 26444.66,-20013.19 26445.05,-20020.17"/>
</g>
<!-- Layer_0_Expert_6_EP1_TP1_PP0 -->
<g id="node27" class="node">
<title>Layer_0_Expert_6_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25983.5,-20154.78 25606.5,-20154.78 25606.5,-20086.78 25983.5,-20086.78 25983.5,-20154.78"/>
<text text-anchor="middle" x="25795" y="-20139.58" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="25795" y="-20124.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="25795" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25795" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_6_EP1_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge38" class="edge">
<title>Layer_0_Expert_6_EP1_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25983.7,-20087.96C25986.49,-20087.56 25989.25,-20087.16 25992,-20086.78 26151.47,-20064.22 26331.49,-20043.42 26471.51,-20028.28"/>
<polygon fill="black" stroke="black" points="26471.96,-20031.75 26481.52,-20027.2 26471.21,-20024.79 26471.96,-20031.75"/>
</g>
<!-- Layer_0_Expert_7_EP1_TP0_PP0 -->
<g id="node28" class="node">
<title>Layer_0_Expert_7_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26378.5,-20154.78 26001.5,-20154.78 26001.5,-20086.78 26378.5,-20086.78 26378.5,-20154.78"/>
<text text-anchor="middle" x="26190" y="-20139.58" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="26190" y="-20124.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="26190" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26190" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_7_EP1_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge40" class="edge">
<title>Layer_0_Expert_7_EP1_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26338.25,-20086.74C26399.91,-20073.01 26471.94,-20056.96 26536.16,-20042.65"/>
<polygon fill="black" stroke="black" points="26536.99,-20046.05 26545.98,-20040.46 26535.46,-20039.22 26536.99,-20046.05"/>
</g>
<!-- Layer_0_Expert_7_EP1_TP1_PP0 -->
<g id="node29" class="node">
<title>Layer_0_Expert_7_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26773.5,-20154.78 26396.5,-20154.78 26396.5,-20086.78 26773.5,-20086.78 26773.5,-20154.78"/>
<text text-anchor="middle" x="26585" y="-20139.58" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="26585" y="-20124.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="26585" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26585" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_7_EP1_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge42" class="edge">
<title>Layer_0_Expert_7_EP1_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26621.11,-20086.51C26631.15,-20077.26 26642.32,-20066.97 26653.27,-20056.88"/>
<polygon fill="black" stroke="black" points="26655.82,-20059.29 26660.8,-20049.94 26651.08,-20054.14 26655.82,-20059.29"/>
</g>
<!-- Layer_0_Expert_8_EP2_TP0_PP0 -->
<g id="node30" class="node">
<title>Layer_0_Expert_8_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27168.5,-20154.78 26791.5,-20154.78 26791.5,-20086.78 27168.5,-20086.78 27168.5,-20154.78"/>
<text text-anchor="middle" x="26980" y="-20139.58" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="26980" y="-20124.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="26980" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26980" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_8_EP2_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge44" class="edge">
<title>Layer_0_Expert_8_EP2_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26903.28,-20086.67C26877.74,-20075.65 26848.78,-20063.15 26821.23,-20051.26"/>
<polygon fill="black" stroke="black" points="26822.51,-20048 26811.94,-20047.25 26819.74,-20054.43 26822.51,-20048"/>
</g>
<!-- Layer_0_Expert_8_EP2_TP1_PP0 -->
<g id="node31" class="node">
<title>Layer_0_Expert_8_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27563.5,-20154.78 27186.5,-20154.78 27186.5,-20086.78 27563.5,-20086.78 27563.5,-20154.78"/>
<text text-anchor="middle" x="27375" y="-20139.58" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="27375" y="-20124.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="27375" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27375" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_8_EP2_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge46" class="edge">
<title>Layer_0_Expert_8_EP2_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27186.06,-20086.74C27099.68,-20071.64 26997.32,-20053.75 26909.78,-20038.44"/>
<polygon fill="black" stroke="black" points="26910.18,-20034.96 26899.73,-20036.69 26908.98,-20041.86 26910.18,-20034.96"/>
</g>
<!-- Layer_0_Expert_9_EP2_TP0_PP0 -->
<g id="node32" class="node">
<title>Layer_0_Expert_9_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27958.5,-20154.78 27581.5,-20154.78 27581.5,-20086.78 27958.5,-20086.78 27958.5,-20154.78"/>
<text text-anchor="middle" x="27770" y="-20139.58" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="27770" y="-20124.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="27770" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27770" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_9_EP2_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge48" class="edge">
<title>Layer_0_Expert_9_EP2_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27581.4,-20088.04C27578.25,-20087.6 27575.11,-20087.18 27572,-20086.78 27367.99,-20059.96 27135.71,-20038.05 26963.86,-20023.48"/>
<polygon fill="black" stroke="black" points="26963.93,-20019.97 26953.67,-20022.61 26963.34,-20026.94 26963.93,-20019.97"/>
</g>
<!-- Layer_0_Expert_9_EP2_TP1_PP0 -->
<g id="node33" class="node">
<title>Layer_0_Expert_9_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28353.5,-20154.78 27976.5,-20154.78 27976.5,-20086.78 28353.5,-20086.78 28353.5,-20154.78"/>
<text text-anchor="middle" x="28165" y="-20139.58" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="28165" y="-20124.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="28165" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28165" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_9_EP2_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge50" class="edge">
<title>Layer_0_Expert_9_EP2_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27976.42,-20087.91C27973.26,-20087.51 27970.12,-20087.14 27967,-20086.78 27628.41,-20047.46 27236.15,-20025.21 26981.31,-20013.83"/>
<polygon fill="black" stroke="black" points="26981.32,-20010.32 26971.17,-20013.37 26981.01,-20017.32 26981.32,-20010.32"/>
</g>
<!-- Layer_0_Expert_10_EP2_TP0_PP0 -->
<g id="node34" class="node">
<title>Layer_0_Expert_10_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28748.5,-20154.78 28371.5,-20154.78 28371.5,-20086.78 28748.5,-20086.78 28748.5,-20154.78"/>
<text text-anchor="middle" x="28560" y="-20139.58" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="28560" y="-20124.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="28560" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28560" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_10_EP2_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge52" class="edge">
<title>Layer_0_Expert_10_EP2_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28371.43,-20087.84C28368.26,-20087.47 28365.12,-20087.11 28362,-20086.78 27879.79,-20034.63 27314.74,-20015.13 26986.37,-20007.89"/>
<polygon fill="black" stroke="black" points="26986.31,-20004.39 26976.24,-20007.67 26986.16,-20011.39 26986.31,-20004.39"/>
</g>
<!-- Layer_0_Expert_10_EP2_TP1_PP0 -->
<g id="node35" class="node">
<title>Layer_0_Expert_10_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29143.5,-20154.78 28766.5,-20154.78 28766.5,-20086.78 29143.5,-20086.78 29143.5,-20154.78"/>
<text text-anchor="middle" x="28955" y="-20139.58" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="28955" y="-20124.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="28955" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28955" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_10_EP2_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge54" class="edge">
<title>Layer_0_Expert_10_EP2_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28766.43,-20087.79C28763.27,-20087.44 28760.12,-20087.1 28757,-20086.78 28126.58,-20021.7 27381.97,-20006.97 26987.94,-20004.02"/>
<polygon fill="black" stroke="black" points="26987.85,-20000.52 26977.83,-20003.95 26987.8,-20007.52 26987.85,-20000.52"/>
</g>
<!-- Layer_0_Expert_11_EP2_TP0_PP0 -->
<g id="node36" class="node">
<title>Layer_0_Expert_11_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29538.5,-20154.78 29161.5,-20154.78 29161.5,-20086.78 29538.5,-20086.78 29538.5,-20154.78"/>
<text text-anchor="middle" x="29350" y="-20139.58" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="29350" y="-20124.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="29350" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29350" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_11_EP2_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge56" class="edge">
<title>Layer_0_Expert_11_EP2_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29161.43,-20087.77C29158.27,-20087.42 29155.12,-20087.09 29152,-20086.78 28739.5,-20045.56 27533.08,-20018.84 26986.18,-20008.51"/>
<polygon fill="black" stroke="black" points="26985.85,-20005 26975.78,-20008.31 26985.72,-20012 26985.85,-20005"/>
</g>
<!-- Layer_0_Expert_11_EP2_TP1_PP0 -->
<g id="node37" class="node">
<title>Layer_0_Expert_11_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29933.5,-20154.78 29556.5,-20154.78 29556.5,-20086.78 29933.5,-20086.78 29933.5,-20154.78"/>
<text text-anchor="middle" x="29745" y="-20139.58" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="29745" y="-20124.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="29745" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29745" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_11_EP2_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge58" class="edge">
<title>Layer_0_Expert_11_EP2_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29556.43,-20087.75C29553.27,-20087.4 29550.12,-20087.08 29547,-20086.78 29056.38,-20038.93 27599.36,-20015.11 26986.98,-20007"/>
<polygon fill="black" stroke="black" points="26986.74,-20003.49 26976.69,-20006.86 26986.64,-20010.49 26986.74,-20003.49"/>
</g>
<!-- Layer_0_Expert_12_EP3_TP0_PP0 -->
<g id="node38" class="node">
<title>Layer_0_Expert_12_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30328.5,-20154.78 29951.5,-20154.78 29951.5,-20086.78 30328.5,-20086.78 30328.5,-20154.78"/>
<text text-anchor="middle" x="30140" y="-20139.58" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="30140" y="-20124.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="30140" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30140" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_12_EP3_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge60" class="edge">
<title>Layer_0_Expert_12_EP3_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29951.44,-20087.73C29948.27,-20087.39 29945.12,-20087.07 29942,-20086.78 29372.57,-20032.27 27660.73,-20011.88 26987.37,-20005.84"/>
<polygon fill="black" stroke="black" points="26987.08,-20002.34 26977.04,-20005.75 26987.01,-20009.34 26987.08,-20002.34"/>
</g>
<!-- Layer_0_Expert_12_EP3_TP1_PP0 -->
<g id="node39" class="node">
<title>Layer_0_Expert_12_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30723.5,-20154.78 30346.5,-20154.78 30346.5,-20086.78 30723.5,-20086.78 30723.5,-20154.78"/>
<text text-anchor="middle" x="30535" y="-20139.58" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="30535" y="-20124.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="30535" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30535" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_12_EP3_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge62" class="edge">
<title>Layer_0_Expert_12_EP3_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30346.44,-20087.72C30343.27,-20087.38 30340.12,-20087.07 30337,-20086.78 29688.25,-20025.59 27718.37,-20009.03 26987.65,-20004.93"/>
<polygon fill="black" stroke="black" points="26987.53,-20001.43 26977.51,-20004.88 26987.49,-20008.43 26987.53,-20001.43"/>
</g>
<!-- Layer_0_Expert_13_EP3_TP0_PP0 -->
<g id="node40" class="node">
<title>Layer_0_Expert_13_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31118.5,-20154.78 30741.5,-20154.78 30741.5,-20086.78 31118.5,-20086.78 31118.5,-20154.78"/>
<text text-anchor="middle" x="30930" y="-20139.58" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="30930" y="-20124.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="30930" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30930" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_13_EP3_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge64" class="edge">
<title>Layer_0_Expert_13_EP3_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30741.44,-20087.71C30738.27,-20087.38 30735.12,-20087.07 30732,-20086.78 30003.4,-20018.89 27772.39,-20006.47 26987.59,-20004.2"/>
<polygon fill="black" stroke="black" points="26987.58,-20000.7 26977.57,-20004.17 26987.56,-20007.7 26987.58,-20000.7"/>
</g>
<!-- Layer_0_Expert_13_EP3_TP1_PP0 -->
<g id="node41" class="node">
<title>Layer_0_Expert_13_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31513.5,-20154.78 31136.5,-20154.78 31136.5,-20086.78 31513.5,-20086.78 31513.5,-20154.78"/>
<text text-anchor="middle" x="31325" y="-20139.58" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="31325" y="-20124.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="31325" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31325" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_13_EP3_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge66" class="edge">
<title>Layer_0_Expert_13_EP3_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31136.44,-20087.7C31133.27,-20087.37 31130.12,-20087.06 31127,-20086.78 30318.27,-20012.18 27824.31,-20004.15 26987.79,-20003.6"/>
<polygon fill="black" stroke="black" points="26987.72,-20000.1 26977.72,-20003.59 26987.72,-20007.1 26987.72,-20000.1"/>
</g>
<!-- Layer_0_Expert_14_EP3_TP0_PP0 -->
<g id="node42" class="node">
<title>Layer_0_Expert_14_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31908.5,-20154.78 31531.5,-20154.78 31531.5,-20086.78 31908.5,-20086.78 31908.5,-20154.78"/>
<text text-anchor="middle" x="31720" y="-20139.58" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="31720" y="-20124.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="31720" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31720" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_14_EP3_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge68" class="edge">
<title>Layer_0_Expert_14_EP3_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31531.44,-20087.69C31528.27,-20087.37 31525.12,-20087.06 31522,-20086.78 30632.78,-20005.45 27873.68,-20002.01 26987.83,-20003.09"/>
<polygon fill="black" stroke="black" points="26987.81,-19999.59 26977.81,-20003.1 26987.82,-20006.59 26987.81,-19999.59"/>
</g>
<!-- Layer_0_Expert_14_EP3_TP1_PP0 -->
<g id="node43" class="node">
<title>Layer_0_Expert_14_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="32303.5,-20154.78 31926.5,-20154.78 31926.5,-20086.78 32303.5,-20086.78 32303.5,-20154.78"/>
<text text-anchor="middle" x="32115" y="-20139.58" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="32115" y="-20124.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="32115" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32115" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_14_EP3_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge70" class="edge">
<title>Layer_0_Expert_14_EP3_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31926.44,-20087.69C31923.27,-20087.36 31920.12,-20087.06 31917,-20086.78 31426.23,-20042.21 27994.14,-20013.28 26987.74,-20005.69"/>
<polygon fill="black" stroke="black" points="26987.5,-20002.19 26977.47,-20005.61 26987.45,-20009.19 26987.5,-20002.19"/>
</g>
<!-- Layer_0_Expert_15_EP3_TP0_PP0 -->
<g id="node44" class="node">
<title>Layer_0_Expert_15_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="32698.5,-20154.78 32321.5,-20154.78 32321.5,-20086.78 32698.5,-20086.78 32698.5,-20154.78"/>
<text text-anchor="middle" x="32510" y="-20139.58" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="32510" y="-20124.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="32510" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32510" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_15_EP3_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge72" class="edge">
<title>Layer_0_Expert_15_EP3_TP0_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M32321.44,-20087.68C32318.27,-20087.36 32315.12,-20087.06 32312,-20086.78 31780.52,-20038.82 28042.98,-20012.02 26987.8,-20005.35"/>
<polygon fill="black" stroke="black" points="26987.44,-20001.85 26977.42,-20005.29 26987.4,-20008.85 26987.44,-20001.85"/>
</g>
<!-- Layer_0_Expert_15_EP3_TP1_PP0 -->
<g id="node45" class="node">
<title>Layer_0_Expert_15_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="33093.5,-20154.78 32716.5,-20154.78 32716.5,-20086.78 33093.5,-20086.78 33093.5,-20154.78"/>
<text text-anchor="middle" x="32905" y="-20139.58" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="32905" y="-20124.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="32905" y="-20109.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32905" y="-20094.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_Expert_15_EP3_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0 -->
<g id="edge74" class="edge">
<title>Layer_0_Expert_15_EP3_TP1_PP0&#45;&gt;Layer_0_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M32716.44,-20087.68C32713.27,-20087.36 32710.12,-20087.06 32707,-20086.78 32134.65,-20035.41 28089.4,-20010.85 26987.55,-20005.06"/>
<polygon fill="black" stroke="black" points="26987.54,-20001.56 26977.52,-20005.01 26987.5,-20008.56 26987.54,-20001.56"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_0_EP0_TP0_PP0 -->
<g id="edge11" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_0_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26713.45,-20236.64C25617.99,-20231.3 21490.95,-20207.9 20859.03,-20154.88"/>
<polygon fill="black" stroke="black" points="20858.92,-20151.36 20848.66,-20153.98 20858.32,-20158.33 20858.92,-20151.36"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_0_EP0_TP1_PP0 -->
<g id="edge13" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_0_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26713.4,-20236.37C25663.52,-20230.18 21843.45,-20204.51 21253.75,-20154.86"/>
<polygon fill="black" stroke="black" points="21253.92,-20151.36 21243.66,-20153.98 21253.31,-20158.33 21253.92,-20151.36"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_1_EP0_TP0_PP0 -->
<g id="edge15" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_1_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26713.53,-20236.06C25711.29,-20228.98 22197.53,-20201.15 21648.81,-20154.86"/>
<polygon fill="black" stroke="black" points="21648.92,-20151.36 21638.66,-20153.97 21648.31,-20158.33 21648.92,-20151.36"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_1_EP0_TP1_PP0 -->
<g id="edge17" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_1_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26713.77,-20235.71C25761.01,-20227.68 22551.17,-20197.79 22043.75,-20154.86"/>
<polygon fill="black" stroke="black" points="22043.93,-20151.36 22033.66,-20153.97 22043.31,-20158.33 22043.93,-20151.36"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_2_EP0_TP0_PP0 -->
<g id="edge19" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_2_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26713.43,-20238.16C25874.69,-20238.28 23295.17,-20232.24 22438.65,-20154.88"/>
<polygon fill="black" stroke="black" points="22438.93,-20151.39 22428.66,-20153.96 22438.3,-20158.36 22438.93,-20151.39"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_2_EP0_TP1_PP0 -->
<g id="edge21" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_2_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26713.51,-20237.61C25924.88,-20236.06 23609.98,-20225.52 22833.85,-20154.89"/>
<polygon fill="black" stroke="black" points="22833.94,-20151.39 22823.66,-20153.96 22833.29,-20158.36 22833.94,-20151.39"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_3_EP0_TP0_PP0 -->
<g id="edge23" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_3_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26713.52,-20236.94C25977.31,-20233.63 23924.61,-20218.82 23228.8,-20154.89"/>
<polygon fill="black" stroke="black" points="23228.94,-20151.39 23218.66,-20153.95 23228.29,-20158.36 23228.94,-20151.39"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_3_EP0_TP1_PP0 -->
<g id="edge25" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_3_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26713.55,-20236.13C26032.69,-20230.93 24240.03,-20212.16 23623.98,-20154.91"/>
<polygon fill="black" stroke="black" points="23623.94,-20151.39 23613.66,-20153.94 23623.29,-20158.36 23623.94,-20151.39"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_4_EP1_TP0_PP0 -->
<g id="edge27" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_4_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26714.1,-20235.1C26092.17,-20227.91 24555.35,-20205.53 24018.82,-20154.9"/>
<polygon fill="black" stroke="black" points="24018.95,-20151.39 24008.66,-20153.92 24018.28,-20158.36 24018.95,-20151.39"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_4_EP1_TP1_PP0 -->
<g id="edge29" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_4_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26714.88,-20233.78C26155.94,-20224.44 24871.2,-20198.95 24413.65,-20154.89"/>
<polygon fill="black" stroke="black" points="24413.96,-20151.4 24403.66,-20153.91 24413.27,-20158.37 24413.96,-20151.4"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_5_EP1_TP0_PP0 -->
<g id="edge31" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_5_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26713.29,-20238.61C26304.7,-20237.29 25499.38,-20225.02 24808.82,-20154.92"/>
<polygon fill="black" stroke="black" points="24808.97,-20151.42 24798.66,-20153.88 24808.26,-20158.38 24808.97,-20151.42"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_5_EP1_TP1_PP0 -->
<g id="edge33" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_5_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26713.79,-20235.31C26367.58,-20229.74 25744.13,-20212.04 25203.62,-20154.91"/>
<polygon fill="black" stroke="black" points="25203.98,-20151.43 25193.67,-20153.85 25203.24,-20158.39 25203.98,-20151.43"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_6_EP1_TP0_PP0 -->
<g id="edge35" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_6_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26717.37,-20230.36C26441.03,-20220.56 25993.41,-20199.25 25598.86,-20154.95"/>
<polygon fill="black" stroke="black" points="25599,-20151.44 25588.67,-20153.8 25598.22,-20158.4 25599,-20151.44"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_6_EP1_TP1_PP0 -->
<g id="edge37" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_6_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26729.17,-20222.47C26531.75,-20209.01 26249.55,-20186.77 25993.92,-20154.99"/>
<polygon fill="black" stroke="black" points="25994.04,-20151.48 25983.69,-20153.71 25993.17,-20158.42 25994.04,-20151.48"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_7_EP1_TP0_PP0 -->
<g id="edge39" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_7_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26768.13,-20209.57C26657.8,-20194.5 26520.43,-20175.2 26388.98,-20155.07"/>
<polygon fill="black" stroke="black" points="26389.13,-20151.55 26378.71,-20153.49 26388.07,-20158.47 26389.13,-20151.55"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_7_EP1_TP1_PP0 -->
<g id="edge41" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_7_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26842.96,-20197.58C26798.73,-20184.59 26750.02,-20170.27 26706.96,-20157.62"/>
<polygon fill="black" stroke="black" points="26707.87,-20154.24 26697.29,-20154.78 26705.9,-20160.95 26707.87,-20154.24"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_8_EP2_TP0_PP0 -->
<g id="edge43" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_8_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26980,-20190.64C26980,-20182.26 26980,-20173.56 26980,-20165.28"/>
<polygon fill="black" stroke="black" points="26983.5,-20165.08 26980,-20155.08 26976.5,-20165.08 26983.5,-20165.08"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_8_EP2_TP1_PP0 -->
<g id="edge45" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_8_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M27117.04,-20197.58C27161.27,-20184.59 27209.98,-20170.27 27253.04,-20157.62"/>
<polygon fill="black" stroke="black" points="27254.1,-20160.95 27262.71,-20154.78 27252.13,-20154.24 27254.1,-20160.95"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_9_EP2_TP0_PP0 -->
<g id="edge47" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_9_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M27191.51,-20209.52C27301.76,-20194.41 27439.06,-20175.09 27571.45,-20154.85"/>
<polygon fill="black" stroke="black" points="27572.02,-20158.3 27581.37,-20153.33 27570.96,-20151.38 27572.02,-20158.3"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_9_EP2_TP1_PP0 -->
<g id="edge49" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_9_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M27230.57,-20222.4C27427.78,-20208.9 27709.7,-20186.64 27966.14,-20154.85"/>
<polygon fill="black" stroke="black" points="27966.92,-20158.28 27976.41,-20153.57 27966.05,-20151.33 27966.92,-20158.28"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_10_EP2_TP0_PP0 -->
<g id="edge51" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_10_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M27242.43,-20230.29C27518.57,-20220.43 27965.86,-20199.07 28361.21,-20154.82"/>
<polygon fill="black" stroke="black" points="28361.87,-20158.27 28371.42,-20153.67 28361.09,-20151.31 28361.87,-20158.27"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_10_EP2_TP1_PP0 -->
<g id="edge53" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_10_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M27246.06,-20235.23C27592.06,-20229.58 28215.15,-20211.8 28756.46,-20154.78"/>
<polygon fill="black" stroke="black" points="28756.85,-20158.26 28766.43,-20153.73 28756.11,-20151.3 28756.85,-20158.26"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_11_EP2_TP0_PP0 -->
<g id="edge55" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_11_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M27246.58,-20238.53C27654.97,-20237.12 28459.91,-20224.71 29151.26,-20154.8"/>
<polygon fill="black" stroke="black" points="29151.84,-20158.26 29161.43,-20153.77 29151.13,-20151.3 29151.84,-20158.26"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_11_EP2_TP1_PP0 -->
<g id="edge57" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_11_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M27245.28,-20233.74C27804.14,-20224.35 29088.04,-20198.74 29546.42,-20154.77"/>
<polygon fill="black" stroke="black" points="29546.82,-20158.25 29556.43,-20153.79 29546.14,-20151.28 29546.82,-20158.25"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_12_EP3_TP0_PP0 -->
<g id="edge59" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_12_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M27245.8,-20235.07C27867.52,-20227.81 29403.81,-20205.31 29941.26,-20154.78"/>
<polygon fill="black" stroke="black" points="29941.81,-20158.25 29951.44,-20153.81 29941.15,-20151.28 29941.81,-20158.25"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_12_EP3_TP1_PP0 -->
<g id="edge61" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_12_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M27246.37,-20236.1C27927.02,-20230.83 29719.13,-20211.9 30336.1,-20154.8"/>
<polygon fill="black" stroke="black" points="30336.81,-20158.25 30346.44,-20153.83 30336.15,-20151.28 30336.81,-20158.25"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_13_EP3_TP0_PP0 -->
<g id="edge63" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_13_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M27246.41,-20236.91C27982.41,-20233.52 30034.55,-20218.53 30731.28,-20154.78"/>
<polygon fill="black" stroke="black" points="30731.8,-20158.25 30741.44,-20153.84 30731.16,-20151.28 30731.8,-20158.25"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_13_EP3_TP1_PP0 -->
<g id="edge65" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_13_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M27246.78,-20237.58C28035.54,-20235.94 30349.3,-20225.19 31126.24,-20154.78"/>
<polygon fill="black" stroke="black" points="31126.8,-20158.25 31136.44,-20153.85 31126.16,-20151.27 31126.8,-20158.25"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_14_EP3_TP0_PP0 -->
<g id="edge67" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_14_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M27246.88,-20238.13C28085.81,-20238.15 30664.12,-20231.87 31521.43,-20154.76"/>
<polygon fill="black" stroke="black" points="31521.8,-20158.25 31531.44,-20153.85 31521.16,-20151.27 31521.8,-20158.25"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_14_EP3_TP1_PP0 -->
<g id="edge69" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_14_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M27246.18,-20235.69C28198.74,-20227.62 31407.92,-20197.6 31916.33,-20154.75"/>
<polygon fill="black" stroke="black" points="31916.78,-20158.22 31926.44,-20153.86 31916.17,-20151.25 31916.78,-20158.22"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_15_EP3_TP0_PP0 -->
<g id="edge71" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_15_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M27246.42,-20236.05C28248.47,-20228.92 31761.55,-20200.93 32311.27,-20154.75"/>
<polygon fill="black" stroke="black" points="32311.78,-20158.22 32321.44,-20153.87 32311.17,-20151.25 32311.78,-20158.22"/>
</g>
<!-- Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_15_EP3_TP1_PP0 -->
<g id="edge73" class="edge">
<title>Layer_0_A2A_Dispatch_PP0&#45;&gt;Layer_0_Expert_15_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M27246.55,-20236.36C28296.25,-20230.12 32115.63,-20204.28 32706.33,-20154.75"/>
<polygon fill="black" stroke="black" points="32706.78,-20158.22 32716.44,-20153.87 32706.18,-20151.25 32706.78,-20158.22"/>
</g>
<!-- Layer_0_MLP_Out_TP0_PP0 -->
<g id="node48" class="node">
<title>Layer_0_MLP_Out_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26812.5,-19918.61 26435.5,-19918.61 26435.5,-19850.61 26812.5,-19850.61 26812.5,-19918.61"/>
<text text-anchor="middle" x="26624" y="-19903.41" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="26624" y="-19888.41" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26624" y="-19873.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26624" y="-19858.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_A2A_Combine_PP0&#45;&gt;Layer_0_MLP_Out_TP0_PP0 -->
<g id="edge75" class="edge">
<title>Layer_0_A2A_Combine_PP0&#45;&gt;Layer_0_MLP_Out_TP0_PP0</title>
<path fill="none" stroke="black" d="M26675.86,-19954.81C26668.93,-19945.56 26661.71,-19935.92 26654.92,-19926.87"/>
<polygon fill="black" stroke="black" points="26657.64,-19924.66 26648.84,-19918.76 26652.04,-19928.86 26657.64,-19924.66"/>
</g>
<!-- Layer_0_MLP_Out_TP1_PP0 -->
<g id="node49" class="node">
<title>Layer_0_MLP_Out_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="27207.5,-19918.61 26830.5,-19918.61 26830.5,-19850.61 27207.5,-19850.61 27207.5,-19918.61"/>
<text text-anchor="middle" x="27019" y="-19903.41" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="27019" y="-19888.41" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="27019" y="-19873.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27019" y="-19858.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_0_A2A_Combine_PP0&#45;&gt;Layer_0_MLP_Out_TP1_PP0 -->
<g id="edge77" class="edge">
<title>Layer_0_A2A_Combine_PP0&#45;&gt;Layer_0_MLP_Out_TP1_PP0</title>
<path fill="none" stroke="black" d="M26823.94,-19959.13C26855.99,-19947.05 26890.6,-19934 26921.65,-19922.3"/>
<polygon fill="black" stroke="black" points="26923.04,-19925.52 26931.16,-19918.72 26920.57,-19918.97 26923.04,-19925.52"/>
</g>
<!-- Layer_0_MLP_AllReduce_PP0 -->
<g id="node50" class="node">
<title>Layer_0_MLP_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26849" cy="-19766.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26849" y="-19785.33" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="26849" y="-19770.33" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26849" y="-19755.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26849" y="-19740.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_0_MLP_Out_TP0_PP0&#45;&gt;Layer_0_MLP_AllReduce_PP0 -->
<g id="edge76" class="edge">
<title>Layer_0_MLP_Out_TP0_PP0&#45;&gt;Layer_0_MLP_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26688.17,-19850.5C26708.5,-19840.02 26731.41,-19828.19 26753.44,-19816.83"/>
<polygon fill="black" stroke="black" points="26755.21,-19819.85 26762.49,-19812.16 26752,-19813.63 26755.21,-19819.85"/>
</g>
<!-- Layer_0_MLP_Out_TP1_PP0&#45;&gt;Layer_0_MLP_AllReduce_PP0 -->
<g id="edge78" class="edge">
<title>Layer_0_MLP_Out_TP1_PP0&#45;&gt;Layer_0_MLP_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26970.28,-19850.34C26955.96,-19840.56 26939.95,-19829.63 26924.37,-19818.99"/>
<polygon fill="black" stroke="black" points="26926.01,-19815.87 26915.78,-19813.12 26922.06,-19821.65 26926.01,-19815.87"/>
</g>
<!-- Layer_0_LayerNorm_PP0 -->
<g id="node51" class="node">
<title>Layer_0_LayerNorm_PP0</title>
<polygon fill="lightgreen" stroke="black" points="27037.5,-19682.44 26660.5,-19682.44 26660.5,-19614.44 27037.5,-19614.44 27037.5,-19682.44"/>
<text text-anchor="middle" x="26849" y="-19667.24" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26849" y="-19652.24" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26849" y="-19637.24" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26849" y="-19622.24" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_0_MLP_AllReduce_PP0&#45;&gt;Layer_0_LayerNorm_PP0 -->
<g id="edge79" class="edge">
<title>Layer_0_MLP_AllReduce_PP0&#45;&gt;Layer_0_LayerNorm_PP0</title>
<path fill="none" stroke="black" d="M26849,-19718.31C26849,-19709.92 26849,-19701.23 26849,-19692.95"/>
<polygon fill="black" stroke="black" points="26852.5,-19692.75 26849,-19682.75 26845.5,-19692.75 26852.5,-19692.75"/>
</g>
<!-- Layer_1_QKV_TP0_PP0 -->
<g id="node52" class="node">
<title>Layer_1_QKV_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="27039.5,-19578.44 26658.5,-19578.44 26658.5,-19510.44 27039.5,-19510.44 27039.5,-19578.44"/>
<text text-anchor="middle" x="26849" y="-19563.24" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="26849" y="-19548.24" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26849" y="-19533.24" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26849" y="-19518.24" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_0_LayerNorm_PP0&#45;&gt;Layer_1_QKV_TP0_PP0 -->
<g id="edge80" class="edge">
<title>Layer_0_LayerNorm_PP0&#45;&gt;Layer_1_QKV_TP0_PP0</title>
<path fill="none" stroke="black" d="M26849,-19614.33C26849,-19606.22 26849,-19597.42 26849,-19588.91"/>
<polygon fill="black" stroke="black" points="26852.5,-19588.74 26849,-19578.74 26845.5,-19588.74 26852.5,-19588.74"/>
</g>
<!-- Layer_1_QKV_AllReduce_PP0 -->
<g id="node54" class="node">
<title>Layer_1_QKV_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26513" cy="-19426.36" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="26513" y="-19445.16" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="26513" y="-19430.16" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26513" y="-19415.16" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="26513" y="-19400.16" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_1_QKV_TP0_PP0&#45;&gt;Layer_1_QKV_AllReduce_PP0 -->
<g id="edge81" class="edge">
<title>Layer_1_QKV_TP0_PP0&#45;&gt;Layer_1_QKV_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26753.17,-19510.33C26719.42,-19498.68 26680.89,-19485.36 26644.71,-19472.86"/>
<polygon fill="black" stroke="black" points="26645.66,-19469.49 26635.07,-19469.53 26643.38,-19476.11 26645.66,-19469.49"/>
</g>
<!-- Layer_1_QKV_TP1_PP0 -->
<g id="node53" class="node">
<title>Layer_1_QKV_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26640.5,-19578.44 26259.5,-19578.44 26259.5,-19510.44 26640.5,-19510.44 26640.5,-19578.44"/>
<text text-anchor="middle" x="26450" y="-19563.24" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="26450" y="-19548.24" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26450" y="-19533.24" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26450" y="-19518.24" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_1_QKV_TP1_PP0&#45;&gt;Layer_1_QKV_AllReduce_PP0 -->
<g id="edge85" class="edge">
<title>Layer_1_QKV_TP1_PP0&#45;&gt;Layer_1_QKV_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26468.05,-19510.18C26472.58,-19501.84 26477.56,-19492.66 26482.51,-19483.53"/>
<polygon fill="black" stroke="black" points="26485.74,-19484.93 26487.43,-19474.47 26479.59,-19481.59 26485.74,-19484.93"/>
</g>
<!-- Layer_1_Attention_TP0_PP0 -->
<g id="node55" class="node">
<title>Layer_1_Attention_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26411.5,-19342.28 26030.5,-19342.28 26030.5,-19274.28 26411.5,-19274.28 26411.5,-19342.28"/>
<text text-anchor="middle" x="26221" y="-19327.08" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="26221" y="-19312.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26221" y="-19297.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="26221" y="-19282.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_1_QKV_AllReduce_PP0&#45;&gt;Layer_1_Attention_TP0_PP0 -->
<g id="edge82" class="edge">
<title>Layer_1_QKV_AllReduce_PP0&#45;&gt;Layer_1_Attention_TP0_PP0</title>
<path fill="none" stroke="black" d="M26404.27,-19382.13C26374.55,-19370.32 26342.62,-19357.63 26313.88,-19346.2"/>
<polygon fill="black" stroke="black" points="26314.85,-19342.82 26304.26,-19342.38 26312.26,-19349.32 26314.85,-19342.82"/>
</g>
<!-- Layer_1_Attention_TP1_PP0 -->
<g id="node56" class="node">
<title>Layer_1_Attention_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26810.5,-19342.28 26429.5,-19342.28 26429.5,-19274.28 26810.5,-19274.28 26810.5,-19342.28"/>
<text text-anchor="middle" x="26620" y="-19327.08" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="26620" y="-19312.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26620" y="-19297.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="26620" y="-19282.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_1_QKV_AllReduce_PP0&#45;&gt;Layer_1_Attention_TP1_PP0 -->
<g id="edge86" class="edge">
<title>Layer_1_QKV_AllReduce_PP0&#45;&gt;Layer_1_Attention_TP1_PP0</title>
<path fill="none" stroke="black" d="M26555.9,-19378.81C26564.63,-19369.35 26573.74,-19359.47 26582.26,-19350.22"/>
<polygon fill="black" stroke="black" points="26585.06,-19352.34 26589.27,-19342.62 26579.92,-19347.6 26585.06,-19352.34"/>
</g>
<!-- Layer_1_AttnOut_TP0_PP0 -->
<g id="node57" class="node">
<title>Layer_1_AttnOut_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26410.5,-19238.28 26033.5,-19238.28 26033.5,-19170.28 26410.5,-19170.28 26410.5,-19238.28"/>
<text text-anchor="middle" x="26222" y="-19223.08" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="26222" y="-19208.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26222" y="-19193.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="26222" y="-19178.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Attention_TP0_PP0&#45;&gt;Layer_1_AttnOut_TP0_PP0 -->
<g id="edge83" class="edge">
<title>Layer_1_Attention_TP0_PP0&#45;&gt;Layer_1_AttnOut_TP0_PP0</title>
<path fill="none" stroke="black" d="M26221.32,-19274.16C26221.4,-19266.05 26221.49,-19257.26 26221.57,-19248.75"/>
<polygon fill="black" stroke="black" points="26225.08,-19248.61 26221.67,-19238.58 26218.08,-19248.54 26225.08,-19248.61"/>
</g>
<!-- Layer_1_AttnOut_TP1_PP0 -->
<g id="node58" class="node">
<title>Layer_1_AttnOut_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26807.5,-19238.28 26430.5,-19238.28 26430.5,-19170.28 26807.5,-19170.28 26807.5,-19238.28"/>
<text text-anchor="middle" x="26619" y="-19223.08" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="26619" y="-19208.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26619" y="-19193.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="26619" y="-19178.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Attention_TP1_PP0&#45;&gt;Layer_1_AttnOut_TP1_PP0 -->
<g id="edge87" class="edge">
<title>Layer_1_Attention_TP1_PP0&#45;&gt;Layer_1_AttnOut_TP1_PP0</title>
<path fill="none" stroke="black" d="M26619.68,-19274.16C26619.6,-19266.05 26619.51,-19257.26 26619.43,-19248.75"/>
<polygon fill="black" stroke="black" points="26622.92,-19248.54 26619.33,-19238.58 26615.92,-19248.61 26622.92,-19248.54"/>
</g>
<!-- Layer_1_AttnOut_AllReduce_PP0 -->
<g id="node59" class="node">
<title>Layer_1_AttnOut_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26275" cy="-19086.19" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26275" y="-19104.99" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="26275" y="-19089.99" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26275" y="-19074.99" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26275" y="-19059.99" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_1_AttnOut_TP0_PP0&#45;&gt;Layer_1_AttnOut_AllReduce_PP0 -->
<g id="edge84" class="edge">
<title>Layer_1_AttnOut_TP0_PP0&#45;&gt;Layer_1_AttnOut_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26237.19,-19170.01C26240.96,-19161.76 26245.1,-19152.68 26249.22,-19143.65"/>
<polygon fill="black" stroke="black" points="26252.52,-19144.85 26253.49,-19134.3 26246.15,-19141.95 26252.52,-19144.85"/>
</g>
<!-- Layer_1_AttnOut_TP1_PP0&#45;&gt;Layer_1_AttnOut_AllReduce_PP0 -->
<g id="edge88" class="edge">
<title>Layer_1_AttnOut_TP1_PP0&#45;&gt;Layer_1_AttnOut_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26520.88,-19170.17C26485.73,-19158.31 26445.5,-19144.73 26407.9,-19132.04"/>
<polygon fill="black" stroke="black" points="26409,-19128.72 26398.4,-19128.83 26406.76,-19135.35 26409,-19128.72"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0 -->
<g id="node96" class="node">
<title>Layer_1_A2A_Dispatch_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26275" cy="-18954.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26275" y="-18972.83" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="26275" y="-18957.83" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26275" y="-18942.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26275" y="-18927.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_1_AttnOut_AllReduce_PP0&#45;&gt;Layer_1_A2A_Dispatch_PP0 -->
<g id="edge89" class="edge">
<title>Layer_1_AttnOut_AllReduce_PP0&#45;&gt;Layer_1_A2A_Dispatch_PP0</title>
<path fill="none" stroke="black" d="M26275,-19037.83C26275,-19029.56 26275,-19020.88 26275,-19012.38"/>
<polygon fill="black" stroke="black" points="26278.5,-19012.13 26275,-19002.13 26271.5,-19012.13 26278.5,-19012.13"/>
</g>
<!-- Layer_1_Gate_EP0_PP0 -->
<g id="node60" class="node">
<title>Layer_1_Gate_EP0_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="29188.4,-20931.28 28584.86,-20931.28 28429.6,-20795.28 29033.14,-20795.28 29188.4,-20931.28"/>
<text text-anchor="middle" x="28809" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="28809" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="28809" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28809" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_1_Gate_EP1_PP0 -->
<g id="node61" class="node">
<title>Layer_1_Gate_EP1_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="28411.4,-20931.28 27807.86,-20931.28 27652.6,-20795.28 28256.14,-20795.28 28411.4,-20931.28"/>
<text text-anchor="middle" x="28032" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="28032" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="28032" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28032" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_1_Gate_EP2_PP0 -->
<g id="node62" class="node">
<title>Layer_1_Gate_EP2_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="27634.4,-20931.28 27030.86,-20931.28 26875.6,-20795.28 27479.14,-20795.28 27634.4,-20931.28"/>
<text text-anchor="middle" x="27255" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="27255" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="27255" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27255" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_1_Gate_EP3_PP0 -->
<g id="node63" class="node">
<title>Layer_1_Gate_EP3_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="26857.4,-20931.28 26253.86,-20931.28 26098.6,-20795.28 26702.14,-20795.28 26857.4,-20931.28"/>
<text text-anchor="middle" x="26478" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="26478" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="26478" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26478" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_1_Expert_0_EP0_TP0_PP0 -->
<g id="node64" class="node">
<title>Layer_1_Expert_0_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="20494.5,-18869.94 20117.5,-18869.94 20117.5,-18801.94 20494.5,-18801.94 20494.5,-18869.94"/>
<text text-anchor="middle" x="20306" y="-18854.74" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20306" y="-18839.74" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="20306" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20306" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_A2A_Combine_PP0 -->
<g id="node97" class="node">
<title>Layer_1_A2A_Combine_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26353" cy="-18717.86" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26353" y="-18736.66" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="26353" y="-18721.66" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26353" y="-18706.66" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26353" y="-18691.66" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_1_Expert_0_EP0_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge91" class="edge">
<title>Layer_1_Expert_0_EP0_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M20494.66,-18802.74C20497.45,-18802.46 20500.24,-18802.19 20503,-18801.94 21060.22,-18751.61 24991.62,-18726.37 26076.38,-18720.32"/>
<polygon fill="black" stroke="black" points="26076.67,-18723.82 26086.65,-18720.26 26076.63,-18716.82 26076.67,-18723.82"/>
</g>
<!-- Layer_1_Expert_0_EP0_TP1_PP0 -->
<g id="node65" class="node">
<title>Layer_1_Expert_0_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="20889.5,-18869.94 20512.5,-18869.94 20512.5,-18801.94 20889.5,-18801.94 20889.5,-18869.94"/>
<text text-anchor="middle" x="20701" y="-18854.74" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20701" y="-18839.74" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="20701" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20701" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_0_EP0_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge93" class="edge">
<title>Layer_1_Expert_0_EP0_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M20889.66,-18802.74C20892.45,-18802.46 20895.24,-18802.19 20898,-18801.94 21414.43,-18755.03 25039.22,-18727.58 26076.37,-18720.62"/>
<polygon fill="black" stroke="black" points="26076.6,-18724.12 26086.58,-18720.56 26076.55,-18717.12 26076.6,-18724.12"/>
</g>
<!-- Layer_1_Expert_1_EP0_TP0_PP0 -->
<g id="node66" class="node">
<title>Layer_1_Expert_1_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21284.5,-18869.94 20907.5,-18869.94 20907.5,-18801.94 21284.5,-18801.94 21284.5,-18869.94"/>
<text text-anchor="middle" x="21096" y="-18854.74" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="21096" y="-18839.74" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="21096" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21096" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_1_EP0_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge95" class="edge">
<title>Layer_1_Expert_1_EP0_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21284.66,-18802.75C21287.45,-18802.46 21290.24,-18802.2 21293,-18801.94 21768.83,-18758.43 25089.66,-18728.87 26076.85,-18720.98"/>
<polygon fill="black" stroke="black" points="26076.95,-18724.48 26086.93,-18720.9 26076.9,-18717.48 26076.95,-18724.48"/>
</g>
<!-- Layer_1_Expert_1_EP0_TP1_PP0 -->
<g id="node67" class="node">
<title>Layer_1_Expert_1_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21679.5,-18869.94 21302.5,-18869.94 21302.5,-18801.94 21679.5,-18801.94 21679.5,-18869.94"/>
<text text-anchor="middle" x="21491" y="-18854.74" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="21491" y="-18839.74" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="21491" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21491" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_1_EP0_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge97" class="edge">
<title>Layer_1_Expert_1_EP0_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21679.66,-18802.75C21682.46,-18802.47 21685.24,-18802.2 21688,-18801.94 22547.32,-18722.76 25207.81,-18717.83 26075.94,-18718.4"/>
<polygon fill="black" stroke="black" points="26076.07,-18721.9 26086.07,-18718.41 26076.07,-18714.9 26076.07,-18721.9"/>
</g>
<!-- Layer_1_Expert_2_EP0_TP0_PP0 -->
<g id="node68" class="node">
<title>Layer_1_Expert_2_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22074.5,-18869.94 21697.5,-18869.94 21697.5,-18801.94 22074.5,-18801.94 22074.5,-18869.94"/>
<text text-anchor="middle" x="21886" y="-18854.74" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="21886" y="-18839.74" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="21886" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21886" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_2_EP0_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge99" class="edge">
<title>Layer_1_Expert_2_EP0_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22074.66,-18802.76C22077.46,-18802.47 22080.24,-18802.2 22083,-18801.94 22861.98,-18729.51 25258.2,-18720.04 26076.08,-18718.95"/>
<polygon fill="black" stroke="black" points="26076.23,-18722.45 26086.22,-18718.93 26076.22,-18715.45 26076.23,-18722.45"/>
</g>
<!-- Layer_1_Expert_2_EP0_TP1_PP0 -->
<g id="node69" class="node">
<title>Layer_1_Expert_2_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22469.5,-18869.94 22092.5,-18869.94 22092.5,-18801.94 22469.5,-18801.94 22469.5,-18869.94"/>
<text text-anchor="middle" x="22281" y="-18854.74" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="22281" y="-18839.74" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="22281" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22281" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_2_EP0_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge101" class="edge">
<title>Layer_1_Expert_2_EP0_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22469.66,-18802.77C22472.46,-18802.48 22475.24,-18802.2 22478,-18801.94 23177,-18736.25 25311.13,-18722.45 26076.32,-18719.59"/>
<polygon fill="black" stroke="black" points="26076.39,-18723.09 26086.37,-18719.56 26076.36,-18716.09 26076.39,-18723.09"/>
</g>
<!-- Layer_1_Expert_3_EP0_TP0_PP0 -->
<g id="node70" class="node">
<title>Layer_1_Expert_3_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22864.5,-18869.94 22487.5,-18869.94 22487.5,-18801.94 22864.5,-18801.94 22864.5,-18869.94"/>
<text text-anchor="middle" x="22676" y="-18854.74" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="22676" y="-18839.74" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="22676" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22676" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_3_EP0_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge103" class="edge">
<title>Layer_1_Expert_3_EP0_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22864.66,-18802.78C22867.46,-18802.48 22870.24,-18802.21 22873,-18801.94 23492.34,-18742.98 25366.43,-18725.12 26076.38,-18720.39"/>
<polygon fill="black" stroke="black" points="26076.51,-18723.88 26086.49,-18720.32 26076.47,-18716.89 26076.51,-18723.88"/>
</g>
<!-- Layer_1_Expert_3_EP0_TP1_PP0 -->
<g id="node71" class="node">
<title>Layer_1_Expert_3_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23259.5,-18869.94 22882.5,-18869.94 22882.5,-18801.94 23259.5,-18801.94 23259.5,-18869.94"/>
<text text-anchor="middle" x="23071" y="-18854.74" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="23071" y="-18839.74" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="23071" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23071" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_3_EP0_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge105" class="edge">
<title>Layer_1_Expert_3_EP0_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23259.66,-18802.79C23262.46,-18802.49 23265.24,-18802.21 23268,-18801.94 23808.13,-18749.69 25424.98,-18728.11 26076.46,-18721.38"/>
<polygon fill="black" stroke="black" points="26076.96,-18724.87 26086.93,-18721.27 26076.89,-18717.87 26076.96,-18724.87"/>
</g>
<!-- Layer_1_Expert_4_EP1_TP0_PP0 -->
<g id="node72" class="node">
<title>Layer_1_Expert_4_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23654.5,-18869.94 23277.5,-18869.94 23277.5,-18801.94 23654.5,-18801.94 23654.5,-18869.94"/>
<text text-anchor="middle" x="23466" y="-18854.74" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="23466" y="-18839.74" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="23466" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23466" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_4_EP1_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge107" class="edge">
<title>Layer_1_Expert_4_EP1_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23654.66,-18802.81C23657.46,-18802.5 23660.24,-18802.22 23663,-18801.94 24124.6,-18756.36 25488.29,-18731.51 26077.11,-18722.65"/>
<polygon fill="black" stroke="black" points="26077.5,-18726.14 26087.44,-18722.49 26077.39,-18719.14 26077.5,-18726.14"/>
</g>
<!-- Layer_1_Expert_4_EP1_TP1_PP0 -->
<g id="node73" class="node">
<title>Layer_1_Expert_4_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24049.5,-18869.94 23672.5,-18869.94 23672.5,-18801.94 24049.5,-18801.94 24049.5,-18869.94"/>
<text text-anchor="middle" x="23861" y="-18854.74" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="23861" y="-18839.74" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="23861" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23861" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_4_EP1_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge109" class="edge">
<title>Layer_1_Expert_4_EP1_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24049.66,-18802.83C24052.46,-18802.52 24055.24,-18802.22 24058,-18801.94 24441.83,-18763.01 25556.9,-18735.46 26078.27,-18724.33"/>
<polygon fill="black" stroke="black" points="26078.64,-18727.83 26088.57,-18724.11 26078.5,-18720.83 26078.64,-18727.83"/>
</g>
<!-- Layer_1_Expert_5_EP1_TP0_PP0 -->
<g id="node74" class="node">
<title>Layer_1_Expert_5_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24444.5,-18869.94 24067.5,-18869.94 24067.5,-18801.94 24444.5,-18801.94 24444.5,-18869.94"/>
<text text-anchor="middle" x="24256" y="-18854.74" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="24256" y="-18839.74" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="24256" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24256" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_5_EP1_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge111" class="edge">
<title>Layer_1_Expert_5_EP1_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24444.67,-18802.85C24447.46,-18802.54 24450.24,-18802.23 24453,-18801.94 25028.34,-18741.4 25706.17,-18724.81 26076.68,-18720.37"/>
<polygon fill="black" stroke="black" points="26076.78,-18723.87 26086.73,-18720.25 26076.69,-18716.87 26076.78,-18723.87"/>
</g>
<!-- Layer_1_Expert_5_EP1_TP1_PP0 -->
<g id="node75" class="node">
<title>Layer_1_Expert_5_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24839.5,-18869.94 24462.5,-18869.94 24462.5,-18801.94 24839.5,-18801.94 24839.5,-18869.94"/>
<text text-anchor="middle" x="24651" y="-18854.74" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="24651" y="-18839.74" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="24651" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24651" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_5_EP1_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge113" class="edge">
<title>Layer_1_Expert_5_EP1_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24839.67,-18802.9C24842.47,-18802.57 24845.24,-18802.25 24848,-18801.94 25276.34,-18754.39 25776.43,-18733.64 26078.67,-18724.88"/>
<polygon fill="black" stroke="black" points="26079,-18728.37 26088.9,-18724.59 26078.8,-18721.38 26079,-18728.37"/>
</g>
<!-- Layer_1_Expert_6_EP1_TP0_PP0 -->
<g id="node76" class="node">
<title>Layer_1_Expert_6_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25234.5,-18869.94 24857.5,-18869.94 24857.5,-18801.94 25234.5,-18801.94 25234.5,-18869.94"/>
<text text-anchor="middle" x="25046" y="-18854.74" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="25046" y="-18839.74" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="25046" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25046" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_6_EP1_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge115" class="edge">
<title>Layer_1_Expert_6_EP1_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25234.68,-18802.98C25237.47,-18802.62 25240.25,-18802.28 25243,-18801.94 25530.32,-18767.2 25861.34,-18744.67 26086.61,-18731.96"/>
<polygon fill="black" stroke="black" points="26087.14,-18735.44 26096.92,-18731.38 26086.74,-18728.45 26087.14,-18735.44"/>
</g>
<!-- Layer_1_Expert_6_EP1_TP1_PP0 -->
<g id="node77" class="node">
<title>Layer_1_Expert_6_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25629.5,-18869.94 25252.5,-18869.94 25252.5,-18801.94 25629.5,-18801.94 25629.5,-18869.94"/>
<text text-anchor="middle" x="25441" y="-18854.74" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="25441" y="-18839.74" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="25441" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25441" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_6_EP1_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge117" class="edge">
<title>Layer_1_Expert_6_EP1_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25629.7,-18803.13C25632.49,-18802.73 25635.25,-18802.33 25638,-18801.94 25796.29,-18779.5 25974.93,-18758.74 26114.05,-18743.59"/>
<polygon fill="black" stroke="black" points="26114.44,-18747.07 26124,-18742.51 26113.68,-18740.11 26114.44,-18747.07"/>
</g>
<!-- Layer_1_Expert_7_EP1_TP0_PP0 -->
<g id="node78" class="node">
<title>Layer_1_Expert_7_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26024.5,-18869.94 25647.5,-18869.94 25647.5,-18801.94 26024.5,-18801.94 26024.5,-18869.94"/>
<text text-anchor="middle" x="25836" y="-18854.74" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="25836" y="-18839.74" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="25836" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25836" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_7_EP1_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge119" class="edge">
<title>Layer_1_Expert_7_EP1_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25983.11,-18801.91C26043.89,-18788.26 26114.82,-18772.34 26178.22,-18758.1"/>
<polygon fill="black" stroke="black" points="26179.34,-18761.44 26188.33,-18755.83 26177.81,-18754.61 26179.34,-18761.44"/>
</g>
<!-- Layer_1_Expert_7_EP1_TP1_PP0 -->
<g id="node79" class="node">
<title>Layer_1_Expert_7_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26419.5,-18869.94 26042.5,-18869.94 26042.5,-18801.94 26419.5,-18801.94 26419.5,-18869.94"/>
<text text-anchor="middle" x="26231" y="-18854.74" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="26231" y="-18839.74" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="26231" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26231" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_7_EP1_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge121" class="edge">
<title>Layer_1_Expert_7_EP1_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26265.96,-18801.68C26275.48,-18792.62 26286.04,-18782.57 26296.43,-18772.69"/>
<polygon fill="black" stroke="black" points="26299.11,-18774.97 26303.94,-18765.54 26294.29,-18769.89 26299.11,-18774.97"/>
</g>
<!-- Layer_1_Expert_8_EP2_TP0_PP0 -->
<g id="node80" class="node">
<title>Layer_1_Expert_8_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26814.5,-18869.94 26437.5,-18869.94 26437.5,-18801.94 26814.5,-18801.94 26814.5,-18869.94"/>
<text text-anchor="middle" x="26626" y="-18854.74" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="26626" y="-18839.74" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="26626" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26626" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_8_EP2_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge123" class="edge">
<title>Layer_1_Expert_8_EP2_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26548.13,-18801.83C26522.15,-18790.79 26492.67,-18778.25 26464.64,-18766.33"/>
<polygon fill="black" stroke="black" points="26465.76,-18763.01 26455.19,-18762.31 26463.02,-18769.45 26465.76,-18763.01"/>
</g>
<!-- Layer_1_Expert_8_EP2_TP1_PP0 -->
<g id="node81" class="node">
<title>Layer_1_Expert_8_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27209.5,-18869.94 26832.5,-18869.94 26832.5,-18801.94 27209.5,-18801.94 27209.5,-18869.94"/>
<text text-anchor="middle" x="27021" y="-18854.74" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="27021" y="-18839.74" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="27021" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27021" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_8_EP2_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge125" class="edge">
<title>Layer_1_Expert_8_EP2_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26832.26,-18802.14C26744.87,-18786.96 26641,-18768.91 26552.34,-18753.5"/>
<polygon fill="black" stroke="black" points="26552.89,-18750.04 26542.43,-18751.78 26551.69,-18756.94 26552.89,-18750.04"/>
</g>
<!-- Layer_1_Expert_9_EP2_TP0_PP0 -->
<g id="node82" class="node">
<title>Layer_1_Expert_9_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27604.5,-18869.94 27227.5,-18869.94 27227.5,-18801.94 27604.5,-18801.94 27604.5,-18869.94"/>
<text text-anchor="middle" x="27416" y="-18854.74" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="27416" y="-18839.74" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="27416" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27416" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_9_EP2_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge127" class="edge">
<title>Layer_1_Expert_9_EP2_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27227.4,-18803.2C27224.25,-18802.77 27221.11,-18802.35 27218,-18801.94 27012.76,-18775.02 26779.03,-18753.09 26606.32,-18738.53"/>
<polygon fill="black" stroke="black" points="26606.59,-18735.04 26596.33,-18737.69 26606,-18742.02 26606.59,-18735.04"/>
</g>
<!-- Layer_1_Expert_9_EP2_TP1_PP0 -->
<g id="node83" class="node">
<title>Layer_1_Expert_9_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27999.5,-18869.94 27622.5,-18869.94 27622.5,-18801.94 27999.5,-18801.94 27999.5,-18869.94"/>
<text text-anchor="middle" x="27811" y="-18854.74" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="27811" y="-18839.74" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="27811" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27811" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_9_EP2_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge129" class="edge">
<title>Layer_1_Expert_9_EP2_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27622.42,-18803.07C27619.26,-18802.68 27616.12,-18802.3 27613,-18801.94 27272.93,-18762.49 26878.89,-18740.25 26623.27,-18728.91"/>
<polygon fill="black" stroke="black" points="26623.24,-18725.41 26613.1,-18728.46 26622.93,-18732.4 26623.24,-18725.41"/>
</g>
<!-- Layer_1_Expert_10_EP2_TP0_PP0 -->
<g id="node84" class="node">
<title>Layer_1_Expert_10_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28394.5,-18869.94 28017.5,-18869.94 28017.5,-18801.94 28394.5,-18801.94 28394.5,-18869.94"/>
<text text-anchor="middle" x="28206" y="-18854.74" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="28206" y="-18839.74" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="28206" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28206" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_10_EP2_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge131" class="edge">
<title>Layer_1_Expert_10_EP2_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28017.43,-18803C28014.26,-18802.63 28011.12,-18802.28 28008,-18801.94 27524.45,-18749.68 26957.79,-18730.21 26628.67,-18723.02"/>
<polygon fill="black" stroke="black" points="26628.59,-18719.51 26618.52,-18722.8 26628.44,-18726.51 26628.59,-18719.51"/>
</g>
<!-- Layer_1_Expert_10_EP2_TP1_PP0 -->
<g id="node85" class="node">
<title>Layer_1_Expert_10_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28789.5,-18869.94 28412.5,-18869.94 28412.5,-18801.94 28789.5,-18801.94 28789.5,-18869.94"/>
<text text-anchor="middle" x="28601" y="-18854.74" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="28601" y="-18839.74" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="28601" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28601" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_10_EP2_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge133" class="edge">
<title>Layer_1_Expert_10_EP2_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28412.43,-18802.96C28409.27,-18802.6 28406.12,-18802.26 28403,-18801.94 27770.9,-18736.72 27024.24,-18722.05 26629.66,-18719.15"/>
<polygon fill="black" stroke="black" points="26629.56,-18715.65 26619.53,-18719.08 26629.51,-18722.65 26629.56,-18715.65"/>
</g>
<!-- Layer_1_Expert_11_EP2_TP0_PP0 -->
<g id="node86" class="node">
<title>Layer_1_Expert_11_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29184.5,-18869.94 28807.5,-18869.94 28807.5,-18801.94 29184.5,-18801.94 29184.5,-18869.94"/>
<text text-anchor="middle" x="28996" y="-18854.74" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="28996" y="-18839.74" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="28996" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28996" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_11_EP2_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge135" class="edge">
<title>Layer_1_Expert_11_EP2_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28807.43,-18802.93C28804.27,-18802.59 28801.12,-18802.25 28798,-18801.94 28384.65,-18760.65 27175.45,-18733.95 26627.97,-18723.66"/>
<polygon fill="black" stroke="black" points="26628.02,-18720.16 26617.96,-18723.47 26627.89,-18727.15 26628.02,-18720.16"/>
</g>
<!-- Layer_1_Expert_11_EP2_TP1_PP0 -->
<g id="node87" class="node">
<title>Layer_1_Expert_11_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29579.5,-18869.94 29202.5,-18869.94 29202.5,-18801.94 29579.5,-18801.94 29579.5,-18869.94"/>
<text text-anchor="middle" x="29391" y="-18854.74" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="29391" y="-18839.74" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="29391" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29391" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_11_EP2_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge137" class="edge">
<title>Layer_1_Expert_11_EP2_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29202.43,-18802.91C29199.27,-18802.57 29196.12,-18802.25 29193,-18801.94 28701.61,-18754.03 27242.16,-18730.25 26629.09,-18722.15"/>
<polygon fill="black" stroke="black" points="26628.83,-18718.65 26618.78,-18722.02 26628.74,-18725.65 26628.83,-18718.65"/>
</g>
<!-- Layer_1_Expert_12_EP3_TP0_PP0 -->
<g id="node88" class="node">
<title>Layer_1_Expert_12_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29974.5,-18869.94 29597.5,-18869.94 29597.5,-18801.94 29974.5,-18801.94 29974.5,-18869.94"/>
<text text-anchor="middle" x="29786" y="-18854.74" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="29786" y="-18839.74" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="29786" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29786" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_12_EP3_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge139" class="edge">
<title>Layer_1_Expert_12_EP3_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29597.44,-18802.9C29594.27,-18802.56 29591.12,-18802.24 29588,-18801.94 29017.78,-18747.37 27303.38,-18727.02 26629.41,-18721"/>
<polygon fill="black" stroke="black" points="26629.1,-18717.5 26619.07,-18720.91 26629.04,-18724.5 26629.1,-18717.5"/>
</g>
<!-- Layer_1_Expert_12_EP3_TP1_PP0 -->
<g id="node89" class="node">
<title>Layer_1_Expert_12_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30369.5,-18869.94 29992.5,-18869.94 29992.5,-18801.94 30369.5,-18801.94 30369.5,-18869.94"/>
<text text-anchor="middle" x="30181" y="-18854.74" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="30181" y="-18839.74" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="30181" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30181" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_12_EP3_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge141" class="edge">
<title>Layer_1_Expert_12_EP3_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29992.44,-18802.88C29989.27,-18802.55 29986.12,-18802.24 29983,-18801.94 29333.43,-18740.69 27360.88,-18724.17 26629.62,-18720.09"/>
<polygon fill="black" stroke="black" points="26629.5,-18716.59 26619.48,-18720.04 26629.46,-18723.59 26629.5,-18716.59"/>
</g>
<!-- Layer_1_Expert_13_EP3_TP0_PP0 -->
<g id="node90" class="node">
<title>Layer_1_Expert_13_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30764.5,-18869.94 30387.5,-18869.94 30387.5,-18801.94 30764.5,-18801.94 30764.5,-18869.94"/>
<text text-anchor="middle" x="30576" y="-18854.74" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="30576" y="-18839.74" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="30576" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30576" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_13_EP3_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge143" class="edge">
<title>Layer_1_Expert_13_EP3_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30387.44,-18802.87C30384.27,-18802.55 30381.12,-18802.23 30378,-18801.94 29648.57,-18733.99 27414.78,-18721.61 26629.51,-18719.36"/>
<polygon fill="black" stroke="black" points="26629.5,-18715.86 26619.49,-18719.33 26629.48,-18722.86 26629.5,-18715.86"/>
</g>
<!-- Layer_1_Expert_13_EP3_TP1_PP0 -->
<g id="node91" class="node">
<title>Layer_1_Expert_13_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31159.5,-18869.94 30782.5,-18869.94 30782.5,-18801.94 31159.5,-18801.94 31159.5,-18869.94"/>
<text text-anchor="middle" x="30971" y="-18854.74" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="30971" y="-18839.74" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="30971" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30971" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_13_EP3_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge145" class="edge">
<title>Layer_1_Expert_13_EP3_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30782.44,-18802.87C30779.27,-18802.54 30776.12,-18802.23 30773,-18801.94 29963.42,-18727.27 27466.59,-18719.29 26629.67,-18718.76"/>
<polygon fill="black" stroke="black" points="26629.6,-18715.26 26619.6,-18718.75 26629.6,-18722.26 26629.6,-18715.26"/>
</g>
<!-- Layer_1_Expert_14_EP3_TP0_PP0 -->
<g id="node92" class="node">
<title>Layer_1_Expert_14_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31554.5,-18869.94 31177.5,-18869.94 31177.5,-18801.94 31554.5,-18801.94 31554.5,-18869.94"/>
<text text-anchor="middle" x="31366" y="-18854.74" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="31366" y="-18839.74" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="31366" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31366" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_14_EP3_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge147" class="edge">
<title>Layer_1_Expert_14_EP3_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31177.44,-18802.86C31174.27,-18802.53 31171.12,-18802.23 31168,-18801.94 30277.91,-18720.54 27515.84,-18717.16 26629.67,-18718.25"/>
<polygon fill="black" stroke="black" points="26629.65,-18714.75 26619.65,-18718.27 26629.66,-18721.75 26629.65,-18714.75"/>
</g>
<!-- Layer_1_Expert_14_EP3_TP1_PP0 -->
<g id="node93" class="node">
<title>Layer_1_Expert_14_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31949.5,-18869.94 31572.5,-18869.94 31572.5,-18801.94 31949.5,-18801.94 31949.5,-18869.94"/>
<text text-anchor="middle" x="31761" y="-18854.74" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="31761" y="-18839.74" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="31761" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31761" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_14_EP3_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge149" class="edge">
<title>Layer_1_Expert_14_EP3_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31572.44,-18802.85C31569.27,-18802.53 31566.12,-18802.23 31563,-18801.94 31071.78,-18757.34 27636.14,-18728.43 26629.52,-18720.85"/>
<polygon fill="black" stroke="black" points="26629.28,-18717.35 26619.25,-18720.77 26629.23,-18724.35 26629.28,-18717.35"/>
</g>
<!-- Layer_1_Expert_15_EP3_TP0_PP0 -->
<g id="node94" class="node">
<title>Layer_1_Expert_15_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="32344.5,-18869.94 31967.5,-18869.94 31967.5,-18801.94 32344.5,-18801.94 32344.5,-18869.94"/>
<text text-anchor="middle" x="32156" y="-18854.74" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="32156" y="-18839.74" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="32156" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32156" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_15_EP3_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge151" class="edge">
<title>Layer_1_Expert_15_EP3_TP0_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31967.44,-18802.85C31964.27,-18802.53 31961.12,-18802.22 31958,-18801.94 31426.14,-18753.95 27685.93,-18727.18 26630,-18720.52"/>
<polygon fill="black" stroke="black" points="26629.63,-18717.02 26619.61,-18720.45 26629.59,-18724.02 26629.63,-18717.02"/>
</g>
<!-- Layer_1_Expert_15_EP3_TP1_PP0 -->
<g id="node95" class="node">
<title>Layer_1_Expert_15_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="32739.5,-18869.94 32362.5,-18869.94 32362.5,-18801.94 32739.5,-18801.94 32739.5,-18869.94"/>
<text text-anchor="middle" x="32551" y="-18854.74" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="32551" y="-18839.74" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="32551" y="-18824.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32551" y="-18809.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_Expert_15_EP3_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0 -->
<g id="edge153" class="edge">
<title>Layer_1_Expert_15_EP3_TP1_PP0&#45;&gt;Layer_1_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M32362.44,-18802.85C32359.27,-18802.52 32356.12,-18802.22 32353,-18801.94 31780.26,-18750.55 27732.32,-18726 26629.74,-18720.23"/>
<polygon fill="black" stroke="black" points="26629.71,-18716.73 26619.7,-18720.17 26629.68,-18723.73 26629.71,-18716.73"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_0_EP0_TP0_PP0 -->
<g id="edge90" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_0_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26008.61,-18951.57C24953.9,-18945.48 21099.45,-18920.06 20504.83,-18870.03"/>
<polygon fill="black" stroke="black" points="20504.92,-18866.53 20494.66,-18869.14 20504.31,-18873.5 20504.92,-18866.53"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_0_EP0_TP1_PP0 -->
<g id="edge92" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_0_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26008.5,-18951.27C25000.91,-18944.29 21453.5,-18916.69 20899.9,-18870.04"/>
<polygon fill="black" stroke="black" points="20899.92,-18866.53 20889.66,-18869.14 20899.31,-18873.5 20899.92,-18866.53"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_1_EP0_TP0_PP0 -->
<g id="edge94" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_1_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26008.89,-18950.92C25050.77,-18943 21807.18,-18913.34 21294.85,-18870.03"/>
<polygon fill="black" stroke="black" points="21294.92,-18866.53 21284.66,-18869.14 21294.31,-18873.5 21294.92,-18866.53"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_1_EP0_TP1_PP0 -->
<g id="edge96" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_1_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26008.08,-18953.38C25163.59,-18953.68 22555.26,-18948.15 21689.76,-18870.05"/>
<polygon fill="black" stroke="black" points="21689.93,-18866.55 21679.66,-18869.13 21689.3,-18873.52 21689.93,-18866.55"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_2_EP0_TP0_PP0 -->
<g id="edge98" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_2_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26008.16,-18952.84C25213.47,-18951.48 22869.49,-18941.42 22084.67,-18870.05"/>
<polygon fill="black" stroke="black" points="22084.94,-18866.56 22074.66,-18869.12 22084.29,-18873.53 22084.94,-18866.56"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_2_EP0_TP1_PP0 -->
<g id="edge100" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_2_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26008.41,-18952.19C25266.09,-18949.08 23184.25,-18934.73 22479.67,-18870.05"/>
<polygon fill="black" stroke="black" points="22479.94,-18866.56 22469.66,-18869.12 22479.29,-18873.53 22479.94,-18866.56"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_3_EP0_TP0_PP0 -->
<g id="edge102" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_3_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26008.52,-18951.4C25321.22,-18946.41 23499.31,-18928.06 22874.67,-18870.05"/>
<polygon fill="black" stroke="black" points="22874.94,-18866.56 22864.66,-18869.11 22874.29,-18873.53 22874.94,-18866.56"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_3_EP0_TP1_PP0 -->
<g id="edge104" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_3_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26008.97,-18950.4C25380.3,-18943.43 23815.47,-18921.44 23269.99,-18870.08"/>
<polygon fill="black" stroke="black" points="23269.95,-18866.56 23259.66,-18869.09 23269.28,-18873.53 23269.95,-18866.56"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_4_EP1_TP0_PP0 -->
<g id="edge106" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_4_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26009.66,-18949.11C25443.47,-18940.02 24131.28,-18914.85 23664.85,-18870.07"/>
<polygon fill="black" stroke="black" points="23664.96,-18866.57 23654.66,-18869.08 23664.27,-18873.53 23664.96,-18866.57"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_4_EP1_TP1_PP0 -->
<g id="edge108" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_4_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26010.85,-18947.39C25512.15,-18936.04 24448,-18908.31 24059.83,-18870.07"/>
<polygon fill="black" stroke="black" points="24059.96,-18866.57 24049.66,-18869.06 24059.27,-18873.54 24059.96,-18866.57"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_5_EP1_TP0_PP0 -->
<g id="edge110" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_5_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26008.71,-18950.91C25655.3,-18945.82 25011.95,-18928.66 24454.92,-18870.11"/>
<polygon fill="black" stroke="black" points="24454.98,-18866.59 24444.67,-18869.02 24454.24,-18873.56 24454.98,-18866.59"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_5_EP1_TP1_PP0 -->
<g id="edge112" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_5_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26011.93,-18946.2C25727.36,-18936.86 25260.34,-18915.83 24849.67,-18870.09"/>
<polygon fill="black" stroke="black" points="24850,-18866.61 24839.67,-18868.97 24849.22,-18873.57 24850,-18866.61"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_6_EP1_TP0_PP0 -->
<g id="edge114" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_6_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26022.03,-18938.72C25815.29,-18925.6 25515.33,-18903.29 25244.7,-18870.12"/>
<polygon fill="black" stroke="black" points="25245.04,-18866.64 25234.68,-18868.89 25244.18,-18873.59 25245.04,-18866.64"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_6_EP1_TP1_PP0 -->
<g id="edge116" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_6_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26056.2,-18926.48C25935.93,-18911.4 25783.86,-18891.54 25639.64,-18870.17"/>
<polygon fill="black" stroke="black" points="25640.12,-18866.71 25629.71,-18868.7 25639.09,-18873.63 25640.12,-18866.71"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_7_EP1_TP0_PP0 -->
<g id="edge118" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_7_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26127.29,-18913.97C26076.64,-18900.57 26020.25,-18885.66 25970.68,-18872.56"/>
<polygon fill="black" stroke="black" points="25971.42,-18869.13 25960.86,-18869.96 25969.63,-18875.9 25971.42,-18869.13"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_7_EP1_TP1_PP0 -->
<g id="edge120" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_7_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26257.1,-18905.81C26253.82,-18897.15 26250.41,-18888.15 26247.18,-18879.62"/>
<polygon fill="black" stroke="black" points="26250.44,-18878.36 26243.62,-18870.25 26243.89,-18880.84 26250.44,-18878.36"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_8_EP2_TP0_PP0 -->
<g id="edge122" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_8_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26400.73,-18911.45C26438.56,-18898.93 26479.75,-18885.31 26516.45,-18873.18"/>
<polygon fill="black" stroke="black" points="26517.77,-18876.42 26526.17,-18869.96 26515.58,-18869.78 26517.77,-18876.42"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_8_EP2_TP1_PP0 -->
<g id="edge124" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_8_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26478.42,-18922.91C26578.87,-18907.86 26702.13,-18889.13 26822.25,-18870.06"/>
<polygon fill="black" stroke="black" points="26823.04,-18873.47 26832.37,-18868.45 26821.94,-18866.56 26823.04,-18873.47"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_9_EP2_TP0_PP0 -->
<g id="edge126" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_9_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26523.25,-18936.42C26711.13,-18922.59 26975.68,-18900.45 27217.37,-18869.99"/>
<polygon fill="black" stroke="black" points="27217.93,-18873.45 27227.41,-18868.72 27217.05,-18866.5 27217.93,-18873.45"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_9_EP2_TP1_PP0 -->
<g id="edge128" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_9_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26536.9,-18944.75C26804.77,-18934.43 27232.95,-18912.81 27612.34,-18869.98"/>
<polygon fill="black" stroke="black" points="27612.88,-18873.44 27622.42,-18868.83 27612.09,-18866.48 27612.88,-18873.44"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_10_EP2_TP0_PP0 -->
<g id="edge130" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_10_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26540.72,-18949.95C26879.31,-18943.83 27482.51,-18925.54 28007.38,-18869.96"/>
<polygon fill="black" stroke="black" points="28007.85,-18873.43 28017.43,-18868.89 28007.11,-18866.47 28007.85,-18873.43"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_10_EP2_TP1_PP0 -->
<g id="edge132" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_10_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26541.58,-18953.39C26943.28,-18951.51 27727.58,-18938.44 28402.01,-18869.99"/>
<polygon fill="black" stroke="black" points="28402.84,-18873.43 28412.43,-18868.93 28402.13,-18866.46 28402.84,-18873.43"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_11_EP2_TP0_PP0 -->
<g id="edge134" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_11_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26540.19,-18948.74C27091.7,-18939.1 28347.53,-18913.19 28797.29,-18869.95"/>
<polygon fill="black" stroke="black" points="28797.82,-18873.41 28807.43,-18868.96 28797.14,-18866.45 28797.82,-18873.41"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_11_EP2_TP1_PP0 -->
<g id="edge136" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_11_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26540.86,-18950.11C27155.92,-18942.61 28663.99,-18919.73 29192.43,-18869.93"/>
<polygon fill="black" stroke="black" points="29192.81,-18873.41 29202.44,-18868.98 29192.15,-18866.45 29192.81,-18873.41"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_12_EP3_TP0_PP0 -->
<g id="edge138" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_12_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26541.27,-18951.16C27215.55,-18945.68 28979.27,-18926.33 29587.25,-18869.95"/>
<polygon fill="black" stroke="black" points="29587.81,-18873.41 29597.44,-18868.99 29587.15,-18866.44 29587.81,-18873.41"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_12_EP3_TP1_PP0 -->
<g id="edge140" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_12_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26541.57,-18952C27271.76,-18948.4 29294.79,-18932.95 29982.41,-18869.93"/>
<polygon fill="black" stroke="black" points="29982.8,-18873.41 29992.44,-18869 29982.16,-18866.44 29982.8,-18873.41"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_13_EP3_TP0_PP0 -->
<g id="edge142" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_13_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26541.74,-18952.68C27324.79,-18950.85 29609.48,-18939.61 30377.36,-18869.94"/>
<polygon fill="black" stroke="black" points="30377.8,-18873.41 30387.44,-18869.01 30377.16,-18866.44 30377.8,-18873.41"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_13_EP3_TP1_PP0 -->
<g id="edge144" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_13_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26541.87,-18953.24C27375.26,-18953.08 29923.69,-18946.29 30772.23,-18869.95"/>
<polygon fill="black" stroke="black" points="30772.8,-18873.41 30782.44,-18869.02 30772.16,-18866.44 30772.8,-18873.41"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_14_EP3_TP0_PP0 -->
<g id="edge146" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_14_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26541.71,-18953.71C27423.03,-18955.14 30237.88,-18953 31167.27,-18869.95"/>
<polygon fill="black" stroke="black" points="31167.8,-18873.41 31177.44,-18869.03 31167.17,-18866.44 31167.8,-18873.41"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_14_EP3_TP1_PP0 -->
<g id="edge148" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_14_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26541.36,-18951.18C27538,-18943.95 31017.51,-18915.73 31562.36,-18869.91"/>
<polygon fill="black" stroke="black" points="31562.78,-18873.39 31572.44,-18869.03 31562.17,-18866.42 31562.78,-18873.39"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_15_EP3_TP0_PP0 -->
<g id="edge150" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_15_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26541.29,-18951.49C27585.46,-18945.16 31371.53,-18919.08 31957.42,-18869.91"/>
<polygon fill="black" stroke="black" points="31957.78,-18873.39 31967.44,-18869.04 31957.18,-18866.42 31957.78,-18873.39"/>
</g>
<!-- Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_15_EP3_TP1_PP0 -->
<g id="edge152" class="edge">
<title>Layer_1_A2A_Dispatch_PP0&#45;&gt;Layer_1_Expert_15_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26541.44,-18951.77C27631.64,-18946.28 31724.07,-18922.44 32352.13,-18869.93"/>
<polygon fill="black" stroke="black" points="32352.78,-18873.39 32362.44,-18869.04 32352.18,-18866.42 32352.78,-18873.39"/>
</g>
<!-- Layer_1_MLP_Out_TP0_PP0 -->
<g id="node98" class="node">
<title>Layer_1_MLP_Out_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26506.5,-18633.78 26129.5,-18633.78 26129.5,-18565.78 26506.5,-18565.78 26506.5,-18633.78"/>
<text text-anchor="middle" x="26318" y="-18618.58" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="26318" y="-18603.58" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26318" y="-18588.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26318" y="-18573.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_A2A_Combine_PP0&#45;&gt;Layer_1_MLP_Out_TP0_PP0 -->
<g id="edge154" class="edge">
<title>Layer_1_A2A_Combine_PP0&#45;&gt;Layer_1_MLP_Out_TP0_PP0</title>
<path fill="none" stroke="black" d="M26338.76,-18669.64C26336.18,-18661.07 26333.5,-18652.17 26330.95,-18643.73"/>
<polygon fill="black" stroke="black" points="26334.28,-18642.64 26328.04,-18634.08 26327.58,-18644.66 26334.28,-18642.64"/>
</g>
<!-- Layer_1_MLP_Out_TP1_PP0 -->
<g id="node99" class="node">
<title>Layer_1_MLP_Out_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26901.5,-18633.78 26524.5,-18633.78 26524.5,-18565.78 26901.5,-18565.78 26901.5,-18633.78"/>
<text text-anchor="middle" x="26713" y="-18618.58" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="26713" y="-18603.58" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26713" y="-18588.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26713" y="-18573.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_1_A2A_Combine_PP0&#45;&gt;Layer_1_MLP_Out_TP1_PP0 -->
<g id="edge156" class="edge">
<title>Layer_1_A2A_Combine_PP0&#45;&gt;Layer_1_MLP_Out_TP1_PP0</title>
<path fill="none" stroke="black" d="M26480.94,-18675.61C26520.15,-18662.96 26562.98,-18649.15 26601.05,-18636.88"/>
<polygon fill="black" stroke="black" points="26602.17,-18640.19 26610.62,-18633.79 26600.02,-18633.53 26602.17,-18640.19"/>
</g>
<!-- Layer_1_MLP_AllReduce_PP0 -->
<g id="node100" class="node">
<title>Layer_1_MLP_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26381" cy="-18481.69" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26381" y="-18500.49" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="26381" y="-18485.49" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26381" y="-18470.49" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26381" y="-18455.49" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_1_MLP_Out_TP0_PP0&#45;&gt;Layer_1_MLP_AllReduce_PP0 -->
<g id="edge155" class="edge">
<title>Layer_1_MLP_Out_TP0_PP0&#45;&gt;Layer_1_MLP_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26336.05,-18565.51C26340.58,-18557.17 26345.56,-18547.99 26350.51,-18538.87"/>
<polygon fill="black" stroke="black" points="26353.74,-18540.26 26355.43,-18529.8 26347.59,-18536.92 26353.74,-18540.26"/>
</g>
<!-- Layer_1_MLP_Out_TP1_PP0&#45;&gt;Layer_1_MLP_AllReduce_PP0 -->
<g id="edge157" class="edge">
<title>Layer_1_MLP_Out_TP1_PP0&#45;&gt;Layer_1_MLP_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26618.31,-18565.67C26584.79,-18553.95 26546.49,-18540.55 26510.57,-18528"/>
<polygon fill="black" stroke="black" points="26511.6,-18524.65 26501.01,-18524.65 26509.29,-18531.26 26511.6,-18524.65"/>
</g>
<!-- Layer_1_LayerNorm_PP0 -->
<g id="node101" class="node">
<title>Layer_1_LayerNorm_PP0</title>
<polygon fill="lightgreen" stroke="black" points="26569.5,-18397.61 26192.5,-18397.61 26192.5,-18329.61 26569.5,-18329.61 26569.5,-18397.61"/>
<text text-anchor="middle" x="26381" y="-18382.41" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26381" y="-18367.41" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26381" y="-18352.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26381" y="-18337.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_1_MLP_AllReduce_PP0&#45;&gt;Layer_1_LayerNorm_PP0 -->
<g id="edge158" class="edge">
<title>Layer_1_MLP_AllReduce_PP0&#45;&gt;Layer_1_LayerNorm_PP0</title>
<path fill="none" stroke="black" d="M26381,-18433.48C26381,-18425.09 26381,-18416.39 26381,-18408.12"/>
<polygon fill="black" stroke="black" points="26384.5,-18407.91 26381,-18397.91 26377.5,-18407.91 26384.5,-18407.91"/>
</g>
<!-- Layer_2_QKV_TP0_PP0 -->
<g id="node102" class="node">
<title>Layer_2_QKV_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26571.5,-18293.61 26190.5,-18293.61 26190.5,-18225.61 26571.5,-18225.61 26571.5,-18293.61"/>
<text text-anchor="middle" x="26381" y="-18278.41" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="26381" y="-18263.41" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26381" y="-18248.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26381" y="-18233.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_1_LayerNorm_PP0&#45;&gt;Layer_2_QKV_TP0_PP0 -->
<g id="edge159" class="edge">
<title>Layer_1_LayerNorm_PP0&#45;&gt;Layer_2_QKV_TP0_PP0</title>
<path fill="none" stroke="black" d="M26381,-18329.49C26381,-18321.39 26381,-18312.59 26381,-18304.08"/>
<polygon fill="black" stroke="black" points="26384.5,-18303.91 26381,-18293.91 26377.5,-18303.91 26384.5,-18303.91"/>
</g>
<!-- Layer_2_QKV_AllReduce_PP0 -->
<g id="node104" class="node">
<title>Layer_2_QKV_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26094" cy="-18141.53" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="26094" y="-18160.33" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="26094" y="-18145.33" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26094" y="-18130.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="26094" y="-18115.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_2_QKV_TP0_PP0&#45;&gt;Layer_2_QKV_AllReduce_PP0 -->
<g id="edge160" class="edge">
<title>Layer_2_QKV_TP0_PP0&#45;&gt;Layer_2_QKV_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26299.14,-18225.5C26271.63,-18214.37 26240.39,-18201.74 26210.73,-18189.74"/>
<polygon fill="black" stroke="black" points="26211.75,-18186.38 26201.17,-18185.87 26209.13,-18192.87 26211.75,-18186.38"/>
</g>
<!-- Layer_2_QKV_TP1_PP0 -->
<g id="node103" class="node">
<title>Layer_2_QKV_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26172.5,-18293.61 25791.5,-18293.61 25791.5,-18225.61 26172.5,-18225.61 26172.5,-18293.61"/>
<text text-anchor="middle" x="25982" y="-18278.41" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="25982" y="-18263.41" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="25982" y="-18248.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25982" y="-18233.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_2_QKV_TP1_PP0&#45;&gt;Layer_2_QKV_AllReduce_PP0 -->
<g id="edge164" class="edge">
<title>Layer_2_QKV_TP1_PP0&#45;&gt;Layer_2_QKV_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26014.09,-18225.35C26022.75,-18216.38 26032.34,-18206.43 26041.79,-18196.64"/>
<polygon fill="black" stroke="black" points="26044.54,-18198.83 26048.96,-18189.2 26039.5,-18193.97 26044.54,-18198.83"/>
</g>
<!-- Layer_2_Attention_TP0_PP0 -->
<g id="node105" class="node">
<title>Layer_2_Attention_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26143.5,-18057.44 25762.5,-18057.44 25762.5,-17989.44 26143.5,-17989.44 26143.5,-18057.44"/>
<text text-anchor="middle" x="25953" y="-18042.24" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="25953" y="-18027.24" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="25953" y="-18012.24" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="25953" y="-17997.24" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_2_QKV_AllReduce_PP0&#45;&gt;Layer_2_Attention_TP0_PP0 -->
<g id="edge161" class="edge">
<title>Layer_2_QKV_AllReduce_PP0&#45;&gt;Layer_2_Attention_TP0_PP0</title>
<path fill="none" stroke="black" d="M26037.87,-18094.31C26025.76,-18084.35 26013.07,-18073.9 26001.29,-18064.2"/>
<polygon fill="black" stroke="black" points="26003.25,-18061.28 25993.31,-18057.63 25998.8,-18066.68 26003.25,-18061.28"/>
</g>
<!-- Layer_2_Attention_TP1_PP0 -->
<g id="node106" class="node">
<title>Layer_2_Attention_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26542.5,-18057.44 26161.5,-18057.44 26161.5,-17989.44 26542.5,-17989.44 26542.5,-18057.44"/>
<text text-anchor="middle" x="26352" y="-18042.24" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="26352" y="-18027.24" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26352" y="-18012.24" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="26352" y="-17997.24" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_2_QKV_AllReduce_PP0&#45;&gt;Layer_2_Attention_TP1_PP0 -->
<g id="edge165" class="edge">
<title>Layer_2_QKV_AllReduce_PP0&#45;&gt;Layer_2_Attention_TP1_PP0</title>
<path fill="none" stroke="black" d="M26191.91,-18096.47C26217.31,-18085.04 26244.43,-18072.84 26268.99,-18061.79"/>
<polygon fill="black" stroke="black" points="26270.59,-18064.91 26278.27,-18057.62 26267.71,-18058.53 26270.59,-18064.91"/>
</g>
<!-- Layer_2_AttnOut_TP0_PP0 -->
<g id="node107" class="node">
<title>Layer_2_AttnOut_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26142.5,-17953.44 25765.5,-17953.44 25765.5,-17885.44 26142.5,-17885.44 26142.5,-17953.44"/>
<text text-anchor="middle" x="25954" y="-17938.24" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="25954" y="-17923.24" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="25954" y="-17908.24" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="25954" y="-17893.24" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Attention_TP0_PP0&#45;&gt;Layer_2_AttnOut_TP0_PP0 -->
<g id="edge162" class="edge">
<title>Layer_2_Attention_TP0_PP0&#45;&gt;Layer_2_AttnOut_TP0_PP0</title>
<path fill="none" stroke="black" d="M25953.32,-17989.33C25953.4,-17981.22 25953.49,-17972.43 25953.57,-17963.92"/>
<polygon fill="black" stroke="black" points="25957.08,-17963.78 25953.67,-17953.74 25950.08,-17963.71 25957.08,-17963.78"/>
</g>
<!-- Layer_2_AttnOut_TP1_PP0 -->
<g id="node108" class="node">
<title>Layer_2_AttnOut_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26538.5,-17953.44 26161.5,-17953.44 26161.5,-17885.44 26538.5,-17885.44 26538.5,-17953.44"/>
<text text-anchor="middle" x="26350" y="-17938.24" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="26350" y="-17923.24" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26350" y="-17908.24" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="26350" y="-17893.24" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Attention_TP1_PP0&#45;&gt;Layer_2_AttnOut_TP1_PP0 -->
<g id="edge166" class="edge">
<title>Layer_2_Attention_TP1_PP0&#45;&gt;Layer_2_AttnOut_TP1_PP0</title>
<path fill="none" stroke="black" d="M26351.35,-17989.33C26351.19,-17981.22 26351.02,-17972.43 26350.85,-17963.92"/>
<polygon fill="black" stroke="black" points="26354.35,-17963.67 26350.65,-17953.74 26347.35,-17963.81 26354.35,-17963.67"/>
</g>
<!-- Layer_2_AttnOut_AllReduce_PP0 -->
<g id="node109" class="node">
<title>Layer_2_AttnOut_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26280" cy="-17801.36" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26280" y="-17820.16" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="26280" y="-17805.16" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26280" y="-17790.16" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26280" y="-17775.16" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_2_AttnOut_TP0_PP0&#45;&gt;Layer_2_AttnOut_AllReduce_PP0 -->
<g id="edge163" class="edge">
<title>Layer_2_AttnOut_TP0_PP0&#45;&gt;Layer_2_AttnOut_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26046.98,-17885.33C26079.58,-17873.73 26116.79,-17860.48 26151.76,-17848.02"/>
<polygon fill="black" stroke="black" points="26153.32,-17851.19 26161.56,-17844.53 26150.97,-17844.59 26153.32,-17851.19"/>
</g>
<!-- Layer_2_AttnOut_TP1_PP0&#45;&gt;Layer_2_AttnOut_AllReduce_PP0 -->
<g id="edge167" class="edge">
<title>Layer_2_AttnOut_TP1_PP0&#45;&gt;Layer_2_AttnOut_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26329.94,-17885.18C26324.86,-17876.75 26319.26,-17867.46 26313.7,-17858.25"/>
<polygon fill="black" stroke="black" points="26316.57,-17856.23 26308.41,-17849.47 26310.57,-17859.84 26316.57,-17856.23"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0 -->
<g id="node146" class="node">
<title>Layer_2_A2A_Dispatch_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26280" cy="-17669.19" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26280" y="-17687.99" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="26280" y="-17672.99" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26280" y="-17657.99" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26280" y="-17642.99" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_2_AttnOut_AllReduce_PP0&#45;&gt;Layer_2_A2A_Dispatch_PP0 -->
<g id="edge168" class="edge">
<title>Layer_2_AttnOut_AllReduce_PP0&#45;&gt;Layer_2_A2A_Dispatch_PP0</title>
<path fill="none" stroke="black" d="M26280,-17753C26280,-17744.73 26280,-17736.05 26280,-17727.55"/>
<polygon fill="black" stroke="black" points="26283.5,-17727.3 26280,-17717.3 26276.5,-17727.3 26283.5,-17727.3"/>
</g>
<!-- Layer_2_Gate_EP0_PP0 -->
<g id="node110" class="node">
<title>Layer_2_Gate_EP0_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="26080.4,-20931.28 25476.86,-20931.28 25321.6,-20795.28 25925.14,-20795.28 26080.4,-20931.28"/>
<text text-anchor="middle" x="25701" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="25701" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="25701" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25701" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_2_Gate_EP1_PP0 -->
<g id="node111" class="node">
<title>Layer_2_Gate_EP1_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="25303.4,-20931.28 24699.86,-20931.28 24544.6,-20795.28 25148.14,-20795.28 25303.4,-20931.28"/>
<text text-anchor="middle" x="24924" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="24924" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="24924" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24924" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_2_Gate_EP2_PP0 -->
<g id="node112" class="node">
<title>Layer_2_Gate_EP2_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24526.4,-20931.28 23922.86,-20931.28 23767.6,-20795.28 24371.14,-20795.28 24526.4,-20931.28"/>
<text text-anchor="middle" x="24147" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="24147" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="24147" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24147" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_2_Gate_EP3_PP0 -->
<g id="node113" class="node">
<title>Layer_2_Gate_EP3_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23749.4,-20931.28 23145.86,-20931.28 22990.6,-20795.28 23594.14,-20795.28 23749.4,-20931.28"/>
<text text-anchor="middle" x="23370" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="23370" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="23370" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23370" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_2_Expert_0_EP0_TP0_PP0 -->
<g id="node114" class="node">
<title>Layer_2_Expert_0_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="20393.5,-17585.11 20016.5,-17585.11 20016.5,-17517.11 20393.5,-17517.11 20393.5,-17585.11"/>
<text text-anchor="middle" x="20205" y="-17569.91" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20205" y="-17554.91" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="20205" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20205" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_A2A_Combine_PP0 -->
<g id="node147" class="node">
<title>Layer_2_A2A_Combine_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26317" cy="-17433.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26317" y="-17451.83" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="26317" y="-17436.83" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26317" y="-17421.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26317" y="-17406.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_2_Expert_0_EP0_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge170" class="edge">
<title>Layer_2_Expert_0_EP0_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M20393.66,-17517.91C20396.45,-17517.63 20399.24,-17517.36 20402,-17517.11 20965.89,-17466.22 24947.24,-17441.35 26040.09,-17435.44"/>
<polygon fill="black" stroke="black" points="26040.46,-17438.94 26050.44,-17435.38 26040.42,-17431.94 26040.46,-17438.94"/>
</g>
<!-- Layer_2_Expert_0_EP0_TP1_PP0 -->
<g id="node115" class="node">
<title>Layer_2_Expert_0_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="20788.5,-17585.11 20411.5,-17585.11 20411.5,-17517.11 20788.5,-17517.11 20788.5,-17585.11"/>
<text text-anchor="middle" x="20600" y="-17569.91" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20600" y="-17554.91" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="20600" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20600" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_0_EP0_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge172" class="edge">
<title>Layer_2_Expert_0_EP0_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M20788.66,-17517.91C20791.45,-17517.63 20794.24,-17517.36 20797,-17517.11 21320.11,-17469.63 24994.87,-17442.54 26040.2,-17435.74"/>
<polygon fill="black" stroke="black" points="26040.51,-17439.24 26050.49,-17435.67 26040.47,-17432.24 26040.51,-17439.24"/>
</g>
<!-- Layer_2_Expert_1_EP0_TP0_PP0 -->
<g id="node116" class="node">
<title>Layer_2_Expert_1_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21183.5,-17585.11 20806.5,-17585.11 20806.5,-17517.11 21183.5,-17517.11 21183.5,-17585.11"/>
<text text-anchor="middle" x="20995" y="-17569.91" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="20995" y="-17554.91" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="20995" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20995" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_1_EP0_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge174" class="edge">
<title>Layer_2_Expert_1_EP0_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21183.66,-17517.92C21186.45,-17517.63 21189.24,-17517.36 21192,-17517.11 21674.49,-17473.04 25045.14,-17443.82 26040.73,-17436.08"/>
<polygon fill="black" stroke="black" points="26040.92,-17439.58 26050.89,-17436 26040.86,-17432.58 26040.92,-17439.58"/>
</g>
<!-- Layer_2_Expert_1_EP0_TP1_PP0 -->
<g id="node117" class="node">
<title>Layer_2_Expert_1_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21578.5,-17585.11 21201.5,-17585.11 21201.5,-17517.11 21578.5,-17517.11 21578.5,-17585.11"/>
<text text-anchor="middle" x="21390" y="-17569.91" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="21390" y="-17554.91" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="21390" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21390" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_1_EP0_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge176" class="edge">
<title>Layer_2_Expert_1_EP0_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21578.66,-17517.92C21581.46,-17517.64 21584.24,-17517.36 21587,-17517.11 22459.57,-17436.81 25163.75,-17432.65 26039.93,-17433.49"/>
<polygon fill="black" stroke="black" points="26040.15,-17436.99 26050.15,-17433.5 26040.15,-17429.99 26040.15,-17436.99"/>
</g>
<!-- Layer_2_Expert_2_EP0_TP0_PP0 -->
<g id="node118" class="node">
<title>Layer_2_Expert_2_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21973.5,-17585.11 21596.5,-17585.11 21596.5,-17517.11 21973.5,-17517.11 21973.5,-17585.11"/>
<text text-anchor="middle" x="21785" y="-17569.91" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="21785" y="-17554.91" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="21785" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21785" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_2_EP0_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge178" class="edge">
<title>Layer_2_Expert_2_EP0_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21973.66,-17517.93C21976.46,-17517.64 21979.24,-17517.37 21982,-17517.11 22774.13,-17443.57 25213.43,-17434.83 26039.89,-17434.02"/>
<polygon fill="black" stroke="black" points="26040.14,-17437.52 26050.14,-17434.01 26040.14,-17430.52 26040.14,-17437.52"/>
</g>
<!-- Layer_2_Expert_2_EP0_TP1_PP0 -->
<g id="node119" class="node">
<title>Layer_2_Expert_2_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22368.5,-17585.11 21991.5,-17585.11 21991.5,-17517.11 22368.5,-17517.11 22368.5,-17585.11"/>
<text text-anchor="middle" x="22180" y="-17569.91" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="22180" y="-17554.91" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="22180" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22180" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_2_EP0_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge180" class="edge">
<title>Layer_2_Expert_2_EP0_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22368.66,-17517.93C22371.46,-17517.64 22374.24,-17517.37 22377,-17517.11 23089.11,-17450.31 25266.07,-17437.21 26040.19,-17434.65"/>
<polygon fill="black" stroke="black" points="26040.37,-17438.14 26050.36,-17434.61 26040.35,-17431.14 26040.37,-17438.14"/>
</g>
<!-- Layer_2_Expert_3_EP0_TP0_PP0 -->
<g id="node120" class="node">
<title>Layer_2_Expert_3_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22763.5,-17585.11 22386.5,-17585.11 22386.5,-17517.11 22763.5,-17517.11 22763.5,-17585.11"/>
<text text-anchor="middle" x="22575" y="-17569.91" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="22575" y="-17554.91" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="22575" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22575" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_3_EP0_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge182" class="edge">
<title>Layer_2_Expert_3_EP0_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22763.66,-17517.94C22766.46,-17517.65 22769.24,-17517.37 22772,-17517.11 23404.44,-17457.04 25321.24,-17439.83 26040.44,-17435.41"/>
<polygon fill="black" stroke="black" points="26040.7,-17438.91 26050.68,-17435.35 26040.66,-17431.91 26040.7,-17438.91"/>
</g>
<!-- Layer_2_Expert_3_EP0_TP1_PP0 -->
<g id="node121" class="node">
<title>Layer_2_Expert_3_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23158.5,-17585.11 22781.5,-17585.11 22781.5,-17517.11 23158.5,-17517.11 23158.5,-17585.11"/>
<text text-anchor="middle" x="22970" y="-17569.91" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="22970" y="-17554.91" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="22970" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22970" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_3_EP0_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge184" class="edge">
<title>Layer_2_Expert_3_EP0_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23158.66,-17517.95C23161.46,-17517.66 23164.24,-17517.38 23167,-17517.11 23720.17,-17463.75 25379.38,-17442.75 26040.61,-17436.36"/>
<polygon fill="black" stroke="black" points="26040.79,-17439.86 26050.75,-17436.27 26040.72,-17432.86 26040.79,-17439.86"/>
</g>
<!-- Layer_2_Expert_4_EP1_TP0_PP0 -->
<g id="node122" class="node">
<title>Layer_2_Expert_4_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23553.5,-17585.11 23176.5,-17585.11 23176.5,-17517.11 23553.5,-17517.11 23553.5,-17585.11"/>
<text text-anchor="middle" x="23365" y="-17569.91" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="23365" y="-17554.91" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="23365" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23365" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_4_EP1_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge186" class="edge">
<title>Layer_2_Expert_4_EP1_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23553.66,-17517.97C23556.46,-17517.67 23559.24,-17517.38 23562,-17517.11 24036.58,-17470.42 25442.15,-17446.07 26041.37,-17437.58"/>
<polygon fill="black" stroke="black" points="26041.49,-17441.08 26051.44,-17437.43 26041.4,-17434.08 26041.49,-17441.08"/>
</g>
<!-- Layer_2_Expert_4_EP1_TP1_PP0 -->
<g id="node123" class="node">
<title>Layer_2_Expert_4_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23948.5,-17585.11 23571.5,-17585.11 23571.5,-17517.11 23948.5,-17517.11 23948.5,-17585.11"/>
<text text-anchor="middle" x="23760" y="-17569.91" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="23760" y="-17554.91" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="23760" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23760" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_4_EP1_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge188" class="edge">
<title>Layer_2_Expert_4_EP1_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23948.66,-17517.99C23951.46,-17517.68 23954.24,-17517.39 23957,-17517.11 24353.64,-17477.08 25509.61,-17449.92 26042.32,-17439.18"/>
<polygon fill="black" stroke="black" points="26042.53,-17442.68 26052.46,-17438.98 26042.39,-17435.68 26042.53,-17442.68"/>
</g>
<!-- Layer_2_Expert_5_EP1_TP0_PP0 -->
<g id="node124" class="node">
<title>Layer_2_Expert_5_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24343.5,-17585.11 23966.5,-17585.11 23966.5,-17517.11 24343.5,-17517.11 24343.5,-17585.11"/>
<text text-anchor="middle" x="24155" y="-17569.91" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="24155" y="-17554.91" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="24155" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24155" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_5_EP1_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge190" class="edge">
<title>Layer_2_Expert_5_EP1_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24343.67,-17518.02C24346.46,-17517.7 24349.24,-17517.4 24352,-17517.11 24951.81,-17454.44 25659.31,-17438.69 26040.39,-17434.96"/>
<polygon fill="black" stroke="black" points="26040.49,-17438.46 26050.45,-17434.86 26040.42,-17431.46 26040.49,-17438.46"/>
</g>
<!-- Layer_2_Expert_5_EP1_TP1_PP0 -->
<g id="node125" class="node">
<title>Layer_2_Expert_5_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24738.5,-17585.11 24361.5,-17585.11 24361.5,-17517.11 24738.5,-17517.11 24738.5,-17585.11"/>
<text text-anchor="middle" x="24550" y="-17569.91" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="24550" y="-17554.91" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="24550" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24550" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_5_EP1_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge192" class="edge">
<title>Layer_2_Expert_5_EP1_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24738.67,-17518.06C24741.46,-17517.73 24744.24,-17517.41 24747,-17517.11 25199.26,-17467.43 25728.2,-17447.22 26042.21,-17439.17"/>
<polygon fill="black" stroke="black" points="26042.45,-17442.66 26052.36,-17438.91 26042.28,-17435.66 26042.45,-17442.66"/>
</g>
<!-- Layer_2_Expert_6_EP1_TP0_PP0 -->
<g id="node126" class="node">
<title>Layer_2_Expert_6_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25133.5,-17585.11 24756.5,-17585.11 24756.5,-17517.11 25133.5,-17517.11 25133.5,-17585.11"/>
<text text-anchor="middle" x="24945" y="-17569.91" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="24945" y="-17554.91" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="24945" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24945" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_6_EP1_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge194" class="edge">
<title>Layer_2_Expert_6_EP1_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25133.68,-17518.13C25136.47,-17517.78 25139.25,-17517.44 25142,-17517.11 25452.06,-17480.26 25810.23,-17457.82 26048.83,-17445.7"/>
<polygon fill="black" stroke="black" points="26049.23,-17449.18 26059.04,-17445.18 26048.87,-17442.19 26049.23,-17449.18"/>
</g>
<!-- Layer_2_Expert_6_EP1_TP1_PP0 -->
<g id="node127" class="node">
<title>Layer_2_Expert_6_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25528.5,-17585.11 25151.5,-17585.11 25151.5,-17517.11 25528.5,-17517.11 25528.5,-17585.11"/>
<text text-anchor="middle" x="25340" y="-17569.91" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="25340" y="-17554.91" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="25340" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25340" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_6_EP1_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge196" class="edge">
<title>Layer_2_Expert_6_EP1_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25528.7,-17518.26C25531.48,-17517.87 25534.25,-17517.49 25537,-17517.11 25715.23,-17492.71 25917.22,-17471.37 26070.98,-17456.43"/>
<polygon fill="black" stroke="black" points="26071.42,-17459.9 26081.04,-17455.45 26070.75,-17452.93 26071.42,-17459.9"/>
</g>
<!-- Layer_2_Expert_7_EP1_TP0_PP0 -->
<g id="node128" class="node">
<title>Layer_2_Expert_7_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25923.5,-17585.11 25546.5,-17585.11 25546.5,-17517.11 25923.5,-17517.11 25923.5,-17585.11"/>
<text text-anchor="middle" x="25735" y="-17569.91" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="25735" y="-17554.91" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="25735" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25735" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_7_EP1_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge198" class="edge">
<title>Layer_2_Expert_7_EP1_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25900.61,-17517.08C25972.48,-17502.74 26056.98,-17485.89 26131,-17471.13"/>
<polygon fill="black" stroke="black" points="26131.78,-17474.54 26140.91,-17469.15 26130.42,-17467.67 26131.78,-17474.54"/>
</g>
<!-- Layer_2_Expert_7_EP1_TP1_PP0 -->
<g id="node129" class="node">
<title>Layer_2_Expert_7_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26318.5,-17585.11 25941.5,-17585.11 25941.5,-17517.11 26318.5,-17517.11 26318.5,-17585.11"/>
<text text-anchor="middle" x="26130" y="-17569.91" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="26130" y="-17554.91" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="26130" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26130" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_7_EP1_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge200" class="edge">
<title>Layer_2_Expert_7_EP1_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26183.34,-17517C26199.57,-17506.92 26217.8,-17495.61 26235.45,-17484.65"/>
<polygon fill="black" stroke="black" points="26237.41,-17487.55 26244.06,-17479.3 26233.72,-17481.61 26237.41,-17487.55"/>
</g>
<!-- Layer_2_Expert_8_EP2_TP0_PP0 -->
<g id="node130" class="node">
<title>Layer_2_Expert_8_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26713.5,-17585.11 26336.5,-17585.11 26336.5,-17517.11 26713.5,-17517.11 26713.5,-17585.11"/>
<text text-anchor="middle" x="26525" y="-17569.91" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="26525" y="-17554.91" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="26525" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26525" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_8_EP2_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge202" class="edge">
<title>Layer_2_Expert_8_EP2_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26465.67,-17517C26447.16,-17506.67 26426.31,-17495.03 26406.22,-17483.82"/>
<polygon fill="black" stroke="black" points="26407.8,-17480.69 26397.36,-17478.87 26404.38,-17486.8 26407.8,-17480.69"/>
</g>
<!-- Layer_2_Expert_8_EP2_TP1_PP0 -->
<g id="node131" class="node">
<title>Layer_2_Expert_8_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27108.5,-17585.11 26731.5,-17585.11 26731.5,-17517.11 27108.5,-17517.11 27108.5,-17585.11"/>
<text text-anchor="middle" x="26920" y="-17569.91" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="26920" y="-17554.91" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="26920" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26920" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_8_EP2_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge204" class="edge">
<title>Layer_2_Expert_8_EP2_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26748.41,-17517.08C26672.88,-17502.54 26583.89,-17485.41 26506.41,-17470.49"/>
<polygon fill="black" stroke="black" points="26507.02,-17467.04 26496.53,-17468.59 26505.69,-17473.92 26507.02,-17467.04"/>
</g>
<!-- Layer_2_Expert_9_EP2_TP0_PP0 -->
<g id="node132" class="node">
<title>Layer_2_Expert_9_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27503.5,-17585.11 27126.5,-17585.11 27126.5,-17517.11 27503.5,-17517.11 27503.5,-17585.11"/>
<text text-anchor="middle" x="27315" y="-17569.91" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="27315" y="-17554.91" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="27315" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27315" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_9_EP2_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge206" class="edge">
<title>Layer_2_Expert_9_EP2_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27126.4,-17518.4C27123.24,-17517.96 27120.11,-17517.53 27117,-17517.11 26932.51,-17492.18 26723.2,-17470.68 26564.97,-17455.8"/>
<polygon fill="black" stroke="black" points="26564.9,-17452.28 26554.62,-17454.83 26564.25,-17459.25 26564.9,-17452.28"/>
</g>
<!-- Layer_2_Expert_9_EP2_TP1_PP0 -->
<g id="node133" class="node">
<title>Layer_2_Expert_9_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27898.5,-17585.11 27521.5,-17585.11 27521.5,-17517.11 27898.5,-17517.11 27898.5,-17585.11"/>
<text text-anchor="middle" x="27710" y="-17569.91" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="27710" y="-17554.91" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="27710" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27710" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_9_EP2_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge208" class="edge">
<title>Layer_2_Expert_9_EP2_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27521.42,-17518.25C27518.26,-17517.86 27515.11,-17517.48 27512,-17517.11 27194.84,-17479.74 26828.2,-17457.31 26585.56,-17445.34"/>
<polygon fill="black" stroke="black" points="26585.7,-17441.84 26575.54,-17444.85 26585.36,-17448.83 26585.7,-17441.84"/>
</g>
<!-- Layer_2_Expert_10_EP2_TP0_PP0 -->
<g id="node134" class="node">
<title>Layer_2_Expert_10_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28293.5,-17585.11 27916.5,-17585.11 27916.5,-17517.11 28293.5,-17517.11 28293.5,-17585.11"/>
<text text-anchor="middle" x="28105" y="-17569.91" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="28105" y="-17554.91" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="28105" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28105" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_10_EP2_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge210" class="edge">
<title>Layer_2_Expert_10_EP2_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27916.42,-17518.18C27913.26,-17517.81 27910.12,-17517.45 27907,-17517.11 27447.43,-17466.97 26909.71,-17446.88 26592.11,-17438.98"/>
<polygon fill="black" stroke="black" points="26591.92,-17435.48 26581.84,-17438.73 26591.75,-17442.47 26591.92,-17435.48"/>
</g>
<!-- Layer_2_Expert_10_EP2_TP1_PP0 -->
<g id="node135" class="node">
<title>Layer_2_Expert_10_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28688.5,-17585.11 28311.5,-17585.11 28311.5,-17517.11 28688.5,-17517.11 28688.5,-17585.11"/>
<text text-anchor="middle" x="28500" y="-17569.91" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="28500" y="-17554.91" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="28500" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28500" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_10_EP2_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge212" class="edge">
<title>Layer_2_Expert_10_EP2_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28311.43,-17518.13C28308.26,-17517.78 28305.12,-17517.43 28302,-17517.11 27694.57,-17454.02 26977.86,-17438.46 26593.59,-17434.86"/>
<polygon fill="black" stroke="black" points="26593.47,-17431.36 26583.44,-17434.77 26593.41,-17438.36 26593.47,-17431.36"/>
</g>
<!-- Layer_2_Expert_11_EP2_TP0_PP0 -->
<g id="node136" class="node">
<title>Layer_2_Expert_11_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29083.5,-17585.11 28706.5,-17585.11 28706.5,-17517.11 29083.5,-17517.11 29083.5,-17585.11"/>
<text text-anchor="middle" x="28895" y="-17569.91" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="28895" y="-17554.91" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="28895" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28895" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_11_EP2_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge214" class="edge">
<title>Layer_2_Expert_11_EP2_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28706.43,-17518.1C28703.27,-17517.76 28700.12,-17517.42 28697,-17517.11 28296.47,-17476.91 27128.24,-17449.8 26591.95,-17439.12"/>
<polygon fill="black" stroke="black" points="26591.81,-17435.62 26581.75,-17438.92 26591.67,-17442.62 26591.81,-17435.62"/>
</g>
<!-- Layer_2_Expert_11_EP2_TP1_PP0 -->
<g id="node137" class="node">
<title>Layer_2_Expert_11_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29478.5,-17585.11 29101.5,-17585.11 29101.5,-17517.11 29478.5,-17517.11 29478.5,-17585.11"/>
<text text-anchor="middle" x="29290" y="-17569.91" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="29290" y="-17554.91" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="29290" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29290" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_11_EP2_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge216" class="edge">
<title>Layer_2_Expert_11_EP2_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29101.43,-17518.08C29098.27,-17517.74 29095.12,-17517.42 29092,-17517.11 28613.43,-17470.28 27195.1,-17445.98 26592.65,-17437.54"/>
<polygon fill="black" stroke="black" points="26592.58,-17434.03 26582.53,-17437.39 26592.48,-17441.03 26592.58,-17434.03"/>
</g>
<!-- Layer_2_Expert_12_EP3_TP0_PP0 -->
<g id="node138" class="node">
<title>Layer_2_Expert_12_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29873.5,-17585.11 29496.5,-17585.11 29496.5,-17517.11 29873.5,-17517.11 29873.5,-17585.11"/>
<text text-anchor="middle" x="29685" y="-17569.91" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="29685" y="-17554.91" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="29685" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29685" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_12_EP3_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge218" class="edge">
<title>Layer_2_Expert_12_EP3_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29496.44,-17518.07C29493.27,-17517.73 29490.12,-17517.41 29487,-17517.11 28929.78,-17463.63 27257.5,-17442.69 26593.31,-17436.34"/>
<polygon fill="black" stroke="black" points="26593.16,-17432.84 26583.13,-17436.24 26593.09,-17439.84 26593.16,-17432.84"/>
</g>
<!-- Layer_2_Expert_12_EP3_TP1_PP0 -->
<g id="node139" class="node">
<title>Layer_2_Expert_12_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30268.5,-17585.11 29891.5,-17585.11 29891.5,-17517.11 30268.5,-17517.11 30268.5,-17585.11"/>
<text text-anchor="middle" x="30080" y="-17569.91" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="30080" y="-17554.91" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="30080" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30080" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_12_EP3_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge220" class="edge">
<title>Layer_2_Expert_12_EP3_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29891.44,-17518.05C29888.27,-17517.72 29885.12,-17517.41 29882,-17517.11 29245.51,-17456.96 27315.57,-17439.79 26593.55,-17435.4"/>
<polygon fill="black" stroke="black" points="26593.55,-17431.9 26583.53,-17435.34 26593.51,-17438.9 26593.55,-17431.9"/>
</g>
<!-- Layer_2_Expert_13_EP3_TP0_PP0 -->
<g id="node140" class="node">
<title>Layer_2_Expert_13_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30663.5,-17585.11 30286.5,-17585.11 30286.5,-17517.11 30663.5,-17517.11 30663.5,-17585.11"/>
<text text-anchor="middle" x="30475" y="-17569.91" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="30475" y="-17554.91" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="30475" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30475" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_13_EP3_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge222" class="edge">
<title>Layer_2_Expert_13_EP3_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30286.44,-17518.04C30283.27,-17517.71 30280.12,-17517.4 30277,-17517.11 29560.82,-17450.27 27370.65,-17437.19 26593.82,-17434.64"/>
<polygon fill="black" stroke="black" points="26593.63,-17431.14 26583.62,-17434.61 26593.61,-17438.14 26593.63,-17431.14"/>
</g>
<!-- Layer_2_Expert_13_EP3_TP1_PP0 -->
<g id="node141" class="node">
<title>Layer_2_Expert_13_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31058.5,-17585.11 30681.5,-17585.11 30681.5,-17517.11 31058.5,-17517.11 31058.5,-17585.11"/>
<text text-anchor="middle" x="30870" y="-17569.91" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="30870" y="-17554.91" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="30870" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30870" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_13_EP3_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge224" class="edge">
<title>Layer_2_Expert_13_EP3_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30681.44,-17518.04C30678.27,-17517.71 30675.12,-17517.4 30672,-17517.11 29875.72,-17443.56 27422.76,-17434.83 26593.92,-17434.02"/>
<polygon fill="black" stroke="black" points="26593.64,-17430.52 26583.64,-17434.01 26593.64,-17437.52 26593.64,-17430.52"/>
</g>
<!-- Layer_2_Expert_14_EP3_TP0_PP0 -->
<g id="node142" class="node">
<title>Layer_2_Expert_14_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31453.5,-17585.11 31076.5,-17585.11 31076.5,-17517.11 31453.5,-17517.11 31453.5,-17585.11"/>
<text text-anchor="middle" x="31265" y="-17569.91" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="31265" y="-17554.91" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="31265" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31265" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_14_EP3_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge226" class="edge">
<title>Layer_2_Expert_14_EP3_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31076.44,-17518.03C31073.27,-17517.7 31070.12,-17517.4 31067,-17517.11 30190.32,-17436.83 27472.74,-17432.67 26594.09,-17433.5"/>
<polygon fill="black" stroke="black" points="26593.83,-17430 26583.84,-17433.51 26593.84,-17437 26593.83,-17430"/>
</g>
<!-- Layer_2_Expert_14_EP3_TP1_PP0 -->
<g id="node143" class="node">
<title>Layer_2_Expert_14_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31848.5,-17585.11 31471.5,-17585.11 31471.5,-17517.11 31848.5,-17517.11 31848.5,-17585.11"/>
<text text-anchor="middle" x="31660" y="-17569.91" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="31660" y="-17554.91" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="31660" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31660" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_14_EP3_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge228" class="edge">
<title>Layer_2_Expert_14_EP3_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31471.44,-17518.02C31468.27,-17517.7 31465.12,-17517.39 31462,-17517.11 30977.47,-17473.07 27591.88,-17443.82 26593.49,-17436.08"/>
<polygon fill="black" stroke="black" points="26593.33,-17432.58 26583.3,-17436 26593.27,-17439.58 26593.33,-17432.58"/>
</g>
<!-- Layer_2_Expert_15_EP3_TP0_PP0 -->
<g id="node144" class="node">
<title>Layer_2_Expert_15_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="32243.5,-17585.11 31866.5,-17585.11 31866.5,-17517.11 32243.5,-17517.11 32243.5,-17585.11"/>
<text text-anchor="middle" x="32055" y="-17569.91" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="32055" y="-17554.91" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="32055" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32055" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_15_EP3_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge230" class="edge">
<title>Layer_2_Expert_15_EP3_TP0_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31866.44,-17518.02C31863.27,-17517.7 31860.12,-17517.39 31857,-17517.11 31331.83,-17469.68 27641.82,-17442.55 26593.9,-17435.74"/>
<polygon fill="black" stroke="black" points="26593.62,-17432.24 26583.6,-17435.67 26593.57,-17439.24 26593.62,-17432.24"/>
</g>
<!-- Layer_2_Expert_15_EP3_TP1_PP0 -->
<g id="node145" class="node">
<title>Layer_2_Expert_15_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="32638.5,-17585.11 32261.5,-17585.11 32261.5,-17517.11 32638.5,-17517.11 32638.5,-17585.11"/>
<text text-anchor="middle" x="32450" y="-17569.91" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="32450" y="-17554.91" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="32450" y="-17539.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32450" y="-17524.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_Expert_15_EP3_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0 -->
<g id="edge232" class="edge">
<title>Layer_2_Expert_15_EP3_TP1_PP0&#45;&gt;Layer_2_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M32261.44,-17518.01C32258.27,-17517.69 32255.12,-17517.39 32252,-17517.11 31686.02,-17466.28 27689.13,-17441.36 26593.92,-17435.44"/>
<polygon fill="black" stroke="black" points="26593.56,-17431.94 26583.55,-17435.38 26593.53,-17438.94 26593.56,-17431.94"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_0_EP0_TP0_PP0 -->
<g id="edge169" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_0_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26013.74,-17666.81C24946.95,-17660.96 21010.41,-17636.14 20404.03,-17585.22"/>
<polygon fill="black" stroke="black" points="20403.92,-17581.69 20393.66,-17584.31 20403.31,-17588.67 20403.92,-17581.69"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_0_EP0_TP1_PP0 -->
<g id="edge171" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_0_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26013.52,-17666.52C24993,-17659.78 21362.71,-17632.76 20798.7,-17585.19"/>
<polygon fill="black" stroke="black" points="20798.92,-17581.69 20788.66,-17584.31 20798.31,-17588.67 20798.92,-17581.69"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_1_EP0_TP0_PP0 -->
<g id="edge173" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_1_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26013.71,-17666.18C25041.94,-17658.52 21716.54,-17629.4 21193.69,-17585.19"/>
<polygon fill="black" stroke="black" points="21193.92,-17581.69 21183.66,-17584.3 21193.31,-17588.67 21193.92,-17581.69"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_1_EP0_TP1_PP0 -->
<g id="edge175" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_1_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26013.36,-17668.67C25156.15,-17669.41 22475.89,-17665.13 21588.69,-17585.21"/>
<polygon fill="black" stroke="black" points="21588.93,-17581.72 21578.66,-17584.3 21588.3,-17588.69 21588.93,-17581.72"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_2_EP0_TP0_PP0 -->
<g id="edge177" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_2_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26013.27,-17668.16C25205.11,-17667.26 22790.1,-17658.4 21983.66,-17585.21"/>
<polygon fill="black" stroke="black" points="21983.94,-17581.72 21973.66,-17584.29 21983.3,-17588.69 21983.94,-17581.72"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_2_EP0_TP1_PP0 -->
<g id="edge179" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_2_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26013.49,-17667.55C25257.01,-17664.91 23104.88,-17651.7 22378.72,-17585.22"/>
<polygon fill="black" stroke="black" points="22378.94,-17581.72 22368.66,-17584.29 22378.29,-17588.69 22378.94,-17581.72"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_3_EP0_TP0_PP0 -->
<g id="edge181" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_3_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M26013.59,-17666.79C25311.42,-17662.33 23420.43,-17645.02 22774.02,-17585.25"/>
<polygon fill="black" stroke="black" points="22773.94,-17581.73 22763.66,-17584.28 22773.29,-17588.69 22773.94,-17581.73"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_3_EP0_TP1_PP0 -->
<g id="edge183" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_3_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M26013.9,-17665.86C25369.22,-17659.44 23735.75,-17638.38 23168.98,-17585.25"/>
<polygon fill="black" stroke="black" points="23168.95,-17581.73 23158.66,-17584.26 23168.28,-17588.7 23168.95,-17581.73"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_4_EP1_TP0_PP0 -->
<g id="edge185" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_4_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26014.44,-17664.66C25431.08,-17656.15 24051.6,-17631.78 23563.96,-17585.25"/>
<polygon fill="black" stroke="black" points="23563.95,-17581.73 23553.66,-17584.25 23563.28,-17588.7 23563.95,-17581.73"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_4_EP1_TP1_PP0 -->
<g id="edge187" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_4_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26015.36,-17663.07C25497.93,-17652.34 24367.81,-17625.22 23958.78,-17585.24"/>
<polygon fill="black" stroke="black" points="23958.96,-17581.74 23948.66,-17584.23 23958.27,-17588.7 23958.96,-17581.74"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_5_EP1_TP0_PP0 -->
<g id="edge189" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_5_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26013.37,-17667.04C25642.71,-17663.1 24950.85,-17647.29 24353.77,-17585.26"/>
<polygon fill="black" stroke="black" points="24353.98,-17581.76 24343.67,-17584.2 24353.25,-17588.72 24353.98,-17581.76"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_5_EP1_TP1_PP0 -->
<g id="edge191" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_5_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26015.46,-17662.83C25711.64,-17654.61 25198.26,-17634.42 24748.94,-17585.29"/>
<polygon fill="black" stroke="black" points="24748.99,-17581.77 24738.67,-17584.16 24748.23,-17588.73 24748.99,-17581.77"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_6_EP1_TP0_PP0 -->
<g id="edge193" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_6_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26023.14,-17656.28C25794.54,-17644.07 25451.02,-17621.78 25143.68,-17585.28"/>
<polygon fill="black" stroke="black" points="25144.02,-17581.8 25133.68,-17584.09 25143.19,-17588.75 25144.02,-17581.8"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_6_EP1_TP1_PP0 -->
<g id="edge195" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_6_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26047.84,-17645.52C25903.83,-17630.66 25714.81,-17609.72 25538.67,-17585.32"/>
<polygon fill="black" stroke="black" points="25539.09,-17581.85 25528.7,-17583.94 25538.12,-17588.78 25539.09,-17581.85"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_7_EP1_TP0_PP0 -->
<g id="edge197" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_7_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M26110.17,-17632.02C26043.32,-17617.78 25966.8,-17601.48 25900.38,-17587.34"/>
<polygon fill="black" stroke="black" points="25900.75,-17583.84 25890.24,-17585.18 25899.29,-17590.68 25900.75,-17583.84"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_7_EP1_TP1_PP0 -->
<g id="edge199" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_7_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26220.72,-17622.31C26207.55,-17612.13 26193.71,-17601.41 26180.91,-17591.51"/>
<polygon fill="black" stroke="black" points="26182.72,-17588.48 26172.67,-17585.13 26178.44,-17594.02 26182.72,-17588.48"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_8_EP2_TP0_PP0 -->
<g id="edge201" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_8_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26373.32,-17623.98C26397.32,-17612.61 26422.9,-17600.49 26446.09,-17589.5"/>
<polygon fill="black" stroke="black" points="26447.65,-17592.63 26455.18,-17585.19 26444.65,-17586.31 26447.65,-17592.63"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_8_EP2_TP1_PP0 -->
<g id="edge203" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_8_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26465.54,-17634.54C26547.92,-17619.6 26644.83,-17602.02 26727.95,-17586.94"/>
<polygon fill="black" stroke="black" points="26728.81,-17590.35 26738.02,-17585.12 26727.56,-17583.46 26728.81,-17590.35"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_9_EP2_TP0_PP0 -->
<g id="edge205" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_9_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26520.87,-17648.54C26685.68,-17634.07 26909.35,-17612.43 27116.25,-17585.18"/>
<polygon fill="black" stroke="black" points="27116.95,-17588.62 27126.4,-17583.84 27116.03,-17581.68 27116.95,-17588.62"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_9_EP2_TP1_PP0 -->
<g id="edge207" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_9_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26539.66,-17658.07C26787.01,-17646.7 27169.87,-17624.61 27511.33,-17585.15"/>
<polygon fill="black" stroke="black" points="27511.89,-17588.61 27521.42,-17583.97 27511.08,-17581.65 27511.89,-17588.61"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_10_EP2_TP0_PP0 -->
<g id="edge209" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_10_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26545.28,-17663.93C26865.75,-17656.66 27421.16,-17637.26 27906.42,-17585.13"/>
<polygon fill="black" stroke="black" points="27906.86,-17588.6 27916.43,-17584.05 27906.11,-17581.64 27906.86,-17588.6"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_10_EP2_TP1_PP0 -->
<g id="edge211" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_10_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26546.53,-17667.75C26931.94,-17664.75 27667.18,-17650.13 28301.17,-17585.15"/>
<polygon fill="black" stroke="black" points="28301.84,-17588.6 28311.43,-17584.09 28301.12,-17581.63 28301.84,-17588.6"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_11_EP2_TP0_PP0 -->
<g id="edge213" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_11_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26544.74,-17663.47C27078.34,-17653.23 28267.83,-17626.61 28696.45,-17585.1"/>
<polygon fill="black" stroke="black" points="28696.82,-17588.58 28706.43,-17584.12 28696.14,-17581.62 28696.82,-17588.58"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_11_EP2_TP1_PP0 -->
<g id="edge215" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_11_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26545.69,-17664.95C27144.15,-17656.89 28584.25,-17633.14 29091.46,-17585.1"/>
<polygon fill="black" stroke="black" points="29091.82,-17588.58 29101.43,-17584.14 29091.15,-17581.61 29091.82,-17588.58"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_12_EP3_TP0_PP0 -->
<g id="edge217" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_12_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26546.19,-17666.07C27204.91,-17660.06 28899.49,-17639.73 29486.18,-17585.12"/>
<polygon fill="black" stroke="black" points="29486.81,-17588.58 29496.44,-17584.16 29486.15,-17581.61 29486.81,-17588.58"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_12_EP3_TP1_PP0 -->
<g id="edge219" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_12_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26546.37,-17666.96C27261.71,-17662.87 29214.86,-17646.34 29881.24,-17585.12"/>
<polygon fill="black" stroke="black" points="29881.81,-17588.58 29891.44,-17584.17 29881.16,-17581.61 29881.81,-17588.58"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_13_EP3_TP0_PP0 -->
<g id="edge221" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_13_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26546.7,-17667.67C27315.82,-17665.38 29530.06,-17652.99 30276.37,-17585.11"/>
<polygon fill="black" stroke="black" points="30276.8,-17588.58 30286.44,-17584.18 30276.16,-17581.61 30276.8,-17588.58"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_13_EP3_TP1_PP0 -->
<g id="edge223" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_13_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26546.72,-17668.26C27366.69,-17667.67 29844.21,-17659.67 30671.19,-17585.12"/>
<polygon fill="black" stroke="black" points="30671.8,-17588.58 30681.44,-17584.19 30671.16,-17581.61 30671.8,-17588.58"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_14_EP3_TP0_PP0 -->
<g id="edge225" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_14_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26546.62,-17668.76C27415.11,-17669.77 30158.38,-17666.37 31066.17,-17585.12"/>
<polygon fill="black" stroke="black" points="31066.8,-17588.58 31076.44,-17584.19 31066.16,-17581.61 31066.8,-17588.58"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_14_EP3_TP1_PP0 -->
<g id="edge227" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_14_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26546.09,-17666.26C27529.19,-17658.78 30926.76,-17630.01 31461.18,-17585.09"/>
<polygon fill="black" stroke="black" points="31461.78,-17588.56 31471.44,-17584.2 31461.17,-17581.58 31461.78,-17588.56"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_15_EP3_TP0_PP0 -->
<g id="edge229" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_15_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26546.6,-17666.58C27578.48,-17660.01 31280.7,-17633.35 31856.19,-17585.09"/>
<polygon fill="black" stroke="black" points="31856.78,-17588.56 31866.44,-17584.2 31856.18,-17581.58 31856.78,-17588.56"/>
</g>
<!-- Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_15_EP3_TP1_PP0 -->
<g id="edge231" class="edge">
<title>Layer_2_A2A_Dispatch_PP0&#45;&gt;Layer_2_Expert_15_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26546.37,-17666.86C27624.38,-17661.16 31634.97,-17636.7 32251.33,-17585.08"/>
<polygon fill="black" stroke="black" points="32251.78,-17588.56 32261.44,-17584.21 32251.18,-17581.58 32251.78,-17588.56"/>
</g>
<!-- Layer_2_MLP_Out_TP0_PP0 -->
<g id="node148" class="node">
<title>Layer_2_MLP_Out_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26290.5,-17348.94 25913.5,-17348.94 25913.5,-17280.94 26290.5,-17280.94 26290.5,-17348.94"/>
<text text-anchor="middle" x="26102" y="-17333.74" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="26102" y="-17318.74" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26102" y="-17303.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26102" y="-17288.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_A2A_Combine_PP0&#45;&gt;Layer_2_MLP_Out_TP0_PP0 -->
<g id="edge233" class="edge">
<title>Layer_2_A2A_Combine_PP0&#45;&gt;Layer_2_MLP_Out_TP0_PP0</title>
<path fill="none" stroke="black" d="M26234.18,-17387.31C26213.77,-17376.29 26192.1,-17364.59 26172.34,-17353.92"/>
<polygon fill="black" stroke="black" points="26173.87,-17350.77 26163.41,-17349.1 26170.54,-17356.93 26173.87,-17350.77"/>
</g>
<!-- Layer_2_MLP_Out_TP1_PP0 -->
<g id="node149" class="node">
<title>Layer_2_MLP_Out_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26685.5,-17348.94 26308.5,-17348.94 26308.5,-17280.94 26685.5,-17280.94 26685.5,-17348.94"/>
<text text-anchor="middle" x="26497" y="-17333.74" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="26497" y="-17318.74" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26497" y="-17303.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26497" y="-17288.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_2_A2A_Combine_PP0&#45;&gt;Layer_2_MLP_Out_TP1_PP0 -->
<g id="edge235" class="edge">
<title>Layer_2_A2A_Combine_PP0&#45;&gt;Layer_2_MLP_Out_TP1_PP0</title>
<path fill="none" stroke="black" d="M26387.37,-17386.65C26403.76,-17376.08 26421.06,-17364.92 26436.95,-17354.67"/>
<polygon fill="black" stroke="black" points="26439.12,-17357.44 26445.63,-17349.08 26435.32,-17351.55 26439.12,-17357.44"/>
</g>
<!-- Layer_2_MLP_AllReduce_PP0 -->
<g id="node150" class="node">
<title>Layer_2_MLP_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26195" cy="-17196.86" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26195" y="-17215.66" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="26195" y="-17200.66" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26195" y="-17185.66" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26195" y="-17170.66" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_2_MLP_Out_TP0_PP0&#45;&gt;Layer_2_MLP_AllReduce_PP0 -->
<g id="edge234" class="edge">
<title>Layer_2_MLP_Out_TP0_PP0&#45;&gt;Layer_2_MLP_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26128.65,-17280.68C26135.69,-17271.89 26143.49,-17262.16 26151.18,-17252.55"/>
<polygon fill="black" stroke="black" points="26154.08,-17254.53 26157.6,-17244.54 26148.62,-17250.15 26154.08,-17254.53"/>
</g>
<!-- Layer_2_MLP_Out_TP1_PP0&#45;&gt;Layer_2_MLP_AllReduce_PP0 -->
<g id="edge236" class="edge">
<title>Layer_2_MLP_Out_TP1_PP0&#45;&gt;Layer_2_MLP_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26410.86,-17280.83C26381.27,-17269.46 26347.57,-17256.51 26315.74,-17244.27"/>
<polygon fill="black" stroke="black" points="26316.97,-17240.99 26306.38,-17240.67 26314.46,-17247.53 26316.97,-17240.99"/>
</g>
<!-- Layer_2_LayerNorm_PP0 -->
<g id="node151" class="node">
<title>Layer_2_LayerNorm_PP0</title>
<polygon fill="lightgreen" stroke="black" points="26383.5,-17112.78 26006.5,-17112.78 26006.5,-17044.78 26383.5,-17044.78 26383.5,-17112.78"/>
<text text-anchor="middle" x="26195" y="-17097.58" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26195" y="-17082.58" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26195" y="-17067.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26195" y="-17052.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_2_MLP_AllReduce_PP0&#45;&gt;Layer_2_LayerNorm_PP0 -->
<g id="edge237" class="edge">
<title>Layer_2_MLP_AllReduce_PP0&#45;&gt;Layer_2_LayerNorm_PP0</title>
<path fill="none" stroke="black" d="M26195,-17148.65C26195,-17140.26 26195,-17131.56 26195,-17123.28"/>
<polygon fill="black" stroke="black" points="26198.5,-17123.08 26195,-17113.08 26191.5,-17123.08 26198.5,-17123.08"/>
</g>
<!-- Layer_3_QKV_TP0_PP0 -->
<g id="node152" class="node">
<title>Layer_3_QKV_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26385.5,-17008.78 26004.5,-17008.78 26004.5,-16940.78 26385.5,-16940.78 26385.5,-17008.78"/>
<text text-anchor="middle" x="26195" y="-16993.58" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="26195" y="-16978.58" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26195" y="-16963.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26195" y="-16948.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_2_LayerNorm_PP0&#45;&gt;Layer_3_QKV_TP0_PP0 -->
<g id="edge238" class="edge">
<title>Layer_2_LayerNorm_PP0&#45;&gt;Layer_3_QKV_TP0_PP0</title>
<path fill="none" stroke="black" d="M26195,-17044.66C26195,-17036.56 26195,-17027.76 26195,-17019.25"/>
<polygon fill="black" stroke="black" points="26198.5,-17019.08 26195,-17009.08 26191.5,-17019.08 26198.5,-17019.08"/>
</g>
<!-- Layer_3_QKV_AllReduce_PP0 -->
<g id="node154" class="node">
<title>Layer_3_QKV_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="25886" cy="-16856.69" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="25886" y="-16875.49" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="25886" y="-16860.49" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="25886" y="-16845.49" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="25886" y="-16830.49" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_3_QKV_TP0_PP0&#45;&gt;Layer_3_QKV_AllReduce_PP0 -->
<g id="edge239" class="edge">
<title>Layer_3_QKV_TP0_PP0&#45;&gt;Layer_3_QKV_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26106.87,-16940.67C26076.59,-16929.29 26042.11,-16916.34 26009.54,-16904.11"/>
<polygon fill="black" stroke="black" points="26010.55,-16900.75 25999.96,-16900.51 26008.09,-16907.3 26010.55,-16900.75"/>
</g>
<!-- Layer_3_QKV_TP1_PP0 -->
<g id="node153" class="node">
<title>Layer_3_QKV_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="25986.5,-17008.78 25605.5,-17008.78 25605.5,-16940.78 25986.5,-16940.78 25986.5,-17008.78"/>
<text text-anchor="middle" x="25796" y="-16993.58" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="25796" y="-16978.58" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="25796" y="-16963.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25796" y="-16948.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_3_QKV_TP1_PP0&#45;&gt;Layer_3_QKV_AllReduce_PP0 -->
<g id="edge243" class="edge">
<title>Layer_3_QKV_TP1_PP0&#45;&gt;Layer_3_QKV_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M25821.79,-16940.51C25828.61,-16931.72 25836.15,-16921.99 25843.6,-16912.39"/>
<polygon fill="black" stroke="black" points="25846.45,-16914.42 25849.81,-16904.37 25840.92,-16910.13 25846.45,-16914.42"/>
</g>
<!-- Layer_3_Attention_TP0_PP0 -->
<g id="node155" class="node">
<title>Layer_3_Attention_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="25924.5,-16772.61 25543.5,-16772.61 25543.5,-16704.61 25924.5,-16704.61 25924.5,-16772.61"/>
<text text-anchor="middle" x="25734" y="-16757.41" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="25734" y="-16742.41" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="25734" y="-16727.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="25734" y="-16712.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_3_QKV_AllReduce_PP0&#45;&gt;Layer_3_Attention_TP0_PP0 -->
<g id="edge240" class="edge">
<title>Layer_3_QKV_AllReduce_PP0&#45;&gt;Layer_3_Attention_TP0_PP0</title>
<path fill="none" stroke="black" d="M25825.49,-16809.48C25812.31,-16799.42 25798.49,-16788.86 25785.69,-16779.09"/>
<polygon fill="black" stroke="black" points="25787.52,-16776.08 25777.45,-16772.79 25783.27,-16781.65 25787.52,-16776.08"/>
</g>
<!-- Layer_3_Attention_TP1_PP0 -->
<g id="node156" class="node">
<title>Layer_3_Attention_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26323.5,-16772.61 25942.5,-16772.61 25942.5,-16704.61 26323.5,-16704.61 26323.5,-16772.61"/>
<text text-anchor="middle" x="26133" y="-16757.41" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="26133" y="-16742.41" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26133" y="-16727.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="26133" y="-16712.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_3_QKV_AllReduce_PP0&#45;&gt;Layer_3_Attention_TP1_PP0 -->
<g id="edge244" class="edge">
<title>Layer_3_QKV_AllReduce_PP0&#45;&gt;Layer_3_Attention_TP1_PP0</title>
<path fill="none" stroke="black" d="M25980.08,-16811.48C26004.28,-16800.11 26030.07,-16787.99 26053.44,-16777"/>
<polygon fill="black" stroke="black" points="26055.05,-16780.11 26062.61,-16772.69 26052.07,-16773.78 26055.05,-16780.11"/>
</g>
<!-- Layer_3_AttnOut_TP0_PP0 -->
<g id="node157" class="node">
<title>Layer_3_AttnOut_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="25923.5,-16668.61 25546.5,-16668.61 25546.5,-16600.61 25923.5,-16600.61 25923.5,-16668.61"/>
<text text-anchor="middle" x="25735" y="-16653.41" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="25735" y="-16638.41" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="25735" y="-16623.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="25735" y="-16608.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Attention_TP0_PP0&#45;&gt;Layer_3_AttnOut_TP0_PP0 -->
<g id="edge241" class="edge">
<title>Layer_3_Attention_TP0_PP0&#45;&gt;Layer_3_AttnOut_TP0_PP0</title>
<path fill="none" stroke="black" d="M25734.32,-16704.49C25734.4,-16696.39 25734.49,-16687.59 25734.57,-16679.08"/>
<polygon fill="black" stroke="black" points="25738.08,-16678.94 25734.67,-16668.91 25731.08,-16678.88 25738.08,-16678.94"/>
</g>
<!-- Layer_3_AttnOut_TP1_PP0 -->
<g id="node158" class="node">
<title>Layer_3_AttnOut_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26320.5,-16668.61 25943.5,-16668.61 25943.5,-16600.61 26320.5,-16600.61 26320.5,-16668.61"/>
<text text-anchor="middle" x="26132" y="-16653.41" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="26132" y="-16638.41" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26132" y="-16623.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="26132" y="-16608.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Attention_TP1_PP0&#45;&gt;Layer_3_AttnOut_TP1_PP0 -->
<g id="edge245" class="edge">
<title>Layer_3_Attention_TP1_PP0&#45;&gt;Layer_3_AttnOut_TP1_PP0</title>
<path fill="none" stroke="black" d="M26132.68,-16704.49C26132.6,-16696.39 26132.51,-16687.59 26132.43,-16679.08"/>
<polygon fill="black" stroke="black" points="26135.92,-16678.88 26132.33,-16668.91 26128.92,-16678.94 26135.92,-16678.88"/>
</g>
<!-- Layer_3_AttnOut_AllReduce_PP0 -->
<g id="node159" class="node">
<title>Layer_3_AttnOut_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26055" cy="-16516.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26055" y="-16535.33" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="26055" y="-16520.33" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26055" y="-16505.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26055" y="-16490.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_3_AttnOut_TP0_PP0&#45;&gt;Layer_3_AttnOut_AllReduce_PP0 -->
<g id="edge242" class="edge">
<title>Layer_3_AttnOut_TP0_PP0&#45;&gt;Layer_3_AttnOut_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M25826.27,-16600.5C25858.18,-16588.92 25894.6,-16575.71 25928.85,-16563.29"/>
<polygon fill="black" stroke="black" points="25930.24,-16566.51 25938.45,-16559.81 25927.86,-16559.93 25930.24,-16566.51"/>
</g>
<!-- Layer_3_AttnOut_TP1_PP0&#45;&gt;Layer_3_AttnOut_AllReduce_PP0 -->
<g id="edge246" class="edge">
<title>Layer_3_AttnOut_TP1_PP0&#45;&gt;Layer_3_AttnOut_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26109.93,-16600.35C26104.29,-16591.83 26098.06,-16582.44 26091.88,-16573.13"/>
<polygon fill="black" stroke="black" points="26094.69,-16571.04 26086.25,-16564.64 26088.86,-16574.91 26094.69,-16571.04"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0 -->
<g id="node196" class="node">
<title>Layer_3_A2A_Dispatch_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26055" cy="-16384.36" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26055" y="-16403.16" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="26055" y="-16388.16" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26055" y="-16373.16" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26055" y="-16358.16" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_3_AttnOut_AllReduce_PP0&#45;&gt;Layer_3_A2A_Dispatch_PP0 -->
<g id="edge247" class="edge">
<title>Layer_3_AttnOut_AllReduce_PP0&#45;&gt;Layer_3_A2A_Dispatch_PP0</title>
<path fill="none" stroke="black" d="M26055,-16468.17C26055,-16459.9 26055,-16451.22 26055,-16442.71"/>
<polygon fill="black" stroke="black" points="26058.5,-16442.47 26055,-16432.47 26051.5,-16442.47 26058.5,-16442.47"/>
</g>
<!-- Layer_3_Gate_EP0_PP0 -->
<g id="node160" class="node">
<title>Layer_3_Gate_EP0_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="22972.4,-20931.28 22368.86,-20931.28 22213.6,-20795.28 22817.14,-20795.28 22972.4,-20931.28"/>
<text text-anchor="middle" x="22593" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="22593" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="22593" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22593" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_3_Gate_EP1_PP0 -->
<g id="node161" class="node">
<title>Layer_3_Gate_EP1_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="22195.4,-20931.28 21591.86,-20931.28 21436.6,-20795.28 22040.14,-20795.28 22195.4,-20931.28"/>
<text text-anchor="middle" x="21816" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="21816" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="21816" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21816" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_3_Gate_EP2_PP0 -->
<g id="node162" class="node">
<title>Layer_3_Gate_EP2_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="21418.4,-20931.28 20814.86,-20931.28 20659.6,-20795.28 21263.14,-20795.28 21418.4,-20931.28"/>
<text text-anchor="middle" x="21039" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="21039" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="21039" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21039" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_3_Gate_EP3_PP0 -->
<g id="node163" class="node">
<title>Layer_3_Gate_EP3_PP0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="20641.4,-20931.28 20037.86,-20931.28 19882.6,-20795.28 20486.14,-20795.28 20641.4,-20931.28"/>
<text text-anchor="middle" x="20262" y="-20882.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="20262" y="-20867.08" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="20262" y="-20852.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20262" y="-20837.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_3_Expert_0_EP0_TP0_PP0 -->
<g id="node164" class="node">
<title>Layer_3_Expert_0_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="20299.5,-16300.28 19922.5,-16300.28 19922.5,-16232.28 20299.5,-16232.28 20299.5,-16300.28"/>
<text text-anchor="middle" x="20111" y="-16285.08" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20111" y="-16270.08" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="20111" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20111" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_A2A_Combine_PP0 -->
<g id="node197" class="node">
<title>Layer_3_A2A_Combine_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26233" cy="-16148.19" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26233" y="-16166.99" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="26233" y="-16151.99" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26233" y="-16136.99" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26233" y="-16121.99" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_3_Expert_0_EP0_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge249" class="edge">
<title>Layer_3_Expert_0_EP0_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M20299.66,-16233.07C20302.45,-16232.79 20305.24,-16232.53 20308,-16232.28 20872.92,-16181.3 24862.05,-16156.49 25956.08,-16150.6"/>
<polygon fill="black" stroke="black" points="25956.46,-16154.1 25966.45,-16150.54 25956.43,-16147.1 25956.46,-16154.1"/>
</g>
<!-- Layer_3_Expert_0_EP0_TP1_PP0 -->
<g id="node165" class="node">
<title>Layer_3_Expert_0_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="20694.5,-16300.28 20317.5,-16300.28 20317.5,-16232.28 20694.5,-16232.28 20694.5,-16300.28"/>
<text text-anchor="middle" x="20506" y="-16285.08" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20506" y="-16270.08" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="20506" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20506" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_0_EP0_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge251" class="edge">
<title>Layer_3_Expert_0_EP0_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M20694.66,-16233.08C20697.45,-16232.8 20700.24,-16232.53 20703,-16232.28 21227.13,-16184.72 24909.52,-16157.68 25956.15,-16150.9"/>
<polygon fill="black" stroke="black" points="25956.47,-16154.4 25966.45,-16150.83 25956.42,-16147.4 25956.47,-16154.4"/>
</g>
<!-- Layer_3_Expert_1_EP0_TP0_PP0 -->
<g id="node166" class="node">
<title>Layer_3_Expert_1_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21089.5,-16300.28 20712.5,-16300.28 20712.5,-16232.28 21089.5,-16232.28 21089.5,-16300.28"/>
<text text-anchor="middle" x="20901" y="-16285.08" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="20901" y="-16270.08" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="20901" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20901" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_1_EP0_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge253" class="edge">
<title>Layer_3_Expert_1_EP0_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21089.66,-16233.08C21092.45,-16232.8 21095.24,-16232.53 21098,-16232.28 21581.5,-16188.12 24959.63,-16158.96 25956.62,-16151.24"/>
<polygon fill="black" stroke="black" points="25956.82,-16154.74 25966.79,-16151.16 25956.77,-16147.74 25956.82,-16154.74"/>
</g>
<!-- Layer_3_Expert_1_EP0_TP1_PP0 -->
<g id="node167" class="node">
<title>Layer_3_Expert_1_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21484.5,-16300.28 21107.5,-16300.28 21107.5,-16232.28 21484.5,-16232.28 21484.5,-16300.28"/>
<text text-anchor="middle" x="21296" y="-16285.08" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="21296" y="-16270.08" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="21296" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21296" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_1_EP0_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge255" class="edge">
<title>Layer_3_Expert_1_EP0_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21484.66,-16233.09C21487.46,-16232.8 21490.24,-16232.53 21493,-16232.28 22367.67,-16151.8 25078.89,-16147.77 25956.11,-16148.65"/>
<polygon fill="black" stroke="black" points="25956.34,-16152.15 25966.34,-16148.66 25956.35,-16145.15 25956.34,-16152.15"/>
</g>
<!-- Layer_3_Expert_2_EP0_TP0_PP0 -->
<g id="node168" class="node">
<title>Layer_3_Expert_2_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="21879.5,-16300.28 21502.5,-16300.28 21502.5,-16232.28 21879.5,-16232.28 21879.5,-16300.28"/>
<text text-anchor="middle" x="21691" y="-16285.08" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="21691" y="-16270.08" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="21691" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21691" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_2_EP0_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge257" class="edge">
<title>Layer_3_Expert_2_EP0_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M21879.66,-16233.09C21882.46,-16232.81 21885.24,-16232.53 21888,-16232.28 22682.19,-16158.57 25128.33,-16149.94 25955.98,-16149.17"/>
<polygon fill="black" stroke="black" points="25956.25,-16152.67 25966.25,-16149.16 25956.25,-16145.67 25956.25,-16152.67"/>
</g>
<!-- Layer_3_Expert_2_EP0_TP1_PP0 -->
<g id="node169" class="node">
<title>Layer_3_Expert_2_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22274.5,-16300.28 21897.5,-16300.28 21897.5,-16232.28 22274.5,-16232.28 22274.5,-16300.28"/>
<text text-anchor="middle" x="22086" y="-16285.08" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="22086" y="-16270.08" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="22086" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22086" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_2_EP0_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge259" class="edge">
<title>Layer_3_Expert_2_EP0_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22274.66,-16233.1C22277.46,-16232.81 22280.24,-16232.54 22283,-16232.28 22997.13,-16165.31 25180.7,-16152.31 25956.18,-16149.8"/>
<polygon fill="black" stroke="black" points="25956.38,-16153.29 25966.37,-16149.76 25956.36,-16146.29 25956.38,-16153.29"/>
</g>
<!-- Layer_3_Expert_3_EP0_TP0_PP0 -->
<g id="node170" class="node">
<title>Layer_3_Expert_3_EP0_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="22669.5,-16300.28 22292.5,-16300.28 22292.5,-16232.28 22669.5,-16232.28 22669.5,-16300.28"/>
<text text-anchor="middle" x="22481" y="-16285.08" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="22481" y="-16270.08" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="22481" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22481" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_3_EP0_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge261" class="edge">
<title>Layer_3_Expert_3_EP0_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M22669.66,-16233.11C22672.46,-16232.82 22675.24,-16232.54 22678,-16232.28 23312.41,-16172.04 25235.59,-16154.92 25956.31,-16150.56"/>
<polygon fill="black" stroke="black" points="25956.59,-16154.06 25966.57,-16150.5 25956.55,-16147.06 25956.59,-16154.06"/>
</g>
<!-- Layer_3_Expert_3_EP0_TP1_PP0 -->
<g id="node171" class="node">
<title>Layer_3_Expert_3_EP0_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23064.5,-16300.28 22687.5,-16300.28 22687.5,-16232.28 23064.5,-16232.28 23064.5,-16300.28"/>
<text text-anchor="middle" x="22876" y="-16285.08" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="22876" y="-16270.08" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="22876" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22876" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_3_EP0_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge263" class="edge">
<title>Layer_3_Expert_3_EP0_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23064.66,-16233.12C23067.46,-16232.83 23070.24,-16232.54 23073,-16232.28 23628.18,-16178.74 25293.93,-16157.84 25956.64,-16151.5"/>
<polygon fill="black" stroke="black" points="25956.84,-16155 25966.81,-16151.41 25956.78,-16148 25956.84,-16155"/>
</g>
<!-- Layer_3_Expert_4_EP1_TP0_PP0 -->
<g id="node172" class="node">
<title>Layer_3_Expert_4_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23459.5,-16300.28 23082.5,-16300.28 23082.5,-16232.28 23459.5,-16232.28 23459.5,-16300.28"/>
<text text-anchor="middle" x="23271" y="-16285.08" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="23271" y="-16270.08" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="23271" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23271" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_4_EP1_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge265" class="edge">
<title>Layer_3_Expert_4_EP1_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23459.66,-16233.14C23462.46,-16232.84 23465.24,-16232.55 23468,-16232.28 23944.53,-16185.43 25356.29,-16161.15 25957.21,-16152.71"/>
<polygon fill="black" stroke="black" points="25957.36,-16156.21 25967.31,-16152.57 25957.27,-16149.21 25957.36,-16156.21"/>
</g>
<!-- Layer_3_Expert_4_EP1_TP1_PP0 -->
<g id="node173" class="node">
<title>Layer_3_Expert_4_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="23854.5,-16300.28 23477.5,-16300.28 23477.5,-16232.28 23854.5,-16232.28 23854.5,-16300.28"/>
<text text-anchor="middle" x="23666" y="-16285.08" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="23666" y="-16270.08" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="23666" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23666" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_4_EP1_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge267" class="edge">
<title>Layer_3_Expert_4_EP1_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M23854.66,-16233.16C23857.46,-16232.85 23860.24,-16232.56 23863,-16232.28 24261.57,-16192.08 25423.67,-16164.99 25958.18,-16154.3"/>
<polygon fill="black" stroke="black" points="25958.42,-16157.8 25968.35,-16154.1 25958.28,-16150.8 25958.42,-16157.8"/>
</g>
<!-- Layer_3_Expert_5_EP1_TP0_PP0 -->
<g id="node174" class="node">
<title>Layer_3_Expert_5_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24249.5,-16300.28 23872.5,-16300.28 23872.5,-16232.28 24249.5,-16232.28 24249.5,-16300.28"/>
<text text-anchor="middle" x="24061" y="-16285.08" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="24061" y="-16270.08" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="24061" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24061" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_5_EP1_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge269" class="edge">
<title>Layer_3_Expert_5_EP1_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24249.67,-16233.18C24252.46,-16232.87 24255.24,-16232.57 24258,-16232.28 24861.5,-16169.28 25573.46,-16153.67 25956.19,-16150.04"/>
<polygon fill="black" stroke="black" points="25956.33,-16153.54 25966.3,-16149.95 25956.26,-16146.54 25956.33,-16153.54"/>
</g>
<!-- Layer_3_Expert_5_EP1_TP1_PP0 -->
<g id="node175" class="node">
<title>Layer_3_Expert_5_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="24644.5,-16300.28 24267.5,-16300.28 24267.5,-16232.28 24644.5,-16232.28 24644.5,-16300.28"/>
<text text-anchor="middle" x="24456" y="-16285.08" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="24456" y="-16270.08" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="24456" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24456" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_5_EP1_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge271" class="edge">
<title>Layer_3_Expert_5_EP1_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M24644.67,-16233.22C24647.46,-16232.9 24650.24,-16232.58 24653,-16232.28 25108.82,-16182.28 25642.03,-16162.16 25957.86,-16154.21"/>
<polygon fill="black" stroke="black" points="25958.17,-16157.7 25968.08,-16153.96 25957.99,-16150.71 25958.17,-16157.7"/>
</g>
<!-- Layer_3_Expert_6_EP1_TP0_PP0 -->
<g id="node176" class="node">
<title>Layer_3_Expert_6_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25039.5,-16300.28 24662.5,-16300.28 24662.5,-16232.28 25039.5,-16232.28 25039.5,-16300.28"/>
<text text-anchor="middle" x="24851" y="-16285.08" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="24851" y="-16270.08" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="24851" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24851" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_6_EP1_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge273" class="edge">
<title>Layer_3_Expert_6_EP1_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25039.68,-16233.29C25042.47,-16232.94 25045.25,-16232.6 25048,-16232.28 25361.45,-16195.12 25723.66,-16172.7 25964.29,-16160.67"/>
<polygon fill="black" stroke="black" points="25964.77,-16164.15 25974.59,-16160.16 25964.43,-16157.16 25964.77,-16164.15"/>
</g>
<!-- Layer_3_Expert_6_EP1_TP1_PP0 -->
<g id="node177" class="node">
<title>Layer_3_Expert_6_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25434.5,-16300.28 25057.5,-16300.28 25057.5,-16232.28 25434.5,-16232.28 25434.5,-16300.28"/>
<text text-anchor="middle" x="25246" y="-16285.08" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="25246" y="-16270.08" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="25246" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25246" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_6_EP1_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge275" class="edge">
<title>Layer_3_Expert_6_EP1_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25434.7,-16233.43C25437.48,-16233.04 25440.25,-16232.65 25443,-16232.28 25624.35,-16207.58 25829.98,-16186.16 25985.98,-16171.26"/>
<polygon fill="black" stroke="black" points="25986.56,-16174.72 25996.18,-16170.28 25985.9,-16167.75 25986.56,-16174.72"/>
</g>
<!-- Layer_3_Expert_7_EP1_TP0_PP0 -->
<g id="node178" class="node">
<title>Layer_3_Expert_7_EP1_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="25829.5,-16300.28 25452.5,-16300.28 25452.5,-16232.28 25829.5,-16232.28 25829.5,-16300.28"/>
<text text-anchor="middle" x="25641" y="-16285.08" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="25641" y="-16270.08" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="25641" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25641" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_7_EP1_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge277" class="edge">
<title>Layer_3_Expert_7_EP1_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M25809.46,-16232.25C25882.97,-16217.83 25969.47,-16200.87 26045.07,-16186.05"/>
<polygon fill="black" stroke="black" points="26046.04,-16189.42 26055.18,-16184.06 26044.7,-16182.55 26046.04,-16189.42"/>
</g>
<!-- Layer_3_Expert_7_EP1_TP1_PP0 -->
<g id="node179" class="node">
<title>Layer_3_Expert_7_EP1_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26224.5,-16300.28 25847.5,-16300.28 25847.5,-16232.28 26224.5,-16232.28 26224.5,-16300.28"/>
<text text-anchor="middle" x="26036" y="-16285.08" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="26036" y="-16270.08" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="26036" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26036" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_7_EP1_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge279" class="edge">
<title>Layer_3_Expert_7_EP1_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26092.19,-16232.17C26109.47,-16221.99 26128.89,-16210.54 26147.67,-16199.48"/>
<polygon fill="black" stroke="black" points="26149.69,-16202.35 26156.53,-16194.26 26146.13,-16196.32 26149.69,-16202.35"/>
</g>
<!-- Layer_3_Expert_8_EP2_TP0_PP0 -->
<g id="node180" class="node">
<title>Layer_3_Expert_8_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="26619.5,-16300.28 26242.5,-16300.28 26242.5,-16232.28 26619.5,-16232.28 26619.5,-16300.28"/>
<text text-anchor="middle" x="26431" y="-16285.08" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="26431" y="-16270.08" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="26431" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26431" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_8_EP2_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge281" class="edge">
<title>Layer_3_Expert_8_EP2_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26374.53,-16232.17C26357.08,-16221.94 26337.46,-16210.44 26318.51,-16199.33"/>
<polygon fill="black" stroke="black" points="26320.26,-16196.3 26309.86,-16194.26 26316.72,-16202.33 26320.26,-16196.3"/>
</g>
<!-- Layer_3_Expert_8_EP2_TP1_PP0 -->
<g id="node181" class="node">
<title>Layer_3_Expert_8_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27014.5,-16300.28 26637.5,-16300.28 26637.5,-16232.28 27014.5,-16232.28 27014.5,-16300.28"/>
<text text-anchor="middle" x="26826" y="-16285.08" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="26826" y="-16270.08" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="26826" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26826" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_8_EP2_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge283" class="edge">
<title>Layer_3_Expert_8_EP2_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M26657.26,-16232.25C26583.62,-16217.83 26496.97,-16200.87 26421.25,-16186.05"/>
<polygon fill="black" stroke="black" points="26421.6,-16182.55 26411.12,-16184.06 26420.26,-16189.42 26421.6,-16182.55"/>
</g>
<!-- Layer_3_Expert_9_EP2_TP0_PP0 -->
<g id="node182" class="node">
<title>Layer_3_Expert_9_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27409.5,-16300.28 27032.5,-16300.28 27032.5,-16232.28 27409.5,-16232.28 27409.5,-16300.28"/>
<text text-anchor="middle" x="27221" y="-16285.08" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="27221" y="-16270.08" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="27221" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27221" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_9_EP2_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge285" class="edge">
<title>Layer_3_Expert_9_EP2_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27032.4,-16233.58C27029.24,-16233.13 27026.11,-16232.7 27023,-16232.28 26841.64,-16207.65 26636.01,-16186.23 26480.01,-16171.31"/>
<polygon fill="black" stroke="black" points="26480.1,-16167.8 26469.81,-16170.33 26479.43,-16174.77 26480.1,-16167.8"/>
</g>
<!-- Layer_3_Expert_9_EP2_TP1_PP0 -->
<g id="node183" class="node">
<title>Layer_3_Expert_9_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="27804.5,-16300.28 27427.5,-16300.28 27427.5,-16232.28 27804.5,-16232.28 27804.5,-16300.28"/>
<text text-anchor="middle" x="27616" y="-16285.08" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="27616" y="-16270.08" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="27616" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="27616" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_9_EP2_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge287" class="edge">
<title>Layer_3_Expert_9_EP2_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27427.42,-16233.42C27424.26,-16233.03 27421.11,-16232.65 27418,-16232.28 27104.53,-16195.25 26742.33,-16172.8 26501.7,-16160.73"/>
<polygon fill="black" stroke="black" points="26501.57,-16157.22 26491.41,-16160.22 26501.22,-16164.21 26501.57,-16157.22"/>
</g>
<!-- Layer_3_Expert_10_EP2_TP0_PP0 -->
<g id="node184" class="node">
<title>Layer_3_Expert_10_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28199.5,-16300.28 27822.5,-16300.28 27822.5,-16232.28 28199.5,-16232.28 28199.5,-16300.28"/>
<text text-anchor="middle" x="28011" y="-16285.08" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="28011" y="-16270.08" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="28011" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28011" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_10_EP2_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge289" class="edge">
<title>Layer_3_Expert_10_EP2_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M27822.42,-16233.35C27819.26,-16232.98 27816.12,-16232.62 27813,-16232.28 27357.16,-16182.47 26823.96,-16162.29 26508.13,-16154.28"/>
<polygon fill="black" stroke="black" points="26508,-16150.77 26497.92,-16154.02 26507.83,-16157.77 26508,-16150.77"/>
</g>
<!-- Layer_3_Expert_10_EP2_TP1_PP0 -->
<g id="node185" class="node">
<title>Layer_3_Expert_10_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28594.5,-16300.28 28217.5,-16300.28 28217.5,-16232.28 28594.5,-16232.28 28594.5,-16300.28"/>
<text text-anchor="middle" x="28406" y="-16285.08" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="28406" y="-16270.08" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="28406" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28406" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_10_EP2_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge291" class="edge">
<title>Layer_3_Expert_10_EP2_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28217.43,-16233.3C28214.26,-16232.94 28211.12,-16232.6 28208,-16232.28 27604.48,-16169.53 26892.53,-16153.83 26509.8,-16150.11"/>
<polygon fill="black" stroke="black" points="26509.73,-16146.61 26499.7,-16150.02 26509.66,-16153.61 26509.73,-16146.61"/>
</g>
<!-- Layer_3_Expert_11_EP2_TP0_PP0 -->
<g id="node186" class="node">
<title>Layer_3_Expert_11_EP2_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="28989.5,-16300.28 28612.5,-16300.28 28612.5,-16232.28 28989.5,-16232.28 28989.5,-16300.28"/>
<text text-anchor="middle" x="28801" y="-16285.08" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="28801" y="-16270.08" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="28801" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="28801" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_11_EP2_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge293" class="edge">
<title>Layer_3_Expert_11_EP2_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M28612.43,-16233.27C28609.27,-16232.92 28606.12,-16232.59 28603,-16232.28 28204.41,-16192.25 27042.32,-16165.07 26507.81,-16154.33"/>
<polygon fill="black" stroke="black" points="26507.72,-16150.83 26497.65,-16154.13 26507.57,-16157.83 26507.72,-16150.83"/>
</g>
<!-- Layer_3_Expert_11_EP2_TP1_PP0 -->
<g id="node187" class="node">
<title>Layer_3_Expert_11_EP2_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29384.5,-16300.28 29007.5,-16300.28 29007.5,-16232.28 29384.5,-16232.28 29384.5,-16300.28"/>
<text text-anchor="middle" x="29196" y="-16285.08" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="29196" y="-16270.08" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="29196" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29196" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_11_EP2_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge295" class="edge">
<title>Layer_3_Expert_11_EP2_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29007.43,-16233.25C29004.27,-16232.91 29001.12,-16232.58 28998,-16232.28 28521.46,-16185.62 27109.7,-16161.24 26508.78,-16152.74"/>
<polygon fill="black" stroke="black" points="26508.73,-16149.24 26498.68,-16152.6 26508.63,-16156.24 26508.73,-16149.24"/>
</g>
<!-- Layer_3_Expert_12_EP3_TP0_PP0 -->
<g id="node188" class="node">
<title>Layer_3_Expert_12_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="29779.5,-16300.28 29402.5,-16300.28 29402.5,-16232.28 29779.5,-16232.28 29779.5,-16300.28"/>
<text text-anchor="middle" x="29591" y="-16285.08" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="29591" y="-16270.08" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="29591" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29591" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_12_EP3_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge297" class="edge">
<title>Layer_3_Expert_12_EP3_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29402.44,-16233.23C29399.27,-16232.9 29396.12,-16232.58 29393,-16232.28 28837.79,-16178.97 27172.06,-16157.94 26509.35,-16151.53"/>
<polygon fill="black" stroke="black" points="26509.22,-16148.03 26499.19,-16151.43 26509.15,-16155.03 26509.22,-16148.03"/>
</g>
<!-- Layer_3_Expert_12_EP3_TP1_PP0 -->
<g id="node189" class="node">
<title>Layer_3_Expert_12_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30174.5,-16300.28 29797.5,-16300.28 29797.5,-16232.28 30174.5,-16232.28 30174.5,-16300.28"/>
<text text-anchor="middle" x="29986" y="-16285.08" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="29986" y="-16270.08" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="29986" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="29986" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_12_EP3_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge299" class="edge">
<title>Layer_3_Expert_12_EP3_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M29797.44,-16233.22C29794.27,-16232.89 29791.12,-16232.57 29788,-16232.28 29153.56,-16172.3 27230.4,-16155.03 26509.69,-16150.59"/>
<polygon fill="black" stroke="black" points="26509.45,-16147.08 26499.43,-16150.52 26509.41,-16154.08 26509.45,-16147.08"/>
</g>
<!-- Layer_3_Expert_13_EP3_TP0_PP0 -->
<g id="node190" class="node">
<title>Layer_3_Expert_13_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30569.5,-16300.28 30192.5,-16300.28 30192.5,-16232.28 30569.5,-16232.28 30569.5,-16300.28"/>
<text text-anchor="middle" x="30381" y="-16285.08" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="30381" y="-16270.08" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="30381" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30381" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_13_EP3_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge301" class="edge">
<title>Layer_3_Expert_13_EP3_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30192.44,-16233.21C30189.27,-16232.88 30186.12,-16232.57 30183,-16232.28 29468.85,-16165.6 27285.29,-16152.42 26509.82,-16149.82"/>
<polygon fill="black" stroke="black" points="26509.64,-16146.32 26499.63,-16149.79 26509.62,-16153.32 26509.64,-16146.32"/>
</g>
<!-- Layer_3_Expert_13_EP3_TP1_PP0 -->
<g id="node191" class="node">
<title>Layer_3_Expert_13_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="30964.5,-16300.28 30587.5,-16300.28 30587.5,-16232.28 30964.5,-16232.28 30964.5,-16300.28"/>
<text text-anchor="middle" x="30776" y="-16285.08" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="30776" y="-16270.08" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="30776" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="30776" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_13_EP3_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge303" class="edge">
<title>Layer_3_Expert_13_EP3_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30587.44,-16233.2C30584.27,-16232.88 30581.12,-16232.57 30578,-16232.28 29783.78,-16158.9 27337.66,-16150.05 26510.01,-16149.2"/>
<polygon fill="black" stroke="black" points="26509.75,-16145.7 26499.75,-16149.19 26509.75,-16152.7 26509.75,-16145.7"/>
</g>
<!-- Layer_3_Expert_14_EP3_TP0_PP0 -->
<g id="node192" class="node">
<title>Layer_3_Expert_14_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31359.5,-16300.28 30982.5,-16300.28 30982.5,-16232.28 31359.5,-16232.28 31359.5,-16300.28"/>
<text text-anchor="middle" x="31171" y="-16285.08" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="31171" y="-16270.08" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="31171" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31171" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_14_EP3_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge305" class="edge">
<title>Layer_3_Expert_14_EP3_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M30982.44,-16233.2C30979.27,-16232.87 30976.12,-16232.56 30973,-16232.28 30098.29,-16152.16 27387.1,-16147.88 26509.89,-16148.68"/>
<polygon fill="black" stroke="black" points="26509.65,-16145.18 26499.65,-16148.69 26509.66,-16152.18 26509.65,-16145.18"/>
</g>
<!-- Layer_3_Expert_14_EP3_TP1_PP0 -->
<g id="node193" class="node">
<title>Layer_3_Expert_14_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="31754.5,-16300.28 31377.5,-16300.28 31377.5,-16232.28 31754.5,-16232.28 31754.5,-16300.28"/>
<text text-anchor="middle" x="31566" y="-16285.08" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="31566" y="-16270.08" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="31566" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31566" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_14_EP3_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge307" class="edge">
<title>Layer_3_Expert_14_EP3_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31377.44,-16233.19C31374.27,-16232.87 31371.12,-16232.56 31368,-16232.28 30884.48,-16188.32 27506.37,-16159.02 26509.38,-16151.25"/>
<polygon fill="black" stroke="black" points="26509.23,-16147.75 26499.21,-16151.18 26509.18,-16154.75 26509.23,-16147.75"/>
</g>
<!-- Layer_3_Expert_15_EP3_TP0_PP0 -->
<g id="node194" class="node">
<title>Layer_3_Expert_15_EP3_TP0_PP0</title>
<polygon fill="lightcoral" stroke="black" points="32149.5,-16300.28 31772.5,-16300.28 31772.5,-16232.28 32149.5,-16232.28 32149.5,-16300.28"/>
<text text-anchor="middle" x="31961" y="-16285.08" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="31961" y="-16270.08" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="31961" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="31961" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_15_EP3_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge309" class="edge">
<title>Layer_3_Expert_15_EP3_TP0_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M31772.44,-16233.19C31769.27,-16232.86 31766.12,-16232.56 31763,-16232.28 31238.85,-16184.93 27556.47,-16157.74 26509.85,-16150.91"/>
<polygon fill="black" stroke="black" points="26509.58,-16147.41 26499.55,-16150.85 26509.53,-16154.41 26509.58,-16147.41"/>
</g>
<!-- Layer_3_Expert_15_EP3_TP1_PP0 -->
<g id="node195" class="node">
<title>Layer_3_Expert_15_EP3_TP1_PP0</title>
<polygon fill="lightcoral" stroke="black" points="32544.5,-16300.28 32167.5,-16300.28 32167.5,-16232.28 32544.5,-16232.28 32544.5,-16300.28"/>
<text text-anchor="middle" x="32356" y="-16285.08" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="32356" y="-16270.08" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="32356" y="-16255.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="32356" y="-16240.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_Expert_15_EP3_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0 -->
<g id="edge311" class="edge">
<title>Layer_3_Expert_15_EP3_TP1_PP0&#45;&gt;Layer_3_A2A_Combine_PP0</title>
<path fill="none" stroke="black" d="M32167.44,-16233.18C32164.27,-16232.86 32161.12,-16232.56 32158,-16232.28 31593.05,-16181.53 27603.95,-16156.56 26509.92,-16150.61"/>
<polygon fill="black" stroke="black" points="26509.57,-16147.11 26499.55,-16150.56 26509.53,-16154.11 26509.57,-16147.11"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_0_EP0_TP0_PP0 -->
<g id="edge248" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_0_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M25788.42,-16381.89C24736.34,-16375.74 20901.59,-16350.18 20309.78,-16300.36"/>
<polygon fill="black" stroke="black" points="20309.92,-16296.86 20299.66,-16299.48 20309.31,-16303.84 20309.92,-16296.86"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_0_EP0_TP1_PP0 -->
<g id="edge250" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_0_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M25788.44,-16381.58C24783.79,-16374.54 21255.66,-16346.81 20704.85,-16300.37"/>
<polygon fill="black" stroke="black" points="20704.92,-16296.86 20694.66,-16299.48 20704.31,-16303.83 20704.92,-16296.86"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_1_EP0_TP0_PP0 -->
<g id="edge252" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_1_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M25788.57,-16381.22C24833.19,-16373.24 21609.28,-16343.46 21099.79,-16300.36"/>
<polygon fill="black" stroke="black" points="21099.93,-16296.86 21089.66,-16299.47 21099.31,-16303.83 21099.93,-16296.86"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_1_EP0_TP1_PP0 -->
<g id="edge254" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_1_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M25788.43,-16383.68C24947.36,-16383.88 22355.14,-16378.06 21494.7,-16300.38"/>
<polygon fill="black" stroke="black" points="21494.93,-16296.89 21484.66,-16299.46 21494.3,-16303.86 21494.93,-16296.89"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_2_EP0_TP0_PP0 -->
<g id="edge256" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_2_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M25788.34,-16383.14C24997.13,-16381.67 22669.9,-16371.34 21889.9,-16300.4"/>
<polygon fill="black" stroke="black" points="21889.94,-16296.89 21879.66,-16299.46 21889.29,-16303.86 21889.94,-16296.89"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_2_EP0_TP1_PP0 -->
<g id="edge258" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_2_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M25788.5,-16382.48C25049.72,-16379.25 22984.57,-16364.65 22284.86,-16300.4"/>
<polygon fill="black" stroke="black" points="22284.94,-16296.89 22274.66,-16299.45 22284.29,-16303.86 22284.94,-16296.89"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_3_EP0_TP0_PP0 -->
<g id="edge260" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_3_EP0_TP0_PP0</title>
<path fill="none" stroke="black" d="M25788.61,-16381.67C25105.09,-16376.57 23300.01,-16357.98 22680.05,-16300.42"/>
<polygon fill="black" stroke="black" points="22679.94,-16296.89 22669.66,-16299.44 22679.29,-16303.86 22679.94,-16296.89"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_3_EP0_TP1_PP0 -->
<g id="edge262" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_3_EP0_TP1_PP0</title>
<path fill="none" stroke="black" d="M25789.15,-16380.66C25164.37,-16373.56 23615.32,-16351.36 23074.89,-16300.41"/>
<polygon fill="black" stroke="black" points="23074.95,-16296.9 23064.66,-16299.43 23074.28,-16303.86 23074.95,-16296.9"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_4_EP1_TP0_PP0 -->
<g id="edge264" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_4_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M25789.8,-16379.35C25227.72,-16370.12 23931.12,-16344.76 23469.74,-16300.4"/>
<polygon fill="black" stroke="black" points="23469.96,-16296.9 23459.66,-16299.41 23469.27,-16303.87 23469.96,-16296.9"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_4_EP1_TP1_PP0 -->
<g id="edge266" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_4_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M25788.09,-16384.24C25376.55,-16383.12 24562.44,-16371.14 23864.67,-16300.41"/>
<polygon fill="black" stroke="black" points="23864.97,-16296.92 23854.66,-16299.39 23864.26,-16303.88 23864.97,-16296.92"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_5_EP1_TP0_PP0 -->
<g id="edge268" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_5_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M25788.97,-16381C25439.69,-16375.64 24807.5,-16358.18 24259.75,-16300.42"/>
<polygon fill="black" stroke="black" points="24259.98,-16296.93 24249.67,-16299.36 24259.24,-16303.89 24259.98,-16296.93"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_5_EP1_TP1_PP0 -->
<g id="edge270" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_5_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M25792.01,-16376.16C25512.08,-16366.55 25056.18,-16345.35 24654.74,-16300.44"/>
<polygon fill="black" stroke="black" points="24655,-16296.95 24644.67,-16299.31 24654.22,-16303.9 24655,-16296.95"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_6_EP1_TP0_PP0 -->
<g id="edge272" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_6_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M25803.25,-16368.45C25601.78,-16355.13 25311.9,-16332.85 25049.78,-16300.47"/>
<polygon fill="black" stroke="black" points="25050.04,-16296.98 25039.68,-16299.22 25049.18,-16303.92 25050.04,-16296.98"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_6_EP1_TP1_PP0 -->
<g id="edge274" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_6_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M25840.22,-16355.86C25725.62,-16340.78 25581.93,-16321.23 25444.98,-16300.57"/>
<polygon fill="black" stroke="black" points="25445.12,-16297.05 25434.71,-16299.01 25444.08,-16303.97 25445.12,-16297.05"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_7_EP1_TP0_PP0 -->
<g id="edge276" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_7_EP1_TP0_PP0</title>
<path fill="none" stroke="black" d="M25913.1,-16343.57C25866.23,-16330.43 25814.4,-16315.9 25768.65,-16303.07"/>
<polygon fill="black" stroke="black" points="25769.56,-16299.69 25758.99,-16300.36 25767.67,-16306.43 25769.56,-16299.69"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_7_EP1_TP1_PP0 -->
<g id="edge278" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_7_EP1_TP1_PP0</title>
<path fill="none" stroke="black" d="M26047.27,-16336.15C26045.88,-16327.67 26044.44,-16318.87 26043.08,-16310.51"/>
<polygon fill="black" stroke="black" points="26046.52,-16309.88 26041.45,-16300.58 26039.61,-16311.02 26046.52,-16309.88"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_8_EP2_TP0_PP0 -->
<g id="edge280" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_8_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26187.3,-16342.52C26228.71,-16329.73 26274.09,-16315.72 26314.35,-16303.29"/>
<polygon fill="black" stroke="black" points="26315.41,-16306.63 26323.93,-16300.33 26313.34,-16299.94 26315.41,-16306.63"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_8_EP2_TP1_PP0 -->
<g id="edge282" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_8_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26263.04,-16354.28C26369.09,-16339.18 26500.34,-16320.1 26627.45,-16300.35"/>
<polygon fill="black" stroke="black" points="26628.03,-16303.81 26637.37,-16298.81 26626.95,-16296.89 26628.03,-16303.81"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_9_EP2_TP0_PP0 -->
<g id="edge284" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_9_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26304.51,-16367.42C26497.76,-16353.77 26772.26,-16331.55 27022.4,-16300.32"/>
<polygon fill="black" stroke="black" points="27022.92,-16303.78 27032.41,-16299.06 27022.05,-16296.84 27022.92,-16303.78"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_9_EP2_TP1_PP0 -->
<g id="edge286" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_9_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26317.32,-16375.49C26589.94,-16365.43 27028.96,-16343.94 27417.39,-16300.3"/>
<polygon fill="black" stroke="black" points="27417.88,-16303.77 27427.42,-16299.17 27417.09,-16296.82 27417.88,-16303.77"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_10_EP2_TP0_PP0 -->
<g id="edge288" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_10_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26320.82,-16380.54C26663.56,-16374.69 27278,-16356.69 27812.2,-16300.32"/>
<polygon fill="black" stroke="black" points="27812.85,-16303.77 27822.43,-16299.23 27812.11,-16296.8 27812.85,-16303.77"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_10_EP2_TP1_PP0 -->
<g id="edge290" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_10_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26321.76,-16383.9C26727.37,-16382.28 27523.38,-16369.58 28207.37,-16300.29"/>
<polygon fill="black" stroke="black" points="28207.84,-16303.76 28217.43,-16299.27 28207.13,-16296.8 28207.84,-16303.76"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_11_EP2_TP0_PP0 -->
<g id="edge292" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_11_EP2_TP0_PP0</title>
<path fill="none" stroke="black" d="M26320.17,-16379.17C26875.74,-16369.67 28147.33,-16343.94 28602.17,-16300.3"/>
<polygon fill="black" stroke="black" points="28602.82,-16303.75 28612.43,-16299.29 28602.14,-16296.78 28602.82,-16303.75"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_11_EP2_TP1_PP0 -->
<g id="edge294" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_11_EP2_TP1_PP0</title>
<path fill="none" stroke="black" d="M26320.83,-16380.52C26939.67,-16373.16 28463.77,-16350.49 28997.33,-16300.28"/>
<polygon fill="black" stroke="black" points="28997.81,-16303.75 29007.44,-16299.31 28997.15,-16296.78 28997.81,-16303.75"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_12_EP3_TP0_PP0 -->
<g id="edge296" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_12_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26321.41,-16381.56C26999.38,-16376.19 28779.11,-16357.08 29392.16,-16300.29"/>
<polygon fill="black" stroke="black" points="29392.81,-16303.75 29402.44,-16299.33 29392.15,-16296.78 29392.81,-16303.75"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_12_EP3_TP1_PP0 -->
<g id="edge298" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_12_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26321.38,-16382.38C27054.8,-16378.9 29094.51,-16363.71 29787.34,-16300.28"/>
<polygon fill="black" stroke="black" points="29787.8,-16303.75 29797.44,-16299.34 29787.16,-16296.78 29787.8,-16303.75"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_13_EP3_TP0_PP0 -->
<g id="edge300" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_13_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26321.61,-16383.05C27107.76,-16381.33 29409.21,-16370.37 30182.29,-16300.28"/>
<polygon fill="black" stroke="black" points="30182.8,-16303.75 30192.44,-16299.35 30182.16,-16296.78 30182.8,-16303.75"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_13_EP3_TP1_PP0 -->
<g id="edge302" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_13_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26321.87,-16383.6C27158.45,-16383.55 29724.09,-16377.05 30577.48,-16300.26"/>
<polygon fill="black" stroke="black" points="30577.8,-16303.75 30587.44,-16299.36 30577.16,-16296.78 30577.8,-16303.75"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_14_EP3_TP0_PP0 -->
<g id="edge304" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_14_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26321.91,-16384.07C27206.42,-16385.6 30037.71,-16383.76 30972.21,-16300.29"/>
<polygon fill="black" stroke="black" points="30972.8,-16303.75 30982.44,-16299.36 30972.17,-16296.78 30972.8,-16303.75"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_14_EP3_TP1_PP0 -->
<g id="edge306" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_14_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26321.33,-16381.53C27320.96,-16374.36 30819.68,-16346.28 31367.31,-16300.25"/>
<polygon fill="black" stroke="black" points="31367.78,-16303.72 31377.44,-16299.37 31367.17,-16296.75 31367.78,-16303.72"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_15_EP3_TP0_PP0 -->
<g id="edge308" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_15_EP3_TP0_PP0</title>
<path fill="none" stroke="black" d="M26321.56,-16381.84C27369.05,-16375.56 31173.77,-16349.62 31762.37,-16300.25"/>
<polygon fill="black" stroke="black" points="31762.78,-16303.73 31772.44,-16299.37 31762.18,-16296.75 31762.78,-16303.73"/>
</g>
<!-- Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_15_EP3_TP1_PP0 -->
<g id="edge310" class="edge">
<title>Layer_3_A2A_Dispatch_PP0&#45;&gt;Layer_3_Expert_15_EP3_TP1_PP0</title>
<path fill="none" stroke="black" d="M26321.61,-16382.12C27414.89,-16376.68 31526.29,-16352.99 32157.09,-16300.27"/>
<polygon fill="black" stroke="black" points="32157.78,-16303.73 32167.44,-16299.38 32157.18,-16296.75 32157.78,-16303.73"/>
</g>
<!-- Layer_3_MLP_Out_TP0_PP0 -->
<g id="node198" class="node">
<title>Layer_3_MLP_Out_TP0_PP0</title>
<polygon fill="lightblue" stroke="black" points="26223.5,-16064.11 25846.5,-16064.11 25846.5,-15996.11 26223.5,-15996.11 26223.5,-16064.11"/>
<text text-anchor="middle" x="26035" y="-16048.91" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="26035" y="-16033.91" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26035" y="-16018.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26035" y="-16003.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_A2A_Combine_PP0&#45;&gt;Layer_3_MLP_Out_TP0_PP0 -->
<g id="edge312" class="edge">
<title>Layer_3_A2A_Combine_PP0&#45;&gt;Layer_3_MLP_Out_TP0_PP0</title>
<path fill="none" stroke="black" d="M26156.16,-16102.15C26137.67,-16091.3 26118.08,-16079.82 26100.18,-16069.32"/>
<polygon fill="black" stroke="black" points="26101.93,-16066.29 26091.53,-16064.26 26098.39,-16072.33 26101.93,-16066.29"/>
</g>
<!-- Layer_3_MLP_Out_TP1_PP0 -->
<g id="node199" class="node">
<title>Layer_3_MLP_Out_TP1_PP0</title>
<polygon fill="lightblue" stroke="black" points="26618.5,-16064.11 26241.5,-16064.11 26241.5,-15996.11 26618.5,-15996.11 26618.5,-16064.11"/>
<text text-anchor="middle" x="26430" y="-16048.91" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="26430" y="-16033.91" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="26430" y="-16018.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26430" y="-16003.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_3_A2A_Combine_PP0&#45;&gt;Layer_3_MLP_Out_TP1_PP0 -->
<g id="edge314" class="edge">
<title>Layer_3_A2A_Combine_PP0&#45;&gt;Layer_3_MLP_Out_TP1_PP0</title>
<path fill="none" stroke="black" d="M26309.73,-16101.98C26327.95,-16091.25 26347.21,-16079.9 26364.85,-16069.5"/>
<polygon fill="black" stroke="black" points="26367.08,-16072.25 26373.91,-16064.16 26363.52,-16066.22 26367.08,-16072.25"/>
</g>
<!-- Layer_3_MLP_AllReduce_PP0 -->
<g id="node200" class="node">
<title>Layer_3_MLP_AllReduce_PP0</title>
<ellipse fill="yellow" stroke="black" cx="26232" cy="-15912.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="26232" y="-15930.83" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="26232" y="-15915.83" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26232" y="-15900.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26232" y="-15885.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_3_MLP_Out_TP0_PP0&#45;&gt;Layer_3_MLP_AllReduce_PP0 -->
<g id="edge313" class="edge">
<title>Layer_3_MLP_Out_TP0_PP0&#45;&gt;Layer_3_MLP_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26091.19,-15996C26108.47,-15985.82 26127.89,-15974.37 26146.67,-15963.31"/>
<polygon fill="black" stroke="black" points="26148.69,-15966.18 26155.53,-15958.09 26145.13,-15960.15 26148.69,-15966.18"/>
</g>
<!-- Layer_3_MLP_Out_TP1_PP0&#45;&gt;Layer_3_MLP_AllReduce_PP0 -->
<g id="edge315" class="edge">
<title>Layer_3_MLP_Out_TP1_PP0&#45;&gt;Layer_3_MLP_AllReduce_PP0</title>
<path fill="none" stroke="black" d="M26373.53,-15996C26356.08,-15985.77 26336.46,-15974.27 26317.51,-15963.16"/>
<polygon fill="black" stroke="black" points="26319.26,-15960.13 26308.86,-15958.09 26315.72,-15966.17 26319.26,-15960.13"/>
</g>
<!-- Layer_3_LayerNorm_PP0 -->
<g id="node201" class="node">
<title>Layer_3_LayerNorm_PP0</title>
<polygon fill="lightgreen" stroke="black" points="26420.5,-15827.94 26043.5,-15827.94 26043.5,-15759.94 26420.5,-15759.94 26420.5,-15827.94"/>
<text text-anchor="middle" x="26232" y="-15812.74" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26232" y="-15797.74" font-family="Arial" font-size="14.00">PP Stage 0</text>
<text text-anchor="middle" x="26232" y="-15782.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26232" y="-15767.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_3_MLP_AllReduce_PP0&#45;&gt;Layer_3_LayerNorm_PP0 -->
<g id="edge316" class="edge">
<title>Layer_3_MLP_AllReduce_PP0&#45;&gt;Layer_3_LayerNorm_PP0</title>
<path fill="none" stroke="black" d="M26232,-15863.81C26232,-15855.43 26232,-15846.73 26232,-15838.45"/>
<polygon fill="black" stroke="black" points="26235.5,-15838.25 26232,-15828.25 26228.5,-15838.25 26235.5,-15838.25"/>
</g>
<!-- Layer_4_QKV_TP0_PP1 -->
<g id="node202" class="node">
<title>Layer_4_QKV_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="26422.5,-15680.94 26041.5,-15680.94 26041.5,-15612.94 26422.5,-15612.94 26422.5,-15680.94"/>
<text text-anchor="middle" x="26232" y="-15665.74" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="26232" y="-15650.74" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="26232" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26232" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_3_LayerNorm_PP0&#45;&gt;Layer_4_QKV_TP0_PP1 -->
<g id="edge317" class="edge">
<title>Layer_3_LayerNorm_PP0&#45;&gt;Layer_4_QKV_TP0_PP1</title>
<path fill="none" stroke="black" d="M26232,-15759.68C26232,-15739.32 26232,-15713.06 26232,-15691.12"/>
<polygon fill="black" stroke="black" points="26235.5,-15691.06 26232,-15681.06 26228.5,-15691.06 26235.5,-15691.06"/>
</g>
<!-- Layer_4_QKV_AllReduce_PP1 -->
<g id="node204" class="node">
<title>Layer_4_QKV_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="25833" cy="-15494.86" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="25833" y="-15513.66" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="25833" y="-15498.66" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="25833" y="-15483.66" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="25833" y="-15468.66" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_4_QKV_TP0_PP1&#45;&gt;Layer_4_QKV_AllReduce_PP1 -->
<g id="edge318" class="edge">
<title>Layer_4_QKV_TP0_PP1&#45;&gt;Layer_4_QKV_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M26143.94,-15612.82C26088.94,-15592.13 26017.29,-15565.18 25956.64,-15542.37"/>
<polygon fill="black" stroke="black" points="25957.6,-15538.99 25947,-15538.74 25955.13,-15545.54 25957.6,-15538.99"/>
</g>
<!-- Layer_4_QKV_TP1_PP1 -->
<g id="node203" class="node">
<title>Layer_4_QKV_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="26023.5,-15680.94 25642.5,-15680.94 25642.5,-15612.94 26023.5,-15612.94 26023.5,-15680.94"/>
<text text-anchor="middle" x="25833" y="-15665.74" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="25833" y="-15650.74" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="25833" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25833" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_4_QKV_TP1_PP1&#45;&gt;Layer_4_QKV_AllReduce_PP1 -->
<g id="edge322" class="edge">
<title>Layer_4_QKV_TP1_PP1&#45;&gt;Layer_4_QKV_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M25833,-15612.64C25833,-15595.13 25833,-15573.17 25833,-15553.04"/>
<polygon fill="black" stroke="black" points="25836.5,-15553.02 25833,-15543.02 25829.5,-15553.02 25836.5,-15553.02"/>
</g>
<!-- Layer_4_Attention_TP0_PP1 -->
<g id="node205" class="node">
<title>Layer_4_Attention_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="25624.5,-15410.78 25243.5,-15410.78 25243.5,-15342.78 25624.5,-15342.78 25624.5,-15410.78"/>
<text text-anchor="middle" x="25434" y="-15395.58" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="25434" y="-15380.58" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="25434" y="-15365.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="25434" y="-15350.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_4_QKV_AllReduce_PP1&#45;&gt;Layer_4_Attention_TP0_PP1 -->
<g id="edge319" class="edge">
<title>Layer_4_QKV_AllReduce_PP1&#45;&gt;Layer_4_Attention_TP0_PP1</title>
<path fill="none" stroke="black" d="M25693.73,-15453.34C25649.31,-15440.42 25600.51,-15426.22 25557.31,-15413.65"/>
<polygon fill="black" stroke="black" points="25558.18,-15410.26 25547.61,-15410.83 25556.23,-15416.98 25558.18,-15410.26"/>
</g>
<!-- Layer_4_Attention_TP1_PP1 -->
<g id="node206" class="node">
<title>Layer_4_Attention_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="26023.5,-15410.78 25642.5,-15410.78 25642.5,-15342.78 26023.5,-15342.78 26023.5,-15410.78"/>
<text text-anchor="middle" x="25833" y="-15395.58" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="25833" y="-15380.58" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="25833" y="-15365.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="25833" y="-15350.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_4_QKV_AllReduce_PP1&#45;&gt;Layer_4_Attention_TP1_PP1 -->
<g id="edge323" class="edge">
<title>Layer_4_QKV_AllReduce_PP1&#45;&gt;Layer_4_Attention_TP1_PP1</title>
<path fill="none" stroke="black" d="M25833,-15446.65C25833,-15438.26 25833,-15429.56 25833,-15421.29"/>
<polygon fill="black" stroke="black" points="25836.5,-15421.08 25833,-15411.08 25829.5,-15421.08 25836.5,-15421.08"/>
</g>
<!-- Layer_4_AttnOut_TP0_PP1 -->
<g id="node207" class="node">
<title>Layer_4_AttnOut_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="25622.5,-15306.78 25245.5,-15306.78 25245.5,-15238.78 25622.5,-15238.78 25622.5,-15306.78"/>
<text text-anchor="middle" x="25434" y="-15291.58" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="25434" y="-15276.58" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="25434" y="-15261.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="25434" y="-15246.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Attention_TP0_PP1&#45;&gt;Layer_4_AttnOut_TP0_PP1 -->
<g id="edge320" class="edge">
<title>Layer_4_Attention_TP0_PP1&#45;&gt;Layer_4_AttnOut_TP0_PP1</title>
<path fill="none" stroke="black" d="M25434,-15342.66C25434,-15334.56 25434,-15325.76 25434,-15317.25"/>
<polygon fill="black" stroke="black" points="25437.5,-15317.08 25434,-15307.08 25430.5,-15317.08 25437.5,-15317.08"/>
</g>
<!-- Layer_4_AttnOut_TP1_PP1 -->
<g id="node208" class="node">
<title>Layer_4_AttnOut_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="26019.5,-15306.78 25642.5,-15306.78 25642.5,-15238.78 26019.5,-15238.78 26019.5,-15306.78"/>
<text text-anchor="middle" x="25831" y="-15291.58" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="25831" y="-15276.58" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="25831" y="-15261.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="25831" y="-15246.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Attention_TP1_PP1&#45;&gt;Layer_4_AttnOut_TP1_PP1 -->
<g id="edge324" class="edge">
<title>Layer_4_Attention_TP1_PP1&#45;&gt;Layer_4_AttnOut_TP1_PP1</title>
<path fill="none" stroke="black" d="M25832.35,-15342.66C25832.19,-15334.56 25832.02,-15325.76 25831.85,-15317.25"/>
<polygon fill="black" stroke="black" points="25835.35,-15317.01 25831.65,-15307.08 25828.35,-15317.14 25835.35,-15317.01"/>
</g>
<!-- Layer_4_AttnOut_AllReduce_PP1 -->
<g id="node209" class="node">
<title>Layer_4_AttnOut_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="25434" cy="-15154.69" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="25434" y="-15173.49" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="25434" y="-15158.49" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="25434" y="-15143.49" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25434" y="-15128.49" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_4_AttnOut_TP0_PP1&#45;&gt;Layer_4_AttnOut_AllReduce_PP1 -->
<g id="edge321" class="edge">
<title>Layer_4_AttnOut_TP0_PP1&#45;&gt;Layer_4_AttnOut_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M25434,-15238.51C25434,-15230.52 25434,-15221.75 25434,-15213.01"/>
<polygon fill="black" stroke="black" points="25437.5,-15212.8 25434,-15202.8 25430.5,-15212.8 25437.5,-15212.8"/>
</g>
<!-- Layer_4_AttnOut_TP1_PP1&#45;&gt;Layer_4_AttnOut_AllReduce_PP1 -->
<g id="edge325" class="edge">
<title>Layer_4_AttnOut_TP1_PP1&#45;&gt;Layer_4_AttnOut_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M25718.03,-15238.75C25675.54,-15226.32 25626.58,-15212 25581.4,-15198.8"/>
<polygon fill="black" stroke="black" points="25582.1,-15195.35 25571.52,-15195.91 25580.14,-15202.07 25582.1,-15195.35"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1 -->
<g id="node246" class="node">
<title>Layer_4_A2A_Dispatch_PP1</title>
<ellipse fill="yellow" stroke="black" cx="20308" cy="-15022.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="20308" y="-15041.33" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="20308" y="-15026.33" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="20308" y="-15011.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20308" y="-14996.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_4_AttnOut_AllReduce_PP1&#45;&gt;Layer_4_A2A_Dispatch_PP1 -->
<g id="edge326" class="edge">
<title>Layer_4_AttnOut_AllReduce_PP1&#45;&gt;Layer_4_A2A_Dispatch_PP1</title>
<path fill="none" stroke="black" d="M25170.53,-15147C24292.89,-15124.72 21473.8,-15053.13 20581.52,-15030.47"/>
<polygon fill="black" stroke="black" points="20581.52,-15026.97 20571.43,-15030.22 20581.34,-15033.97 20581.52,-15026.97"/>
</g>
<!-- Layer_4_Gate_EP0_PP1 -->
<g id="node210" class="node">
<title>Layer_4_Gate_EP0_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="25624.4,-15714.94 25020.86,-15714.94 24865.6,-15578.94 25469.14,-15578.94 25624.4,-15714.94"/>
<text text-anchor="middle" x="25245" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="25245" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="25245" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25245" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_4_Gate_EP1_PP1 -->
<g id="node211" class="node">
<title>Layer_4_Gate_EP1_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24847.4,-15714.94 24243.86,-15714.94 24088.6,-15578.94 24692.14,-15578.94 24847.4,-15714.94"/>
<text text-anchor="middle" x="24468" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="24468" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="24468" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24468" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_4_Gate_EP2_PP1 -->
<g id="node212" class="node">
<title>Layer_4_Gate_EP2_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24070.4,-15714.94 23466.86,-15714.94 23311.6,-15578.94 23915.14,-15578.94 24070.4,-15714.94"/>
<text text-anchor="middle" x="23691" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="23691" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="23691" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23691" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_4_Gate_EP3_PP1 -->
<g id="node213" class="node">
<title>Layer_4_Gate_EP3_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23293.4,-15714.94 22689.86,-15714.94 22534.6,-15578.94 23138.14,-15578.94 23293.4,-15714.94"/>
<text text-anchor="middle" x="22914" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="22914" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="22914" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22914" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_4_Expert_0_EP0_TP0_PP1 -->
<g id="node214" class="node">
<title>Layer_4_Expert_0_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14176.5,-14938.45 13799.5,-14938.45 13799.5,-14870.45 14176.5,-14870.45 14176.5,-14938.45"/>
<text text-anchor="middle" x="13988" y="-14923.25" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13988" y="-14908.25" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="13988" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13988" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_A2A_Combine_PP1 -->
<g id="node247" class="node">
<title>Layer_4_A2A_Combine_PP1</title>
<ellipse fill="yellow" stroke="black" cx="20091" cy="-14786.36" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="20091" y="-14805.16" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="20091" y="-14790.16" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="20091" y="-14775.16" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20091" y="-14760.16" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_4_Expert_0_EP0_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge328" class="edge">
<title>Layer_4_Expert_0_EP0_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14176.66,-14871.24C14179.45,-14870.96 14182.24,-14870.69 14185,-14870.45 14747.95,-14819.63 18722.2,-14794.72 19814.05,-14788.78"/>
<polygon fill="black" stroke="black" points="19814.41,-14792.28 19824.39,-14788.73 19814.37,-14785.28 19814.41,-14792.28"/>
</g>
<!-- Layer_4_Expert_0_EP0_TP1_PP1 -->
<g id="node215" class="node">
<title>Layer_4_Expert_0_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14571.5,-14938.45 14194.5,-14938.45 14194.5,-14870.45 14571.5,-14870.45 14571.5,-14938.45"/>
<text text-anchor="middle" x="14383" y="-14923.25" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="14383" y="-14908.25" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="14383" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14383" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_0_EP0_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge330" class="edge">
<title>Layer_4_Expert_0_EP0_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14571.66,-14871.25C14574.45,-14870.96 14577.24,-14870.7 14580,-14870.45 15102.18,-14823.05 18769.99,-14795.91 19814.21,-14789.08"/>
<polygon fill="black" stroke="black" points="19814.51,-14792.58 19824.48,-14789.01 19814.46,-14785.58 19814.51,-14792.58"/>
</g>
<!-- Layer_4_Expert_1_EP0_TP0_PP1 -->
<g id="node216" class="node">
<title>Layer_4_Expert_1_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14966.5,-14938.45 14589.5,-14938.45 14589.5,-14870.45 14966.5,-14870.45 14966.5,-14938.45"/>
<text text-anchor="middle" x="14778" y="-14923.25" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14778" y="-14908.25" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="14778" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14778" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_1_EP0_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge332" class="edge">
<title>Layer_4_Expert_1_EP0_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14966.66,-14871.25C14969.45,-14870.97 14972.24,-14870.7 14975,-14870.45 15456.51,-14826.46 18819.45,-14797.2 19814.36,-14789.43"/>
<polygon fill="black" stroke="black" points="19814.54,-14792.93 19824.51,-14789.35 19814.49,-14785.93 19814.54,-14792.93"/>
</g>
<!-- Layer_4_Expert_1_EP0_TP1_PP1 -->
<g id="node217" class="node">
<title>Layer_4_Expert_1_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15361.5,-14938.45 14984.5,-14938.45 14984.5,-14870.45 15361.5,-14870.45 15361.5,-14938.45"/>
<text text-anchor="middle" x="15173" y="-14923.25" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="15173" y="-14908.25" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="15173" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15173" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_1_EP0_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge334" class="edge">
<title>Layer_4_Expert_1_EP0_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15361.66,-14871.26C15364.46,-14870.97 15367.24,-14870.7 15370,-14870.45 16240.79,-14790.3 18939.15,-14786.03 19814.07,-14786.84"/>
<polygon fill="black" stroke="black" points="19814.28,-14790.34 19824.28,-14786.85 19814.28,-14783.34 19814.28,-14790.34"/>
</g>
<!-- Layer_4_Expert_2_EP0_TP0_PP1 -->
<g id="node218" class="node">
<title>Layer_4_Expert_2_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15756.5,-14938.45 15379.5,-14938.45 15379.5,-14870.45 15756.5,-14870.45 15756.5,-14938.45"/>
<text text-anchor="middle" x="15568" y="-14923.25" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15568" y="-14908.25" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="15568" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15568" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_2_EP0_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge336" class="edge">
<title>Layer_4_Expert_2_EP0_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15756.66,-14871.26C15759.46,-14870.97 15762.24,-14870.7 15765,-14870.45 16555.36,-14797.06 18989.01,-14788.22 19814.1,-14787.36"/>
<polygon fill="black" stroke="black" points="19814.34,-14790.86 19824.34,-14787.35 19814.33,-14783.86 19814.34,-14790.86"/>
</g>
<!-- Layer_4_Expert_2_EP0_TP1_PP1 -->
<g id="node219" class="node">
<title>Layer_4_Expert_2_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16151.5,-14938.45 15774.5,-14938.45 15774.5,-14870.45 16151.5,-14870.45 16151.5,-14938.45"/>
<text text-anchor="middle" x="15963" y="-14923.25" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15963" y="-14908.25" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="15963" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15963" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_2_EP0_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge338" class="edge">
<title>Layer_4_Expert_2_EP0_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16151.66,-14871.27C16154.46,-14870.98 16157.24,-14870.7 16160,-14870.45 16870.27,-14803.8 19041.18,-14790.6 19814.13,-14788"/>
<polygon fill="black" stroke="black" points="19814.3,-14791.5 19824.29,-14787.96 19814.27,-14784.5 19814.3,-14791.5"/>
</g>
<!-- Layer_4_Expert_3_EP0_TP0_PP1 -->
<g id="node220" class="node">
<title>Layer_4_Expert_3_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16546.5,-14938.45 16169.5,-14938.45 16169.5,-14870.45 16546.5,-14870.45 16546.5,-14938.45"/>
<text text-anchor="middle" x="16358" y="-14923.25" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="16358" y="-14908.25" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="16358" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16358" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_3_EP0_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge340" class="edge">
<title>Layer_4_Expert_3_EP0_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16546.66,-14871.28C16549.46,-14870.99 16552.24,-14870.71 16555,-14870.45 17185.64,-14810.52 19096.62,-14793.22 19814.49,-14788.76"/>
<polygon fill="black" stroke="black" points="19814.73,-14792.26 19824.71,-14788.7 19814.69,-14785.26 19814.73,-14792.26"/>
</g>
<!-- Layer_4_Expert_3_EP0_TP1_PP1 -->
<g id="node221" class="node">
<title>Layer_4_Expert_3_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16941.5,-14938.45 16564.5,-14938.45 16564.5,-14870.45 16941.5,-14870.45 16941.5,-14938.45"/>
<text text-anchor="middle" x="16753" y="-14923.25" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="16753" y="-14908.25" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="16753" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16753" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_3_EP0_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge342" class="edge">
<title>Layer_4_Expert_3_EP0_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16941.66,-14871.29C16944.46,-14870.99 16947.24,-14870.71 16950,-14870.45 17501.42,-14817.23 19155.04,-14796.16 19814.79,-14789.72"/>
<polygon fill="black" stroke="black" points="19814.95,-14793.22 19824.91,-14789.62 19814.88,-14786.22 19814.95,-14793.22"/>
</g>
<!-- Layer_4_Expert_4_EP1_TP0_PP1 -->
<g id="node222" class="node">
<title>Layer_4_Expert_4_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17336.5,-14938.45 16959.5,-14938.45 16959.5,-14870.45 17336.5,-14870.45 17336.5,-14938.45"/>
<text text-anchor="middle" x="17148" y="-14923.25" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="17148" y="-14908.25" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="17148" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17148" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_4_EP1_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge344" class="edge">
<title>Layer_4_Expert_4_EP1_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17336.66,-14871.3C17339.46,-14871 17342.24,-14870.72 17345,-14870.45 17817.81,-14823.91 19217.7,-14799.49 19815.43,-14790.94"/>
<polygon fill="black" stroke="black" points="19815.53,-14794.44 19825.48,-14790.8 19815.43,-14787.44 19815.53,-14794.44"/>
</g>
<!-- Layer_4_Expert_4_EP1_TP1_PP1 -->
<g id="node223" class="node">
<title>Layer_4_Expert_4_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17731.5,-14938.45 17354.5,-14938.45 17354.5,-14870.45 17731.5,-14870.45 17731.5,-14938.45"/>
<text text-anchor="middle" x="17543" y="-14923.25" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="17543" y="-14908.25" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="17543" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17543" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_4_EP1_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge346" class="edge">
<title>Layer_4_Expert_4_EP1_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17731.66,-14871.32C17734.46,-14871.02 17737.24,-14870.72 17740,-14870.45 18134.87,-14830.57 19285.22,-14803.35 19816.35,-14792.56"/>
<polygon fill="black" stroke="black" points="19816.53,-14796.06 19826.46,-14792.35 19816.39,-14789.06 19816.53,-14796.06"/>
</g>
<!-- Layer_4_Expert_5_EP1_TP0_PP1 -->
<g id="node224" class="node">
<title>Layer_4_Expert_5_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18126.5,-14938.45 17749.5,-14938.45 17749.5,-14870.45 18126.5,-14870.45 18126.5,-14938.45"/>
<text text-anchor="middle" x="17938" y="-14923.25" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="17938" y="-14908.25" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="17938" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17938" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_5_EP1_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge348" class="edge">
<title>Layer_4_Expert_5_EP1_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18126.67,-14871.35C18129.46,-14871.04 18132.24,-14870.73 18135,-14870.45 18731.43,-14808.06 19434.84,-14792.2 19814.46,-14788.37"/>
<polygon fill="black" stroke="black" points="19814.52,-14791.87 19824.48,-14788.27 19814.45,-14784.87 19814.52,-14791.87"/>
</g>
<!-- Layer_4_Expert_5_EP1_TP1_PP1 -->
<g id="node225" class="node">
<title>Layer_4_Expert_5_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18521.5,-14938.45 18144.5,-14938.45 18144.5,-14870.45 18521.5,-14870.45 18521.5,-14938.45"/>
<text text-anchor="middle" x="18333" y="-14923.25" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="18333" y="-14908.25" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="18333" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18333" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_5_EP1_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge350" class="edge">
<title>Layer_4_Expert_5_EP1_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18521.67,-14871.39C18524.46,-14871.07 18527.24,-14870.75 18530,-14870.45 18979,-14821.05 19504.01,-14800.76 19816.39,-14792.62"/>
<polygon fill="black" stroke="black" points="19816.59,-14796.11 19826.49,-14792.35 19816.41,-14789.11 19816.59,-14796.11"/>
</g>
<!-- Layer_4_Expert_6_EP1_TP0_PP1 -->
<g id="node226" class="node">
<title>Layer_4_Expert_6_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18916.5,-14938.45 18539.5,-14938.45 18539.5,-14870.45 18916.5,-14870.45 18916.5,-14938.45"/>
<text text-anchor="middle" x="18728" y="-14923.25" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="18728" y="-14908.25" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="18728" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18728" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_6_EP1_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge352" class="edge">
<title>Layer_4_Expert_6_EP1_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18916.68,-14871.46C18919.47,-14871.11 18922.25,-14870.77 18925,-14870.45 19231.94,-14833.89 19586.39,-14811.42 19823.16,-14799.22"/>
<polygon fill="black" stroke="black" points="19823.49,-14802.71 19833.29,-14798.7 19823.13,-14795.71 19823.49,-14802.71"/>
</g>
<!-- Layer_4_Expert_6_EP1_TP1_PP1 -->
<g id="node227" class="node">
<title>Layer_4_Expert_6_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19311.5,-14938.45 18934.5,-14938.45 18934.5,-14870.45 19311.5,-14870.45 19311.5,-14938.45"/>
<text text-anchor="middle" x="19123" y="-14923.25" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="19123" y="-14908.25" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="19123" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19123" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_6_EP1_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge354" class="edge">
<title>Layer_4_Expert_6_EP1_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19311.7,-14871.6C19314.48,-14871.21 19317.25,-14870.82 19320,-14870.45 19495.2,-14846.35 19693.59,-14825.11 19845.26,-14810.14"/>
<polygon fill="black" stroke="black" points="19846.03,-14813.58 19855.64,-14809.11 19845.34,-14806.61 19846.03,-14813.58"/>
</g>
<!-- Layer_4_Expert_7_EP1_TP0_PP1 -->
<g id="node228" class="node">
<title>Layer_4_Expert_7_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19706.5,-14938.45 19329.5,-14938.45 19329.5,-14870.45 19706.5,-14870.45 19706.5,-14938.45"/>
<text text-anchor="middle" x="19518" y="-14923.25" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="19518" y="-14908.25" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="19518" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19518" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_7_EP1_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge356" class="edge">
<title>Layer_4_Expert_7_EP1_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19681.05,-14870.41C19751.27,-14856.19 19833.73,-14839.48 19906.21,-14824.8"/>
<polygon fill="black" stroke="black" points="19907.26,-14828.16 19916.37,-14822.74 19905.87,-14821.3 19907.26,-14828.16"/>
</g>
<!-- Layer_4_Expert_7_EP1_TP1_PP1 -->
<g id="node229" class="node">
<title>Layer_4_Expert_7_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20101.5,-14938.45 19724.5,-14938.45 19724.5,-14870.45 20101.5,-14870.45 20101.5,-14938.45"/>
<text text-anchor="middle" x="19913" y="-14923.25" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="19913" y="-14908.25" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="19913" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19913" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_7_EP1_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge358" class="edge">
<title>Layer_4_Expert_7_EP1_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19964.01,-14870.18C19979.14,-14860.31 19996.08,-14849.26 20012.53,-14838.53"/>
<polygon fill="black" stroke="black" points="20014.62,-14841.35 20021.08,-14832.96 20010.79,-14835.49 20014.62,-14841.35"/>
</g>
<!-- Layer_4_Expert_8_EP2_TP0_PP1 -->
<g id="node230" class="node">
<title>Layer_4_Expert_8_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20496.5,-14938.45 20119.5,-14938.45 20119.5,-14870.45 20496.5,-14870.45 20496.5,-14938.45"/>
<text text-anchor="middle" x="20308" y="-14923.25" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="20308" y="-14908.25" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="20308" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20308" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_8_EP2_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge360" class="edge">
<title>Layer_4_Expert_8_EP2_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20246.11,-14870.34C20226.71,-14859.96 20204.85,-14848.26 20183.8,-14837"/>
<polygon fill="black" stroke="black" points="20185.3,-14833.84 20174.84,-14832.21 20182,-14840.01 20185.3,-14833.84"/>
</g>
<!-- Layer_4_Expert_8_EP2_TP1_PP1 -->
<g id="node231" class="node">
<title>Layer_4_Expert_8_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20891.5,-14938.45 20514.5,-14938.45 20514.5,-14870.45 20891.5,-14870.45 20891.5,-14938.45"/>
<text text-anchor="middle" x="20703" y="-14923.25" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="20703" y="-14908.25" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="20703" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20703" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_8_EP2_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge362" class="edge">
<title>Layer_4_Expert_8_EP2_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20528.85,-14870.41C20451.85,-14855.81 20361.07,-14838.59 20282.2,-14823.63"/>
<polygon fill="black" stroke="black" points="20282.62,-14820.15 20272.14,-14821.72 20281.31,-14827.02 20282.62,-14820.15"/>
</g>
<!-- Layer_4_Expert_9_EP2_TP0_PP1 -->
<g id="node232" class="node">
<title>Layer_4_Expert_9_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21286.5,-14938.45 20909.5,-14938.45 20909.5,-14870.45 21286.5,-14870.45 21286.5,-14938.45"/>
<text text-anchor="middle" x="21098" y="-14923.25" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="21098" y="-14908.25" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="21098" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21098" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_9_EP2_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge364" class="edge">
<title>Layer_4_Expert_9_EP2_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20909.4,-14871.73C20906.24,-14871.29 20903.11,-14870.86 20900,-14870.45 20712.57,-14845.23 20499.8,-14823.65 20339.52,-14808.81"/>
<polygon fill="black" stroke="black" points="20339.8,-14805.33 20329.52,-14807.89 20339.16,-14812.3 20339.8,-14805.33"/>
</g>
<!-- Layer_4_Expert_9_EP2_TP1_PP1 -->
<g id="node233" class="node">
<title>Layer_4_Expert_9_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21681.5,-14938.45 21304.5,-14938.45 21304.5,-14870.45 21681.5,-14870.45 21681.5,-14938.45"/>
<text text-anchor="middle" x="21493" y="-14923.25" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="21493" y="-14908.25" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="21493" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21493" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_9_EP2_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge366" class="edge">
<title>Layer_4_Expert_9_EP2_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21304.42,-14871.59C21301.26,-14871.19 21298.11,-14870.81 21295,-14870.45 20974.69,-14832.79 20604.27,-14810.38 20359.82,-14798.49"/>
<polygon fill="black" stroke="black" points="20359.88,-14794.99 20349.73,-14798.01 20359.54,-14801.99 20359.88,-14794.99"/>
</g>
<!-- Layer_4_Expert_10_EP2_TP0_PP1 -->
<g id="node234" class="node">
<title>Layer_4_Expert_10_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22076.5,-14938.45 21699.5,-14938.45 21699.5,-14870.45 22076.5,-14870.45 22076.5,-14938.45"/>
<text text-anchor="middle" x="21888" y="-14923.25" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="21888" y="-14908.25" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="21888" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21888" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_10_EP2_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge368" class="edge">
<title>Layer_4_Expert_10_EP2_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21699.42,-14871.51C21696.26,-14871.14 21693.12,-14870.78 21690,-14870.45 21227.14,-14820.01 20685.47,-14800.01 20366.25,-14792.2"/>
<polygon fill="black" stroke="black" points="20366.01,-14788.7 20355.93,-14791.95 20365.84,-14795.69 20366.01,-14788.7"/>
</g>
<!-- Layer_4_Expert_10_EP2_TP1_PP1 -->
<g id="node235" class="node">
<title>Layer_4_Expert_10_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22471.5,-14938.45 22094.5,-14938.45 22094.5,-14870.45 22471.5,-14870.45 22471.5,-14938.45"/>
<text text-anchor="middle" x="22283" y="-14923.25" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="22283" y="-14908.25" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="22283" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22283" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_10_EP2_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge370" class="edge">
<title>Layer_4_Expert_10_EP2_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22094.43,-14871.47C22091.26,-14871.11 22088.12,-14870.77 22085,-14870.45 21474.17,-14807.06 20753.34,-14791.62 20367.62,-14788.12"/>
<polygon fill="black" stroke="black" points="20367.47,-14784.62 20357.44,-14788.03 20367.41,-14791.62 20367.47,-14784.62"/>
</g>
<!-- Layer_4_Expert_11_EP2_TP0_PP1 -->
<g id="node236" class="node">
<title>Layer_4_Expert_11_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22866.5,-14938.45 22489.5,-14938.45 22489.5,-14870.45 22866.5,-14870.45 22866.5,-14938.45"/>
<text text-anchor="middle" x="22678" y="-14923.25" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="22678" y="-14908.25" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="22678" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22678" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_11_EP2_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge372" class="edge">
<title>Layer_4_Expert_11_EP2_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22489.43,-14871.44C22486.27,-14871.09 22483.12,-14870.76 22480,-14870.45 22077.7,-14830.1 20903.81,-14803.04 20365.96,-14792.41"/>
<polygon fill="black" stroke="black" points="20365.79,-14788.91 20355.73,-14792.21 20365.66,-14795.91 20365.79,-14788.91"/>
</g>
<!-- Layer_4_Expert_11_EP2_TP1_PP1 -->
<g id="node237" class="node">
<title>Layer_4_Expert_11_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23261.5,-14938.45 22884.5,-14938.45 22884.5,-14870.45 23261.5,-14870.45 23261.5,-14938.45"/>
<text text-anchor="middle" x="23073" y="-14923.25" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="23073" y="-14908.25" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="23073" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23073" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_11_EP2_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge374" class="edge">
<title>Layer_4_Expert_11_EP2_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22884.43,-14871.42C22881.27,-14871.07 22878.12,-14870.75 22875,-14870.45 22394.66,-14823.47 20970.62,-14799.23 20366.7,-14790.84"/>
<polygon fill="black" stroke="black" points="20366.6,-14787.34 20356.55,-14790.7 20366.5,-14794.34 20366.6,-14787.34"/>
</g>
<!-- Layer_4_Expert_12_EP3_TP0_PP1 -->
<g id="node238" class="node">
<title>Layer_4_Expert_12_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23656.5,-14938.45 23279.5,-14938.45 23279.5,-14870.45 23656.5,-14870.45 23656.5,-14938.45"/>
<text text-anchor="middle" x="23468" y="-14923.25" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="23468" y="-14908.25" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="23468" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23468" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_12_EP3_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge376" class="edge">
<title>Layer_4_Expert_12_EP3_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23279.44,-14871.4C23276.27,-14871.06 23273.12,-14870.74 23270,-14870.45 22711.03,-14816.82 21033.14,-14795.96 20367.49,-14789.65"/>
<polygon fill="black" stroke="black" points="20367.31,-14786.15 20357.28,-14789.55 20367.24,-14793.15 20367.31,-14786.15"/>
</g>
<!-- Layer_4_Expert_12_EP3_TP1_PP1 -->
<g id="node239" class="node">
<title>Layer_4_Expert_12_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24051.5,-14938.45 23674.5,-14938.45 23674.5,-14870.45 24051.5,-14870.45 24051.5,-14938.45"/>
<text text-anchor="middle" x="23863" y="-14923.25" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="23863" y="-14908.25" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="23863" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23863" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_12_EP3_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge378" class="edge">
<title>Layer_4_Expert_12_EP3_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23674.44,-14871.39C23671.27,-14871.06 23668.12,-14870.74 23665,-14870.45 23026.71,-14810.14 21090.92,-14793.06 20367.59,-14788.71"/>
<polygon fill="black" stroke="black" points="20367.58,-14785.21 20357.56,-14788.65 20367.54,-14792.21 20367.58,-14785.21"/>
</g>
<!-- Layer_4_Expert_13_EP3_TP0_PP1 -->
<g id="node240" class="node">
<title>Layer_4_Expert_13_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24446.5,-14938.45 24069.5,-14938.45 24069.5,-14870.45 24446.5,-14870.45 24446.5,-14938.45"/>
<text text-anchor="middle" x="24258" y="-14923.25" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="24258" y="-14908.25" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="24258" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24258" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_13_EP3_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge380" class="edge">
<title>Layer_4_Expert_13_EP3_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24069.44,-14871.38C24066.27,-14871.05 24063.12,-14870.74 24060,-14870.45 23341.98,-14803.45 21145.74,-14790.47 20367.76,-14787.96"/>
<polygon fill="black" stroke="black" points="20367.55,-14784.46 20357.54,-14787.93 20367.53,-14791.46 20367.55,-14784.46"/>
</g>
<!-- Layer_4_Expert_13_EP3_TP1_PP1 -->
<g id="node241" class="node">
<title>Layer_4_Expert_13_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24841.5,-14938.45 24464.5,-14938.45 24464.5,-14870.45 24841.5,-14870.45 24841.5,-14938.45"/>
<text text-anchor="middle" x="24653" y="-14923.25" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="24653" y="-14908.25" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="24653" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24653" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_13_EP3_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge382" class="edge">
<title>Layer_4_Expert_13_EP3_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24464.44,-14871.37C24461.27,-14871.04 24458.12,-14870.73 24455,-14870.45 23656.95,-14796.74 21198.32,-14788.11 20368.12,-14787.34"/>
<polygon fill="black" stroke="black" points="20367.83,-14783.84 20357.83,-14787.33 20367.83,-14790.84 20367.83,-14783.84"/>
</g>
<!-- Layer_4_Expert_14_EP3_TP0_PP1 -->
<g id="node242" class="node">
<title>Layer_4_Expert_14_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25236.5,-14938.45 24859.5,-14938.45 24859.5,-14870.45 25236.5,-14870.45 25236.5,-14938.45"/>
<text text-anchor="middle" x="25048" y="-14923.25" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="25048" y="-14908.25" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="25048" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25048" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_14_EP3_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge384" class="edge">
<title>Layer_4_Expert_14_EP3_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24859.44,-14871.36C24856.27,-14871.04 24853.12,-14870.73 24850,-14870.45 23971.4,-14790 21247.34,-14785.95 20367.84,-14786.82"/>
<polygon fill="black" stroke="black" points="20367.58,-14783.32 20357.58,-14786.83 20367.58,-14790.32 20367.58,-14783.32"/>
</g>
<!-- Layer_4_Expert_14_EP3_TP1_PP1 -->
<g id="node243" class="node">
<title>Layer_4_Expert_14_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25631.5,-14938.45 25254.5,-14938.45 25254.5,-14870.45 25631.5,-14870.45 25631.5,-14938.45"/>
<text text-anchor="middle" x="25443" y="-14923.25" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="25443" y="-14908.25" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="25443" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25443" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_14_EP3_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge386" class="edge">
<title>Layer_4_Expert_14_EP3_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M25254.44,-14871.36C25251.27,-14871.03 25248.12,-14870.73 25245,-14870.45 24759.55,-14826.33 21367.14,-14797.12 20367.54,-14789.41"/>
<polygon fill="black" stroke="black" points="20367.37,-14785.9 20357.34,-14789.33 20367.32,-14792.9 20367.37,-14785.9"/>
</g>
<!-- Layer_4_Expert_15_EP3_TP0_PP1 -->
<g id="node244" class="node">
<title>Layer_4_Expert_15_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="26026.5,-14938.45 25649.5,-14938.45 25649.5,-14870.45 26026.5,-14870.45 26026.5,-14938.45"/>
<text text-anchor="middle" x="25838" y="-14923.25" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="25838" y="-14908.25" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="25838" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25838" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_15_EP3_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge388" class="edge">
<title>Layer_4_Expert_15_EP3_TP0_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M25649.44,-14871.35C25646.27,-14871.03 25643.12,-14870.73 25640,-14870.45 25113.9,-14822.94 21416.92,-14795.85 20367.91,-14789.07"/>
<polygon fill="black" stroke="black" points="20367.61,-14785.56 20357.59,-14789 20367.56,-14792.56 20367.61,-14785.56"/>
</g>
<!-- Layer_4_Expert_15_EP3_TP1_PP1 -->
<g id="node245" class="node">
<title>Layer_4_Expert_15_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="26421.5,-14938.45 26044.5,-14938.45 26044.5,-14870.45 26421.5,-14870.45 26421.5,-14938.45"/>
<text text-anchor="middle" x="26233" y="-14923.25" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="26233" y="-14908.25" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="26233" y="-14893.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="26233" y="-14878.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_Expert_15_EP3_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1 -->
<g id="edge390" class="edge">
<title>Layer_4_Expert_15_EP3_TP1_PP1&#45;&gt;Layer_4_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M26044.44,-14871.35C26041.27,-14871.03 26038.12,-14870.73 26035,-14870.45 25468.08,-14819.53 21464.08,-14794.67 20367.87,-14788.77"/>
<polygon fill="black" stroke="black" points="20367.51,-14785.27 20357.49,-14788.71 20367.47,-14792.27 20367.51,-14785.27"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_0_EP0_TP0_PP1 -->
<g id="edge327" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_0_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M20041.45,-15020.31C18945.99,-15014.97 14818.95,-14991.57 14187.03,-14938.55"/>
<polygon fill="black" stroke="black" points="14186.92,-14935.03 14176.66,-14937.65 14186.32,-14942 14186.92,-14935.03"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_0_EP0_TP1_PP1 -->
<g id="edge329" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_0_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M20041.4,-15020.04C18991.52,-15013.85 15171.45,-14988.18 14581.75,-14938.53"/>
<polygon fill="black" stroke="black" points="14581.92,-14935.03 14571.66,-14937.65 14581.31,-14942 14581.92,-14935.03"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_1_EP0_TP0_PP1 -->
<g id="edge331" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_1_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M20041.53,-15019.73C19039.29,-15012.65 15525.53,-14984.82 14976.81,-14938.53"/>
<polygon fill="black" stroke="black" points="14976.92,-14935.03 14966.66,-14937.64 14976.31,-14942 14976.92,-14935.03"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_1_EP0_TP1_PP1 -->
<g id="edge333" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_1_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M20041.77,-15019.37C19089.01,-15011.35 15879.17,-14981.46 15371.75,-14938.53"/>
<polygon fill="black" stroke="black" points="15371.93,-14935.03 15361.66,-14937.64 15371.31,-14942 15371.93,-14935.03"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_2_EP0_TP0_PP1 -->
<g id="edge335" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_2_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M20041.43,-15021.82C19202.69,-15021.95 16623.17,-15015.91 15766.65,-14938.55"/>
<polygon fill="black" stroke="black" points="15766.93,-14935.06 15756.66,-14937.63 15766.3,-14942.03 15766.93,-14935.06"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_2_EP0_TP1_PP1 -->
<g id="edge337" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_2_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M20041.51,-15021.28C19252.88,-15019.73 16937.98,-15009.19 16161.85,-14938.56"/>
<polygon fill="black" stroke="black" points="16161.94,-14935.06 16151.66,-14937.63 16161.29,-14942.03 16161.94,-14935.06"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_3_EP0_TP0_PP1 -->
<g id="edge339" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_3_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M20041.52,-15020.61C19305.31,-15017.3 17252.61,-15002.49 16556.8,-14938.56"/>
<polygon fill="black" stroke="black" points="16556.94,-14935.06 16546.66,-14937.62 16556.29,-14942.03 16556.94,-14935.06"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_3_EP0_TP1_PP1 -->
<g id="edge341" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_3_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M20041.55,-15019.8C19360.69,-15014.6 17568.03,-14995.83 16951.98,-14938.58"/>
<polygon fill="black" stroke="black" points="16951.94,-14935.06 16941.66,-14937.61 16951.29,-14942.03 16951.94,-14935.06"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_4_EP1_TP0_PP1 -->
<g id="edge343" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_4_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M20042.1,-15018.77C19420.17,-15011.58 17883.35,-14989.2 17346.82,-14938.57"/>
<polygon fill="black" stroke="black" points="17346.95,-14935.06 17336.66,-14937.59 17346.28,-14942.03 17346.95,-14935.06"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_4_EP1_TP1_PP1 -->
<g id="edge345" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_4_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M20042.88,-15017.45C19483.94,-15008.11 18199.2,-14982.61 17741.65,-14938.56"/>
<polygon fill="black" stroke="black" points="17741.96,-14935.07 17731.66,-14937.58 17741.27,-14942.04 17741.96,-14935.07"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_5_EP1_TP0_PP1 -->
<g id="edge347" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_5_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M20041.29,-15022.27C19632.7,-15020.96 18827.38,-15008.69 18136.82,-14938.59"/>
<polygon fill="black" stroke="black" points="18136.97,-14935.09 18126.66,-14937.55 18136.26,-14942.05 18136.97,-14935.09"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_5_EP1_TP1_PP1 -->
<g id="edge349" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_5_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M20041.79,-15018.98C19695.58,-15013.41 19072.13,-14995.71 18531.62,-14938.58"/>
<polygon fill="black" stroke="black" points="18531.98,-14935.1 18521.67,-14937.52 18531.24,-14942.06 18531.98,-14935.1"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_6_EP1_TP0_PP1 -->
<g id="edge351" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_6_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M20045.37,-15014.03C19769.03,-15004.23 19321.41,-14982.92 18926.86,-14938.62"/>
<polygon fill="black" stroke="black" points="18927,-14935.11 18916.67,-14937.47 18926.22,-14942.07 18927,-14935.11"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_6_EP1_TP1_PP1 -->
<g id="edge353" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_6_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M20057.17,-15006.14C19859.75,-14992.68 19577.55,-14970.44 19321.92,-14938.66"/>
<polygon fill="black" stroke="black" points="19322.04,-14935.14 19311.69,-14937.38 19321.17,-14942.09 19322.04,-14935.14"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_7_EP1_TP0_PP1 -->
<g id="edge355" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_7_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M20096.13,-14993.24C19985.8,-14978.17 19848.43,-14958.87 19716.98,-14938.74"/>
<polygon fill="black" stroke="black" points="19717.13,-14935.22 19706.71,-14937.16 19716.07,-14942.14 19717.13,-14935.22"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_7_EP1_TP1_PP1 -->
<g id="edge357" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_7_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M20170.96,-14981.25C20126.73,-14968.26 20078.02,-14953.94 20034.96,-14941.29"/>
<polygon fill="black" stroke="black" points="20035.87,-14937.91 20025.29,-14938.45 20033.9,-14944.62 20035.87,-14937.91"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_8_EP2_TP0_PP1 -->
<g id="edge359" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_8_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M20308,-14974.31C20308,-14965.93 20308,-14957.23 20308,-14948.95"/>
<polygon fill="black" stroke="black" points="20311.5,-14948.75 20308,-14938.75 20304.5,-14948.75 20311.5,-14948.75"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_8_EP2_TP1_PP1 -->
<g id="edge361" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_8_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M20445.04,-14981.25C20489.27,-14968.26 20537.98,-14953.94 20581.04,-14941.29"/>
<polygon fill="black" stroke="black" points="20582.1,-14944.62 20590.71,-14938.45 20580.13,-14937.91 20582.1,-14944.62"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_9_EP2_TP0_PP1 -->
<g id="edge363" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_9_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M20519.51,-14993.19C20629.76,-14978.08 20767.06,-14958.76 20899.45,-14938.52"/>
<polygon fill="black" stroke="black" points="20900.02,-14941.97 20909.37,-14937 20898.96,-14935.05 20900.02,-14941.97"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_9_EP2_TP1_PP1 -->
<g id="edge365" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_9_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M20558.57,-15006.07C20755.78,-14992.57 21037.7,-14970.31 21294.14,-14938.52"/>
<polygon fill="black" stroke="black" points="21294.92,-14941.95 21304.41,-14937.24 21294.05,-14935 21294.92,-14941.95"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_10_EP2_TP0_PP1 -->
<g id="edge367" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_10_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M20570.43,-15013.96C20846.57,-15004.1 21293.86,-14982.73 21689.21,-14938.49"/>
<polygon fill="black" stroke="black" points="21689.87,-14941.94 21699.42,-14937.34 21689.09,-14934.98 21689.87,-14941.94"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_10_EP2_TP1_PP1 -->
<g id="edge369" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_10_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M20574.06,-15018.9C20920.06,-15013.25 21543.15,-14995.47 22084.46,-14938.45"/>
<polygon fill="black" stroke="black" points="22084.85,-14941.93 22094.43,-14937.4 22084.11,-14934.97 22084.85,-14941.93"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_11_EP2_TP0_PP1 -->
<g id="edge371" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_11_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M20574.58,-15022.2C20982.97,-15020.79 21787.91,-15008.38 22479.26,-14938.47"/>
<polygon fill="black" stroke="black" points="22479.84,-14941.93 22489.43,-14937.44 22479.13,-14934.97 22479.84,-14941.93"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_11_EP2_TP1_PP1 -->
<g id="edge373" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_11_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M20573.28,-15017.41C21132.14,-15008.02 22416.04,-14982.41 22874.42,-14938.44"/>
<polygon fill="black" stroke="black" points="22874.82,-14941.92 22884.43,-14937.46 22874.14,-14934.95 22874.82,-14941.92"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_12_EP3_TP0_PP1 -->
<g id="edge375" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_12_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M20573.8,-15018.74C21195.52,-15011.48 22731.81,-14988.98 23269.26,-14938.45"/>
<polygon fill="black" stroke="black" points="23269.81,-14941.92 23279.44,-14937.48 23269.15,-14934.95 23269.81,-14941.92"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_12_EP3_TP1_PP1 -->
<g id="edge377" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_12_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M20574.37,-15019.77C21255.02,-15014.5 23047.13,-14995.57 23664.1,-14938.47"/>
<polygon fill="black" stroke="black" points="23664.81,-14941.92 23674.44,-14937.5 23664.15,-14934.95 23664.81,-14941.92"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_13_EP3_TP0_PP1 -->
<g id="edge379" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_13_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M20574.41,-15020.58C21310.41,-15017.19 23362.55,-15002.2 24059.28,-14938.45"/>
<polygon fill="black" stroke="black" points="24059.8,-14941.92 24069.44,-14937.51 24059.16,-14934.94 24059.8,-14941.92"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_13_EP3_TP1_PP1 -->
<g id="edge381" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_13_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M20574.78,-15021.25C21363.54,-15019.61 23677.3,-15008.85 24454.24,-14938.45"/>
<polygon fill="black" stroke="black" points="24454.8,-14941.91 24464.44,-14937.52 24454.16,-14934.94 24454.8,-14941.91"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_14_EP3_TP0_PP1 -->
<g id="edge383" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_14_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M20574.88,-15021.79C21413.81,-15021.82 23992.12,-15015.54 24849.43,-14938.43"/>
<polygon fill="black" stroke="black" points="24849.8,-14941.92 24859.44,-14937.52 24849.16,-14934.94 24849.8,-14941.92"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_14_EP3_TP1_PP1 -->
<g id="edge385" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_14_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M20574.18,-15019.36C21526.74,-15011.29 24735.92,-14981.27 25244.33,-14938.42"/>
<polygon fill="black" stroke="black" points="25244.78,-14941.89 25254.44,-14937.53 25244.17,-14934.92 25244.78,-14941.89"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_15_EP3_TP0_PP1 -->
<g id="edge387" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_15_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M20574.42,-15019.72C21576.47,-15012.59 25089.55,-14984.6 25639.27,-14938.42"/>
<polygon fill="black" stroke="black" points="25639.78,-14941.89 25649.44,-14937.54 25639.17,-14934.92 25639.78,-14941.89"/>
</g>
<!-- Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_15_EP3_TP1_PP1 -->
<g id="edge389" class="edge">
<title>Layer_4_A2A_Dispatch_PP1&#45;&gt;Layer_4_Expert_15_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M20574.55,-15020.03C21624.25,-15013.79 25443.63,-14987.95 26034.33,-14938.42"/>
<polygon fill="black" stroke="black" points="26034.78,-14941.89 26044.44,-14937.54 26034.18,-14934.92 26034.78,-14941.89"/>
</g>
<!-- Layer_4_MLP_Out_TP0_PP1 -->
<g id="node248" class="node">
<title>Layer_4_MLP_Out_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="20206.5,-14702.28 19829.5,-14702.28 19829.5,-14634.28 20206.5,-14634.28 20206.5,-14702.28"/>
<text text-anchor="middle" x="20018" y="-14687.08" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="20018" y="-14672.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="20018" y="-14657.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20018" y="-14642.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_A2A_Combine_PP1&#45;&gt;Layer_4_MLP_Out_TP0_PP1 -->
<g id="edge391" class="edge">
<title>Layer_4_A2A_Combine_PP1&#45;&gt;Layer_4_MLP_Out_TP0_PP1</title>
<path fill="none" stroke="black" d="M20061.52,-14738.48C20055.82,-14729.42 20049.89,-14719.98 20044.3,-14711.1"/>
<polygon fill="black" stroke="black" points="20047.13,-14709.03 20038.85,-14702.43 20041.21,-14712.76 20047.13,-14709.03"/>
</g>
<!-- Layer_4_MLP_Out_TP1_PP1 -->
<g id="node249" class="node">
<title>Layer_4_MLP_Out_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="20601.5,-14702.28 20224.5,-14702.28 20224.5,-14634.28 20601.5,-14634.28 20601.5,-14702.28"/>
<text text-anchor="middle" x="20413" y="-14687.08" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="20413" y="-14672.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="20413" y="-14657.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20413" y="-14642.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_4_A2A_Combine_PP1&#45;&gt;Layer_4_MLP_Out_TP1_PP1 -->
<g id="edge393" class="edge">
<title>Layer_4_A2A_Combine_PP1&#45;&gt;Layer_4_MLP_Out_TP1_PP1</title>
<path fill="none" stroke="black" d="M20208.16,-14743.12C20242.12,-14730.88 20278.9,-14717.62 20311.79,-14705.76"/>
<polygon fill="black" stroke="black" points="20313.19,-14708.98 20321.42,-14702.3 20310.82,-14702.39 20313.19,-14708.98"/>
</g>
<!-- Layer_4_MLP_AllReduce_PP1 -->
<g id="node250" class="node">
<title>Layer_4_MLP_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="20063" cy="-14550.2" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="20063" y="-14569" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="20063" y="-14554" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="20063" y="-14539" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20063" y="-14524" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_4_MLP_Out_TP0_PP1&#45;&gt;Layer_4_MLP_AllReduce_PP1 -->
<g id="edge392" class="edge">
<title>Layer_4_MLP_Out_TP0_PP1&#45;&gt;Layer_4_MLP_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M20030.9,-14634.01C20034.09,-14625.76 20037.61,-14616.68 20041.11,-14607.66"/>
<polygon fill="black" stroke="black" points="20044.39,-14608.89 20044.74,-14598.3 20037.86,-14606.36 20044.39,-14608.89"/>
</g>
<!-- Layer_4_MLP_Out_TP1_PP1&#45;&gt;Layer_4_MLP_AllReduce_PP1 -->
<g id="edge394" class="edge">
<title>Layer_4_MLP_Out_TP1_PP1&#45;&gt;Layer_4_MLP_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M20313.17,-14634.17C20277.32,-14622.28 20236.26,-14608.66 20197.92,-14595.94"/>
<polygon fill="black" stroke="black" points="20198.83,-14592.56 20188.23,-14592.73 20196.62,-14599.2 20198.83,-14592.56"/>
</g>
<!-- Layer_4_LayerNorm_PP1 -->
<g id="node251" class="node">
<title>Layer_4_LayerNorm_PP1</title>
<polygon fill="lightgreen" stroke="black" points="20251.5,-14466.11 19874.5,-14466.11 19874.5,-14398.11 20251.5,-14398.11 20251.5,-14466.11"/>
<text text-anchor="middle" x="20063" y="-14450.91" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20063" y="-14435.91" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="20063" y="-14420.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20063" y="-14405.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_4_MLP_AllReduce_PP1&#45;&gt;Layer_4_LayerNorm_PP1 -->
<g id="edge395" class="edge">
<title>Layer_4_MLP_AllReduce_PP1&#45;&gt;Layer_4_LayerNorm_PP1</title>
<path fill="none" stroke="black" d="M20063,-14501.98C20063,-14493.59 20063,-14484.9 20063,-14476.62"/>
<polygon fill="black" stroke="black" points="20066.5,-14476.42 20063,-14466.42 20059.5,-14476.42 20066.5,-14476.42"/>
</g>
<!-- Layer_5_QKV_TP0_PP1 -->
<g id="node252" class="node">
<title>Layer_5_QKV_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="20253.5,-14362.11 19872.5,-14362.11 19872.5,-14294.11 20253.5,-14294.11 20253.5,-14362.11"/>
<text text-anchor="middle" x="20063" y="-14346.91" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="20063" y="-14331.91" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="20063" y="-14316.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20063" y="-14301.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_4_LayerNorm_PP1&#45;&gt;Layer_5_QKV_TP0_PP1 -->
<g id="edge396" class="edge">
<title>Layer_4_LayerNorm_PP1&#45;&gt;Layer_5_QKV_TP0_PP1</title>
<path fill="none" stroke="black" d="M20063,-14398C20063,-14389.89 20063,-14381.09 20063,-14372.58"/>
<polygon fill="black" stroke="black" points="20066.5,-14372.41 20063,-14362.41 20059.5,-14372.41 20066.5,-14372.41"/>
</g>
<!-- Layer_5_QKV_AllReduce_PP1 -->
<g id="node254" class="node">
<title>Layer_5_QKV_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19769" cy="-14210.03" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="19769" y="-14228.83" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="19769" y="-14213.83" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19769" y="-14198.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19769" y="-14183.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_5_QKV_TP0_PP1&#45;&gt;Layer_5_QKV_AllReduce_PP1 -->
<g id="edge397" class="edge">
<title>Layer_5_QKV_TP0_PP1&#45;&gt;Layer_5_QKV_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19979.14,-14294C19950.69,-14282.77 19918.34,-14269.99 19887.69,-14257.89"/>
<polygon fill="black" stroke="black" points="19888.83,-14254.58 19878.24,-14254.16 19886.26,-14261.09 19888.83,-14254.58"/>
</g>
<!-- Layer_5_QKV_TP1_PP1 -->
<g id="node253" class="node">
<title>Layer_5_QKV_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="19854.5,-14362.11 19473.5,-14362.11 19473.5,-14294.11 19854.5,-14294.11 19854.5,-14362.11"/>
<text text-anchor="middle" x="19664" y="-14346.91" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19664" y="-14331.91" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19664" y="-14316.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19664" y="-14301.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_5_QKV_TP1_PP1&#45;&gt;Layer_5_QKV_AllReduce_PP1 -->
<g id="edge401" class="edge">
<title>Layer_5_QKV_TP1_PP1&#45;&gt;Layer_5_QKV_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19694.09,-14293.85C19702.2,-14284.88 19711.19,-14274.94 19720.05,-14265.15"/>
<polygon fill="black" stroke="black" points="19722.67,-14267.47 19726.78,-14257.71 19717.48,-14262.77 19722.67,-14267.47"/>
</g>
<!-- Layer_5_Attention_TP0_PP1 -->
<g id="node255" class="node">
<title>Layer_5_Attention_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19649.5,-14125.95 19268.5,-14125.95 19268.5,-14057.95 19649.5,-14057.95 19649.5,-14125.95"/>
<text text-anchor="middle" x="19459" y="-14110.75" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="19459" y="-14095.75" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19459" y="-14080.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19459" y="-14065.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_5_QKV_AllReduce_PP1&#45;&gt;Layer_5_Attention_TP0_PP1 -->
<g id="edge398" class="edge">
<title>Layer_5_QKV_AllReduce_PP1&#45;&gt;Layer_5_Attention_TP0_PP1</title>
<path fill="none" stroke="black" d="M19654.45,-14166.13C19622.41,-14154.13 19587.88,-14141.21 19556.9,-14129.61"/>
<polygon fill="black" stroke="black" points="19558,-14126.28 19547.4,-14126.05 19555.54,-14132.83 19558,-14126.28"/>
</g>
<!-- Layer_5_Attention_TP1_PP1 -->
<g id="node256" class="node">
<title>Layer_5_Attention_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="20048.5,-14125.95 19667.5,-14125.95 19667.5,-14057.95 20048.5,-14057.95 20048.5,-14125.95"/>
<text text-anchor="middle" x="19858" y="-14110.75" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="19858" y="-14095.75" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19858" y="-14080.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19858" y="-14065.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_5_QKV_AllReduce_PP1&#45;&gt;Layer_5_Attention_TP1_PP1 -->
<g id="edge402" class="edge">
<title>Layer_5_QKV_AllReduce_PP1&#45;&gt;Layer_5_Attention_TP1_PP1</title>
<path fill="none" stroke="black" d="M19804.94,-14162.15C19812.03,-14152.9 19819.43,-14143.26 19826.36,-14134.21"/>
<polygon fill="black" stroke="black" points="19829.28,-14136.16 19832.59,-14126.09 19823.72,-14131.9 19829.28,-14136.16"/>
</g>
<!-- Layer_5_AttnOut_TP0_PP1 -->
<g id="node257" class="node">
<title>Layer_5_AttnOut_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19648.5,-14021.95 19271.5,-14021.95 19271.5,-13953.95 19648.5,-13953.95 19648.5,-14021.95"/>
<text text-anchor="middle" x="19460" y="-14006.75" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="19460" y="-13991.75" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19460" y="-13976.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19460" y="-13961.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Attention_TP0_PP1&#45;&gt;Layer_5_AttnOut_TP0_PP1 -->
<g id="edge399" class="edge">
<title>Layer_5_Attention_TP0_PP1&#45;&gt;Layer_5_AttnOut_TP0_PP1</title>
<path fill="none" stroke="black" d="M19459.32,-14057.83C19459.4,-14049.72 19459.49,-14040.93 19459.57,-14032.42"/>
<polygon fill="black" stroke="black" points="19463.08,-14032.28 19459.67,-14022.24 19456.08,-14032.21 19463.08,-14032.28"/>
</g>
<!-- Layer_5_AttnOut_TP1_PP1 -->
<g id="node258" class="node">
<title>Layer_5_AttnOut_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="20045.5,-14021.95 19668.5,-14021.95 19668.5,-13953.95 20045.5,-13953.95 20045.5,-14021.95"/>
<text text-anchor="middle" x="19857" y="-14006.75" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="19857" y="-13991.75" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19857" y="-13976.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19857" y="-13961.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Attention_TP1_PP1&#45;&gt;Layer_5_AttnOut_TP1_PP1 -->
<g id="edge403" class="edge">
<title>Layer_5_Attention_TP1_PP1&#45;&gt;Layer_5_AttnOut_TP1_PP1</title>
<path fill="none" stroke="black" d="M19857.68,-14057.83C19857.6,-14049.72 19857.51,-14040.93 19857.43,-14032.42"/>
<polygon fill="black" stroke="black" points="19860.92,-14032.21 19857.33,-14022.24 19853.92,-14032.28 19860.92,-14032.21"/>
</g>
<!-- Layer_5_AttnOut_AllReduce_PP1 -->
<g id="node259" class="node">
<title>Layer_5_AttnOut_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19711" cy="-13869.86" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19711" y="-13888.66" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="19711" y="-13873.66" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19711" y="-13858.66" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19711" y="-13843.66" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_5_AttnOut_TP0_PP1&#45;&gt;Layer_5_AttnOut_AllReduce_PP1 -->
<g id="edge400" class="edge">
<title>Layer_5_AttnOut_TP0_PP1&#45;&gt;Layer_5_AttnOut_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19531.59,-13953.84C19554.95,-13943.03 19581.38,-13930.81 19606.64,-13919.13"/>
<polygon fill="black" stroke="black" points="19608.28,-13922.23 19615.89,-13914.85 19605.34,-13915.87 19608.28,-13922.23"/>
</g>
<!-- Layer_5_AttnOut_TP1_PP1&#45;&gt;Layer_5_AttnOut_AllReduce_PP1 -->
<g id="edge404" class="edge">
<title>Layer_5_AttnOut_TP1_PP1&#45;&gt;Layer_5_AttnOut_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19815.16,-13953.68C19803.23,-13944.19 19789.93,-13933.62 19776.93,-13923.28"/>
<polygon fill="black" stroke="black" points="19778.9,-13920.38 19768.89,-13916.89 19774.54,-13925.86 19778.9,-13920.38"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1 -->
<g id="node296" class="node">
<title>Layer_5_A2A_Dispatch_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19711" cy="-13737.7" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19711" y="-13756.5" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="19711" y="-13741.5" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19711" y="-13726.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19711" y="-13711.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_5_AttnOut_AllReduce_PP1&#45;&gt;Layer_5_A2A_Dispatch_PP1 -->
<g id="edge405" class="edge">
<title>Layer_5_AttnOut_AllReduce_PP1&#45;&gt;Layer_5_A2A_Dispatch_PP1</title>
<path fill="none" stroke="black" d="M19711,-13821.5C19711,-13813.23 19711,-13804.55 19711,-13796.05"/>
<polygon fill="black" stroke="black" points="19714.5,-13795.8 19711,-13785.8 19707.5,-13795.8 19714.5,-13795.8"/>
</g>
<!-- Layer_5_Gate_EP0_PP1 -->
<g id="node260" class="node">
<title>Layer_5_Gate_EP0_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="22516.4,-15714.94 21912.86,-15714.94 21757.6,-15578.94 22361.14,-15578.94 22516.4,-15714.94"/>
<text text-anchor="middle" x="22137" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="22137" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="22137" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22137" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_5_Gate_EP1_PP1 -->
<g id="node261" class="node">
<title>Layer_5_Gate_EP1_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="21739.4,-15714.94 21135.86,-15714.94 20980.6,-15578.94 21584.14,-15578.94 21739.4,-15714.94"/>
<text text-anchor="middle" x="21360" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="21360" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="21360" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21360" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_5_Gate_EP2_PP1 -->
<g id="node262" class="node">
<title>Layer_5_Gate_EP2_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="20962.4,-15714.94 20358.86,-15714.94 20203.6,-15578.94 20807.14,-15578.94 20962.4,-15714.94"/>
<text text-anchor="middle" x="20583" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="20583" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="20583" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20583" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_5_Gate_EP3_PP1 -->
<g id="node263" class="node">
<title>Layer_5_Gate_EP3_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="20185.4,-15714.94 19581.86,-15714.94 19426.6,-15578.94 20030.14,-15578.94 20185.4,-15714.94"/>
<text text-anchor="middle" x="19806" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="19806" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="19806" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19806" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_5_Expert_0_EP0_TP0_PP1 -->
<g id="node264" class="node">
<title>Layer_5_Expert_0_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="13624.5,-13653.61 13247.5,-13653.61 13247.5,-13585.61 13624.5,-13585.61 13624.5,-13653.61"/>
<text text-anchor="middle" x="13436" y="-13638.41" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13436" y="-13623.41" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="13436" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13436" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_A2A_Combine_PP1 -->
<g id="node297" class="node">
<title>Layer_5_A2A_Combine_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19505" cy="-13501.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19505" y="-13520.33" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="19505" y="-13505.33" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19505" y="-13490.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19505" y="-13475.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_5_Expert_0_EP0_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge407" class="edge">
<title>Layer_5_Expert_0_EP0_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M13624.66,-13586.41C13627.45,-13586.13 13630.24,-13585.86 13633,-13585.61 14192.47,-13535.09 18140.73,-13509.98 19228.26,-13503.97"/>
<polygon fill="black" stroke="black" points="19228.58,-13507.47 19238.56,-13503.92 19228.54,-13500.47 19228.58,-13507.47"/>
</g>
<!-- Layer_5_Expert_0_EP0_TP1_PP1 -->
<g id="node265" class="node">
<title>Layer_5_Expert_0_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14019.5,-13653.61 13642.5,-13653.61 13642.5,-13585.61 14019.5,-13585.61 14019.5,-13653.61"/>
<text text-anchor="middle" x="13831" y="-13638.41" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13831" y="-13623.41" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="13831" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13831" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_0_EP0_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge409" class="edge">
<title>Layer_5_Expert_0_EP0_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14019.66,-13586.41C14022.45,-13586.13 14025.24,-13585.86 14028,-13585.61 14546.73,-13538.5 18189.03,-13511.18 19228.59,-13504.27"/>
<polygon fill="black" stroke="black" points="19228.84,-13507.77 19238.82,-13504.21 19228.79,-13500.77 19228.84,-13507.77"/>
</g>
<!-- Layer_5_Expert_1_EP0_TP0_PP1 -->
<g id="node266" class="node">
<title>Layer_5_Expert_1_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14414.5,-13653.61 14037.5,-13653.61 14037.5,-13585.61 14414.5,-13585.61 14414.5,-13653.61"/>
<text text-anchor="middle" x="14226" y="-13638.41" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14226" y="-13623.41" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="14226" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14226" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_1_EP0_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge411" class="edge">
<title>Layer_5_Expert_1_EP0_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14414.66,-13586.42C14417.45,-13586.13 14420.24,-13585.87 14423,-13585.61 14901.03,-13541.91 18238.08,-13512.48 19228.5,-13504.63"/>
<polygon fill="black" stroke="black" points="19228.64,-13508.13 19238.61,-13504.55 19228.58,-13501.13 19228.64,-13508.13"/>
</g>
<!-- Layer_5_Expert_1_EP0_TP1_PP1 -->
<g id="node267" class="node">
<title>Layer_5_Expert_1_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14809.5,-13653.61 14432.5,-13653.61 14432.5,-13585.61 14809.5,-13585.61 14809.5,-13653.61"/>
<text text-anchor="middle" x="14621" y="-13638.41" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14621" y="-13623.41" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="14621" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14621" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_1_EP0_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge413" class="edge">
<title>Layer_5_Expert_1_EP0_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14809.66,-13586.42C14812.46,-13586.14 14815.24,-13585.87 14818,-13585.61 15681.88,-13506.04 18357.54,-13501.38 19228.16,-13502.05"/>
<polygon fill="black" stroke="black" points="19228.32,-13505.55 19238.32,-13502.06 19228.32,-13498.55 19228.32,-13505.55"/>
</g>
<!-- Layer_5_Expert_2_EP0_TP0_PP1 -->
<g id="node268" class="node">
<title>Layer_5_Expert_2_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15204.5,-13653.61 14827.5,-13653.61 14827.5,-13585.61 15204.5,-13585.61 15204.5,-13653.61"/>
<text text-anchor="middle" x="15016" y="-13638.41" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15016" y="-13623.41" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="15016" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15016" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_2_EP0_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge415" class="edge">
<title>Layer_5_Expert_2_EP0_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15204.66,-13586.43C15207.46,-13586.14 15210.24,-13585.87 15213,-13585.61 15996.46,-13512.81 18407.4,-13503.58 19228.11,-13502.58"/>
<polygon fill="black" stroke="black" points="19228.29,-13506.08 19238.28,-13502.57 19228.28,-13499.08 19228.29,-13506.08"/>
</g>
<!-- Layer_5_Expert_2_EP0_TP1_PP1 -->
<g id="node269" class="node">
<title>Layer_5_Expert_2_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15599.5,-13653.61 15222.5,-13653.61 15222.5,-13585.61 15599.5,-13585.61 15599.5,-13653.61"/>
<text text-anchor="middle" x="15411" y="-13638.41" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15411" y="-13623.41" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="15411" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15411" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_2_EP0_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge417" class="edge">
<title>Layer_5_Expert_2_EP0_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15599.66,-13586.44C15602.46,-13586.15 15605.24,-13585.87 15608,-13585.61 16311.49,-13519.54 18460.42,-13505.98 19228.47,-13503.22"/>
<polygon fill="black" stroke="black" points="19228.57,-13506.72 19238.56,-13503.19 19228.55,-13499.72 19228.57,-13506.72"/>
</g>
<!-- Layer_5_Expert_3_EP0_TP0_PP1 -->
<g id="node270" class="node">
<title>Layer_5_Expert_3_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15994.5,-13653.61 15617.5,-13653.61 15617.5,-13585.61 15994.5,-13585.61 15994.5,-13653.61"/>
<text text-anchor="middle" x="15806" y="-13638.41" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="15806" y="-13623.41" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="15806" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15806" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_3_EP0_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge419" class="edge">
<title>Layer_5_Expert_3_EP0_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15994.66,-13586.45C15997.46,-13586.15 16000.24,-13585.88 16003,-13585.61 16626.82,-13526.27 18515.62,-13508.63 19228.57,-13504.01"/>
<polygon fill="black" stroke="black" points="19228.75,-13507.5 19238.72,-13503.94 19228.7,-13500.5 19228.75,-13507.5"/>
</g>
<!-- Layer_5_Expert_3_EP0_TP1_PP1 -->
<g id="node271" class="node">
<title>Layer_5_Expert_3_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16389.5,-13653.61 16012.5,-13653.61 16012.5,-13585.61 16389.5,-13585.61 16389.5,-13653.61"/>
<text text-anchor="middle" x="16201" y="-13638.41" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="16201" y="-13623.41" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="16201" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16201" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_3_EP0_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge421" class="edge">
<title>Layer_5_Expert_3_EP0_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16389.66,-13586.46C16392.46,-13586.16 16395.24,-13585.88 16398,-13585.61 16942.62,-13532.97 18574.17,-13511.59 19228.78,-13504.98"/>
<polygon fill="black" stroke="black" points="19228.86,-13508.48 19238.82,-13504.88 19228.79,-13501.48 19228.86,-13508.48"/>
</g>
<!-- Layer_5_Expert_4_EP1_TP0_PP1 -->
<g id="node272" class="node">
<title>Layer_5_Expert_4_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16784.5,-13653.61 16407.5,-13653.61 16407.5,-13585.61 16784.5,-13585.61 16784.5,-13653.61"/>
<text text-anchor="middle" x="16596" y="-13638.41" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="16596" y="-13623.41" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="16596" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16596" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_4_EP1_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge423" class="edge">
<title>Layer_5_Expert_4_EP1_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16784.66,-13586.47C16787.46,-13586.17 16790.24,-13585.88 16793,-13585.61 17258.96,-13539.66 18636.66,-13514.98 19229.08,-13506.24"/>
<polygon fill="black" stroke="black" points="19229.53,-13509.73 19239.48,-13506.08 19229.43,-13502.73 19229.53,-13509.73"/>
</g>
<!-- Layer_5_Expert_4_EP1_TP1_PP1 -->
<g id="node273" class="node">
<title>Layer_5_Expert_4_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17179.5,-13653.61 16802.5,-13653.61 16802.5,-13585.61 17179.5,-13585.61 17179.5,-13653.61"/>
<text text-anchor="middle" x="16991" y="-13638.41" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="16991" y="-13623.41" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="16991" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16991" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_4_EP1_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge425" class="edge">
<title>Layer_5_Expert_4_EP1_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17179.66,-13586.49C17182.46,-13586.19 17185.24,-13585.89 17188,-13585.61 17576.13,-13546.31 18704.89,-13518.89 19230.16,-13507.89"/>
<polygon fill="black" stroke="black" points="19230.61,-13511.39 19240.54,-13507.68 19230.47,-13504.39 19230.61,-13511.39"/>
</g>
<!-- Layer_5_Expert_5_EP1_TP0_PP1 -->
<g id="node274" class="node">
<title>Layer_5_Expert_5_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17574.5,-13653.61 17197.5,-13653.61 17197.5,-13585.61 17574.5,-13585.61 17574.5,-13653.61"/>
<text text-anchor="middle" x="17386" y="-13638.41" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="17386" y="-13623.41" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="17386" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17386" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_5_EP1_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge427" class="edge">
<title>Layer_5_Expert_5_EP1_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17574.67,-13586.52C17577.46,-13586.21 17580.24,-13585.9 17583,-13585.61 18166.45,-13524.37 18854.08,-13508.05 19228.26,-13503.85"/>
<polygon fill="black" stroke="black" points="19228.45,-13507.34 19238.41,-13503.73 19228.37,-13500.34 19228.45,-13507.34"/>
</g>
<!-- Layer_5_Expert_5_EP1_TP1_PP1 -->
<g id="node275" class="node">
<title>Layer_5_Expert_5_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17969.5,-13653.61 17592.5,-13653.61 17592.5,-13585.61 17969.5,-13585.61 17969.5,-13653.61"/>
<text text-anchor="middle" x="17781" y="-13638.41" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="17781" y="-13623.41" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="17781" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17781" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_5_EP1_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge429" class="edge">
<title>Layer_5_Expert_5_EP1_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17969.67,-13586.57C17972.47,-13586.24 17975.24,-13585.92 17978,-13585.61 18414.39,-13537.34 18924.19,-13516.77 19230.45,-13508.25"/>
<polygon fill="black" stroke="black" points="19230.91,-13511.73 19240.81,-13507.96 19230.71,-13504.74 19230.91,-13511.73"/>
</g>
<!-- Layer_5_Expert_6_EP1_TP0_PP1 -->
<g id="node276" class="node">
<title>Layer_5_Expert_6_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18364.5,-13653.61 17987.5,-13653.61 17987.5,-13585.61 18364.5,-13585.61 18364.5,-13653.61"/>
<text text-anchor="middle" x="18176" y="-13638.41" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="18176" y="-13623.41" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="18176" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18176" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_6_EP1_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge431" class="edge">
<title>Layer_5_Expert_6_EP1_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18364.68,-13586.64C18367.47,-13586.29 18370.25,-13585.94 18373,-13585.61 18668.08,-13550.15 19008.37,-13527.63 19238.19,-13515.12"/>
<polygon fill="black" stroke="black" points="19238.57,-13518.6 19248.37,-13514.57 19238.19,-13511.61 19238.57,-13518.6"/>
</g>
<!-- Layer_5_Expert_6_EP1_TP1_PP1 -->
<g id="node277" class="node">
<title>Layer_5_Expert_6_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18759.5,-13653.61 18382.5,-13653.61 18382.5,-13585.61 18759.5,-13585.61 18759.5,-13653.61"/>
<text text-anchor="middle" x="18571" y="-13638.41" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="18571" y="-13623.41" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="18571" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18571" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_6_EP1_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge433" class="edge">
<title>Layer_5_Expert_6_EP1_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18759.7,-13586.79C18762.48,-13586.39 18765.25,-13586 18768,-13585.61 18932.85,-13562.53 19119.14,-13541.57 19263.18,-13526.48"/>
<polygon fill="black" stroke="black" points="19263.9,-13529.93 19273.48,-13525.41 19263.17,-13522.97 19263.9,-13529.93"/>
</g>
<!-- Layer_5_Expert_7_EP1_TP0_PP1 -->
<g id="node278" class="node">
<title>Layer_5_Expert_7_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19154.5,-13653.61 18777.5,-13653.61 18777.5,-13585.61 19154.5,-13585.61 19154.5,-13653.61"/>
<text text-anchor="middle" x="18966" y="-13638.41" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="18966" y="-13623.41" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="18966" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18966" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_7_EP1_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge435" class="edge">
<title>Layer_5_Expert_7_EP1_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19119.37,-13585.58C19183.89,-13571.69 19259.38,-13555.43 19326.38,-13541"/>
<polygon fill="black" stroke="black" points="19327.16,-13544.41 19336.2,-13538.88 19325.69,-13537.57 19327.16,-13544.41"/>
</g>
<!-- Layer_5_Expert_7_EP1_TP1_PP1 -->
<g id="node279" class="node">
<title>Layer_5_Expert_7_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19549.5,-13653.61 19172.5,-13653.61 19172.5,-13585.61 19549.5,-13585.61 19549.5,-13653.61"/>
<text text-anchor="middle" x="19361" y="-13638.41" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="19361" y="-13623.41" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="19361" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19361" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_7_EP1_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge437" class="edge">
<title>Layer_5_Expert_7_EP1_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19402.26,-13585.35C19414.03,-13575.86 19427.15,-13565.29 19439.97,-13554.95"/>
<polygon fill="black" stroke="black" points="19442.31,-13557.56 19447.9,-13548.56 19437.92,-13552.11 19442.31,-13557.56"/>
</g>
<!-- Layer_5_Expert_8_EP2_TP0_PP1 -->
<g id="node280" class="node">
<title>Layer_5_Expert_8_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19944.5,-13653.61 19567.5,-13653.61 19567.5,-13585.61 19944.5,-13585.61 19944.5,-13653.61"/>
<text text-anchor="middle" x="19756" y="-13638.41" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="19756" y="-13623.41" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="19756" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19756" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_8_EP2_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge439" class="edge">
<title>Layer_5_Expert_8_EP2_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19684.41,-13585.5C19661.05,-13574.7 19634.62,-13562.47 19609.36,-13550.79"/>
<polygon fill="black" stroke="black" points="19610.66,-13547.54 19600.11,-13546.52 19607.72,-13553.89 19610.66,-13547.54"/>
</g>
<!-- Layer_5_Expert_8_EP2_TP1_PP1 -->
<g id="node281" class="node">
<title>Layer_5_Expert_8_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20339.5,-13653.61 19962.5,-13653.61 19962.5,-13585.61 20339.5,-13585.61 20339.5,-13653.61"/>
<text text-anchor="middle" x="20151" y="-13638.41" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="20151" y="-13623.41" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="20151" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20151" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_8_EP2_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge441" class="edge">
<title>Layer_5_Expert_8_EP2_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19967.18,-13585.58C19884.03,-13570.64 19785.68,-13552.97 19701.11,-13537.77"/>
<polygon fill="black" stroke="black" points="19701.6,-13534.3 19691.14,-13535.98 19700.36,-13541.19 19701.6,-13534.3"/>
</g>
<!-- Layer_5_Expert_9_EP2_TP0_PP1 -->
<g id="node282" class="node">
<title>Layer_5_Expert_9_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20734.5,-13653.61 20357.5,-13653.61 20357.5,-13585.61 20734.5,-13585.61 20734.5,-13653.61"/>
<text text-anchor="middle" x="20546" y="-13638.41" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="20546" y="-13623.41" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="20546" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20546" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_9_EP2_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge443" class="edge">
<title>Layer_5_Expert_9_EP2_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20357.4,-13586.88C20354.24,-13586.45 20351.11,-13586.02 20348,-13585.61 20149.94,-13559.38 19924.7,-13537.59 19756.89,-13522.92"/>
<polygon fill="black" stroke="black" points="19756.95,-13519.41 19746.68,-13522.03 19756.34,-13526.38 19756.95,-13519.41"/>
</g>
<!-- Layer_5_Expert_9_EP2_TP1_PP1 -->
<g id="node283" class="node">
<title>Layer_5_Expert_9_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21129.5,-13653.61 20752.5,-13653.61 20752.5,-13585.61 21129.5,-13585.61 21129.5,-13653.61"/>
<text text-anchor="middle" x="20941" y="-13638.41" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="20941" y="-13623.41" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="20941" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20941" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_9_EP2_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge445" class="edge">
<title>Layer_5_Expert_9_EP2_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20752.42,-13586.75C20749.26,-13586.35 20746.12,-13585.98 20743,-13585.61 20410.71,-13546.87 20025.98,-13524.55 19774.72,-13513"/>
<polygon fill="black" stroke="black" points="19774.88,-13509.5 19764.73,-13512.54 19774.56,-13516.49 19774.88,-13509.5"/>
</g>
<!-- Layer_5_Expert_10_EP2_TP0_PP1 -->
<g id="node284" class="node">
<title>Layer_5_Expert_10_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21524.5,-13653.61 21147.5,-13653.61 21147.5,-13585.61 21524.5,-13585.61 21524.5,-13653.61"/>
<text text-anchor="middle" x="21336" y="-13638.41" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="21336" y="-13623.41" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="21336" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21336" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_10_EP2_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge447" class="edge">
<title>Layer_5_Expert_10_EP2_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21147.43,-13586.68C21144.26,-13586.31 21141.12,-13585.95 21138,-13585.61 20662.45,-13534.06 20105.43,-13514.37 19780.22,-13506.94"/>
<polygon fill="black" stroke="black" points="19780.27,-13503.44 19770.19,-13506.72 19780.11,-13510.44 19780.27,-13503.44"/>
</g>
<!-- Layer_5_Expert_10_EP2_TP1_PP1 -->
<g id="node285" class="node">
<title>Layer_5_Expert_10_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21919.5,-13653.61 21542.5,-13653.61 21542.5,-13585.61 21919.5,-13585.61 21919.5,-13653.61"/>
<text text-anchor="middle" x="21731" y="-13638.41" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="21731" y="-13623.41" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="21731" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21731" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_10_EP2_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge449" class="edge">
<title>Layer_5_Expert_10_EP2_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21542.43,-13586.63C21539.26,-13586.28 21536.12,-13585.94 21533,-13585.61 20909.21,-13521.1 20172.63,-13506.13 19781.54,-13503"/>
<polygon fill="black" stroke="black" points="19781.53,-13499.5 19771.51,-13502.92 19781.48,-13506.5 19781.53,-13499.5"/>
</g>
<!-- Layer_5_Expert_11_EP2_TP0_PP1 -->
<g id="node286" class="node">
<title>Layer_5_Expert_11_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22314.5,-13653.61 21937.5,-13653.61 21937.5,-13585.61 22314.5,-13585.61 22314.5,-13653.61"/>
<text text-anchor="middle" x="22126" y="-13638.41" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="22126" y="-13623.41" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="22126" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22126" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_11_EP2_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge451" class="edge">
<title>Layer_5_Expert_11_EP2_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21937.43,-13586.6C21934.27,-13586.26 21931.12,-13585.92 21928,-13585.61 21519.06,-13544.7 20324.06,-13517.86 19780.23,-13507.43"/>
<polygon fill="black" stroke="black" points="19779.95,-13503.92 19769.88,-13507.23 19779.82,-13510.92 19779.95,-13503.92"/>
</g>
<!-- Layer_5_Expert_11_EP2_TP1_PP1 -->
<g id="node287" class="node">
<title>Layer_5_Expert_11_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22709.5,-13653.61 22332.5,-13653.61 22332.5,-13585.61 22709.5,-13585.61 22709.5,-13653.61"/>
<text text-anchor="middle" x="22521" y="-13638.41" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="22521" y="-13623.41" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="22521" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22521" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_11_EP2_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge453" class="edge">
<title>Layer_5_Expert_11_EP2_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22332.43,-13586.58C22329.27,-13586.24 22326.12,-13585.92 22323,-13585.61 21835.95,-13538.07 20390.42,-13514.11 19780.94,-13505.89"/>
<polygon fill="black" stroke="black" points="19780.74,-13502.39 19770.69,-13505.76 19780.64,-13509.39 19780.74,-13502.39"/>
</g>
<!-- Layer_5_Expert_12_EP3_TP0_PP1 -->
<g id="node288" class="node">
<title>Layer_5_Expert_12_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23104.5,-13653.61 22727.5,-13653.61 22727.5,-13585.61 23104.5,-13585.61 23104.5,-13653.61"/>
<text text-anchor="middle" x="22916" y="-13638.41" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="22916" y="-13623.41" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="22916" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22916" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_12_EP3_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge455" class="edge">
<title>Layer_5_Expert_12_EP3_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22727.44,-13586.57C22724.27,-13586.23 22721.12,-13585.91 22718,-13585.61 22152.18,-13531.41 20452.03,-13510.86 19781.37,-13504.73"/>
<polygon fill="black" stroke="black" points="19781.11,-13501.22 19771.08,-13504.63 19781.05,-13508.22 19781.11,-13501.22"/>
</g>
<!-- Layer_5_Expert_12_EP3_TP1_PP1 -->
<g id="node289" class="node">
<title>Layer_5_Expert_12_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23499.5,-13653.61 23122.5,-13653.61 23122.5,-13585.61 23499.5,-13585.61 23499.5,-13653.61"/>
<text text-anchor="middle" x="23311" y="-13638.41" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="23311" y="-13623.41" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="23311" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23311" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_12_EP3_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge457" class="edge">
<title>Layer_5_Expert_12_EP3_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23122.44,-13586.55C23119.27,-13586.22 23116.12,-13585.91 23113,-13585.61 22467.86,-13524.73 20509.72,-13507.99 19781.59,-13503.81"/>
<polygon fill="black" stroke="black" points="19781.51,-13500.31 19771.49,-13503.75 19781.47,-13507.31 19781.51,-13500.31"/>
</g>
<!-- Layer_5_Expert_13_EP3_TP0_PP1 -->
<g id="node290" class="node">
<title>Layer_5_Expert_13_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23894.5,-13653.61 23517.5,-13653.61 23517.5,-13585.61 23894.5,-13585.61 23894.5,-13653.61"/>
<text text-anchor="middle" x="23706" y="-13638.41" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="23706" y="-13623.41" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="23706" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23706" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_13_EP3_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge459" class="edge">
<title>Layer_5_Expert_13_EP3_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23517.44,-13586.54C23514.27,-13586.22 23511.12,-13585.9 23508,-13585.61 22783.18,-13518.05 20564.82,-13505.42 19782.03,-13503.07"/>
<polygon fill="black" stroke="black" points="19781.76,-13499.57 19771.75,-13503.04 19781.74,-13506.57 19781.76,-13499.57"/>
</g>
<!-- Layer_5_Expert_13_EP3_TP1_PP1 -->
<g id="node291" class="node">
<title>Layer_5_Expert_13_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24289.5,-13653.61 23912.5,-13653.61 23912.5,-13585.61 24289.5,-13585.61 24289.5,-13653.61"/>
<text text-anchor="middle" x="24101" y="-13638.41" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="24101" y="-13623.41" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="24101" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24101" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_13_EP3_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge461" class="edge">
<title>Layer_5_Expert_13_EP3_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23912.44,-13586.54C23909.27,-13586.21 23906.12,-13585.9 23903,-13585.61 23097.92,-13511.32 20615.96,-13503.09 19781.76,-13502.46"/>
<polygon fill="black" stroke="black" points="19781.73,-13498.96 19771.72,-13502.45 19781.72,-13505.96 19781.73,-13498.96"/>
</g>
<!-- Layer_5_Expert_14_EP3_TP0_PP1 -->
<g id="node292" class="node">
<title>Layer_5_Expert_14_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24684.5,-13653.61 24307.5,-13653.61 24307.5,-13585.61 24684.5,-13585.61 24684.5,-13653.61"/>
<text text-anchor="middle" x="24496" y="-13638.41" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="24496" y="-13623.41" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="24496" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24496" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_14_EP3_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge463" class="edge">
<title>Layer_5_Expert_14_EP3_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24307.44,-13586.53C24304.27,-13586.2 24301.12,-13585.9 24298,-13585.61 23412.48,-13504.59 20665.6,-13500.94 19781.89,-13501.95"/>
<polygon fill="black" stroke="black" points="19781.57,-13498.45 19771.58,-13501.96 19781.58,-13505.45 19781.57,-13498.45"/>
</g>
<!-- Layer_5_Expert_14_EP3_TP1_PP1 -->
<g id="node293" class="node">
<title>Layer_5_Expert_14_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25079.5,-13653.61 24702.5,-13653.61 24702.5,-13585.61 25079.5,-13585.61 25079.5,-13653.61"/>
<text text-anchor="middle" x="24891" y="-13638.41" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="24891" y="-13623.41" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="24891" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24891" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_14_EP3_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge465" class="edge">
<title>Layer_5_Expert_14_EP3_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24702.44,-13586.52C24699.27,-13586.2 24696.12,-13585.9 24693,-13585.61 24204.07,-13541.2 20785.65,-13512.18 19781.65,-13504.54"/>
<polygon fill="black" stroke="black" points="19781.43,-13501.04 19771.4,-13504.46 19781.37,-13508.04 19781.43,-13501.04"/>
</g>
<!-- Layer_5_Expert_15_EP3_TP0_PP1 -->
<g id="node294" class="node">
<title>Layer_5_Expert_15_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25474.5,-13653.61 25097.5,-13653.61 25097.5,-13585.61 25474.5,-13585.61 25474.5,-13653.61"/>
<text text-anchor="middle" x="25286" y="-13638.41" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="25286" y="-13623.41" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="25286" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25286" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_15_EP3_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge467" class="edge">
<title>Layer_5_Expert_15_EP3_TP0_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M25097.44,-13586.52C25094.27,-13586.2 25091.12,-13585.89 25088,-13585.61 24558.37,-13537.81 20834.81,-13510.91 19781.81,-13504.2"/>
<polygon fill="black" stroke="black" points="19781.47,-13500.7 19771.45,-13504.14 19781.43,-13507.7 19781.47,-13500.7"/>
</g>
<!-- Layer_5_Expert_15_EP3_TP1_PP1 -->
<g id="node295" class="node">
<title>Layer_5_Expert_15_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25869.5,-13653.61 25492.5,-13653.61 25492.5,-13585.61 25869.5,-13585.61 25869.5,-13653.61"/>
<text text-anchor="middle" x="25681" y="-13638.41" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="25681" y="-13623.41" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="25681" y="-13608.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25681" y="-13593.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_Expert_15_EP3_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1 -->
<g id="edge469" class="edge">
<title>Layer_5_Expert_15_EP3_TP1_PP1&#45;&gt;Layer_5_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M25492.44,-13586.52C25489.27,-13586.19 25486.12,-13585.89 25483,-13585.61 24912.53,-13534.41 20881.54,-13509.74 19781.65,-13503.91"/>
<polygon fill="black" stroke="black" points="19781.65,-13500.41 19771.64,-13503.86 19781.62,-13507.41 19781.65,-13500.41"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_0_EP0_TP0_PP1 -->
<g id="edge406" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_0_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19444.56,-13735.45C18354.36,-13730.02 14261.91,-13706.35 13634.94,-13653.71"/>
<polygon fill="black" stroke="black" points="13634.92,-13650.2 13624.66,-13652.82 13634.31,-13657.17 13634.92,-13650.2"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_0_EP0_TP1_PP1 -->
<g id="edge408" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_0_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19444.71,-13735.18C18400.54,-13728.89 14614.45,-13702.97 14029.66,-13653.69"/>
<polygon fill="black" stroke="black" points="14029.92,-13650.2 14019.66,-13652.81 14029.31,-13657.17 14029.92,-13650.2"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_1_EP0_TP0_PP1 -->
<g id="edge410" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_1_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19444.64,-13734.86C18447.99,-13727.68 14968.47,-13699.6 14424.72,-13653.69"/>
<polygon fill="black" stroke="black" points="14424.92,-13650.2 14414.66,-13652.81 14424.31,-13657.17 14424.92,-13650.2"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_1_EP0_TP1_PP1 -->
<g id="edge412" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_1_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19444.28,-13737.41C18562.96,-13738.93 15748.09,-13737.04 14819.82,-13653.73"/>
<polygon fill="black" stroke="black" points="14819.93,-13650.22 14809.66,-13652.8 14819.3,-13657.19 14819.93,-13650.22"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_2_EP0_TP0_PP1 -->
<g id="edge414" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_2_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19444.13,-13736.93C18610.73,-13736.87 16062.28,-13730.3 15214.86,-13653.73"/>
<polygon fill="black" stroke="black" points="15214.93,-13650.22 15204.66,-13652.8 15214.3,-13657.19 15214.93,-13650.22"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_2_EP0_TP1_PP1 -->
<g id="edge416" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_2_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19444.26,-13736.37C18661.2,-13734.63 16376.49,-13723.59 15609.72,-13653.72"/>
<polygon fill="black" stroke="black" points="15609.94,-13650.23 15599.66,-13652.79 15609.29,-13657.2 15609.94,-13650.23"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_3_EP0_TP0_PP1 -->
<g id="edge418" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_3_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19444.42,-13735.7C18714.23,-13732.17 16691.19,-13716.9 16004.67,-13653.72"/>
<polygon fill="black" stroke="black" points="16004.94,-13650.23 15994.66,-13652.78 16004.29,-13657.2 16004.94,-13650.23"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_3_EP0_TP1_PP1 -->
<g id="edge420" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_3_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19444.73,-13734.86C18770.44,-13729.44 17006.7,-13710.24 16399.83,-13653.73"/>
<polygon fill="black" stroke="black" points="16399.94,-13650.23 16389.66,-13652.77 16399.29,-13657.2 16399.94,-13650.23"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_4_EP1_TP0_PP1 -->
<g id="edge422" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_4_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19445.13,-13733.81C18830.07,-13726.37 17321.99,-13703.61 16794.65,-13653.72"/>
<polygon fill="black" stroke="black" points="16794.95,-13650.23 16784.66,-13652.76 16794.28,-13657.2 16794.95,-13650.23"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_4_EP1_TP1_PP1 -->
<g id="edge424" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_4_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19445.8,-13732.44C18894.29,-13722.85 17638.45,-13697.04 17189.79,-13653.74"/>
<polygon fill="black" stroke="black" points="17189.96,-13650.24 17179.66,-13652.74 17189.27,-13657.2 17189.96,-13650.24"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_5_EP1_TP0_PP1 -->
<g id="edge426" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_5_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19444.41,-13737.12C19042.71,-13735.34 18258.39,-13722.38 17585.07,-13653.78"/>
<polygon fill="black" stroke="black" points="17584.97,-13650.26 17574.67,-13652.72 17584.26,-13657.22 17584.97,-13650.26"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_5_EP1_TP1_PP1 -->
<g id="edge428" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_5_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19445.27,-13733.68C19106.68,-13727.63 18503.47,-13709.42 17979.7,-13653.76"/>
<polygon fill="black" stroke="black" points="17979.98,-13650.27 17969.67,-13652.68 17979.24,-13657.23 17979.98,-13650.27"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_6_EP1_TP0_PP1 -->
<g id="edge430" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_6_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19449.1,-13728.48C19181.22,-13718.22 18753.03,-13696.63 18374.73,-13653.77"/>
<polygon fill="black" stroke="black" points="18375.01,-13650.28 18364.67,-13652.63 18374.21,-13657.24 18375.01,-13650.28"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_6_EP1_TP1_PP1 -->
<g id="edge432" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_6_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19462.74,-13720.14C19274.86,-13706.34 19010.31,-13684.21 18769.68,-13653.8"/>
<polygon fill="black" stroke="black" points="18770.05,-13650.32 18759.69,-13652.53 18769.17,-13657.26 18770.05,-13650.32"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_7_EP1_TP0_PP1 -->
<g id="edge434" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_7_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19507.57,-13706.62C19407.12,-13691.58 19283.86,-13672.84 19164.76,-13653.89"/>
<polygon fill="black" stroke="black" points="19165.15,-13650.4 19154.72,-13652.29 19164.05,-13657.32 19165.15,-13650.4"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_7_EP1_TP1_PP1 -->
<g id="edge436" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_7_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19585.63,-13695.11C19547.91,-13682.6 19506.83,-13668.98 19470.24,-13656.84"/>
<polygon fill="black" stroke="black" points="19471.14,-13653.45 19460.55,-13653.63 19468.94,-13660.1 19471.14,-13653.45"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_8_EP2_TP0_PP1 -->
<g id="edge438" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_8_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19729.3,-13689.48C19732.66,-13680.82 19736.15,-13671.82 19739.45,-13663.29"/>
<polygon fill="black" stroke="black" points="19742.74,-13664.51 19743.09,-13653.92 19736.21,-13661.98 19742.74,-13664.51"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_8_EP2_TP1_PP1 -->
<g id="edge440" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_8_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19859.04,-13697.64C19909.82,-13684.24 19966.33,-13669.33 20016.02,-13656.22"/>
<polygon fill="black" stroke="black" points="20017.08,-13659.56 20025.86,-13653.63 20015.3,-13652.79 20017.08,-13659.56"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_9_EP2_TP0_PP1 -->
<g id="edge442" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_9_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19929.8,-13710.1C20050.06,-13695.01 20202.13,-13675.15 20347.38,-13653.69"/>
<polygon fill="black" stroke="black" points="20348,-13657.13 20357.38,-13652.21 20346.98,-13650.21 20348,-13657.13"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_9_EP2_TP1_PP1 -->
<g id="edge444" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_9_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19963.69,-13722.35C20170.44,-13709.2 20470.54,-13686.86 20742.35,-13653.66"/>
<polygon fill="black" stroke="black" points="20742.91,-13657.11 20752.41,-13652.42 20742.06,-13650.17 20742.91,-13657.11"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_10_EP2_TP0_PP1 -->
<g id="edge446" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_10_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19974.07,-13729.81C20258.63,-13720.41 20725.64,-13699.34 21137.4,-13653.64"/>
<polygon fill="black" stroke="black" points="21137.87,-13657.1 21147.42,-13652.52 21137.1,-13650.15 21137.87,-13657.1"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_10_EP2_TP1_PP1 -->
<g id="edge448" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_10_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19977.28,-13734.51C20330.69,-13729.35 20974.03,-13712.1 21532.16,-13653.65"/>
<polygon fill="black" stroke="black" points="21532.85,-13657.1 21542.43,-13652.57 21532.12,-13650.14 21532.85,-13657.1"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_11_EP2_TP0_PP1 -->
<g id="edge450" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_11_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19975.15,-13731.03C20473.84,-13719.64 21537.99,-13691.83 21927.24,-13653.63"/>
<polygon fill="black" stroke="black" points="21927.83,-13657.08 21937.43,-13652.61 21927.13,-13650.12 21927.83,-13657.08"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_11_EP2_TP1_PP1 -->
<g id="edge452" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_11_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19976.34,-13732.75C20542.52,-13723.61 21854.7,-13698.33 22322.22,-13653.62"/>
<polygon fill="black" stroke="black" points="22322.82,-13657.08 22332.43,-13652.63 22322.14,-13650.12 22322.82,-13657.08"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_12_EP3_TP0_PP1 -->
<g id="edge454" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_12_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19977.03,-13734.04C20605.69,-13727.01 22170.51,-13704.89 22717.09,-13653.64"/>
<polygon fill="black" stroke="black" points="22717.81,-13657.08 22727.44,-13652.65 22717.15,-13650.11 22717.81,-13657.08"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_12_EP3_TP1_PP1 -->
<g id="edge456" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_12_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19977.47,-13735.04C20664.77,-13729.99 22486.67,-13711.48 23112.4,-13653.61"/>
<polygon fill="black" stroke="black" points="23112.81,-13657.08 23122.44,-13652.66 23112.15,-13650.11 23112.81,-13657.08"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_13_EP3_TP0_PP1 -->
<g id="edge458" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_13_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19977.58,-13735.83C20719.9,-13732.64 22801.72,-13718.12 23507.41,-13653.6"/>
<polygon fill="black" stroke="black" points="23507.8,-13657.08 23517.44,-13652.68 23507.16,-13650.11 23507.8,-13657.08"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_13_EP3_TP1_PP1 -->
<g id="edge460" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_13_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19977.84,-13736.48C20772.52,-13735.04 23116.48,-13724.78 23902.41,-13653.6"/>
<polygon fill="black" stroke="black" points="23902.8,-13657.08 23912.44,-13652.68 23902.16,-13650.11 23902.8,-13657.08"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_14_EP3_TP0_PP1 -->
<g id="edge462" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_14_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19977.91,-13737.02C20822.4,-13737.23 23430.71,-13731.47 24297.32,-13653.61"/>
<polygon fill="black" stroke="black" points="24297.8,-13657.08 24307.44,-13652.69 24297.16,-13650.11 24297.8,-13657.08"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_14_EP3_TP1_PP1 -->
<g id="edge464" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_14_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19977.11,-13734.57C20935.22,-13726.61 24178.8,-13696.82 24692.23,-13653.59"/>
<polygon fill="black" stroke="black" points="24692.78,-13657.06 24702.44,-13652.7 24692.17,-13650.08 24692.78,-13657.06"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_15_EP3_TP0_PP1 -->
<g id="edge466" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_15_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19977.5,-13734.92C20985.09,-13727.9 24532.48,-13700.15 25087.18,-13653.6"/>
<polygon fill="black" stroke="black" points="25087.78,-13657.06 25097.44,-13652.7 25087.17,-13650.08 25087.78,-13657.06"/>
</g>
<!-- Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_15_EP3_TP1_PP1 -->
<g id="edge468" class="edge">
<title>Layer_5_A2A_Dispatch_PP1&#45;&gt;Layer_5_Expert_15_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19977.39,-13735.23C21032.1,-13729.09 24886.53,-13703.51 25482.25,-13653.59"/>
<polygon fill="black" stroke="black" points="25482.78,-13657.06 25492.44,-13652.71 25482.18,-13650.09 25482.78,-13657.06"/>
</g>
<!-- Layer_5_MLP_Out_TP0_PP1 -->
<g id="node298" class="node">
<title>Layer_5_MLP_Out_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19495.5,-13417.45 19118.5,-13417.45 19118.5,-13349.45 19495.5,-13349.45 19495.5,-13417.45"/>
<text text-anchor="middle" x="19307" y="-13402.25" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="19307" y="-13387.25" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19307" y="-13372.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19307" y="-13357.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_A2A_Combine_PP1&#45;&gt;Layer_5_MLP_Out_TP0_PP1 -->
<g id="edge470" class="edge">
<title>Layer_5_A2A_Combine_PP1&#45;&gt;Layer_5_MLP_Out_TP0_PP1</title>
<path fill="none" stroke="black" d="M19428.16,-13455.48C19409.67,-13444.64 19390.08,-13433.16 19372.18,-13422.66"/>
<polygon fill="black" stroke="black" points="19373.93,-13419.63 19363.53,-13417.59 19370.39,-13425.67 19373.93,-13419.63"/>
</g>
<!-- Layer_5_MLP_Out_TP1_PP1 -->
<g id="node299" class="node">
<title>Layer_5_MLP_Out_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="19890.5,-13417.45 19513.5,-13417.45 19513.5,-13349.45 19890.5,-13349.45 19890.5,-13417.45"/>
<text text-anchor="middle" x="19702" y="-13402.25" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="19702" y="-13387.25" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19702" y="-13372.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19702" y="-13357.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_5_A2A_Combine_PP1&#45;&gt;Layer_5_MLP_Out_TP1_PP1 -->
<g id="edge472" class="edge">
<title>Layer_5_A2A_Combine_PP1&#45;&gt;Layer_5_MLP_Out_TP1_PP1</title>
<path fill="none" stroke="black" d="M19581.73,-13455.32C19599.95,-13444.58 19619.21,-13433.23 19636.85,-13422.84"/>
<polygon fill="black" stroke="black" points="19639.08,-13425.59 19645.91,-13417.49 19635.52,-13419.56 19639.08,-13425.59"/>
</g>
<!-- Layer_5_MLP_AllReduce_PP1 -->
<g id="node300" class="node">
<title>Layer_5_MLP_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19486" cy="-13265.36" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19486" y="-13284.16" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="19486" y="-13269.16" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19486" y="-13254.16" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19486" y="-13239.16" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_5_MLP_Out_TP0_PP1&#45;&gt;Layer_5_MLP_AllReduce_PP1 -->
<g id="edge471" class="edge">
<title>Layer_5_MLP_Out_TP0_PP1&#45;&gt;Layer_5_MLP_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19358.29,-13349.18C19373.51,-13339.31 19390.55,-13328.26 19407.09,-13317.54"/>
<polygon fill="black" stroke="black" points="19409.2,-13320.34 19415.69,-13311.96 19405.39,-13314.47 19409.2,-13320.34"/>
</g>
<!-- Layer_5_MLP_Out_TP1_PP1&#45;&gt;Layer_5_MLP_AllReduce_PP1 -->
<g id="edge473" class="edge">
<title>Layer_5_MLP_Out_TP1_PP1&#45;&gt;Layer_5_MLP_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19640.39,-13349.34C19621.08,-13338.96 19599.32,-13327.27 19578.37,-13316"/>
<polygon fill="black" stroke="black" points="19579.91,-13312.86 19569.45,-13311.21 19576.6,-13319.03 19579.91,-13312.86"/>
</g>
<!-- Layer_5_LayerNorm_PP1 -->
<g id="node301" class="node">
<title>Layer_5_LayerNorm_PP1</title>
<polygon fill="lightgreen" stroke="black" points="19674.5,-13181.28 19297.5,-13181.28 19297.5,-13113.28 19674.5,-13113.28 19674.5,-13181.28"/>
<text text-anchor="middle" x="19486" y="-13166.08" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19486" y="-13151.08" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19486" y="-13136.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19486" y="-13121.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_5_MLP_AllReduce_PP1&#45;&gt;Layer_5_LayerNorm_PP1 -->
<g id="edge474" class="edge">
<title>Layer_5_MLP_AllReduce_PP1&#45;&gt;Layer_5_LayerNorm_PP1</title>
<path fill="none" stroke="black" d="M19486,-13217.15C19486,-13208.76 19486,-13200.06 19486,-13191.79"/>
<polygon fill="black" stroke="black" points="19489.5,-13191.58 19486,-13181.58 19482.5,-13191.58 19489.5,-13191.58"/>
</g>
<!-- Layer_6_QKV_TP0_PP1 -->
<g id="node302" class="node">
<title>Layer_6_QKV_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19676.5,-13077.28 19295.5,-13077.28 19295.5,-13009.28 19676.5,-13009.28 19676.5,-13077.28"/>
<text text-anchor="middle" x="19486" y="-13062.08" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19486" y="-13047.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19486" y="-13032.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19486" y="-13017.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_5_LayerNorm_PP1&#45;&gt;Layer_6_QKV_TP0_PP1 -->
<g id="edge475" class="edge">
<title>Layer_5_LayerNorm_PP1&#45;&gt;Layer_6_QKV_TP0_PP1</title>
<path fill="none" stroke="black" d="M19486,-13113.16C19486,-13105.06 19486,-13096.26 19486,-13087.75"/>
<polygon fill="black" stroke="black" points="19489.5,-13087.58 19486,-13077.58 19482.5,-13087.58 19489.5,-13087.58"/>
</g>
<!-- Layer_6_QKV_AllReduce_PP1 -->
<g id="node304" class="node">
<title>Layer_6_QKV_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19186" cy="-12925.2" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="19186" y="-12944" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="19186" y="-12929" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19186" y="-12914" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19186" y="-12899" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_6_QKV_TP0_PP1&#45;&gt;Layer_6_QKV_AllReduce_PP1 -->
<g id="edge476" class="edge">
<title>Layer_6_QKV_TP0_PP1&#45;&gt;Layer_6_QKV_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19400.43,-13009.17C19371.32,-12997.9 19338.21,-12985.09 19306.86,-12972.96"/>
<polygon fill="black" stroke="black" points="19307.78,-12969.57 19297.19,-12969.22 19305.26,-12976.09 19307.78,-12969.57"/>
</g>
<!-- Layer_6_QKV_TP1_PP1 -->
<g id="node303" class="node">
<title>Layer_6_QKV_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="19277.5,-13077.28 18896.5,-13077.28 18896.5,-13009.28 19277.5,-13009.28 19277.5,-13077.28"/>
<text text-anchor="middle" x="19087" y="-13062.08" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19087" y="-13047.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19087" y="-13032.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19087" y="-13017.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_6_QKV_TP1_PP1&#45;&gt;Layer_6_QKV_AllReduce_PP1 -->
<g id="edge480" class="edge">
<title>Layer_6_QKV_TP1_PP1&#45;&gt;Layer_6_QKV_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19115.37,-13009.01C19122.94,-13000.13 19131.33,-12990.3 19139.6,-12980.6"/>
<polygon fill="black" stroke="black" points="19142.37,-12982.75 19146.19,-12972.87 19137.04,-12978.21 19142.37,-12982.75"/>
</g>
<!-- Layer_6_Attention_TP0_PP1 -->
<g id="node305" class="node">
<title>Layer_6_Attention_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19305.5,-12841.11 18924.5,-12841.11 18924.5,-12773.11 19305.5,-12773.11 19305.5,-12841.11"/>
<text text-anchor="middle" x="19115" y="-12825.91" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="19115" y="-12810.91" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19115" y="-12795.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19115" y="-12780.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_6_QKV_AllReduce_PP1&#45;&gt;Layer_6_Attention_TP0_PP1 -->
<g id="edge477" class="edge">
<title>Layer_6_QKV_AllReduce_PP1&#45;&gt;Layer_6_Attention_TP0_PP1</title>
<path fill="none" stroke="black" d="M19157.33,-12877.32C19151.78,-12868.25 19146.01,-12858.82 19140.58,-12849.93"/>
<polygon fill="black" stroke="black" points="19143.48,-12847.97 19135.27,-12841.26 19137.51,-12851.62 19143.48,-12847.97"/>
</g>
<!-- Layer_6_Attention_TP1_PP1 -->
<g id="node306" class="node">
<title>Layer_6_Attention_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="19704.5,-12841.11 19323.5,-12841.11 19323.5,-12773.11 19704.5,-12773.11 19704.5,-12841.11"/>
<text text-anchor="middle" x="19514" y="-12825.91" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="19514" y="-12810.91" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19514" y="-12795.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19514" y="-12780.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_6_QKV_AllReduce_PP1&#45;&gt;Layer_6_Attention_TP1_PP1 -->
<g id="edge481" class="edge">
<title>Layer_6_QKV_AllReduce_PP1&#45;&gt;Layer_6_Attention_TP1_PP1</title>
<path fill="none" stroke="black" d="M19305.81,-12881.79C19340.29,-12869.59 19377.58,-12856.39 19410.95,-12844.58"/>
<polygon fill="black" stroke="black" points="19412.45,-12847.77 19420.71,-12841.13 19410.12,-12841.17 19412.45,-12847.77"/>
</g>
<!-- Layer_6_AttnOut_TP0_PP1 -->
<g id="node307" class="node">
<title>Layer_6_AttnOut_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19304.5,-12737.11 18927.5,-12737.11 18927.5,-12669.11 19304.5,-12669.11 19304.5,-12737.11"/>
<text text-anchor="middle" x="19116" y="-12721.91" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="19116" y="-12706.91" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19116" y="-12691.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19116" y="-12676.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Attention_TP0_PP1&#45;&gt;Layer_6_AttnOut_TP0_PP1 -->
<g id="edge478" class="edge">
<title>Layer_6_Attention_TP0_PP1&#45;&gt;Layer_6_AttnOut_TP0_PP1</title>
<path fill="none" stroke="black" d="M19115.32,-12773C19115.4,-12764.89 19115.49,-12756.09 19115.57,-12747.59"/>
<polygon fill="black" stroke="black" points="19119.08,-12747.45 19115.67,-12737.41 19112.08,-12747.38 19119.08,-12747.45"/>
</g>
<!-- Layer_6_AttnOut_TP1_PP1 -->
<g id="node308" class="node">
<title>Layer_6_AttnOut_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="19700.5,-12737.11 19323.5,-12737.11 19323.5,-12669.11 19700.5,-12669.11 19700.5,-12737.11"/>
<text text-anchor="middle" x="19512" y="-12721.91" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="19512" y="-12706.91" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19512" y="-12691.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19512" y="-12676.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Attention_TP1_PP1&#45;&gt;Layer_6_AttnOut_TP1_PP1 -->
<g id="edge482" class="edge">
<title>Layer_6_Attention_TP1_PP1&#45;&gt;Layer_6_AttnOut_TP1_PP1</title>
<path fill="none" stroke="black" d="M19513.35,-12773C19513.19,-12764.89 19513.02,-12756.09 19512.85,-12747.59"/>
<polygon fill="black" stroke="black" points="19516.35,-12747.34 19512.65,-12737.41 19509.35,-12747.48 19516.35,-12747.34"/>
</g>
<!-- Layer_6_AttnOut_AllReduce_PP1 -->
<g id="node309" class="node">
<title>Layer_6_AttnOut_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19365" cy="-12585.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19365" y="-12603.83" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="19365" y="-12588.83" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19365" y="-12573.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19365" y="-12558.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_6_AttnOut_TP0_PP1&#45;&gt;Layer_6_AttnOut_AllReduce_PP1 -->
<g id="edge479" class="edge">
<title>Layer_6_AttnOut_TP0_PP1&#45;&gt;Layer_6_AttnOut_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19187.02,-12669C19210.19,-12658.2 19236.42,-12645.98 19261.47,-12634.29"/>
<polygon fill="black" stroke="black" points="19263.06,-12637.42 19270.64,-12630.02 19260.1,-12631.07 19263.06,-12637.42"/>
</g>
<!-- Layer_6_AttnOut_TP1_PP1&#45;&gt;Layer_6_AttnOut_AllReduce_PP1 -->
<g id="edge483" class="edge">
<title>Layer_6_AttnOut_TP1_PP1&#45;&gt;Layer_6_AttnOut_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19469.88,-12668.85C19457.86,-12659.36 19444.47,-12648.79 19431.38,-12638.45"/>
<polygon fill="black" stroke="black" points="19433.31,-12635.51 19423.29,-12632.06 19428.97,-12641 19433.31,-12635.51"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1 -->
<g id="node346" class="node">
<title>Layer_6_A2A_Dispatch_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19365" cy="-12452.86" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19365" y="-12471.66" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="19365" y="-12456.66" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19365" y="-12441.66" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19365" y="-12426.66" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_6_AttnOut_AllReduce_PP1&#45;&gt;Layer_6_A2A_Dispatch_PP1 -->
<g id="edge484" class="edge">
<title>Layer_6_AttnOut_AllReduce_PP1&#45;&gt;Layer_6_A2A_Dispatch_PP1</title>
<path fill="none" stroke="black" d="M19365,-12536.67C19365,-12528.4 19365,-12519.72 19365,-12511.21"/>
<polygon fill="black" stroke="black" points="19368.5,-12510.97 19365,-12500.97 19361.5,-12510.97 19368.5,-12510.97"/>
</g>
<!-- Layer_6_Gate_EP0_PP1 -->
<g id="node310" class="node">
<title>Layer_6_Gate_EP0_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="19408.4,-15714.94 18804.86,-15714.94 18649.6,-15578.94 19253.14,-15578.94 19408.4,-15714.94"/>
<text text-anchor="middle" x="19029" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="19029" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="19029" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19029" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_6_Gate_EP1_PP1 -->
<g id="node311" class="node">
<title>Layer_6_Gate_EP1_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="18631.4,-15714.94 18027.86,-15714.94 17872.6,-15578.94 18476.14,-15578.94 18631.4,-15714.94"/>
<text text-anchor="middle" x="18252" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="18252" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="18252" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18252" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_6_Gate_EP2_PP1 -->
<g id="node312" class="node">
<title>Layer_6_Gate_EP2_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="17854.4,-15714.94 17250.86,-15714.94 17095.6,-15578.94 17699.14,-15578.94 17854.4,-15714.94"/>
<text text-anchor="middle" x="17475" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="17475" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="17475" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17475" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_6_Gate_EP3_PP1 -->
<g id="node313" class="node">
<title>Layer_6_Gate_EP3_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="17077.4,-15714.94 16473.86,-15714.94 16318.6,-15578.94 16922.14,-15578.94 17077.4,-15714.94"/>
<text text-anchor="middle" x="16698" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="16698" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="16698" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16698" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_6_Expert_0_EP0_TP0_PP1 -->
<g id="node314" class="node">
<title>Layer_6_Expert_0_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="13592.5,-12368.78 13215.5,-12368.78 13215.5,-12300.78 13592.5,-12300.78 13592.5,-12368.78"/>
<text text-anchor="middle" x="13404" y="-12353.58" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13404" y="-12338.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="13404" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13404" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_A2A_Combine_PP1 -->
<g id="node347" class="node">
<title>Layer_6_A2A_Combine_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19515" cy="-12216.7" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19515" y="-12235.5" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="19515" y="-12220.5" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19515" y="-12205.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19515" y="-12190.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_6_Expert_0_EP0_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge486" class="edge">
<title>Layer_6_Expert_0_EP0_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M13592.66,-12301.58C13595.45,-12301.3 13598.24,-12301.03 13601,-12300.78 14164.8,-12249.9 18145.47,-12225.03 19238.13,-12219.11"/>
<polygon fill="black" stroke="black" points="19238.5,-12222.61 19248.48,-12219.05 19238.46,-12215.61 19238.5,-12222.61"/>
</g>
<!-- Layer_6_Expert_0_EP0_TP1_PP1 -->
<g id="node315" class="node">
<title>Layer_6_Expert_0_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="13987.5,-12368.78 13610.5,-12368.78 13610.5,-12300.78 13987.5,-12300.78 13987.5,-12368.78"/>
<text text-anchor="middle" x="13799" y="-12353.58" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13799" y="-12338.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="13799" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13799" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_0_EP0_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge488" class="edge">
<title>Layer_6_Expert_0_EP0_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M13987.66,-12301.58C13990.45,-12301.3 13993.24,-12301.03 13996,-12300.78 14519.01,-12253.31 18193.11,-12226.22 19238.25,-12219.41"/>
<polygon fill="black" stroke="black" points="19238.56,-12222.91 19248.54,-12219.34 19238.51,-12215.91 19238.56,-12222.91"/>
</g>
<!-- Layer_6_Expert_1_EP0_TP0_PP1 -->
<g id="node316" class="node">
<title>Layer_6_Expert_1_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14382.5,-12368.78 14005.5,-12368.78 14005.5,-12300.78 14382.5,-12300.78 14382.5,-12368.78"/>
<text text-anchor="middle" x="14194" y="-12353.58" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14194" y="-12338.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="14194" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14194" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_1_EP0_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge490" class="edge">
<title>Layer_6_Expert_1_EP0_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14382.66,-12301.59C14385.45,-12301.3 14388.24,-12301.03 14391,-12300.78 14873.33,-12256.72 18242.43,-12227.5 19238.36,-12219.76"/>
<polygon fill="black" stroke="black" points="19238.55,-12223.25 19248.52,-12219.68 19238.49,-12216.25 19238.55,-12223.25"/>
</g>
<!-- Layer_6_Expert_1_EP0_TP1_PP1 -->
<g id="node317" class="node">
<title>Layer_6_Expert_1_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14777.5,-12368.78 14400.5,-12368.78 14400.5,-12300.78 14777.5,-12300.78 14777.5,-12368.78"/>
<text text-anchor="middle" x="14589" y="-12353.58" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14589" y="-12338.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="14589" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14589" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_1_EP0_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge492" class="edge">
<title>Layer_6_Expert_1_EP0_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14777.66,-12301.59C14780.46,-12301.3 14783.24,-12301.03 14786,-12300.78 15658.39,-12220.5 18361.99,-12216.33 19237.99,-12217.16"/>
<polygon fill="black" stroke="black" points="19238.2,-12220.66 19248.21,-12217.17 19238.21,-12213.66 19238.2,-12220.66"/>
</g>
<!-- Layer_6_Expert_2_EP0_TP0_PP1 -->
<g id="node318" class="node">
<title>Layer_6_Expert_2_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15172.5,-12368.78 14795.5,-12368.78 14795.5,-12300.78 15172.5,-12300.78 15172.5,-12368.78"/>
<text text-anchor="middle" x="14984" y="-12353.58" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="14984" y="-12338.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="14984" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14984" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_2_EP0_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge494" class="edge">
<title>Layer_6_Expert_2_EP0_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15172.66,-12301.6C15175.46,-12301.31 15178.24,-12301.04 15181,-12300.78 15972.94,-12227.26 18411.69,-12218.51 19237.96,-12217.69"/>
<polygon fill="black" stroke="black" points="19238.21,-12221.19 19248.2,-12217.68 19238.2,-12214.19 19238.21,-12221.19"/>
</g>
<!-- Layer_6_Expert_2_EP0_TP1_PP1 -->
<g id="node319" class="node">
<title>Layer_6_Expert_2_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15567.5,-12368.78 15190.5,-12368.78 15190.5,-12300.78 15567.5,-12300.78 15567.5,-12368.78"/>
<text text-anchor="middle" x="15379" y="-12353.58" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15379" y="-12338.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="15379" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15379" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_2_EP0_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge496" class="edge">
<title>Layer_6_Expert_2_EP0_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15567.66,-12301.6C15570.46,-12301.31 15573.24,-12301.04 15576,-12300.78 16287.93,-12234 18464.34,-12220.88 19238.26,-12218.32"/>
<polygon fill="black" stroke="black" points="19238.44,-12221.82 19248.43,-12218.28 19238.42,-12214.82 19238.44,-12221.82"/>
</g>
<!-- Layer_6_Expert_3_EP0_TP0_PP1 -->
<g id="node320" class="node">
<title>Layer_6_Expert_3_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15962.5,-12368.78 15585.5,-12368.78 15585.5,-12300.78 15962.5,-12300.78 15962.5,-12368.78"/>
<text text-anchor="middle" x="15774" y="-12353.58" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="15774" y="-12338.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="15774" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15774" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_3_EP0_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge498" class="edge">
<title>Layer_6_Expert_3_EP0_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15962.66,-12301.61C15965.46,-12301.32 15968.24,-12301.04 15971,-12300.78 16603.16,-12240.73 18518.95,-12223.51 19238.19,-12219.08"/>
<polygon fill="black" stroke="black" points="19238.45,-12222.58 19248.43,-12219.02 19238.41,-12215.58 19238.45,-12222.58"/>
</g>
<!-- Layer_6_Expert_3_EP0_TP1_PP1 -->
<g id="node321" class="node">
<title>Layer_6_Expert_3_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16357.5,-12368.78 15980.5,-12368.78 15980.5,-12300.78 16357.5,-12300.78 16357.5,-12368.78"/>
<text text-anchor="middle" x="16169" y="-12353.58" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="16169" y="-12338.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="16169" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16169" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_3_EP0_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge500" class="edge">
<title>Layer_6_Expert_3_EP0_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16357.66,-12301.62C16360.46,-12301.33 16363.24,-12301.05 16366,-12300.78 16919,-12247.43 18577.67,-12226.43 19238.7,-12220.04"/>
<polygon fill="black" stroke="black" points="19238.87,-12223.53 19248.84,-12219.94 19238.8,-12216.53 19238.87,-12223.53"/>
</g>
<!-- Layer_6_Expert_4_EP1_TP0_PP1 -->
<g id="node322" class="node">
<title>Layer_6_Expert_4_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16752.5,-12368.78 16375.5,-12368.78 16375.5,-12300.78 16752.5,-12300.78 16752.5,-12368.78"/>
<text text-anchor="middle" x="16564" y="-12353.58" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="16564" y="-12338.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="16564" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16564" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_4_EP1_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge502" class="edge">
<title>Layer_6_Expert_4_EP1_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16752.66,-12301.64C16755.46,-12301.34 16758.24,-12301.05 16761,-12300.78 17235.41,-12254.11 18640.47,-12229.75 19239.47,-12221.25"/>
<polygon fill="black" stroke="black" points="19239.59,-12224.75 19249.54,-12221.11 19239.49,-12217.75 19239.59,-12224.75"/>
</g>
<!-- Layer_6_Expert_4_EP1_TP1_PP1 -->
<g id="node323" class="node">
<title>Layer_6_Expert_4_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17147.5,-12368.78 16770.5,-12368.78 16770.5,-12300.78 17147.5,-12300.78 17147.5,-12368.78"/>
<text text-anchor="middle" x="16959" y="-12353.58" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="16959" y="-12338.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="16959" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16959" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_4_EP1_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge504" class="edge">
<title>Layer_6_Expert_4_EP1_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17147.66,-12301.66C17150.46,-12301.35 17153.24,-12301.06 17156,-12300.78 17552.41,-12260.77 18707.58,-12233.61 19240.18,-12222.86"/>
<polygon fill="black" stroke="black" points="19240.39,-12226.35 19250.31,-12222.65 19240.25,-12219.36 19240.39,-12226.35"/>
</g>
<!-- Layer_6_Expert_5_EP1_TP0_PP1 -->
<g id="node324" class="node">
<title>Layer_6_Expert_5_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17542.5,-12368.78 17165.5,-12368.78 17165.5,-12300.78 17542.5,-12300.78 17542.5,-12368.78"/>
<text text-anchor="middle" x="17354" y="-12353.58" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="17354" y="-12338.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="17354" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17354" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_5_EP1_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge506" class="edge">
<title>Layer_6_Expert_5_EP1_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17542.67,-12301.69C17545.46,-12301.37 17548.24,-12301.07 17551,-12300.78 18150.5,-12238.13 18857.64,-12222.38 19238.53,-12218.64"/>
<polygon fill="black" stroke="black" points="19238.62,-12222.14 19248.59,-12218.54 19238.55,-12215.14 19238.62,-12222.14"/>
</g>
<!-- Layer_6_Expert_5_EP1_TP1_PP1 -->
<g id="node325" class="node">
<title>Layer_6_Expert_5_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17937.5,-12368.78 17560.5,-12368.78 17560.5,-12300.78 17937.5,-12300.78 17937.5,-12368.78"/>
<text text-anchor="middle" x="17749" y="-12353.58" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="17749" y="-12338.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="17749" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17749" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_5_EP1_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge508" class="edge">
<title>Layer_6_Expert_5_EP1_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17937.67,-12301.73C17940.46,-12301.4 17943.24,-12301.08 17946,-12300.78 18397.8,-12251.14 18926.18,-12230.92 19240.04,-12222.85"/>
<polygon fill="black" stroke="black" points="19240.28,-12226.35 19250.18,-12222.59 19240.1,-12219.35 19240.28,-12226.35"/>
</g>
<!-- Layer_6_Expert_6_EP1_TP0_PP1 -->
<g id="node326" class="node">
<title>Layer_6_Expert_6_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18332.5,-12368.78 17955.5,-12368.78 17955.5,-12300.78 18332.5,-12300.78 18332.5,-12368.78"/>
<text text-anchor="middle" x="18144" y="-12353.58" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="18144" y="-12338.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="18144" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18144" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_6_EP1_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge510" class="edge">
<title>Layer_6_Expert_6_EP1_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18332.68,-12301.8C18335.47,-12301.45 18338.25,-12301.11 18341,-12300.78 18650.67,-12263.97 19008.37,-12241.52 19246.77,-12229.39"/>
<polygon fill="black" stroke="black" points="19247.16,-12232.88 19256.97,-12228.88 19246.8,-12225.89 19247.16,-12232.88"/>
</g>
<!-- Layer_6_Expert_6_EP1_TP1_PP1 -->
<g id="node327" class="node">
<title>Layer_6_Expert_6_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18727.5,-12368.78 18350.5,-12368.78 18350.5,-12300.78 18727.5,-12300.78 18727.5,-12368.78"/>
<text text-anchor="middle" x="18539" y="-12353.58" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="18539" y="-12338.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="18539" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18539" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_6_EP1_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge512" class="edge">
<title>Layer_6_Expert_6_EP1_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18727.7,-12301.93C18730.48,-12301.54 18733.25,-12301.16 18736,-12300.78 18913.84,-12276.42 19115.36,-12255.1 19268.87,-12240.15"/>
<polygon fill="black" stroke="black" points="19269.3,-12243.63 19278.91,-12239.18 19268.62,-12236.66 19269.3,-12243.63"/>
</g>
<!-- Layer_6_Expert_7_EP1_TP0_PP1 -->
<g id="node328" class="node">
<title>Layer_6_Expert_7_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19122.5,-12368.78 18745.5,-12368.78 18745.5,-12300.78 19122.5,-12300.78 19122.5,-12368.78"/>
<text text-anchor="middle" x="18934" y="-12353.58" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="18934" y="-12338.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="18934" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18934" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_7_EP1_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge514" class="edge">
<title>Layer_6_Expert_7_EP1_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19099.33,-12300.75C19171,-12286.43 19255.24,-12269.6 19329.07,-12254.84"/>
<polygon fill="black" stroke="black" points="19329.83,-12258.26 19338.95,-12252.87 19328.46,-12251.4 19329.83,-12258.26"/>
</g>
<!-- Layer_6_Expert_7_EP1_TP1_PP1 -->
<g id="node329" class="node">
<title>Layer_6_Expert_7_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19517.5,-12368.78 19140.5,-12368.78 19140.5,-12300.78 19517.5,-12300.78 19517.5,-12368.78"/>
<text text-anchor="middle" x="19329" y="-12353.58" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="19329" y="-12338.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="19329" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19329" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_7_EP1_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge516" class="edge">
<title>Layer_6_Expert_7_EP1_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19382.3,-12300.52C19398.35,-12290.5 19416.35,-12279.27 19433.78,-12268.39"/>
<polygon fill="black" stroke="black" points="19435.65,-12271.34 19442.28,-12263.08 19431.95,-12265.41 19435.65,-12271.34"/>
</g>
<!-- Layer_6_Expert_8_EP2_TP0_PP1 -->
<g id="node330" class="node">
<title>Layer_6_Expert_8_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19912.5,-12368.78 19535.5,-12368.78 19535.5,-12300.78 19912.5,-12300.78 19912.5,-12368.78"/>
<text text-anchor="middle" x="19724" y="-12353.58" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="19724" y="-12338.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="19724" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19724" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_8_EP2_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge518" class="edge">
<title>Layer_6_Expert_8_EP2_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19664.39,-12300.67C19645.79,-12290.34 19624.84,-12278.7 19604.65,-12267.49"/>
<polygon fill="black" stroke="black" points="19606.19,-12264.34 19595.74,-12262.54 19602.79,-12270.46 19606.19,-12264.34"/>
</g>
<!-- Layer_6_Expert_8_EP2_TP1_PP1 -->
<g id="node331" class="node">
<title>Layer_6_Expert_8_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20307.5,-12368.78 19930.5,-12368.78 19930.5,-12300.78 20307.5,-12300.78 20307.5,-12368.78"/>
<text text-anchor="middle" x="20119" y="-12353.58" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="20119" y="-12338.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="20119" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20119" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_8_EP2_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge520" class="edge">
<title>Layer_6_Expert_8_EP2_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19947.13,-12300.75C19871.47,-12286.21 19782.33,-12269.07 19704.72,-12254.16"/>
<polygon fill="black" stroke="black" points="19705.31,-12250.71 19694.83,-12252.26 19703.99,-12257.58 19705.31,-12250.71"/>
</g>
<!-- Layer_6_Expert_9_EP2_TP0_PP1 -->
<g id="node332" class="node">
<title>Layer_6_Expert_9_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20702.5,-12368.78 20325.5,-12368.78 20325.5,-12300.78 20702.5,-12300.78 20702.5,-12368.78"/>
<text text-anchor="middle" x="20514" y="-12353.58" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="20514" y="-12338.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="20514" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20514" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_9_EP2_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge522" class="edge">
<title>Layer_6_Expert_9_EP2_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20325.4,-12302.07C20322.24,-12301.63 20319.11,-12301.2 20316,-12300.78 20131.28,-12275.83 19921.71,-12254.33 19763.28,-12239.46"/>
<polygon fill="black" stroke="black" points="19763.2,-12235.94 19752.91,-12238.49 19762.54,-12242.91 19763.2,-12235.94"/>
</g>
<!-- Layer_6_Expert_9_EP2_TP1_PP1 -->
<g id="node333" class="node">
<title>Layer_6_Expert_9_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21097.5,-12368.78 20720.5,-12368.78 20720.5,-12300.78 21097.5,-12300.78 21097.5,-12368.78"/>
<text text-anchor="middle" x="20909" y="-12353.58" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="20909" y="-12338.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="20909" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20909" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_9_EP2_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge524" class="edge">
<title>Layer_6_Expert_9_EP2_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20720.42,-12301.92C20717.26,-12301.53 20714.11,-12301.15 20711,-12300.78 20393.45,-12263.37 20026.34,-12240.94 19783.49,-12228.99"/>
<polygon fill="black" stroke="black" points="19783.62,-12225.49 19773.46,-12228.49 19783.28,-12232.48 19783.62,-12225.49"/>
</g>
<!-- Layer_6_Expert_10_EP2_TP0_PP1 -->
<g id="node334" class="node">
<title>Layer_6_Expert_10_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21492.5,-12368.78 21115.5,-12368.78 21115.5,-12300.78 21492.5,-12300.78 21492.5,-12368.78"/>
<text text-anchor="middle" x="21304" y="-12353.58" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="21304" y="-12338.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="21304" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21304" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_10_EP2_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge526" class="edge">
<title>Layer_6_Expert_10_EP2_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21115.42,-12301.85C21112.26,-12301.48 21109.12,-12301.12 21106,-12300.78 20646.14,-12250.61 20108.08,-12230.53 19790.28,-12222.64"/>
<polygon fill="black" stroke="black" points="19790.09,-12219.14 19780,-12222.39 19789.91,-12226.13 19790.09,-12219.14"/>
</g>
<!-- Layer_6_Expert_10_EP2_TP1_PP1 -->
<g id="node335" class="node">
<title>Layer_6_Expert_10_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21887.5,-12368.78 21510.5,-12368.78 21510.5,-12300.78 21887.5,-12300.78 21887.5,-12368.78"/>
<text text-anchor="middle" x="21699" y="-12353.58" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="21699" y="-12338.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="21699" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21699" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_10_EP2_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge528" class="edge">
<title>Layer_6_Expert_10_EP2_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21510.43,-12301.8C21507.26,-12301.45 21504.12,-12301.1 21501,-12300.78 20893.26,-12237.67 20176.19,-12222.11 19791.72,-12218.52"/>
<polygon fill="black" stroke="black" points="19791.61,-12215.02 19781.58,-12218.43 19791.54,-12222.02 19791.61,-12215.02"/>
</g>
<!-- Layer_6_Expert_11_EP2_TP0_PP1 -->
<g id="node336" class="node">
<title>Layer_6_Expert_11_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22282.5,-12368.78 21905.5,-12368.78 21905.5,-12300.78 22282.5,-12300.78 22282.5,-12368.78"/>
<text text-anchor="middle" x="22094" y="-12353.58" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="22094" y="-12338.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="22094" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22094" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_11_EP2_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge530" class="edge">
<title>Layer_6_Expert_11_EP2_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21905.43,-12301.77C21902.27,-12301.42 21899.12,-12301.09 21896,-12300.78 21495.24,-12260.56 20326.21,-12233.45 19789.8,-12222.78"/>
<polygon fill="black" stroke="black" points="19789.67,-12219.28 19779.6,-12222.58 19789.53,-12226.28 19789.67,-12219.28"/>
</g>
<!-- Layer_6_Expert_11_EP2_TP1_PP1 -->
<g id="node337" class="node">
<title>Layer_6_Expert_11_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22677.5,-12368.78 22300.5,-12368.78 22300.5,-12300.78 22677.5,-12300.78 22677.5,-12368.78"/>
<text text-anchor="middle" x="22489" y="-12353.58" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="22489" y="-12338.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="22489" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22489" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_11_EP2_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge532" class="edge">
<title>Layer_6_Expert_11_EP2_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22300.43,-12301.75C22297.27,-12301.41 22294.12,-12301.09 22291,-12300.78 21812.26,-12253.94 20393.42,-12229.64 19790.75,-12221.2"/>
<polygon fill="black" stroke="black" points="19790.67,-12217.7 19780.62,-12221.06 19790.57,-12224.7 19790.67,-12217.7"/>
</g>
<!-- Layer_6_Expert_12_EP3_TP0_PP1 -->
<g id="node338" class="node">
<title>Layer_6_Expert_12_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23072.5,-12368.78 22695.5,-12368.78 22695.5,-12300.78 23072.5,-12300.78 23072.5,-12368.78"/>
<text text-anchor="middle" x="22884" y="-12353.58" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="22884" y="-12338.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="22884" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22884" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_12_EP3_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge534" class="edge">
<title>Layer_6_Expert_12_EP3_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22695.44,-12301.74C22692.27,-12301.4 22689.12,-12301.08 22686,-12300.78 22128.6,-12247.29 20455.8,-12226.35 19791.4,-12220.01"/>
<polygon fill="black" stroke="black" points="19791.24,-12216.5 19781.21,-12219.91 19791.18,-12223.5 19791.24,-12216.5"/>
</g>
<!-- Layer_6_Expert_12_EP3_TP1_PP1 -->
<g id="node339" class="node">
<title>Layer_6_Expert_12_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23467.5,-12368.78 23090.5,-12368.78 23090.5,-12300.78 23467.5,-12300.78 23467.5,-12368.78"/>
<text text-anchor="middle" x="23279" y="-12353.58" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="23279" y="-12338.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="23279" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23279" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_12_EP3_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge536" class="edge">
<title>Layer_6_Expert_12_EP3_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23090.44,-12301.72C23087.27,-12301.39 23084.12,-12301.07 23081,-12300.78 22444.23,-12240.6 20513.26,-12223.45 19791.3,-12219.06"/>
<polygon fill="black" stroke="black" points="19791.3,-12215.56 19781.28,-12219 19791.26,-12222.56 19791.3,-12215.56"/>
</g>
<!-- Layer_6_Expert_13_EP3_TP0_PP1 -->
<g id="node340" class="node">
<title>Layer_6_Expert_13_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23862.5,-12368.78 23485.5,-12368.78 23485.5,-12300.78 23862.5,-12300.78 23862.5,-12368.78"/>
<text text-anchor="middle" x="23674" y="-12353.58" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="23674" y="-12338.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="23674" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23674" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_13_EP3_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge538" class="edge">
<title>Layer_6_Expert_13_EP3_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23485.44,-12301.71C23482.27,-12301.38 23479.12,-12301.07 23476,-12300.78 22759.64,-12233.92 20568.91,-12220.85 19791.89,-12218.31"/>
<polygon fill="black" stroke="black" points="19791.7,-12214.81 19781.69,-12218.28 19791.68,-12221.81 19791.7,-12214.81"/>
</g>
<!-- Layer_6_Expert_13_EP3_TP1_PP1 -->
<g id="node341" class="node">
<title>Layer_6_Expert_13_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24257.5,-12368.78 23880.5,-12368.78 23880.5,-12300.78 24257.5,-12300.78 24257.5,-12368.78"/>
<text text-anchor="middle" x="24069" y="-12353.58" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="24069" y="-12338.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="24069" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24069" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_13_EP3_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge540" class="edge">
<title>Layer_6_Expert_13_EP3_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23880.44,-12301.71C23877.27,-12301.38 23874.12,-12301.07 23871,-12300.78 23074.54,-12227.21 20621.01,-12218.49 19791.98,-12217.69"/>
<polygon fill="black" stroke="black" points="19791.7,-12214.19 19781.7,-12217.68 19791.7,-12221.19 19791.7,-12214.19"/>
</g>
<!-- Layer_6_Expert_14_EP3_TP0_PP1 -->
<g id="node342" class="node">
<title>Layer_6_Expert_14_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24652.5,-12368.78 24275.5,-12368.78 24275.5,-12300.78 24652.5,-12300.78 24652.5,-12368.78"/>
<text text-anchor="middle" x="24464" y="-12353.58" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="24464" y="-12338.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="24464" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24464" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_14_EP3_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge542" class="edge">
<title>Layer_6_Expert_14_EP3_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24275.44,-12301.7C24272.27,-12301.37 24269.12,-12301.07 24266,-12300.78 23389.13,-12220.48 20670.98,-12216.33 19792.15,-12217.17"/>
<polygon fill="black" stroke="black" points="19791.89,-12213.67 19781.89,-12217.18 19791.9,-12220.67 19791.89,-12213.67"/>
</g>
<!-- Layer_6_Expert_14_EP3_TP1_PP1 -->
<g id="node343" class="node">
<title>Layer_6_Expert_14_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25047.5,-12368.78 24670.5,-12368.78 24670.5,-12300.78 25047.5,-12300.78 25047.5,-12368.78"/>
<text text-anchor="middle" x="24859" y="-12353.58" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="24859" y="-12338.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="24859" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24859" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_14_EP3_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge544" class="edge">
<title>Layer_6_Expert_14_EP3_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24670.44,-12301.69C24667.27,-12301.37 24664.12,-12301.06 24661,-12300.78 24176.37,-12256.73 20790.13,-12227.49 19791.54,-12219.75"/>
<polygon fill="black" stroke="black" points="19791.38,-12216.25 19781.35,-12219.67 19791.33,-12223.25 19791.38,-12216.25"/>
</g>
<!-- Layer_6_Expert_15_EP3_TP0_PP1 -->
<g id="node344" class="node">
<title>Layer_6_Expert_15_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25442.5,-12368.78 25065.5,-12368.78 25065.5,-12300.78 25442.5,-12300.78 25442.5,-12368.78"/>
<text text-anchor="middle" x="25254" y="-12353.58" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="25254" y="-12338.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="25254" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25254" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_15_EP3_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge546" class="edge">
<title>Layer_6_Expert_15_EP3_TP0_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M25065.44,-12301.69C25062.27,-12301.37 25059.12,-12301.06 25056,-12300.78 24530.66,-12253.33 20839.01,-12226.21 19791.51,-12219.4"/>
<polygon fill="black" stroke="black" points="19791.23,-12215.9 19781.2,-12219.34 19791.18,-12222.9 19791.23,-12215.9"/>
</g>
<!-- Layer_6_Expert_15_EP3_TP1_PP1 -->
<g id="node345" class="node">
<title>Layer_6_Expert_15_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25837.5,-12368.78 25460.5,-12368.78 25460.5,-12300.78 25837.5,-12300.78 25837.5,-12368.78"/>
<text text-anchor="middle" x="25649" y="-12353.58" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="25649" y="-12338.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="25649" y="-12323.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25649" y="-12308.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_Expert_15_EP3_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1 -->
<g id="edge548" class="edge">
<title>Layer_6_Expert_15_EP3_TP1_PP1&#45;&gt;Layer_6_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M25460.44,-12301.68C25457.27,-12301.36 25454.12,-12301.06 25451,-12300.78 24884.93,-12249.94 20887.36,-12225.03 19791.97,-12219.11"/>
<polygon fill="black" stroke="black" points="19791.61,-12215.61 19781.59,-12219.05 19791.57,-12222.61 19791.61,-12215.61"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_0_EP0_TP0_PP1 -->
<g id="edge485" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_0_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19098.53,-12450.4C18044.63,-12444.29 14196.53,-12418.83 13602.81,-12368.87"/>
<polygon fill="black" stroke="black" points="13602.92,-12365.36 13592.66,-12367.98 13602.31,-12372.34 13602.92,-12365.36"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_0_EP0_TP1_PP1 -->
<g id="edge487" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_0_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19098.46,-12450.1C18091.79,-12443.1 14550.59,-12415.46 13997.88,-12368.87"/>
<polygon fill="black" stroke="black" points="13997.92,-12365.36 13987.66,-12367.98 13997.31,-12372.34 13997.92,-12365.36"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_1_EP0_TP0_PP1 -->
<g id="edge489" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_1_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19098.9,-12449.75C18141.8,-12441.81 14904.28,-12412.11 14392.83,-12368.87"/>
<polygon fill="black" stroke="black" points="14392.93,-12365.36 14382.66,-12367.97 14392.31,-12372.34 14392.93,-12365.36"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_1_EP0_TP1_PP1 -->
<g id="edge491" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_1_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19098.18,-12452.21C18254.76,-12452.47 15651.62,-12446.85 14787.74,-12368.89"/>
<polygon fill="black" stroke="black" points="14787.93,-12365.39 14777.66,-12367.97 14787.3,-12372.36 14787.93,-12365.39"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_2_EP0_TP0_PP1 -->
<g id="edge493" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_2_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19098.32,-12451.67C18304.8,-12450.27 15965.87,-12440.13 15182.65,-12368.88"/>
<polygon fill="black" stroke="black" points="15182.94,-12365.39 15172.66,-12367.96 15182.29,-12372.36 15182.94,-12365.39"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_2_EP0_TP1_PP1 -->
<g id="edge495" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_2_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19098.31,-12451.01C18356.97,-12447.86 16280.55,-12433.43 15577.65,-12368.88"/>
<polygon fill="black" stroke="black" points="15577.94,-12365.39 15567.66,-12367.95 15577.29,-12372.36 15577.94,-12365.39"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_3_EP0_TP0_PP1 -->
<g id="edge497" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_3_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19098.52,-12450.21C18412.35,-12445.19 16595.64,-12426.76 15972.65,-12368.88"/>
<polygon fill="black" stroke="black" points="15972.94,-12365.4 15962.66,-12367.94 15972.29,-12372.37 15972.94,-12365.4"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_3_EP0_TP1_PP1 -->
<g id="edge499" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_3_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19099.09,-12449.21C18471.71,-12442.2 16911.84,-12420.14 16367.96,-12368.92"/>
<polygon fill="black" stroke="black" points="16367.95,-12365.4 16357.66,-12367.93 16367.28,-12372.37 16367.95,-12365.4"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_4_EP1_TP0_PP1 -->
<g id="edge501" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_4_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19099.67,-12447.92C18534.78,-12438.78 17227.62,-12413.55 16762.81,-12368.91"/>
<polygon fill="black" stroke="black" points="16762.96,-12365.4 16752.66,-12367.91 16762.27,-12372.37 16762.96,-12365.4"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_4_EP1_TP1_PP1 -->
<g id="edge503" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_4_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19100.83,-12446.18C18603.52,-12434.79 17544.33,-12407.01 17157.79,-12368.91"/>
<polygon fill="black" stroke="black" points="17157.96,-12365.41 17147.66,-12367.89 17157.27,-12372.37 17157.96,-12365.41"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_5_EP1_TP0_PP1 -->
<g id="edge505" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_5_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19098.74,-12449.67C18746.63,-12444.49 18106.9,-12427.23 17552.87,-12368.94"/>
<polygon fill="black" stroke="black" points="17552.98,-12365.43 17542.67,-12367.86 17552.24,-12372.39 17552.98,-12365.43"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_5_EP1_TP1_PP1 -->
<g id="edge507" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_5_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19101.77,-12444.91C18818.71,-12435.48 18355.47,-12414.41 17947.9,-12368.96"/>
<polygon fill="black" stroke="black" points="17948,-12365.45 17937.67,-12367.81 17947.22,-12372.4 17948,-12365.45"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_6_EP1_TP0_PP1 -->
<g id="edge509" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_6_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19112.42,-12437.37C18907.43,-12424.19 18610.83,-12401.89 18343,-12369"/>
<polygon fill="black" stroke="black" points="18343.04,-12365.48 18332.68,-12367.72 18342.18,-12372.42 18343.04,-12365.48"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_6_EP1_TP1_PP1 -->
<g id="edge511" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_6_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19147.5,-12425.02C19029.09,-12409.94 18879.76,-12390.18 18737.91,-12369.05"/>
<polygon fill="black" stroke="black" points="18738.12,-12365.54 18727.71,-12367.53 18737.08,-12372.47 18738.12,-12365.54"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_7_EP1_TP0_PP1 -->
<g id="edge513" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_7_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19219.08,-12412.56C19169.73,-12399.27 19114.93,-12384.51 19066.66,-12371.51"/>
<polygon fill="black" stroke="black" points="19067.35,-12368.07 19056.79,-12368.85 19065.53,-12374.83 19067.35,-12368.07"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_7_EP1_TP1_PP1 -->
<g id="edge515" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_7_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19350.36,-12404.65C19347.7,-12396.08 19344.94,-12387.18 19342.32,-12378.74"/>
<polygon fill="black" stroke="black" points="19345.63,-12377.6 19339.33,-12369.08 19338.95,-12379.67 19345.63,-12377.6"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_8_EP2_TP0_PP1 -->
<g id="edge517" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_8_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19492.58,-12410.61C19531.69,-12397.96 19574.4,-12384.15 19612.36,-12371.88"/>
<polygon fill="black" stroke="black" points="19613.46,-12375.2 19621.9,-12368.79 19611.31,-12368.54 19613.46,-12375.2"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_8_EP2_TP1_PP1 -->
<g id="edge519" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_8_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19570.1,-12422.06C19672.34,-12406.99 19798.12,-12388.14 19920.44,-12368.86"/>
<polygon fill="black" stroke="black" points="19921.04,-12372.31 19930.37,-12367.29 19919.95,-12365.4 19921.04,-12372.31"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_9_EP2_TP0_PP1 -->
<g id="edge521" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_9_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19613.86,-12435.46C19803.42,-12421.69 20070.99,-12399.53 20315.26,-12368.84"/>
<polygon fill="black" stroke="black" points="20315.92,-12372.28 20325.41,-12367.56 20315.05,-12365.34 20315.92,-12372.28"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_9_EP2_TP1_PP1 -->
<g id="edge523" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_9_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19626.88,-12443.72C19896.24,-12433.49 20327.94,-12411.92 20710.26,-12368.82"/>
<polygon fill="black" stroke="black" points="20710.88,-12372.27 20720.42,-12367.67 20710.09,-12365.32 20710.88,-12372.27"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_10_EP2_TP0_PP1 -->
<g id="edge525" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_10_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19630.84,-12448.87C19970.77,-12442.83 20577.51,-12424.64 21105.32,-12368.8"/>
<polygon fill="black" stroke="black" points="21105.85,-12372.27 21115.43,-12367.73 21105.11,-12365.31 21105.85,-12372.27"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_10_EP2_TP1_PP1 -->
<g id="edge527" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_10_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19631.74,-12452.28C20034.79,-12450.48 20822.96,-12437.52 21500.47,-12368.78"/>
<polygon fill="black" stroke="black" points="21500.84,-12372.26 21510.43,-12367.77 21500.13,-12365.3 21500.84,-12372.26"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_11_EP2_TP0_PP1 -->
<g id="edge529" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_11_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19630.24,-12447.61C20183.08,-12438.01 21443.88,-12412.16 21895.25,-12368.79"/>
<polygon fill="black" stroke="black" points="21895.82,-12372.25 21905.43,-12367.79 21895.14,-12365.28 21895.82,-12372.25"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_11_EP2_TP1_PP1 -->
<g id="edge531" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_11_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19630.73,-12448.97C20246.92,-12441.52 21760.28,-12418.71 22290.4,-12368.77"/>
<polygon fill="black" stroke="black" points="22290.81,-12372.25 22300.44,-12367.81 22290.15,-12365.28 22290.81,-12372.25"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_12_EP3_TP0_PP1 -->
<g id="edge533" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_12_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19631.29,-12450.02C20306.74,-12444.57 22075.61,-12425.3 22685.22,-12368.79"/>
<polygon fill="black" stroke="black" points="22685.81,-12372.25 22695.44,-12367.83 22685.15,-12365.28 22685.81,-12372.25"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_12_EP3_TP1_PP1 -->
<g id="edge535" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_12_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19631.49,-12450.85C20362.69,-12447.29 22391.09,-12431.93 23080.39,-12368.77"/>
<polygon fill="black" stroke="black" points="23080.8,-12372.25 23090.44,-12367.84 23080.16,-12365.28 23080.8,-12372.25"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_13_EP3_TP0_PP1 -->
<g id="edge537" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_13_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19631.56,-12451.53C20415.47,-12449.74 22705.75,-12438.59 23475.34,-12368.78"/>
<polygon fill="black" stroke="black" points="23475.8,-12372.25 23485.44,-12367.85 23475.16,-12365.28 23475.8,-12372.25"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_13_EP3_TP1_PP1 -->
<g id="edge539" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_13_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19631.61,-12452.08C20465.71,-12451.97 23019.93,-12445.27 23870.21,-12368.79"/>
<polygon fill="black" stroke="black" points="23870.8,-12372.25 23880.44,-12367.86 23870.16,-12365.28 23870.8,-12372.25"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_14_EP3_TP0_PP1 -->
<g id="edge541" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_14_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19631.76,-12452.55C20514.08,-12454.02 23334.22,-12451.97 24265.25,-12368.78"/>
<polygon fill="black" stroke="black" points="24265.8,-12372.25 24275.44,-12367.86 24265.17,-12365.28 24265.8,-12372.25"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_14_EP3_TP1_PP1 -->
<g id="edge543" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_14_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19631.34,-12450.02C20628.91,-12442.81 24114.6,-12414.63 24660.34,-12368.75"/>
<polygon fill="black" stroke="black" points="24660.78,-12372.23 24670.44,-12367.87 24660.17,-12365.25 24660.78,-12372.23"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_15_EP3_TP0_PP1 -->
<g id="edge545" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_15_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19631.22,-12450.34C20676.22,-12444.02 24468.62,-12417.98 25055.4,-12368.75"/>
<polygon fill="black" stroke="black" points="25055.78,-12372.23 25065.44,-12367.87 25055.18,-12365.25 25055.78,-12372.23"/>
</g>
<!-- Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_15_EP3_TP1_PP1 -->
<g id="edge547" class="edge">
<title>Layer_6_A2A_Dispatch_PP1&#45;&gt;Layer_6_Expert_15_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19631.33,-12450.61C20722.26,-12445.14 24821.15,-12421.35 25450.12,-12368.77"/>
<polygon fill="black" stroke="black" points="25450.78,-12372.23 25460.44,-12367.88 25450.18,-12365.25 25450.78,-12372.23"/>
</g>
<!-- Layer_6_MLP_Out_TP0_PP1 -->
<g id="node348" class="node">
<title>Layer_6_MLP_Out_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19653.5,-12132.61 19276.5,-12132.61 19276.5,-12064.61 19653.5,-12064.61 19653.5,-12132.61"/>
<text text-anchor="middle" x="19465" y="-12117.41" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="19465" y="-12102.41" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19465" y="-12087.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19465" y="-12072.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_A2A_Combine_PP1&#45;&gt;Layer_6_MLP_Out_TP0_PP1 -->
<g id="edge549" class="edge">
<title>Layer_6_A2A_Combine_PP1&#45;&gt;Layer_6_MLP_Out_TP0_PP1</title>
<path fill="none" stroke="black" d="M19494.66,-12168.48C19490.93,-12159.82 19487.05,-12150.82 19483.38,-12142.29"/>
<polygon fill="black" stroke="black" points="19486.52,-12140.72 19479.34,-12132.92 19480.09,-12143.49 19486.52,-12140.72"/>
</g>
<!-- Layer_6_MLP_Out_TP1_PP1 -->
<g id="node349" class="node">
<title>Layer_6_MLP_Out_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="20048.5,-12132.61 19671.5,-12132.61 19671.5,-12064.61 20048.5,-12064.61 20048.5,-12132.61"/>
<text text-anchor="middle" x="19860" y="-12117.41" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="19860" y="-12102.41" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19860" y="-12087.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19860" y="-12072.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_6_A2A_Combine_PP1&#45;&gt;Layer_6_MLP_Out_TP1_PP1 -->
<g id="edge551" class="edge">
<title>Layer_6_A2A_Combine_PP1&#45;&gt;Layer_6_MLP_Out_TP1_PP1</title>
<path fill="none" stroke="black" d="M19639.07,-12173.95C19676.13,-12161.48 19716.44,-12147.92 19752.35,-12135.83"/>
<polygon fill="black" stroke="black" points="19753.51,-12139.14 19761.87,-12132.63 19751.28,-12132.5 19753.51,-12139.14"/>
</g>
<!-- Layer_6_MLP_AllReduce_PP1 -->
<g id="node350" class="node">
<title>Layer_6_MLP_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19708" cy="-11980.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19708" y="-11999.33" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="19708" y="-11984.33" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19708" y="-11969.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19708" y="-11954.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_6_MLP_Out_TP0_PP1&#45;&gt;Layer_6_MLP_AllReduce_PP1 -->
<g id="edge550" class="edge">
<title>Layer_6_MLP_Out_TP0_PP1&#45;&gt;Layer_6_MLP_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19534.31,-12064.5C19556.7,-12053.81 19582.01,-12041.72 19606.24,-12030.14"/>
<polygon fill="black" stroke="black" points="19607.95,-12033.2 19615.47,-12025.73 19604.94,-12026.89 19607.95,-12033.2"/>
</g>
<!-- Layer_6_MLP_Out_TP1_PP1&#45;&gt;Layer_6_MLP_AllReduce_PP1 -->
<g id="edge552" class="edge">
<title>Layer_6_MLP_Out_TP1_PP1&#45;&gt;Layer_6_MLP_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19816.44,-12064.35C19803.9,-12054.77 19789.91,-12044.09 19776.26,-12033.66"/>
<polygon fill="black" stroke="black" points="19778.34,-12030.85 19768.27,-12027.56 19774.09,-12036.41 19778.34,-12030.85"/>
</g>
<!-- Layer_6_LayerNorm_PP1 -->
<g id="node351" class="node">
<title>Layer_6_LayerNorm_PP1</title>
<polygon fill="lightgreen" stroke="black" points="19896.5,-11896.45 19519.5,-11896.45 19519.5,-11828.45 19896.5,-11828.45 19896.5,-11896.45"/>
<text text-anchor="middle" x="19708" y="-11881.25" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19708" y="-11866.25" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19708" y="-11851.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19708" y="-11836.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_6_MLP_AllReduce_PP1&#45;&gt;Layer_6_LayerNorm_PP1 -->
<g id="edge553" class="edge">
<title>Layer_6_MLP_AllReduce_PP1&#45;&gt;Layer_6_LayerNorm_PP1</title>
<path fill="none" stroke="black" d="M19708,-11932.31C19708,-11923.93 19708,-11915.23 19708,-11906.95"/>
<polygon fill="black" stroke="black" points="19711.5,-11906.75 19708,-11896.75 19704.5,-11906.75 19711.5,-11906.75"/>
</g>
<!-- Layer_7_QKV_TP0_PP1 -->
<g id="node352" class="node">
<title>Layer_7_QKV_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19898.5,-11792.45 19517.5,-11792.45 19517.5,-11724.45 19898.5,-11724.45 19898.5,-11792.45"/>
<text text-anchor="middle" x="19708" y="-11777.25" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19708" y="-11762.25" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19708" y="-11747.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19708" y="-11732.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_6_LayerNorm_PP1&#45;&gt;Layer_7_QKV_TP0_PP1 -->
<g id="edge554" class="edge">
<title>Layer_6_LayerNorm_PP1&#45;&gt;Layer_7_QKV_TP0_PP1</title>
<path fill="none" stroke="black" d="M19708,-11828.33C19708,-11820.22 19708,-11811.43 19708,-11802.92"/>
<polygon fill="black" stroke="black" points="19711.5,-11802.75 19708,-11792.75 19704.5,-11802.75 19711.5,-11802.75"/>
</g>
<!-- Layer_7_QKV_AllReduce_PP1 -->
<g id="node354" class="node">
<title>Layer_7_QKV_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19555" cy="-11640.36" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="19555" y="-11659.16" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="19555" y="-11644.16" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19555" y="-11629.16" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19555" y="-11614.16" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_7_QKV_TP0_PP1&#45;&gt;Layer_7_QKV_AllReduce_PP1 -->
<g id="edge555" class="edge">
<title>Layer_7_QKV_TP0_PP1&#45;&gt;Layer_7_QKV_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19664.16,-11724.18C19651.53,-11714.61 19637.45,-11703.92 19623.71,-11693.49"/>
<polygon fill="black" stroke="black" points="19625.75,-11690.65 19615.67,-11687.39 19621.52,-11696.23 19625.75,-11690.65"/>
</g>
<!-- Layer_7_QKV_TP1_PP1 -->
<g id="node353" class="node">
<title>Layer_7_QKV_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="19499.5,-11792.45 19118.5,-11792.45 19118.5,-11724.45 19499.5,-11724.45 19499.5,-11792.45"/>
<text text-anchor="middle" x="19309" y="-11777.25" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19309" y="-11762.25" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19309" y="-11747.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19309" y="-11732.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_7_QKV_TP1_PP1&#45;&gt;Layer_7_QKV_AllReduce_PP1 -->
<g id="edge559" class="edge">
<title>Layer_7_QKV_TP1_PP1&#45;&gt;Layer_7_QKV_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19379.16,-11724.34C19401.71,-11713.7 19427.17,-11701.68 19451.58,-11690.17"/>
<polygon fill="black" stroke="black" points="19453.32,-11693.21 19460.87,-11685.78 19450.33,-11686.88 19453.32,-11693.21"/>
</g>
<!-- Layer_7_Attention_TP0_PP1 -->
<g id="node355" class="node">
<title>Layer_7_Attention_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19439.5,-11556.28 19058.5,-11556.28 19058.5,-11488.28 19439.5,-11488.28 19439.5,-11556.28"/>
<text text-anchor="middle" x="19249" y="-11541.08" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="19249" y="-11526.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19249" y="-11511.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19249" y="-11496.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_7_QKV_AllReduce_PP1&#45;&gt;Layer_7_Attention_TP0_PP1 -->
<g id="edge556" class="edge">
<title>Layer_7_QKV_AllReduce_PP1&#45;&gt;Layer_7_Attention_TP0_PP1</title>
<path fill="none" stroke="black" d="M19441.93,-11596.47C19410.3,-11584.47 19376.22,-11571.54 19345.64,-11559.94"/>
<polygon fill="black" stroke="black" points="19346.85,-11556.66 19336.26,-11556.38 19344.37,-11563.2 19346.85,-11556.66"/>
</g>
<!-- Layer_7_Attention_TP1_PP1 -->
<g id="node356" class="node">
<title>Layer_7_Attention_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="19838.5,-11556.28 19457.5,-11556.28 19457.5,-11488.28 19838.5,-11488.28 19838.5,-11556.28"/>
<text text-anchor="middle" x="19648" y="-11541.08" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="19648" y="-11526.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19648" y="-11511.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19648" y="-11496.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_7_QKV_AllReduce_PP1&#45;&gt;Layer_7_Attention_TP1_PP1 -->
<g id="edge560" class="edge">
<title>Layer_7_QKV_AllReduce_PP1&#45;&gt;Layer_7_Attention_TP1_PP1</title>
<path fill="none" stroke="black" d="M19592.56,-11592.48C19600.04,-11583.14 19607.85,-11573.39 19615.16,-11564.27"/>
<polygon fill="black" stroke="black" points="19617.92,-11566.42 19621.44,-11556.43 19612.46,-11562.04 19617.92,-11566.42"/>
</g>
<!-- Layer_7_AttnOut_TP0_PP1 -->
<g id="node357" class="node">
<title>Layer_7_AttnOut_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19438.5,-11452.28 19061.5,-11452.28 19061.5,-11384.28 19438.5,-11384.28 19438.5,-11452.28"/>
<text text-anchor="middle" x="19250" y="-11437.08" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="19250" y="-11422.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19250" y="-11407.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19250" y="-11392.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Attention_TP0_PP1&#45;&gt;Layer_7_AttnOut_TP0_PP1 -->
<g id="edge557" class="edge">
<title>Layer_7_Attention_TP0_PP1&#45;&gt;Layer_7_AttnOut_TP0_PP1</title>
<path fill="none" stroke="black" d="M19249.32,-11488.16C19249.4,-11480.06 19249.49,-11471.26 19249.57,-11462.75"/>
<polygon fill="black" stroke="black" points="19253.08,-11462.61 19249.67,-11452.58 19246.08,-11462.54 19253.08,-11462.61"/>
</g>
<!-- Layer_7_AttnOut_TP1_PP1 -->
<g id="node358" class="node">
<title>Layer_7_AttnOut_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="19835.5,-11452.28 19458.5,-11452.28 19458.5,-11384.28 19835.5,-11384.28 19835.5,-11452.28"/>
<text text-anchor="middle" x="19647" y="-11437.08" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="19647" y="-11422.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19647" y="-11407.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19647" y="-11392.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Attention_TP1_PP1&#45;&gt;Layer_7_AttnOut_TP1_PP1 -->
<g id="edge561" class="edge">
<title>Layer_7_Attention_TP1_PP1&#45;&gt;Layer_7_AttnOut_TP1_PP1</title>
<path fill="none" stroke="black" d="M19647.68,-11488.16C19647.6,-11480.06 19647.51,-11471.26 19647.43,-11462.75"/>
<polygon fill="black" stroke="black" points="19650.92,-11462.54 19647.33,-11452.58 19643.92,-11462.61 19650.92,-11462.54"/>
</g>
<!-- Layer_7_AttnOut_AllReduce_PP1 -->
<g id="node359" class="node">
<title>Layer_7_AttnOut_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19450" cy="-11300.2" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19450" y="-11319" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="19450" y="-11304" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19450" y="-11289" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19450" y="-11274" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_7_AttnOut_TP0_PP1&#45;&gt;Layer_7_AttnOut_AllReduce_PP1 -->
<g id="edge558" class="edge">
<title>Layer_7_AttnOut_TP0_PP1&#45;&gt;Layer_7_AttnOut_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19307.04,-11384.17C19324.67,-11373.94 19344.49,-11362.44 19363.63,-11351.33"/>
<polygon fill="black" stroke="black" points="19365.47,-11354.31 19372.36,-11346.26 19361.96,-11348.25 19365.47,-11354.31"/>
</g>
<!-- Layer_7_AttnOut_TP1_PP1&#45;&gt;Layer_7_AttnOut_AllReduce_PP1 -->
<g id="edge562" class="edge">
<title>Layer_7_AttnOut_TP1_PP1&#45;&gt;Layer_7_AttnOut_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19590.81,-11384.17C19573.53,-11373.99 19554.11,-11362.54 19535.33,-11351.48"/>
<polygon fill="black" stroke="black" points="19536.87,-11348.32 19526.47,-11346.26 19533.31,-11354.35 19536.87,-11348.32"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1 -->
<g id="node396" class="node">
<title>Layer_7_A2A_Dispatch_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19450" cy="-11168.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19450" y="-11186.83" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="19450" y="-11171.83" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19450" y="-11156.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19450" y="-11141.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_7_AttnOut_AllReduce_PP1&#45;&gt;Layer_7_A2A_Dispatch_PP1 -->
<g id="edge563" class="edge">
<title>Layer_7_AttnOut_AllReduce_PP1&#45;&gt;Layer_7_A2A_Dispatch_PP1</title>
<path fill="none" stroke="black" d="M19450,-11251.84C19450,-11243.57 19450,-11234.89 19450,-11226.38"/>
<polygon fill="black" stroke="black" points="19453.5,-11226.14 19450,-11216.14 19446.5,-11226.14 19453.5,-11226.14"/>
</g>
<!-- Layer_7_Gate_EP0_PP1 -->
<g id="node360" class="node">
<title>Layer_7_Gate_EP0_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16300.4,-15714.94 15696.86,-15714.94 15541.6,-15578.94 16145.14,-15578.94 16300.4,-15714.94"/>
<text text-anchor="middle" x="15921" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="15921" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="15921" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15921" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_7_Gate_EP1_PP1 -->
<g id="node361" class="node">
<title>Layer_7_Gate_EP1_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15523.4,-15714.94 14919.86,-15714.94 14764.6,-15578.94 15368.14,-15578.94 15523.4,-15714.94"/>
<text text-anchor="middle" x="15144" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="15144" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="15144" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15144" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_7_Gate_EP2_PP1 -->
<g id="node362" class="node">
<title>Layer_7_Gate_EP2_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="14746.4,-15714.94 14142.86,-15714.94 13987.6,-15578.94 14591.14,-15578.94 14746.4,-15714.94"/>
<text text-anchor="middle" x="14367" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="14367" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="14367" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14367" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_7_Gate_EP3_PP1 -->
<g id="node363" class="node">
<title>Layer_7_Gate_EP3_PP1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="13969.4,-15714.94 13365.86,-15714.94 13210.6,-15578.94 13814.14,-15578.94 13969.4,-15714.94"/>
<text text-anchor="middle" x="13590" y="-15665.74" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="13590" y="-15650.74" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="13590" y="-15635.74" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13590" y="-15620.74" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_7_Expert_0_EP0_TP0_PP1 -->
<g id="node364" class="node">
<title>Layer_7_Expert_0_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="13688.5,-11083.95 13311.5,-11083.95 13311.5,-11015.95 13688.5,-11015.95 13688.5,-11083.95"/>
<text text-anchor="middle" x="13500" y="-11068.75" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13500" y="-11053.75" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="13500" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13500" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_A2A_Combine_PP1 -->
<g id="node397" class="node">
<title>Layer_7_A2A_Combine_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19622" cy="-10931.86" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19622" y="-10950.66" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="19622" y="-10935.66" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19622" y="-10920.66" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19622" y="-10905.66" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_7_Expert_0_EP0_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge565" class="edge">
<title>Layer_7_Expert_0_EP0_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M13688.66,-11016.74C13691.45,-11016.46 13694.24,-11016.2 13697,-11015.95 14261.92,-10964.97 18251.05,-10940.16 19345.08,-10934.27"/>
<polygon fill="black" stroke="black" points="19345.46,-10937.77 19355.45,-10934.21 19345.43,-10930.77 19345.46,-10937.77"/>
</g>
<!-- Layer_7_Expert_0_EP0_TP1_PP1 -->
<g id="node365" class="node">
<title>Layer_7_Expert_0_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14083.5,-11083.95 13706.5,-11083.95 13706.5,-11015.95 14083.5,-11015.95 14083.5,-11083.95"/>
<text text-anchor="middle" x="13895" y="-11068.75" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13895" y="-11053.75" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="13895" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13895" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_0_EP0_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge567" class="edge">
<title>Layer_7_Expert_0_EP0_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14083.66,-11016.75C14086.45,-11016.47 14089.24,-11016.2 14092,-11015.95 14616.13,-10968.39 18298.52,-10941.35 19345.15,-10934.57"/>
<polygon fill="black" stroke="black" points="19345.47,-10938.07 19355.45,-10934.5 19345.42,-10931.07 19345.47,-10938.07"/>
</g>
<!-- Layer_7_Expert_1_EP0_TP0_PP1 -->
<g id="node366" class="node">
<title>Layer_7_Expert_1_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14478.5,-11083.95 14101.5,-11083.95 14101.5,-11015.95 14478.5,-11015.95 14478.5,-11083.95"/>
<text text-anchor="middle" x="14290" y="-11068.75" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14290" y="-11053.75" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="14290" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14290" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_1_EP0_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge569" class="edge">
<title>Layer_7_Expert_1_EP0_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14478.66,-11016.75C14481.45,-11016.47 14484.24,-11016.2 14487,-11015.95 14970.5,-10971.79 18348.63,-10942.63 19345.62,-10934.91"/>
<polygon fill="black" stroke="black" points="19345.82,-10938.41 19355.79,-10934.83 19345.77,-10931.41 19345.82,-10938.41"/>
</g>
<!-- Layer_7_Expert_1_EP0_TP1_PP1 -->
<g id="node367" class="node">
<title>Layer_7_Expert_1_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="14873.5,-11083.95 14496.5,-11083.95 14496.5,-11015.95 14873.5,-11015.95 14873.5,-11083.95"/>
<text text-anchor="middle" x="14685" y="-11068.75" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14685" y="-11053.75" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="14685" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14685" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_1_EP0_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge571" class="edge">
<title>Layer_7_Expert_1_EP0_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M14873.66,-11016.76C14876.46,-11016.47 14879.24,-11016.2 14882,-11015.95 15756.67,-10935.47 18467.89,-10931.43 19345.11,-10932.32"/>
<polygon fill="black" stroke="black" points="19345.34,-10935.82 19355.34,-10932.33 19345.35,-10928.82 19345.34,-10935.82"/>
</g>
<!-- Layer_7_Expert_2_EP0_TP0_PP1 -->
<g id="node368" class="node">
<title>Layer_7_Expert_2_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15268.5,-11083.95 14891.5,-11083.95 14891.5,-11015.95 15268.5,-11015.95 15268.5,-11083.95"/>
<text text-anchor="middle" x="15080" y="-11068.75" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15080" y="-11053.75" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="15080" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15080" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_2_EP0_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge573" class="edge">
<title>Layer_7_Expert_2_EP0_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15268.66,-11016.76C15271.46,-11016.48 15274.24,-11016.2 15277,-11015.95 16071.19,-10942.24 18517.33,-10933.61 19344.98,-10932.84"/>
<polygon fill="black" stroke="black" points="19345.25,-10936.34 19355.25,-10932.83 19345.25,-10929.34 19345.25,-10936.34"/>
</g>
<!-- Layer_7_Expert_2_EP0_TP1_PP1 -->
<g id="node369" class="node">
<title>Layer_7_Expert_2_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="15663.5,-11083.95 15286.5,-11083.95 15286.5,-11015.95 15663.5,-11015.95 15663.5,-11083.95"/>
<text text-anchor="middle" x="15475" y="-11068.75" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15475" y="-11053.75" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="15475" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15475" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_2_EP0_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge575" class="edge">
<title>Layer_7_Expert_2_EP0_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M15663.66,-11016.77C15666.46,-11016.48 15669.24,-11016.21 15672,-11015.95 16386.13,-10948.98 18569.7,-10935.98 19345.18,-10933.46"/>
<polygon fill="black" stroke="black" points="19345.38,-10936.96 19355.37,-10933.43 19345.36,-10929.96 19345.38,-10936.96"/>
</g>
<!-- Layer_7_Expert_3_EP0_TP0_PP1 -->
<g id="node370" class="node">
<title>Layer_7_Expert_3_EP0_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16058.5,-11083.95 15681.5,-11083.95 15681.5,-11015.95 16058.5,-11015.95 16058.5,-11083.95"/>
<text text-anchor="middle" x="15870" y="-11068.75" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="15870" y="-11053.75" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="15870" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15870" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_3_EP0_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge577" class="edge">
<title>Layer_7_Expert_3_EP0_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16058.66,-11016.78C16061.46,-11016.49 16064.24,-11016.21 16067,-11015.95 16701.41,-10955.71 18624.59,-10938.59 19345.31,-10934.23"/>
<polygon fill="black" stroke="black" points="19345.59,-10937.72 19355.57,-10934.16 19345.55,-10930.73 19345.59,-10937.72"/>
</g>
<!-- Layer_7_Expert_3_EP0_TP1_PP1 -->
<g id="node371" class="node">
<title>Layer_7_Expert_3_EP0_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16453.5,-11083.95 16076.5,-11083.95 16076.5,-11015.95 16453.5,-11015.95 16453.5,-11083.95"/>
<text text-anchor="middle" x="16265" y="-11068.75" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="16265" y="-11053.75" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="16265" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16265" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_3_EP0_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge579" class="edge">
<title>Layer_7_Expert_3_EP0_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16453.66,-11016.79C16456.46,-11016.5 16459.24,-11016.21 16462,-11015.95 17017.18,-10962.41 18682.93,-10941.51 19345.64,-10935.17"/>
<polygon fill="black" stroke="black" points="19345.84,-10938.67 19355.81,-10935.08 19345.78,-10931.67 19345.84,-10938.67"/>
</g>
<!-- Layer_7_Expert_4_EP1_TP0_PP1 -->
<g id="node372" class="node">
<title>Layer_7_Expert_4_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="16848.5,-11083.95 16471.5,-11083.95 16471.5,-11015.95 16848.5,-11015.95 16848.5,-11083.95"/>
<text text-anchor="middle" x="16660" y="-11068.75" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="16660" y="-11053.75" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="16660" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16660" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_4_EP1_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge581" class="edge">
<title>Layer_7_Expert_4_EP1_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M16848.66,-11016.81C16851.46,-11016.51 16854.24,-11016.22 16857,-11015.95 17333.53,-10969.1 18745.29,-10944.82 19346.21,-10936.38"/>
<polygon fill="black" stroke="black" points="19346.36,-10939.88 19356.31,-10936.24 19346.27,-10932.88 19346.36,-10939.88"/>
</g>
<!-- Layer_7_Expert_4_EP1_TP1_PP1 -->
<g id="node373" class="node">
<title>Layer_7_Expert_4_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17243.5,-11083.95 16866.5,-11083.95 16866.5,-11015.95 17243.5,-11015.95 17243.5,-11083.95"/>
<text text-anchor="middle" x="17055" y="-11068.75" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="17055" y="-11053.75" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="17055" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17055" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_4_EP1_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge583" class="edge">
<title>Layer_7_Expert_4_EP1_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17243.66,-11016.83C17246.46,-11016.52 17249.24,-11016.23 17252,-11015.95 17650.57,-10975.75 18812.67,-10948.66 19347.18,-10937.97"/>
<polygon fill="black" stroke="black" points="19347.42,-10941.47 19357.35,-10937.77 19347.28,-10934.47 19347.42,-10941.47"/>
</g>
<!-- Layer_7_Expert_5_EP1_TP0_PP1 -->
<g id="node374" class="node">
<title>Layer_7_Expert_5_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="17638.5,-11083.95 17261.5,-11083.95 17261.5,-11015.95 17638.5,-11015.95 17638.5,-11083.95"/>
<text text-anchor="middle" x="17450" y="-11068.75" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="17450" y="-11053.75" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="17450" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17450" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_5_EP1_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge585" class="edge">
<title>Layer_7_Expert_5_EP1_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M17638.67,-11016.85C17641.46,-11016.54 17644.24,-11016.24 17647,-11015.95 18250.5,-10952.95 18962.46,-10937.34 19345.19,-10933.71"/>
<polygon fill="black" stroke="black" points="19345.33,-10937.21 19355.3,-10933.62 19345.26,-10930.21 19345.33,-10937.21"/>
</g>
<!-- Layer_7_Expert_5_EP1_TP1_PP1 -->
<g id="node375" class="node">
<title>Layer_7_Expert_5_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18033.5,-11083.95 17656.5,-11083.95 17656.5,-11015.95 18033.5,-11015.95 18033.5,-11083.95"/>
<text text-anchor="middle" x="17845" y="-11068.75" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="17845" y="-11053.75" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="17845" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17845" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_5_EP1_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge587" class="edge">
<title>Layer_7_Expert_5_EP1_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18033.67,-11016.89C18036.46,-11016.57 18039.24,-11016.25 18042,-11015.95 18497.82,-10965.95 19031.03,-10945.83 19346.86,-10937.88"/>
<polygon fill="black" stroke="black" points="19347.17,-10941.37 19357.08,-10937.63 19346.99,-10934.38 19347.17,-10941.37"/>
</g>
<!-- Layer_7_Expert_6_EP1_TP0_PP1 -->
<g id="node376" class="node">
<title>Layer_7_Expert_6_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18428.5,-11083.95 18051.5,-11083.95 18051.5,-11015.95 18428.5,-11015.95 18428.5,-11083.95"/>
<text text-anchor="middle" x="18240" y="-11068.75" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="18240" y="-11053.75" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="18240" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18240" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_6_EP1_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge589" class="edge">
<title>Layer_7_Expert_6_EP1_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18428.68,-11016.96C18431.47,-11016.61 18434.25,-11016.27 18437,-11015.95 18750.45,-10978.79 19112.66,-10956.37 19353.29,-10944.34"/>
<polygon fill="black" stroke="black" points="19353.77,-10947.82 19363.59,-10943.83 19353.43,-10940.83 19353.77,-10947.82"/>
</g>
<!-- Layer_7_Expert_6_EP1_TP1_PP1 -->
<g id="node377" class="node">
<title>Layer_7_Expert_6_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="18823.5,-11083.95 18446.5,-11083.95 18446.5,-11015.95 18823.5,-11015.95 18823.5,-11083.95"/>
<text text-anchor="middle" x="18635" y="-11068.75" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="18635" y="-11053.75" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="18635" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18635" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_6_EP1_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge591" class="edge">
<title>Layer_7_Expert_6_EP1_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M18823.7,-11017.1C18826.48,-11016.7 18829.25,-11016.32 18832,-11015.95 19013.35,-10991.25 19218.98,-10969.83 19374.98,-10954.93"/>
<polygon fill="black" stroke="black" points="19375.56,-10958.39 19385.18,-10953.95 19374.9,-10951.42 19375.56,-10958.39"/>
</g>
<!-- Layer_7_Expert_7_EP1_TP0_PP1 -->
<g id="node378" class="node">
<title>Layer_7_Expert_7_EP1_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19218.5,-11083.95 18841.5,-11083.95 18841.5,-11015.95 19218.5,-11015.95 19218.5,-11083.95"/>
<text text-anchor="middle" x="19030" y="-11068.75" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="19030" y="-11053.75" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="19030" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19030" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_7_EP1_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge593" class="edge">
<title>Layer_7_Expert_7_EP1_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19198.46,-11015.92C19271.97,-11001.5 19358.47,-10984.54 19434.07,-10969.71"/>
<polygon fill="black" stroke="black" points="19435.04,-10973.09 19444.18,-10967.73 19433.7,-10966.22 19435.04,-10973.09"/>
</g>
<!-- Layer_7_Expert_7_EP1_TP1_PP1 -->
<g id="node379" class="node">
<title>Layer_7_Expert_7_EP1_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="19613.5,-11083.95 19236.5,-11083.95 19236.5,-11015.95 19613.5,-11015.95 19613.5,-11083.95"/>
<text text-anchor="middle" x="19425" y="-11068.75" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="19425" y="-11053.75" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="19425" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19425" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_7_EP1_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge595" class="edge">
<title>Layer_7_Expert_7_EP1_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19481.19,-11015.84C19498.47,-11005.66 19517.89,-10994.21 19536.67,-10983.15"/>
<polygon fill="black" stroke="black" points="19538.69,-10986.02 19545.53,-10977.93 19535.13,-10979.99 19538.69,-10986.02"/>
</g>
<!-- Layer_7_Expert_8_EP2_TP0_PP1 -->
<g id="node380" class="node">
<title>Layer_7_Expert_8_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20008.5,-11083.95 19631.5,-11083.95 19631.5,-11015.95 20008.5,-11015.95 20008.5,-11083.95"/>
<text text-anchor="middle" x="19820" y="-11068.75" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="19820" y="-11053.75" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="19820" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19820" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_8_EP2_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge597" class="edge">
<title>Layer_7_Expert_8_EP2_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M19763.53,-11015.84C19746.08,-11005.61 19726.46,-10994.11 19707.51,-10983"/>
<polygon fill="black" stroke="black" points="19709.26,-10979.96 19698.86,-10977.93 19705.72,-10986 19709.26,-10979.96"/>
</g>
<!-- Layer_7_Expert_8_EP2_TP1_PP1 -->
<g id="node381" class="node">
<title>Layer_7_Expert_8_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20403.5,-11083.95 20026.5,-11083.95 20026.5,-11015.95 20403.5,-11015.95 20403.5,-11083.95"/>
<text text-anchor="middle" x="20215" y="-11068.75" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="20215" y="-11053.75" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="20215" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20215" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_8_EP2_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge599" class="edge">
<title>Layer_7_Expert_8_EP2_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20046.26,-11015.92C19972.62,-11001.5 19885.97,-10984.54 19810.25,-10969.71"/>
<polygon fill="black" stroke="black" points="19810.6,-10966.22 19800.12,-10967.73 19809.26,-10973.09 19810.6,-10966.22"/>
</g>
<!-- Layer_7_Expert_9_EP2_TP0_PP1 -->
<g id="node382" class="node">
<title>Layer_7_Expert_9_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="20798.5,-11083.95 20421.5,-11083.95 20421.5,-11015.95 20798.5,-11015.95 20798.5,-11083.95"/>
<text text-anchor="middle" x="20610" y="-11068.75" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="20610" y="-11053.75" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="20610" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="20610" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_9_EP2_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge601" class="edge">
<title>Layer_7_Expert_9_EP2_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20421.4,-11017.25C20418.24,-11016.8 20415.11,-11016.37 20412,-11015.95 20230.64,-10991.32 20025.01,-10969.9 19869.01,-10954.98"/>
<polygon fill="black" stroke="black" points="19869.1,-10951.47 19858.81,-10954 19868.43,-10958.44 19869.1,-10951.47"/>
</g>
<!-- Layer_7_Expert_9_EP2_TP1_PP1 -->
<g id="node383" class="node">
<title>Layer_7_Expert_9_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21193.5,-11083.95 20816.5,-11083.95 20816.5,-11015.95 21193.5,-11015.95 21193.5,-11083.95"/>
<text text-anchor="middle" x="21005" y="-11068.75" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="21005" y="-11053.75" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="21005" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21005" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_9_EP2_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge603" class="edge">
<title>Layer_7_Expert_9_EP2_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M20816.42,-11017.09C20813.26,-11016.7 20810.11,-11016.32 20807,-11015.95 20493.53,-10978.92 20131.33,-10956.47 19890.7,-10944.4"/>
<polygon fill="black" stroke="black" points="19890.57,-10940.89 19880.41,-10943.89 19890.22,-10947.88 19890.57,-10940.89"/>
</g>
<!-- Layer_7_Expert_10_EP2_TP0_PP1 -->
<g id="node384" class="node">
<title>Layer_7_Expert_10_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21588.5,-11083.95 21211.5,-11083.95 21211.5,-11015.95 21588.5,-11015.95 21588.5,-11083.95"/>
<text text-anchor="middle" x="21400" y="-11068.75" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="21400" y="-11053.75" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="21400" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21400" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_10_EP2_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge605" class="edge">
<title>Layer_7_Expert_10_EP2_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21211.42,-11017.02C21208.26,-11016.65 21205.12,-11016.29 21202,-11015.95 20746.16,-10966.14 20212.96,-10945.96 19897.13,-10937.95"/>
<polygon fill="black" stroke="black" points="19897,-10934.44 19886.92,-10937.69 19896.83,-10941.44 19897,-10934.44"/>
</g>
<!-- Layer_7_Expert_10_EP2_TP1_PP1 -->
<g id="node385" class="node">
<title>Layer_7_Expert_10_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="21983.5,-11083.95 21606.5,-11083.95 21606.5,-11015.95 21983.5,-11015.95 21983.5,-11083.95"/>
<text text-anchor="middle" x="21795" y="-11068.75" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="21795" y="-11053.75" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="21795" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="21795" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_10_EP2_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge607" class="edge">
<title>Layer_7_Expert_10_EP2_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M21606.43,-11016.97C21603.26,-11016.61 21600.12,-11016.27 21597,-11015.95 20993.48,-10953.2 20281.53,-10937.5 19898.8,-10933.78"/>
<polygon fill="black" stroke="black" points="19898.73,-10930.28 19888.7,-10933.69 19898.66,-10937.28 19898.73,-10930.28"/>
</g>
<!-- Layer_7_Expert_11_EP2_TP0_PP1 -->
<g id="node386" class="node">
<title>Layer_7_Expert_11_EP2_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22378.5,-11083.95 22001.5,-11083.95 22001.5,-11015.95 22378.5,-11015.95 22378.5,-11083.95"/>
<text text-anchor="middle" x="22190" y="-11068.75" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="22190" y="-11053.75" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="22190" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22190" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_11_EP2_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge609" class="edge">
<title>Layer_7_Expert_11_EP2_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22001.43,-11016.94C21998.27,-11016.59 21995.12,-11016.26 21992,-11015.95 21593.41,-10975.92 20431.32,-10948.74 19896.81,-10938"/>
<polygon fill="black" stroke="black" points="19896.72,-10934.5 19886.65,-10937.8 19896.57,-10941.5 19896.72,-10934.5"/>
</g>
<!-- Layer_7_Expert_11_EP2_TP1_PP1 -->
<g id="node387" class="node">
<title>Layer_7_Expert_11_EP2_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="22773.5,-11083.95 22396.5,-11083.95 22396.5,-11015.95 22773.5,-11015.95 22773.5,-11083.95"/>
<text text-anchor="middle" x="22585" y="-11068.75" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="22585" y="-11053.75" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="22585" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22585" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_11_EP2_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge611" class="edge">
<title>Layer_7_Expert_11_EP2_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22396.43,-11016.92C22393.27,-11016.58 22390.12,-11016.25 22387,-11015.95 21910.46,-10969.29 20498.7,-10944.91 19897.78,-10936.41"/>
<polygon fill="black" stroke="black" points="19897.73,-10932.91 19887.68,-10936.27 19897.63,-10939.91 19897.73,-10932.91"/>
</g>
<!-- Layer_7_Expert_12_EP3_TP0_PP1 -->
<g id="node388" class="node">
<title>Layer_7_Expert_12_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23168.5,-11083.95 22791.5,-11083.95 22791.5,-11015.95 23168.5,-11015.95 23168.5,-11083.95"/>
<text text-anchor="middle" x="22980" y="-11068.75" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="22980" y="-11053.75" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="22980" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="22980" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_12_EP3_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge613" class="edge">
<title>Layer_7_Expert_12_EP3_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M22791.44,-11016.9C22788.27,-11016.57 22785.12,-11016.25 22782,-11015.95 22226.79,-10962.64 20561.06,-10941.61 19898.35,-10935.2"/>
<polygon fill="black" stroke="black" points="19898.22,-10931.7 19888.19,-10935.1 19898.15,-10938.7 19898.22,-10931.7"/>
</g>
<!-- Layer_7_Expert_12_EP3_TP1_PP1 -->
<g id="node389" class="node">
<title>Layer_7_Expert_12_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23563.5,-11083.95 23186.5,-11083.95 23186.5,-11015.95 23563.5,-11015.95 23563.5,-11083.95"/>
<text text-anchor="middle" x="23375" y="-11068.75" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="23375" y="-11053.75" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="23375" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23375" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_12_EP3_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge615" class="edge">
<title>Layer_7_Expert_12_EP3_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23186.44,-11016.89C23183.27,-11016.56 23180.12,-11016.24 23177,-11015.95 22542.56,-10955.97 20619.4,-10938.7 19898.69,-10934.26"/>
<polygon fill="black" stroke="black" points="19898.45,-10930.75 19888.43,-10934.19 19898.41,-10937.75 19898.45,-10930.75"/>
</g>
<!-- Layer_7_Expert_13_EP3_TP0_PP1 -->
<g id="node390" class="node">
<title>Layer_7_Expert_13_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="23958.5,-11083.95 23581.5,-11083.95 23581.5,-11015.95 23958.5,-11015.95 23958.5,-11083.95"/>
<text text-anchor="middle" x="23770" y="-11068.75" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="23770" y="-11053.75" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="23770" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="23770" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_13_EP3_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge617" class="edge">
<title>Layer_7_Expert_13_EP3_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23581.44,-11016.88C23578.27,-11016.55 23575.12,-11016.24 23572,-11015.95 22857.85,-10949.27 20674.29,-10936.09 19898.82,-10933.49"/>
<polygon fill="black" stroke="black" points="19898.64,-10929.99 19888.63,-10933.46 19898.62,-10936.99 19898.64,-10929.99"/>
</g>
<!-- Layer_7_Expert_13_EP3_TP1_PP1 -->
<g id="node391" class="node">
<title>Layer_7_Expert_13_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24353.5,-11083.95 23976.5,-11083.95 23976.5,-11015.95 24353.5,-11015.95 24353.5,-11083.95"/>
<text text-anchor="middle" x="24165" y="-11068.75" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="24165" y="-11053.75" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="24165" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24165" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_13_EP3_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge619" class="edge">
<title>Layer_7_Expert_13_EP3_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M23976.44,-11016.87C23973.27,-11016.54 23970.12,-11016.24 23967,-11015.95 23172.78,-10942.56 20726.66,-10933.72 19899.01,-10932.87"/>
<polygon fill="black" stroke="black" points="19898.75,-10929.37 19888.75,-10932.86 19898.75,-10936.37 19898.75,-10929.37"/>
</g>
<!-- Layer_7_Expert_14_EP3_TP0_PP1 -->
<g id="node392" class="node">
<title>Layer_7_Expert_14_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="24748.5,-11083.95 24371.5,-11083.95 24371.5,-11015.95 24748.5,-11015.95 24748.5,-11083.95"/>
<text text-anchor="middle" x="24560" y="-11068.75" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="24560" y="-11053.75" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="24560" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24560" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_14_EP3_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge621" class="edge">
<title>Layer_7_Expert_14_EP3_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24371.44,-11016.87C24368.27,-11016.54 24365.12,-11016.23 24362,-11015.95 23487.29,-10935.83 20776.1,-10931.55 19898.89,-10932.35"/>
<polygon fill="black" stroke="black" points="19898.65,-10928.85 19888.65,-10932.36 19898.66,-10935.85 19898.65,-10928.85"/>
</g>
<!-- Layer_7_Expert_14_EP3_TP1_PP1 -->
<g id="node393" class="node">
<title>Layer_7_Expert_14_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25143.5,-11083.95 24766.5,-11083.95 24766.5,-11015.95 25143.5,-11015.95 25143.5,-11083.95"/>
<text text-anchor="middle" x="24955" y="-11068.75" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="24955" y="-11053.75" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="24955" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="24955" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_14_EP3_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge623" class="edge">
<title>Layer_7_Expert_14_EP3_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M24766.44,-11016.86C24763.27,-11016.54 24760.12,-11016.23 24757,-11015.95 24273.48,-10971.99 20895.37,-10942.69 19898.38,-10934.92"/>
<polygon fill="black" stroke="black" points="19898.23,-10931.42 19888.21,-10934.84 19898.18,-10938.42 19898.23,-10931.42"/>
</g>
<!-- Layer_7_Expert_15_EP3_TP0_PP1 -->
<g id="node394" class="node">
<title>Layer_7_Expert_15_EP3_TP0_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25538.5,-11083.95 25161.5,-11083.95 25161.5,-11015.95 25538.5,-11015.95 25538.5,-11083.95"/>
<text text-anchor="middle" x="25350" y="-11068.75" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="25350" y="-11053.75" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="25350" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25350" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_15_EP3_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge625" class="edge">
<title>Layer_7_Expert_15_EP3_TP0_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M25161.44,-11016.85C25158.27,-11016.53 25155.12,-11016.23 25152,-11015.95 24627.85,-10968.6 20945.47,-10941.41 19898.85,-10934.58"/>
<polygon fill="black" stroke="black" points="19898.58,-10931.08 19888.55,-10934.52 19898.53,-10938.08 19898.58,-10931.08"/>
</g>
<!-- Layer_7_Expert_15_EP3_TP1_PP1 -->
<g id="node395" class="node">
<title>Layer_7_Expert_15_EP3_TP1_PP1</title>
<polygon fill="lightcoral" stroke="black" points="25933.5,-11083.95 25556.5,-11083.95 25556.5,-11015.95 25933.5,-11015.95 25933.5,-11083.95"/>
<text text-anchor="middle" x="25745" y="-11068.75" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="25745" y="-11053.75" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="25745" y="-11038.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="25745" y="-11023.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_Expert_15_EP3_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1 -->
<g id="edge627" class="edge">
<title>Layer_7_Expert_15_EP3_TP1_PP1&#45;&gt;Layer_7_A2A_Combine_PP1</title>
<path fill="none" stroke="black" d="M25556.44,-11016.85C25553.27,-11016.53 25550.12,-11016.23 25547,-11015.95 24982.05,-10965.2 20992.95,-10940.23 19898.92,-10934.28"/>
<polygon fill="black" stroke="black" points="19898.57,-10930.78 19888.55,-10934.23 19898.53,-10937.78 19898.57,-10930.78"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_0_EP0_TP0_PP1 -->
<g id="edge564" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_0_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19183.59,-11165.56C18131.05,-11159.43 14291.3,-11133.9 13698.79,-11084.03"/>
<polygon fill="black" stroke="black" points="13698.92,-11080.53 13688.66,-11083.15 13698.31,-11087.5 13698.92,-11080.53"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_0_EP0_TP1_PP1 -->
<g id="edge566" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_0_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19183.58,-11165.25C18178.38,-11158.23 14645.37,-11130.54 14093.86,-11084.04"/>
<polygon fill="black" stroke="black" points="14093.92,-11080.53 14083.66,-11083.14 14093.31,-11087.5 14093.92,-11080.53"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_1_EP0_TP0_PP1 -->
<g id="edge568" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_1_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19183.67,-11164.9C18227.64,-11156.94 14998.98,-11127.18 14488.8,-11084.03"/>
<polygon fill="black" stroke="black" points="14488.93,-11080.53 14478.66,-11083.14 14488.31,-11087.5 14488.93,-11080.53"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_1_EP0_TP1_PP1 -->
<g id="edge570" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_1_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19183.08,-11167.36C18340.9,-11167.58 15745.28,-11161.83 14883.71,-11084.05"/>
<polygon fill="black" stroke="black" points="14883.93,-11080.56 14873.66,-11083.13 14883.3,-11087.53 14883.93,-11080.56"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_2_EP0_TP0_PP1 -->
<g id="edge572" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_2_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19183.31,-11166.82C18391.2,-11165.37 16059.57,-11155.11 15278.62,-11084.05"/>
<polygon fill="black" stroke="black" points="15278.94,-11080.56 15268.66,-11083.13 15278.29,-11087.53 15278.94,-11080.56"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_2_EP0_TP1_PP1 -->
<g id="edge574" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_2_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19183.41,-11166.16C18443.65,-11162.96 16374.28,-11148.41 15673.62,-11084.05"/>
<polygon fill="black" stroke="black" points="15673.94,-11080.56 15663.66,-11083.12 15673.29,-11087.53 15673.94,-11080.56"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_3_EP0_TP0_PP1 -->
<g id="edge576" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_3_EP0_TP0_PP1</title>
<path fill="none" stroke="black" d="M19183.76,-11165.36C18499.5,-11160.29 16690.31,-11141.76 16069.07,-11084.09"/>
<polygon fill="black" stroke="black" points="16068.94,-11080.56 16058.66,-11083.11 16068.29,-11087.53 16068.94,-11080.56"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_3_EP0_TP1_PP1 -->
<g id="edge578" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_3_EP0_TP1_PP1</title>
<path fill="none" stroke="black" d="M19184.19,-11164.35C18558.54,-11157.28 17005.58,-11135.13 16463.92,-11084.08"/>
<polygon fill="black" stroke="black" points="16463.95,-11080.57 16453.66,-11083.1 16463.28,-11087.53 16463.95,-11080.57"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_4_EP1_TP0_PP1 -->
<g id="edge580" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_4_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19184.72,-11163.04C18621.63,-11153.85 17321.35,-11128.53 16858.76,-11084.07"/>
<polygon fill="black" stroke="black" points="16858.96,-11080.57 16848.66,-11083.08 16858.27,-11087.54 16858.96,-11080.57"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_4_EP1_TP1_PP1 -->
<g id="edge582" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_4_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19183.21,-11167.95C18770.82,-11166.9 17953.84,-11155.01 17253.7,-11084.08"/>
<polygon fill="black" stroke="black" points="17253.97,-11080.59 17243.66,-11083.06 17253.26,-11087.55 17253.97,-11080.59"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_5_EP1_TP0_PP1 -->
<g id="edge584" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_5_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19183.84,-11164.73C18833.55,-11159.43 18198.73,-11142.04 17648.79,-11084.1"/>
<polygon fill="black" stroke="black" points="17648.98,-11080.6 17638.67,-11083.03 17648.24,-11087.56 17648.98,-11080.6"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_5_EP1_TP1_PP1 -->
<g id="edge586" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_5_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19187.19,-11159.92C18906.17,-11150.38 18447.52,-11129.23 18043.8,-11084.11"/>
<polygon fill="black" stroke="black" points="18044,-11080.61 18033.67,-11082.98 18043.22,-11087.57 18044,-11080.61"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_6_EP1_TP0_PP1 -->
<g id="edge588" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_6_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19198.05,-11152.28C18995.33,-11139 18703.03,-11116.72 18438.86,-11084.15"/>
<polygon fill="black" stroke="black" points="18439.04,-11080.64 18428.68,-11082.89 18438.18,-11087.59 18439.04,-11080.64"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_6_EP1_TP1_PP1 -->
<g id="edge590" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_6_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19234.18,-11139.75C19118.17,-11124.67 18972.42,-11105.03 18833.69,-11084.19"/>
<polygon fill="black" stroke="black" points="18834.12,-11080.72 18823.71,-11082.69 18833.08,-11087.64 18834.12,-11080.72"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_7_EP1_TP0_PP1 -->
<g id="edge592" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_7_EP1_TP0_PP1</title>
<path fill="none" stroke="black" d="M19306.63,-11127.41C19258.94,-11114.22 19206.12,-11099.62 19159.53,-11086.75"/>
<polygon fill="black" stroke="black" points="19160.26,-11083.32 19149.69,-11084.03 19158.39,-11090.06 19160.26,-11083.32"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_7_EP1_TP1_PP1 -->
<g id="edge594" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_7_EP1_TP1_PP1</title>
<path fill="none" stroke="black" d="M19439.83,-11119.82C19438.01,-11111.34 19436.11,-11102.54 19434.31,-11094.18"/>
<polygon fill="black" stroke="black" points="19437.7,-11093.29 19432.17,-11084.25 19430.86,-11094.76 19437.7,-11093.29"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_8_EP2_TP0_PP1 -->
<g id="edge596" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_8_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19580.71,-11126.02C19621.16,-11113.33 19665.42,-11099.45 19704.74,-11087.11"/>
<polygon fill="black" stroke="black" points="19706.14,-11090.34 19714.63,-11084.01 19704.04,-11083.66 19706.14,-11090.34"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_8_EP2_TP1_PP1 -->
<g id="edge598" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_8_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19657.18,-11137.67C19761.79,-11122.6 19890.93,-11103.62 20016.2,-11084.06"/>
<polygon fill="black" stroke="black" points="20017.03,-11087.48 20026.37,-11082.47 20015.95,-11080.56 20017.03,-11087.48"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_9_EP2_TP0_PP1 -->
<g id="edge600" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_9_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19699.22,-11150.93C19891.21,-11137.24 20163.35,-11115.03 20411.48,-11083.98"/>
<polygon fill="black" stroke="black" points="20411.92,-11087.45 20421.41,-11082.73 20411.05,-11080.51 20411.92,-11087.45"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_9_EP2_TP1_PP1 -->
<g id="edge602" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_9_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19712.11,-11159.07C19983.6,-11148.94 20420.12,-11127.43 20806.44,-11083.97"/>
<polygon fill="black" stroke="black" points="20806.88,-11087.44 20816.42,-11082.84 20806.09,-11080.48 20806.88,-11087.44"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_10_EP2_TP0_PP1 -->
<g id="edge604" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_10_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19716.02,-11164.15C20057.82,-11158.23 20669.4,-11140.16 21201.24,-11083.98"/>
<polygon fill="black" stroke="black" points="21201.85,-11087.44 21211.43,-11082.9 21201.11,-11080.47 21201.85,-11087.44"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_10_EP2_TP1_PP1 -->
<g id="edge606" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_10_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19716.86,-11167.52C20121.6,-11165.84 20914.76,-11153.05 21596.4,-11083.96"/>
<polygon fill="black" stroke="black" points="21596.84,-11087.43 21606.43,-11082.94 21596.13,-11080.47 21596.84,-11087.43"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_11_EP2_TP0_PP1 -->
<g id="edge608" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_11_EP2_TP0_PP1</title>
<path fill="none" stroke="black" d="M19715.07,-11162.82C20269.62,-11153.29 21537.55,-11127.52 21991.2,-11083.96"/>
<polygon fill="black" stroke="black" points="21991.82,-11087.42 22001.43,-11082.96 21991.14,-11080.45 21991.82,-11087.42"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_11_EP2_TP1_PP1 -->
<g id="edge610" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_11_EP2_TP1_PP1</title>
<path fill="none" stroke="black" d="M19715.86,-11164.17C20333.82,-11156.78 21854.03,-11134.06 22386.36,-11083.95"/>
<polygon fill="black" stroke="black" points="22386.81,-11087.42 22396.44,-11082.98 22386.15,-11080.45 22386.81,-11087.42"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_12_EP3_TP0_PP1 -->
<g id="edge612" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_12_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19716.24,-11165.21C20393.22,-11159.82 22169.3,-11140.65 22781.18,-11083.96"/>
<polygon fill="black" stroke="black" points="22781.81,-11087.42 22791.44,-11083 22781.15,-11080.45 22781.81,-11087.42"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_12_EP3_TP1_PP1 -->
<g id="edge614" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_12_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19716.61,-11166.04C20449.42,-11162.53 22484.84,-11147.28 23176.36,-11083.94"/>
<polygon fill="black" stroke="black" points="23176.8,-11087.42 23186.44,-11083.01 23176.16,-11080.45 23176.8,-11087.42"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_13_EP3_TP0_PP1 -->
<g id="edge616" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_13_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19716.57,-11166.71C20501.91,-11164.97 22799.46,-11153.94 23571.31,-11083.95"/>
<polygon fill="black" stroke="black" points="23571.8,-11087.42 23581.44,-11083.02 23571.16,-11080.45 23571.8,-11087.42"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_13_EP3_TP1_PP1 -->
<g id="edge618" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_13_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19716.89,-11167.27C20552.64,-11167.19 23113.72,-11160.62 23966.18,-11083.96"/>
<polygon fill="black" stroke="black" points="23966.8,-11087.42 23976.44,-11083.03 23966.16,-11080.45 23966.8,-11087.42"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_14_EP3_TP0_PP1 -->
<g id="edge620" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_14_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19716.59,-11167.73C20600.01,-11169.24 23427.85,-11167.33 24361.22,-11083.95"/>
<polygon fill="black" stroke="black" points="24361.8,-11087.42 24371.44,-11083.03 24361.17,-11080.45 24361.8,-11087.42"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_14_EP3_TP1_PP1 -->
<g id="edge622" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_14_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19716.46,-11165.2C20715.53,-11158.01 24209.39,-11129.89 24756.32,-11083.92"/>
<polygon fill="black" stroke="black" points="24756.78,-11087.39 24766.44,-11083.04 24756.17,-11080.42 24756.78,-11087.39"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_15_EP3_TP0_PP1 -->
<g id="edge624" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_15_EP3_TP0_PP1</title>
<path fill="none" stroke="black" d="M19716.28,-11165.51C20762.67,-11159.22 24563.39,-11133.24 25151.38,-11083.92"/>
<polygon fill="black" stroke="black" points="25151.78,-11087.39 25161.44,-11083.04 25151.18,-11080.42 25151.78,-11087.39"/>
</g>
<!-- Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_15_EP3_TP1_PP1 -->
<g id="edge626" class="edge">
<title>Layer_7_A2A_Dispatch_PP1&#45;&gt;Layer_7_Expert_15_EP3_TP1_PP1</title>
<path fill="none" stroke="black" d="M19716.35,-11165.78C20808.55,-11160.34 24915.91,-11136.61 25546.1,-11083.94"/>
<polygon fill="black" stroke="black" points="25546.78,-11087.4 25556.44,-11083.05 25546.18,-11080.42 25546.78,-11087.4"/>
</g>
<!-- Layer_7_MLP_Out_TP0_PP1 -->
<g id="node398" class="node">
<title>Layer_7_MLP_Out_TP0_PP1</title>
<polygon fill="lightblue" stroke="black" points="19613.5,-10847.78 19236.5,-10847.78 19236.5,-10779.78 19613.5,-10779.78 19613.5,-10847.78"/>
<text text-anchor="middle" x="19425" y="-10832.58" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="19425" y="-10817.58" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19425" y="-10802.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19425" y="-10787.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_A2A_Combine_PP1&#45;&gt;Layer_7_MLP_Out_TP0_PP1 -->
<g id="edge628" class="edge">
<title>Layer_7_A2A_Combine_PP1&#45;&gt;Layer_7_MLP_Out_TP0_PP1</title>
<path fill="none" stroke="black" d="M19545.27,-10885.65C19527.05,-10874.92 19507.79,-10863.57 19490.15,-10853.17"/>
<polygon fill="black" stroke="black" points="19491.48,-10849.89 19481.09,-10847.83 19487.92,-10855.92 19491.48,-10849.89"/>
</g>
<!-- Layer_7_MLP_Out_TP1_PP1 -->
<g id="node399" class="node">
<title>Layer_7_MLP_Out_TP1_PP1</title>
<polygon fill="lightblue" stroke="black" points="20008.5,-10847.78 19631.5,-10847.78 19631.5,-10779.78 20008.5,-10779.78 20008.5,-10847.78"/>
<text text-anchor="middle" x="19820" y="-10832.58" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="19820" y="-10817.58" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19820" y="-10802.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19820" y="-10787.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_7_A2A_Combine_PP1&#45;&gt;Layer_7_MLP_Out_TP1_PP1 -->
<g id="edge630" class="edge">
<title>Layer_7_A2A_Combine_PP1&#45;&gt;Layer_7_MLP_Out_TP1_PP1</title>
<path fill="none" stroke="black" d="M19698.84,-10885.82C19717.33,-10874.97 19736.92,-10863.49 19754.82,-10852.99"/>
<polygon fill="black" stroke="black" points="19756.61,-10856 19763.47,-10847.92 19753.07,-10849.96 19756.61,-10856"/>
</g>
<!-- Layer_7_MLP_AllReduce_PP1 -->
<g id="node400" class="node">
<title>Layer_7_MLP_AllReduce_PP1</title>
<ellipse fill="yellow" stroke="black" cx="19622" cy="-10695.7" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="19622" y="-10714.5" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="19622" y="-10699.5" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19622" y="-10684.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19622" y="-10669.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_7_MLP_Out_TP0_PP1&#45;&gt;Layer_7_MLP_AllReduce_PP1 -->
<g id="edge629" class="edge">
<title>Layer_7_MLP_Out_TP0_PP1&#45;&gt;Layer_7_MLP_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19481.19,-10779.67C19498.47,-10769.49 19517.89,-10758.04 19536.67,-10746.98"/>
<polygon fill="black" stroke="black" points="19538.69,-10749.85 19545.53,-10741.76 19535.13,-10743.82 19538.69,-10749.85"/>
</g>
<!-- Layer_7_MLP_Out_TP1_PP1&#45;&gt;Layer_7_MLP_AllReduce_PP1 -->
<g id="edge631" class="edge">
<title>Layer_7_MLP_Out_TP1_PP1&#45;&gt;Layer_7_MLP_AllReduce_PP1</title>
<path fill="none" stroke="black" d="M19763.53,-10779.67C19746.08,-10769.44 19726.46,-10757.94 19707.51,-10746.83"/>
<polygon fill="black" stroke="black" points="19709.26,-10743.8 19698.86,-10741.76 19705.72,-10749.84 19709.26,-10743.8"/>
</g>
<!-- Layer_7_LayerNorm_PP1 -->
<g id="node401" class="node">
<title>Layer_7_LayerNorm_PP1</title>
<polygon fill="lightgreen" stroke="black" points="19810.5,-10611.61 19433.5,-10611.61 19433.5,-10543.61 19810.5,-10543.61 19810.5,-10611.61"/>
<text text-anchor="middle" x="19622" y="-10596.41" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19622" y="-10581.41" font-family="Arial" font-size="14.00">PP Stage 1</text>
<text text-anchor="middle" x="19622" y="-10566.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19622" y="-10551.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_7_MLP_AllReduce_PP1&#45;&gt;Layer_7_LayerNorm_PP1 -->
<g id="edge632" class="edge">
<title>Layer_7_MLP_AllReduce_PP1&#45;&gt;Layer_7_LayerNorm_PP1</title>
<path fill="none" stroke="black" d="M19622,-10647.48C19622,-10639.1 19622,-10630.4 19622,-10622.12"/>
<polygon fill="black" stroke="black" points="19625.5,-10621.92 19622,-10611.92 19618.5,-10621.92 19625.5,-10621.92"/>
</g>
<!-- Layer_8_QKV_TP0_PP2 -->
<g id="node402" class="node">
<title>Layer_8_QKV_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="19812.5,-10464.61 19431.5,-10464.61 19431.5,-10396.61 19812.5,-10396.61 19812.5,-10464.61"/>
<text text-anchor="middle" x="19622" y="-10449.41" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19622" y="-10434.41" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="19622" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19622" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_7_LayerNorm_PP1&#45;&gt;Layer_8_QKV_TP0_PP2 -->
<g id="edge633" class="edge">
<title>Layer_7_LayerNorm_PP1&#45;&gt;Layer_8_QKV_TP0_PP2</title>
<path fill="none" stroke="black" d="M19622,-10543.35C19622,-10522.99 19622,-10496.73 19622,-10474.79"/>
<polygon fill="black" stroke="black" points="19625.5,-10474.73 19622,-10464.73 19618.5,-10474.73 19625.5,-10474.73"/>
</g>
<!-- Layer_8_QKV_AllReduce_PP2 -->
<g id="node404" class="node">
<title>Layer_8_QKV_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="19223" cy="-10278.53" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="19223" y="-10297.33" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="19223" y="-10282.33" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="19223" y="-10267.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19223" y="-10252.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_8_QKV_TP0_PP2&#45;&gt;Layer_8_QKV_AllReduce_PP2 -->
<g id="edge634" class="edge">
<title>Layer_8_QKV_TP0_PP2&#45;&gt;Layer_8_QKV_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M19533.94,-10396.49C19478.94,-10375.8 19407.29,-10348.85 19346.64,-10326.04"/>
<polygon fill="black" stroke="black" points="19347.6,-10322.66 19337,-10322.41 19345.13,-10329.21 19347.6,-10322.66"/>
</g>
<!-- Layer_8_QKV_TP1_PP2 -->
<g id="node403" class="node">
<title>Layer_8_QKV_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="19413.5,-10464.61 19032.5,-10464.61 19032.5,-10396.61 19413.5,-10396.61 19413.5,-10464.61"/>
<text text-anchor="middle" x="19223" y="-10449.41" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="19223" y="-10434.41" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19223" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19223" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_8_QKV_TP1_PP2&#45;&gt;Layer_8_QKV_AllReduce_PP2 -->
<g id="edge638" class="edge">
<title>Layer_8_QKV_TP1_PP2&#45;&gt;Layer_8_QKV_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M19223,-10396.31C19223,-10378.8 19223,-10356.84 19223,-10336.71"/>
<polygon fill="black" stroke="black" points="19226.5,-10336.69 19223,-10326.69 19219.5,-10336.69 19226.5,-10336.69"/>
</g>
<!-- Layer_8_Attention_TP0_PP2 -->
<g id="node405" class="node">
<title>Layer_8_Attention_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="19014.5,-10194.45 18633.5,-10194.45 18633.5,-10126.45 19014.5,-10126.45 19014.5,-10194.45"/>
<text text-anchor="middle" x="18824" y="-10179.25" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="18824" y="-10164.25" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="18824" y="-10149.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="18824" y="-10134.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_8_QKV_AllReduce_PP2&#45;&gt;Layer_8_Attention_TP0_PP2 -->
<g id="edge635" class="edge">
<title>Layer_8_QKV_AllReduce_PP2&#45;&gt;Layer_8_Attention_TP0_PP2</title>
<path fill="none" stroke="black" d="M19083.73,-10237.01C19039.31,-10224.09 18990.51,-10209.89 18947.31,-10197.32"/>
<polygon fill="black" stroke="black" points="18948.18,-10193.93 18937.61,-10194.5 18946.23,-10200.65 18948.18,-10193.93"/>
</g>
<!-- Layer_8_Attention_TP1_PP2 -->
<g id="node406" class="node">
<title>Layer_8_Attention_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="19413.5,-10194.45 19032.5,-10194.45 19032.5,-10126.45 19413.5,-10126.45 19413.5,-10194.45"/>
<text text-anchor="middle" x="19223" y="-10179.25" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="19223" y="-10164.25" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19223" y="-10149.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19223" y="-10134.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_8_QKV_AllReduce_PP2&#45;&gt;Layer_8_Attention_TP1_PP2 -->
<g id="edge639" class="edge">
<title>Layer_8_QKV_AllReduce_PP2&#45;&gt;Layer_8_Attention_TP1_PP2</title>
<path fill="none" stroke="black" d="M19223,-10230.32C19223,-10221.93 19223,-10213.23 19223,-10204.95"/>
<polygon fill="black" stroke="black" points="19226.5,-10204.75 19223,-10194.75 19219.5,-10204.75 19226.5,-10204.75"/>
</g>
<!-- Layer_8_AttnOut_TP0_PP2 -->
<g id="node407" class="node">
<title>Layer_8_AttnOut_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="19012.5,-10090.45 18635.5,-10090.45 18635.5,-10022.45 19012.5,-10022.45 19012.5,-10090.45"/>
<text text-anchor="middle" x="18824" y="-10075.25" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="18824" y="-10060.25" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="18824" y="-10045.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="18824" y="-10030.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Attention_TP0_PP2&#45;&gt;Layer_8_AttnOut_TP0_PP2 -->
<g id="edge636" class="edge">
<title>Layer_8_Attention_TP0_PP2&#45;&gt;Layer_8_AttnOut_TP0_PP2</title>
<path fill="none" stroke="black" d="M18824,-10126.33C18824,-10118.23 18824,-10109.43 18824,-10100.92"/>
<polygon fill="black" stroke="black" points="18827.5,-10100.75 18824,-10090.75 18820.5,-10100.75 18827.5,-10100.75"/>
</g>
<!-- Layer_8_AttnOut_TP1_PP2 -->
<g id="node408" class="node">
<title>Layer_8_AttnOut_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="19409.5,-10090.45 19032.5,-10090.45 19032.5,-10022.45 19409.5,-10022.45 19409.5,-10090.45"/>
<text text-anchor="middle" x="19221" y="-10075.25" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="19221" y="-10060.25" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="19221" y="-10045.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="19221" y="-10030.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Attention_TP1_PP2&#45;&gt;Layer_8_AttnOut_TP1_PP2 -->
<g id="edge640" class="edge">
<title>Layer_8_Attention_TP1_PP2&#45;&gt;Layer_8_AttnOut_TP1_PP2</title>
<path fill="none" stroke="black" d="M19222.35,-10126.33C19222.19,-10118.23 19222.02,-10109.43 19221.85,-10100.92"/>
<polygon fill="black" stroke="black" points="19225.35,-10100.68 19221.65,-10090.75 19218.35,-10100.81 19225.35,-10100.68"/>
</g>
<!-- Layer_8_AttnOut_AllReduce_PP2 -->
<g id="node409" class="node">
<title>Layer_8_AttnOut_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="18824" cy="-9938.36" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="18824" y="-9957.16" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="18824" y="-9942.16" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="18824" y="-9927.16" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18824" y="-9912.16" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_8_AttnOut_TP0_PP2&#45;&gt;Layer_8_AttnOut_AllReduce_PP2 -->
<g id="edge637" class="edge">
<title>Layer_8_AttnOut_TP0_PP2&#45;&gt;Layer_8_AttnOut_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M18824,-10022.18C18824,-10014.19 18824,-10005.42 18824,-9996.68"/>
<polygon fill="black" stroke="black" points="18827.5,-9996.47 18824,-9986.47 18820.5,-9996.47 18827.5,-9996.47"/>
</g>
<!-- Layer_8_AttnOut_TP1_PP2&#45;&gt;Layer_8_AttnOut_AllReduce_PP2 -->
<g id="edge641" class="edge">
<title>Layer_8_AttnOut_TP1_PP2&#45;&gt;Layer_8_AttnOut_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M19108.03,-10022.42C19065.54,-10009.99 19016.58,-9995.67 18971.4,-9982.46"/>
<polygon fill="black" stroke="black" points="18972.1,-9979.02 18961.52,-9979.58 18970.14,-9985.74 18972.1,-9979.02"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2 -->
<g id="node446" class="node">
<title>Layer_8_A2A_Dispatch_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13698" cy="-9806.2" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13698" y="-9825" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="13698" y="-9810" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13698" y="-9795" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13698" y="-9780" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_8_AttnOut_AllReduce_PP2&#45;&gt;Layer_8_A2A_Dispatch_PP2 -->
<g id="edge642" class="edge">
<title>Layer_8_AttnOut_AllReduce_PP2&#45;&gt;Layer_8_A2A_Dispatch_PP2</title>
<path fill="none" stroke="black" d="M18560.53,-9930.67C17682.89,-9908.39 14863.8,-9836.8 13971.52,-9814.14"/>
<polygon fill="black" stroke="black" points="13971.52,-9810.64 13961.43,-9813.89 13971.34,-9817.64 13971.52,-9810.64"/>
</g>
<!-- Layer_8_Gate_EP0_PP2 -->
<g id="node410" class="node">
<title>Layer_8_Gate_EP0_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="19014.4,-10498.61 18410.86,-10498.61 18255.6,-10362.61 18859.14,-10362.61 19014.4,-10498.61"/>
<text text-anchor="middle" x="18635" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="18635" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="18635" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18635" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_8_Gate_EP1_PP2 -->
<g id="node411" class="node">
<title>Layer_8_Gate_EP1_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="18237.4,-10498.61 17633.86,-10498.61 17478.6,-10362.61 18082.14,-10362.61 18237.4,-10498.61"/>
<text text-anchor="middle" x="17858" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="17858" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="17858" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17858" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_8_Gate_EP2_PP2 -->
<g id="node412" class="node">
<title>Layer_8_Gate_EP2_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="17460.4,-10498.61 16856.86,-10498.61 16701.6,-10362.61 17305.14,-10362.61 17460.4,-10498.61"/>
<text text-anchor="middle" x="17081" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="17081" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="17081" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17081" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_8_Gate_EP3_PP2 -->
<g id="node413" class="node">
<title>Layer_8_Gate_EP3_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16683.4,-10498.61 16079.86,-10498.61 15924.6,-10362.61 16528.14,-10362.61 16683.4,-10498.61"/>
<text text-anchor="middle" x="16304" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="16304" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="16304" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16304" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_8_Expert_0_EP0_TP0_PP2 -->
<g id="node414" class="node">
<title>Layer_8_Expert_0_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7566.5,-9722.11 7189.5,-9722.11 7189.5,-9654.11 7566.5,-9654.11 7566.5,-9722.11"/>
<text text-anchor="middle" x="7378" y="-9706.91" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7378" y="-9691.91" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="7378" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7378" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_A2A_Combine_PP2 -->
<g id="node447" class="node">
<title>Layer_8_A2A_Combine_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13484" cy="-9570.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13484" y="-9588.83" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="13484" y="-9573.83" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13484" y="-9558.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13484" y="-9543.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_8_Expert_0_EP0_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge644" class="edge">
<title>Layer_8_Expert_0_EP0_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7566.66,-9654.91C7569.45,-9654.63 7572.24,-9654.36 7575,-9654.11 8138.32,-9603.27 12115.63,-9578.37 13207.37,-9572.45"/>
<polygon fill="black" stroke="black" points="13207.73,-9575.95 13217.71,-9572.39 13207.69,-9568.95 13207.73,-9575.95"/>
</g>
<!-- Layer_8_Expert_0_EP0_TP1_PP2 -->
<g id="node415" class="node">
<title>Layer_8_Expert_0_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7961.5,-9722.11 7584.5,-9722.11 7584.5,-9654.11 7961.5,-9654.11 7961.5,-9722.11"/>
<text text-anchor="middle" x="7773" y="-9706.91" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7773" y="-9691.91" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="7773" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7773" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_0_EP0_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge646" class="edge">
<title>Layer_8_Expert_0_EP0_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7961.66,-9654.92C7964.45,-9654.63 7967.24,-9654.37 7970,-9654.11 8492.54,-9606.69 12163.31,-9579.56 13207.5,-9572.75"/>
<polygon fill="black" stroke="black" points="13207.8,-9576.25 13217.78,-9572.68 13207.75,-9569.25 13207.8,-9576.25"/>
</g>
<!-- Layer_8_Expert_1_EP0_TP0_PP2 -->
<g id="node416" class="node">
<title>Layer_8_Expert_1_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8356.5,-9722.11 7979.5,-9722.11 7979.5,-9654.11 8356.5,-9654.11 8356.5,-9722.11"/>
<text text-anchor="middle" x="8168" y="-9706.91" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8168" y="-9691.91" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="8168" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8168" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_1_EP0_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge648" class="edge">
<title>Layer_8_Expert_1_EP0_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8356.66,-9654.92C8359.45,-9654.64 8362.24,-9654.37 8365,-9654.11 8846.86,-9610.1 12212.67,-9580.85 13207.63,-9573.09"/>
<polygon fill="black" stroke="black" points="13207.81,-9576.59 13217.78,-9573.01 13207.75,-9569.59 13207.81,-9576.59"/>
</g>
<!-- Layer_8_Expert_1_EP0_TP1_PP2 -->
<g id="node417" class="node">
<title>Layer_8_Expert_1_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8751.5,-9722.11 8374.5,-9722.11 8374.5,-9654.11 8751.5,-9654.11 8751.5,-9722.11"/>
<text text-anchor="middle" x="8563" y="-9706.91" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8563" y="-9691.91" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="8563" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8563" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_1_EP0_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge650" class="edge">
<title>Layer_8_Expert_1_EP0_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8751.66,-9654.93C8754.46,-9654.64 8757.24,-9654.37 8760,-9654.11 9631.34,-9573.92 12331.42,-9569.69 13206.9,-9570.5"/>
<polygon fill="black" stroke="black" points="13207.11,-9574 13217.11,-9570.51 13207.11,-9567 13207.11,-9574"/>
</g>
<!-- Layer_8_Expert_2_EP0_TP0_PP2 -->
<g id="node418" class="node">
<title>Layer_8_Expert_2_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9146.5,-9722.11 8769.5,-9722.11 8769.5,-9654.11 9146.5,-9654.11 9146.5,-9722.11"/>
<text text-anchor="middle" x="8958" y="-9706.91" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8958" y="-9691.91" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="8958" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8958" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_2_EP0_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge652" class="edge">
<title>Layer_8_Expert_2_EP0_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9146.66,-9654.93C9149.46,-9654.64 9152.24,-9654.37 9155,-9654.11 9945.91,-9580.68 12381.24,-9571.87 13206.91,-9571.03"/>
<polygon fill="black" stroke="black" points="13207.15,-9574.53 13217.15,-9571.02 13207.15,-9567.53 13207.15,-9574.53"/>
</g>
<!-- Layer_8_Expert_2_EP0_TP1_PP2 -->
<g id="node419" class="node">
<title>Layer_8_Expert_2_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9541.5,-9722.11 9164.5,-9722.11 9164.5,-9654.11 9541.5,-9654.11 9541.5,-9722.11"/>
<text text-anchor="middle" x="9353" y="-9706.91" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9353" y="-9691.91" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="9353" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9353" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_2_EP0_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge654" class="edge">
<title>Layer_8_Expert_2_EP0_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9541.66,-9654.94C9544.46,-9654.65 9547.24,-9654.37 9550,-9654.11 10260.92,-9587.42 12434.03,-9574.25 13207.27,-9571.66"/>
<polygon fill="black" stroke="black" points="13207.44,-9575.16 13217.42,-9571.63 13207.41,-9568.16 13207.44,-9575.16"/>
</g>
<!-- Layer_8_Expert_3_EP0_TP0_PP2 -->
<g id="node420" class="node">
<title>Layer_8_Expert_3_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9936.5,-9722.11 9559.5,-9722.11 9559.5,-9654.11 9936.5,-9654.11 9936.5,-9722.11"/>
<text text-anchor="middle" x="9748" y="-9706.91" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9748" y="-9691.91" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="9748" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9748" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_3_EP0_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge656" class="edge">
<title>Layer_8_Expert_3_EP0_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9936.66,-9654.95C9939.46,-9654.66 9942.24,-9654.38 9945,-9654.11 10576.17,-9594.15 12488.78,-9576.87 13207.26,-9572.43"/>
<polygon fill="black" stroke="black" points="13207.51,-9575.93 13217.49,-9572.37 13207.46,-9568.93 13207.51,-9575.93"/>
</g>
<!-- Layer_8_Expert_3_EP0_TP1_PP2 -->
<g id="node421" class="node">
<title>Layer_8_Expert_3_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10331.5,-9722.11 9954.5,-9722.11 9954.5,-9654.11 10331.5,-9654.11 10331.5,-9722.11"/>
<text text-anchor="middle" x="10143" y="-9706.91" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10143" y="-9691.91" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="10143" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10143" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_3_EP0_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge658" class="edge">
<title>Layer_8_Expert_3_EP0_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10331.66,-9654.96C10334.46,-9654.66 10337.24,-9654.38 10340,-9654.11 10892.03,-9600.85 12547.66,-9579.8 13207.83,-9573.38"/>
<polygon fill="black" stroke="black" points="13207.99,-9576.88 13217.96,-9573.28 13207.92,-9569.88 13207.99,-9576.88"/>
</g>
<!-- Layer_8_Expert_4_EP1_TP0_PP2 -->
<g id="node422" class="node">
<title>Layer_8_Expert_4_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10726.5,-9722.11 10349.5,-9722.11 10349.5,-9654.11 10726.5,-9654.11 10726.5,-9722.11"/>
<text text-anchor="middle" x="10538" y="-9706.91" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10538" y="-9691.91" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="10538" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10538" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_4_EP1_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge660" class="edge">
<title>Layer_8_Expert_4_EP1_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10726.66,-9654.97C10729.46,-9654.67 10732.24,-9654.39 10735,-9654.11 11208.4,-9607.53 12610.18,-9583.13 13208.41,-9574.6"/>
<polygon fill="black" stroke="black" points="13208.52,-9578.1 13218.47,-9574.46 13208.42,-9571.1 13208.52,-9578.1"/>
</g>
<!-- Layer_8_Expert_4_EP1_TP1_PP2 -->
<g id="node423" class="node">
<title>Layer_8_Expert_4_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11121.5,-9722.11 10744.5,-9722.11 10744.5,-9654.11 11121.5,-9654.11 11121.5,-9722.11"/>
<text text-anchor="middle" x="10933" y="-9706.91" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10933" y="-9691.91" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="10933" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10933" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_4_EP1_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge662" class="edge">
<title>Layer_8_Expert_4_EP1_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11121.66,-9654.99C11124.46,-9654.69 11127.24,-9654.39 11130,-9654.11 11525.44,-9614.19 12677.56,-9586.99 13209.26,-9576.21"/>
<polygon fill="black" stroke="black" points="13209.44,-9579.71 13219.37,-9576.01 13209.3,-9572.71 13209.44,-9579.71"/>
</g>
<!-- Layer_8_Expert_5_EP1_TP0_PP2 -->
<g id="node424" class="node">
<title>Layer_8_Expert_5_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11516.5,-9722.11 11139.5,-9722.11 11139.5,-9654.11 11516.5,-9654.11 11516.5,-9722.11"/>
<text text-anchor="middle" x="11328" y="-9706.91" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="11328" y="-9691.91" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="11328" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11328" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_5_EP1_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge664" class="edge">
<title>Layer_8_Expert_5_EP1_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11516.67,-9655.02C11519.46,-9654.71 11522.24,-9654.4 11525,-9654.11 12122.56,-9591.64 12827.33,-9575.82 13207.44,-9572.02"/>
<polygon fill="black" stroke="black" points="13207.51,-9575.52 13217.47,-9571.92 13207.44,-9568.52 13207.51,-9575.52"/>
</g>
<!-- Layer_8_Expert_5_EP1_TP1_PP2 -->
<g id="node425" class="node">
<title>Layer_8_Expert_5_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11911.5,-9722.11 11534.5,-9722.11 11534.5,-9654.11 11911.5,-9654.11 11911.5,-9722.11"/>
<text text-anchor="middle" x="11723" y="-9706.91" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="11723" y="-9691.91" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="11723" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11723" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_5_EP1_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge666" class="edge">
<title>Layer_8_Expert_5_EP1_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11911.67,-9655.06C11914.46,-9654.73 11917.24,-9654.42 11920,-9654.11 12370.03,-9604.63 12896.27,-9584.37 13209.21,-9576.25"/>
<polygon fill="black" stroke="black" points="13209.43,-9579.75 13219.33,-9575.99 13209.25,-9572.75 13209.43,-9579.75"/>
</g>
<!-- Layer_8_Expert_6_EP1_TP0_PP2 -->
<g id="node426" class="node">
<title>Layer_8_Expert_6_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12306.5,-9722.11 11929.5,-9722.11 11929.5,-9654.11 12306.5,-9654.11 12306.5,-9722.11"/>
<text text-anchor="middle" x="12118" y="-9706.91" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12118" y="-9691.91" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="12118" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12118" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_6_EP1_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge668" class="edge">
<title>Layer_8_Expert_6_EP1_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12306.68,-9655.13C12309.47,-9654.78 12312.25,-9654.44 12315,-9654.11 12622.98,-9617.46 12978.67,-9595 13216.05,-9582.82"/>
<polygon fill="black" stroke="black" points="13216.4,-9586.31 13226.21,-9582.31 13216.04,-9579.32 13216.4,-9586.31"/>
</g>
<!-- Layer_8_Expert_6_EP1_TP1_PP2 -->
<g id="node427" class="node">
<title>Layer_8_Expert_6_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12701.5,-9722.11 12324.5,-9722.11 12324.5,-9654.11 12701.5,-9654.11 12701.5,-9722.11"/>
<text text-anchor="middle" x="12513" y="-9706.91" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12513" y="-9691.91" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="12513" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12513" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_6_EP1_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge670" class="edge">
<title>Layer_8_Expert_6_EP1_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12701.7,-9655.27C12704.48,-9654.88 12707.25,-9654.49 12710,-9654.11 12886.38,-9629.9 13086.18,-9608.6 13238.6,-9593.64"/>
<polygon fill="black" stroke="black" points="13238.96,-9597.12 13248.57,-9592.66 13238.28,-9590.15 13238.96,-9597.12"/>
</g>
<!-- Layer_8_Expert_7_EP1_TP0_PP2 -->
<g id="node428" class="node">
<title>Layer_8_Expert_7_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13096.5,-9722.11 12719.5,-9722.11 12719.5,-9654.11 13096.5,-9654.11 13096.5,-9722.11"/>
<text text-anchor="middle" x="12908" y="-9706.91" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12908" y="-9691.91" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="12908" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12908" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_7_EP1_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge672" class="edge">
<title>Layer_8_Expert_7_EP1_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13071.9,-9654.08C13142.65,-9639.82 13225.76,-9623.08 13298.73,-9608.37"/>
<polygon fill="black" stroke="black" points="13299.85,-9611.71 13308.96,-9606.31 13298.47,-9604.85 13299.85,-9611.71"/>
</g>
<!-- Layer_8_Expert_7_EP1_TP1_PP2 -->
<g id="node429" class="node">
<title>Layer_8_Expert_7_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13491.5,-9722.11 13114.5,-9722.11 13114.5,-9654.11 13491.5,-9654.11 13491.5,-9722.11"/>
<text text-anchor="middle" x="13303" y="-9706.91" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="13303" y="-9691.91" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="13303" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13303" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_7_EP1_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge674" class="edge">
<title>Layer_8_Expert_7_EP1_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13354.87,-9653.85C13370.35,-9643.92 13387.68,-9632.81 13404.5,-9622.02"/>
<polygon fill="black" stroke="black" points="13406.71,-9624.76 13413.24,-9616.41 13402.93,-9618.87 13406.71,-9624.76"/>
</g>
<!-- Layer_8_Expert_8_EP2_TP0_PP2 -->
<g id="node430" class="node">
<title>Layer_8_Expert_8_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13886.5,-9722.11 13509.5,-9722.11 13509.5,-9654.11 13886.5,-9654.11 13886.5,-9722.11"/>
<text text-anchor="middle" x="13698" y="-9706.91" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="13698" y="-9691.91" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="13698" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13698" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_8_EP2_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge676" class="edge">
<title>Layer_8_Expert_8_EP2_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13636.96,-9654.01C13617.83,-9643.63 13596.28,-9631.93 13575.52,-9620.67"/>
<polygon fill="black" stroke="black" points="13577.14,-9617.57 13566.68,-9615.88 13573.8,-9623.72 13577.14,-9617.57"/>
</g>
<!-- Layer_8_Expert_8_EP2_TP1_PP2 -->
<g id="node431" class="node">
<title>Layer_8_Expert_8_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14281.5,-9722.11 13904.5,-9722.11 13904.5,-9654.11 14281.5,-9654.11 14281.5,-9722.11"/>
<text text-anchor="middle" x="14093" y="-9706.91" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="14093" y="-9691.91" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="14093" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14093" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_8_EP2_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge678" class="edge">
<title>Layer_8_Expert_8_EP2_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13919.71,-9654.08C13843.16,-9639.49 13752.95,-9622.3 13674.52,-9607.35"/>
<polygon fill="black" stroke="black" points="13675,-9603.88 13664.52,-9605.44 13673.69,-9610.75 13675,-9603.88"/>
</g>
<!-- Layer_8_Expert_9_EP2_TP0_PP2 -->
<g id="node432" class="node">
<title>Layer_8_Expert_9_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14676.5,-9722.11 14299.5,-9722.11 14299.5,-9654.11 14676.5,-9654.11 14676.5,-9722.11"/>
<text text-anchor="middle" x="14488" y="-9706.91" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14488" y="-9691.91" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="14488" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14488" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_9_EP2_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge680" class="edge">
<title>Layer_8_Expert_9_EP2_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14299.4,-9655.4C14296.24,-9654.96 14293.11,-9654.53 14290,-9654.11 14103.79,-9629.02 13892.48,-9607.5 13732.95,-9592.65"/>
<polygon fill="black" stroke="black" points="13732.8,-9589.12 13722.52,-9591.68 13732.15,-9596.09 13732.8,-9589.12"/>
</g>
<!-- Layer_8_Expert_9_EP2_TP1_PP2 -->
<g id="node433" class="node">
<title>Layer_8_Expert_9_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15071.5,-9722.11 14694.5,-9722.11 14694.5,-9654.11 15071.5,-9654.11 15071.5,-9722.11"/>
<text text-anchor="middle" x="14883" y="-9706.91" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14883" y="-9691.91" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="14883" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14883" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_9_EP2_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge682" class="edge">
<title>Layer_8_Expert_9_EP2_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14694.42,-9655.26C14691.26,-9654.86 14688.11,-9654.48 14685,-9654.11 14365.74,-9616.55 13996.59,-9594.14 13752.73,-9582.22"/>
<polygon fill="black" stroke="black" points="13752.82,-9578.72 13742.67,-9581.73 13752.48,-9585.72 13752.82,-9578.72"/>
</g>
<!-- Layer_8_Expert_10_EP2_TP0_PP2 -->
<g id="node434" class="node">
<title>Layer_8_Expert_10_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15466.5,-9722.11 15089.5,-9722.11 15089.5,-9654.11 15466.5,-9654.11 15466.5,-9722.11"/>
<text text-anchor="middle" x="15278" y="-9706.91" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15278" y="-9691.91" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="15278" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15278" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_10_EP2_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge684" class="edge">
<title>Layer_8_Expert_10_EP2_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15089.42,-9655.18C15086.26,-9654.81 15083.12,-9654.45 15080,-9654.11 14618.18,-9603.77 14077.75,-9583.74 13759.08,-9575.91"/>
<polygon fill="black" stroke="black" points="13758.86,-9572.4 13748.78,-9575.66 13758.69,-9579.4 13758.86,-9572.4"/>
</g>
<!-- Layer_8_Expert_10_EP2_TP1_PP2 -->
<g id="node435" class="node">
<title>Layer_8_Expert_10_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15861.5,-9722.11 15484.5,-9722.11 15484.5,-9654.11 15861.5,-9654.11 15861.5,-9722.11"/>
<text text-anchor="middle" x="15673" y="-9706.91" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15673" y="-9691.91" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="15673" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15673" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_10_EP2_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge686" class="edge">
<title>Layer_8_Expert_10_EP2_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15484.43,-9655.14C15481.26,-9654.78 15478.12,-9654.44 15475,-9654.11 14865.31,-9590.83 14145.85,-9575.35 13760.61,-9571.81"/>
<polygon fill="black" stroke="black" points="13760.48,-9568.31 13750.44,-9571.72 13760.41,-9575.31 13760.48,-9568.31"/>
</g>
<!-- Layer_8_Expert_11_EP2_TP0_PP2 -->
<g id="node436" class="node">
<title>Layer_8_Expert_11_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16256.5,-9722.11 15879.5,-9722.11 15879.5,-9654.11 16256.5,-9654.11 16256.5,-9722.11"/>
<text text-anchor="middle" x="16068" y="-9706.91" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="16068" y="-9691.91" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="16068" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16068" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_11_EP2_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge688" class="edge">
<title>Layer_8_Expert_11_EP2_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15879.43,-9655.11C15876.27,-9654.76 15873.12,-9654.43 15870,-9654.11 15468.27,-9613.82 14296.17,-9586.74 13758.87,-9576.09"/>
<polygon fill="black" stroke="black" points="13758.72,-9572.59 13748.65,-9575.89 13758.58,-9579.59 13758.72,-9572.59"/>
</g>
<!-- Layer_8_Expert_11_EP2_TP1_PP2 -->
<g id="node437" class="node">
<title>Layer_8_Expert_11_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16651.5,-9722.11 16274.5,-9722.11 16274.5,-9654.11 16651.5,-9654.11 16651.5,-9722.11"/>
<text text-anchor="middle" x="16463" y="-9706.91" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="16463" y="-9691.91" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="16463" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16463" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_11_EP2_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge690" class="edge">
<title>Layer_8_Expert_11_EP2_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16274.43,-9655.09C16271.27,-9654.74 16268.12,-9654.42 16265,-9654.11 15785.25,-9607.19 14363.11,-9582.93 13759.69,-9574.52"/>
<polygon fill="black" stroke="black" points="13759.59,-9571.02 13749.54,-9574.38 13759.49,-9578.02 13759.59,-9571.02"/>
</g>
<!-- Layer_8_Expert_12_EP3_TP0_PP2 -->
<g id="node438" class="node">
<title>Layer_8_Expert_12_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17046.5,-9722.11 16669.5,-9722.11 16669.5,-9654.11 17046.5,-9654.11 17046.5,-9722.11"/>
<text text-anchor="middle" x="16858" y="-9706.91" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="16858" y="-9691.91" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="16858" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16858" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_12_EP3_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge692" class="edge">
<title>Layer_8_Expert_12_EP3_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16669.44,-9655.07C16666.27,-9654.73 16663.12,-9654.41 16660,-9654.11 16101.55,-9600.54 14425.25,-9579.65 13760.23,-9573.33"/>
<polygon fill="black" stroke="black" points="13760.06,-9569.82 13750.03,-9573.23 13759.99,-9576.82 13760.06,-9569.82"/>
</g>
<!-- Layer_8_Expert_12_EP3_TP1_PP2 -->
<g id="node439" class="node">
<title>Layer_8_Expert_12_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17441.5,-9722.11 17064.5,-9722.11 17064.5,-9654.11 17441.5,-9654.11 17441.5,-9722.11"/>
<text text-anchor="middle" x="17253" y="-9706.91" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="17253" y="-9691.91" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="17253" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17253" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_12_EP3_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge694" class="edge">
<title>Layer_8_Expert_12_EP3_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17064.44,-9655.06C17061.27,-9654.72 17058.12,-9654.41 17055,-9654.11 16417.24,-9593.86 14483.08,-9576.75 13760.36,-9572.39"/>
<polygon fill="black" stroke="black" points="13760.35,-9568.89 13750.33,-9572.33 13760.31,-9575.89 13760.35,-9568.89"/>
</g>
<!-- Layer_8_Expert_13_EP3_TP0_PP2 -->
<g id="node440" class="node">
<title>Layer_8_Expert_13_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17836.5,-9722.11 17459.5,-9722.11 17459.5,-9654.11 17836.5,-9654.11 17836.5,-9722.11"/>
<text text-anchor="middle" x="17648" y="-9706.91" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17648" y="-9691.91" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="17648" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17648" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_13_EP3_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge696" class="edge">
<title>Layer_8_Expert_13_EP3_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17459.44,-9655.05C17456.27,-9654.72 17453.12,-9654.41 17450,-9654.11 16732.63,-9587.17 14538.59,-9574.16 13760.9,-9571.63"/>
<polygon fill="black" stroke="black" points="13760.69,-9568.13 13750.68,-9571.6 13760.67,-9575.13 13760.69,-9568.13"/>
</g>
<!-- Layer_8_Expert_13_EP3_TP1_PP2 -->
<g id="node441" class="node">
<title>Layer_8_Expert_13_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18231.5,-9722.11 17854.5,-9722.11 17854.5,-9654.11 18231.5,-9654.11 18231.5,-9722.11"/>
<text text-anchor="middle" x="18043" y="-9706.91" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="18043" y="-9691.91" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="18043" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18043" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_13_EP3_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge698" class="edge">
<title>Layer_8_Expert_13_EP3_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17854.44,-9655.04C17851.27,-9654.71 17848.12,-9654.4 17845,-9654.11 17047.5,-9580.46 14590.56,-9571.8 13760.93,-9571.01"/>
<polygon fill="black" stroke="black" points="13760.65,-9567.51 13750.65,-9571 13760.64,-9574.51 13760.65,-9567.51"/>
</g>
<!-- Layer_8_Expert_14_EP3_TP0_PP2 -->
<g id="node442" class="node">
<title>Layer_8_Expert_14_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18626.5,-9722.11 18249.5,-9722.11 18249.5,-9654.11 18626.5,-9654.11 18626.5,-9722.11"/>
<text text-anchor="middle" x="18438" y="-9706.91" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="18438" y="-9691.91" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="18438" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18438" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_14_EP3_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge700" class="edge">
<title>Layer_8_Expert_14_EP3_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18249.44,-9655.03C18246.27,-9654.71 18243.12,-9654.4 18240,-9654.11 17362.08,-9573.73 14640.41,-9569.64 13761.05,-9570.49"/>
<polygon fill="black" stroke="black" points="13760.79,-9566.99 13750.79,-9570.5 13760.8,-9573.99 13760.79,-9566.99"/>
</g>
<!-- Layer_8_Expert_14_EP3_TP1_PP2 -->
<g id="node443" class="node">
<title>Layer_8_Expert_14_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="19021.5,-9722.11 18644.5,-9722.11 18644.5,-9654.11 19021.5,-9654.11 19021.5,-9722.11"/>
<text text-anchor="middle" x="18833" y="-9706.91" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="18833" y="-9691.91" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="18833" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18833" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_14_EP3_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge702" class="edge">
<title>Layer_8_Expert_14_EP3_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18644.44,-9655.03C18641.27,-9654.7 18638.12,-9654.4 18635,-9654.11 18149.83,-9610.02 14759.4,-9580.8 13760.38,-9573.08"/>
<polygon fill="black" stroke="black" points="13760.22,-9569.58 13750.19,-9573 13760.16,-9576.57 13760.22,-9569.58"/>
</g>
<!-- Layer_8_Expert_15_EP3_TP0_PP2 -->
<g id="node444" class="node">
<title>Layer_8_Expert_15_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="19416.5,-9722.11 19039.5,-9722.11 19039.5,-9654.11 19416.5,-9654.11 19416.5,-9722.11"/>
<text text-anchor="middle" x="19228" y="-9706.91" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="19228" y="-9691.91" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="19228" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19228" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_15_EP3_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge704" class="edge">
<title>Layer_8_Expert_15_EP3_TP0_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M19039.44,-9655.02C19036.27,-9654.7 19033.12,-9654.4 19030,-9654.11 18504.19,-9606.63 14809.2,-9579.53 13760.76,-9572.74"/>
<polygon fill="black" stroke="black" points="13760.47,-9569.23 13750.44,-9572.67 13760.42,-9576.23 13760.47,-9569.23"/>
</g>
<!-- Layer_8_Expert_15_EP3_TP1_PP2 -->
<g id="node445" class="node">
<title>Layer_8_Expert_15_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="19811.5,-9722.11 19434.5,-9722.11 19434.5,-9654.11 19811.5,-9654.11 19811.5,-9722.11"/>
<text text-anchor="middle" x="19623" y="-9706.91" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="19623" y="-9691.91" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="19623" y="-9676.91" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19623" y="-9661.91" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_Expert_15_EP3_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2 -->
<g id="edge706" class="edge">
<title>Layer_8_Expert_15_EP3_TP1_PP2&#45;&gt;Layer_8_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M19434.44,-9655.02C19431.27,-9654.7 19428.12,-9654.4 19425,-9654.11 18858.37,-9603.23 14856.39,-9578.35 13760.73,-9572.44"/>
<polygon fill="black" stroke="black" points="13760.38,-9568.94 13750.36,-9572.38 13760.34,-9575.94 13760.38,-9568.94"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_0_EP0_TP0_PP2 -->
<g id="edge643" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_0_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M13431.45,-9803.98C12335.99,-9798.64 8208.95,-9775.24 7577.03,-9722.22"/>
<polygon fill="black" stroke="black" points="7576.92,-9718.7 7566.66,-9721.32 7576.32,-9725.67 7576.92,-9718.7"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_0_EP0_TP1_PP2 -->
<g id="edge645" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_0_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M13431.4,-9803.71C12381.52,-9797.52 8561.45,-9771.85 7971.75,-9722.2"/>
<polygon fill="black" stroke="black" points="7971.92,-9718.7 7961.66,-9721.32 7971.31,-9725.67 7971.92,-9718.7"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_1_EP0_TP0_PP2 -->
<g id="edge647" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_1_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M13431.53,-9803.4C12429.29,-9796.32 8915.53,-9768.49 8366.81,-9722.2"/>
<polygon fill="black" stroke="black" points="8366.92,-9718.7 8356.66,-9721.31 8366.31,-9725.67 8366.92,-9718.7"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_1_EP0_TP1_PP2 -->
<g id="edge649" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_1_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M13431.77,-9803.04C12479.01,-9795.02 9269.17,-9765.13 8761.75,-9722.2"/>
<polygon fill="black" stroke="black" points="8761.93,-9718.7 8751.66,-9721.31 8761.31,-9725.67 8761.93,-9718.7"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_2_EP0_TP0_PP2 -->
<g id="edge651" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_2_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M13431.43,-9805.49C12592.69,-9805.62 10013.17,-9799.58 9156.65,-9722.21"/>
<polygon fill="black" stroke="black" points="9156.93,-9718.73 9146.66,-9721.3 9156.3,-9725.7 9156.93,-9718.73"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_2_EP0_TP1_PP2 -->
<g id="edge653" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_2_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M13431.51,-9804.95C12642.88,-9803.4 10327.98,-9792.86 9551.85,-9722.23"/>
<polygon fill="black" stroke="black" points="9551.94,-9718.73 9541.66,-9721.29 9551.29,-9725.7 9551.94,-9718.73"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_3_EP0_TP0_PP2 -->
<g id="edge655" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_3_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M13431.52,-9804.28C12695.31,-9800.97 10642.61,-9786.16 9946.8,-9722.23"/>
<polygon fill="black" stroke="black" points="9946.94,-9718.73 9936.66,-9721.29 9946.29,-9725.7 9946.94,-9718.73"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_3_EP0_TP1_PP2 -->
<g id="edge657" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_3_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M13431.55,-9803.47C12750.69,-9798.27 10958.03,-9779.5 10341.98,-9722.25"/>
<polygon fill="black" stroke="black" points="10341.94,-9718.73 10331.66,-9721.28 10341.29,-9725.7 10341.94,-9718.73"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_4_EP1_TP0_PP2 -->
<g id="edge659" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_4_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M13432.1,-9802.44C12810.17,-9795.25 11273.35,-9772.87 10736.82,-9722.24"/>
<polygon fill="black" stroke="black" points="10736.95,-9718.73 10726.66,-9721.26 10736.28,-9725.7 10736.95,-9718.73"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_4_EP1_TP1_PP2 -->
<g id="edge661" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_4_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M13432.88,-9801.12C12873.94,-9791.78 11589.2,-9766.28 11131.65,-9722.23"/>
<polygon fill="black" stroke="black" points="11131.96,-9718.74 11121.66,-9721.25 11131.27,-9725.7 11131.96,-9718.74"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_5_EP1_TP0_PP2 -->
<g id="edge663" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_5_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M13431.29,-9805.94C13022.7,-9804.63 12217.38,-9792.36 11526.82,-9722.26"/>
<polygon fill="black" stroke="black" points="11526.97,-9718.76 11516.66,-9721.22 11526.26,-9725.72 11526.97,-9718.76"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_5_EP1_TP1_PP2 -->
<g id="edge665" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_5_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M13431.79,-9802.64C13085.58,-9797.08 12462.13,-9779.38 11921.62,-9722.25"/>
<polygon fill="black" stroke="black" points="11921.98,-9718.77 11911.67,-9721.19 11921.24,-9725.73 11921.98,-9718.77"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_6_EP1_TP0_PP2 -->
<g id="edge667" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_6_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M13435.37,-9797.7C13159.03,-9787.9 12711.41,-9766.59 12316.86,-9722.29"/>
<polygon fill="black" stroke="black" points="12317,-9718.78 12306.67,-9721.14 12316.22,-9725.74 12317,-9718.78"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_6_EP1_TP1_PP2 -->
<g id="edge669" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_6_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M13447.17,-9789.81C13249.75,-9776.35 12967.55,-9754.11 12711.92,-9722.33"/>
<polygon fill="black" stroke="black" points="12712.04,-9718.81 12701.69,-9721.05 12711.17,-9725.76 12712.04,-9718.81"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_7_EP1_TP0_PP2 -->
<g id="edge671" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_7_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M13486.13,-9776.91C13375.8,-9761.84 13238.43,-9742.54 13106.98,-9722.41"/>
<polygon fill="black" stroke="black" points="13107.13,-9718.89 13096.71,-9720.83 13106.07,-9725.81 13107.13,-9718.89"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_7_EP1_TP1_PP2 -->
<g id="edge673" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_7_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M13560.96,-9764.92C13516.73,-9751.93 13468.02,-9737.61 13424.96,-9724.96"/>
<polygon fill="black" stroke="black" points="13425.87,-9721.58 13415.29,-9722.12 13423.9,-9728.29 13425.87,-9721.58"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_8_EP2_TP0_PP2 -->
<g id="edge675" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_8_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13698,-9757.98C13698,-9749.6 13698,-9740.9 13698,-9732.62"/>
<polygon fill="black" stroke="black" points="13701.5,-9732.42 13698,-9722.42 13694.5,-9732.42 13701.5,-9732.42"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_8_EP2_TP1_PP2 -->
<g id="edge677" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_8_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13835.04,-9764.92C13879.27,-9751.93 13927.98,-9737.61 13971.04,-9724.96"/>
<polygon fill="black" stroke="black" points="13972.1,-9728.29 13980.71,-9722.12 13970.13,-9721.58 13972.1,-9728.29"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_9_EP2_TP0_PP2 -->
<g id="edge679" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_9_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13909.51,-9776.86C14019.76,-9761.75 14157.06,-9742.43 14289.45,-9722.19"/>
<polygon fill="black" stroke="black" points="14290.02,-9725.64 14299.37,-9720.67 14288.96,-9718.72 14290.02,-9725.64"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_9_EP2_TP1_PP2 -->
<g id="edge681" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_9_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13948.57,-9789.74C14145.78,-9776.24 14427.7,-9753.98 14684.14,-9722.19"/>
<polygon fill="black" stroke="black" points="14684.92,-9725.62 14694.41,-9720.91 14684.05,-9718.67 14684.92,-9725.62"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_10_EP2_TP0_PP2 -->
<g id="edge683" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_10_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13960.43,-9797.63C14236.57,-9787.77 14683.86,-9766.4 15079.21,-9722.16"/>
<polygon fill="black" stroke="black" points="15079.87,-9725.61 15089.42,-9721.01 15079.09,-9718.65 15079.87,-9725.61"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_10_EP2_TP1_PP2 -->
<g id="edge685" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_10_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13964.06,-9802.57C14310.06,-9796.92 14933.15,-9779.13 15474.46,-9722.12"/>
<polygon fill="black" stroke="black" points="15474.85,-9725.6 15484.43,-9721.07 15474.11,-9718.64 15474.85,-9725.6"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_11_EP2_TP0_PP2 -->
<g id="edge687" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_11_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13964.58,-9805.87C14372.97,-9804.46 15177.91,-9792.05 15869.26,-9722.14"/>
<polygon fill="black" stroke="black" points="15869.84,-9725.6 15879.43,-9721.11 15869.13,-9718.63 15869.84,-9725.6"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_11_EP2_TP1_PP2 -->
<g id="edge689" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_11_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13963.28,-9801.08C14522.14,-9791.69 15806.04,-9766.08 16264.42,-9722.11"/>
<polygon fill="black" stroke="black" points="16264.82,-9725.59 16274.43,-9721.13 16264.14,-9718.62 16264.82,-9725.59"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_12_EP3_TP0_PP2 -->
<g id="edge691" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_12_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13963.8,-9802.41C14585.52,-9795.15 16121.81,-9772.65 16659.26,-9722.12"/>
<polygon fill="black" stroke="black" points="16659.81,-9725.59 16669.44,-9721.15 16659.15,-9718.62 16659.81,-9725.59"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_12_EP3_TP1_PP2 -->
<g id="edge693" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_12_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13964.37,-9803.44C14645.02,-9798.17 16437.13,-9779.24 17054.1,-9722.14"/>
<polygon fill="black" stroke="black" points="17054.81,-9725.58 17064.44,-9721.16 17054.15,-9718.62 17054.81,-9725.58"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_13_EP3_TP0_PP2 -->
<g id="edge695" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_13_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13964.41,-9804.25C14700.41,-9800.86 16752.55,-9785.87 17449.28,-9722.12"/>
<polygon fill="black" stroke="black" points="17449.8,-9725.58 17459.44,-9721.18 17449.16,-9718.61 17449.8,-9725.58"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_13_EP3_TP1_PP2 -->
<g id="edge697" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_13_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13964.78,-9804.92C14753.54,-9803.28 17067.3,-9792.52 17844.24,-9722.12"/>
<polygon fill="black" stroke="black" points="17844.8,-9725.58 17854.44,-9721.19 17844.16,-9718.61 17844.8,-9725.58"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_14_EP3_TP0_PP2 -->
<g id="edge699" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_14_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13964.88,-9805.46C14803.81,-9805.49 17382.12,-9799.21 18239.43,-9722.1"/>
<polygon fill="black" stroke="black" points="18239.8,-9725.58 18249.44,-9721.19 18239.16,-9718.61 18239.8,-9725.58"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_14_EP3_TP1_PP2 -->
<g id="edge701" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_14_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13964.18,-9803.03C14916.74,-9794.96 18125.92,-9764.94 18634.33,-9722.09"/>
<polygon fill="black" stroke="black" points="18634.78,-9725.56 18644.44,-9721.2 18634.17,-9718.59 18634.78,-9725.56"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_15_EP3_TP0_PP2 -->
<g id="edge703" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_15_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13964.42,-9803.39C14966.47,-9796.26 18479.55,-9768.27 19029.27,-9722.09"/>
<polygon fill="black" stroke="black" points="19029.78,-9725.56 19039.44,-9721.2 19029.17,-9718.59 19029.78,-9725.56"/>
</g>
<!-- Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_15_EP3_TP1_PP2 -->
<g id="edge705" class="edge">
<title>Layer_8_A2A_Dispatch_PP2&#45;&gt;Layer_8_Expert_15_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13964.55,-9803.7C15014.25,-9797.46 18833.63,-9771.62 19424.33,-9722.09"/>
<polygon fill="black" stroke="black" points="19424.78,-9725.56 19434.44,-9721.21 19424.18,-9718.59 19424.78,-9725.56"/>
</g>
<!-- Layer_8_MLP_Out_TP0_PP2 -->
<g id="node448" class="node">
<title>Layer_8_MLP_Out_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13475.5,-9485.95 13098.5,-9485.95 13098.5,-9417.95 13475.5,-9417.95 13475.5,-9485.95"/>
<text text-anchor="middle" x="13287" y="-9470.75" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="13287" y="-9455.75" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="13287" y="-9440.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13287" y="-9425.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_A2A_Combine_PP2&#45;&gt;Layer_8_MLP_Out_TP0_PP2 -->
<g id="edge707" class="edge">
<title>Layer_8_A2A_Combine_PP2&#45;&gt;Layer_8_MLP_Out_TP0_PP2</title>
<path fill="none" stroke="black" d="M13407.27,-9523.82C13389.05,-9513.08 13369.79,-9501.73 13352.15,-9491.34"/>
<polygon fill="black" stroke="black" points="13353.48,-9488.06 13343.09,-9486 13349.92,-9494.09 13353.48,-9488.06"/>
</g>
<!-- Layer_8_MLP_Out_TP1_PP2 -->
<g id="node449" class="node">
<title>Layer_8_MLP_Out_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13870.5,-9485.95 13493.5,-9485.95 13493.5,-9417.95 13870.5,-9417.95 13870.5,-9485.95"/>
<text text-anchor="middle" x="13682" y="-9470.75" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="13682" y="-9455.75" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="13682" y="-9440.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13682" y="-9425.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_8_A2A_Combine_PP2&#45;&gt;Layer_8_MLP_Out_TP1_PP2 -->
<g id="edge709" class="edge">
<title>Layer_8_A2A_Combine_PP2&#45;&gt;Layer_8_MLP_Out_TP1_PP2</title>
<path fill="none" stroke="black" d="M13560.84,-9523.98C13579.33,-9513.14 13598.92,-9501.66 13616.82,-9491.16"/>
<polygon fill="black" stroke="black" points="13618.61,-9494.17 13625.47,-9486.09 13615.07,-9488.13 13618.61,-9494.17"/>
</g>
<!-- Layer_8_MLP_AllReduce_PP2 -->
<g id="node450" class="node">
<title>Layer_8_MLP_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13378" cy="-9333.86" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13378" y="-9352.66" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="13378" y="-9337.66" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13378" y="-9322.66" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13378" y="-9307.66" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_8_MLP_Out_TP0_PP2&#45;&gt;Layer_8_MLP_AllReduce_PP2 -->
<g id="edge708" class="edge">
<title>Layer_8_MLP_Out_TP0_PP2&#45;&gt;Layer_8_MLP_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13313.08,-9417.68C13319.97,-9408.89 13327.6,-9399.16 13335.13,-9389.56"/>
<polygon fill="black" stroke="black" points="13337.99,-9391.57 13341.41,-9381.54 13332.48,-9387.25 13337.99,-9391.57"/>
</g>
<!-- Layer_8_MLP_Out_TP1_PP2&#45;&gt;Layer_8_MLP_AllReduce_PP2 -->
<g id="edge710" class="edge">
<title>Layer_8_MLP_Out_TP1_PP2&#45;&gt;Layer_8_MLP_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13595.29,-9417.84C13565.42,-9406.43 13531.4,-9393.44 13499.29,-9381.18"/>
<polygon fill="black" stroke="black" points="13500.43,-9377.87 13489.84,-9377.57 13497.93,-9384.41 13500.43,-9377.87"/>
</g>
<!-- Layer_8_LayerNorm_PP2 -->
<g id="node451" class="node">
<title>Layer_8_LayerNorm_PP2</title>
<polygon fill="lightgreen" stroke="black" points="13566.5,-9249.78 13189.5,-9249.78 13189.5,-9181.78 13566.5,-9181.78 13566.5,-9249.78"/>
<text text-anchor="middle" x="13378" y="-9234.58" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13378" y="-9219.58" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13378" y="-9204.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13378" y="-9189.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_8_MLP_AllReduce_PP2&#45;&gt;Layer_8_LayerNorm_PP2 -->
<g id="edge711" class="edge">
<title>Layer_8_MLP_AllReduce_PP2&#45;&gt;Layer_8_LayerNorm_PP2</title>
<path fill="none" stroke="black" d="M13378,-9285.65C13378,-9277.26 13378,-9268.57 13378,-9260.29"/>
<polygon fill="black" stroke="black" points="13381.5,-9260.09 13378,-9250.09 13374.5,-9260.09 13381.5,-9260.09"/>
</g>
<!-- Layer_9_QKV_TP0_PP2 -->
<g id="node452" class="node">
<title>Layer_9_QKV_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13568.5,-9145.78 13187.5,-9145.78 13187.5,-9077.78 13568.5,-9077.78 13568.5,-9145.78"/>
<text text-anchor="middle" x="13378" y="-9130.58" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="13378" y="-9115.58" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="13378" y="-9100.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13378" y="-9085.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_8_LayerNorm_PP2&#45;&gt;Layer_9_QKV_TP0_PP2 -->
<g id="edge712" class="edge">
<title>Layer_8_LayerNorm_PP2&#45;&gt;Layer_9_QKV_TP0_PP2</title>
<path fill="none" stroke="black" d="M13378,-9181.67C13378,-9173.56 13378,-9164.76 13378,-9156.25"/>
<polygon fill="black" stroke="black" points="13381.5,-9156.08 13378,-9146.08 13374.5,-9156.08 13381.5,-9156.08"/>
</g>
<!-- Layer_9_QKV_AllReduce_PP2 -->
<g id="node454" class="node">
<title>Layer_9_QKV_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13070" cy="-8993.7" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="13070" y="-9012.5" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="13070" y="-8997.5" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13070" y="-8982.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="13070" y="-8967.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_9_QKV_TP0_PP2&#45;&gt;Layer_9_QKV_AllReduce_PP2 -->
<g id="edge713" class="edge">
<title>Layer_9_QKV_TP0_PP2&#45;&gt;Layer_9_QKV_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13290.15,-9077.67C13259.97,-9066.3 13225.6,-9053.34 13193.14,-9041.11"/>
<polygon fill="black" stroke="black" points="13194.18,-9037.76 13183.59,-9037.51 13191.72,-9044.31 13194.18,-9037.76"/>
</g>
<!-- Layer_9_QKV_TP1_PP2 -->
<g id="node453" class="node">
<title>Layer_9_QKV_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13169.5,-9145.78 12788.5,-9145.78 12788.5,-9077.78 13169.5,-9077.78 13169.5,-9145.78"/>
<text text-anchor="middle" x="12979" y="-9130.58" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="12979" y="-9115.58" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="12979" y="-9100.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12979" y="-9085.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_9_QKV_TP1_PP2&#45;&gt;Layer_9_QKV_AllReduce_PP2 -->
<g id="edge717" class="edge">
<title>Layer_9_QKV_TP1_PP2&#45;&gt;Layer_9_QKV_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13005.08,-9077.52C13011.97,-9068.72 13019.6,-9059 13027.13,-9049.39"/>
<polygon fill="black" stroke="black" points="13029.99,-9051.4 13033.41,-9041.38 13024.48,-9047.09 13029.99,-9051.4"/>
</g>
<!-- Layer_9_Attention_TP0_PP2 -->
<g id="node455" class="node">
<title>Layer_9_Attention_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13113.5,-8909.62 12732.5,-8909.62 12732.5,-8841.62 13113.5,-8841.62 13113.5,-8909.62"/>
<text text-anchor="middle" x="12923" y="-8894.42" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="12923" y="-8879.42" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12923" y="-8864.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12923" y="-8849.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_9_QKV_AllReduce_PP2&#45;&gt;Layer_9_Attention_TP0_PP2 -->
<g id="edge714" class="edge">
<title>Layer_9_QKV_AllReduce_PP2&#45;&gt;Layer_9_Attention_TP0_PP2</title>
<path fill="none" stroke="black" d="M13011.48,-8946.49C12998.74,-8936.42 12985.37,-8925.87 12972.99,-8916.09"/>
<polygon fill="black" stroke="black" points="12975.04,-8913.25 12965.02,-8909.8 12970.7,-8918.74 12975.04,-8913.25"/>
</g>
<!-- Layer_9_Attention_TP1_PP2 -->
<g id="node456" class="node">
<title>Layer_9_Attention_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13512.5,-8909.62 13131.5,-8909.62 13131.5,-8841.62 13512.5,-8841.62 13512.5,-8909.62"/>
<text text-anchor="middle" x="13322" y="-8894.42" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="13322" y="-8879.42" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="13322" y="-8864.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="13322" y="-8849.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_9_QKV_AllReduce_PP2&#45;&gt;Layer_9_Attention_TP1_PP2 -->
<g id="edge718" class="edge">
<title>Layer_9_QKV_AllReduce_PP2&#45;&gt;Layer_9_Attention_TP1_PP2</title>
<path fill="none" stroke="black" d="M13165.99,-8948.48C13190.67,-8937.11 13216.98,-8924.99 13240.83,-8914.01"/>
<polygon fill="black" stroke="black" points="13242.57,-8917.06 13250.19,-8909.69 13239.64,-8910.7 13242.57,-8917.06"/>
</g>
<!-- Layer_9_AttnOut_TP0_PP2 -->
<g id="node457" class="node">
<title>Layer_9_AttnOut_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13112.5,-8805.62 12735.5,-8805.62 12735.5,-8737.62 13112.5,-8737.62 13112.5,-8805.62"/>
<text text-anchor="middle" x="12924" y="-8790.42" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="12924" y="-8775.42" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12924" y="-8760.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12924" y="-8745.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Attention_TP0_PP2&#45;&gt;Layer_9_AttnOut_TP0_PP2 -->
<g id="edge715" class="edge">
<title>Layer_9_Attention_TP0_PP2&#45;&gt;Layer_9_AttnOut_TP0_PP2</title>
<path fill="none" stroke="black" d="M12923.32,-8841.5C12923.4,-8833.39 12923.49,-8824.6 12923.57,-8816.09"/>
<polygon fill="black" stroke="black" points="12927.08,-8815.95 12923.67,-8805.91 12920.08,-8815.88 12927.08,-8815.95"/>
</g>
<!-- Layer_9_AttnOut_TP1_PP2 -->
<g id="node458" class="node">
<title>Layer_9_AttnOut_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13509.5,-8805.62 13132.5,-8805.62 13132.5,-8737.62 13509.5,-8737.62 13509.5,-8805.62"/>
<text text-anchor="middle" x="13321" y="-8790.42" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="13321" y="-8775.42" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="13321" y="-8760.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="13321" y="-8745.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Attention_TP1_PP2&#45;&gt;Layer_9_AttnOut_TP1_PP2 -->
<g id="edge719" class="edge">
<title>Layer_9_Attention_TP1_PP2&#45;&gt;Layer_9_AttnOut_TP1_PP2</title>
<path fill="none" stroke="black" d="M13321.68,-8841.5C13321.6,-8833.39 13321.51,-8824.6 13321.43,-8816.09"/>
<polygon fill="black" stroke="black" points="13324.92,-8815.88 13321.33,-8805.91 13317.92,-8815.95 13324.92,-8815.88"/>
</g>
<!-- Layer_9_AttnOut_AllReduce_PP2 -->
<g id="node459" class="node">
<title>Layer_9_AttnOut_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13248" cy="-8653.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13248" y="-8672.33" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="13248" y="-8657.33" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13248" y="-8642.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13248" y="-8627.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_9_AttnOut_TP0_PP2&#45;&gt;Layer_9_AttnOut_AllReduce_PP2 -->
<g id="edge716" class="edge">
<title>Layer_9_AttnOut_TP0_PP2&#45;&gt;Layer_9_AttnOut_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13016.41,-8737.51C13048.81,-8725.9 13085.79,-8712.65 13120.55,-8700.19"/>
<polygon fill="black" stroke="black" points="13122.06,-8703.37 13130.29,-8696.71 13119.7,-8696.78 13122.06,-8703.37"/>
</g>
<!-- Layer_9_AttnOut_TP1_PP2&#45;&gt;Layer_9_AttnOut_AllReduce_PP2 -->
<g id="edge720" class="edge">
<title>Layer_9_AttnOut_TP1_PP2&#45;&gt;Layer_9_AttnOut_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13300.08,-8737.35C13294.73,-8728.84 13288.82,-8719.44 13282.97,-8710.14"/>
<polygon fill="black" stroke="black" points="13285.91,-8708.24 13277.63,-8701.64 13279.99,-8711.97 13285.91,-8708.24"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2 -->
<g id="node496" class="node">
<title>Layer_9_A2A_Dispatch_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13248" cy="-8521.37" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13248" y="-8540.17" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="13248" y="-8525.17" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13248" y="-8510.17" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13248" y="-8495.17" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_9_AttnOut_AllReduce_PP2&#45;&gt;Layer_9_A2A_Dispatch_PP2 -->
<g id="edge721" class="edge">
<title>Layer_9_AttnOut_AllReduce_PP2&#45;&gt;Layer_9_A2A_Dispatch_PP2</title>
<path fill="none" stroke="black" d="M13248,-8605.17C13248,-8596.9 13248,-8588.22 13248,-8579.72"/>
<polygon fill="black" stroke="black" points="13251.5,-8579.47 13248,-8569.47 13244.5,-8579.47 13251.5,-8579.47"/>
</g>
<!-- Layer_9_Gate_EP0_PP2 -->
<g id="node460" class="node">
<title>Layer_9_Gate_EP0_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15906.4,-10498.61 15302.86,-10498.61 15147.6,-10362.61 15751.14,-10362.61 15906.4,-10498.61"/>
<text text-anchor="middle" x="15527" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="15527" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="15527" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15527" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_9_Gate_EP1_PP2 -->
<g id="node461" class="node">
<title>Layer_9_Gate_EP1_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15129.4,-10498.61 14525.86,-10498.61 14370.6,-10362.61 14974.14,-10362.61 15129.4,-10498.61"/>
<text text-anchor="middle" x="14750" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="14750" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="14750" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14750" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_9_Gate_EP2_PP2 -->
<g id="node462" class="node">
<title>Layer_9_Gate_EP2_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="14352.4,-10498.61 13748.86,-10498.61 13593.6,-10362.61 14197.14,-10362.61 14352.4,-10498.61"/>
<text text-anchor="middle" x="13973" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="13973" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="13973" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13973" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_9_Gate_EP3_PP2 -->
<g id="node463" class="node">
<title>Layer_9_Gate_EP3_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="13575.4,-10498.61 12971.86,-10498.61 12816.6,-10362.61 13420.14,-10362.61 13575.4,-10498.61"/>
<text text-anchor="middle" x="13196" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="13196" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="13196" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13196" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_9_Expert_0_EP0_TP0_PP2 -->
<g id="node464" class="node">
<title>Layer_9_Expert_0_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7474.5,-8437.28 7097.5,-8437.28 7097.5,-8369.28 7474.5,-8369.28 7474.5,-8437.28"/>
<text text-anchor="middle" x="7286" y="-8422.08" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7286" y="-8407.08" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="7286" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7286" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_A2A_Combine_PP2 -->
<g id="node497" class="node">
<title>Layer_9_A2A_Combine_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13367" cy="-8285.2" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13367" y="-8304" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="13367" y="-8289" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13367" y="-8274" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13367" y="-8259" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_9_Expert_0_EP0_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge723" class="edge">
<title>Layer_9_Expert_0_EP0_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7474.66,-8370.08C7477.45,-8369.8 7480.24,-8369.53 7483,-8369.28 8043.7,-8318.66 12001.06,-8293.62 13090.16,-8287.63"/>
<polygon fill="black" stroke="black" points="13090.49,-8291.13 13100.47,-8287.58 13090.45,-8284.13 13090.49,-8291.13"/>
</g>
<!-- Layer_9_Expert_0_EP0_TP1_PP2 -->
<g id="node465" class="node">
<title>Layer_9_Expert_0_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7869.5,-8437.28 7492.5,-8437.28 7492.5,-8369.28 7869.5,-8369.28 7869.5,-8437.28"/>
<text text-anchor="middle" x="7681" y="-8422.08" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7681" y="-8407.08" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="7681" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7681" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_0_EP0_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge725" class="edge">
<title>Layer_9_Expert_0_EP0_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7869.66,-8370.08C7872.45,-8369.8 7875.24,-8369.53 7878,-8369.28 8397.95,-8322.07 12049.18,-8294.81 13090.43,-8287.94"/>
<polygon fill="black" stroke="black" points="13090.69,-8291.43 13100.67,-8287.87 13090.65,-8284.43 13090.69,-8291.43"/>
</g>
<!-- Layer_9_Expert_1_EP0_TP0_PP2 -->
<g id="node466" class="node">
<title>Layer_9_Expert_1_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8264.5,-8437.28 7887.5,-8437.28 7887.5,-8369.28 8264.5,-8369.28 8264.5,-8437.28"/>
<text text-anchor="middle" x="8076" y="-8422.08" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8076" y="-8407.08" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="8076" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8076" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_1_EP0_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge727" class="edge">
<title>Layer_9_Expert_1_EP0_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8264.66,-8370.09C8267.45,-8369.8 8270.24,-8369.53 8273,-8369.28 8752.3,-8325.48 12099,-8296.1 13090.7,-8288.28"/>
<polygon fill="black" stroke="black" points="13090.85,-8291.78 13100.82,-8288.2 13090.79,-8284.78 13090.85,-8291.78"/>
</g>
<!-- Layer_9_Expert_1_EP0_TP1_PP2 -->
<g id="node467" class="node">
<title>Layer_9_Expert_1_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8659.5,-8437.28 8282.5,-8437.28 8282.5,-8369.28 8659.5,-8369.28 8659.5,-8437.28"/>
<text text-anchor="middle" x="8471" y="-8422.08" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8471" y="-8407.08" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="8471" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8471" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_1_EP0_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge729" class="edge">
<title>Layer_9_Expert_1_EP0_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8659.66,-8370.09C8662.46,-8369.81 8665.24,-8369.54 8668,-8369.28 9534.35,-8289.51 12218.17,-8284.99 13090.22,-8285.7"/>
<polygon fill="black" stroke="black" points="13090.39,-8289.2 13100.39,-8285.71 13090.4,-8282.2 13090.39,-8289.2"/>
</g>
<!-- Layer_9_Expert_2_EP0_TP0_PP2 -->
<g id="node468" class="node">
<title>Layer_9_Expert_2_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9054.5,-8437.28 8677.5,-8437.28 8677.5,-8369.28 9054.5,-8369.28 9054.5,-8437.28"/>
<text text-anchor="middle" x="8866" y="-8422.08" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8866" y="-8407.08" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="8866" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8866" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_2_EP0_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge731" class="edge">
<title>Layer_9_Expert_2_EP0_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9054.66,-8370.1C9057.46,-8369.81 9060.24,-8369.54 9063,-8369.28 9848.88,-8296.27 12267.76,-8287.18 13090.06,-8286.23"/>
<polygon fill="black" stroke="black" points="13090.26,-8289.73 13100.26,-8286.22 13090.25,-8282.73 13090.26,-8289.73"/>
</g>
<!-- Layer_9_Expert_2_EP0_TP1_PP2 -->
<g id="node469" class="node">
<title>Layer_9_Expert_2_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9449.5,-8437.28 9072.5,-8437.28 9072.5,-8369.28 9449.5,-8369.28 9449.5,-8437.28"/>
<text text-anchor="middle" x="9261" y="-8422.08" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9261" y="-8407.08" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="9261" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9261" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_2_EP0_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge733" class="edge">
<title>Layer_9_Expert_2_EP0_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9449.66,-8370.11C9452.46,-8369.82 9455.24,-8369.54 9458,-8369.28 10163.87,-8303.01 12320.48,-8289.57 13090.31,-8286.87"/>
<polygon fill="black" stroke="black" points="13090.43,-8290.37 13100.42,-8286.84 13090.41,-8283.37 13090.43,-8290.37"/>
</g>
<!-- Layer_9_Expert_3_EP0_TP0_PP2 -->
<g id="node470" class="node">
<title>Layer_9_Expert_3_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9844.5,-8437.28 9467.5,-8437.28 9467.5,-8369.28 9844.5,-8369.28 9844.5,-8437.28"/>
<text text-anchor="middle" x="9656" y="-8422.08" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9656" y="-8407.08" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="9656" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9656" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_3_EP0_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge735" class="edge">
<title>Layer_9_Expert_3_EP0_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9844.66,-8370.12C9847.46,-8369.82 9850.24,-8369.54 9853,-8369.28 10479.15,-8309.74 12375.37,-8292.22 13090.27,-8287.65"/>
<polygon fill="black" stroke="black" points="13090.47,-8291.15 13100.45,-8287.59 13090.43,-8284.15 13090.47,-8291.15"/>
</g>
<!-- Layer_9_Expert_3_EP0_TP1_PP2 -->
<g id="node471" class="node">
<title>Layer_9_Expert_3_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10239.5,-8437.28 9862.5,-8437.28 9862.5,-8369.28 10239.5,-8369.28 10239.5,-8437.28"/>
<text text-anchor="middle" x="10051" y="-8422.08" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10051" y="-8407.08" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="10051" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10051" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_3_EP0_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge737" class="edge">
<title>Layer_9_Expert_3_EP0_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10239.66,-8370.13C10242.46,-8369.83 10245.24,-8369.55 10248,-8369.28 10795.06,-8316.44 12434.58,-8295.17 13090.92,-8288.62"/>
<polygon fill="black" stroke="black" points="13091.02,-8292.12 13100.99,-8288.52 13090.95,-8285.12 13091.02,-8292.12"/>
</g>
<!-- Layer_9_Expert_4_EP1_TP0_PP2 -->
<g id="node472" class="node">
<title>Layer_9_Expert_4_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10634.5,-8437.28 10257.5,-8437.28 10257.5,-8369.28 10634.5,-8369.28 10634.5,-8437.28"/>
<text text-anchor="middle" x="10446" y="-8422.08" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10446" y="-8407.08" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="10446" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10446" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_4_EP1_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge739" class="edge">
<title>Layer_9_Expert_4_EP1_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10634.66,-8370.14C10637.46,-8369.84 10640.24,-8369.55 10643,-8369.28 11111.32,-8323.13 12496.55,-8298.54 13090.98,-8289.86"/>
<polygon fill="black" stroke="black" points="13091.46,-8293.36 13101.41,-8289.71 13091.36,-8286.36 13091.46,-8293.36"/>
</g>
<!-- Layer_9_Expert_4_EP1_TP1_PP2 -->
<g id="node473" class="node">
<title>Layer_9_Expert_4_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11029.5,-8437.28 10652.5,-8437.28 10652.5,-8369.28 11029.5,-8369.28 11029.5,-8437.28"/>
<text text-anchor="middle" x="10841" y="-8422.08" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10841" y="-8407.08" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="10841" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10841" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_4_EP1_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge741" class="edge">
<title>Layer_9_Expert_4_EP1_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11029.66,-8370.16C11032.46,-8369.86 11035.24,-8369.56 11038,-8369.28 11428.55,-8329.77 12565.12,-8302.43 13092.4,-8291.5"/>
<polygon fill="black" stroke="black" points="13092.5,-8295 13102.43,-8291.29 13092.36,-8288 13092.5,-8295"/>
</g>
<!-- Layer_9_Expert_5_EP1_TP0_PP2 -->
<g id="node474" class="node">
<title>Layer_9_Expert_5_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11424.5,-8437.28 11047.5,-8437.28 11047.5,-8369.28 11424.5,-8369.28 11424.5,-8437.28"/>
<text text-anchor="middle" x="11236" y="-8422.08" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="11236" y="-8407.08" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="11236" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11236" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_5_EP1_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge743" class="edge">
<title>Layer_9_Expert_5_EP1_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11424.67,-8370.19C11427.46,-8369.87 11430.24,-8369.57 11433,-8369.28 12020.92,-8307.65 12713.97,-8291.49 13090.12,-8287.41"/>
<polygon fill="black" stroke="black" points="13090.37,-8290.91 13100.33,-8287.3 13090.29,-8283.91 13090.37,-8290.91"/>
</g>
<!-- Layer_9_Expert_5_EP1_TP1_PP2 -->
<g id="node475" class="node">
<title>Layer_9_Expert_5_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11819.5,-8437.28 11442.5,-8437.28 11442.5,-8369.28 11819.5,-8369.28 11819.5,-8437.28"/>
<text text-anchor="middle" x="11631" y="-8422.08" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="11631" y="-8407.08" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="11631" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11631" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_5_EP1_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge745" class="edge">
<title>Layer_9_Expert_5_EP1_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11819.67,-8370.23C11822.46,-8369.9 11825.24,-8369.59 11828,-8369.28 12268.65,-8320.64 12783.55,-8300.16 13092.02,-8291.76"/>
<polygon fill="black" stroke="black" points="13092.55,-8295.25 13102.45,-8291.48 13092.36,-8288.25 13092.55,-8295.25"/>
</g>
<!-- Layer_9_Expert_6_EP1_TP0_PP2 -->
<g id="node476" class="node">
<title>Layer_9_Expert_6_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12214.5,-8437.28 11837.5,-8437.28 11837.5,-8369.28 12214.5,-8369.28 12214.5,-8437.28"/>
<text text-anchor="middle" x="12026" y="-8422.08" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12026" y="-8407.08" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="12026" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12026" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_6_EP1_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge747" class="edge">
<title>Layer_9_Expert_6_EP1_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12214.68,-8370.31C12217.47,-8369.95 12220.25,-8369.61 12223,-8369.28 12522.18,-8333.44 12867.35,-8310.94 13099.63,-8298.54"/>
<polygon fill="black" stroke="black" points="13100.12,-8302.01 13109.92,-8297.99 13099.75,-8295.02 13100.12,-8302.01"/>
</g>
<!-- Layer_9_Expert_6_EP1_TP1_PP2 -->
<g id="node477" class="node">
<title>Layer_9_Expert_6_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12609.5,-8437.28 12232.5,-8437.28 12232.5,-8369.28 12609.5,-8369.28 12609.5,-8437.28"/>
<text text-anchor="middle" x="12421" y="-8422.08" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12421" y="-8407.08" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="12421" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12421" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_6_EP1_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge749" class="edge">
<title>Layer_9_Expert_6_EP1_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12609.7,-8370.45C12612.48,-8370.05 12615.25,-8369.66 12618,-8369.28 12786.63,-8345.82 12977.37,-8324.75 13124.16,-8309.69"/>
<polygon fill="black" stroke="black" points="13124.62,-8313.16 13134.21,-8308.66 13123.9,-8306.2 13124.62,-8313.16"/>
</g>
<!-- Layer_9_Expert_7_EP1_TP0_PP2 -->
<g id="node478" class="node">
<title>Layer_9_Expert_7_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13004.5,-8437.28 12627.5,-8437.28 12627.5,-8369.28 13004.5,-8369.28 13004.5,-8437.28"/>
<text text-anchor="middle" x="12816" y="-8422.08" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12816" y="-8407.08" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="12816" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12816" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_7_EP1_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge751" class="edge">
<title>Layer_9_Expert_7_EP1_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12972.79,-8369.25C13039.19,-8355.26 13116.97,-8338.87 13185.82,-8324.37"/>
<polygon fill="black" stroke="black" points="13186.84,-8327.73 13195.91,-8322.24 13185.4,-8320.88 13186.84,-8327.73"/>
</g>
<!-- Layer_9_Expert_7_EP1_TP1_PP2 -->
<g id="node479" class="node">
<title>Layer_9_Expert_7_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13399.5,-8437.28 13022.5,-8437.28 13022.5,-8369.28 13399.5,-8369.28 13399.5,-8437.28"/>
<text text-anchor="middle" x="13211" y="-8422.08" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="13211" y="-8407.08" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="13211" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13211" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_7_EP1_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge753" class="edge">
<title>Layer_9_Expert_7_EP1_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13255.7,-8369.02C13268.65,-8359.38 13283.1,-8348.63 13297.19,-8338.15"/>
<polygon fill="black" stroke="black" points="13299.5,-8340.79 13305.43,-8332.01 13295.32,-8335.17 13299.5,-8340.79"/>
</g>
<!-- Layer_9_Expert_8_EP2_TP0_PP2 -->
<g id="node480" class="node">
<title>Layer_9_Expert_8_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13794.5,-8437.28 13417.5,-8437.28 13417.5,-8369.28 13794.5,-8369.28 13794.5,-8437.28"/>
<text text-anchor="middle" x="13606" y="-8422.08" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="13606" y="-8407.08" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="13606" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13606" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_8_EP2_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge755" class="edge">
<title>Layer_9_Expert_8_EP2_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13537.83,-8369.17C13515.81,-8358.48 13490.92,-8346.39 13467.08,-8334.81"/>
<polygon fill="black" stroke="black" points="13468.53,-8331.62 13458.01,-8330.4 13465.47,-8337.92 13468.53,-8331.62"/>
</g>
<!-- Layer_9_Expert_8_EP2_TP1_PP2 -->
<g id="node481" class="node">
<title>Layer_9_Expert_8_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14189.5,-8437.28 13812.5,-8437.28 13812.5,-8369.28 14189.5,-8369.28 14189.5,-8437.28"/>
<text text-anchor="middle" x="14001" y="-8422.08" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="14001" y="-8407.08" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="14001" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14001" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_8_EP2_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge757" class="edge">
<title>Layer_9_Expert_8_EP2_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13820.59,-8369.25C13739.6,-8354.42 13643.91,-8336.9 13561.34,-8321.78"/>
<polygon fill="black" stroke="black" points="13561.8,-8318.31 13551.33,-8319.95 13560.54,-8325.19 13561.8,-8318.31"/>
</g>
<!-- Layer_9_Expert_9_EP2_TP0_PP2 -->
<g id="node482" class="node">
<title>Layer_9_Expert_9_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14584.5,-8437.28 14207.5,-8437.28 14207.5,-8369.28 14584.5,-8369.28 14584.5,-8437.28"/>
<text text-anchor="middle" x="14396" y="-8422.08" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14396" y="-8407.08" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="14396" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14396" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_9_EP2_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge759" class="edge">
<title>Layer_9_Expert_9_EP2_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14207.4,-8370.56C14204.24,-8370.12 14201.11,-8369.7 14198,-8369.28 14003.73,-8343.41 13782.94,-8321.7 13617.79,-8306.96"/>
<polygon fill="black" stroke="black" points="13617.76,-8303.45 13607.49,-8306.05 13617.14,-8310.42 13617.76,-8303.45"/>
</g>
<!-- Layer_9_Expert_9_EP2_TP1_PP2 -->
<g id="node483" class="node">
<title>Layer_9_Expert_9_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14979.5,-8437.28 14602.5,-8437.28 14602.5,-8369.28 14979.5,-8369.28 14979.5,-8437.28"/>
<text text-anchor="middle" x="14791" y="-8422.08" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14791" y="-8407.08" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="14791" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14791" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_9_EP2_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge761" class="edge">
<title>Layer_9_Expert_9_EP2_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14602.42,-8370.42C14599.26,-8370.03 14596.12,-8369.65 14593,-8369.28 14265.01,-8330.93 13885.43,-8308.58 13636.56,-8296.9"/>
<polygon fill="black" stroke="black" points="13636.44,-8293.4 13626.28,-8296.43 13636.11,-8300.39 13636.44,-8293.4"/>
</g>
<!-- Layer_9_Expert_10_EP2_TP0_PP2 -->
<g id="node484" class="node">
<title>Layer_9_Expert_10_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15374.5,-8437.28 14997.5,-8437.28 14997.5,-8369.28 15374.5,-8369.28 15374.5,-8437.28"/>
<text text-anchor="middle" x="15186" y="-8422.08" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15186" y="-8407.08" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="15186" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15186" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_10_EP2_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge763" class="edge">
<title>Layer_9_Expert_10_EP2_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14997.43,-8370.35C14994.26,-8369.98 14991.12,-8369.62 14988,-8369.28 14517.04,-8318.13 13965.59,-8298.33 13642.46,-8290.77"/>
<polygon fill="black" stroke="black" points="13642.09,-8287.26 13632.01,-8290.52 13641.93,-8294.26 13642.09,-8287.26"/>
</g>
<!-- Layer_9_Expert_10_EP2_TP1_PP2 -->
<g id="node485" class="node">
<title>Layer_9_Expert_10_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15769.5,-8437.28 15392.5,-8437.28 15392.5,-8369.28 15769.5,-8369.28 15769.5,-8437.28"/>
<text text-anchor="middle" x="15581" y="-8422.08" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15581" y="-8407.08" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="15581" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15581" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_10_EP2_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge765" class="edge">
<title>Layer_9_Expert_10_EP2_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15392.43,-8370.3C15389.26,-8369.95 15386.12,-8369.61 15383,-8369.28 14763.92,-8305.18 14033.08,-8290.04 13643.82,-8286.77"/>
<polygon fill="black" stroke="black" points="13643.57,-8283.27 13633.55,-8286.69 13643.52,-8290.27 13643.57,-8283.27"/>
</g>
<!-- Layer_9_Expert_11_EP2_TP0_PP2 -->
<g id="node486" class="node">
<title>Layer_9_Expert_11_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16164.5,-8437.28 15787.5,-8437.28 15787.5,-8369.28 16164.5,-8369.28 16164.5,-8437.28"/>
<text text-anchor="middle" x="15976" y="-8422.08" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="15976" y="-8407.08" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="15976" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15976" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_11_EP2_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge767" class="edge">
<title>Layer_9_Expert_11_EP2_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15787.43,-8370.27C15784.27,-8369.93 15781.12,-8369.59 15778,-8369.28 15371.41,-8328.57 14183.9,-8301.65 13642.16,-8291.15"/>
<polygon fill="black" stroke="black" points="13641.92,-8287.65 13631.85,-8290.95 13641.78,-8294.65 13641.92,-8287.65"/>
</g>
<!-- Layer_9_Expert_11_EP2_TP1_PP2 -->
<g id="node487" class="node">
<title>Layer_9_Expert_11_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16559.5,-8437.28 16182.5,-8437.28 16182.5,-8369.28 16559.5,-8369.28 16559.5,-8437.28"/>
<text text-anchor="middle" x="16371" y="-8422.08" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="16371" y="-8407.08" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="16371" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16371" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_11_EP2_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge769" class="edge">
<title>Layer_9_Expert_11_EP2_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16182.43,-8370.25C16179.27,-8369.91 16176.12,-8369.59 16173,-8369.28 15688.33,-8321.94 14250.44,-8297.88 13642.89,-8289.6"/>
<polygon fill="black" stroke="black" points="13642.73,-8286.1 13632.68,-8289.47 13642.63,-8293.1 13642.73,-8286.1"/>
</g>
<!-- Layer_9_Expert_12_EP3_TP0_PP2 -->
<g id="node488" class="node">
<title>Layer_9_Expert_12_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16954.5,-8437.28 16577.5,-8437.28 16577.5,-8369.28 16954.5,-8369.28 16954.5,-8437.28"/>
<text text-anchor="middle" x="16766" y="-8422.08" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="16766" y="-8407.08" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="16766" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16766" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_12_EP3_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge771" class="edge">
<title>Layer_9_Expert_12_EP3_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16577.44,-8370.24C16574.27,-8369.9 16571.12,-8369.58 16568,-8369.28 16004.64,-8315.29 14312.56,-8294.63 13643.56,-8288.43"/>
<polygon fill="black" stroke="black" points="13643.33,-8284.93 13633.3,-8288.34 13643.26,-8291.93 13643.33,-8284.93"/>
</g>
<!-- Layer_9_Expert_12_EP3_TP1_PP2 -->
<g id="node489" class="node">
<title>Layer_9_Expert_12_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17349.5,-8437.28 16972.5,-8437.28 16972.5,-8369.28 17349.5,-8369.28 17349.5,-8437.28"/>
<text text-anchor="middle" x="17161" y="-8422.08" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="17161" y="-8407.08" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="17161" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17161" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_12_EP3_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge773" class="edge">
<title>Layer_9_Expert_12_EP3_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16972.44,-8370.22C16969.27,-8369.89 16966.12,-8369.58 16963,-8369.28 16320.29,-8308.61 14370.14,-8291.75 13643.65,-8287.5"/>
<polygon fill="black" stroke="black" points="13643.6,-8284 13633.57,-8287.45 13643.55,-8291 13643.6,-8284"/>
</g>
<!-- Layer_9_Expert_13_EP3_TP0_PP2 -->
<g id="node490" class="node">
<title>Layer_9_Expert_13_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17744.5,-8437.28 17367.5,-8437.28 17367.5,-8369.28 17744.5,-8369.28 17744.5,-8437.28"/>
<text text-anchor="middle" x="17556" y="-8422.08" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17556" y="-8407.08" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="17556" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17556" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_13_EP3_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge775" class="edge">
<title>Layer_9_Expert_13_EP3_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17367.44,-8370.21C17364.27,-8369.88 17361.12,-8369.57 17358,-8369.28 16635.57,-8301.92 14424.95,-8289.17 13643.9,-8286.76"/>
<polygon fill="black" stroke="black" points="13643.65,-8283.26 13633.64,-8286.73 13643.63,-8290.26 13643.65,-8283.26"/>
</g>
<!-- Layer_9_Expert_13_EP3_TP1_PP2 -->
<g id="node491" class="node">
<title>Layer_9_Expert_13_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18139.5,-8437.28 17762.5,-8437.28 17762.5,-8369.28 18139.5,-8369.28 18139.5,-8437.28"/>
<text text-anchor="middle" x="17951" y="-8422.08" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17951" y="-8407.08" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="17951" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17951" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_13_EP3_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge777" class="edge">
<title>Layer_9_Expert_13_EP3_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17762.44,-8370.21C17759.27,-8369.88 17756.12,-8369.57 17753,-8369.28 16950.36,-8295.19 14476.39,-8286.82 13643.74,-8286.15"/>
<polygon fill="black" stroke="black" points="13643.72,-8282.65 13633.72,-8286.14 13643.72,-8289.65 13643.72,-8282.65"/>
</g>
<!-- Layer_9_Expert_14_EP3_TP0_PP2 -->
<g id="node492" class="node">
<title>Layer_9_Expert_14_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18534.5,-8437.28 18157.5,-8437.28 18157.5,-8369.28 18534.5,-8369.28 18534.5,-8437.28"/>
<text text-anchor="middle" x="18346" y="-8422.08" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="18346" y="-8407.08" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="18346" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18346" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_14_EP3_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge779" class="edge">
<title>Layer_9_Expert_14_EP3_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18157.44,-8370.2C18154.27,-8369.87 18151.12,-8369.57 18148,-8369.28 17264.95,-8288.47 14526.29,-8284.67 13643.96,-8285.63"/>
<polygon fill="black" stroke="black" points="13643.67,-8282.13 13633.67,-8285.64 13643.67,-8289.13 13643.67,-8282.13"/>
</g>
<!-- Layer_9_Expert_14_EP3_TP1_PP2 -->
<g id="node493" class="node">
<title>Layer_9_Expert_14_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18929.5,-8437.28 18552.5,-8437.28 18552.5,-8369.28 18929.5,-8369.28 18929.5,-8437.28"/>
<text text-anchor="middle" x="18741" y="-8422.08" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="18741" y="-8407.08" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="18741" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18741" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_14_EP3_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge781" class="edge">
<title>Layer_9_Expert_14_EP3_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18552.44,-8370.19C18549.27,-8369.87 18546.12,-8369.57 18543,-8369.28 18055.27,-8324.97 14645.67,-8295.89 13643.44,-8288.22"/>
<polygon fill="black" stroke="black" points="13643.23,-8284.72 13633.21,-8288.14 13643.18,-8291.72 13643.23,-8284.72"/>
</g>
<!-- Layer_9_Expert_15_EP3_TP0_PP2 -->
<g id="node494" class="node">
<title>Layer_9_Expert_15_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="19324.5,-8437.28 18947.5,-8437.28 18947.5,-8369.28 19324.5,-8369.28 19324.5,-8437.28"/>
<text text-anchor="middle" x="19136" y="-8422.08" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="19136" y="-8407.08" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="19136" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19136" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_15_EP3_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge783" class="edge">
<title>Layer_9_Expert_15_EP3_TP0_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18947.44,-8370.19C18944.27,-8369.87 18941.12,-8369.56 18938,-8369.28 18409.59,-8321.58 14695.01,-8294.62 13643.66,-8287.88"/>
<polygon fill="black" stroke="black" points="13643.34,-8284.38 13633.32,-8287.82 13643.29,-8291.38 13643.34,-8284.38"/>
</g>
<!-- Layer_9_Expert_15_EP3_TP1_PP2 -->
<g id="node495" class="node">
<title>Layer_9_Expert_15_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="19719.5,-8437.28 19342.5,-8437.28 19342.5,-8369.28 19719.5,-8369.28 19719.5,-8437.28"/>
<text text-anchor="middle" x="19531" y="-8422.08" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="19531" y="-8407.08" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="19531" y="-8392.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19531" y="-8377.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_Expert_15_EP3_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2 -->
<g id="edge785" class="edge">
<title>Layer_9_Expert_15_EP3_TP1_PP2&#45;&gt;Layer_9_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M19342.44,-8370.18C19339.27,-8369.86 19336.12,-8369.56 19333,-8369.28 18763.75,-8318.18 14741.91,-8293.44 13643.56,-8287.59"/>
<polygon fill="black" stroke="black" points="13643.58,-8284.09 13633.56,-8287.53 13643.54,-8291.09 13643.58,-8284.09"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_0_EP0_TP0_PP2 -->
<g id="edge722" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_0_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12981.48,-8518.9C11927.4,-8512.8 8078.63,-8487.34 7484.82,-8437.37"/>
<polygon fill="black" stroke="black" points="7484.92,-8433.87 7474.66,-8436.48 7484.31,-8440.84 7484.92,-8433.87"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_0_EP0_TP1_PP2 -->
<g id="edge724" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_0_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12981.85,-8518.6C11975.56,-8511.61 8432.77,-8483.98 7879.88,-8437.38"/>
<polygon fill="black" stroke="black" points="7879.92,-8433.87 7869.66,-8436.48 7879.31,-8440.84 7879.92,-8433.87"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_1_EP0_TP0_PP2 -->
<g id="edge726" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_1_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12981.85,-8518.25C12024.56,-8510.32 8786.38,-8480.62 8274.83,-8437.37"/>
<polygon fill="black" stroke="black" points="8274.93,-8433.86 8264.66,-8436.47 8274.31,-8440.84 8274.93,-8433.86"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_1_EP0_TP1_PP2 -->
<g id="edge728" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_1_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12981.12,-8520.71C12137.52,-8520.98 9533.8,-8515.37 8669.74,-8437.39"/>
<polygon fill="black" stroke="black" points="8669.93,-8433.89 8659.66,-8436.47 8669.3,-8440.86 8669.93,-8433.89"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_2_EP0_TP0_PP2 -->
<g id="edge730" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_2_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12981.25,-8520.17C12187.54,-8518.78 9848.06,-8508.65 9064.66,-8437.38"/>
<polygon fill="black" stroke="black" points="9064.94,-8433.89 9054.66,-8436.46 9064.29,-8440.87 9064.94,-8433.89"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_2_EP0_TP1_PP2 -->
<g id="edge732" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_2_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12981.57,-8519.52C12240.33,-8516.37 10162.84,-8501.96 9459.66,-8437.38"/>
<polygon fill="black" stroke="black" points="9459.94,-8433.9 9449.66,-8436.45 9459.29,-8440.87 9459.94,-8433.9"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_3_EP0_TP0_PP2 -->
<g id="edge734" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_3_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12981.76,-8518.72C12295.63,-8513.71 10477.92,-8495.29 9854.65,-8437.39"/>
<polygon fill="black" stroke="black" points="9854.94,-8433.9 9844.66,-8436.44 9854.29,-8440.87 9854.94,-8433.9"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_3_EP0_TP1_PP2 -->
<g id="edge736" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_3_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12982,-8517.72C12354.42,-8510.71 10794.02,-8488.66 10249.96,-8437.42"/>
<polygon fill="black" stroke="black" points="10249.95,-8433.9 10239.66,-8436.43 10249.28,-8440.87 10249.95,-8433.9"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_4_EP1_TP0_PP2 -->
<g id="edge738" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_4_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12982.56,-8516.42C12417.46,-8507.29 11109.8,-8482.07 10644.82,-8437.41"/>
<polygon fill="black" stroke="black" points="10644.96,-8433.9 10634.66,-8436.42 10644.27,-8440.87 10644.96,-8433.9"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_4_EP1_TP1_PP2 -->
<g id="edge740" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_4_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12983.71,-8514.69C12486.17,-8503.3 11426.51,-8475.53 11039.79,-8437.41"/>
<polygon fill="black" stroke="black" points="11039.96,-8433.91 11029.66,-8436.39 11039.27,-8440.88 11039.96,-8433.91"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_5_EP1_TP0_PP2 -->
<g id="edge742" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_5_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12981.97,-8518.18C12629.75,-8513.02 11989.4,-8495.78 11434.87,-8437.44"/>
<polygon fill="black" stroke="black" points="11434.98,-8433.93 11424.67,-8436.36 11434.24,-8440.89 11434.98,-8433.93"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_5_EP1_TP1_PP2 -->
<g id="edge744" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_5_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12984.91,-8513.44C12701.68,-8504.02 12237.92,-8482.95 11829.91,-8437.46"/>
<polygon fill="black" stroke="black" points="11830,-8433.95 11819.67,-8436.31 11829.22,-8440.91 11830,-8433.95"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_6_EP1_TP0_PP2 -->
<g id="edge746" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_6_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12995.44,-8505.9C12790.14,-8492.72 12492.91,-8470.41 12224.62,-8437.45"/>
<polygon fill="black" stroke="black" points="12225.04,-8433.98 12214.68,-8436.23 12224.18,-8440.93 12225.04,-8433.98"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_6_EP1_TP1_PP2 -->
<g id="edge748" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_6_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M13030.16,-8493.54C12911.55,-8478.46 12761.99,-8458.7 12619.93,-8437.56"/>
<polygon fill="black" stroke="black" points="12620.12,-8434.05 12609.71,-8436.03 12619.08,-8440.97 12620.12,-8434.05"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_7_EP1_TP0_PP2 -->
<g id="edge750" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_7_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M13101.74,-8481.06C13052.28,-8467.77 12997.35,-8453.01 12948.97,-8440.01"/>
<polygon fill="black" stroke="black" points="12949.64,-8436.57 12939.07,-8437.35 12947.82,-8443.33 12949.64,-8436.57"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_7_EP1_TP1_PP2 -->
<g id="edge752" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_7_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M13232.95,-8473.15C13230.22,-8464.58 13227.38,-8455.68 13224.69,-8447.24"/>
<polygon fill="black" stroke="black" points="13227.99,-8446.05 13221.62,-8437.59 13221.32,-8448.18 13227.99,-8446.05"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_8_EP2_TP0_PP2 -->
<g id="edge754" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_8_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13375.48,-8479.03C13414.2,-8466.47 13456.45,-8452.78 13494.07,-8440.58"/>
<polygon fill="black" stroke="black" points="13495.61,-8443.76 13504.04,-8437.34 13493.45,-8437.1 13495.61,-8443.76"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_8_EP2_TP1_PP2 -->
<g id="edge756" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_8_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13452.73,-8490.54C13554.79,-8475.47 13680.34,-8456.63 13802.46,-8437.36"/>
<polygon fill="black" stroke="black" points="13803.04,-8440.81 13812.37,-8435.79 13801.94,-8433.9 13803.04,-8440.81"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_9_EP2_TP0_PP2 -->
<g id="edge758" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_9_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13496.6,-8503.95C13685.96,-8490.17 13953.24,-8468.01 14197.27,-8437.34"/>
<polygon fill="black" stroke="black" points="14197.92,-8440.79 14207.41,-8436.06 14197.05,-8433.84 14197.92,-8440.79"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_9_EP2_TP1_PP2 -->
<g id="edge760" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_9_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13510,-8512.2C13779.19,-8501.96 14210.37,-8480.38 14592.27,-8437.32"/>
<polygon fill="black" stroke="black" points="14592.88,-8440.78 14602.42,-8436.17 14592.09,-8433.82 14592.88,-8440.78"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_10_EP2_TP0_PP2 -->
<g id="edge762" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_10_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13513.68,-8517.36C13853.42,-8511.32 14459.81,-8493.11 14987.33,-8437.31"/>
<polygon fill="black" stroke="black" points="14987.85,-8440.77 14997.43,-8436.23 14987.11,-8433.81 14987.85,-8440.77"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_10_EP2_TP1_PP2 -->
<g id="edge764" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_10_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13514.62,-8520.77C13917.48,-8518.97 14705.27,-8506 15382.47,-8437.29"/>
<polygon fill="black" stroke="black" points="15382.84,-8440.77 15392.43,-8436.27 15382.13,-8433.8 15382.84,-8440.77"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_11_EP2_TP0_PP2 -->
<g id="edge766" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_11_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13513.14,-8516.11C14065.76,-8506.51 15326.06,-8480.65 15777.25,-8437.29"/>
<polygon fill="black" stroke="black" points="15777.82,-8440.75 15787.43,-8436.3 15777.14,-8433.79 15777.82,-8440.75"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_11_EP2_TP1_PP2 -->
<g id="edge768" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_11_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13513.93,-8517.47C14130.09,-8510.01 15642.55,-8487.19 16172.4,-8437.28"/>
<polygon fill="black" stroke="black" points="16172.81,-8440.75 16182.44,-8436.32 16172.15,-8433.78 16172.81,-8440.75"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_12_EP3_TP0_PP2 -->
<g id="edge770" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_12_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13514.21,-8518.52C14189.45,-8513.07 15957.8,-8493.79 16567.22,-8437.29"/>
<polygon fill="black" stroke="black" points="16567.81,-8440.75 16577.44,-8436.33 16567.15,-8433.78 16567.81,-8440.75"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_12_EP3_TP1_PP2 -->
<g id="edge772" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_12_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13514.42,-8519.35C14245.42,-8515.79 16273.28,-8500.41 16962.39,-8437.28"/>
<polygon fill="black" stroke="black" points="16962.8,-8440.75 16972.44,-8436.34 16962.16,-8433.78 16962.8,-8440.75"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_13_EP3_TP0_PP2 -->
<g id="edge774" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_13_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13514.49,-8520.03C14298.21,-8518.23 16587.94,-8507.07 17357.34,-8437.28"/>
<polygon fill="black" stroke="black" points="17357.8,-8440.75 17367.44,-8436.35 17357.16,-8433.78 17357.8,-8440.75"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_13_EP3_TP1_PP2 -->
<g id="edge776" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_13_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13514.55,-8520.58C14348.47,-8520.46 16902.12,-8513.76 17752.21,-8437.29"/>
<polygon fill="black" stroke="black" points="17752.8,-8440.75 17762.44,-8436.36 17752.16,-8433.78 17752.8,-8440.75"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_14_EP3_TP0_PP2 -->
<g id="edge778" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_14_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13514.71,-8521.05C14396.85,-8522.52 17216.41,-8520.46 18147.25,-8437.29"/>
<polygon fill="black" stroke="black" points="18147.8,-8440.75 18157.44,-8436.37 18147.17,-8433.78 18147.8,-8440.75"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_14_EP3_TP1_PP2 -->
<g id="edge780" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_14_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13514.29,-8518.52C14511.67,-8511.31 17996.71,-8483.13 18542.34,-8437.25"/>
<polygon fill="black" stroke="black" points="18542.78,-8440.73 18552.44,-8436.37 18542.17,-8433.75 18542.78,-8440.73"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_15_EP3_TP0_PP2 -->
<g id="edge782" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_15_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13514.62,-8518.84C14560.07,-8512.51 18350.81,-8486.47 18937.4,-8437.25"/>
<polygon fill="black" stroke="black" points="18937.78,-8440.73 18947.44,-8436.38 18937.18,-8433.76 18937.78,-8440.73"/>
</g>
<!-- Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_15_EP3_TP1_PP2 -->
<g id="edge784" class="edge">
<title>Layer_9_A2A_Dispatch_PP2&#45;&gt;Layer_9_Expert_15_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13514.75,-8519.11C14606.2,-8513.64 18703.34,-8489.84 19332.12,-8437.27"/>
<polygon fill="black" stroke="black" points="19332.78,-8440.73 19342.44,-8436.38 19332.18,-8433.76 19332.78,-8440.73"/>
</g>
<!-- Layer_9_MLP_Out_TP0_PP2 -->
<g id="node498" class="node">
<title>Layer_9_MLP_Out_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13239.5,-8201.12 12862.5,-8201.12 12862.5,-8133.12 13239.5,-8133.12 13239.5,-8201.12"/>
<text text-anchor="middle" x="13051" y="-8185.92" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="13051" y="-8170.92" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="13051" y="-8155.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13051" y="-8140.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_A2A_Combine_PP2&#45;&gt;Layer_9_MLP_Out_TP0_PP2 -->
<g id="edge786" class="edge">
<title>Layer_9_A2A_Combine_PP2&#45;&gt;Layer_9_MLP_Out_TP0_PP2</title>
<path fill="none" stroke="black" d="M13251.58,-8241.8C13218.36,-8229.6 13182.43,-8216.4 13150.28,-8204.59"/>
<polygon fill="black" stroke="black" points="13151.47,-8201.29 13140.88,-8201.13 13149.06,-8207.87 13151.47,-8201.29"/>
</g>
<!-- Layer_9_MLP_Out_TP1_PP2 -->
<g id="node499" class="node">
<title>Layer_9_MLP_Out_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13634.5,-8201.12 13257.5,-8201.12 13257.5,-8133.12 13634.5,-8133.12 13634.5,-8201.12"/>
<text text-anchor="middle" x="13446" y="-8185.92" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="13446" y="-8170.92" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="13446" y="-8155.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13446" y="-8140.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_9_A2A_Combine_PP2&#45;&gt;Layer_9_MLP_Out_TP1_PP2 -->
<g id="edge788" class="edge">
<title>Layer_9_A2A_Combine_PP2&#45;&gt;Layer_9_MLP_Out_TP1_PP2</title>
<path fill="none" stroke="black" d="M13398.9,-8237.32C13405.14,-8228.16 13411.63,-8218.62 13417.73,-8209.65"/>
<polygon fill="black" stroke="black" points="13420.71,-8211.5 13423.44,-8201.26 13414.92,-8207.56 13420.71,-8211.5"/>
</g>
<!-- Layer_9_MLP_AllReduce_PP2 -->
<g id="node500" class="node">
<title>Layer_9_MLP_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13129" cy="-8049.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13129" y="-8067.83" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="13129" y="-8052.83" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13129" y="-8037.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13129" y="-8022.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_9_MLP_Out_TP0_PP2&#45;&gt;Layer_9_MLP_AllReduce_PP2 -->
<g id="edge787" class="edge">
<title>Layer_9_MLP_Out_TP0_PP2&#45;&gt;Layer_9_MLP_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13073.35,-8132.85C13079.07,-8124.34 13085.38,-8114.95 13091.64,-8105.64"/>
<polygon fill="black" stroke="black" points="13094.67,-8107.39 13097.35,-8097.14 13088.86,-8103.49 13094.67,-8107.39"/>
</g>
<!-- Layer_9_MLP_Out_TP1_PP2&#45;&gt;Layer_9_MLP_AllReduce_PP2 -->
<g id="edge789" class="edge">
<title>Layer_9_MLP_Out_TP1_PP2&#45;&gt;Layer_9_MLP_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13355.58,-8133.01C13324.05,-8121.46 13288.08,-8108.29 13254.23,-8095.89"/>
<polygon fill="black" stroke="black" points="13255.34,-8092.57 13244.75,-8092.42 13252.93,-8099.14 13255.34,-8092.57"/>
</g>
<!-- Layer_9_LayerNorm_PP2 -->
<g id="node501" class="node">
<title>Layer_9_LayerNorm_PP2</title>
<polygon fill="lightgreen" stroke="black" points="13317.5,-7964.95 12940.5,-7964.95 12940.5,-7896.95 13317.5,-7896.95 13317.5,-7964.95"/>
<text text-anchor="middle" x="13129" y="-7949.75" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13129" y="-7934.75" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13129" y="-7919.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13129" y="-7904.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_9_MLP_AllReduce_PP2&#45;&gt;Layer_9_LayerNorm_PP2 -->
<g id="edge790" class="edge">
<title>Layer_9_MLP_AllReduce_PP2&#45;&gt;Layer_9_LayerNorm_PP2</title>
<path fill="none" stroke="black" d="M13129,-8000.82C13129,-7992.43 13129,-7983.73 13129,-7975.46"/>
<polygon fill="black" stroke="black" points="13132.5,-7975.25 13129,-7965.25 13125.5,-7975.25 13132.5,-7975.25"/>
</g>
<!-- Layer_10_QKV_TP0_PP2 -->
<g id="node502" class="node">
<title>Layer_10_QKV_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13319.5,-7860.95 12938.5,-7860.95 12938.5,-7792.95 13319.5,-7792.95 13319.5,-7860.95"/>
<text text-anchor="middle" x="13129" y="-7845.75" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="13129" y="-7830.75" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="13129" y="-7815.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13129" y="-7800.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_9_LayerNorm_PP2&#45;&gt;Layer_10_QKV_TP0_PP2 -->
<g id="edge791" class="edge">
<title>Layer_9_LayerNorm_PP2&#45;&gt;Layer_10_QKV_TP0_PP2</title>
<path fill="none" stroke="black" d="M13129,-7896.83C13129,-7888.73 13129,-7879.93 13129,-7871.42"/>
<polygon fill="black" stroke="black" points="13132.5,-7871.25 13129,-7861.25 13125.5,-7871.25 13132.5,-7871.25"/>
</g>
<!-- Layer_10_QKV_AllReduce_PP2 -->
<g id="node504" class="node">
<title>Layer_10_QKV_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="12881" cy="-7708.87" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="12881" y="-7727.67" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="12881" y="-7712.67" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="12881" y="-7697.67" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="12881" y="-7682.67" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_10_QKV_TP0_PP2&#45;&gt;Layer_10_QKV_AllReduce_PP2 -->
<g id="edge792" class="edge">
<title>Layer_10_QKV_TP0_PP2&#45;&gt;Layer_10_QKV_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13058.27,-7792.84C13035.31,-7782.1 13009.36,-7769.95 12984.52,-7758.32"/>
<polygon fill="black" stroke="black" points="12985.98,-7755.14 12975.44,-7754.07 12983.01,-7761.48 12985.98,-7755.14"/>
</g>
<!-- Layer_10_QKV_TP1_PP2 -->
<g id="node503" class="node">
<title>Layer_10_QKV_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="12920.5,-7860.95 12539.5,-7860.95 12539.5,-7792.95 12920.5,-7792.95 12920.5,-7860.95"/>
<text text-anchor="middle" x="12730" y="-7845.75" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="12730" y="-7830.75" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="12730" y="-7815.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12730" y="-7800.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_10_QKV_TP1_PP2&#45;&gt;Layer_10_QKV_AllReduce_PP2 -->
<g id="edge796" class="edge">
<title>Layer_10_QKV_TP1_PP2&#45;&gt;Layer_10_QKV_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M12773.27,-7792.68C12785.73,-7783.11 12799.63,-7772.42 12813.19,-7761.99"/>
<polygon fill="black" stroke="black" points="12815.33,-7764.76 12821.13,-7755.9 12811.06,-7759.22 12815.33,-7764.76"/>
</g>
<!-- Layer_10_Attention_TP0_PP2 -->
<g id="node505" class="node">
<title>Layer_10_Attention_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="12747.5,-7624.78 12366.5,-7624.78 12366.5,-7556.78 12747.5,-7556.78 12747.5,-7624.78"/>
<text text-anchor="middle" x="12557" y="-7609.58" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="12557" y="-7594.58" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12557" y="-7579.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12557" y="-7564.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_10_QKV_AllReduce_PP2&#45;&gt;Layer_10_Attention_TP0_PP2 -->
<g id="edge793" class="edge">
<title>Layer_10_QKV_AllReduce_PP2&#45;&gt;Layer_10_Attention_TP0_PP2</title>
<path fill="none" stroke="black" d="M12762.19,-7665.3C12728.25,-7653.14 12691.58,-7640 12658.75,-7628.24"/>
<polygon fill="black" stroke="black" points="12659.74,-7624.88 12649.15,-7624.8 12657.38,-7631.47 12659.74,-7624.88"/>
</g>
<!-- Layer_10_Attention_TP1_PP2 -->
<g id="node506" class="node">
<title>Layer_10_Attention_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13146.5,-7624.78 12765.5,-7624.78 12765.5,-7556.78 13146.5,-7556.78 13146.5,-7624.78"/>
<text text-anchor="middle" x="12956" y="-7609.58" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="12956" y="-7594.58" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="12956" y="-7579.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12956" y="-7564.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_10_QKV_AllReduce_PP2&#45;&gt;Layer_10_Attention_TP1_PP2 -->
<g id="edge797" class="edge">
<title>Layer_10_QKV_AllReduce_PP2&#45;&gt;Layer_10_Attention_TP1_PP2</title>
<path fill="none" stroke="black" d="M12911.29,-7660.98C12917.14,-7651.92 12923.24,-7642.49 12928.98,-7633.6"/>
<polygon fill="black" stroke="black" points="12932.1,-7635.23 12934.58,-7624.93 12926.22,-7631.43 12932.1,-7635.23"/>
</g>
<!-- Layer_10_AttnOut_TP0_PP2 -->
<g id="node507" class="node">
<title>Layer_10_AttnOut_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="12746.5,-7520.78 12369.5,-7520.78 12369.5,-7452.78 12746.5,-7452.78 12746.5,-7520.78"/>
<text text-anchor="middle" x="12558" y="-7505.58" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="12558" y="-7490.58" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12558" y="-7475.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12558" y="-7460.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Attention_TP0_PP2&#45;&gt;Layer_10_AttnOut_TP0_PP2 -->
<g id="edge794" class="edge">
<title>Layer_10_Attention_TP0_PP2&#45;&gt;Layer_10_AttnOut_TP0_PP2</title>
<path fill="none" stroke="black" d="M12557.32,-7556.67C12557.4,-7548.56 12557.49,-7539.76 12557.57,-7531.25"/>
<polygon fill="black" stroke="black" points="12561.08,-7531.12 12557.67,-7521.08 12554.08,-7531.05 12561.08,-7531.12"/>
</g>
<!-- Layer_10_AttnOut_TP1_PP2 -->
<g id="node508" class="node">
<title>Layer_10_AttnOut_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13143.5,-7520.78 12766.5,-7520.78 12766.5,-7452.78 13143.5,-7452.78 13143.5,-7520.78"/>
<text text-anchor="middle" x="12955" y="-7505.58" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="12955" y="-7490.58" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="12955" y="-7475.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12955" y="-7460.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Attention_TP1_PP2&#45;&gt;Layer_10_AttnOut_TP1_PP2 -->
<g id="edge798" class="edge">
<title>Layer_10_Attention_TP1_PP2&#45;&gt;Layer_10_AttnOut_TP1_PP2</title>
<path fill="none" stroke="black" d="M12955.68,-7556.67C12955.6,-7548.56 12955.51,-7539.76 12955.43,-7531.25"/>
<polygon fill="black" stroke="black" points="12958.92,-7531.05 12955.33,-7521.08 12951.92,-7531.12 12958.92,-7531.05"/>
</g>
<!-- Layer_10_AttnOut_AllReduce_PP2 -->
<g id="node509" class="node">
<title>Layer_10_AttnOut_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="12795" cy="-7368.7" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="12795" y="-7387.5" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="12795" y="-7372.5" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="12795" y="-7357.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12795" y="-7342.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_10_AttnOut_TP0_PP2&#45;&gt;Layer_10_AttnOut_AllReduce_PP2 -->
<g id="edge795" class="edge">
<title>Layer_10_AttnOut_TP0_PP2&#45;&gt;Layer_10_AttnOut_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M12625.6,-7452.67C12647.22,-7442.08 12671.63,-7430.13 12695.05,-7418.66"/>
<polygon fill="black" stroke="black" points="12696.87,-7421.66 12704.32,-7414.12 12693.8,-7415.37 12696.87,-7421.66"/>
</g>
<!-- Layer_10_AttnOut_TP1_PP2&#45;&gt;Layer_10_AttnOut_AllReduce_PP2 -->
<g id="edge799" class="edge">
<title>Layer_10_AttnOut_TP1_PP2&#45;&gt;Layer_10_AttnOut_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M12909.15,-7452.52C12895.87,-7442.88 12881.05,-7432.13 12866.6,-7421.65"/>
<polygon fill="black" stroke="black" points="12868.3,-7418.55 12858.15,-7415.51 12864.19,-7424.22 12868.3,-7418.55"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2 -->
<g id="node546" class="node">
<title>Layer_10_A2A_Dispatch_PP2</title>
<ellipse fill="yellow" stroke="black" cx="12795" cy="-7236.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="12795" y="-7255.33" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="12795" y="-7240.33" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="12795" y="-7225.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12795" y="-7210.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_10_AttnOut_AllReduce_PP2&#45;&gt;Layer_10_A2A_Dispatch_PP2 -->
<g id="edge800" class="edge">
<title>Layer_10_AttnOut_AllReduce_PP2&#45;&gt;Layer_10_A2A_Dispatch_PP2</title>
<path fill="none" stroke="black" d="M12795,-7320.34C12795,-7312.07 12795,-7303.39 12795,-7294.88"/>
<polygon fill="black" stroke="black" points="12798.5,-7294.64 12795,-7284.64 12791.5,-7294.64 12798.5,-7294.64"/>
</g>
<!-- Layer_10_Gate_EP0_PP2 -->
<g id="node510" class="node">
<title>Layer_10_Gate_EP0_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="12798.4,-10498.61 12194.86,-10498.61 12039.6,-10362.61 12643.14,-10362.61 12798.4,-10498.61"/>
<text text-anchor="middle" x="12419" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="12419" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="12419" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12419" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_10_Gate_EP1_PP2 -->
<g id="node511" class="node">
<title>Layer_10_Gate_EP1_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="12021.4,-10498.61 11417.86,-10498.61 11262.6,-10362.61 11866.14,-10362.61 12021.4,-10498.61"/>
<text text-anchor="middle" x="11642" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="11642" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="11642" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11642" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_10_Gate_EP2_PP2 -->
<g id="node512" class="node">
<title>Layer_10_Gate_EP2_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="11244.4,-10498.61 10640.86,-10498.61 10485.6,-10362.61 11089.14,-10362.61 11244.4,-10498.61"/>
<text text-anchor="middle" x="10865" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="10865" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="10865" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10865" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_10_Gate_EP3_PP2 -->
<g id="node513" class="node">
<title>Layer_10_Gate_EP3_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="10467.4,-10498.61 9863.86,-10498.61 9708.6,-10362.61 10312.14,-10362.61 10467.4,-10498.61"/>
<text text-anchor="middle" x="10088" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="10088" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="10088" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10088" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_10_Expert_0_EP0_TP0_PP2 -->
<g id="node514" class="node">
<title>Layer_10_Expert_0_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="6978.5,-7152.45 6601.5,-7152.45 6601.5,-7084.45 6978.5,-7084.45 6978.5,-7152.45"/>
<text text-anchor="middle" x="6790" y="-7137.25" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6790" y="-7122.25" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="6790" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6790" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_A2A_Combine_PP2 -->
<g id="node547" class="node">
<title>Layer_10_A2A_Combine_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13048" cy="-7000.37" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13048" y="-7019.17" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="13048" y="-7004.17" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13048" y="-6989.17" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13048" y="-6974.17" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_10_Expert_0_EP0_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge802" class="edge">
<title>Layer_10_Expert_0_EP0_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M6978.66,-7085.24C6981.45,-7084.96 6984.24,-7084.7 6987,-7084.45 7566.03,-7032.29 11661.58,-7008.27 12771.27,-7002.68"/>
<polygon fill="black" stroke="black" points="12771.39,-7006.18 12781.38,-7002.63 12771.36,-6999.18 12771.39,-7006.18"/>
</g>
<!-- Layer_10_Expert_0_EP0_TP1_PP2 -->
<g id="node515" class="node">
<title>Layer_10_Expert_0_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7373.5,-7152.45 6996.5,-7152.45 6996.5,-7084.45 7373.5,-7084.45 7373.5,-7152.45"/>
<text text-anchor="middle" x="7185" y="-7137.25" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7185" y="-7122.25" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="7185" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7185" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_0_EP0_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge804" class="edge">
<title>Layer_10_Expert_0_EP0_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7373.66,-7085.25C7376.45,-7084.97 7379.24,-7084.7 7382,-7084.45 7920.24,-7035.7 11709,-7009.43 12771.55,-7002.96"/>
<polygon fill="black" stroke="black" points="12771.64,-7006.46 12781.62,-7002.9 12771.59,-6999.46 12771.64,-7006.46"/>
</g>
<!-- Layer_10_Expert_1_EP0_TP0_PP2 -->
<g id="node516" class="node">
<title>Layer_10_Expert_1_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7768.5,-7152.45 7391.5,-7152.45 7391.5,-7084.45 7768.5,-7084.45 7768.5,-7152.45"/>
<text text-anchor="middle" x="7580" y="-7137.25" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7580" y="-7122.25" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="7580" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7580" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_1_EP0_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge806" class="edge">
<title>Layer_10_Expert_1_EP0_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7768.66,-7085.25C7771.45,-7084.97 7774.24,-7084.7 7777,-7084.45 8274.45,-7039.12 11756.78,-7010.68 12771.28,-7003.29"/>
<polygon fill="black" stroke="black" points="12771.66,-7006.79 12781.64,-7003.22 12771.61,-6999.79 12771.66,-7006.79"/>
</g>
<!-- Layer_10_Expert_1_EP0_TP1_PP2 -->
<g id="node517" class="node">
<title>Layer_10_Expert_1_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8163.5,-7152.45 7786.5,-7152.45 7786.5,-7084.45 8163.5,-7084.45 8163.5,-7152.45"/>
<text text-anchor="middle" x="7975" y="-7137.25" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7975" y="-7122.25" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="7975" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7975" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_1_EP0_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge808" class="edge">
<title>Layer_10_Expert_1_EP0_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8163.66,-7085.26C8166.46,-7084.97 8169.24,-7084.7 8172,-7084.45 9074.39,-7001.65 11876.94,-6999.23 12770.95,-7000.66"/>
<polygon fill="black" stroke="black" points="12771.05,-7004.16 12781.06,-7000.67 12771.06,-6997.16 12771.05,-7004.16"/>
</g>
<!-- Layer_10_Expert_2_EP0_TP0_PP2 -->
<g id="node518" class="node">
<title>Layer_10_Expert_2_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8558.5,-7152.45 8181.5,-7152.45 8181.5,-7084.45 8558.5,-7084.45 8558.5,-7152.45"/>
<text text-anchor="middle" x="8370" y="-7137.25" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8370" y="-7122.25" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="8370" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8370" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_2_EP0_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge810" class="edge">
<title>Layer_10_Expert_2_EP0_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8558.66,-7085.26C8561.46,-7084.98 8564.24,-7084.7 8567,-7084.45 9388.93,-7008.41 11926.48,-7001.34 12771.24,-7001.15"/>
<polygon fill="black" stroke="black" points="12771.4,-7004.65 12781.4,-7001.15 12771.4,-6997.65 12771.4,-7004.65"/>
</g>
<!-- Layer_10_Expert_2_EP0_TP1_PP2 -->
<g id="node519" class="node">
<title>Layer_10_Expert_2_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8953.5,-7152.45 8576.5,-7152.45 8576.5,-7084.45 8953.5,-7084.45 8953.5,-7152.45"/>
<text text-anchor="middle" x="8765" y="-7137.25" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8765" y="-7122.25" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="8765" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8765" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_2_EP0_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge812" class="edge">
<title>Layer_10_Expert_2_EP0_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8953.66,-7085.27C8956.46,-7084.98 8959.24,-7084.71 8962,-7084.45 9703.68,-7015.16 11977.53,-7003.64 12771.19,-7001.74"/>
<polygon fill="black" stroke="black" points="12771.33,-7005.24 12781.32,-7001.71 12771.31,-6998.24 12771.33,-7005.24"/>
</g>
<!-- Layer_10_Expert_3_EP0_TP0_PP2 -->
<g id="node520" class="node">
<title>Layer_10_Expert_3_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9348.5,-7152.45 8971.5,-7152.45 8971.5,-7084.45 9348.5,-7084.45 9348.5,-7152.45"/>
<text text-anchor="middle" x="9160" y="-7137.25" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9160" y="-7122.25" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="9160" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9160" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_3_EP0_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge814" class="edge">
<title>Layer_10_Expert_3_EP0_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9348.66,-7085.28C9351.46,-7084.99 9354.24,-7084.71 9357,-7084.45 10018.75,-7021.9 12031.01,-7006.17 12771.07,-7002.45"/>
<polygon fill="black" stroke="black" points="12771.35,-7005.95 12781.33,-7002.4 12771.31,-6998.95 12771.35,-7005.95"/>
</g>
<!-- Layer_10_Expert_3_EP0_TP1_PP2 -->
<g id="node521" class="node">
<title>Layer_10_Expert_3_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9743.5,-7152.45 9366.5,-7152.45 9366.5,-7084.45 9743.5,-7084.45 9743.5,-7152.45"/>
<text text-anchor="middle" x="9555" y="-7137.25" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9555" y="-7122.25" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="9555" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9555" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_3_EP0_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge816" class="edge">
<title>Layer_10_Expert_3_EP0_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9743.66,-7085.29C9746.46,-7084.99 9749.24,-7084.71 9752,-7084.45 10334.44,-7028.61 12088.65,-7008.97 12771.64,-7003.32"/>
<polygon fill="black" stroke="black" points="12771.89,-7006.82 12781.86,-7003.24 12771.83,-6999.82 12771.89,-7006.82"/>
</g>
<!-- Layer_10_Expert_4_EP1_TP0_PP2 -->
<g id="node522" class="node">
<title>Layer_10_Expert_4_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10138.5,-7152.45 9761.5,-7152.45 9761.5,-7084.45 10138.5,-7084.45 10138.5,-7152.45"/>
<text text-anchor="middle" x="9950" y="-7137.25" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="9950" y="-7122.25" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="9950" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9950" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_4_EP1_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge818" class="edge">
<title>Layer_10_Expert_4_EP1_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10138.66,-7085.3C10141.46,-7085 10144.24,-7084.72 10147,-7084.45 10650.61,-7035.29 12149.74,-7012.13 12772.25,-7004.43"/>
<polygon fill="black" stroke="black" points="12772.3,-7007.93 12782.25,-7004.3 12772.21,-7000.93 12772.3,-7007.93"/>
</g>
<!-- Layer_10_Expert_4_EP1_TP1_PP2 -->
<g id="node523" class="node">
<title>Layer_10_Expert_4_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10533.5,-7152.45 10156.5,-7152.45 10156.5,-7084.45 10533.5,-7084.45 10533.5,-7152.45"/>
<text text-anchor="middle" x="10345" y="-7137.25" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10345" y="-7122.25" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="10345" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10345" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_4_EP1_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge820" class="edge">
<title>Layer_10_Expert_4_EP1_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10533.66,-7085.32C10536.46,-7085.02 10539.24,-7084.73 10542,-7084.45 10967.33,-7041.96 12214.87,-7015.77 12772.82,-7005.87"/>
<polygon fill="black" stroke="black" points="12773.08,-7009.37 12783.02,-7005.69 12772.96,-7002.37 12773.08,-7009.37"/>
</g>
<!-- Layer_10_Expert_5_EP1_TP0_PP2 -->
<g id="node524" class="node">
<title>Layer_10_Expert_5_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10928.5,-7152.45 10551.5,-7152.45 10551.5,-7084.45 10928.5,-7084.45 10928.5,-7152.45"/>
<text text-anchor="middle" x="10740" y="-7137.25" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10740" y="-7122.25" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="10740" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10740" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_5_EP1_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge822" class="edge">
<title>Layer_10_Expert_5_EP1_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10928.67,-7085.34C10931.46,-7085.03 10934.24,-7084.73 10937,-7084.45 11592.12,-7016.96 12366.77,-7003.27 12770.98,-7001.11"/>
<polygon fill="black" stroke="black" points="12771.07,-7004.61 12781.06,-7001.06 12771.04,-6997.61 12771.07,-7004.61"/>
</g>
<!-- Layer_10_Expert_5_EP1_TP1_PP2 -->
<g id="node525" class="node">
<title>Layer_10_Expert_5_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11323.5,-7152.45 10946.5,-7152.45 10946.5,-7084.45 11323.5,-7084.45 11323.5,-7152.45"/>
<text text-anchor="middle" x="11135" y="-7137.25" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="11135" y="-7122.25" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="11135" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11135" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_5_EP1_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge824" class="edge">
<title>Layer_10_Expert_5_EP1_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11323.67,-7085.38C11326.46,-7085.06 11329.24,-7084.75 11332,-7084.45 11838.25,-7029.98 12432.39,-7011.21 12772.08,-7004.75"/>
<polygon fill="black" stroke="black" points="12772.38,-7008.25 12782.31,-7004.56 12772.25,-7001.25 12772.38,-7008.25"/>
</g>
<!-- Layer_10_Expert_6_EP1_TP0_PP2 -->
<g id="node526" class="node">
<title>Layer_10_Expert_6_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11718.5,-7152.45 11341.5,-7152.45 11341.5,-7084.45 11718.5,-7084.45 11718.5,-7152.45"/>
<text text-anchor="middle" x="11530" y="-7137.25" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="11530" y="-7122.25" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="11530" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11530" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_6_EP1_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge826" class="edge">
<title>Layer_10_Expert_6_EP1_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11718.68,-7085.44C11721.47,-7085.1 11724.24,-7084.77 11727,-7084.45 12088.76,-7042.89 12508.81,-7020.94 12776.38,-7010.26"/>
<polygon fill="black" stroke="black" points="12776.77,-7013.74 12786.62,-7009.85 12776.49,-7006.75 12776.77,-7013.74"/>
</g>
<!-- Layer_10_Expert_6_EP1_TP1_PP2 -->
<g id="node527" class="node">
<title>Layer_10_Expert_6_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12113.5,-7152.45 11736.5,-7152.45 11736.5,-7084.45 12113.5,-7084.45 12113.5,-7152.45"/>
<text text-anchor="middle" x="11925" y="-7137.25" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="11925" y="-7122.25" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="11925" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11925" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_6_EP1_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge828" class="edge">
<title>Layer_10_Expert_6_EP1_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12113.69,-7085.54C12116.48,-7085.17 12119.25,-7084.8 12122,-7084.45 12347.19,-7055.53 12604.48,-7033.31 12790.61,-7019.15"/>
<polygon fill="black" stroke="black" points="12791.1,-7022.63 12800.81,-7018.38 12790.57,-7015.65 12791.1,-7022.63"/>
</g>
<!-- Layer_10_Expert_7_EP1_TP0_PP2 -->
<g id="node528" class="node">
<title>Layer_10_Expert_7_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12508.5,-7152.45 12131.5,-7152.45 12131.5,-7084.45 12508.5,-7084.45 12508.5,-7152.45"/>
<text text-anchor="middle" x="12320" y="-7137.25" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12320" y="-7122.25" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="12320" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12320" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_7_EP1_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge830" class="edge">
<title>Layer_10_Expert_7_EP1_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12508.72,-7085.79C12511.5,-7085.34 12514.26,-7084.89 12517,-7084.45 12622.64,-7067.34 12740.19,-7048.88 12837.79,-7033.72"/>
<polygon fill="black" stroke="black" points="12838.43,-7037.17 12847.77,-7032.17 12837.36,-7030.25 12838.43,-7037.17"/>
</g>
<!-- Layer_10_Expert_7_EP1_TP1_PP2 -->
<g id="node529" class="node">
<title>Layer_10_Expert_7_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12903.5,-7152.45 12526.5,-7152.45 12526.5,-7084.45 12903.5,-7084.45 12903.5,-7152.45"/>
<text text-anchor="middle" x="12715" y="-7137.25" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12715" y="-7122.25" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="12715" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12715" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_7_EP1_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge832" class="edge">
<title>Layer_10_Expert_7_EP1_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12809.98,-7084.34C12843.6,-7072.62 12882.02,-7059.23 12918.04,-7046.67"/>
<polygon fill="black" stroke="black" points="12919.34,-7049.92 12927.63,-7043.33 12917.04,-7043.31 12919.34,-7049.92"/>
</g>
<!-- Layer_10_Expert_8_EP2_TP0_PP2 -->
<g id="node530" class="node">
<title>Layer_10_Expert_8_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13298.5,-7152.45 12921.5,-7152.45 12921.5,-7084.45 13298.5,-7084.45 13298.5,-7152.45"/>
<text text-anchor="middle" x="13110" y="-7137.25" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="13110" y="-7122.25" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="13110" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13110" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_8_EP2_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge834" class="edge">
<title>Layer_10_Expert_8_EP2_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13092.23,-7084.18C13087.78,-7075.84 13082.87,-7066.66 13078,-7057.54"/>
<polygon fill="black" stroke="black" points="13080.96,-7055.65 13073.16,-7048.48 13074.79,-7058.95 13080.96,-7055.65"/>
</g>
<!-- Layer_10_Expert_8_EP2_TP1_PP2 -->
<g id="node531" class="node">
<title>Layer_10_Expert_8_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13693.5,-7152.45 13316.5,-7152.45 13316.5,-7084.45 13693.5,-7084.45 13693.5,-7152.45"/>
<text text-anchor="middle" x="13505" y="-7137.25" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="13505" y="-7122.25" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="13505" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13505" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_8_EP2_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge836" class="edge">
<title>Layer_10_Expert_8_EP2_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13374.96,-7084.42C13323.67,-7071.39 13264.19,-7056.28 13210.14,-7042.55"/>
<polygon fill="black" stroke="black" points="13210.66,-7039.07 13200.11,-7040 13208.94,-7045.86 13210.66,-7039.07"/>
</g>
<!-- Layer_10_Expert_9_EP2_TP0_PP2 -->
<g id="node532" class="node">
<title>Layer_10_Expert_9_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14088.5,-7152.45 13711.5,-7152.45 13711.5,-7084.45 14088.5,-7084.45 14088.5,-7152.45"/>
<text text-anchor="middle" x="13900" y="-7137.25" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="13900" y="-7122.25" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="13900" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13900" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_9_EP2_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge838" class="edge">
<title>Layer_10_Expert_9_EP2_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13711.38,-7085.84C13708.23,-7085.37 13705.1,-7084.9 13702,-7084.45 13561.98,-7063.89 13404.64,-7043.81 13279.38,-7028.54"/>
<polygon fill="black" stroke="black" points="13279.63,-7025.05 13269.28,-7027.31 13278.78,-7032 13279.63,-7025.05"/>
</g>
<!-- Layer_10_Expert_9_EP2_TP1_PP2 -->
<g id="node533" class="node">
<title>Layer_10_Expert_9_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14483.5,-7152.45 14106.5,-7152.45 14106.5,-7084.45 14483.5,-7084.45 14483.5,-7152.45"/>
<text text-anchor="middle" x="14295" y="-7137.25" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14295" y="-7122.25" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="14295" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14295" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_9_EP2_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge840" class="edge">
<title>Layer_10_Expert_9_EP2_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14106.41,-7085.64C14103.25,-7085.23 14100.11,-7084.83 14097,-7084.45 13830.48,-7051.75 13524.22,-7029.21 13311.69,-7015.94"/>
<polygon fill="black" stroke="black" points="13311.84,-7012.45 13301.64,-7015.32 13311.41,-7019.43 13311.84,-7012.45"/>
</g>
<!-- Layer_10_Expert_10_EP2_TP0_PP2 -->
<g id="node534" class="node">
<title>Layer_10_Expert_10_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14878.5,-7152.45 14501.5,-7152.45 14501.5,-7084.45 14878.5,-7084.45 14878.5,-7152.45"/>
<text text-anchor="middle" x="14690" y="-7137.25" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="14690" y="-7122.25" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="14690" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14690" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_10_EP2_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge842" class="edge">
<title>Layer_10_Expert_10_EP2_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14501.42,-7085.54C14498.26,-7085.16 14495.12,-7084.8 14492,-7084.45 14085.83,-7039.05 13612.45,-7017.8 13321.5,-7008.33"/>
<polygon fill="black" stroke="black" points="13321.33,-7004.83 13311.22,-7008 13321.11,-7011.82 13321.33,-7004.83"/>
</g>
<!-- Layer_10_Expert_10_EP2_TP1_PP2 -->
<g id="node535" class="node">
<title>Layer_10_Expert_10_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15273.5,-7152.45 14896.5,-7152.45 14896.5,-7084.45 15273.5,-7084.45 15273.5,-7152.45"/>
<text text-anchor="middle" x="15085" y="-7137.25" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15085" y="-7122.25" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="15085" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15085" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_10_EP2_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge844" class="edge">
<title>Layer_10_Expert_10_EP2_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14896.43,-7085.49C14893.26,-7085.13 14890.12,-7084.78 14887,-7084.45 14334.58,-7026.15 13684.57,-7008.72 13324.13,-7003.53"/>
<polygon fill="black" stroke="black" points="13324.13,-7000.03 13314.08,-7003.39 13324.03,-7007.03 13324.13,-7000.03"/>
</g>
<!-- Layer_10_Expert_11_EP2_TP0_PP2 -->
<g id="node536" class="node">
<title>Layer_10_Expert_11_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15668.5,-7152.45 15291.5,-7152.45 15291.5,-7084.45 15668.5,-7084.45 15668.5,-7152.45"/>
<text text-anchor="middle" x="15480" y="-7137.25" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="15480" y="-7122.25" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="15480" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15480" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_11_EP2_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge846" class="edge">
<title>Layer_10_Expert_11_EP2_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15291.43,-7085.45C15288.27,-7085.1 15285.12,-7084.77 15282,-7084.45 14910.04,-7046.69 13832.67,-7018.71 13322.3,-7007.17"/>
<polygon fill="black" stroke="black" points="13322.29,-7003.67 13312.22,-7006.95 13322.14,-7010.67 13322.29,-7003.67"/>
</g>
<!-- Layer_10_Expert_11_EP2_TP1_PP2 -->
<g id="node537" class="node">
<title>Layer_10_Expert_11_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16063.5,-7152.45 15686.5,-7152.45 15686.5,-7084.45 16063.5,-7084.45 16063.5,-7152.45"/>
<text text-anchor="middle" x="15875" y="-7137.25" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="15875" y="-7122.25" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="15875" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15875" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_11_EP2_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge848" class="edge">
<title>Layer_10_Expert_11_EP2_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15686.43,-7085.43C15683.27,-7085.08 15680.12,-7084.76 15677,-7084.45 15227.41,-7040.08 13902.26,-7014.66 13323.6,-7005.41"/>
<polygon fill="black" stroke="black" points="13323.5,-7001.91 13313.44,-7005.25 13323.39,-7008.91 13323.5,-7001.91"/>
</g>
<!-- Layer_10_Expert_12_EP3_TP0_PP2 -->
<g id="node538" class="node">
<title>Layer_10_Expert_12_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16458.5,-7152.45 16081.5,-7152.45 16081.5,-7084.45 16458.5,-7084.45 16458.5,-7152.45"/>
<text text-anchor="middle" x="16270" y="-7137.25" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="16270" y="-7122.25" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="16270" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16270" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_12_EP3_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge850" class="edge">
<title>Layer_10_Expert_12_EP3_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16081.44,-7085.41C16078.27,-7085.07 16075.12,-7084.75 16072,-7084.45 15544,-7033.44 13966.41,-7011.2 13324.39,-7004.09"/>
<polygon fill="black" stroke="black" points="13324.1,-7000.58 13314.07,-7003.97 13324.03,-7007.58 13324.1,-7000.58"/>
</g>
<!-- Layer_10_Expert_12_EP3_TP1_PP2 -->
<g id="node539" class="node">
<title>Layer_10_Expert_12_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16853.5,-7152.45 16476.5,-7152.45 16476.5,-7084.45 16853.5,-7084.45 16853.5,-7152.45"/>
<text text-anchor="middle" x="16665" y="-7137.25" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="16665" y="-7122.25" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="16665" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16665" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_12_EP3_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge852" class="edge">
<title>Layer_10_Expert_12_EP3_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16476.44,-7085.4C16473.27,-7085.06 16470.12,-7084.75 16467,-7084.45 15859.86,-7026.77 14025.5,-7008.16 13324.47,-7003.06"/>
<polygon fill="black" stroke="black" points="13324.25,-6999.56 13314.23,-7002.98 13324.2,-7006.56 13324.25,-6999.56"/>
</g>
<!-- Layer_10_Expert_13_EP3_TP0_PP2 -->
<g id="node540" class="node">
<title>Layer_10_Expert_13_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17248.5,-7152.45 16871.5,-7152.45 16871.5,-7084.45 17248.5,-7084.45 17248.5,-7152.45"/>
<text text-anchor="middle" x="17060" y="-7137.25" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17060" y="-7122.25" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="17060" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17060" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_13_EP3_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge854" class="edge">
<title>Layer_10_Expert_13_EP3_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16871.44,-7085.39C16868.27,-7085.06 16865.12,-7084.74 16862,-7084.45 16175.3,-7020.08 14081.49,-7005.46 13324.65,-7002.24"/>
<polygon fill="black" stroke="black" points="13324.45,-6998.74 13314.44,-7002.2 13324.42,-7005.74 13324.45,-6998.74"/>
</g>
<!-- Layer_10_Expert_13_EP3_TP1_PP2 -->
<g id="node541" class="node">
<title>Layer_10_Expert_13_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17643.5,-7152.45 17266.5,-7152.45 17266.5,-7084.45 17643.5,-7084.45 17643.5,-7152.45"/>
<text text-anchor="middle" x="17455" y="-7137.25" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17455" y="-7122.25" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="17455" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17455" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_13_EP3_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge856" class="edge">
<title>Layer_10_Expert_13_EP3_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17266.44,-7085.38C17263.27,-7085.05 17260.12,-7084.74 17257,-7084.45 16490.26,-7013.37 14134.11,-7003.01 13324.54,-7001.57"/>
<polygon fill="black" stroke="black" points="13324.5,-6998.07 13314.5,-7001.56 13324.49,-7005.07 13324.5,-6998.07"/>
</g>
<!-- Layer_10_Expert_14_EP3_TP0_PP2 -->
<g id="node542" class="node">
<title>Layer_10_Expert_14_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18038.5,-7152.45 17661.5,-7152.45 17661.5,-7084.45 18038.5,-7084.45 18038.5,-7152.45"/>
<text text-anchor="middle" x="17850" y="-7137.25" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="17850" y="-7122.25" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="17850" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17850" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_14_EP3_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge858" class="edge">
<title>Layer_10_Expert_14_EP3_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17661.44,-7085.37C17658.27,-7085.04 17655.12,-7084.74 17652,-7084.45 16805,-7006.65 14185.1,-7000.78 13324.82,-7001.02"/>
<polygon fill="black" stroke="black" points="13324.78,-6997.52 13314.78,-7001.02 13324.78,-7004.52 13324.78,-6997.52"/>
</g>
<!-- Layer_10_Expert_14_EP3_TP1_PP2 -->
<g id="node543" class="node">
<title>Layer_10_Expert_14_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18433.5,-7152.45 18056.5,-7152.45 18056.5,-7084.45 18433.5,-7084.45 18433.5,-7152.45"/>
<text text-anchor="middle" x="18245" y="-7137.25" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="18245" y="-7122.25" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="18245" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18245" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_14_EP3_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge860" class="edge">
<title>Layer_10_Expert_14_EP3_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18056.44,-7085.36C18053.27,-7085.04 18050.12,-7084.73 18047,-7084.45 17577.49,-7041.66 14304.42,-7011.66 13324.54,-7003.56"/>
<polygon fill="black" stroke="black" points="13324.21,-7000.06 13314.18,-7003.47 13324.15,-7007.06 13324.21,-7000.06"/>
</g>
<!-- Layer_10_Expert_15_EP3_TP0_PP2 -->
<g id="node544" class="node">
<title>Layer_10_Expert_15_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18828.5,-7152.45 18451.5,-7152.45 18451.5,-7084.45 18828.5,-7084.45 18828.5,-7152.45"/>
<text text-anchor="middle" x="18640" y="-7137.25" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="18640" y="-7122.25" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="18640" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18640" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_15_EP3_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge862" class="edge">
<title>Layer_10_Expert_15_EP3_TP0_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18451.44,-7085.36C18448.27,-7085.04 18445.12,-7084.73 18442,-7084.45 17931.84,-7038.27 14354.22,-7010.34 13324.6,-7003.2"/>
<polygon fill="black" stroke="black" points="13324.5,-6999.7 13314.47,-7003.13 13324.45,-7006.7 13324.5,-6999.7"/>
</g>
<!-- Layer_10_Expert_15_EP3_TP1_PP2 -->
<g id="node545" class="node">
<title>Layer_10_Expert_15_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="19223.5,-7152.45 18846.5,-7152.45 18846.5,-7084.45 19223.5,-7084.45 19223.5,-7152.45"/>
<text text-anchor="middle" x="19035" y="-7137.25" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="19035" y="-7122.25" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="19035" y="-7107.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19035" y="-7092.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_Expert_15_EP3_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2 -->
<g id="edge864" class="edge">
<title>Layer_10_Expert_15_EP3_TP1_PP2&#45;&gt;Layer_10_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18846.44,-7085.35C18843.27,-7085.03 18840.12,-7084.73 18837,-7084.45 18286.04,-7034.87 14401.78,-7009.12 13324.48,-7002.88"/>
<polygon fill="black" stroke="black" points="13324.29,-6999.38 13314.27,-7002.82 13324.25,-7006.38 13324.29,-6999.38"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_0_EP0_TP0_PP2 -->
<g id="edge801" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_0_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12528.76,-7234.1C11470.08,-7228.1 7587.53,-7202.88 6988.9,-7152.54"/>
<polygon fill="black" stroke="black" points="6988.92,-7149.03 6978.66,-7151.65 6988.31,-7156.01 6988.92,-7149.03"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_0_EP0_TP1_PP2 -->
<g id="edge803" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_0_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12528.46,-7233.8C11516.48,-7226.9 7941.56,-7199.51 7383.97,-7152.55"/>
<polygon fill="black" stroke="black" points="7383.92,-7149.03 7373.66,-7151.65 7383.31,-7156.01 7383.92,-7149.03"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_1_EP0_TP0_PP2 -->
<g id="edge805" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_1_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12528.64,-7233.46C11565.71,-7225.63 8295.22,-7196.15 7778.92,-7152.55"/>
<polygon fill="black" stroke="black" points="7778.92,-7149.03 7768.66,-7151.64 7778.31,-7156.01 7778.92,-7149.03"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_1_EP0_TP1_PP2 -->
<g id="edge807" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_1_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12528.24,-7235.93C11679.51,-7236.38 9046.85,-7231.27 8173.85,-7152.57"/>
<polygon fill="black" stroke="black" points="8173.93,-7149.06 8163.66,-7151.64 8173.3,-7156.03 8173.93,-7149.06"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_2_EP0_TP0_PP2 -->
<g id="edge809" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_2_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12528.36,-7235.4C11729.27,-7234.2 9361.08,-7224.55 8568.77,-7152.56"/>
<polygon fill="black" stroke="black" points="8568.94,-7149.06 8558.66,-7151.63 8568.3,-7156.03 8568.94,-7149.06"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_2_EP0_TP1_PP2 -->
<g id="edge811" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_2_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12528.58,-7234.76C11781.59,-7231.81 9675.82,-7217.85 8963.78,-7152.56"/>
<polygon fill="black" stroke="black" points="8963.94,-7149.06 8953.66,-7151.62 8963.29,-7156.03 8963.94,-7149.06"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_3_EP0_TP0_PP2 -->
<g id="edge813" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_3_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12528.55,-7233.98C11836.18,-7229.18 9990.82,-7211.18 9358.79,-7152.57"/>
<polygon fill="black" stroke="black" points="9358.94,-7149.07 9348.66,-7151.61 9358.29,-7156.03 9358.94,-7149.07"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_3_EP0_TP1_PP2 -->
<g id="edge815" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_3_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12529.03,-7233.01C11894.84,-7226.22 10306.21,-7204.54 9753.72,-7152.56"/>
<polygon fill="black" stroke="black" points="9753.95,-7149.07 9743.66,-7151.6 9753.28,-7156.04 9753.95,-7149.07"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_4_EP1_TP0_PP2 -->
<g id="edge817" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_4_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12529.54,-7231.75C11957.36,-7222.86 10622.08,-7197.94 10148.66,-7152.56"/>
<polygon fill="black" stroke="black" points="10148.95,-7149.07 10138.66,-7151.59 10148.28,-7156.04 10148.95,-7149.07"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_4_EP1_TP1_PP2 -->
<g id="edge819" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_4_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12530.5,-7230.07C12025.29,-7218.93 10938.85,-7191.4 10543.73,-7152.57"/>
<polygon fill="black" stroke="black" points="10543.96,-7149.08 10533.66,-7151.56 10543.27,-7156.04 10543.96,-7149.08"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_5_EP1_TP0_PP2 -->
<g id="edge821" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_5_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12528.48,-7233.75C12169.11,-7229.05 11509.33,-7212.33 10938.75,-7152.59"/>
<polygon fill="black" stroke="black" points="10938.98,-7149.1 10928.67,-7151.53 10938.25,-7156.06 10938.98,-7149.1"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_5_EP1_TP1_PP2 -->
<g id="edge823" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_5_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12531.31,-7229.22C12240.11,-7220.26 11757.41,-7199.49 11333.67,-7152.6"/>
<polygon fill="black" stroke="black" points="11334,-7149.11 11323.67,-7151.49 11333.22,-7156.07 11334,-7149.11"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_6_EP1_TP0_PP2 -->
<g id="edge825" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_6_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12540.55,-7222.08C12326.31,-7209.25 12011.72,-7186.92 11728.74,-7152.63"/>
<polygon fill="black" stroke="black" points="11729.03,-7149.14 11718.68,-7151.41 11728.19,-7156.09 11729.03,-7149.14"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_6_EP1_TP1_PP2 -->
<g id="edge827" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_6_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12571.11,-7210.34C12442.85,-7195.32 12278.64,-7175.07 12123.88,-7152.71"/>
<polygon fill="black" stroke="black" points="12124.1,-7149.2 12113.71,-7151.23 12123.1,-7156.13 12124.1,-7149.2"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_7_EP1_TP0_PP2 -->
<g id="edge829" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_7_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12639.14,-7197.44C12583.13,-7183.75 12520.23,-7168.38 12465.16,-7154.93"/>
<polygon fill="black" stroke="black" points="12465.88,-7151.5 12455.33,-7152.52 12464.22,-7158.3 12465.88,-7151.5"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_7_EP1_TP1_PP2 -->
<g id="edge831" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_7_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12762.69,-7188.65C12756.38,-7179.5 12749.81,-7169.96 12743.63,-7160.99"/>
<polygon fill="black" stroke="black" points="12746.4,-7158.85 12737.84,-7152.6 12740.64,-7162.82 12746.4,-7158.85"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_8_EP2_TP0_PP2 -->
<g id="edge833" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_8_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M12910.06,-7193.13C12943.03,-7180.98 12978.68,-7167.84 13010.62,-7156.07"/>
<polygon fill="black" stroke="black" points="13012.23,-7159.21 13020.41,-7152.47 13009.81,-7152.64 13012.23,-7159.21"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_8_EP2_TP1_PP2 -->
<g id="edge835" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_8_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M12991.05,-7203.92C13083.62,-7188.94 13195.91,-7170.71 13306.36,-7152.55"/>
<polygon fill="black" stroke="black" points="13307.06,-7155.98 13316.36,-7150.91 13305.92,-7149.08 13307.06,-7155.98"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_9_EP2_TP0_PP2 -->
<g id="edge837" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_9_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13040.95,-7217.94C13221.03,-7203.88 13471.45,-7181.87 13701.17,-7152.52"/>
<polygon fill="black" stroke="black" points="13701.93,-7155.95 13711.4,-7151.21 13701.04,-7149.01 13701.93,-7155.95"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_9_EP2_TP1_PP2 -->
<g id="edge839" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_9_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13056,-7226.66C13316.98,-7215.99 13729.85,-7194.18 14096.41,-7152.48"/>
<polygon fill="black" stroke="black" points="14096.88,-7155.94 14106.42,-7151.33 14096.09,-7148.99 14096.88,-7155.94"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_10_EP2_TP0_PP2 -->
<g id="edge841" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_10_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13060.65,-7232.07C13393.13,-7225.55 13979.94,-7206.88 14491.26,-7152.48"/>
<polygon fill="black" stroke="black" points="14491.86,-7155.94 14501.43,-7151.39 14491.11,-7148.98 14491.86,-7155.94"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_10_EP2_TP1_PP2 -->
<g id="edge843" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_10_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13061.6,-7235.63C13457.85,-7233.37 14225.53,-7219.76 14886.22,-7152.48"/>
<polygon fill="black" stroke="black" points="14886.84,-7155.93 14896.43,-7151.43 14886.13,-7148.97 14886.84,-7155.93"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_11_EP2_TP0_PP2 -->
<g id="edge845" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_11_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13060.06,-7231.1C13605.57,-7221.26 14838.97,-7195.1 15281.45,-7152.44"/>
<polygon fill="black" stroke="black" points="15281.82,-7155.92 15291.43,-7151.46 15281.14,-7148.95 15281.82,-7155.92"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_11_EP2_TP1_PP2 -->
<g id="edge847" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_11_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13060.71,-7232.51C13670.01,-7224.82 15154.7,-7201.65 15676.18,-7152.46"/>
<polygon fill="black" stroke="black" points="15676.81,-7155.92 15686.44,-7151.48 15676.15,-7148.95 15676.81,-7155.92"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_12_EP3_TP0_PP2 -->
<g id="edge849" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_12_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13061.13,-7233.59C13730.13,-7227.92 15470.73,-7208.23 16071.37,-7152.45"/>
<polygon fill="black" stroke="black" points="16071.81,-7155.92 16081.44,-7151.5 16071.15,-7148.95 16071.81,-7155.92"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_12_EP3_TP1_PP2 -->
<g id="edge851" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_12_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13061.6,-7234.44C13786.83,-7230.67 15785.82,-7214.85 16466.27,-7152.45"/>
<polygon fill="black" stroke="black" points="16466.8,-7155.92 16476.44,-7151.51 16466.16,-7148.95 16466.8,-7155.92"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_13_EP3_TP0_PP2 -->
<g id="edge853" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_13_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13061.48,-7235.13C13839.62,-7233.14 16100.92,-7221.51 16861.46,-7152.44"/>
<polygon fill="black" stroke="black" points="16861.8,-7155.92 16871.44,-7151.52 16861.16,-7148.95 16861.8,-7155.92"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_13_EP3_TP1_PP2 -->
<g id="edge855" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_13_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13061.56,-7235.7C13890.18,-7235.4 16415.12,-7228.2 17256.32,-7152.45"/>
<polygon fill="black" stroke="black" points="17256.8,-7155.92 17266.44,-7151.53 17256.16,-7148.95 17256.8,-7155.92"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_14_EP3_TP0_PP2 -->
<g id="edge857" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_14_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13061.67,-7236.17C13938.66,-7237.47 16729.4,-7234.9 17651.35,-7152.45"/>
<polygon fill="black" stroke="black" points="17651.8,-7155.92 17661.44,-7151.53 17651.17,-7148.95 17651.8,-7155.92"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_14_EP3_TP1_PP2 -->
<g id="edge859" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_14_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13061.26,-7233.65C14053.38,-7226.34 17505.56,-7197.93 18046.43,-7152.41"/>
<polygon fill="black" stroke="black" points="18046.78,-7155.9 18056.44,-7151.54 18046.17,-7148.92 18046.78,-7155.9"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_15_EP3_TP0_PP2 -->
<g id="edge861" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_15_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13061.38,-7233.97C14101.19,-7227.56 17857.75,-7201.29 18441.06,-7152.45"/>
<polygon fill="black" stroke="black" points="18441.78,-7155.9 18451.44,-7151.54 18441.18,-7148.92 18441.78,-7155.9"/>
</g>
<!-- Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_15_EP3_TP1_PP2 -->
<g id="edge863" class="edge">
<title>Layer_10_A2A_Dispatch_PP2&#45;&gt;Layer_10_Expert_15_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13061.71,-7234.25C14148.22,-7228.69 18212.17,-7204.64 18836.2,-7152.43"/>
<polygon fill="black" stroke="black" points="18836.78,-7155.9 18846.44,-7151.55 18836.18,-7148.92 18836.78,-7155.9"/>
</g>
<!-- Layer_10_MLP_Out_TP0_PP2 -->
<g id="node548" class="node">
<title>Layer_10_MLP_Out_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13039.5,-6916.28 12662.5,-6916.28 12662.5,-6848.28 13039.5,-6848.28 13039.5,-6916.28"/>
<text text-anchor="middle" x="12851" y="-6901.08" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="12851" y="-6886.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12851" y="-6871.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12851" y="-6856.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_A2A_Combine_PP2&#45;&gt;Layer_10_MLP_Out_TP0_PP2 -->
<g id="edge865" class="edge">
<title>Layer_10_A2A_Combine_PP2&#45;&gt;Layer_10_MLP_Out_TP0_PP2</title>
<path fill="none" stroke="black" d="M12971.27,-6954.15C12953.05,-6943.42 12933.79,-6932.07 12916.15,-6921.67"/>
<polygon fill="black" stroke="black" points="12917.48,-6918.39 12907.09,-6916.33 12913.92,-6924.42 12917.48,-6918.39"/>
</g>
<!-- Layer_10_MLP_Out_TP1_PP2 -->
<g id="node549" class="node">
<title>Layer_10_MLP_Out_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13434.5,-6916.28 13057.5,-6916.28 13057.5,-6848.28 13434.5,-6848.28 13434.5,-6916.28"/>
<text text-anchor="middle" x="13246" y="-6901.08" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="13246" y="-6886.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="13246" y="-6871.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13246" y="-6856.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_10_A2A_Combine_PP2&#45;&gt;Layer_10_MLP_Out_TP1_PP2 -->
<g id="edge867" class="edge">
<title>Layer_10_A2A_Combine_PP2&#45;&gt;Layer_10_MLP_Out_TP1_PP2</title>
<path fill="none" stroke="black" d="M13124.84,-6954.32C13143.33,-6943.47 13162.92,-6931.99 13180.82,-6921.49"/>
<polygon fill="black" stroke="black" points="13182.61,-6924.5 13189.47,-6916.43 13179.07,-6918.47 13182.61,-6924.5"/>
</g>
<!-- Layer_10_MLP_AllReduce_PP2 -->
<g id="node550" class="node">
<title>Layer_10_MLP_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13035" cy="-6764.2" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13035" y="-6783" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="13035" y="-6768" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13035" y="-6753" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13035" y="-6738" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_10_MLP_Out_TP0_PP2&#45;&gt;Layer_10_MLP_AllReduce_PP2 -->
<g id="edge866" class="edge">
<title>Layer_10_MLP_Out_TP0_PP2&#45;&gt;Layer_10_MLP_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M12903.73,-6848.02C12919.46,-6838.09 12937.08,-6826.97 12954.18,-6816.19"/>
<polygon fill="black" stroke="black" points="12956.47,-6818.88 12963.06,-6810.58 12952.74,-6812.96 12956.47,-6818.88"/>
</g>
<!-- Layer_10_MLP_Out_TP1_PP2&#45;&gt;Layer_10_MLP_AllReduce_PP2 -->
<g id="edge868" class="edge">
<title>Layer_10_MLP_Out_TP1_PP2&#45;&gt;Layer_10_MLP_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13185.82,-6848.17C13167.04,-6837.84 13145.89,-6826.21 13125.51,-6814.99"/>
<polygon fill="black" stroke="black" points="13126.97,-6811.8 13116.52,-6810.05 13123.59,-6817.93 13126.97,-6811.8"/>
</g>
<!-- Layer_10_LayerNorm_PP2 -->
<g id="node551" class="node">
<title>Layer_10_LayerNorm_PP2</title>
<polygon fill="lightgreen" stroke="black" points="13223.5,-6680.12 12846.5,-6680.12 12846.5,-6612.12 13223.5,-6612.12 13223.5,-6680.12"/>
<text text-anchor="middle" x="13035" y="-6664.92" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13035" y="-6649.92" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13035" y="-6634.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13035" y="-6619.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_10_MLP_AllReduce_PP2&#45;&gt;Layer_10_LayerNorm_PP2 -->
<g id="edge869" class="edge">
<title>Layer_10_MLP_AllReduce_PP2&#45;&gt;Layer_10_LayerNorm_PP2</title>
<path fill="none" stroke="black" d="M13035,-6715.98C13035,-6707.6 13035,-6698.9 13035,-6690.62"/>
<polygon fill="black" stroke="black" points="13038.5,-6690.42 13035,-6680.42 13031.5,-6690.42 13038.5,-6690.42"/>
</g>
<!-- Layer_11_QKV_TP0_PP2 -->
<g id="node552" class="node">
<title>Layer_11_QKV_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13225.5,-6576.12 12844.5,-6576.12 12844.5,-6508.12 13225.5,-6508.12 13225.5,-6576.12"/>
<text text-anchor="middle" x="13035" y="-6560.92" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="13035" y="-6545.92" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="13035" y="-6530.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13035" y="-6515.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_10_LayerNorm_PP2&#45;&gt;Layer_11_QKV_TP0_PP2 -->
<g id="edge870" class="edge">
<title>Layer_10_LayerNorm_PP2&#45;&gt;Layer_11_QKV_TP0_PP2</title>
<path fill="none" stroke="black" d="M13035,-6612C13035,-6603.89 13035,-6595.1 13035,-6586.59"/>
<polygon fill="black" stroke="black" points="13038.5,-6586.42 13035,-6576.42 13031.5,-6586.42 13038.5,-6586.42"/>
</g>
<!-- Layer_11_QKV_AllReduce_PP2 -->
<g id="node554" class="node">
<title>Layer_11_QKV_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="12934" cy="-6424.03" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="12934" y="-6442.83" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="12934" y="-6427.83" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="12934" y="-6412.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="12934" y="-6397.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_11_QKV_TP0_PP2&#45;&gt;Layer_11_QKV_AllReduce_PP2 -->
<g id="edge871" class="edge">
<title>Layer_11_QKV_TP0_PP2&#45;&gt;Layer_11_QKV_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13006.06,-6507.85C12998.33,-6498.97 12989.77,-6489.14 12981.34,-6479.44"/>
<polygon fill="black" stroke="black" points="12983.82,-6476.96 12974.61,-6471.71 12978.54,-6481.55 12983.82,-6476.96"/>
</g>
<!-- Layer_11_QKV_TP1_PP2 -->
<g id="node553" class="node">
<title>Layer_11_QKV_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="12826.5,-6576.12 12445.5,-6576.12 12445.5,-6508.12 12826.5,-6508.12 12826.5,-6576.12"/>
<text text-anchor="middle" x="12636" y="-6560.92" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="12636" y="-6545.92" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="12636" y="-6530.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12636" y="-6515.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_11_QKV_TP1_PP2&#45;&gt;Layer_11_QKV_AllReduce_PP2 -->
<g id="edge875" class="edge">
<title>Layer_11_QKV_TP1_PP2&#45;&gt;Layer_11_QKV_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M12721,-6508.01C12749.84,-6496.77 12782.63,-6484 12813.69,-6471.9"/>
<polygon fill="black" stroke="black" points="12815.23,-6475.06 12823.27,-6468.17 12812.68,-6468.53 12815.23,-6475.06"/>
</g>
<!-- Layer_11_Attention_TP0_PP2 -->
<g id="node555" class="node">
<title>Layer_11_Attention_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="12910.5,-6339.95 12529.5,-6339.95 12529.5,-6271.95 12910.5,-6271.95 12910.5,-6339.95"/>
<text text-anchor="middle" x="12720" y="-6324.75" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="12720" y="-6309.75" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12720" y="-6294.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12720" y="-6279.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_11_QKV_AllReduce_PP2&#45;&gt;Layer_11_Attention_TP0_PP2 -->
<g id="edge872" class="edge">
<title>Layer_11_QKV_AllReduce_PP2&#45;&gt;Layer_11_Attention_TP0_PP2</title>
<path fill="none" stroke="black" d="M12851.26,-6378.15C12830.96,-6367.14 12809.44,-6355.47 12789.82,-6344.82"/>
<polygon fill="black" stroke="black" points="12791.41,-6341.7 12780.95,-6340.01 12788.07,-6347.85 12791.41,-6341.7"/>
</g>
<!-- Layer_11_Attention_TP1_PP2 -->
<g id="node556" class="node">
<title>Layer_11_Attention_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13309.5,-6339.95 12928.5,-6339.95 12928.5,-6271.95 13309.5,-6271.95 13309.5,-6339.95"/>
<text text-anchor="middle" x="13119" y="-6324.75" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="13119" y="-6309.75" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="13119" y="-6294.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="13119" y="-6279.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_11_QKV_AllReduce_PP2&#45;&gt;Layer_11_Attention_TP1_PP2 -->
<g id="edge876" class="edge">
<title>Layer_11_QKV_AllReduce_PP2&#45;&gt;Layer_11_Attention_TP1_PP2</title>
<path fill="none" stroke="black" d="M13006.59,-6377.49C13023.41,-6366.93 13041.16,-6355.79 13057.46,-6345.56"/>
<polygon fill="black" stroke="black" points="13059.74,-6348.27 13066.35,-6339.99 13056.02,-6342.34 13059.74,-6348.27"/>
</g>
<!-- Layer_11_AttnOut_TP0_PP2 -->
<g id="node557" class="node">
<title>Layer_11_AttnOut_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="12909.5,-6235.95 12532.5,-6235.95 12532.5,-6167.95 12909.5,-6167.95 12909.5,-6235.95"/>
<text text-anchor="middle" x="12721" y="-6220.75" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="12721" y="-6205.75" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12721" y="-6190.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12721" y="-6175.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Attention_TP0_PP2&#45;&gt;Layer_11_AttnOut_TP0_PP2 -->
<g id="edge873" class="edge">
<title>Layer_11_Attention_TP0_PP2&#45;&gt;Layer_11_AttnOut_TP0_PP2</title>
<path fill="none" stroke="black" d="M12720.32,-6271.83C12720.4,-6263.73 12720.49,-6254.93 12720.57,-6246.42"/>
<polygon fill="black" stroke="black" points="12724.08,-6246.28 12720.67,-6236.25 12717.08,-6246.21 12724.08,-6246.28"/>
</g>
<!-- Layer_11_AttnOut_TP1_PP2 -->
<g id="node558" class="node">
<title>Layer_11_AttnOut_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13306.5,-6235.95 12929.5,-6235.95 12929.5,-6167.95 13306.5,-6167.95 13306.5,-6235.95"/>
<text text-anchor="middle" x="13118" y="-6220.75" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="13118" y="-6205.75" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="13118" y="-6190.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="13118" y="-6175.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Attention_TP1_PP2&#45;&gt;Layer_11_AttnOut_TP1_PP2 -->
<g id="edge877" class="edge">
<title>Layer_11_Attention_TP1_PP2&#45;&gt;Layer_11_AttnOut_TP1_PP2</title>
<path fill="none" stroke="black" d="M13118.68,-6271.83C13118.6,-6263.73 13118.51,-6254.93 13118.43,-6246.42"/>
<polygon fill="black" stroke="black" points="13121.92,-6246.21 13118.33,-6236.25 13114.92,-6246.28 13121.92,-6246.21"/>
</g>
<!-- Layer_11_AttnOut_AllReduce_PP2 -->
<g id="node559" class="node">
<title>Layer_11_AttnOut_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="12870" cy="-6083.87" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="12870" y="-6102.67" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="12870" y="-6087.67" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="12870" y="-6072.67" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12870" y="-6057.67" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_11_AttnOut_TP0_PP2&#45;&gt;Layer_11_AttnOut_AllReduce_PP2 -->
<g id="edge874" class="edge">
<title>Layer_11_AttnOut_TP0_PP2&#45;&gt;Layer_11_AttnOut_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M12763.7,-6167.69C12775.88,-6158.2 12789.45,-6147.62 12802.71,-6137.29"/>
<polygon fill="black" stroke="black" points="12805.18,-6139.8 12810.92,-6130.9 12800.88,-6134.28 12805.18,-6139.8"/>
</g>
<!-- Layer_11_AttnOut_TP1_PP2&#45;&gt;Layer_11_AttnOut_AllReduce_PP2 -->
<g id="edge878" class="edge">
<title>Layer_11_AttnOut_TP1_PP2&#45;&gt;Layer_11_AttnOut_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13047.27,-6167.84C13024.31,-6157.1 12998.36,-6144.95 12973.52,-6133.32"/>
<polygon fill="black" stroke="black" points="12974.98,-6130.14 12964.44,-6129.07 12972.01,-6136.48 12974.98,-6130.14"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2 -->
<g id="node596" class="node">
<title>Layer_11_A2A_Dispatch_PP2</title>
<ellipse fill="yellow" stroke="black" cx="12870" cy="-5951.7" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="12870" y="-5970.5" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="12870" y="-5955.5" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="12870" y="-5940.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12870" y="-5925.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_11_AttnOut_AllReduce_PP2&#45;&gt;Layer_11_A2A_Dispatch_PP2 -->
<g id="edge879" class="edge">
<title>Layer_11_AttnOut_AllReduce_PP2&#45;&gt;Layer_11_A2A_Dispatch_PP2</title>
<path fill="none" stroke="black" d="M12870,-6035.51C12870,-6027.24 12870,-6018.55 12870,-6010.05"/>
<polygon fill="black" stroke="black" points="12873.5,-6009.81 12870,-5999.81 12866.5,-6009.81 12873.5,-6009.81"/>
</g>
<!-- Layer_11_Gate_EP0_PP2 -->
<g id="node560" class="node">
<title>Layer_11_Gate_EP0_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9690.4,-10498.61 9086.86,-10498.61 8931.6,-10362.61 9535.14,-10362.61 9690.4,-10498.61"/>
<text text-anchor="middle" x="9311" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="9311" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="9311" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9311" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_11_Gate_EP1_PP2 -->
<g id="node561" class="node">
<title>Layer_11_Gate_EP1_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8913.4,-10498.61 8309.86,-10498.61 8154.6,-10362.61 8758.14,-10362.61 8913.4,-10498.61"/>
<text text-anchor="middle" x="8534" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="8534" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="8534" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8534" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_11_Gate_EP2_PP2 -->
<g id="node562" class="node">
<title>Layer_11_Gate_EP2_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8136.4,-10498.61 7532.86,-10498.61 7377.6,-10362.61 7981.14,-10362.61 8136.4,-10498.61"/>
<text text-anchor="middle" x="7757" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="7757" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="7757" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7757" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_11_Gate_EP3_PP2 -->
<g id="node563" class="node">
<title>Layer_11_Gate_EP3_PP2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7359.4,-10498.61 6755.86,-10498.61 6600.6,-10362.61 7204.14,-10362.61 7359.4,-10498.61"/>
<text text-anchor="middle" x="6980" y="-10449.41" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="6980" y="-10434.41" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="6980" y="-10419.41" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6980" y="-10404.41" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_11_Expert_0_EP0_TP0_PP2 -->
<g id="node564" class="node">
<title>Layer_11_Expert_0_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7102.5,-5867.62 6725.5,-5867.62 6725.5,-5799.62 7102.5,-5799.62 7102.5,-5867.62"/>
<text text-anchor="middle" x="6914" y="-5852.42" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6914" y="-5837.42" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="6914" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6914" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_A2A_Combine_PP2 -->
<g id="node597" class="node">
<title>Layer_11_A2A_Combine_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13037" cy="-5715.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13037" y="-5734.33" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="13037" y="-5719.33" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13037" y="-5704.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13037" y="-5689.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_11_Expert_0_EP0_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge881" class="edge">
<title>Layer_11_Expert_0_EP0_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7102.66,-5800.41C7105.45,-5800.13 7108.24,-5799.87 7111,-5799.62 7676.02,-5748.63 11665.82,-5723.83 12760.04,-5717.94"/>
<polygon fill="black" stroke="black" points="12760.42,-5721.44 12770.4,-5717.88 12760.38,-5714.44 12760.42,-5721.44"/>
</g>
<!-- Layer_11_Expert_0_EP0_TP1_PP2 -->
<g id="node565" class="node">
<title>Layer_11_Expert_0_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7497.5,-5867.62 7120.5,-5867.62 7120.5,-5799.62 7497.5,-5799.62 7497.5,-5867.62"/>
<text text-anchor="middle" x="7309" y="-5852.42" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7309" y="-5837.42" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="7309" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7309" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_0_EP0_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge883" class="edge">
<title>Layer_11_Expert_0_EP0_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7497.66,-5800.42C7500.45,-5800.13 7503.24,-5799.87 7506,-5799.62 8030.22,-5752.05 11713.28,-5725.02 12760.1,-5718.24"/>
<polygon fill="black" stroke="black" points="12760.42,-5721.74 12770.4,-5718.17 12760.37,-5714.74 12760.42,-5721.74"/>
</g>
<!-- Layer_11_Expert_1_EP0_TP0_PP2 -->
<g id="node566" class="node">
<title>Layer_11_Expert_1_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="7892.5,-5867.62 7515.5,-5867.62 7515.5,-5799.62 7892.5,-5799.62 7892.5,-5867.62"/>
<text text-anchor="middle" x="7704" y="-5852.42" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7704" y="-5837.42" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="7704" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7704" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_1_EP0_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge885" class="edge">
<title>Layer_11_Expert_1_EP0_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M7892.66,-5800.42C7895.45,-5800.14 7898.24,-5799.87 7901,-5799.62 8384.6,-5755.45 11763.38,-5726.3 12760.56,-5718.58"/>
<polygon fill="black" stroke="black" points="12760.77,-5722.08 12770.74,-5718.5 12760.71,-5715.08 12760.77,-5722.08"/>
</g>
<!-- Layer_11_Expert_1_EP0_TP1_PP2 -->
<g id="node567" class="node">
<title>Layer_11_Expert_1_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8287.5,-5867.62 7910.5,-5867.62 7910.5,-5799.62 8287.5,-5799.62 8287.5,-5867.62"/>
<text text-anchor="middle" x="8099" y="-5852.42" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8099" y="-5837.42" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="8099" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8099" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_1_EP0_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge887" class="edge">
<title>Layer_11_Expert_1_EP0_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8287.66,-5800.43C8290.46,-5800.14 8293.24,-5799.87 8296,-5799.62 9170.86,-5719.12 11882.65,-5715.1 12760.05,-5715.99"/>
<polygon fill="black" stroke="black" points="12760.28,-5719.49 12770.29,-5716 12760.29,-5712.49 12760.28,-5719.49"/>
</g>
<!-- Layer_11_Expert_2_EP0_TP0_PP2 -->
<g id="node568" class="node">
<title>Layer_11_Expert_2_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="8682.5,-5867.62 8305.5,-5867.62 8305.5,-5799.62 8682.5,-5799.62 8682.5,-5867.62"/>
<text text-anchor="middle" x="8494" y="-5852.42" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8494" y="-5837.42" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="8494" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8494" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_2_EP0_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge889" class="edge">
<title>Layer_11_Expert_2_EP0_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M8682.66,-5800.43C8685.46,-5800.15 8688.24,-5799.87 8691,-5799.62 9485.37,-5725.89 11932.07,-5717.27 12759.92,-5716.51"/>
<polygon fill="black" stroke="black" points="12760.19,-5720.01 12770.19,-5716.5 12760.18,-5713.01 12760.19,-5720.01"/>
</g>
<!-- Layer_11_Expert_2_EP0_TP1_PP2 -->
<g id="node569" class="node">
<title>Layer_11_Expert_2_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9077.5,-5867.62 8700.5,-5867.62 8700.5,-5799.62 9077.5,-5799.62 9077.5,-5867.62"/>
<text text-anchor="middle" x="8889" y="-5852.42" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8889" y="-5837.42" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="8889" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8889" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_2_EP0_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge891" class="edge">
<title>Layer_11_Expert_2_EP0_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9077.66,-5800.44C9080.46,-5800.15 9083.24,-5799.88 9086,-5799.62 9800.31,-5732.63 11984.44,-5719.64 12760.11,-5717.13"/>
<polygon fill="black" stroke="black" points="12760.31,-5720.63 12770.3,-5717.1 12760.29,-5713.63 12760.31,-5720.63"/>
</g>
<!-- Layer_11_Expert_3_EP0_TP0_PP2 -->
<g id="node570" class="node">
<title>Layer_11_Expert_3_EP0_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9472.5,-5867.62 9095.5,-5867.62 9095.5,-5799.62 9472.5,-5799.62 9472.5,-5867.62"/>
<text text-anchor="middle" x="9284" y="-5852.42" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9284" y="-5837.42" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="9284" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9284" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_3_EP0_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge893" class="edge">
<title>Layer_11_Expert_3_EP0_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9472.66,-5800.45C9475.46,-5800.16 9478.24,-5799.88 9481,-5799.62 10115.59,-5739.36 12039.31,-5722.26 12760.23,-5717.89"/>
<polygon fill="black" stroke="black" points="12760.52,-5721.39 12770.49,-5717.83 12760.47,-5714.39 12760.52,-5721.39"/>
</g>
<!-- Layer_11_Expert_3_EP0_TP1_PP2 -->
<g id="node571" class="node">
<title>Layer_11_Expert_3_EP0_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="9867.5,-5867.62 9490.5,-5867.62 9490.5,-5799.62 9867.5,-5799.62 9867.5,-5867.62"/>
<text text-anchor="middle" x="9679" y="-5852.42" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9679" y="-5837.42" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="9679" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9679" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_3_EP0_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge895" class="edge">
<title>Layer_11_Expert_3_EP0_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M9867.66,-5800.46C9870.46,-5800.16 9873.24,-5799.88 9876,-5799.62 10431.36,-5746.07 12097.63,-5725.18 12760.56,-5718.84"/>
<polygon fill="black" stroke="black" points="12760.76,-5722.34 12770.73,-5718.74 12760.69,-5715.34 12760.76,-5722.34"/>
</g>
<!-- Layer_11_Expert_4_EP1_TP0_PP2 -->
<g id="node572" class="node">
<title>Layer_11_Expert_4_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10262.5,-5867.62 9885.5,-5867.62 9885.5,-5799.62 10262.5,-5799.62 10262.5,-5867.62"/>
<text text-anchor="middle" x="10074" y="-5852.42" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10074" y="-5837.42" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="10074" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10074" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_4_EP1_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge897" class="edge">
<title>Layer_11_Expert_4_EP1_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10262.66,-5800.48C10265.46,-5800.17 10268.24,-5799.89 10271,-5799.62 10747.77,-5752.74 12160.42,-5728.48 12761.39,-5720.04"/>
<polygon fill="black" stroke="black" points="12761.55,-5723.54 12771.5,-5719.9 12761.45,-5716.54 12761.55,-5723.54"/>
</g>
<!-- Layer_11_Expert_4_EP1_TP1_PP2 -->
<g id="node573" class="node">
<title>Layer_11_Expert_4_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="10657.5,-5867.62 10280.5,-5867.62 10280.5,-5799.62 10657.5,-5799.62 10657.5,-5867.62"/>
<text text-anchor="middle" x="10469" y="-5852.42" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10469" y="-5837.42" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="10469" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10469" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_4_EP1_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge899" class="edge">
<title>Layer_11_Expert_4_EP1_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M10657.66,-5800.5C10660.46,-5800.19 10663.24,-5799.9 10666,-5799.62 11064.74,-5759.41 12227.33,-5732.32 12762.07,-5721.64"/>
<polygon fill="black" stroke="black" points="12762.31,-5725.14 12772.24,-5721.44 12762.17,-5718.14 12762.31,-5725.14"/>
</g>
<!-- Layer_11_Expert_5_EP1_TP0_PP2 -->
<g id="node574" class="node">
<title>Layer_11_Expert_5_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11052.5,-5867.62 10675.5,-5867.62 10675.5,-5799.62 11052.5,-5799.62 11052.5,-5867.62"/>
<text text-anchor="middle" x="10864" y="-5852.42" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10864" y="-5837.42" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="10864" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10864" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_5_EP1_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge901" class="edge">
<title>Layer_11_Expert_5_EP1_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11052.67,-5800.52C11055.46,-5800.21 11058.24,-5799.9 11061,-5799.62 11665.01,-5736.57 12377.62,-5720.98 12760.45,-5717.37"/>
<polygon fill="black" stroke="black" points="12760.59,-5720.87 12770.56,-5717.28 12760.53,-5713.87 12760.59,-5720.87"/>
</g>
<!-- Layer_11_Expert_5_EP1_TP1_PP2 -->
<g id="node575" class="node">
<title>Layer_11_Expert_5_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11447.5,-5867.62 11070.5,-5867.62 11070.5,-5799.62 11447.5,-5799.62 11447.5,-5867.62"/>
<text text-anchor="middle" x="11259" y="-5852.42" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="11259" y="-5837.42" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="11259" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11259" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_5_EP1_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge903" class="edge">
<title>Layer_11_Expert_5_EP1_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11447.67,-5800.56C11450.46,-5800.24 11453.24,-5799.92 11456,-5799.62 11912.27,-5749.58 12446.05,-5729.47 12762.04,-5721.53"/>
<polygon fill="black" stroke="black" points="12762.35,-5725.03 12772.26,-5721.28 12762.17,-5718.03 12762.35,-5725.03"/>
</g>
<!-- Layer_11_Expert_6_EP1_TP0_PP2 -->
<g id="node576" class="node">
<title>Layer_11_Expert_6_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="11842.5,-5867.62 11465.5,-5867.62 11465.5,-5799.62 11842.5,-5799.62 11842.5,-5867.62"/>
<text text-anchor="middle" x="11654" y="-5852.42" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="11654" y="-5837.42" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="11654" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11654" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_6_EP1_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge905" class="edge">
<title>Layer_11_Expert_6_EP1_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M11842.68,-5800.63C11845.47,-5800.28 11848.25,-5799.94 11851,-5799.62 12164.84,-5762.42 12527.52,-5740 12768.36,-5727.98"/>
<polygon fill="black" stroke="black" points="12768.85,-5731.46 12778.66,-5727.47 12768.5,-5724.47 12768.85,-5731.46"/>
</g>
<!-- Layer_11_Expert_6_EP1_TP1_PP2 -->
<g id="node577" class="node">
<title>Layer_11_Expert_6_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12237.5,-5867.62 11860.5,-5867.62 11860.5,-5799.62 12237.5,-5799.62 12237.5,-5867.62"/>
<text text-anchor="middle" x="12049" y="-5852.42" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12049" y="-5837.42" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="12049" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12049" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_6_EP1_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge907" class="edge">
<title>Layer_11_Expert_6_EP1_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12237.7,-5800.77C12240.48,-5800.37 12243.25,-5799.99 12246,-5799.62 12427.58,-5774.9 12633.47,-5753.48 12789.67,-5738.58"/>
<polygon fill="black" stroke="black" points="12790.26,-5742.04 12799.88,-5737.61 12789.6,-5735.07 12790.26,-5742.04"/>
</g>
<!-- Layer_11_Expert_7_EP1_TP0_PP2 -->
<g id="node578" class="node">
<title>Layer_11_Expert_7_EP1_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="12632.5,-5867.62 12255.5,-5867.62 12255.5,-5799.62 12632.5,-5799.62 12632.5,-5867.62"/>
<text text-anchor="middle" x="12444" y="-5852.42" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12444" y="-5837.42" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="12444" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12444" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_7_EP1_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge909" class="edge">
<title>Layer_11_Expert_7_EP1_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12612.74,-5799.58C12686.38,-5785.17 12773.03,-5768.21 12848.75,-5753.38"/>
<polygon fill="black" stroke="black" points="12849.74,-5756.76 12858.88,-5751.4 12848.4,-5749.89 12849.74,-5756.76"/>
</g>
<!-- Layer_11_Expert_7_EP1_TP1_PP2 -->
<g id="node579" class="node">
<title>Layer_11_Expert_7_EP1_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13027.5,-5867.62 12650.5,-5867.62 12650.5,-5799.62 13027.5,-5799.62 13027.5,-5867.62"/>
<text text-anchor="middle" x="12839" y="-5852.42" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12839" y="-5837.42" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="12839" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12839" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_7_EP1_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge911" class="edge">
<title>Layer_11_Expert_7_EP1_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M12895.47,-5799.51C12912.92,-5789.28 12932.54,-5777.78 12951.49,-5766.67"/>
<polygon fill="black" stroke="black" points="12953.28,-5769.67 12960.14,-5761.6 12949.74,-5763.63 12953.28,-5769.67"/>
</g>
<!-- Layer_11_Expert_8_EP2_TP0_PP2 -->
<g id="node580" class="node">
<title>Layer_11_Expert_8_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13422.5,-5867.62 13045.5,-5867.62 13045.5,-5799.62 13422.5,-5799.62 13422.5,-5867.62"/>
<text text-anchor="middle" x="13234" y="-5852.42" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="13234" y="-5837.42" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="13234" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13234" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_8_EP2_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge913" class="edge">
<title>Layer_11_Expert_8_EP2_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13177.81,-5799.51C13160.53,-5789.33 13141.11,-5777.88 13122.33,-5766.82"/>
<polygon fill="black" stroke="black" points="13123.87,-5763.66 13113.47,-5761.6 13120.31,-5769.69 13123.87,-5763.66"/>
</g>
<!-- Layer_11_Expert_8_EP2_TP1_PP2 -->
<g id="node581" class="node">
<title>Layer_11_Expert_8_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="13817.5,-5867.62 13440.5,-5867.62 13440.5,-5799.62 13817.5,-5799.62 13817.5,-5867.62"/>
<text text-anchor="middle" x="13629" y="-5852.42" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="13629" y="-5837.42" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="13629" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13629" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_8_EP2_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge915" class="edge">
<title>Layer_11_Expert_8_EP2_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13460.54,-5799.58C13387.03,-5785.17 13300.53,-5768.21 13224.93,-5753.38"/>
<polygon fill="black" stroke="black" points="13225.3,-5749.89 13214.82,-5751.4 13223.96,-5756.76 13225.3,-5749.89"/>
</g>
<!-- Layer_11_Expert_9_EP2_TP0_PP2 -->
<g id="node582" class="node">
<title>Layer_11_Expert_9_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14212.5,-5867.62 13835.5,-5867.62 13835.5,-5799.62 14212.5,-5799.62 14212.5,-5867.62"/>
<text text-anchor="middle" x="14024" y="-5852.42" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14024" y="-5837.42" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="14024" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14024" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_9_EP2_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge917" class="edge">
<title>Layer_11_Expert_9_EP2_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M13835.4,-5800.92C13832.24,-5800.47 13829.11,-5800.04 13826,-5799.62 13645.04,-5775.03 13439.88,-5753.63 13284.13,-5738.7"/>
<polygon fill="black" stroke="black" points="13284.23,-5735.2 13273.94,-5737.73 13283.57,-5742.16 13284.23,-5735.2"/>
</g>
<!-- Layer_11_Expert_9_EP2_TP1_PP2 -->
<g id="node583" class="node">
<title>Layer_11_Expert_9_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="14607.5,-5867.62 14230.5,-5867.62 14230.5,-5799.62 14607.5,-5799.62 14607.5,-5867.62"/>
<text text-anchor="middle" x="14419" y="-5852.42" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14419" y="-5837.42" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="14419" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14419" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_9_EP2_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge919" class="edge">
<title>Layer_11_Expert_9_EP2_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14230.42,-5800.76C14227.26,-5800.37 14224.11,-5799.98 14221,-5799.62 13907.8,-5762.61 13545.9,-5740.16 13305.47,-5728.08"/>
<polygon fill="black" stroke="black" points="13305.35,-5724.57 13295.19,-5727.57 13305,-5731.56 13305.35,-5724.57"/>
</g>
<!-- Layer_11_Expert_10_EP2_TP0_PP2 -->
<g id="node584" class="node">
<title>Layer_11_Expert_10_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15002.5,-5867.62 14625.5,-5867.62 14625.5,-5799.62 15002.5,-5799.62 15002.5,-5867.62"/>
<text text-anchor="middle" x="14814" y="-5852.42" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="14814" y="-5837.42" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="14814" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="14814" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_10_EP2_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge921" class="edge">
<title>Layer_11_Expert_10_EP2_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M14625.42,-5800.69C14622.26,-5800.32 14619.12,-5799.96 14616,-5799.62 14160.45,-5749.83 13627.59,-5729.64 13311.95,-5721.63"/>
<polygon fill="black" stroke="black" points="13311.83,-5718.12 13301.75,-5721.37 13311.66,-5725.12 13311.83,-5718.12"/>
</g>
<!-- Layer_11_Expert_10_EP2_TP1_PP2 -->
<g id="node585" class="node">
<title>Layer_11_Expert_10_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15397.5,-5867.62 15020.5,-5867.62 15020.5,-5799.62 15397.5,-5799.62 15397.5,-5867.62"/>
<text text-anchor="middle" x="15209" y="-5852.42" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15209" y="-5837.42" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="15209" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15209" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_10_EP2_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge923" class="edge">
<title>Layer_11_Expert_10_EP2_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15020.43,-5800.64C15017.26,-5800.28 15014.12,-5799.94 15011,-5799.62 14407.78,-5736.9 13696.19,-5721.18 13313.66,-5717.46"/>
<polygon fill="black" stroke="black" points="13313.59,-5713.96 13303.56,-5717.36 13313.53,-5720.96 13313.59,-5713.96"/>
</g>
<!-- Layer_11_Expert_11_EP2_TP0_PP2 -->
<g id="node586" class="node">
<title>Layer_11_Expert_11_EP2_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="15792.5,-5867.62 15415.5,-5867.62 15415.5,-5799.62 15792.5,-5799.62 15792.5,-5867.62"/>
<text text-anchor="middle" x="15604" y="-5852.42" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="15604" y="-5837.42" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="15604" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15604" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_11_EP2_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge925" class="edge">
<title>Layer_11_Expert_11_EP2_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15415.43,-5800.61C15412.27,-5800.26 15409.12,-5799.93 15406,-5799.62 15007.64,-5759.61 13846.35,-5732.42 13311.95,-5721.68"/>
<polygon fill="black" stroke="black" points="13311.86,-5718.18 13301.79,-5721.47 13311.72,-5725.17 13311.86,-5718.18"/>
</g>
<!-- Layer_11_Expert_11_EP2_TP1_PP2 -->
<g id="node587" class="node">
<title>Layer_11_Expert_11_EP2_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16187.5,-5867.62 15810.5,-5867.62 15810.5,-5799.62 16187.5,-5799.62 16187.5,-5867.62"/>
<text text-anchor="middle" x="15999" y="-5852.42" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="15999" y="-5837.42" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="15999" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="15999" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_11_EP2_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge927" class="edge">
<title>Layer_11_Expert_11_EP2_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M15810.43,-5800.59C15807.27,-5800.25 15804.12,-5799.92 15801,-5799.62 15324.63,-5752.97 13913.38,-5728.59 13312.68,-5720.08"/>
<polygon fill="black" stroke="black" points="13312.63,-5716.58 13302.59,-5719.94 13312.54,-5723.58 13312.63,-5716.58"/>
</g>
<!-- Layer_11_Expert_12_EP3_TP0_PP2 -->
<g id="node588" class="node">
<title>Layer_11_Expert_12_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16582.5,-5867.62 16205.5,-5867.62 16205.5,-5799.62 16582.5,-5799.62 16582.5,-5867.62"/>
<text text-anchor="middle" x="16394" y="-5852.42" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="16394" y="-5837.42" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="16394" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16394" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_12_EP3_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge929" class="edge">
<title>Layer_11_Expert_12_EP3_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16205.44,-5800.57C16202.27,-5800.24 16199.12,-5799.92 16196,-5799.62 15640.97,-5746.33 13975.76,-5725.28 13313.27,-5718.87"/>
<polygon fill="black" stroke="black" points="13313.14,-5715.37 13303.1,-5718.78 13313.07,-5722.37 13313.14,-5715.37"/>
</g>
<!-- Layer_11_Expert_12_EP3_TP1_PP2 -->
<g id="node589" class="node">
<title>Layer_11_Expert_12_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="16977.5,-5867.62 16600.5,-5867.62 16600.5,-5799.62 16977.5,-5799.62 16977.5,-5867.62"/>
<text text-anchor="middle" x="16789" y="-5852.42" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="16789" y="-5837.42" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="16789" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="16789" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_12_EP3_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge931" class="edge">
<title>Layer_11_Expert_12_EP3_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16600.44,-5800.56C16597.27,-5800.23 16594.12,-5799.91 16591,-5799.62 15956.74,-5739.65 14034.12,-5722.37 13313.61,-5717.93"/>
<polygon fill="black" stroke="black" points="13313.37,-5714.43 13303.35,-5717.86 13313.33,-5721.43 13313.37,-5714.43"/>
</g>
<!-- Layer_11_Expert_13_EP3_TP0_PP2 -->
<g id="node590" class="node">
<title>Layer_11_Expert_13_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17372.5,-5867.62 16995.5,-5867.62 16995.5,-5799.62 17372.5,-5799.62 17372.5,-5867.62"/>
<text text-anchor="middle" x="17184" y="-5852.42" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17184" y="-5837.42" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="17184" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17184" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_13_EP3_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge933" class="edge">
<title>Layer_11_Expert_13_EP3_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M16995.44,-5800.55C16992.27,-5800.22 16989.12,-5799.91 16986,-5799.62 16272.03,-5732.96 14089.02,-5719.76 13313.75,-5717.17"/>
<polygon fill="black" stroke="black" points="13313.57,-5713.66 13303.56,-5717.13 13313.55,-5720.66 13313.57,-5713.66"/>
</g>
<!-- Layer_11_Expert_13_EP3_TP1_PP2 -->
<g id="node591" class="node">
<title>Layer_11_Expert_13_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="17767.5,-5867.62 17390.5,-5867.62 17390.5,-5799.62 17767.5,-5799.62 17767.5,-5867.62"/>
<text text-anchor="middle" x="17579" y="-5852.42" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17579" y="-5837.42" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="17579" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17579" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_13_EP3_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge935" class="edge">
<title>Layer_11_Expert_13_EP3_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17390.44,-5800.54C17387.27,-5800.21 17384.12,-5799.91 17381,-5799.62 16586.96,-5726.25 14141.41,-5717.4 13313.95,-5716.54"/>
<polygon fill="black" stroke="black" points="13313.69,-5713.04 13303.69,-5716.53 13313.68,-5720.04 13313.69,-5713.04"/>
</g>
<!-- Layer_11_Expert_14_EP3_TP0_PP2 -->
<g id="node592" class="node">
<title>Layer_11_Expert_14_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18162.5,-5867.62 17785.5,-5867.62 17785.5,-5799.62 18162.5,-5799.62 18162.5,-5867.62"/>
<text text-anchor="middle" x="17974" y="-5852.42" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="17974" y="-5837.42" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="17974" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="17974" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_14_EP3_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge937" class="edge">
<title>Layer_11_Expert_14_EP3_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M17785.44,-5800.54C17782.27,-5800.21 17779.12,-5799.9 17776,-5799.62 16901.48,-5719.52 14190.86,-5715.23 13313.83,-5716.02"/>
<polygon fill="black" stroke="black" points="13313.59,-5712.52 13303.6,-5716.03 13313.6,-5719.52 13313.59,-5712.52"/>
</g>
<!-- Layer_11_Expert_14_EP3_TP1_PP2 -->
<g id="node593" class="node">
<title>Layer_11_Expert_14_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18557.5,-5867.62 18180.5,-5867.62 18180.5,-5799.62 18557.5,-5799.62 18557.5,-5867.62"/>
<text text-anchor="middle" x="18369" y="-5852.42" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="18369" y="-5837.42" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="18369" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18369" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_14_EP3_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge939" class="edge">
<title>Layer_11_Expert_14_EP3_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18180.44,-5800.53C18177.27,-5800.21 18174.12,-5799.9 18171,-5799.62 17687.57,-5755.67 14310.12,-5726.36 13313.33,-5718.59"/>
<polygon fill="black" stroke="black" points="13313.18,-5715.09 13303.15,-5718.51 13313.13,-5722.09 13313.18,-5715.09"/>
</g>
<!-- Layer_11_Expert_15_EP3_TP0_PP2 -->
<g id="node594" class="node">
<title>Layer_11_Expert_15_EP3_TP0_PP2</title>
<polygon fill="lightcoral" stroke="black" points="18952.5,-5867.62 18575.5,-5867.62 18575.5,-5799.62 18952.5,-5799.62 18952.5,-5867.62"/>
<text text-anchor="middle" x="18764" y="-5852.42" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="18764" y="-5837.42" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="18764" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="18764" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_15_EP3_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge941" class="edge">
<title>Layer_11_Expert_15_EP3_TP0_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18575.44,-5800.52C18572.27,-5800.2 18569.12,-5799.9 18566,-5799.62 18041.95,-5752.28 14360.23,-5725.09 13313.8,-5718.25"/>
<polygon fill="black" stroke="black" points="13313.53,-5714.75 13303.51,-5718.19 13313.48,-5721.75 13313.53,-5714.75"/>
</g>
<!-- Layer_11_Expert_15_EP3_TP1_PP2 -->
<g id="node595" class="node">
<title>Layer_11_Expert_15_EP3_TP1_PP2</title>
<polygon fill="lightcoral" stroke="black" points="19347.5,-5867.62 18970.5,-5867.62 18970.5,-5799.62 19347.5,-5799.62 19347.5,-5867.62"/>
<text text-anchor="middle" x="19159" y="-5852.42" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="19159" y="-5837.42" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="19159" y="-5822.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="19159" y="-5807.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_Expert_15_EP3_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2 -->
<g id="edge943" class="edge">
<title>Layer_11_Expert_15_EP3_TP1_PP2&#45;&gt;Layer_11_A2A_Combine_PP2</title>
<path fill="none" stroke="black" d="M18970.44,-5800.52C18967.27,-5800.2 18964.12,-5799.9 18961,-5799.62 18396.15,-5748.88 14407.71,-5723.9 13313.87,-5717.95"/>
<polygon fill="black" stroke="black" points="13313.53,-5714.45 13303.51,-5717.9 13313.49,-5721.45 13313.53,-5714.45"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_0_EP0_TP0_PP2 -->
<g id="edge880" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_0_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12603.76,-5949.24C11550.78,-5943.12 7706.01,-5917.63 7112.8,-5867.7"/>
<polygon fill="black" stroke="black" points="7112.92,-5864.2 7102.66,-5866.82 7112.31,-5871.17 7112.92,-5864.2"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_0_EP0_TP1_PP2 -->
<g id="edge882" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_0_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12603.71,-5948.93C11597.97,-5941.92 8060.07,-5914.26 7507.87,-5867.71"/>
<polygon fill="black" stroke="black" points="7507.92,-5864.2 7497.66,-5866.81 7507.31,-5871.17 7507.92,-5864.2"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_1_EP0_TP0_PP2 -->
<g id="edge884" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_1_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12603.76,-5948.58C11647.1,-5940.63 8413.68,-5910.9 7902.82,-5867.7"/>
<polygon fill="black" stroke="black" points="7902.93,-5864.2 7892.66,-5866.81 7902.31,-5871.17 7902.93,-5864.2"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_1_EP0_TP1_PP2 -->
<g id="edge886" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_1_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12603.1,-5951.04C11760.21,-5951.28 9160.54,-5945.6 8297.73,-5867.72"/>
<polygon fill="black" stroke="black" points="8297.93,-5864.23 8287.66,-5866.8 8297.3,-5871.2 8297.93,-5864.23"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_2_EP0_TP0_PP2 -->
<g id="edge888" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_2_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12603.28,-5950.49C11810.37,-5949.08 9474.81,-5938.88 8692.64,-5867.72"/>
<polygon fill="black" stroke="black" points="8692.94,-5864.23 8682.66,-5866.8 8692.29,-5871.2 8692.94,-5864.23"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_2_EP0_TP1_PP2 -->
<g id="edge890" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_2_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12603.33,-5949.84C11862.68,-5946.67 9789.51,-5932.18 9087.64,-5867.72"/>
<polygon fill="black" stroke="black" points="9087.94,-5864.23 9077.66,-5866.79 9087.29,-5871.2 9087.94,-5864.23"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_3_EP0_TP0_PP2 -->
<g id="edge892" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_3_EP0_TP0_PP2</title>
<path fill="none" stroke="black" d="M12603.6,-5949.04C11918.2,-5944 10104.62,-5925.52 9482.63,-5867.72"/>
<polygon fill="black" stroke="black" points="9482.94,-5864.23 9472.66,-5866.78 9482.29,-5871.2 9482.94,-5864.23"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_3_EP0_TP1_PP2 -->
<g id="edge894" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_3_EP0_TP1_PP2</title>
<path fill="none" stroke="black" d="M12603.95,-5948.03C11977.24,-5941 10420.76,-5918.89 9877.94,-5867.75"/>
<polygon fill="black" stroke="black" points="9877.95,-5864.24 9867.66,-5866.77 9877.28,-5871.2 9877.95,-5864.24"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_4_EP1_TP0_PP2 -->
<g id="edge896" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_4_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12604.64,-5946.73C12040.54,-5937.57 10736.57,-5912.3 10272.79,-5867.74"/>
<polygon fill="black" stroke="black" points="10272.96,-5864.24 10262.66,-5866.75 10272.27,-5871.21 10272.96,-5864.24"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_4_EP1_TP1_PP2 -->
<g id="edge898" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_4_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12605.94,-5945C12109.55,-5933.57 11053.32,-5905.77 10667.76,-5867.74"/>
<polygon fill="black" stroke="black" points="10667.96,-5864.24 10657.66,-5866.73 10667.26,-5871.21 10667.96,-5864.24"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_5_EP1_TP0_PP2 -->
<g id="edge900" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_5_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12603.71,-5948.45C12252.42,-5943.22 11614.97,-5925.9 11062.83,-5867.77"/>
<polygon fill="black" stroke="black" points="11062.98,-5864.27 11052.67,-5866.7 11062.24,-5871.23 11062.98,-5864.27"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_5_EP1_TP1_PP2 -->
<g id="edge902" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_5_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12607.04,-5943.68C12324.92,-5934.2 11863.72,-5913.09 11457.85,-5867.79"/>
<polygon fill="black" stroke="black" points="11458,-5864.28 11447.67,-5866.65 11457.22,-5871.24 11458,-5864.28"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_6_EP1_TP0_PP2 -->
<g id="edge904" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_6_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12617.61,-5936.08C12413.65,-5922.86 12119.06,-5900.57 11852.94,-5867.83"/>
<polygon fill="black" stroke="black" points="11853.04,-5864.31 11842.68,-5866.56 11852.18,-5871.26 11853.04,-5864.31"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_6_EP1_TP1_PP2 -->
<g id="edge906" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_6_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12653.16,-5923.65C12535.85,-5908.57 12388.2,-5888.87 12247.81,-5867.88"/>
<polygon fill="black" stroke="black" points="12248.12,-5864.38 12237.71,-5866.36 12247.08,-5871.31 12248.12,-5864.38"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_7_EP1_TP0_PP2 -->
<g id="edge908" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_7_EP1_TP0_PP2</title>
<path fill="none" stroke="black" d="M12725.18,-5911.24C12676.55,-5897.99 12622.62,-5883.29 12575.1,-5870.34"/>
<polygon fill="black" stroke="black" points="12575.95,-5866.94 12565.38,-5867.69 12574.11,-5873.7 12575.95,-5866.94"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_7_EP1_TP1_PP2 -->
<g id="edge910" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_7_EP1_TP1_PP2</title>
<path fill="none" stroke="black" d="M12857.39,-5903.48C12855.13,-5895.01 12852.78,-5886.21 12850.54,-5877.85"/>
<polygon fill="black" stroke="black" points="12853.86,-5876.68 12847.89,-5867.92 12847.09,-5878.48 12853.86,-5876.68"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_8_EP2_TP0_PP2 -->
<g id="edge912" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_8_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M12999.1,-5909.53C13038.77,-5896.88 13082.11,-5883.05 13120.65,-5870.77"/>
<polygon fill="black" stroke="black" points="13121.87,-5874.05 13130.33,-5867.68 13119.74,-5867.38 13121.87,-5874.05"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_8_EP2_TP1_PP2 -->
<g id="edge914" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_8_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13075.96,-5921.11C13179.29,-5906.04 13306.64,-5887.13 13430.33,-5867.71"/>
<polygon fill="black" stroke="black" points="13431.03,-5871.15 13440.37,-5866.14 13429.95,-5864.23 13431.03,-5871.15"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_9_EP2_TP0_PP2 -->
<g id="edge916" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_9_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13118.92,-5934.44C13309.54,-5920.71 13579.17,-5898.53 13825.19,-5867.68"/>
<polygon fill="black" stroke="black" points="13825.92,-5871.12 13835.41,-5866.4 13825.05,-5864.18 13825.92,-5871.12"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_9_EP2_TP1_PP2 -->
<g id="edge918" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_9_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13131.9,-5942.64C13402.2,-5932.46 13836.07,-5910.92 14220.21,-5867.66"/>
<polygon fill="black" stroke="black" points="14220.88,-5871.11 14230.42,-5866.51 14220.09,-5864.15 14220.88,-5871.11"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_10_EP2_TP0_PP2 -->
<g id="edge920" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_10_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13135.86,-5947.76C13476.62,-5941.77 14085.61,-5923.64 14615.29,-5867.65"/>
<polygon fill="black" stroke="black" points="14615.85,-5871.1 14625.43,-5866.57 14615.11,-5864.14 14615.85,-5871.1"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_10_EP2_TP1_PP2 -->
<g id="edge922" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_10_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13136.95,-5951.15C13540.82,-5949.41 14331.13,-5936.51 15010.44,-5867.62"/>
<polygon fill="black" stroke="black" points="15010.84,-5871.1 15020.43,-5866.61 15010.13,-5864.14 15010.84,-5871.1"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_11_EP2_TP0_PP2 -->
<g id="edge924" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_11_EP2_TP0_PP2</title>
<path fill="none" stroke="black" d="M13135.24,-5946.46C13688.89,-5936.9 14952.84,-5911.08 15405.23,-5867.63"/>
<polygon fill="black" stroke="black" points="15405.82,-5871.09 15415.43,-5866.63 15405.14,-5864.12 15405.82,-5871.09"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_11_EP2_TP1_PP2 -->
<g id="edge926" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_11_EP2_TP1_PP2</title>
<path fill="none" stroke="black" d="M13135.89,-5947.82C13752.95,-5940.39 15269.29,-5917.63 15800.38,-5867.61"/>
<polygon fill="black" stroke="black" points="15800.81,-5871.09 15810.44,-5866.65 15800.15,-5864.12 15800.81,-5871.09"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_12_EP3_TP0_PP2 -->
<g id="edge928" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_12_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13136.38,-5948.87C13812.61,-5943.45 15584.6,-5924.22 16195.2,-5867.63"/>
<polygon fill="black" stroke="black" points="16195.81,-5871.09 16205.44,-5866.67 16195.15,-5864.12 16195.81,-5871.09"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_12_EP3_TP1_PP2 -->
<g id="edge930" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_12_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13136.52,-5949.7C13868.42,-5946.16 15900.06,-5930.85 16590.37,-5867.61"/>
<polygon fill="black" stroke="black" points="16590.8,-5871.09 16600.44,-5866.68 16590.16,-5864.12 16590.8,-5871.09"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_13_EP3_TP0_PP2 -->
<g id="edge932" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_13_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13136.53,-5950.37C13921.07,-5948.6 16214.7,-5937.51 16985.32,-5867.62"/>
<polygon fill="black" stroke="black" points="16985.8,-5871.09 16995.44,-5866.69 16985.16,-5864.12 16985.8,-5871.09"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_13_EP3_TP1_PP2 -->
<g id="edge934" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_13_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13136.9,-5950.93C13971.93,-5950.83 16528.98,-5944.18 17380.19,-5867.63"/>
<polygon fill="black" stroke="black" points="17380.8,-5871.09 17390.44,-5866.69 17380.16,-5864.12 17380.8,-5871.09"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_14_EP3_TP0_PP2 -->
<g id="edge936" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_14_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13136.65,-5951.4C14019.43,-5952.88 16843.13,-5950.9 17775.24,-5867.62"/>
<polygon fill="black" stroke="black" points="17775.8,-5871.09 17785.44,-5866.7 17775.17,-5864.11 17775.8,-5871.09"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_14_EP3_TP1_PP2 -->
<g id="edge938" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_14_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13136.16,-5948.87C14134.1,-5941.67 17624.01,-5913.51 18170.33,-5867.59"/>
<polygon fill="black" stroke="black" points="18170.78,-5871.06 18180.44,-5866.71 18170.17,-5864.09 18170.78,-5871.06"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_15_EP3_TP0_PP2 -->
<g id="edge940" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_15_EP3_TP0_PP2</title>
<path fill="none" stroke="black" d="M13136.45,-5949.18C14182.37,-5942.87 17978.1,-5916.86 18565.39,-5867.58"/>
<polygon fill="black" stroke="black" points="18565.78,-5871.06 18575.44,-5866.71 18565.18,-5864.09 18565.78,-5871.06"/>
</g>
<!-- Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_15_EP3_TP1_PP2 -->
<g id="edge942" class="edge">
<title>Layer_11_A2A_Dispatch_PP2&#45;&gt;Layer_11_Expert_15_EP3_TP1_PP2</title>
<path fill="none" stroke="black" d="M13136.55,-5949.45C14228.38,-5943.99 18330.63,-5920.23 18960.11,-5867.61"/>
<polygon fill="black" stroke="black" points="18960.78,-5871.06 18970.44,-5866.72 18960.18,-5864.09 18960.78,-5871.06"/>
</g>
<!-- Layer_11_MLP_Out_TP0_PP2 -->
<g id="node598" class="node">
<title>Layer_11_MLP_Out_TP0_PP2</title>
<polygon fill="lightblue" stroke="black" points="13028.5,-5631.45 12651.5,-5631.45 12651.5,-5563.45 13028.5,-5563.45 13028.5,-5631.45"/>
<text text-anchor="middle" x="12840" y="-5616.25" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="12840" y="-5601.25" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12840" y="-5586.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12840" y="-5571.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_A2A_Combine_PP2&#45;&gt;Layer_11_MLP_Out_TP0_PP2 -->
<g id="edge944" class="edge">
<title>Layer_11_A2A_Combine_PP2&#45;&gt;Layer_11_MLP_Out_TP0_PP2</title>
<path fill="none" stroke="black" d="M12960.27,-5669.32C12942.05,-5658.59 12922.79,-5647.24 12905.15,-5636.84"/>
<polygon fill="black" stroke="black" points="12906.48,-5633.56 12896.09,-5631.5 12902.92,-5639.59 12906.48,-5633.56"/>
</g>
<!-- Layer_11_MLP_Out_TP1_PP2 -->
<g id="node599" class="node">
<title>Layer_11_MLP_Out_TP1_PP2</title>
<polygon fill="lightblue" stroke="black" points="13423.5,-5631.45 13046.5,-5631.45 13046.5,-5563.45 13423.5,-5563.45 13423.5,-5631.45"/>
<text text-anchor="middle" x="13235" y="-5616.25" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="13235" y="-5601.25" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="13235" y="-5586.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13235" y="-5571.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_11_A2A_Combine_PP2&#45;&gt;Layer_11_MLP_Out_TP1_PP2 -->
<g id="edge946" class="edge">
<title>Layer_11_A2A_Combine_PP2&#45;&gt;Layer_11_MLP_Out_TP1_PP2</title>
<path fill="none" stroke="black" d="M13113.84,-5669.49C13132.33,-5658.64 13151.92,-5647.16 13169.82,-5636.66"/>
<polygon fill="black" stroke="black" points="13171.61,-5639.67 13178.47,-5631.59 13168.07,-5633.63 13171.61,-5639.67"/>
</g>
<!-- Layer_11_MLP_AllReduce_PP2 -->
<g id="node600" class="node">
<title>Layer_11_MLP_AllReduce_PP2</title>
<ellipse fill="yellow" stroke="black" cx="13037" cy="-5479.37" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="13037" y="-5498.17" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="13037" y="-5483.17" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13037" y="-5468.17" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13037" y="-5453.17" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_11_MLP_Out_TP0_PP2&#45;&gt;Layer_11_MLP_AllReduce_PP2 -->
<g id="edge945" class="edge">
<title>Layer_11_MLP_Out_TP0_PP2&#45;&gt;Layer_11_MLP_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M12896.19,-5563.34C12913.47,-5553.16 12932.89,-5541.71 12951.67,-5530.65"/>
<polygon fill="black" stroke="black" points="12953.69,-5533.52 12960.53,-5525.43 12950.13,-5527.49 12953.69,-5533.52"/>
</g>
<!-- Layer_11_MLP_Out_TP1_PP2&#45;&gt;Layer_11_MLP_AllReduce_PP2 -->
<g id="edge947" class="edge">
<title>Layer_11_MLP_Out_TP1_PP2&#45;&gt;Layer_11_MLP_AllReduce_PP2</title>
<path fill="none" stroke="black" d="M13178.53,-5563.34C13161.08,-5553.11 13141.46,-5541.61 13122.51,-5530.5"/>
<polygon fill="black" stroke="black" points="13124.26,-5527.47 13113.86,-5525.43 13120.72,-5533.51 13124.26,-5527.47"/>
</g>
<!-- Layer_11_LayerNorm_PP2 -->
<g id="node601" class="node">
<title>Layer_11_LayerNorm_PP2</title>
<polygon fill="lightgreen" stroke="black" points="13225.5,-5395.28 12848.5,-5395.28 12848.5,-5327.28 13225.5,-5327.28 13225.5,-5395.28"/>
<text text-anchor="middle" x="13037" y="-5380.08" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13037" y="-5365.08" font-family="Arial" font-size="14.00">PP Stage 2</text>
<text text-anchor="middle" x="13037" y="-5350.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13037" y="-5335.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_11_MLP_AllReduce_PP2&#45;&gt;Layer_11_LayerNorm_PP2 -->
<g id="edge948" class="edge">
<title>Layer_11_MLP_AllReduce_PP2&#45;&gt;Layer_11_LayerNorm_PP2</title>
<path fill="none" stroke="black" d="M13037,-5431.15C13037,-5422.77 13037,-5414.07 13037,-5405.79"/>
<polygon fill="black" stroke="black" points="13040.5,-5405.59 13037,-5395.59 13033.5,-5405.59 13040.5,-5405.59"/>
</g>
<!-- Layer_12_QKV_TP0_PP3 -->
<g id="node602" class="node">
<title>Layer_12_QKV_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="13227.5,-5248.28 12846.5,-5248.28 12846.5,-5180.28 13227.5,-5180.28 13227.5,-5248.28"/>
<text text-anchor="middle" x="13037" y="-5233.08" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="13037" y="-5218.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="13037" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13037" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_11_LayerNorm_PP2&#45;&gt;Layer_12_QKV_TP0_PP3 -->
<g id="edge949" class="edge">
<title>Layer_11_LayerNorm_PP2&#45;&gt;Layer_12_QKV_TP0_PP3</title>
<path fill="none" stroke="black" d="M13037,-5327.02C13037,-5306.66 13037,-5280.4 13037,-5258.46"/>
<polygon fill="black" stroke="black" points="13040.5,-5258.39 13037,-5248.39 13033.5,-5258.39 13040.5,-5258.39"/>
</g>
<!-- Layer_12_QKV_AllReduce_PP3 -->
<g id="node604" class="node">
<title>Layer_12_QKV_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="12638" cy="-5062.2" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="12638" y="-5081" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="12638" y="-5066" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="12638" y="-5051" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="12638" y="-5036" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_12_QKV_TP0_PP3&#45;&gt;Layer_12_QKV_AllReduce_PP3 -->
<g id="edge950" class="edge">
<title>Layer_12_QKV_TP0_PP3&#45;&gt;Layer_12_QKV_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M12948.94,-5180.16C12893.94,-5159.47 12822.29,-5132.52 12761.64,-5109.71"/>
<polygon fill="black" stroke="black" points="12762.6,-5106.33 12752,-5106.08 12760.13,-5112.88 12762.6,-5106.33"/>
</g>
<!-- Layer_12_QKV_TP1_PP3 -->
<g id="node603" class="node">
<title>Layer_12_QKV_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="12828.5,-5248.28 12447.5,-5248.28 12447.5,-5180.28 12828.5,-5180.28 12828.5,-5248.28"/>
<text text-anchor="middle" x="12638" y="-5233.08" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="12638" y="-5218.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="12638" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12638" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_12_QKV_TP1_PP3&#45;&gt;Layer_12_QKV_AllReduce_PP3 -->
<g id="edge954" class="edge">
<title>Layer_12_QKV_TP1_PP3&#45;&gt;Layer_12_QKV_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M12638,-5179.98C12638,-5162.47 12638,-5140.51 12638,-5120.38"/>
<polygon fill="black" stroke="black" points="12641.5,-5120.36 12638,-5110.36 12634.5,-5120.36 12641.5,-5120.36"/>
</g>
<!-- Layer_12_Attention_TP0_PP3 -->
<g id="node605" class="node">
<title>Layer_12_Attention_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="12429.5,-4978.12 12048.5,-4978.12 12048.5,-4910.12 12429.5,-4910.12 12429.5,-4978.12"/>
<text text-anchor="middle" x="12239" y="-4962.92" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="12239" y="-4947.92" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12239" y="-4932.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12239" y="-4917.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_12_QKV_AllReduce_PP3&#45;&gt;Layer_12_Attention_TP0_PP3 -->
<g id="edge951" class="edge">
<title>Layer_12_QKV_AllReduce_PP3&#45;&gt;Layer_12_Attention_TP0_PP3</title>
<path fill="none" stroke="black" d="M12498.73,-5020.68C12454.31,-5007.76 12405.51,-4993.56 12362.31,-4980.99"/>
<polygon fill="black" stroke="black" points="12363.18,-4977.6 12352.61,-4978.17 12361.23,-4984.32 12363.18,-4977.6"/>
</g>
<!-- Layer_12_Attention_TP1_PP3 -->
<g id="node606" class="node">
<title>Layer_12_Attention_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="12828.5,-4978.12 12447.5,-4978.12 12447.5,-4910.12 12828.5,-4910.12 12828.5,-4978.12"/>
<text text-anchor="middle" x="12638" y="-4962.92" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="12638" y="-4947.92" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="12638" y="-4932.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12638" y="-4917.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_12_QKV_AllReduce_PP3&#45;&gt;Layer_12_Attention_TP1_PP3 -->
<g id="edge955" class="edge">
<title>Layer_12_QKV_AllReduce_PP3&#45;&gt;Layer_12_Attention_TP1_PP3</title>
<path fill="none" stroke="black" d="M12638,-5013.98C12638,-5005.6 12638,-4996.9 12638,-4988.62"/>
<polygon fill="black" stroke="black" points="12641.5,-4988.42 12638,-4978.42 12634.5,-4988.42 12641.5,-4988.42"/>
</g>
<!-- Layer_12_AttnOut_TP0_PP3 -->
<g id="node607" class="node">
<title>Layer_12_AttnOut_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="12427.5,-4874.12 12050.5,-4874.12 12050.5,-4806.12 12427.5,-4806.12 12427.5,-4874.12"/>
<text text-anchor="middle" x="12239" y="-4858.92" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="12239" y="-4843.92" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="12239" y="-4828.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12239" y="-4813.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Attention_TP0_PP3&#45;&gt;Layer_12_AttnOut_TP0_PP3 -->
<g id="edge952" class="edge">
<title>Layer_12_Attention_TP0_PP3&#45;&gt;Layer_12_AttnOut_TP0_PP3</title>
<path fill="none" stroke="black" d="M12239,-4910C12239,-4901.9 12239,-4893.1 12239,-4884.59"/>
<polygon fill="black" stroke="black" points="12242.5,-4884.42 12239,-4874.42 12235.5,-4884.42 12242.5,-4884.42"/>
</g>
<!-- Layer_12_AttnOut_TP1_PP3 -->
<g id="node608" class="node">
<title>Layer_12_AttnOut_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="12824.5,-4874.12 12447.5,-4874.12 12447.5,-4806.12 12824.5,-4806.12 12824.5,-4874.12"/>
<text text-anchor="middle" x="12636" y="-4858.92" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="12636" y="-4843.92" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="12636" y="-4828.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="12636" y="-4813.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Attention_TP1_PP3&#45;&gt;Layer_12_AttnOut_TP1_PP3 -->
<g id="edge956" class="edge">
<title>Layer_12_Attention_TP1_PP3&#45;&gt;Layer_12_AttnOut_TP1_PP3</title>
<path fill="none" stroke="black" d="M12637.35,-4910C12637.19,-4901.9 12637.02,-4893.1 12636.85,-4884.59"/>
<polygon fill="black" stroke="black" points="12640.35,-4884.35 12636.65,-4874.42 12633.35,-4884.48 12640.35,-4884.35"/>
</g>
<!-- Layer_12_AttnOut_AllReduce_PP3 -->
<g id="node609" class="node">
<title>Layer_12_AttnOut_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="12239" cy="-4722.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="12239" y="-4740.83" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="12239" y="-4725.83" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="12239" y="-4710.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12239" y="-4695.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_12_AttnOut_TP0_PP3&#45;&gt;Layer_12_AttnOut_AllReduce_PP3 -->
<g id="edge953" class="edge">
<title>Layer_12_AttnOut_TP0_PP3&#45;&gt;Layer_12_AttnOut_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M12239,-4805.85C12239,-4797.86 12239,-4789.09 12239,-4780.35"/>
<polygon fill="black" stroke="black" points="12242.5,-4780.14 12239,-4770.14 12235.5,-4780.14 12242.5,-4780.14"/>
</g>
<!-- Layer_12_AttnOut_TP1_PP3&#45;&gt;Layer_12_AttnOut_AllReduce_PP3 -->
<g id="edge957" class="edge">
<title>Layer_12_AttnOut_TP1_PP3&#45;&gt;Layer_12_AttnOut_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M12523.03,-4806.09C12480.54,-4793.66 12431.58,-4779.34 12386.4,-4766.13"/>
<polygon fill="black" stroke="black" points="12387.1,-4762.69 12376.52,-4763.25 12385.14,-4769.41 12387.1,-4762.69"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3 -->
<g id="node646" class="node">
<title>Layer_12_A2A_Dispatch_PP3</title>
<ellipse fill="yellow" stroke="black" cx="7113" cy="-4589.87" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="7113" y="-4608.67" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="7113" y="-4593.67" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="7113" y="-4578.67" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7113" y="-4563.67" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_12_AttnOut_AllReduce_PP3&#45;&gt;Layer_12_A2A_Dispatch_PP3 -->
<g id="edge958" class="edge">
<title>Layer_12_AttnOut_AllReduce_PP3&#45;&gt;Layer_12_A2A_Dispatch_PP3</title>
<path fill="none" stroke="black" d="M11975.53,-4714.34C11097.89,-4692.06 8278.8,-4620.47 7386.52,-4597.81"/>
<polygon fill="black" stroke="black" points="7386.52,-4594.31 7376.43,-4597.56 7386.34,-4601.31 7386.52,-4594.31"/>
</g>
<!-- Layer_12_Gate_EP0_PP3 -->
<g id="node610" class="node">
<title>Layer_12_Gate_EP0_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="12429.4,-5282.28 11825.86,-5282.28 11670.6,-5146.28 12274.14,-5146.28 12429.4,-5282.28"/>
<text text-anchor="middle" x="12050" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="12050" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="12050" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12050" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_12_Gate_EP1_PP3 -->
<g id="node611" class="node">
<title>Layer_12_Gate_EP1_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="11652.4,-5282.28 11048.86,-5282.28 10893.6,-5146.28 11497.14,-5146.28 11652.4,-5282.28"/>
<text text-anchor="middle" x="11273" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="11273" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="11273" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11273" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_12_Gate_EP2_PP3 -->
<g id="node612" class="node">
<title>Layer_12_Gate_EP2_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="10875.4,-5282.28 10271.86,-5282.28 10116.6,-5146.28 10720.14,-5146.28 10875.4,-5282.28"/>
<text text-anchor="middle" x="10496" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="10496" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="10496" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10496" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_12_Gate_EP3_PP3 -->
<g id="node613" class="node">
<title>Layer_12_Gate_EP3_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="10098.4,-5282.28 9494.86,-5282.28 9339.6,-5146.28 9943.14,-5146.28 10098.4,-5282.28"/>
<text text-anchor="middle" x="9719" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="9719" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="9719" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9719" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_12_Expert_0_EP0_TP0_PP3 -->
<g id="node614" class="node">
<title>Layer_12_Expert_0_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="981.5,-4505.78 604.5,-4505.78 604.5,-4437.78 981.5,-4437.78 981.5,-4505.78"/>
<text text-anchor="middle" x="793" y="-4490.58" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="793" y="-4475.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="793" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="793" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_A2A_Combine_PP3 -->
<g id="node647" class="node">
<title>Layer_12_A2A_Combine_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6905" cy="-4353.7" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6905" y="-4372.5" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="6905" y="-4357.5" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6905" y="-4342.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6905" y="-4327.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_12_Expert_0_EP0_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge960" class="edge">
<title>Layer_12_Expert_0_EP0_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M981.66,-4438.58C984.45,-4438.3 987.24,-4438.03 990,-4437.78 1553.89,-4386.89 5535.24,-4362.03 6628.09,-4356.11"/>
<polygon fill="black" stroke="black" points="6628.46,-4359.61 6638.44,-4356.06 6628.42,-4352.61 6628.46,-4359.61"/>
</g>
<!-- Layer_12_Expert_0_EP0_TP1_PP3 -->
<g id="node615" class="node">
<title>Layer_12_Expert_0_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="1376.5,-4505.78 999.5,-4505.78 999.5,-4437.78 1376.5,-4437.78 1376.5,-4505.78"/>
<text text-anchor="middle" x="1188" y="-4490.58" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1188" y="-4475.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="1188" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1188" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_0_EP0_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge962" class="edge">
<title>Layer_12_Expert_0_EP0_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M1376.66,-4438.58C1379.45,-4438.3 1382.24,-4438.03 1385,-4437.78 1908.11,-4390.31 5582.87,-4363.22 6628.2,-4356.41"/>
<polygon fill="black" stroke="black" points="6628.51,-4359.91 6638.49,-4356.35 6628.47,-4352.91 6628.51,-4359.91"/>
</g>
<!-- Layer_12_Expert_1_EP0_TP0_PP3 -->
<g id="node616" class="node">
<title>Layer_12_Expert_1_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="1771.5,-4505.78 1394.5,-4505.78 1394.5,-4437.78 1771.5,-4437.78 1771.5,-4505.78"/>
<text text-anchor="middle" x="1583" y="-4490.58" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1583" y="-4475.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="1583" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1583" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_1_EP0_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge964" class="edge">
<title>Layer_12_Expert_1_EP0_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M1771.66,-4438.59C1774.45,-4438.31 1777.24,-4438.04 1780,-4437.78 2262.49,-4393.71 5633.14,-4364.5 6628.73,-4356.76"/>
<polygon fill="black" stroke="black" points="6628.92,-4360.25 6638.89,-4356.68 6628.86,-4353.26 6628.92,-4360.25"/>
</g>
<!-- Layer_12_Expert_1_EP0_TP1_PP3 -->
<g id="node617" class="node">
<title>Layer_12_Expert_1_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2166.5,-4505.78 1789.5,-4505.78 1789.5,-4437.78 2166.5,-4437.78 2166.5,-4505.78"/>
<text text-anchor="middle" x="1978" y="-4490.58" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1978" y="-4475.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="1978" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1978" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_1_EP0_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge966" class="edge">
<title>Layer_12_Expert_1_EP0_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2166.66,-4438.59C2169.46,-4438.31 2172.24,-4438.04 2175,-4437.78 3047.57,-4357.48 5751.75,-4353.33 6627.93,-4354.17"/>
<polygon fill="black" stroke="black" points="6628.15,-4357.67 6638.15,-4354.18 6628.15,-4350.67 6628.15,-4357.67"/>
</g>
<!-- Layer_12_Expert_2_EP0_TP0_PP3 -->
<g id="node618" class="node">
<title>Layer_12_Expert_2_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2561.5,-4505.78 2184.5,-4505.78 2184.5,-4437.78 2561.5,-4437.78 2561.5,-4505.78"/>
<text text-anchor="middle" x="2373" y="-4490.58" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2373" y="-4475.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="2373" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2373" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_2_EP0_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge968" class="edge">
<title>Layer_12_Expert_2_EP0_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2561.66,-4438.6C2564.46,-4438.31 2567.24,-4438.04 2570,-4437.78 3362.13,-4364.25 5801.43,-4355.5 6627.89,-4354.69"/>
<polygon fill="black" stroke="black" points="6628.14,-4358.19 6638.14,-4354.68 6628.14,-4351.19 6628.14,-4358.19"/>
</g>
<!-- Layer_12_Expert_2_EP0_TP1_PP3 -->
<g id="node619" class="node">
<title>Layer_12_Expert_2_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2956.5,-4505.78 2579.5,-4505.78 2579.5,-4437.78 2956.5,-4437.78 2956.5,-4505.78"/>
<text text-anchor="middle" x="2768" y="-4490.58" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2768" y="-4475.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="2768" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2768" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_2_EP0_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge970" class="edge">
<title>Layer_12_Expert_2_EP0_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2956.66,-4438.61C2959.46,-4438.32 2962.24,-4438.04 2965,-4437.78 3677.11,-4370.99 5854.07,-4357.88 6628.19,-4355.32"/>
<polygon fill="black" stroke="black" points="6628.37,-4358.82 6638.36,-4355.29 6628.35,-4351.82 6628.37,-4358.82"/>
</g>
<!-- Layer_12_Expert_3_EP0_TP0_PP3 -->
<g id="node620" class="node">
<title>Layer_12_Expert_3_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="3351.5,-4505.78 2974.5,-4505.78 2974.5,-4437.78 3351.5,-4437.78 3351.5,-4505.78"/>
<text text-anchor="middle" x="3163" y="-4490.58" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3163" y="-4475.58" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="3163" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3163" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_3_EP0_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge972" class="edge">
<title>Layer_12_Expert_3_EP0_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M3351.66,-4438.62C3354.46,-4438.32 3357.24,-4438.05 3360,-4437.78 3992.44,-4377.71 5909.24,-4360.5 6628.44,-4356.08"/>
<polygon fill="black" stroke="black" points="6628.7,-4359.58 6638.68,-4356.02 6628.66,-4352.58 6628.7,-4359.58"/>
</g>
<!-- Layer_12_Expert_3_EP0_TP1_PP3 -->
<g id="node621" class="node">
<title>Layer_12_Expert_3_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="3746.5,-4505.78 3369.5,-4505.78 3369.5,-4437.78 3746.5,-4437.78 3746.5,-4505.78"/>
<text text-anchor="middle" x="3558" y="-4490.58" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3558" y="-4475.58" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="3558" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3558" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_3_EP0_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge974" class="edge">
<title>Layer_12_Expert_3_EP0_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M3746.66,-4438.63C3749.46,-4438.33 3752.24,-4438.05 3755,-4437.78 4308.17,-4384.42 5967.38,-4363.43 6628.61,-4357.04"/>
<polygon fill="black" stroke="black" points="6628.79,-4360.54 6638.75,-4356.94 6628.72,-4353.54 6628.79,-4360.54"/>
</g>
<!-- Layer_12_Expert_4_EP1_TP0_PP3 -->
<g id="node622" class="node">
<title>Layer_12_Expert_4_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4141.5,-4505.78 3764.5,-4505.78 3764.5,-4437.78 4141.5,-4437.78 4141.5,-4505.78"/>
<text text-anchor="middle" x="3953" y="-4490.58" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3953" y="-4475.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="3953" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3953" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_4_EP1_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge976" class="edge">
<title>Layer_12_Expert_4_EP1_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4141.66,-4438.64C4144.46,-4438.34 4147.24,-4438.06 4150,-4437.78 4624.58,-4391.1 6030.15,-4366.75 6629.37,-4358.25"/>
<polygon fill="black" stroke="black" points="6629.49,-4361.75 6639.44,-4358.11 6629.4,-4354.75 6629.49,-4361.75"/>
</g>
<!-- Layer_12_Expert_4_EP1_TP1_PP3 -->
<g id="node623" class="node">
<title>Layer_12_Expert_4_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4536.5,-4505.78 4159.5,-4505.78 4159.5,-4437.78 4536.5,-4437.78 4536.5,-4505.78"/>
<text text-anchor="middle" x="4348" y="-4490.58" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4348" y="-4475.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="4348" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4348" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_4_EP1_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge978" class="edge">
<title>Layer_12_Expert_4_EP1_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4536.66,-4438.66C4539.46,-4438.36 4542.24,-4438.06 4545,-4437.78 4941.64,-4397.75 6097.61,-4370.6 6630.32,-4359.85"/>
<polygon fill="black" stroke="black" points="6630.53,-4363.35 6640.46,-4359.65 6630.39,-4356.35 6630.53,-4363.35"/>
</g>
<!-- Layer_12_Expert_5_EP1_TP0_PP3 -->
<g id="node624" class="node">
<title>Layer_12_Expert_5_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4931.5,-4505.78 4554.5,-4505.78 4554.5,-4437.78 4931.5,-4437.78 4931.5,-4505.78"/>
<text text-anchor="middle" x="4743" y="-4490.58" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4743" y="-4475.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="4743" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4743" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_5_EP1_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge980" class="edge">
<title>Layer_12_Expert_5_EP1_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4931.67,-4438.69C4934.46,-4438.38 4937.24,-4438.07 4940,-4437.78 5539.81,-4375.11 6247.31,-4359.37 6628.39,-4355.63"/>
<polygon fill="black" stroke="black" points="6628.49,-4359.13 6638.45,-4355.54 6628.42,-4352.13 6628.49,-4359.13"/>
</g>
<!-- Layer_12_Expert_5_EP1_TP1_PP3 -->
<g id="node625" class="node">
<title>Layer_12_Expert_5_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="5326.5,-4505.78 4949.5,-4505.78 4949.5,-4437.78 5326.5,-4437.78 5326.5,-4505.78"/>
<text text-anchor="middle" x="5138" y="-4490.58" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5138" y="-4475.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="5138" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5138" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_5_EP1_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge982" class="edge">
<title>Layer_12_Expert_5_EP1_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5326.67,-4438.73C5329.46,-4438.4 5332.24,-4438.09 5335,-4437.78 5787.26,-4388.1 6316.2,-4367.89 6630.21,-4359.84"/>
<polygon fill="black" stroke="black" points="6630.45,-4363.33 6640.36,-4359.58 6630.28,-4356.34 6630.45,-4363.33"/>
</g>
<!-- Layer_12_Expert_6_EP1_TP0_PP3 -->
<g id="node626" class="node">
<title>Layer_12_Expert_6_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="5721.5,-4505.78 5344.5,-4505.78 5344.5,-4437.78 5721.5,-4437.78 5721.5,-4505.78"/>
<text text-anchor="middle" x="5533" y="-4490.58" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5533" y="-4475.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="5533" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5533" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_6_EP1_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge984" class="edge">
<title>Layer_12_Expert_6_EP1_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5721.68,-4438.8C5724.47,-4438.45 5727.25,-4438.11 5730,-4437.78 6040.06,-4400.94 6398.23,-4378.49 6636.83,-4366.37"/>
<polygon fill="black" stroke="black" points="6637.23,-4369.86 6647.04,-4365.86 6636.87,-4362.86 6637.23,-4369.86"/>
</g>
<!-- Layer_12_Expert_6_EP1_TP1_PP3 -->
<g id="node627" class="node">
<title>Layer_12_Expert_6_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6116.5,-4505.78 5739.5,-4505.78 5739.5,-4437.78 6116.5,-4437.78 6116.5,-4505.78"/>
<text text-anchor="middle" x="5928" y="-4490.58" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5928" y="-4475.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="5928" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5928" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_6_EP1_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge986" class="edge">
<title>Layer_12_Expert_6_EP1_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6116.7,-4438.94C6119.48,-4438.55 6122.25,-4438.16 6125,-4437.78 6303.23,-4413.39 6505.22,-4392.04 6658.98,-4377.1"/>
<polygon fill="black" stroke="black" points="6659.42,-4380.58 6669.04,-4376.13 6658.75,-4373.61 6659.42,-4380.58"/>
</g>
<!-- Layer_12_Expert_7_EP1_TP0_PP3 -->
<g id="node628" class="node">
<title>Layer_12_Expert_7_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6511.5,-4505.78 6134.5,-4505.78 6134.5,-4437.78 6511.5,-4437.78 6511.5,-4505.78"/>
<text text-anchor="middle" x="6323" y="-4490.58" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6323" y="-4475.58" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="6323" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6323" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_7_EP1_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge988" class="edge">
<title>Layer_12_Expert_7_EP1_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6488.61,-4437.75C6560.48,-4423.42 6644.98,-4406.56 6719,-4391.8"/>
<polygon fill="black" stroke="black" points="6719.78,-4395.21 6728.91,-4389.82 6718.42,-4388.35 6719.78,-4395.21"/>
</g>
<!-- Layer_12_Expert_7_EP1_TP1_PP3 -->
<g id="node629" class="node">
<title>Layer_12_Expert_7_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6906.5,-4505.78 6529.5,-4505.78 6529.5,-4437.78 6906.5,-4437.78 6906.5,-4505.78"/>
<text text-anchor="middle" x="6718" y="-4490.58" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6718" y="-4475.58" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="6718" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6718" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_7_EP1_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge990" class="edge">
<title>Layer_12_Expert_7_EP1_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6771.34,-4437.67C6787.57,-4427.6 6805.8,-4416.28 6823.45,-4405.32"/>
<polygon fill="black" stroke="black" points="6825.41,-4408.23 6832.06,-4399.98 6821.72,-4402.28 6825.41,-4408.23"/>
</g>
<!-- Layer_12_Expert_8_EP2_TP0_PP3 -->
<g id="node630" class="node">
<title>Layer_12_Expert_8_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7301.5,-4505.78 6924.5,-4505.78 6924.5,-4437.78 7301.5,-4437.78 7301.5,-4505.78"/>
<text text-anchor="middle" x="7113" y="-4490.58" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7113" y="-4475.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="7113" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7113" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_8_EP2_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge992" class="edge">
<title>Layer_12_Expert_8_EP2_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7053.67,-4437.67C7035.16,-4427.34 7014.31,-4415.71 6994.22,-4404.49"/>
<polygon fill="black" stroke="black" points="6995.8,-4401.37 6985.36,-4399.55 6992.38,-4407.48 6995.8,-4401.37"/>
</g>
<!-- Layer_12_Expert_8_EP2_TP1_PP3 -->
<g id="node631" class="node">
<title>Layer_12_Expert_8_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7696.5,-4505.78 7319.5,-4505.78 7319.5,-4437.78 7696.5,-4437.78 7696.5,-4505.78"/>
<text text-anchor="middle" x="7508" y="-4490.58" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7508" y="-4475.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="7508" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7508" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_8_EP2_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge994" class="edge">
<title>Layer_12_Expert_8_EP2_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7336.41,-4437.75C7260.88,-4423.21 7171.89,-4406.08 7094.41,-4391.16"/>
<polygon fill="black" stroke="black" points="7095.02,-4387.72 7084.53,-4389.26 7093.69,-4394.59 7095.02,-4387.72"/>
</g>
<!-- Layer_12_Expert_9_EP2_TP0_PP3 -->
<g id="node632" class="node">
<title>Layer_12_Expert_9_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8091.5,-4505.78 7714.5,-4505.78 7714.5,-4437.78 8091.5,-4437.78 8091.5,-4505.78"/>
<text text-anchor="middle" x="7903" y="-4490.58" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7903" y="-4475.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="7903" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7903" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_9_EP2_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge996" class="edge">
<title>Layer_12_Expert_9_EP2_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7714.4,-4439.08C7711.24,-4438.64 7708.11,-4438.2 7705,-4437.78 7520.51,-4412.85 7311.2,-4391.36 7152.97,-4376.48"/>
<polygon fill="black" stroke="black" points="7152.9,-4372.96 7142.62,-4375.51 7152.25,-4379.93 7152.9,-4372.96"/>
</g>
<!-- Layer_12_Expert_9_EP2_TP1_PP3 -->
<g id="node633" class="node">
<title>Layer_12_Expert_9_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8486.5,-4505.78 8109.5,-4505.78 8109.5,-4437.78 8486.5,-4437.78 8486.5,-4505.78"/>
<text text-anchor="middle" x="8298" y="-4490.58" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="8298" y="-4475.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="8298" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8298" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_9_EP2_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge998" class="edge">
<title>Layer_12_Expert_9_EP2_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8109.42,-4438.93C8106.26,-4438.53 8103.11,-4438.15 8100,-4437.78 7782.84,-4400.42 7416.2,-4377.98 7173.56,-4366.01"/>
<polygon fill="black" stroke="black" points="7173.7,-4362.52 7163.54,-4365.52 7173.36,-4369.51 7173.7,-4362.52"/>
</g>
<!-- Layer_12_Expert_10_EP2_TP0_PP3 -->
<g id="node634" class="node">
<title>Layer_12_Expert_10_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8881.5,-4505.78 8504.5,-4505.78 8504.5,-4437.78 8881.5,-4437.78 8881.5,-4505.78"/>
<text text-anchor="middle" x="8693" y="-4490.58" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="8693" y="-4475.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="8693" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8693" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_10_EP2_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1000" class="edge">
<title>Layer_12_Expert_10_EP2_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8504.42,-4438.85C8501.26,-4438.48 8498.12,-4438.12 8495,-4437.78 8035.43,-4387.64 7497.71,-4367.56 7180.11,-4359.65"/>
<polygon fill="black" stroke="black" points="7179.92,-4356.15 7169.84,-4359.4 7179.75,-4363.15 7179.92,-4356.15"/>
</g>
<!-- Layer_12_Expert_10_EP2_TP1_PP3 -->
<g id="node635" class="node">
<title>Layer_12_Expert_10_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9276.5,-4505.78 8899.5,-4505.78 8899.5,-4437.78 9276.5,-4437.78 9276.5,-4505.78"/>
<text text-anchor="middle" x="9088" y="-4490.58" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="9088" y="-4475.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="9088" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9088" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_10_EP2_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1002" class="edge">
<title>Layer_12_Expert_10_EP2_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8899.43,-4438.81C8896.26,-4438.45 8893.12,-4438.11 8890,-4437.78 8282.57,-4374.7 7565.86,-4359.13 7181.59,-4355.53"/>
<polygon fill="black" stroke="black" points="7181.47,-4352.03 7171.44,-4355.44 7181.41,-4359.03 7181.47,-4352.03"/>
</g>
<!-- Layer_12_Expert_11_EP2_TP0_PP3 -->
<g id="node636" class="node">
<title>Layer_12_Expert_11_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9671.5,-4505.78 9294.5,-4505.78 9294.5,-4437.78 9671.5,-4437.78 9671.5,-4505.78"/>
<text text-anchor="middle" x="9483" y="-4490.58" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="9483" y="-4475.58" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="9483" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9483" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_11_EP2_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1004" class="edge">
<title>Layer_12_Expert_11_EP2_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9294.43,-4438.78C9291.27,-4438.43 9288.12,-4438.1 9285,-4437.78 8884.47,-4397.59 7716.24,-4370.47 7179.95,-4359.79"/>
<polygon fill="black" stroke="black" points="7179.81,-4356.29 7169.75,-4359.59 7179.67,-4363.29 7179.81,-4356.29"/>
</g>
<!-- Layer_12_Expert_11_EP2_TP1_PP3 -->
<g id="node637" class="node">
<title>Layer_12_Expert_11_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10066.5,-4505.78 9689.5,-4505.78 9689.5,-4437.78 10066.5,-4437.78 10066.5,-4505.78"/>
<text text-anchor="middle" x="9878" y="-4490.58" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="9878" y="-4475.58" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="9878" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9878" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_11_EP2_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1006" class="edge">
<title>Layer_12_Expert_11_EP2_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9689.43,-4438.76C9686.27,-4438.41 9683.12,-4438.09 9680,-4437.78 9201.43,-4390.96 7783.1,-4366.65 7180.65,-4358.21"/>
<polygon fill="black" stroke="black" points="7180.58,-4354.71 7170.53,-4358.07 7180.48,-4361.71 7180.58,-4354.71"/>
</g>
<!-- Layer_12_Expert_12_EP3_TP0_PP3 -->
<g id="node638" class="node">
<title>Layer_12_Expert_12_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10461.5,-4505.78 10084.5,-4505.78 10084.5,-4437.78 10461.5,-4437.78 10461.5,-4505.78"/>
<text text-anchor="middle" x="10273" y="-4490.58" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10273" y="-4475.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="10273" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10273" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_12_EP3_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1008" class="edge">
<title>Layer_12_Expert_12_EP3_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10084.44,-4438.74C10081.27,-4438.4 10078.12,-4438.08 10075,-4437.78 9517.78,-4384.31 7845.5,-4363.36 7181.31,-4357.01"/>
<polygon fill="black" stroke="black" points="7181.16,-4353.51 7171.13,-4356.91 7181.09,-4360.51 7181.16,-4353.51"/>
</g>
<!-- Layer_12_Expert_12_EP3_TP1_PP3 -->
<g id="node639" class="node">
<title>Layer_12_Expert_12_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10856.5,-4505.78 10479.5,-4505.78 10479.5,-4437.78 10856.5,-4437.78 10856.5,-4505.78"/>
<text text-anchor="middle" x="10668" y="-4490.58" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10668" y="-4475.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="10668" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10668" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_12_EP3_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1010" class="edge">
<title>Layer_12_Expert_12_EP3_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10479.44,-4438.73C10476.27,-4438.39 10473.12,-4438.08 10470,-4437.78 9833.51,-4377.63 7903.57,-4360.46 7181.55,-4356.07"/>
<polygon fill="black" stroke="black" points="7181.55,-4352.57 7171.53,-4356.01 7181.51,-4359.57 7181.55,-4352.57"/>
</g>
<!-- Layer_12_Expert_13_EP3_TP0_PP3 -->
<g id="node640" class="node">
<title>Layer_12_Expert_13_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11251.5,-4505.78 10874.5,-4505.78 10874.5,-4437.78 11251.5,-4437.78 11251.5,-4505.78"/>
<text text-anchor="middle" x="11063" y="-4490.58" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11063" y="-4475.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="11063" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11063" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_13_EP3_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1012" class="edge">
<title>Layer_12_Expert_13_EP3_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10874.44,-4438.72C10871.27,-4438.39 10868.12,-4438.08 10865,-4437.78 10148.82,-4370.94 7958.65,-4357.86 7181.82,-4355.31"/>
<polygon fill="black" stroke="black" points="7181.63,-4351.81 7171.62,-4355.28 7181.61,-4358.81 7181.63,-4351.81"/>
</g>
<!-- Layer_12_Expert_13_EP3_TP1_PP3 -->
<g id="node641" class="node">
<title>Layer_12_Expert_13_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11646.5,-4505.78 11269.5,-4505.78 11269.5,-4437.78 11646.5,-4437.78 11646.5,-4505.78"/>
<text text-anchor="middle" x="11458" y="-4490.58" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11458" y="-4475.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="11458" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11458" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_13_EP3_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1014" class="edge">
<title>Layer_12_Expert_13_EP3_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11269.44,-4438.71C11266.27,-4438.38 11263.12,-4438.07 11260,-4437.78 10463.72,-4364.23 8010.76,-4355.5 7181.92,-4354.69"/>
<polygon fill="black" stroke="black" points="7181.64,-4351.19 7171.64,-4354.68 7181.64,-4358.19 7181.64,-4351.19"/>
</g>
<!-- Layer_12_Expert_14_EP3_TP0_PP3 -->
<g id="node642" class="node">
<title>Layer_12_Expert_14_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12041.5,-4505.78 11664.5,-4505.78 11664.5,-4437.78 12041.5,-4437.78 12041.5,-4505.78"/>
<text text-anchor="middle" x="11853" y="-4490.58" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11853" y="-4475.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="11853" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11853" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_14_EP3_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1016" class="edge">
<title>Layer_12_Expert_14_EP3_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11664.44,-4438.7C11661.27,-4438.38 11658.12,-4438.07 11655,-4437.78 10778.32,-4357.5 8060.74,-4353.34 7182.09,-4354.17"/>
<polygon fill="black" stroke="black" points="7181.83,-4350.67 7171.84,-4354.18 7181.84,-4357.67 7181.83,-4350.67"/>
</g>
<!-- Layer_12_Expert_14_EP3_TP1_PP3 -->
<g id="node643" class="node">
<title>Layer_12_Expert_14_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12436.5,-4505.78 12059.5,-4505.78 12059.5,-4437.78 12436.5,-4437.78 12436.5,-4505.78"/>
<text text-anchor="middle" x="12248" y="-4490.58" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12248" y="-4475.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="12248" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12248" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_14_EP3_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1018" class="edge">
<title>Layer_12_Expert_14_EP3_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12059.44,-4438.7C12056.27,-4438.37 12053.12,-4438.07 12050,-4437.78 11565.47,-4393.74 8179.88,-4364.49 7181.49,-4356.75"/>
<polygon fill="black" stroke="black" points="7181.33,-4353.25 7171.3,-4356.67 7181.27,-4360.25 7181.33,-4353.25"/>
</g>
<!-- Layer_12_Expert_15_EP3_TP0_PP3 -->
<g id="node644" class="node">
<title>Layer_12_Expert_15_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12831.5,-4505.78 12454.5,-4505.78 12454.5,-4437.78 12831.5,-4437.78 12831.5,-4505.78"/>
<text text-anchor="middle" x="12643" y="-4490.58" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12643" y="-4475.58" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="12643" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12643" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_15_EP3_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1020" class="edge">
<title>Layer_12_Expert_15_EP3_TP0_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12454.44,-4438.69C12451.27,-4438.37 12448.12,-4438.07 12445,-4437.78 11919.83,-4390.35 8229.82,-4363.22 7181.9,-4356.41"/>
<polygon fill="black" stroke="black" points="7181.62,-4352.91 7171.6,-4356.34 7181.57,-4359.91 7181.62,-4352.91"/>
</g>
<!-- Layer_12_Expert_15_EP3_TP1_PP3 -->
<g id="node645" class="node">
<title>Layer_12_Expert_15_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="13226.5,-4505.78 12849.5,-4505.78 12849.5,-4437.78 13226.5,-4437.78 13226.5,-4505.78"/>
<text text-anchor="middle" x="13038" y="-4490.58" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="13038" y="-4475.58" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="13038" y="-4460.58" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13038" y="-4445.58" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_Expert_15_EP3_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3 -->
<g id="edge1022" class="edge">
<title>Layer_12_Expert_15_EP3_TP1_PP3&#45;&gt;Layer_12_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12849.44,-4438.69C12846.27,-4438.37 12843.12,-4438.06 12840,-4437.78 12274.02,-4386.95 8277.13,-4362.03 7181.92,-4356.11"/>
<polygon fill="black" stroke="black" points="7181.56,-4352.61 7171.55,-4356.06 7181.53,-4359.61 7181.56,-4352.61"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_0_EP0_TP0_PP3 -->
<g id="edge959" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_0_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6846.45,-4587.65C5750.99,-4582.31 1623.95,-4558.91 992.03,-4505.89"/>
<polygon fill="black" stroke="black" points="991.92,-4502.37 981.66,-4504.99 991.32,-4509.34 991.92,-4502.37"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_0_EP0_TP1_PP3 -->
<g id="edge961" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_0_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6846.4,-4587.38C5796.52,-4581.19 1976.45,-4555.52 1386.75,-4505.87"/>
<polygon fill="black" stroke="black" points="1386.92,-4502.37 1376.66,-4504.99 1386.31,-4509.34 1386.92,-4502.37"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_1_EP0_TP0_PP3 -->
<g id="edge963" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_1_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6846.53,-4587.07C5844.29,-4579.99 2330.53,-4552.16 1781.81,-4505.87"/>
<polygon fill="black" stroke="black" points="1781.92,-4502.37 1771.66,-4504.98 1781.31,-4509.34 1781.92,-4502.37"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_1_EP0_TP1_PP3 -->
<g id="edge965" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_1_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6846.77,-4586.71C5894.01,-4578.69 2684.17,-4548.8 2176.75,-4505.87"/>
<polygon fill="black" stroke="black" points="2176.93,-4502.37 2166.66,-4504.98 2176.31,-4509.34 2176.93,-4502.37"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_2_EP0_TP0_PP3 -->
<g id="edge967" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_2_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6846.43,-4589.16C6007.69,-4589.28 3428.17,-4583.25 2571.65,-4505.88"/>
<polygon fill="black" stroke="black" points="2571.93,-4502.4 2561.66,-4504.97 2571.3,-4509.37 2571.93,-4502.4"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_2_EP0_TP1_PP3 -->
<g id="edge969" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_2_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6846.51,-4588.62C6057.88,-4587.07 3742.98,-4576.53 2966.85,-4505.9"/>
<polygon fill="black" stroke="black" points="2966.94,-4502.4 2956.66,-4504.96 2966.29,-4509.37 2966.94,-4502.4"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_3_EP0_TP0_PP3 -->
<g id="edge971" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_3_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6846.52,-4587.95C6110.31,-4584.64 4057.61,-4569.83 3361.8,-4505.9"/>
<polygon fill="black" stroke="black" points="3361.94,-4502.4 3351.66,-4504.96 3361.29,-4509.37 3361.94,-4502.4"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_3_EP0_TP1_PP3 -->
<g id="edge973" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_3_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6846.55,-4587.14C6165.69,-4581.94 4373.03,-4563.17 3756.98,-4505.92"/>
<polygon fill="black" stroke="black" points="3756.94,-4502.4 3746.66,-4504.95 3756.29,-4509.37 3756.94,-4502.4"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_4_EP1_TP0_PP3 -->
<g id="edge975" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_4_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6847.1,-4586.11C6225.17,-4578.91 4688.35,-4556.54 4151.82,-4505.91"/>
<polygon fill="black" stroke="black" points="4151.95,-4502.4 4141.66,-4504.93 4151.28,-4509.37 4151.95,-4502.4"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_4_EP1_TP1_PP3 -->
<g id="edge977" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_4_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6847.88,-4584.79C6288.94,-4575.45 5004.2,-4549.95 4546.65,-4505.89"/>
<polygon fill="black" stroke="black" points="4546.96,-4502.41 4536.66,-4504.92 4546.27,-4509.37 4546.96,-4502.41"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_5_EP1_TP0_PP3 -->
<g id="edge979" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_5_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6846.29,-4589.61C6437.7,-4588.3 5632.38,-4576.03 4941.82,-4505.93"/>
<polygon fill="black" stroke="black" points="4941.97,-4502.43 4931.66,-4504.89 4941.26,-4509.39 4941.97,-4502.43"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_5_EP1_TP1_PP3 -->
<g id="edge981" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_5_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6846.79,-4586.31C6500.58,-4580.75 5877.13,-4563.05 5336.62,-4505.92"/>
<polygon fill="black" stroke="black" points="5336.98,-4502.44 5326.67,-4504.86 5336.24,-4509.4 5336.98,-4502.44"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_6_EP1_TP0_PP3 -->
<g id="edge983" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_6_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6850.37,-4581.37C6574.03,-4571.57 6126.41,-4550.26 5731.86,-4505.96"/>
<polygon fill="black" stroke="black" points="5732,-4502.45 5721.67,-4504.81 5731.22,-4509.41 5732,-4502.45"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_6_EP1_TP1_PP3 -->
<g id="edge985" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_6_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6862.17,-4573.48C6664.75,-4560.02 6382.55,-4537.78 6126.92,-4506"/>
<polygon fill="black" stroke="black" points="6127.04,-4502.48 6116.69,-4504.72 6126.17,-4509.43 6127.04,-4502.48"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_7_EP1_TP0_PP3 -->
<g id="edge987" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_7_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6901.13,-4560.58C6790.8,-4545.51 6653.43,-4526.21 6521.98,-4506.08"/>
<polygon fill="black" stroke="black" points="6522.13,-4502.56 6511.71,-4504.5 6521.07,-4509.48 6522.13,-4502.56"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_7_EP1_TP1_PP3 -->
<g id="edge989" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_7_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6975.96,-4548.59C6931.73,-4535.6 6883.02,-4521.28 6839.96,-4508.63"/>
<polygon fill="black" stroke="black" points="6840.87,-4505.25 6830.29,-4505.78 6838.9,-4511.96 6840.87,-4505.25"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_8_EP2_TP0_PP3 -->
<g id="edge991" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_8_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M7113,-4541.65C7113,-4533.27 7113,-4524.57 7113,-4516.29"/>
<polygon fill="black" stroke="black" points="7116.5,-4516.09 7113,-4506.09 7109.5,-4516.09 7116.5,-4516.09"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_8_EP2_TP1_PP3 -->
<g id="edge993" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_8_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M7250.04,-4548.59C7294.27,-4535.6 7342.98,-4521.28 7386.04,-4508.63"/>
<polygon fill="black" stroke="black" points="7387.1,-4511.96 7395.71,-4505.78 7385.13,-4505.25 7387.1,-4511.96"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_9_EP2_TP0_PP3 -->
<g id="edge995" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_9_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M7324.51,-4560.53C7434.76,-4545.42 7572.06,-4526.1 7704.45,-4505.86"/>
<polygon fill="black" stroke="black" points="7705.02,-4509.31 7714.37,-4504.34 7703.96,-4502.39 7705.02,-4509.31"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_9_EP2_TP1_PP3 -->
<g id="edge997" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_9_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M7363.57,-4573.41C7560.78,-4559.91 7842.7,-4537.65 8099.14,-4505.86"/>
<polygon fill="black" stroke="black" points="8099.92,-4509.29 8109.41,-4504.58 8099.05,-4502.34 8099.92,-4509.29"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_10_EP2_TP0_PP3 -->
<g id="edge999" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_10_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M7375.43,-4581.3C7651.57,-4571.44 8098.86,-4550.07 8494.21,-4505.83"/>
<polygon fill="black" stroke="black" points="8494.87,-4509.28 8504.42,-4504.68 8494.09,-4502.32 8494.87,-4509.28"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_10_EP2_TP1_PP3 -->
<g id="edge1001" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_10_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M7379.06,-4586.24C7725.06,-4580.59 8348.15,-4562.8 8889.46,-4505.79"/>
<polygon fill="black" stroke="black" points="8889.85,-4509.27 8899.43,-4504.74 8889.11,-4502.31 8889.85,-4509.27"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_11_EP2_TP0_PP3 -->
<g id="edge1003" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_11_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M7379.58,-4589.54C7787.97,-4588.13 8592.91,-4575.72 9284.26,-4505.81"/>
<polygon fill="black" stroke="black" points="9284.84,-4509.27 9294.43,-4504.78 9284.13,-4502.3 9284.84,-4509.27"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_11_EP2_TP1_PP3 -->
<g id="edge1005" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_11_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M7378.28,-4584.75C7937.14,-4575.36 9221.04,-4549.75 9679.42,-4505.78"/>
<polygon fill="black" stroke="black" points="9679.82,-4509.26 9689.43,-4504.8 9679.14,-4502.29 9679.82,-4509.26"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_12_EP3_TP0_PP3 -->
<g id="edge1007" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_12_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M7378.8,-4586.08C8000.52,-4578.82 9536.81,-4556.32 10074.26,-4505.79"/>
<polygon fill="black" stroke="black" points="10074.81,-4509.25 10084.44,-4504.82 10074.15,-4502.29 10074.81,-4509.25"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_12_EP3_TP1_PP3 -->
<g id="edge1009" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_12_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M7379.37,-4587.11C8060.02,-4581.84 9852.13,-4562.91 10469.1,-4505.81"/>
<polygon fill="black" stroke="black" points="10469.81,-4509.25 10479.44,-4504.83 10469.15,-4502.28 10469.81,-4509.25"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_13_EP3_TP0_PP3 -->
<g id="edge1011" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_13_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M7379.41,-4587.92C8115.41,-4584.53 10167.55,-4569.54 10864.28,-4505.79"/>
<polygon fill="black" stroke="black" points="10864.8,-4509.25 10874.44,-4504.85 10864.16,-4502.28 10864.8,-4509.25"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_13_EP3_TP1_PP3 -->
<g id="edge1013" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_13_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M7379.78,-4588.58C8168.54,-4586.95 10482.3,-4576.19 11259.24,-4505.79"/>
<polygon fill="black" stroke="black" points="11259.8,-4509.25 11269.44,-4504.85 11259.16,-4502.28 11259.8,-4509.25"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_14_EP3_TP0_PP3 -->
<g id="edge1015" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_14_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M7379.88,-4589.13C8218.81,-4589.16 10797.12,-4582.88 11654.43,-4505.77"/>
<polygon fill="black" stroke="black" points="11654.8,-4509.25 11664.44,-4504.86 11654.16,-4502.28 11654.8,-4509.25"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_14_EP3_TP1_PP3 -->
<g id="edge1017" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_14_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M7379.18,-4586.7C8331.74,-4578.63 11540.92,-4548.61 12049.33,-4505.76"/>
<polygon fill="black" stroke="black" points="12049.78,-4509.23 12059.44,-4504.87 12049.17,-4502.26 12049.78,-4509.23"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_15_EP3_TP0_PP3 -->
<g id="edge1019" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_15_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M7379.42,-4587.06C8381.47,-4579.93 11894.55,-4551.94 12444.27,-4505.76"/>
<polygon fill="black" stroke="black" points="12444.78,-4509.23 12454.44,-4504.87 12444.17,-4502.26 12444.78,-4509.23"/>
</g>
<!-- Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_15_EP3_TP1_PP3 -->
<g id="edge1021" class="edge">
<title>Layer_12_A2A_Dispatch_PP3&#45;&gt;Layer_12_Expert_15_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M7379.55,-4587.36C8429.25,-4581.13 12248.63,-4555.29 12839.33,-4505.76"/>
<polygon fill="black" stroke="black" points="12839.78,-4509.23 12849.44,-4504.88 12839.18,-4502.26 12839.78,-4509.23"/>
</g>
<!-- Layer_12_MLP_Out_TP0_PP3 -->
<g id="node648" class="node">
<title>Layer_12_MLP_Out_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="7044.5,-4269.62 6667.5,-4269.62 6667.5,-4201.62 7044.5,-4201.62 7044.5,-4269.62"/>
<text text-anchor="middle" x="6856" y="-4254.42" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="6856" y="-4239.42" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6856" y="-4224.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6856" y="-4209.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_A2A_Combine_PP3&#45;&gt;Layer_12_MLP_Out_TP0_PP3 -->
<g id="edge1023" class="edge">
<title>Layer_12_A2A_Combine_PP3&#45;&gt;Layer_12_MLP_Out_TP0_PP3</title>
<path fill="none" stroke="black" d="M6885.07,-4305.49C6881.41,-4296.82 6877.61,-4287.82 6874.02,-4279.3"/>
<polygon fill="black" stroke="black" points="6877.17,-4277.77 6870.06,-4269.92 6870.72,-4280.5 6877.17,-4277.77"/>
</g>
<!-- Layer_12_MLP_Out_TP1_PP3 -->
<g id="node649" class="node">
<title>Layer_12_MLP_Out_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="7439.5,-4269.62 7062.5,-4269.62 7062.5,-4201.62 7439.5,-4201.62 7439.5,-4269.62"/>
<text text-anchor="middle" x="7251" y="-4254.42" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="7251" y="-4239.42" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="7251" y="-4224.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7251" y="-4209.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_12_A2A_Combine_PP3&#45;&gt;Layer_12_MLP_Out_TP1_PP3 -->
<g id="edge1025" class="edge">
<title>Layer_12_A2A_Combine_PP3&#45;&gt;Layer_12_MLP_Out_TP1_PP3</title>
<path fill="none" stroke="black" d="M7028.94,-4311.12C7066.23,-4298.61 7106.84,-4284.99 7143.01,-4272.85"/>
<polygon fill="black" stroke="black" points="7144.22,-4276.13 7152.59,-4269.63 7142,-4269.5 7144.22,-4276.13"/>
</g>
<!-- Layer_12_MLP_AllReduce_PP3 -->
<g id="node650" class="node">
<title>Layer_12_MLP_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6949" cy="-4117.53" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6949" y="-4136.33" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="6949" y="-4121.33" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6949" y="-4106.33" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6949" y="-4091.33" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_12_MLP_Out_TP0_PP3&#45;&gt;Layer_12_MLP_AllReduce_PP3 -->
<g id="edge1024" class="edge">
<title>Layer_12_MLP_Out_TP0_PP3&#45;&gt;Layer_12_MLP_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6882.65,-4201.35C6889.69,-4192.56 6897.49,-4182.83 6905.18,-4173.23"/>
<polygon fill="black" stroke="black" points="6908.08,-4175.2 6911.6,-4165.21 6902.62,-4170.83 6908.08,-4175.2"/>
</g>
<!-- Layer_12_MLP_Out_TP1_PP3&#45;&gt;Layer_12_MLP_AllReduce_PP3 -->
<g id="edge1026" class="edge">
<title>Layer_12_MLP_Out_TP1_PP3&#45;&gt;Layer_12_MLP_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M7164.86,-4201.51C7135.27,-4190.13 7101.57,-4177.18 7069.74,-4164.95"/>
<polygon fill="black" stroke="black" points="7070.97,-4161.67 7060.38,-4161.35 7068.46,-4168.2 7070.97,-4161.67"/>
</g>
<!-- Layer_12_LayerNorm_PP3 -->
<g id="node651" class="node">
<title>Layer_12_LayerNorm_PP3</title>
<polygon fill="lightgreen" stroke="black" points="7137.5,-4033.45 6760.5,-4033.45 6760.5,-3965.45 7137.5,-3965.45 7137.5,-4033.45"/>
<text text-anchor="middle" x="6949" y="-4018.25" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6949" y="-4003.25" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6949" y="-3988.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6949" y="-3973.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_12_MLP_AllReduce_PP3&#45;&gt;Layer_12_LayerNorm_PP3 -->
<g id="edge1027" class="edge">
<title>Layer_12_MLP_AllReduce_PP3&#45;&gt;Layer_12_LayerNorm_PP3</title>
<path fill="none" stroke="black" d="M6949,-4069.32C6949,-4060.93 6949,-4052.23 6949,-4043.96"/>
<polygon fill="black" stroke="black" points="6952.5,-4043.75 6949,-4033.75 6945.5,-4043.75 6952.5,-4043.75"/>
</g>
<!-- Layer_13_QKV_TP0_PP3 -->
<g id="node652" class="node">
<title>Layer_13_QKV_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="7139.5,-3929.45 6758.5,-3929.45 6758.5,-3861.45 7139.5,-3861.45 7139.5,-3929.45"/>
<text text-anchor="middle" x="6949" y="-3914.25" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6949" y="-3899.25" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6949" y="-3884.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6949" y="-3869.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_12_LayerNorm_PP3&#45;&gt;Layer_13_QKV_TP0_PP3 -->
<g id="edge1028" class="edge">
<title>Layer_12_LayerNorm_PP3&#45;&gt;Layer_13_QKV_TP0_PP3</title>
<path fill="none" stroke="black" d="M6949,-3965.33C6949,-3957.23 6949,-3948.43 6949,-3939.92"/>
<polygon fill="black" stroke="black" points="6952.5,-3939.75 6949,-3929.75 6945.5,-3939.75 6952.5,-3939.75"/>
</g>
<!-- Layer_13_QKV_AllReduce_PP3 -->
<g id="node654" class="node">
<title>Layer_13_QKV_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6644" cy="-3777.37" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="6644" y="-3796.17" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="6644" y="-3781.17" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6644" y="-3766.17" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6644" y="-3751.17" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_13_QKV_TP0_PP3&#45;&gt;Layer_13_QKV_AllReduce_PP3 -->
<g id="edge1029" class="edge">
<title>Layer_13_QKV_TP0_PP3&#45;&gt;Layer_13_QKV_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6862.01,-3861.34C6832.2,-3850 6798.27,-3837.08 6766.2,-3824.88"/>
<polygon fill="black" stroke="black" points="6767.36,-3821.57 6756.77,-3821.29 6764.87,-3828.12 6767.36,-3821.57"/>
</g>
<!-- Layer_13_QKV_TP1_PP3 -->
<g id="node653" class="node">
<title>Layer_13_QKV_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="6740.5,-3929.45 6359.5,-3929.45 6359.5,-3861.45 6740.5,-3861.45 6740.5,-3929.45"/>
<text text-anchor="middle" x="6550" y="-3914.25" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6550" y="-3899.25" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6550" y="-3884.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6550" y="-3869.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_13_QKV_TP1_PP3&#45;&gt;Layer_13_QKV_AllReduce_PP3 -->
<g id="edge1033" class="edge">
<title>Layer_13_QKV_TP1_PP3&#45;&gt;Layer_13_QKV_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6576.94,-3861.19C6584.06,-3852.39 6591.93,-3842.67 6599.71,-3833.06"/>
<polygon fill="black" stroke="black" points="6602.63,-3835.02 6606.2,-3825.05 6597.19,-3830.61 6602.63,-3835.02"/>
</g>
<!-- Layer_13_Attention_TP0_PP3 -->
<g id="node655" class="node">
<title>Layer_13_Attention_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6634.5,-3693.28 6253.5,-3693.28 6253.5,-3625.28 6634.5,-3625.28 6634.5,-3693.28"/>
<text text-anchor="middle" x="6444" y="-3678.08" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6444" y="-3663.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6444" y="-3648.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6444" y="-3633.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_13_QKV_AllReduce_PP3&#45;&gt;Layer_13_Attention_TP0_PP3 -->
<g id="edge1030" class="edge">
<title>Layer_13_QKV_AllReduce_PP3&#45;&gt;Layer_13_Attention_TP0_PP3</title>
<path fill="none" stroke="black" d="M6566.1,-3731.15C6547.44,-3720.32 6527.7,-3708.86 6509.65,-3698.39"/>
<polygon fill="black" stroke="black" points="6511.35,-3695.33 6500.94,-3693.33 6507.83,-3701.38 6511.35,-3695.33"/>
</g>
<!-- Layer_13_Attention_TP1_PP3 -->
<g id="node656" class="node">
<title>Layer_13_Attention_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="7033.5,-3693.28 6652.5,-3693.28 6652.5,-3625.28 7033.5,-3625.28 7033.5,-3693.28"/>
<text text-anchor="middle" x="6843" y="-3678.08" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6843" y="-3663.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6843" y="-3648.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6843" y="-3633.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_13_QKV_AllReduce_PP3&#45;&gt;Layer_13_Attention_TP1_PP3 -->
<g id="edge1034" class="edge">
<title>Layer_13_QKV_AllReduce_PP3&#45;&gt;Layer_13_Attention_TP1_PP3</title>
<path fill="none" stroke="black" d="M6721.51,-3731.15C6740.08,-3720.32 6759.72,-3708.86 6777.68,-3698.39"/>
<polygon fill="black" stroke="black" points="6779.47,-3701.4 6786.34,-3693.33 6775.94,-3695.35 6779.47,-3701.4"/>
</g>
<!-- Layer_13_AttnOut_TP0_PP3 -->
<g id="node657" class="node">
<title>Layer_13_AttnOut_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6633.5,-3589.28 6256.5,-3589.28 6256.5,-3521.28 6633.5,-3521.28 6633.5,-3589.28"/>
<text text-anchor="middle" x="6445" y="-3574.08" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="6445" y="-3559.08" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6445" y="-3544.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6445" y="-3529.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Attention_TP0_PP3&#45;&gt;Layer_13_AttnOut_TP0_PP3 -->
<g id="edge1031" class="edge">
<title>Layer_13_Attention_TP0_PP3&#45;&gt;Layer_13_AttnOut_TP0_PP3</title>
<path fill="none" stroke="black" d="M6444.32,-3625.17C6444.4,-3617.06 6444.49,-3608.27 6444.57,-3599.76"/>
<polygon fill="black" stroke="black" points="6448.08,-3599.62 6444.67,-3589.58 6441.08,-3599.55 6448.08,-3599.62"/>
</g>
<!-- Layer_13_AttnOut_TP1_PP3 -->
<g id="node658" class="node">
<title>Layer_13_AttnOut_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="7029.5,-3589.28 6652.5,-3589.28 6652.5,-3521.28 7029.5,-3521.28 7029.5,-3589.28"/>
<text text-anchor="middle" x="6841" y="-3574.08" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="6841" y="-3559.08" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6841" y="-3544.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6841" y="-3529.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Attention_TP1_PP3&#45;&gt;Layer_13_AttnOut_TP1_PP3 -->
<g id="edge1035" class="edge">
<title>Layer_13_Attention_TP1_PP3&#45;&gt;Layer_13_AttnOut_TP1_PP3</title>
<path fill="none" stroke="black" d="M6842.35,-3625.17C6842.19,-3617.06 6842.02,-3608.27 6841.85,-3599.76"/>
<polygon fill="black" stroke="black" points="6845.35,-3599.51 6841.65,-3589.58 6838.35,-3599.65 6845.35,-3599.51"/>
</g>
<!-- Layer_13_AttnOut_AllReduce_PP3 -->
<g id="node659" class="node">
<title>Layer_13_AttnOut_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6743" cy="-3437.2" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6743" y="-3456" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="6743" y="-3441" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6743" y="-3426" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6743" y="-3411" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_13_AttnOut_TP0_PP3&#45;&gt;Layer_13_AttnOut_AllReduce_PP3 -->
<g id="edge1032" class="edge">
<title>Layer_13_AttnOut_TP0_PP3&#45;&gt;Layer_13_AttnOut_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6530,-3521.18C6559.07,-3509.85 6592.16,-3496.96 6623.45,-3484.77"/>
<polygon fill="black" stroke="black" points="6625.05,-3487.9 6633.1,-3481.01 6622.51,-3481.38 6625.05,-3487.9"/>
</g>
<!-- Layer_13_AttnOut_TP1_PP3&#45;&gt;Layer_13_AttnOut_AllReduce_PP3 -->
<g id="edge1036" class="edge">
<title>Layer_13_AttnOut_TP1_PP3&#45;&gt;Layer_13_AttnOut_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6812.92,-3521.02C6805.42,-3512.14 6797.12,-3502.3 6788.93,-3492.61"/>
<polygon fill="black" stroke="black" points="6791.53,-3490.26 6782.41,-3484.88 6786.18,-3494.78 6791.53,-3490.26"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3 -->
<g id="node696" class="node">
<title>Layer_13_A2A_Dispatch_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6743" cy="-3305.03" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6743" y="-3323.83" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="6743" y="-3308.83" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6743" y="-3293.83" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6743" y="-3278.83" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_13_AttnOut_AllReduce_PP3&#45;&gt;Layer_13_A2A_Dispatch_PP3 -->
<g id="edge1037" class="edge">
<title>Layer_13_AttnOut_AllReduce_PP3&#45;&gt;Layer_13_A2A_Dispatch_PP3</title>
<path fill="none" stroke="black" d="M6743,-3388.84C6743,-3380.57 6743,-3371.89 6743,-3363.39"/>
<polygon fill="black" stroke="black" points="6746.5,-3363.14 6743,-3353.14 6739.5,-3363.14 6746.5,-3363.14"/>
</g>
<!-- Layer_13_Gate_EP0_PP3 -->
<g id="node660" class="node">
<title>Layer_13_Gate_EP0_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9321.4,-5282.28 8717.86,-5282.28 8562.6,-5146.28 9166.14,-5146.28 9321.4,-5282.28"/>
<text text-anchor="middle" x="8942" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="8942" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="8942" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8942" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_13_Gate_EP1_PP3 -->
<g id="node661" class="node">
<title>Layer_13_Gate_EP1_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8544.4,-5282.28 7940.86,-5282.28 7785.6,-5146.28 8389.14,-5146.28 8544.4,-5282.28"/>
<text text-anchor="middle" x="8165" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="8165" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="8165" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8165" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_13_Gate_EP2_PP3 -->
<g id="node662" class="node">
<title>Layer_13_Gate_EP2_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7767.4,-5282.28 7163.86,-5282.28 7008.6,-5146.28 7612.14,-5146.28 7767.4,-5282.28"/>
<text text-anchor="middle" x="7388" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="7388" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="7388" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7388" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_13_Gate_EP3_PP3 -->
<g id="node663" class="node">
<title>Layer_13_Gate_EP3_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6990.4,-5282.28 6386.86,-5282.28 6231.6,-5146.28 6835.14,-5146.28 6990.4,-5282.28"/>
<text text-anchor="middle" x="6611" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="6611" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="6611" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6611" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_13_Expert_0_EP0_TP0_PP3 -->
<g id="node664" class="node">
<title>Layer_13_Expert_0_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="981.5,-3220.95 604.5,-3220.95 604.5,-3152.95 981.5,-3152.95 981.5,-3220.95"/>
<text text-anchor="middle" x="793" y="-3205.75" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="793" y="-3190.75" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="793" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="793" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_A2A_Combine_PP3 -->
<g id="node697" class="node">
<title>Layer_13_A2A_Combine_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6899" cy="-3068.87" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6899" y="-3087.67" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="6899" y="-3072.67" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6899" y="-3057.67" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6899" y="-3042.67" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_13_Expert_0_EP0_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1039" class="edge">
<title>Layer_13_Expert_0_EP0_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M981.66,-3153.75C984.45,-3153.47 987.24,-3153.2 990,-3152.95 1553.32,-3102.11 5530.63,-3077.21 6622.37,-3071.28"/>
<polygon fill="black" stroke="black" points="6622.73,-3074.78 6632.71,-3071.23 6622.69,-3067.78 6622.73,-3074.78"/>
</g>
<!-- Layer_13_Expert_0_EP0_TP1_PP3 -->
<g id="node665" class="node">
<title>Layer_13_Expert_0_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="1376.5,-3220.95 999.5,-3220.95 999.5,-3152.95 1376.5,-3152.95 1376.5,-3220.95"/>
<text text-anchor="middle" x="1188" y="-3205.75" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1188" y="-3190.75" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="1188" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1188" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_0_EP0_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1041" class="edge">
<title>Layer_13_Expert_0_EP0_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M1376.66,-3153.75C1379.45,-3153.47 1382.24,-3153.2 1385,-3152.95 1907.54,-3105.52 5578.31,-3078.4 6622.5,-3071.58"/>
<polygon fill="black" stroke="black" points="6622.8,-3075.08 6632.78,-3071.52 6622.75,-3068.08 6622.8,-3075.08"/>
</g>
<!-- Layer_13_Expert_1_EP0_TP0_PP3 -->
<g id="node666" class="node">
<title>Layer_13_Expert_1_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="1771.5,-3220.95 1394.5,-3220.95 1394.5,-3152.95 1771.5,-3152.95 1771.5,-3220.95"/>
<text text-anchor="middle" x="1583" y="-3205.75" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1583" y="-3190.75" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="1583" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1583" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_1_EP0_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1043" class="edge">
<title>Layer_13_Expert_1_EP0_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M1771.66,-3153.76C1774.45,-3153.47 1777.24,-3153.2 1780,-3152.95 2261.86,-3108.93 5627.67,-3079.69 6622.63,-3071.93"/>
<polygon fill="black" stroke="black" points="6622.81,-3075.43 6632.78,-3071.85 6622.75,-3068.43 6622.81,-3075.43"/>
</g>
<!-- Layer_13_Expert_1_EP0_TP1_PP3 -->
<g id="node667" class="node">
<title>Layer_13_Expert_1_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2166.5,-3220.95 1789.5,-3220.95 1789.5,-3152.95 2166.5,-3152.95 2166.5,-3220.95"/>
<text text-anchor="middle" x="1978" y="-3205.75" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1978" y="-3190.75" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="1978" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1978" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_1_EP0_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1045" class="edge">
<title>Layer_13_Expert_1_EP0_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2166.66,-3153.76C2169.46,-3153.48 2172.24,-3153.21 2175,-3152.95 3046.34,-3072.76 5746.42,-3068.52 6621.9,-3069.34"/>
<polygon fill="black" stroke="black" points="6622.11,-3072.84 6632.11,-3069.35 6622.11,-3065.84 6622.11,-3072.84"/>
</g>
<!-- Layer_13_Expert_2_EP0_TP0_PP3 -->
<g id="node668" class="node">
<title>Layer_13_Expert_2_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2561.5,-3220.95 2184.5,-3220.95 2184.5,-3152.95 2561.5,-3152.95 2561.5,-3220.95"/>
<text text-anchor="middle" x="2373" y="-3205.75" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2373" y="-3190.75" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="2373" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2373" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_2_EP0_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1047" class="edge">
<title>Layer_13_Expert_2_EP0_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2561.66,-3153.77C2564.46,-3153.48 2567.24,-3153.21 2570,-3152.95 3360.91,-3079.52 5796.24,-3070.71 6621.91,-3069.87"/>
<polygon fill="black" stroke="black" points="6622.15,-3073.37 6632.15,-3069.86 6622.15,-3066.37 6622.15,-3073.37"/>
</g>
<!-- Layer_13_Expert_2_EP0_TP1_PP3 -->
<g id="node669" class="node">
<title>Layer_13_Expert_2_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2956.5,-3220.95 2579.5,-3220.95 2579.5,-3152.95 2956.5,-3152.95 2956.5,-3220.95"/>
<text text-anchor="middle" x="2768" y="-3205.75" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2768" y="-3190.75" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="2768" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2768" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_2_EP0_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1049" class="edge">
<title>Layer_13_Expert_2_EP0_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2956.66,-3153.78C2959.46,-3153.49 2962.24,-3153.21 2965,-3152.95 3675.92,-3086.26 5849.03,-3073.08 6622.27,-3070.5"/>
<polygon fill="black" stroke="black" points="6622.44,-3074 6632.42,-3070.46 6622.41,-3067 6622.44,-3074"/>
</g>
<!-- Layer_13_Expert_3_EP0_TP0_PP3 -->
<g id="node670" class="node">
<title>Layer_13_Expert_3_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="3351.5,-3220.95 2974.5,-3220.95 2974.5,-3152.95 3351.5,-3152.95 3351.5,-3220.95"/>
<text text-anchor="middle" x="3163" y="-3205.75" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3163" y="-3190.75" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="3163" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3163" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_3_EP0_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1051" class="edge">
<title>Layer_13_Expert_3_EP0_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M3351.66,-3153.78C3354.46,-3153.49 3357.24,-3153.21 3360,-3152.95 3991.17,-3092.99 5903.78,-3075.71 6622.26,-3071.27"/>
<polygon fill="black" stroke="black" points="6622.51,-3074.76 6632.49,-3071.2 6622.46,-3067.76 6622.51,-3074.76"/>
</g>
<!-- Layer_13_Expert_3_EP0_TP1_PP3 -->
<g id="node671" class="node">
<title>Layer_13_Expert_3_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="3746.5,-3220.95 3369.5,-3220.95 3369.5,-3152.95 3746.5,-3152.95 3746.5,-3220.95"/>
<text text-anchor="middle" x="3558" y="-3205.75" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3558" y="-3190.75" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="3558" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3558" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_3_EP0_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1053" class="edge">
<title>Layer_13_Expert_3_EP0_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M3746.66,-3153.8C3749.46,-3153.5 3752.24,-3153.22 3755,-3152.95 4307.03,-3099.68 5962.66,-3078.64 6622.83,-3072.22"/>
<polygon fill="black" stroke="black" points="6622.99,-3075.72 6632.96,-3072.12 6622.92,-3068.72 6622.99,-3075.72"/>
</g>
<!-- Layer_13_Expert_4_EP1_TP0_PP3 -->
<g id="node672" class="node">
<title>Layer_13_Expert_4_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4141.5,-3220.95 3764.5,-3220.95 3764.5,-3152.95 4141.5,-3152.95 4141.5,-3220.95"/>
<text text-anchor="middle" x="3953" y="-3205.75" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3953" y="-3190.75" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="3953" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3953" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_4_EP1_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1055" class="edge">
<title>Layer_13_Expert_4_EP1_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4141.66,-3153.81C4144.46,-3153.51 4147.24,-3153.22 4150,-3152.95 4623.4,-3106.37 6025.18,-3081.97 6623.41,-3073.44"/>
<polygon fill="black" stroke="black" points="6623.52,-3076.94 6633.47,-3073.3 6623.42,-3069.94 6623.52,-3076.94"/>
</g>
<!-- Layer_13_Expert_4_EP1_TP1_PP3 -->
<g id="node673" class="node">
<title>Layer_13_Expert_4_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4536.5,-3220.95 4159.5,-3220.95 4159.5,-3152.95 4536.5,-3152.95 4536.5,-3220.95"/>
<text text-anchor="middle" x="4348" y="-3205.75" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4348" y="-3190.75" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="4348" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4348" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_4_EP1_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1057" class="edge">
<title>Layer_13_Expert_4_EP1_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4536.66,-3153.83C4539.46,-3153.52 4542.24,-3153.23 4545,-3152.95 4940.44,-3113.03 6092.56,-3085.83 6624.26,-3075.05"/>
<polygon fill="black" stroke="black" points="6624.44,-3078.55 6634.37,-3074.85 6624.3,-3071.55 6624.44,-3078.55"/>
</g>
<!-- Layer_13_Expert_5_EP1_TP0_PP3 -->
<g id="node674" class="node">
<title>Layer_13_Expert_5_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4931.5,-3220.95 4554.5,-3220.95 4554.5,-3152.95 4931.5,-3152.95 4931.5,-3220.95"/>
<text text-anchor="middle" x="4743" y="-3205.75" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4743" y="-3190.75" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="4743" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4743" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_5_EP1_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1059" class="edge">
<title>Layer_13_Expert_5_EP1_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4931.67,-3153.86C4934.46,-3153.54 4937.24,-3153.24 4940,-3152.95 5537.56,-3090.47 6242.33,-3074.65 6622.44,-3070.85"/>
<polygon fill="black" stroke="black" points="6622.51,-3074.35 6632.47,-3070.75 6622.44,-3067.35 6622.51,-3074.35"/>
</g>
<!-- Layer_13_Expert_5_EP1_TP1_PP3 -->
<g id="node675" class="node">
<title>Layer_13_Expert_5_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="5326.5,-3220.95 4949.5,-3220.95 4949.5,-3152.95 5326.5,-3152.95 5326.5,-3220.95"/>
<text text-anchor="middle" x="5138" y="-3205.75" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5138" y="-3190.75" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="5138" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5138" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_5_EP1_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1061" class="edge">
<title>Layer_13_Expert_5_EP1_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5326.67,-3153.9C5329.46,-3153.57 5332.24,-3153.25 5335,-3152.95 5785.03,-3103.47 6311.27,-3083.2 6624.21,-3075.09"/>
<polygon fill="black" stroke="black" points="6624.43,-3078.58 6634.33,-3074.83 6624.25,-3071.59 6624.43,-3078.58"/>
</g>
<!-- Layer_13_Expert_6_EP1_TP0_PP3 -->
<g id="node676" class="node">
<title>Layer_13_Expert_6_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="5721.5,-3220.95 5344.5,-3220.95 5344.5,-3152.95 5721.5,-3152.95 5721.5,-3220.95"/>
<text text-anchor="middle" x="5533" y="-3205.75" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5533" y="-3190.75" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="5533" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5533" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_6_EP1_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1063" class="edge">
<title>Layer_13_Expert_6_EP1_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5721.68,-3153.97C5724.47,-3153.62 5727.25,-3153.28 5730,-3152.95 6037.98,-3116.3 6393.67,-3093.84 6631.05,-3081.66"/>
<polygon fill="black" stroke="black" points="6631.4,-3085.15 6641.21,-3081.14 6631.04,-3078.16 6631.4,-3085.15"/>
</g>
<!-- Layer_13_Expert_6_EP1_TP1_PP3 -->
<g id="node677" class="node">
<title>Layer_13_Expert_6_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6116.5,-3220.95 5739.5,-3220.95 5739.5,-3152.95 6116.5,-3152.95 6116.5,-3220.95"/>
<text text-anchor="middle" x="5928" y="-3205.75" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5928" y="-3190.75" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="5928" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5928" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_6_EP1_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1065" class="edge">
<title>Layer_13_Expert_6_EP1_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6116.7,-3154.11C6119.48,-3153.71 6122.25,-3153.33 6125,-3152.95 6301.38,-3128.73 6501.18,-3107.44 6653.6,-3092.47"/>
<polygon fill="black" stroke="black" points="6653.96,-3095.96 6663.57,-3091.5 6653.28,-3088.99 6653.96,-3095.96"/>
</g>
<!-- Layer_13_Expert_7_EP1_TP0_PP3 -->
<g id="node678" class="node">
<title>Layer_13_Expert_7_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6511.5,-3220.95 6134.5,-3220.95 6134.5,-3152.95 6511.5,-3152.95 6511.5,-3220.95"/>
<text text-anchor="middle" x="6323" y="-3205.75" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6323" y="-3190.75" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="6323" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6323" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_7_EP1_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1067" class="edge">
<title>Layer_13_Expert_7_EP1_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6486.9,-3152.92C6557.65,-3138.66 6640.76,-3121.91 6713.73,-3107.21"/>
<polygon fill="black" stroke="black" points="6714.85,-3110.55 6723.96,-3105.14 6713.47,-3103.69 6714.85,-3110.55"/>
</g>
<!-- Layer_13_Expert_7_EP1_TP1_PP3 -->
<g id="node679" class="node">
<title>Layer_13_Expert_7_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6906.5,-3220.95 6529.5,-3220.95 6529.5,-3152.95 6906.5,-3152.95 6906.5,-3220.95"/>
<text text-anchor="middle" x="6718" y="-3205.75" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6718" y="-3190.75" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="6718" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6718" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_7_EP1_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1069" class="edge">
<title>Layer_13_Expert_7_EP1_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6769.87,-3152.69C6785.35,-3142.76 6802.68,-3131.64 6819.5,-3120.85"/>
<polygon fill="black" stroke="black" points="6821.71,-3123.6 6828.24,-3115.25 6817.93,-3117.7 6821.71,-3123.6"/>
</g>
<!-- Layer_13_Expert_8_EP2_TP0_PP3 -->
<g id="node680" class="node">
<title>Layer_13_Expert_8_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7301.5,-3220.95 6924.5,-3220.95 6924.5,-3152.95 7301.5,-3152.95 7301.5,-3220.95"/>
<text text-anchor="middle" x="7113" y="-3205.75" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7113" y="-3190.75" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="7113" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7113" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_8_EP2_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1071" class="edge">
<title>Layer_13_Expert_8_EP2_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7051.96,-3152.84C7032.83,-3142.46 7011.28,-3130.77 6990.52,-3119.51"/>
<polygon fill="black" stroke="black" points="6992.14,-3116.41 6981.68,-3114.72 6988.8,-3122.56 6992.14,-3116.41"/>
</g>
<!-- Layer_13_Expert_8_EP2_TP1_PP3 -->
<g id="node681" class="node">
<title>Layer_13_Expert_8_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7696.5,-3220.95 7319.5,-3220.95 7319.5,-3152.95 7696.5,-3152.95 7696.5,-3220.95"/>
<text text-anchor="middle" x="7508" y="-3205.75" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7508" y="-3190.75" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="7508" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7508" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_8_EP2_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1073" class="edge">
<title>Layer_13_Expert_8_EP2_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7334.71,-3152.92C7258.16,-3138.33 7167.95,-3121.13 7089.52,-3106.18"/>
<polygon fill="black" stroke="black" points="7090,-3102.71 7079.52,-3104.28 7088.69,-3109.59 7090,-3102.71"/>
</g>
<!-- Layer_13_Expert_9_EP2_TP0_PP3 -->
<g id="node682" class="node">
<title>Layer_13_Expert_9_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8091.5,-3220.95 7714.5,-3220.95 7714.5,-3152.95 8091.5,-3152.95 8091.5,-3220.95"/>
<text text-anchor="middle" x="7903" y="-3205.75" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7903" y="-3190.75" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="7903" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7903" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_9_EP2_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1075" class="edge">
<title>Layer_13_Expert_9_EP2_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7714.4,-3154.24C7711.24,-3153.8 7708.11,-3153.37 7705,-3152.95 7518.79,-3127.86 7307.48,-3106.34 7147.95,-3091.49"/>
<polygon fill="black" stroke="black" points="7147.8,-3087.96 7137.52,-3090.52 7147.15,-3094.93 7147.8,-3087.96"/>
</g>
<!-- Layer_13_Expert_9_EP2_TP1_PP3 -->
<g id="node683" class="node">
<title>Layer_13_Expert_9_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8486.5,-3220.95 8109.5,-3220.95 8109.5,-3152.95 8486.5,-3152.95 8486.5,-3220.95"/>
<text text-anchor="middle" x="8298" y="-3205.75" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="8298" y="-3190.75" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="8298" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8298" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_9_EP2_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1077" class="edge">
<title>Layer_13_Expert_9_EP2_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8109.42,-3154.09C8106.26,-3153.7 8103.11,-3153.32 8100,-3152.95 7780.74,-3115.39 7411.59,-3092.97 7167.73,-3081.06"/>
<polygon fill="black" stroke="black" points="7167.82,-3077.56 7157.67,-3080.57 7167.48,-3084.55 7167.82,-3077.56"/>
</g>
<!-- Layer_13_Expert_10_EP2_TP0_PP3 -->
<g id="node684" class="node">
<title>Layer_13_Expert_10_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8881.5,-3220.95 8504.5,-3220.95 8504.5,-3152.95 8881.5,-3152.95 8881.5,-3220.95"/>
<text text-anchor="middle" x="8693" y="-3205.75" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="8693" y="-3190.75" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="8693" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8693" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_10_EP2_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1079" class="edge">
<title>Layer_13_Expert_10_EP2_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8504.42,-3154.02C8501.26,-3153.65 8498.12,-3153.29 8495,-3152.95 8033.18,-3102.61 7492.75,-3082.58 7174.08,-3074.74"/>
<polygon fill="black" stroke="black" points="7173.86,-3071.24 7163.78,-3074.49 7173.69,-3078.24 7173.86,-3071.24"/>
</g>
<!-- Layer_13_Expert_10_EP2_TP1_PP3 -->
<g id="node685" class="node">
<title>Layer_13_Expert_10_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9276.5,-3220.95 8899.5,-3220.95 8899.5,-3152.95 9276.5,-3152.95 9276.5,-3220.95"/>
<text text-anchor="middle" x="9088" y="-3205.75" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="9088" y="-3190.75" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="9088" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9088" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_10_EP2_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1081" class="edge">
<title>Layer_13_Expert_10_EP2_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8899.43,-3153.98C8896.26,-3153.62 8893.12,-3153.28 8890,-3152.95 8280.31,-3089.67 7560.85,-3074.18 7175.61,-3070.65"/>
<polygon fill="black" stroke="black" points="7175.48,-3067.15 7165.44,-3070.56 7175.41,-3074.15 7175.48,-3067.15"/>
</g>
<!-- Layer_13_Expert_11_EP2_TP0_PP3 -->
<g id="node686" class="node">
<title>Layer_13_Expert_11_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9671.5,-3220.95 9294.5,-3220.95 9294.5,-3152.95 9671.5,-3152.95 9671.5,-3220.95"/>
<text text-anchor="middle" x="9483" y="-3205.75" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="9483" y="-3190.75" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="9483" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9483" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_11_EP2_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1083" class="edge">
<title>Layer_13_Expert_11_EP2_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9294.43,-3153.95C9291.27,-3153.6 9288.12,-3153.26 9285,-3152.95 8883.27,-3112.65 7711.17,-3085.57 7173.87,-3074.93"/>
<polygon fill="black" stroke="black" points="7173.72,-3071.43 7163.65,-3074.73 7173.58,-3078.43 7173.72,-3071.43"/>
</g>
<!-- Layer_13_Expert_11_EP2_TP1_PP3 -->
<g id="node687" class="node">
<title>Layer_13_Expert_11_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10066.5,-3220.95 9689.5,-3220.95 9689.5,-3152.95 10066.5,-3152.95 10066.5,-3220.95"/>
<text text-anchor="middle" x="9878" y="-3205.75" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="9878" y="-3190.75" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="9878" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9878" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_11_EP2_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1085" class="edge">
<title>Layer_13_Expert_11_EP2_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9689.43,-3153.92C9686.27,-3153.58 9683.12,-3153.26 9680,-3152.95 9200.25,-3106.02 7778.11,-3081.77 7174.69,-3073.36"/>
<polygon fill="black" stroke="black" points="7174.59,-3069.86 7164.54,-3073.22 7174.49,-3076.85 7174.59,-3069.86"/>
</g>
<!-- Layer_13_Expert_12_EP3_TP0_PP3 -->
<g id="node688" class="node">
<title>Layer_13_Expert_12_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10461.5,-3220.95 10084.5,-3220.95 10084.5,-3152.95 10461.5,-3152.95 10461.5,-3220.95"/>
<text text-anchor="middle" x="10273" y="-3205.75" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10273" y="-3190.75" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="10273" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10273" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_12_EP3_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1087" class="edge">
<title>Layer_13_Expert_12_EP3_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10084.44,-3153.91C10081.27,-3153.57 10078.12,-3153.25 10075,-3152.95 9516.55,-3099.37 7840.25,-3078.48 7175.23,-3072.16"/>
<polygon fill="black" stroke="black" points="7175.06,-3068.66 7165.03,-3072.07 7174.99,-3075.66 7175.06,-3068.66"/>
</g>
<!-- Layer_13_Expert_12_EP3_TP1_PP3 -->
<g id="node689" class="node">
<title>Layer_13_Expert_12_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10856.5,-3220.95 10479.5,-3220.95 10479.5,-3152.95 10856.5,-3152.95 10856.5,-3220.95"/>
<text text-anchor="middle" x="10668" y="-3205.75" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10668" y="-3190.75" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="10668" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10668" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_12_EP3_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1089" class="edge">
<title>Layer_13_Expert_12_EP3_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10479.44,-3153.9C10476.27,-3153.56 10473.12,-3153.25 10470,-3152.95 9832.24,-3092.69 7898.08,-3075.58 7175.36,-3071.22"/>
<polygon fill="black" stroke="black" points="7175.35,-3067.72 7165.33,-3071.16 7175.31,-3074.72 7175.35,-3067.72"/>
</g>
<!-- Layer_13_Expert_13_EP3_TP0_PP3 -->
<g id="node690" class="node">
<title>Layer_13_Expert_13_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11251.5,-3220.95 10874.5,-3220.95 10874.5,-3152.95 11251.5,-3152.95 11251.5,-3220.95"/>
<text text-anchor="middle" x="11063" y="-3205.75" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11063" y="-3190.75" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="11063" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11063" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_13_EP3_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1091" class="edge">
<title>Layer_13_Expert_13_EP3_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10874.44,-3153.88C10871.27,-3153.55 10868.12,-3153.24 10865,-3152.95 10147.63,-3086.01 7953.59,-3072.99 7175.9,-3070.47"/>
<polygon fill="black" stroke="black" points="7175.69,-3066.97 7165.68,-3070.44 7175.67,-3073.97 7175.69,-3066.97"/>
</g>
<!-- Layer_13_Expert_13_EP3_TP1_PP3 -->
<g id="node691" class="node">
<title>Layer_13_Expert_13_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11646.5,-3220.95 11269.5,-3220.95 11269.5,-3152.95 11646.5,-3152.95 11646.5,-3220.95"/>
<text text-anchor="middle" x="11458" y="-3205.75" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11458" y="-3190.75" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="11458" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11458" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_13_EP3_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1093" class="edge">
<title>Layer_13_Expert_13_EP3_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11269.44,-3153.88C11266.27,-3153.55 11263.12,-3153.24 11260,-3152.95 10462.5,-3079.29 8005.56,-3070.64 7175.93,-3069.85"/>
<polygon fill="black" stroke="black" points="7175.65,-3066.35 7165.65,-3069.84 7175.64,-3073.35 7175.65,-3066.35"/>
</g>
<!-- Layer_13_Expert_14_EP3_TP0_PP3 -->
<g id="node692" class="node">
<title>Layer_13_Expert_14_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12041.5,-3220.95 11664.5,-3220.95 11664.5,-3152.95 12041.5,-3152.95 12041.5,-3220.95"/>
<text text-anchor="middle" x="11853" y="-3205.75" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11853" y="-3190.75" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="11853" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11853" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_14_EP3_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1095" class="edge">
<title>Layer_13_Expert_14_EP3_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11664.44,-3153.87C11661.27,-3153.54 11658.12,-3153.24 11655,-3152.95 10777.08,-3072.57 8055.41,-3068.48 7176.05,-3069.33"/>
<polygon fill="black" stroke="black" points="7175.79,-3065.83 7165.79,-3069.34 7175.8,-3072.83 7175.79,-3065.83"/>
</g>
<!-- Layer_13_Expert_14_EP3_TP1_PP3 -->
<g id="node693" class="node">
<title>Layer_13_Expert_14_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12436.5,-3220.95 12059.5,-3220.95 12059.5,-3152.95 12436.5,-3152.95 12436.5,-3220.95"/>
<text text-anchor="middle" x="12248" y="-3205.75" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12248" y="-3190.75" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="12248" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12248" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_14_EP3_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1097" class="edge">
<title>Layer_13_Expert_14_EP3_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12059.44,-3153.86C12056.27,-3153.54 12053.12,-3153.24 12050,-3152.95 11564.83,-3108.86 8174.4,-3079.64 7175.38,-3071.91"/>
<polygon fill="black" stroke="black" points="7175.22,-3068.41 7165.19,-3071.83 7175.16,-3075.41 7175.22,-3068.41"/>
</g>
<!-- Layer_13_Expert_15_EP3_TP0_PP3 -->
<g id="node694" class="node">
<title>Layer_13_Expert_15_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12831.5,-3220.95 12454.5,-3220.95 12454.5,-3152.95 12831.5,-3152.95 12831.5,-3220.95"/>
<text text-anchor="middle" x="12643" y="-3205.75" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12643" y="-3190.75" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="12643" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12643" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_15_EP3_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1099" class="edge">
<title>Layer_13_Expert_15_EP3_TP0_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12454.44,-3153.86C12451.27,-3153.54 12448.12,-3153.23 12445,-3152.95 11919.19,-3105.47 8224.2,-3078.37 7175.76,-3071.57"/>
<polygon fill="black" stroke="black" points="7175.47,-3068.07 7165.44,-3071.51 7175.42,-3075.07 7175.47,-3068.07"/>
</g>
<!-- Layer_13_Expert_15_EP3_TP1_PP3 -->
<g id="node695" class="node">
<title>Layer_13_Expert_15_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="13226.5,-3220.95 12849.5,-3220.95 12849.5,-3152.95 13226.5,-3152.95 13226.5,-3220.95"/>
<text text-anchor="middle" x="13038" y="-3205.75" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="13038" y="-3190.75" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="13038" y="-3175.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="13038" y="-3160.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_Expert_15_EP3_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3 -->
<g id="edge1101" class="edge">
<title>Layer_13_Expert_15_EP3_TP1_PP3&#45;&gt;Layer_13_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12849.44,-3153.85C12846.27,-3153.53 12843.12,-3153.23 12840,-3152.95 12273.37,-3102.06 8271.39,-3077.18 7175.73,-3071.28"/>
<polygon fill="black" stroke="black" points="7175.38,-3067.77 7165.36,-3071.22 7175.34,-3074.77 7175.38,-3067.77"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_0_EP0_TP0_PP3 -->
<g id="edge1038" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_0_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6476.59,-3302.56C5424.05,-3296.43 1584.3,-3270.91 991.79,-3221.04"/>
<polygon fill="black" stroke="black" points="991.92,-3217.54 981.66,-3220.15 991.31,-3224.51 991.92,-3217.54"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_0_EP0_TP1_PP3 -->
<g id="edge1040" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_0_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6476.58,-3302.26C5471.38,-3295.24 1938.37,-3267.54 1386.86,-3221.04"/>
<polygon fill="black" stroke="black" points="1386.92,-3217.53 1376.66,-3220.15 1386.31,-3224.51 1386.92,-3217.53"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_1_EP0_TP0_PP3 -->
<g id="edge1042" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_1_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6476.67,-3301.9C5520.64,-3293.94 2291.98,-3264.18 1781.8,-3221.04"/>
<polygon fill="black" stroke="black" points="1781.93,-3217.53 1771.66,-3220.14 1781.31,-3224.51 1781.93,-3217.53"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_1_EP0_TP1_PP3 -->
<g id="edge1044" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_1_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6476.08,-3304.36C5633.9,-3304.58 3038.28,-3298.83 2176.71,-3221.06"/>
<polygon fill="black" stroke="black" points="2176.93,-3217.56 2166.66,-3220.14 2176.3,-3224.53 2176.93,-3217.56"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_2_EP0_TP0_PP3 -->
<g id="edge1046" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_2_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6476.31,-3303.82C5684.2,-3302.38 3352.57,-3292.11 2571.62,-3221.05"/>
<polygon fill="black" stroke="black" points="2571.94,-3217.56 2561.66,-3220.13 2571.29,-3224.53 2571.94,-3217.56"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_2_EP0_TP1_PP3 -->
<g id="edge1048" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_2_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6476.41,-3303.17C5736.65,-3299.96 3667.28,-3285.42 2966.62,-3221.05"/>
<polygon fill="black" stroke="black" points="2966.94,-3217.57 2956.66,-3220.12 2966.29,-3224.54 2966.94,-3217.57"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_3_EP0_TP0_PP3 -->
<g id="edge1050" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_3_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6476.76,-3302.36C5792.5,-3297.29 3983.31,-3278.76 3362.07,-3221.09"/>
<polygon fill="black" stroke="black" points="3361.94,-3217.57 3351.66,-3220.11 3361.29,-3224.54 3361.94,-3217.57"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_3_EP0_TP1_PP3 -->
<g id="edge1052" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_3_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6477.19,-3301.35C5851.54,-3294.29 4298.58,-3272.13 3756.92,-3221.08"/>
<polygon fill="black" stroke="black" points="3756.95,-3217.57 3746.66,-3220.1 3756.28,-3224.54 3756.95,-3217.57"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_4_EP1_TP0_PP3 -->
<g id="edge1054" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_4_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6477.72,-3300.05C5914.63,-3290.85 4614.35,-3265.54 4151.76,-3221.07"/>
<polygon fill="black" stroke="black" points="4151.96,-3217.57 4141.66,-3220.08 4151.27,-3224.54 4151.96,-3217.57"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_4_EP1_TP1_PP3 -->
<g id="edge1056" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_4_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6476.21,-3304.95C6063.82,-3303.9 5246.84,-3292.01 4546.7,-3221.08"/>
<polygon fill="black" stroke="black" points="4546.97,-3217.59 4536.66,-3220.06 4546.26,-3224.56 4546.97,-3217.59"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_5_EP1_TP0_PP3 -->
<g id="edge1058" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_5_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6476.84,-3301.73C6126.55,-3296.44 5491.73,-3279.04 4941.79,-3221.1"/>
<polygon fill="black" stroke="black" points="4941.98,-3217.6 4931.67,-3220.03 4941.24,-3224.56 4941.98,-3217.6"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_5_EP1_TP1_PP3 -->
<g id="edge1060" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_5_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6480.19,-3296.93C6199.17,-3287.39 5740.52,-3266.23 5336.8,-3221.12"/>
<polygon fill="black" stroke="black" points="5337,-3217.62 5326.67,-3219.98 5336.22,-3224.58 5337,-3217.62"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_6_EP1_TP0_PP3 -->
<g id="edge1062" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_6_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6491.05,-3289.28C6288.33,-3276.01 5996.03,-3253.72 5731.86,-3221.15"/>
<polygon fill="black" stroke="black" points="5732.04,-3217.65 5721.68,-3219.89 5731.18,-3224.6 5732.04,-3217.65"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_6_EP1_TP1_PP3 -->
<g id="edge1064" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_6_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6527.18,-3276.76C6411.17,-3261.67 6265.42,-3242.03 6126.69,-3221.19"/>
<polygon fill="black" stroke="black" points="6127.12,-3217.72 6116.71,-3219.69 6126.08,-3224.64 6127.12,-3217.72"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_7_EP1_TP0_PP3 -->
<g id="edge1066" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_7_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6599.63,-3264.41C6551.94,-3251.23 6499.12,-3236.63 6452.53,-3223.75"/>
<polygon fill="black" stroke="black" points="6453.26,-3220.32 6442.69,-3221.03 6451.39,-3227.07 6453.26,-3220.32"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_7_EP1_TP1_PP3 -->
<g id="edge1068" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_7_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6732.83,-3256.82C6731.01,-3248.34 6729.11,-3239.54 6727.31,-3231.18"/>
<polygon fill="black" stroke="black" points="6730.7,-3230.29 6725.17,-3221.26 6723.86,-3231.77 6730.7,-3230.29"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_8_EP2_TP0_PP3 -->
<g id="edge1070" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_8_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6873.71,-3263.03C6914.16,-3250.33 6958.42,-3236.45 6997.74,-3224.11"/>
<polygon fill="black" stroke="black" points="6999.14,-3227.34 7007.63,-3221.01 6997.04,-3220.66 6999.14,-3227.34"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_8_EP2_TP1_PP3 -->
<g id="edge1072" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_8_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6950.18,-3274.67C7054.79,-3259.6 7183.93,-3240.62 7309.2,-3221.07"/>
<polygon fill="black" stroke="black" points="7310.03,-3224.48 7319.37,-3219.48 7308.95,-3217.56 7310.03,-3224.48"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_9_EP2_TP0_PP3 -->
<g id="edge1074" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_9_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6992.22,-3287.94C7184.21,-3274.24 7456.35,-3252.03 7704.48,-3220.98"/>
<polygon fill="black" stroke="black" points="7704.92,-3224.46 7714.41,-3219.73 7704.05,-3217.51 7704.92,-3224.46"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_9_EP2_TP1_PP3 -->
<g id="edge1076" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_9_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M7005.11,-3296.07C7276.6,-3285.95 7713.12,-3264.43 8099.44,-3220.97"/>
<polygon fill="black" stroke="black" points="8099.88,-3224.44 8109.42,-3219.84 8099.09,-3217.49 8099.88,-3224.44"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_10_EP2_TP0_PP3 -->
<g id="edge1078" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_10_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M7009.02,-3301.15C7350.82,-3295.23 7962.4,-3277.16 8494.24,-3220.98"/>
<polygon fill="black" stroke="black" points="8494.85,-3224.44 8504.43,-3219.9 8494.11,-3217.48 8494.85,-3224.44"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_10_EP2_TP1_PP3 -->
<g id="edge1080" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_10_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M7009.86,-3304.53C7414.6,-3302.85 8207.76,-3290.05 8889.4,-3220.96"/>
<polygon fill="black" stroke="black" points="8889.84,-3224.44 8899.43,-3219.94 8889.13,-3217.47 8889.84,-3224.44"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_11_EP2_TP0_PP3 -->
<g id="edge1082" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_11_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M7008.07,-3299.83C7562.62,-3290.29 8830.55,-3264.52 9284.2,-3220.97"/>
<polygon fill="black" stroke="black" points="9284.82,-3224.42 9294.43,-3219.97 9284.14,-3217.46 9284.82,-3224.42"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_11_EP2_TP1_PP3 -->
<g id="edge1084" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_11_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M7008.86,-3301.18C7626.82,-3293.78 9147.03,-3271.06 9679.36,-3220.95"/>
<polygon fill="black" stroke="black" points="9679.81,-3224.42 9689.44,-3219.99 9679.15,-3217.45 9679.81,-3224.42"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_12_EP3_TP0_PP3 -->
<g id="edge1086" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_12_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M7009.24,-3302.22C7686.22,-3296.83 9462.3,-3277.66 10074.18,-3220.96"/>
<polygon fill="black" stroke="black" points="10074.81,-3224.42 10084.44,-3220 10074.15,-3217.45 10074.81,-3224.42"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_12_EP3_TP1_PP3 -->
<g id="edge1088" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_12_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M7009.61,-3303.04C7742.42,-3299.53 9777.84,-3284.28 10469.36,-3220.95"/>
<polygon fill="black" stroke="black" points="10469.8,-3224.42 10479.44,-3220.01 10469.16,-3217.45 10469.8,-3224.42"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_13_EP3_TP0_PP3 -->
<g id="edge1090" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_13_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M7009.57,-3303.71C7794.91,-3301.97 10092.46,-3290.94 10864.31,-3220.95"/>
<polygon fill="black" stroke="black" points="10864.8,-3224.42 10874.44,-3220.02 10864.16,-3217.45 10864.8,-3224.42"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_13_EP3_TP1_PP3 -->
<g id="edge1092" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_13_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M7009.89,-3304.27C7845.64,-3304.2 10406.72,-3297.62 11259.18,-3220.96"/>
<polygon fill="black" stroke="black" points="11259.8,-3224.42 11269.44,-3220.03 11259.16,-3217.45 11259.8,-3224.42"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_14_EP3_TP0_PP3 -->
<g id="edge1094" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_14_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M7009.59,-3304.74C7893.01,-3306.25 10720.85,-3304.34 11654.22,-3220.96"/>
<polygon fill="black" stroke="black" points="11654.8,-3224.42 11664.44,-3220.04 11654.17,-3217.45 11654.8,-3224.42"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_14_EP3_TP1_PP3 -->
<g id="edge1096" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_14_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M7009.46,-3302.2C8008.53,-3295.01 11502.39,-3266.9 12049.32,-3220.92"/>
<polygon fill="black" stroke="black" points="12049.78,-3224.4 12059.44,-3220.04 12049.17,-3217.42 12049.78,-3224.4"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_15_EP3_TP0_PP3 -->
<g id="edge1098" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_15_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M7009.28,-3302.52C8055.67,-3296.22 11856.39,-3270.25 12444.38,-3220.92"/>
<polygon fill="black" stroke="black" points="12444.78,-3224.4 12454.44,-3220.05 12444.18,-3217.43 12444.78,-3224.4"/>
</g>
<!-- Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_15_EP3_TP1_PP3 -->
<g id="edge1100" class="edge">
<title>Layer_13_A2A_Dispatch_PP3&#45;&gt;Layer_13_Expert_15_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M7009.35,-3302.79C8101.55,-3297.35 12208.91,-3273.62 12839.1,-3220.95"/>
<polygon fill="black" stroke="black" points="12839.78,-3224.4 12849.44,-3220.05 12839.18,-3217.43 12839.78,-3224.4"/>
</g>
<!-- Layer_13_MLP_Out_TP0_PP3 -->
<g id="node698" class="node">
<title>Layer_13_MLP_Out_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="7016.5,-2984.79 6639.5,-2984.79 6639.5,-2916.79 7016.5,-2916.79 7016.5,-2984.79"/>
<text text-anchor="middle" x="6828" y="-2969.59" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="6828" y="-2954.59" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6828" y="-2939.59" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6828" y="-2924.59" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_A2A_Combine_PP3&#45;&gt;Layer_13_MLP_Out_TP0_PP3 -->
<g id="edge1102" class="edge">
<title>Layer_13_A2A_Combine_PP3&#45;&gt;Layer_13_MLP_Out_TP0_PP3</title>
<path fill="none" stroke="black" d="M6870.33,-3020.99C6864.78,-3011.93 6859.01,-3002.49 6853.58,-2993.6"/>
<polygon fill="black" stroke="black" points="6856.48,-2991.64 6848.27,-2984.93 6850.51,-2995.29 6856.48,-2991.64"/>
</g>
<!-- Layer_13_MLP_Out_TP1_PP3 -->
<g id="node699" class="node">
<title>Layer_13_MLP_Out_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="7411.5,-2984.79 7034.5,-2984.79 7034.5,-2916.79 7411.5,-2916.79 7411.5,-2984.79"/>
<text text-anchor="middle" x="7223" y="-2969.59" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="7223" y="-2954.59" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="7223" y="-2939.59" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7223" y="-2924.59" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_13_A2A_Combine_PP3&#45;&gt;Layer_13_MLP_Out_TP1_PP3 -->
<g id="edge1104" class="edge">
<title>Layer_13_A2A_Combine_PP3&#45;&gt;Layer_13_MLP_Out_TP1_PP3</title>
<path fill="none" stroke="black" d="M7016.89,-3025.63C7051.06,-3013.39 7088.06,-3000.13 7121.16,-2988.27"/>
<polygon fill="black" stroke="black" points="7122.61,-2991.47 7130.85,-2984.8 7120.25,-2984.88 7122.61,-2991.47"/>
</g>
<!-- Layer_13_MLP_AllReduce_PP3 -->
<g id="node700" class="node">
<title>Layer_13_MLP_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6918" cy="-2832.7" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6918" y="-2851.5" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="6918" y="-2836.5" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6918" y="-2821.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6918" y="-2806.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_13_MLP_Out_TP0_PP3&#45;&gt;Layer_13_MLP_AllReduce_PP3 -->
<g id="edge1103" class="edge">
<title>Layer_13_MLP_Out_TP0_PP3&#45;&gt;Layer_13_MLP_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6853.79,-2916.52C6860.61,-2907.73 6868.15,-2898 6875.6,-2888.39"/>
<polygon fill="black" stroke="black" points="6878.45,-2890.43 6881.81,-2880.38 6872.92,-2886.14 6878.45,-2890.43"/>
</g>
<!-- Layer_13_MLP_Out_TP1_PP3&#45;&gt;Layer_13_MLP_AllReduce_PP3 -->
<g id="edge1105" class="edge">
<title>Layer_13_MLP_Out_TP1_PP3&#45;&gt;Layer_13_MLP_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M7136.01,-2916.68C7106.04,-2905.27 7071.91,-2892.28 7039.69,-2880.02"/>
<polygon fill="black" stroke="black" points="7040.8,-2876.69 7030.21,-2876.41 7038.31,-2883.24 7040.8,-2876.69"/>
</g>
<!-- Layer_13_LayerNorm_PP3 -->
<g id="node701" class="node">
<title>Layer_13_LayerNorm_PP3</title>
<polygon fill="lightgreen" stroke="black" points="7106.5,-2748.62 6729.5,-2748.62 6729.5,-2680.62 7106.5,-2680.62 7106.5,-2748.62"/>
<text text-anchor="middle" x="6918" y="-2733.42" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6918" y="-2718.42" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6918" y="-2703.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6918" y="-2688.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_13_MLP_AllReduce_PP3&#45;&gt;Layer_13_LayerNorm_PP3 -->
<g id="edge1106" class="edge">
<title>Layer_13_MLP_AllReduce_PP3&#45;&gt;Layer_13_LayerNorm_PP3</title>
<path fill="none" stroke="black" d="M6918,-2784.49C6918,-2776.1 6918,-2767.4 6918,-2759.13"/>
<polygon fill="black" stroke="black" points="6921.5,-2758.92 6918,-2748.92 6914.5,-2758.92 6921.5,-2758.92"/>
</g>
<!-- Layer_14_QKV_TP0_PP3 -->
<g id="node702" class="node">
<title>Layer_14_QKV_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="7108.5,-2644.62 6727.5,-2644.62 6727.5,-2576.62 7108.5,-2576.62 7108.5,-2644.62"/>
<text text-anchor="middle" x="6918" y="-2629.42" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6918" y="-2614.42" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6918" y="-2599.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6918" y="-2584.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_13_LayerNorm_PP3&#45;&gt;Layer_14_QKV_TP0_PP3 -->
<g id="edge1107" class="edge">
<title>Layer_13_LayerNorm_PP3&#45;&gt;Layer_14_QKV_TP0_PP3</title>
<path fill="none" stroke="black" d="M6918,-2680.5C6918,-2672.4 6918,-2663.6 6918,-2655.09"/>
<polygon fill="black" stroke="black" points="6921.5,-2654.92 6918,-2644.92 6914.5,-2654.92 6921.5,-2654.92"/>
</g>
<!-- Layer_14_QKV_AllReduce_PP3 -->
<g id="node704" class="node">
<title>Layer_14_QKV_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6820" cy="-2492.54" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="6820" y="-2511.34" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="6820" y="-2496.34" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6820" y="-2481.34" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6820" y="-2466.34" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_14_QKV_TP0_PP3&#45;&gt;Layer_14_QKV_AllReduce_PP3 -->
<g id="edge1108" class="edge">
<title>Layer_14_QKV_TP0_PP3&#45;&gt;Layer_14_QKV_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6889.92,-2576.35C6882.42,-2567.47 6874.12,-2557.64 6865.93,-2547.94"/>
<polygon fill="black" stroke="black" points="6868.53,-2545.6 6859.41,-2540.21 6863.18,-2550.11 6868.53,-2545.6"/>
</g>
<!-- Layer_14_QKV_TP1_PP3 -->
<g id="node703" class="node">
<title>Layer_14_QKV_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="6709.5,-2644.62 6328.5,-2644.62 6328.5,-2576.62 6709.5,-2576.62 6709.5,-2644.62"/>
<text text-anchor="middle" x="6519" y="-2629.42" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6519" y="-2614.42" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6519" y="-2599.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6519" y="-2584.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_14_QKV_TP1_PP3&#45;&gt;Layer_14_QKV_AllReduce_PP3 -->
<g id="edge1112" class="edge">
<title>Layer_14_QKV_TP1_PP3&#45;&gt;Layer_14_QKV_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6604.85,-2576.51C6634.06,-2565.24 6667.29,-2552.43 6698.74,-2540.3"/>
<polygon fill="black" stroke="black" points="6700.36,-2543.43 6708.44,-2536.56 6697.85,-2536.89 6700.36,-2543.43"/>
</g>
<!-- Layer_14_Attention_TP0_PP3 -->
<g id="node705" class="node">
<title>Layer_14_Attention_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6702.5,-2408.45 6321.5,-2408.45 6321.5,-2340.45 6702.5,-2340.45 6702.5,-2408.45"/>
<text text-anchor="middle" x="6512" y="-2393.25" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6512" y="-2378.25" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6512" y="-2363.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6512" y="-2348.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_14_QKV_AllReduce_PP3&#45;&gt;Layer_14_Attention_TP0_PP3 -->
<g id="edge1109" class="edge">
<title>Layer_14_QKV_AllReduce_PP3&#45;&gt;Layer_14_Attention_TP0_PP3</title>
<path fill="none" stroke="black" d="M6706.19,-2448.64C6674.35,-2436.64 6640.05,-2423.71 6609.27,-2412.11"/>
<polygon fill="black" stroke="black" points="6610.43,-2408.81 6599.83,-2408.56 6607.96,-2415.36 6610.43,-2408.81"/>
</g>
<!-- Layer_14_Attention_TP1_PP3 -->
<g id="node706" class="node">
<title>Layer_14_Attention_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="7101.5,-2408.45 6720.5,-2408.45 6720.5,-2340.45 7101.5,-2340.45 7101.5,-2408.45"/>
<text text-anchor="middle" x="6911" y="-2393.25" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6911" y="-2378.25" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6911" y="-2363.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6911" y="-2348.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_14_QKV_AllReduce_PP3&#45;&gt;Layer_14_Attention_TP1_PP3 -->
<g id="edge1113" class="edge">
<title>Layer_14_QKV_AllReduce_PP3&#45;&gt;Layer_14_Attention_TP1_PP3</title>
<path fill="none" stroke="black" d="M6856.75,-2444.65C6864,-2435.4 6871.56,-2425.76 6878.65,-2416.71"/>
<polygon fill="black" stroke="black" points="6881.6,-2418.63 6885.01,-2408.6 6876.09,-2414.31 6881.6,-2418.63"/>
</g>
<!-- Layer_14_AttnOut_TP0_PP3 -->
<g id="node707" class="node">
<title>Layer_14_AttnOut_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6701.5,-2304.45 6324.5,-2304.45 6324.5,-2236.45 6701.5,-2236.45 6701.5,-2304.45"/>
<text text-anchor="middle" x="6513" y="-2289.25" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="6513" y="-2274.25" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6513" y="-2259.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6513" y="-2244.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Attention_TP0_PP3&#45;&gt;Layer_14_AttnOut_TP0_PP3 -->
<g id="edge1110" class="edge">
<title>Layer_14_Attention_TP0_PP3&#45;&gt;Layer_14_AttnOut_TP0_PP3</title>
<path fill="none" stroke="black" d="M6512.32,-2340.34C6512.4,-2332.23 6512.49,-2323.43 6512.57,-2314.92"/>
<polygon fill="black" stroke="black" points="6516.08,-2314.79 6512.67,-2304.75 6509.08,-2314.72 6516.08,-2314.79"/>
</g>
<!-- Layer_14_AttnOut_TP1_PP3 -->
<g id="node708" class="node">
<title>Layer_14_AttnOut_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="7098.5,-2304.45 6721.5,-2304.45 6721.5,-2236.45 7098.5,-2236.45 7098.5,-2304.45"/>
<text text-anchor="middle" x="6910" y="-2289.25" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="6910" y="-2274.25" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6910" y="-2259.25" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6910" y="-2244.25" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Attention_TP1_PP3&#45;&gt;Layer_14_AttnOut_TP1_PP3 -->
<g id="edge1114" class="edge">
<title>Layer_14_Attention_TP1_PP3&#45;&gt;Layer_14_AttnOut_TP1_PP3</title>
<path fill="none" stroke="black" d="M6910.68,-2340.34C6910.6,-2332.23 6910.51,-2323.43 6910.43,-2314.92"/>
<polygon fill="black" stroke="black" points="6913.92,-2314.72 6910.33,-2304.75 6906.92,-2314.79 6913.92,-2314.72"/>
</g>
<!-- Layer_14_AttnOut_AllReduce_PP3 -->
<g id="node709" class="node">
<title>Layer_14_AttnOut_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6710" cy="-2152.37" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6710" y="-2171.17" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="6710" y="-2156.17" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6710" y="-2141.17" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6710" y="-2126.17" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_14_AttnOut_TP0_PP3&#45;&gt;Layer_14_AttnOut_AllReduce_PP3 -->
<g id="edge1111" class="edge">
<title>Layer_14_AttnOut_TP0_PP3&#45;&gt;Layer_14_AttnOut_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6569.19,-2236.34C6586.47,-2226.16 6605.89,-2214.71 6624.67,-2203.65"/>
<polygon fill="black" stroke="black" points="6626.69,-2206.52 6633.53,-2198.43 6623.13,-2200.49 6626.69,-2206.52"/>
</g>
<!-- Layer_14_AttnOut_TP1_PP3&#45;&gt;Layer_14_AttnOut_AllReduce_PP3 -->
<g id="edge1115" class="edge">
<title>Layer_14_AttnOut_TP1_PP3&#45;&gt;Layer_14_AttnOut_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6852.96,-2236.34C6835.33,-2226.11 6815.51,-2214.61 6796.37,-2203.5"/>
<polygon fill="black" stroke="black" points="6798.04,-2200.42 6787.64,-2198.43 6794.53,-2206.48 6798.04,-2200.42"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3 -->
<g id="node746" class="node">
<title>Layer_14_A2A_Dispatch_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6710" cy="-2020.2" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6710" y="-2039" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="6710" y="-2024" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6710" y="-2009" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6710" y="-1994" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_14_AttnOut_AllReduce_PP3&#45;&gt;Layer_14_A2A_Dispatch_PP3 -->
<g id="edge1116" class="edge">
<title>Layer_14_AttnOut_AllReduce_PP3&#45;&gt;Layer_14_A2A_Dispatch_PP3</title>
<path fill="none" stroke="black" d="M6710,-2104.01C6710,-2095.74 6710,-2087.06 6710,-2078.55"/>
<polygon fill="black" stroke="black" points="6713.5,-2078.31 6710,-2068.31 6706.5,-2078.31 6713.5,-2078.31"/>
</g>
<!-- Layer_14_Gate_EP0_PP3 -->
<g id="node710" class="node">
<title>Layer_14_Gate_EP0_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6213.4,-5282.28 5609.86,-5282.28 5454.6,-5146.28 6058.14,-5146.28 6213.4,-5282.28"/>
<text text-anchor="middle" x="5834" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="5834" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="5834" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5834" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_14_Gate_EP1_PP3 -->
<g id="node711" class="node">
<title>Layer_14_Gate_EP1_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5436.4,-5282.28 4832.86,-5282.28 4677.6,-5146.28 5281.14,-5146.28 5436.4,-5282.28"/>
<text text-anchor="middle" x="5057" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="5057" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="5057" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5057" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_14_Gate_EP2_PP3 -->
<g id="node712" class="node">
<title>Layer_14_Gate_EP2_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4659.4,-5282.28 4055.86,-5282.28 3900.6,-5146.28 4504.14,-5146.28 4659.4,-5282.28"/>
<text text-anchor="middle" x="4280" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="4280" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="4280" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4280" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_14_Gate_EP3_PP3 -->
<g id="node713" class="node">
<title>Layer_14_Gate_EP3_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3882.4,-5282.28 3278.86,-5282.28 3123.6,-5146.28 3727.14,-5146.28 3882.4,-5282.28"/>
<text text-anchor="middle" x="3503" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="3503" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="3503" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3503" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_14_Expert_0_EP0_TP0_PP3 -->
<g id="node714" class="node">
<title>Layer_14_Expert_0_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="938.5,-1936.12 561.5,-1936.12 561.5,-1868.12 938.5,-1868.12 938.5,-1936.12"/>
<text text-anchor="middle" x="750" y="-1920.92" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="750" y="-1905.92" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="750" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="750" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_A2A_Combine_PP3 -->
<g id="node747" class="node">
<title>Layer_14_A2A_Combine_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6862" cy="-1784.04" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6862" y="-1802.84" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="6862" y="-1787.84" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6862" y="-1772.84" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6862" y="-1757.84" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_14_Expert_0_EP0_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1118" class="edge">
<title>Layer_14_Expert_0_EP0_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M938.66,-1868.92C941.45,-1868.63 944.24,-1868.37 947,-1868.12 1510.89,-1817.23 5492.24,-1792.36 6585.09,-1786.45"/>
<polygon fill="black" stroke="black" points="6585.46,-1789.95 6595.44,-1786.39 6585.42,-1782.95 6585.46,-1789.95"/>
</g>
<!-- Layer_14_Expert_0_EP0_TP1_PP3 -->
<g id="node715" class="node">
<title>Layer_14_Expert_0_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="1333.5,-1936.12 956.5,-1936.12 956.5,-1868.12 1333.5,-1868.12 1333.5,-1936.12"/>
<text text-anchor="middle" x="1145" y="-1920.92" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1145" y="-1905.92" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="1145" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1145" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_0_EP0_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1120" class="edge">
<title>Layer_14_Expert_0_EP0_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M1333.66,-1868.92C1336.45,-1868.64 1339.24,-1868.37 1342,-1868.12 1865.11,-1820.64 5539.87,-1793.55 6585.2,-1786.75"/>
<polygon fill="black" stroke="black" points="6585.51,-1790.25 6595.49,-1786.68 6585.47,-1783.25 6585.51,-1790.25"/>
</g>
<!-- Layer_14_Expert_1_EP0_TP0_PP3 -->
<g id="node716" class="node">
<title>Layer_14_Expert_1_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="1728.5,-1936.12 1351.5,-1936.12 1351.5,-1868.12 1728.5,-1868.12 1728.5,-1936.12"/>
<text text-anchor="middle" x="1540" y="-1920.92" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1540" y="-1905.92" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="1540" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1540" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_1_EP0_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1122" class="edge">
<title>Layer_14_Expert_1_EP0_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M1728.66,-1868.92C1731.45,-1868.64 1734.24,-1868.37 1737,-1868.12 2219.49,-1824.05 5590.14,-1794.83 6585.73,-1787.09"/>
<polygon fill="black" stroke="black" points="6585.92,-1790.59 6595.89,-1787.01 6585.86,-1783.59 6585.92,-1790.59"/>
</g>
<!-- Layer_14_Expert_1_EP0_TP1_PP3 -->
<g id="node717" class="node">
<title>Layer_14_Expert_1_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2123.5,-1936.12 1746.5,-1936.12 1746.5,-1868.12 2123.5,-1868.12 2123.5,-1936.12"/>
<text text-anchor="middle" x="1935" y="-1920.92" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1935" y="-1905.92" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="1935" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1935" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_1_EP0_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1124" class="edge">
<title>Layer_14_Expert_1_EP0_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2123.66,-1868.93C2126.46,-1868.64 2129.24,-1868.37 2132,-1868.12 3004.57,-1787.82 5708.75,-1783.66 6584.93,-1784.5"/>
<polygon fill="black" stroke="black" points="6585.15,-1788 6595.15,-1784.51 6585.15,-1781 6585.15,-1788"/>
</g>
<!-- Layer_14_Expert_2_EP0_TP0_PP3 -->
<g id="node718" class="node">
<title>Layer_14_Expert_2_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2518.5,-1936.12 2141.5,-1936.12 2141.5,-1868.12 2518.5,-1868.12 2518.5,-1936.12"/>
<text text-anchor="middle" x="2330" y="-1920.92" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2330" y="-1905.92" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="2330" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2330" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_2_EP0_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1126" class="edge">
<title>Layer_14_Expert_2_EP0_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2518.66,-1868.94C2521.46,-1868.65 2524.24,-1868.38 2527,-1868.12 3319.13,-1794.58 5758.43,-1785.84 6584.89,-1785.03"/>
<polygon fill="black" stroke="black" points="6585.14,-1788.53 6595.14,-1785.02 6585.14,-1781.53 6585.14,-1788.53"/>
</g>
<!-- Layer_14_Expert_2_EP0_TP1_PP3 -->
<g id="node719" class="node">
<title>Layer_14_Expert_2_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2913.5,-1936.12 2536.5,-1936.12 2536.5,-1868.12 2913.5,-1868.12 2913.5,-1936.12"/>
<text text-anchor="middle" x="2725" y="-1920.92" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2725" y="-1905.92" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="2725" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2725" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_2_EP0_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1128" class="edge">
<title>Layer_14_Expert_2_EP0_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2913.66,-1868.94C2916.46,-1868.65 2919.24,-1868.38 2922,-1868.12 3634.11,-1801.32 5811.07,-1788.21 6585.19,-1785.65"/>
<polygon fill="black" stroke="black" points="6585.37,-1789.15 6595.36,-1785.62 6585.35,-1782.15 6585.37,-1789.15"/>
</g>
<!-- Layer_14_Expert_3_EP0_TP0_PP3 -->
<g id="node720" class="node">
<title>Layer_14_Expert_3_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="3308.5,-1936.12 2931.5,-1936.12 2931.5,-1868.12 3308.5,-1868.12 3308.5,-1936.12"/>
<text text-anchor="middle" x="3120" y="-1920.92" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3120" y="-1905.92" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="3120" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3120" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_3_EP0_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1130" class="edge">
<title>Layer_14_Expert_3_EP0_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M3308.66,-1868.95C3311.46,-1868.66 3314.24,-1868.38 3317,-1868.12 3949.44,-1808.05 5866.24,-1790.83 6585.44,-1786.42"/>
<polygon fill="black" stroke="black" points="6585.7,-1789.92 6595.68,-1786.36 6585.66,-1782.92 6585.7,-1789.92"/>
</g>
<!-- Layer_14_Expert_3_EP0_TP1_PP3 -->
<g id="node721" class="node">
<title>Layer_14_Expert_3_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="3703.5,-1936.12 3326.5,-1936.12 3326.5,-1868.12 3703.5,-1868.12 3703.5,-1936.12"/>
<text text-anchor="middle" x="3515" y="-1920.92" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3515" y="-1905.92" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="3515" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3515" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_3_EP0_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1132" class="edge">
<title>Layer_14_Expert_3_EP0_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M3703.66,-1868.96C3706.46,-1868.67 3709.24,-1868.39 3712,-1868.12 4265.17,-1814.76 5924.38,-1793.76 6585.61,-1787.37"/>
<polygon fill="black" stroke="black" points="6585.79,-1790.87 6595.75,-1787.27 6585.72,-1783.87 6585.79,-1790.87"/>
</g>
<!-- Layer_14_Expert_4_EP1_TP0_PP3 -->
<g id="node722" class="node">
<title>Layer_14_Expert_4_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4098.5,-1936.12 3721.5,-1936.12 3721.5,-1868.12 4098.5,-1868.12 4098.5,-1936.12"/>
<text text-anchor="middle" x="3910" y="-1920.92" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3910" y="-1905.92" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="3910" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3910" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_4_EP1_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1134" class="edge">
<title>Layer_14_Expert_4_EP1_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4098.66,-1868.98C4101.46,-1868.68 4104.24,-1868.39 4107,-1868.12 4581.58,-1821.43 5987.15,-1797.08 6586.37,-1788.59"/>
<polygon fill="black" stroke="black" points="6586.49,-1792.08 6596.44,-1788.44 6586.4,-1785.08 6586.49,-1792.08"/>
</g>
<!-- Layer_14_Expert_4_EP1_TP1_PP3 -->
<g id="node723" class="node">
<title>Layer_14_Expert_4_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4493.5,-1936.12 4116.5,-1936.12 4116.5,-1868.12 4493.5,-1868.12 4493.5,-1936.12"/>
<text text-anchor="middle" x="4305" y="-1920.92" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4305" y="-1905.92" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="4305" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4305" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_4_EP1_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1136" class="edge">
<title>Layer_14_Expert_4_EP1_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4493.66,-1869C4496.46,-1868.69 4499.24,-1868.4 4502,-1868.12 4898.64,-1828.09 6054.61,-1800.93 6587.32,-1790.19"/>
<polygon fill="black" stroke="black" points="6587.53,-1793.69 6597.46,-1789.99 6587.39,-1786.69 6587.53,-1793.69"/>
</g>
<!-- Layer_14_Expert_5_EP1_TP0_PP3 -->
<g id="node724" class="node">
<title>Layer_14_Expert_5_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4888.5,-1936.12 4511.5,-1936.12 4511.5,-1868.12 4888.5,-1868.12 4888.5,-1936.12"/>
<text text-anchor="middle" x="4700" y="-1920.92" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4700" y="-1905.92" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="4700" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4700" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_5_EP1_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1138" class="edge">
<title>Layer_14_Expert_5_EP1_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4888.67,-1869.03C4891.46,-1868.71 4894.24,-1868.41 4897,-1868.12 5496.81,-1805.44 6204.31,-1789.7 6585.39,-1785.97"/>
<polygon fill="black" stroke="black" points="6585.49,-1789.47 6595.45,-1785.87 6585.42,-1782.47 6585.49,-1789.47"/>
</g>
<!-- Layer_14_Expert_5_EP1_TP1_PP3 -->
<g id="node725" class="node">
<title>Layer_14_Expert_5_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="5283.5,-1936.12 4906.5,-1936.12 4906.5,-1868.12 5283.5,-1868.12 5283.5,-1936.12"/>
<text text-anchor="middle" x="5095" y="-1920.92" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5095" y="-1905.92" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="5095" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5095" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_5_EP1_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1140" class="edge">
<title>Layer_14_Expert_5_EP1_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5283.67,-1869.07C5286.46,-1868.74 5289.24,-1868.42 5292,-1868.12 5744.26,-1818.43 6273.2,-1798.23 6587.21,-1790.17"/>
<polygon fill="black" stroke="black" points="6587.45,-1793.67 6597.36,-1789.92 6587.28,-1786.67 6587.45,-1793.67"/>
</g>
<!-- Layer_14_Expert_6_EP1_TP0_PP3 -->
<g id="node726" class="node">
<title>Layer_14_Expert_6_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="5678.5,-1936.12 5301.5,-1936.12 5301.5,-1868.12 5678.5,-1868.12 5678.5,-1936.12"/>
<text text-anchor="middle" x="5490" y="-1920.92" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5490" y="-1905.92" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="5490" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5490" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_6_EP1_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1142" class="edge">
<title>Layer_14_Expert_6_EP1_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5678.68,-1869.14C5681.47,-1868.79 5684.25,-1868.45 5687,-1868.12 5997.06,-1831.27 6355.23,-1808.82 6593.83,-1796.71"/>
<polygon fill="black" stroke="black" points="6594.23,-1800.19 6604.04,-1796.19 6593.87,-1793.2 6594.23,-1800.19"/>
</g>
<!-- Layer_14_Expert_6_EP1_TP1_PP3 -->
<g id="node727" class="node">
<title>Layer_14_Expert_6_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6073.5,-1936.12 5696.5,-1936.12 5696.5,-1868.12 6073.5,-1868.12 6073.5,-1936.12"/>
<text text-anchor="middle" x="5885" y="-1920.92" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5885" y="-1905.92" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="5885" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5885" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_6_EP1_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1144" class="edge">
<title>Layer_14_Expert_6_EP1_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6073.7,-1869.27C6076.48,-1868.88 6079.25,-1868.5 6082,-1868.12 6260.23,-1843.72 6462.22,-1822.38 6615.98,-1807.44"/>
<polygon fill="black" stroke="black" points="6616.42,-1810.91 6626.04,-1806.46 6615.75,-1803.94 6616.42,-1810.91"/>
</g>
<!-- Layer_14_Expert_7_EP1_TP0_PP3 -->
<g id="node728" class="node">
<title>Layer_14_Expert_7_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6468.5,-1936.12 6091.5,-1936.12 6091.5,-1868.12 6468.5,-1868.12 6468.5,-1936.12"/>
<text text-anchor="middle" x="6280" y="-1920.92" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6280" y="-1905.92" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="6280" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6280" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_7_EP1_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1146" class="edge">
<title>Layer_14_Expert_7_EP1_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6445.61,-1868.09C6517.48,-1853.75 6601.98,-1836.9 6676,-1822.13"/>
<polygon fill="black" stroke="black" points="6676.78,-1825.55 6685.91,-1820.16 6675.42,-1818.68 6676.78,-1825.55"/>
</g>
<!-- Layer_14_Expert_7_EP1_TP1_PP3 -->
<g id="node729" class="node">
<title>Layer_14_Expert_7_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6863.5,-1936.12 6486.5,-1936.12 6486.5,-1868.12 6863.5,-1868.12 6863.5,-1936.12"/>
<text text-anchor="middle" x="6675" y="-1920.92" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6675" y="-1905.92" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="6675" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6675" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_7_EP1_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1148" class="edge">
<title>Layer_14_Expert_7_EP1_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6728.34,-1868.01C6744.57,-1857.93 6762.8,-1846.61 6780.45,-1835.66"/>
<polygon fill="black" stroke="black" points="6782.41,-1838.56 6789.06,-1830.31 6778.72,-1832.61 6782.41,-1838.56"/>
</g>
<!-- Layer_14_Expert_8_EP2_TP0_PP3 -->
<g id="node730" class="node">
<title>Layer_14_Expert_8_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7258.5,-1936.12 6881.5,-1936.12 6881.5,-1868.12 7258.5,-1868.12 7258.5,-1936.12"/>
<text text-anchor="middle" x="7070" y="-1920.92" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7070" y="-1905.92" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="7070" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7070" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_8_EP2_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1150" class="edge">
<title>Layer_14_Expert_8_EP2_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7010.67,-1868.01C6992.16,-1857.68 6971.31,-1846.04 6951.22,-1834.83"/>
<polygon fill="black" stroke="black" points="6952.8,-1831.7 6942.36,-1829.88 6949.38,-1837.81 6952.8,-1831.7"/>
</g>
<!-- Layer_14_Expert_8_EP2_TP1_PP3 -->
<g id="node731" class="node">
<title>Layer_14_Expert_8_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7653.5,-1936.12 7276.5,-1936.12 7276.5,-1868.12 7653.5,-1868.12 7653.5,-1936.12"/>
<text text-anchor="middle" x="7465" y="-1920.92" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7465" y="-1905.92" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="7465" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7465" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_8_EP2_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1152" class="edge">
<title>Layer_14_Expert_8_EP2_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7293.41,-1868.09C7217.88,-1853.55 7128.89,-1836.41 7051.41,-1821.5"/>
<polygon fill="black" stroke="black" points="7052.02,-1818.05 7041.53,-1819.6 7050.69,-1824.93 7052.02,-1818.05"/>
</g>
<!-- Layer_14_Expert_9_EP2_TP0_PP3 -->
<g id="node732" class="node">
<title>Layer_14_Expert_9_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8048.5,-1936.12 7671.5,-1936.12 7671.5,-1868.12 8048.5,-1868.12 8048.5,-1936.12"/>
<text text-anchor="middle" x="7860" y="-1920.92" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7860" y="-1905.92" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="7860" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7860" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_9_EP2_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1154" class="edge">
<title>Layer_14_Expert_9_EP2_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7671.4,-1869.41C7668.24,-1868.97 7665.11,-1868.54 7662,-1868.12 7477.51,-1843.19 7268.2,-1821.69 7109.97,-1806.81"/>
<polygon fill="black" stroke="black" points="7109.9,-1803.29 7099.62,-1805.84 7109.25,-1810.26 7109.9,-1803.29"/>
</g>
<!-- Layer_14_Expert_9_EP2_TP1_PP3 -->
<g id="node733" class="node">
<title>Layer_14_Expert_9_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8443.5,-1936.12 8066.5,-1936.12 8066.5,-1868.12 8443.5,-1868.12 8443.5,-1936.12"/>
<text text-anchor="middle" x="8255" y="-1920.92" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="8255" y="-1905.92" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="8255" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8255" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_9_EP2_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1156" class="edge">
<title>Layer_14_Expert_9_EP2_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8066.42,-1869.26C8063.26,-1868.87 8060.11,-1868.49 8057,-1868.12 7739.84,-1830.75 7373.2,-1808.32 7130.56,-1796.35"/>
<polygon fill="black" stroke="black" points="7130.7,-1792.85 7120.54,-1795.86 7130.36,-1799.84 7130.7,-1792.85"/>
</g>
<!-- Layer_14_Expert_10_EP2_TP0_PP3 -->
<g id="node734" class="node">
<title>Layer_14_Expert_10_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8838.5,-1936.12 8461.5,-1936.12 8461.5,-1868.12 8838.5,-1868.12 8838.5,-1936.12"/>
<text text-anchor="middle" x="8650" y="-1920.92" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="8650" y="-1905.92" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="8650" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8650" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_10_EP2_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1158" class="edge">
<title>Layer_14_Expert_10_EP2_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8461.42,-1869.19C8458.26,-1868.82 8455.12,-1868.46 8452,-1868.12 7992.43,-1817.98 7454.71,-1797.89 7137.11,-1789.99"/>
<polygon fill="black" stroke="black" points="7136.92,-1786.48 7126.84,-1789.74 7136.75,-1793.48 7136.92,-1786.48"/>
</g>
<!-- Layer_14_Expert_10_EP2_TP1_PP3 -->
<g id="node735" class="node">
<title>Layer_14_Expert_10_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9233.5,-1936.12 8856.5,-1936.12 8856.5,-1868.12 9233.5,-1868.12 9233.5,-1936.12"/>
<text text-anchor="middle" x="9045" y="-1920.92" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="9045" y="-1905.92" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="9045" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9045" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_10_EP2_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1160" class="edge">
<title>Layer_14_Expert_10_EP2_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8856.43,-1869.14C8853.26,-1868.78 8850.12,-1868.44 8847,-1868.12 8239.57,-1805.03 7522.86,-1789.47 7138.59,-1785.87"/>
<polygon fill="black" stroke="black" points="7138.47,-1782.37 7128.44,-1785.77 7138.41,-1789.37 7138.47,-1782.37"/>
</g>
<!-- Layer_14_Expert_11_EP2_TP0_PP3 -->
<g id="node736" class="node">
<title>Layer_14_Expert_11_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9628.5,-1936.12 9251.5,-1936.12 9251.5,-1868.12 9628.5,-1868.12 9628.5,-1936.12"/>
<text text-anchor="middle" x="9440" y="-1920.92" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="9440" y="-1905.92" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="9440" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9440" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_11_EP2_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1162" class="edge">
<title>Layer_14_Expert_11_EP2_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9251.43,-1869.11C9248.27,-1868.76 9245.12,-1868.43 9242,-1868.12 8841.47,-1827.92 7673.24,-1800.81 7136.95,-1790.13"/>
<polygon fill="black" stroke="black" points="7136.81,-1786.63 7126.75,-1789.93 7136.67,-1793.62 7136.81,-1786.63"/>
</g>
<!-- Layer_14_Expert_11_EP2_TP1_PP3 -->
<g id="node737" class="node">
<title>Layer_14_Expert_11_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10023.5,-1936.12 9646.5,-1936.12 9646.5,-1868.12 10023.5,-1868.12 10023.5,-1936.12"/>
<text text-anchor="middle" x="9835" y="-1920.92" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="9835" y="-1905.92" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="9835" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9835" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_11_EP2_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1164" class="edge">
<title>Layer_14_Expert_11_EP2_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9646.43,-1869.09C9643.27,-1868.75 9640.12,-1868.42 9637,-1868.12 9158.43,-1821.29 7740.1,-1796.99 7137.65,-1788.54"/>
<polygon fill="black" stroke="black" points="7137.58,-1785.04 7127.53,-1788.4 7137.48,-1792.04 7137.58,-1785.04"/>
</g>
<!-- Layer_14_Expert_12_EP3_TP0_PP3 -->
<g id="node738" class="node">
<title>Layer_14_Expert_12_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10418.5,-1936.12 10041.5,-1936.12 10041.5,-1868.12 10418.5,-1868.12 10418.5,-1936.12"/>
<text text-anchor="middle" x="10230" y="-1920.92" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10230" y="-1905.92" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="10230" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10230" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_12_EP3_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1166" class="edge">
<title>Layer_14_Expert_12_EP3_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10041.44,-1869.08C10038.27,-1868.74 10035.12,-1868.42 10032,-1868.12 9474.78,-1814.64 7802.5,-1793.7 7138.31,-1787.35"/>
<polygon fill="black" stroke="black" points="7138.16,-1783.85 7128.13,-1787.25 7138.09,-1790.84 7138.16,-1783.85"/>
</g>
<!-- Layer_14_Expert_12_EP3_TP1_PP3 -->
<g id="node739" class="node">
<title>Layer_14_Expert_12_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10813.5,-1936.12 10436.5,-1936.12 10436.5,-1868.12 10813.5,-1868.12 10813.5,-1936.12"/>
<text text-anchor="middle" x="10625" y="-1920.92" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10625" y="-1905.92" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="10625" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10625" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_12_EP3_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1168" class="edge">
<title>Layer_14_Expert_12_EP3_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10436.44,-1869.06C10433.27,-1868.73 10430.12,-1868.41 10427,-1868.12 9790.51,-1807.97 7860.57,-1790.8 7138.55,-1786.41"/>
<polygon fill="black" stroke="black" points="7138.55,-1782.91 7128.53,-1786.34 7138.51,-1789.91 7138.55,-1782.91"/>
</g>
<!-- Layer_14_Expert_13_EP3_TP0_PP3 -->
<g id="node740" class="node">
<title>Layer_14_Expert_13_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11208.5,-1936.12 10831.5,-1936.12 10831.5,-1868.12 11208.5,-1868.12 11208.5,-1936.12"/>
<text text-anchor="middle" x="11020" y="-1920.92" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11020" y="-1905.92" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="11020" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11020" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_13_EP3_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1170" class="edge">
<title>Layer_14_Expert_13_EP3_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10831.44,-1869.05C10828.27,-1868.72 10825.12,-1868.41 10822,-1868.12 10105.82,-1801.28 7915.65,-1788.2 7138.82,-1785.65"/>
<polygon fill="black" stroke="black" points="7138.63,-1782.15 7128.62,-1785.62 7138.61,-1789.15 7138.63,-1782.15"/>
</g>
<!-- Layer_14_Expert_13_EP3_TP1_PP3 -->
<g id="node741" class="node">
<title>Layer_14_Expert_13_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11603.5,-1936.12 11226.5,-1936.12 11226.5,-1868.12 11603.5,-1868.12 11603.5,-1936.12"/>
<text text-anchor="middle" x="11415" y="-1920.92" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11415" y="-1905.92" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="11415" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11415" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_13_EP3_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1172" class="edge">
<title>Layer_14_Expert_13_EP3_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11226.44,-1869.04C11223.27,-1868.72 11220.12,-1868.41 11217,-1868.12 10420.72,-1794.56 7967.76,-1785.84 7138.92,-1785.03"/>
<polygon fill="black" stroke="black" points="7138.64,-1781.53 7128.64,-1785.02 7138.64,-1788.53 7138.64,-1781.53"/>
</g>
<!-- Layer_14_Expert_14_EP3_TP0_PP3 -->
<g id="node742" class="node">
<title>Layer_14_Expert_14_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11998.5,-1936.12 11621.5,-1936.12 11621.5,-1868.12 11998.5,-1868.12 11998.5,-1936.12"/>
<text text-anchor="middle" x="11810" y="-1920.92" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11810" y="-1905.92" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="11810" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11810" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_14_EP3_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1174" class="edge">
<title>Layer_14_Expert_14_EP3_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11621.44,-1869.04C11618.27,-1868.71 11615.12,-1868.4 11612,-1868.12 10735.32,-1787.84 8017.74,-1783.67 7139.09,-1784.51"/>
<polygon fill="black" stroke="black" points="7138.83,-1781.01 7128.84,-1784.52 7138.84,-1788.01 7138.83,-1781.01"/>
</g>
<!-- Layer_14_Expert_14_EP3_TP1_PP3 -->
<g id="node743" class="node">
<title>Layer_14_Expert_14_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12393.5,-1936.12 12016.5,-1936.12 12016.5,-1868.12 12393.5,-1868.12 12393.5,-1936.12"/>
<text text-anchor="middle" x="12205" y="-1920.92" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12205" y="-1905.92" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="12205" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12205" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_14_EP3_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1176" class="edge">
<title>Layer_14_Expert_14_EP3_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12016.44,-1869.03C12013.27,-1868.71 12010.12,-1868.4 12007,-1868.12 11522.47,-1824.08 8136.88,-1794.83 7138.49,-1787.09"/>
<polygon fill="black" stroke="black" points="7138.33,-1783.59 7128.3,-1787.01 7138.27,-1790.59 7138.33,-1783.59"/>
</g>
<!-- Layer_14_Expert_15_EP3_TP0_PP3 -->
<g id="node744" class="node">
<title>Layer_14_Expert_15_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12788.5,-1936.12 12411.5,-1936.12 12411.5,-1868.12 12788.5,-1868.12 12788.5,-1936.12"/>
<text text-anchor="middle" x="12600" y="-1920.92" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12600" y="-1905.92" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="12600" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12600" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_15_EP3_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1178" class="edge">
<title>Layer_14_Expert_15_EP3_TP0_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12411.44,-1869.03C12408.27,-1868.7 12405.12,-1868.4 12402,-1868.12 11876.83,-1820.69 8186.82,-1793.55 7138.9,-1786.75"/>
<polygon fill="black" stroke="black" points="7138.62,-1783.24 7128.6,-1786.68 7138.57,-1790.24 7138.62,-1783.24"/>
</g>
<!-- Layer_14_Expert_15_EP3_TP1_PP3 -->
<g id="node745" class="node">
<title>Layer_14_Expert_15_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="13183.5,-1936.12 12806.5,-1936.12 12806.5,-1868.12 13183.5,-1868.12 13183.5,-1936.12"/>
<text text-anchor="middle" x="12995" y="-1920.92" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12995" y="-1905.92" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="12995" y="-1890.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12995" y="-1875.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_Expert_15_EP3_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3 -->
<g id="edge1180" class="edge">
<title>Layer_14_Expert_15_EP3_TP1_PP3&#45;&gt;Layer_14_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12806.44,-1869.02C12803.27,-1868.7 12800.12,-1868.4 12797,-1868.12 12231.02,-1817.29 8234.13,-1792.37 7138.92,-1786.45"/>
<polygon fill="black" stroke="black" points="7138.56,-1782.95 7128.55,-1786.39 7138.53,-1789.95 7138.56,-1782.95"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_0_EP0_TP0_PP3 -->
<g id="edge1117" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_0_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6443.57,-2017.74C5389.86,-2011.63 1542.43,-1986.16 948.81,-1936.21"/>
<polygon fill="black" stroke="black" points="948.92,-1932.7 938.66,-1935.32 948.31,-1939.68 948.92,-1932.7"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_0_EP0_TP1_PP3 -->
<g id="edge1119" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_0_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6443.51,-2017.43C5437.02,-2010.43 1896.48,-1982.79 1343.88,-1936.21"/>
<polygon fill="black" stroke="black" points="1343.92,-1932.7 1333.66,-1935.32 1343.31,-1939.68 1343.92,-1932.7"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_1_EP0_TP0_PP3 -->
<g id="edge1121" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_1_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6443.96,-2017.08C5487.05,-2009.15 2250.17,-1979.44 1738.83,-1936.21"/>
<polygon fill="black" stroke="black" points="1738.93,-1932.7 1728.66,-1935.31 1738.31,-1939.67 1738.93,-1932.7"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_1_EP0_TP1_PP3 -->
<g id="edge1123" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_1_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6443.24,-2019.54C5600,-2019.81 2997.43,-2014.17 2133.74,-1936.23"/>
<polygon fill="black" stroke="black" points="2133.93,-1932.73 2123.66,-1935.31 2133.3,-1939.7 2133.93,-1932.73"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_2_EP0_TP0_PP3 -->
<g id="edge1125" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_2_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6443.38,-2019C5650.05,-2017.61 3311.68,-2007.45 2528.65,-1936.22"/>
<polygon fill="black" stroke="black" points="2528.94,-1932.73 2518.66,-1935.3 2528.29,-1939.7 2528.94,-1932.73"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_2_EP0_TP1_PP3 -->
<g id="edge1127" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_2_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6443.38,-2018.35C5702.24,-2015.19 3626.36,-2000.75 2923.65,-1936.22"/>
<polygon fill="black" stroke="black" points="2923.94,-1932.73 2913.66,-1935.29 2923.29,-1939.7 2923.94,-1932.73"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_3_EP0_TP0_PP3 -->
<g id="edge1129" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_3_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M6443.6,-2017.55C5757.63,-2012.53 3941.46,-1994.09 3318.64,-1936.22"/>
<polygon fill="black" stroke="black" points="3318.94,-1932.74 3308.66,-1935.28 3318.29,-1939.7 3318.94,-1932.74"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_3_EP0_TP1_PP3 -->
<g id="edge1131" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_3_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M6444.18,-2016.55C5817.01,-2009.54 4257.66,-1987.47 3713.96,-1936.25"/>
<polygon fill="black" stroke="black" points="3713.95,-1932.74 3703.66,-1935.27 3713.28,-1939.71 3713.95,-1932.74"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_4_EP1_TP0_PP3 -->
<g id="edge1133" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_4_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6444.77,-2015.25C5880.09,-2006.12 4573.44,-1980.87 4108.81,-1936.24"/>
<polygon fill="black" stroke="black" points="4108.96,-1932.74 4098.66,-1935.25 4108.27,-1939.71 4108.96,-1932.74"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_4_EP1_TP1_PP3 -->
<g id="edge1135" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_4_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6445.95,-2013.52C5948.86,-2002.12 4890.15,-1974.34 4503.78,-1936.25"/>
<polygon fill="black" stroke="black" points="4503.96,-1932.75 4493.66,-1935.23 4503.27,-1939.71 4503.96,-1932.75"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_5_EP1_TP0_PP3 -->
<g id="edge1137" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_5_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6443.89,-2017C6091.97,-2011.82 5452.59,-1994.54 4898.86,-1936.28"/>
<polygon fill="black" stroke="black" points="4898.98,-1932.77 4888.67,-1935.2 4898.24,-1939.73 4898.98,-1932.77"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_5_EP1_TP1_PP3 -->
<g id="edge1139" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_5_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6446.95,-2012.24C6164.1,-2002.81 5701.19,-1981.72 5293.89,-1936.3"/>
<polygon fill="black" stroke="black" points="5294,-1932.79 5283.67,-1935.15 5293.22,-1939.74 5294,-1932.79"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_6_EP1_TP0_PP3 -->
<g id="edge1141" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_6_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6457.41,-2004.68C6252.62,-1991.49 5956.45,-1969.2 5688.99,-1936.33"/>
<polygon fill="black" stroke="black" points="5689.04,-1932.81 5678.68,-1935.06 5688.18,-1939.76 5689.04,-1932.81"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_6_EP1_TP1_PP3 -->
<g id="edge1143" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_6_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6492.49,-1992.3C6374.32,-1977.22 6225.39,-1957.48 6083.89,-1936.39"/>
<polygon fill="black" stroke="black" points="6084.12,-1932.88 6073.71,-1934.87 6083.08,-1939.81 6084.12,-1932.88"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_7_EP1_TP0_PP3 -->
<g id="edge1145" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_7_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6564.42,-1979.9C6515.19,-1966.61 6460.51,-1951.85 6412.36,-1938.85"/>
<polygon fill="black" stroke="black" points="6413.07,-1935.42 6402.5,-1936.19 6411.24,-1942.18 6413.07,-1935.42"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_7_EP1_TP1_PP3 -->
<g id="edge1147" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_7_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6695.76,-1971.99C6693.18,-1963.41 6690.5,-1954.52 6687.95,-1946.07"/>
<polygon fill="black" stroke="black" points="6691.28,-1944.99 6685.04,-1936.42 6684.58,-1947.01 6691.28,-1944.99"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_8_EP2_TP0_PP3 -->
<g id="edge1149" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_8_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6837.94,-1977.95C6877.15,-1965.3 6919.98,-1951.49 6958.05,-1939.22"/>
<polygon fill="black" stroke="black" points="6959.17,-1942.53 6967.62,-1936.13 6957.02,-1935.87 6959.17,-1942.53"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_8_EP2_TP1_PP3 -->
<g id="edge1151" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_8_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6915.14,-1989.46C7017.62,-1974.39 7143.78,-1955.52 7266.41,-1936.2"/>
<polygon fill="black" stroke="black" points="7267.04,-1939.65 7276.37,-1934.63 7265.95,-1932.73 7267.04,-1939.65"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_9_EP2_TP0_PP3 -->
<g id="edge1153" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_9_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6958.62,-2002.84C7148.41,-1989.08 7416.52,-1966.91 7661.24,-1936.18"/>
<polygon fill="black" stroke="black" points="7661.92,-1939.62 7671.41,-1934.9 7661.05,-1932.68 7661.92,-1939.62"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_9_EP2_TP1_PP3 -->
<g id="edge1155" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_9_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6971.76,-2011.08C7241.3,-2000.86 7673.51,-1979.29 8056.25,-1936.16"/>
<polygon fill="black" stroke="black" points="8056.88,-1939.61 8066.42,-1935.01 8056.09,-1932.66 8056.88,-1939.61"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_10_EP2_TP0_PP3 -->
<g id="edge1157" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_10_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6975.99,-2016.21C7316.12,-2010.19 7923.21,-1992 8451.32,-1936.14"/>
<polygon fill="black" stroke="black" points="8451.85,-1939.61 8461.43,-1935.07 8451.11,-1932.65 8451.85,-1939.61"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_10_EP2_TP1_PP3 -->
<g id="edge1159" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_10_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6976.87,-2019.62C7380.11,-2017.84 8168.64,-2004.89 8846.46,-1936.12"/>
<polygon fill="black" stroke="black" points="8846.84,-1939.6 8856.43,-1935.11 8846.13,-1932.64 8846.84,-1939.6"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_11_EP2_TP0_PP3 -->
<g id="edge1161" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_11_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6975.08,-2014.95C7528,-2005.36 8789.63,-1979.52 9241.24,-1936.13"/>
<polygon fill="black" stroke="black" points="9241.82,-1939.59 9251.43,-1935.13 9241.14,-1932.62 9241.82,-1939.59"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_11_EP2_TP1_PP3 -->
<g id="edge1163" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_11_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6975.82,-2016.31C7592.22,-2008.87 9106.1,-1986.06 9636.39,-1936.11"/>
<polygon fill="black" stroke="black" points="9636.81,-1939.59 9646.44,-1935.15 9636.15,-1932.62 9636.81,-1939.59"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_12_EP3_TP0_PP3 -->
<g id="edge1165" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_12_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M6976.37,-2017.36C7652.02,-2011.92 9421.43,-1992.65 10031.22,-1936.13"/>
<polygon fill="black" stroke="black" points="10031.81,-1939.59 10041.44,-1935.17 10031.15,-1932.62 10031.81,-1939.59"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_12_EP3_TP1_PP3 -->
<g id="edge1167" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_12_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M6976.56,-2018.19C7707.96,-2014.63 9736.91,-1999.28 10426.39,-1936.11"/>
<polygon fill="black" stroke="black" points="10426.8,-1939.59 10436.44,-1935.18 10426.16,-1932.62 10426.8,-1939.59"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_13_EP3_TP0_PP3 -->
<g id="edge1169" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_13_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M6976.62,-2018.87C7760.73,-2017.08 10051.56,-2005.94 10821.33,-1936.12"/>
<polygon fill="black" stroke="black" points="10821.8,-1939.59 10831.44,-1935.19 10821.16,-1932.62 10821.8,-1939.59"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_13_EP3_TP1_PP3 -->
<g id="edge1171" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_13_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M6976.66,-2019.42C7810.95,-2019.31 10365.74,-2012.63 11216.2,-1936.13"/>
<polygon fill="black" stroke="black" points="11216.8,-1939.59 11226.44,-1935.2 11216.16,-1932.62 11216.8,-1939.59"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_14_EP3_TP0_PP3 -->
<g id="edge1173" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_14_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M6976.82,-2019.89C7859.32,-2021.36 10680.03,-2019.33 11611.25,-1936.12"/>
<polygon fill="black" stroke="black" points="11611.8,-1939.59 11621.44,-1935.2 11611.17,-1932.62 11611.8,-1939.59"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_14_EP3_TP1_PP3 -->
<g id="edge1175" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_14_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M6976.39,-2017.36C7974.15,-2010.15 11460.5,-1981.98 12006.34,-1936.09"/>
<polygon fill="black" stroke="black" points="12006.78,-1939.57 12016.44,-1935.21 12006.17,-1932.59 12006.78,-1939.57"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_15_EP3_TP0_PP3 -->
<g id="edge1177" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_15_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M6976.26,-2017.68C8021.45,-2011.36 11814.51,-1985.33 12401.4,-1936.09"/>
<polygon fill="black" stroke="black" points="12401.78,-1939.57 12411.44,-1935.21 12401.18,-1932.59 12401.78,-1939.57"/>
</g>
<!-- Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_15_EP3_TP1_PP3 -->
<g id="edge1179" class="edge">
<title>Layer_14_A2A_Dispatch_PP3&#45;&gt;Layer_14_Expert_15_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M6976.37,-2017.95C8067.48,-2012.49 12167.04,-1988.7 12796.12,-1936.11"/>
<polygon fill="black" stroke="black" points="12796.78,-1939.57 12806.44,-1935.22 12796.18,-1932.59 12796.78,-1939.57"/>
</g>
<!-- Layer_14_MLP_Out_TP0_PP3 -->
<g id="node748" class="node">
<title>Layer_14_MLP_Out_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6749.5,-1699.95 6372.5,-1699.95 6372.5,-1631.95 6749.5,-1631.95 6749.5,-1699.95"/>
<text text-anchor="middle" x="6561" y="-1684.75" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="6561" y="-1669.75" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6561" y="-1654.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6561" y="-1639.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_A2A_Combine_PP3&#45;&gt;Layer_14_MLP_Out_TP0_PP3 -->
<g id="edge1181" class="edge">
<title>Layer_14_A2A_Combine_PP3&#45;&gt;Layer_14_MLP_Out_TP0_PP3</title>
<path fill="none" stroke="black" d="M6750.77,-1740.14C6719.8,-1728.19 6686.43,-1715.33 6656.45,-1703.76"/>
<polygon fill="black" stroke="black" points="6657.43,-1700.39 6646.84,-1700.06 6654.91,-1706.92 6657.43,-1700.39"/>
</g>
<!-- Layer_14_MLP_Out_TP1_PP3 -->
<g id="node749" class="node">
<title>Layer_14_MLP_Out_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="7144.5,-1699.95 6767.5,-1699.95 6767.5,-1631.95 7144.5,-1631.95 7144.5,-1699.95"/>
<text text-anchor="middle" x="6956" y="-1684.75" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="6956" y="-1669.75" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6956" y="-1654.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6956" y="-1639.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_14_A2A_Combine_PP3&#45;&gt;Layer_14_MLP_Out_TP1_PP3 -->
<g id="edge1183" class="edge">
<title>Layer_14_A2A_Combine_PP3&#45;&gt;Layer_14_MLP_Out_TP1_PP3</title>
<path fill="none" stroke="black" d="M6899.96,-1736.15C6907.53,-1726.81 6915.42,-1717.07 6922.81,-1707.94"/>
<polygon fill="black" stroke="black" points="6925.58,-1710.07 6929.16,-1700.1 6920.14,-1705.67 6925.58,-1710.07"/>
</g>
<!-- Layer_14_MLP_AllReduce_PP3 -->
<g id="node750" class="node">
<title>Layer_14_MLP_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6654" cy="-1547.87" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6654" y="-1566.67" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="6654" y="-1551.67" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6654" y="-1536.67" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6654" y="-1521.67" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_14_MLP_Out_TP0_PP3&#45;&gt;Layer_14_MLP_AllReduce_PP3 -->
<g id="edge1182" class="edge">
<title>Layer_14_MLP_Out_TP0_PP3&#45;&gt;Layer_14_MLP_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6587.65,-1631.69C6594.69,-1622.89 6602.49,-1613.17 6610.18,-1603.56"/>
<polygon fill="black" stroke="black" points="6613.08,-1605.54 6616.6,-1595.55 6607.62,-1601.16 6613.08,-1605.54"/>
</g>
<!-- Layer_14_MLP_Out_TP1_PP3&#45;&gt;Layer_14_MLP_AllReduce_PP3 -->
<g id="edge1184" class="edge">
<title>Layer_14_MLP_Out_TP1_PP3&#45;&gt;Layer_14_MLP_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6869.86,-1631.84C6840.27,-1620.47 6806.57,-1607.52 6774.74,-1595.28"/>
<polygon fill="black" stroke="black" points="6775.97,-1592 6765.38,-1591.68 6773.46,-1598.54 6775.97,-1592"/>
</g>
<!-- Layer_14_LayerNorm_PP3 -->
<g id="node751" class="node">
<title>Layer_14_LayerNorm_PP3</title>
<polygon fill="lightgreen" stroke="black" points="6842.5,-1463.79 6465.5,-1463.79 6465.5,-1395.79 6842.5,-1395.79 6842.5,-1463.79"/>
<text text-anchor="middle" x="6654" y="-1448.59" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6654" y="-1433.59" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6654" y="-1418.59" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6654" y="-1403.59" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_14_MLP_AllReduce_PP3&#45;&gt;Layer_14_LayerNorm_PP3 -->
<g id="edge1185" class="edge">
<title>Layer_14_MLP_AllReduce_PP3&#45;&gt;Layer_14_LayerNorm_PP3</title>
<path fill="none" stroke="black" d="M6654,-1499.65C6654,-1491.27 6654,-1482.57 6654,-1474.29"/>
<polygon fill="black" stroke="black" points="6657.5,-1474.09 6654,-1464.09 6650.5,-1474.09 6657.5,-1474.09"/>
</g>
<!-- Layer_15_QKV_TP0_PP3 -->
<g id="node752" class="node">
<title>Layer_15_QKV_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6844.5,-1359.79 6463.5,-1359.79 6463.5,-1291.79 6844.5,-1291.79 6844.5,-1359.79"/>
<text text-anchor="middle" x="6654" y="-1344.59" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6654" y="-1329.59" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6654" y="-1314.59" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6654" y="-1299.59" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_14_LayerNorm_PP3&#45;&gt;Layer_15_QKV_TP0_PP3 -->
<g id="edge1186" class="edge">
<title>Layer_14_LayerNorm_PP3&#45;&gt;Layer_15_QKV_TP0_PP3</title>
<path fill="none" stroke="black" d="M6654,-1395.67C6654,-1387.56 6654,-1378.77 6654,-1370.26"/>
<polygon fill="black" stroke="black" points="6657.5,-1370.09 6654,-1360.09 6650.5,-1370.09 6657.5,-1370.09"/>
</g>
<!-- Layer_15_QKV_AllReduce_PP3 -->
<g id="node754" class="node">
<title>Layer_15_QKV_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6358" cy="-1207.7" rx="275.13" ry="48.17"/>
<text text-anchor="middle" x="6358" y="-1226.5" font-family="Arial" font-size="14.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="6358" y="-1211.5" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6358" y="-1196.5" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6358" y="-1181.5" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- Layer_15_QKV_TP0_PP3&#45;&gt;Layer_15_QKV_AllReduce_PP3 -->
<g id="edge1187" class="edge">
<title>Layer_15_QKV_TP0_PP3&#45;&gt;Layer_15_QKV_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6569.57,-1291.68C6540.93,-1280.44 6508.35,-1267.67 6477.5,-1255.57"/>
<polygon fill="black" stroke="black" points="6478.57,-1252.23 6467.98,-1251.84 6476.02,-1258.74 6478.57,-1252.23"/>
</g>
<!-- Layer_15_QKV_TP1_PP3 -->
<g id="node753" class="node">
<title>Layer_15_QKV_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="6445.5,-1359.79 6064.5,-1359.79 6064.5,-1291.79 6445.5,-1291.79 6445.5,-1359.79"/>
<text text-anchor="middle" x="6255" y="-1344.59" font-family="Arial" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6255" y="-1329.59" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6255" y="-1314.59" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6255" y="-1299.59" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_15_QKV_TP1_PP3&#45;&gt;Layer_15_QKV_AllReduce_PP3 -->
<g id="edge1191" class="edge">
<title>Layer_15_QKV_TP1_PP3&#45;&gt;Layer_15_QKV_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6284.52,-1291.52C6292.4,-1282.64 6301.12,-1272.81 6309.73,-1263.11"/>
<polygon fill="black" stroke="black" points="6312.56,-1265.18 6316.58,-1255.38 6307.33,-1260.54 6312.56,-1265.18"/>
</g>
<!-- Layer_15_Attention_TP0_PP3 -->
<g id="node755" class="node">
<title>Layer_15_Attention_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6200.5,-1123.62 5819.5,-1123.62 5819.5,-1055.62 6200.5,-1055.62 6200.5,-1123.62"/>
<text text-anchor="middle" x="6010" y="-1108.42" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6010" y="-1093.42" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6010" y="-1078.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6010" y="-1063.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_15_QKV_AllReduce_PP3&#45;&gt;Layer_15_Attention_TP0_PP3 -->
<g id="edge1188" class="edge">
<title>Layer_15_QKV_AllReduce_PP3&#45;&gt;Layer_15_Attention_TP0_PP3</title>
<path fill="none" stroke="black" d="M6232.36,-1164.79C6195.1,-1152.36 6154.62,-1138.86 6118.54,-1126.83"/>
<polygon fill="black" stroke="black" points="6119.57,-1123.48 6108.98,-1123.64 6117.36,-1130.12 6119.57,-1123.48"/>
</g>
<!-- Layer_15_Attention_TP1_PP3 -->
<g id="node756" class="node">
<title>Layer_15_Attention_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="6599.5,-1123.62 6218.5,-1123.62 6218.5,-1055.62 6599.5,-1055.62 6599.5,-1123.62"/>
<text text-anchor="middle" x="6409" y="-1108.42" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6409" y="-1093.42" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6409" y="-1078.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6409" y="-1063.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
</g>
<!-- Layer_15_QKV_AllReduce_PP3&#45;&gt;Layer_15_Attention_TP1_PP3 -->
<g id="edge1192" class="edge">
<title>Layer_15_QKV_AllReduce_PP3&#45;&gt;Layer_15_Attention_TP1_PP3</title>
<path fill="none" stroke="black" d="M6378.74,-1159.49C6382.55,-1150.82 6386.5,-1141.82 6390.25,-1133.3"/>
<polygon fill="black" stroke="black" points="6393.55,-1134.49 6394.37,-1123.92 6387.14,-1131.67 6393.55,-1134.49"/>
</g>
<!-- Layer_15_AttnOut_TP0_PP3 -->
<g id="node757" class="node">
<title>Layer_15_AttnOut_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6199.5,-1019.62 5822.5,-1019.62 5822.5,-951.62 6199.5,-951.62 6199.5,-1019.62"/>
<text text-anchor="middle" x="6011" y="-1004.42" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="6011" y="-989.42" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6011" y="-974.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6011" y="-959.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Attention_TP0_PP3&#45;&gt;Layer_15_AttnOut_TP0_PP3 -->
<g id="edge1189" class="edge">
<title>Layer_15_Attention_TP0_PP3&#45;&gt;Layer_15_AttnOut_TP0_PP3</title>
<path fill="none" stroke="black" d="M6010.32,-1055.5C6010.4,-1047.4 6010.49,-1038.6 6010.57,-1030.09"/>
<polygon fill="black" stroke="black" points="6014.08,-1029.95 6010.67,-1019.92 6007.08,-1029.88 6014.08,-1029.95"/>
</g>
<!-- Layer_15_AttnOut_TP1_PP3 -->
<g id="node758" class="node">
<title>Layer_15_AttnOut_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="6596.5,-1019.62 6219.5,-1019.62 6219.5,-951.62 6596.5,-951.62 6596.5,-1019.62"/>
<text text-anchor="middle" x="6408" y="-1004.42" font-family="Arial" font-size="14.00">Attention Output Proj</text>
<text text-anchor="middle" x="6408" y="-989.42" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6408" y="-974.42" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, heads=8, d_k=32]</text>
<text text-anchor="middle" x="6408" y="-959.42" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Attention_TP1_PP3&#45;&gt;Layer_15_AttnOut_TP1_PP3 -->
<g id="edge1193" class="edge">
<title>Layer_15_Attention_TP1_PP3&#45;&gt;Layer_15_AttnOut_TP1_PP3</title>
<path fill="none" stroke="black" d="M6408.68,-1055.5C6408.6,-1047.4 6408.51,-1038.6 6408.43,-1030.09"/>
<polygon fill="black" stroke="black" points="6411.92,-1029.88 6408.33,-1019.92 6404.92,-1029.95 6411.92,-1029.88"/>
</g>
<!-- Layer_15_AttnOut_AllReduce_PP3 -->
<g id="node759" class="node">
<title>Layer_15_AttnOut_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6237" cy="-867.54" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6237" y="-886.34" font-family="Arial" font-size="14.00">All&#45;Reduce Attn Output</text>
<text text-anchor="middle" x="6237" y="-871.34" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6237" y="-856.34" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6237" y="-841.34" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_15_AttnOut_TP0_PP3&#45;&gt;Layer_15_AttnOut_AllReduce_PP3 -->
<g id="edge1190" class="edge">
<title>Layer_15_AttnOut_TP0_PP3&#45;&gt;Layer_15_AttnOut_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6075.46,-951.51C6095.87,-941.03 6118.89,-929.2 6141.02,-917.84"/>
<polygon fill="black" stroke="black" points="6142.81,-920.85 6150.11,-913.17 6139.61,-914.62 6142.81,-920.85"/>
</g>
<!-- Layer_15_AttnOut_TP1_PP3&#45;&gt;Layer_15_AttnOut_AllReduce_PP3 -->
<g id="edge1194" class="edge">
<title>Layer_15_AttnOut_TP1_PP3&#45;&gt;Layer_15_AttnOut_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6359,-951.35C6344.59,-941.58 6328.48,-930.64 6312.82,-920"/>
<polygon fill="black" stroke="black" points="6314.41,-916.86 6304.17,-914.13 6310.48,-922.65 6314.41,-916.86"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3 -->
<g id="node796" class="node">
<title>Layer_15_A2A_Dispatch_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6237" cy="-735.37" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6237" y="-754.17" font-family="Arial" font-size="14.00">All&#45;to&#45;All Dispatch</text>
<text text-anchor="middle" x="6237" y="-739.17" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6237" y="-724.17" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6237" y="-709.17" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_15_AttnOut_AllReduce_PP3&#45;&gt;Layer_15_A2A_Dispatch_PP3 -->
<g id="edge1195" class="edge">
<title>Layer_15_AttnOut_AllReduce_PP3&#45;&gt;Layer_15_A2A_Dispatch_PP3</title>
<path fill="none" stroke="black" d="M6237,-819.17C6237,-810.91 6237,-802.22 6237,-793.72"/>
<polygon fill="black" stroke="black" points="6240.5,-793.48 6237,-783.48 6233.5,-793.48 6240.5,-793.48"/>
</g>
<!-- Layer_15_Gate_EP0_PP3 -->
<g id="node760" class="node">
<title>Layer_15_Gate_EP0_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3105.4,-5282.28 2501.86,-5282.28 2346.6,-5146.28 2950.14,-5146.28 3105.4,-5282.28"/>
<text text-anchor="middle" x="2726" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="2726" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 0</text>
<text text-anchor="middle" x="2726" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2726" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_15_Gate_EP1_PP3 -->
<g id="node761" class="node">
<title>Layer_15_Gate_EP1_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2328.4,-5282.28 1724.86,-5282.28 1569.6,-5146.28 2173.14,-5146.28 2328.4,-5282.28"/>
<text text-anchor="middle" x="1949" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="1949" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 1</text>
<text text-anchor="middle" x="1949" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1949" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_15_Gate_EP2_PP3 -->
<g id="node762" class="node">
<title>Layer_15_Gate_EP2_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1551.4,-5282.28 947.86,-5282.28 792.6,-5146.28 1396.14,-5146.28 1551.4,-5282.28"/>
<text text-anchor="middle" x="1172" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="1172" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 2</text>
<text text-anchor="middle" x="1172" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1172" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_15_Gate_EP3_PP3 -->
<g id="node763" class="node">
<title>Layer_15_Gate_EP3_PP3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="774.4,-5282.28 170.86,-5282.28 15.6,-5146.28 619.14,-5146.28 774.4,-5282.28"/>
<text text-anchor="middle" x="395" y="-5233.08" font-family="Arial" font-size="14.00">MoE Gate/Router</text>
<text text-anchor="middle" x="395" y="-5218.08" font-family="Arial" font-size="14.00">EP Rank 3</text>
<text text-anchor="middle" x="395" y="-5203.08" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="395" y="-5188.08" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, expert_ids=2]</text>
</g>
<!-- Layer_15_Expert_0_EP0_TP0_PP3 -->
<g id="node764" class="node">
<title>Layer_15_Expert_0_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="479.5,-651.29 102.5,-651.29 102.5,-583.29 479.5,-583.29 479.5,-651.29"/>
<text text-anchor="middle" x="291" y="-636.09" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="291" y="-621.09" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="291" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="291" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_A2A_Combine_PP3 -->
<g id="node797" class="node">
<title>Layer_15_A2A_Combine_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6413" cy="-499.2" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6413" y="-518" font-family="Arial" font-size="14.00">All&#45;to&#45;All Combine</text>
<text text-anchor="middle" x="6413" y="-503" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6413" y="-488" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6413" y="-473" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_15_Expert_0_EP0_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1197" class="edge">
<title>Layer_15_Expert_0_EP0_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M479.66,-584.08C482.45,-583.8 485.24,-583.54 488,-583.29 1052.92,-532.31 5042.05,-507.5 6136.08,-501.61"/>
<polygon fill="black" stroke="black" points="6136.46,-505.11 6146.45,-501.55 6136.43,-498.11 6136.46,-505.11"/>
</g>
<!-- Layer_15_Expert_0_EP0_TP1_PP3 -->
<g id="node765" class="node">
<title>Layer_15_Expert_0_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="874.5,-651.29 497.5,-651.29 497.5,-583.29 874.5,-583.29 874.5,-651.29"/>
<text text-anchor="middle" x="686" y="-636.09" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="686" y="-621.09" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="686" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="686" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_0_EP0_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1199" class="edge">
<title>Layer_15_Expert_0_EP0_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M874.66,-584.09C877.45,-583.8 880.24,-583.54 883,-583.29 1407.13,-535.72 5089.52,-508.69 6136.15,-501.91"/>
<polygon fill="black" stroke="black" points="6136.47,-505.41 6146.45,-501.84 6136.42,-498.41 6136.47,-505.41"/>
</g>
<!-- Layer_15_Expert_1_EP0_TP0_PP3 -->
<g id="node766" class="node">
<title>Layer_15_Expert_1_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="1269.5,-651.29 892.5,-651.29 892.5,-583.29 1269.5,-583.29 1269.5,-651.29"/>
<text text-anchor="middle" x="1081" y="-636.09" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1081" y="-621.09" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="1081" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1081" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_1_EP0_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1201" class="edge">
<title>Layer_15_Expert_1_EP0_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M1269.66,-584.09C1272.45,-583.81 1275.24,-583.54 1278,-583.29 1761.5,-539.13 5139.63,-509.97 6136.62,-502.25"/>
<polygon fill="black" stroke="black" points="6136.82,-505.75 6146.79,-502.17 6136.77,-498.75 6136.82,-505.75"/>
</g>
<!-- Layer_15_Expert_1_EP0_TP1_PP3 -->
<g id="node767" class="node">
<title>Layer_15_Expert_1_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="1664.5,-651.29 1287.5,-651.29 1287.5,-583.29 1664.5,-583.29 1664.5,-651.29"/>
<text text-anchor="middle" x="1476" y="-636.09" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1476" y="-621.09" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="1476" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1476" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_1_EP0_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1203" class="edge">
<title>Layer_15_Expert_1_EP0_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M1664.66,-584.1C1667.46,-583.81 1670.24,-583.54 1673,-583.29 2547.67,-502.81 5258.89,-498.77 6136.11,-499.66"/>
<polygon fill="black" stroke="black" points="6136.34,-503.16 6146.34,-499.67 6136.35,-496.16 6136.34,-503.16"/>
</g>
<!-- Layer_15_Expert_2_EP0_TP0_PP3 -->
<g id="node768" class="node">
<title>Layer_15_Expert_2_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2059.5,-651.29 1682.5,-651.29 1682.5,-583.29 2059.5,-583.29 2059.5,-651.29"/>
<text text-anchor="middle" x="1871" y="-636.09" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1871" y="-621.09" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="1871" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="1871" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_2_EP0_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1205" class="edge">
<title>Layer_15_Expert_2_EP0_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2059.66,-584.1C2062.46,-583.82 2065.24,-583.54 2068,-583.29 2862.19,-509.58 5308.33,-500.95 6135.98,-500.18"/>
<polygon fill="black" stroke="black" points="6136.25,-503.68 6146.25,-500.17 6136.25,-496.68 6136.25,-503.68"/>
</g>
<!-- Layer_15_Expert_2_EP0_TP1_PP3 -->
<g id="node769" class="node">
<title>Layer_15_Expert_2_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2454.5,-651.29 2077.5,-651.29 2077.5,-583.29 2454.5,-583.29 2454.5,-651.29"/>
<text text-anchor="middle" x="2266" y="-636.09" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2266" y="-621.09" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="2266" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2266" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_2_EP0_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1207" class="edge">
<title>Layer_15_Expert_2_EP0_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2454.66,-584.11C2457.46,-583.82 2460.24,-583.55 2463,-583.29 3177.13,-516.32 5360.7,-503.32 6136.18,-500.8"/>
<polygon fill="black" stroke="black" points="6136.38,-504.3 6146.37,-500.77 6136.36,-497.3 6136.38,-504.3"/>
</g>
<!-- Layer_15_Expert_3_EP0_TP0_PP3 -->
<g id="node770" class="node">
<title>Layer_15_Expert_3_EP0_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="2849.5,-651.29 2472.5,-651.29 2472.5,-583.29 2849.5,-583.29 2849.5,-651.29"/>
<text text-anchor="middle" x="2661" y="-636.09" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2661" y="-621.09" font-family="Arial" font-size="14.00">EP 0, TP 0</text>
<text text-anchor="middle" x="2661" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="2661" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_3_EP0_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1209" class="edge">
<title>Layer_15_Expert_3_EP0_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M2849.66,-584.12C2852.46,-583.83 2855.24,-583.55 2858,-583.29 3492.41,-523.05 5415.59,-505.93 6136.31,-501.57"/>
<polygon fill="black" stroke="black" points="6136.59,-505.06 6146.57,-501.5 6136.55,-498.06 6136.59,-505.06"/>
</g>
<!-- Layer_15_Expert_3_EP0_TP1_PP3 -->
<g id="node771" class="node">
<title>Layer_15_Expert_3_EP0_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="3244.5,-651.29 2867.5,-651.29 2867.5,-583.29 3244.5,-583.29 3244.5,-651.29"/>
<text text-anchor="middle" x="3056" y="-636.09" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3056" y="-621.09" font-family="Arial" font-size="14.00">EP 0, TP 1</text>
<text text-anchor="middle" x="3056" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3056" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_3_EP0_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1211" class="edge">
<title>Layer_15_Expert_3_EP0_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M3244.66,-584.13C3247.46,-583.83 3250.24,-583.55 3253,-583.29 3808.18,-529.75 5473.93,-508.85 6136.64,-502.51"/>
<polygon fill="black" stroke="black" points="6136.84,-506.01 6146.81,-502.42 6136.78,-499.01 6136.84,-506.01"/>
</g>
<!-- Layer_15_Expert_4_EP1_TP0_PP3 -->
<g id="node772" class="node">
<title>Layer_15_Expert_4_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="3639.5,-651.29 3262.5,-651.29 3262.5,-583.29 3639.5,-583.29 3639.5,-651.29"/>
<text text-anchor="middle" x="3451" y="-636.09" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3451" y="-621.09" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="3451" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3451" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_4_EP1_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1213" class="edge">
<title>Layer_15_Expert_4_EP1_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M3639.66,-584.15C3642.46,-583.84 3645.24,-583.56 3648,-583.29 4124.53,-536.43 5536.29,-512.16 6137.21,-503.72"/>
<polygon fill="black" stroke="black" points="6137.36,-507.22 6147.31,-503.58 6137.27,-500.22 6137.36,-507.22"/>
</g>
<!-- Layer_15_Expert_4_EP1_TP1_PP3 -->
<g id="node773" class="node">
<title>Layer_15_Expert_4_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4034.5,-651.29 3657.5,-651.29 3657.5,-583.29 4034.5,-583.29 4034.5,-651.29"/>
<text text-anchor="middle" x="3846" y="-636.09" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3846" y="-621.09" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="3846" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="3846" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_4_EP1_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1215" class="edge">
<title>Layer_15_Expert_4_EP1_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4034.66,-584.16C4037.46,-583.86 4040.24,-583.56 4043,-583.29 4441.57,-543.09 5603.67,-516 6138.18,-505.31"/>
<polygon fill="black" stroke="black" points="6138.42,-508.81 6148.35,-505.11 6138.28,-501.81 6138.42,-508.81"/>
</g>
<!-- Layer_15_Expert_5_EP1_TP0_PP3 -->
<g id="node774" class="node">
<title>Layer_15_Expert_5_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4429.5,-651.29 4052.5,-651.29 4052.5,-583.29 4429.5,-583.29 4429.5,-651.29"/>
<text text-anchor="middle" x="4241" y="-636.09" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4241" y="-621.09" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="4241" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4241" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_5_EP1_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1217" class="edge">
<title>Layer_15_Expert_5_EP1_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4429.67,-584.19C4432.46,-583.88 4435.24,-583.57 4438,-583.29 5041.5,-520.29 5753.46,-504.68 6136.19,-501.05"/>
<polygon fill="black" stroke="black" points="6136.33,-504.55 6146.3,-500.96 6136.26,-497.55 6136.33,-504.55"/>
</g>
<!-- Layer_15_Expert_5_EP1_TP1_PP3 -->
<g id="node775" class="node">
<title>Layer_15_Expert_5_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="4824.5,-651.29 4447.5,-651.29 4447.5,-583.29 4824.5,-583.29 4824.5,-651.29"/>
<text text-anchor="middle" x="4636" y="-636.09" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4636" y="-621.09" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="4636" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="4636" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_5_EP1_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1219" class="edge">
<title>Layer_15_Expert_5_EP1_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M4824.67,-584.23C4827.46,-583.9 4830.24,-583.59 4833,-583.29 5288.82,-533.29 5822.03,-513.17 6137.86,-505.22"/>
<polygon fill="black" stroke="black" points="6138.17,-508.71 6148.08,-504.96 6137.99,-501.72 6138.17,-508.71"/>
</g>
<!-- Layer_15_Expert_6_EP1_TP0_PP3 -->
<g id="node776" class="node">
<title>Layer_15_Expert_6_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="5219.5,-651.29 4842.5,-651.29 4842.5,-583.29 5219.5,-583.29 5219.5,-651.29"/>
<text text-anchor="middle" x="5031" y="-636.09" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5031" y="-621.09" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="5031" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5031" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_6_EP1_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1221" class="edge">
<title>Layer_15_Expert_6_EP1_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5219.68,-584.3C5222.47,-583.95 5225.25,-583.61 5228,-583.29 5541.45,-546.13 5903.66,-523.71 6144.29,-511.68"/>
<polygon fill="black" stroke="black" points="6144.77,-515.16 6154.59,-511.17 6144.43,-508.17 6144.77,-515.16"/>
</g>
<!-- Layer_15_Expert_6_EP1_TP1_PP3 -->
<g id="node777" class="node">
<title>Layer_15_Expert_6_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="5614.5,-651.29 5237.5,-651.29 5237.5,-583.29 5614.5,-583.29 5614.5,-651.29"/>
<text text-anchor="middle" x="5426" y="-636.09" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5426" y="-621.09" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="5426" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5426" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_6_EP1_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1223" class="edge">
<title>Layer_15_Expert_6_EP1_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5614.7,-584.44C5617.48,-584.04 5620.25,-583.66 5623,-583.29 5804.35,-558.59 6009.98,-537.17 6165.98,-522.26"/>
<polygon fill="black" stroke="black" points="6166.56,-525.73 6176.18,-521.29 6165.9,-518.76 6166.56,-525.73"/>
</g>
<!-- Layer_15_Expert_7_EP1_TP0_PP3 -->
<g id="node778" class="node">
<title>Layer_15_Expert_7_EP1_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6009.5,-651.29 5632.5,-651.29 5632.5,-583.29 6009.5,-583.29 6009.5,-651.29"/>
<text text-anchor="middle" x="5821" y="-636.09" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5821" y="-621.09" font-family="Arial" font-size="14.00">EP 1, TP 0</text>
<text text-anchor="middle" x="5821" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="5821" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_7_EP1_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1225" class="edge">
<title>Layer_15_Expert_7_EP1_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M5989.46,-583.25C6062.97,-568.84 6149.47,-551.88 6225.07,-537.05"/>
<polygon fill="black" stroke="black" points="6226.04,-540.43 6235.18,-535.07 6224.7,-533.56 6226.04,-540.43"/>
</g>
<!-- Layer_15_Expert_7_EP1_TP1_PP3 -->
<g id="node779" class="node">
<title>Layer_15_Expert_7_EP1_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6404.5,-651.29 6027.5,-651.29 6027.5,-583.29 6404.5,-583.29 6404.5,-651.29"/>
<text text-anchor="middle" x="6216" y="-636.09" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6216" y="-621.09" font-family="Arial" font-size="14.00">EP 1, TP 1</text>
<text text-anchor="middle" x="6216" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6216" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_7_EP1_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1227" class="edge">
<title>Layer_15_Expert_7_EP1_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6272.19,-583.18C6289.47,-573 6308.89,-561.55 6327.67,-550.49"/>
<polygon fill="black" stroke="black" points="6329.69,-553.36 6336.53,-545.27 6326.13,-547.33 6329.69,-553.36"/>
</g>
<!-- Layer_15_Expert_8_EP2_TP0_PP3 -->
<g id="node780" class="node">
<title>Layer_15_Expert_8_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="6799.5,-651.29 6422.5,-651.29 6422.5,-583.29 6799.5,-583.29 6799.5,-651.29"/>
<text text-anchor="middle" x="6611" y="-636.09" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6611" y="-621.09" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="6611" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6611" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_8_EP2_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1229" class="edge">
<title>Layer_15_Expert_8_EP2_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6554.53,-583.18C6537.08,-572.95 6517.46,-561.45 6498.51,-550.34"/>
<polygon fill="black" stroke="black" points="6500.26,-547.3 6489.86,-545.27 6496.72,-553.34 6500.26,-547.3"/>
</g>
<!-- Layer_15_Expert_8_EP2_TP1_PP3 -->
<g id="node781" class="node">
<title>Layer_15_Expert_8_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7194.5,-651.29 6817.5,-651.29 6817.5,-583.29 7194.5,-583.29 7194.5,-651.29"/>
<text text-anchor="middle" x="7006" y="-636.09" font-family="Arial" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7006" y="-621.09" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="7006" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7006" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_8_EP2_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1231" class="edge">
<title>Layer_15_Expert_8_EP2_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M6837.26,-583.25C6763.62,-568.84 6676.97,-551.88 6601.25,-537.05"/>
<polygon fill="black" stroke="black" points="6601.6,-533.56 6591.12,-535.07 6600.26,-540.43 6601.6,-533.56"/>
</g>
<!-- Layer_15_Expert_9_EP2_TP0_PP3 -->
<g id="node782" class="node">
<title>Layer_15_Expert_9_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7589.5,-651.29 7212.5,-651.29 7212.5,-583.29 7589.5,-583.29 7589.5,-651.29"/>
<text text-anchor="middle" x="7401" y="-636.09" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7401" y="-621.09" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="7401" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7401" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_9_EP2_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1233" class="edge">
<title>Layer_15_Expert_9_EP2_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7212.4,-584.58C7209.24,-584.14 7206.11,-583.71 7203,-583.29 7021.64,-558.66 6816.01,-537.24 6660.01,-522.32"/>
<polygon fill="black" stroke="black" points="6660.1,-518.81 6649.81,-521.34 6659.43,-525.78 6660.1,-518.81"/>
</g>
<!-- Layer_15_Expert_9_EP2_TP1_PP3 -->
<g id="node783" class="node">
<title>Layer_15_Expert_9_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="7984.5,-651.29 7607.5,-651.29 7607.5,-583.29 7984.5,-583.29 7984.5,-651.29"/>
<text text-anchor="middle" x="7796" y="-636.09" font-family="Arial" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7796" y="-621.09" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="7796" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="7796" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_9_EP2_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1235" class="edge">
<title>Layer_15_Expert_9_EP2_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M7607.42,-584.43C7604.26,-584.04 7601.11,-583.65 7598,-583.29 7284.53,-546.26 6922.33,-523.81 6681.7,-511.74"/>
<polygon fill="black" stroke="black" points="6681.57,-508.23 6671.41,-511.23 6681.22,-515.22 6681.57,-508.23"/>
</g>
<!-- Layer_15_Expert_10_EP2_TP0_PP3 -->
<g id="node784" class="node">
<title>Layer_15_Expert_10_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8379.5,-651.29 8002.5,-651.29 8002.5,-583.29 8379.5,-583.29 8379.5,-651.29"/>
<text text-anchor="middle" x="8191" y="-636.09" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="8191" y="-621.09" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="8191" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8191" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_10_EP2_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1237" class="edge">
<title>Layer_15_Expert_10_EP2_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8002.42,-584.36C7999.26,-583.98 7996.12,-583.63 7993,-583.29 7537.16,-533.48 7003.96,-513.3 6688.13,-505.29"/>
<polygon fill="black" stroke="black" points="6688,-501.78 6677.92,-505.03 6687.83,-508.78 6688,-501.78"/>
</g>
<!-- Layer_15_Expert_10_EP2_TP1_PP3 -->
<g id="node785" class="node">
<title>Layer_15_Expert_10_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="8774.5,-651.29 8397.5,-651.29 8397.5,-583.29 8774.5,-583.29 8774.5,-651.29"/>
<text text-anchor="middle" x="8586" y="-636.09" font-family="Arial" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="8586" y="-621.09" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="8586" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8586" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_10_EP2_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1239" class="edge">
<title>Layer_15_Expert_10_EP2_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8397.43,-584.31C8394.26,-583.95 8391.12,-583.61 8388,-583.29 7784.48,-520.54 7072.53,-504.83 6689.8,-501.12"/>
<polygon fill="black" stroke="black" points="6689.73,-497.62 6679.7,-501.03 6689.66,-504.62 6689.73,-497.62"/>
</g>
<!-- Layer_15_Expert_11_EP2_TP0_PP3 -->
<g id="node786" class="node">
<title>Layer_15_Expert_11_EP2_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9169.5,-651.29 8792.5,-651.29 8792.5,-583.29 9169.5,-583.29 9169.5,-651.29"/>
<text text-anchor="middle" x="8981" y="-636.09" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="8981" y="-621.09" font-family="Arial" font-size="14.00">EP 2, TP 0</text>
<text text-anchor="middle" x="8981" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="8981" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_11_EP2_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1241" class="edge">
<title>Layer_15_Expert_11_EP2_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M8792.43,-584.28C8789.27,-583.93 8786.12,-583.6 8783,-583.29 8384.41,-543.26 7222.32,-516.08 6687.81,-505.34"/>
<polygon fill="black" stroke="black" points="6687.72,-501.84 6677.65,-505.14 6687.57,-508.84 6687.72,-501.84"/>
</g>
<!-- Layer_15_Expert_11_EP2_TP1_PP3 -->
<g id="node787" class="node">
<title>Layer_15_Expert_11_EP2_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9564.5,-651.29 9187.5,-651.29 9187.5,-583.29 9564.5,-583.29 9564.5,-651.29"/>
<text text-anchor="middle" x="9376" y="-636.09" font-family="Arial" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="9376" y="-621.09" font-family="Arial" font-size="14.00">EP 2, TP 1</text>
<text text-anchor="middle" x="9376" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9376" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_11_EP2_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1243" class="edge">
<title>Layer_15_Expert_11_EP2_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9187.43,-584.26C9184.27,-583.92 9181.12,-583.59 9178,-583.29 8701.46,-536.63 7289.7,-512.25 6688.78,-503.75"/>
<polygon fill="black" stroke="black" points="6688.73,-500.25 6678.68,-503.61 6688.63,-507.25 6688.73,-500.25"/>
</g>
<!-- Layer_15_Expert_12_EP3_TP0_PP3 -->
<g id="node788" class="node">
<title>Layer_15_Expert_12_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="9959.5,-651.29 9582.5,-651.29 9582.5,-583.29 9959.5,-583.29 9959.5,-651.29"/>
<text text-anchor="middle" x="9771" y="-636.09" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="9771" y="-621.09" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="9771" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="9771" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_12_EP3_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1245" class="edge">
<title>Layer_15_Expert_12_EP3_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9582.44,-584.24C9579.27,-583.91 9576.12,-583.59 9573,-583.29 9017.79,-529.98 7352.06,-508.95 6689.35,-502.54"/>
<polygon fill="black" stroke="black" points="6689.22,-499.04 6679.19,-502.44 6689.15,-506.04 6689.22,-499.04"/>
</g>
<!-- Layer_15_Expert_12_EP3_TP1_PP3 -->
<g id="node789" class="node">
<title>Layer_15_Expert_12_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10354.5,-651.29 9977.5,-651.29 9977.5,-583.29 10354.5,-583.29 10354.5,-651.29"/>
<text text-anchor="middle" x="10166" y="-636.09" font-family="Arial" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10166" y="-621.09" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="10166" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10166" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_12_EP3_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1247" class="edge">
<title>Layer_15_Expert_12_EP3_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M9977.44,-584.23C9974.27,-583.9 9971.12,-583.58 9968,-583.29 9333.56,-523.31 7410.4,-506.03 6689.69,-501.59"/>
<polygon fill="black" stroke="black" points="6689.45,-498.09 6679.43,-501.53 6689.41,-505.09 6689.45,-498.09"/>
</g>
<!-- Layer_15_Expert_13_EP3_TP0_PP3 -->
<g id="node790" class="node">
<title>Layer_15_Expert_13_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="10749.5,-651.29 10372.5,-651.29 10372.5,-583.29 10749.5,-583.29 10749.5,-651.29"/>
<text text-anchor="middle" x="10561" y="-636.09" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10561" y="-621.09" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="10561" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10561" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_13_EP3_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1249" class="edge">
<title>Layer_15_Expert_13_EP3_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10372.44,-584.22C10369.27,-583.89 10366.12,-583.58 10363,-583.29 9648.85,-516.61 7465.29,-503.43 6689.82,-500.83"/>
<polygon fill="black" stroke="black" points="6689.64,-497.33 6679.63,-500.8 6689.62,-504.33 6689.64,-497.33"/>
</g>
<!-- Layer_15_Expert_13_EP3_TP1_PP3 -->
<g id="node791" class="node">
<title>Layer_15_Expert_13_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11144.5,-651.29 10767.5,-651.29 10767.5,-583.29 11144.5,-583.29 11144.5,-651.29"/>
<text text-anchor="middle" x="10956" y="-636.09" font-family="Arial" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10956" y="-621.09" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="10956" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="10956" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_13_EP3_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1251" class="edge">
<title>Layer_15_Expert_13_EP3_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M10767.44,-584.21C10764.27,-583.88 10761.12,-583.57 10758,-583.29 9963.78,-509.9 7517.66,-501.06 6690.01,-500.21"/>
<polygon fill="black" stroke="black" points="6689.75,-496.71 6679.75,-500.2 6689.75,-503.71 6689.75,-496.71"/>
</g>
<!-- Layer_15_Expert_14_EP3_TP0_PP3 -->
<g id="node792" class="node">
<title>Layer_15_Expert_14_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11539.5,-651.29 11162.5,-651.29 11162.5,-583.29 11539.5,-583.29 11539.5,-651.29"/>
<text text-anchor="middle" x="11351" y="-636.09" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11351" y="-621.09" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="11351" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11351" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_14_EP3_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1253" class="edge">
<title>Layer_15_Expert_14_EP3_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11162.44,-584.2C11159.27,-583.88 11156.12,-583.57 11153,-583.29 10278.29,-503.17 7567.1,-498.89 6689.89,-499.69"/>
<polygon fill="black" stroke="black" points="6689.65,-496.19 6679.65,-499.7 6689.66,-503.19 6689.65,-496.19"/>
</g>
<!-- Layer_15_Expert_14_EP3_TP1_PP3 -->
<g id="node793" class="node">
<title>Layer_15_Expert_14_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="11934.5,-651.29 11557.5,-651.29 11557.5,-583.29 11934.5,-583.29 11934.5,-651.29"/>
<text text-anchor="middle" x="11746" y="-636.09" font-family="Arial" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11746" y="-621.09" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="11746" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="11746" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_14_EP3_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1255" class="edge">
<title>Layer_15_Expert_14_EP3_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11557.44,-584.2C11554.27,-583.88 11551.12,-583.57 11548,-583.29 11064.48,-539.33 7686.37,-510.03 6689.38,-502.26"/>
<polygon fill="black" stroke="black" points="6689.23,-498.76 6679.21,-502.18 6689.18,-505.76 6689.23,-498.76"/>
</g>
<!-- Layer_15_Expert_15_EP3_TP0_PP3 -->
<g id="node794" class="node">
<title>Layer_15_Expert_15_EP3_TP0_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12329.5,-651.29 11952.5,-651.29 11952.5,-583.29 12329.5,-583.29 12329.5,-651.29"/>
<text text-anchor="middle" x="12141" y="-636.09" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12141" y="-621.09" font-family="Arial" font-size="14.00">EP 3, TP 0</text>
<text text-anchor="middle" x="12141" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12141" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_15_EP3_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1257" class="edge">
<title>Layer_15_Expert_15_EP3_TP0_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M11952.44,-584.19C11949.27,-583.87 11946.12,-583.57 11943,-583.29 11418.85,-535.94 7736.47,-508.75 6689.85,-501.92"/>
<polygon fill="black" stroke="black" points="6689.58,-498.42 6679.55,-501.85 6689.53,-505.42 6689.58,-498.42"/>
</g>
<!-- Layer_15_Expert_15_EP3_TP1_PP3 -->
<g id="node795" class="node">
<title>Layer_15_Expert_15_EP3_TP1_PP3</title>
<polygon fill="lightcoral" stroke="black" points="12724.5,-651.29 12347.5,-651.29 12347.5,-583.29 12724.5,-583.29 12724.5,-651.29"/>
<text text-anchor="middle" x="12536" y="-636.09" font-family="Arial" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="12536" y="-621.09" font-family="Arial" font-size="14.00">EP 3, TP 1</text>
<text text-anchor="middle" x="12536" y="-606.09" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="12536" y="-591.09" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_Expert_15_EP3_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3 -->
<g id="edge1259" class="edge">
<title>Layer_15_Expert_15_EP3_TP1_PP3&#45;&gt;Layer_15_A2A_Combine_PP3</title>
<path fill="none" stroke="black" d="M12347.44,-584.19C12344.27,-583.87 12341.12,-583.57 12338,-583.29 11773.05,-532.54 7783.95,-507.57 6689.92,-501.62"/>
<polygon fill="black" stroke="black" points="6689.57,-498.12 6679.55,-501.57 6689.53,-505.12 6689.57,-498.12"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_0_EP0_TP0_PP3 -->
<g id="edge1196" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_0_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M5970.77,-732.9C4918.97,-726.76 1081.89,-701.21 489.79,-651.37"/>
<polygon fill="black" stroke="black" points="489.92,-647.87 479.66,-650.49 489.31,-654.84 489.92,-647.87"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_0_EP0_TP1_PP3 -->
<g id="edge1198" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_0_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M5970.78,-732.59C4966.33,-725.56 1435.95,-697.84 884.85,-651.38"/>
<polygon fill="black" stroke="black" points="884.92,-647.87 874.66,-650.48 884.31,-654.84 884.92,-647.87"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_1_EP0_TP0_PP3 -->
<g id="edge1200" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_1_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M5970.88,-732.24C5015.63,-724.27 1789.57,-694.49 1279.8,-651.37"/>
<polygon fill="black" stroke="black" points="1279.93,-647.87 1269.66,-650.48 1279.31,-654.84 1279.93,-647.87"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_1_EP0_TP1_PP3 -->
<g id="edge1202" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_1_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M5970.31,-734.69C5128.87,-734.9 2535.52,-729.1 1674.7,-651.39"/>
<polygon fill="black" stroke="black" points="1674.93,-647.9 1664.66,-650.47 1674.3,-654.87 1674.93,-647.9"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_2_EP0_TP0_PP3 -->
<g id="edge1204" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_2_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M5970.22,-734.15C5178.62,-732.69 2850.27,-722.38 2069.9,-651.41"/>
<polygon fill="black" stroke="black" points="2069.94,-647.9 2059.66,-650.47 2069.29,-654.87 2069.94,-647.9"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_2_EP0_TP1_PP3 -->
<g id="edge1206" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_2_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M5970.36,-733.49C5231.19,-730.27 3164.94,-715.69 2464.87,-651.41"/>
<polygon fill="black" stroke="black" points="2464.94,-647.9 2454.66,-650.46 2464.29,-654.87 2464.94,-647.9"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_3_EP0_TP0_PP3 -->
<g id="edge1208" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_3_EP0_TP0_PP3</title>
<path fill="none" stroke="black" d="M5970.76,-732.69C5287.08,-727.6 3480.48,-709.03 2860.06,-651.43"/>
<polygon fill="black" stroke="black" points="2859.94,-647.9 2849.66,-650.45 2859.29,-654.87 2859.94,-647.9"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_3_EP0_TP1_PP3 -->
<g id="edge1210" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_3_EP0_TP1_PP3</title>
<path fill="none" stroke="black" d="M5970.97,-731.68C5345.77,-724.59 3795.68,-702.39 3254.9,-651.42"/>
<polygon fill="black" stroke="black" points="3254.95,-647.91 3244.66,-650.44 3254.28,-654.87 3254.95,-647.91"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_4_EP1_TP0_PP3 -->
<g id="edge1212" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_4_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M5971.86,-730.37C5409.5,-721.15 4111.55,-695.81 3649.75,-651.41"/>
<polygon fill="black" stroke="black" points="3649.96,-647.91 3639.66,-650.42 3649.27,-654.88 3649.96,-647.91"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_4_EP1_TP1_PP3 -->
<g id="edge1214" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_4_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M5970.27,-735.26C5558.49,-734.17 4743.32,-722.22 4044.68,-651.42"/>
<polygon fill="black" stroke="black" points="4044.97,-647.93 4034.66,-650.4 4044.26,-654.89 4044.97,-647.93"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_5_EP1_TP0_PP3 -->
<g id="edge1216" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_5_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M5971.05,-732.03C5621.46,-726.7 4988.31,-709.26 4439.76,-651.43"/>
<polygon fill="black" stroke="black" points="4439.98,-647.94 4429.67,-650.36 4439.24,-654.9 4439.98,-647.94"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_5_EP1_TP1_PP3 -->
<g id="edge1218" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_5_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M5974.28,-727.21C5694.01,-717.62 5237.06,-696.44 4834.76,-651.45"/>
<polygon fill="black" stroke="black" points="4835,-647.95 4824.67,-650.31 4834.22,-654.91 4835,-647.95"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_6_EP1_TP0_PP3 -->
<g id="edge1220" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_6_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M5985.27,-719.52C5783.38,-706.21 5492.65,-683.93 5229.81,-651.48"/>
<polygon fill="black" stroke="black" points="5230.04,-647.98 5219.68,-650.23 5229.18,-654.93 5230.04,-647.98"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_6_EP1_TP1_PP3 -->
<g id="edge1222" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_6_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6021.87,-706.94C5906.72,-691.85 5762.23,-672.25 5624.61,-651.52"/>
<polygon fill="black" stroke="black" points="5625.12,-648.06 5614.71,-650.02 5624.08,-654.98 5625.12,-648.06"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_7_EP1_TP0_PP3 -->
<g id="edge1224" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_7_EP1_TP0_PP3</title>
<path fill="none" stroke="black" d="M6094.71,-694.66C6047.48,-681.49 5995.22,-666.9 5949.12,-654.04"/>
<polygon fill="black" stroke="black" points="5949.96,-650.64 5939.38,-651.32 5948.08,-657.38 5949.96,-650.64"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_7_EP1_TP1_PP3 -->
<g id="edge1226" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_7_EP1_TP1_PP3</title>
<path fill="none" stroke="black" d="M6228.46,-687.15C6226.92,-678.68 6225.33,-669.88 6223.82,-661.52"/>
<polygon fill="black" stroke="black" points="6227.25,-660.81 6222.02,-651.59 6220.36,-662.05 6227.25,-660.81"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_8_EP2_TP0_PP3 -->
<g id="edge1228" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_8_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6368.6,-693.52C6409.7,-680.77 6454.74,-666.79 6494.72,-654.38"/>
<polygon fill="black" stroke="black" points="6495.98,-657.65 6504.5,-651.34 6493.91,-650.96 6495.98,-657.65"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_8_EP2_TP1_PP3 -->
<g id="edge1230" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_8_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6444.64,-705.21C6550.26,-690.12 6680.92,-671.05 6807.49,-651.36"/>
<polygon fill="black" stroke="black" points="6808.03,-654.81 6817.37,-649.82 6806.95,-647.9 6808.03,-654.81"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_9_EP2_TP0_PP3 -->
<g id="edge1232" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_9_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6486.5,-718.37C6679.32,-704.71 6953,-682.49 7202.42,-651.32"/>
<polygon fill="black" stroke="black" points="7202.92,-654.79 7212.41,-650.07 7202.05,-647.84 7202.92,-654.79"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_9_EP2_TP1_PP3 -->
<g id="edge1234" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_9_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6499.25,-726.47C6771.49,-716.38 7209.68,-694.89 7597.41,-651.31"/>
<polygon fill="black" stroke="black" points="7597.88,-654.78 7607.42,-650.18 7597.09,-647.82 7597.88,-654.78"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_10_EP2_TP0_PP3 -->
<g id="edge1236" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_10_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6502.89,-731.53C6845.31,-725.66 7458.8,-707.63 7992.21,-651.32"/>
<polygon fill="black" stroke="black" points="7992.85,-654.77 8002.43,-650.24 7992.11,-647.81 7992.85,-654.77"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_10_EP2_TP1_PP3 -->
<g id="edge1238" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_10_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6503.93,-734.89C6909.3,-733.25 7704.25,-720.51 8387.38,-651.3"/>
<polygon fill="black" stroke="black" points="8387.84,-654.77 8397.43,-650.28 8387.13,-647.81 8387.84,-654.77"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_11_EP2_TP0_PP3 -->
<g id="edge1240" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_11_EP2_TP0_PP3</title>
<path fill="none" stroke="black" d="M6502.22,-730.17C7057.5,-720.66 8327.76,-694.92 8782.18,-651.3"/>
<polygon fill="black" stroke="black" points="8782.82,-654.76 8792.43,-650.3 8782.14,-647.79 8782.82,-654.76"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_11_EP2_TP1_PP3 -->
<g id="edge1242" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_11_EP2_TP1_PP3</title>
<path fill="none" stroke="black" d="M6502.94,-731.52C7121.54,-724.15 8644.22,-701.46 9177.34,-651.29"/>
<polygon fill="black" stroke="black" points="9177.81,-654.76 9187.44,-650.32 9177.15,-647.79 9177.81,-654.76"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_12_EP3_TP0_PP3 -->
<g id="edge1244" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_12_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M6503.25,-732.56C7180.81,-727.19 8959.47,-708.06 9572.17,-651.3"/>
<polygon fill="black" stroke="black" points="9572.81,-654.76 9582.44,-650.34 9572.15,-647.79 9572.81,-654.76"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_12_EP3_TP1_PP3 -->
<g id="edge1246" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_12_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M6503.57,-733.39C7236.88,-729.89 9274.99,-714.68 9967.34,-651.28"/>
<polygon fill="black" stroke="black" points="9967.8,-654.76 9977.44,-650.35 9967.16,-647.79 9967.8,-654.76"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_13_EP3_TP0_PP3 -->
<g id="edge1248" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_13_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M6503.83,-734.05C7289.93,-732.33 9589.71,-721.34 10362.3,-651.29"/>
<polygon fill="black" stroke="black" points="10362.8,-654.76 10372.44,-650.36 10362.16,-647.79 10362.8,-654.76"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_13_EP3_TP1_PP3 -->
<g id="edge1250" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_13_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M6503.75,-734.61C7339.86,-734.55 9903.84,-728.03 10757.17,-651.3"/>
<polygon fill="black" stroke="black" points="10757.8,-654.76 10767.44,-650.36 10757.16,-647.78 10757.8,-654.76"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_14_EP3_TP0_PP3 -->
<g id="edge1252" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_14_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M6503.8,-735.08C7387.95,-736.6 10218.09,-734.73 11152.22,-651.29"/>
<polygon fill="black" stroke="black" points="11152.8,-654.76 11162.44,-650.37 11152.17,-647.78 11152.8,-654.76"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_14_EP3_TP1_PP3 -->
<g id="edge1254" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_14_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M6503.23,-732.54C7502.48,-725.37 10999.89,-697.27 11547.31,-651.26"/>
<polygon fill="black" stroke="black" points="11547.78,-654.73 11557.44,-650.38 11547.17,-647.76 11547.78,-654.73"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_15_EP3_TP0_PP3 -->
<g id="edge1256" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_15_EP3_TP0_PP3</title>
<path fill="none" stroke="black" d="M6503.47,-732.85C7550.59,-726.57 11353.98,-700.61 11942.37,-651.26"/>
<polygon fill="black" stroke="black" points="11942.78,-654.73 11952.44,-650.38 11942.18,-647.76 11942.78,-654.73"/>
</g>
<!-- Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_15_EP3_TP1_PP3 -->
<g id="edge1258" class="edge">
<title>Layer_15_A2A_Dispatch_PP3&#45;&gt;Layer_15_Expert_15_EP3_TP1_PP3</title>
<path fill="none" stroke="black" d="M6503.52,-733.12C7596.44,-727.69 11706.5,-703.98 12337.09,-651.28"/>
<polygon fill="black" stroke="black" points="12337.78,-654.73 12347.44,-650.38 12337.18,-647.76 12337.78,-654.73"/>
</g>
<!-- Layer_15_MLP_Out_TP0_PP3 -->
<g id="node798" class="node">
<title>Layer_15_MLP_Out_TP0_PP3</title>
<polygon fill="lightblue" stroke="black" points="6403.5,-415.12 6026.5,-415.12 6026.5,-347.12 6403.5,-347.12 6403.5,-415.12"/>
<text text-anchor="middle" x="6215" y="-399.92" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="6215" y="-384.92" font-family="Arial" font-size="14.00">TP Rank 0</text>
<text text-anchor="middle" x="6215" y="-369.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6215" y="-354.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_A2A_Combine_PP3&#45;&gt;Layer_15_MLP_Out_TP0_PP3 -->
<g id="edge1260" class="edge">
<title>Layer_15_A2A_Combine_PP3&#45;&gt;Layer_15_MLP_Out_TP0_PP3</title>
<path fill="none" stroke="black" d="M6336.16,-453.16C6317.67,-442.31 6298.08,-430.83 6280.18,-420.33"/>
<polygon fill="black" stroke="black" points="6281.93,-417.3 6271.53,-415.26 6278.39,-423.34 6281.93,-417.3"/>
</g>
<!-- Layer_15_MLP_Out_TP1_PP3 -->
<g id="node799" class="node">
<title>Layer_15_MLP_Out_TP1_PP3</title>
<polygon fill="lightblue" stroke="black" points="6798.5,-415.12 6421.5,-415.12 6421.5,-347.12 6798.5,-347.12 6798.5,-415.12"/>
<text text-anchor="middle" x="6610" y="-399.92" font-family="Arial" font-size="14.00">MLP Output Proj</text>
<text text-anchor="middle" x="6610" y="-384.92" font-family="Arial" font-size="14.00">TP Rank 1</text>
<text text-anchor="middle" x="6610" y="-369.92" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6610" y="-354.92" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=256]</text>
</g>
<!-- Layer_15_A2A_Combine_PP3&#45;&gt;Layer_15_MLP_Out_TP1_PP3 -->
<g id="edge1262" class="edge">
<title>Layer_15_A2A_Combine_PP3&#45;&gt;Layer_15_MLP_Out_TP1_PP3</title>
<path fill="none" stroke="black" d="M6489.73,-452.99C6507.95,-442.26 6527.21,-430.91 6544.85,-420.51"/>
<polygon fill="black" stroke="black" points="6547.08,-423.26 6553.91,-415.17 6543.52,-417.23 6547.08,-423.26"/>
</g>
<!-- Layer_15_MLP_AllReduce_PP3 -->
<g id="node800" class="node">
<title>Layer_15_MLP_AllReduce_PP3</title>
<ellipse fill="yellow" stroke="black" cx="6412" cy="-263.04" rx="266.66" ry="48.17"/>
<text text-anchor="middle" x="6412" y="-281.84" font-family="Arial" font-size="14.00">All&#45;Reduce MLP Output</text>
<text text-anchor="middle" x="6412" y="-266.84" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6412" y="-251.84" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6412" y="-236.84" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_15_MLP_Out_TP0_PP3&#45;&gt;Layer_15_MLP_AllReduce_PP3 -->
<g id="edge1261" class="edge">
<title>Layer_15_MLP_Out_TP0_PP3&#45;&gt;Layer_15_MLP_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6271.19,-347.01C6288.47,-336.83 6307.89,-325.38 6326.67,-314.32"/>
<polygon fill="black" stroke="black" points="6328.69,-317.19 6335.53,-309.1 6325.13,-311.16 6328.69,-317.19"/>
</g>
<!-- Layer_15_MLP_Out_TP1_PP3&#45;&gt;Layer_15_MLP_AllReduce_PP3 -->
<g id="edge1263" class="edge">
<title>Layer_15_MLP_Out_TP1_PP3&#45;&gt;Layer_15_MLP_AllReduce_PP3</title>
<path fill="none" stroke="black" d="M6553.53,-347.01C6536.08,-336.78 6516.46,-325.28 6497.51,-314.17"/>
<polygon fill="black" stroke="black" points="6499.26,-311.14 6488.86,-309.1 6495.72,-317.18 6499.26,-311.14"/>
</g>
<!-- Layer_15_LayerNorm_PP3 -->
<g id="node801" class="node">
<title>Layer_15_LayerNorm_PP3</title>
<polygon fill="lightgreen" stroke="black" points="6600.5,-178.95 6223.5,-178.95 6223.5,-110.95 6600.5,-110.95 6600.5,-178.95"/>
<text text-anchor="middle" x="6412" y="-163.75" font-family="Arial" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6412" y="-148.75" font-family="Arial" font-size="14.00">PP Stage 3</text>
<text text-anchor="middle" x="6412" y="-133.75" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6412" y="-118.75" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_15_MLP_AllReduce_PP3&#45;&gt;Layer_15_LayerNorm_PP3 -->
<g id="edge1264" class="edge">
<title>Layer_15_MLP_AllReduce_PP3&#45;&gt;Layer_15_LayerNorm_PP3</title>
<path fill="none" stroke="black" d="M6412,-214.82C6412,-206.44 6412,-197.74 6412,-189.46"/>
<polygon fill="black" stroke="black" points="6415.5,-189.26 6412,-179.26 6408.5,-189.26 6415.5,-189.26"/>
</g>
<!-- output -->
<g id="node802" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="6412" cy="-37.48" rx="266.66" ry="37.45"/>
<text text-anchor="middle" x="6412" y="-48.78" font-family="Arial" font-size="14.00">Output</text>
<text text-anchor="middle" x="6412" y="-33.78" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
<text text-anchor="middle" x="6412" y="-18.78" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10240, hidden_dim=512]</text>
</g>
<!-- Layer_15_LayerNorm_PP3&#45;&gt;output -->
<g id="edge1265" class="edge">
<title>Layer_15_LayerNorm_PP3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6412,-110.87C6412,-102.71 6412,-93.81 6412,-85.13"/>
<polygon fill="black" stroke="black" points="6415.5,-85.11 6412,-75.11 6408.5,-85.11 6415.5,-85.11"/>
</g>
</g>
</svg>
