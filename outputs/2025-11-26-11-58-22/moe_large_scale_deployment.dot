digraph MoE_Large_Scale_Deployment {
    rankdir=TB;
    bgcolor="#f8f9fa";
    node [shape=record, style=rounded, fontname="Arial"];
    edge [fontname="Arial", fontsize=10];
    
    // Graph metadata
    label="Large-Scale Cross-Node Expert Parallelism DAG\n61-Layer MoE Transformer (3 Dense + 58 MoE)\n3,715 GPUs across 488 Nodes\nOne Expert per GPU Strategy";
    labelloc=t;
    fontsize=16;
    fontname="Arial Bold";
    
    // Define node styles
    stylesheet=""
    
    // Input node
    input [shape=ellipse, style=filled, fillcolor="#e3f2fd", 
           label="Input\nInput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: Host"];
    
    
    // Dense Layer 0
    dense_0_mha_q [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 0 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3712 (Node 464, GPU 0)"];
    
    dense_0_mha_k [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 0 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3712 (Node 464, GPU 0)"];
    
    dense_0_mha_v [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 0 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3712 (Node 464, GPU 0)"];
    
    dense_0_mha_attn [shape=rectangle, style=filled, fillcolor="#fff3e0",
                              label="Dense Layer 0 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3712 (Node 464, GPU 0)"];
    
    dense_0_mha_out [shape=rectangle, style=filled, fillcolor="#fff3e0",
                             label="Dense Layer 0 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3712 (Node 464, GPU 0)"];
    
    dense_0_ffn [shape=rectangle, style=filled, fillcolor="#fff3e0",
                         label="Dense Layer 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3712 (Node 464, GPU 0)"];
    
    dense_0_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="Dense Layer 0 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3712 (Node 464, GPU 0)"];
    
    // Dense Layer 1
    dense_1_mha_q [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 1 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3713 (Node 464, GPU 1)"];
    
    dense_1_mha_k [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 1 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3713 (Node 464, GPU 1)"];
    
    dense_1_mha_v [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 1 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3713 (Node 464, GPU 1)"];
    
    dense_1_mha_attn [shape=rectangle, style=filled, fillcolor="#fff3e0",
                              label="Dense Layer 1 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3713 (Node 464, GPU 1)"];
    
    dense_1_mha_out [shape=rectangle, style=filled, fillcolor="#fff3e0",
                             label="Dense Layer 1 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3713 (Node 464, GPU 1)"];
    
    dense_1_ffn [shape=rectangle, style=filled, fillcolor="#fff3e0",
                         label="Dense Layer 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3713 (Node 464, GPU 1)"];
    
    dense_1_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="Dense Layer 1 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3713 (Node 464, GPU 1)"];
    
    // Dense Layer 2
    dense_2_mha_q [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 2 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3714 (Node 464, GPU 2)"];
    
    dense_2_mha_k [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 2 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3714 (Node 464, GPU 2)"];
    
    dense_2_mha_v [shape=rectangle, style=filled, fillcolor="#fff3e0",
                           label="Dense Layer 2 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3714 (Node 464, GPU 2)"];
    
    dense_2_mha_attn [shape=rectangle, style=filled, fillcolor="#fff3e0",
                              label="Dense Layer 2 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3714 (Node 464, GPU 2)"];
    
    dense_2_mha_out [shape=rectangle, style=filled, fillcolor="#fff3e0",
                             label="Dense Layer 2 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3714 (Node 464, GPU 2)"];
    
    dense_2_ffn [shape=rectangle, style=filled, fillcolor="#fff3e0",
                         label="Dense Layer 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3714 (Node 464, GPU 2)"];
    
    dense_2_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="Dense Layer 2 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3714 (Node 464, GPU 2)"];
    
    // MoE Layer 3 - MHA components
    moe_3_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 3 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 0 (Node 0, GPU 0)"];
    
    moe_3_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 3 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 0 (Node 0, GPU 0)"];
    
    moe_3_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 3 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 0 (Node 0, GPU 0)"];
    
    moe_3_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 3 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 0 (Node 0, GPU 0)"];
    
    moe_3_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 3 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 0 (Node 0, GPU 0)"];
    
    moe_3_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 3 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 0 (Node 0, GPU 0)"];
    
    moe_3_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 0 (Node 0, GPU 0)"];
    
    moe_3_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1 (Node 0, GPU 1)"];
    
    moe_3_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2 (Node 0, GPU 2)"];
    
    moe_3_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3 (Node 0, GPU 3)"];
    
    moe_3_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 4 (Node 0, GPU 4)"];
    
    moe_3_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 5 (Node 0, GPU 5)"];
    
    moe_3_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 6 (Node 0, GPU 6)"];
    
    moe_3_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 7 (Node 0, GPU 7)"];
    
    moe_3_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 8 (Node 1, GPU 0)"];
    
    moe_3_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 9 (Node 1, GPU 1)"];
    
    moe_3_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 10 (Node 1, GPU 2)"];
    
    moe_3_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 11 (Node 1, GPU 3)"];
    
    moe_3_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 12 (Node 1, GPU 4)"];
    
    moe_3_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 13 (Node 1, GPU 5)"];
    
    moe_3_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 14 (Node 1, GPU 6)"];
    
    moe_3_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 15 (Node 1, GPU 7)"];
    
    moe_3_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 16 (Node 2, GPU 0)"];
    
    moe_3_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 17 (Node 2, GPU 1)"];
    
    moe_3_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 18 (Node 2, GPU 2)"];
    
    moe_3_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 19 (Node 2, GPU 3)"];
    
    moe_3_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 20 (Node 2, GPU 4)"];
    
    moe_3_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 21 (Node 2, GPU 5)"];
    
    moe_3_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 22 (Node 2, GPU 6)"];
    
    moe_3_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 23 (Node 2, GPU 7)"];
    
    moe_3_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 24 (Node 3, GPU 0)"];
    
    moe_3_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 25 (Node 3, GPU 1)"];
    
    moe_3_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 26 (Node 3, GPU 2)"];
    
    moe_3_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 27 (Node 3, GPU 3)"];
    
    moe_3_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 28 (Node 3, GPU 4)"];
    
    moe_3_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 29 (Node 3, GPU 5)"];
    
    moe_3_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 30 (Node 3, GPU 6)"];
    
    moe_3_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 31 (Node 3, GPU 7)"];
    
    moe_3_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 32 (Node 4, GPU 0)"];
    
    moe_3_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 33 (Node 4, GPU 1)"];
    
    moe_3_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 34 (Node 4, GPU 2)"];
    
    moe_3_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 35 (Node 4, GPU 3)"];
    
    moe_3_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 36 (Node 4, GPU 4)"];
    
    moe_3_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 37 (Node 4, GPU 5)"];
    
    moe_3_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 38 (Node 4, GPU 6)"];
    
    moe_3_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 39 (Node 4, GPU 7)"];
    
    moe_3_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 40 (Node 5, GPU 0)"];
    
    moe_3_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 41 (Node 5, GPU 1)"];
    
    moe_3_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 42 (Node 5, GPU 2)"];
    
    moe_3_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 43 (Node 5, GPU 3)"];
    
    moe_3_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 44 (Node 5, GPU 4)"];
    
    moe_3_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 45 (Node 5, GPU 5)"];
    
    moe_3_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 46 (Node 5, GPU 6)"];
    
    moe_3_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 47 (Node 5, GPU 7)"];
    
    moe_3_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 48 (Node 6, GPU 0)"];
    
    moe_3_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 49 (Node 6, GPU 1)"];
    
    moe_3_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 50 (Node 6, GPU 2)"];
    
    moe_3_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 51 (Node 6, GPU 3)"];
    
    moe_3_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 52 (Node 6, GPU 4)"];
    
    moe_3_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 53 (Node 6, GPU 5)"];
    
    moe_3_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 54 (Node 6, GPU 6)"];
    
    moe_3_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 55 (Node 6, GPU 7)"];
    
    moe_3_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 56 (Node 7, GPU 0)"];
    
    moe_3_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 57 (Node 7, GPU 1)"];
    
    moe_3_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 58 (Node 7, GPU 2)"];
    
    moe_3_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 59 (Node 7, GPU 3)"];
    
    moe_3_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 60 (Node 7, GPU 4)"];
    
    moe_3_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 61 (Node 7, GPU 5)"];
    
    moe_3_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 62 (Node 7, GPU 6)"];
    
    moe_3_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 3 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 63 (Node 7, GPU 7)"];
    
    moe_3_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 3 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 0 (Node 0, GPU 0)"];
    
    moe_3_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 3 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 0 (Node 0, GPU 0)"];
    
    // MoE Layer 4 - MHA components
    moe_4_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 4 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 64 (Node 8, GPU 0)"];
    
    moe_4_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 4 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 64 (Node 8, GPU 0)"];
    
    moe_4_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 4 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 64 (Node 8, GPU 0)"];
    
    moe_4_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 4 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 64 (Node 8, GPU 0)"];
    
    moe_4_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 4 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 64 (Node 8, GPU 0)"];
    
    moe_4_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 4 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 64 (Node 8, GPU 0)"];
    
    moe_4_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 64 (Node 8, GPU 0)"];
    
    moe_4_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 65 (Node 8, GPU 1)"];
    
    moe_4_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 66 (Node 8, GPU 2)"];
    
    moe_4_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 67 (Node 8, GPU 3)"];
    
    moe_4_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 68 (Node 8, GPU 4)"];
    
    moe_4_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 69 (Node 8, GPU 5)"];
    
    moe_4_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 70 (Node 8, GPU 6)"];
    
    moe_4_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 71 (Node 8, GPU 7)"];
    
    moe_4_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 72 (Node 9, GPU 0)"];
    
    moe_4_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 73 (Node 9, GPU 1)"];
    
    moe_4_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 74 (Node 9, GPU 2)"];
    
    moe_4_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 75 (Node 9, GPU 3)"];
    
    moe_4_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 76 (Node 9, GPU 4)"];
    
    moe_4_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 77 (Node 9, GPU 5)"];
    
    moe_4_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 78 (Node 9, GPU 6)"];
    
    moe_4_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 79 (Node 9, GPU 7)"];
    
    moe_4_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 80 (Node 10, GPU 0)"];
    
    moe_4_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 81 (Node 10, GPU 1)"];
    
    moe_4_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 82 (Node 10, GPU 2)"];
    
    moe_4_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 83 (Node 10, GPU 3)"];
    
    moe_4_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 84 (Node 10, GPU 4)"];
    
    moe_4_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 85 (Node 10, GPU 5)"];
    
    moe_4_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 86 (Node 10, GPU 6)"];
    
    moe_4_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 87 (Node 10, GPU 7)"];
    
    moe_4_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 88 (Node 11, GPU 0)"];
    
    moe_4_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 89 (Node 11, GPU 1)"];
    
    moe_4_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 90 (Node 11, GPU 2)"];
    
    moe_4_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 91 (Node 11, GPU 3)"];
    
    moe_4_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 92 (Node 11, GPU 4)"];
    
    moe_4_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 93 (Node 11, GPU 5)"];
    
    moe_4_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 94 (Node 11, GPU 6)"];
    
    moe_4_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 95 (Node 11, GPU 7)"];
    
    moe_4_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 96 (Node 12, GPU 0)"];
    
    moe_4_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 97 (Node 12, GPU 1)"];
    
    moe_4_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 98 (Node 12, GPU 2)"];
    
    moe_4_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 99 (Node 12, GPU 3)"];
    
    moe_4_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 100 (Node 12, GPU 4)"];
    
    moe_4_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 101 (Node 12, GPU 5)"];
    
    moe_4_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 102 (Node 12, GPU 6)"];
    
    moe_4_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 103 (Node 12, GPU 7)"];
    
    moe_4_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 104 (Node 13, GPU 0)"];
    
    moe_4_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 105 (Node 13, GPU 1)"];
    
    moe_4_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 106 (Node 13, GPU 2)"];
    
    moe_4_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 107 (Node 13, GPU 3)"];
    
    moe_4_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 108 (Node 13, GPU 4)"];
    
    moe_4_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 109 (Node 13, GPU 5)"];
    
    moe_4_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 110 (Node 13, GPU 6)"];
    
    moe_4_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 111 (Node 13, GPU 7)"];
    
    moe_4_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 112 (Node 14, GPU 0)"];
    
    moe_4_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 113 (Node 14, GPU 1)"];
    
    moe_4_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 114 (Node 14, GPU 2)"];
    
    moe_4_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 115 (Node 14, GPU 3)"];
    
    moe_4_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 116 (Node 14, GPU 4)"];
    
    moe_4_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 117 (Node 14, GPU 5)"];
    
    moe_4_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 118 (Node 14, GPU 6)"];
    
    moe_4_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 119 (Node 14, GPU 7)"];
    
    moe_4_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 120 (Node 15, GPU 0)"];
    
    moe_4_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 121 (Node 15, GPU 1)"];
    
    moe_4_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 122 (Node 15, GPU 2)"];
    
    moe_4_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 123 (Node 15, GPU 3)"];
    
    moe_4_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 124 (Node 15, GPU 4)"];
    
    moe_4_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 125 (Node 15, GPU 5)"];
    
    moe_4_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 126 (Node 15, GPU 6)"];
    
    moe_4_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 4 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 127 (Node 15, GPU 7)"];
    
    moe_4_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 4 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 64 (Node 8, GPU 0)"];
    
    moe_4_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 4 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 64 (Node 8, GPU 0)"];
    
    // MoE Layer 5 - MHA components
    moe_5_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 5 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 128 (Node 16, GPU 0)"];
    
    moe_5_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 5 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 128 (Node 16, GPU 0)"];
    
    moe_5_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 5 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 128 (Node 16, GPU 0)"];
    
    moe_5_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 5 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 128 (Node 16, GPU 0)"];
    
    moe_5_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 5 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 128 (Node 16, GPU 0)"];
    
    moe_5_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 5 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 128 (Node 16, GPU 0)"];
    
    moe_5_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 128 (Node 16, GPU 0)"];
    
    moe_5_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 129 (Node 16, GPU 1)"];
    
    moe_5_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 130 (Node 16, GPU 2)"];
    
    moe_5_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 131 (Node 16, GPU 3)"];
    
    moe_5_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 132 (Node 16, GPU 4)"];
    
    moe_5_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 133 (Node 16, GPU 5)"];
    
    moe_5_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 134 (Node 16, GPU 6)"];
    
    moe_5_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 135 (Node 16, GPU 7)"];
    
    moe_5_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 136 (Node 17, GPU 0)"];
    
    moe_5_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 137 (Node 17, GPU 1)"];
    
    moe_5_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 138 (Node 17, GPU 2)"];
    
    moe_5_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 139 (Node 17, GPU 3)"];
    
    moe_5_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 140 (Node 17, GPU 4)"];
    
    moe_5_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 141 (Node 17, GPU 5)"];
    
    moe_5_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 142 (Node 17, GPU 6)"];
    
    moe_5_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 143 (Node 17, GPU 7)"];
    
    moe_5_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 144 (Node 18, GPU 0)"];
    
    moe_5_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 145 (Node 18, GPU 1)"];
    
    moe_5_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 146 (Node 18, GPU 2)"];
    
    moe_5_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 147 (Node 18, GPU 3)"];
    
    moe_5_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 148 (Node 18, GPU 4)"];
    
    moe_5_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 149 (Node 18, GPU 5)"];
    
    moe_5_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 150 (Node 18, GPU 6)"];
    
    moe_5_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 151 (Node 18, GPU 7)"];
    
    moe_5_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 152 (Node 19, GPU 0)"];
    
    moe_5_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 153 (Node 19, GPU 1)"];
    
    moe_5_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 154 (Node 19, GPU 2)"];
    
    moe_5_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 155 (Node 19, GPU 3)"];
    
    moe_5_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 156 (Node 19, GPU 4)"];
    
    moe_5_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 157 (Node 19, GPU 5)"];
    
    moe_5_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 158 (Node 19, GPU 6)"];
    
    moe_5_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 159 (Node 19, GPU 7)"];
    
    moe_5_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 160 (Node 20, GPU 0)"];
    
    moe_5_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 161 (Node 20, GPU 1)"];
    
    moe_5_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 162 (Node 20, GPU 2)"];
    
    moe_5_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 163 (Node 20, GPU 3)"];
    
    moe_5_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 164 (Node 20, GPU 4)"];
    
    moe_5_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 165 (Node 20, GPU 5)"];
    
    moe_5_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 166 (Node 20, GPU 6)"];
    
    moe_5_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 167 (Node 20, GPU 7)"];
    
    moe_5_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 168 (Node 21, GPU 0)"];
    
    moe_5_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 169 (Node 21, GPU 1)"];
    
    moe_5_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 170 (Node 21, GPU 2)"];
    
    moe_5_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 171 (Node 21, GPU 3)"];
    
    moe_5_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 172 (Node 21, GPU 4)"];
    
    moe_5_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 173 (Node 21, GPU 5)"];
    
    moe_5_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 174 (Node 21, GPU 6)"];
    
    moe_5_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 175 (Node 21, GPU 7)"];
    
    moe_5_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 176 (Node 22, GPU 0)"];
    
    moe_5_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 177 (Node 22, GPU 1)"];
    
    moe_5_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 178 (Node 22, GPU 2)"];
    
    moe_5_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 179 (Node 22, GPU 3)"];
    
    moe_5_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 180 (Node 22, GPU 4)"];
    
    moe_5_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 181 (Node 22, GPU 5)"];
    
    moe_5_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 182 (Node 22, GPU 6)"];
    
    moe_5_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 183 (Node 22, GPU 7)"];
    
    moe_5_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 184 (Node 23, GPU 0)"];
    
    moe_5_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 185 (Node 23, GPU 1)"];
    
    moe_5_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 186 (Node 23, GPU 2)"];
    
    moe_5_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 187 (Node 23, GPU 3)"];
    
    moe_5_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 188 (Node 23, GPU 4)"];
    
    moe_5_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 189 (Node 23, GPU 5)"];
    
    moe_5_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 190 (Node 23, GPU 6)"];
    
    moe_5_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 5 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 191 (Node 23, GPU 7)"];
    
    moe_5_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 5 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 128 (Node 16, GPU 0)"];
    
    moe_5_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 5 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 128 (Node 16, GPU 0)"];
    
    // MoE Layer 6 - MHA components
    moe_6_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 6 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 192 (Node 24, GPU 0)"];
    
    moe_6_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 6 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 192 (Node 24, GPU 0)"];
    
    moe_6_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 6 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 192 (Node 24, GPU 0)"];
    
    moe_6_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 6 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 192 (Node 24, GPU 0)"];
    
    moe_6_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 6 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 192 (Node 24, GPU 0)"];
    
    moe_6_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 6 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 192 (Node 24, GPU 0)"];
    
    moe_6_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 192 (Node 24, GPU 0)"];
    
    moe_6_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 193 (Node 24, GPU 1)"];
    
    moe_6_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 194 (Node 24, GPU 2)"];
    
    moe_6_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 195 (Node 24, GPU 3)"];
    
    moe_6_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 196 (Node 24, GPU 4)"];
    
    moe_6_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 197 (Node 24, GPU 5)"];
    
    moe_6_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 198 (Node 24, GPU 6)"];
    
    moe_6_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 199 (Node 24, GPU 7)"];
    
    moe_6_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 200 (Node 25, GPU 0)"];
    
    moe_6_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 201 (Node 25, GPU 1)"];
    
    moe_6_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 202 (Node 25, GPU 2)"];
    
    moe_6_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 203 (Node 25, GPU 3)"];
    
    moe_6_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 204 (Node 25, GPU 4)"];
    
    moe_6_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 205 (Node 25, GPU 5)"];
    
    moe_6_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 206 (Node 25, GPU 6)"];
    
    moe_6_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 207 (Node 25, GPU 7)"];
    
    moe_6_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 208 (Node 26, GPU 0)"];
    
    moe_6_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 209 (Node 26, GPU 1)"];
    
    moe_6_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 210 (Node 26, GPU 2)"];
    
    moe_6_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 211 (Node 26, GPU 3)"];
    
    moe_6_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 212 (Node 26, GPU 4)"];
    
    moe_6_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 213 (Node 26, GPU 5)"];
    
    moe_6_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 214 (Node 26, GPU 6)"];
    
    moe_6_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 215 (Node 26, GPU 7)"];
    
    moe_6_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 216 (Node 27, GPU 0)"];
    
    moe_6_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 217 (Node 27, GPU 1)"];
    
    moe_6_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 218 (Node 27, GPU 2)"];
    
    moe_6_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 219 (Node 27, GPU 3)"];
    
    moe_6_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 220 (Node 27, GPU 4)"];
    
    moe_6_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 221 (Node 27, GPU 5)"];
    
    moe_6_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 222 (Node 27, GPU 6)"];
    
    moe_6_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 223 (Node 27, GPU 7)"];
    
    moe_6_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 224 (Node 28, GPU 0)"];
    
    moe_6_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 225 (Node 28, GPU 1)"];
    
    moe_6_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 226 (Node 28, GPU 2)"];
    
    moe_6_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 227 (Node 28, GPU 3)"];
    
    moe_6_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 228 (Node 28, GPU 4)"];
    
    moe_6_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 229 (Node 28, GPU 5)"];
    
    moe_6_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 230 (Node 28, GPU 6)"];
    
    moe_6_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 231 (Node 28, GPU 7)"];
    
    moe_6_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 232 (Node 29, GPU 0)"];
    
    moe_6_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 233 (Node 29, GPU 1)"];
    
    moe_6_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 234 (Node 29, GPU 2)"];
    
    moe_6_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 235 (Node 29, GPU 3)"];
    
    moe_6_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 236 (Node 29, GPU 4)"];
    
    moe_6_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 237 (Node 29, GPU 5)"];
    
    moe_6_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 238 (Node 29, GPU 6)"];
    
    moe_6_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 239 (Node 29, GPU 7)"];
    
    moe_6_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 240 (Node 30, GPU 0)"];
    
    moe_6_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 241 (Node 30, GPU 1)"];
    
    moe_6_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 242 (Node 30, GPU 2)"];
    
    moe_6_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 243 (Node 30, GPU 3)"];
    
    moe_6_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 244 (Node 30, GPU 4)"];
    
    moe_6_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 245 (Node 30, GPU 5)"];
    
    moe_6_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 246 (Node 30, GPU 6)"];
    
    moe_6_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 247 (Node 30, GPU 7)"];
    
    moe_6_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 248 (Node 31, GPU 0)"];
    
    moe_6_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 249 (Node 31, GPU 1)"];
    
    moe_6_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 250 (Node 31, GPU 2)"];
    
    moe_6_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 251 (Node 31, GPU 3)"];
    
    moe_6_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 252 (Node 31, GPU 4)"];
    
    moe_6_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 253 (Node 31, GPU 5)"];
    
    moe_6_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 254 (Node 31, GPU 6)"];
    
    moe_6_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 6 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 255 (Node 31, GPU 7)"];
    
    moe_6_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 6 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 192 (Node 24, GPU 0)"];
    
    moe_6_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 6 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 192 (Node 24, GPU 0)"];
    
    // MoE Layer 7 - MHA components
    moe_7_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 7 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 256 (Node 32, GPU 0)"];
    
    moe_7_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 7 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 256 (Node 32, GPU 0)"];
    
    moe_7_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 7 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 256 (Node 32, GPU 0)"];
    
    moe_7_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 7 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 256 (Node 32, GPU 0)"];
    
    moe_7_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 7 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 256 (Node 32, GPU 0)"];
    
    moe_7_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 7 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 256 (Node 32, GPU 0)"];
    
    moe_7_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 256 (Node 32, GPU 0)"];
    
    moe_7_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 257 (Node 32, GPU 1)"];
    
    moe_7_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 258 (Node 32, GPU 2)"];
    
    moe_7_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 259 (Node 32, GPU 3)"];
    
    moe_7_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 260 (Node 32, GPU 4)"];
    
    moe_7_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 261 (Node 32, GPU 5)"];
    
    moe_7_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 262 (Node 32, GPU 6)"];
    
    moe_7_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 263 (Node 32, GPU 7)"];
    
    moe_7_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 264 (Node 33, GPU 0)"];
    
    moe_7_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 265 (Node 33, GPU 1)"];
    
    moe_7_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 266 (Node 33, GPU 2)"];
    
    moe_7_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 267 (Node 33, GPU 3)"];
    
    moe_7_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 268 (Node 33, GPU 4)"];
    
    moe_7_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 269 (Node 33, GPU 5)"];
    
    moe_7_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 270 (Node 33, GPU 6)"];
    
    moe_7_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 271 (Node 33, GPU 7)"];
    
    moe_7_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 272 (Node 34, GPU 0)"];
    
    moe_7_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 273 (Node 34, GPU 1)"];
    
    moe_7_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 274 (Node 34, GPU 2)"];
    
    moe_7_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 275 (Node 34, GPU 3)"];
    
    moe_7_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 276 (Node 34, GPU 4)"];
    
    moe_7_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 277 (Node 34, GPU 5)"];
    
    moe_7_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 278 (Node 34, GPU 6)"];
    
    moe_7_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 279 (Node 34, GPU 7)"];
    
    moe_7_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 280 (Node 35, GPU 0)"];
    
    moe_7_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 281 (Node 35, GPU 1)"];
    
    moe_7_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 282 (Node 35, GPU 2)"];
    
    moe_7_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 283 (Node 35, GPU 3)"];
    
    moe_7_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 284 (Node 35, GPU 4)"];
    
    moe_7_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 285 (Node 35, GPU 5)"];
    
    moe_7_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 286 (Node 35, GPU 6)"];
    
    moe_7_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 287 (Node 35, GPU 7)"];
    
    moe_7_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 288 (Node 36, GPU 0)"];
    
    moe_7_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 289 (Node 36, GPU 1)"];
    
    moe_7_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 290 (Node 36, GPU 2)"];
    
    moe_7_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 291 (Node 36, GPU 3)"];
    
    moe_7_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 292 (Node 36, GPU 4)"];
    
    moe_7_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 293 (Node 36, GPU 5)"];
    
    moe_7_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 294 (Node 36, GPU 6)"];
    
    moe_7_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 295 (Node 36, GPU 7)"];
    
    moe_7_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 296 (Node 37, GPU 0)"];
    
    moe_7_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 297 (Node 37, GPU 1)"];
    
    moe_7_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 298 (Node 37, GPU 2)"];
    
    moe_7_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 299 (Node 37, GPU 3)"];
    
    moe_7_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 300 (Node 37, GPU 4)"];
    
    moe_7_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 301 (Node 37, GPU 5)"];
    
    moe_7_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 302 (Node 37, GPU 6)"];
    
    moe_7_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 303 (Node 37, GPU 7)"];
    
    moe_7_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 304 (Node 38, GPU 0)"];
    
    moe_7_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 305 (Node 38, GPU 1)"];
    
    moe_7_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 306 (Node 38, GPU 2)"];
    
    moe_7_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 307 (Node 38, GPU 3)"];
    
    moe_7_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 308 (Node 38, GPU 4)"];
    
    moe_7_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 309 (Node 38, GPU 5)"];
    
    moe_7_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 310 (Node 38, GPU 6)"];
    
    moe_7_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 311 (Node 38, GPU 7)"];
    
    moe_7_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 312 (Node 39, GPU 0)"];
    
    moe_7_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 313 (Node 39, GPU 1)"];
    
    moe_7_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 314 (Node 39, GPU 2)"];
    
    moe_7_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 315 (Node 39, GPU 3)"];
    
    moe_7_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 316 (Node 39, GPU 4)"];
    
    moe_7_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 317 (Node 39, GPU 5)"];
    
    moe_7_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 318 (Node 39, GPU 6)"];
    
    moe_7_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 7 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 319 (Node 39, GPU 7)"];
    
    moe_7_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 7 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 256 (Node 32, GPU 0)"];
    
    moe_7_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 7 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 256 (Node 32, GPU 0)"];
    
    // MoE Layer 8 - MHA components
    moe_8_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 8 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 320 (Node 40, GPU 0)"];
    
    moe_8_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 8 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 320 (Node 40, GPU 0)"];
    
    moe_8_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 8 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 320 (Node 40, GPU 0)"];
    
    moe_8_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 8 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 320 (Node 40, GPU 0)"];
    
    moe_8_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 8 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 320 (Node 40, GPU 0)"];
    
    moe_8_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 8 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 320 (Node 40, GPU 0)"];
    
    moe_8_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 320 (Node 40, GPU 0)"];
    
    moe_8_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 321 (Node 40, GPU 1)"];
    
    moe_8_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 322 (Node 40, GPU 2)"];
    
    moe_8_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 323 (Node 40, GPU 3)"];
    
    moe_8_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 324 (Node 40, GPU 4)"];
    
    moe_8_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 325 (Node 40, GPU 5)"];
    
    moe_8_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 326 (Node 40, GPU 6)"];
    
    moe_8_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 327 (Node 40, GPU 7)"];
    
    moe_8_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 328 (Node 41, GPU 0)"];
    
    moe_8_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 329 (Node 41, GPU 1)"];
    
    moe_8_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 330 (Node 41, GPU 2)"];
    
    moe_8_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 331 (Node 41, GPU 3)"];
    
    moe_8_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 332 (Node 41, GPU 4)"];
    
    moe_8_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 333 (Node 41, GPU 5)"];
    
    moe_8_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 334 (Node 41, GPU 6)"];
    
    moe_8_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 335 (Node 41, GPU 7)"];
    
    moe_8_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 336 (Node 42, GPU 0)"];
    
    moe_8_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 337 (Node 42, GPU 1)"];
    
    moe_8_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 338 (Node 42, GPU 2)"];
    
    moe_8_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 339 (Node 42, GPU 3)"];
    
    moe_8_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 340 (Node 42, GPU 4)"];
    
    moe_8_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 341 (Node 42, GPU 5)"];
    
    moe_8_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 342 (Node 42, GPU 6)"];
    
    moe_8_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 343 (Node 42, GPU 7)"];
    
    moe_8_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 344 (Node 43, GPU 0)"];
    
    moe_8_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 345 (Node 43, GPU 1)"];
    
    moe_8_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 346 (Node 43, GPU 2)"];
    
    moe_8_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 347 (Node 43, GPU 3)"];
    
    moe_8_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 348 (Node 43, GPU 4)"];
    
    moe_8_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 349 (Node 43, GPU 5)"];
    
    moe_8_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 350 (Node 43, GPU 6)"];
    
    moe_8_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 351 (Node 43, GPU 7)"];
    
    moe_8_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 352 (Node 44, GPU 0)"];
    
    moe_8_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 353 (Node 44, GPU 1)"];
    
    moe_8_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 354 (Node 44, GPU 2)"];
    
    moe_8_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 355 (Node 44, GPU 3)"];
    
    moe_8_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 356 (Node 44, GPU 4)"];
    
    moe_8_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 357 (Node 44, GPU 5)"];
    
    moe_8_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 358 (Node 44, GPU 6)"];
    
    moe_8_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 359 (Node 44, GPU 7)"];
    
    moe_8_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 360 (Node 45, GPU 0)"];
    
    moe_8_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 361 (Node 45, GPU 1)"];
    
    moe_8_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 362 (Node 45, GPU 2)"];
    
    moe_8_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 363 (Node 45, GPU 3)"];
    
    moe_8_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 364 (Node 45, GPU 4)"];
    
    moe_8_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 365 (Node 45, GPU 5)"];
    
    moe_8_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 366 (Node 45, GPU 6)"];
    
    moe_8_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 367 (Node 45, GPU 7)"];
    
    moe_8_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 368 (Node 46, GPU 0)"];
    
    moe_8_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 369 (Node 46, GPU 1)"];
    
    moe_8_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 370 (Node 46, GPU 2)"];
    
    moe_8_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 371 (Node 46, GPU 3)"];
    
    moe_8_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 372 (Node 46, GPU 4)"];
    
    moe_8_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 373 (Node 46, GPU 5)"];
    
    moe_8_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 374 (Node 46, GPU 6)"];
    
    moe_8_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 375 (Node 46, GPU 7)"];
    
    moe_8_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 376 (Node 47, GPU 0)"];
    
    moe_8_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 377 (Node 47, GPU 1)"];
    
    moe_8_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 378 (Node 47, GPU 2)"];
    
    moe_8_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 379 (Node 47, GPU 3)"];
    
    moe_8_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 380 (Node 47, GPU 4)"];
    
    moe_8_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 381 (Node 47, GPU 5)"];
    
    moe_8_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 382 (Node 47, GPU 6)"];
    
    moe_8_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 8 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 383 (Node 47, GPU 7)"];
    
    moe_8_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 8 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 320 (Node 40, GPU 0)"];
    
    moe_8_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 8 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 320 (Node 40, GPU 0)"];
    
    // MoE Layer 9 - MHA components
    moe_9_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 9 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 384 (Node 48, GPU 0)"];
    
    moe_9_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 9 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 384 (Node 48, GPU 0)"];
    
    moe_9_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 9 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 384 (Node 48, GPU 0)"];
    
    moe_9_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 9 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 384 (Node 48, GPU 0)"];
    
    moe_9_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 9 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 384 (Node 48, GPU 0)"];
    
    moe_9_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 9 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 384 (Node 48, GPU 0)"];
    
    moe_9_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 384 (Node 48, GPU 0)"];
    
    moe_9_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 385 (Node 48, GPU 1)"];
    
    moe_9_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 386 (Node 48, GPU 2)"];
    
    moe_9_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 387 (Node 48, GPU 3)"];
    
    moe_9_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 388 (Node 48, GPU 4)"];
    
    moe_9_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 389 (Node 48, GPU 5)"];
    
    moe_9_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 390 (Node 48, GPU 6)"];
    
    moe_9_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 391 (Node 48, GPU 7)"];
    
    moe_9_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 392 (Node 49, GPU 0)"];
    
    moe_9_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 393 (Node 49, GPU 1)"];
    
    moe_9_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 394 (Node 49, GPU 2)"];
    
    moe_9_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 395 (Node 49, GPU 3)"];
    
    moe_9_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 396 (Node 49, GPU 4)"];
    
    moe_9_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 397 (Node 49, GPU 5)"];
    
    moe_9_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 398 (Node 49, GPU 6)"];
    
    moe_9_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 399 (Node 49, GPU 7)"];
    
    moe_9_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 400 (Node 50, GPU 0)"];
    
    moe_9_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 401 (Node 50, GPU 1)"];
    
    moe_9_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 402 (Node 50, GPU 2)"];
    
    moe_9_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 403 (Node 50, GPU 3)"];
    
    moe_9_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 404 (Node 50, GPU 4)"];
    
    moe_9_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 405 (Node 50, GPU 5)"];
    
    moe_9_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 406 (Node 50, GPU 6)"];
    
    moe_9_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 407 (Node 50, GPU 7)"];
    
    moe_9_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 408 (Node 51, GPU 0)"];
    
    moe_9_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 409 (Node 51, GPU 1)"];
    
    moe_9_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 410 (Node 51, GPU 2)"];
    
    moe_9_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 411 (Node 51, GPU 3)"];
    
    moe_9_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 412 (Node 51, GPU 4)"];
    
    moe_9_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 413 (Node 51, GPU 5)"];
    
    moe_9_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 414 (Node 51, GPU 6)"];
    
    moe_9_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 415 (Node 51, GPU 7)"];
    
    moe_9_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 416 (Node 52, GPU 0)"];
    
    moe_9_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 417 (Node 52, GPU 1)"];
    
    moe_9_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 418 (Node 52, GPU 2)"];
    
    moe_9_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 419 (Node 52, GPU 3)"];
    
    moe_9_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 420 (Node 52, GPU 4)"];
    
    moe_9_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 421 (Node 52, GPU 5)"];
    
    moe_9_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 422 (Node 52, GPU 6)"];
    
    moe_9_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 423 (Node 52, GPU 7)"];
    
    moe_9_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 424 (Node 53, GPU 0)"];
    
    moe_9_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 425 (Node 53, GPU 1)"];
    
    moe_9_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 426 (Node 53, GPU 2)"];
    
    moe_9_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 427 (Node 53, GPU 3)"];
    
    moe_9_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 428 (Node 53, GPU 4)"];
    
    moe_9_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 429 (Node 53, GPU 5)"];
    
    moe_9_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 430 (Node 53, GPU 6)"];
    
    moe_9_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 431 (Node 53, GPU 7)"];
    
    moe_9_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 432 (Node 54, GPU 0)"];
    
    moe_9_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 433 (Node 54, GPU 1)"];
    
    moe_9_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 434 (Node 54, GPU 2)"];
    
    moe_9_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 435 (Node 54, GPU 3)"];
    
    moe_9_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 436 (Node 54, GPU 4)"];
    
    moe_9_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 437 (Node 54, GPU 5)"];
    
    moe_9_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 438 (Node 54, GPU 6)"];
    
    moe_9_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 439 (Node 54, GPU 7)"];
    
    moe_9_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 440 (Node 55, GPU 0)"];
    
    moe_9_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 441 (Node 55, GPU 1)"];
    
    moe_9_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 442 (Node 55, GPU 2)"];
    
    moe_9_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 443 (Node 55, GPU 3)"];
    
    moe_9_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 444 (Node 55, GPU 4)"];
    
    moe_9_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 445 (Node 55, GPU 5)"];
    
    moe_9_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 446 (Node 55, GPU 6)"];
    
    moe_9_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 9 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 447 (Node 55, GPU 7)"];
    
    moe_9_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 9 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 384 (Node 48, GPU 0)"];
    
    moe_9_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 9 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 384 (Node 48, GPU 0)"];
    
    // MoE Layer 10 - MHA components
    moe_10_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 10 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 448 (Node 56, GPU 0)"];
    
    moe_10_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 10 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 448 (Node 56, GPU 0)"];
    
    moe_10_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 10 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 448 (Node 56, GPU 0)"];
    
    moe_10_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 10 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 448 (Node 56, GPU 0)"];
    
    moe_10_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 10 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 448 (Node 56, GPU 0)"];
    
    moe_10_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 10 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 448 (Node 56, GPU 0)"];
    
    moe_10_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 448 (Node 56, GPU 0)"];
    
    moe_10_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 449 (Node 56, GPU 1)"];
    
    moe_10_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 450 (Node 56, GPU 2)"];
    
    moe_10_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 451 (Node 56, GPU 3)"];
    
    moe_10_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 452 (Node 56, GPU 4)"];
    
    moe_10_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 453 (Node 56, GPU 5)"];
    
    moe_10_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 454 (Node 56, GPU 6)"];
    
    moe_10_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 455 (Node 56, GPU 7)"];
    
    moe_10_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 456 (Node 57, GPU 0)"];
    
    moe_10_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 457 (Node 57, GPU 1)"];
    
    moe_10_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 458 (Node 57, GPU 2)"];
    
    moe_10_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 459 (Node 57, GPU 3)"];
    
    moe_10_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 460 (Node 57, GPU 4)"];
    
    moe_10_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 461 (Node 57, GPU 5)"];
    
    moe_10_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 462 (Node 57, GPU 6)"];
    
    moe_10_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 463 (Node 57, GPU 7)"];
    
    moe_10_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 464 (Node 58, GPU 0)"];
    
    moe_10_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 465 (Node 58, GPU 1)"];
    
    moe_10_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 466 (Node 58, GPU 2)"];
    
    moe_10_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 467 (Node 58, GPU 3)"];
    
    moe_10_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 468 (Node 58, GPU 4)"];
    
    moe_10_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 469 (Node 58, GPU 5)"];
    
    moe_10_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 470 (Node 58, GPU 6)"];
    
    moe_10_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 471 (Node 58, GPU 7)"];
    
    moe_10_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 472 (Node 59, GPU 0)"];
    
    moe_10_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 473 (Node 59, GPU 1)"];
    
    moe_10_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 474 (Node 59, GPU 2)"];
    
    moe_10_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 475 (Node 59, GPU 3)"];
    
    moe_10_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 476 (Node 59, GPU 4)"];
    
    moe_10_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 477 (Node 59, GPU 5)"];
    
    moe_10_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 478 (Node 59, GPU 6)"];
    
    moe_10_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 479 (Node 59, GPU 7)"];
    
    moe_10_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 480 (Node 60, GPU 0)"];
    
    moe_10_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 481 (Node 60, GPU 1)"];
    
    moe_10_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 482 (Node 60, GPU 2)"];
    
    moe_10_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 483 (Node 60, GPU 3)"];
    
    moe_10_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 484 (Node 60, GPU 4)"];
    
    moe_10_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 485 (Node 60, GPU 5)"];
    
    moe_10_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 486 (Node 60, GPU 6)"];
    
    moe_10_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 487 (Node 60, GPU 7)"];
    
    moe_10_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 488 (Node 61, GPU 0)"];
    
    moe_10_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 489 (Node 61, GPU 1)"];
    
    moe_10_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 490 (Node 61, GPU 2)"];
    
    moe_10_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 491 (Node 61, GPU 3)"];
    
    moe_10_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 492 (Node 61, GPU 4)"];
    
    moe_10_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 493 (Node 61, GPU 5)"];
    
    moe_10_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 494 (Node 61, GPU 6)"];
    
    moe_10_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 495 (Node 61, GPU 7)"];
    
    moe_10_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 496 (Node 62, GPU 0)"];
    
    moe_10_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 497 (Node 62, GPU 1)"];
    
    moe_10_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 498 (Node 62, GPU 2)"];
    
    moe_10_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 499 (Node 62, GPU 3)"];
    
    moe_10_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 500 (Node 62, GPU 4)"];
    
    moe_10_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 501 (Node 62, GPU 5)"];
    
    moe_10_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 502 (Node 62, GPU 6)"];
    
    moe_10_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 503 (Node 62, GPU 7)"];
    
    moe_10_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 504 (Node 63, GPU 0)"];
    
    moe_10_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 505 (Node 63, GPU 1)"];
    
    moe_10_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 506 (Node 63, GPU 2)"];
    
    moe_10_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 507 (Node 63, GPU 3)"];
    
    moe_10_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 508 (Node 63, GPU 4)"];
    
    moe_10_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 509 (Node 63, GPU 5)"];
    
    moe_10_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 510 (Node 63, GPU 6)"];
    
    moe_10_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 10 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 511 (Node 63, GPU 7)"];
    
    moe_10_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 10 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 448 (Node 56, GPU 0)"];
    
    moe_10_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 10 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 448 (Node 56, GPU 0)"];
    
    // MoE Layer 11 - MHA components
    moe_11_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 11 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 512 (Node 64, GPU 0)"];
    
    moe_11_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 11 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 512 (Node 64, GPU 0)"];
    
    moe_11_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 11 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 512 (Node 64, GPU 0)"];
    
    moe_11_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 11 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 512 (Node 64, GPU 0)"];
    
    moe_11_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 11 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 512 (Node 64, GPU 0)"];
    
    moe_11_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 11 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 512 (Node 64, GPU 0)"];
    
    moe_11_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 512 (Node 64, GPU 0)"];
    
    moe_11_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 513 (Node 64, GPU 1)"];
    
    moe_11_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 514 (Node 64, GPU 2)"];
    
    moe_11_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 515 (Node 64, GPU 3)"];
    
    moe_11_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 516 (Node 64, GPU 4)"];
    
    moe_11_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 517 (Node 64, GPU 5)"];
    
    moe_11_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 518 (Node 64, GPU 6)"];
    
    moe_11_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 519 (Node 64, GPU 7)"];
    
    moe_11_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 520 (Node 65, GPU 0)"];
    
    moe_11_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 521 (Node 65, GPU 1)"];
    
    moe_11_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 522 (Node 65, GPU 2)"];
    
    moe_11_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 523 (Node 65, GPU 3)"];
    
    moe_11_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 524 (Node 65, GPU 4)"];
    
    moe_11_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 525 (Node 65, GPU 5)"];
    
    moe_11_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 526 (Node 65, GPU 6)"];
    
    moe_11_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 527 (Node 65, GPU 7)"];
    
    moe_11_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 528 (Node 66, GPU 0)"];
    
    moe_11_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 529 (Node 66, GPU 1)"];
    
    moe_11_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 530 (Node 66, GPU 2)"];
    
    moe_11_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 531 (Node 66, GPU 3)"];
    
    moe_11_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 532 (Node 66, GPU 4)"];
    
    moe_11_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 533 (Node 66, GPU 5)"];
    
    moe_11_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 534 (Node 66, GPU 6)"];
    
    moe_11_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 535 (Node 66, GPU 7)"];
    
    moe_11_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 536 (Node 67, GPU 0)"];
    
    moe_11_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 537 (Node 67, GPU 1)"];
    
    moe_11_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 538 (Node 67, GPU 2)"];
    
    moe_11_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 539 (Node 67, GPU 3)"];
    
    moe_11_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 540 (Node 67, GPU 4)"];
    
    moe_11_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 541 (Node 67, GPU 5)"];
    
    moe_11_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 542 (Node 67, GPU 6)"];
    
    moe_11_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 543 (Node 67, GPU 7)"];
    
    moe_11_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 544 (Node 68, GPU 0)"];
    
    moe_11_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 545 (Node 68, GPU 1)"];
    
    moe_11_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 546 (Node 68, GPU 2)"];
    
    moe_11_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 547 (Node 68, GPU 3)"];
    
    moe_11_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 548 (Node 68, GPU 4)"];
    
    moe_11_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 549 (Node 68, GPU 5)"];
    
    moe_11_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 550 (Node 68, GPU 6)"];
    
    moe_11_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 551 (Node 68, GPU 7)"];
    
    moe_11_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 552 (Node 69, GPU 0)"];
    
    moe_11_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 553 (Node 69, GPU 1)"];
    
    moe_11_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 554 (Node 69, GPU 2)"];
    
    moe_11_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 555 (Node 69, GPU 3)"];
    
    moe_11_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 556 (Node 69, GPU 4)"];
    
    moe_11_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 557 (Node 69, GPU 5)"];
    
    moe_11_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 558 (Node 69, GPU 6)"];
    
    moe_11_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 559 (Node 69, GPU 7)"];
    
    moe_11_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 560 (Node 70, GPU 0)"];
    
    moe_11_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 561 (Node 70, GPU 1)"];
    
    moe_11_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 562 (Node 70, GPU 2)"];
    
    moe_11_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 563 (Node 70, GPU 3)"];
    
    moe_11_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 564 (Node 70, GPU 4)"];
    
    moe_11_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 565 (Node 70, GPU 5)"];
    
    moe_11_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 566 (Node 70, GPU 6)"];
    
    moe_11_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 567 (Node 70, GPU 7)"];
    
    moe_11_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 568 (Node 71, GPU 0)"];
    
    moe_11_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 569 (Node 71, GPU 1)"];
    
    moe_11_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 570 (Node 71, GPU 2)"];
    
    moe_11_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 571 (Node 71, GPU 3)"];
    
    moe_11_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 572 (Node 71, GPU 4)"];
    
    moe_11_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 573 (Node 71, GPU 5)"];
    
    moe_11_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 574 (Node 71, GPU 6)"];
    
    moe_11_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 11 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 575 (Node 71, GPU 7)"];
    
    moe_11_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 11 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 512 (Node 64, GPU 0)"];
    
    moe_11_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 11 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 512 (Node 64, GPU 0)"];
    
    // MoE Layer 12 - MHA components
    moe_12_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 12 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 576 (Node 72, GPU 0)"];
    
    moe_12_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 12 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 576 (Node 72, GPU 0)"];
    
    moe_12_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 12 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 576 (Node 72, GPU 0)"];
    
    moe_12_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 12 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 576 (Node 72, GPU 0)"];
    
    moe_12_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 12 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 576 (Node 72, GPU 0)"];
    
    moe_12_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 12 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 576 (Node 72, GPU 0)"];
    
    moe_12_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 576 (Node 72, GPU 0)"];
    
    moe_12_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 577 (Node 72, GPU 1)"];
    
    moe_12_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 578 (Node 72, GPU 2)"];
    
    moe_12_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 579 (Node 72, GPU 3)"];
    
    moe_12_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 580 (Node 72, GPU 4)"];
    
    moe_12_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 581 (Node 72, GPU 5)"];
    
    moe_12_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 582 (Node 72, GPU 6)"];
    
    moe_12_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 583 (Node 72, GPU 7)"];
    
    moe_12_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 584 (Node 73, GPU 0)"];
    
    moe_12_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 585 (Node 73, GPU 1)"];
    
    moe_12_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 586 (Node 73, GPU 2)"];
    
    moe_12_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 587 (Node 73, GPU 3)"];
    
    moe_12_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 588 (Node 73, GPU 4)"];
    
    moe_12_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 589 (Node 73, GPU 5)"];
    
    moe_12_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 590 (Node 73, GPU 6)"];
    
    moe_12_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 591 (Node 73, GPU 7)"];
    
    moe_12_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 592 (Node 74, GPU 0)"];
    
    moe_12_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 593 (Node 74, GPU 1)"];
    
    moe_12_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 594 (Node 74, GPU 2)"];
    
    moe_12_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 595 (Node 74, GPU 3)"];
    
    moe_12_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 596 (Node 74, GPU 4)"];
    
    moe_12_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 597 (Node 74, GPU 5)"];
    
    moe_12_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 598 (Node 74, GPU 6)"];
    
    moe_12_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 599 (Node 74, GPU 7)"];
    
    moe_12_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 600 (Node 75, GPU 0)"];
    
    moe_12_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 601 (Node 75, GPU 1)"];
    
    moe_12_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 602 (Node 75, GPU 2)"];
    
    moe_12_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 603 (Node 75, GPU 3)"];
    
    moe_12_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 604 (Node 75, GPU 4)"];
    
    moe_12_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 605 (Node 75, GPU 5)"];
    
    moe_12_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 606 (Node 75, GPU 6)"];
    
    moe_12_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 607 (Node 75, GPU 7)"];
    
    moe_12_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 608 (Node 76, GPU 0)"];
    
    moe_12_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 609 (Node 76, GPU 1)"];
    
    moe_12_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 610 (Node 76, GPU 2)"];
    
    moe_12_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 611 (Node 76, GPU 3)"];
    
    moe_12_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 612 (Node 76, GPU 4)"];
    
    moe_12_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 613 (Node 76, GPU 5)"];
    
    moe_12_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 614 (Node 76, GPU 6)"];
    
    moe_12_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 615 (Node 76, GPU 7)"];
    
    moe_12_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 616 (Node 77, GPU 0)"];
    
    moe_12_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 617 (Node 77, GPU 1)"];
    
    moe_12_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 618 (Node 77, GPU 2)"];
    
    moe_12_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 619 (Node 77, GPU 3)"];
    
    moe_12_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 620 (Node 77, GPU 4)"];
    
    moe_12_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 621 (Node 77, GPU 5)"];
    
    moe_12_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 622 (Node 77, GPU 6)"];
    
    moe_12_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 623 (Node 77, GPU 7)"];
    
    moe_12_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 624 (Node 78, GPU 0)"];
    
    moe_12_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 625 (Node 78, GPU 1)"];
    
    moe_12_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 626 (Node 78, GPU 2)"];
    
    moe_12_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 627 (Node 78, GPU 3)"];
    
    moe_12_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 628 (Node 78, GPU 4)"];
    
    moe_12_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 629 (Node 78, GPU 5)"];
    
    moe_12_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 630 (Node 78, GPU 6)"];
    
    moe_12_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 631 (Node 78, GPU 7)"];
    
    moe_12_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 632 (Node 79, GPU 0)"];
    
    moe_12_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 633 (Node 79, GPU 1)"];
    
    moe_12_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 634 (Node 79, GPU 2)"];
    
    moe_12_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 635 (Node 79, GPU 3)"];
    
    moe_12_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 636 (Node 79, GPU 4)"];
    
    moe_12_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 637 (Node 79, GPU 5)"];
    
    moe_12_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 638 (Node 79, GPU 6)"];
    
    moe_12_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 12 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 639 (Node 79, GPU 7)"];
    
    moe_12_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 12 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 576 (Node 72, GPU 0)"];
    
    moe_12_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 12 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 576 (Node 72, GPU 0)"];
    
    // MoE Layer 13 - MHA components
    moe_13_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 13 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 640 (Node 80, GPU 0)"];
    
    moe_13_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 13 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 640 (Node 80, GPU 0)"];
    
    moe_13_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 13 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 640 (Node 80, GPU 0)"];
    
    moe_13_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 13 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 640 (Node 80, GPU 0)"];
    
    moe_13_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 13 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 640 (Node 80, GPU 0)"];
    
    moe_13_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 13 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 640 (Node 80, GPU 0)"];
    
    moe_13_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 640 (Node 80, GPU 0)"];
    
    moe_13_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 641 (Node 80, GPU 1)"];
    
    moe_13_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 642 (Node 80, GPU 2)"];
    
    moe_13_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 643 (Node 80, GPU 3)"];
    
    moe_13_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 644 (Node 80, GPU 4)"];
    
    moe_13_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 645 (Node 80, GPU 5)"];
    
    moe_13_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 646 (Node 80, GPU 6)"];
    
    moe_13_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 647 (Node 80, GPU 7)"];
    
    moe_13_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 648 (Node 81, GPU 0)"];
    
    moe_13_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 649 (Node 81, GPU 1)"];
    
    moe_13_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 650 (Node 81, GPU 2)"];
    
    moe_13_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 651 (Node 81, GPU 3)"];
    
    moe_13_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 652 (Node 81, GPU 4)"];
    
    moe_13_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 653 (Node 81, GPU 5)"];
    
    moe_13_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 654 (Node 81, GPU 6)"];
    
    moe_13_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 655 (Node 81, GPU 7)"];
    
    moe_13_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 656 (Node 82, GPU 0)"];
    
    moe_13_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 657 (Node 82, GPU 1)"];
    
    moe_13_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 658 (Node 82, GPU 2)"];
    
    moe_13_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 659 (Node 82, GPU 3)"];
    
    moe_13_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 660 (Node 82, GPU 4)"];
    
    moe_13_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 661 (Node 82, GPU 5)"];
    
    moe_13_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 662 (Node 82, GPU 6)"];
    
    moe_13_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 663 (Node 82, GPU 7)"];
    
    moe_13_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 664 (Node 83, GPU 0)"];
    
    moe_13_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 665 (Node 83, GPU 1)"];
    
    moe_13_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 666 (Node 83, GPU 2)"];
    
    moe_13_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 667 (Node 83, GPU 3)"];
    
    moe_13_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 668 (Node 83, GPU 4)"];
    
    moe_13_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 669 (Node 83, GPU 5)"];
    
    moe_13_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 670 (Node 83, GPU 6)"];
    
    moe_13_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 671 (Node 83, GPU 7)"];
    
    moe_13_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 672 (Node 84, GPU 0)"];
    
    moe_13_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 673 (Node 84, GPU 1)"];
    
    moe_13_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 674 (Node 84, GPU 2)"];
    
    moe_13_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 675 (Node 84, GPU 3)"];
    
    moe_13_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 676 (Node 84, GPU 4)"];
    
    moe_13_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 677 (Node 84, GPU 5)"];
    
    moe_13_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 678 (Node 84, GPU 6)"];
    
    moe_13_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 679 (Node 84, GPU 7)"];
    
    moe_13_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 680 (Node 85, GPU 0)"];
    
    moe_13_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 681 (Node 85, GPU 1)"];
    
    moe_13_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 682 (Node 85, GPU 2)"];
    
    moe_13_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 683 (Node 85, GPU 3)"];
    
    moe_13_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 684 (Node 85, GPU 4)"];
    
    moe_13_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 685 (Node 85, GPU 5)"];
    
    moe_13_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 686 (Node 85, GPU 6)"];
    
    moe_13_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 687 (Node 85, GPU 7)"];
    
    moe_13_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 688 (Node 86, GPU 0)"];
    
    moe_13_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 689 (Node 86, GPU 1)"];
    
    moe_13_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 690 (Node 86, GPU 2)"];
    
    moe_13_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 691 (Node 86, GPU 3)"];
    
    moe_13_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 692 (Node 86, GPU 4)"];
    
    moe_13_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 693 (Node 86, GPU 5)"];
    
    moe_13_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 694 (Node 86, GPU 6)"];
    
    moe_13_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 695 (Node 86, GPU 7)"];
    
    moe_13_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 696 (Node 87, GPU 0)"];
    
    moe_13_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 697 (Node 87, GPU 1)"];
    
    moe_13_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 698 (Node 87, GPU 2)"];
    
    moe_13_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 699 (Node 87, GPU 3)"];
    
    moe_13_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 700 (Node 87, GPU 4)"];
    
    moe_13_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 701 (Node 87, GPU 5)"];
    
    moe_13_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 702 (Node 87, GPU 6)"];
    
    moe_13_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 13 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 703 (Node 87, GPU 7)"];
    
    moe_13_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 13 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 640 (Node 80, GPU 0)"];
    
    moe_13_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 13 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 640 (Node 80, GPU 0)"];
    
    // MoE Layer 14 - MHA components
    moe_14_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 14 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 704 (Node 88, GPU 0)"];
    
    moe_14_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 14 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 704 (Node 88, GPU 0)"];
    
    moe_14_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 14 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 704 (Node 88, GPU 0)"];
    
    moe_14_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 14 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 704 (Node 88, GPU 0)"];
    
    moe_14_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 14 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 704 (Node 88, GPU 0)"];
    
    moe_14_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 14 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 704 (Node 88, GPU 0)"];
    
    moe_14_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 704 (Node 88, GPU 0)"];
    
    moe_14_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 705 (Node 88, GPU 1)"];
    
    moe_14_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 706 (Node 88, GPU 2)"];
    
    moe_14_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 707 (Node 88, GPU 3)"];
    
    moe_14_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 708 (Node 88, GPU 4)"];
    
    moe_14_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 709 (Node 88, GPU 5)"];
    
    moe_14_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 710 (Node 88, GPU 6)"];
    
    moe_14_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 711 (Node 88, GPU 7)"];
    
    moe_14_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 712 (Node 89, GPU 0)"];
    
    moe_14_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 713 (Node 89, GPU 1)"];
    
    moe_14_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 714 (Node 89, GPU 2)"];
    
    moe_14_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 715 (Node 89, GPU 3)"];
    
    moe_14_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 716 (Node 89, GPU 4)"];
    
    moe_14_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 717 (Node 89, GPU 5)"];
    
    moe_14_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 718 (Node 89, GPU 6)"];
    
    moe_14_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 719 (Node 89, GPU 7)"];
    
    moe_14_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 720 (Node 90, GPU 0)"];
    
    moe_14_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 721 (Node 90, GPU 1)"];
    
    moe_14_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 722 (Node 90, GPU 2)"];
    
    moe_14_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 723 (Node 90, GPU 3)"];
    
    moe_14_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 724 (Node 90, GPU 4)"];
    
    moe_14_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 725 (Node 90, GPU 5)"];
    
    moe_14_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 726 (Node 90, GPU 6)"];
    
    moe_14_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 727 (Node 90, GPU 7)"];
    
    moe_14_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 728 (Node 91, GPU 0)"];
    
    moe_14_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 729 (Node 91, GPU 1)"];
    
    moe_14_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 730 (Node 91, GPU 2)"];
    
    moe_14_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 731 (Node 91, GPU 3)"];
    
    moe_14_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 732 (Node 91, GPU 4)"];
    
    moe_14_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 733 (Node 91, GPU 5)"];
    
    moe_14_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 734 (Node 91, GPU 6)"];
    
    moe_14_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 735 (Node 91, GPU 7)"];
    
    moe_14_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 736 (Node 92, GPU 0)"];
    
    moe_14_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 737 (Node 92, GPU 1)"];
    
    moe_14_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 738 (Node 92, GPU 2)"];
    
    moe_14_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 739 (Node 92, GPU 3)"];
    
    moe_14_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 740 (Node 92, GPU 4)"];
    
    moe_14_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 741 (Node 92, GPU 5)"];
    
    moe_14_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 742 (Node 92, GPU 6)"];
    
    moe_14_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 743 (Node 92, GPU 7)"];
    
    moe_14_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 744 (Node 93, GPU 0)"];
    
    moe_14_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 745 (Node 93, GPU 1)"];
    
    moe_14_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 746 (Node 93, GPU 2)"];
    
    moe_14_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 747 (Node 93, GPU 3)"];
    
    moe_14_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 748 (Node 93, GPU 4)"];
    
    moe_14_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 749 (Node 93, GPU 5)"];
    
    moe_14_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 750 (Node 93, GPU 6)"];
    
    moe_14_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 751 (Node 93, GPU 7)"];
    
    moe_14_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 752 (Node 94, GPU 0)"];
    
    moe_14_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 753 (Node 94, GPU 1)"];
    
    moe_14_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 754 (Node 94, GPU 2)"];
    
    moe_14_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 755 (Node 94, GPU 3)"];
    
    moe_14_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 756 (Node 94, GPU 4)"];
    
    moe_14_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 757 (Node 94, GPU 5)"];
    
    moe_14_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 758 (Node 94, GPU 6)"];
    
    moe_14_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 759 (Node 94, GPU 7)"];
    
    moe_14_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 760 (Node 95, GPU 0)"];
    
    moe_14_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 761 (Node 95, GPU 1)"];
    
    moe_14_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 762 (Node 95, GPU 2)"];
    
    moe_14_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 763 (Node 95, GPU 3)"];
    
    moe_14_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 764 (Node 95, GPU 4)"];
    
    moe_14_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 765 (Node 95, GPU 5)"];
    
    moe_14_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 766 (Node 95, GPU 6)"];
    
    moe_14_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 14 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 767 (Node 95, GPU 7)"];
    
    moe_14_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 14 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 704 (Node 88, GPU 0)"];
    
    moe_14_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 14 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 704 (Node 88, GPU 0)"];
    
    // MoE Layer 15 - MHA components
    moe_15_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 15 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 768 (Node 96, GPU 0)"];
    
    moe_15_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 15 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 768 (Node 96, GPU 0)"];
    
    moe_15_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 15 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 768 (Node 96, GPU 0)"];
    
    moe_15_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 15 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 768 (Node 96, GPU 0)"];
    
    moe_15_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 15 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 768 (Node 96, GPU 0)"];
    
    moe_15_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 15 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 768 (Node 96, GPU 0)"];
    
    moe_15_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 768 (Node 96, GPU 0)"];
    
    moe_15_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 769 (Node 96, GPU 1)"];
    
    moe_15_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 770 (Node 96, GPU 2)"];
    
    moe_15_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 771 (Node 96, GPU 3)"];
    
    moe_15_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 772 (Node 96, GPU 4)"];
    
    moe_15_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 773 (Node 96, GPU 5)"];
    
    moe_15_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 774 (Node 96, GPU 6)"];
    
    moe_15_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 775 (Node 96, GPU 7)"];
    
    moe_15_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 776 (Node 97, GPU 0)"];
    
    moe_15_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 777 (Node 97, GPU 1)"];
    
    moe_15_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 778 (Node 97, GPU 2)"];
    
    moe_15_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 779 (Node 97, GPU 3)"];
    
    moe_15_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 780 (Node 97, GPU 4)"];
    
    moe_15_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 781 (Node 97, GPU 5)"];
    
    moe_15_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 782 (Node 97, GPU 6)"];
    
    moe_15_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 783 (Node 97, GPU 7)"];
    
    moe_15_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 784 (Node 98, GPU 0)"];
    
    moe_15_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 785 (Node 98, GPU 1)"];
    
    moe_15_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 786 (Node 98, GPU 2)"];
    
    moe_15_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 787 (Node 98, GPU 3)"];
    
    moe_15_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 788 (Node 98, GPU 4)"];
    
    moe_15_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 789 (Node 98, GPU 5)"];
    
    moe_15_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 790 (Node 98, GPU 6)"];
    
    moe_15_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 791 (Node 98, GPU 7)"];
    
    moe_15_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 792 (Node 99, GPU 0)"];
    
    moe_15_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 793 (Node 99, GPU 1)"];
    
    moe_15_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 794 (Node 99, GPU 2)"];
    
    moe_15_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 795 (Node 99, GPU 3)"];
    
    moe_15_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 796 (Node 99, GPU 4)"];
    
    moe_15_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 797 (Node 99, GPU 5)"];
    
    moe_15_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 798 (Node 99, GPU 6)"];
    
    moe_15_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 799 (Node 99, GPU 7)"];
    
    moe_15_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 800 (Node 100, GPU 0)"];
    
    moe_15_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 801 (Node 100, GPU 1)"];
    
    moe_15_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 802 (Node 100, GPU 2)"];
    
    moe_15_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 803 (Node 100, GPU 3)"];
    
    moe_15_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 804 (Node 100, GPU 4)"];
    
    moe_15_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 805 (Node 100, GPU 5)"];
    
    moe_15_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 806 (Node 100, GPU 6)"];
    
    moe_15_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 807 (Node 100, GPU 7)"];
    
    moe_15_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 808 (Node 101, GPU 0)"];
    
    moe_15_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 809 (Node 101, GPU 1)"];
    
    moe_15_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 810 (Node 101, GPU 2)"];
    
    moe_15_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 811 (Node 101, GPU 3)"];
    
    moe_15_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 812 (Node 101, GPU 4)"];
    
    moe_15_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 813 (Node 101, GPU 5)"];
    
    moe_15_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 814 (Node 101, GPU 6)"];
    
    moe_15_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 815 (Node 101, GPU 7)"];
    
    moe_15_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 816 (Node 102, GPU 0)"];
    
    moe_15_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 817 (Node 102, GPU 1)"];
    
    moe_15_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 818 (Node 102, GPU 2)"];
    
    moe_15_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 819 (Node 102, GPU 3)"];
    
    moe_15_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 820 (Node 102, GPU 4)"];
    
    moe_15_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 821 (Node 102, GPU 5)"];
    
    moe_15_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 822 (Node 102, GPU 6)"];
    
    moe_15_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 823 (Node 102, GPU 7)"];
    
    moe_15_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 824 (Node 103, GPU 0)"];
    
    moe_15_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 825 (Node 103, GPU 1)"];
    
    moe_15_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 826 (Node 103, GPU 2)"];
    
    moe_15_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 827 (Node 103, GPU 3)"];
    
    moe_15_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 828 (Node 103, GPU 4)"];
    
    moe_15_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 829 (Node 103, GPU 5)"];
    
    moe_15_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 830 (Node 103, GPU 6)"];
    
    moe_15_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 15 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 831 (Node 103, GPU 7)"];
    
    moe_15_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 15 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 768 (Node 96, GPU 0)"];
    
    moe_15_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 15 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 768 (Node 96, GPU 0)"];
    
    // MoE Layer 16 - MHA components
    moe_16_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 16 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 832 (Node 104, GPU 0)"];
    
    moe_16_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 16 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 832 (Node 104, GPU 0)"];
    
    moe_16_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 16 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 832 (Node 104, GPU 0)"];
    
    moe_16_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 16 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 832 (Node 104, GPU 0)"];
    
    moe_16_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 16 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 832 (Node 104, GPU 0)"];
    
    moe_16_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 16 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 832 (Node 104, GPU 0)"];
    
    moe_16_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 832 (Node 104, GPU 0)"];
    
    moe_16_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 833 (Node 104, GPU 1)"];
    
    moe_16_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 834 (Node 104, GPU 2)"];
    
    moe_16_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 835 (Node 104, GPU 3)"];
    
    moe_16_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 836 (Node 104, GPU 4)"];
    
    moe_16_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 837 (Node 104, GPU 5)"];
    
    moe_16_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 838 (Node 104, GPU 6)"];
    
    moe_16_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 839 (Node 104, GPU 7)"];
    
    moe_16_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 840 (Node 105, GPU 0)"];
    
    moe_16_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 841 (Node 105, GPU 1)"];
    
    moe_16_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 842 (Node 105, GPU 2)"];
    
    moe_16_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 843 (Node 105, GPU 3)"];
    
    moe_16_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 844 (Node 105, GPU 4)"];
    
    moe_16_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 845 (Node 105, GPU 5)"];
    
    moe_16_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 846 (Node 105, GPU 6)"];
    
    moe_16_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 847 (Node 105, GPU 7)"];
    
    moe_16_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 848 (Node 106, GPU 0)"];
    
    moe_16_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 849 (Node 106, GPU 1)"];
    
    moe_16_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 850 (Node 106, GPU 2)"];
    
    moe_16_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 851 (Node 106, GPU 3)"];
    
    moe_16_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 852 (Node 106, GPU 4)"];
    
    moe_16_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 853 (Node 106, GPU 5)"];
    
    moe_16_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 854 (Node 106, GPU 6)"];
    
    moe_16_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 855 (Node 106, GPU 7)"];
    
    moe_16_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 856 (Node 107, GPU 0)"];
    
    moe_16_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 857 (Node 107, GPU 1)"];
    
    moe_16_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 858 (Node 107, GPU 2)"];
    
    moe_16_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 859 (Node 107, GPU 3)"];
    
    moe_16_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 860 (Node 107, GPU 4)"];
    
    moe_16_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 861 (Node 107, GPU 5)"];
    
    moe_16_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 862 (Node 107, GPU 6)"];
    
    moe_16_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 863 (Node 107, GPU 7)"];
    
    moe_16_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 864 (Node 108, GPU 0)"];
    
    moe_16_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 865 (Node 108, GPU 1)"];
    
    moe_16_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 866 (Node 108, GPU 2)"];
    
    moe_16_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 867 (Node 108, GPU 3)"];
    
    moe_16_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 868 (Node 108, GPU 4)"];
    
    moe_16_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 869 (Node 108, GPU 5)"];
    
    moe_16_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 870 (Node 108, GPU 6)"];
    
    moe_16_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 871 (Node 108, GPU 7)"];
    
    moe_16_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 872 (Node 109, GPU 0)"];
    
    moe_16_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 873 (Node 109, GPU 1)"];
    
    moe_16_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 874 (Node 109, GPU 2)"];
    
    moe_16_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 875 (Node 109, GPU 3)"];
    
    moe_16_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 876 (Node 109, GPU 4)"];
    
    moe_16_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 877 (Node 109, GPU 5)"];
    
    moe_16_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 878 (Node 109, GPU 6)"];
    
    moe_16_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 879 (Node 109, GPU 7)"];
    
    moe_16_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 880 (Node 110, GPU 0)"];
    
    moe_16_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 881 (Node 110, GPU 1)"];
    
    moe_16_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 882 (Node 110, GPU 2)"];
    
    moe_16_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 883 (Node 110, GPU 3)"];
    
    moe_16_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 884 (Node 110, GPU 4)"];
    
    moe_16_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 885 (Node 110, GPU 5)"];
    
    moe_16_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 886 (Node 110, GPU 6)"];
    
    moe_16_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 887 (Node 110, GPU 7)"];
    
    moe_16_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 888 (Node 111, GPU 0)"];
    
    moe_16_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 889 (Node 111, GPU 1)"];
    
    moe_16_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 890 (Node 111, GPU 2)"];
    
    moe_16_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 891 (Node 111, GPU 3)"];
    
    moe_16_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 892 (Node 111, GPU 4)"];
    
    moe_16_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 893 (Node 111, GPU 5)"];
    
    moe_16_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 894 (Node 111, GPU 6)"];
    
    moe_16_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 16 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 895 (Node 111, GPU 7)"];
    
    moe_16_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 16 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 832 (Node 104, GPU 0)"];
    
    moe_16_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 16 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 832 (Node 104, GPU 0)"];
    
    // MoE Layer 17 - MHA components
    moe_17_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 17 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 896 (Node 112, GPU 0)"];
    
    moe_17_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 17 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 896 (Node 112, GPU 0)"];
    
    moe_17_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 17 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 896 (Node 112, GPU 0)"];
    
    moe_17_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 17 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 896 (Node 112, GPU 0)"];
    
    moe_17_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 17 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 896 (Node 112, GPU 0)"];
    
    moe_17_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 17 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 896 (Node 112, GPU 0)"];
    
    moe_17_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 896 (Node 112, GPU 0)"];
    
    moe_17_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 897 (Node 112, GPU 1)"];
    
    moe_17_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 898 (Node 112, GPU 2)"];
    
    moe_17_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 899 (Node 112, GPU 3)"];
    
    moe_17_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 900 (Node 112, GPU 4)"];
    
    moe_17_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 901 (Node 112, GPU 5)"];
    
    moe_17_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 902 (Node 112, GPU 6)"];
    
    moe_17_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 903 (Node 112, GPU 7)"];
    
    moe_17_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 904 (Node 113, GPU 0)"];
    
    moe_17_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 905 (Node 113, GPU 1)"];
    
    moe_17_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 906 (Node 113, GPU 2)"];
    
    moe_17_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 907 (Node 113, GPU 3)"];
    
    moe_17_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 908 (Node 113, GPU 4)"];
    
    moe_17_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 909 (Node 113, GPU 5)"];
    
    moe_17_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 910 (Node 113, GPU 6)"];
    
    moe_17_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 911 (Node 113, GPU 7)"];
    
    moe_17_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 912 (Node 114, GPU 0)"];
    
    moe_17_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 913 (Node 114, GPU 1)"];
    
    moe_17_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 914 (Node 114, GPU 2)"];
    
    moe_17_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 915 (Node 114, GPU 3)"];
    
    moe_17_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 916 (Node 114, GPU 4)"];
    
    moe_17_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 917 (Node 114, GPU 5)"];
    
    moe_17_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 918 (Node 114, GPU 6)"];
    
    moe_17_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 919 (Node 114, GPU 7)"];
    
    moe_17_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 920 (Node 115, GPU 0)"];
    
    moe_17_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 921 (Node 115, GPU 1)"];
    
    moe_17_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 922 (Node 115, GPU 2)"];
    
    moe_17_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 923 (Node 115, GPU 3)"];
    
    moe_17_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 924 (Node 115, GPU 4)"];
    
    moe_17_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 925 (Node 115, GPU 5)"];
    
    moe_17_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 926 (Node 115, GPU 6)"];
    
    moe_17_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 927 (Node 115, GPU 7)"];
    
    moe_17_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 928 (Node 116, GPU 0)"];
    
    moe_17_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 929 (Node 116, GPU 1)"];
    
    moe_17_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 930 (Node 116, GPU 2)"];
    
    moe_17_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 931 (Node 116, GPU 3)"];
    
    moe_17_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 932 (Node 116, GPU 4)"];
    
    moe_17_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 933 (Node 116, GPU 5)"];
    
    moe_17_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 934 (Node 116, GPU 6)"];
    
    moe_17_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 935 (Node 116, GPU 7)"];
    
    moe_17_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 936 (Node 117, GPU 0)"];
    
    moe_17_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 937 (Node 117, GPU 1)"];
    
    moe_17_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 938 (Node 117, GPU 2)"];
    
    moe_17_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 939 (Node 117, GPU 3)"];
    
    moe_17_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 940 (Node 117, GPU 4)"];
    
    moe_17_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 941 (Node 117, GPU 5)"];
    
    moe_17_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 942 (Node 117, GPU 6)"];
    
    moe_17_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 943 (Node 117, GPU 7)"];
    
    moe_17_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 944 (Node 118, GPU 0)"];
    
    moe_17_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 945 (Node 118, GPU 1)"];
    
    moe_17_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 946 (Node 118, GPU 2)"];
    
    moe_17_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 947 (Node 118, GPU 3)"];
    
    moe_17_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 948 (Node 118, GPU 4)"];
    
    moe_17_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 949 (Node 118, GPU 5)"];
    
    moe_17_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 950 (Node 118, GPU 6)"];
    
    moe_17_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 951 (Node 118, GPU 7)"];
    
    moe_17_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 952 (Node 119, GPU 0)"];
    
    moe_17_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 953 (Node 119, GPU 1)"];
    
    moe_17_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 954 (Node 119, GPU 2)"];
    
    moe_17_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 955 (Node 119, GPU 3)"];
    
    moe_17_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 956 (Node 119, GPU 4)"];
    
    moe_17_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 957 (Node 119, GPU 5)"];
    
    moe_17_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 958 (Node 119, GPU 6)"];
    
    moe_17_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 17 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 959 (Node 119, GPU 7)"];
    
    moe_17_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 17 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 896 (Node 112, GPU 0)"];
    
    moe_17_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 17 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 896 (Node 112, GPU 0)"];
    
    // MoE Layer 18 - MHA components
    moe_18_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 18 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 960 (Node 120, GPU 0)"];
    
    moe_18_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 18 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 960 (Node 120, GPU 0)"];
    
    moe_18_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 18 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 960 (Node 120, GPU 0)"];
    
    moe_18_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 18 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 960 (Node 120, GPU 0)"];
    
    moe_18_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 18 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 960 (Node 120, GPU 0)"];
    
    moe_18_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 18 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 960 (Node 120, GPU 0)"];
    
    moe_18_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 960 (Node 120, GPU 0)"];
    
    moe_18_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 961 (Node 120, GPU 1)"];
    
    moe_18_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 962 (Node 120, GPU 2)"];
    
    moe_18_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 963 (Node 120, GPU 3)"];
    
    moe_18_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 964 (Node 120, GPU 4)"];
    
    moe_18_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 965 (Node 120, GPU 5)"];
    
    moe_18_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 966 (Node 120, GPU 6)"];
    
    moe_18_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 967 (Node 120, GPU 7)"];
    
    moe_18_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 968 (Node 121, GPU 0)"];
    
    moe_18_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 969 (Node 121, GPU 1)"];
    
    moe_18_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 970 (Node 121, GPU 2)"];
    
    moe_18_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 971 (Node 121, GPU 3)"];
    
    moe_18_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 972 (Node 121, GPU 4)"];
    
    moe_18_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 973 (Node 121, GPU 5)"];
    
    moe_18_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 974 (Node 121, GPU 6)"];
    
    moe_18_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 975 (Node 121, GPU 7)"];
    
    moe_18_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 976 (Node 122, GPU 0)"];
    
    moe_18_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 977 (Node 122, GPU 1)"];
    
    moe_18_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 978 (Node 122, GPU 2)"];
    
    moe_18_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 979 (Node 122, GPU 3)"];
    
    moe_18_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 980 (Node 122, GPU 4)"];
    
    moe_18_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 981 (Node 122, GPU 5)"];
    
    moe_18_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 982 (Node 122, GPU 6)"];
    
    moe_18_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 983 (Node 122, GPU 7)"];
    
    moe_18_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 984 (Node 123, GPU 0)"];
    
    moe_18_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 985 (Node 123, GPU 1)"];
    
    moe_18_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 986 (Node 123, GPU 2)"];
    
    moe_18_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 987 (Node 123, GPU 3)"];
    
    moe_18_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 988 (Node 123, GPU 4)"];
    
    moe_18_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 989 (Node 123, GPU 5)"];
    
    moe_18_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 990 (Node 123, GPU 6)"];
    
    moe_18_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 991 (Node 123, GPU 7)"];
    
    moe_18_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 992 (Node 124, GPU 0)"];
    
    moe_18_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 993 (Node 124, GPU 1)"];
    
    moe_18_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 994 (Node 124, GPU 2)"];
    
    moe_18_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 995 (Node 124, GPU 3)"];
    
    moe_18_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 996 (Node 124, GPU 4)"];
    
    moe_18_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 997 (Node 124, GPU 5)"];
    
    moe_18_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 998 (Node 124, GPU 6)"];
    
    moe_18_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 999 (Node 124, GPU 7)"];
    
    moe_18_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1000 (Node 125, GPU 0)"];
    
    moe_18_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1001 (Node 125, GPU 1)"];
    
    moe_18_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1002 (Node 125, GPU 2)"];
    
    moe_18_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1003 (Node 125, GPU 3)"];
    
    moe_18_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1004 (Node 125, GPU 4)"];
    
    moe_18_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1005 (Node 125, GPU 5)"];
    
    moe_18_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1006 (Node 125, GPU 6)"];
    
    moe_18_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1007 (Node 125, GPU 7)"];
    
    moe_18_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1008 (Node 126, GPU 0)"];
    
    moe_18_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1009 (Node 126, GPU 1)"];
    
    moe_18_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1010 (Node 126, GPU 2)"];
    
    moe_18_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1011 (Node 126, GPU 3)"];
    
    moe_18_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1012 (Node 126, GPU 4)"];
    
    moe_18_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1013 (Node 126, GPU 5)"];
    
    moe_18_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1014 (Node 126, GPU 6)"];
    
    moe_18_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1015 (Node 126, GPU 7)"];
    
    moe_18_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1016 (Node 127, GPU 0)"];
    
    moe_18_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1017 (Node 127, GPU 1)"];
    
    moe_18_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1018 (Node 127, GPU 2)"];
    
    moe_18_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1019 (Node 127, GPU 3)"];
    
    moe_18_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1020 (Node 127, GPU 4)"];
    
    moe_18_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1021 (Node 127, GPU 5)"];
    
    moe_18_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1022 (Node 127, GPU 6)"];
    
    moe_18_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 18 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1023 (Node 127, GPU 7)"];
    
    moe_18_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 18 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 960 (Node 120, GPU 0)"];
    
    moe_18_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 18 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 960 (Node 120, GPU 0)"];
    
    // MoE Layer 19 - MHA components
    moe_19_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 19 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1024 (Node 128, GPU 0)"];
    
    moe_19_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 19 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1024 (Node 128, GPU 0)"];
    
    moe_19_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 19 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1024 (Node 128, GPU 0)"];
    
    moe_19_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 19 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1024 (Node 128, GPU 0)"];
    
    moe_19_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 19 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1024 (Node 128, GPU 0)"];
    
    moe_19_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 19 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1024 (Node 128, GPU 0)"];
    
    moe_19_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1024 (Node 128, GPU 0)"];
    
    moe_19_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1025 (Node 128, GPU 1)"];
    
    moe_19_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1026 (Node 128, GPU 2)"];
    
    moe_19_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1027 (Node 128, GPU 3)"];
    
    moe_19_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1028 (Node 128, GPU 4)"];
    
    moe_19_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1029 (Node 128, GPU 5)"];
    
    moe_19_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1030 (Node 128, GPU 6)"];
    
    moe_19_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1031 (Node 128, GPU 7)"];
    
    moe_19_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1032 (Node 129, GPU 0)"];
    
    moe_19_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1033 (Node 129, GPU 1)"];
    
    moe_19_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1034 (Node 129, GPU 2)"];
    
    moe_19_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1035 (Node 129, GPU 3)"];
    
    moe_19_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1036 (Node 129, GPU 4)"];
    
    moe_19_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1037 (Node 129, GPU 5)"];
    
    moe_19_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1038 (Node 129, GPU 6)"];
    
    moe_19_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1039 (Node 129, GPU 7)"];
    
    moe_19_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1040 (Node 130, GPU 0)"];
    
    moe_19_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1041 (Node 130, GPU 1)"];
    
    moe_19_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1042 (Node 130, GPU 2)"];
    
    moe_19_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1043 (Node 130, GPU 3)"];
    
    moe_19_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1044 (Node 130, GPU 4)"];
    
    moe_19_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1045 (Node 130, GPU 5)"];
    
    moe_19_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1046 (Node 130, GPU 6)"];
    
    moe_19_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1047 (Node 130, GPU 7)"];
    
    moe_19_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1048 (Node 131, GPU 0)"];
    
    moe_19_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1049 (Node 131, GPU 1)"];
    
    moe_19_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1050 (Node 131, GPU 2)"];
    
    moe_19_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1051 (Node 131, GPU 3)"];
    
    moe_19_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1052 (Node 131, GPU 4)"];
    
    moe_19_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1053 (Node 131, GPU 5)"];
    
    moe_19_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1054 (Node 131, GPU 6)"];
    
    moe_19_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1055 (Node 131, GPU 7)"];
    
    moe_19_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1056 (Node 132, GPU 0)"];
    
    moe_19_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1057 (Node 132, GPU 1)"];
    
    moe_19_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1058 (Node 132, GPU 2)"];
    
    moe_19_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1059 (Node 132, GPU 3)"];
    
    moe_19_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1060 (Node 132, GPU 4)"];
    
    moe_19_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1061 (Node 132, GPU 5)"];
    
    moe_19_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1062 (Node 132, GPU 6)"];
    
    moe_19_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1063 (Node 132, GPU 7)"];
    
    moe_19_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1064 (Node 133, GPU 0)"];
    
    moe_19_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1065 (Node 133, GPU 1)"];
    
    moe_19_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1066 (Node 133, GPU 2)"];
    
    moe_19_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1067 (Node 133, GPU 3)"];
    
    moe_19_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1068 (Node 133, GPU 4)"];
    
    moe_19_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1069 (Node 133, GPU 5)"];
    
    moe_19_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1070 (Node 133, GPU 6)"];
    
    moe_19_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1071 (Node 133, GPU 7)"];
    
    moe_19_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1072 (Node 134, GPU 0)"];
    
    moe_19_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1073 (Node 134, GPU 1)"];
    
    moe_19_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1074 (Node 134, GPU 2)"];
    
    moe_19_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1075 (Node 134, GPU 3)"];
    
    moe_19_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1076 (Node 134, GPU 4)"];
    
    moe_19_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1077 (Node 134, GPU 5)"];
    
    moe_19_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1078 (Node 134, GPU 6)"];
    
    moe_19_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1079 (Node 134, GPU 7)"];
    
    moe_19_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1080 (Node 135, GPU 0)"];
    
    moe_19_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1081 (Node 135, GPU 1)"];
    
    moe_19_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1082 (Node 135, GPU 2)"];
    
    moe_19_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1083 (Node 135, GPU 3)"];
    
    moe_19_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1084 (Node 135, GPU 4)"];
    
    moe_19_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1085 (Node 135, GPU 5)"];
    
    moe_19_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1086 (Node 135, GPU 6)"];
    
    moe_19_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 19 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1087 (Node 135, GPU 7)"];
    
    moe_19_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 19 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1024 (Node 128, GPU 0)"];
    
    moe_19_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 19 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1024 (Node 128, GPU 0)"];
    
    // MoE Layer 20 - MHA components
    moe_20_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 20 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1088 (Node 136, GPU 0)"];
    
    moe_20_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 20 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1088 (Node 136, GPU 0)"];
    
    moe_20_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 20 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1088 (Node 136, GPU 0)"];
    
    moe_20_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 20 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1088 (Node 136, GPU 0)"];
    
    moe_20_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 20 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1088 (Node 136, GPU 0)"];
    
    moe_20_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 20 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1088 (Node 136, GPU 0)"];
    
    moe_20_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1088 (Node 136, GPU 0)"];
    
    moe_20_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1089 (Node 136, GPU 1)"];
    
    moe_20_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1090 (Node 136, GPU 2)"];
    
    moe_20_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1091 (Node 136, GPU 3)"];
    
    moe_20_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1092 (Node 136, GPU 4)"];
    
    moe_20_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1093 (Node 136, GPU 5)"];
    
    moe_20_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1094 (Node 136, GPU 6)"];
    
    moe_20_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1095 (Node 136, GPU 7)"];
    
    moe_20_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1096 (Node 137, GPU 0)"];
    
    moe_20_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1097 (Node 137, GPU 1)"];
    
    moe_20_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1098 (Node 137, GPU 2)"];
    
    moe_20_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1099 (Node 137, GPU 3)"];
    
    moe_20_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1100 (Node 137, GPU 4)"];
    
    moe_20_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1101 (Node 137, GPU 5)"];
    
    moe_20_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1102 (Node 137, GPU 6)"];
    
    moe_20_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1103 (Node 137, GPU 7)"];
    
    moe_20_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1104 (Node 138, GPU 0)"];
    
    moe_20_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1105 (Node 138, GPU 1)"];
    
    moe_20_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1106 (Node 138, GPU 2)"];
    
    moe_20_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1107 (Node 138, GPU 3)"];
    
    moe_20_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1108 (Node 138, GPU 4)"];
    
    moe_20_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1109 (Node 138, GPU 5)"];
    
    moe_20_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1110 (Node 138, GPU 6)"];
    
    moe_20_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1111 (Node 138, GPU 7)"];
    
    moe_20_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1112 (Node 139, GPU 0)"];
    
    moe_20_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1113 (Node 139, GPU 1)"];
    
    moe_20_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1114 (Node 139, GPU 2)"];
    
    moe_20_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1115 (Node 139, GPU 3)"];
    
    moe_20_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1116 (Node 139, GPU 4)"];
    
    moe_20_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1117 (Node 139, GPU 5)"];
    
    moe_20_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1118 (Node 139, GPU 6)"];
    
    moe_20_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1119 (Node 139, GPU 7)"];
    
    moe_20_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1120 (Node 140, GPU 0)"];
    
    moe_20_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1121 (Node 140, GPU 1)"];
    
    moe_20_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1122 (Node 140, GPU 2)"];
    
    moe_20_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1123 (Node 140, GPU 3)"];
    
    moe_20_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1124 (Node 140, GPU 4)"];
    
    moe_20_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1125 (Node 140, GPU 5)"];
    
    moe_20_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1126 (Node 140, GPU 6)"];
    
    moe_20_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1127 (Node 140, GPU 7)"];
    
    moe_20_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1128 (Node 141, GPU 0)"];
    
    moe_20_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1129 (Node 141, GPU 1)"];
    
    moe_20_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1130 (Node 141, GPU 2)"];
    
    moe_20_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1131 (Node 141, GPU 3)"];
    
    moe_20_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1132 (Node 141, GPU 4)"];
    
    moe_20_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1133 (Node 141, GPU 5)"];
    
    moe_20_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1134 (Node 141, GPU 6)"];
    
    moe_20_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1135 (Node 141, GPU 7)"];
    
    moe_20_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1136 (Node 142, GPU 0)"];
    
    moe_20_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1137 (Node 142, GPU 1)"];
    
    moe_20_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1138 (Node 142, GPU 2)"];
    
    moe_20_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1139 (Node 142, GPU 3)"];
    
    moe_20_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1140 (Node 142, GPU 4)"];
    
    moe_20_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1141 (Node 142, GPU 5)"];
    
    moe_20_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1142 (Node 142, GPU 6)"];
    
    moe_20_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1143 (Node 142, GPU 7)"];
    
    moe_20_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1144 (Node 143, GPU 0)"];
    
    moe_20_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1145 (Node 143, GPU 1)"];
    
    moe_20_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1146 (Node 143, GPU 2)"];
    
    moe_20_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1147 (Node 143, GPU 3)"];
    
    moe_20_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1148 (Node 143, GPU 4)"];
    
    moe_20_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1149 (Node 143, GPU 5)"];
    
    moe_20_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1150 (Node 143, GPU 6)"];
    
    moe_20_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 20 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1151 (Node 143, GPU 7)"];
    
    moe_20_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 20 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1088 (Node 136, GPU 0)"];
    
    moe_20_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 20 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1088 (Node 136, GPU 0)"];
    
    // MoE Layer 21 - MHA components
    moe_21_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 21 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1152 (Node 144, GPU 0)"];
    
    moe_21_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 21 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1152 (Node 144, GPU 0)"];
    
    moe_21_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 21 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1152 (Node 144, GPU 0)"];
    
    moe_21_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 21 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1152 (Node 144, GPU 0)"];
    
    moe_21_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 21 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1152 (Node 144, GPU 0)"];
    
    moe_21_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 21 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1152 (Node 144, GPU 0)"];
    
    moe_21_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1152 (Node 144, GPU 0)"];
    
    moe_21_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1153 (Node 144, GPU 1)"];
    
    moe_21_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1154 (Node 144, GPU 2)"];
    
    moe_21_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1155 (Node 144, GPU 3)"];
    
    moe_21_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1156 (Node 144, GPU 4)"];
    
    moe_21_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1157 (Node 144, GPU 5)"];
    
    moe_21_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1158 (Node 144, GPU 6)"];
    
    moe_21_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1159 (Node 144, GPU 7)"];
    
    moe_21_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1160 (Node 145, GPU 0)"];
    
    moe_21_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1161 (Node 145, GPU 1)"];
    
    moe_21_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1162 (Node 145, GPU 2)"];
    
    moe_21_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1163 (Node 145, GPU 3)"];
    
    moe_21_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1164 (Node 145, GPU 4)"];
    
    moe_21_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1165 (Node 145, GPU 5)"];
    
    moe_21_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1166 (Node 145, GPU 6)"];
    
    moe_21_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1167 (Node 145, GPU 7)"];
    
    moe_21_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1168 (Node 146, GPU 0)"];
    
    moe_21_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1169 (Node 146, GPU 1)"];
    
    moe_21_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1170 (Node 146, GPU 2)"];
    
    moe_21_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1171 (Node 146, GPU 3)"];
    
    moe_21_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1172 (Node 146, GPU 4)"];
    
    moe_21_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1173 (Node 146, GPU 5)"];
    
    moe_21_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1174 (Node 146, GPU 6)"];
    
    moe_21_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1175 (Node 146, GPU 7)"];
    
    moe_21_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1176 (Node 147, GPU 0)"];
    
    moe_21_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1177 (Node 147, GPU 1)"];
    
    moe_21_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1178 (Node 147, GPU 2)"];
    
    moe_21_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1179 (Node 147, GPU 3)"];
    
    moe_21_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1180 (Node 147, GPU 4)"];
    
    moe_21_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1181 (Node 147, GPU 5)"];
    
    moe_21_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1182 (Node 147, GPU 6)"];
    
    moe_21_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1183 (Node 147, GPU 7)"];
    
    moe_21_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1184 (Node 148, GPU 0)"];
    
    moe_21_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1185 (Node 148, GPU 1)"];
    
    moe_21_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1186 (Node 148, GPU 2)"];
    
    moe_21_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1187 (Node 148, GPU 3)"];
    
    moe_21_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1188 (Node 148, GPU 4)"];
    
    moe_21_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1189 (Node 148, GPU 5)"];
    
    moe_21_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1190 (Node 148, GPU 6)"];
    
    moe_21_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1191 (Node 148, GPU 7)"];
    
    moe_21_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1192 (Node 149, GPU 0)"];
    
    moe_21_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1193 (Node 149, GPU 1)"];
    
    moe_21_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1194 (Node 149, GPU 2)"];
    
    moe_21_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1195 (Node 149, GPU 3)"];
    
    moe_21_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1196 (Node 149, GPU 4)"];
    
    moe_21_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1197 (Node 149, GPU 5)"];
    
    moe_21_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1198 (Node 149, GPU 6)"];
    
    moe_21_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1199 (Node 149, GPU 7)"];
    
    moe_21_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1200 (Node 150, GPU 0)"];
    
    moe_21_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1201 (Node 150, GPU 1)"];
    
    moe_21_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1202 (Node 150, GPU 2)"];
    
    moe_21_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1203 (Node 150, GPU 3)"];
    
    moe_21_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1204 (Node 150, GPU 4)"];
    
    moe_21_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1205 (Node 150, GPU 5)"];
    
    moe_21_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1206 (Node 150, GPU 6)"];
    
    moe_21_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1207 (Node 150, GPU 7)"];
    
    moe_21_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1208 (Node 151, GPU 0)"];
    
    moe_21_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1209 (Node 151, GPU 1)"];
    
    moe_21_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1210 (Node 151, GPU 2)"];
    
    moe_21_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1211 (Node 151, GPU 3)"];
    
    moe_21_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1212 (Node 151, GPU 4)"];
    
    moe_21_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1213 (Node 151, GPU 5)"];
    
    moe_21_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1214 (Node 151, GPU 6)"];
    
    moe_21_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 21 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1215 (Node 151, GPU 7)"];
    
    moe_21_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 21 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1152 (Node 144, GPU 0)"];
    
    moe_21_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 21 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1152 (Node 144, GPU 0)"];
    
    // MoE Layer 22 - MHA components
    moe_22_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 22 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1216 (Node 152, GPU 0)"];
    
    moe_22_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 22 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1216 (Node 152, GPU 0)"];
    
    moe_22_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 22 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1216 (Node 152, GPU 0)"];
    
    moe_22_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 22 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1216 (Node 152, GPU 0)"];
    
    moe_22_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 22 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1216 (Node 152, GPU 0)"];
    
    moe_22_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 22 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1216 (Node 152, GPU 0)"];
    
    moe_22_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1216 (Node 152, GPU 0)"];
    
    moe_22_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1217 (Node 152, GPU 1)"];
    
    moe_22_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1218 (Node 152, GPU 2)"];
    
    moe_22_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1219 (Node 152, GPU 3)"];
    
    moe_22_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1220 (Node 152, GPU 4)"];
    
    moe_22_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1221 (Node 152, GPU 5)"];
    
    moe_22_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1222 (Node 152, GPU 6)"];
    
    moe_22_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1223 (Node 152, GPU 7)"];
    
    moe_22_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1224 (Node 153, GPU 0)"];
    
    moe_22_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1225 (Node 153, GPU 1)"];
    
    moe_22_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1226 (Node 153, GPU 2)"];
    
    moe_22_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1227 (Node 153, GPU 3)"];
    
    moe_22_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1228 (Node 153, GPU 4)"];
    
    moe_22_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1229 (Node 153, GPU 5)"];
    
    moe_22_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1230 (Node 153, GPU 6)"];
    
    moe_22_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1231 (Node 153, GPU 7)"];
    
    moe_22_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1232 (Node 154, GPU 0)"];
    
    moe_22_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1233 (Node 154, GPU 1)"];
    
    moe_22_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1234 (Node 154, GPU 2)"];
    
    moe_22_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1235 (Node 154, GPU 3)"];
    
    moe_22_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1236 (Node 154, GPU 4)"];
    
    moe_22_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1237 (Node 154, GPU 5)"];
    
    moe_22_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1238 (Node 154, GPU 6)"];
    
    moe_22_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1239 (Node 154, GPU 7)"];
    
    moe_22_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1240 (Node 155, GPU 0)"];
    
    moe_22_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1241 (Node 155, GPU 1)"];
    
    moe_22_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1242 (Node 155, GPU 2)"];
    
    moe_22_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1243 (Node 155, GPU 3)"];
    
    moe_22_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1244 (Node 155, GPU 4)"];
    
    moe_22_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1245 (Node 155, GPU 5)"];
    
    moe_22_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1246 (Node 155, GPU 6)"];
    
    moe_22_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1247 (Node 155, GPU 7)"];
    
    moe_22_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1248 (Node 156, GPU 0)"];
    
    moe_22_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1249 (Node 156, GPU 1)"];
    
    moe_22_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1250 (Node 156, GPU 2)"];
    
    moe_22_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1251 (Node 156, GPU 3)"];
    
    moe_22_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1252 (Node 156, GPU 4)"];
    
    moe_22_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1253 (Node 156, GPU 5)"];
    
    moe_22_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1254 (Node 156, GPU 6)"];
    
    moe_22_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1255 (Node 156, GPU 7)"];
    
    moe_22_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1256 (Node 157, GPU 0)"];
    
    moe_22_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1257 (Node 157, GPU 1)"];
    
    moe_22_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1258 (Node 157, GPU 2)"];
    
    moe_22_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1259 (Node 157, GPU 3)"];
    
    moe_22_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1260 (Node 157, GPU 4)"];
    
    moe_22_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1261 (Node 157, GPU 5)"];
    
    moe_22_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1262 (Node 157, GPU 6)"];
    
    moe_22_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1263 (Node 157, GPU 7)"];
    
    moe_22_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1264 (Node 158, GPU 0)"];
    
    moe_22_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1265 (Node 158, GPU 1)"];
    
    moe_22_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1266 (Node 158, GPU 2)"];
    
    moe_22_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1267 (Node 158, GPU 3)"];
    
    moe_22_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1268 (Node 158, GPU 4)"];
    
    moe_22_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1269 (Node 158, GPU 5)"];
    
    moe_22_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1270 (Node 158, GPU 6)"];
    
    moe_22_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1271 (Node 158, GPU 7)"];
    
    moe_22_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1272 (Node 159, GPU 0)"];
    
    moe_22_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1273 (Node 159, GPU 1)"];
    
    moe_22_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1274 (Node 159, GPU 2)"];
    
    moe_22_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1275 (Node 159, GPU 3)"];
    
    moe_22_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1276 (Node 159, GPU 4)"];
    
    moe_22_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1277 (Node 159, GPU 5)"];
    
    moe_22_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1278 (Node 159, GPU 6)"];
    
    moe_22_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 22 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1279 (Node 159, GPU 7)"];
    
    moe_22_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 22 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1216 (Node 152, GPU 0)"];
    
    moe_22_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 22 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1216 (Node 152, GPU 0)"];
    
    // MoE Layer 23 - MHA components
    moe_23_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 23 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1280 (Node 160, GPU 0)"];
    
    moe_23_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 23 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1280 (Node 160, GPU 0)"];
    
    moe_23_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 23 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1280 (Node 160, GPU 0)"];
    
    moe_23_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 23 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1280 (Node 160, GPU 0)"];
    
    moe_23_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 23 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1280 (Node 160, GPU 0)"];
    
    moe_23_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 23 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1280 (Node 160, GPU 0)"];
    
    moe_23_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1280 (Node 160, GPU 0)"];
    
    moe_23_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1281 (Node 160, GPU 1)"];
    
    moe_23_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1282 (Node 160, GPU 2)"];
    
    moe_23_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1283 (Node 160, GPU 3)"];
    
    moe_23_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1284 (Node 160, GPU 4)"];
    
    moe_23_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1285 (Node 160, GPU 5)"];
    
    moe_23_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1286 (Node 160, GPU 6)"];
    
    moe_23_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1287 (Node 160, GPU 7)"];
    
    moe_23_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1288 (Node 161, GPU 0)"];
    
    moe_23_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1289 (Node 161, GPU 1)"];
    
    moe_23_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1290 (Node 161, GPU 2)"];
    
    moe_23_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1291 (Node 161, GPU 3)"];
    
    moe_23_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1292 (Node 161, GPU 4)"];
    
    moe_23_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1293 (Node 161, GPU 5)"];
    
    moe_23_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1294 (Node 161, GPU 6)"];
    
    moe_23_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1295 (Node 161, GPU 7)"];
    
    moe_23_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1296 (Node 162, GPU 0)"];
    
    moe_23_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1297 (Node 162, GPU 1)"];
    
    moe_23_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1298 (Node 162, GPU 2)"];
    
    moe_23_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1299 (Node 162, GPU 3)"];
    
    moe_23_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1300 (Node 162, GPU 4)"];
    
    moe_23_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1301 (Node 162, GPU 5)"];
    
    moe_23_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1302 (Node 162, GPU 6)"];
    
    moe_23_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1303 (Node 162, GPU 7)"];
    
    moe_23_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1304 (Node 163, GPU 0)"];
    
    moe_23_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1305 (Node 163, GPU 1)"];
    
    moe_23_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1306 (Node 163, GPU 2)"];
    
    moe_23_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1307 (Node 163, GPU 3)"];
    
    moe_23_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1308 (Node 163, GPU 4)"];
    
    moe_23_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1309 (Node 163, GPU 5)"];
    
    moe_23_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1310 (Node 163, GPU 6)"];
    
    moe_23_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1311 (Node 163, GPU 7)"];
    
    moe_23_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1312 (Node 164, GPU 0)"];
    
    moe_23_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1313 (Node 164, GPU 1)"];
    
    moe_23_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1314 (Node 164, GPU 2)"];
    
    moe_23_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1315 (Node 164, GPU 3)"];
    
    moe_23_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1316 (Node 164, GPU 4)"];
    
    moe_23_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1317 (Node 164, GPU 5)"];
    
    moe_23_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1318 (Node 164, GPU 6)"];
    
    moe_23_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1319 (Node 164, GPU 7)"];
    
    moe_23_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1320 (Node 165, GPU 0)"];
    
    moe_23_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1321 (Node 165, GPU 1)"];
    
    moe_23_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1322 (Node 165, GPU 2)"];
    
    moe_23_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1323 (Node 165, GPU 3)"];
    
    moe_23_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1324 (Node 165, GPU 4)"];
    
    moe_23_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1325 (Node 165, GPU 5)"];
    
    moe_23_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1326 (Node 165, GPU 6)"];
    
    moe_23_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1327 (Node 165, GPU 7)"];
    
    moe_23_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1328 (Node 166, GPU 0)"];
    
    moe_23_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1329 (Node 166, GPU 1)"];
    
    moe_23_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1330 (Node 166, GPU 2)"];
    
    moe_23_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1331 (Node 166, GPU 3)"];
    
    moe_23_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1332 (Node 166, GPU 4)"];
    
    moe_23_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1333 (Node 166, GPU 5)"];
    
    moe_23_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1334 (Node 166, GPU 6)"];
    
    moe_23_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1335 (Node 166, GPU 7)"];
    
    moe_23_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1336 (Node 167, GPU 0)"];
    
    moe_23_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1337 (Node 167, GPU 1)"];
    
    moe_23_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1338 (Node 167, GPU 2)"];
    
    moe_23_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1339 (Node 167, GPU 3)"];
    
    moe_23_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1340 (Node 167, GPU 4)"];
    
    moe_23_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1341 (Node 167, GPU 5)"];
    
    moe_23_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1342 (Node 167, GPU 6)"];
    
    moe_23_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 23 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1343 (Node 167, GPU 7)"];
    
    moe_23_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 23 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1280 (Node 160, GPU 0)"];
    
    moe_23_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 23 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1280 (Node 160, GPU 0)"];
    
    // MoE Layer 24 - MHA components
    moe_24_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 24 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1344 (Node 168, GPU 0)"];
    
    moe_24_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 24 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1344 (Node 168, GPU 0)"];
    
    moe_24_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 24 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1344 (Node 168, GPU 0)"];
    
    moe_24_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 24 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1344 (Node 168, GPU 0)"];
    
    moe_24_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 24 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1344 (Node 168, GPU 0)"];
    
    moe_24_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 24 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1344 (Node 168, GPU 0)"];
    
    moe_24_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1344 (Node 168, GPU 0)"];
    
    moe_24_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1345 (Node 168, GPU 1)"];
    
    moe_24_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1346 (Node 168, GPU 2)"];
    
    moe_24_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1347 (Node 168, GPU 3)"];
    
    moe_24_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1348 (Node 168, GPU 4)"];
    
    moe_24_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1349 (Node 168, GPU 5)"];
    
    moe_24_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1350 (Node 168, GPU 6)"];
    
    moe_24_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1351 (Node 168, GPU 7)"];
    
    moe_24_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1352 (Node 169, GPU 0)"];
    
    moe_24_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1353 (Node 169, GPU 1)"];
    
    moe_24_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1354 (Node 169, GPU 2)"];
    
    moe_24_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1355 (Node 169, GPU 3)"];
    
    moe_24_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1356 (Node 169, GPU 4)"];
    
    moe_24_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1357 (Node 169, GPU 5)"];
    
    moe_24_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1358 (Node 169, GPU 6)"];
    
    moe_24_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1359 (Node 169, GPU 7)"];
    
    moe_24_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1360 (Node 170, GPU 0)"];
    
    moe_24_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1361 (Node 170, GPU 1)"];
    
    moe_24_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1362 (Node 170, GPU 2)"];
    
    moe_24_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1363 (Node 170, GPU 3)"];
    
    moe_24_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1364 (Node 170, GPU 4)"];
    
    moe_24_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1365 (Node 170, GPU 5)"];
    
    moe_24_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1366 (Node 170, GPU 6)"];
    
    moe_24_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1367 (Node 170, GPU 7)"];
    
    moe_24_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1368 (Node 171, GPU 0)"];
    
    moe_24_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1369 (Node 171, GPU 1)"];
    
    moe_24_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1370 (Node 171, GPU 2)"];
    
    moe_24_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1371 (Node 171, GPU 3)"];
    
    moe_24_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1372 (Node 171, GPU 4)"];
    
    moe_24_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1373 (Node 171, GPU 5)"];
    
    moe_24_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1374 (Node 171, GPU 6)"];
    
    moe_24_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1375 (Node 171, GPU 7)"];
    
    moe_24_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1376 (Node 172, GPU 0)"];
    
    moe_24_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1377 (Node 172, GPU 1)"];
    
    moe_24_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1378 (Node 172, GPU 2)"];
    
    moe_24_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1379 (Node 172, GPU 3)"];
    
    moe_24_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1380 (Node 172, GPU 4)"];
    
    moe_24_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1381 (Node 172, GPU 5)"];
    
    moe_24_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1382 (Node 172, GPU 6)"];
    
    moe_24_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1383 (Node 172, GPU 7)"];
    
    moe_24_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1384 (Node 173, GPU 0)"];
    
    moe_24_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1385 (Node 173, GPU 1)"];
    
    moe_24_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1386 (Node 173, GPU 2)"];
    
    moe_24_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1387 (Node 173, GPU 3)"];
    
    moe_24_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1388 (Node 173, GPU 4)"];
    
    moe_24_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1389 (Node 173, GPU 5)"];
    
    moe_24_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1390 (Node 173, GPU 6)"];
    
    moe_24_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1391 (Node 173, GPU 7)"];
    
    moe_24_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1392 (Node 174, GPU 0)"];
    
    moe_24_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1393 (Node 174, GPU 1)"];
    
    moe_24_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1394 (Node 174, GPU 2)"];
    
    moe_24_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1395 (Node 174, GPU 3)"];
    
    moe_24_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1396 (Node 174, GPU 4)"];
    
    moe_24_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1397 (Node 174, GPU 5)"];
    
    moe_24_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1398 (Node 174, GPU 6)"];
    
    moe_24_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1399 (Node 174, GPU 7)"];
    
    moe_24_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1400 (Node 175, GPU 0)"];
    
    moe_24_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1401 (Node 175, GPU 1)"];
    
    moe_24_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1402 (Node 175, GPU 2)"];
    
    moe_24_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1403 (Node 175, GPU 3)"];
    
    moe_24_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1404 (Node 175, GPU 4)"];
    
    moe_24_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1405 (Node 175, GPU 5)"];
    
    moe_24_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1406 (Node 175, GPU 6)"];
    
    moe_24_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 24 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1407 (Node 175, GPU 7)"];
    
    moe_24_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 24 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1344 (Node 168, GPU 0)"];
    
    moe_24_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 24 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1344 (Node 168, GPU 0)"];
    
    // MoE Layer 25 - MHA components
    moe_25_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 25 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1408 (Node 176, GPU 0)"];
    
    moe_25_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 25 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1408 (Node 176, GPU 0)"];
    
    moe_25_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 25 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1408 (Node 176, GPU 0)"];
    
    moe_25_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 25 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1408 (Node 176, GPU 0)"];
    
    moe_25_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 25 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1408 (Node 176, GPU 0)"];
    
    moe_25_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 25 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1408 (Node 176, GPU 0)"];
    
    moe_25_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1408 (Node 176, GPU 0)"];
    
    moe_25_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1409 (Node 176, GPU 1)"];
    
    moe_25_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1410 (Node 176, GPU 2)"];
    
    moe_25_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1411 (Node 176, GPU 3)"];
    
    moe_25_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1412 (Node 176, GPU 4)"];
    
    moe_25_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1413 (Node 176, GPU 5)"];
    
    moe_25_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1414 (Node 176, GPU 6)"];
    
    moe_25_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1415 (Node 176, GPU 7)"];
    
    moe_25_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1416 (Node 177, GPU 0)"];
    
    moe_25_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1417 (Node 177, GPU 1)"];
    
    moe_25_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1418 (Node 177, GPU 2)"];
    
    moe_25_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1419 (Node 177, GPU 3)"];
    
    moe_25_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1420 (Node 177, GPU 4)"];
    
    moe_25_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1421 (Node 177, GPU 5)"];
    
    moe_25_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1422 (Node 177, GPU 6)"];
    
    moe_25_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1423 (Node 177, GPU 7)"];
    
    moe_25_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1424 (Node 178, GPU 0)"];
    
    moe_25_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1425 (Node 178, GPU 1)"];
    
    moe_25_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1426 (Node 178, GPU 2)"];
    
    moe_25_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1427 (Node 178, GPU 3)"];
    
    moe_25_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1428 (Node 178, GPU 4)"];
    
    moe_25_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1429 (Node 178, GPU 5)"];
    
    moe_25_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1430 (Node 178, GPU 6)"];
    
    moe_25_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1431 (Node 178, GPU 7)"];
    
    moe_25_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1432 (Node 179, GPU 0)"];
    
    moe_25_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1433 (Node 179, GPU 1)"];
    
    moe_25_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1434 (Node 179, GPU 2)"];
    
    moe_25_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1435 (Node 179, GPU 3)"];
    
    moe_25_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1436 (Node 179, GPU 4)"];
    
    moe_25_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1437 (Node 179, GPU 5)"];
    
    moe_25_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1438 (Node 179, GPU 6)"];
    
    moe_25_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1439 (Node 179, GPU 7)"];
    
    moe_25_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1440 (Node 180, GPU 0)"];
    
    moe_25_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1441 (Node 180, GPU 1)"];
    
    moe_25_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1442 (Node 180, GPU 2)"];
    
    moe_25_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1443 (Node 180, GPU 3)"];
    
    moe_25_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1444 (Node 180, GPU 4)"];
    
    moe_25_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1445 (Node 180, GPU 5)"];
    
    moe_25_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1446 (Node 180, GPU 6)"];
    
    moe_25_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1447 (Node 180, GPU 7)"];
    
    moe_25_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1448 (Node 181, GPU 0)"];
    
    moe_25_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1449 (Node 181, GPU 1)"];
    
    moe_25_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1450 (Node 181, GPU 2)"];
    
    moe_25_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1451 (Node 181, GPU 3)"];
    
    moe_25_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1452 (Node 181, GPU 4)"];
    
    moe_25_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1453 (Node 181, GPU 5)"];
    
    moe_25_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1454 (Node 181, GPU 6)"];
    
    moe_25_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1455 (Node 181, GPU 7)"];
    
    moe_25_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1456 (Node 182, GPU 0)"];
    
    moe_25_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1457 (Node 182, GPU 1)"];
    
    moe_25_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1458 (Node 182, GPU 2)"];
    
    moe_25_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1459 (Node 182, GPU 3)"];
    
    moe_25_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1460 (Node 182, GPU 4)"];
    
    moe_25_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1461 (Node 182, GPU 5)"];
    
    moe_25_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1462 (Node 182, GPU 6)"];
    
    moe_25_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1463 (Node 182, GPU 7)"];
    
    moe_25_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1464 (Node 183, GPU 0)"];
    
    moe_25_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1465 (Node 183, GPU 1)"];
    
    moe_25_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1466 (Node 183, GPU 2)"];
    
    moe_25_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1467 (Node 183, GPU 3)"];
    
    moe_25_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1468 (Node 183, GPU 4)"];
    
    moe_25_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1469 (Node 183, GPU 5)"];
    
    moe_25_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1470 (Node 183, GPU 6)"];
    
    moe_25_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 25 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1471 (Node 183, GPU 7)"];
    
    moe_25_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 25 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1408 (Node 176, GPU 0)"];
    
    moe_25_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 25 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1408 (Node 176, GPU 0)"];
    
    // MoE Layer 26 - MHA components
    moe_26_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 26 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1472 (Node 184, GPU 0)"];
    
    moe_26_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 26 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1472 (Node 184, GPU 0)"];
    
    moe_26_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 26 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1472 (Node 184, GPU 0)"];
    
    moe_26_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 26 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1472 (Node 184, GPU 0)"];
    
    moe_26_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 26 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1472 (Node 184, GPU 0)"];
    
    moe_26_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 26 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1472 (Node 184, GPU 0)"];
    
    moe_26_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1472 (Node 184, GPU 0)"];
    
    moe_26_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1473 (Node 184, GPU 1)"];
    
    moe_26_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1474 (Node 184, GPU 2)"];
    
    moe_26_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1475 (Node 184, GPU 3)"];
    
    moe_26_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1476 (Node 184, GPU 4)"];
    
    moe_26_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1477 (Node 184, GPU 5)"];
    
    moe_26_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1478 (Node 184, GPU 6)"];
    
    moe_26_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1479 (Node 184, GPU 7)"];
    
    moe_26_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1480 (Node 185, GPU 0)"];
    
    moe_26_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1481 (Node 185, GPU 1)"];
    
    moe_26_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1482 (Node 185, GPU 2)"];
    
    moe_26_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1483 (Node 185, GPU 3)"];
    
    moe_26_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1484 (Node 185, GPU 4)"];
    
    moe_26_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1485 (Node 185, GPU 5)"];
    
    moe_26_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1486 (Node 185, GPU 6)"];
    
    moe_26_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1487 (Node 185, GPU 7)"];
    
    moe_26_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1488 (Node 186, GPU 0)"];
    
    moe_26_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1489 (Node 186, GPU 1)"];
    
    moe_26_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1490 (Node 186, GPU 2)"];
    
    moe_26_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1491 (Node 186, GPU 3)"];
    
    moe_26_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1492 (Node 186, GPU 4)"];
    
    moe_26_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1493 (Node 186, GPU 5)"];
    
    moe_26_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1494 (Node 186, GPU 6)"];
    
    moe_26_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1495 (Node 186, GPU 7)"];
    
    moe_26_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1496 (Node 187, GPU 0)"];
    
    moe_26_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1497 (Node 187, GPU 1)"];
    
    moe_26_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1498 (Node 187, GPU 2)"];
    
    moe_26_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1499 (Node 187, GPU 3)"];
    
    moe_26_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1500 (Node 187, GPU 4)"];
    
    moe_26_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1501 (Node 187, GPU 5)"];
    
    moe_26_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1502 (Node 187, GPU 6)"];
    
    moe_26_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1503 (Node 187, GPU 7)"];
    
    moe_26_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1504 (Node 188, GPU 0)"];
    
    moe_26_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1505 (Node 188, GPU 1)"];
    
    moe_26_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1506 (Node 188, GPU 2)"];
    
    moe_26_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1507 (Node 188, GPU 3)"];
    
    moe_26_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1508 (Node 188, GPU 4)"];
    
    moe_26_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1509 (Node 188, GPU 5)"];
    
    moe_26_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1510 (Node 188, GPU 6)"];
    
    moe_26_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1511 (Node 188, GPU 7)"];
    
    moe_26_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1512 (Node 189, GPU 0)"];
    
    moe_26_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1513 (Node 189, GPU 1)"];
    
    moe_26_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1514 (Node 189, GPU 2)"];
    
    moe_26_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1515 (Node 189, GPU 3)"];
    
    moe_26_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1516 (Node 189, GPU 4)"];
    
    moe_26_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1517 (Node 189, GPU 5)"];
    
    moe_26_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1518 (Node 189, GPU 6)"];
    
    moe_26_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1519 (Node 189, GPU 7)"];
    
    moe_26_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1520 (Node 190, GPU 0)"];
    
    moe_26_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1521 (Node 190, GPU 1)"];
    
    moe_26_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1522 (Node 190, GPU 2)"];
    
    moe_26_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1523 (Node 190, GPU 3)"];
    
    moe_26_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1524 (Node 190, GPU 4)"];
    
    moe_26_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1525 (Node 190, GPU 5)"];
    
    moe_26_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1526 (Node 190, GPU 6)"];
    
    moe_26_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1527 (Node 190, GPU 7)"];
    
    moe_26_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1528 (Node 191, GPU 0)"];
    
    moe_26_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1529 (Node 191, GPU 1)"];
    
    moe_26_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1530 (Node 191, GPU 2)"];
    
    moe_26_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1531 (Node 191, GPU 3)"];
    
    moe_26_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1532 (Node 191, GPU 4)"];
    
    moe_26_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1533 (Node 191, GPU 5)"];
    
    moe_26_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1534 (Node 191, GPU 6)"];
    
    moe_26_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 26 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1535 (Node 191, GPU 7)"];
    
    moe_26_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 26 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1472 (Node 184, GPU 0)"];
    
    moe_26_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 26 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1472 (Node 184, GPU 0)"];
    
    // MoE Layer 27 - MHA components
    moe_27_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 27 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1536 (Node 192, GPU 0)"];
    
    moe_27_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 27 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1536 (Node 192, GPU 0)"];
    
    moe_27_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 27 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1536 (Node 192, GPU 0)"];
    
    moe_27_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 27 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1536 (Node 192, GPU 0)"];
    
    moe_27_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 27 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1536 (Node 192, GPU 0)"];
    
    moe_27_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 27 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1536 (Node 192, GPU 0)"];
    
    moe_27_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1536 (Node 192, GPU 0)"];
    
    moe_27_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1537 (Node 192, GPU 1)"];
    
    moe_27_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1538 (Node 192, GPU 2)"];
    
    moe_27_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1539 (Node 192, GPU 3)"];
    
    moe_27_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1540 (Node 192, GPU 4)"];
    
    moe_27_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1541 (Node 192, GPU 5)"];
    
    moe_27_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1542 (Node 192, GPU 6)"];
    
    moe_27_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1543 (Node 192, GPU 7)"];
    
    moe_27_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1544 (Node 193, GPU 0)"];
    
    moe_27_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1545 (Node 193, GPU 1)"];
    
    moe_27_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1546 (Node 193, GPU 2)"];
    
    moe_27_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1547 (Node 193, GPU 3)"];
    
    moe_27_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1548 (Node 193, GPU 4)"];
    
    moe_27_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1549 (Node 193, GPU 5)"];
    
    moe_27_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1550 (Node 193, GPU 6)"];
    
    moe_27_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1551 (Node 193, GPU 7)"];
    
    moe_27_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1552 (Node 194, GPU 0)"];
    
    moe_27_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1553 (Node 194, GPU 1)"];
    
    moe_27_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1554 (Node 194, GPU 2)"];
    
    moe_27_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1555 (Node 194, GPU 3)"];
    
    moe_27_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1556 (Node 194, GPU 4)"];
    
    moe_27_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1557 (Node 194, GPU 5)"];
    
    moe_27_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1558 (Node 194, GPU 6)"];
    
    moe_27_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1559 (Node 194, GPU 7)"];
    
    moe_27_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1560 (Node 195, GPU 0)"];
    
    moe_27_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1561 (Node 195, GPU 1)"];
    
    moe_27_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1562 (Node 195, GPU 2)"];
    
    moe_27_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1563 (Node 195, GPU 3)"];
    
    moe_27_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1564 (Node 195, GPU 4)"];
    
    moe_27_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1565 (Node 195, GPU 5)"];
    
    moe_27_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1566 (Node 195, GPU 6)"];
    
    moe_27_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1567 (Node 195, GPU 7)"];
    
    moe_27_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1568 (Node 196, GPU 0)"];
    
    moe_27_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1569 (Node 196, GPU 1)"];
    
    moe_27_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1570 (Node 196, GPU 2)"];
    
    moe_27_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1571 (Node 196, GPU 3)"];
    
    moe_27_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1572 (Node 196, GPU 4)"];
    
    moe_27_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1573 (Node 196, GPU 5)"];
    
    moe_27_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1574 (Node 196, GPU 6)"];
    
    moe_27_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1575 (Node 196, GPU 7)"];
    
    moe_27_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1576 (Node 197, GPU 0)"];
    
    moe_27_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1577 (Node 197, GPU 1)"];
    
    moe_27_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1578 (Node 197, GPU 2)"];
    
    moe_27_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1579 (Node 197, GPU 3)"];
    
    moe_27_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1580 (Node 197, GPU 4)"];
    
    moe_27_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1581 (Node 197, GPU 5)"];
    
    moe_27_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1582 (Node 197, GPU 6)"];
    
    moe_27_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1583 (Node 197, GPU 7)"];
    
    moe_27_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1584 (Node 198, GPU 0)"];
    
    moe_27_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1585 (Node 198, GPU 1)"];
    
    moe_27_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1586 (Node 198, GPU 2)"];
    
    moe_27_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1587 (Node 198, GPU 3)"];
    
    moe_27_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1588 (Node 198, GPU 4)"];
    
    moe_27_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1589 (Node 198, GPU 5)"];
    
    moe_27_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1590 (Node 198, GPU 6)"];
    
    moe_27_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1591 (Node 198, GPU 7)"];
    
    moe_27_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1592 (Node 199, GPU 0)"];
    
    moe_27_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1593 (Node 199, GPU 1)"];
    
    moe_27_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1594 (Node 199, GPU 2)"];
    
    moe_27_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1595 (Node 199, GPU 3)"];
    
    moe_27_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1596 (Node 199, GPU 4)"];
    
    moe_27_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1597 (Node 199, GPU 5)"];
    
    moe_27_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1598 (Node 199, GPU 6)"];
    
    moe_27_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 27 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1599 (Node 199, GPU 7)"];
    
    moe_27_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 27 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1536 (Node 192, GPU 0)"];
    
    moe_27_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 27 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1536 (Node 192, GPU 0)"];
    
    // MoE Layer 28 - MHA components
    moe_28_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 28 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1600 (Node 200, GPU 0)"];
    
    moe_28_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 28 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1600 (Node 200, GPU 0)"];
    
    moe_28_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 28 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1600 (Node 200, GPU 0)"];
    
    moe_28_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 28 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1600 (Node 200, GPU 0)"];
    
    moe_28_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 28 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1600 (Node 200, GPU 0)"];
    
    moe_28_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 28 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1600 (Node 200, GPU 0)"];
    
    moe_28_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1600 (Node 200, GPU 0)"];
    
    moe_28_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1601 (Node 200, GPU 1)"];
    
    moe_28_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1602 (Node 200, GPU 2)"];
    
    moe_28_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1603 (Node 200, GPU 3)"];
    
    moe_28_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1604 (Node 200, GPU 4)"];
    
    moe_28_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1605 (Node 200, GPU 5)"];
    
    moe_28_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1606 (Node 200, GPU 6)"];
    
    moe_28_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1607 (Node 200, GPU 7)"];
    
    moe_28_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1608 (Node 201, GPU 0)"];
    
    moe_28_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1609 (Node 201, GPU 1)"];
    
    moe_28_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1610 (Node 201, GPU 2)"];
    
    moe_28_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1611 (Node 201, GPU 3)"];
    
    moe_28_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1612 (Node 201, GPU 4)"];
    
    moe_28_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1613 (Node 201, GPU 5)"];
    
    moe_28_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1614 (Node 201, GPU 6)"];
    
    moe_28_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1615 (Node 201, GPU 7)"];
    
    moe_28_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1616 (Node 202, GPU 0)"];
    
    moe_28_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1617 (Node 202, GPU 1)"];
    
    moe_28_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1618 (Node 202, GPU 2)"];
    
    moe_28_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1619 (Node 202, GPU 3)"];
    
    moe_28_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1620 (Node 202, GPU 4)"];
    
    moe_28_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1621 (Node 202, GPU 5)"];
    
    moe_28_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1622 (Node 202, GPU 6)"];
    
    moe_28_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1623 (Node 202, GPU 7)"];
    
    moe_28_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1624 (Node 203, GPU 0)"];
    
    moe_28_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1625 (Node 203, GPU 1)"];
    
    moe_28_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1626 (Node 203, GPU 2)"];
    
    moe_28_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1627 (Node 203, GPU 3)"];
    
    moe_28_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1628 (Node 203, GPU 4)"];
    
    moe_28_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1629 (Node 203, GPU 5)"];
    
    moe_28_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1630 (Node 203, GPU 6)"];
    
    moe_28_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1631 (Node 203, GPU 7)"];
    
    moe_28_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1632 (Node 204, GPU 0)"];
    
    moe_28_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1633 (Node 204, GPU 1)"];
    
    moe_28_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1634 (Node 204, GPU 2)"];
    
    moe_28_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1635 (Node 204, GPU 3)"];
    
    moe_28_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1636 (Node 204, GPU 4)"];
    
    moe_28_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1637 (Node 204, GPU 5)"];
    
    moe_28_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1638 (Node 204, GPU 6)"];
    
    moe_28_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1639 (Node 204, GPU 7)"];
    
    moe_28_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1640 (Node 205, GPU 0)"];
    
    moe_28_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1641 (Node 205, GPU 1)"];
    
    moe_28_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1642 (Node 205, GPU 2)"];
    
    moe_28_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1643 (Node 205, GPU 3)"];
    
    moe_28_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1644 (Node 205, GPU 4)"];
    
    moe_28_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1645 (Node 205, GPU 5)"];
    
    moe_28_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1646 (Node 205, GPU 6)"];
    
    moe_28_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1647 (Node 205, GPU 7)"];
    
    moe_28_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1648 (Node 206, GPU 0)"];
    
    moe_28_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1649 (Node 206, GPU 1)"];
    
    moe_28_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1650 (Node 206, GPU 2)"];
    
    moe_28_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1651 (Node 206, GPU 3)"];
    
    moe_28_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1652 (Node 206, GPU 4)"];
    
    moe_28_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1653 (Node 206, GPU 5)"];
    
    moe_28_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1654 (Node 206, GPU 6)"];
    
    moe_28_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1655 (Node 206, GPU 7)"];
    
    moe_28_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1656 (Node 207, GPU 0)"];
    
    moe_28_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1657 (Node 207, GPU 1)"];
    
    moe_28_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1658 (Node 207, GPU 2)"];
    
    moe_28_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1659 (Node 207, GPU 3)"];
    
    moe_28_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1660 (Node 207, GPU 4)"];
    
    moe_28_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1661 (Node 207, GPU 5)"];
    
    moe_28_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1662 (Node 207, GPU 6)"];
    
    moe_28_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 28 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1663 (Node 207, GPU 7)"];
    
    moe_28_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 28 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1600 (Node 200, GPU 0)"];
    
    moe_28_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 28 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1600 (Node 200, GPU 0)"];
    
    // MoE Layer 29 - MHA components
    moe_29_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 29 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1664 (Node 208, GPU 0)"];
    
    moe_29_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 29 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1664 (Node 208, GPU 0)"];
    
    moe_29_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 29 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1664 (Node 208, GPU 0)"];
    
    moe_29_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 29 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1664 (Node 208, GPU 0)"];
    
    moe_29_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 29 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1664 (Node 208, GPU 0)"];
    
    moe_29_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 29 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1664 (Node 208, GPU 0)"];
    
    moe_29_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1664 (Node 208, GPU 0)"];
    
    moe_29_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1665 (Node 208, GPU 1)"];
    
    moe_29_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1666 (Node 208, GPU 2)"];
    
    moe_29_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1667 (Node 208, GPU 3)"];
    
    moe_29_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1668 (Node 208, GPU 4)"];
    
    moe_29_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1669 (Node 208, GPU 5)"];
    
    moe_29_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1670 (Node 208, GPU 6)"];
    
    moe_29_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1671 (Node 208, GPU 7)"];
    
    moe_29_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1672 (Node 209, GPU 0)"];
    
    moe_29_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1673 (Node 209, GPU 1)"];
    
    moe_29_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1674 (Node 209, GPU 2)"];
    
    moe_29_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1675 (Node 209, GPU 3)"];
    
    moe_29_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1676 (Node 209, GPU 4)"];
    
    moe_29_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1677 (Node 209, GPU 5)"];
    
    moe_29_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1678 (Node 209, GPU 6)"];
    
    moe_29_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1679 (Node 209, GPU 7)"];
    
    moe_29_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1680 (Node 210, GPU 0)"];
    
    moe_29_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1681 (Node 210, GPU 1)"];
    
    moe_29_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1682 (Node 210, GPU 2)"];
    
    moe_29_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1683 (Node 210, GPU 3)"];
    
    moe_29_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1684 (Node 210, GPU 4)"];
    
    moe_29_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1685 (Node 210, GPU 5)"];
    
    moe_29_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1686 (Node 210, GPU 6)"];
    
    moe_29_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1687 (Node 210, GPU 7)"];
    
    moe_29_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1688 (Node 211, GPU 0)"];
    
    moe_29_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1689 (Node 211, GPU 1)"];
    
    moe_29_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1690 (Node 211, GPU 2)"];
    
    moe_29_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1691 (Node 211, GPU 3)"];
    
    moe_29_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1692 (Node 211, GPU 4)"];
    
    moe_29_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1693 (Node 211, GPU 5)"];
    
    moe_29_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1694 (Node 211, GPU 6)"];
    
    moe_29_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1695 (Node 211, GPU 7)"];
    
    moe_29_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1696 (Node 212, GPU 0)"];
    
    moe_29_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1697 (Node 212, GPU 1)"];
    
    moe_29_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1698 (Node 212, GPU 2)"];
    
    moe_29_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1699 (Node 212, GPU 3)"];
    
    moe_29_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1700 (Node 212, GPU 4)"];
    
    moe_29_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1701 (Node 212, GPU 5)"];
    
    moe_29_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1702 (Node 212, GPU 6)"];
    
    moe_29_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1703 (Node 212, GPU 7)"];
    
    moe_29_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1704 (Node 213, GPU 0)"];
    
    moe_29_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1705 (Node 213, GPU 1)"];
    
    moe_29_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1706 (Node 213, GPU 2)"];
    
    moe_29_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1707 (Node 213, GPU 3)"];
    
    moe_29_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1708 (Node 213, GPU 4)"];
    
    moe_29_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1709 (Node 213, GPU 5)"];
    
    moe_29_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1710 (Node 213, GPU 6)"];
    
    moe_29_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1711 (Node 213, GPU 7)"];
    
    moe_29_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1712 (Node 214, GPU 0)"];
    
    moe_29_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1713 (Node 214, GPU 1)"];
    
    moe_29_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1714 (Node 214, GPU 2)"];
    
    moe_29_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1715 (Node 214, GPU 3)"];
    
    moe_29_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1716 (Node 214, GPU 4)"];
    
    moe_29_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1717 (Node 214, GPU 5)"];
    
    moe_29_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1718 (Node 214, GPU 6)"];
    
    moe_29_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1719 (Node 214, GPU 7)"];
    
    moe_29_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1720 (Node 215, GPU 0)"];
    
    moe_29_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1721 (Node 215, GPU 1)"];
    
    moe_29_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1722 (Node 215, GPU 2)"];
    
    moe_29_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1723 (Node 215, GPU 3)"];
    
    moe_29_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1724 (Node 215, GPU 4)"];
    
    moe_29_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1725 (Node 215, GPU 5)"];
    
    moe_29_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1726 (Node 215, GPU 6)"];
    
    moe_29_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 29 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1727 (Node 215, GPU 7)"];
    
    moe_29_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 29 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1664 (Node 208, GPU 0)"];
    
    moe_29_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 29 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1664 (Node 208, GPU 0)"];
    
    // MoE Layer 30 - MHA components
    moe_30_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 30 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1728 (Node 216, GPU 0)"];
    
    moe_30_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 30 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1728 (Node 216, GPU 0)"];
    
    moe_30_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 30 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1728 (Node 216, GPU 0)"];
    
    moe_30_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 30 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1728 (Node 216, GPU 0)"];
    
    moe_30_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 30 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1728 (Node 216, GPU 0)"];
    
    moe_30_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 30 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1728 (Node 216, GPU 0)"];
    
    moe_30_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1728 (Node 216, GPU 0)"];
    
    moe_30_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1729 (Node 216, GPU 1)"];
    
    moe_30_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1730 (Node 216, GPU 2)"];
    
    moe_30_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1731 (Node 216, GPU 3)"];
    
    moe_30_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1732 (Node 216, GPU 4)"];
    
    moe_30_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1733 (Node 216, GPU 5)"];
    
    moe_30_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1734 (Node 216, GPU 6)"];
    
    moe_30_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1735 (Node 216, GPU 7)"];
    
    moe_30_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1736 (Node 217, GPU 0)"];
    
    moe_30_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1737 (Node 217, GPU 1)"];
    
    moe_30_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1738 (Node 217, GPU 2)"];
    
    moe_30_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1739 (Node 217, GPU 3)"];
    
    moe_30_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1740 (Node 217, GPU 4)"];
    
    moe_30_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1741 (Node 217, GPU 5)"];
    
    moe_30_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1742 (Node 217, GPU 6)"];
    
    moe_30_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1743 (Node 217, GPU 7)"];
    
    moe_30_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1744 (Node 218, GPU 0)"];
    
    moe_30_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1745 (Node 218, GPU 1)"];
    
    moe_30_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1746 (Node 218, GPU 2)"];
    
    moe_30_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1747 (Node 218, GPU 3)"];
    
    moe_30_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1748 (Node 218, GPU 4)"];
    
    moe_30_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1749 (Node 218, GPU 5)"];
    
    moe_30_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1750 (Node 218, GPU 6)"];
    
    moe_30_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1751 (Node 218, GPU 7)"];
    
    moe_30_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1752 (Node 219, GPU 0)"];
    
    moe_30_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1753 (Node 219, GPU 1)"];
    
    moe_30_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1754 (Node 219, GPU 2)"];
    
    moe_30_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1755 (Node 219, GPU 3)"];
    
    moe_30_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1756 (Node 219, GPU 4)"];
    
    moe_30_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1757 (Node 219, GPU 5)"];
    
    moe_30_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1758 (Node 219, GPU 6)"];
    
    moe_30_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1759 (Node 219, GPU 7)"];
    
    moe_30_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1760 (Node 220, GPU 0)"];
    
    moe_30_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1761 (Node 220, GPU 1)"];
    
    moe_30_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1762 (Node 220, GPU 2)"];
    
    moe_30_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1763 (Node 220, GPU 3)"];
    
    moe_30_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1764 (Node 220, GPU 4)"];
    
    moe_30_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1765 (Node 220, GPU 5)"];
    
    moe_30_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1766 (Node 220, GPU 6)"];
    
    moe_30_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1767 (Node 220, GPU 7)"];
    
    moe_30_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1768 (Node 221, GPU 0)"];
    
    moe_30_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1769 (Node 221, GPU 1)"];
    
    moe_30_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1770 (Node 221, GPU 2)"];
    
    moe_30_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1771 (Node 221, GPU 3)"];
    
    moe_30_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1772 (Node 221, GPU 4)"];
    
    moe_30_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1773 (Node 221, GPU 5)"];
    
    moe_30_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1774 (Node 221, GPU 6)"];
    
    moe_30_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1775 (Node 221, GPU 7)"];
    
    moe_30_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1776 (Node 222, GPU 0)"];
    
    moe_30_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1777 (Node 222, GPU 1)"];
    
    moe_30_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1778 (Node 222, GPU 2)"];
    
    moe_30_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1779 (Node 222, GPU 3)"];
    
    moe_30_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1780 (Node 222, GPU 4)"];
    
    moe_30_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1781 (Node 222, GPU 5)"];
    
    moe_30_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1782 (Node 222, GPU 6)"];
    
    moe_30_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1783 (Node 222, GPU 7)"];
    
    moe_30_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1784 (Node 223, GPU 0)"];
    
    moe_30_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1785 (Node 223, GPU 1)"];
    
    moe_30_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1786 (Node 223, GPU 2)"];
    
    moe_30_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1787 (Node 223, GPU 3)"];
    
    moe_30_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1788 (Node 223, GPU 4)"];
    
    moe_30_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1789 (Node 223, GPU 5)"];
    
    moe_30_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1790 (Node 223, GPU 6)"];
    
    moe_30_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 30 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1791 (Node 223, GPU 7)"];
    
    moe_30_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 30 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1728 (Node 216, GPU 0)"];
    
    moe_30_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 30 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1728 (Node 216, GPU 0)"];
    
    // MoE Layer 31 - MHA components
    moe_31_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 31 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1792 (Node 224, GPU 0)"];
    
    moe_31_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 31 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1792 (Node 224, GPU 0)"];
    
    moe_31_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 31 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1792 (Node 224, GPU 0)"];
    
    moe_31_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 31 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1792 (Node 224, GPU 0)"];
    
    moe_31_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 31 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1792 (Node 224, GPU 0)"];
    
    moe_31_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 31 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1792 (Node 224, GPU 0)"];
    
    moe_31_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1792 (Node 224, GPU 0)"];
    
    moe_31_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1793 (Node 224, GPU 1)"];
    
    moe_31_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1794 (Node 224, GPU 2)"];
    
    moe_31_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1795 (Node 224, GPU 3)"];
    
    moe_31_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1796 (Node 224, GPU 4)"];
    
    moe_31_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1797 (Node 224, GPU 5)"];
    
    moe_31_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1798 (Node 224, GPU 6)"];
    
    moe_31_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1799 (Node 224, GPU 7)"];
    
    moe_31_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1800 (Node 225, GPU 0)"];
    
    moe_31_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1801 (Node 225, GPU 1)"];
    
    moe_31_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1802 (Node 225, GPU 2)"];
    
    moe_31_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1803 (Node 225, GPU 3)"];
    
    moe_31_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1804 (Node 225, GPU 4)"];
    
    moe_31_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1805 (Node 225, GPU 5)"];
    
    moe_31_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1806 (Node 225, GPU 6)"];
    
    moe_31_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1807 (Node 225, GPU 7)"];
    
    moe_31_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1808 (Node 226, GPU 0)"];
    
    moe_31_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1809 (Node 226, GPU 1)"];
    
    moe_31_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1810 (Node 226, GPU 2)"];
    
    moe_31_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1811 (Node 226, GPU 3)"];
    
    moe_31_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1812 (Node 226, GPU 4)"];
    
    moe_31_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1813 (Node 226, GPU 5)"];
    
    moe_31_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1814 (Node 226, GPU 6)"];
    
    moe_31_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1815 (Node 226, GPU 7)"];
    
    moe_31_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1816 (Node 227, GPU 0)"];
    
    moe_31_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1817 (Node 227, GPU 1)"];
    
    moe_31_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1818 (Node 227, GPU 2)"];
    
    moe_31_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1819 (Node 227, GPU 3)"];
    
    moe_31_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1820 (Node 227, GPU 4)"];
    
    moe_31_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1821 (Node 227, GPU 5)"];
    
    moe_31_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1822 (Node 227, GPU 6)"];
    
    moe_31_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1823 (Node 227, GPU 7)"];
    
    moe_31_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1824 (Node 228, GPU 0)"];
    
    moe_31_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1825 (Node 228, GPU 1)"];
    
    moe_31_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1826 (Node 228, GPU 2)"];
    
    moe_31_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1827 (Node 228, GPU 3)"];
    
    moe_31_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1828 (Node 228, GPU 4)"];
    
    moe_31_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1829 (Node 228, GPU 5)"];
    
    moe_31_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1830 (Node 228, GPU 6)"];
    
    moe_31_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1831 (Node 228, GPU 7)"];
    
    moe_31_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1832 (Node 229, GPU 0)"];
    
    moe_31_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1833 (Node 229, GPU 1)"];
    
    moe_31_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1834 (Node 229, GPU 2)"];
    
    moe_31_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1835 (Node 229, GPU 3)"];
    
    moe_31_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1836 (Node 229, GPU 4)"];
    
    moe_31_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1837 (Node 229, GPU 5)"];
    
    moe_31_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1838 (Node 229, GPU 6)"];
    
    moe_31_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1839 (Node 229, GPU 7)"];
    
    moe_31_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1840 (Node 230, GPU 0)"];
    
    moe_31_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1841 (Node 230, GPU 1)"];
    
    moe_31_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1842 (Node 230, GPU 2)"];
    
    moe_31_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1843 (Node 230, GPU 3)"];
    
    moe_31_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1844 (Node 230, GPU 4)"];
    
    moe_31_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1845 (Node 230, GPU 5)"];
    
    moe_31_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1846 (Node 230, GPU 6)"];
    
    moe_31_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1847 (Node 230, GPU 7)"];
    
    moe_31_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1848 (Node 231, GPU 0)"];
    
    moe_31_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1849 (Node 231, GPU 1)"];
    
    moe_31_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1850 (Node 231, GPU 2)"];
    
    moe_31_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1851 (Node 231, GPU 3)"];
    
    moe_31_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1852 (Node 231, GPU 4)"];
    
    moe_31_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1853 (Node 231, GPU 5)"];
    
    moe_31_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1854 (Node 231, GPU 6)"];
    
    moe_31_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 31 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1855 (Node 231, GPU 7)"];
    
    moe_31_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 31 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1792 (Node 224, GPU 0)"];
    
    moe_31_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 31 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1792 (Node 224, GPU 0)"];
    
    // MoE Layer 32 - MHA components
    moe_32_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 32 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1856 (Node 232, GPU 0)"];
    
    moe_32_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 32 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1856 (Node 232, GPU 0)"];
    
    moe_32_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 32 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1856 (Node 232, GPU 0)"];
    
    moe_32_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 32 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1856 (Node 232, GPU 0)"];
    
    moe_32_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 32 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1856 (Node 232, GPU 0)"];
    
    moe_32_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 32 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1856 (Node 232, GPU 0)"];
    
    moe_32_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1856 (Node 232, GPU 0)"];
    
    moe_32_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1857 (Node 232, GPU 1)"];
    
    moe_32_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1858 (Node 232, GPU 2)"];
    
    moe_32_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1859 (Node 232, GPU 3)"];
    
    moe_32_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1860 (Node 232, GPU 4)"];
    
    moe_32_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1861 (Node 232, GPU 5)"];
    
    moe_32_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1862 (Node 232, GPU 6)"];
    
    moe_32_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1863 (Node 232, GPU 7)"];
    
    moe_32_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1864 (Node 233, GPU 0)"];
    
    moe_32_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1865 (Node 233, GPU 1)"];
    
    moe_32_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1866 (Node 233, GPU 2)"];
    
    moe_32_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1867 (Node 233, GPU 3)"];
    
    moe_32_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1868 (Node 233, GPU 4)"];
    
    moe_32_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1869 (Node 233, GPU 5)"];
    
    moe_32_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1870 (Node 233, GPU 6)"];
    
    moe_32_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1871 (Node 233, GPU 7)"];
    
    moe_32_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1872 (Node 234, GPU 0)"];
    
    moe_32_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1873 (Node 234, GPU 1)"];
    
    moe_32_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1874 (Node 234, GPU 2)"];
    
    moe_32_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1875 (Node 234, GPU 3)"];
    
    moe_32_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1876 (Node 234, GPU 4)"];
    
    moe_32_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1877 (Node 234, GPU 5)"];
    
    moe_32_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1878 (Node 234, GPU 6)"];
    
    moe_32_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1879 (Node 234, GPU 7)"];
    
    moe_32_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1880 (Node 235, GPU 0)"];
    
    moe_32_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1881 (Node 235, GPU 1)"];
    
    moe_32_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1882 (Node 235, GPU 2)"];
    
    moe_32_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1883 (Node 235, GPU 3)"];
    
    moe_32_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1884 (Node 235, GPU 4)"];
    
    moe_32_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1885 (Node 235, GPU 5)"];
    
    moe_32_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1886 (Node 235, GPU 6)"];
    
    moe_32_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1887 (Node 235, GPU 7)"];
    
    moe_32_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1888 (Node 236, GPU 0)"];
    
    moe_32_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1889 (Node 236, GPU 1)"];
    
    moe_32_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1890 (Node 236, GPU 2)"];
    
    moe_32_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1891 (Node 236, GPU 3)"];
    
    moe_32_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1892 (Node 236, GPU 4)"];
    
    moe_32_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1893 (Node 236, GPU 5)"];
    
    moe_32_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1894 (Node 236, GPU 6)"];
    
    moe_32_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1895 (Node 236, GPU 7)"];
    
    moe_32_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1896 (Node 237, GPU 0)"];
    
    moe_32_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1897 (Node 237, GPU 1)"];
    
    moe_32_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1898 (Node 237, GPU 2)"];
    
    moe_32_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1899 (Node 237, GPU 3)"];
    
    moe_32_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1900 (Node 237, GPU 4)"];
    
    moe_32_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1901 (Node 237, GPU 5)"];
    
    moe_32_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1902 (Node 237, GPU 6)"];
    
    moe_32_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1903 (Node 237, GPU 7)"];
    
    moe_32_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1904 (Node 238, GPU 0)"];
    
    moe_32_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1905 (Node 238, GPU 1)"];
    
    moe_32_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1906 (Node 238, GPU 2)"];
    
    moe_32_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1907 (Node 238, GPU 3)"];
    
    moe_32_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1908 (Node 238, GPU 4)"];
    
    moe_32_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1909 (Node 238, GPU 5)"];
    
    moe_32_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1910 (Node 238, GPU 6)"];
    
    moe_32_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1911 (Node 238, GPU 7)"];
    
    moe_32_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1912 (Node 239, GPU 0)"];
    
    moe_32_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1913 (Node 239, GPU 1)"];
    
    moe_32_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1914 (Node 239, GPU 2)"];
    
    moe_32_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1915 (Node 239, GPU 3)"];
    
    moe_32_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1916 (Node 239, GPU 4)"];
    
    moe_32_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1917 (Node 239, GPU 5)"];
    
    moe_32_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1918 (Node 239, GPU 6)"];
    
    moe_32_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 32 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1919 (Node 239, GPU 7)"];
    
    moe_32_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 32 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1856 (Node 232, GPU 0)"];
    
    moe_32_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 32 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1856 (Node 232, GPU 0)"];
    
    // MoE Layer 33 - MHA components
    moe_33_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 33 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1920 (Node 240, GPU 0)"];
    
    moe_33_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 33 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1920 (Node 240, GPU 0)"];
    
    moe_33_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 33 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1920 (Node 240, GPU 0)"];
    
    moe_33_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 33 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1920 (Node 240, GPU 0)"];
    
    moe_33_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 33 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1920 (Node 240, GPU 0)"];
    
    moe_33_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 33 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1920 (Node 240, GPU 0)"];
    
    moe_33_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1920 (Node 240, GPU 0)"];
    
    moe_33_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1921 (Node 240, GPU 1)"];
    
    moe_33_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1922 (Node 240, GPU 2)"];
    
    moe_33_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1923 (Node 240, GPU 3)"];
    
    moe_33_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1924 (Node 240, GPU 4)"];
    
    moe_33_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1925 (Node 240, GPU 5)"];
    
    moe_33_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1926 (Node 240, GPU 6)"];
    
    moe_33_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1927 (Node 240, GPU 7)"];
    
    moe_33_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1928 (Node 241, GPU 0)"];
    
    moe_33_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1929 (Node 241, GPU 1)"];
    
    moe_33_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1930 (Node 241, GPU 2)"];
    
    moe_33_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1931 (Node 241, GPU 3)"];
    
    moe_33_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1932 (Node 241, GPU 4)"];
    
    moe_33_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1933 (Node 241, GPU 5)"];
    
    moe_33_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1934 (Node 241, GPU 6)"];
    
    moe_33_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1935 (Node 241, GPU 7)"];
    
    moe_33_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1936 (Node 242, GPU 0)"];
    
    moe_33_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1937 (Node 242, GPU 1)"];
    
    moe_33_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1938 (Node 242, GPU 2)"];
    
    moe_33_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1939 (Node 242, GPU 3)"];
    
    moe_33_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1940 (Node 242, GPU 4)"];
    
    moe_33_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1941 (Node 242, GPU 5)"];
    
    moe_33_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1942 (Node 242, GPU 6)"];
    
    moe_33_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1943 (Node 242, GPU 7)"];
    
    moe_33_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1944 (Node 243, GPU 0)"];
    
    moe_33_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1945 (Node 243, GPU 1)"];
    
    moe_33_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1946 (Node 243, GPU 2)"];
    
    moe_33_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1947 (Node 243, GPU 3)"];
    
    moe_33_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1948 (Node 243, GPU 4)"];
    
    moe_33_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1949 (Node 243, GPU 5)"];
    
    moe_33_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1950 (Node 243, GPU 6)"];
    
    moe_33_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1951 (Node 243, GPU 7)"];
    
    moe_33_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1952 (Node 244, GPU 0)"];
    
    moe_33_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1953 (Node 244, GPU 1)"];
    
    moe_33_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1954 (Node 244, GPU 2)"];
    
    moe_33_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1955 (Node 244, GPU 3)"];
    
    moe_33_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1956 (Node 244, GPU 4)"];
    
    moe_33_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1957 (Node 244, GPU 5)"];
    
    moe_33_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1958 (Node 244, GPU 6)"];
    
    moe_33_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1959 (Node 244, GPU 7)"];
    
    moe_33_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1960 (Node 245, GPU 0)"];
    
    moe_33_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1961 (Node 245, GPU 1)"];
    
    moe_33_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1962 (Node 245, GPU 2)"];
    
    moe_33_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1963 (Node 245, GPU 3)"];
    
    moe_33_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1964 (Node 245, GPU 4)"];
    
    moe_33_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1965 (Node 245, GPU 5)"];
    
    moe_33_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1966 (Node 245, GPU 6)"];
    
    moe_33_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1967 (Node 245, GPU 7)"];
    
    moe_33_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1968 (Node 246, GPU 0)"];
    
    moe_33_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1969 (Node 246, GPU 1)"];
    
    moe_33_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1970 (Node 246, GPU 2)"];
    
    moe_33_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1971 (Node 246, GPU 3)"];
    
    moe_33_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1972 (Node 246, GPU 4)"];
    
    moe_33_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1973 (Node 246, GPU 5)"];
    
    moe_33_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1974 (Node 246, GPU 6)"];
    
    moe_33_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1975 (Node 246, GPU 7)"];
    
    moe_33_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1976 (Node 247, GPU 0)"];
    
    moe_33_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1977 (Node 247, GPU 1)"];
    
    moe_33_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1978 (Node 247, GPU 2)"];
    
    moe_33_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1979 (Node 247, GPU 3)"];
    
    moe_33_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1980 (Node 247, GPU 4)"];
    
    moe_33_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1981 (Node 247, GPU 5)"];
    
    moe_33_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1982 (Node 247, GPU 6)"];
    
    moe_33_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 33 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1983 (Node 247, GPU 7)"];
    
    moe_33_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 33 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1920 (Node 240, GPU 0)"];
    
    moe_33_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 33 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1920 (Node 240, GPU 0)"];
    
    // MoE Layer 34 - MHA components
    moe_34_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 34 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1984 (Node 248, GPU 0)"];
    
    moe_34_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 34 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1984 (Node 248, GPU 0)"];
    
    moe_34_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 34 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1984 (Node 248, GPU 0)"];
    
    moe_34_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 34 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 1984 (Node 248, GPU 0)"];
    
    moe_34_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 34 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1984 (Node 248, GPU 0)"];
    
    moe_34_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 34 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 1984 (Node 248, GPU 0)"];
    
    moe_34_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1984 (Node 248, GPU 0)"];
    
    moe_34_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1985 (Node 248, GPU 1)"];
    
    moe_34_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1986 (Node 248, GPU 2)"];
    
    moe_34_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1987 (Node 248, GPU 3)"];
    
    moe_34_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1988 (Node 248, GPU 4)"];
    
    moe_34_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1989 (Node 248, GPU 5)"];
    
    moe_34_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1990 (Node 248, GPU 6)"];
    
    moe_34_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1991 (Node 248, GPU 7)"];
    
    moe_34_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1992 (Node 249, GPU 0)"];
    
    moe_34_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1993 (Node 249, GPU 1)"];
    
    moe_34_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1994 (Node 249, GPU 2)"];
    
    moe_34_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1995 (Node 249, GPU 3)"];
    
    moe_34_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1996 (Node 249, GPU 4)"];
    
    moe_34_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1997 (Node 249, GPU 5)"];
    
    moe_34_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1998 (Node 249, GPU 6)"];
    
    moe_34_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1999 (Node 249, GPU 7)"];
    
    moe_34_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2000 (Node 250, GPU 0)"];
    
    moe_34_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2001 (Node 250, GPU 1)"];
    
    moe_34_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2002 (Node 250, GPU 2)"];
    
    moe_34_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2003 (Node 250, GPU 3)"];
    
    moe_34_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2004 (Node 250, GPU 4)"];
    
    moe_34_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2005 (Node 250, GPU 5)"];
    
    moe_34_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2006 (Node 250, GPU 6)"];
    
    moe_34_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2007 (Node 250, GPU 7)"];
    
    moe_34_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2008 (Node 251, GPU 0)"];
    
    moe_34_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2009 (Node 251, GPU 1)"];
    
    moe_34_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2010 (Node 251, GPU 2)"];
    
    moe_34_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2011 (Node 251, GPU 3)"];
    
    moe_34_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2012 (Node 251, GPU 4)"];
    
    moe_34_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2013 (Node 251, GPU 5)"];
    
    moe_34_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2014 (Node 251, GPU 6)"];
    
    moe_34_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2015 (Node 251, GPU 7)"];
    
    moe_34_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2016 (Node 252, GPU 0)"];
    
    moe_34_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2017 (Node 252, GPU 1)"];
    
    moe_34_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2018 (Node 252, GPU 2)"];
    
    moe_34_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2019 (Node 252, GPU 3)"];
    
    moe_34_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2020 (Node 252, GPU 4)"];
    
    moe_34_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2021 (Node 252, GPU 5)"];
    
    moe_34_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2022 (Node 252, GPU 6)"];
    
    moe_34_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2023 (Node 252, GPU 7)"];
    
    moe_34_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2024 (Node 253, GPU 0)"];
    
    moe_34_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2025 (Node 253, GPU 1)"];
    
    moe_34_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2026 (Node 253, GPU 2)"];
    
    moe_34_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2027 (Node 253, GPU 3)"];
    
    moe_34_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2028 (Node 253, GPU 4)"];
    
    moe_34_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2029 (Node 253, GPU 5)"];
    
    moe_34_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2030 (Node 253, GPU 6)"];
    
    moe_34_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2031 (Node 253, GPU 7)"];
    
    moe_34_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2032 (Node 254, GPU 0)"];
    
    moe_34_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2033 (Node 254, GPU 1)"];
    
    moe_34_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2034 (Node 254, GPU 2)"];
    
    moe_34_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2035 (Node 254, GPU 3)"];
    
    moe_34_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2036 (Node 254, GPU 4)"];
    
    moe_34_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2037 (Node 254, GPU 5)"];
    
    moe_34_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2038 (Node 254, GPU 6)"];
    
    moe_34_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2039 (Node 254, GPU 7)"];
    
    moe_34_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2040 (Node 255, GPU 0)"];
    
    moe_34_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2041 (Node 255, GPU 1)"];
    
    moe_34_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2042 (Node 255, GPU 2)"];
    
    moe_34_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2043 (Node 255, GPU 3)"];
    
    moe_34_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2044 (Node 255, GPU 4)"];
    
    moe_34_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2045 (Node 255, GPU 5)"];
    
    moe_34_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2046 (Node 255, GPU 6)"];
    
    moe_34_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 34 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2047 (Node 255, GPU 7)"];
    
    moe_34_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 34 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1984 (Node 248, GPU 0)"];
    
    moe_34_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 34 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 1984 (Node 248, GPU 0)"];
    
    // MoE Layer 35 - MHA components
    moe_35_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 35 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2048 (Node 256, GPU 0)"];
    
    moe_35_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 35 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2048 (Node 256, GPU 0)"];
    
    moe_35_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 35 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2048 (Node 256, GPU 0)"];
    
    moe_35_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 35 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2048 (Node 256, GPU 0)"];
    
    moe_35_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 35 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2048 (Node 256, GPU 0)"];
    
    moe_35_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 35 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2048 (Node 256, GPU 0)"];
    
    moe_35_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2048 (Node 256, GPU 0)"];
    
    moe_35_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2049 (Node 256, GPU 1)"];
    
    moe_35_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2050 (Node 256, GPU 2)"];
    
    moe_35_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2051 (Node 256, GPU 3)"];
    
    moe_35_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2052 (Node 256, GPU 4)"];
    
    moe_35_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2053 (Node 256, GPU 5)"];
    
    moe_35_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2054 (Node 256, GPU 6)"];
    
    moe_35_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2055 (Node 256, GPU 7)"];
    
    moe_35_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2056 (Node 257, GPU 0)"];
    
    moe_35_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2057 (Node 257, GPU 1)"];
    
    moe_35_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2058 (Node 257, GPU 2)"];
    
    moe_35_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2059 (Node 257, GPU 3)"];
    
    moe_35_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2060 (Node 257, GPU 4)"];
    
    moe_35_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2061 (Node 257, GPU 5)"];
    
    moe_35_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2062 (Node 257, GPU 6)"];
    
    moe_35_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2063 (Node 257, GPU 7)"];
    
    moe_35_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2064 (Node 258, GPU 0)"];
    
    moe_35_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2065 (Node 258, GPU 1)"];
    
    moe_35_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2066 (Node 258, GPU 2)"];
    
    moe_35_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2067 (Node 258, GPU 3)"];
    
    moe_35_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2068 (Node 258, GPU 4)"];
    
    moe_35_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2069 (Node 258, GPU 5)"];
    
    moe_35_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2070 (Node 258, GPU 6)"];
    
    moe_35_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2071 (Node 258, GPU 7)"];
    
    moe_35_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2072 (Node 259, GPU 0)"];
    
    moe_35_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2073 (Node 259, GPU 1)"];
    
    moe_35_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2074 (Node 259, GPU 2)"];
    
    moe_35_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2075 (Node 259, GPU 3)"];
    
    moe_35_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2076 (Node 259, GPU 4)"];
    
    moe_35_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2077 (Node 259, GPU 5)"];
    
    moe_35_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2078 (Node 259, GPU 6)"];
    
    moe_35_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2079 (Node 259, GPU 7)"];
    
    moe_35_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2080 (Node 260, GPU 0)"];
    
    moe_35_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2081 (Node 260, GPU 1)"];
    
    moe_35_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2082 (Node 260, GPU 2)"];
    
    moe_35_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2083 (Node 260, GPU 3)"];
    
    moe_35_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2084 (Node 260, GPU 4)"];
    
    moe_35_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2085 (Node 260, GPU 5)"];
    
    moe_35_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2086 (Node 260, GPU 6)"];
    
    moe_35_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2087 (Node 260, GPU 7)"];
    
    moe_35_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2088 (Node 261, GPU 0)"];
    
    moe_35_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2089 (Node 261, GPU 1)"];
    
    moe_35_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2090 (Node 261, GPU 2)"];
    
    moe_35_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2091 (Node 261, GPU 3)"];
    
    moe_35_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2092 (Node 261, GPU 4)"];
    
    moe_35_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2093 (Node 261, GPU 5)"];
    
    moe_35_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2094 (Node 261, GPU 6)"];
    
    moe_35_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2095 (Node 261, GPU 7)"];
    
    moe_35_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2096 (Node 262, GPU 0)"];
    
    moe_35_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2097 (Node 262, GPU 1)"];
    
    moe_35_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2098 (Node 262, GPU 2)"];
    
    moe_35_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2099 (Node 262, GPU 3)"];
    
    moe_35_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2100 (Node 262, GPU 4)"];
    
    moe_35_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2101 (Node 262, GPU 5)"];
    
    moe_35_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2102 (Node 262, GPU 6)"];
    
    moe_35_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2103 (Node 262, GPU 7)"];
    
    moe_35_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2104 (Node 263, GPU 0)"];
    
    moe_35_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2105 (Node 263, GPU 1)"];
    
    moe_35_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2106 (Node 263, GPU 2)"];
    
    moe_35_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2107 (Node 263, GPU 3)"];
    
    moe_35_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2108 (Node 263, GPU 4)"];
    
    moe_35_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2109 (Node 263, GPU 5)"];
    
    moe_35_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2110 (Node 263, GPU 6)"];
    
    moe_35_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 35 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2111 (Node 263, GPU 7)"];
    
    moe_35_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 35 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2048 (Node 256, GPU 0)"];
    
    moe_35_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 35 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2048 (Node 256, GPU 0)"];
    
    // MoE Layer 36 - MHA components
    moe_36_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 36 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2112 (Node 264, GPU 0)"];
    
    moe_36_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 36 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2112 (Node 264, GPU 0)"];
    
    moe_36_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 36 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2112 (Node 264, GPU 0)"];
    
    moe_36_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 36 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2112 (Node 264, GPU 0)"];
    
    moe_36_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 36 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2112 (Node 264, GPU 0)"];
    
    moe_36_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 36 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2112 (Node 264, GPU 0)"];
    
    moe_36_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2112 (Node 264, GPU 0)"];
    
    moe_36_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2113 (Node 264, GPU 1)"];
    
    moe_36_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2114 (Node 264, GPU 2)"];
    
    moe_36_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2115 (Node 264, GPU 3)"];
    
    moe_36_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2116 (Node 264, GPU 4)"];
    
    moe_36_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2117 (Node 264, GPU 5)"];
    
    moe_36_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2118 (Node 264, GPU 6)"];
    
    moe_36_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2119 (Node 264, GPU 7)"];
    
    moe_36_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2120 (Node 265, GPU 0)"];
    
    moe_36_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2121 (Node 265, GPU 1)"];
    
    moe_36_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2122 (Node 265, GPU 2)"];
    
    moe_36_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2123 (Node 265, GPU 3)"];
    
    moe_36_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2124 (Node 265, GPU 4)"];
    
    moe_36_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2125 (Node 265, GPU 5)"];
    
    moe_36_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2126 (Node 265, GPU 6)"];
    
    moe_36_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2127 (Node 265, GPU 7)"];
    
    moe_36_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2128 (Node 266, GPU 0)"];
    
    moe_36_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2129 (Node 266, GPU 1)"];
    
    moe_36_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2130 (Node 266, GPU 2)"];
    
    moe_36_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2131 (Node 266, GPU 3)"];
    
    moe_36_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2132 (Node 266, GPU 4)"];
    
    moe_36_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2133 (Node 266, GPU 5)"];
    
    moe_36_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2134 (Node 266, GPU 6)"];
    
    moe_36_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2135 (Node 266, GPU 7)"];
    
    moe_36_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2136 (Node 267, GPU 0)"];
    
    moe_36_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2137 (Node 267, GPU 1)"];
    
    moe_36_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2138 (Node 267, GPU 2)"];
    
    moe_36_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2139 (Node 267, GPU 3)"];
    
    moe_36_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2140 (Node 267, GPU 4)"];
    
    moe_36_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2141 (Node 267, GPU 5)"];
    
    moe_36_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2142 (Node 267, GPU 6)"];
    
    moe_36_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2143 (Node 267, GPU 7)"];
    
    moe_36_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2144 (Node 268, GPU 0)"];
    
    moe_36_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2145 (Node 268, GPU 1)"];
    
    moe_36_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2146 (Node 268, GPU 2)"];
    
    moe_36_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2147 (Node 268, GPU 3)"];
    
    moe_36_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2148 (Node 268, GPU 4)"];
    
    moe_36_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2149 (Node 268, GPU 5)"];
    
    moe_36_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2150 (Node 268, GPU 6)"];
    
    moe_36_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2151 (Node 268, GPU 7)"];
    
    moe_36_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2152 (Node 269, GPU 0)"];
    
    moe_36_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2153 (Node 269, GPU 1)"];
    
    moe_36_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2154 (Node 269, GPU 2)"];
    
    moe_36_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2155 (Node 269, GPU 3)"];
    
    moe_36_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2156 (Node 269, GPU 4)"];
    
    moe_36_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2157 (Node 269, GPU 5)"];
    
    moe_36_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2158 (Node 269, GPU 6)"];
    
    moe_36_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2159 (Node 269, GPU 7)"];
    
    moe_36_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2160 (Node 270, GPU 0)"];
    
    moe_36_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2161 (Node 270, GPU 1)"];
    
    moe_36_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2162 (Node 270, GPU 2)"];
    
    moe_36_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2163 (Node 270, GPU 3)"];
    
    moe_36_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2164 (Node 270, GPU 4)"];
    
    moe_36_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2165 (Node 270, GPU 5)"];
    
    moe_36_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2166 (Node 270, GPU 6)"];
    
    moe_36_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2167 (Node 270, GPU 7)"];
    
    moe_36_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2168 (Node 271, GPU 0)"];
    
    moe_36_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2169 (Node 271, GPU 1)"];
    
    moe_36_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2170 (Node 271, GPU 2)"];
    
    moe_36_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2171 (Node 271, GPU 3)"];
    
    moe_36_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2172 (Node 271, GPU 4)"];
    
    moe_36_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2173 (Node 271, GPU 5)"];
    
    moe_36_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2174 (Node 271, GPU 6)"];
    
    moe_36_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 36 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2175 (Node 271, GPU 7)"];
    
    moe_36_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 36 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2112 (Node 264, GPU 0)"];
    
    moe_36_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 36 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2112 (Node 264, GPU 0)"];
    
    // MoE Layer 37 - MHA components
    moe_37_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 37 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2176 (Node 272, GPU 0)"];
    
    moe_37_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 37 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2176 (Node 272, GPU 0)"];
    
    moe_37_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 37 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2176 (Node 272, GPU 0)"];
    
    moe_37_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 37 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2176 (Node 272, GPU 0)"];
    
    moe_37_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 37 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2176 (Node 272, GPU 0)"];
    
    moe_37_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 37 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2176 (Node 272, GPU 0)"];
    
    moe_37_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2176 (Node 272, GPU 0)"];
    
    moe_37_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2177 (Node 272, GPU 1)"];
    
    moe_37_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2178 (Node 272, GPU 2)"];
    
    moe_37_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2179 (Node 272, GPU 3)"];
    
    moe_37_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2180 (Node 272, GPU 4)"];
    
    moe_37_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2181 (Node 272, GPU 5)"];
    
    moe_37_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2182 (Node 272, GPU 6)"];
    
    moe_37_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2183 (Node 272, GPU 7)"];
    
    moe_37_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2184 (Node 273, GPU 0)"];
    
    moe_37_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2185 (Node 273, GPU 1)"];
    
    moe_37_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2186 (Node 273, GPU 2)"];
    
    moe_37_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2187 (Node 273, GPU 3)"];
    
    moe_37_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2188 (Node 273, GPU 4)"];
    
    moe_37_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2189 (Node 273, GPU 5)"];
    
    moe_37_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2190 (Node 273, GPU 6)"];
    
    moe_37_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2191 (Node 273, GPU 7)"];
    
    moe_37_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2192 (Node 274, GPU 0)"];
    
    moe_37_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2193 (Node 274, GPU 1)"];
    
    moe_37_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2194 (Node 274, GPU 2)"];
    
    moe_37_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2195 (Node 274, GPU 3)"];
    
    moe_37_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2196 (Node 274, GPU 4)"];
    
    moe_37_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2197 (Node 274, GPU 5)"];
    
    moe_37_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2198 (Node 274, GPU 6)"];
    
    moe_37_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2199 (Node 274, GPU 7)"];
    
    moe_37_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2200 (Node 275, GPU 0)"];
    
    moe_37_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2201 (Node 275, GPU 1)"];
    
    moe_37_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2202 (Node 275, GPU 2)"];
    
    moe_37_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2203 (Node 275, GPU 3)"];
    
    moe_37_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2204 (Node 275, GPU 4)"];
    
    moe_37_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2205 (Node 275, GPU 5)"];
    
    moe_37_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2206 (Node 275, GPU 6)"];
    
    moe_37_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2207 (Node 275, GPU 7)"];
    
    moe_37_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2208 (Node 276, GPU 0)"];
    
    moe_37_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2209 (Node 276, GPU 1)"];
    
    moe_37_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2210 (Node 276, GPU 2)"];
    
    moe_37_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2211 (Node 276, GPU 3)"];
    
    moe_37_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2212 (Node 276, GPU 4)"];
    
    moe_37_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2213 (Node 276, GPU 5)"];
    
    moe_37_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2214 (Node 276, GPU 6)"];
    
    moe_37_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2215 (Node 276, GPU 7)"];
    
    moe_37_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2216 (Node 277, GPU 0)"];
    
    moe_37_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2217 (Node 277, GPU 1)"];
    
    moe_37_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2218 (Node 277, GPU 2)"];
    
    moe_37_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2219 (Node 277, GPU 3)"];
    
    moe_37_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2220 (Node 277, GPU 4)"];
    
    moe_37_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2221 (Node 277, GPU 5)"];
    
    moe_37_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2222 (Node 277, GPU 6)"];
    
    moe_37_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2223 (Node 277, GPU 7)"];
    
    moe_37_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2224 (Node 278, GPU 0)"];
    
    moe_37_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2225 (Node 278, GPU 1)"];
    
    moe_37_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2226 (Node 278, GPU 2)"];
    
    moe_37_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2227 (Node 278, GPU 3)"];
    
    moe_37_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2228 (Node 278, GPU 4)"];
    
    moe_37_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2229 (Node 278, GPU 5)"];
    
    moe_37_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2230 (Node 278, GPU 6)"];
    
    moe_37_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2231 (Node 278, GPU 7)"];
    
    moe_37_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2232 (Node 279, GPU 0)"];
    
    moe_37_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2233 (Node 279, GPU 1)"];
    
    moe_37_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2234 (Node 279, GPU 2)"];
    
    moe_37_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2235 (Node 279, GPU 3)"];
    
    moe_37_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2236 (Node 279, GPU 4)"];
    
    moe_37_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2237 (Node 279, GPU 5)"];
    
    moe_37_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2238 (Node 279, GPU 6)"];
    
    moe_37_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 37 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2239 (Node 279, GPU 7)"];
    
    moe_37_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 37 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2176 (Node 272, GPU 0)"];
    
    moe_37_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 37 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2176 (Node 272, GPU 0)"];
    
    // MoE Layer 38 - MHA components
    moe_38_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 38 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2240 (Node 280, GPU 0)"];
    
    moe_38_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 38 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2240 (Node 280, GPU 0)"];
    
    moe_38_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 38 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2240 (Node 280, GPU 0)"];
    
    moe_38_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 38 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2240 (Node 280, GPU 0)"];
    
    moe_38_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 38 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2240 (Node 280, GPU 0)"];
    
    moe_38_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 38 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2240 (Node 280, GPU 0)"];
    
    moe_38_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2240 (Node 280, GPU 0)"];
    
    moe_38_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2241 (Node 280, GPU 1)"];
    
    moe_38_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2242 (Node 280, GPU 2)"];
    
    moe_38_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2243 (Node 280, GPU 3)"];
    
    moe_38_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2244 (Node 280, GPU 4)"];
    
    moe_38_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2245 (Node 280, GPU 5)"];
    
    moe_38_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2246 (Node 280, GPU 6)"];
    
    moe_38_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2247 (Node 280, GPU 7)"];
    
    moe_38_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2248 (Node 281, GPU 0)"];
    
    moe_38_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2249 (Node 281, GPU 1)"];
    
    moe_38_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2250 (Node 281, GPU 2)"];
    
    moe_38_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2251 (Node 281, GPU 3)"];
    
    moe_38_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2252 (Node 281, GPU 4)"];
    
    moe_38_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2253 (Node 281, GPU 5)"];
    
    moe_38_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2254 (Node 281, GPU 6)"];
    
    moe_38_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2255 (Node 281, GPU 7)"];
    
    moe_38_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2256 (Node 282, GPU 0)"];
    
    moe_38_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2257 (Node 282, GPU 1)"];
    
    moe_38_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2258 (Node 282, GPU 2)"];
    
    moe_38_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2259 (Node 282, GPU 3)"];
    
    moe_38_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2260 (Node 282, GPU 4)"];
    
    moe_38_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2261 (Node 282, GPU 5)"];
    
    moe_38_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2262 (Node 282, GPU 6)"];
    
    moe_38_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2263 (Node 282, GPU 7)"];
    
    moe_38_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2264 (Node 283, GPU 0)"];
    
    moe_38_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2265 (Node 283, GPU 1)"];
    
    moe_38_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2266 (Node 283, GPU 2)"];
    
    moe_38_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2267 (Node 283, GPU 3)"];
    
    moe_38_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2268 (Node 283, GPU 4)"];
    
    moe_38_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2269 (Node 283, GPU 5)"];
    
    moe_38_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2270 (Node 283, GPU 6)"];
    
    moe_38_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2271 (Node 283, GPU 7)"];
    
    moe_38_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2272 (Node 284, GPU 0)"];
    
    moe_38_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2273 (Node 284, GPU 1)"];
    
    moe_38_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2274 (Node 284, GPU 2)"];
    
    moe_38_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2275 (Node 284, GPU 3)"];
    
    moe_38_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2276 (Node 284, GPU 4)"];
    
    moe_38_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2277 (Node 284, GPU 5)"];
    
    moe_38_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2278 (Node 284, GPU 6)"];
    
    moe_38_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2279 (Node 284, GPU 7)"];
    
    moe_38_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2280 (Node 285, GPU 0)"];
    
    moe_38_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2281 (Node 285, GPU 1)"];
    
    moe_38_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2282 (Node 285, GPU 2)"];
    
    moe_38_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2283 (Node 285, GPU 3)"];
    
    moe_38_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2284 (Node 285, GPU 4)"];
    
    moe_38_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2285 (Node 285, GPU 5)"];
    
    moe_38_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2286 (Node 285, GPU 6)"];
    
    moe_38_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2287 (Node 285, GPU 7)"];
    
    moe_38_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2288 (Node 286, GPU 0)"];
    
    moe_38_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2289 (Node 286, GPU 1)"];
    
    moe_38_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2290 (Node 286, GPU 2)"];
    
    moe_38_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2291 (Node 286, GPU 3)"];
    
    moe_38_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2292 (Node 286, GPU 4)"];
    
    moe_38_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2293 (Node 286, GPU 5)"];
    
    moe_38_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2294 (Node 286, GPU 6)"];
    
    moe_38_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2295 (Node 286, GPU 7)"];
    
    moe_38_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2296 (Node 287, GPU 0)"];
    
    moe_38_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2297 (Node 287, GPU 1)"];
    
    moe_38_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2298 (Node 287, GPU 2)"];
    
    moe_38_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2299 (Node 287, GPU 3)"];
    
    moe_38_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2300 (Node 287, GPU 4)"];
    
    moe_38_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2301 (Node 287, GPU 5)"];
    
    moe_38_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2302 (Node 287, GPU 6)"];
    
    moe_38_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 38 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2303 (Node 287, GPU 7)"];
    
    moe_38_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 38 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2240 (Node 280, GPU 0)"];
    
    moe_38_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 38 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2240 (Node 280, GPU 0)"];
    
    // MoE Layer 39 - MHA components
    moe_39_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 39 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2304 (Node 288, GPU 0)"];
    
    moe_39_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 39 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2304 (Node 288, GPU 0)"];
    
    moe_39_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 39 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2304 (Node 288, GPU 0)"];
    
    moe_39_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 39 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2304 (Node 288, GPU 0)"];
    
    moe_39_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 39 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2304 (Node 288, GPU 0)"];
    
    moe_39_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 39 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2304 (Node 288, GPU 0)"];
    
    moe_39_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2304 (Node 288, GPU 0)"];
    
    moe_39_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2305 (Node 288, GPU 1)"];
    
    moe_39_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2306 (Node 288, GPU 2)"];
    
    moe_39_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2307 (Node 288, GPU 3)"];
    
    moe_39_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2308 (Node 288, GPU 4)"];
    
    moe_39_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2309 (Node 288, GPU 5)"];
    
    moe_39_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2310 (Node 288, GPU 6)"];
    
    moe_39_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2311 (Node 288, GPU 7)"];
    
    moe_39_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2312 (Node 289, GPU 0)"];
    
    moe_39_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2313 (Node 289, GPU 1)"];
    
    moe_39_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2314 (Node 289, GPU 2)"];
    
    moe_39_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2315 (Node 289, GPU 3)"];
    
    moe_39_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2316 (Node 289, GPU 4)"];
    
    moe_39_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2317 (Node 289, GPU 5)"];
    
    moe_39_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2318 (Node 289, GPU 6)"];
    
    moe_39_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2319 (Node 289, GPU 7)"];
    
    moe_39_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2320 (Node 290, GPU 0)"];
    
    moe_39_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2321 (Node 290, GPU 1)"];
    
    moe_39_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2322 (Node 290, GPU 2)"];
    
    moe_39_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2323 (Node 290, GPU 3)"];
    
    moe_39_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2324 (Node 290, GPU 4)"];
    
    moe_39_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2325 (Node 290, GPU 5)"];
    
    moe_39_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2326 (Node 290, GPU 6)"];
    
    moe_39_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2327 (Node 290, GPU 7)"];
    
    moe_39_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2328 (Node 291, GPU 0)"];
    
    moe_39_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2329 (Node 291, GPU 1)"];
    
    moe_39_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2330 (Node 291, GPU 2)"];
    
    moe_39_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2331 (Node 291, GPU 3)"];
    
    moe_39_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2332 (Node 291, GPU 4)"];
    
    moe_39_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2333 (Node 291, GPU 5)"];
    
    moe_39_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2334 (Node 291, GPU 6)"];
    
    moe_39_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2335 (Node 291, GPU 7)"];
    
    moe_39_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2336 (Node 292, GPU 0)"];
    
    moe_39_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2337 (Node 292, GPU 1)"];
    
    moe_39_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2338 (Node 292, GPU 2)"];
    
    moe_39_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2339 (Node 292, GPU 3)"];
    
    moe_39_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2340 (Node 292, GPU 4)"];
    
    moe_39_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2341 (Node 292, GPU 5)"];
    
    moe_39_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2342 (Node 292, GPU 6)"];
    
    moe_39_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2343 (Node 292, GPU 7)"];
    
    moe_39_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2344 (Node 293, GPU 0)"];
    
    moe_39_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2345 (Node 293, GPU 1)"];
    
    moe_39_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2346 (Node 293, GPU 2)"];
    
    moe_39_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2347 (Node 293, GPU 3)"];
    
    moe_39_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2348 (Node 293, GPU 4)"];
    
    moe_39_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2349 (Node 293, GPU 5)"];
    
    moe_39_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2350 (Node 293, GPU 6)"];
    
    moe_39_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2351 (Node 293, GPU 7)"];
    
    moe_39_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2352 (Node 294, GPU 0)"];
    
    moe_39_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2353 (Node 294, GPU 1)"];
    
    moe_39_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2354 (Node 294, GPU 2)"];
    
    moe_39_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2355 (Node 294, GPU 3)"];
    
    moe_39_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2356 (Node 294, GPU 4)"];
    
    moe_39_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2357 (Node 294, GPU 5)"];
    
    moe_39_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2358 (Node 294, GPU 6)"];
    
    moe_39_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2359 (Node 294, GPU 7)"];
    
    moe_39_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2360 (Node 295, GPU 0)"];
    
    moe_39_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2361 (Node 295, GPU 1)"];
    
    moe_39_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2362 (Node 295, GPU 2)"];
    
    moe_39_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2363 (Node 295, GPU 3)"];
    
    moe_39_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2364 (Node 295, GPU 4)"];
    
    moe_39_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2365 (Node 295, GPU 5)"];
    
    moe_39_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2366 (Node 295, GPU 6)"];
    
    moe_39_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 39 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2367 (Node 295, GPU 7)"];
    
    moe_39_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 39 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2304 (Node 288, GPU 0)"];
    
    moe_39_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 39 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2304 (Node 288, GPU 0)"];
    
    // MoE Layer 40 - MHA components
    moe_40_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 40 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2368 (Node 296, GPU 0)"];
    
    moe_40_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 40 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2368 (Node 296, GPU 0)"];
    
    moe_40_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 40 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2368 (Node 296, GPU 0)"];
    
    moe_40_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 40 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2368 (Node 296, GPU 0)"];
    
    moe_40_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 40 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2368 (Node 296, GPU 0)"];
    
    moe_40_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 40 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2368 (Node 296, GPU 0)"];
    
    moe_40_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2368 (Node 296, GPU 0)"];
    
    moe_40_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2369 (Node 296, GPU 1)"];
    
    moe_40_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2370 (Node 296, GPU 2)"];
    
    moe_40_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2371 (Node 296, GPU 3)"];
    
    moe_40_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2372 (Node 296, GPU 4)"];
    
    moe_40_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2373 (Node 296, GPU 5)"];
    
    moe_40_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2374 (Node 296, GPU 6)"];
    
    moe_40_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2375 (Node 296, GPU 7)"];
    
    moe_40_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2376 (Node 297, GPU 0)"];
    
    moe_40_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2377 (Node 297, GPU 1)"];
    
    moe_40_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2378 (Node 297, GPU 2)"];
    
    moe_40_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2379 (Node 297, GPU 3)"];
    
    moe_40_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2380 (Node 297, GPU 4)"];
    
    moe_40_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2381 (Node 297, GPU 5)"];
    
    moe_40_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2382 (Node 297, GPU 6)"];
    
    moe_40_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2383 (Node 297, GPU 7)"];
    
    moe_40_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2384 (Node 298, GPU 0)"];
    
    moe_40_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2385 (Node 298, GPU 1)"];
    
    moe_40_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2386 (Node 298, GPU 2)"];
    
    moe_40_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2387 (Node 298, GPU 3)"];
    
    moe_40_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2388 (Node 298, GPU 4)"];
    
    moe_40_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2389 (Node 298, GPU 5)"];
    
    moe_40_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2390 (Node 298, GPU 6)"];
    
    moe_40_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2391 (Node 298, GPU 7)"];
    
    moe_40_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2392 (Node 299, GPU 0)"];
    
    moe_40_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2393 (Node 299, GPU 1)"];
    
    moe_40_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2394 (Node 299, GPU 2)"];
    
    moe_40_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2395 (Node 299, GPU 3)"];
    
    moe_40_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2396 (Node 299, GPU 4)"];
    
    moe_40_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2397 (Node 299, GPU 5)"];
    
    moe_40_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2398 (Node 299, GPU 6)"];
    
    moe_40_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2399 (Node 299, GPU 7)"];
    
    moe_40_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2400 (Node 300, GPU 0)"];
    
    moe_40_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2401 (Node 300, GPU 1)"];
    
    moe_40_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2402 (Node 300, GPU 2)"];
    
    moe_40_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2403 (Node 300, GPU 3)"];
    
    moe_40_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2404 (Node 300, GPU 4)"];
    
    moe_40_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2405 (Node 300, GPU 5)"];
    
    moe_40_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2406 (Node 300, GPU 6)"];
    
    moe_40_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2407 (Node 300, GPU 7)"];
    
    moe_40_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2408 (Node 301, GPU 0)"];
    
    moe_40_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2409 (Node 301, GPU 1)"];
    
    moe_40_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2410 (Node 301, GPU 2)"];
    
    moe_40_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2411 (Node 301, GPU 3)"];
    
    moe_40_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2412 (Node 301, GPU 4)"];
    
    moe_40_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2413 (Node 301, GPU 5)"];
    
    moe_40_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2414 (Node 301, GPU 6)"];
    
    moe_40_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2415 (Node 301, GPU 7)"];
    
    moe_40_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2416 (Node 302, GPU 0)"];
    
    moe_40_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2417 (Node 302, GPU 1)"];
    
    moe_40_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2418 (Node 302, GPU 2)"];
    
    moe_40_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2419 (Node 302, GPU 3)"];
    
    moe_40_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2420 (Node 302, GPU 4)"];
    
    moe_40_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2421 (Node 302, GPU 5)"];
    
    moe_40_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2422 (Node 302, GPU 6)"];
    
    moe_40_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2423 (Node 302, GPU 7)"];
    
    moe_40_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2424 (Node 303, GPU 0)"];
    
    moe_40_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2425 (Node 303, GPU 1)"];
    
    moe_40_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2426 (Node 303, GPU 2)"];
    
    moe_40_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2427 (Node 303, GPU 3)"];
    
    moe_40_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2428 (Node 303, GPU 4)"];
    
    moe_40_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2429 (Node 303, GPU 5)"];
    
    moe_40_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2430 (Node 303, GPU 6)"];
    
    moe_40_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 40 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2431 (Node 303, GPU 7)"];
    
    moe_40_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 40 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2368 (Node 296, GPU 0)"];
    
    moe_40_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 40 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2368 (Node 296, GPU 0)"];
    
    // MoE Layer 41 - MHA components
    moe_41_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 41 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2432 (Node 304, GPU 0)"];
    
    moe_41_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 41 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2432 (Node 304, GPU 0)"];
    
    moe_41_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 41 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2432 (Node 304, GPU 0)"];
    
    moe_41_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 41 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2432 (Node 304, GPU 0)"];
    
    moe_41_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 41 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2432 (Node 304, GPU 0)"];
    
    moe_41_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 41 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2432 (Node 304, GPU 0)"];
    
    moe_41_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2432 (Node 304, GPU 0)"];
    
    moe_41_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2433 (Node 304, GPU 1)"];
    
    moe_41_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2434 (Node 304, GPU 2)"];
    
    moe_41_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2435 (Node 304, GPU 3)"];
    
    moe_41_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2436 (Node 304, GPU 4)"];
    
    moe_41_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2437 (Node 304, GPU 5)"];
    
    moe_41_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2438 (Node 304, GPU 6)"];
    
    moe_41_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2439 (Node 304, GPU 7)"];
    
    moe_41_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2440 (Node 305, GPU 0)"];
    
    moe_41_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2441 (Node 305, GPU 1)"];
    
    moe_41_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2442 (Node 305, GPU 2)"];
    
    moe_41_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2443 (Node 305, GPU 3)"];
    
    moe_41_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2444 (Node 305, GPU 4)"];
    
    moe_41_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2445 (Node 305, GPU 5)"];
    
    moe_41_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2446 (Node 305, GPU 6)"];
    
    moe_41_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2447 (Node 305, GPU 7)"];
    
    moe_41_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2448 (Node 306, GPU 0)"];
    
    moe_41_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2449 (Node 306, GPU 1)"];
    
    moe_41_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2450 (Node 306, GPU 2)"];
    
    moe_41_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2451 (Node 306, GPU 3)"];
    
    moe_41_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2452 (Node 306, GPU 4)"];
    
    moe_41_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2453 (Node 306, GPU 5)"];
    
    moe_41_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2454 (Node 306, GPU 6)"];
    
    moe_41_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2455 (Node 306, GPU 7)"];
    
    moe_41_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2456 (Node 307, GPU 0)"];
    
    moe_41_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2457 (Node 307, GPU 1)"];
    
    moe_41_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2458 (Node 307, GPU 2)"];
    
    moe_41_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2459 (Node 307, GPU 3)"];
    
    moe_41_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2460 (Node 307, GPU 4)"];
    
    moe_41_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2461 (Node 307, GPU 5)"];
    
    moe_41_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2462 (Node 307, GPU 6)"];
    
    moe_41_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2463 (Node 307, GPU 7)"];
    
    moe_41_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2464 (Node 308, GPU 0)"];
    
    moe_41_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2465 (Node 308, GPU 1)"];
    
    moe_41_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2466 (Node 308, GPU 2)"];
    
    moe_41_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2467 (Node 308, GPU 3)"];
    
    moe_41_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2468 (Node 308, GPU 4)"];
    
    moe_41_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2469 (Node 308, GPU 5)"];
    
    moe_41_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2470 (Node 308, GPU 6)"];
    
    moe_41_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2471 (Node 308, GPU 7)"];
    
    moe_41_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2472 (Node 309, GPU 0)"];
    
    moe_41_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2473 (Node 309, GPU 1)"];
    
    moe_41_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2474 (Node 309, GPU 2)"];
    
    moe_41_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2475 (Node 309, GPU 3)"];
    
    moe_41_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2476 (Node 309, GPU 4)"];
    
    moe_41_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2477 (Node 309, GPU 5)"];
    
    moe_41_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2478 (Node 309, GPU 6)"];
    
    moe_41_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2479 (Node 309, GPU 7)"];
    
    moe_41_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2480 (Node 310, GPU 0)"];
    
    moe_41_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2481 (Node 310, GPU 1)"];
    
    moe_41_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2482 (Node 310, GPU 2)"];
    
    moe_41_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2483 (Node 310, GPU 3)"];
    
    moe_41_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2484 (Node 310, GPU 4)"];
    
    moe_41_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2485 (Node 310, GPU 5)"];
    
    moe_41_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2486 (Node 310, GPU 6)"];
    
    moe_41_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2487 (Node 310, GPU 7)"];
    
    moe_41_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2488 (Node 311, GPU 0)"];
    
    moe_41_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2489 (Node 311, GPU 1)"];
    
    moe_41_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2490 (Node 311, GPU 2)"];
    
    moe_41_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2491 (Node 311, GPU 3)"];
    
    moe_41_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2492 (Node 311, GPU 4)"];
    
    moe_41_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2493 (Node 311, GPU 5)"];
    
    moe_41_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2494 (Node 311, GPU 6)"];
    
    moe_41_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 41 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2495 (Node 311, GPU 7)"];
    
    moe_41_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 41 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2432 (Node 304, GPU 0)"];
    
    moe_41_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 41 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2432 (Node 304, GPU 0)"];
    
    // MoE Layer 42 - MHA components
    moe_42_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 42 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2496 (Node 312, GPU 0)"];
    
    moe_42_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 42 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2496 (Node 312, GPU 0)"];
    
    moe_42_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 42 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2496 (Node 312, GPU 0)"];
    
    moe_42_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 42 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2496 (Node 312, GPU 0)"];
    
    moe_42_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 42 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2496 (Node 312, GPU 0)"];
    
    moe_42_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 42 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2496 (Node 312, GPU 0)"];
    
    moe_42_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2496 (Node 312, GPU 0)"];
    
    moe_42_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2497 (Node 312, GPU 1)"];
    
    moe_42_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2498 (Node 312, GPU 2)"];
    
    moe_42_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2499 (Node 312, GPU 3)"];
    
    moe_42_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2500 (Node 312, GPU 4)"];
    
    moe_42_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2501 (Node 312, GPU 5)"];
    
    moe_42_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2502 (Node 312, GPU 6)"];
    
    moe_42_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2503 (Node 312, GPU 7)"];
    
    moe_42_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2504 (Node 313, GPU 0)"];
    
    moe_42_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2505 (Node 313, GPU 1)"];
    
    moe_42_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2506 (Node 313, GPU 2)"];
    
    moe_42_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2507 (Node 313, GPU 3)"];
    
    moe_42_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2508 (Node 313, GPU 4)"];
    
    moe_42_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2509 (Node 313, GPU 5)"];
    
    moe_42_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2510 (Node 313, GPU 6)"];
    
    moe_42_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2511 (Node 313, GPU 7)"];
    
    moe_42_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2512 (Node 314, GPU 0)"];
    
    moe_42_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2513 (Node 314, GPU 1)"];
    
    moe_42_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2514 (Node 314, GPU 2)"];
    
    moe_42_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2515 (Node 314, GPU 3)"];
    
    moe_42_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2516 (Node 314, GPU 4)"];
    
    moe_42_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2517 (Node 314, GPU 5)"];
    
    moe_42_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2518 (Node 314, GPU 6)"];
    
    moe_42_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2519 (Node 314, GPU 7)"];
    
    moe_42_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2520 (Node 315, GPU 0)"];
    
    moe_42_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2521 (Node 315, GPU 1)"];
    
    moe_42_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2522 (Node 315, GPU 2)"];
    
    moe_42_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2523 (Node 315, GPU 3)"];
    
    moe_42_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2524 (Node 315, GPU 4)"];
    
    moe_42_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2525 (Node 315, GPU 5)"];
    
    moe_42_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2526 (Node 315, GPU 6)"];
    
    moe_42_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2527 (Node 315, GPU 7)"];
    
    moe_42_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2528 (Node 316, GPU 0)"];
    
    moe_42_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2529 (Node 316, GPU 1)"];
    
    moe_42_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2530 (Node 316, GPU 2)"];
    
    moe_42_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2531 (Node 316, GPU 3)"];
    
    moe_42_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2532 (Node 316, GPU 4)"];
    
    moe_42_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2533 (Node 316, GPU 5)"];
    
    moe_42_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2534 (Node 316, GPU 6)"];
    
    moe_42_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2535 (Node 316, GPU 7)"];
    
    moe_42_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2536 (Node 317, GPU 0)"];
    
    moe_42_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2537 (Node 317, GPU 1)"];
    
    moe_42_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2538 (Node 317, GPU 2)"];
    
    moe_42_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2539 (Node 317, GPU 3)"];
    
    moe_42_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2540 (Node 317, GPU 4)"];
    
    moe_42_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2541 (Node 317, GPU 5)"];
    
    moe_42_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2542 (Node 317, GPU 6)"];
    
    moe_42_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2543 (Node 317, GPU 7)"];
    
    moe_42_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2544 (Node 318, GPU 0)"];
    
    moe_42_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2545 (Node 318, GPU 1)"];
    
    moe_42_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2546 (Node 318, GPU 2)"];
    
    moe_42_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2547 (Node 318, GPU 3)"];
    
    moe_42_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2548 (Node 318, GPU 4)"];
    
    moe_42_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2549 (Node 318, GPU 5)"];
    
    moe_42_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2550 (Node 318, GPU 6)"];
    
    moe_42_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2551 (Node 318, GPU 7)"];
    
    moe_42_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2552 (Node 319, GPU 0)"];
    
    moe_42_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2553 (Node 319, GPU 1)"];
    
    moe_42_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2554 (Node 319, GPU 2)"];
    
    moe_42_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2555 (Node 319, GPU 3)"];
    
    moe_42_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2556 (Node 319, GPU 4)"];
    
    moe_42_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2557 (Node 319, GPU 5)"];
    
    moe_42_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2558 (Node 319, GPU 6)"];
    
    moe_42_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 42 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2559 (Node 319, GPU 7)"];
    
    moe_42_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 42 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2496 (Node 312, GPU 0)"];
    
    moe_42_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 42 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2496 (Node 312, GPU 0)"];
    
    // MoE Layer 43 - MHA components
    moe_43_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 43 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2560 (Node 320, GPU 0)"];
    
    moe_43_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 43 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2560 (Node 320, GPU 0)"];
    
    moe_43_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 43 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2560 (Node 320, GPU 0)"];
    
    moe_43_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 43 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2560 (Node 320, GPU 0)"];
    
    moe_43_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 43 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2560 (Node 320, GPU 0)"];
    
    moe_43_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 43 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2560 (Node 320, GPU 0)"];
    
    moe_43_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2560 (Node 320, GPU 0)"];
    
    moe_43_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2561 (Node 320, GPU 1)"];
    
    moe_43_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2562 (Node 320, GPU 2)"];
    
    moe_43_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2563 (Node 320, GPU 3)"];
    
    moe_43_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2564 (Node 320, GPU 4)"];
    
    moe_43_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2565 (Node 320, GPU 5)"];
    
    moe_43_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2566 (Node 320, GPU 6)"];
    
    moe_43_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2567 (Node 320, GPU 7)"];
    
    moe_43_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2568 (Node 321, GPU 0)"];
    
    moe_43_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2569 (Node 321, GPU 1)"];
    
    moe_43_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2570 (Node 321, GPU 2)"];
    
    moe_43_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2571 (Node 321, GPU 3)"];
    
    moe_43_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2572 (Node 321, GPU 4)"];
    
    moe_43_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2573 (Node 321, GPU 5)"];
    
    moe_43_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2574 (Node 321, GPU 6)"];
    
    moe_43_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2575 (Node 321, GPU 7)"];
    
    moe_43_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2576 (Node 322, GPU 0)"];
    
    moe_43_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2577 (Node 322, GPU 1)"];
    
    moe_43_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2578 (Node 322, GPU 2)"];
    
    moe_43_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2579 (Node 322, GPU 3)"];
    
    moe_43_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2580 (Node 322, GPU 4)"];
    
    moe_43_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2581 (Node 322, GPU 5)"];
    
    moe_43_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2582 (Node 322, GPU 6)"];
    
    moe_43_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2583 (Node 322, GPU 7)"];
    
    moe_43_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2584 (Node 323, GPU 0)"];
    
    moe_43_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2585 (Node 323, GPU 1)"];
    
    moe_43_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2586 (Node 323, GPU 2)"];
    
    moe_43_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2587 (Node 323, GPU 3)"];
    
    moe_43_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2588 (Node 323, GPU 4)"];
    
    moe_43_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2589 (Node 323, GPU 5)"];
    
    moe_43_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2590 (Node 323, GPU 6)"];
    
    moe_43_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2591 (Node 323, GPU 7)"];
    
    moe_43_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2592 (Node 324, GPU 0)"];
    
    moe_43_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2593 (Node 324, GPU 1)"];
    
    moe_43_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2594 (Node 324, GPU 2)"];
    
    moe_43_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2595 (Node 324, GPU 3)"];
    
    moe_43_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2596 (Node 324, GPU 4)"];
    
    moe_43_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2597 (Node 324, GPU 5)"];
    
    moe_43_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2598 (Node 324, GPU 6)"];
    
    moe_43_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2599 (Node 324, GPU 7)"];
    
    moe_43_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2600 (Node 325, GPU 0)"];
    
    moe_43_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2601 (Node 325, GPU 1)"];
    
    moe_43_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2602 (Node 325, GPU 2)"];
    
    moe_43_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2603 (Node 325, GPU 3)"];
    
    moe_43_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2604 (Node 325, GPU 4)"];
    
    moe_43_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2605 (Node 325, GPU 5)"];
    
    moe_43_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2606 (Node 325, GPU 6)"];
    
    moe_43_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2607 (Node 325, GPU 7)"];
    
    moe_43_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2608 (Node 326, GPU 0)"];
    
    moe_43_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2609 (Node 326, GPU 1)"];
    
    moe_43_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2610 (Node 326, GPU 2)"];
    
    moe_43_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2611 (Node 326, GPU 3)"];
    
    moe_43_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2612 (Node 326, GPU 4)"];
    
    moe_43_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2613 (Node 326, GPU 5)"];
    
    moe_43_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2614 (Node 326, GPU 6)"];
    
    moe_43_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2615 (Node 326, GPU 7)"];
    
    moe_43_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2616 (Node 327, GPU 0)"];
    
    moe_43_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2617 (Node 327, GPU 1)"];
    
    moe_43_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2618 (Node 327, GPU 2)"];
    
    moe_43_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2619 (Node 327, GPU 3)"];
    
    moe_43_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2620 (Node 327, GPU 4)"];
    
    moe_43_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2621 (Node 327, GPU 5)"];
    
    moe_43_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2622 (Node 327, GPU 6)"];
    
    moe_43_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 43 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2623 (Node 327, GPU 7)"];
    
    moe_43_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 43 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2560 (Node 320, GPU 0)"];
    
    moe_43_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 43 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2560 (Node 320, GPU 0)"];
    
    // MoE Layer 44 - MHA components
    moe_44_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 44 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2624 (Node 328, GPU 0)"];
    
    moe_44_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 44 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2624 (Node 328, GPU 0)"];
    
    moe_44_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 44 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2624 (Node 328, GPU 0)"];
    
    moe_44_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 44 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2624 (Node 328, GPU 0)"];
    
    moe_44_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 44 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2624 (Node 328, GPU 0)"];
    
    moe_44_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 44 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2624 (Node 328, GPU 0)"];
    
    moe_44_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2624 (Node 328, GPU 0)"];
    
    moe_44_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2625 (Node 328, GPU 1)"];
    
    moe_44_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2626 (Node 328, GPU 2)"];
    
    moe_44_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2627 (Node 328, GPU 3)"];
    
    moe_44_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2628 (Node 328, GPU 4)"];
    
    moe_44_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2629 (Node 328, GPU 5)"];
    
    moe_44_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2630 (Node 328, GPU 6)"];
    
    moe_44_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2631 (Node 328, GPU 7)"];
    
    moe_44_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2632 (Node 329, GPU 0)"];
    
    moe_44_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2633 (Node 329, GPU 1)"];
    
    moe_44_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2634 (Node 329, GPU 2)"];
    
    moe_44_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2635 (Node 329, GPU 3)"];
    
    moe_44_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2636 (Node 329, GPU 4)"];
    
    moe_44_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2637 (Node 329, GPU 5)"];
    
    moe_44_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2638 (Node 329, GPU 6)"];
    
    moe_44_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2639 (Node 329, GPU 7)"];
    
    moe_44_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2640 (Node 330, GPU 0)"];
    
    moe_44_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2641 (Node 330, GPU 1)"];
    
    moe_44_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2642 (Node 330, GPU 2)"];
    
    moe_44_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2643 (Node 330, GPU 3)"];
    
    moe_44_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2644 (Node 330, GPU 4)"];
    
    moe_44_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2645 (Node 330, GPU 5)"];
    
    moe_44_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2646 (Node 330, GPU 6)"];
    
    moe_44_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2647 (Node 330, GPU 7)"];
    
    moe_44_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2648 (Node 331, GPU 0)"];
    
    moe_44_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2649 (Node 331, GPU 1)"];
    
    moe_44_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2650 (Node 331, GPU 2)"];
    
    moe_44_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2651 (Node 331, GPU 3)"];
    
    moe_44_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2652 (Node 331, GPU 4)"];
    
    moe_44_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2653 (Node 331, GPU 5)"];
    
    moe_44_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2654 (Node 331, GPU 6)"];
    
    moe_44_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2655 (Node 331, GPU 7)"];
    
    moe_44_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2656 (Node 332, GPU 0)"];
    
    moe_44_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2657 (Node 332, GPU 1)"];
    
    moe_44_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2658 (Node 332, GPU 2)"];
    
    moe_44_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2659 (Node 332, GPU 3)"];
    
    moe_44_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2660 (Node 332, GPU 4)"];
    
    moe_44_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2661 (Node 332, GPU 5)"];
    
    moe_44_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2662 (Node 332, GPU 6)"];
    
    moe_44_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2663 (Node 332, GPU 7)"];
    
    moe_44_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2664 (Node 333, GPU 0)"];
    
    moe_44_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2665 (Node 333, GPU 1)"];
    
    moe_44_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2666 (Node 333, GPU 2)"];
    
    moe_44_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2667 (Node 333, GPU 3)"];
    
    moe_44_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2668 (Node 333, GPU 4)"];
    
    moe_44_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2669 (Node 333, GPU 5)"];
    
    moe_44_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2670 (Node 333, GPU 6)"];
    
    moe_44_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2671 (Node 333, GPU 7)"];
    
    moe_44_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2672 (Node 334, GPU 0)"];
    
    moe_44_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2673 (Node 334, GPU 1)"];
    
    moe_44_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2674 (Node 334, GPU 2)"];
    
    moe_44_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2675 (Node 334, GPU 3)"];
    
    moe_44_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2676 (Node 334, GPU 4)"];
    
    moe_44_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2677 (Node 334, GPU 5)"];
    
    moe_44_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2678 (Node 334, GPU 6)"];
    
    moe_44_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2679 (Node 334, GPU 7)"];
    
    moe_44_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2680 (Node 335, GPU 0)"];
    
    moe_44_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2681 (Node 335, GPU 1)"];
    
    moe_44_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2682 (Node 335, GPU 2)"];
    
    moe_44_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2683 (Node 335, GPU 3)"];
    
    moe_44_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2684 (Node 335, GPU 4)"];
    
    moe_44_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2685 (Node 335, GPU 5)"];
    
    moe_44_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2686 (Node 335, GPU 6)"];
    
    moe_44_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 44 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2687 (Node 335, GPU 7)"];
    
    moe_44_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 44 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2624 (Node 328, GPU 0)"];
    
    moe_44_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 44 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2624 (Node 328, GPU 0)"];
    
    // MoE Layer 45 - MHA components
    moe_45_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 45 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2688 (Node 336, GPU 0)"];
    
    moe_45_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 45 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2688 (Node 336, GPU 0)"];
    
    moe_45_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 45 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2688 (Node 336, GPU 0)"];
    
    moe_45_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 45 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2688 (Node 336, GPU 0)"];
    
    moe_45_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 45 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2688 (Node 336, GPU 0)"];
    
    moe_45_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 45 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2688 (Node 336, GPU 0)"];
    
    moe_45_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2688 (Node 336, GPU 0)"];
    
    moe_45_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2689 (Node 336, GPU 1)"];
    
    moe_45_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2690 (Node 336, GPU 2)"];
    
    moe_45_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2691 (Node 336, GPU 3)"];
    
    moe_45_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2692 (Node 336, GPU 4)"];
    
    moe_45_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2693 (Node 336, GPU 5)"];
    
    moe_45_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2694 (Node 336, GPU 6)"];
    
    moe_45_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2695 (Node 336, GPU 7)"];
    
    moe_45_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2696 (Node 337, GPU 0)"];
    
    moe_45_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2697 (Node 337, GPU 1)"];
    
    moe_45_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2698 (Node 337, GPU 2)"];
    
    moe_45_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2699 (Node 337, GPU 3)"];
    
    moe_45_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2700 (Node 337, GPU 4)"];
    
    moe_45_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2701 (Node 337, GPU 5)"];
    
    moe_45_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2702 (Node 337, GPU 6)"];
    
    moe_45_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2703 (Node 337, GPU 7)"];
    
    moe_45_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2704 (Node 338, GPU 0)"];
    
    moe_45_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2705 (Node 338, GPU 1)"];
    
    moe_45_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2706 (Node 338, GPU 2)"];
    
    moe_45_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2707 (Node 338, GPU 3)"];
    
    moe_45_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2708 (Node 338, GPU 4)"];
    
    moe_45_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2709 (Node 338, GPU 5)"];
    
    moe_45_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2710 (Node 338, GPU 6)"];
    
    moe_45_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2711 (Node 338, GPU 7)"];
    
    moe_45_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2712 (Node 339, GPU 0)"];
    
    moe_45_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2713 (Node 339, GPU 1)"];
    
    moe_45_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2714 (Node 339, GPU 2)"];
    
    moe_45_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2715 (Node 339, GPU 3)"];
    
    moe_45_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2716 (Node 339, GPU 4)"];
    
    moe_45_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2717 (Node 339, GPU 5)"];
    
    moe_45_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2718 (Node 339, GPU 6)"];
    
    moe_45_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2719 (Node 339, GPU 7)"];
    
    moe_45_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2720 (Node 340, GPU 0)"];
    
    moe_45_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2721 (Node 340, GPU 1)"];
    
    moe_45_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2722 (Node 340, GPU 2)"];
    
    moe_45_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2723 (Node 340, GPU 3)"];
    
    moe_45_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2724 (Node 340, GPU 4)"];
    
    moe_45_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2725 (Node 340, GPU 5)"];
    
    moe_45_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2726 (Node 340, GPU 6)"];
    
    moe_45_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2727 (Node 340, GPU 7)"];
    
    moe_45_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2728 (Node 341, GPU 0)"];
    
    moe_45_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2729 (Node 341, GPU 1)"];
    
    moe_45_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2730 (Node 341, GPU 2)"];
    
    moe_45_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2731 (Node 341, GPU 3)"];
    
    moe_45_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2732 (Node 341, GPU 4)"];
    
    moe_45_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2733 (Node 341, GPU 5)"];
    
    moe_45_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2734 (Node 341, GPU 6)"];
    
    moe_45_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2735 (Node 341, GPU 7)"];
    
    moe_45_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2736 (Node 342, GPU 0)"];
    
    moe_45_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2737 (Node 342, GPU 1)"];
    
    moe_45_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2738 (Node 342, GPU 2)"];
    
    moe_45_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2739 (Node 342, GPU 3)"];
    
    moe_45_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2740 (Node 342, GPU 4)"];
    
    moe_45_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2741 (Node 342, GPU 5)"];
    
    moe_45_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2742 (Node 342, GPU 6)"];
    
    moe_45_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2743 (Node 342, GPU 7)"];
    
    moe_45_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2744 (Node 343, GPU 0)"];
    
    moe_45_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2745 (Node 343, GPU 1)"];
    
    moe_45_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2746 (Node 343, GPU 2)"];
    
    moe_45_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2747 (Node 343, GPU 3)"];
    
    moe_45_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2748 (Node 343, GPU 4)"];
    
    moe_45_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2749 (Node 343, GPU 5)"];
    
    moe_45_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2750 (Node 343, GPU 6)"];
    
    moe_45_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 45 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2751 (Node 343, GPU 7)"];
    
    moe_45_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 45 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2688 (Node 336, GPU 0)"];
    
    moe_45_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 45 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2688 (Node 336, GPU 0)"];
    
    // MoE Layer 46 - MHA components
    moe_46_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 46 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2752 (Node 344, GPU 0)"];
    
    moe_46_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 46 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2752 (Node 344, GPU 0)"];
    
    moe_46_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 46 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2752 (Node 344, GPU 0)"];
    
    moe_46_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 46 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2752 (Node 344, GPU 0)"];
    
    moe_46_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 46 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2752 (Node 344, GPU 0)"];
    
    moe_46_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 46 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2752 (Node 344, GPU 0)"];
    
    moe_46_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2752 (Node 344, GPU 0)"];
    
    moe_46_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2753 (Node 344, GPU 1)"];
    
    moe_46_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2754 (Node 344, GPU 2)"];
    
    moe_46_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2755 (Node 344, GPU 3)"];
    
    moe_46_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2756 (Node 344, GPU 4)"];
    
    moe_46_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2757 (Node 344, GPU 5)"];
    
    moe_46_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2758 (Node 344, GPU 6)"];
    
    moe_46_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2759 (Node 344, GPU 7)"];
    
    moe_46_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2760 (Node 345, GPU 0)"];
    
    moe_46_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2761 (Node 345, GPU 1)"];
    
    moe_46_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2762 (Node 345, GPU 2)"];
    
    moe_46_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2763 (Node 345, GPU 3)"];
    
    moe_46_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2764 (Node 345, GPU 4)"];
    
    moe_46_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2765 (Node 345, GPU 5)"];
    
    moe_46_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2766 (Node 345, GPU 6)"];
    
    moe_46_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2767 (Node 345, GPU 7)"];
    
    moe_46_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2768 (Node 346, GPU 0)"];
    
    moe_46_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2769 (Node 346, GPU 1)"];
    
    moe_46_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2770 (Node 346, GPU 2)"];
    
    moe_46_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2771 (Node 346, GPU 3)"];
    
    moe_46_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2772 (Node 346, GPU 4)"];
    
    moe_46_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2773 (Node 346, GPU 5)"];
    
    moe_46_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2774 (Node 346, GPU 6)"];
    
    moe_46_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2775 (Node 346, GPU 7)"];
    
    moe_46_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2776 (Node 347, GPU 0)"];
    
    moe_46_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2777 (Node 347, GPU 1)"];
    
    moe_46_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2778 (Node 347, GPU 2)"];
    
    moe_46_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2779 (Node 347, GPU 3)"];
    
    moe_46_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2780 (Node 347, GPU 4)"];
    
    moe_46_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2781 (Node 347, GPU 5)"];
    
    moe_46_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2782 (Node 347, GPU 6)"];
    
    moe_46_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2783 (Node 347, GPU 7)"];
    
    moe_46_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2784 (Node 348, GPU 0)"];
    
    moe_46_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2785 (Node 348, GPU 1)"];
    
    moe_46_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2786 (Node 348, GPU 2)"];
    
    moe_46_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2787 (Node 348, GPU 3)"];
    
    moe_46_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2788 (Node 348, GPU 4)"];
    
    moe_46_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2789 (Node 348, GPU 5)"];
    
    moe_46_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2790 (Node 348, GPU 6)"];
    
    moe_46_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2791 (Node 348, GPU 7)"];
    
    moe_46_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2792 (Node 349, GPU 0)"];
    
    moe_46_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2793 (Node 349, GPU 1)"];
    
    moe_46_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2794 (Node 349, GPU 2)"];
    
    moe_46_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2795 (Node 349, GPU 3)"];
    
    moe_46_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2796 (Node 349, GPU 4)"];
    
    moe_46_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2797 (Node 349, GPU 5)"];
    
    moe_46_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2798 (Node 349, GPU 6)"];
    
    moe_46_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2799 (Node 349, GPU 7)"];
    
    moe_46_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2800 (Node 350, GPU 0)"];
    
    moe_46_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2801 (Node 350, GPU 1)"];
    
    moe_46_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2802 (Node 350, GPU 2)"];
    
    moe_46_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2803 (Node 350, GPU 3)"];
    
    moe_46_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2804 (Node 350, GPU 4)"];
    
    moe_46_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2805 (Node 350, GPU 5)"];
    
    moe_46_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2806 (Node 350, GPU 6)"];
    
    moe_46_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2807 (Node 350, GPU 7)"];
    
    moe_46_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2808 (Node 351, GPU 0)"];
    
    moe_46_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2809 (Node 351, GPU 1)"];
    
    moe_46_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2810 (Node 351, GPU 2)"];
    
    moe_46_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2811 (Node 351, GPU 3)"];
    
    moe_46_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2812 (Node 351, GPU 4)"];
    
    moe_46_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2813 (Node 351, GPU 5)"];
    
    moe_46_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2814 (Node 351, GPU 6)"];
    
    moe_46_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 46 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2815 (Node 351, GPU 7)"];
    
    moe_46_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 46 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2752 (Node 344, GPU 0)"];
    
    moe_46_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 46 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2752 (Node 344, GPU 0)"];
    
    // MoE Layer 47 - MHA components
    moe_47_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 47 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2816 (Node 352, GPU 0)"];
    
    moe_47_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 47 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2816 (Node 352, GPU 0)"];
    
    moe_47_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 47 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2816 (Node 352, GPU 0)"];
    
    moe_47_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 47 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2816 (Node 352, GPU 0)"];
    
    moe_47_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 47 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2816 (Node 352, GPU 0)"];
    
    moe_47_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 47 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2816 (Node 352, GPU 0)"];
    
    moe_47_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2816 (Node 352, GPU 0)"];
    
    moe_47_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2817 (Node 352, GPU 1)"];
    
    moe_47_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2818 (Node 352, GPU 2)"];
    
    moe_47_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2819 (Node 352, GPU 3)"];
    
    moe_47_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2820 (Node 352, GPU 4)"];
    
    moe_47_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2821 (Node 352, GPU 5)"];
    
    moe_47_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2822 (Node 352, GPU 6)"];
    
    moe_47_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2823 (Node 352, GPU 7)"];
    
    moe_47_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2824 (Node 353, GPU 0)"];
    
    moe_47_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2825 (Node 353, GPU 1)"];
    
    moe_47_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2826 (Node 353, GPU 2)"];
    
    moe_47_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2827 (Node 353, GPU 3)"];
    
    moe_47_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2828 (Node 353, GPU 4)"];
    
    moe_47_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2829 (Node 353, GPU 5)"];
    
    moe_47_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2830 (Node 353, GPU 6)"];
    
    moe_47_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2831 (Node 353, GPU 7)"];
    
    moe_47_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2832 (Node 354, GPU 0)"];
    
    moe_47_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2833 (Node 354, GPU 1)"];
    
    moe_47_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2834 (Node 354, GPU 2)"];
    
    moe_47_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2835 (Node 354, GPU 3)"];
    
    moe_47_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2836 (Node 354, GPU 4)"];
    
    moe_47_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2837 (Node 354, GPU 5)"];
    
    moe_47_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2838 (Node 354, GPU 6)"];
    
    moe_47_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2839 (Node 354, GPU 7)"];
    
    moe_47_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2840 (Node 355, GPU 0)"];
    
    moe_47_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2841 (Node 355, GPU 1)"];
    
    moe_47_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2842 (Node 355, GPU 2)"];
    
    moe_47_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2843 (Node 355, GPU 3)"];
    
    moe_47_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2844 (Node 355, GPU 4)"];
    
    moe_47_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2845 (Node 355, GPU 5)"];
    
    moe_47_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2846 (Node 355, GPU 6)"];
    
    moe_47_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2847 (Node 355, GPU 7)"];
    
    moe_47_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2848 (Node 356, GPU 0)"];
    
    moe_47_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2849 (Node 356, GPU 1)"];
    
    moe_47_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2850 (Node 356, GPU 2)"];
    
    moe_47_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2851 (Node 356, GPU 3)"];
    
    moe_47_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2852 (Node 356, GPU 4)"];
    
    moe_47_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2853 (Node 356, GPU 5)"];
    
    moe_47_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2854 (Node 356, GPU 6)"];
    
    moe_47_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2855 (Node 356, GPU 7)"];
    
    moe_47_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2856 (Node 357, GPU 0)"];
    
    moe_47_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2857 (Node 357, GPU 1)"];
    
    moe_47_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2858 (Node 357, GPU 2)"];
    
    moe_47_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2859 (Node 357, GPU 3)"];
    
    moe_47_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2860 (Node 357, GPU 4)"];
    
    moe_47_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2861 (Node 357, GPU 5)"];
    
    moe_47_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2862 (Node 357, GPU 6)"];
    
    moe_47_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2863 (Node 357, GPU 7)"];
    
    moe_47_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2864 (Node 358, GPU 0)"];
    
    moe_47_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2865 (Node 358, GPU 1)"];
    
    moe_47_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2866 (Node 358, GPU 2)"];
    
    moe_47_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2867 (Node 358, GPU 3)"];
    
    moe_47_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2868 (Node 358, GPU 4)"];
    
    moe_47_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2869 (Node 358, GPU 5)"];
    
    moe_47_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2870 (Node 358, GPU 6)"];
    
    moe_47_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2871 (Node 358, GPU 7)"];
    
    moe_47_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2872 (Node 359, GPU 0)"];
    
    moe_47_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2873 (Node 359, GPU 1)"];
    
    moe_47_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2874 (Node 359, GPU 2)"];
    
    moe_47_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2875 (Node 359, GPU 3)"];
    
    moe_47_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2876 (Node 359, GPU 4)"];
    
    moe_47_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2877 (Node 359, GPU 5)"];
    
    moe_47_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2878 (Node 359, GPU 6)"];
    
    moe_47_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 47 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2879 (Node 359, GPU 7)"];
    
    moe_47_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 47 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2816 (Node 352, GPU 0)"];
    
    moe_47_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 47 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2816 (Node 352, GPU 0)"];
    
    // MoE Layer 48 - MHA components
    moe_48_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 48 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2880 (Node 360, GPU 0)"];
    
    moe_48_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 48 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2880 (Node 360, GPU 0)"];
    
    moe_48_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 48 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2880 (Node 360, GPU 0)"];
    
    moe_48_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 48 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2880 (Node 360, GPU 0)"];
    
    moe_48_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 48 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2880 (Node 360, GPU 0)"];
    
    moe_48_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 48 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2880 (Node 360, GPU 0)"];
    
    moe_48_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2880 (Node 360, GPU 0)"];
    
    moe_48_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2881 (Node 360, GPU 1)"];
    
    moe_48_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2882 (Node 360, GPU 2)"];
    
    moe_48_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2883 (Node 360, GPU 3)"];
    
    moe_48_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2884 (Node 360, GPU 4)"];
    
    moe_48_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2885 (Node 360, GPU 5)"];
    
    moe_48_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2886 (Node 360, GPU 6)"];
    
    moe_48_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2887 (Node 360, GPU 7)"];
    
    moe_48_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2888 (Node 361, GPU 0)"];
    
    moe_48_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2889 (Node 361, GPU 1)"];
    
    moe_48_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2890 (Node 361, GPU 2)"];
    
    moe_48_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2891 (Node 361, GPU 3)"];
    
    moe_48_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2892 (Node 361, GPU 4)"];
    
    moe_48_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2893 (Node 361, GPU 5)"];
    
    moe_48_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2894 (Node 361, GPU 6)"];
    
    moe_48_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2895 (Node 361, GPU 7)"];
    
    moe_48_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2896 (Node 362, GPU 0)"];
    
    moe_48_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2897 (Node 362, GPU 1)"];
    
    moe_48_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2898 (Node 362, GPU 2)"];
    
    moe_48_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2899 (Node 362, GPU 3)"];
    
    moe_48_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2900 (Node 362, GPU 4)"];
    
    moe_48_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2901 (Node 362, GPU 5)"];
    
    moe_48_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2902 (Node 362, GPU 6)"];
    
    moe_48_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2903 (Node 362, GPU 7)"];
    
    moe_48_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2904 (Node 363, GPU 0)"];
    
    moe_48_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2905 (Node 363, GPU 1)"];
    
    moe_48_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2906 (Node 363, GPU 2)"];
    
    moe_48_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2907 (Node 363, GPU 3)"];
    
    moe_48_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2908 (Node 363, GPU 4)"];
    
    moe_48_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2909 (Node 363, GPU 5)"];
    
    moe_48_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2910 (Node 363, GPU 6)"];
    
    moe_48_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2911 (Node 363, GPU 7)"];
    
    moe_48_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2912 (Node 364, GPU 0)"];
    
    moe_48_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2913 (Node 364, GPU 1)"];
    
    moe_48_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2914 (Node 364, GPU 2)"];
    
    moe_48_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2915 (Node 364, GPU 3)"];
    
    moe_48_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2916 (Node 364, GPU 4)"];
    
    moe_48_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2917 (Node 364, GPU 5)"];
    
    moe_48_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2918 (Node 364, GPU 6)"];
    
    moe_48_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2919 (Node 364, GPU 7)"];
    
    moe_48_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2920 (Node 365, GPU 0)"];
    
    moe_48_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2921 (Node 365, GPU 1)"];
    
    moe_48_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2922 (Node 365, GPU 2)"];
    
    moe_48_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2923 (Node 365, GPU 3)"];
    
    moe_48_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2924 (Node 365, GPU 4)"];
    
    moe_48_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2925 (Node 365, GPU 5)"];
    
    moe_48_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2926 (Node 365, GPU 6)"];
    
    moe_48_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2927 (Node 365, GPU 7)"];
    
    moe_48_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2928 (Node 366, GPU 0)"];
    
    moe_48_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2929 (Node 366, GPU 1)"];
    
    moe_48_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2930 (Node 366, GPU 2)"];
    
    moe_48_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2931 (Node 366, GPU 3)"];
    
    moe_48_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2932 (Node 366, GPU 4)"];
    
    moe_48_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2933 (Node 366, GPU 5)"];
    
    moe_48_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2934 (Node 366, GPU 6)"];
    
    moe_48_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2935 (Node 366, GPU 7)"];
    
    moe_48_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2936 (Node 367, GPU 0)"];
    
    moe_48_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2937 (Node 367, GPU 1)"];
    
    moe_48_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2938 (Node 367, GPU 2)"];
    
    moe_48_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2939 (Node 367, GPU 3)"];
    
    moe_48_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2940 (Node 367, GPU 4)"];
    
    moe_48_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2941 (Node 367, GPU 5)"];
    
    moe_48_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2942 (Node 367, GPU 6)"];
    
    moe_48_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 48 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2943 (Node 367, GPU 7)"];
    
    moe_48_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 48 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2880 (Node 360, GPU 0)"];
    
    moe_48_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 48 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2880 (Node 360, GPU 0)"];
    
    // MoE Layer 49 - MHA components
    moe_49_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 49 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2944 (Node 368, GPU 0)"];
    
    moe_49_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 49 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2944 (Node 368, GPU 0)"];
    
    moe_49_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 49 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2944 (Node 368, GPU 0)"];
    
    moe_49_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 49 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 2944 (Node 368, GPU 0)"];
    
    moe_49_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 49 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2944 (Node 368, GPU 0)"];
    
    moe_49_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 49 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 2944 (Node 368, GPU 0)"];
    
    moe_49_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2944 (Node 368, GPU 0)"];
    
    moe_49_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2945 (Node 368, GPU 1)"];
    
    moe_49_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2946 (Node 368, GPU 2)"];
    
    moe_49_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2947 (Node 368, GPU 3)"];
    
    moe_49_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2948 (Node 368, GPU 4)"];
    
    moe_49_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2949 (Node 368, GPU 5)"];
    
    moe_49_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2950 (Node 368, GPU 6)"];
    
    moe_49_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2951 (Node 368, GPU 7)"];
    
    moe_49_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2952 (Node 369, GPU 0)"];
    
    moe_49_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2953 (Node 369, GPU 1)"];
    
    moe_49_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2954 (Node 369, GPU 2)"];
    
    moe_49_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2955 (Node 369, GPU 3)"];
    
    moe_49_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2956 (Node 369, GPU 4)"];
    
    moe_49_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2957 (Node 369, GPU 5)"];
    
    moe_49_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2958 (Node 369, GPU 6)"];
    
    moe_49_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2959 (Node 369, GPU 7)"];
    
    moe_49_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2960 (Node 370, GPU 0)"];
    
    moe_49_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2961 (Node 370, GPU 1)"];
    
    moe_49_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2962 (Node 370, GPU 2)"];
    
    moe_49_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2963 (Node 370, GPU 3)"];
    
    moe_49_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2964 (Node 370, GPU 4)"];
    
    moe_49_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2965 (Node 370, GPU 5)"];
    
    moe_49_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2966 (Node 370, GPU 6)"];
    
    moe_49_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2967 (Node 370, GPU 7)"];
    
    moe_49_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2968 (Node 371, GPU 0)"];
    
    moe_49_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2969 (Node 371, GPU 1)"];
    
    moe_49_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2970 (Node 371, GPU 2)"];
    
    moe_49_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2971 (Node 371, GPU 3)"];
    
    moe_49_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2972 (Node 371, GPU 4)"];
    
    moe_49_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2973 (Node 371, GPU 5)"];
    
    moe_49_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2974 (Node 371, GPU 6)"];
    
    moe_49_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2975 (Node 371, GPU 7)"];
    
    moe_49_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2976 (Node 372, GPU 0)"];
    
    moe_49_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2977 (Node 372, GPU 1)"];
    
    moe_49_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2978 (Node 372, GPU 2)"];
    
    moe_49_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2979 (Node 372, GPU 3)"];
    
    moe_49_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2980 (Node 372, GPU 4)"];
    
    moe_49_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2981 (Node 372, GPU 5)"];
    
    moe_49_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2982 (Node 372, GPU 6)"];
    
    moe_49_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2983 (Node 372, GPU 7)"];
    
    moe_49_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2984 (Node 373, GPU 0)"];
    
    moe_49_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2985 (Node 373, GPU 1)"];
    
    moe_49_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2986 (Node 373, GPU 2)"];
    
    moe_49_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2987 (Node 373, GPU 3)"];
    
    moe_49_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2988 (Node 373, GPU 4)"];
    
    moe_49_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2989 (Node 373, GPU 5)"];
    
    moe_49_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2990 (Node 373, GPU 6)"];
    
    moe_49_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2991 (Node 373, GPU 7)"];
    
    moe_49_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2992 (Node 374, GPU 0)"];
    
    moe_49_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2993 (Node 374, GPU 1)"];
    
    moe_49_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2994 (Node 374, GPU 2)"];
    
    moe_49_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2995 (Node 374, GPU 3)"];
    
    moe_49_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2996 (Node 374, GPU 4)"];
    
    moe_49_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2997 (Node 374, GPU 5)"];
    
    moe_49_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2998 (Node 374, GPU 6)"];
    
    moe_49_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2999 (Node 374, GPU 7)"];
    
    moe_49_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3000 (Node 375, GPU 0)"];
    
    moe_49_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3001 (Node 375, GPU 1)"];
    
    moe_49_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3002 (Node 375, GPU 2)"];
    
    moe_49_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3003 (Node 375, GPU 3)"];
    
    moe_49_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3004 (Node 375, GPU 4)"];
    
    moe_49_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3005 (Node 375, GPU 5)"];
    
    moe_49_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3006 (Node 375, GPU 6)"];
    
    moe_49_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 49 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3007 (Node 375, GPU 7)"];
    
    moe_49_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 49 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2944 (Node 368, GPU 0)"];
    
    moe_49_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 49 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 2944 (Node 368, GPU 0)"];
    
    // MoE Layer 50 - MHA components
    moe_50_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 50 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3008 (Node 376, GPU 0)"];
    
    moe_50_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 50 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3008 (Node 376, GPU 0)"];
    
    moe_50_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 50 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3008 (Node 376, GPU 0)"];
    
    moe_50_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 50 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3008 (Node 376, GPU 0)"];
    
    moe_50_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 50 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3008 (Node 376, GPU 0)"];
    
    moe_50_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 50 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3008 (Node 376, GPU 0)"];
    
    moe_50_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3008 (Node 376, GPU 0)"];
    
    moe_50_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3009 (Node 376, GPU 1)"];
    
    moe_50_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3010 (Node 376, GPU 2)"];
    
    moe_50_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3011 (Node 376, GPU 3)"];
    
    moe_50_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3012 (Node 376, GPU 4)"];
    
    moe_50_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3013 (Node 376, GPU 5)"];
    
    moe_50_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3014 (Node 376, GPU 6)"];
    
    moe_50_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3015 (Node 376, GPU 7)"];
    
    moe_50_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3016 (Node 377, GPU 0)"];
    
    moe_50_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3017 (Node 377, GPU 1)"];
    
    moe_50_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3018 (Node 377, GPU 2)"];
    
    moe_50_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3019 (Node 377, GPU 3)"];
    
    moe_50_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3020 (Node 377, GPU 4)"];
    
    moe_50_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3021 (Node 377, GPU 5)"];
    
    moe_50_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3022 (Node 377, GPU 6)"];
    
    moe_50_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3023 (Node 377, GPU 7)"];
    
    moe_50_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3024 (Node 378, GPU 0)"];
    
    moe_50_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3025 (Node 378, GPU 1)"];
    
    moe_50_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3026 (Node 378, GPU 2)"];
    
    moe_50_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3027 (Node 378, GPU 3)"];
    
    moe_50_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3028 (Node 378, GPU 4)"];
    
    moe_50_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3029 (Node 378, GPU 5)"];
    
    moe_50_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3030 (Node 378, GPU 6)"];
    
    moe_50_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3031 (Node 378, GPU 7)"];
    
    moe_50_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3032 (Node 379, GPU 0)"];
    
    moe_50_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3033 (Node 379, GPU 1)"];
    
    moe_50_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3034 (Node 379, GPU 2)"];
    
    moe_50_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3035 (Node 379, GPU 3)"];
    
    moe_50_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3036 (Node 379, GPU 4)"];
    
    moe_50_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3037 (Node 379, GPU 5)"];
    
    moe_50_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3038 (Node 379, GPU 6)"];
    
    moe_50_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3039 (Node 379, GPU 7)"];
    
    moe_50_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3040 (Node 380, GPU 0)"];
    
    moe_50_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3041 (Node 380, GPU 1)"];
    
    moe_50_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3042 (Node 380, GPU 2)"];
    
    moe_50_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3043 (Node 380, GPU 3)"];
    
    moe_50_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3044 (Node 380, GPU 4)"];
    
    moe_50_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3045 (Node 380, GPU 5)"];
    
    moe_50_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3046 (Node 380, GPU 6)"];
    
    moe_50_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3047 (Node 380, GPU 7)"];
    
    moe_50_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3048 (Node 381, GPU 0)"];
    
    moe_50_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3049 (Node 381, GPU 1)"];
    
    moe_50_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3050 (Node 381, GPU 2)"];
    
    moe_50_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3051 (Node 381, GPU 3)"];
    
    moe_50_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3052 (Node 381, GPU 4)"];
    
    moe_50_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3053 (Node 381, GPU 5)"];
    
    moe_50_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3054 (Node 381, GPU 6)"];
    
    moe_50_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3055 (Node 381, GPU 7)"];
    
    moe_50_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3056 (Node 382, GPU 0)"];
    
    moe_50_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3057 (Node 382, GPU 1)"];
    
    moe_50_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3058 (Node 382, GPU 2)"];
    
    moe_50_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3059 (Node 382, GPU 3)"];
    
    moe_50_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3060 (Node 382, GPU 4)"];
    
    moe_50_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3061 (Node 382, GPU 5)"];
    
    moe_50_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3062 (Node 382, GPU 6)"];
    
    moe_50_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3063 (Node 382, GPU 7)"];
    
    moe_50_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3064 (Node 383, GPU 0)"];
    
    moe_50_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3065 (Node 383, GPU 1)"];
    
    moe_50_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3066 (Node 383, GPU 2)"];
    
    moe_50_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3067 (Node 383, GPU 3)"];
    
    moe_50_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3068 (Node 383, GPU 4)"];
    
    moe_50_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3069 (Node 383, GPU 5)"];
    
    moe_50_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3070 (Node 383, GPU 6)"];
    
    moe_50_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 50 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3071 (Node 383, GPU 7)"];
    
    moe_50_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 50 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3008 (Node 376, GPU 0)"];
    
    moe_50_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 50 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3008 (Node 376, GPU 0)"];
    
    // MoE Layer 51 - MHA components
    moe_51_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 51 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3072 (Node 384, GPU 0)"];
    
    moe_51_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 51 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3072 (Node 384, GPU 0)"];
    
    moe_51_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 51 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3072 (Node 384, GPU 0)"];
    
    moe_51_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 51 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3072 (Node 384, GPU 0)"];
    
    moe_51_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 51 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3072 (Node 384, GPU 0)"];
    
    moe_51_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 51 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3072 (Node 384, GPU 0)"];
    
    moe_51_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3072 (Node 384, GPU 0)"];
    
    moe_51_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3073 (Node 384, GPU 1)"];
    
    moe_51_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3074 (Node 384, GPU 2)"];
    
    moe_51_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3075 (Node 384, GPU 3)"];
    
    moe_51_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3076 (Node 384, GPU 4)"];
    
    moe_51_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3077 (Node 384, GPU 5)"];
    
    moe_51_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3078 (Node 384, GPU 6)"];
    
    moe_51_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3079 (Node 384, GPU 7)"];
    
    moe_51_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3080 (Node 385, GPU 0)"];
    
    moe_51_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3081 (Node 385, GPU 1)"];
    
    moe_51_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3082 (Node 385, GPU 2)"];
    
    moe_51_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3083 (Node 385, GPU 3)"];
    
    moe_51_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3084 (Node 385, GPU 4)"];
    
    moe_51_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3085 (Node 385, GPU 5)"];
    
    moe_51_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3086 (Node 385, GPU 6)"];
    
    moe_51_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3087 (Node 385, GPU 7)"];
    
    moe_51_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3088 (Node 386, GPU 0)"];
    
    moe_51_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3089 (Node 386, GPU 1)"];
    
    moe_51_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3090 (Node 386, GPU 2)"];
    
    moe_51_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3091 (Node 386, GPU 3)"];
    
    moe_51_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3092 (Node 386, GPU 4)"];
    
    moe_51_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3093 (Node 386, GPU 5)"];
    
    moe_51_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3094 (Node 386, GPU 6)"];
    
    moe_51_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3095 (Node 386, GPU 7)"];
    
    moe_51_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3096 (Node 387, GPU 0)"];
    
    moe_51_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3097 (Node 387, GPU 1)"];
    
    moe_51_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3098 (Node 387, GPU 2)"];
    
    moe_51_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3099 (Node 387, GPU 3)"];
    
    moe_51_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3100 (Node 387, GPU 4)"];
    
    moe_51_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3101 (Node 387, GPU 5)"];
    
    moe_51_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3102 (Node 387, GPU 6)"];
    
    moe_51_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3103 (Node 387, GPU 7)"];
    
    moe_51_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3104 (Node 388, GPU 0)"];
    
    moe_51_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3105 (Node 388, GPU 1)"];
    
    moe_51_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3106 (Node 388, GPU 2)"];
    
    moe_51_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3107 (Node 388, GPU 3)"];
    
    moe_51_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3108 (Node 388, GPU 4)"];
    
    moe_51_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3109 (Node 388, GPU 5)"];
    
    moe_51_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3110 (Node 388, GPU 6)"];
    
    moe_51_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3111 (Node 388, GPU 7)"];
    
    moe_51_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3112 (Node 389, GPU 0)"];
    
    moe_51_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3113 (Node 389, GPU 1)"];
    
    moe_51_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3114 (Node 389, GPU 2)"];
    
    moe_51_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3115 (Node 389, GPU 3)"];
    
    moe_51_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3116 (Node 389, GPU 4)"];
    
    moe_51_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3117 (Node 389, GPU 5)"];
    
    moe_51_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3118 (Node 389, GPU 6)"];
    
    moe_51_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3119 (Node 389, GPU 7)"];
    
    moe_51_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3120 (Node 390, GPU 0)"];
    
    moe_51_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3121 (Node 390, GPU 1)"];
    
    moe_51_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3122 (Node 390, GPU 2)"];
    
    moe_51_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3123 (Node 390, GPU 3)"];
    
    moe_51_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3124 (Node 390, GPU 4)"];
    
    moe_51_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3125 (Node 390, GPU 5)"];
    
    moe_51_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3126 (Node 390, GPU 6)"];
    
    moe_51_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3127 (Node 390, GPU 7)"];
    
    moe_51_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3128 (Node 391, GPU 0)"];
    
    moe_51_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3129 (Node 391, GPU 1)"];
    
    moe_51_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3130 (Node 391, GPU 2)"];
    
    moe_51_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3131 (Node 391, GPU 3)"];
    
    moe_51_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3132 (Node 391, GPU 4)"];
    
    moe_51_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3133 (Node 391, GPU 5)"];
    
    moe_51_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3134 (Node 391, GPU 6)"];
    
    moe_51_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 51 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3135 (Node 391, GPU 7)"];
    
    moe_51_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 51 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3072 (Node 384, GPU 0)"];
    
    moe_51_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 51 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3072 (Node 384, GPU 0)"];
    
    // MoE Layer 52 - MHA components
    moe_52_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 52 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3136 (Node 392, GPU 0)"];
    
    moe_52_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 52 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3136 (Node 392, GPU 0)"];
    
    moe_52_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 52 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3136 (Node 392, GPU 0)"];
    
    moe_52_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 52 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3136 (Node 392, GPU 0)"];
    
    moe_52_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 52 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3136 (Node 392, GPU 0)"];
    
    moe_52_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 52 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3136 (Node 392, GPU 0)"];
    
    moe_52_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3136 (Node 392, GPU 0)"];
    
    moe_52_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3137 (Node 392, GPU 1)"];
    
    moe_52_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3138 (Node 392, GPU 2)"];
    
    moe_52_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3139 (Node 392, GPU 3)"];
    
    moe_52_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3140 (Node 392, GPU 4)"];
    
    moe_52_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3141 (Node 392, GPU 5)"];
    
    moe_52_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3142 (Node 392, GPU 6)"];
    
    moe_52_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3143 (Node 392, GPU 7)"];
    
    moe_52_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3144 (Node 393, GPU 0)"];
    
    moe_52_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3145 (Node 393, GPU 1)"];
    
    moe_52_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3146 (Node 393, GPU 2)"];
    
    moe_52_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3147 (Node 393, GPU 3)"];
    
    moe_52_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3148 (Node 393, GPU 4)"];
    
    moe_52_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3149 (Node 393, GPU 5)"];
    
    moe_52_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3150 (Node 393, GPU 6)"];
    
    moe_52_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3151 (Node 393, GPU 7)"];
    
    moe_52_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3152 (Node 394, GPU 0)"];
    
    moe_52_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3153 (Node 394, GPU 1)"];
    
    moe_52_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3154 (Node 394, GPU 2)"];
    
    moe_52_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3155 (Node 394, GPU 3)"];
    
    moe_52_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3156 (Node 394, GPU 4)"];
    
    moe_52_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3157 (Node 394, GPU 5)"];
    
    moe_52_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3158 (Node 394, GPU 6)"];
    
    moe_52_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3159 (Node 394, GPU 7)"];
    
    moe_52_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3160 (Node 395, GPU 0)"];
    
    moe_52_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3161 (Node 395, GPU 1)"];
    
    moe_52_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3162 (Node 395, GPU 2)"];
    
    moe_52_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3163 (Node 395, GPU 3)"];
    
    moe_52_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3164 (Node 395, GPU 4)"];
    
    moe_52_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3165 (Node 395, GPU 5)"];
    
    moe_52_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3166 (Node 395, GPU 6)"];
    
    moe_52_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3167 (Node 395, GPU 7)"];
    
    moe_52_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3168 (Node 396, GPU 0)"];
    
    moe_52_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3169 (Node 396, GPU 1)"];
    
    moe_52_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3170 (Node 396, GPU 2)"];
    
    moe_52_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3171 (Node 396, GPU 3)"];
    
    moe_52_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3172 (Node 396, GPU 4)"];
    
    moe_52_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3173 (Node 396, GPU 5)"];
    
    moe_52_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3174 (Node 396, GPU 6)"];
    
    moe_52_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3175 (Node 396, GPU 7)"];
    
    moe_52_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3176 (Node 397, GPU 0)"];
    
    moe_52_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3177 (Node 397, GPU 1)"];
    
    moe_52_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3178 (Node 397, GPU 2)"];
    
    moe_52_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3179 (Node 397, GPU 3)"];
    
    moe_52_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3180 (Node 397, GPU 4)"];
    
    moe_52_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3181 (Node 397, GPU 5)"];
    
    moe_52_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3182 (Node 397, GPU 6)"];
    
    moe_52_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3183 (Node 397, GPU 7)"];
    
    moe_52_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3184 (Node 398, GPU 0)"];
    
    moe_52_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3185 (Node 398, GPU 1)"];
    
    moe_52_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3186 (Node 398, GPU 2)"];
    
    moe_52_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3187 (Node 398, GPU 3)"];
    
    moe_52_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3188 (Node 398, GPU 4)"];
    
    moe_52_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3189 (Node 398, GPU 5)"];
    
    moe_52_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3190 (Node 398, GPU 6)"];
    
    moe_52_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3191 (Node 398, GPU 7)"];
    
    moe_52_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3192 (Node 399, GPU 0)"];
    
    moe_52_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3193 (Node 399, GPU 1)"];
    
    moe_52_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3194 (Node 399, GPU 2)"];
    
    moe_52_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3195 (Node 399, GPU 3)"];
    
    moe_52_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3196 (Node 399, GPU 4)"];
    
    moe_52_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3197 (Node 399, GPU 5)"];
    
    moe_52_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3198 (Node 399, GPU 6)"];
    
    moe_52_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 52 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3199 (Node 399, GPU 7)"];
    
    moe_52_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 52 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3136 (Node 392, GPU 0)"];
    
    moe_52_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 52 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3136 (Node 392, GPU 0)"];
    
    // MoE Layer 53 - MHA components
    moe_53_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 53 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3200 (Node 400, GPU 0)"];
    
    moe_53_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 53 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3200 (Node 400, GPU 0)"];
    
    moe_53_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 53 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3200 (Node 400, GPU 0)"];
    
    moe_53_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 53 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3200 (Node 400, GPU 0)"];
    
    moe_53_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 53 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3200 (Node 400, GPU 0)"];
    
    moe_53_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 53 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3200 (Node 400, GPU 0)"];
    
    moe_53_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3200 (Node 400, GPU 0)"];
    
    moe_53_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3201 (Node 400, GPU 1)"];
    
    moe_53_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3202 (Node 400, GPU 2)"];
    
    moe_53_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3203 (Node 400, GPU 3)"];
    
    moe_53_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3204 (Node 400, GPU 4)"];
    
    moe_53_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3205 (Node 400, GPU 5)"];
    
    moe_53_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3206 (Node 400, GPU 6)"];
    
    moe_53_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3207 (Node 400, GPU 7)"];
    
    moe_53_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3208 (Node 401, GPU 0)"];
    
    moe_53_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3209 (Node 401, GPU 1)"];
    
    moe_53_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3210 (Node 401, GPU 2)"];
    
    moe_53_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3211 (Node 401, GPU 3)"];
    
    moe_53_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3212 (Node 401, GPU 4)"];
    
    moe_53_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3213 (Node 401, GPU 5)"];
    
    moe_53_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3214 (Node 401, GPU 6)"];
    
    moe_53_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3215 (Node 401, GPU 7)"];
    
    moe_53_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3216 (Node 402, GPU 0)"];
    
    moe_53_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3217 (Node 402, GPU 1)"];
    
    moe_53_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3218 (Node 402, GPU 2)"];
    
    moe_53_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3219 (Node 402, GPU 3)"];
    
    moe_53_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3220 (Node 402, GPU 4)"];
    
    moe_53_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3221 (Node 402, GPU 5)"];
    
    moe_53_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3222 (Node 402, GPU 6)"];
    
    moe_53_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3223 (Node 402, GPU 7)"];
    
    moe_53_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3224 (Node 403, GPU 0)"];
    
    moe_53_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3225 (Node 403, GPU 1)"];
    
    moe_53_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3226 (Node 403, GPU 2)"];
    
    moe_53_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3227 (Node 403, GPU 3)"];
    
    moe_53_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3228 (Node 403, GPU 4)"];
    
    moe_53_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3229 (Node 403, GPU 5)"];
    
    moe_53_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3230 (Node 403, GPU 6)"];
    
    moe_53_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3231 (Node 403, GPU 7)"];
    
    moe_53_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3232 (Node 404, GPU 0)"];
    
    moe_53_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3233 (Node 404, GPU 1)"];
    
    moe_53_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3234 (Node 404, GPU 2)"];
    
    moe_53_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3235 (Node 404, GPU 3)"];
    
    moe_53_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3236 (Node 404, GPU 4)"];
    
    moe_53_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3237 (Node 404, GPU 5)"];
    
    moe_53_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3238 (Node 404, GPU 6)"];
    
    moe_53_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3239 (Node 404, GPU 7)"];
    
    moe_53_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3240 (Node 405, GPU 0)"];
    
    moe_53_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3241 (Node 405, GPU 1)"];
    
    moe_53_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3242 (Node 405, GPU 2)"];
    
    moe_53_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3243 (Node 405, GPU 3)"];
    
    moe_53_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3244 (Node 405, GPU 4)"];
    
    moe_53_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3245 (Node 405, GPU 5)"];
    
    moe_53_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3246 (Node 405, GPU 6)"];
    
    moe_53_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3247 (Node 405, GPU 7)"];
    
    moe_53_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3248 (Node 406, GPU 0)"];
    
    moe_53_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3249 (Node 406, GPU 1)"];
    
    moe_53_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3250 (Node 406, GPU 2)"];
    
    moe_53_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3251 (Node 406, GPU 3)"];
    
    moe_53_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3252 (Node 406, GPU 4)"];
    
    moe_53_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3253 (Node 406, GPU 5)"];
    
    moe_53_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3254 (Node 406, GPU 6)"];
    
    moe_53_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3255 (Node 406, GPU 7)"];
    
    moe_53_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3256 (Node 407, GPU 0)"];
    
    moe_53_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3257 (Node 407, GPU 1)"];
    
    moe_53_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3258 (Node 407, GPU 2)"];
    
    moe_53_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3259 (Node 407, GPU 3)"];
    
    moe_53_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3260 (Node 407, GPU 4)"];
    
    moe_53_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3261 (Node 407, GPU 5)"];
    
    moe_53_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3262 (Node 407, GPU 6)"];
    
    moe_53_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 53 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3263 (Node 407, GPU 7)"];
    
    moe_53_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 53 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3200 (Node 400, GPU 0)"];
    
    moe_53_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 53 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3200 (Node 400, GPU 0)"];
    
    // MoE Layer 54 - MHA components
    moe_54_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 54 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3264 (Node 408, GPU 0)"];
    
    moe_54_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 54 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3264 (Node 408, GPU 0)"];
    
    moe_54_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 54 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3264 (Node 408, GPU 0)"];
    
    moe_54_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 54 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3264 (Node 408, GPU 0)"];
    
    moe_54_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 54 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3264 (Node 408, GPU 0)"];
    
    moe_54_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 54 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3264 (Node 408, GPU 0)"];
    
    moe_54_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3264 (Node 408, GPU 0)"];
    
    moe_54_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3265 (Node 408, GPU 1)"];
    
    moe_54_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3266 (Node 408, GPU 2)"];
    
    moe_54_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3267 (Node 408, GPU 3)"];
    
    moe_54_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3268 (Node 408, GPU 4)"];
    
    moe_54_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3269 (Node 408, GPU 5)"];
    
    moe_54_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3270 (Node 408, GPU 6)"];
    
    moe_54_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3271 (Node 408, GPU 7)"];
    
    moe_54_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3272 (Node 409, GPU 0)"];
    
    moe_54_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3273 (Node 409, GPU 1)"];
    
    moe_54_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3274 (Node 409, GPU 2)"];
    
    moe_54_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3275 (Node 409, GPU 3)"];
    
    moe_54_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3276 (Node 409, GPU 4)"];
    
    moe_54_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3277 (Node 409, GPU 5)"];
    
    moe_54_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3278 (Node 409, GPU 6)"];
    
    moe_54_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3279 (Node 409, GPU 7)"];
    
    moe_54_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3280 (Node 410, GPU 0)"];
    
    moe_54_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3281 (Node 410, GPU 1)"];
    
    moe_54_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3282 (Node 410, GPU 2)"];
    
    moe_54_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3283 (Node 410, GPU 3)"];
    
    moe_54_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3284 (Node 410, GPU 4)"];
    
    moe_54_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3285 (Node 410, GPU 5)"];
    
    moe_54_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3286 (Node 410, GPU 6)"];
    
    moe_54_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3287 (Node 410, GPU 7)"];
    
    moe_54_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3288 (Node 411, GPU 0)"];
    
    moe_54_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3289 (Node 411, GPU 1)"];
    
    moe_54_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3290 (Node 411, GPU 2)"];
    
    moe_54_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3291 (Node 411, GPU 3)"];
    
    moe_54_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3292 (Node 411, GPU 4)"];
    
    moe_54_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3293 (Node 411, GPU 5)"];
    
    moe_54_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3294 (Node 411, GPU 6)"];
    
    moe_54_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3295 (Node 411, GPU 7)"];
    
    moe_54_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3296 (Node 412, GPU 0)"];
    
    moe_54_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3297 (Node 412, GPU 1)"];
    
    moe_54_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3298 (Node 412, GPU 2)"];
    
    moe_54_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3299 (Node 412, GPU 3)"];
    
    moe_54_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3300 (Node 412, GPU 4)"];
    
    moe_54_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3301 (Node 412, GPU 5)"];
    
    moe_54_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3302 (Node 412, GPU 6)"];
    
    moe_54_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3303 (Node 412, GPU 7)"];
    
    moe_54_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3304 (Node 413, GPU 0)"];
    
    moe_54_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3305 (Node 413, GPU 1)"];
    
    moe_54_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3306 (Node 413, GPU 2)"];
    
    moe_54_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3307 (Node 413, GPU 3)"];
    
    moe_54_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3308 (Node 413, GPU 4)"];
    
    moe_54_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3309 (Node 413, GPU 5)"];
    
    moe_54_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3310 (Node 413, GPU 6)"];
    
    moe_54_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3311 (Node 413, GPU 7)"];
    
    moe_54_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3312 (Node 414, GPU 0)"];
    
    moe_54_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3313 (Node 414, GPU 1)"];
    
    moe_54_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3314 (Node 414, GPU 2)"];
    
    moe_54_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3315 (Node 414, GPU 3)"];
    
    moe_54_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3316 (Node 414, GPU 4)"];
    
    moe_54_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3317 (Node 414, GPU 5)"];
    
    moe_54_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3318 (Node 414, GPU 6)"];
    
    moe_54_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3319 (Node 414, GPU 7)"];
    
    moe_54_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3320 (Node 415, GPU 0)"];
    
    moe_54_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3321 (Node 415, GPU 1)"];
    
    moe_54_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3322 (Node 415, GPU 2)"];
    
    moe_54_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3323 (Node 415, GPU 3)"];
    
    moe_54_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3324 (Node 415, GPU 4)"];
    
    moe_54_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3325 (Node 415, GPU 5)"];
    
    moe_54_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3326 (Node 415, GPU 6)"];
    
    moe_54_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 54 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3327 (Node 415, GPU 7)"];
    
    moe_54_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 54 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3264 (Node 408, GPU 0)"];
    
    moe_54_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 54 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3264 (Node 408, GPU 0)"];
    
    // MoE Layer 55 - MHA components
    moe_55_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 55 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3328 (Node 416, GPU 0)"];
    
    moe_55_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 55 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3328 (Node 416, GPU 0)"];
    
    moe_55_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 55 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3328 (Node 416, GPU 0)"];
    
    moe_55_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 55 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3328 (Node 416, GPU 0)"];
    
    moe_55_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 55 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3328 (Node 416, GPU 0)"];
    
    moe_55_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 55 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3328 (Node 416, GPU 0)"];
    
    moe_55_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3328 (Node 416, GPU 0)"];
    
    moe_55_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3329 (Node 416, GPU 1)"];
    
    moe_55_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3330 (Node 416, GPU 2)"];
    
    moe_55_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3331 (Node 416, GPU 3)"];
    
    moe_55_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3332 (Node 416, GPU 4)"];
    
    moe_55_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3333 (Node 416, GPU 5)"];
    
    moe_55_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3334 (Node 416, GPU 6)"];
    
    moe_55_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3335 (Node 416, GPU 7)"];
    
    moe_55_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3336 (Node 417, GPU 0)"];
    
    moe_55_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3337 (Node 417, GPU 1)"];
    
    moe_55_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3338 (Node 417, GPU 2)"];
    
    moe_55_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3339 (Node 417, GPU 3)"];
    
    moe_55_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3340 (Node 417, GPU 4)"];
    
    moe_55_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3341 (Node 417, GPU 5)"];
    
    moe_55_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3342 (Node 417, GPU 6)"];
    
    moe_55_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3343 (Node 417, GPU 7)"];
    
    moe_55_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3344 (Node 418, GPU 0)"];
    
    moe_55_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3345 (Node 418, GPU 1)"];
    
    moe_55_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3346 (Node 418, GPU 2)"];
    
    moe_55_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3347 (Node 418, GPU 3)"];
    
    moe_55_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3348 (Node 418, GPU 4)"];
    
    moe_55_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3349 (Node 418, GPU 5)"];
    
    moe_55_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3350 (Node 418, GPU 6)"];
    
    moe_55_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3351 (Node 418, GPU 7)"];
    
    moe_55_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3352 (Node 419, GPU 0)"];
    
    moe_55_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3353 (Node 419, GPU 1)"];
    
    moe_55_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3354 (Node 419, GPU 2)"];
    
    moe_55_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3355 (Node 419, GPU 3)"];
    
    moe_55_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3356 (Node 419, GPU 4)"];
    
    moe_55_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3357 (Node 419, GPU 5)"];
    
    moe_55_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3358 (Node 419, GPU 6)"];
    
    moe_55_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3359 (Node 419, GPU 7)"];
    
    moe_55_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3360 (Node 420, GPU 0)"];
    
    moe_55_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3361 (Node 420, GPU 1)"];
    
    moe_55_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3362 (Node 420, GPU 2)"];
    
    moe_55_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3363 (Node 420, GPU 3)"];
    
    moe_55_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3364 (Node 420, GPU 4)"];
    
    moe_55_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3365 (Node 420, GPU 5)"];
    
    moe_55_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3366 (Node 420, GPU 6)"];
    
    moe_55_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3367 (Node 420, GPU 7)"];
    
    moe_55_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3368 (Node 421, GPU 0)"];
    
    moe_55_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3369 (Node 421, GPU 1)"];
    
    moe_55_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3370 (Node 421, GPU 2)"];
    
    moe_55_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3371 (Node 421, GPU 3)"];
    
    moe_55_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3372 (Node 421, GPU 4)"];
    
    moe_55_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3373 (Node 421, GPU 5)"];
    
    moe_55_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3374 (Node 421, GPU 6)"];
    
    moe_55_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3375 (Node 421, GPU 7)"];
    
    moe_55_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3376 (Node 422, GPU 0)"];
    
    moe_55_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3377 (Node 422, GPU 1)"];
    
    moe_55_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3378 (Node 422, GPU 2)"];
    
    moe_55_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3379 (Node 422, GPU 3)"];
    
    moe_55_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3380 (Node 422, GPU 4)"];
    
    moe_55_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3381 (Node 422, GPU 5)"];
    
    moe_55_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3382 (Node 422, GPU 6)"];
    
    moe_55_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3383 (Node 422, GPU 7)"];
    
    moe_55_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3384 (Node 423, GPU 0)"];
    
    moe_55_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3385 (Node 423, GPU 1)"];
    
    moe_55_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3386 (Node 423, GPU 2)"];
    
    moe_55_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3387 (Node 423, GPU 3)"];
    
    moe_55_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3388 (Node 423, GPU 4)"];
    
    moe_55_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3389 (Node 423, GPU 5)"];
    
    moe_55_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3390 (Node 423, GPU 6)"];
    
    moe_55_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 55 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3391 (Node 423, GPU 7)"];
    
    moe_55_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 55 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3328 (Node 416, GPU 0)"];
    
    moe_55_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 55 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3328 (Node 416, GPU 0)"];
    
    // MoE Layer 56 - MHA components
    moe_56_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 56 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3392 (Node 424, GPU 0)"];
    
    moe_56_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 56 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3392 (Node 424, GPU 0)"];
    
    moe_56_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 56 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3392 (Node 424, GPU 0)"];
    
    moe_56_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 56 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3392 (Node 424, GPU 0)"];
    
    moe_56_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 56 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3392 (Node 424, GPU 0)"];
    
    moe_56_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 56 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3392 (Node 424, GPU 0)"];
    
    moe_56_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3392 (Node 424, GPU 0)"];
    
    moe_56_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3393 (Node 424, GPU 1)"];
    
    moe_56_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3394 (Node 424, GPU 2)"];
    
    moe_56_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3395 (Node 424, GPU 3)"];
    
    moe_56_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3396 (Node 424, GPU 4)"];
    
    moe_56_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3397 (Node 424, GPU 5)"];
    
    moe_56_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3398 (Node 424, GPU 6)"];
    
    moe_56_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3399 (Node 424, GPU 7)"];
    
    moe_56_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3400 (Node 425, GPU 0)"];
    
    moe_56_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3401 (Node 425, GPU 1)"];
    
    moe_56_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3402 (Node 425, GPU 2)"];
    
    moe_56_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3403 (Node 425, GPU 3)"];
    
    moe_56_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3404 (Node 425, GPU 4)"];
    
    moe_56_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3405 (Node 425, GPU 5)"];
    
    moe_56_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3406 (Node 425, GPU 6)"];
    
    moe_56_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3407 (Node 425, GPU 7)"];
    
    moe_56_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3408 (Node 426, GPU 0)"];
    
    moe_56_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3409 (Node 426, GPU 1)"];
    
    moe_56_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3410 (Node 426, GPU 2)"];
    
    moe_56_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3411 (Node 426, GPU 3)"];
    
    moe_56_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3412 (Node 426, GPU 4)"];
    
    moe_56_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3413 (Node 426, GPU 5)"];
    
    moe_56_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3414 (Node 426, GPU 6)"];
    
    moe_56_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3415 (Node 426, GPU 7)"];
    
    moe_56_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3416 (Node 427, GPU 0)"];
    
    moe_56_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3417 (Node 427, GPU 1)"];
    
    moe_56_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3418 (Node 427, GPU 2)"];
    
    moe_56_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3419 (Node 427, GPU 3)"];
    
    moe_56_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3420 (Node 427, GPU 4)"];
    
    moe_56_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3421 (Node 427, GPU 5)"];
    
    moe_56_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3422 (Node 427, GPU 6)"];
    
    moe_56_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3423 (Node 427, GPU 7)"];
    
    moe_56_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3424 (Node 428, GPU 0)"];
    
    moe_56_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3425 (Node 428, GPU 1)"];
    
    moe_56_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3426 (Node 428, GPU 2)"];
    
    moe_56_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3427 (Node 428, GPU 3)"];
    
    moe_56_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3428 (Node 428, GPU 4)"];
    
    moe_56_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3429 (Node 428, GPU 5)"];
    
    moe_56_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3430 (Node 428, GPU 6)"];
    
    moe_56_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3431 (Node 428, GPU 7)"];
    
    moe_56_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3432 (Node 429, GPU 0)"];
    
    moe_56_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3433 (Node 429, GPU 1)"];
    
    moe_56_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3434 (Node 429, GPU 2)"];
    
    moe_56_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3435 (Node 429, GPU 3)"];
    
    moe_56_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3436 (Node 429, GPU 4)"];
    
    moe_56_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3437 (Node 429, GPU 5)"];
    
    moe_56_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3438 (Node 429, GPU 6)"];
    
    moe_56_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3439 (Node 429, GPU 7)"];
    
    moe_56_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3440 (Node 430, GPU 0)"];
    
    moe_56_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3441 (Node 430, GPU 1)"];
    
    moe_56_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3442 (Node 430, GPU 2)"];
    
    moe_56_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3443 (Node 430, GPU 3)"];
    
    moe_56_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3444 (Node 430, GPU 4)"];
    
    moe_56_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3445 (Node 430, GPU 5)"];
    
    moe_56_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3446 (Node 430, GPU 6)"];
    
    moe_56_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3447 (Node 430, GPU 7)"];
    
    moe_56_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3448 (Node 431, GPU 0)"];
    
    moe_56_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3449 (Node 431, GPU 1)"];
    
    moe_56_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3450 (Node 431, GPU 2)"];
    
    moe_56_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3451 (Node 431, GPU 3)"];
    
    moe_56_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3452 (Node 431, GPU 4)"];
    
    moe_56_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3453 (Node 431, GPU 5)"];
    
    moe_56_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3454 (Node 431, GPU 6)"];
    
    moe_56_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 56 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3455 (Node 431, GPU 7)"];
    
    moe_56_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 56 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3392 (Node 424, GPU 0)"];
    
    moe_56_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 56 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3392 (Node 424, GPU 0)"];
    
    // MoE Layer 57 - MHA components
    moe_57_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 57 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3456 (Node 432, GPU 0)"];
    
    moe_57_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 57 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3456 (Node 432, GPU 0)"];
    
    moe_57_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 57 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3456 (Node 432, GPU 0)"];
    
    moe_57_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 57 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3456 (Node 432, GPU 0)"];
    
    moe_57_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 57 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3456 (Node 432, GPU 0)"];
    
    moe_57_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 57 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3456 (Node 432, GPU 0)"];
    
    moe_57_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3456 (Node 432, GPU 0)"];
    
    moe_57_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3457 (Node 432, GPU 1)"];
    
    moe_57_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3458 (Node 432, GPU 2)"];
    
    moe_57_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3459 (Node 432, GPU 3)"];
    
    moe_57_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3460 (Node 432, GPU 4)"];
    
    moe_57_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3461 (Node 432, GPU 5)"];
    
    moe_57_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3462 (Node 432, GPU 6)"];
    
    moe_57_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3463 (Node 432, GPU 7)"];
    
    moe_57_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3464 (Node 433, GPU 0)"];
    
    moe_57_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3465 (Node 433, GPU 1)"];
    
    moe_57_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3466 (Node 433, GPU 2)"];
    
    moe_57_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3467 (Node 433, GPU 3)"];
    
    moe_57_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3468 (Node 433, GPU 4)"];
    
    moe_57_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3469 (Node 433, GPU 5)"];
    
    moe_57_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3470 (Node 433, GPU 6)"];
    
    moe_57_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3471 (Node 433, GPU 7)"];
    
    moe_57_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3472 (Node 434, GPU 0)"];
    
    moe_57_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3473 (Node 434, GPU 1)"];
    
    moe_57_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3474 (Node 434, GPU 2)"];
    
    moe_57_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3475 (Node 434, GPU 3)"];
    
    moe_57_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3476 (Node 434, GPU 4)"];
    
    moe_57_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3477 (Node 434, GPU 5)"];
    
    moe_57_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3478 (Node 434, GPU 6)"];
    
    moe_57_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3479 (Node 434, GPU 7)"];
    
    moe_57_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3480 (Node 435, GPU 0)"];
    
    moe_57_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3481 (Node 435, GPU 1)"];
    
    moe_57_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3482 (Node 435, GPU 2)"];
    
    moe_57_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3483 (Node 435, GPU 3)"];
    
    moe_57_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3484 (Node 435, GPU 4)"];
    
    moe_57_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3485 (Node 435, GPU 5)"];
    
    moe_57_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3486 (Node 435, GPU 6)"];
    
    moe_57_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3487 (Node 435, GPU 7)"];
    
    moe_57_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3488 (Node 436, GPU 0)"];
    
    moe_57_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3489 (Node 436, GPU 1)"];
    
    moe_57_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3490 (Node 436, GPU 2)"];
    
    moe_57_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3491 (Node 436, GPU 3)"];
    
    moe_57_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3492 (Node 436, GPU 4)"];
    
    moe_57_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3493 (Node 436, GPU 5)"];
    
    moe_57_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3494 (Node 436, GPU 6)"];
    
    moe_57_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3495 (Node 436, GPU 7)"];
    
    moe_57_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3496 (Node 437, GPU 0)"];
    
    moe_57_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3497 (Node 437, GPU 1)"];
    
    moe_57_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3498 (Node 437, GPU 2)"];
    
    moe_57_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3499 (Node 437, GPU 3)"];
    
    moe_57_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3500 (Node 437, GPU 4)"];
    
    moe_57_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3501 (Node 437, GPU 5)"];
    
    moe_57_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3502 (Node 437, GPU 6)"];
    
    moe_57_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3503 (Node 437, GPU 7)"];
    
    moe_57_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3504 (Node 438, GPU 0)"];
    
    moe_57_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3505 (Node 438, GPU 1)"];
    
    moe_57_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3506 (Node 438, GPU 2)"];
    
    moe_57_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3507 (Node 438, GPU 3)"];
    
    moe_57_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3508 (Node 438, GPU 4)"];
    
    moe_57_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3509 (Node 438, GPU 5)"];
    
    moe_57_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3510 (Node 438, GPU 6)"];
    
    moe_57_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3511 (Node 438, GPU 7)"];
    
    moe_57_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3512 (Node 439, GPU 0)"];
    
    moe_57_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3513 (Node 439, GPU 1)"];
    
    moe_57_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3514 (Node 439, GPU 2)"];
    
    moe_57_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3515 (Node 439, GPU 3)"];
    
    moe_57_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3516 (Node 439, GPU 4)"];
    
    moe_57_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3517 (Node 439, GPU 5)"];
    
    moe_57_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3518 (Node 439, GPU 6)"];
    
    moe_57_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 57 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3519 (Node 439, GPU 7)"];
    
    moe_57_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 57 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3456 (Node 432, GPU 0)"];
    
    moe_57_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 57 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3456 (Node 432, GPU 0)"];
    
    // MoE Layer 58 - MHA components
    moe_58_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 58 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3520 (Node 440, GPU 0)"];
    
    moe_58_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 58 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3520 (Node 440, GPU 0)"];
    
    moe_58_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 58 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3520 (Node 440, GPU 0)"];
    
    moe_58_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 58 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3520 (Node 440, GPU 0)"];
    
    moe_58_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 58 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3520 (Node 440, GPU 0)"];
    
    moe_58_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 58 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3520 (Node 440, GPU 0)"];
    
    moe_58_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3520 (Node 440, GPU 0)"];
    
    moe_58_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3521 (Node 440, GPU 1)"];
    
    moe_58_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3522 (Node 440, GPU 2)"];
    
    moe_58_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3523 (Node 440, GPU 3)"];
    
    moe_58_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3524 (Node 440, GPU 4)"];
    
    moe_58_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3525 (Node 440, GPU 5)"];
    
    moe_58_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3526 (Node 440, GPU 6)"];
    
    moe_58_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3527 (Node 440, GPU 7)"];
    
    moe_58_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3528 (Node 441, GPU 0)"];
    
    moe_58_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3529 (Node 441, GPU 1)"];
    
    moe_58_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3530 (Node 441, GPU 2)"];
    
    moe_58_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3531 (Node 441, GPU 3)"];
    
    moe_58_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3532 (Node 441, GPU 4)"];
    
    moe_58_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3533 (Node 441, GPU 5)"];
    
    moe_58_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3534 (Node 441, GPU 6)"];
    
    moe_58_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3535 (Node 441, GPU 7)"];
    
    moe_58_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3536 (Node 442, GPU 0)"];
    
    moe_58_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3537 (Node 442, GPU 1)"];
    
    moe_58_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3538 (Node 442, GPU 2)"];
    
    moe_58_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3539 (Node 442, GPU 3)"];
    
    moe_58_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3540 (Node 442, GPU 4)"];
    
    moe_58_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3541 (Node 442, GPU 5)"];
    
    moe_58_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3542 (Node 442, GPU 6)"];
    
    moe_58_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3543 (Node 442, GPU 7)"];
    
    moe_58_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3544 (Node 443, GPU 0)"];
    
    moe_58_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3545 (Node 443, GPU 1)"];
    
    moe_58_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3546 (Node 443, GPU 2)"];
    
    moe_58_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3547 (Node 443, GPU 3)"];
    
    moe_58_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3548 (Node 443, GPU 4)"];
    
    moe_58_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3549 (Node 443, GPU 5)"];
    
    moe_58_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3550 (Node 443, GPU 6)"];
    
    moe_58_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3551 (Node 443, GPU 7)"];
    
    moe_58_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3552 (Node 444, GPU 0)"];
    
    moe_58_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3553 (Node 444, GPU 1)"];
    
    moe_58_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3554 (Node 444, GPU 2)"];
    
    moe_58_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3555 (Node 444, GPU 3)"];
    
    moe_58_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3556 (Node 444, GPU 4)"];
    
    moe_58_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3557 (Node 444, GPU 5)"];
    
    moe_58_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3558 (Node 444, GPU 6)"];
    
    moe_58_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3559 (Node 444, GPU 7)"];
    
    moe_58_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3560 (Node 445, GPU 0)"];
    
    moe_58_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3561 (Node 445, GPU 1)"];
    
    moe_58_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3562 (Node 445, GPU 2)"];
    
    moe_58_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3563 (Node 445, GPU 3)"];
    
    moe_58_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3564 (Node 445, GPU 4)"];
    
    moe_58_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3565 (Node 445, GPU 5)"];
    
    moe_58_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3566 (Node 445, GPU 6)"];
    
    moe_58_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3567 (Node 445, GPU 7)"];
    
    moe_58_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3568 (Node 446, GPU 0)"];
    
    moe_58_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3569 (Node 446, GPU 1)"];
    
    moe_58_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3570 (Node 446, GPU 2)"];
    
    moe_58_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3571 (Node 446, GPU 3)"];
    
    moe_58_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3572 (Node 446, GPU 4)"];
    
    moe_58_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3573 (Node 446, GPU 5)"];
    
    moe_58_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3574 (Node 446, GPU 6)"];
    
    moe_58_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3575 (Node 446, GPU 7)"];
    
    moe_58_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3576 (Node 447, GPU 0)"];
    
    moe_58_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3577 (Node 447, GPU 1)"];
    
    moe_58_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3578 (Node 447, GPU 2)"];
    
    moe_58_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3579 (Node 447, GPU 3)"];
    
    moe_58_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3580 (Node 447, GPU 4)"];
    
    moe_58_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3581 (Node 447, GPU 5)"];
    
    moe_58_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3582 (Node 447, GPU 6)"];
    
    moe_58_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 58 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3583 (Node 447, GPU 7)"];
    
    moe_58_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 58 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3520 (Node 440, GPU 0)"];
    
    moe_58_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 58 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3520 (Node 440, GPU 0)"];
    
    // MoE Layer 59 - MHA components
    moe_59_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 59 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3584 (Node 448, GPU 0)"];
    
    moe_59_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 59 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3584 (Node 448, GPU 0)"];
    
    moe_59_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 59 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3584 (Node 448, GPU 0)"];
    
    moe_59_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 59 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3584 (Node 448, GPU 0)"];
    
    moe_59_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 59 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3584 (Node 448, GPU 0)"];
    
    moe_59_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 59 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3584 (Node 448, GPU 0)"];
    
    moe_59_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3584 (Node 448, GPU 0)"];
    
    moe_59_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3585 (Node 448, GPU 1)"];
    
    moe_59_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3586 (Node 448, GPU 2)"];
    
    moe_59_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3587 (Node 448, GPU 3)"];
    
    moe_59_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3588 (Node 448, GPU 4)"];
    
    moe_59_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3589 (Node 448, GPU 5)"];
    
    moe_59_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3590 (Node 448, GPU 6)"];
    
    moe_59_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3591 (Node 448, GPU 7)"];
    
    moe_59_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3592 (Node 449, GPU 0)"];
    
    moe_59_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3593 (Node 449, GPU 1)"];
    
    moe_59_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3594 (Node 449, GPU 2)"];
    
    moe_59_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3595 (Node 449, GPU 3)"];
    
    moe_59_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3596 (Node 449, GPU 4)"];
    
    moe_59_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3597 (Node 449, GPU 5)"];
    
    moe_59_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3598 (Node 449, GPU 6)"];
    
    moe_59_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3599 (Node 449, GPU 7)"];
    
    moe_59_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3600 (Node 450, GPU 0)"];
    
    moe_59_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3601 (Node 450, GPU 1)"];
    
    moe_59_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3602 (Node 450, GPU 2)"];
    
    moe_59_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3603 (Node 450, GPU 3)"];
    
    moe_59_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3604 (Node 450, GPU 4)"];
    
    moe_59_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3605 (Node 450, GPU 5)"];
    
    moe_59_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3606 (Node 450, GPU 6)"];
    
    moe_59_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3607 (Node 450, GPU 7)"];
    
    moe_59_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3608 (Node 451, GPU 0)"];
    
    moe_59_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3609 (Node 451, GPU 1)"];
    
    moe_59_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3610 (Node 451, GPU 2)"];
    
    moe_59_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3611 (Node 451, GPU 3)"];
    
    moe_59_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3612 (Node 451, GPU 4)"];
    
    moe_59_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3613 (Node 451, GPU 5)"];
    
    moe_59_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3614 (Node 451, GPU 6)"];
    
    moe_59_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3615 (Node 451, GPU 7)"];
    
    moe_59_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3616 (Node 452, GPU 0)"];
    
    moe_59_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3617 (Node 452, GPU 1)"];
    
    moe_59_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3618 (Node 452, GPU 2)"];
    
    moe_59_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3619 (Node 452, GPU 3)"];
    
    moe_59_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3620 (Node 452, GPU 4)"];
    
    moe_59_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3621 (Node 452, GPU 5)"];
    
    moe_59_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3622 (Node 452, GPU 6)"];
    
    moe_59_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3623 (Node 452, GPU 7)"];
    
    moe_59_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3624 (Node 453, GPU 0)"];
    
    moe_59_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3625 (Node 453, GPU 1)"];
    
    moe_59_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3626 (Node 453, GPU 2)"];
    
    moe_59_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3627 (Node 453, GPU 3)"];
    
    moe_59_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3628 (Node 453, GPU 4)"];
    
    moe_59_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3629 (Node 453, GPU 5)"];
    
    moe_59_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3630 (Node 453, GPU 6)"];
    
    moe_59_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3631 (Node 453, GPU 7)"];
    
    moe_59_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3632 (Node 454, GPU 0)"];
    
    moe_59_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3633 (Node 454, GPU 1)"];
    
    moe_59_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3634 (Node 454, GPU 2)"];
    
    moe_59_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3635 (Node 454, GPU 3)"];
    
    moe_59_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3636 (Node 454, GPU 4)"];
    
    moe_59_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3637 (Node 454, GPU 5)"];
    
    moe_59_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3638 (Node 454, GPU 6)"];
    
    moe_59_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3639 (Node 454, GPU 7)"];
    
    moe_59_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3640 (Node 455, GPU 0)"];
    
    moe_59_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3641 (Node 455, GPU 1)"];
    
    moe_59_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3642 (Node 455, GPU 2)"];
    
    moe_59_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3643 (Node 455, GPU 3)"];
    
    moe_59_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3644 (Node 455, GPU 4)"];
    
    moe_59_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3645 (Node 455, GPU 5)"];
    
    moe_59_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3646 (Node 455, GPU 6)"];
    
    moe_59_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 59 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3647 (Node 455, GPU 7)"];
    
    moe_59_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 59 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3584 (Node 448, GPU 0)"];
    
    moe_59_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 59 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3584 (Node 448, GPU 0)"];
    
    // MoE Layer 60 - MHA components
    moe_60_mha_q [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 60 MHA Q Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3648 (Node 456, GPU 0)"];
    
    moe_60_mha_k [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 60 MHA K Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3648 (Node 456, GPU 0)"];
    
    moe_60_mha_v [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                         label="MoE Layer 60 MHA V Projection\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3648 (Node 456, GPU 0)"];
    
    moe_60_mha_attn [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                            label="MoE Layer 60 MHA Attention\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nGPU: 3648 (Node 456, GPU 0)"];
    
    moe_60_mha_out [shape=rectangle, style=filled, fillcolor="#e1f5fe",
                           label="MoE Layer 60 MHA Output Projection\nInput: [batch_size=?, seq_len=?, heads=128, d_k=128]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3648 (Node 456, GPU 0)"];
    
    moe_60_gate [shape=parallelogram, style=filled, fillcolor="#fff9c4",
                        label="MoE Layer 60 Gate\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, top_k=2]\nGPU: 3648 (Node 456, GPU 0)"];
    
    moe_60_expert_0 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 0 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3648 (Node 456, GPU 0)"];
    
    moe_60_expert_1 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 1 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3649 (Node 456, GPU 1)"];
    
    moe_60_expert_2 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 2 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3650 (Node 456, GPU 2)"];
    
    moe_60_expert_3 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 3 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3651 (Node 456, GPU 3)"];
    
    moe_60_expert_4 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 4 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3652 (Node 456, GPU 4)"];
    
    moe_60_expert_5 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 5 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3653 (Node 456, GPU 5)"];
    
    moe_60_expert_6 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 6 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3654 (Node 456, GPU 6)"];
    
    moe_60_expert_7 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 7 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3655 (Node 456, GPU 7)"];
    
    moe_60_expert_8 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 8 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3656 (Node 457, GPU 0)"];
    
    moe_60_expert_9 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 9 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3657 (Node 457, GPU 1)"];
    
    moe_60_expert_10 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 10 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3658 (Node 457, GPU 2)"];
    
    moe_60_expert_11 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 11 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3659 (Node 457, GPU 3)"];
    
    moe_60_expert_12 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 12 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3660 (Node 457, GPU 4)"];
    
    moe_60_expert_13 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 13 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3661 (Node 457, GPU 5)"];
    
    moe_60_expert_14 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 14 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3662 (Node 457, GPU 6)"];
    
    moe_60_expert_15 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 15 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3663 (Node 457, GPU 7)"];
    
    moe_60_expert_16 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 16 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3664 (Node 458, GPU 0)"];
    
    moe_60_expert_17 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 17 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3665 (Node 458, GPU 1)"];
    
    moe_60_expert_18 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 18 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3666 (Node 458, GPU 2)"];
    
    moe_60_expert_19 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 19 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3667 (Node 458, GPU 3)"];
    
    moe_60_expert_20 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 20 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3668 (Node 458, GPU 4)"];
    
    moe_60_expert_21 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 21 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3669 (Node 458, GPU 5)"];
    
    moe_60_expert_22 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 22 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3670 (Node 458, GPU 6)"];
    
    moe_60_expert_23 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 23 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3671 (Node 458, GPU 7)"];
    
    moe_60_expert_24 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 24 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3672 (Node 459, GPU 0)"];
    
    moe_60_expert_25 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 25 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3673 (Node 459, GPU 1)"];
    
    moe_60_expert_26 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 26 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3674 (Node 459, GPU 2)"];
    
    moe_60_expert_27 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 27 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3675 (Node 459, GPU 3)"];
    
    moe_60_expert_28 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 28 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3676 (Node 459, GPU 4)"];
    
    moe_60_expert_29 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 29 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3677 (Node 459, GPU 5)"];
    
    moe_60_expert_30 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 30 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3678 (Node 459, GPU 6)"];
    
    moe_60_expert_31 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 31 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3679 (Node 459, GPU 7)"];
    
    moe_60_expert_32 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 32 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3680 (Node 460, GPU 0)"];
    
    moe_60_expert_33 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 33 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3681 (Node 460, GPU 1)"];
    
    moe_60_expert_34 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 34 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3682 (Node 460, GPU 2)"];
    
    moe_60_expert_35 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 35 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3683 (Node 460, GPU 3)"];
    
    moe_60_expert_36 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 36 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3684 (Node 460, GPU 4)"];
    
    moe_60_expert_37 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 37 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3685 (Node 460, GPU 5)"];
    
    moe_60_expert_38 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 38 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3686 (Node 460, GPU 6)"];
    
    moe_60_expert_39 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 39 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3687 (Node 460, GPU 7)"];
    
    moe_60_expert_40 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 40 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3688 (Node 461, GPU 0)"];
    
    moe_60_expert_41 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 41 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3689 (Node 461, GPU 1)"];
    
    moe_60_expert_42 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 42 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3690 (Node 461, GPU 2)"];
    
    moe_60_expert_43 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 43 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3691 (Node 461, GPU 3)"];
    
    moe_60_expert_44 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 44 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3692 (Node 461, GPU 4)"];
    
    moe_60_expert_45 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 45 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3693 (Node 461, GPU 5)"];
    
    moe_60_expert_46 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 46 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3694 (Node 461, GPU 6)"];
    
    moe_60_expert_47 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 47 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3695 (Node 461, GPU 7)"];
    
    moe_60_expert_48 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 48 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3696 (Node 462, GPU 0)"];
    
    moe_60_expert_49 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 49 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3697 (Node 462, GPU 1)"];
    
    moe_60_expert_50 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 50 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3698 (Node 462, GPU 2)"];
    
    moe_60_expert_51 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 51 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3699 (Node 462, GPU 3)"];
    
    moe_60_expert_52 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 52 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3700 (Node 462, GPU 4)"];
    
    moe_60_expert_53 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 53 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3701 (Node 462, GPU 5)"];
    
    moe_60_expert_54 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 54 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3702 (Node 462, GPU 6)"];
    
    moe_60_expert_55 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 55 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3703 (Node 462, GPU 7)"];
    
    moe_60_expert_56 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 56 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3704 (Node 463, GPU 0)"];
    
    moe_60_expert_57 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 57 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3705 (Node 463, GPU 1)"];
    
    moe_60_expert_58 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 58 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3706 (Node 463, GPU 2)"];
    
    moe_60_expert_59 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 59 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3707 (Node 463, GPU 3)"];
    
    moe_60_expert_60 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 60 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3708 (Node 463, GPU 4)"];
    
    moe_60_expert_61 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 61 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3709 (Node 463, GPU 5)"];
    
    moe_60_expert_62 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 62 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3710 (Node 463, GPU 6)"];
    
    moe_60_expert_63 [shape=rectangle, style=filled, fillcolor="#f3e5f5",
                                      label="MoE Layer 60 Expert 63 FFN\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3711 (Node 463, GPU 7)"];
    
    moe_60_expert_agg [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                              label="MoE Layer 60 Expert Aggregation\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3648 (Node 456, GPU 0)"];
    
    moe_60_residual [shape=parallelogram, style=filled, fillcolor="#e8f5e8",
                            label="MoE Layer 60 Residual Add\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: 3648 (Node 456, GPU 0)"];
    
    // Output
    output [shape=ellipse, style=filled, fillcolor="#e8f5e8",
            label="Output\nInput: [batch_size=?, seq_len=?, hidden=7168]\nOutput: [batch_size=?, seq_len=?, hidden=7168]\nGPU: Host"];
    
    
    // Connections - Input to Dense Layer 0
    input -> dense_0_mha_q [label="hidden=7168"];
    input -> dense_0_mha_k [label="hidden=7168"];
    input -> dense_0_mha_v [label="hidden=7168"];
    
    // Dense Layer 0 connections
    dense_0_mha_q -> dense_0_mha_attn [label="Q: [heads=128, d_k=128]"];
    dense_0_mha_k -> dense_0_mha_attn [label="K: [heads=128, d_k=128]"];
    dense_0_mha_v -> dense_0_mha_attn [label="V: [heads=128, d_k=128]"];
    dense_0_mha_attn -> dense_0_mha_out [label="[heads=128, d_k=128]"];
    dense_0_mha_out -> dense_0_ffn [label="hidden=7168"];
    dense_0_ffn -> dense_0_residual [label="hidden=7168"];
    dense_0_residual -> dense_1_mha_q [label="hidden=7168"];

    // Dense Layer 1 connections
    dense_1_mha_q -> dense_1_mha_attn [label="Q: [heads=128, d_k=128]"];
    dense_1_mha_k -> dense_1_mha_attn [label="K: [heads=128, d_k=128]"];
    dense_1_mha_v -> dense_1_mha_attn [label="V: [heads=128, d_k=128]"];
    dense_1_mha_attn -> dense_1_mha_out [label="[heads=128, d_k=128]"];
    dense_1_mha_out -> dense_1_ffn [label="hidden=7168"];
    dense_1_ffn -> dense_1_residual [label="hidden=7168"];
    dense_1_residual -> dense_2_mha_q [label="hidden=7168"];

    // Dense Layer 2 connections
    dense_2_mha_q -> dense_2_mha_attn [label="Q: [heads=128, d_k=128]"];
    dense_2_mha_k -> dense_2_mha_attn [label="K: [heads=128, d_k=128]"];
    dense_2_mha_v -> dense_2_mha_attn [label="V: [heads=128, d_k=128]"];
    dense_2_mha_attn -> dense_2_mha_out [label="[heads=128, d_k=128]"];
    dense_2_mha_out -> dense_2_ffn [label="hidden=7168"];
    dense_2_ffn -> dense_2_residual [label="hidden=7168"];
    dense_2_residual -> moe_3_mha_q [label="hidden=7168"];

    // MoE Layer 3 connections
    moe_3_mha_q -> moe_3_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_3_mha_k -> moe_3_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_3_mha_v -> moe_3_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_3_mha_attn -> moe_3_mha_out [label="[heads=128, d_k=128]"];
    moe_3_mha_out -> moe_3_gate [label="hidden=7168"];
    moe_3_gate -> moe_3_expert_0 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_1 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_2 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_3 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_4 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_5 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_6 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_7 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_8 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_9 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_10 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_11 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_12 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_13 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_14 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_15 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_16 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_17 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_18 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_19 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_20 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_21 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_22 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_23 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_24 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_25 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_26 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_27 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_28 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_29 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_30 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_31 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_32 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_33 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_34 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_35 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_36 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_37 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_38 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_39 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_40 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_41 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_42 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_43 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_44 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_45 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_46 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_47 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_48 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_49 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_50 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_51 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_52 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_53 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_54 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_55 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_56 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_57 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_58 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_59 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_60 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_61 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_62 [style=dashed, label="tokens"];
moe_3_gate -> moe_3_expert_63 [style=dashed, label="tokens"];
moe_3_expert_0 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_1 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_2 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_3 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_4 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_5 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_6 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_7 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_8 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_9 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_10 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_11 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_12 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_13 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_14 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_15 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_16 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_17 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_18 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_19 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_20 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_21 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_22 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_23 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_24 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_25 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_26 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_27 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_28 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_29 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_30 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_31 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_32 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_33 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_34 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_35 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_36 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_37 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_38 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_39 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_40 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_41 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_42 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_43 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_44 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_45 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_46 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_47 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_48 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_49 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_50 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_51 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_52 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_53 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_54 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_55 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_56 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_57 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_58 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_59 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_60 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_61 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_62 -> moe_3_expert_agg [label="hidden=7168"];
moe_3_expert_63 -> moe_3_expert_agg [label="hidden=7168"];

    moe_3_expert_agg -> moe_3_residual [label="hidden=7168"];
    moe_3_residual -> moe_4_mha_q [label="hidden=7168"];

    // MoE Layer 4 connections
    moe_4_mha_q -> moe_4_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_4_mha_k -> moe_4_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_4_mha_v -> moe_4_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_4_mha_attn -> moe_4_mha_out [label="[heads=128, d_k=128]"];
    moe_4_mha_out -> moe_4_gate [label="hidden=7168"];
    moe_4_gate -> moe_4_expert_0 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_1 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_2 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_3 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_4 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_5 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_6 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_7 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_8 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_9 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_10 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_11 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_12 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_13 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_14 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_15 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_16 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_17 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_18 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_19 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_20 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_21 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_22 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_23 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_24 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_25 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_26 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_27 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_28 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_29 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_30 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_31 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_32 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_33 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_34 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_35 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_36 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_37 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_38 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_39 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_40 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_41 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_42 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_43 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_44 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_45 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_46 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_47 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_48 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_49 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_50 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_51 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_52 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_53 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_54 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_55 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_56 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_57 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_58 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_59 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_60 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_61 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_62 [style=dashed, label="tokens"];
moe_4_gate -> moe_4_expert_63 [style=dashed, label="tokens"];
moe_4_expert_0 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_1 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_2 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_3 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_4 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_5 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_6 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_7 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_8 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_9 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_10 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_11 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_12 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_13 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_14 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_15 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_16 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_17 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_18 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_19 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_20 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_21 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_22 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_23 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_24 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_25 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_26 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_27 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_28 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_29 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_30 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_31 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_32 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_33 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_34 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_35 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_36 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_37 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_38 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_39 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_40 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_41 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_42 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_43 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_44 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_45 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_46 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_47 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_48 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_49 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_50 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_51 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_52 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_53 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_54 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_55 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_56 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_57 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_58 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_59 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_60 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_61 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_62 -> moe_4_expert_agg [label="hidden=7168"];
moe_4_expert_63 -> moe_4_expert_agg [label="hidden=7168"];

    moe_4_expert_agg -> moe_4_residual [label="hidden=7168"];
    moe_4_residual -> moe_5_mha_q [label="hidden=7168"];

    // MoE Layer 5 connections
    moe_5_mha_q -> moe_5_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_5_mha_k -> moe_5_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_5_mha_v -> moe_5_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_5_mha_attn -> moe_5_mha_out [label="[heads=128, d_k=128]"];
    moe_5_mha_out -> moe_5_gate [label="hidden=7168"];
    moe_5_gate -> moe_5_expert_0 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_1 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_2 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_3 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_4 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_5 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_6 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_7 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_8 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_9 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_10 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_11 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_12 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_13 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_14 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_15 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_16 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_17 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_18 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_19 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_20 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_21 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_22 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_23 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_24 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_25 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_26 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_27 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_28 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_29 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_30 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_31 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_32 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_33 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_34 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_35 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_36 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_37 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_38 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_39 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_40 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_41 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_42 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_43 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_44 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_45 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_46 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_47 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_48 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_49 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_50 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_51 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_52 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_53 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_54 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_55 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_56 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_57 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_58 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_59 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_60 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_61 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_62 [style=dashed, label="tokens"];
moe_5_gate -> moe_5_expert_63 [style=dashed, label="tokens"];
moe_5_expert_0 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_1 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_2 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_3 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_4 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_5 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_6 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_7 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_8 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_9 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_10 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_11 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_12 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_13 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_14 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_15 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_16 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_17 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_18 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_19 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_20 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_21 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_22 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_23 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_24 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_25 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_26 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_27 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_28 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_29 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_30 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_31 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_32 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_33 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_34 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_35 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_36 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_37 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_38 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_39 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_40 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_41 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_42 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_43 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_44 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_45 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_46 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_47 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_48 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_49 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_50 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_51 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_52 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_53 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_54 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_55 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_56 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_57 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_58 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_59 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_60 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_61 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_62 -> moe_5_expert_agg [label="hidden=7168"];
moe_5_expert_63 -> moe_5_expert_agg [label="hidden=7168"];

    moe_5_expert_agg -> moe_5_residual [label="hidden=7168"];
    moe_5_residual -> moe_6_mha_q [label="hidden=7168"];

    // MoE Layer 6 connections
    moe_6_mha_q -> moe_6_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_6_mha_k -> moe_6_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_6_mha_v -> moe_6_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_6_mha_attn -> moe_6_mha_out [label="[heads=128, d_k=128]"];
    moe_6_mha_out -> moe_6_gate [label="hidden=7168"];
    moe_6_gate -> moe_6_expert_0 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_1 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_2 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_3 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_4 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_5 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_6 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_7 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_8 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_9 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_10 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_11 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_12 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_13 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_14 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_15 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_16 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_17 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_18 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_19 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_20 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_21 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_22 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_23 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_24 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_25 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_26 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_27 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_28 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_29 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_30 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_31 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_32 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_33 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_34 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_35 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_36 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_37 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_38 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_39 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_40 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_41 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_42 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_43 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_44 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_45 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_46 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_47 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_48 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_49 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_50 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_51 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_52 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_53 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_54 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_55 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_56 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_57 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_58 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_59 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_60 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_61 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_62 [style=dashed, label="tokens"];
moe_6_gate -> moe_6_expert_63 [style=dashed, label="tokens"];
moe_6_expert_0 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_1 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_2 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_3 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_4 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_5 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_6 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_7 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_8 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_9 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_10 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_11 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_12 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_13 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_14 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_15 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_16 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_17 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_18 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_19 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_20 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_21 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_22 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_23 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_24 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_25 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_26 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_27 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_28 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_29 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_30 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_31 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_32 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_33 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_34 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_35 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_36 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_37 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_38 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_39 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_40 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_41 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_42 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_43 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_44 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_45 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_46 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_47 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_48 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_49 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_50 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_51 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_52 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_53 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_54 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_55 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_56 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_57 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_58 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_59 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_60 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_61 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_62 -> moe_6_expert_agg [label="hidden=7168"];
moe_6_expert_63 -> moe_6_expert_agg [label="hidden=7168"];

    moe_6_expert_agg -> moe_6_residual [label="hidden=7168"];
    moe_6_residual -> moe_7_mha_q [label="hidden=7168"];

    // MoE Layer 7 connections
    moe_7_mha_q -> moe_7_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_7_mha_k -> moe_7_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_7_mha_v -> moe_7_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_7_mha_attn -> moe_7_mha_out [label="[heads=128, d_k=128]"];
    moe_7_mha_out -> moe_7_gate [label="hidden=7168"];
    moe_7_gate -> moe_7_expert_0 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_1 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_2 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_3 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_4 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_5 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_6 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_7 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_8 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_9 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_10 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_11 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_12 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_13 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_14 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_15 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_16 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_17 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_18 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_19 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_20 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_21 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_22 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_23 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_24 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_25 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_26 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_27 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_28 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_29 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_30 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_31 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_32 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_33 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_34 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_35 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_36 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_37 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_38 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_39 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_40 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_41 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_42 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_43 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_44 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_45 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_46 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_47 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_48 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_49 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_50 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_51 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_52 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_53 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_54 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_55 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_56 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_57 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_58 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_59 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_60 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_61 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_62 [style=dashed, label="tokens"];
moe_7_gate -> moe_7_expert_63 [style=dashed, label="tokens"];
moe_7_expert_0 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_1 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_2 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_3 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_4 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_5 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_6 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_7 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_8 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_9 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_10 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_11 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_12 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_13 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_14 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_15 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_16 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_17 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_18 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_19 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_20 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_21 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_22 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_23 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_24 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_25 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_26 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_27 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_28 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_29 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_30 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_31 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_32 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_33 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_34 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_35 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_36 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_37 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_38 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_39 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_40 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_41 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_42 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_43 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_44 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_45 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_46 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_47 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_48 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_49 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_50 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_51 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_52 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_53 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_54 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_55 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_56 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_57 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_58 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_59 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_60 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_61 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_62 -> moe_7_expert_agg [label="hidden=7168"];
moe_7_expert_63 -> moe_7_expert_agg [label="hidden=7168"];

    moe_7_expert_agg -> moe_7_residual [label="hidden=7168"];
    moe_7_residual -> moe_8_mha_q [label="hidden=7168"];

    // MoE Layer 8 connections
    moe_8_mha_q -> moe_8_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_8_mha_k -> moe_8_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_8_mha_v -> moe_8_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_8_mha_attn -> moe_8_mha_out [label="[heads=128, d_k=128]"];
    moe_8_mha_out -> moe_8_gate [label="hidden=7168"];
    moe_8_gate -> moe_8_expert_0 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_1 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_2 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_3 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_4 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_5 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_6 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_7 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_8 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_9 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_10 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_11 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_12 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_13 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_14 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_15 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_16 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_17 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_18 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_19 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_20 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_21 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_22 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_23 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_24 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_25 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_26 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_27 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_28 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_29 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_30 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_31 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_32 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_33 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_34 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_35 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_36 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_37 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_38 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_39 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_40 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_41 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_42 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_43 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_44 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_45 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_46 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_47 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_48 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_49 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_50 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_51 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_52 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_53 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_54 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_55 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_56 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_57 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_58 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_59 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_60 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_61 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_62 [style=dashed, label="tokens"];
moe_8_gate -> moe_8_expert_63 [style=dashed, label="tokens"];
moe_8_expert_0 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_1 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_2 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_3 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_4 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_5 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_6 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_7 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_8 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_9 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_10 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_11 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_12 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_13 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_14 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_15 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_16 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_17 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_18 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_19 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_20 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_21 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_22 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_23 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_24 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_25 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_26 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_27 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_28 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_29 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_30 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_31 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_32 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_33 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_34 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_35 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_36 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_37 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_38 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_39 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_40 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_41 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_42 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_43 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_44 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_45 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_46 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_47 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_48 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_49 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_50 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_51 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_52 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_53 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_54 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_55 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_56 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_57 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_58 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_59 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_60 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_61 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_62 -> moe_8_expert_agg [label="hidden=7168"];
moe_8_expert_63 -> moe_8_expert_agg [label="hidden=7168"];

    moe_8_expert_agg -> moe_8_residual [label="hidden=7168"];
    moe_8_residual -> moe_9_mha_q [label="hidden=7168"];

    // MoE Layer 9 connections
    moe_9_mha_q -> moe_9_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_9_mha_k -> moe_9_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_9_mha_v -> moe_9_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_9_mha_attn -> moe_9_mha_out [label="[heads=128, d_k=128]"];
    moe_9_mha_out -> moe_9_gate [label="hidden=7168"];
    moe_9_gate -> moe_9_expert_0 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_1 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_2 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_3 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_4 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_5 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_6 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_7 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_8 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_9 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_10 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_11 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_12 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_13 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_14 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_15 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_16 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_17 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_18 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_19 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_20 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_21 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_22 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_23 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_24 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_25 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_26 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_27 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_28 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_29 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_30 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_31 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_32 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_33 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_34 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_35 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_36 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_37 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_38 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_39 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_40 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_41 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_42 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_43 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_44 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_45 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_46 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_47 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_48 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_49 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_50 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_51 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_52 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_53 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_54 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_55 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_56 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_57 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_58 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_59 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_60 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_61 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_62 [style=dashed, label="tokens"];
moe_9_gate -> moe_9_expert_63 [style=dashed, label="tokens"];
moe_9_expert_0 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_1 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_2 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_3 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_4 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_5 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_6 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_7 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_8 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_9 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_10 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_11 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_12 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_13 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_14 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_15 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_16 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_17 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_18 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_19 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_20 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_21 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_22 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_23 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_24 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_25 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_26 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_27 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_28 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_29 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_30 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_31 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_32 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_33 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_34 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_35 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_36 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_37 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_38 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_39 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_40 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_41 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_42 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_43 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_44 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_45 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_46 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_47 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_48 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_49 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_50 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_51 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_52 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_53 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_54 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_55 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_56 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_57 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_58 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_59 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_60 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_61 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_62 -> moe_9_expert_agg [label="hidden=7168"];
moe_9_expert_63 -> moe_9_expert_agg [label="hidden=7168"];

    moe_9_expert_agg -> moe_9_residual [label="hidden=7168"];
    moe_9_residual -> moe_10_mha_q [label="hidden=7168"];

    // MoE Layer 10 connections
    moe_10_mha_q -> moe_10_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_10_mha_k -> moe_10_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_10_mha_v -> moe_10_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_10_mha_attn -> moe_10_mha_out [label="[heads=128, d_k=128]"];
    moe_10_mha_out -> moe_10_gate [label="hidden=7168"];
    moe_10_gate -> moe_10_expert_0 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_1 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_2 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_3 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_4 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_5 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_6 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_7 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_8 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_9 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_10 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_11 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_12 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_13 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_14 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_15 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_16 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_17 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_18 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_19 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_20 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_21 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_22 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_23 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_24 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_25 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_26 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_27 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_28 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_29 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_30 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_31 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_32 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_33 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_34 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_35 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_36 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_37 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_38 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_39 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_40 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_41 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_42 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_43 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_44 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_45 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_46 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_47 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_48 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_49 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_50 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_51 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_52 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_53 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_54 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_55 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_56 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_57 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_58 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_59 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_60 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_61 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_62 [style=dashed, label="tokens"];
moe_10_gate -> moe_10_expert_63 [style=dashed, label="tokens"];
moe_10_expert_0 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_1 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_2 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_3 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_4 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_5 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_6 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_7 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_8 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_9 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_10 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_11 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_12 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_13 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_14 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_15 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_16 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_17 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_18 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_19 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_20 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_21 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_22 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_23 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_24 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_25 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_26 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_27 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_28 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_29 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_30 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_31 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_32 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_33 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_34 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_35 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_36 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_37 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_38 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_39 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_40 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_41 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_42 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_43 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_44 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_45 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_46 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_47 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_48 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_49 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_50 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_51 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_52 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_53 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_54 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_55 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_56 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_57 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_58 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_59 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_60 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_61 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_62 -> moe_10_expert_agg [label="hidden=7168"];
moe_10_expert_63 -> moe_10_expert_agg [label="hidden=7168"];

    moe_10_expert_agg -> moe_10_residual [label="hidden=7168"];
    moe_10_residual -> moe_11_mha_q [label="hidden=7168"];

    // MoE Layer 11 connections
    moe_11_mha_q -> moe_11_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_11_mha_k -> moe_11_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_11_mha_v -> moe_11_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_11_mha_attn -> moe_11_mha_out [label="[heads=128, d_k=128]"];
    moe_11_mha_out -> moe_11_gate [label="hidden=7168"];
    moe_11_gate -> moe_11_expert_0 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_1 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_2 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_3 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_4 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_5 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_6 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_7 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_8 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_9 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_10 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_11 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_12 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_13 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_14 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_15 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_16 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_17 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_18 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_19 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_20 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_21 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_22 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_23 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_24 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_25 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_26 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_27 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_28 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_29 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_30 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_31 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_32 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_33 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_34 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_35 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_36 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_37 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_38 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_39 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_40 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_41 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_42 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_43 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_44 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_45 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_46 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_47 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_48 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_49 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_50 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_51 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_52 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_53 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_54 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_55 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_56 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_57 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_58 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_59 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_60 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_61 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_62 [style=dashed, label="tokens"];
moe_11_gate -> moe_11_expert_63 [style=dashed, label="tokens"];
moe_11_expert_0 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_1 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_2 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_3 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_4 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_5 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_6 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_7 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_8 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_9 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_10 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_11 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_12 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_13 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_14 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_15 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_16 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_17 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_18 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_19 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_20 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_21 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_22 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_23 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_24 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_25 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_26 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_27 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_28 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_29 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_30 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_31 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_32 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_33 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_34 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_35 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_36 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_37 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_38 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_39 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_40 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_41 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_42 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_43 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_44 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_45 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_46 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_47 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_48 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_49 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_50 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_51 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_52 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_53 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_54 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_55 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_56 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_57 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_58 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_59 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_60 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_61 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_62 -> moe_11_expert_agg [label="hidden=7168"];
moe_11_expert_63 -> moe_11_expert_agg [label="hidden=7168"];

    moe_11_expert_agg -> moe_11_residual [label="hidden=7168"];
    moe_11_residual -> moe_12_mha_q [label="hidden=7168"];

    // MoE Layer 12 connections
    moe_12_mha_q -> moe_12_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_12_mha_k -> moe_12_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_12_mha_v -> moe_12_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_12_mha_attn -> moe_12_mha_out [label="[heads=128, d_k=128]"];
    moe_12_mha_out -> moe_12_gate [label="hidden=7168"];
    moe_12_gate -> moe_12_expert_0 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_1 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_2 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_3 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_4 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_5 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_6 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_7 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_8 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_9 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_10 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_11 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_12 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_13 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_14 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_15 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_16 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_17 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_18 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_19 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_20 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_21 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_22 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_23 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_24 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_25 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_26 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_27 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_28 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_29 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_30 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_31 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_32 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_33 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_34 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_35 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_36 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_37 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_38 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_39 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_40 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_41 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_42 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_43 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_44 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_45 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_46 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_47 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_48 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_49 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_50 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_51 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_52 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_53 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_54 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_55 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_56 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_57 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_58 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_59 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_60 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_61 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_62 [style=dashed, label="tokens"];
moe_12_gate -> moe_12_expert_63 [style=dashed, label="tokens"];
moe_12_expert_0 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_1 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_2 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_3 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_4 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_5 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_6 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_7 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_8 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_9 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_10 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_11 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_12 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_13 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_14 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_15 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_16 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_17 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_18 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_19 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_20 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_21 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_22 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_23 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_24 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_25 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_26 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_27 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_28 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_29 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_30 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_31 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_32 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_33 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_34 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_35 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_36 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_37 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_38 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_39 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_40 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_41 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_42 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_43 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_44 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_45 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_46 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_47 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_48 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_49 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_50 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_51 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_52 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_53 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_54 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_55 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_56 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_57 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_58 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_59 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_60 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_61 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_62 -> moe_12_expert_agg [label="hidden=7168"];
moe_12_expert_63 -> moe_12_expert_agg [label="hidden=7168"];

    moe_12_expert_agg -> moe_12_residual [label="hidden=7168"];
    moe_12_residual -> moe_13_mha_q [label="hidden=7168"];

    // MoE Layer 13 connections
    moe_13_mha_q -> moe_13_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_13_mha_k -> moe_13_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_13_mha_v -> moe_13_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_13_mha_attn -> moe_13_mha_out [label="[heads=128, d_k=128]"];
    moe_13_mha_out -> moe_13_gate [label="hidden=7168"];
    moe_13_gate -> moe_13_expert_0 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_1 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_2 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_3 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_4 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_5 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_6 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_7 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_8 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_9 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_10 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_11 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_12 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_13 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_14 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_15 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_16 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_17 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_18 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_19 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_20 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_21 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_22 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_23 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_24 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_25 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_26 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_27 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_28 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_29 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_30 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_31 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_32 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_33 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_34 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_35 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_36 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_37 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_38 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_39 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_40 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_41 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_42 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_43 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_44 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_45 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_46 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_47 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_48 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_49 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_50 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_51 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_52 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_53 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_54 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_55 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_56 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_57 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_58 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_59 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_60 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_61 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_62 [style=dashed, label="tokens"];
moe_13_gate -> moe_13_expert_63 [style=dashed, label="tokens"];
moe_13_expert_0 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_1 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_2 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_3 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_4 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_5 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_6 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_7 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_8 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_9 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_10 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_11 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_12 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_13 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_14 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_15 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_16 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_17 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_18 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_19 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_20 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_21 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_22 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_23 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_24 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_25 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_26 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_27 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_28 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_29 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_30 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_31 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_32 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_33 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_34 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_35 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_36 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_37 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_38 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_39 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_40 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_41 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_42 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_43 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_44 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_45 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_46 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_47 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_48 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_49 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_50 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_51 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_52 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_53 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_54 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_55 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_56 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_57 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_58 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_59 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_60 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_61 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_62 -> moe_13_expert_agg [label="hidden=7168"];
moe_13_expert_63 -> moe_13_expert_agg [label="hidden=7168"];

    moe_13_expert_agg -> moe_13_residual [label="hidden=7168"];
    moe_13_residual -> moe_14_mha_q [label="hidden=7168"];

    // MoE Layer 14 connections
    moe_14_mha_q -> moe_14_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_14_mha_k -> moe_14_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_14_mha_v -> moe_14_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_14_mha_attn -> moe_14_mha_out [label="[heads=128, d_k=128]"];
    moe_14_mha_out -> moe_14_gate [label="hidden=7168"];
    moe_14_gate -> moe_14_expert_0 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_1 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_2 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_3 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_4 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_5 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_6 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_7 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_8 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_9 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_10 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_11 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_12 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_13 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_14 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_15 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_16 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_17 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_18 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_19 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_20 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_21 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_22 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_23 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_24 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_25 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_26 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_27 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_28 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_29 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_30 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_31 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_32 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_33 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_34 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_35 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_36 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_37 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_38 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_39 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_40 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_41 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_42 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_43 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_44 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_45 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_46 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_47 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_48 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_49 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_50 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_51 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_52 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_53 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_54 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_55 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_56 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_57 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_58 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_59 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_60 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_61 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_62 [style=dashed, label="tokens"];
moe_14_gate -> moe_14_expert_63 [style=dashed, label="tokens"];
moe_14_expert_0 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_1 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_2 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_3 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_4 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_5 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_6 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_7 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_8 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_9 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_10 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_11 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_12 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_13 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_14 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_15 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_16 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_17 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_18 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_19 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_20 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_21 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_22 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_23 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_24 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_25 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_26 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_27 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_28 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_29 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_30 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_31 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_32 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_33 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_34 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_35 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_36 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_37 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_38 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_39 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_40 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_41 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_42 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_43 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_44 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_45 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_46 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_47 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_48 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_49 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_50 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_51 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_52 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_53 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_54 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_55 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_56 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_57 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_58 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_59 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_60 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_61 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_62 -> moe_14_expert_agg [label="hidden=7168"];
moe_14_expert_63 -> moe_14_expert_agg [label="hidden=7168"];

    moe_14_expert_agg -> moe_14_residual [label="hidden=7168"];
    moe_14_residual -> moe_15_mha_q [label="hidden=7168"];

    // MoE Layer 15 connections
    moe_15_mha_q -> moe_15_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_15_mha_k -> moe_15_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_15_mha_v -> moe_15_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_15_mha_attn -> moe_15_mha_out [label="[heads=128, d_k=128]"];
    moe_15_mha_out -> moe_15_gate [label="hidden=7168"];
    moe_15_gate -> moe_15_expert_0 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_1 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_2 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_3 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_4 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_5 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_6 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_7 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_8 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_9 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_10 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_11 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_12 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_13 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_14 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_15 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_16 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_17 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_18 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_19 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_20 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_21 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_22 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_23 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_24 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_25 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_26 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_27 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_28 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_29 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_30 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_31 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_32 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_33 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_34 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_35 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_36 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_37 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_38 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_39 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_40 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_41 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_42 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_43 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_44 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_45 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_46 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_47 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_48 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_49 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_50 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_51 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_52 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_53 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_54 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_55 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_56 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_57 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_58 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_59 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_60 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_61 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_62 [style=dashed, label="tokens"];
moe_15_gate -> moe_15_expert_63 [style=dashed, label="tokens"];
moe_15_expert_0 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_1 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_2 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_3 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_4 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_5 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_6 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_7 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_8 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_9 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_10 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_11 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_12 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_13 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_14 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_15 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_16 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_17 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_18 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_19 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_20 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_21 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_22 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_23 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_24 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_25 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_26 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_27 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_28 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_29 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_30 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_31 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_32 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_33 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_34 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_35 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_36 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_37 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_38 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_39 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_40 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_41 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_42 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_43 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_44 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_45 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_46 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_47 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_48 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_49 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_50 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_51 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_52 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_53 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_54 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_55 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_56 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_57 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_58 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_59 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_60 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_61 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_62 -> moe_15_expert_agg [label="hidden=7168"];
moe_15_expert_63 -> moe_15_expert_agg [label="hidden=7168"];

    moe_15_expert_agg -> moe_15_residual [label="hidden=7168"];
    moe_15_residual -> moe_16_mha_q [label="hidden=7168"];

    // MoE Layer 16 connections
    moe_16_mha_q -> moe_16_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_16_mha_k -> moe_16_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_16_mha_v -> moe_16_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_16_mha_attn -> moe_16_mha_out [label="[heads=128, d_k=128]"];
    moe_16_mha_out -> moe_16_gate [label="hidden=7168"];
    moe_16_gate -> moe_16_expert_0 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_1 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_2 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_3 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_4 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_5 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_6 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_7 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_8 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_9 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_10 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_11 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_12 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_13 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_14 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_15 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_16 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_17 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_18 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_19 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_20 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_21 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_22 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_23 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_24 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_25 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_26 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_27 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_28 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_29 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_30 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_31 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_32 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_33 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_34 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_35 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_36 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_37 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_38 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_39 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_40 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_41 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_42 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_43 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_44 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_45 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_46 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_47 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_48 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_49 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_50 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_51 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_52 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_53 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_54 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_55 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_56 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_57 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_58 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_59 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_60 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_61 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_62 [style=dashed, label="tokens"];
moe_16_gate -> moe_16_expert_63 [style=dashed, label="tokens"];
moe_16_expert_0 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_1 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_2 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_3 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_4 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_5 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_6 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_7 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_8 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_9 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_10 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_11 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_12 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_13 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_14 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_15 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_16 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_17 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_18 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_19 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_20 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_21 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_22 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_23 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_24 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_25 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_26 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_27 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_28 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_29 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_30 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_31 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_32 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_33 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_34 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_35 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_36 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_37 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_38 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_39 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_40 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_41 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_42 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_43 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_44 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_45 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_46 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_47 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_48 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_49 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_50 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_51 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_52 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_53 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_54 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_55 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_56 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_57 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_58 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_59 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_60 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_61 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_62 -> moe_16_expert_agg [label="hidden=7168"];
moe_16_expert_63 -> moe_16_expert_agg [label="hidden=7168"];

    moe_16_expert_agg -> moe_16_residual [label="hidden=7168"];
    moe_16_residual -> moe_17_mha_q [label="hidden=7168"];

    // MoE Layer 17 connections
    moe_17_mha_q -> moe_17_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_17_mha_k -> moe_17_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_17_mha_v -> moe_17_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_17_mha_attn -> moe_17_mha_out [label="[heads=128, d_k=128]"];
    moe_17_mha_out -> moe_17_gate [label="hidden=7168"];
    moe_17_gate -> moe_17_expert_0 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_1 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_2 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_3 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_4 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_5 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_6 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_7 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_8 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_9 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_10 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_11 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_12 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_13 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_14 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_15 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_16 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_17 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_18 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_19 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_20 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_21 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_22 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_23 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_24 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_25 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_26 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_27 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_28 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_29 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_30 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_31 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_32 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_33 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_34 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_35 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_36 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_37 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_38 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_39 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_40 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_41 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_42 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_43 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_44 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_45 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_46 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_47 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_48 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_49 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_50 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_51 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_52 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_53 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_54 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_55 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_56 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_57 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_58 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_59 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_60 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_61 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_62 [style=dashed, label="tokens"];
moe_17_gate -> moe_17_expert_63 [style=dashed, label="tokens"];
moe_17_expert_0 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_1 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_2 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_3 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_4 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_5 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_6 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_7 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_8 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_9 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_10 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_11 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_12 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_13 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_14 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_15 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_16 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_17 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_18 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_19 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_20 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_21 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_22 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_23 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_24 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_25 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_26 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_27 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_28 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_29 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_30 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_31 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_32 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_33 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_34 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_35 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_36 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_37 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_38 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_39 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_40 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_41 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_42 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_43 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_44 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_45 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_46 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_47 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_48 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_49 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_50 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_51 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_52 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_53 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_54 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_55 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_56 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_57 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_58 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_59 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_60 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_61 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_62 -> moe_17_expert_agg [label="hidden=7168"];
moe_17_expert_63 -> moe_17_expert_agg [label="hidden=7168"];

    moe_17_expert_agg -> moe_17_residual [label="hidden=7168"];
    moe_17_residual -> moe_18_mha_q [label="hidden=7168"];

    // MoE Layer 18 connections
    moe_18_mha_q -> moe_18_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_18_mha_k -> moe_18_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_18_mha_v -> moe_18_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_18_mha_attn -> moe_18_mha_out [label="[heads=128, d_k=128]"];
    moe_18_mha_out -> moe_18_gate [label="hidden=7168"];
    moe_18_gate -> moe_18_expert_0 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_1 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_2 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_3 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_4 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_5 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_6 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_7 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_8 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_9 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_10 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_11 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_12 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_13 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_14 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_15 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_16 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_17 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_18 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_19 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_20 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_21 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_22 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_23 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_24 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_25 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_26 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_27 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_28 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_29 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_30 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_31 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_32 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_33 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_34 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_35 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_36 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_37 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_38 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_39 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_40 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_41 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_42 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_43 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_44 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_45 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_46 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_47 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_48 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_49 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_50 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_51 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_52 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_53 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_54 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_55 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_56 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_57 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_58 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_59 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_60 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_61 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_62 [style=dashed, label="tokens"];
moe_18_gate -> moe_18_expert_63 [style=dashed, label="tokens"];
moe_18_expert_0 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_1 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_2 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_3 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_4 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_5 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_6 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_7 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_8 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_9 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_10 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_11 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_12 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_13 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_14 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_15 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_16 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_17 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_18 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_19 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_20 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_21 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_22 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_23 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_24 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_25 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_26 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_27 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_28 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_29 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_30 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_31 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_32 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_33 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_34 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_35 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_36 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_37 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_38 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_39 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_40 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_41 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_42 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_43 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_44 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_45 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_46 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_47 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_48 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_49 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_50 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_51 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_52 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_53 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_54 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_55 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_56 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_57 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_58 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_59 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_60 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_61 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_62 -> moe_18_expert_agg [label="hidden=7168"];
moe_18_expert_63 -> moe_18_expert_agg [label="hidden=7168"];

    moe_18_expert_agg -> moe_18_residual [label="hidden=7168"];
    moe_18_residual -> moe_19_mha_q [label="hidden=7168"];

    // MoE Layer 19 connections
    moe_19_mha_q -> moe_19_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_19_mha_k -> moe_19_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_19_mha_v -> moe_19_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_19_mha_attn -> moe_19_mha_out [label="[heads=128, d_k=128]"];
    moe_19_mha_out -> moe_19_gate [label="hidden=7168"];
    moe_19_gate -> moe_19_expert_0 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_1 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_2 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_3 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_4 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_5 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_6 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_7 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_8 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_9 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_10 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_11 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_12 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_13 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_14 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_15 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_16 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_17 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_18 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_19 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_20 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_21 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_22 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_23 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_24 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_25 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_26 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_27 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_28 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_29 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_30 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_31 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_32 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_33 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_34 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_35 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_36 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_37 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_38 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_39 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_40 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_41 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_42 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_43 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_44 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_45 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_46 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_47 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_48 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_49 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_50 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_51 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_52 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_53 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_54 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_55 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_56 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_57 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_58 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_59 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_60 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_61 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_62 [style=dashed, label="tokens"];
moe_19_gate -> moe_19_expert_63 [style=dashed, label="tokens"];
moe_19_expert_0 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_1 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_2 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_3 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_4 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_5 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_6 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_7 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_8 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_9 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_10 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_11 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_12 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_13 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_14 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_15 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_16 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_17 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_18 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_19 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_20 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_21 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_22 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_23 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_24 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_25 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_26 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_27 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_28 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_29 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_30 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_31 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_32 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_33 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_34 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_35 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_36 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_37 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_38 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_39 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_40 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_41 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_42 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_43 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_44 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_45 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_46 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_47 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_48 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_49 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_50 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_51 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_52 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_53 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_54 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_55 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_56 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_57 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_58 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_59 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_60 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_61 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_62 -> moe_19_expert_agg [label="hidden=7168"];
moe_19_expert_63 -> moe_19_expert_agg [label="hidden=7168"];

    moe_19_expert_agg -> moe_19_residual [label="hidden=7168"];
    moe_19_residual -> moe_20_mha_q [label="hidden=7168"];

    // MoE Layer 20 connections
    moe_20_mha_q -> moe_20_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_20_mha_k -> moe_20_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_20_mha_v -> moe_20_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_20_mha_attn -> moe_20_mha_out [label="[heads=128, d_k=128]"];
    moe_20_mha_out -> moe_20_gate [label="hidden=7168"];
    moe_20_gate -> moe_20_expert_0 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_1 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_2 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_3 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_4 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_5 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_6 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_7 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_8 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_9 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_10 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_11 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_12 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_13 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_14 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_15 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_16 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_17 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_18 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_19 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_20 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_21 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_22 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_23 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_24 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_25 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_26 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_27 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_28 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_29 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_30 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_31 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_32 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_33 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_34 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_35 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_36 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_37 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_38 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_39 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_40 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_41 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_42 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_43 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_44 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_45 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_46 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_47 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_48 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_49 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_50 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_51 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_52 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_53 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_54 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_55 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_56 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_57 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_58 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_59 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_60 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_61 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_62 [style=dashed, label="tokens"];
moe_20_gate -> moe_20_expert_63 [style=dashed, label="tokens"];
moe_20_expert_0 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_1 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_2 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_3 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_4 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_5 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_6 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_7 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_8 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_9 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_10 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_11 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_12 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_13 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_14 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_15 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_16 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_17 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_18 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_19 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_20 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_21 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_22 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_23 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_24 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_25 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_26 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_27 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_28 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_29 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_30 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_31 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_32 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_33 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_34 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_35 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_36 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_37 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_38 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_39 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_40 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_41 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_42 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_43 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_44 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_45 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_46 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_47 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_48 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_49 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_50 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_51 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_52 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_53 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_54 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_55 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_56 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_57 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_58 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_59 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_60 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_61 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_62 -> moe_20_expert_agg [label="hidden=7168"];
moe_20_expert_63 -> moe_20_expert_agg [label="hidden=7168"];

    moe_20_expert_agg -> moe_20_residual [label="hidden=7168"];
    moe_20_residual -> moe_21_mha_q [label="hidden=7168"];

    // MoE Layer 21 connections
    moe_21_mha_q -> moe_21_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_21_mha_k -> moe_21_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_21_mha_v -> moe_21_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_21_mha_attn -> moe_21_mha_out [label="[heads=128, d_k=128]"];
    moe_21_mha_out -> moe_21_gate [label="hidden=7168"];
    moe_21_gate -> moe_21_expert_0 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_1 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_2 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_3 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_4 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_5 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_6 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_7 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_8 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_9 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_10 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_11 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_12 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_13 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_14 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_15 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_16 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_17 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_18 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_19 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_20 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_21 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_22 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_23 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_24 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_25 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_26 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_27 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_28 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_29 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_30 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_31 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_32 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_33 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_34 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_35 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_36 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_37 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_38 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_39 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_40 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_41 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_42 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_43 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_44 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_45 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_46 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_47 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_48 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_49 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_50 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_51 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_52 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_53 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_54 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_55 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_56 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_57 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_58 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_59 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_60 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_61 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_62 [style=dashed, label="tokens"];
moe_21_gate -> moe_21_expert_63 [style=dashed, label="tokens"];
moe_21_expert_0 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_1 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_2 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_3 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_4 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_5 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_6 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_7 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_8 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_9 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_10 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_11 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_12 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_13 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_14 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_15 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_16 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_17 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_18 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_19 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_20 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_21 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_22 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_23 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_24 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_25 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_26 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_27 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_28 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_29 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_30 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_31 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_32 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_33 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_34 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_35 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_36 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_37 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_38 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_39 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_40 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_41 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_42 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_43 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_44 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_45 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_46 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_47 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_48 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_49 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_50 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_51 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_52 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_53 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_54 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_55 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_56 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_57 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_58 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_59 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_60 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_61 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_62 -> moe_21_expert_agg [label="hidden=7168"];
moe_21_expert_63 -> moe_21_expert_agg [label="hidden=7168"];

    moe_21_expert_agg -> moe_21_residual [label="hidden=7168"];
    moe_21_residual -> moe_22_mha_q [label="hidden=7168"];

    // MoE Layer 22 connections
    moe_22_mha_q -> moe_22_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_22_mha_k -> moe_22_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_22_mha_v -> moe_22_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_22_mha_attn -> moe_22_mha_out [label="[heads=128, d_k=128]"];
    moe_22_mha_out -> moe_22_gate [label="hidden=7168"];
    moe_22_gate -> moe_22_expert_0 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_1 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_2 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_3 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_4 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_5 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_6 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_7 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_8 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_9 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_10 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_11 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_12 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_13 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_14 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_15 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_16 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_17 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_18 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_19 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_20 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_21 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_22 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_23 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_24 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_25 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_26 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_27 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_28 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_29 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_30 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_31 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_32 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_33 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_34 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_35 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_36 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_37 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_38 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_39 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_40 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_41 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_42 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_43 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_44 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_45 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_46 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_47 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_48 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_49 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_50 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_51 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_52 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_53 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_54 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_55 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_56 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_57 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_58 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_59 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_60 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_61 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_62 [style=dashed, label="tokens"];
moe_22_gate -> moe_22_expert_63 [style=dashed, label="tokens"];
moe_22_expert_0 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_1 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_2 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_3 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_4 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_5 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_6 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_7 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_8 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_9 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_10 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_11 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_12 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_13 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_14 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_15 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_16 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_17 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_18 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_19 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_20 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_21 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_22 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_23 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_24 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_25 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_26 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_27 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_28 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_29 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_30 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_31 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_32 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_33 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_34 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_35 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_36 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_37 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_38 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_39 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_40 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_41 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_42 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_43 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_44 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_45 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_46 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_47 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_48 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_49 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_50 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_51 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_52 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_53 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_54 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_55 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_56 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_57 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_58 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_59 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_60 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_61 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_62 -> moe_22_expert_agg [label="hidden=7168"];
moe_22_expert_63 -> moe_22_expert_agg [label="hidden=7168"];

    moe_22_expert_agg -> moe_22_residual [label="hidden=7168"];
    moe_22_residual -> moe_23_mha_q [label="hidden=7168"];

    // MoE Layer 23 connections
    moe_23_mha_q -> moe_23_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_23_mha_k -> moe_23_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_23_mha_v -> moe_23_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_23_mha_attn -> moe_23_mha_out [label="[heads=128, d_k=128]"];
    moe_23_mha_out -> moe_23_gate [label="hidden=7168"];
    moe_23_gate -> moe_23_expert_0 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_1 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_2 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_3 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_4 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_5 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_6 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_7 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_8 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_9 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_10 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_11 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_12 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_13 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_14 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_15 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_16 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_17 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_18 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_19 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_20 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_21 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_22 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_23 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_24 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_25 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_26 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_27 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_28 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_29 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_30 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_31 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_32 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_33 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_34 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_35 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_36 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_37 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_38 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_39 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_40 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_41 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_42 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_43 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_44 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_45 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_46 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_47 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_48 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_49 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_50 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_51 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_52 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_53 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_54 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_55 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_56 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_57 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_58 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_59 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_60 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_61 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_62 [style=dashed, label="tokens"];
moe_23_gate -> moe_23_expert_63 [style=dashed, label="tokens"];
moe_23_expert_0 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_1 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_2 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_3 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_4 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_5 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_6 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_7 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_8 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_9 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_10 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_11 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_12 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_13 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_14 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_15 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_16 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_17 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_18 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_19 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_20 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_21 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_22 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_23 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_24 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_25 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_26 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_27 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_28 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_29 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_30 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_31 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_32 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_33 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_34 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_35 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_36 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_37 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_38 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_39 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_40 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_41 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_42 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_43 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_44 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_45 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_46 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_47 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_48 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_49 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_50 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_51 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_52 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_53 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_54 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_55 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_56 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_57 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_58 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_59 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_60 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_61 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_62 -> moe_23_expert_agg [label="hidden=7168"];
moe_23_expert_63 -> moe_23_expert_agg [label="hidden=7168"];

    moe_23_expert_agg -> moe_23_residual [label="hidden=7168"];
    moe_23_residual -> moe_24_mha_q [label="hidden=7168"];

    // MoE Layer 24 connections
    moe_24_mha_q -> moe_24_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_24_mha_k -> moe_24_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_24_mha_v -> moe_24_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_24_mha_attn -> moe_24_mha_out [label="[heads=128, d_k=128]"];
    moe_24_mha_out -> moe_24_gate [label="hidden=7168"];
    moe_24_gate -> moe_24_expert_0 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_1 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_2 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_3 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_4 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_5 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_6 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_7 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_8 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_9 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_10 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_11 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_12 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_13 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_14 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_15 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_16 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_17 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_18 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_19 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_20 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_21 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_22 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_23 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_24 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_25 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_26 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_27 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_28 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_29 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_30 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_31 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_32 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_33 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_34 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_35 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_36 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_37 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_38 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_39 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_40 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_41 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_42 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_43 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_44 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_45 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_46 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_47 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_48 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_49 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_50 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_51 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_52 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_53 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_54 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_55 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_56 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_57 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_58 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_59 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_60 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_61 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_62 [style=dashed, label="tokens"];
moe_24_gate -> moe_24_expert_63 [style=dashed, label="tokens"];
moe_24_expert_0 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_1 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_2 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_3 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_4 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_5 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_6 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_7 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_8 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_9 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_10 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_11 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_12 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_13 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_14 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_15 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_16 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_17 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_18 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_19 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_20 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_21 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_22 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_23 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_24 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_25 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_26 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_27 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_28 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_29 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_30 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_31 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_32 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_33 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_34 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_35 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_36 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_37 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_38 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_39 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_40 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_41 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_42 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_43 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_44 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_45 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_46 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_47 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_48 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_49 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_50 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_51 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_52 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_53 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_54 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_55 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_56 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_57 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_58 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_59 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_60 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_61 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_62 -> moe_24_expert_agg [label="hidden=7168"];
moe_24_expert_63 -> moe_24_expert_agg [label="hidden=7168"];

    moe_24_expert_agg -> moe_24_residual [label="hidden=7168"];
    moe_24_residual -> moe_25_mha_q [label="hidden=7168"];

    // MoE Layer 25 connections
    moe_25_mha_q -> moe_25_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_25_mha_k -> moe_25_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_25_mha_v -> moe_25_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_25_mha_attn -> moe_25_mha_out [label="[heads=128, d_k=128]"];
    moe_25_mha_out -> moe_25_gate [label="hidden=7168"];
    moe_25_gate -> moe_25_expert_0 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_1 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_2 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_3 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_4 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_5 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_6 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_7 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_8 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_9 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_10 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_11 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_12 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_13 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_14 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_15 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_16 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_17 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_18 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_19 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_20 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_21 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_22 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_23 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_24 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_25 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_26 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_27 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_28 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_29 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_30 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_31 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_32 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_33 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_34 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_35 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_36 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_37 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_38 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_39 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_40 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_41 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_42 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_43 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_44 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_45 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_46 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_47 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_48 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_49 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_50 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_51 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_52 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_53 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_54 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_55 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_56 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_57 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_58 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_59 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_60 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_61 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_62 [style=dashed, label="tokens"];
moe_25_gate -> moe_25_expert_63 [style=dashed, label="tokens"];
moe_25_expert_0 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_1 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_2 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_3 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_4 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_5 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_6 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_7 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_8 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_9 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_10 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_11 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_12 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_13 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_14 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_15 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_16 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_17 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_18 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_19 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_20 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_21 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_22 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_23 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_24 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_25 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_26 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_27 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_28 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_29 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_30 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_31 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_32 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_33 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_34 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_35 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_36 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_37 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_38 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_39 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_40 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_41 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_42 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_43 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_44 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_45 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_46 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_47 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_48 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_49 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_50 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_51 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_52 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_53 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_54 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_55 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_56 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_57 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_58 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_59 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_60 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_61 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_62 -> moe_25_expert_agg [label="hidden=7168"];
moe_25_expert_63 -> moe_25_expert_agg [label="hidden=7168"];

    moe_25_expert_agg -> moe_25_residual [label="hidden=7168"];
    moe_25_residual -> moe_26_mha_q [label="hidden=7168"];

    // MoE Layer 26 connections
    moe_26_mha_q -> moe_26_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_26_mha_k -> moe_26_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_26_mha_v -> moe_26_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_26_mha_attn -> moe_26_mha_out [label="[heads=128, d_k=128]"];
    moe_26_mha_out -> moe_26_gate [label="hidden=7168"];
    moe_26_gate -> moe_26_expert_0 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_1 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_2 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_3 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_4 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_5 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_6 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_7 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_8 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_9 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_10 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_11 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_12 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_13 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_14 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_15 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_16 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_17 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_18 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_19 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_20 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_21 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_22 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_23 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_24 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_25 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_26 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_27 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_28 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_29 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_30 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_31 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_32 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_33 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_34 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_35 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_36 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_37 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_38 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_39 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_40 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_41 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_42 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_43 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_44 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_45 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_46 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_47 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_48 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_49 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_50 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_51 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_52 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_53 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_54 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_55 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_56 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_57 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_58 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_59 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_60 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_61 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_62 [style=dashed, label="tokens"];
moe_26_gate -> moe_26_expert_63 [style=dashed, label="tokens"];
moe_26_expert_0 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_1 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_2 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_3 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_4 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_5 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_6 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_7 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_8 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_9 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_10 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_11 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_12 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_13 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_14 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_15 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_16 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_17 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_18 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_19 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_20 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_21 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_22 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_23 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_24 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_25 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_26 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_27 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_28 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_29 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_30 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_31 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_32 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_33 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_34 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_35 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_36 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_37 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_38 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_39 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_40 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_41 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_42 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_43 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_44 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_45 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_46 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_47 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_48 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_49 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_50 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_51 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_52 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_53 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_54 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_55 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_56 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_57 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_58 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_59 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_60 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_61 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_62 -> moe_26_expert_agg [label="hidden=7168"];
moe_26_expert_63 -> moe_26_expert_agg [label="hidden=7168"];

    moe_26_expert_agg -> moe_26_residual [label="hidden=7168"];
    moe_26_residual -> moe_27_mha_q [label="hidden=7168"];

    // MoE Layer 27 connections
    moe_27_mha_q -> moe_27_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_27_mha_k -> moe_27_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_27_mha_v -> moe_27_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_27_mha_attn -> moe_27_mha_out [label="[heads=128, d_k=128]"];
    moe_27_mha_out -> moe_27_gate [label="hidden=7168"];
    moe_27_gate -> moe_27_expert_0 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_1 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_2 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_3 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_4 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_5 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_6 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_7 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_8 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_9 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_10 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_11 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_12 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_13 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_14 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_15 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_16 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_17 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_18 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_19 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_20 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_21 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_22 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_23 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_24 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_25 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_26 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_27 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_28 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_29 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_30 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_31 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_32 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_33 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_34 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_35 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_36 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_37 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_38 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_39 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_40 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_41 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_42 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_43 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_44 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_45 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_46 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_47 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_48 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_49 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_50 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_51 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_52 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_53 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_54 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_55 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_56 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_57 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_58 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_59 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_60 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_61 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_62 [style=dashed, label="tokens"];
moe_27_gate -> moe_27_expert_63 [style=dashed, label="tokens"];
moe_27_expert_0 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_1 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_2 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_3 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_4 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_5 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_6 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_7 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_8 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_9 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_10 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_11 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_12 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_13 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_14 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_15 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_16 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_17 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_18 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_19 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_20 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_21 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_22 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_23 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_24 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_25 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_26 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_27 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_28 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_29 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_30 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_31 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_32 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_33 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_34 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_35 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_36 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_37 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_38 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_39 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_40 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_41 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_42 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_43 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_44 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_45 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_46 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_47 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_48 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_49 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_50 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_51 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_52 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_53 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_54 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_55 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_56 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_57 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_58 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_59 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_60 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_61 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_62 -> moe_27_expert_agg [label="hidden=7168"];
moe_27_expert_63 -> moe_27_expert_agg [label="hidden=7168"];

    moe_27_expert_agg -> moe_27_residual [label="hidden=7168"];
    moe_27_residual -> moe_28_mha_q [label="hidden=7168"];

    // MoE Layer 28 connections
    moe_28_mha_q -> moe_28_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_28_mha_k -> moe_28_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_28_mha_v -> moe_28_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_28_mha_attn -> moe_28_mha_out [label="[heads=128, d_k=128]"];
    moe_28_mha_out -> moe_28_gate [label="hidden=7168"];
    moe_28_gate -> moe_28_expert_0 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_1 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_2 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_3 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_4 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_5 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_6 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_7 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_8 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_9 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_10 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_11 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_12 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_13 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_14 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_15 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_16 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_17 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_18 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_19 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_20 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_21 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_22 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_23 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_24 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_25 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_26 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_27 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_28 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_29 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_30 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_31 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_32 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_33 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_34 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_35 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_36 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_37 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_38 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_39 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_40 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_41 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_42 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_43 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_44 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_45 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_46 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_47 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_48 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_49 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_50 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_51 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_52 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_53 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_54 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_55 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_56 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_57 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_58 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_59 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_60 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_61 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_62 [style=dashed, label="tokens"];
moe_28_gate -> moe_28_expert_63 [style=dashed, label="tokens"];
moe_28_expert_0 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_1 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_2 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_3 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_4 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_5 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_6 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_7 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_8 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_9 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_10 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_11 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_12 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_13 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_14 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_15 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_16 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_17 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_18 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_19 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_20 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_21 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_22 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_23 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_24 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_25 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_26 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_27 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_28 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_29 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_30 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_31 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_32 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_33 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_34 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_35 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_36 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_37 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_38 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_39 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_40 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_41 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_42 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_43 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_44 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_45 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_46 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_47 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_48 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_49 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_50 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_51 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_52 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_53 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_54 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_55 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_56 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_57 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_58 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_59 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_60 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_61 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_62 -> moe_28_expert_agg [label="hidden=7168"];
moe_28_expert_63 -> moe_28_expert_agg [label="hidden=7168"];

    moe_28_expert_agg -> moe_28_residual [label="hidden=7168"];
    moe_28_residual -> moe_29_mha_q [label="hidden=7168"];

    // MoE Layer 29 connections
    moe_29_mha_q -> moe_29_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_29_mha_k -> moe_29_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_29_mha_v -> moe_29_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_29_mha_attn -> moe_29_mha_out [label="[heads=128, d_k=128]"];
    moe_29_mha_out -> moe_29_gate [label="hidden=7168"];
    moe_29_gate -> moe_29_expert_0 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_1 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_2 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_3 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_4 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_5 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_6 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_7 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_8 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_9 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_10 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_11 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_12 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_13 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_14 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_15 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_16 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_17 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_18 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_19 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_20 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_21 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_22 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_23 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_24 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_25 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_26 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_27 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_28 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_29 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_30 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_31 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_32 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_33 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_34 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_35 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_36 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_37 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_38 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_39 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_40 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_41 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_42 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_43 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_44 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_45 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_46 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_47 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_48 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_49 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_50 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_51 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_52 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_53 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_54 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_55 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_56 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_57 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_58 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_59 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_60 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_61 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_62 [style=dashed, label="tokens"];
moe_29_gate -> moe_29_expert_63 [style=dashed, label="tokens"];
moe_29_expert_0 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_1 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_2 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_3 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_4 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_5 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_6 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_7 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_8 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_9 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_10 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_11 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_12 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_13 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_14 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_15 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_16 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_17 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_18 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_19 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_20 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_21 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_22 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_23 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_24 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_25 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_26 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_27 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_28 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_29 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_30 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_31 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_32 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_33 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_34 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_35 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_36 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_37 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_38 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_39 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_40 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_41 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_42 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_43 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_44 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_45 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_46 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_47 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_48 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_49 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_50 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_51 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_52 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_53 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_54 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_55 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_56 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_57 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_58 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_59 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_60 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_61 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_62 -> moe_29_expert_agg [label="hidden=7168"];
moe_29_expert_63 -> moe_29_expert_agg [label="hidden=7168"];

    moe_29_expert_agg -> moe_29_residual [label="hidden=7168"];
    moe_29_residual -> moe_30_mha_q [label="hidden=7168"];

    // MoE Layer 30 connections
    moe_30_mha_q -> moe_30_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_30_mha_k -> moe_30_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_30_mha_v -> moe_30_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_30_mha_attn -> moe_30_mha_out [label="[heads=128, d_k=128]"];
    moe_30_mha_out -> moe_30_gate [label="hidden=7168"];
    moe_30_gate -> moe_30_expert_0 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_1 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_2 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_3 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_4 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_5 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_6 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_7 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_8 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_9 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_10 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_11 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_12 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_13 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_14 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_15 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_16 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_17 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_18 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_19 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_20 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_21 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_22 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_23 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_24 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_25 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_26 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_27 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_28 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_29 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_30 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_31 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_32 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_33 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_34 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_35 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_36 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_37 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_38 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_39 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_40 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_41 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_42 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_43 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_44 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_45 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_46 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_47 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_48 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_49 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_50 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_51 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_52 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_53 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_54 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_55 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_56 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_57 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_58 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_59 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_60 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_61 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_62 [style=dashed, label="tokens"];
moe_30_gate -> moe_30_expert_63 [style=dashed, label="tokens"];
moe_30_expert_0 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_1 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_2 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_3 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_4 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_5 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_6 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_7 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_8 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_9 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_10 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_11 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_12 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_13 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_14 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_15 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_16 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_17 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_18 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_19 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_20 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_21 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_22 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_23 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_24 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_25 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_26 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_27 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_28 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_29 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_30 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_31 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_32 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_33 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_34 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_35 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_36 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_37 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_38 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_39 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_40 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_41 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_42 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_43 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_44 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_45 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_46 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_47 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_48 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_49 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_50 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_51 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_52 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_53 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_54 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_55 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_56 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_57 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_58 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_59 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_60 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_61 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_62 -> moe_30_expert_agg [label="hidden=7168"];
moe_30_expert_63 -> moe_30_expert_agg [label="hidden=7168"];

    moe_30_expert_agg -> moe_30_residual [label="hidden=7168"];
    moe_30_residual -> moe_31_mha_q [label="hidden=7168"];

    // MoE Layer 31 connections
    moe_31_mha_q -> moe_31_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_31_mha_k -> moe_31_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_31_mha_v -> moe_31_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_31_mha_attn -> moe_31_mha_out [label="[heads=128, d_k=128]"];
    moe_31_mha_out -> moe_31_gate [label="hidden=7168"];
    moe_31_gate -> moe_31_expert_0 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_1 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_2 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_3 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_4 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_5 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_6 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_7 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_8 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_9 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_10 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_11 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_12 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_13 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_14 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_15 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_16 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_17 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_18 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_19 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_20 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_21 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_22 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_23 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_24 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_25 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_26 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_27 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_28 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_29 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_30 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_31 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_32 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_33 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_34 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_35 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_36 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_37 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_38 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_39 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_40 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_41 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_42 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_43 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_44 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_45 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_46 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_47 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_48 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_49 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_50 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_51 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_52 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_53 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_54 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_55 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_56 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_57 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_58 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_59 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_60 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_61 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_62 [style=dashed, label="tokens"];
moe_31_gate -> moe_31_expert_63 [style=dashed, label="tokens"];
moe_31_expert_0 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_1 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_2 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_3 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_4 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_5 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_6 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_7 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_8 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_9 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_10 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_11 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_12 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_13 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_14 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_15 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_16 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_17 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_18 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_19 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_20 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_21 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_22 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_23 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_24 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_25 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_26 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_27 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_28 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_29 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_30 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_31 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_32 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_33 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_34 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_35 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_36 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_37 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_38 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_39 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_40 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_41 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_42 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_43 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_44 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_45 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_46 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_47 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_48 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_49 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_50 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_51 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_52 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_53 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_54 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_55 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_56 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_57 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_58 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_59 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_60 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_61 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_62 -> moe_31_expert_agg [label="hidden=7168"];
moe_31_expert_63 -> moe_31_expert_agg [label="hidden=7168"];

    moe_31_expert_agg -> moe_31_residual [label="hidden=7168"];
    moe_31_residual -> moe_32_mha_q [label="hidden=7168"];

    // MoE Layer 32 connections
    moe_32_mha_q -> moe_32_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_32_mha_k -> moe_32_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_32_mha_v -> moe_32_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_32_mha_attn -> moe_32_mha_out [label="[heads=128, d_k=128]"];
    moe_32_mha_out -> moe_32_gate [label="hidden=7168"];
    moe_32_gate -> moe_32_expert_0 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_1 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_2 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_3 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_4 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_5 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_6 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_7 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_8 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_9 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_10 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_11 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_12 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_13 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_14 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_15 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_16 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_17 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_18 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_19 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_20 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_21 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_22 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_23 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_24 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_25 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_26 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_27 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_28 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_29 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_30 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_31 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_32 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_33 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_34 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_35 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_36 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_37 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_38 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_39 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_40 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_41 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_42 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_43 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_44 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_45 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_46 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_47 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_48 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_49 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_50 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_51 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_52 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_53 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_54 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_55 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_56 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_57 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_58 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_59 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_60 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_61 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_62 [style=dashed, label="tokens"];
moe_32_gate -> moe_32_expert_63 [style=dashed, label="tokens"];
moe_32_expert_0 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_1 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_2 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_3 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_4 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_5 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_6 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_7 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_8 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_9 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_10 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_11 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_12 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_13 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_14 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_15 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_16 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_17 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_18 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_19 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_20 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_21 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_22 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_23 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_24 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_25 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_26 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_27 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_28 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_29 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_30 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_31 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_32 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_33 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_34 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_35 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_36 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_37 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_38 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_39 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_40 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_41 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_42 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_43 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_44 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_45 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_46 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_47 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_48 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_49 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_50 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_51 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_52 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_53 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_54 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_55 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_56 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_57 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_58 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_59 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_60 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_61 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_62 -> moe_32_expert_agg [label="hidden=7168"];
moe_32_expert_63 -> moe_32_expert_agg [label="hidden=7168"];

    moe_32_expert_agg -> moe_32_residual [label="hidden=7168"];
    moe_32_residual -> moe_33_mha_q [label="hidden=7168"];

    // MoE Layer 33 connections
    moe_33_mha_q -> moe_33_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_33_mha_k -> moe_33_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_33_mha_v -> moe_33_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_33_mha_attn -> moe_33_mha_out [label="[heads=128, d_k=128]"];
    moe_33_mha_out -> moe_33_gate [label="hidden=7168"];
    moe_33_gate -> moe_33_expert_0 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_1 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_2 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_3 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_4 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_5 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_6 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_7 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_8 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_9 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_10 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_11 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_12 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_13 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_14 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_15 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_16 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_17 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_18 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_19 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_20 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_21 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_22 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_23 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_24 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_25 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_26 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_27 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_28 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_29 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_30 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_31 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_32 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_33 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_34 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_35 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_36 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_37 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_38 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_39 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_40 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_41 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_42 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_43 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_44 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_45 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_46 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_47 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_48 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_49 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_50 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_51 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_52 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_53 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_54 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_55 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_56 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_57 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_58 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_59 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_60 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_61 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_62 [style=dashed, label="tokens"];
moe_33_gate -> moe_33_expert_63 [style=dashed, label="tokens"];
moe_33_expert_0 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_1 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_2 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_3 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_4 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_5 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_6 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_7 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_8 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_9 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_10 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_11 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_12 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_13 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_14 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_15 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_16 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_17 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_18 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_19 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_20 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_21 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_22 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_23 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_24 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_25 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_26 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_27 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_28 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_29 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_30 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_31 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_32 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_33 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_34 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_35 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_36 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_37 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_38 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_39 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_40 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_41 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_42 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_43 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_44 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_45 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_46 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_47 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_48 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_49 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_50 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_51 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_52 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_53 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_54 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_55 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_56 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_57 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_58 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_59 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_60 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_61 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_62 -> moe_33_expert_agg [label="hidden=7168"];
moe_33_expert_63 -> moe_33_expert_agg [label="hidden=7168"];

    moe_33_expert_agg -> moe_33_residual [label="hidden=7168"];
    moe_33_residual -> moe_34_mha_q [label="hidden=7168"];

    // MoE Layer 34 connections
    moe_34_mha_q -> moe_34_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_34_mha_k -> moe_34_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_34_mha_v -> moe_34_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_34_mha_attn -> moe_34_mha_out [label="[heads=128, d_k=128]"];
    moe_34_mha_out -> moe_34_gate [label="hidden=7168"];
    moe_34_gate -> moe_34_expert_0 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_1 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_2 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_3 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_4 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_5 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_6 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_7 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_8 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_9 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_10 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_11 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_12 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_13 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_14 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_15 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_16 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_17 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_18 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_19 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_20 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_21 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_22 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_23 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_24 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_25 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_26 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_27 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_28 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_29 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_30 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_31 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_32 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_33 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_34 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_35 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_36 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_37 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_38 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_39 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_40 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_41 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_42 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_43 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_44 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_45 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_46 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_47 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_48 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_49 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_50 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_51 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_52 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_53 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_54 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_55 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_56 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_57 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_58 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_59 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_60 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_61 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_62 [style=dashed, label="tokens"];
moe_34_gate -> moe_34_expert_63 [style=dashed, label="tokens"];
moe_34_expert_0 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_1 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_2 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_3 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_4 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_5 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_6 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_7 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_8 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_9 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_10 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_11 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_12 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_13 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_14 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_15 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_16 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_17 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_18 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_19 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_20 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_21 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_22 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_23 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_24 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_25 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_26 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_27 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_28 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_29 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_30 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_31 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_32 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_33 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_34 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_35 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_36 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_37 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_38 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_39 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_40 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_41 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_42 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_43 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_44 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_45 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_46 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_47 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_48 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_49 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_50 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_51 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_52 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_53 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_54 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_55 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_56 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_57 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_58 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_59 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_60 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_61 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_62 -> moe_34_expert_agg [label="hidden=7168"];
moe_34_expert_63 -> moe_34_expert_agg [label="hidden=7168"];

    moe_34_expert_agg -> moe_34_residual [label="hidden=7168"];
    moe_34_residual -> moe_35_mha_q [label="hidden=7168"];

    // MoE Layer 35 connections
    moe_35_mha_q -> moe_35_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_35_mha_k -> moe_35_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_35_mha_v -> moe_35_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_35_mha_attn -> moe_35_mha_out [label="[heads=128, d_k=128]"];
    moe_35_mha_out -> moe_35_gate [label="hidden=7168"];
    moe_35_gate -> moe_35_expert_0 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_1 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_2 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_3 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_4 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_5 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_6 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_7 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_8 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_9 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_10 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_11 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_12 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_13 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_14 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_15 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_16 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_17 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_18 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_19 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_20 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_21 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_22 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_23 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_24 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_25 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_26 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_27 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_28 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_29 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_30 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_31 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_32 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_33 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_34 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_35 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_36 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_37 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_38 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_39 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_40 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_41 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_42 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_43 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_44 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_45 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_46 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_47 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_48 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_49 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_50 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_51 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_52 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_53 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_54 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_55 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_56 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_57 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_58 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_59 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_60 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_61 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_62 [style=dashed, label="tokens"];
moe_35_gate -> moe_35_expert_63 [style=dashed, label="tokens"];
moe_35_expert_0 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_1 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_2 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_3 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_4 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_5 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_6 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_7 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_8 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_9 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_10 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_11 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_12 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_13 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_14 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_15 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_16 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_17 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_18 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_19 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_20 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_21 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_22 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_23 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_24 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_25 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_26 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_27 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_28 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_29 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_30 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_31 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_32 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_33 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_34 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_35 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_36 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_37 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_38 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_39 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_40 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_41 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_42 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_43 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_44 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_45 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_46 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_47 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_48 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_49 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_50 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_51 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_52 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_53 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_54 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_55 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_56 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_57 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_58 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_59 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_60 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_61 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_62 -> moe_35_expert_agg [label="hidden=7168"];
moe_35_expert_63 -> moe_35_expert_agg [label="hidden=7168"];

    moe_35_expert_agg -> moe_35_residual [label="hidden=7168"];
    moe_35_residual -> moe_36_mha_q [label="hidden=7168"];

    // MoE Layer 36 connections
    moe_36_mha_q -> moe_36_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_36_mha_k -> moe_36_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_36_mha_v -> moe_36_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_36_mha_attn -> moe_36_mha_out [label="[heads=128, d_k=128]"];
    moe_36_mha_out -> moe_36_gate [label="hidden=7168"];
    moe_36_gate -> moe_36_expert_0 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_1 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_2 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_3 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_4 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_5 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_6 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_7 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_8 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_9 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_10 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_11 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_12 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_13 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_14 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_15 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_16 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_17 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_18 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_19 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_20 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_21 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_22 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_23 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_24 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_25 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_26 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_27 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_28 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_29 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_30 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_31 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_32 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_33 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_34 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_35 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_36 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_37 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_38 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_39 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_40 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_41 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_42 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_43 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_44 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_45 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_46 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_47 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_48 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_49 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_50 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_51 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_52 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_53 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_54 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_55 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_56 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_57 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_58 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_59 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_60 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_61 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_62 [style=dashed, label="tokens"];
moe_36_gate -> moe_36_expert_63 [style=dashed, label="tokens"];
moe_36_expert_0 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_1 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_2 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_3 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_4 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_5 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_6 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_7 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_8 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_9 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_10 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_11 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_12 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_13 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_14 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_15 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_16 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_17 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_18 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_19 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_20 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_21 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_22 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_23 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_24 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_25 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_26 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_27 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_28 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_29 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_30 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_31 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_32 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_33 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_34 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_35 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_36 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_37 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_38 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_39 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_40 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_41 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_42 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_43 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_44 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_45 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_46 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_47 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_48 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_49 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_50 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_51 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_52 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_53 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_54 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_55 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_56 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_57 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_58 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_59 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_60 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_61 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_62 -> moe_36_expert_agg [label="hidden=7168"];
moe_36_expert_63 -> moe_36_expert_agg [label="hidden=7168"];

    moe_36_expert_agg -> moe_36_residual [label="hidden=7168"];
    moe_36_residual -> moe_37_mha_q [label="hidden=7168"];

    // MoE Layer 37 connections
    moe_37_mha_q -> moe_37_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_37_mha_k -> moe_37_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_37_mha_v -> moe_37_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_37_mha_attn -> moe_37_mha_out [label="[heads=128, d_k=128]"];
    moe_37_mha_out -> moe_37_gate [label="hidden=7168"];
    moe_37_gate -> moe_37_expert_0 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_1 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_2 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_3 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_4 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_5 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_6 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_7 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_8 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_9 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_10 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_11 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_12 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_13 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_14 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_15 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_16 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_17 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_18 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_19 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_20 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_21 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_22 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_23 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_24 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_25 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_26 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_27 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_28 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_29 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_30 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_31 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_32 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_33 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_34 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_35 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_36 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_37 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_38 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_39 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_40 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_41 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_42 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_43 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_44 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_45 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_46 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_47 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_48 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_49 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_50 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_51 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_52 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_53 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_54 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_55 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_56 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_57 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_58 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_59 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_60 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_61 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_62 [style=dashed, label="tokens"];
moe_37_gate -> moe_37_expert_63 [style=dashed, label="tokens"];
moe_37_expert_0 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_1 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_2 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_3 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_4 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_5 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_6 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_7 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_8 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_9 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_10 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_11 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_12 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_13 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_14 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_15 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_16 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_17 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_18 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_19 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_20 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_21 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_22 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_23 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_24 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_25 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_26 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_27 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_28 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_29 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_30 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_31 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_32 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_33 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_34 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_35 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_36 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_37 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_38 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_39 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_40 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_41 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_42 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_43 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_44 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_45 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_46 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_47 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_48 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_49 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_50 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_51 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_52 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_53 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_54 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_55 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_56 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_57 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_58 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_59 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_60 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_61 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_62 -> moe_37_expert_agg [label="hidden=7168"];
moe_37_expert_63 -> moe_37_expert_agg [label="hidden=7168"];

    moe_37_expert_agg -> moe_37_residual [label="hidden=7168"];
    moe_37_residual -> moe_38_mha_q [label="hidden=7168"];

    // MoE Layer 38 connections
    moe_38_mha_q -> moe_38_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_38_mha_k -> moe_38_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_38_mha_v -> moe_38_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_38_mha_attn -> moe_38_mha_out [label="[heads=128, d_k=128]"];
    moe_38_mha_out -> moe_38_gate [label="hidden=7168"];
    moe_38_gate -> moe_38_expert_0 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_1 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_2 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_3 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_4 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_5 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_6 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_7 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_8 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_9 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_10 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_11 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_12 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_13 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_14 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_15 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_16 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_17 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_18 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_19 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_20 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_21 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_22 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_23 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_24 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_25 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_26 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_27 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_28 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_29 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_30 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_31 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_32 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_33 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_34 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_35 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_36 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_37 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_38 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_39 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_40 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_41 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_42 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_43 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_44 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_45 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_46 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_47 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_48 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_49 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_50 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_51 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_52 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_53 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_54 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_55 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_56 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_57 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_58 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_59 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_60 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_61 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_62 [style=dashed, label="tokens"];
moe_38_gate -> moe_38_expert_63 [style=dashed, label="tokens"];
moe_38_expert_0 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_1 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_2 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_3 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_4 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_5 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_6 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_7 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_8 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_9 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_10 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_11 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_12 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_13 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_14 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_15 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_16 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_17 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_18 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_19 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_20 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_21 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_22 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_23 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_24 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_25 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_26 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_27 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_28 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_29 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_30 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_31 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_32 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_33 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_34 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_35 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_36 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_37 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_38 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_39 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_40 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_41 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_42 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_43 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_44 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_45 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_46 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_47 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_48 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_49 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_50 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_51 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_52 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_53 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_54 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_55 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_56 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_57 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_58 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_59 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_60 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_61 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_62 -> moe_38_expert_agg [label="hidden=7168"];
moe_38_expert_63 -> moe_38_expert_agg [label="hidden=7168"];

    moe_38_expert_agg -> moe_38_residual [label="hidden=7168"];
    moe_38_residual -> moe_39_mha_q [label="hidden=7168"];

    // MoE Layer 39 connections
    moe_39_mha_q -> moe_39_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_39_mha_k -> moe_39_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_39_mha_v -> moe_39_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_39_mha_attn -> moe_39_mha_out [label="[heads=128, d_k=128]"];
    moe_39_mha_out -> moe_39_gate [label="hidden=7168"];
    moe_39_gate -> moe_39_expert_0 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_1 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_2 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_3 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_4 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_5 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_6 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_7 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_8 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_9 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_10 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_11 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_12 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_13 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_14 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_15 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_16 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_17 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_18 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_19 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_20 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_21 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_22 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_23 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_24 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_25 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_26 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_27 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_28 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_29 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_30 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_31 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_32 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_33 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_34 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_35 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_36 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_37 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_38 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_39 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_40 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_41 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_42 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_43 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_44 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_45 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_46 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_47 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_48 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_49 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_50 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_51 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_52 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_53 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_54 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_55 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_56 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_57 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_58 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_59 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_60 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_61 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_62 [style=dashed, label="tokens"];
moe_39_gate -> moe_39_expert_63 [style=dashed, label="tokens"];
moe_39_expert_0 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_1 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_2 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_3 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_4 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_5 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_6 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_7 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_8 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_9 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_10 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_11 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_12 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_13 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_14 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_15 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_16 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_17 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_18 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_19 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_20 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_21 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_22 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_23 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_24 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_25 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_26 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_27 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_28 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_29 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_30 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_31 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_32 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_33 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_34 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_35 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_36 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_37 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_38 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_39 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_40 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_41 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_42 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_43 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_44 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_45 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_46 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_47 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_48 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_49 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_50 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_51 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_52 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_53 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_54 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_55 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_56 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_57 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_58 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_59 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_60 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_61 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_62 -> moe_39_expert_agg [label="hidden=7168"];
moe_39_expert_63 -> moe_39_expert_agg [label="hidden=7168"];

    moe_39_expert_agg -> moe_39_residual [label="hidden=7168"];
    moe_39_residual -> moe_40_mha_q [label="hidden=7168"];

    // MoE Layer 40 connections
    moe_40_mha_q -> moe_40_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_40_mha_k -> moe_40_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_40_mha_v -> moe_40_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_40_mha_attn -> moe_40_mha_out [label="[heads=128, d_k=128]"];
    moe_40_mha_out -> moe_40_gate [label="hidden=7168"];
    moe_40_gate -> moe_40_expert_0 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_1 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_2 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_3 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_4 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_5 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_6 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_7 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_8 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_9 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_10 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_11 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_12 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_13 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_14 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_15 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_16 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_17 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_18 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_19 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_20 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_21 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_22 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_23 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_24 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_25 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_26 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_27 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_28 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_29 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_30 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_31 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_32 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_33 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_34 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_35 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_36 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_37 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_38 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_39 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_40 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_41 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_42 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_43 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_44 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_45 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_46 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_47 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_48 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_49 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_50 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_51 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_52 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_53 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_54 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_55 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_56 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_57 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_58 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_59 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_60 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_61 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_62 [style=dashed, label="tokens"];
moe_40_gate -> moe_40_expert_63 [style=dashed, label="tokens"];
moe_40_expert_0 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_1 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_2 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_3 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_4 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_5 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_6 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_7 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_8 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_9 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_10 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_11 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_12 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_13 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_14 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_15 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_16 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_17 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_18 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_19 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_20 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_21 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_22 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_23 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_24 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_25 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_26 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_27 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_28 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_29 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_30 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_31 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_32 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_33 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_34 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_35 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_36 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_37 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_38 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_39 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_40 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_41 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_42 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_43 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_44 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_45 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_46 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_47 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_48 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_49 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_50 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_51 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_52 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_53 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_54 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_55 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_56 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_57 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_58 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_59 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_60 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_61 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_62 -> moe_40_expert_agg [label="hidden=7168"];
moe_40_expert_63 -> moe_40_expert_agg [label="hidden=7168"];

    moe_40_expert_agg -> moe_40_residual [label="hidden=7168"];
    moe_40_residual -> moe_41_mha_q [label="hidden=7168"];

    // MoE Layer 41 connections
    moe_41_mha_q -> moe_41_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_41_mha_k -> moe_41_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_41_mha_v -> moe_41_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_41_mha_attn -> moe_41_mha_out [label="[heads=128, d_k=128]"];
    moe_41_mha_out -> moe_41_gate [label="hidden=7168"];
    moe_41_gate -> moe_41_expert_0 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_1 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_2 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_3 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_4 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_5 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_6 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_7 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_8 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_9 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_10 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_11 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_12 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_13 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_14 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_15 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_16 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_17 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_18 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_19 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_20 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_21 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_22 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_23 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_24 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_25 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_26 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_27 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_28 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_29 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_30 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_31 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_32 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_33 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_34 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_35 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_36 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_37 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_38 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_39 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_40 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_41 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_42 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_43 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_44 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_45 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_46 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_47 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_48 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_49 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_50 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_51 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_52 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_53 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_54 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_55 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_56 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_57 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_58 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_59 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_60 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_61 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_62 [style=dashed, label="tokens"];
moe_41_gate -> moe_41_expert_63 [style=dashed, label="tokens"];
moe_41_expert_0 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_1 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_2 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_3 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_4 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_5 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_6 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_7 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_8 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_9 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_10 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_11 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_12 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_13 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_14 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_15 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_16 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_17 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_18 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_19 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_20 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_21 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_22 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_23 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_24 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_25 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_26 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_27 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_28 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_29 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_30 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_31 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_32 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_33 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_34 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_35 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_36 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_37 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_38 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_39 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_40 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_41 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_42 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_43 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_44 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_45 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_46 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_47 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_48 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_49 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_50 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_51 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_52 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_53 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_54 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_55 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_56 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_57 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_58 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_59 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_60 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_61 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_62 -> moe_41_expert_agg [label="hidden=7168"];
moe_41_expert_63 -> moe_41_expert_agg [label="hidden=7168"];

    moe_41_expert_agg -> moe_41_residual [label="hidden=7168"];
    moe_41_residual -> moe_42_mha_q [label="hidden=7168"];

    // MoE Layer 42 connections
    moe_42_mha_q -> moe_42_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_42_mha_k -> moe_42_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_42_mha_v -> moe_42_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_42_mha_attn -> moe_42_mha_out [label="[heads=128, d_k=128]"];
    moe_42_mha_out -> moe_42_gate [label="hidden=7168"];
    moe_42_gate -> moe_42_expert_0 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_1 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_2 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_3 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_4 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_5 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_6 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_7 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_8 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_9 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_10 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_11 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_12 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_13 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_14 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_15 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_16 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_17 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_18 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_19 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_20 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_21 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_22 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_23 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_24 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_25 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_26 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_27 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_28 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_29 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_30 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_31 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_32 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_33 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_34 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_35 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_36 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_37 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_38 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_39 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_40 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_41 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_42 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_43 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_44 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_45 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_46 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_47 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_48 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_49 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_50 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_51 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_52 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_53 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_54 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_55 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_56 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_57 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_58 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_59 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_60 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_61 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_62 [style=dashed, label="tokens"];
moe_42_gate -> moe_42_expert_63 [style=dashed, label="tokens"];
moe_42_expert_0 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_1 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_2 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_3 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_4 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_5 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_6 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_7 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_8 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_9 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_10 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_11 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_12 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_13 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_14 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_15 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_16 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_17 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_18 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_19 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_20 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_21 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_22 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_23 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_24 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_25 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_26 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_27 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_28 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_29 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_30 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_31 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_32 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_33 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_34 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_35 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_36 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_37 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_38 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_39 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_40 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_41 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_42 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_43 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_44 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_45 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_46 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_47 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_48 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_49 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_50 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_51 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_52 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_53 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_54 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_55 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_56 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_57 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_58 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_59 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_60 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_61 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_62 -> moe_42_expert_agg [label="hidden=7168"];
moe_42_expert_63 -> moe_42_expert_agg [label="hidden=7168"];

    moe_42_expert_agg -> moe_42_residual [label="hidden=7168"];
    moe_42_residual -> moe_43_mha_q [label="hidden=7168"];

    // MoE Layer 43 connections
    moe_43_mha_q -> moe_43_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_43_mha_k -> moe_43_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_43_mha_v -> moe_43_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_43_mha_attn -> moe_43_mha_out [label="[heads=128, d_k=128]"];
    moe_43_mha_out -> moe_43_gate [label="hidden=7168"];
    moe_43_gate -> moe_43_expert_0 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_1 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_2 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_3 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_4 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_5 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_6 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_7 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_8 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_9 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_10 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_11 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_12 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_13 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_14 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_15 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_16 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_17 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_18 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_19 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_20 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_21 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_22 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_23 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_24 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_25 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_26 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_27 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_28 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_29 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_30 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_31 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_32 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_33 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_34 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_35 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_36 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_37 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_38 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_39 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_40 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_41 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_42 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_43 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_44 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_45 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_46 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_47 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_48 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_49 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_50 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_51 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_52 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_53 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_54 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_55 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_56 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_57 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_58 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_59 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_60 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_61 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_62 [style=dashed, label="tokens"];
moe_43_gate -> moe_43_expert_63 [style=dashed, label="tokens"];
moe_43_expert_0 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_1 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_2 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_3 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_4 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_5 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_6 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_7 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_8 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_9 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_10 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_11 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_12 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_13 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_14 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_15 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_16 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_17 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_18 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_19 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_20 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_21 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_22 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_23 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_24 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_25 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_26 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_27 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_28 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_29 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_30 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_31 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_32 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_33 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_34 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_35 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_36 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_37 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_38 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_39 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_40 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_41 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_42 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_43 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_44 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_45 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_46 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_47 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_48 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_49 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_50 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_51 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_52 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_53 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_54 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_55 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_56 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_57 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_58 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_59 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_60 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_61 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_62 -> moe_43_expert_agg [label="hidden=7168"];
moe_43_expert_63 -> moe_43_expert_agg [label="hidden=7168"];

    moe_43_expert_agg -> moe_43_residual [label="hidden=7168"];
    moe_43_residual -> moe_44_mha_q [label="hidden=7168"];

    // MoE Layer 44 connections
    moe_44_mha_q -> moe_44_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_44_mha_k -> moe_44_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_44_mha_v -> moe_44_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_44_mha_attn -> moe_44_mha_out [label="[heads=128, d_k=128]"];
    moe_44_mha_out -> moe_44_gate [label="hidden=7168"];
    moe_44_gate -> moe_44_expert_0 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_1 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_2 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_3 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_4 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_5 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_6 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_7 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_8 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_9 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_10 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_11 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_12 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_13 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_14 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_15 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_16 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_17 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_18 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_19 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_20 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_21 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_22 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_23 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_24 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_25 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_26 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_27 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_28 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_29 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_30 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_31 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_32 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_33 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_34 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_35 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_36 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_37 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_38 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_39 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_40 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_41 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_42 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_43 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_44 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_45 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_46 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_47 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_48 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_49 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_50 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_51 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_52 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_53 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_54 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_55 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_56 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_57 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_58 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_59 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_60 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_61 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_62 [style=dashed, label="tokens"];
moe_44_gate -> moe_44_expert_63 [style=dashed, label="tokens"];
moe_44_expert_0 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_1 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_2 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_3 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_4 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_5 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_6 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_7 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_8 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_9 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_10 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_11 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_12 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_13 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_14 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_15 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_16 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_17 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_18 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_19 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_20 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_21 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_22 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_23 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_24 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_25 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_26 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_27 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_28 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_29 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_30 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_31 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_32 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_33 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_34 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_35 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_36 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_37 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_38 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_39 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_40 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_41 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_42 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_43 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_44 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_45 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_46 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_47 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_48 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_49 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_50 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_51 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_52 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_53 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_54 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_55 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_56 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_57 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_58 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_59 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_60 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_61 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_62 -> moe_44_expert_agg [label="hidden=7168"];
moe_44_expert_63 -> moe_44_expert_agg [label="hidden=7168"];

    moe_44_expert_agg -> moe_44_residual [label="hidden=7168"];
    moe_44_residual -> moe_45_mha_q [label="hidden=7168"];

    // MoE Layer 45 connections
    moe_45_mha_q -> moe_45_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_45_mha_k -> moe_45_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_45_mha_v -> moe_45_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_45_mha_attn -> moe_45_mha_out [label="[heads=128, d_k=128]"];
    moe_45_mha_out -> moe_45_gate [label="hidden=7168"];
    moe_45_gate -> moe_45_expert_0 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_1 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_2 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_3 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_4 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_5 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_6 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_7 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_8 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_9 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_10 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_11 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_12 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_13 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_14 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_15 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_16 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_17 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_18 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_19 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_20 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_21 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_22 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_23 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_24 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_25 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_26 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_27 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_28 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_29 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_30 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_31 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_32 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_33 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_34 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_35 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_36 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_37 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_38 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_39 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_40 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_41 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_42 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_43 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_44 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_45 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_46 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_47 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_48 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_49 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_50 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_51 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_52 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_53 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_54 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_55 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_56 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_57 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_58 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_59 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_60 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_61 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_62 [style=dashed, label="tokens"];
moe_45_gate -> moe_45_expert_63 [style=dashed, label="tokens"];
moe_45_expert_0 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_1 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_2 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_3 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_4 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_5 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_6 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_7 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_8 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_9 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_10 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_11 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_12 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_13 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_14 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_15 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_16 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_17 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_18 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_19 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_20 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_21 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_22 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_23 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_24 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_25 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_26 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_27 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_28 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_29 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_30 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_31 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_32 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_33 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_34 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_35 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_36 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_37 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_38 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_39 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_40 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_41 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_42 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_43 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_44 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_45 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_46 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_47 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_48 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_49 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_50 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_51 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_52 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_53 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_54 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_55 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_56 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_57 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_58 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_59 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_60 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_61 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_62 -> moe_45_expert_agg [label="hidden=7168"];
moe_45_expert_63 -> moe_45_expert_agg [label="hidden=7168"];

    moe_45_expert_agg -> moe_45_residual [label="hidden=7168"];
    moe_45_residual -> moe_46_mha_q [label="hidden=7168"];

    // MoE Layer 46 connections
    moe_46_mha_q -> moe_46_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_46_mha_k -> moe_46_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_46_mha_v -> moe_46_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_46_mha_attn -> moe_46_mha_out [label="[heads=128, d_k=128]"];
    moe_46_mha_out -> moe_46_gate [label="hidden=7168"];
    moe_46_gate -> moe_46_expert_0 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_1 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_2 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_3 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_4 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_5 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_6 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_7 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_8 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_9 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_10 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_11 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_12 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_13 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_14 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_15 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_16 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_17 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_18 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_19 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_20 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_21 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_22 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_23 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_24 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_25 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_26 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_27 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_28 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_29 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_30 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_31 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_32 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_33 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_34 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_35 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_36 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_37 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_38 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_39 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_40 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_41 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_42 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_43 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_44 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_45 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_46 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_47 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_48 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_49 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_50 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_51 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_52 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_53 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_54 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_55 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_56 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_57 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_58 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_59 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_60 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_61 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_62 [style=dashed, label="tokens"];
moe_46_gate -> moe_46_expert_63 [style=dashed, label="tokens"];
moe_46_expert_0 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_1 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_2 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_3 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_4 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_5 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_6 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_7 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_8 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_9 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_10 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_11 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_12 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_13 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_14 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_15 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_16 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_17 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_18 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_19 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_20 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_21 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_22 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_23 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_24 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_25 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_26 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_27 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_28 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_29 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_30 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_31 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_32 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_33 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_34 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_35 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_36 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_37 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_38 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_39 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_40 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_41 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_42 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_43 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_44 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_45 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_46 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_47 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_48 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_49 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_50 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_51 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_52 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_53 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_54 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_55 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_56 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_57 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_58 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_59 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_60 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_61 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_62 -> moe_46_expert_agg [label="hidden=7168"];
moe_46_expert_63 -> moe_46_expert_agg [label="hidden=7168"];

    moe_46_expert_agg -> moe_46_residual [label="hidden=7168"];
    moe_46_residual -> moe_47_mha_q [label="hidden=7168"];

    // MoE Layer 47 connections
    moe_47_mha_q -> moe_47_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_47_mha_k -> moe_47_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_47_mha_v -> moe_47_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_47_mha_attn -> moe_47_mha_out [label="[heads=128, d_k=128]"];
    moe_47_mha_out -> moe_47_gate [label="hidden=7168"];
    moe_47_gate -> moe_47_expert_0 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_1 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_2 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_3 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_4 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_5 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_6 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_7 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_8 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_9 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_10 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_11 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_12 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_13 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_14 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_15 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_16 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_17 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_18 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_19 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_20 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_21 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_22 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_23 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_24 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_25 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_26 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_27 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_28 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_29 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_30 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_31 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_32 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_33 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_34 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_35 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_36 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_37 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_38 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_39 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_40 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_41 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_42 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_43 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_44 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_45 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_46 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_47 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_48 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_49 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_50 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_51 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_52 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_53 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_54 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_55 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_56 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_57 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_58 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_59 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_60 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_61 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_62 [style=dashed, label="tokens"];
moe_47_gate -> moe_47_expert_63 [style=dashed, label="tokens"];
moe_47_expert_0 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_1 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_2 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_3 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_4 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_5 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_6 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_7 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_8 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_9 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_10 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_11 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_12 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_13 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_14 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_15 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_16 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_17 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_18 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_19 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_20 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_21 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_22 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_23 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_24 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_25 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_26 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_27 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_28 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_29 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_30 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_31 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_32 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_33 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_34 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_35 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_36 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_37 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_38 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_39 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_40 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_41 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_42 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_43 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_44 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_45 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_46 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_47 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_48 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_49 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_50 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_51 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_52 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_53 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_54 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_55 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_56 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_57 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_58 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_59 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_60 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_61 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_62 -> moe_47_expert_agg [label="hidden=7168"];
moe_47_expert_63 -> moe_47_expert_agg [label="hidden=7168"];

    moe_47_expert_agg -> moe_47_residual [label="hidden=7168"];
    moe_47_residual -> moe_48_mha_q [label="hidden=7168"];

    // MoE Layer 48 connections
    moe_48_mha_q -> moe_48_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_48_mha_k -> moe_48_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_48_mha_v -> moe_48_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_48_mha_attn -> moe_48_mha_out [label="[heads=128, d_k=128]"];
    moe_48_mha_out -> moe_48_gate [label="hidden=7168"];
    moe_48_gate -> moe_48_expert_0 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_1 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_2 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_3 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_4 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_5 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_6 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_7 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_8 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_9 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_10 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_11 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_12 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_13 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_14 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_15 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_16 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_17 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_18 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_19 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_20 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_21 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_22 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_23 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_24 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_25 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_26 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_27 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_28 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_29 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_30 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_31 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_32 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_33 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_34 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_35 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_36 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_37 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_38 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_39 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_40 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_41 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_42 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_43 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_44 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_45 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_46 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_47 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_48 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_49 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_50 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_51 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_52 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_53 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_54 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_55 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_56 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_57 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_58 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_59 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_60 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_61 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_62 [style=dashed, label="tokens"];
moe_48_gate -> moe_48_expert_63 [style=dashed, label="tokens"];
moe_48_expert_0 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_1 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_2 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_3 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_4 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_5 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_6 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_7 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_8 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_9 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_10 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_11 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_12 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_13 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_14 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_15 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_16 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_17 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_18 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_19 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_20 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_21 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_22 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_23 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_24 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_25 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_26 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_27 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_28 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_29 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_30 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_31 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_32 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_33 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_34 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_35 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_36 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_37 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_38 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_39 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_40 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_41 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_42 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_43 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_44 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_45 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_46 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_47 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_48 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_49 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_50 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_51 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_52 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_53 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_54 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_55 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_56 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_57 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_58 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_59 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_60 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_61 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_62 -> moe_48_expert_agg [label="hidden=7168"];
moe_48_expert_63 -> moe_48_expert_agg [label="hidden=7168"];

    moe_48_expert_agg -> moe_48_residual [label="hidden=7168"];
    moe_48_residual -> moe_49_mha_q [label="hidden=7168"];

    // MoE Layer 49 connections
    moe_49_mha_q -> moe_49_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_49_mha_k -> moe_49_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_49_mha_v -> moe_49_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_49_mha_attn -> moe_49_mha_out [label="[heads=128, d_k=128]"];
    moe_49_mha_out -> moe_49_gate [label="hidden=7168"];
    moe_49_gate -> moe_49_expert_0 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_1 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_2 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_3 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_4 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_5 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_6 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_7 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_8 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_9 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_10 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_11 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_12 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_13 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_14 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_15 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_16 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_17 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_18 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_19 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_20 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_21 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_22 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_23 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_24 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_25 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_26 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_27 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_28 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_29 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_30 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_31 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_32 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_33 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_34 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_35 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_36 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_37 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_38 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_39 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_40 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_41 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_42 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_43 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_44 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_45 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_46 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_47 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_48 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_49 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_50 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_51 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_52 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_53 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_54 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_55 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_56 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_57 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_58 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_59 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_60 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_61 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_62 [style=dashed, label="tokens"];
moe_49_gate -> moe_49_expert_63 [style=dashed, label="tokens"];
moe_49_expert_0 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_1 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_2 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_3 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_4 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_5 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_6 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_7 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_8 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_9 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_10 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_11 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_12 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_13 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_14 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_15 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_16 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_17 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_18 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_19 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_20 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_21 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_22 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_23 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_24 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_25 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_26 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_27 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_28 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_29 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_30 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_31 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_32 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_33 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_34 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_35 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_36 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_37 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_38 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_39 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_40 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_41 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_42 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_43 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_44 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_45 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_46 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_47 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_48 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_49 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_50 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_51 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_52 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_53 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_54 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_55 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_56 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_57 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_58 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_59 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_60 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_61 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_62 -> moe_49_expert_agg [label="hidden=7168"];
moe_49_expert_63 -> moe_49_expert_agg [label="hidden=7168"];

    moe_49_expert_agg -> moe_49_residual [label="hidden=7168"];
    moe_49_residual -> moe_50_mha_q [label="hidden=7168"];

    // MoE Layer 50 connections
    moe_50_mha_q -> moe_50_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_50_mha_k -> moe_50_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_50_mha_v -> moe_50_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_50_mha_attn -> moe_50_mha_out [label="[heads=128, d_k=128]"];
    moe_50_mha_out -> moe_50_gate [label="hidden=7168"];
    moe_50_gate -> moe_50_expert_0 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_1 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_2 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_3 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_4 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_5 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_6 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_7 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_8 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_9 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_10 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_11 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_12 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_13 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_14 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_15 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_16 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_17 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_18 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_19 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_20 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_21 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_22 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_23 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_24 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_25 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_26 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_27 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_28 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_29 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_30 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_31 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_32 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_33 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_34 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_35 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_36 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_37 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_38 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_39 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_40 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_41 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_42 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_43 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_44 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_45 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_46 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_47 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_48 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_49 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_50 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_51 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_52 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_53 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_54 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_55 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_56 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_57 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_58 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_59 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_60 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_61 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_62 [style=dashed, label="tokens"];
moe_50_gate -> moe_50_expert_63 [style=dashed, label="tokens"];
moe_50_expert_0 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_1 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_2 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_3 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_4 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_5 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_6 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_7 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_8 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_9 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_10 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_11 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_12 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_13 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_14 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_15 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_16 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_17 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_18 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_19 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_20 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_21 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_22 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_23 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_24 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_25 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_26 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_27 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_28 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_29 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_30 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_31 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_32 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_33 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_34 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_35 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_36 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_37 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_38 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_39 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_40 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_41 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_42 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_43 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_44 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_45 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_46 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_47 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_48 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_49 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_50 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_51 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_52 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_53 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_54 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_55 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_56 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_57 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_58 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_59 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_60 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_61 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_62 -> moe_50_expert_agg [label="hidden=7168"];
moe_50_expert_63 -> moe_50_expert_agg [label="hidden=7168"];

    moe_50_expert_agg -> moe_50_residual [label="hidden=7168"];
    moe_50_residual -> moe_51_mha_q [label="hidden=7168"];

    // MoE Layer 51 connections
    moe_51_mha_q -> moe_51_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_51_mha_k -> moe_51_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_51_mha_v -> moe_51_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_51_mha_attn -> moe_51_mha_out [label="[heads=128, d_k=128]"];
    moe_51_mha_out -> moe_51_gate [label="hidden=7168"];
    moe_51_gate -> moe_51_expert_0 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_1 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_2 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_3 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_4 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_5 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_6 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_7 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_8 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_9 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_10 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_11 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_12 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_13 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_14 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_15 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_16 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_17 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_18 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_19 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_20 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_21 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_22 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_23 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_24 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_25 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_26 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_27 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_28 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_29 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_30 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_31 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_32 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_33 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_34 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_35 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_36 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_37 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_38 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_39 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_40 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_41 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_42 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_43 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_44 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_45 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_46 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_47 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_48 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_49 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_50 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_51 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_52 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_53 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_54 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_55 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_56 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_57 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_58 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_59 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_60 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_61 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_62 [style=dashed, label="tokens"];
moe_51_gate -> moe_51_expert_63 [style=dashed, label="tokens"];
moe_51_expert_0 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_1 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_2 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_3 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_4 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_5 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_6 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_7 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_8 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_9 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_10 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_11 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_12 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_13 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_14 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_15 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_16 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_17 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_18 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_19 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_20 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_21 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_22 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_23 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_24 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_25 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_26 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_27 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_28 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_29 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_30 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_31 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_32 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_33 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_34 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_35 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_36 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_37 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_38 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_39 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_40 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_41 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_42 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_43 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_44 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_45 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_46 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_47 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_48 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_49 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_50 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_51 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_52 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_53 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_54 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_55 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_56 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_57 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_58 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_59 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_60 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_61 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_62 -> moe_51_expert_agg [label="hidden=7168"];
moe_51_expert_63 -> moe_51_expert_agg [label="hidden=7168"];

    moe_51_expert_agg -> moe_51_residual [label="hidden=7168"];
    moe_51_residual -> moe_52_mha_q [label="hidden=7168"];

    // MoE Layer 52 connections
    moe_52_mha_q -> moe_52_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_52_mha_k -> moe_52_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_52_mha_v -> moe_52_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_52_mha_attn -> moe_52_mha_out [label="[heads=128, d_k=128]"];
    moe_52_mha_out -> moe_52_gate [label="hidden=7168"];
    moe_52_gate -> moe_52_expert_0 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_1 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_2 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_3 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_4 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_5 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_6 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_7 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_8 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_9 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_10 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_11 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_12 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_13 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_14 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_15 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_16 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_17 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_18 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_19 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_20 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_21 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_22 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_23 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_24 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_25 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_26 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_27 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_28 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_29 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_30 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_31 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_32 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_33 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_34 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_35 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_36 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_37 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_38 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_39 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_40 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_41 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_42 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_43 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_44 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_45 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_46 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_47 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_48 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_49 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_50 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_51 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_52 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_53 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_54 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_55 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_56 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_57 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_58 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_59 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_60 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_61 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_62 [style=dashed, label="tokens"];
moe_52_gate -> moe_52_expert_63 [style=dashed, label="tokens"];
moe_52_expert_0 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_1 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_2 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_3 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_4 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_5 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_6 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_7 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_8 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_9 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_10 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_11 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_12 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_13 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_14 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_15 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_16 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_17 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_18 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_19 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_20 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_21 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_22 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_23 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_24 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_25 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_26 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_27 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_28 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_29 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_30 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_31 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_32 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_33 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_34 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_35 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_36 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_37 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_38 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_39 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_40 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_41 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_42 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_43 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_44 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_45 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_46 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_47 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_48 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_49 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_50 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_51 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_52 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_53 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_54 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_55 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_56 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_57 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_58 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_59 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_60 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_61 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_62 -> moe_52_expert_agg [label="hidden=7168"];
moe_52_expert_63 -> moe_52_expert_agg [label="hidden=7168"];

    moe_52_expert_agg -> moe_52_residual [label="hidden=7168"];
    moe_52_residual -> moe_53_mha_q [label="hidden=7168"];

    // MoE Layer 53 connections
    moe_53_mha_q -> moe_53_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_53_mha_k -> moe_53_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_53_mha_v -> moe_53_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_53_mha_attn -> moe_53_mha_out [label="[heads=128, d_k=128]"];
    moe_53_mha_out -> moe_53_gate [label="hidden=7168"];
    moe_53_gate -> moe_53_expert_0 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_1 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_2 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_3 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_4 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_5 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_6 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_7 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_8 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_9 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_10 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_11 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_12 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_13 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_14 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_15 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_16 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_17 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_18 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_19 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_20 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_21 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_22 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_23 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_24 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_25 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_26 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_27 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_28 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_29 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_30 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_31 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_32 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_33 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_34 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_35 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_36 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_37 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_38 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_39 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_40 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_41 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_42 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_43 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_44 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_45 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_46 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_47 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_48 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_49 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_50 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_51 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_52 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_53 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_54 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_55 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_56 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_57 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_58 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_59 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_60 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_61 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_62 [style=dashed, label="tokens"];
moe_53_gate -> moe_53_expert_63 [style=dashed, label="tokens"];
moe_53_expert_0 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_1 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_2 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_3 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_4 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_5 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_6 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_7 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_8 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_9 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_10 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_11 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_12 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_13 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_14 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_15 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_16 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_17 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_18 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_19 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_20 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_21 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_22 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_23 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_24 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_25 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_26 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_27 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_28 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_29 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_30 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_31 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_32 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_33 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_34 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_35 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_36 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_37 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_38 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_39 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_40 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_41 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_42 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_43 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_44 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_45 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_46 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_47 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_48 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_49 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_50 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_51 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_52 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_53 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_54 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_55 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_56 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_57 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_58 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_59 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_60 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_61 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_62 -> moe_53_expert_agg [label="hidden=7168"];
moe_53_expert_63 -> moe_53_expert_agg [label="hidden=7168"];

    moe_53_expert_agg -> moe_53_residual [label="hidden=7168"];
    moe_53_residual -> moe_54_mha_q [label="hidden=7168"];

    // MoE Layer 54 connections
    moe_54_mha_q -> moe_54_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_54_mha_k -> moe_54_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_54_mha_v -> moe_54_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_54_mha_attn -> moe_54_mha_out [label="[heads=128, d_k=128]"];
    moe_54_mha_out -> moe_54_gate [label="hidden=7168"];
    moe_54_gate -> moe_54_expert_0 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_1 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_2 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_3 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_4 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_5 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_6 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_7 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_8 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_9 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_10 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_11 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_12 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_13 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_14 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_15 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_16 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_17 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_18 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_19 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_20 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_21 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_22 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_23 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_24 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_25 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_26 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_27 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_28 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_29 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_30 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_31 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_32 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_33 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_34 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_35 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_36 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_37 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_38 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_39 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_40 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_41 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_42 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_43 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_44 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_45 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_46 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_47 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_48 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_49 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_50 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_51 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_52 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_53 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_54 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_55 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_56 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_57 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_58 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_59 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_60 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_61 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_62 [style=dashed, label="tokens"];
moe_54_gate -> moe_54_expert_63 [style=dashed, label="tokens"];
moe_54_expert_0 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_1 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_2 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_3 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_4 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_5 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_6 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_7 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_8 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_9 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_10 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_11 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_12 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_13 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_14 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_15 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_16 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_17 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_18 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_19 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_20 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_21 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_22 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_23 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_24 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_25 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_26 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_27 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_28 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_29 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_30 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_31 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_32 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_33 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_34 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_35 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_36 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_37 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_38 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_39 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_40 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_41 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_42 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_43 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_44 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_45 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_46 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_47 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_48 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_49 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_50 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_51 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_52 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_53 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_54 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_55 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_56 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_57 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_58 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_59 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_60 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_61 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_62 -> moe_54_expert_agg [label="hidden=7168"];
moe_54_expert_63 -> moe_54_expert_agg [label="hidden=7168"];

    moe_54_expert_agg -> moe_54_residual [label="hidden=7168"];
    moe_54_residual -> moe_55_mha_q [label="hidden=7168"];

    // MoE Layer 55 connections
    moe_55_mha_q -> moe_55_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_55_mha_k -> moe_55_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_55_mha_v -> moe_55_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_55_mha_attn -> moe_55_mha_out [label="[heads=128, d_k=128]"];
    moe_55_mha_out -> moe_55_gate [label="hidden=7168"];
    moe_55_gate -> moe_55_expert_0 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_1 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_2 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_3 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_4 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_5 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_6 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_7 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_8 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_9 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_10 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_11 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_12 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_13 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_14 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_15 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_16 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_17 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_18 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_19 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_20 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_21 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_22 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_23 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_24 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_25 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_26 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_27 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_28 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_29 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_30 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_31 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_32 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_33 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_34 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_35 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_36 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_37 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_38 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_39 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_40 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_41 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_42 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_43 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_44 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_45 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_46 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_47 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_48 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_49 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_50 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_51 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_52 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_53 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_54 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_55 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_56 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_57 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_58 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_59 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_60 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_61 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_62 [style=dashed, label="tokens"];
moe_55_gate -> moe_55_expert_63 [style=dashed, label="tokens"];
moe_55_expert_0 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_1 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_2 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_3 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_4 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_5 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_6 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_7 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_8 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_9 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_10 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_11 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_12 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_13 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_14 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_15 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_16 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_17 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_18 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_19 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_20 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_21 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_22 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_23 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_24 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_25 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_26 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_27 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_28 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_29 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_30 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_31 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_32 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_33 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_34 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_35 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_36 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_37 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_38 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_39 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_40 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_41 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_42 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_43 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_44 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_45 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_46 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_47 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_48 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_49 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_50 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_51 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_52 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_53 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_54 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_55 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_56 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_57 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_58 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_59 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_60 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_61 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_62 -> moe_55_expert_agg [label="hidden=7168"];
moe_55_expert_63 -> moe_55_expert_agg [label="hidden=7168"];

    moe_55_expert_agg -> moe_55_residual [label="hidden=7168"];
    moe_55_residual -> moe_56_mha_q [label="hidden=7168"];

    // MoE Layer 56 connections
    moe_56_mha_q -> moe_56_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_56_mha_k -> moe_56_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_56_mha_v -> moe_56_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_56_mha_attn -> moe_56_mha_out [label="[heads=128, d_k=128]"];
    moe_56_mha_out -> moe_56_gate [label="hidden=7168"];
    moe_56_gate -> moe_56_expert_0 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_1 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_2 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_3 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_4 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_5 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_6 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_7 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_8 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_9 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_10 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_11 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_12 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_13 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_14 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_15 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_16 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_17 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_18 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_19 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_20 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_21 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_22 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_23 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_24 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_25 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_26 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_27 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_28 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_29 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_30 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_31 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_32 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_33 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_34 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_35 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_36 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_37 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_38 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_39 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_40 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_41 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_42 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_43 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_44 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_45 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_46 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_47 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_48 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_49 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_50 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_51 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_52 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_53 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_54 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_55 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_56 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_57 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_58 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_59 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_60 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_61 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_62 [style=dashed, label="tokens"];
moe_56_gate -> moe_56_expert_63 [style=dashed, label="tokens"];
moe_56_expert_0 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_1 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_2 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_3 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_4 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_5 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_6 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_7 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_8 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_9 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_10 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_11 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_12 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_13 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_14 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_15 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_16 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_17 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_18 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_19 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_20 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_21 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_22 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_23 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_24 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_25 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_26 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_27 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_28 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_29 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_30 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_31 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_32 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_33 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_34 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_35 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_36 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_37 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_38 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_39 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_40 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_41 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_42 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_43 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_44 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_45 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_46 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_47 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_48 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_49 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_50 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_51 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_52 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_53 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_54 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_55 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_56 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_57 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_58 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_59 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_60 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_61 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_62 -> moe_56_expert_agg [label="hidden=7168"];
moe_56_expert_63 -> moe_56_expert_agg [label="hidden=7168"];

    moe_56_expert_agg -> moe_56_residual [label="hidden=7168"];
    moe_56_residual -> moe_57_mha_q [label="hidden=7168"];

    // MoE Layer 57 connections
    moe_57_mha_q -> moe_57_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_57_mha_k -> moe_57_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_57_mha_v -> moe_57_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_57_mha_attn -> moe_57_mha_out [label="[heads=128, d_k=128]"];
    moe_57_mha_out -> moe_57_gate [label="hidden=7168"];
    moe_57_gate -> moe_57_expert_0 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_1 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_2 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_3 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_4 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_5 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_6 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_7 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_8 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_9 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_10 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_11 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_12 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_13 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_14 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_15 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_16 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_17 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_18 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_19 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_20 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_21 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_22 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_23 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_24 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_25 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_26 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_27 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_28 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_29 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_30 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_31 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_32 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_33 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_34 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_35 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_36 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_37 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_38 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_39 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_40 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_41 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_42 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_43 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_44 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_45 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_46 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_47 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_48 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_49 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_50 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_51 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_52 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_53 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_54 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_55 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_56 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_57 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_58 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_59 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_60 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_61 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_62 [style=dashed, label="tokens"];
moe_57_gate -> moe_57_expert_63 [style=dashed, label="tokens"];
moe_57_expert_0 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_1 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_2 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_3 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_4 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_5 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_6 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_7 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_8 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_9 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_10 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_11 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_12 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_13 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_14 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_15 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_16 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_17 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_18 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_19 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_20 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_21 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_22 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_23 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_24 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_25 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_26 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_27 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_28 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_29 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_30 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_31 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_32 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_33 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_34 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_35 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_36 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_37 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_38 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_39 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_40 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_41 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_42 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_43 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_44 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_45 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_46 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_47 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_48 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_49 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_50 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_51 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_52 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_53 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_54 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_55 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_56 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_57 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_58 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_59 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_60 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_61 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_62 -> moe_57_expert_agg [label="hidden=7168"];
moe_57_expert_63 -> moe_57_expert_agg [label="hidden=7168"];

    moe_57_expert_agg -> moe_57_residual [label="hidden=7168"];
    moe_57_residual -> moe_58_mha_q [label="hidden=7168"];

    // MoE Layer 58 connections
    moe_58_mha_q -> moe_58_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_58_mha_k -> moe_58_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_58_mha_v -> moe_58_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_58_mha_attn -> moe_58_mha_out [label="[heads=128, d_k=128]"];
    moe_58_mha_out -> moe_58_gate [label="hidden=7168"];
    moe_58_gate -> moe_58_expert_0 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_1 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_2 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_3 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_4 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_5 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_6 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_7 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_8 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_9 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_10 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_11 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_12 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_13 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_14 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_15 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_16 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_17 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_18 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_19 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_20 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_21 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_22 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_23 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_24 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_25 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_26 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_27 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_28 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_29 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_30 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_31 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_32 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_33 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_34 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_35 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_36 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_37 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_38 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_39 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_40 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_41 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_42 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_43 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_44 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_45 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_46 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_47 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_48 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_49 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_50 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_51 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_52 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_53 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_54 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_55 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_56 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_57 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_58 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_59 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_60 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_61 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_62 [style=dashed, label="tokens"];
moe_58_gate -> moe_58_expert_63 [style=dashed, label="tokens"];
moe_58_expert_0 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_1 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_2 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_3 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_4 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_5 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_6 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_7 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_8 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_9 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_10 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_11 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_12 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_13 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_14 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_15 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_16 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_17 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_18 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_19 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_20 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_21 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_22 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_23 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_24 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_25 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_26 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_27 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_28 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_29 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_30 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_31 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_32 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_33 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_34 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_35 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_36 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_37 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_38 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_39 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_40 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_41 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_42 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_43 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_44 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_45 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_46 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_47 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_48 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_49 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_50 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_51 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_52 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_53 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_54 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_55 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_56 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_57 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_58 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_59 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_60 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_61 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_62 -> moe_58_expert_agg [label="hidden=7168"];
moe_58_expert_63 -> moe_58_expert_agg [label="hidden=7168"];

    moe_58_expert_agg -> moe_58_residual [label="hidden=7168"];
    moe_58_residual -> moe_59_mha_q [label="hidden=7168"];

    // MoE Layer 59 connections
    moe_59_mha_q -> moe_59_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_59_mha_k -> moe_59_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_59_mha_v -> moe_59_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_59_mha_attn -> moe_59_mha_out [label="[heads=128, d_k=128]"];
    moe_59_mha_out -> moe_59_gate [label="hidden=7168"];
    moe_59_gate -> moe_59_expert_0 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_1 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_2 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_3 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_4 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_5 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_6 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_7 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_8 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_9 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_10 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_11 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_12 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_13 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_14 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_15 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_16 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_17 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_18 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_19 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_20 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_21 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_22 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_23 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_24 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_25 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_26 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_27 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_28 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_29 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_30 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_31 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_32 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_33 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_34 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_35 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_36 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_37 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_38 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_39 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_40 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_41 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_42 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_43 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_44 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_45 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_46 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_47 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_48 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_49 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_50 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_51 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_52 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_53 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_54 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_55 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_56 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_57 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_58 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_59 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_60 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_61 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_62 [style=dashed, label="tokens"];
moe_59_gate -> moe_59_expert_63 [style=dashed, label="tokens"];
moe_59_expert_0 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_1 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_2 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_3 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_4 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_5 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_6 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_7 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_8 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_9 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_10 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_11 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_12 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_13 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_14 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_15 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_16 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_17 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_18 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_19 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_20 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_21 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_22 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_23 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_24 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_25 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_26 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_27 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_28 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_29 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_30 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_31 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_32 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_33 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_34 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_35 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_36 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_37 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_38 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_39 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_40 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_41 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_42 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_43 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_44 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_45 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_46 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_47 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_48 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_49 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_50 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_51 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_52 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_53 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_54 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_55 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_56 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_57 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_58 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_59 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_60 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_61 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_62 -> moe_59_expert_agg [label="hidden=7168"];
moe_59_expert_63 -> moe_59_expert_agg [label="hidden=7168"];

    moe_59_expert_agg -> moe_59_residual [label="hidden=7168"];
    moe_59_residual -> moe_60_mha_q [label="hidden=7168"];

    // MoE Layer 60 connections
    moe_60_mha_q -> moe_60_mha_attn [label="Q: [heads=128, d_k=128]"];
    moe_60_mha_k -> moe_60_mha_attn [label="K: [heads=128, d_k=128]"];
    moe_60_mha_v -> moe_60_mha_attn [label="V: [heads=128, d_k=128]"];
    moe_60_mha_attn -> moe_60_mha_out [label="[heads=128, d_k=128]"];
    moe_60_mha_out -> moe_60_gate [label="hidden=7168"];
    moe_60_gate -> moe_60_expert_0 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_1 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_2 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_3 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_4 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_5 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_6 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_7 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_8 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_9 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_10 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_11 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_12 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_13 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_14 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_15 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_16 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_17 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_18 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_19 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_20 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_21 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_22 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_23 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_24 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_25 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_26 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_27 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_28 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_29 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_30 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_31 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_32 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_33 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_34 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_35 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_36 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_37 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_38 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_39 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_40 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_41 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_42 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_43 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_44 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_45 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_46 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_47 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_48 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_49 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_50 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_51 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_52 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_53 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_54 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_55 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_56 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_57 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_58 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_59 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_60 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_61 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_62 [style=dashed, label="tokens"];
moe_60_gate -> moe_60_expert_63 [style=dashed, label="tokens"];
moe_60_expert_0 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_1 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_2 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_3 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_4 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_5 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_6 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_7 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_8 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_9 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_10 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_11 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_12 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_13 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_14 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_15 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_16 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_17 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_18 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_19 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_20 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_21 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_22 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_23 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_24 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_25 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_26 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_27 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_28 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_29 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_30 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_31 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_32 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_33 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_34 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_35 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_36 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_37 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_38 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_39 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_40 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_41 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_42 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_43 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_44 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_45 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_46 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_47 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_48 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_49 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_50 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_51 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_52 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_53 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_54 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_55 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_56 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_57 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_58 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_59 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_60 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_61 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_62 -> moe_60_expert_agg [label="hidden=7168"];
moe_60_expert_63 -> moe_60_expert_agg [label="hidden=7168"];

    moe_60_expert_agg -> moe_60_residual [label="hidden=7168"];
    moe_60_residual -> output [label="hidden=7168"];
}
