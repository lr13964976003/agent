<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Simplified_Deployment Pages: 1 -->
<svg width="651pt" height="4025pt"
 viewBox="0.00 0.00 650.79 4025.29" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4021.29)">
<title>MoE_Simplified_Deployment</title>
<polygon fill="#f8f9fa" stroke="transparent" points="-4,4 -4,-4021.29 646.79,-4021.29 646.79,4 -4,4"/>
<text text-anchor="middle" x="321.39" y="-4000.49" font-family="Arial Bold" font-size="16.00">Large&#45;Scale Cross&#45;Node Expert Parallelism (Simplified View)</text>
<text text-anchor="middle" x="321.39" y="-3982.49" font-family="Arial Bold" font-size="16.00">61&#45;Layer MoE Transformer (3 Dense + 58 MoE)</text>
<text text-anchor="middle" x="321.39" y="-3964.49" font-family="Arial Bold" font-size="16.00">3,715 GPUs across 488 Nodes</text>
<text text-anchor="middle" x="321.39" y="-3946.49" font-family="Arial Bold" font-size="16.00">One Expert per GPU Strategy</text>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e3f2fd" stroke="black" cx="321.39" cy="-3899.81" rx="211.35" ry="37.45"/>
<text text-anchor="middle" x="321.39" y="-3911.11" font-family="Arial" font-size="14.00">Input</text>
<text text-anchor="middle" x="321.39" y="-3896.11" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3881.11" font-family="Arial" font-size="14.00">GPU: Host</text>
</g>
<!-- dense_0_mha -->
<g id="node2" class="node">
<title>dense_0_mha</title>
<polygon fill="#fff3e0" stroke="black" points="476.39,-3815.33 166.39,-3815.33 166.39,-3747.33 476.39,-3747.33 476.39,-3815.33"/>
<text text-anchor="middle" x="321.39" y="-3800.13" font-family="Arial" font-size="14.00">Dense Layer 0 MHA (All Components)</text>
<text text-anchor="middle" x="321.39" y="-3785.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3770.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3755.13" font-family="Arial" font-size="14.00">GPU: 3712 (Node 464, GPU 0)</text>
</g>
<!-- input&#45;&gt;dense_0_mha -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dense_0_mha</title>
<path fill="none" stroke="black" d="M321.39,-3862.28C321.39,-3850.72 321.39,-3837.83 321.39,-3825.83"/>
<polygon fill="black" stroke="black" points="324.89,-3825.57 321.39,-3815.57 317.89,-3825.57 324.89,-3825.57"/>
<text text-anchor="middle" x="349.39" y="-3836.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- dense_0_ffn -->
<g id="node3" class="node">
<title>dense_0_ffn</title>
<polygon fill="#fff3e0" stroke="black" points="476.39,-3700.33 166.39,-3700.33 166.39,-3632.33 476.39,-3632.33 476.39,-3700.33"/>
<text text-anchor="middle" x="321.39" y="-3685.13" font-family="Arial" font-size="14.00">Dense Layer 0 FFN</text>
<text text-anchor="middle" x="321.39" y="-3670.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3655.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3640.13" font-family="Arial" font-size="14.00">GPU: 3712 (Node 464, GPU 0)</text>
</g>
<!-- dense_0_mha&#45;&gt;dense_0_ffn -->
<g id="edge2" class="edge">
<title>dense_0_mha&#45;&gt;dense_0_ffn</title>
<path fill="none" stroke="black" d="M321.39,-3747.04C321.39,-3735.66 321.39,-3722.76 321.39,-3710.71"/>
<polygon fill="black" stroke="black" points="324.89,-3710.39 321.39,-3700.39 317.89,-3710.39 324.89,-3710.39"/>
<text text-anchor="middle" x="349.39" y="-3721.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- dense_0_residual -->
<g id="node4" class="node">
<title>dense_0_residual</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-3585.33 131.58,-3585.33 0.11,-3449.33 511.2,-3449.33 642.68,-3585.33"/>
<text text-anchor="middle" x="321.39" y="-3536.13" font-family="Arial" font-size="14.00">Dense Layer 0 Residual Add</text>
<text text-anchor="middle" x="321.39" y="-3521.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3506.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3491.13" font-family="Arial" font-size="14.00">GPU: 3712 (Node 464, GPU 0)</text>
</g>
<!-- dense_0_ffn&#45;&gt;dense_0_residual -->
<g id="edge3" class="edge">
<title>dense_0_ffn&#45;&gt;dense_0_residual</title>
<path fill="none" stroke="black" d="M321.39,-3631.98C321.39,-3621.08 321.39,-3608.49 321.39,-3595.74"/>
<polygon fill="black" stroke="black" points="324.89,-3595.51 321.39,-3585.51 317.89,-3595.51 324.89,-3595.51"/>
<text text-anchor="middle" x="349.39" y="-3606.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- dense_1_mha -->
<g id="node5" class="node">
<title>dense_1_mha</title>
<polygon fill="#fff3e0" stroke="black" points="476.39,-3402.33 166.39,-3402.33 166.39,-3334.33 476.39,-3334.33 476.39,-3402.33"/>
<text text-anchor="middle" x="321.39" y="-3387.13" font-family="Arial" font-size="14.00">Dense Layer 1 MHA (All Components)</text>
<text text-anchor="middle" x="321.39" y="-3372.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3357.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3342.13" font-family="Arial" font-size="14.00">GPU: 3713 (Node 464, GPU 1)</text>
</g>
<!-- dense_0_residual&#45;&gt;dense_1_mha -->
<g id="edge4" class="edge">
<title>dense_0_residual&#45;&gt;dense_1_mha</title>
<path fill="none" stroke="black" d="M321.39,-3449.29C321.39,-3436.88 321.39,-3424.23 321.39,-3412.75"/>
<polygon fill="black" stroke="black" points="324.89,-3412.59 321.39,-3402.59 317.89,-3412.59 324.89,-3412.59"/>
<text text-anchor="middle" x="349.39" y="-3423.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- dense_1_ffn -->
<g id="node6" class="node">
<title>dense_1_ffn</title>
<polygon fill="#fff3e0" stroke="black" points="476.39,-3287.33 166.39,-3287.33 166.39,-3219.33 476.39,-3219.33 476.39,-3287.33"/>
<text text-anchor="middle" x="321.39" y="-3272.13" font-family="Arial" font-size="14.00">Dense Layer 1 FFN</text>
<text text-anchor="middle" x="321.39" y="-3257.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3242.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3227.13" font-family="Arial" font-size="14.00">GPU: 3713 (Node 464, GPU 1)</text>
</g>
<!-- dense_1_mha&#45;&gt;dense_1_ffn -->
<g id="edge5" class="edge">
<title>dense_1_mha&#45;&gt;dense_1_ffn</title>
<path fill="none" stroke="black" d="M321.39,-3334.04C321.39,-3322.66 321.39,-3309.76 321.39,-3297.71"/>
<polygon fill="black" stroke="black" points="324.89,-3297.39 321.39,-3287.39 317.89,-3297.39 324.89,-3297.39"/>
<text text-anchor="middle" x="349.39" y="-3308.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- dense_1_residual -->
<g id="node7" class="node">
<title>dense_1_residual</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-3172.33 131.58,-3172.33 0.11,-3036.33 511.2,-3036.33 642.68,-3172.33"/>
<text text-anchor="middle" x="321.39" y="-3123.13" font-family="Arial" font-size="14.00">Dense Layer 1 Residual Add</text>
<text text-anchor="middle" x="321.39" y="-3108.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3093.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-3078.13" font-family="Arial" font-size="14.00">GPU: 3713 (Node 464, GPU 1)</text>
</g>
<!-- dense_1_ffn&#45;&gt;dense_1_residual -->
<g id="edge6" class="edge">
<title>dense_1_ffn&#45;&gt;dense_1_residual</title>
<path fill="none" stroke="black" d="M321.39,-3218.98C321.39,-3208.08 321.39,-3195.49 321.39,-3182.74"/>
<polygon fill="black" stroke="black" points="324.89,-3182.51 321.39,-3172.51 317.89,-3182.51 324.89,-3182.51"/>
<text text-anchor="middle" x="349.39" y="-3193.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- dense_2_mha -->
<g id="node8" class="node">
<title>dense_2_mha</title>
<polygon fill="#fff3e0" stroke="black" points="476.39,-2989.33 166.39,-2989.33 166.39,-2921.33 476.39,-2921.33 476.39,-2989.33"/>
<text text-anchor="middle" x="321.39" y="-2974.13" font-family="Arial" font-size="14.00">Dense Layer 2 MHA (All Components)</text>
<text text-anchor="middle" x="321.39" y="-2959.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2944.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2929.13" font-family="Arial" font-size="14.00">GPU: 3714 (Node 464, GPU 2)</text>
</g>
<!-- dense_1_residual&#45;&gt;dense_2_mha -->
<g id="edge7" class="edge">
<title>dense_1_residual&#45;&gt;dense_2_mha</title>
<path fill="none" stroke="black" d="M321.39,-3036.29C321.39,-3023.88 321.39,-3011.23 321.39,-2999.75"/>
<polygon fill="black" stroke="black" points="324.89,-2999.59 321.39,-2989.59 317.89,-2999.59 324.89,-2999.59"/>
<text text-anchor="middle" x="349.39" y="-3010.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- dense_2_ffn -->
<g id="node9" class="node">
<title>dense_2_ffn</title>
<polygon fill="#fff3e0" stroke="black" points="476.39,-2874.33 166.39,-2874.33 166.39,-2806.33 476.39,-2806.33 476.39,-2874.33"/>
<text text-anchor="middle" x="321.39" y="-2859.13" font-family="Arial" font-size="14.00">Dense Layer 2 FFN</text>
<text text-anchor="middle" x="321.39" y="-2844.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2829.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2814.13" font-family="Arial" font-size="14.00">GPU: 3714 (Node 464, GPU 2)</text>
</g>
<!-- dense_2_mha&#45;&gt;dense_2_ffn -->
<g id="edge8" class="edge">
<title>dense_2_mha&#45;&gt;dense_2_ffn</title>
<path fill="none" stroke="black" d="M321.39,-2921.04C321.39,-2909.66 321.39,-2896.76 321.39,-2884.71"/>
<polygon fill="black" stroke="black" points="324.89,-2884.39 321.39,-2874.39 317.89,-2884.39 324.89,-2884.39"/>
<text text-anchor="middle" x="349.39" y="-2895.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- dense_2_residual -->
<g id="node10" class="node">
<title>dense_2_residual</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-2759.33 131.58,-2759.33 0.11,-2623.33 511.2,-2623.33 642.68,-2759.33"/>
<text text-anchor="middle" x="321.39" y="-2710.13" font-family="Arial" font-size="14.00">Dense Layer 2 Residual Add</text>
<text text-anchor="middle" x="321.39" y="-2695.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2680.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2665.13" font-family="Arial" font-size="14.00">GPU: 3714 (Node 464, GPU 2)</text>
</g>
<!-- dense_2_ffn&#45;&gt;dense_2_residual -->
<g id="edge9" class="edge">
<title>dense_2_ffn&#45;&gt;dense_2_residual</title>
<path fill="none" stroke="black" d="M321.39,-2805.98C321.39,-2795.08 321.39,-2782.49 321.39,-2769.74"/>
<polygon fill="black" stroke="black" points="324.89,-2769.51 321.39,-2759.51 317.89,-2769.51 324.89,-2769.51"/>
<text text-anchor="middle" x="349.39" y="-2780.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- moe_3_mha -->
<g id="node11" class="node">
<title>moe_3_mha</title>
<polygon fill="#e1f5fe" stroke="black" points="476.39,-2576.33 166.39,-2576.33 166.39,-2508.33 476.39,-2508.33 476.39,-2576.33"/>
<text text-anchor="middle" x="321.39" y="-2561.13" font-family="Arial" font-size="14.00">MoE Layer 3 MHA (All Components)</text>
<text text-anchor="middle" x="321.39" y="-2546.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2531.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2516.13" font-family="Arial" font-size="14.00">GPU: 0 (Node 0, GPU 0)</text>
</g>
<!-- dense_2_residual&#45;&gt;moe_3_mha -->
<g id="edge10" class="edge">
<title>dense_2_residual&#45;&gt;moe_3_mha</title>
<path fill="none" stroke="black" d="M321.39,-2623.29C321.39,-2610.88 321.39,-2598.23 321.39,-2586.75"/>
<polygon fill="black" stroke="black" points="324.89,-2586.59 321.39,-2576.59 317.89,-2586.59 324.89,-2586.59"/>
<text text-anchor="middle" x="349.39" y="-2597.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- moe_3_gate -->
<g id="node12" class="node">
<title>moe_3_gate</title>
<polygon fill="#fff9c4" stroke="black" points="631.37,-2461.33 138.27,-2461.33 11.42,-2325.33 504.52,-2325.33 631.37,-2461.33"/>
<text text-anchor="middle" x="321.39" y="-2412.13" font-family="Arial" font-size="14.00">MoE Layer 3 Gate</text>
<text text-anchor="middle" x="321.39" y="-2397.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2382.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="321.39" y="-2367.13" font-family="Arial" font-size="14.00">GPU: 0 (Node 0, GPU 0)</text>
</g>
<!-- moe_3_mha&#45;&gt;moe_3_gate -->
<g id="edge11" class="edge">
<title>moe_3_mha&#45;&gt;moe_3_gate</title>
<path fill="none" stroke="black" d="M321.39,-2507.98C321.39,-2497.08 321.39,-2484.49 321.39,-2471.74"/>
<polygon fill="black" stroke="black" points="324.89,-2471.51 321.39,-2461.51 317.89,-2471.51 324.89,-2471.51"/>
<text text-anchor="middle" x="349.39" y="-2482.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- moe_3_experts -->
<g id="node13" class="node">
<title>moe_3_experts</title>
<polygon fill="#f3e5f5" stroke="black" points="450.89,-2278.33 191.89,-2278.33 191.89,-2210.33 450.89,-2210.33 450.89,-2278.33"/>
<text text-anchor="middle" x="321.39" y="-2263.13" font-family="Arial" font-size="14.00">MoE Layer 3 Expert Cluster (64 experts)</text>
<text text-anchor="middle" x="321.39" y="-2248.13" font-family="Arial" font-size="14.00">GPU Range: 0&#45;63 (Nodes 0&#45;7)</text>
<text text-anchor="middle" x="321.39" y="-2233.13" font-family="Arial" font-size="14.00">Each expert on separate GPU</text>
<text text-anchor="middle" x="321.39" y="-2218.13" font-family="Arial" font-size="14.00">Top&#45;2 experts selected per token</text>
</g>
<!-- moe_3_gate&#45;&gt;moe_3_experts -->
<g id="edge12" class="edge">
<title>moe_3_gate&#45;&gt;moe_3_experts</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M321.39,-2325.29C321.39,-2312.88 321.39,-2300.23 321.39,-2288.75"/>
<polygon fill="black" stroke="black" points="324.89,-2288.59 321.39,-2278.59 317.89,-2288.59 324.89,-2288.59"/>
<text text-anchor="middle" x="349.89" y="-2299.33" font-family="Arial" font-size="10.00">token routing</text>
</g>
<!-- moe_3_agg -->
<g id="node14" class="node">
<title>moe_3_agg</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-2163.33 131.58,-2163.33 0.11,-2027.33 511.2,-2027.33 642.68,-2163.33"/>
<text text-anchor="middle" x="321.39" y="-2114.13" font-family="Arial" font-size="14.00">MoE Layer 3 Expert Aggregation</text>
<text text-anchor="middle" x="321.39" y="-2099.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2084.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-2069.13" font-family="Arial" font-size="14.00">GPU: 0 (Node 0, GPU 0)</text>
</g>
<!-- moe_3_experts&#45;&gt;moe_3_agg -->
<g id="edge13" class="edge">
<title>moe_3_experts&#45;&gt;moe_3_agg</title>
<path fill="none" stroke="black" d="M321.39,-2209.98C321.39,-2199.08 321.39,-2186.49 321.39,-2173.74"/>
<polygon fill="black" stroke="black" points="324.89,-2173.51 321.39,-2163.51 317.89,-2173.51 324.89,-2173.51"/>
<text text-anchor="middle" x="352.89" y="-2184.33" font-family="Arial" font-size="10.00">expert outputs</text>
</g>
<!-- moe_3_residual -->
<g id="node15" class="node">
<title>moe_3_residual</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-1980.33 131.58,-1980.33 0.11,-1844.33 511.2,-1844.33 642.68,-1980.33"/>
<text text-anchor="middle" x="321.39" y="-1931.13" font-family="Arial" font-size="14.00">MoE Layer 3 Residual Add</text>
<text text-anchor="middle" x="321.39" y="-1916.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1901.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1886.13" font-family="Arial" font-size="14.00">GPU: 0 (Node 0, GPU 0)</text>
</g>
<!-- moe_3_agg&#45;&gt;moe_3_residual -->
<g id="edge14" class="edge">
<title>moe_3_agg&#45;&gt;moe_3_residual</title>
<path fill="none" stroke="black" d="M321.39,-2027.19C321.39,-2015.25 321.39,-2002.72 321.39,-1990.52"/>
<polygon fill="black" stroke="black" points="324.89,-1990.37 321.39,-1980.37 317.89,-1990.37 324.89,-1990.37"/>
<text text-anchor="middle" x="349.39" y="-2001.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- moe_4_mha -->
<g id="node16" class="node">
<title>moe_4_mha</title>
<polygon fill="#e1f5fe" stroke="black" points="476.39,-1797.33 166.39,-1797.33 166.39,-1729.33 476.39,-1729.33 476.39,-1797.33"/>
<text text-anchor="middle" x="321.39" y="-1782.13" font-family="Arial" font-size="14.00">MoE Layer 4 MHA (All Components)</text>
<text text-anchor="middle" x="321.39" y="-1767.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1752.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1737.13" font-family="Arial" font-size="14.00">GPU: 64 (Node 8, GPU 0)</text>
</g>
<!-- moe_3_residual&#45;&gt;moe_4_mha -->
<g id="edge15" class="edge">
<title>moe_3_residual&#45;&gt;moe_4_mha</title>
<path fill="none" stroke="black" d="M321.39,-1844.29C321.39,-1831.88 321.39,-1819.23 321.39,-1807.75"/>
<polygon fill="black" stroke="black" points="324.89,-1807.59 321.39,-1797.59 317.89,-1807.59 324.89,-1807.59"/>
<text text-anchor="middle" x="349.39" y="-1818.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- moe_4_gate -->
<g id="node17" class="node">
<title>moe_4_gate</title>
<polygon fill="#fff9c4" stroke="black" points="631.37,-1682.33 138.27,-1682.33 11.42,-1546.33 504.52,-1546.33 631.37,-1682.33"/>
<text text-anchor="middle" x="321.39" y="-1633.13" font-family="Arial" font-size="14.00">MoE Layer 4 Gate</text>
<text text-anchor="middle" x="321.39" y="-1618.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1603.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="321.39" y="-1588.13" font-family="Arial" font-size="14.00">GPU: 64 (Node 8, GPU 0)</text>
</g>
<!-- moe_4_mha&#45;&gt;moe_4_gate -->
<g id="edge16" class="edge">
<title>moe_4_mha&#45;&gt;moe_4_gate</title>
<path fill="none" stroke="black" d="M321.39,-1728.98C321.39,-1718.08 321.39,-1705.49 321.39,-1692.74"/>
<polygon fill="black" stroke="black" points="324.89,-1692.51 321.39,-1682.51 317.89,-1692.51 324.89,-1692.51"/>
<text text-anchor="middle" x="349.39" y="-1703.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- moe_4_experts -->
<g id="node18" class="node">
<title>moe_4_experts</title>
<polygon fill="#f3e5f5" stroke="black" points="450.89,-1499.33 191.89,-1499.33 191.89,-1431.33 450.89,-1431.33 450.89,-1499.33"/>
<text text-anchor="middle" x="321.39" y="-1484.13" font-family="Arial" font-size="14.00">MoE Layer 4 Expert Cluster (64 experts)</text>
<text text-anchor="middle" x="321.39" y="-1469.13" font-family="Arial" font-size="14.00">GPU Range: 64&#45;127 (Nodes 8&#45;15)</text>
<text text-anchor="middle" x="321.39" y="-1454.13" font-family="Arial" font-size="14.00">Each expert on separate GPU</text>
<text text-anchor="middle" x="321.39" y="-1439.13" font-family="Arial" font-size="14.00">Top&#45;2 experts selected per token</text>
</g>
<!-- moe_4_gate&#45;&gt;moe_4_experts -->
<g id="edge17" class="edge">
<title>moe_4_gate&#45;&gt;moe_4_experts</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M321.39,-1546.29C321.39,-1533.88 321.39,-1521.23 321.39,-1509.75"/>
<polygon fill="black" stroke="black" points="324.89,-1509.59 321.39,-1499.59 317.89,-1509.59 324.89,-1509.59"/>
<text text-anchor="middle" x="349.89" y="-1520.33" font-family="Arial" font-size="10.00">token routing</text>
</g>
<!-- moe_4_agg -->
<g id="node19" class="node">
<title>moe_4_agg</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-1384.33 131.58,-1384.33 0.11,-1248.33 511.2,-1248.33 642.68,-1384.33"/>
<text text-anchor="middle" x="321.39" y="-1335.13" font-family="Arial" font-size="14.00">MoE Layer 4 Expert Aggregation</text>
<text text-anchor="middle" x="321.39" y="-1320.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1305.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1290.13" font-family="Arial" font-size="14.00">GPU: 64 (Node 8, GPU 0)</text>
</g>
<!-- moe_4_experts&#45;&gt;moe_4_agg -->
<g id="edge18" class="edge">
<title>moe_4_experts&#45;&gt;moe_4_agg</title>
<path fill="none" stroke="black" d="M321.39,-1430.98C321.39,-1420.08 321.39,-1407.49 321.39,-1394.74"/>
<polygon fill="black" stroke="black" points="324.89,-1394.51 321.39,-1384.51 317.89,-1394.51 324.89,-1394.51"/>
<text text-anchor="middle" x="352.89" y="-1405.33" font-family="Arial" font-size="10.00">expert outputs</text>
</g>
<!-- moe_4_residual -->
<g id="node20" class="node">
<title>moe_4_residual</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-1201.33 131.58,-1201.33 0.11,-1065.33 511.2,-1065.33 642.68,-1201.33"/>
<text text-anchor="middle" x="321.39" y="-1152.13" font-family="Arial" font-size="14.00">MoE Layer 4 Residual Add</text>
<text text-anchor="middle" x="321.39" y="-1137.13" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1122.13" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-1107.13" font-family="Arial" font-size="14.00">GPU: 64 (Node 8, GPU 0)</text>
</g>
<!-- moe_4_agg&#45;&gt;moe_4_residual -->
<g id="edge19" class="edge">
<title>moe_4_agg&#45;&gt;moe_4_residual</title>
<path fill="none" stroke="black" d="M321.39,-1248.19C321.39,-1236.25 321.39,-1223.72 321.39,-1211.52"/>
<polygon fill="black" stroke="black" points="324.89,-1211.37 321.39,-1201.37 317.89,-1211.37 324.89,-1211.37"/>
<text text-anchor="middle" x="349.39" y="-1222.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- intermediate_layers -->
<g id="node26" class="node">
<title>intermediate_layers</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="321.39" cy="-970.25" rx="210.02" ry="48.17"/>
<text text-anchor="middle" x="321.39" y="-989.05" font-family="Arial" font-size="14.00">... MoE Layers 5&#45;59 (56 layers total) ...</text>
<text text-anchor="middle" x="321.39" y="-974.05" font-family="Arial" font-size="14.00">Following same pattern:</text>
<text text-anchor="middle" x="321.39" y="-959.05" font-family="Arial" font-size="14.00">Each layer uses 64 GPUs</text>
<text text-anchor="middle" x="321.39" y="-944.05" font-family="Arial" font-size="14.00">Total: 3,584 GPUs for intermediate MoE layers</text>
</g>
<!-- moe_4_residual&#45;&gt;intermediate_layers -->
<g id="edge20" class="edge">
<title>moe_4_residual&#45;&gt;intermediate_layers</title>
<path fill="none" stroke="black" d="M321.39,-1064.95C321.39,-1052.95 321.39,-1040.55 321.39,-1028.85"/>
<polygon fill="black" stroke="black" points="324.89,-1028.78 321.39,-1018.78 317.89,-1028.78 324.89,-1028.78"/>
<text text-anchor="middle" x="349.39" y="-1039.33" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- moe_60_mha -->
<g id="node21" class="node">
<title>moe_60_mha</title>
<polygon fill="#e1f5fe" stroke="black" points="476.39,-875.17 166.39,-875.17 166.39,-807.17 476.39,-807.17 476.39,-875.17"/>
<text text-anchor="middle" x="321.39" y="-859.97" font-family="Arial" font-size="14.00">MoE Layer 60 MHA (All Components)</text>
<text text-anchor="middle" x="321.39" y="-844.97" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-829.97" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-814.97" font-family="Arial" font-size="14.00">GPU: 3648 (Node 456, GPU 0)</text>
</g>
<!-- moe_60_gate -->
<g id="node22" class="node">
<title>moe_60_gate</title>
<polygon fill="#fff9c4" stroke="black" points="631.37,-760.17 138.27,-760.17 11.42,-624.17 504.52,-624.17 631.37,-760.17"/>
<text text-anchor="middle" x="321.39" y="-710.97" font-family="Arial" font-size="14.00">MoE Layer 60 Gate</text>
<text text-anchor="middle" x="321.39" y="-695.97" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-680.97" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="321.39" y="-665.97" font-family="Arial" font-size="14.00">GPU: 3648 (Node 456, GPU 0)</text>
</g>
<!-- moe_60_mha&#45;&gt;moe_60_gate -->
<g id="edge22" class="edge">
<title>moe_60_mha&#45;&gt;moe_60_gate</title>
<path fill="none" stroke="black" d="M321.39,-806.81C321.39,-795.91 321.39,-783.32 321.39,-770.57"/>
<polygon fill="black" stroke="black" points="324.89,-770.34 321.39,-760.34 317.89,-770.34 324.89,-770.34"/>
<text text-anchor="middle" x="349.39" y="-781.17" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- moe_60_experts -->
<g id="node23" class="node">
<title>moe_60_experts</title>
<polygon fill="#f3e5f5" stroke="black" points="454.89,-577.17 187.89,-577.17 187.89,-509.17 454.89,-509.17 454.89,-577.17"/>
<text text-anchor="middle" x="321.39" y="-561.97" font-family="Arial" font-size="14.00">MoE Layer 60 Expert Cluster (64 experts)</text>
<text text-anchor="middle" x="321.39" y="-546.97" font-family="Arial" font-size="14.00">GPU Range: 3648&#45;3711 (Nodes 456&#45;463)</text>
<text text-anchor="middle" x="321.39" y="-531.97" font-family="Arial" font-size="14.00">Each expert on separate GPU</text>
<text text-anchor="middle" x="321.39" y="-516.97" font-family="Arial" font-size="14.00">Top&#45;2 experts selected per token</text>
</g>
<!-- moe_60_gate&#45;&gt;moe_60_experts -->
<g id="edge23" class="edge">
<title>moe_60_gate&#45;&gt;moe_60_experts</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M321.39,-624.12C321.39,-611.71 321.39,-599.06 321.39,-587.59"/>
<polygon fill="black" stroke="black" points="324.89,-587.42 321.39,-577.42 317.89,-587.42 324.89,-587.42"/>
<text text-anchor="middle" x="349.89" y="-598.17" font-family="Arial" font-size="10.00">token routing</text>
</g>
<!-- moe_60_agg -->
<g id="node24" class="node">
<title>moe_60_agg</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-462.17 131.58,-462.17 0.11,-326.17 511.2,-326.17 642.68,-462.17"/>
<text text-anchor="middle" x="321.39" y="-412.97" font-family="Arial" font-size="14.00">MoE Layer 60 Expert Aggregation</text>
<text text-anchor="middle" x="321.39" y="-397.97" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-382.97" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-367.97" font-family="Arial" font-size="14.00">GPU: 3648 (Node 456, GPU 0)</text>
</g>
<!-- moe_60_experts&#45;&gt;moe_60_agg -->
<g id="edge24" class="edge">
<title>moe_60_experts&#45;&gt;moe_60_agg</title>
<path fill="none" stroke="black" d="M321.39,-508.81C321.39,-497.91 321.39,-485.32 321.39,-472.57"/>
<polygon fill="black" stroke="black" points="324.89,-472.34 321.39,-462.34 317.89,-472.34 324.89,-472.34"/>
<text text-anchor="middle" x="352.89" y="-483.17" font-family="Arial" font-size="10.00">expert outputs</text>
</g>
<!-- moe_60_residual -->
<g id="node25" class="node">
<title>moe_60_residual</title>
<polygon fill="#e8f5e8" stroke="black" points="642.68,-279.17 131.58,-279.17 0.11,-143.17 511.2,-143.17 642.68,-279.17"/>
<text text-anchor="middle" x="321.39" y="-229.97" font-family="Arial" font-size="14.00">MoE Layer 60 Residual Add</text>
<text text-anchor="middle" x="321.39" y="-214.97" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-199.97" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-184.97" font-family="Arial" font-size="14.00">GPU: 3648 (Node 456, GPU 0)</text>
</g>
<!-- moe_60_agg&#45;&gt;moe_60_residual -->
<g id="edge25" class="edge">
<title>moe_60_agg&#45;&gt;moe_60_residual</title>
<path fill="none" stroke="black" d="M321.39,-326.03C321.39,-314.08 321.39,-301.55 321.39,-289.35"/>
<polygon fill="black" stroke="black" points="324.89,-289.2 321.39,-279.2 317.89,-289.2 324.89,-289.2"/>
<text text-anchor="middle" x="349.39" y="-300.17" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- output -->
<g id="node27" class="node">
<title>output</title>
<ellipse fill="#e8f5e8" stroke="black" cx="321.39" cy="-48.08" rx="219.41" ry="48.17"/>
<text text-anchor="middle" x="321.39" y="-66.88" font-family="Arial" font-size="14.00">Output</text>
<text text-anchor="middle" x="321.39" y="-51.88" font-family="Arial" font-size="14.00">Input: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-36.88" font-family="Arial" font-size="14.00">Output: [batch_size=?, seq_len=?, hidden=7168]</text>
<text text-anchor="middle" x="321.39" y="-21.88" font-family="Arial" font-size="14.00">GPU: Host</text>
</g>
<!-- moe_60_residual&#45;&gt;output -->
<g id="edge26" class="edge">
<title>moe_60_residual&#45;&gt;output</title>
<path fill="none" stroke="black" d="M321.39,-142.79C321.39,-130.78 321.39,-118.38 321.39,-106.68"/>
<polygon fill="black" stroke="black" points="324.89,-106.61 321.39,-96.61 317.89,-106.61 324.89,-106.61"/>
<text text-anchor="middle" x="349.39" y="-117.17" font-family="Arial" font-size="10.00">hidden=7168</text>
</g>
<!-- intermediate_layers&#45;&gt;moe_60_mha -->
<g id="edge21" class="edge">
<title>intermediate_layers&#45;&gt;moe_60_mha</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M321.39,-921.93C321.39,-909.92 321.39,-897.08 321.39,-885.3"/>
<polygon fill="black" stroke="black" points="324.89,-885.26 321.39,-875.26 317.89,-885.26 324.89,-885.26"/>
<text text-anchor="middle" x="326.39" y="-896.17" font-family="Arial" font-size="10.00">...</text>
</g>
</g>
</svg>
