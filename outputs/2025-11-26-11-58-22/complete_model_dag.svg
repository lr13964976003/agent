<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="14400pt" height="13044pt"
 viewBox="0.00 0.00 14400.00 13043.57" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.33 0.33) rotate(0) translate(4 38963.31)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-38963.31 43015.61,-38963.31 43015.61,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="499.61" cy="-38900.62" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="499.61" y="-38911.92" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="499.61" y="-38896.92" font-family="Times,serif" font-size="14.00">batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="499.61" y="-38881.92" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- d0_ln1 -->
<g id="node2" class="node">
<title>d0_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="331.61" cy="-38768.45" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="331.61" y="-38779.75" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="331.61" y="-38764.75" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="331.61" y="-38749.75" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- input&#45;&gt;d0_ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;d0_ln1</title>
<path fill="none" stroke="black" d="M453.26,-38863.71C432.51,-38847.63 407.88,-38828.55 386.24,-38811.78"/>
<polygon fill="black" stroke="black" points="388.15,-38808.83 378.1,-38805.47 383.87,-38814.37 388.15,-38808.83"/>
</g>
<!-- d0_res1 -->
<g id="node6" class="node">
<title>d0_res1</title>
<ellipse fill="lightpink" stroke="black" cx="493.61" cy="-38239.79" rx="304.53" ry="58.88"/>
<text text-anchor="middle" x="493.61" y="-38266.09" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="493.61" y="-38251.09" font-family="Times,serif" font-size="14.00">Input1: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="493.61" y="-38236.09" font-family="Times,serif" font-size="14.00">Input2: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="493.61" y="-38221.09" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="493.61" y="-38206.09" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- input&#45;&gt;d0_res1 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;d0_res1</title>
<path fill="none" stroke="black" d="M572.58,-38864.46C596.39,-38849.56 620.76,-38830 636.61,-38805.93 675.98,-38746.15 667.61,-38719.47 667.61,-38647.89 667.61,-38647.89 667.61,-38647.89 667.61,-38513.73 667.61,-38433.41 688.06,-38402.03 644.61,-38334.48 636.47,-38321.81 625.94,-38310.57 614.23,-38300.67"/>
<polygon fill="black" stroke="black" points="616.37,-38297.9 606.38,-38294.36 611.98,-38303.35 616.37,-38297.9"/>
</g>
<!-- d0_qkv -->
<g id="node3" class="node">
<title>d0_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="319.61" cy="-38646.89" rx="319.72" ry="48.17"/>
<text text-anchor="middle" x="319.61" y="-38665.69" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="319.61" y="-38650.69" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="319.61" y="-38635.69" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, heads=128, d_k=128</text>
<text text-anchor="middle" x="319.61" y="-38620.69" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- d0_ln1&#45;&gt;d0_qkv -->
<g id="edge2" class="edge">
<title>d0_ln1&#45;&gt;d0_qkv</title>
<path fill="none" stroke="black" d="M327.95,-38730.93C327.13,-38722.84 326.25,-38714.07 325.38,-38705.36"/>
<polygon fill="black" stroke="black" points="328.84,-38704.82 324.36,-38695.22 321.88,-38705.52 328.84,-38704.82"/>
</g>
<!-- d0_mha -->
<g id="node4" class="node">
<title>d0_mha</title>
<ellipse fill="lightblue" stroke="black" cx="323.61" cy="-38514.73" rx="311.25" ry="48.17"/>
<text text-anchor="middle" x="323.61" y="-38533.53" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="323.61" y="-38518.53" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, heads=128, d_k=128</text>
<text text-anchor="middle" x="323.61" y="-38503.53" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="323.61" y="-38488.53" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- d0_qkv&#45;&gt;d0_mha -->
<g id="edge3" class="edge">
<title>d0_qkv&#45;&gt;d0_mha</title>
<path fill="none" stroke="black" d="M321.07,-38598.53C321.32,-38590.26 321.59,-38581.58 321.85,-38573.08"/>
<polygon fill="black" stroke="black" points="325.36,-38572.94 322.16,-38562.83 318.36,-38572.72 325.36,-38572.94"/>
</g>
<!-- d0_out -->
<g id="node5" class="node">
<title>d0_out</title>
<ellipse fill="lightblue" stroke="black" cx="330.61" cy="-38382.56" rx="304.53" ry="48.17"/>
<text text-anchor="middle" x="330.61" y="-38401.36" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="330.61" y="-38386.36" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="330.61" y="-38371.36" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="330.61" y="-38356.36" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- d0_mha&#45;&gt;d0_out -->
<g id="edge4" class="edge">
<title>d0_mha&#45;&gt;d0_out</title>
<path fill="none" stroke="black" d="M326.16,-38466.37C326.6,-38458.1 327.07,-38449.42 327.53,-38440.91"/>
<polygon fill="black" stroke="black" points="331.04,-38440.84 328.08,-38430.67 324.05,-38440.47 331.04,-38440.84"/>
</g>
<!-- d0_out&#45;&gt;d0_res1 -->
<g id="edge5" class="edge">
<title>d0_out&#45;&gt;d0_res1</title>
<path fill="none" stroke="black" d="M384.44,-38335.08C395.92,-38325.16 408.24,-38314.52 420.32,-38304.09"/>
<polygon fill="black" stroke="black" points="422.93,-38306.46 428.21,-38297.27 418.35,-38301.16 422.93,-38306.46"/>
</g>
<!-- d0_ln2 -->
<g id="node7" class="node">
<title>d0_ln2</title>
<ellipse fill="lightyellow" stroke="black" cx="331.61" cy="-38092.1" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="331.61" y="-38103.4" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="331.61" y="-38088.4" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="331.61" y="-38073.4" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- d0_res1&#45;&gt;d0_ln2 -->
<g id="edge7" class="edge">
<title>d0_res1&#45;&gt;d0_ln2</title>
<path fill="none" stroke="black" d="M430.51,-38182.04C413.57,-38166.8 395.52,-38150.57 379.54,-38136.2"/>
<polygon fill="black" stroke="black" points="381.65,-38133.39 371.88,-38129.31 376.97,-38138.6 381.65,-38133.39"/>
</g>
<!-- d0_final -->
<g id="node11" class="node">
<title>d0_final</title>
<ellipse fill="lightpink" stroke="black" cx="491.61" cy="-37547.91" rx="304.53" ry="58.88"/>
<text text-anchor="middle" x="491.61" y="-37574.21" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="491.61" y="-37559.21" font-family="Times,serif" font-size="14.00">Input1: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="491.61" y="-37544.21" font-family="Times,serif" font-size="14.00">Input2: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="491.61" y="-37529.21" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="491.61" y="-37514.21" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- d0_res1&#45;&gt;d0_final -->
<g id="edge12" class="edge">
<title>d0_res1&#45;&gt;d0_final</title>
<path fill="none" stroke="black" d="M600.34,-38184.81C614.49,-38173.48 627.29,-38160.27 636.61,-38145.1 680.86,-38073.04 657.61,-38040.57 657.61,-37956.01 657.61,-37956.01 657.61,-37956.01 657.61,-37821.85 657.61,-37741.73 680.79,-37710.71 638.61,-37642.6 630.91,-37630.16 620.87,-37619.08 609.66,-37609.28"/>
<polygon fill="black" stroke="black" points="611.66,-37606.39 601.72,-37602.71 607.19,-37611.78 611.66,-37606.39"/>
</g>
<!-- d0_ffn1 -->
<g id="node8" class="node">
<title>d0_ffn1</title>
<ellipse fill="lightblue" stroke="black" cx="328.61" cy="-37955.01" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="328.61" y="-37973.81" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="328.61" y="-37958.81" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="328.61" y="-37943.81" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="328.61" y="-37928.81" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- d0_ln2&#45;&gt;d0_ffn1 -->
<g id="edge8" class="edge">
<title>d0_ln2&#45;&gt;d0_ffn1</title>
<path fill="none" stroke="black" d="M330.8,-38054.54C330.52,-38041.84 330.19,-38027.27 329.88,-38013.31"/>
<polygon fill="black" stroke="black" points="333.38,-38013.2 329.66,-38003.28 326.38,-38013.35 333.38,-38013.2"/>
</g>
<!-- d0_gelu -->
<g id="node9" class="node">
<title>d0_gelu</title>
<ellipse fill="lightgreen" stroke="black" cx="328.61" cy="-37822.85" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="328.61" y="-37841.65" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="328.61" y="-37826.65" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="328.61" y="-37811.65" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="328.61" y="-37796.65" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- d0_ffn1&#45;&gt;d0_gelu -->
<g id="edge9" class="edge">
<title>d0_ffn1&#45;&gt;d0_gelu</title>
<path fill="none" stroke="black" d="M328.61,-37906.65C328.61,-37898.38 328.61,-37889.7 328.61,-37881.2"/>
<polygon fill="black" stroke="black" points="332.11,-37880.96 328.61,-37870.96 325.11,-37880.96 332.11,-37880.96"/>
</g>
<!-- d0_ffn2 -->
<g id="node10" class="node">
<title>d0_ffn2</title>
<ellipse fill="lightblue" stroke="black" cx="324.61" cy="-37690.68" rx="304.53" ry="48.17"/>
<text text-anchor="middle" x="324.61" y="-37709.48" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="324.61" y="-37694.48" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="324.61" y="-37679.48" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="324.61" y="-37664.48" font-family="Times,serif" font-size="14.00">GPU: 3712</text>
</g>
<!-- d0_gelu&#45;&gt;d0_ffn2 -->
<g id="edge10" class="edge">
<title>d0_gelu&#45;&gt;d0_ffn2</title>
<path fill="none" stroke="black" d="M327.16,-37774.49C326.9,-37766.22 326.64,-37757.54 326.37,-37749.03"/>
<polygon fill="black" stroke="black" points="329.87,-37748.68 326.06,-37738.79 322.87,-37748.89 329.87,-37748.68"/>
</g>
<!-- d0_ffn2&#45;&gt;d0_final -->
<g id="edge11" class="edge">
<title>d0_ffn2&#45;&gt;d0_final</title>
<path fill="none" stroke="black" d="M379.76,-37643.2C391.64,-37633.18 404.39,-37622.43 416.87,-37611.91"/>
<polygon fill="black" stroke="black" points="419.21,-37614.52 424.6,-37605.39 414.7,-37609.16 419.21,-37614.52"/>
</g>
<!-- d1_ln1 -->
<g id="node12" class="node">
<title>d1_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="491.61" cy="-37415.74" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="491.61" y="-37427.04" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="491.61" y="-37412.04" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="491.61" y="-37397.04" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d0_final&#45;&gt;d1_ln1 -->
<g id="edge13" class="edge">
<title>d0_final&#45;&gt;d1_ln1</title>
<path fill="none" stroke="black" d="M491.61,-37489.06C491.61,-37480.56 491.61,-37471.89 491.61,-37463.65"/>
<polygon fill="black" stroke="black" points="495.11,-37463.48 491.61,-37453.48 488.11,-37463.48 495.11,-37463.48"/>
</g>
<!-- d1_qkv -->
<g id="node13" class="node">
<title>d1_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="1099.61" cy="-38900.62" rx="319.72" ry="48.17"/>
<text text-anchor="middle" x="1099.61" y="-38919.42" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1099.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="1099.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, heads=128, d_k=128</text>
<text text-anchor="middle" x="1099.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d1_mha -->
<g id="node14" class="node">
<title>d1_mha</title>
<ellipse fill="lightblue" stroke="black" cx="1748.61" cy="-38900.62" rx="311.25" ry="48.17"/>
<text text-anchor="middle" x="1748.61" y="-38919.42" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1748.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, heads=128, d_k=128</text>
<text text-anchor="middle" x="1748.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="1748.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d1_out -->
<g id="node15" class="node">
<title>d1_out</title>
<ellipse fill="lightblue" stroke="black" cx="2382.61" cy="-38900.62" rx="304.53" ry="48.17"/>
<text text-anchor="middle" x="2382.61" y="-38919.42" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2382.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="2382.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="2382.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d1_res1 -->
<g id="node16" class="node">
<title>d1_res1</title>
<ellipse fill="lightpink" stroke="black" cx="3010.61" cy="-38900.62" rx="304.53" ry="58.88"/>
<text text-anchor="middle" x="3010.61" y="-38926.92" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3010.61" y="-38911.92" font-family="Times,serif" font-size="14.00">Input1: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="3010.61" y="-38896.92" font-family="Times,serif" font-size="14.00">Input2: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="3010.61" y="-38881.92" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="3010.61" y="-38866.92" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d1_ln2 -->
<g id="node17" class="node">
<title>d1_ln2</title>
<ellipse fill="lightyellow" stroke="black" cx="3629.61" cy="-38900.62" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="3629.61" y="-38911.92" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3629.61" y="-38896.92" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="3629.61" y="-38881.92" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d1_ffn1 -->
<g id="node18" class="node">
<title>d1_ffn1</title>
<ellipse fill="lightblue" stroke="black" cx="4242.61" cy="-38900.62" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="4242.61" y="-38919.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4242.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="4242.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="4242.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d1_gelu -->
<g id="node19" class="node">
<title>d1_gelu</title>
<ellipse fill="lightgreen" stroke="black" cx="4857.61" cy="-38900.62" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="4857.61" y="-38919.42" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4857.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="4857.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="4857.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d1_ffn2 -->
<g id="node20" class="node">
<title>d1_ffn2</title>
<ellipse fill="lightblue" stroke="black" cx="5478.61" cy="-38900.62" rx="304.53" ry="48.17"/>
<text text-anchor="middle" x="5478.61" y="-38919.42" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="5478.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="5478.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="5478.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d1_final -->
<g id="node21" class="node">
<title>d1_final</title>
<ellipse fill="lightpink" stroke="black" cx="6106.61" cy="-38900.62" rx="304.53" ry="58.88"/>
<text text-anchor="middle" x="6106.61" y="-38926.92" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6106.61" y="-38911.92" font-family="Times,serif" font-size="14.00">Input1: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="6106.61" y="-38896.92" font-family="Times,serif" font-size="14.00">Input2: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="6106.61" y="-38881.92" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="6106.61" y="-38866.92" font-family="Times,serif" font-size="14.00">GPU: 3713</text>
</g>
<!-- d2_ln1 -->
<g id="node22" class="node">
<title>d2_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="6725.61" cy="-38900.62" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="6725.61" y="-38911.92" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6725.61" y="-38896.92" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="6725.61" y="-38881.92" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_qkv -->
<g id="node23" class="node">
<title>d2_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="7359.61" cy="-38900.62" rx="319.72" ry="48.17"/>
<text text-anchor="middle" x="7359.61" y="-38919.42" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7359.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="7359.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, heads=128, d_k=128</text>
<text text-anchor="middle" x="7359.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_mha -->
<g id="node24" class="node">
<title>d2_mha</title>
<ellipse fill="lightblue" stroke="black" cx="8008.61" cy="-38900.62" rx="311.25" ry="48.17"/>
<text text-anchor="middle" x="8008.61" y="-38919.42" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="8008.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, heads=128, d_k=128</text>
<text text-anchor="middle" x="8008.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="8008.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_out -->
<g id="node25" class="node">
<title>d2_out</title>
<ellipse fill="lightblue" stroke="black" cx="8642.61" cy="-38900.62" rx="304.53" ry="48.17"/>
<text text-anchor="middle" x="8642.61" y="-38919.42" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8642.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="8642.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="8642.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_res1 -->
<g id="node26" class="node">
<title>d2_res1</title>
<ellipse fill="lightpink" stroke="black" cx="9270.61" cy="-38900.62" rx="304.53" ry="58.88"/>
<text text-anchor="middle" x="9270.61" y="-38926.92" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9270.61" y="-38911.92" font-family="Times,serif" font-size="14.00">Input1: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="9270.61" y="-38896.92" font-family="Times,serif" font-size="14.00">Input2: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="9270.61" y="-38881.92" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="9270.61" y="-38866.92" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_ln2 -->
<g id="node27" class="node">
<title>d2_ln2</title>
<ellipse fill="lightyellow" stroke="black" cx="9889.61" cy="-38900.62" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="9889.61" y="-38911.92" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9889.61" y="-38896.92" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="9889.61" y="-38881.92" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_ffn1 -->
<g id="node28" class="node">
<title>d2_ffn1</title>
<ellipse fill="lightblue" stroke="black" cx="10502.61" cy="-38900.62" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="10502.61" y="-38919.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="10502.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="10502.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="10502.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_gelu -->
<g id="node29" class="node">
<title>d2_gelu</title>
<ellipse fill="lightgreen" stroke="black" cx="11117.61" cy="-38900.62" rx="298.3" ry="48.17"/>
<text text-anchor="middle" x="11117.61" y="-38919.42" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11117.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="11117.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="11117.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_ffn2 -->
<g id="node30" class="node">
<title>d2_ffn2</title>
<ellipse fill="lightblue" stroke="black" cx="11738.61" cy="-38900.62" rx="304.53" ry="48.17"/>
<text text-anchor="middle" x="11738.61" y="-38919.42" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="11738.61" y="-38904.42" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, ffn_hidden=2048</text>
<text text-anchor="middle" x="11738.61" y="-38889.42" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="11738.61" y="-38874.42" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- d2_final -->
<g id="node31" class="node">
<title>d2_final</title>
<ellipse fill="lightpink" stroke="black" cx="12366.61" cy="-38900.62" rx="304.53" ry="58.88"/>
<text text-anchor="middle" x="12366.61" y="-38926.92" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12366.61" y="-38911.92" font-family="Times,serif" font-size="14.00">Input1: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="12366.61" y="-38896.92" font-family="Times,serif" font-size="14.00">Input2: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="12366.61" y="-38881.92" font-family="Times,serif" font-size="14.00">Output: batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="12366.61" y="-38866.92" font-family="Times,serif" font-size="14.00">GPU: 3714</text>
</g>
<!-- m3_ln1 -->
<g id="node32" class="node">
<title>m3_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="12317.61" cy="-38768.45" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="12317.61" y="-38772.25" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="12317.61" y="-38757.25" font-family="Times,serif" font-size="14.00">GPU: 3715</text>
</g>
<!-- d2_final&#45;&gt;m3_ln1 -->
<g id="edge14" class="edge">
<title>d2_final&#45;&gt;m3_ln1</title>
<path fill="none" stroke="black" d="M12344.83,-38841.77C12340.09,-38829.17 12335.21,-38816.19 12330.91,-38804.78"/>
<polygon fill="black" stroke="black" points="12334.1,-38803.32 12327.3,-38795.2 12327.55,-38805.79 12334.1,-38803.32"/>
</g>
<!-- m3_res1 -->
<g id="node36" class="node">
<title>m3_res1</title>
<ellipse fill="lightpink" stroke="black" cx="12359.61" cy="-38239.79" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="12359.61" y="-38243.59" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12359.61" y="-38228.59" font-family="Times,serif" font-size="14.00">GPU: 3715</text>
</g>
<!-- d2_final&#45;&gt;m3_res1 -->
<g id="edge19" class="edge">
<title>d2_final&#45;&gt;m3_res1</title>
<path fill="none" stroke="black" d="M12387.72,-38841.99C12404.3,-38791.52 12424.61,-38715.84 12424.61,-38647.89 12424.61,-38647.89 12424.61,-38647.89 12424.61,-38513.73 12424.61,-38433.61 12427.83,-38411.45 12405.61,-38334.48 12399.72,-38314.06 12389.57,-38292.69 12380.3,-38275.52"/>
<polygon fill="black" stroke="black" points="12383.18,-38273.5 12375.28,-38266.44 12377.06,-38276.89 12383.18,-38273.5"/>
</g>
<!-- m3_qkv -->
<g id="node33" class="node">
<title>m3_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="12308.61" cy="-38646.89" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="12308.61" y="-38650.69" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12308.61" y="-38635.69" font-family="Times,serif" font-size="14.00">GPU: 3715</text>
</g>
<!-- m3_ln1&#45;&gt;m3_qkv -->
<g id="edge15" class="edge">
<title>m3_ln1&#45;&gt;m3_qkv</title>
<path fill="none" stroke="black" d="M12315.66,-38741.51C12314.39,-38724.67 12312.72,-38702.48 12311.33,-38683.94"/>
<polygon fill="black" stroke="black" points="12314.8,-38683.49 12310.56,-38673.79 12307.82,-38684.02 12314.8,-38683.49"/>
</g>
<!-- m3_mha -->
<g id="node34" class="node">
<title>m3_mha</title>
<ellipse fill="lightblue" stroke="black" cx="12301.61" cy="-38514.73" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="12301.61" y="-38518.53" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="12301.61" y="-38503.53" font-family="Times,serif" font-size="14.00">GPU: 3715</text>
</g>
<!-- m3_qkv&#45;&gt;m3_mha -->
<g id="edge16" class="edge">
<title>m3_qkv&#45;&gt;m3_mha</title>
<path fill="none" stroke="black" d="M12307.21,-38619.87C12306.16,-38600.36 12304.71,-38573.41 12303.55,-38551.82"/>
<polygon fill="black" stroke="black" points="12307.04,-38551.51 12303.01,-38541.71 12300.05,-38551.88 12307.04,-38551.51"/>
</g>
<!-- m3_out -->
<g id="node35" class="node">
<title>m3_out</title>
<ellipse fill="lightblue" stroke="black" cx="12294.61" cy="-38382.56" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="12294.61" y="-38386.36" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12294.61" y="-38371.36" font-family="Times,serif" font-size="14.00">GPU: 3715</text>
</g>
<!-- m3_mha&#45;&gt;m3_out -->
<g id="edge17" class="edge">
<title>m3_mha&#45;&gt;m3_out</title>
<path fill="none" stroke="black" d="M12300.21,-38487.7C12299.16,-38468.19 12297.71,-38441.25 12296.55,-38419.66"/>
<polygon fill="black" stroke="black" points="12300.04,-38419.34 12296.01,-38409.54 12293.05,-38419.72 12300.04,-38419.34"/>
</g>
<!-- m3_out&#45;&gt;m3_res1 -->
<g id="edge18" class="edge">
<title>m3_out&#45;&gt;m3_res1</title>
<path fill="none" stroke="black" d="M12306.53,-38355.74C12316.93,-38333.22 12332.11,-38300.35 12343.57,-38275.53"/>
<polygon fill="black" stroke="black" points="12346.75,-38276.99 12347.77,-38266.44 12340.4,-38274.06 12346.75,-38276.99"/>
</g>
<!-- m3_gate -->
<g id="node37" class="node">
<title>m3_gate</title>
<polygon fill="orange" stroke="black" points="12331.23,-38145.1 12126.63,-38145.1 12074,-38039.1 12278.59,-38039.1 12331.23,-38145.1"/>
<text text-anchor="middle" x="12202.61" y="-38103.4" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="12202.61" y="-38088.4" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="12202.61" y="-38073.4" font-family="Times,serif" font-size="14.00">GPU: 3715</text>
</g>
<!-- m3_res1&#45;&gt;m3_gate -->
<g id="edge20" class="edge">
<title>m3_res1&#45;&gt;m3_gate</title>
<path fill="none" stroke="black" d="M12333.33,-38214.4C12315.06,-38197.44 12289.88,-38174.07 12266.49,-38152.37"/>
<polygon fill="black" stroke="black" points="12268.68,-38149.63 12258.97,-38145.39 12263.92,-38154.76 12268.68,-38149.63"/>
</g>
<!-- m3_route -->
<g id="node38" class="node">
<title>m3_route</title>
<ellipse fill="lightgray" stroke="black" cx="12202.61" cy="-37955.01" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="12202.61" y="-37966.31" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="12202.61" y="-37951.31" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="12202.61" y="-37936.31" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m3_res1&#45;&gt;m3_route -->
<g id="edge22" class="edge">
<title>m3_res1&#45;&gt;m3_route</title>
<path fill="none" stroke="black" d="M12364.1,-38212.82C12369.66,-38172.33 12374.66,-38093.18 12340.61,-38039.1 12326.54,-38016.74 12304.06,-37999.57 12281.3,-37986.81"/>
<polygon fill="black" stroke="black" points="12282.71,-37983.59 12272.24,-37981.95 12279.4,-37989.76 12282.71,-37983.59"/>
</g>
<!-- m3_final -->
<g id="node43" class="node">
<title>m3_final</title>
<ellipse fill="lightpink" stroke="black" cx="12775.61" cy="-37547.91" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="12775.61" y="-37551.71" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="12775.61" y="-37536.71" font-family="Times,serif" font-size="14.00">GPU: 3715</text>
</g>
<!-- m3_res1&#45;&gt;m3_final -->
<g id="edge30" class="edge">
<title>m3_res1&#45;&gt;m3_final</title>
<path fill="none" stroke="black" d="M12431.3,-38229.34C12563.34,-38207.48 12831.61,-38140.38 12831.61,-37956.01 12831.61,-37956.01 12831.61,-37956.01 12831.61,-37821.85 12831.61,-37735.23 12804.21,-37636.25 12787.75,-37584.58"/>
<polygon fill="black" stroke="black" points="12791.02,-37583.33 12784.61,-37574.89 12784.36,-37585.48 12791.02,-37583.33"/>
</g>
<!-- m3_gate&#45;&gt;m3_route -->
<g id="edge21" class="edge">
<title>m3_gate&#45;&gt;m3_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12202.61,-38038.87C12202.61,-38027.05 12202.61,-38014.56 12202.61,-38002.97"/>
<polygon fill="black" stroke="black" points="12206.11,-38002.63 12202.61,-37992.63 12199.11,-38002.63 12206.11,-38002.63"/>
</g>
<!-- m3_expert0 -->
<g id="node39" class="node">
<title>m3_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="11285.61" cy="-37822.85" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="11285.61" y="-37834.15" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11285.61" y="-37819.15" font-family="Times,serif" font-size="14.00">Node 0 GPU 0</text>
<text text-anchor="middle" x="11285.61" y="-37804.15" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m3_route&#45;&gt;m3_expert0 -->
<g id="edge23" class="edge">
<title>m3_route&#45;&gt;m3_expert0</title>
<path fill="none" stroke="black" d="M12109.12,-37941.82C11989.18,-37926.05 11774.77,-37897.47 11591.61,-37870.93 11554.87,-37865.61 11515.67,-37859.73 11478.02,-37853.98"/>
<polygon fill="black" stroke="black" points="11478.39,-37850.49 11467.97,-37852.44 11477.33,-37857.41 11478.39,-37850.49"/>
</g>
<!-- m3_expert1 -->
<g id="node40" class="node">
<title>m3_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="11896.61" cy="-37822.85" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="11896.61" y="-37834.15" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11896.61" y="-37819.15" font-family="Times,serif" font-size="14.00">Node 0 GPU 1</text>
<text text-anchor="middle" x="11896.61" y="-37804.15" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m3_route&#45;&gt;m3_expert1 -->
<g id="edge25" class="edge">
<title>m3_route&#45;&gt;m3_expert1</title>
<path fill="none" stroke="black" d="M12137.72,-37926.41C12094.3,-37907.94 12036.52,-37883.36 11988.4,-37862.89"/>
<polygon fill="black" stroke="black" points="11989.49,-37859.55 11978.92,-37858.86 11986.75,-37865.99 11989.49,-37859.55"/>
</g>
<!-- m3_expert2 -->
<g id="node41" class="node">
<title>m3_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="12507.61" cy="-37822.85" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="12507.61" y="-37834.15" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12507.61" y="-37819.15" font-family="Times,serif" font-size="14.00">Node 0 GPU 2</text>
<text text-anchor="middle" x="12507.61" y="-37804.15" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m3_route&#45;&gt;m3_expert2 -->
<g id="edge27" class="edge">
<title>m3_route&#45;&gt;m3_expert2</title>
<path fill="none" stroke="black" d="M12267.29,-37926.41C12310.49,-37907.97 12367.95,-37883.45 12415.85,-37863.01"/>
<polygon fill="black" stroke="black" points="12417.47,-37866.12 12425.29,-37858.98 12414.72,-37859.68 12417.47,-37866.12"/>
</g>
<!-- m3_agg -->
<g id="node42" class="node">
<title>m3_agg</title>
<polygon fill="purple" stroke="black" points="12366.23,-37728.68 12105.95,-37728.68 12039,-37652.68 12299.27,-37652.68 12366.23,-37728.68"/>
<text text-anchor="middle" x="12202.61" y="-37694.48" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12202.61" y="-37679.48" font-family="Times,serif" font-size="14.00">GPU: 3715</text>
</g>
<!-- m3_expert0&#45;&gt;m3_agg -->
<g id="edge24" class="edge">
<title>m3_expert0&#45;&gt;m3_agg</title>
<path fill="none" stroke="black" d="M11467.97,-37793.25C11508.65,-37787.02 11551.58,-37780.56 11591.61,-37774.76 11759.07,-37750.5 11952.65,-37724.53 12076.27,-37708.2"/>
<polygon fill="black" stroke="black" points="12077.08,-37711.63 12086.53,-37706.85 12076.16,-37704.69 12077.08,-37711.63"/>
</g>
<!-- m3_expert1&#45;&gt;m3_agg -->
<g id="edge26" class="edge">
<title>m3_expert1&#45;&gt;m3_agg</title>
<path fill="none" stroke="black" d="M11979.02,-37786.79C12018.18,-37770.13 12065.26,-37750.11 12106.09,-37732.74"/>
<polygon fill="black" stroke="black" points="12107.68,-37735.87 12115.51,-37728.73 12104.94,-37729.43 12107.68,-37735.87"/>
</g>
<!-- m3_expert2&#45;&gt;m3_agg -->
<g id="edge28" class="edge">
<title>m3_expert2&#45;&gt;m3_agg</title>
<path fill="none" stroke="black" d="M12425.48,-37786.79C12386.44,-37770.13 12339.52,-37750.11 12298.82,-37732.74"/>
<polygon fill="black" stroke="black" points="12300,-37729.44 12289.43,-37728.73 12297.25,-37735.88 12300,-37729.44"/>
</g>
<!-- m3_agg&#45;&gt;m3_final -->
<g id="edge29" class="edge">
<title>m3_agg&#45;&gt;m3_final</title>
<path fill="none" stroke="black" d="M12309.05,-37663.53C12419.46,-37636.41 12589.86,-37594.54 12691.3,-37569.62"/>
<polygon fill="black" stroke="black" points="12692.33,-37572.97 12701.2,-37567.19 12690.66,-37566.18 12692.33,-37572.97"/>
</g>
<!-- m4_res1 -->
<g id="node48" class="node">
<title>m4_res1</title>
<ellipse fill="lightpink" stroke="black" cx="12888.61" cy="-37415.74" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="12888.61" y="-37419.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12888.61" y="-37404.54" font-family="Times,serif" font-size="14.00">GPU: 3716</text>
</g>
<!-- m3_final&#45;&gt;m4_res1 -->
<g id="edge35" class="edge">
<title>m3_final&#45;&gt;m4_res1</title>
<path fill="none" stroke="black" d="M12797.67,-37521.5C12815.59,-37500.85 12841,-37471.59 12860.4,-37449.23"/>
<polygon fill="black" stroke="black" points="12863.08,-37451.49 12867,-37441.64 12857.8,-37446.9 12863.08,-37451.49"/>
</g>
<!-- m4_ln1 -->
<g id="node44" class="node">
<title>m4_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="13002.61" cy="-37955.01" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="13002.61" y="-37958.81" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13002.61" y="-37943.81" font-family="Times,serif" font-size="14.00">GPU: 3716</text>
</g>
<!-- m4_qkv -->
<g id="node45" class="node">
<title>m4_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="13002.61" cy="-37822.85" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="13002.61" y="-37826.65" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13002.61" y="-37811.65" font-family="Times,serif" font-size="14.00">GPU: 3716</text>
</g>
<!-- m4_ln1&#45;&gt;m4_qkv -->
<g id="edge31" class="edge">
<title>m4_ln1&#45;&gt;m4_qkv</title>
<path fill="none" stroke="black" d="M13002.61,-37927.99C13002.61,-37908.48 13002.61,-37881.54 13002.61,-37859.94"/>
<polygon fill="black" stroke="black" points="13006.11,-37859.83 13002.61,-37849.83 12999.11,-37859.83 13006.11,-37859.83"/>
</g>
<!-- m4_mha -->
<g id="node46" class="node">
<title>m4_mha</title>
<ellipse fill="lightblue" stroke="black" cx="13002.61" cy="-37690.68" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="13002.61" y="-37694.48" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="13002.61" y="-37679.48" font-family="Times,serif" font-size="14.00">GPU: 3716</text>
</g>
<!-- m4_qkv&#45;&gt;m4_mha -->
<g id="edge32" class="edge">
<title>m4_qkv&#45;&gt;m4_mha</title>
<path fill="none" stroke="black" d="M13002.61,-37795.82C13002.61,-37776.31 13002.61,-37749.37 13002.61,-37727.78"/>
<polygon fill="black" stroke="black" points="13006.11,-37727.66 13002.61,-37717.66 12999.11,-37727.66 13006.11,-37727.66"/>
</g>
<!-- m4_out -->
<g id="node47" class="node">
<title>m4_out</title>
<ellipse fill="lightblue" stroke="black" cx="13002.61" cy="-37547.91" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="13002.61" y="-37551.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13002.61" y="-37536.71" font-family="Times,serif" font-size="14.00">GPU: 3716</text>
</g>
<!-- m4_mha&#45;&gt;m4_out -->
<g id="edge33" class="edge">
<title>m4_mha&#45;&gt;m4_out</title>
<path fill="none" stroke="black" d="M13002.61,-37663.53C13002.61,-37641.41 13002.61,-37609.48 13002.61,-37584.93"/>
<polygon fill="black" stroke="black" points="13006.11,-37584.92 13002.61,-37574.92 12999.11,-37584.92 13006.11,-37584.92"/>
</g>
<!-- m4_out&#45;&gt;m4_res1 -->
<g id="edge34" class="edge">
<title>m4_out&#45;&gt;m4_res1</title>
<path fill="none" stroke="black" d="M12980.36,-37521.5C12962.28,-37500.85 12936.65,-37471.59 12917.07,-37449.23"/>
<polygon fill="black" stroke="black" points="12919.64,-37446.86 12910.42,-37441.64 12914.38,-37451.47 12919.64,-37446.86"/>
</g>
<!-- m4_gate -->
<g id="node49" class="node">
<title>m4_gate</title>
<polygon fill="orange" stroke="black" points="12860.23,-37342.26 12655.63,-37342.26 12603,-37236.26 12807.59,-37236.26 12860.23,-37342.26"/>
<text text-anchor="middle" x="12731.61" y="-37300.56" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="12731.61" y="-37285.56" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="12731.61" y="-37270.56" font-family="Times,serif" font-size="14.00">GPU: 3716</text>
</g>
<!-- m4_res1&#45;&gt;m4_gate -->
<g id="edge36" class="edge">
<title>m4_res1&#45;&gt;m4_gate</title>
<path fill="none" stroke="black" d="M12858.34,-37390.74C12843.14,-37378.69 12823.99,-37363.51 12805.22,-37348.63"/>
<polygon fill="black" stroke="black" points="12807.22,-37345.75 12797.21,-37342.28 12802.88,-37351.23 12807.22,-37345.75"/>
</g>
<!-- m4_route -->
<g id="node50" class="node">
<title>m4_route</title>
<ellipse fill="lightgray" stroke="black" cx="12731.61" cy="-37162.79" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="12731.61" y="-37174.09" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="12731.61" y="-37159.09" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="12731.61" y="-37144.09" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m4_res1&#45;&gt;m4_route -->
<g id="edge38" class="edge">
<title>m4_res1&#45;&gt;m4_route</title>
<path fill="none" stroke="black" d="M12892.96,-37388.85C12897.74,-37351.66 12901.04,-37282.53 12869.61,-37236.26 12856.63,-37217.15 12836.96,-37202.73 12816.51,-37191.99"/>
<polygon fill="black" stroke="black" points="12817.91,-37188.78 12807.4,-37187.46 12814.8,-37195.05 12817.91,-37188.78"/>
</g>
<!-- m4_final -->
<g id="node55" class="node">
<title>m4_final</title>
<ellipse fill="lightpink" stroke="black" cx="13305.61" cy="-36839.49" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="13305.61" y="-36843.29" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="13305.61" y="-36828.29" font-family="Times,serif" font-size="14.00">GPU: 3716</text>
</g>
<!-- m4_res1&#45;&gt;m4_final -->
<g id="edge46" class="edge">
<title>m4_res1&#45;&gt;m4_final</title>
<path fill="none" stroke="black" d="M12963.82,-37408.85C13097.28,-37393.85 13361.61,-37341.69 13361.61,-37163.79 13361.61,-37163.79 13361.61,-37163.79 13361.61,-37050.83 13361.61,-36987.51 13337.62,-36916.96 13321.04,-36875.78"/>
<polygon fill="black" stroke="black" points="13324.25,-36874.38 13317.22,-36866.46 13317.78,-36877.04 13324.25,-36874.38"/>
</g>
<!-- m4_gate&#45;&gt;m4_route -->
<g id="edge37" class="edge">
<title>m4_gate&#45;&gt;m4_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12731.61,-37236.2C12731.61,-37227.76 12731.61,-37219.08 12731.61,-37210.78"/>
<polygon fill="black" stroke="black" points="12735.11,-37210.51 12731.61,-37200.51 12728.11,-37210.51 12735.11,-37210.51"/>
</g>
<!-- m4_expert0 -->
<g id="node51" class="node">
<title>m4_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="11815.61" cy="-37051.83" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="11815.61" y="-37063.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11815.61" y="-37048.13" font-family="Times,serif" font-size="14.00">Node 8 GPU 0</text>
<text text-anchor="middle" x="11815.61" y="-37033.13" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m4_route&#45;&gt;m4_expert0 -->
<g id="edge39" class="edge">
<title>m4_route&#45;&gt;m4_expert0</title>
<path fill="none" stroke="black" d="M12637.3,-37150.59C12517.44,-37136.36 12304.16,-37111.04 12121.61,-37089.31 12094.41,-37086.07 12065.84,-37082.67 12037.54,-37079.3"/>
<polygon fill="black" stroke="black" points="12037.89,-37075.82 12027.55,-37078.11 12037.06,-37082.77 12037.89,-37075.82"/>
</g>
<!-- m4_expert1 -->
<g id="node52" class="node">
<title>m4_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="12426.61" cy="-37051.83" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="12426.61" y="-37063.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="12426.61" y="-37048.13" font-family="Times,serif" font-size="14.00">Node 8 GPU 1</text>
<text text-anchor="middle" x="12426.61" y="-37033.13" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m4_route&#45;&gt;m4_expert1 -->
<g id="edge41" class="edge">
<title>m4_route&#45;&gt;m4_expert1</title>
<path fill="none" stroke="black" d="M12660.49,-37136.38C12622.44,-37122.79 12574.83,-37105.78 12532.52,-37090.67"/>
<polygon fill="black" stroke="black" points="12533.61,-37087.34 12523.02,-37087.27 12531.26,-37093.93 12533.61,-37087.34"/>
</g>
<!-- m4_expert2 -->
<g id="node53" class="node">
<title>m4_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="13037.61" cy="-37051.83" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="13037.61" y="-37063.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="13037.61" y="-37048.13" font-family="Times,serif" font-size="14.00">Node 8 GPU 2</text>
<text text-anchor="middle" x="13037.61" y="-37033.13" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m4_route&#45;&gt;m4_expert2 -->
<g id="edge43" class="edge">
<title>m4_route&#45;&gt;m4_expert2</title>
<path fill="none" stroke="black" d="M12802.97,-37136.38C12841.14,-37122.79 12888.9,-37105.78 12931.36,-37090.67"/>
<polygon fill="black" stroke="black" points="12932.64,-37093.92 12940.89,-37087.27 12930.3,-37087.33 12932.64,-37093.92"/>
</g>
<!-- m4_agg -->
<g id="node54" class="node">
<title>m4_agg</title>
<polygon fill="purple" stroke="black" points="12896.23,-36978.36 12635.95,-36978.36 12569,-36902.36 12829.27,-36902.36 12896.23,-36978.36"/>
<text text-anchor="middle" x="12732.61" y="-36944.16" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12732.61" y="-36929.16" font-family="Times,serif" font-size="14.00">GPU: 3716</text>
</g>
<!-- m4_expert0&#45;&gt;m4_agg -->
<g id="edge40" class="edge">
<title>m4_expert0&#45;&gt;m4_agg</title>
<path fill="none" stroke="black" d="M12027.14,-37025.58C12205.91,-37004.24 12456.08,-36974.37 12605.48,-36956.54"/>
<polygon fill="black" stroke="black" points="12606.1,-36959.99 12615.62,-36955.33 12605.27,-36953.04 12606.1,-36959.99"/>
</g>
<!-- m4_expert1&#45;&gt;m4_agg -->
<g id="edge42" class="edge">
<title>m4_expert1&#45;&gt;m4_agg</title>
<path fill="none" stroke="black" d="M12523.01,-37016.35C12555.3,-37004.79 12591.5,-36991.84 12624.62,-36979.99"/>
<polygon fill="black" stroke="black" points="12626.09,-36983.19 12634.33,-36976.52 12623.73,-36976.59 12626.09,-36983.19"/>
</g>
<!-- m4_expert2&#45;&gt;m4_agg -->
<g id="edge44" class="edge">
<title>m4_expert2&#45;&gt;m4_agg</title>
<path fill="none" stroke="black" d="M12941.53,-37016.35C12911.07,-37005.41 12877.11,-36993.22 12845.57,-36981.9"/>
<polygon fill="black" stroke="black" points="12846.47,-36978.51 12835.87,-36978.42 12844.1,-36985.09 12846.47,-36978.51"/>
</g>
<!-- m4_agg&#45;&gt;m4_final -->
<g id="edge45" class="edge">
<title>m4_agg&#45;&gt;m4_final</title>
<path fill="none" stroke="black" d="M12845.13,-36919.94C12951.17,-36901.65 13108.36,-36874.52 13208.9,-36857.18"/>
<polygon fill="black" stroke="black" points="13209.79,-36860.57 13219.05,-36855.42 13208.6,-36853.68 13209.79,-36860.57"/>
</g>
<!-- m5_res1 -->
<g id="node60" class="node">
<title>m5_res1</title>
<ellipse fill="lightpink" stroke="black" cx="13418.61" cy="-36749.75" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="13418.61" y="-36753.55" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13418.61" y="-36738.55" font-family="Times,serif" font-size="14.00">GPU: 3717</text>
</g>
<!-- m4_final&#45;&gt;m5_res1 -->
<g id="edge51" class="edge">
<title>m4_final&#45;&gt;m5_res1</title>
<path fill="none" stroke="black" d="M13337.39,-36813.81C13350.6,-36803.56 13366.05,-36791.56 13379.9,-36780.8"/>
<polygon fill="black" stroke="black" points="13382.1,-36783.53 13387.85,-36774.63 13377.81,-36778 13382.1,-36783.53"/>
</g>
<!-- m5_ln1 -->
<g id="node56" class="node">
<title>m5_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="13532.61" cy="-37162.79" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="13532.61" y="-37166.59" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="13532.61" y="-37151.59" font-family="Times,serif" font-size="14.00">GPU: 3717</text>
</g>
<!-- m5_qkv -->
<g id="node57" class="node">
<title>m5_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="13532.61" cy="-37051.83" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="13532.61" y="-37055.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13532.61" y="-37040.63" font-family="Times,serif" font-size="14.00">GPU: 3717</text>
</g>
<!-- m5_ln1&#45;&gt;m5_qkv -->
<g id="edge47" class="edge">
<title>m5_ln1&#45;&gt;m5_qkv</title>
<path fill="none" stroke="black" d="M13532.61,-37135.69C13532.61,-37121.68 13532.61,-37104.18 13532.61,-37088.89"/>
<polygon fill="black" stroke="black" points="13536.11,-37088.72 13532.61,-37078.72 13529.11,-37088.72 13536.11,-37088.72"/>
</g>
<!-- m5_mha -->
<g id="node58" class="node">
<title>m5_mha</title>
<ellipse fill="lightblue" stroke="black" cx="13532.61" cy="-36940.36" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="13532.61" y="-36944.16" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="13532.61" y="-36929.16" font-family="Times,serif" font-size="14.00">GPU: 3717</text>
</g>
<!-- m5_qkv&#45;&gt;m5_mha -->
<g id="edge48" class="edge">
<title>m5_qkv&#45;&gt;m5_mha</title>
<path fill="none" stroke="black" d="M13532.61,-37024.89C13532.61,-37010.81 13532.61,-36993.19 13532.61,-36977.76"/>
<polygon fill="black" stroke="black" points="13536.11,-36977.5 13532.61,-36967.5 13529.11,-36977.5 13536.11,-36977.5"/>
</g>
<!-- m5_out -->
<g id="node59" class="node">
<title>m5_out</title>
<ellipse fill="lightblue" stroke="black" cx="13532.61" cy="-36839.49" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="13532.61" y="-36843.29" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13532.61" y="-36828.29" font-family="Times,serif" font-size="14.00">GPU: 3717</text>
</g>
<!-- m5_mha&#45;&gt;m5_out -->
<g id="edge49" class="edge">
<title>m5_mha&#45;&gt;m5_out</title>
<path fill="none" stroke="black" d="M13532.61,-36913.38C13532.61,-36902.23 13532.61,-36889.01 13532.61,-36876.9"/>
<polygon fill="black" stroke="black" points="13536.11,-36876.63 13532.61,-36866.63 13529.11,-36876.63 13536.11,-36876.63"/>
</g>
<!-- m5_out&#45;&gt;m5_res1 -->
<g id="edge50" class="edge">
<title>m5_out&#45;&gt;m5_res1</title>
<path fill="none" stroke="black" d="M13500.55,-36813.81C13487.23,-36803.56 13471.64,-36791.56 13457.66,-36780.8"/>
<polygon fill="black" stroke="black" points="13459.7,-36777.96 13449.64,-36774.63 13455.43,-36783.5 13459.7,-36777.96"/>
</g>
<!-- m5_gate -->
<g id="node61" class="node">
<title>m5_gate</title>
<polygon fill="orange" stroke="black" points="13390.23,-36686.88 13185.63,-36686.88 13133,-36580.88 13337.59,-36580.88 13390.23,-36686.88"/>
<text text-anchor="middle" x="13261.61" y="-36645.18" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="13261.61" y="-36630.18" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="13261.61" y="-36615.18" font-family="Times,serif" font-size="14.00">GPU: 3717</text>
</g>
<!-- m5_res1&#45;&gt;m5_gate -->
<g id="edge52" class="edge">
<title>m5_res1&#45;&gt;m5_gate</title>
<path fill="none" stroke="black" d="M13386.08,-36725.15C13373.08,-36715.72 13357.48,-36704.41 13341.79,-36693.03"/>
<polygon fill="black" stroke="black" points="13343.74,-36690.12 13333.59,-36687.08 13339.63,-36695.79 13343.74,-36690.12"/>
</g>
<!-- m5_route -->
<g id="node62" class="node">
<title>m5_route</title>
<ellipse fill="lightgray" stroke="black" cx="13261.61" cy="-36507.4" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="13261.61" y="-36518.7" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="13261.61" y="-36503.7" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="13261.61" y="-36488.7" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m5_res1&#45;&gt;m5_route -->
<g id="edge54" class="edge">
<title>m5_res1&#45;&gt;m5_route</title>
<path fill="none" stroke="black" d="M13422.67,-36722.9C13426.79,-36687.57 13428.92,-36623.73 13399.61,-36580.88 13386.5,-36561.71 13366.68,-36547.25 13346.11,-36536.5"/>
<polygon fill="black" stroke="black" points="13347.47,-36533.26 13336.95,-36531.96 13344.36,-36539.54 13347.47,-36533.26"/>
</g>
<!-- m5_final -->
<g id="node67" class="node">
<title>m5_final</title>
<ellipse fill="lightpink" stroke="black" cx="13834.61" cy="-36184.1" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="13834.61" y="-36187.9" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="13834.61" y="-36172.9" font-family="Times,serif" font-size="14.00">GPU: 3717</text>
</g>
<!-- m5_res1&#45;&gt;m5_final -->
<g id="edge62" class="edge">
<title>m5_res1&#45;&gt;m5_final</title>
<path fill="none" stroke="black" d="M13494.71,-36744.08C13628.21,-36731.32 13890.61,-36683.92 13890.61,-36508.4 13890.61,-36508.4 13890.61,-36508.4 13890.61,-36395.45 13890.61,-36332.12 13866.62,-36261.58 13850.04,-36220.39"/>
<polygon fill="black" stroke="black" points="13853.25,-36218.99 13846.22,-36211.07 13846.78,-36221.65 13853.25,-36218.99"/>
</g>
<!-- m5_gate&#45;&gt;m5_route -->
<g id="edge53" class="edge">
<title>m5_gate&#45;&gt;m5_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13261.61,-36580.81C13261.61,-36572.38 13261.61,-36563.69 13261.61,-36555.39"/>
<polygon fill="black" stroke="black" points="13265.11,-36555.13 13261.61,-36545.13 13258.11,-36555.13 13265.11,-36555.13"/>
</g>
<!-- m5_expert0 -->
<g id="node63" class="node">
<title>m5_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="12344.61" cy="-36396.45" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="12344.61" y="-36407.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="12344.61" y="-36392.75" font-family="Times,serif" font-size="14.00">Node 16 GPU 0</text>
<text text-anchor="middle" x="12344.61" y="-36377.75" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m5_route&#45;&gt;m5_expert0 -->
<g id="edge55" class="edge">
<title>m5_route&#45;&gt;m5_expert0</title>
<path fill="none" stroke="black" d="M13167.15,-36495.21C13047.09,-36480.99 12833.46,-36455.67 12650.61,-36433.92 12623.41,-36430.69 12594.84,-36427.29 12566.54,-36423.92"/>
<polygon fill="black" stroke="black" points="12566.89,-36420.44 12556.55,-36422.73 12566.06,-36427.39 12566.89,-36420.44"/>
</g>
<!-- m5_expert1 -->
<g id="node64" class="node">
<title>m5_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="12955.61" cy="-36396.45" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="12955.61" y="-36407.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="12955.61" y="-36392.75" font-family="Times,serif" font-size="14.00">Node 16 GPU 1</text>
<text text-anchor="middle" x="12955.61" y="-36377.75" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m5_route&#45;&gt;m5_expert1 -->
<g id="edge57" class="edge">
<title>m5_route&#45;&gt;m5_expert1</title>
<path fill="none" stroke="black" d="M13190.26,-36480.99C13152.08,-36467.4 13104.32,-36450.4 13061.87,-36435.28"/>
<polygon fill="black" stroke="black" points="13062.93,-36431.94 13052.33,-36431.89 13060.58,-36438.54 13062.93,-36431.94"/>
</g>
<!-- m5_expert2 -->
<g id="node65" class="node">
<title>m5_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="13566.61" cy="-36396.45" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="13566.61" y="-36407.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="13566.61" y="-36392.75" font-family="Times,serif" font-size="14.00">Node 16 GPU 2</text>
<text text-anchor="middle" x="13566.61" y="-36377.75" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m5_route&#45;&gt;m5_expert2 -->
<g id="edge59" class="edge">
<title>m5_route&#45;&gt;m5_expert2</title>
<path fill="none" stroke="black" d="M13332.74,-36480.99C13370.78,-36467.4 13418.39,-36450.4 13460.7,-36435.28"/>
<polygon fill="black" stroke="black" points="13461.97,-36438.55 13470.21,-36431.89 13459.61,-36431.95 13461.97,-36438.55"/>
</g>
<!-- m5_agg -->
<g id="node66" class="node">
<title>m5_agg</title>
<polygon fill="purple" stroke="black" points="13425.23,-36322.97 13164.95,-36322.97 13098,-36246.97 13358.27,-36246.97 13425.23,-36322.97"/>
<text text-anchor="middle" x="13261.61" y="-36288.77" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13261.61" y="-36273.77" font-family="Times,serif" font-size="14.00">GPU: 3717</text>
</g>
<!-- m5_expert0&#45;&gt;m5_agg -->
<g id="edge56" class="edge">
<title>m5_expert0&#45;&gt;m5_agg</title>
<path fill="none" stroke="black" d="M12556.14,-36370.19C12734.91,-36348.85 12985.08,-36318.99 13134.48,-36301.15"/>
<polygon fill="black" stroke="black" points="13135.1,-36304.6 13144.62,-36299.94 13134.27,-36297.65 13135.1,-36304.6"/>
</g>
<!-- m5_expert1&#45;&gt;m5_agg -->
<g id="edge58" class="edge">
<title>m5_expert1&#45;&gt;m5_agg</title>
<path fill="none" stroke="black" d="M13052.01,-36360.96C13084.3,-36349.41 13120.5,-36336.46 13153.62,-36324.61"/>
<polygon fill="black" stroke="black" points="13155.09,-36327.8 13163.33,-36321.13 13152.73,-36321.21 13155.09,-36327.8"/>
</g>
<!-- m5_expert2&#45;&gt;m5_agg -->
<g id="edge60" class="edge">
<title>m5_expert2&#45;&gt;m5_agg</title>
<path fill="none" stroke="black" d="M13470.53,-36360.96C13440.07,-36350.03 13406.11,-36337.84 13374.57,-36326.52"/>
<polygon fill="black" stroke="black" points="13375.47,-36323.12 13364.87,-36323.03 13373.1,-36329.71 13375.47,-36323.12"/>
</g>
<!-- m5_agg&#45;&gt;m5_final -->
<g id="edge61" class="edge">
<title>m5_agg&#45;&gt;m5_final</title>
<path fill="none" stroke="black" d="M13374.13,-36264.56C13480.17,-36246.26 13637.36,-36219.14 13737.9,-36201.79"/>
<polygon fill="black" stroke="black" points="13738.79,-36205.19 13748.05,-36200.04 13737.6,-36198.29 13738.79,-36205.19"/>
</g>
<!-- m6_res1 -->
<g id="node72" class="node">
<title>m6_res1</title>
<ellipse fill="lightpink" stroke="black" cx="13947.61" cy="-36094.36" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="13947.61" y="-36098.16" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13947.61" y="-36083.16" font-family="Times,serif" font-size="14.00">GPU: 3718</text>
</g>
<!-- m5_final&#45;&gt;m6_res1 -->
<g id="edge67" class="edge">
<title>m5_final&#45;&gt;m6_res1</title>
<path fill="none" stroke="black" d="M13866.39,-36158.43C13879.6,-36148.17 13895.05,-36136.18 13908.9,-36125.42"/>
<polygon fill="black" stroke="black" points="13911.1,-36128.14 13916.85,-36119.24 13906.81,-36122.61 13911.1,-36128.14"/>
</g>
<!-- m6_ln1 -->
<g id="node68" class="node">
<title>m6_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="14061.61" cy="-36507.4" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="14061.61" y="-36511.2" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14061.61" y="-36496.2" font-family="Times,serif" font-size="14.00">GPU: 3718</text>
</g>
<!-- m6_qkv -->
<g id="node69" class="node">
<title>m6_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="14061.61" cy="-36396.45" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="14061.61" y="-36400.25" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14061.61" y="-36385.25" font-family="Times,serif" font-size="14.00">GPU: 3718</text>
</g>
<!-- m6_ln1&#45;&gt;m6_qkv -->
<g id="edge63" class="edge">
<title>m6_ln1&#45;&gt;m6_qkv</title>
<path fill="none" stroke="black" d="M14061.61,-36480.3C14061.61,-36466.29 14061.61,-36448.8 14061.61,-36433.5"/>
<polygon fill="black" stroke="black" points="14065.11,-36433.33 14061.61,-36423.33 14058.11,-36433.33 14065.11,-36433.33"/>
</g>
<!-- m6_mha -->
<g id="node70" class="node">
<title>m6_mha</title>
<ellipse fill="lightblue" stroke="black" cx="14061.61" cy="-36284.97" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14061.61" y="-36288.77" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="14061.61" y="-36273.77" font-family="Times,serif" font-size="14.00">GPU: 3718</text>
</g>
<!-- m6_qkv&#45;&gt;m6_mha -->
<g id="edge64" class="edge">
<title>m6_qkv&#45;&gt;m6_mha</title>
<path fill="none" stroke="black" d="M14061.61,-36369.5C14061.61,-36355.43 14061.61,-36337.8 14061.61,-36322.37"/>
<polygon fill="black" stroke="black" points="14065.11,-36322.11 14061.61,-36312.11 14058.11,-36322.11 14065.11,-36322.11"/>
</g>
<!-- m6_out -->
<g id="node71" class="node">
<title>m6_out</title>
<ellipse fill="lightblue" stroke="black" cx="14061.61" cy="-36184.1" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="14061.61" y="-36187.9" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14061.61" y="-36172.9" font-family="Times,serif" font-size="14.00">GPU: 3718</text>
</g>
<!-- m6_mha&#45;&gt;m6_out -->
<g id="edge65" class="edge">
<title>m6_mha&#45;&gt;m6_out</title>
<path fill="none" stroke="black" d="M14061.61,-36257.99C14061.61,-36246.84 14061.61,-36233.62 14061.61,-36221.52"/>
<polygon fill="black" stroke="black" points="14065.11,-36221.25 14061.61,-36211.25 14058.11,-36221.25 14065.11,-36221.25"/>
</g>
<!-- m6_out&#45;&gt;m6_res1 -->
<g id="edge66" class="edge">
<title>m6_out&#45;&gt;m6_res1</title>
<path fill="none" stroke="black" d="M14029.55,-36158.43C14016.23,-36148.17 14000.64,-36136.18 13986.66,-36125.42"/>
<polygon fill="black" stroke="black" points="13988.7,-36122.57 13978.64,-36119.24 13984.43,-36128.12 13988.7,-36122.57"/>
</g>
<!-- m6_gate -->
<g id="node73" class="node">
<title>m6_gate</title>
<polygon fill="orange" stroke="black" points="13919.23,-36031.49 13714.63,-36031.49 13662,-35925.49 13866.59,-35925.49 13919.23,-36031.49"/>
<text text-anchor="middle" x="13790.61" y="-35989.79" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="13790.61" y="-35974.79" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="13790.61" y="-35959.79" font-family="Times,serif" font-size="14.00">GPU: 3718</text>
</g>
<!-- m6_res1&#45;&gt;m6_gate -->
<g id="edge68" class="edge">
<title>m6_res1&#45;&gt;m6_gate</title>
<path fill="none" stroke="black" d="M13915.08,-36069.77C13902.08,-36060.34 13886.48,-36049.02 13870.79,-36037.64"/>
<polygon fill="black" stroke="black" points="13872.74,-36034.73 13862.59,-36031.7 13868.63,-36040.4 13872.74,-36034.73"/>
</g>
<!-- m6_route -->
<g id="node74" class="node">
<title>m6_route</title>
<ellipse fill="lightgray" stroke="black" cx="13790.61" cy="-35852.01" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="13790.61" y="-35863.31" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="13790.61" y="-35848.31" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="13790.61" y="-35833.31" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m6_res1&#45;&gt;m6_route -->
<g id="edge70" class="edge">
<title>m6_res1&#45;&gt;m6_route</title>
<path fill="none" stroke="black" d="M13951.67,-36067.51C13955.79,-36032.19 13957.92,-35968.34 13928.61,-35925.49 13915.5,-35906.33 13895.68,-35891.87 13875.11,-35881.11"/>
<polygon fill="black" stroke="black" points="13876.47,-35877.88 13865.95,-35876.58 13873.36,-35884.15 13876.47,-35877.88"/>
</g>
<!-- m6_final -->
<g id="node79" class="node">
<title>m6_final</title>
<ellipse fill="lightpink" stroke="black" cx="14363.61" cy="-35528.71" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="14363.61" y="-35532.51" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="14363.61" y="-35517.51" font-family="Times,serif" font-size="14.00">GPU: 3718</text>
</g>
<!-- m6_res1&#45;&gt;m6_final -->
<g id="edge78" class="edge">
<title>m6_res1&#45;&gt;m6_final</title>
<path fill="none" stroke="black" d="M14023.71,-36088.69C14157.21,-36075.93 14419.61,-36028.54 14419.61,-35853.01 14419.61,-35853.01 14419.61,-35853.01 14419.61,-35740.06 14419.61,-35676.74 14395.62,-35606.19 14379.04,-35565.01"/>
<polygon fill="black" stroke="black" points="14382.25,-35563.61 14375.22,-35555.69 14375.78,-35566.27 14382.25,-35563.61"/>
</g>
<!-- m6_gate&#45;&gt;m6_route -->
<g id="edge69" class="edge">
<title>m6_gate&#45;&gt;m6_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13790.61,-35925.42C13790.61,-35916.99 13790.61,-35908.3 13790.61,-35900"/>
<polygon fill="black" stroke="black" points="13794.11,-35899.74 13790.61,-35889.74 13787.11,-35899.74 13794.11,-35899.74"/>
</g>
<!-- m6_expert0 -->
<g id="node75" class="node">
<title>m6_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="12873.61" cy="-35741.06" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="12873.61" y="-35752.36" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="12873.61" y="-35737.36" font-family="Times,serif" font-size="14.00">Node 24 GPU 0</text>
<text text-anchor="middle" x="12873.61" y="-35722.36" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m6_route&#45;&gt;m6_expert0 -->
<g id="edge71" class="edge">
<title>m6_route&#45;&gt;m6_expert0</title>
<path fill="none" stroke="black" d="M13696.15,-35839.83C13576.09,-35825.6 13362.46,-35800.28 13179.61,-35778.54 13152.41,-35775.3 13123.84,-35771.9 13095.54,-35768.53"/>
<polygon fill="black" stroke="black" points="13095.89,-35765.05 13085.55,-35767.34 13095.06,-35772 13095.89,-35765.05"/>
</g>
<!-- m6_expert1 -->
<g id="node76" class="node">
<title>m6_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="13484.61" cy="-35741.06" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="13484.61" y="-35752.36" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="13484.61" y="-35737.36" font-family="Times,serif" font-size="14.00">Node 24 GPU 1</text>
<text text-anchor="middle" x="13484.61" y="-35722.36" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m6_route&#45;&gt;m6_expert1 -->
<g id="edge73" class="edge">
<title>m6_route&#45;&gt;m6_expert1</title>
<path fill="none" stroke="black" d="M13719.26,-35825.61C13681.08,-35812.02 13633.32,-35795.01 13590.87,-35779.89"/>
<polygon fill="black" stroke="black" points="13591.93,-35776.56 13581.33,-35776.5 13589.58,-35783.15 13591.93,-35776.56"/>
</g>
<!-- m6_expert2 -->
<g id="node77" class="node">
<title>m6_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="14095.61" cy="-35741.06" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="14095.61" y="-35752.36" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="14095.61" y="-35737.36" font-family="Times,serif" font-size="14.00">Node 24 GPU 2</text>
<text text-anchor="middle" x="14095.61" y="-35722.36" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m6_route&#45;&gt;m6_expert2 -->
<g id="edge75" class="edge">
<title>m6_route&#45;&gt;m6_expert2</title>
<path fill="none" stroke="black" d="M13861.74,-35825.61C13899.78,-35812.02 13947.39,-35795.01 13989.7,-35779.89"/>
<polygon fill="black" stroke="black" points="13990.97,-35783.16 13999.21,-35776.5 13988.61,-35776.57 13990.97,-35783.16"/>
</g>
<!-- m6_agg -->
<g id="node78" class="node">
<title>m6_agg</title>
<polygon fill="purple" stroke="black" points="13953.23,-35667.58 13692.95,-35667.58 13626,-35591.58 13886.27,-35591.58 13953.23,-35667.58"/>
<text text-anchor="middle" x="13789.61" y="-35633.38" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13789.61" y="-35618.38" font-family="Times,serif" font-size="14.00">GPU: 3718</text>
</g>
<!-- m6_expert0&#45;&gt;m6_agg -->
<g id="edge72" class="edge">
<title>m6_expert0&#45;&gt;m6_agg</title>
<path fill="none" stroke="black" d="M13085.2,-35714.77C13263.66,-35693.44 13513.19,-35663.62 13662.38,-35645.79"/>
<polygon fill="black" stroke="black" points="13662.99,-35649.24 13672.5,-35644.58 13662.16,-35642.29 13662.99,-35649.24"/>
</g>
<!-- m6_expert1&#45;&gt;m6_agg -->
<g id="edge74" class="edge">
<title>m6_expert1&#45;&gt;m6_agg</title>
<path fill="none" stroke="black" d="M13580.7,-35705.57C13612.8,-35694.05 13648.79,-35681.13 13681.73,-35669.31"/>
<polygon fill="black" stroke="black" points="13683.16,-35672.51 13691.39,-35665.84 13680.79,-35665.93 13683.16,-35672.51"/>
</g>
<!-- m6_expert2&#45;&gt;m6_agg -->
<g id="edge76" class="edge">
<title>m6_expert2&#45;&gt;m6_agg</title>
<path fill="none" stroke="black" d="M13999.21,-35705.57C13968.65,-35694.64 13934.58,-35682.45 13902.94,-35671.13"/>
<polygon fill="black" stroke="black" points="13903.8,-35667.72 13893.21,-35667.65 13901.45,-35674.31 13903.8,-35667.72"/>
</g>
<!-- m6_agg&#45;&gt;m6_final -->
<g id="edge77" class="edge">
<title>m6_agg&#45;&gt;m6_final</title>
<path fill="none" stroke="black" d="M13901.99,-35609.23C14008.43,-35590.89 14166.58,-35563.65 14267.37,-35546.29"/>
<polygon fill="black" stroke="black" points="14267.98,-35549.74 14277.24,-35544.59 14266.79,-35542.84 14267.98,-35549.74"/>
</g>
<!-- m7_res1 -->
<g id="node84" class="node">
<title>m7_res1</title>
<ellipse fill="lightpink" stroke="black" cx="14476.61" cy="-35438.97" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="14476.61" y="-35442.77" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14476.61" y="-35427.77" font-family="Times,serif" font-size="14.00">GPU: 3719</text>
</g>
<!-- m6_final&#45;&gt;m7_res1 -->
<g id="edge83" class="edge">
<title>m6_final&#45;&gt;m7_res1</title>
<path fill="none" stroke="black" d="M14395.39,-35503.04C14408.6,-35492.79 14424.05,-35480.79 14437.9,-35470.03"/>
<polygon fill="black" stroke="black" points="14440.1,-35472.76 14445.85,-35463.86 14435.81,-35467.23 14440.1,-35472.76"/>
</g>
<!-- m7_ln1 -->
<g id="node80" class="node">
<title>m7_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="14590.61" cy="-35852.01" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="14590.61" y="-35855.81" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="14590.61" y="-35840.81" font-family="Times,serif" font-size="14.00">GPU: 3719</text>
</g>
<!-- m7_qkv -->
<g id="node81" class="node">
<title>m7_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="14590.61" cy="-35741.06" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="14590.61" y="-35744.86" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14590.61" y="-35729.86" font-family="Times,serif" font-size="14.00">GPU: 3719</text>
</g>
<!-- m7_ln1&#45;&gt;m7_qkv -->
<g id="edge79" class="edge">
<title>m7_ln1&#45;&gt;m7_qkv</title>
<path fill="none" stroke="black" d="M14590.61,-35824.92C14590.61,-35810.9 14590.61,-35793.41 14590.61,-35778.11"/>
<polygon fill="black" stroke="black" points="14594.11,-35777.95 14590.61,-35767.95 14587.11,-35777.95 14594.11,-35777.95"/>
</g>
<!-- m7_mha -->
<g id="node82" class="node">
<title>m7_mha</title>
<ellipse fill="lightblue" stroke="black" cx="14590.61" cy="-35629.58" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="14590.61" y="-35633.38" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="14590.61" y="-35618.38" font-family="Times,serif" font-size="14.00">GPU: 3719</text>
</g>
<!-- m7_qkv&#45;&gt;m7_mha -->
<g id="edge80" class="edge">
<title>m7_qkv&#45;&gt;m7_mha</title>
<path fill="none" stroke="black" d="M14590.61,-35714.12C14590.61,-35700.04 14590.61,-35682.41 14590.61,-35666.98"/>
<polygon fill="black" stroke="black" points="14594.11,-35666.72 14590.61,-35656.72 14587.11,-35666.72 14594.11,-35666.72"/>
</g>
<!-- m7_out -->
<g id="node83" class="node">
<title>m7_out</title>
<ellipse fill="lightblue" stroke="black" cx="14590.61" cy="-35528.71" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="14590.61" y="-35532.51" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14590.61" y="-35517.51" font-family="Times,serif" font-size="14.00">GPU: 3719</text>
</g>
<!-- m7_mha&#45;&gt;m7_out -->
<g id="edge81" class="edge">
<title>m7_mha&#45;&gt;m7_out</title>
<path fill="none" stroke="black" d="M14590.61,-35602.61C14590.61,-35591.46 14590.61,-35578.23 14590.61,-35566.13"/>
<polygon fill="black" stroke="black" points="14594.11,-35565.86 14590.61,-35555.86 14587.11,-35565.86 14594.11,-35565.86"/>
</g>
<!-- m7_out&#45;&gt;m7_res1 -->
<g id="edge82" class="edge">
<title>m7_out&#45;&gt;m7_res1</title>
<path fill="none" stroke="black" d="M14558.55,-35503.04C14545.23,-35492.79 14529.64,-35480.79 14515.66,-35470.03"/>
<polygon fill="black" stroke="black" points="14517.7,-35467.18 14507.64,-35463.86 14513.43,-35472.73 14517.7,-35467.18"/>
</g>
<!-- m7_gate -->
<g id="node85" class="node">
<title>m7_gate</title>
<polygon fill="orange" stroke="black" points="14448.23,-35376.1 14243.63,-35376.1 14191,-35270.1 14395.59,-35270.1 14448.23,-35376.1"/>
<text text-anchor="middle" x="14319.61" y="-35334.4" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="14319.61" y="-35319.4" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="14319.61" y="-35304.4" font-family="Times,serif" font-size="14.00">GPU: 3719</text>
</g>
<!-- m7_res1&#45;&gt;m7_gate -->
<g id="edge84" class="edge">
<title>m7_res1&#45;&gt;m7_gate</title>
<path fill="none" stroke="black" d="M14444.08,-35414.38C14431.08,-35404.95 14415.48,-35393.63 14399.79,-35382.26"/>
<polygon fill="black" stroke="black" points="14401.74,-35379.35 14391.59,-35376.31 14397.63,-35385.01 14401.74,-35379.35"/>
</g>
<!-- m7_route -->
<g id="node86" class="node">
<title>m7_route</title>
<ellipse fill="lightgray" stroke="black" cx="14319.61" cy="-35196.63" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="14319.61" y="-35207.93" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="14319.61" y="-35192.93" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="14319.61" y="-35177.93" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m7_res1&#45;&gt;m7_route -->
<g id="edge86" class="edge">
<title>m7_res1&#45;&gt;m7_route</title>
<path fill="none" stroke="black" d="M14480.67,-35412.12C14484.79,-35376.8 14486.92,-35312.95 14457.61,-35270.1 14444.5,-35250.94 14424.68,-35236.48 14404.11,-35225.72"/>
<polygon fill="black" stroke="black" points="14405.47,-35222.49 14394.95,-35221.19 14402.36,-35228.76 14405.47,-35222.49"/>
</g>
<!-- m7_final -->
<g id="node91" class="node">
<title>m7_final</title>
<ellipse fill="lightpink" stroke="black" cx="14892.61" cy="-34873.33" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="14892.61" y="-34877.13" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="14892.61" y="-34862.13" font-family="Times,serif" font-size="14.00">GPU: 3719</text>
</g>
<!-- m7_res1&#45;&gt;m7_final -->
<g id="edge94" class="edge">
<title>m7_res1&#45;&gt;m7_final</title>
<path fill="none" stroke="black" d="M14552.71,-35433.3C14686.21,-35420.55 14948.61,-35373.15 14948.61,-35197.63 14948.61,-35197.63 14948.61,-35197.63 14948.61,-35084.67 14948.61,-35021.35 14924.62,-34950.8 14908.04,-34909.62"/>
<polygon fill="black" stroke="black" points="14911.25,-34908.22 14904.22,-34900.3 14904.78,-34910.88 14911.25,-34908.22"/>
</g>
<!-- m7_gate&#45;&gt;m7_route -->
<g id="edge85" class="edge">
<title>m7_gate&#45;&gt;m7_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14319.61,-35270.04C14319.61,-35261.6 14319.61,-35252.92 14319.61,-35244.61"/>
<polygon fill="black" stroke="black" points="14323.11,-35244.35 14319.61,-35234.35 14316.11,-35244.35 14323.11,-35244.35"/>
</g>
<!-- m7_expert0 -->
<g id="node87" class="node">
<title>m7_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="13402.61" cy="-35085.67" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="13402.61" y="-35096.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13402.61" y="-35081.97" font-family="Times,serif" font-size="14.00">Node 32 GPU 0</text>
<text text-anchor="middle" x="13402.61" y="-35066.97" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m7_route&#45;&gt;m7_expert0 -->
<g id="edge87" class="edge">
<title>m7_route&#45;&gt;m7_expert0</title>
<path fill="none" stroke="black" d="M14225.15,-35184.44C14105.09,-35170.22 13891.46,-35144.89 13708.61,-35123.15 13681.41,-35119.92 13652.84,-35116.51 13624.54,-35113.14"/>
<polygon fill="black" stroke="black" points="13624.89,-35109.66 13614.55,-35111.95 13624.06,-35116.61 13624.89,-35109.66"/>
</g>
<!-- m7_expert1 -->
<g id="node88" class="node">
<title>m7_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="14013.61" cy="-35085.67" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="14013.61" y="-35096.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14013.61" y="-35081.97" font-family="Times,serif" font-size="14.00">Node 32 GPU 1</text>
<text text-anchor="middle" x="14013.61" y="-35066.97" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m7_route&#45;&gt;m7_expert1 -->
<g id="edge89" class="edge">
<title>m7_route&#45;&gt;m7_expert1</title>
<path fill="none" stroke="black" d="M14248.26,-35170.22C14210.08,-35156.63 14162.32,-35139.62 14119.87,-35124.51"/>
<polygon fill="black" stroke="black" points="14120.93,-35121.17 14110.33,-35121.11 14118.58,-35127.76 14120.93,-35121.17"/>
</g>
<!-- m7_expert2 -->
<g id="node89" class="node">
<title>m7_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="14624.61" cy="-35085.67" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="14624.61" y="-35096.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="14624.61" y="-35081.97" font-family="Times,serif" font-size="14.00">Node 32 GPU 2</text>
<text text-anchor="middle" x="14624.61" y="-35066.97" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m7_route&#45;&gt;m7_expert2 -->
<g id="edge91" class="edge">
<title>m7_route&#45;&gt;m7_expert2</title>
<path fill="none" stroke="black" d="M14390.74,-35170.22C14428.78,-35156.63 14476.39,-35139.62 14518.7,-35124.51"/>
<polygon fill="black" stroke="black" points="14519.97,-35127.77 14528.21,-35121.11 14517.61,-35121.18 14519.97,-35127.77"/>
</g>
<!-- m7_agg -->
<g id="node90" class="node">
<title>m7_agg</title>
<polygon fill="purple" stroke="black" points="14483.23,-35012.2 14222.95,-35012.2 14156,-34936.2 14416.27,-34936.2 14483.23,-35012.2"/>
<text text-anchor="middle" x="14319.61" y="-34978" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14319.61" y="-34963" font-family="Times,serif" font-size="14.00">GPU: 3719</text>
</g>
<!-- m7_expert0&#45;&gt;m7_agg -->
<g id="edge88" class="edge">
<title>m7_expert0&#45;&gt;m7_agg</title>
<path fill="none" stroke="black" d="M13614.14,-35059.42C13792.91,-35038.08 14043.08,-35008.21 14192.48,-34990.38"/>
<polygon fill="black" stroke="black" points="14193.1,-34993.83 14202.62,-34989.16 14192.27,-34986.88 14193.1,-34993.83"/>
</g>
<!-- m7_expert1&#45;&gt;m7_agg -->
<g id="edge90" class="edge">
<title>m7_expert1&#45;&gt;m7_agg</title>
<path fill="none" stroke="black" d="M14110.01,-35050.19C14142.3,-35038.63 14178.5,-35025.68 14211.62,-35013.83"/>
<polygon fill="black" stroke="black" points="14213.09,-35017.02 14221.33,-35010.36 14210.73,-35010.43 14213.09,-35017.02"/>
</g>
<!-- m7_expert2&#45;&gt;m7_agg -->
<g id="edge92" class="edge">
<title>m7_expert2&#45;&gt;m7_agg</title>
<path fill="none" stroke="black" d="M14528.53,-35050.19C14498.07,-35039.25 14464.11,-35027.06 14432.57,-35015.74"/>
<polygon fill="black" stroke="black" points="14433.47,-35012.35 14422.87,-35012.26 14431.1,-35018.93 14433.47,-35012.35"/>
</g>
<!-- m7_agg&#45;&gt;m7_final -->
<g id="edge93" class="edge">
<title>m7_agg&#45;&gt;m7_final</title>
<path fill="none" stroke="black" d="M14432.13,-34953.78C14538.17,-34935.49 14695.36,-34908.36 14795.9,-34891.02"/>
<polygon fill="black" stroke="black" points="14796.79,-34894.41 14806.05,-34889.26 14795.6,-34887.51 14796.79,-34894.41"/>
</g>
<!-- m8_res1 -->
<g id="node96" class="node">
<title>m8_res1</title>
<ellipse fill="lightpink" stroke="black" cx="15005.61" cy="-34783.59" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="15005.61" y="-34787.39" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15005.61" y="-34772.39" font-family="Times,serif" font-size="14.00">GPU: 3720</text>
</g>
<!-- m7_final&#45;&gt;m8_res1 -->
<g id="edge99" class="edge">
<title>m7_final&#45;&gt;m8_res1</title>
<path fill="none" stroke="black" d="M14924.39,-34847.65C14937.6,-34837.4 14953.05,-34825.4 14966.9,-34814.64"/>
<polygon fill="black" stroke="black" points="14969.1,-34817.37 14974.85,-34808.47 14964.81,-34811.84 14969.1,-34817.37"/>
</g>
<!-- m8_ln1 -->
<g id="node92" class="node">
<title>m8_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="15119.61" cy="-35196.63" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="15119.61" y="-35200.43" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15119.61" y="-35185.43" font-family="Times,serif" font-size="14.00">GPU: 3720</text>
</g>
<!-- m8_qkv -->
<g id="node93" class="node">
<title>m8_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="15119.61" cy="-35085.67" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="15119.61" y="-35089.47" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15119.61" y="-35074.47" font-family="Times,serif" font-size="14.00">GPU: 3720</text>
</g>
<!-- m8_ln1&#45;&gt;m8_qkv -->
<g id="edge95" class="edge">
<title>m8_ln1&#45;&gt;m8_qkv</title>
<path fill="none" stroke="black" d="M15119.61,-35169.53C15119.61,-35155.52 15119.61,-35138.02 15119.61,-35122.73"/>
<polygon fill="black" stroke="black" points="15123.11,-35122.56 15119.61,-35112.56 15116.11,-35122.56 15123.11,-35122.56"/>
</g>
<!-- m8_mha -->
<g id="node94" class="node">
<title>m8_mha</title>
<ellipse fill="lightblue" stroke="black" cx="15119.61" cy="-34974.2" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="15119.61" y="-34978" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="15119.61" y="-34963" font-family="Times,serif" font-size="14.00">GPU: 3720</text>
</g>
<!-- m8_qkv&#45;&gt;m8_mha -->
<g id="edge96" class="edge">
<title>m8_qkv&#45;&gt;m8_mha</title>
<path fill="none" stroke="black" d="M15119.61,-35058.73C15119.61,-35044.65 15119.61,-35027.03 15119.61,-35011.6"/>
<polygon fill="black" stroke="black" points="15123.11,-35011.34 15119.61,-35001.34 15116.11,-35011.34 15123.11,-35011.34"/>
</g>
<!-- m8_out -->
<g id="node95" class="node">
<title>m8_out</title>
<ellipse fill="lightblue" stroke="black" cx="15119.61" cy="-34873.33" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="15119.61" y="-34877.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15119.61" y="-34862.13" font-family="Times,serif" font-size="14.00">GPU: 3720</text>
</g>
<!-- m8_mha&#45;&gt;m8_out -->
<g id="edge97" class="edge">
<title>m8_mha&#45;&gt;m8_out</title>
<path fill="none" stroke="black" d="M15119.61,-34947.22C15119.61,-34936.07 15119.61,-34922.84 15119.61,-34910.74"/>
<polygon fill="black" stroke="black" points="15123.11,-34910.47 15119.61,-34900.47 15116.11,-34910.47 15123.11,-34910.47"/>
</g>
<!-- m8_out&#45;&gt;m8_res1 -->
<g id="edge98" class="edge">
<title>m8_out&#45;&gt;m8_res1</title>
<path fill="none" stroke="black" d="M15087.55,-34847.65C15074.23,-34837.4 15058.64,-34825.4 15044.66,-34814.64"/>
<polygon fill="black" stroke="black" points="15046.7,-34811.8 15036.64,-34808.47 15042.43,-34817.34 15046.7,-34811.8"/>
</g>
<!-- m8_gate -->
<g id="node97" class="node">
<title>m8_gate</title>
<polygon fill="orange" stroke="black" points="14977.23,-34720.72 14772.63,-34720.72 14720,-34614.72 14924.59,-34614.72 14977.23,-34720.72"/>
<text text-anchor="middle" x="14848.61" y="-34679.02" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="14848.61" y="-34664.02" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="14848.61" y="-34649.02" font-family="Times,serif" font-size="14.00">GPU: 3720</text>
</g>
<!-- m8_res1&#45;&gt;m8_gate -->
<g id="edge100" class="edge">
<title>m8_res1&#45;&gt;m8_gate</title>
<path fill="none" stroke="black" d="M14973.08,-34758.99C14960.08,-34749.56 14944.48,-34738.25 14928.79,-34726.87"/>
<polygon fill="black" stroke="black" points="14930.74,-34723.96 14920.59,-34720.92 14926.63,-34729.63 14930.74,-34723.96"/>
</g>
<!-- m8_route -->
<g id="node98" class="node">
<title>m8_route</title>
<ellipse fill="lightgray" stroke="black" cx="14848.61" cy="-34541.24" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="14848.61" y="-34552.54" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="14848.61" y="-34537.54" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="14848.61" y="-34522.54" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m8_res1&#45;&gt;m8_route -->
<g id="edge102" class="edge">
<title>m8_res1&#45;&gt;m8_route</title>
<path fill="none" stroke="black" d="M15009.67,-34756.74C15013.79,-34721.41 15015.92,-34657.57 14986.61,-34614.72 14973.5,-34595.55 14953.68,-34581.09 14933.11,-34570.34"/>
<polygon fill="black" stroke="black" points="14934.47,-34567.1 14923.95,-34565.8 14931.36,-34573.38 14934.47,-34567.1"/>
</g>
<!-- m8_final -->
<g id="node103" class="node">
<title>m8_final</title>
<ellipse fill="lightpink" stroke="black" cx="15422.61" cy="-34217.94" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="15422.61" y="-34221.74" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="15422.61" y="-34206.74" font-family="Times,serif" font-size="14.00">GPU: 3720</text>
</g>
<!-- m8_res1&#45;&gt;m8_final -->
<g id="edge110" class="edge">
<title>m8_res1&#45;&gt;m8_final</title>
<path fill="none" stroke="black" d="M15081.87,-34777.97C15215.66,-34765.31 15478.61,-34718.06 15478.61,-34542.24 15478.61,-34542.24 15478.61,-34542.24 15478.61,-34429.29 15478.61,-34365.96 15454.62,-34295.42 15438.04,-34254.23"/>
<polygon fill="black" stroke="black" points="15441.25,-34252.83 15434.22,-34244.91 15434.78,-34255.49 15441.25,-34252.83"/>
</g>
<!-- m8_gate&#45;&gt;m8_route -->
<g id="edge101" class="edge">
<title>m8_gate&#45;&gt;m8_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14848.61,-34614.65C14848.61,-34606.22 14848.61,-34597.53 14848.61,-34589.23"/>
<polygon fill="black" stroke="black" points="14852.11,-34588.97 14848.61,-34578.97 14845.11,-34588.97 14852.11,-34588.97"/>
</g>
<!-- m8_expert0 -->
<g id="node99" class="node">
<title>m8_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="13932.61" cy="-34430.29" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="13932.61" y="-34441.59" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13932.61" y="-34426.59" font-family="Times,serif" font-size="14.00">Node 40 GPU 0</text>
<text text-anchor="middle" x="13932.61" y="-34411.59" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m8_route&#45;&gt;m8_expert0 -->
<g id="edge103" class="edge">
<title>m8_route&#45;&gt;m8_expert0</title>
<path fill="none" stroke="black" d="M14754.3,-34529.05C14634.44,-34514.82 14421.16,-34489.49 14238.61,-34467.76 14211.41,-34464.53 14182.84,-34461.12 14154.54,-34457.75"/>
<polygon fill="black" stroke="black" points="14154.89,-34454.27 14144.55,-34456.56 14154.06,-34461.22 14154.89,-34454.27"/>
</g>
<!-- m8_expert1 -->
<g id="node100" class="node">
<title>m8_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="14543.61" cy="-34430.29" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="14543.61" y="-34441.59" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14543.61" y="-34426.59" font-family="Times,serif" font-size="14.00">Node 40 GPU 1</text>
<text text-anchor="middle" x="14543.61" y="-34411.59" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m8_route&#45;&gt;m8_expert1 -->
<g id="edge105" class="edge">
<title>m8_route&#45;&gt;m8_expert1</title>
<path fill="none" stroke="black" d="M14777.49,-34514.83C14739.44,-34501.24 14691.83,-34484.24 14649.52,-34469.12"/>
<polygon fill="black" stroke="black" points="14650.61,-34465.79 14640.02,-34465.73 14648.26,-34472.39 14650.61,-34465.79"/>
</g>
<!-- m8_expert2 -->
<g id="node101" class="node">
<title>m8_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="15154.61" cy="-34430.29" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="15154.61" y="-34441.59" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15154.61" y="-34426.59" font-family="Times,serif" font-size="14.00">Node 40 GPU 2</text>
<text text-anchor="middle" x="15154.61" y="-34411.59" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m8_route&#45;&gt;m8_expert2 -->
<g id="edge107" class="edge">
<title>m8_route&#45;&gt;m8_expert2</title>
<path fill="none" stroke="black" d="M14919.97,-34514.83C14958.14,-34501.24 15005.9,-34484.24 15048.36,-34469.12"/>
<polygon fill="black" stroke="black" points="15049.64,-34472.38 15057.89,-34465.73 15047.3,-34465.78 15049.64,-34472.38"/>
</g>
<!-- m8_agg -->
<g id="node102" class="node">
<title>m8_agg</title>
<polygon fill="purple" stroke="black" points="15013.23,-34356.81 14752.95,-34356.81 14686,-34280.81 14946.27,-34280.81 15013.23,-34356.81"/>
<text text-anchor="middle" x="14849.61" y="-34322.61" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14849.61" y="-34307.61" font-family="Times,serif" font-size="14.00">GPU: 3720</text>
</g>
<!-- m8_expert0&#45;&gt;m8_agg -->
<g id="edge104" class="edge">
<title>m8_expert0&#45;&gt;m8_agg</title>
<path fill="none" stroke="black" d="M14144.14,-34404.03C14322.91,-34382.69 14573.08,-34352.82 14722.48,-34334.99"/>
<polygon fill="black" stroke="black" points="14723.1,-34338.44 14732.62,-34333.78 14722.27,-34331.49 14723.1,-34338.44"/>
</g>
<!-- m8_expert1&#45;&gt;m8_agg -->
<g id="edge106" class="edge">
<title>m8_expert1&#45;&gt;m8_agg</title>
<path fill="none" stroke="black" d="M14640.01,-34394.8C14672.3,-34383.25 14708.5,-34370.29 14741.62,-34358.45"/>
<polygon fill="black" stroke="black" points="14743.09,-34361.64 14751.33,-34354.97 14740.73,-34355.05 14743.09,-34361.64"/>
</g>
<!-- m8_expert2&#45;&gt;m8_agg -->
<g id="edge108" class="edge">
<title>m8_expert2&#45;&gt;m8_agg</title>
<path fill="none" stroke="black" d="M15058.53,-34394.8C15028.07,-34383.86 14994.11,-34371.68 14962.57,-34360.36"/>
<polygon fill="black" stroke="black" points="14963.47,-34356.96 14952.87,-34356.87 14961.1,-34363.55 14963.47,-34356.96"/>
</g>
<!-- m8_agg&#45;&gt;m8_final -->
<g id="edge109" class="edge">
<title>m8_agg&#45;&gt;m8_final</title>
<path fill="none" stroke="black" d="M14962.13,-34298.4C15068.17,-34280.1 15225.36,-34252.98 15325.9,-34235.63"/>
<polygon fill="black" stroke="black" points="15326.79,-34239.03 15336.05,-34233.88 15325.6,-34232.13 15326.79,-34239.03"/>
</g>
<!-- m9_res1 -->
<g id="node108" class="node">
<title>m9_res1</title>
<ellipse fill="lightpink" stroke="black" cx="15535.61" cy="-34128.2" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="15535.61" y="-34132" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="15535.61" y="-34117" font-family="Times,serif" font-size="14.00">GPU: 3721</text>
</g>
<!-- m8_final&#45;&gt;m9_res1 -->
<g id="edge115" class="edge">
<title>m8_final&#45;&gt;m9_res1</title>
<path fill="none" stroke="black" d="M15454.39,-34192.27C15467.6,-34182.01 15483.05,-34170.02 15496.9,-34159.26"/>
<polygon fill="black" stroke="black" points="15499.1,-34161.98 15504.85,-34153.08 15494.81,-34156.45 15499.1,-34161.98"/>
</g>
<!-- m9_ln1 -->
<g id="node104" class="node">
<title>m9_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="15649.61" cy="-34541.24" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="15649.61" y="-34545.04" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="15649.61" y="-34530.04" font-family="Times,serif" font-size="14.00">GPU: 3721</text>
</g>
<!-- m9_qkv -->
<g id="node105" class="node">
<title>m9_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="15649.61" cy="-34430.29" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="15649.61" y="-34434.09" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15649.61" y="-34419.09" font-family="Times,serif" font-size="14.00">GPU: 3721</text>
</g>
<!-- m9_ln1&#45;&gt;m9_qkv -->
<g id="edge111" class="edge">
<title>m9_ln1&#45;&gt;m9_qkv</title>
<path fill="none" stroke="black" d="M15649.61,-34514.14C15649.61,-34500.13 15649.61,-34482.64 15649.61,-34467.34"/>
<polygon fill="black" stroke="black" points="15653.11,-34467.17 15649.61,-34457.17 15646.11,-34467.17 15653.11,-34467.17"/>
</g>
<!-- m9_mha -->
<g id="node106" class="node">
<title>m9_mha</title>
<ellipse fill="lightblue" stroke="black" cx="15649.61" cy="-34318.81" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="15649.61" y="-34322.61" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="15649.61" y="-34307.61" font-family="Times,serif" font-size="14.00">GPU: 3721</text>
</g>
<!-- m9_qkv&#45;&gt;m9_mha -->
<g id="edge112" class="edge">
<title>m9_qkv&#45;&gt;m9_mha</title>
<path fill="none" stroke="black" d="M15649.61,-34403.34C15649.61,-34389.27 15649.61,-34371.64 15649.61,-34356.21"/>
<polygon fill="black" stroke="black" points="15653.11,-34355.95 15649.61,-34345.95 15646.11,-34355.95 15653.11,-34355.95"/>
</g>
<!-- m9_out -->
<g id="node107" class="node">
<title>m9_out</title>
<ellipse fill="lightblue" stroke="black" cx="15649.61" cy="-34217.94" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="15649.61" y="-34221.74" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15649.61" y="-34206.74" font-family="Times,serif" font-size="14.00">GPU: 3721</text>
</g>
<!-- m9_mha&#45;&gt;m9_out -->
<g id="edge113" class="edge">
<title>m9_mha&#45;&gt;m9_out</title>
<path fill="none" stroke="black" d="M15649.61,-34291.83C15649.61,-34280.68 15649.61,-34267.46 15649.61,-34255.35"/>
<polygon fill="black" stroke="black" points="15653.11,-34255.09 15649.61,-34245.09 15646.11,-34255.09 15653.11,-34255.09"/>
</g>
<!-- m9_out&#45;&gt;m9_res1 -->
<g id="edge114" class="edge">
<title>m9_out&#45;&gt;m9_res1</title>
<path fill="none" stroke="black" d="M15617.55,-34192.27C15604.23,-34182.01 15588.64,-34170.02 15574.66,-34159.26"/>
<polygon fill="black" stroke="black" points="15576.7,-34156.41 15566.64,-34153.08 15572.43,-34161.96 15576.7,-34156.41"/>
</g>
<!-- m9_gate -->
<g id="node109" class="node">
<title>m9_gate</title>
<polygon fill="orange" stroke="black" points="15507.23,-34065.33 15302.63,-34065.33 15250,-33959.33 15454.59,-33959.33 15507.23,-34065.33"/>
<text text-anchor="middle" x="15378.61" y="-34023.63" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="15378.61" y="-34008.63" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="15378.61" y="-33993.63" font-family="Times,serif" font-size="14.00">GPU: 3721</text>
</g>
<!-- m9_res1&#45;&gt;m9_gate -->
<g id="edge116" class="edge">
<title>m9_res1&#45;&gt;m9_gate</title>
<path fill="none" stroke="black" d="M15503.08,-34103.61C15490.08,-34094.18 15474.48,-34082.86 15458.79,-34071.48"/>
<polygon fill="black" stroke="black" points="15460.74,-34068.57 15450.59,-34065.53 15456.63,-34074.24 15460.74,-34068.57"/>
</g>
<!-- m9_route -->
<g id="node110" class="node">
<title>m9_route</title>
<ellipse fill="lightgray" stroke="black" cx="15378.61" cy="-33885.85" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="15378.61" y="-33897.15" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="15378.61" y="-33882.15" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="15378.61" y="-33867.15" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m9_res1&#45;&gt;m9_route -->
<g id="edge118" class="edge">
<title>m9_res1&#45;&gt;m9_route</title>
<path fill="none" stroke="black" d="M15539.67,-34101.35C15543.79,-34066.02 15545.92,-34002.18 15516.61,-33959.33 15503.5,-33940.17 15483.68,-33925.71 15463.11,-33914.95"/>
<polygon fill="black" stroke="black" points="15464.47,-33911.72 15453.95,-33910.42 15461.36,-33917.99 15464.47,-33911.72"/>
</g>
<!-- m9_final -->
<g id="node115" class="node">
<title>m9_final</title>
<ellipse fill="lightpink" stroke="black" cx="15951.61" cy="-33562.55" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="15951.61" y="-33566.35" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="15951.61" y="-33551.35" font-family="Times,serif" font-size="14.00">GPU: 3721</text>
</g>
<!-- m9_res1&#45;&gt;m9_final -->
<g id="edge126" class="edge">
<title>m9_res1&#45;&gt;m9_final</title>
<path fill="none" stroke="black" d="M15611.71,-34122.53C15745.21,-34109.77 16007.61,-34062.38 16007.61,-33886.85 16007.61,-33886.85 16007.61,-33886.85 16007.61,-33773.9 16007.61,-33710.58 15983.62,-33640.03 15967.04,-33598.84"/>
<polygon fill="black" stroke="black" points="15970.25,-33597.45 15963.22,-33589.52 15963.78,-33600.1 15970.25,-33597.45"/>
</g>
<!-- m9_gate&#45;&gt;m9_route -->
<g id="edge117" class="edge">
<title>m9_gate&#45;&gt;m9_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15378.61,-33959.26C15378.61,-33950.83 15378.61,-33942.14 15378.61,-33933.84"/>
<polygon fill="black" stroke="black" points="15382.11,-33933.58 15378.61,-33923.58 15375.11,-33933.58 15382.11,-33933.58"/>
</g>
<!-- m9_expert0 -->
<g id="node111" class="node">
<title>m9_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="14461.61" cy="-33774.9" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="14461.61" y="-33786.2" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="14461.61" y="-33771.2" font-family="Times,serif" font-size="14.00">Node 48 GPU 0</text>
<text text-anchor="middle" x="14461.61" y="-33756.2" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m9_route&#45;&gt;m9_expert0 -->
<g id="edge119" class="edge">
<title>m9_route&#45;&gt;m9_expert0</title>
<path fill="none" stroke="black" d="M15284.15,-33873.67C15164.09,-33859.44 14950.46,-33834.12 14767.61,-33812.38 14740.41,-33809.14 14711.84,-33805.74 14683.54,-33802.37"/>
<polygon fill="black" stroke="black" points="14683.89,-33798.89 14673.55,-33801.18 14683.06,-33805.84 14683.89,-33798.89"/>
</g>
<!-- m9_expert1 -->
<g id="node112" class="node">
<title>m9_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="15072.61" cy="-33774.9" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="15072.61" y="-33786.2" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="15072.61" y="-33771.2" font-family="Times,serif" font-size="14.00">Node 48 GPU 1</text>
<text text-anchor="middle" x="15072.61" y="-33756.2" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m9_route&#45;&gt;m9_expert1 -->
<g id="edge121" class="edge">
<title>m9_route&#45;&gt;m9_expert1</title>
<path fill="none" stroke="black" d="M15307.26,-33859.45C15269.08,-33845.85 15221.32,-33828.85 15178.87,-33813.73"/>
<polygon fill="black" stroke="black" points="15179.93,-33810.4 15169.33,-33810.34 15177.58,-33816.99 15179.93,-33810.4"/>
</g>
<!-- m9_expert2 -->
<g id="node113" class="node">
<title>m9_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="15683.61" cy="-33774.9" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="15683.61" y="-33786.2" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15683.61" y="-33771.2" font-family="Times,serif" font-size="14.00">Node 48 GPU 2</text>
<text text-anchor="middle" x="15683.61" y="-33756.2" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m9_route&#45;&gt;m9_expert2 -->
<g id="edge123" class="edge">
<title>m9_route&#45;&gt;m9_expert2</title>
<path fill="none" stroke="black" d="M15449.74,-33859.45C15487.78,-33845.85 15535.39,-33828.85 15577.7,-33813.73"/>
<polygon fill="black" stroke="black" points="15578.97,-33817 15587.21,-33810.34 15576.61,-33810.41 15578.97,-33817"/>
</g>
<!-- m9_agg -->
<g id="node114" class="node">
<title>m9_agg</title>
<polygon fill="purple" stroke="black" points="15542.23,-33701.42 15281.95,-33701.42 15215,-33625.42 15475.27,-33625.42 15542.23,-33701.42"/>
<text text-anchor="middle" x="15378.61" y="-33667.22" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15378.61" y="-33652.22" font-family="Times,serif" font-size="14.00">GPU: 3721</text>
</g>
<!-- m9_expert0&#45;&gt;m9_agg -->
<g id="edge120" class="edge">
<title>m9_expert0&#45;&gt;m9_agg</title>
<path fill="none" stroke="black" d="M14673.14,-33748.65C14851.91,-33727.3 15102.08,-33697.44 15251.48,-33679.6"/>
<polygon fill="black" stroke="black" points="15252.1,-33683.05 15261.62,-33678.39 15251.27,-33676.1 15252.1,-33683.05"/>
</g>
<!-- m9_expert1&#45;&gt;m9_agg -->
<g id="edge122" class="edge">
<title>m9_expert1&#45;&gt;m9_agg</title>
<path fill="none" stroke="black" d="M15169.01,-33739.41C15201.3,-33727.86 15237.5,-33714.91 15270.62,-33703.06"/>
<polygon fill="black" stroke="black" points="15272.09,-33706.25 15280.33,-33699.59 15269.73,-33699.66 15272.09,-33706.25"/>
</g>
<!-- m9_expert2&#45;&gt;m9_agg -->
<g id="edge124" class="edge">
<title>m9_expert2&#45;&gt;m9_agg</title>
<path fill="none" stroke="black" d="M15587.53,-33739.41C15557.07,-33728.48 15523.11,-33716.29 15491.57,-33704.97"/>
<polygon fill="black" stroke="black" points="15492.47,-33701.57 15481.87,-33701.49 15490.1,-33708.16 15492.47,-33701.57"/>
</g>
<!-- m9_agg&#45;&gt;m9_final -->
<g id="edge125" class="edge">
<title>m9_agg&#45;&gt;m9_final</title>
<path fill="none" stroke="black" d="M15491.13,-33643.01C15597.17,-33624.71 15754.36,-33597.59 15854.9,-33580.24"/>
<polygon fill="black" stroke="black" points="15855.79,-33583.64 15865.05,-33578.49 15854.6,-33576.74 15855.79,-33583.64"/>
</g>
<!-- m10_res1 -->
<g id="node120" class="node">
<title>m10_res1</title>
<ellipse fill="lightpink" stroke="black" cx="16064.61" cy="-33472.81" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="16064.61" y="-33476.61" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16064.61" y="-33461.61" font-family="Times,serif" font-size="14.00">GPU: 3722</text>
</g>
<!-- m9_final&#45;&gt;m10_res1 -->
<g id="edge131" class="edge">
<title>m9_final&#45;&gt;m10_res1</title>
<path fill="none" stroke="black" d="M15983.39,-33536.88C15996.6,-33526.63 16012.05,-33514.63 16025.9,-33503.87"/>
<polygon fill="black" stroke="black" points="16028.1,-33506.59 16033.85,-33497.7 16023.81,-33501.07 16028.1,-33506.59"/>
</g>
<!-- m10_ln1 -->
<g id="node116" class="node">
<title>m10_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="16178.61" cy="-33885.85" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="16178.61" y="-33889.65" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16178.61" y="-33874.65" font-family="Times,serif" font-size="14.00">GPU: 3722</text>
</g>
<!-- m10_qkv -->
<g id="node117" class="node">
<title>m10_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="16178.61" cy="-33774.9" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="16178.61" y="-33778.7" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16178.61" y="-33763.7" font-family="Times,serif" font-size="14.00">GPU: 3722</text>
</g>
<!-- m10_ln1&#45;&gt;m10_qkv -->
<g id="edge127" class="edge">
<title>m10_ln1&#45;&gt;m10_qkv</title>
<path fill="none" stroke="black" d="M16178.61,-33858.76C16178.61,-33844.74 16178.61,-33827.25 16178.61,-33811.95"/>
<polygon fill="black" stroke="black" points="16182.11,-33811.78 16178.61,-33801.78 16175.11,-33811.78 16182.11,-33811.78"/>
</g>
<!-- m10_mha -->
<g id="node118" class="node">
<title>m10_mha</title>
<ellipse fill="lightblue" stroke="black" cx="16178.61" cy="-33663.42" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16178.61" y="-33667.22" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="16178.61" y="-33652.22" font-family="Times,serif" font-size="14.00">GPU: 3722</text>
</g>
<!-- m10_qkv&#45;&gt;m10_mha -->
<g id="edge128" class="edge">
<title>m10_qkv&#45;&gt;m10_mha</title>
<path fill="none" stroke="black" d="M16178.61,-33747.96C16178.61,-33733.88 16178.61,-33716.25 16178.61,-33700.82"/>
<polygon fill="black" stroke="black" points="16182.11,-33700.56 16178.61,-33690.56 16175.11,-33700.56 16182.11,-33700.56"/>
</g>
<!-- m10_out -->
<g id="node119" class="node">
<title>m10_out</title>
<ellipse fill="lightblue" stroke="black" cx="16178.61" cy="-33562.55" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="16178.61" y="-33566.35" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16178.61" y="-33551.35" font-family="Times,serif" font-size="14.00">GPU: 3722</text>
</g>
<!-- m10_mha&#45;&gt;m10_out -->
<g id="edge129" class="edge">
<title>m10_mha&#45;&gt;m10_out</title>
<path fill="none" stroke="black" d="M16178.61,-33636.45C16178.61,-33625.3 16178.61,-33612.07 16178.61,-33599.97"/>
<polygon fill="black" stroke="black" points="16182.11,-33599.7 16178.61,-33589.7 16175.11,-33599.7 16182.11,-33599.7"/>
</g>
<!-- m10_out&#45;&gt;m10_res1 -->
<g id="edge130" class="edge">
<title>m10_out&#45;&gt;m10_res1</title>
<path fill="none" stroke="black" d="M16146.55,-33536.88C16133.23,-33526.63 16117.64,-33514.63 16103.66,-33503.87"/>
<polygon fill="black" stroke="black" points="16105.7,-33501.02 16095.64,-33497.7 16101.43,-33506.57 16105.7,-33501.02"/>
</g>
<!-- m10_gate -->
<g id="node121" class="node">
<title>m10_gate</title>
<polygon fill="orange" stroke="black" points="16036.23,-33409.94 15831.63,-33409.94 15779,-33303.94 15983.59,-33303.94 16036.23,-33409.94"/>
<text text-anchor="middle" x="15907.61" y="-33368.24" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="15907.61" y="-33353.24" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="15907.61" y="-33338.24" font-family="Times,serif" font-size="14.00">GPU: 3722</text>
</g>
<!-- m10_res1&#45;&gt;m10_gate -->
<g id="edge132" class="edge">
<title>m10_res1&#45;&gt;m10_gate</title>
<path fill="none" stroke="black" d="M16032.08,-33448.22C16019.08,-33438.79 16003.48,-33427.47 15987.79,-33416.09"/>
<polygon fill="black" stroke="black" points="15989.74,-33413.19 15979.59,-33410.15 15985.63,-33418.85 15989.74,-33413.19"/>
</g>
<!-- m10_route -->
<g id="node122" class="node">
<title>m10_route</title>
<ellipse fill="lightgray" stroke="black" cx="15907.61" cy="-33230.47" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="15907.61" y="-33241.77" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="15907.61" y="-33226.77" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="15907.61" y="-33211.77" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m10_res1&#45;&gt;m10_route -->
<g id="edge134" class="edge">
<title>m10_res1&#45;&gt;m10_route</title>
<path fill="none" stroke="black" d="M16068.67,-33445.96C16072.79,-33410.64 16074.92,-33346.79 16045.61,-33303.94 16032.5,-33284.78 16012.68,-33270.32 15992.11,-33259.56"/>
<polygon fill="black" stroke="black" points="15993.47,-33256.33 15982.95,-33255.03 15990.36,-33262.6 15993.47,-33256.33"/>
</g>
<!-- m10_final -->
<g id="node127" class="node">
<title>m10_final</title>
<ellipse fill="lightpink" stroke="black" cx="16481.61" cy="-32907.17" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="16481.61" y="-32910.97" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="16481.61" y="-32895.97" font-family="Times,serif" font-size="14.00">GPU: 3722</text>
</g>
<!-- m10_res1&#45;&gt;m10_final -->
<g id="edge142" class="edge">
<title>m10_res1&#45;&gt;m10_final</title>
<path fill="none" stroke="black" d="M16140.87,-33467.2C16274.66,-33454.54 16537.61,-33407.28 16537.61,-33231.47 16537.61,-33231.47 16537.61,-33231.47 16537.61,-33118.51 16537.61,-33055.19 16513.62,-32984.64 16497.04,-32943.46"/>
<polygon fill="black" stroke="black" points="16500.25,-32942.06 16493.22,-32934.14 16493.78,-32944.72 16500.25,-32942.06"/>
</g>
<!-- m10_gate&#45;&gt;m10_route -->
<g id="edge133" class="edge">
<title>m10_gate&#45;&gt;m10_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15907.61,-33303.88C15907.61,-33295.44 15907.61,-33286.76 15907.61,-33278.45"/>
<polygon fill="black" stroke="black" points="15911.11,-33278.19 15907.61,-33268.19 15904.11,-33278.19 15911.11,-33278.19"/>
</g>
<!-- m10_expert0 -->
<g id="node123" class="node">
<title>m10_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="14991.61" cy="-33119.51" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="14991.61" y="-33130.81" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="14991.61" y="-33115.81" font-family="Times,serif" font-size="14.00">Node 56 GPU 0</text>
<text text-anchor="middle" x="14991.61" y="-33100.81" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m10_route&#45;&gt;m10_expert0 -->
<g id="edge135" class="edge">
<title>m10_route&#45;&gt;m10_expert0</title>
<path fill="none" stroke="black" d="M15813.3,-33218.27C15693.44,-33204.04 15480.16,-33178.71 15297.61,-33156.99 15270.41,-33153.75 15241.84,-33150.35 15213.54,-33146.98"/>
<polygon fill="black" stroke="black" points="15213.89,-33143.5 15203.55,-33145.79 15213.06,-33150.45 15213.89,-33143.5"/>
</g>
<!-- m10_expert1 -->
<g id="node124" class="node">
<title>m10_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="15602.61" cy="-33119.51" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="15602.61" y="-33130.81" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="15602.61" y="-33115.81" font-family="Times,serif" font-size="14.00">Node 56 GPU 1</text>
<text text-anchor="middle" x="15602.61" y="-33100.81" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m10_route&#45;&gt;m10_expert1 -->
<g id="edge137" class="edge">
<title>m10_route&#45;&gt;m10_expert1</title>
<path fill="none" stroke="black" d="M15836.49,-33204.06C15798.44,-33190.47 15750.83,-33173.46 15708.52,-33158.35"/>
<polygon fill="black" stroke="black" points="15709.61,-33155.02 15699.02,-33154.95 15707.26,-33161.61 15709.61,-33155.02"/>
</g>
<!-- m10_expert2 -->
<g id="node125" class="node">
<title>m10_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="16213.61" cy="-33119.51" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="16213.61" y="-33130.81" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="16213.61" y="-33115.81" font-family="Times,serif" font-size="14.00">Node 56 GPU 2</text>
<text text-anchor="middle" x="16213.61" y="-33100.81" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m10_route&#45;&gt;m10_expert2 -->
<g id="edge139" class="edge">
<title>m10_route&#45;&gt;m10_expert2</title>
<path fill="none" stroke="black" d="M15978.97,-33204.06C16017.14,-33190.47 16064.9,-33173.46 16107.36,-33158.35"/>
<polygon fill="black" stroke="black" points="16108.64,-33161.6 16116.89,-33154.95 16106.3,-33155.01 16108.64,-33161.6"/>
</g>
<!-- m10_agg -->
<g id="node126" class="node">
<title>m10_agg</title>
<polygon fill="purple" stroke="black" points="16072.23,-33046.04 15811.95,-33046.04 15745,-32970.04 16005.27,-32970.04 16072.23,-33046.04"/>
<text text-anchor="middle" x="15908.61" y="-33011.84" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15908.61" y="-32996.84" font-family="Times,serif" font-size="14.00">GPU: 3722</text>
</g>
<!-- m10_expert0&#45;&gt;m10_agg -->
<g id="edge136" class="edge">
<title>m10_expert0&#45;&gt;m10_agg</title>
<path fill="none" stroke="black" d="M15203.14,-33093.26C15381.91,-33071.92 15632.08,-33042.05 15781.48,-33024.21"/>
<polygon fill="black" stroke="black" points="15782.1,-33027.67 15791.62,-33023 15781.27,-33020.71 15782.1,-33027.67"/>
</g>
<!-- m10_expert1&#45;&gt;m10_agg -->
<g id="edge138" class="edge">
<title>m10_expert1&#45;&gt;m10_agg</title>
<path fill="none" stroke="black" d="M15699.01,-33084.02C15731.3,-33072.47 15767.5,-33059.52 15800.62,-33047.67"/>
<polygon fill="black" stroke="black" points="15802.09,-33050.86 15810.33,-33044.2 15799.73,-33044.27 15802.09,-33050.86"/>
</g>
<!-- m10_expert2&#45;&gt;m10_agg -->
<g id="edge140" class="edge">
<title>m10_expert2&#45;&gt;m10_agg</title>
<path fill="none" stroke="black" d="M16117.53,-33084.02C16087.07,-33073.09 16053.11,-33060.9 16021.57,-33049.58"/>
<polygon fill="black" stroke="black" points="16022.47,-33046.18 16011.87,-33046.1 16020.1,-33052.77 16022.47,-33046.18"/>
</g>
<!-- m10_agg&#45;&gt;m10_final -->
<g id="edge141" class="edge">
<title>m10_agg&#45;&gt;m10_final</title>
<path fill="none" stroke="black" d="M16021.13,-32987.62C16127.17,-32969.33 16284.36,-32942.2 16384.9,-32924.85"/>
<polygon fill="black" stroke="black" points="16385.79,-32928.25 16395.05,-32923.1 16384.6,-32921.35 16385.79,-32928.25"/>
</g>
<!-- m11_res1 -->
<g id="node132" class="node">
<title>m11_res1</title>
<ellipse fill="lightpink" stroke="black" cx="16594.61" cy="-32817.43" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="16594.61" y="-32821.23" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="16594.61" y="-32806.23" font-family="Times,serif" font-size="14.00">GPU: 3723</text>
</g>
<!-- m10_final&#45;&gt;m11_res1 -->
<g id="edge147" class="edge">
<title>m10_final&#45;&gt;m11_res1</title>
<path fill="none" stroke="black" d="M16513.39,-32881.49C16526.6,-32871.24 16542.05,-32859.24 16555.9,-32848.48"/>
<polygon fill="black" stroke="black" points="16558.1,-32851.21 16563.85,-32842.31 16553.81,-32845.68 16558.1,-32851.21"/>
</g>
<!-- m11_ln1 -->
<g id="node128" class="node">
<title>m11_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="16708.61" cy="-33230.47" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="16708.61" y="-33234.27" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="16708.61" y="-33219.27" font-family="Times,serif" font-size="14.00">GPU: 3723</text>
</g>
<!-- m11_qkv -->
<g id="node129" class="node">
<title>m11_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="16708.61" cy="-33119.51" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="16708.61" y="-33123.31" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16708.61" y="-33108.31" font-family="Times,serif" font-size="14.00">GPU: 3723</text>
</g>
<!-- m11_ln1&#45;&gt;m11_qkv -->
<g id="edge143" class="edge">
<title>m11_ln1&#45;&gt;m11_qkv</title>
<path fill="none" stroke="black" d="M16708.61,-33203.37C16708.61,-33189.35 16708.61,-33171.86 16708.61,-33156.57"/>
<polygon fill="black" stroke="black" points="16712.11,-33156.4 16708.61,-33146.4 16705.11,-33156.4 16712.11,-33156.4"/>
</g>
<!-- m11_mha -->
<g id="node130" class="node">
<title>m11_mha</title>
<ellipse fill="lightblue" stroke="black" cx="16708.61" cy="-33008.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="16708.61" y="-33011.84" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="16708.61" y="-32996.84" font-family="Times,serif" font-size="14.00">GPU: 3723</text>
</g>
<!-- m11_qkv&#45;&gt;m11_mha -->
<g id="edge144" class="edge">
<title>m11_qkv&#45;&gt;m11_mha</title>
<path fill="none" stroke="black" d="M16708.61,-33092.57C16708.61,-33078.49 16708.61,-33060.86 16708.61,-33045.43"/>
<polygon fill="black" stroke="black" points="16712.11,-33045.17 16708.61,-33035.17 16705.11,-33045.17 16712.11,-33045.17"/>
</g>
<!-- m11_out -->
<g id="node131" class="node">
<title>m11_out</title>
<ellipse fill="lightblue" stroke="black" cx="16708.61" cy="-32907.17" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="16708.61" y="-32910.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16708.61" y="-32895.97" font-family="Times,serif" font-size="14.00">GPU: 3723</text>
</g>
<!-- m11_mha&#45;&gt;m11_out -->
<g id="edge145" class="edge">
<title>m11_mha&#45;&gt;m11_out</title>
<path fill="none" stroke="black" d="M16708.61,-32981.06C16708.61,-32969.91 16708.61,-32956.68 16708.61,-32944.58"/>
<polygon fill="black" stroke="black" points="16712.11,-32944.31 16708.61,-32934.31 16705.11,-32944.31 16712.11,-32944.31"/>
</g>
<!-- m11_out&#45;&gt;m11_res1 -->
<g id="edge146" class="edge">
<title>m11_out&#45;&gt;m11_res1</title>
<path fill="none" stroke="black" d="M16676.55,-32881.49C16663.23,-32871.24 16647.64,-32859.24 16633.66,-32848.48"/>
<polygon fill="black" stroke="black" points="16635.7,-32845.64 16625.64,-32842.31 16631.43,-32851.18 16635.7,-32845.64"/>
</g>
<!-- m11_gate -->
<g id="node133" class="node">
<title>m11_gate</title>
<polygon fill="orange" stroke="black" points="16566.23,-32754.56 16361.63,-32754.56 16309,-32648.56 16513.59,-32648.56 16566.23,-32754.56"/>
<text text-anchor="middle" x="16437.61" y="-32712.86" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="16437.61" y="-32697.86" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="16437.61" y="-32682.86" font-family="Times,serif" font-size="14.00">GPU: 3723</text>
</g>
<!-- m11_res1&#45;&gt;m11_gate -->
<g id="edge148" class="edge">
<title>m11_res1&#45;&gt;m11_gate</title>
<path fill="none" stroke="black" d="M16562.08,-32792.83C16549.08,-32783.4 16533.48,-32772.09 16517.79,-32760.71"/>
<polygon fill="black" stroke="black" points="16519.74,-32757.8 16509.59,-32754.76 16515.63,-32763.47 16519.74,-32757.8"/>
</g>
<!-- m11_route -->
<g id="node134" class="node">
<title>m11_route</title>
<ellipse fill="lightgray" stroke="black" cx="16437.61" cy="-32575.08" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="16437.61" y="-32586.38" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="16437.61" y="-32571.38" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="16437.61" y="-32556.38" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m11_res1&#45;&gt;m11_route -->
<g id="edge150" class="edge">
<title>m11_res1&#45;&gt;m11_route</title>
<path fill="none" stroke="black" d="M16598.67,-32790.58C16602.79,-32755.25 16604.92,-32691.4 16575.61,-32648.56 16562.5,-32629.39 16542.68,-32614.93 16522.11,-32604.18"/>
<polygon fill="black" stroke="black" points="16523.47,-32600.94 16512.95,-32599.64 16520.36,-32607.22 16523.47,-32600.94"/>
</g>
<!-- m11_final -->
<g id="node139" class="node">
<title>m11_final</title>
<ellipse fill="lightpink" stroke="black" cx="17010.61" cy="-32251.78" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="17010.61" y="-32255.58" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="17010.61" y="-32240.58" font-family="Times,serif" font-size="14.00">GPU: 3723</text>
</g>
<!-- m11_res1&#45;&gt;m11_final -->
<g id="edge158" class="edge">
<title>m11_res1&#45;&gt;m11_final</title>
<path fill="none" stroke="black" d="M16670.71,-32811.75C16804.21,-32799 17066.61,-32751.6 17066.61,-32576.08 17066.61,-32576.08 17066.61,-32576.08 17066.61,-32463.13 17066.61,-32399.8 17042.62,-32329.25 17026.04,-32288.07"/>
<polygon fill="black" stroke="black" points="17029.25,-32286.67 17022.22,-32278.75 17022.78,-32289.33 17029.25,-32286.67"/>
</g>
<!-- m11_gate&#45;&gt;m11_route -->
<g id="edge149" class="edge">
<title>m11_gate&#45;&gt;m11_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16437.61,-32648.49C16437.61,-32640.06 16437.61,-32631.37 16437.61,-32623.07"/>
<polygon fill="black" stroke="black" points="16441.11,-32622.81 16437.61,-32612.81 16434.11,-32622.81 16441.11,-32622.81"/>
</g>
<!-- m11_expert0 -->
<g id="node135" class="node">
<title>m11_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="15520.61" cy="-32464.13" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="15520.61" y="-32475.43" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="15520.61" y="-32460.43" font-family="Times,serif" font-size="14.00">Node 64 GPU 0</text>
<text text-anchor="middle" x="15520.61" y="-32445.43" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m11_route&#45;&gt;m11_expert0 -->
<g id="edge151" class="edge">
<title>m11_route&#45;&gt;m11_expert0</title>
<path fill="none" stroke="black" d="M16343.15,-32562.89C16223.09,-32548.67 16009.46,-32523.35 15826.61,-32501.6 15799.41,-32498.37 15770.84,-32494.97 15742.54,-32491.6"/>
<polygon fill="black" stroke="black" points="15742.89,-32488.11 15732.55,-32490.41 15742.06,-32495.06 15742.89,-32488.11"/>
</g>
<!-- m11_expert1 -->
<g id="node136" class="node">
<title>m11_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="16131.61" cy="-32464.13" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="16131.61" y="-32475.43" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="16131.61" y="-32460.43" font-family="Times,serif" font-size="14.00">Node 64 GPU 1</text>
<text text-anchor="middle" x="16131.61" y="-32445.43" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m11_route&#45;&gt;m11_expert1 -->
<g id="edge153" class="edge">
<title>m11_route&#45;&gt;m11_expert1</title>
<path fill="none" stroke="black" d="M16366.26,-32548.67C16328.08,-32535.08 16280.32,-32518.07 16237.87,-32502.96"/>
<polygon fill="black" stroke="black" points="16238.93,-32499.62 16228.33,-32499.57 16236.58,-32506.22 16238.93,-32499.62"/>
</g>
<!-- m11_expert2 -->
<g id="node137" class="node">
<title>m11_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="16742.61" cy="-32464.13" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="16742.61" y="-32475.43" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="16742.61" y="-32460.43" font-family="Times,serif" font-size="14.00">Node 64 GPU 2</text>
<text text-anchor="middle" x="16742.61" y="-32445.43" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m11_route&#45;&gt;m11_expert2 -->
<g id="edge155" class="edge">
<title>m11_route&#45;&gt;m11_expert2</title>
<path fill="none" stroke="black" d="M16508.74,-32548.67C16546.78,-32535.08 16594.39,-32518.07 16636.7,-32502.96"/>
<polygon fill="black" stroke="black" points="16637.97,-32506.23 16646.21,-32499.57 16635.61,-32499.63 16637.97,-32506.23"/>
</g>
<!-- m11_agg -->
<g id="node138" class="node">
<title>m11_agg</title>
<polygon fill="purple" stroke="black" points="16601.23,-32390.65 16340.95,-32390.65 16274,-32314.65 16534.27,-32314.65 16601.23,-32390.65"/>
<text text-anchor="middle" x="16437.61" y="-32356.45" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16437.61" y="-32341.45" font-family="Times,serif" font-size="14.00">GPU: 3723</text>
</g>
<!-- m11_expert0&#45;&gt;m11_agg -->
<g id="edge152" class="edge">
<title>m11_expert0&#45;&gt;m11_agg</title>
<path fill="none" stroke="black" d="M15732.14,-32437.87C15910.91,-32416.53 16161.08,-32386.66 16310.48,-32368.83"/>
<polygon fill="black" stroke="black" points="16311.1,-32372.28 16320.62,-32367.62 16310.27,-32365.33 16311.1,-32372.28"/>
</g>
<!-- m11_expert1&#45;&gt;m11_agg -->
<g id="edge154" class="edge">
<title>m11_expert1&#45;&gt;m11_agg</title>
<path fill="none" stroke="black" d="M16228.01,-32428.64C16260.3,-32417.09 16296.5,-32404.13 16329.62,-32392.29"/>
<polygon fill="black" stroke="black" points="16331.09,-32395.48 16339.33,-32388.81 16328.73,-32388.89 16331.09,-32395.48"/>
</g>
<!-- m11_expert2&#45;&gt;m11_agg -->
<g id="edge156" class="edge">
<title>m11_expert2&#45;&gt;m11_agg</title>
<path fill="none" stroke="black" d="M16646.53,-32428.64C16616.07,-32417.7 16582.11,-32405.52 16550.57,-32394.2"/>
<polygon fill="black" stroke="black" points="16551.47,-32390.8 16540.87,-32390.71 16549.1,-32397.39 16551.47,-32390.8"/>
</g>
<!-- m11_agg&#45;&gt;m11_final -->
<g id="edge157" class="edge">
<title>m11_agg&#45;&gt;m11_final</title>
<path fill="none" stroke="black" d="M16550.13,-32332.23C16656.17,-32313.94 16813.36,-32286.81 16913.9,-32269.47"/>
<polygon fill="black" stroke="black" points="16914.79,-32272.87 16924.05,-32267.72 16913.6,-32265.97 16914.79,-32272.87"/>
</g>
<!-- m12_res1 -->
<g id="node144" class="node">
<title>m12_res1</title>
<ellipse fill="lightpink" stroke="black" cx="17123.61" cy="-32162.04" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="17123.61" y="-32165.84" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17123.61" y="-32150.84" font-family="Times,serif" font-size="14.00">GPU: 3724</text>
</g>
<!-- m11_final&#45;&gt;m12_res1 -->
<g id="edge163" class="edge">
<title>m11_final&#45;&gt;m12_res1</title>
<path fill="none" stroke="black" d="M17042.39,-32226.11C17055.6,-32215.85 17071.05,-32203.86 17084.9,-32193.09"/>
<polygon fill="black" stroke="black" points="17087.1,-32195.82 17092.85,-32186.92 17082.81,-32190.29 17087.1,-32195.82"/>
</g>
<!-- m12_ln1 -->
<g id="node140" class="node">
<title>m12_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="17237.61" cy="-32575.08" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="17237.61" y="-32578.88" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17237.61" y="-32563.88" font-family="Times,serif" font-size="14.00">GPU: 3724</text>
</g>
<!-- m12_qkv -->
<g id="node141" class="node">
<title>m12_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="17237.61" cy="-32464.13" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="17237.61" y="-32467.93" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17237.61" y="-32452.93" font-family="Times,serif" font-size="14.00">GPU: 3724</text>
</g>
<!-- m12_ln1&#45;&gt;m12_qkv -->
<g id="edge159" class="edge">
<title>m12_ln1&#45;&gt;m12_qkv</title>
<path fill="none" stroke="black" d="M17237.61,-32547.98C17237.61,-32533.97 17237.61,-32516.48 17237.61,-32501.18"/>
<polygon fill="black" stroke="black" points="17241.11,-32501.01 17237.61,-32491.01 17234.11,-32501.01 17241.11,-32501.01"/>
</g>
<!-- m12_mha -->
<g id="node142" class="node">
<title>m12_mha</title>
<ellipse fill="lightblue" stroke="black" cx="17237.61" cy="-32352.65" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="17237.61" y="-32356.45" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="17237.61" y="-32341.45" font-family="Times,serif" font-size="14.00">GPU: 3724</text>
</g>
<!-- m12_qkv&#45;&gt;m12_mha -->
<g id="edge160" class="edge">
<title>m12_qkv&#45;&gt;m12_mha</title>
<path fill="none" stroke="black" d="M17237.61,-32437.18C17237.61,-32423.11 17237.61,-32405.48 17237.61,-32390.05"/>
<polygon fill="black" stroke="black" points="17241.11,-32389.79 17237.61,-32379.79 17234.11,-32389.79 17241.11,-32389.79"/>
</g>
<!-- m12_out -->
<g id="node143" class="node">
<title>m12_out</title>
<ellipse fill="lightblue" stroke="black" cx="17237.61" cy="-32251.78" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="17237.61" y="-32255.58" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17237.61" y="-32240.58" font-family="Times,serif" font-size="14.00">GPU: 3724</text>
</g>
<!-- m12_mha&#45;&gt;m12_out -->
<g id="edge161" class="edge">
<title>m12_mha&#45;&gt;m12_out</title>
<path fill="none" stroke="black" d="M17237.61,-32325.67C17237.61,-32314.52 17237.61,-32301.3 17237.61,-32289.19"/>
<polygon fill="black" stroke="black" points="17241.11,-32288.93 17237.61,-32278.93 17234.11,-32288.93 17241.11,-32288.93"/>
</g>
<!-- m12_out&#45;&gt;m12_res1 -->
<g id="edge162" class="edge">
<title>m12_out&#45;&gt;m12_res1</title>
<path fill="none" stroke="black" d="M17205.55,-32226.11C17192.23,-32215.85 17176.64,-32203.86 17162.66,-32193.09"/>
<polygon fill="black" stroke="black" points="17164.7,-32190.25 17154.64,-32186.92 17160.43,-32195.8 17164.7,-32190.25"/>
</g>
<!-- m12_gate -->
<g id="node145" class="node">
<title>m12_gate</title>
<polygon fill="orange" stroke="black" points="17095.23,-32099.17 16890.63,-32099.17 16838,-31993.17 17042.59,-31993.17 17095.23,-32099.17"/>
<text text-anchor="middle" x="16966.61" y="-32057.47" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="16966.61" y="-32042.47" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="16966.61" y="-32027.47" font-family="Times,serif" font-size="14.00">GPU: 3724</text>
</g>
<!-- m12_res1&#45;&gt;m12_gate -->
<g id="edge164" class="edge">
<title>m12_res1&#45;&gt;m12_gate</title>
<path fill="none" stroke="black" d="M17091.08,-32137.45C17078.08,-32128.02 17062.48,-32116.7 17046.79,-32105.32"/>
<polygon fill="black" stroke="black" points="17048.74,-32102.41 17038.59,-32099.37 17044.63,-32108.08 17048.74,-32102.41"/>
</g>
<!-- m12_route -->
<g id="node146" class="node">
<title>m12_route</title>
<ellipse fill="lightgray" stroke="black" cx="16966.61" cy="-31919.69" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="16966.61" y="-31930.99" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="16966.61" y="-31915.99" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="16966.61" y="-31900.99" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m12_res1&#45;&gt;m12_route -->
<g id="edge166" class="edge">
<title>m12_res1&#45;&gt;m12_route</title>
<path fill="none" stroke="black" d="M17127.67,-32135.19C17131.79,-32099.86 17133.92,-32036.02 17104.61,-31993.17 17091.5,-31974.01 17071.68,-31959.55 17051.11,-31948.79"/>
<polygon fill="black" stroke="black" points="17052.47,-31945.56 17041.95,-31944.25 17049.36,-31951.83 17052.47,-31945.56"/>
</g>
<!-- m12_final -->
<g id="node151" class="node">
<title>m12_final</title>
<ellipse fill="lightpink" stroke="black" cx="17539.61" cy="-31596.39" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="17539.61" y="-31600.19" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="17539.61" y="-31585.19" font-family="Times,serif" font-size="14.00">GPU: 3724</text>
</g>
<!-- m12_res1&#45;&gt;m12_final -->
<g id="edge174" class="edge">
<title>m12_res1&#45;&gt;m12_final</title>
<path fill="none" stroke="black" d="M17199.71,-32156.37C17333.21,-32143.61 17595.61,-32096.22 17595.61,-31920.69 17595.61,-31920.69 17595.61,-31920.69 17595.61,-31807.74 17595.61,-31744.42 17571.62,-31673.87 17555.04,-31632.68"/>
<polygon fill="black" stroke="black" points="17558.25,-31631.29 17551.22,-31623.36 17551.78,-31633.94 17558.25,-31631.29"/>
</g>
<!-- m12_gate&#45;&gt;m12_route -->
<g id="edge165" class="edge">
<title>m12_gate&#45;&gt;m12_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16966.61,-31993.1C16966.61,-31984.67 16966.61,-31975.98 16966.61,-31967.68"/>
<polygon fill="black" stroke="black" points="16970.11,-31967.42 16966.61,-31957.42 16963.11,-31967.42 16970.11,-31967.42"/>
</g>
<!-- m12_expert0 -->
<g id="node147" class="node">
<title>m12_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="16049.61" cy="-31808.74" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="16049.61" y="-31820.04" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="16049.61" y="-31805.04" font-family="Times,serif" font-size="14.00">Node 72 GPU 0</text>
<text text-anchor="middle" x="16049.61" y="-31790.04" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m12_route&#45;&gt;m12_expert0 -->
<g id="edge167" class="edge">
<title>m12_route&#45;&gt;m12_expert0</title>
<path fill="none" stroke="black" d="M16872.15,-31907.5C16752.09,-31893.28 16538.46,-31867.96 16355.61,-31846.22 16328.41,-31842.98 16299.84,-31839.58 16271.54,-31836.21"/>
<polygon fill="black" stroke="black" points="16271.89,-31832.73 16261.55,-31835.02 16271.06,-31839.68 16271.89,-31832.73"/>
</g>
<!-- m12_expert1 -->
<g id="node148" class="node">
<title>m12_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="16660.61" cy="-31808.74" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="16660.61" y="-31820.04" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="16660.61" y="-31805.04" font-family="Times,serif" font-size="14.00">Node 72 GPU 1</text>
<text text-anchor="middle" x="16660.61" y="-31790.04" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m12_route&#45;&gt;m12_expert1 -->
<g id="edge169" class="edge">
<title>m12_route&#45;&gt;m12_expert1</title>
<path fill="none" stroke="black" d="M16895.26,-31893.29C16857.08,-31879.69 16809.32,-31862.69 16766.87,-31847.57"/>
<polygon fill="black" stroke="black" points="16767.93,-31844.24 16757.33,-31844.18 16765.58,-31850.83 16767.93,-31844.24"/>
</g>
<!-- m12_expert2 -->
<g id="node149" class="node">
<title>m12_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="17271.61" cy="-31808.74" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="17271.61" y="-31820.04" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="17271.61" y="-31805.04" font-family="Times,serif" font-size="14.00">Node 72 GPU 2</text>
<text text-anchor="middle" x="17271.61" y="-31790.04" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m12_route&#45;&gt;m12_expert2 -->
<g id="edge171" class="edge">
<title>m12_route&#45;&gt;m12_expert2</title>
<path fill="none" stroke="black" d="M17037.74,-31893.29C17075.78,-31879.69 17123.39,-31862.69 17165.7,-31847.57"/>
<polygon fill="black" stroke="black" points="17166.97,-31850.84 17175.21,-31844.18 17164.61,-31844.25 17166.97,-31850.84"/>
</g>
<!-- m12_agg -->
<g id="node150" class="node">
<title>m12_agg</title>
<polygon fill="purple" stroke="black" points="17130.23,-31735.26 16869.95,-31735.26 16803,-31659.26 17063.27,-31659.26 17130.23,-31735.26"/>
<text text-anchor="middle" x="16966.61" y="-31701.06" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16966.61" y="-31686.06" font-family="Times,serif" font-size="14.00">GPU: 3724</text>
</g>
<!-- m12_expert0&#45;&gt;m12_agg -->
<g id="edge168" class="edge">
<title>m12_expert0&#45;&gt;m12_agg</title>
<path fill="none" stroke="black" d="M16261.14,-31782.49C16439.91,-31761.14 16690.08,-31731.28 16839.48,-31713.44"/>
<polygon fill="black" stroke="black" points="16840.1,-31716.89 16849.62,-31712.23 16839.27,-31709.94 16840.1,-31716.89"/>
</g>
<!-- m12_expert1&#45;&gt;m12_agg -->
<g id="edge170" class="edge">
<title>m12_expert1&#45;&gt;m12_agg</title>
<path fill="none" stroke="black" d="M16757.01,-31773.25C16789.3,-31761.7 16825.5,-31748.75 16858.62,-31736.9"/>
<polygon fill="black" stroke="black" points="16860.09,-31740.09 16868.33,-31733.43 16857.73,-31733.5 16860.09,-31740.09"/>
</g>
<!-- m12_expert2&#45;&gt;m12_agg -->
<g id="edge172" class="edge">
<title>m12_expert2&#45;&gt;m12_agg</title>
<path fill="none" stroke="black" d="M17175.53,-31773.25C17145.07,-31762.32 17111.11,-31750.13 17079.57,-31738.81"/>
<polygon fill="black" stroke="black" points="17080.47,-31735.41 17069.87,-31735.33 17078.1,-31742 17080.47,-31735.41"/>
</g>
<!-- m12_agg&#45;&gt;m12_final -->
<g id="edge173" class="edge">
<title>m12_agg&#45;&gt;m12_final</title>
<path fill="none" stroke="black" d="M17079.13,-31676.85C17185.17,-31658.55 17342.36,-31631.43 17442.9,-31614.08"/>
<polygon fill="black" stroke="black" points="17443.79,-31617.48 17453.05,-31612.33 17442.6,-31610.58 17443.79,-31617.48"/>
</g>
<!-- m13_res1 -->
<g id="node156" class="node">
<title>m13_res1</title>
<ellipse fill="lightpink" stroke="black" cx="17652.61" cy="-31506.65" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="17652.61" y="-31510.45" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="17652.61" y="-31495.45" font-family="Times,serif" font-size="14.00">GPU: 3725</text>
</g>
<!-- m12_final&#45;&gt;m13_res1 -->
<g id="edge179" class="edge">
<title>m12_final&#45;&gt;m13_res1</title>
<path fill="none" stroke="black" d="M17571.39,-31570.72C17584.6,-31560.47 17600.05,-31548.47 17613.9,-31537.71"/>
<polygon fill="black" stroke="black" points="17616.1,-31540.43 17621.85,-31531.54 17611.81,-31534.91 17616.1,-31540.43"/>
</g>
<!-- m13_ln1 -->
<g id="node152" class="node">
<title>m13_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="17766.61" cy="-31919.69" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="17766.61" y="-31923.49" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="17766.61" y="-31908.49" font-family="Times,serif" font-size="14.00">GPU: 3725</text>
</g>
<!-- m13_qkv -->
<g id="node153" class="node">
<title>m13_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="17766.61" cy="-31808.74" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="17766.61" y="-31812.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17766.61" y="-31797.54" font-family="Times,serif" font-size="14.00">GPU: 3725</text>
</g>
<!-- m13_ln1&#45;&gt;m13_qkv -->
<g id="edge175" class="edge">
<title>m13_ln1&#45;&gt;m13_qkv</title>
<path fill="none" stroke="black" d="M17766.61,-31892.6C17766.61,-31878.58 17766.61,-31861.09 17766.61,-31845.79"/>
<polygon fill="black" stroke="black" points="17770.11,-31845.62 17766.61,-31835.62 17763.11,-31845.62 17770.11,-31845.62"/>
</g>
<!-- m13_mha -->
<g id="node154" class="node">
<title>m13_mha</title>
<ellipse fill="lightblue" stroke="black" cx="17766.61" cy="-31697.26" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="17766.61" y="-31701.06" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="17766.61" y="-31686.06" font-family="Times,serif" font-size="14.00">GPU: 3725</text>
</g>
<!-- m13_qkv&#45;&gt;m13_mha -->
<g id="edge176" class="edge">
<title>m13_qkv&#45;&gt;m13_mha</title>
<path fill="none" stroke="black" d="M17766.61,-31781.8C17766.61,-31767.72 17766.61,-31750.09 17766.61,-31734.66"/>
<polygon fill="black" stroke="black" points="17770.11,-31734.4 17766.61,-31724.4 17763.11,-31734.4 17770.11,-31734.4"/>
</g>
<!-- m13_out -->
<g id="node155" class="node">
<title>m13_out</title>
<ellipse fill="lightblue" stroke="black" cx="17766.61" cy="-31596.39" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="17766.61" y="-31600.19" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17766.61" y="-31585.19" font-family="Times,serif" font-size="14.00">GPU: 3725</text>
</g>
<!-- m13_mha&#45;&gt;m13_out -->
<g id="edge177" class="edge">
<title>m13_mha&#45;&gt;m13_out</title>
<path fill="none" stroke="black" d="M17766.61,-31670.29C17766.61,-31659.13 17766.61,-31645.91 17766.61,-31633.81"/>
<polygon fill="black" stroke="black" points="17770.11,-31633.54 17766.61,-31623.54 17763.11,-31633.54 17770.11,-31633.54"/>
</g>
<!-- m13_out&#45;&gt;m13_res1 -->
<g id="edge178" class="edge">
<title>m13_out&#45;&gt;m13_res1</title>
<path fill="none" stroke="black" d="M17734.55,-31570.72C17721.23,-31560.47 17705.64,-31548.47 17691.66,-31537.71"/>
<polygon fill="black" stroke="black" points="17693.7,-31534.86 17683.64,-31531.54 17689.43,-31540.41 17693.7,-31534.86"/>
</g>
<!-- m13_gate -->
<g id="node157" class="node">
<title>m13_gate</title>
<polygon fill="orange" stroke="black" points="17624.23,-31443.78 17419.63,-31443.78 17367,-31337.78 17571.59,-31337.78 17624.23,-31443.78"/>
<text text-anchor="middle" x="17495.61" y="-31402.08" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="17495.61" y="-31387.08" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="17495.61" y="-31372.08" font-family="Times,serif" font-size="14.00">GPU: 3725</text>
</g>
<!-- m13_res1&#45;&gt;m13_gate -->
<g id="edge180" class="edge">
<title>m13_res1&#45;&gt;m13_gate</title>
<path fill="none" stroke="black" d="M17620.08,-31482.06C17607.08,-31472.63 17591.48,-31461.31 17575.79,-31449.93"/>
<polygon fill="black" stroke="black" points="17577.74,-31447.03 17567.59,-31443.99 17573.63,-31452.69 17577.74,-31447.03"/>
</g>
<!-- m13_route -->
<g id="node158" class="node">
<title>m13_route</title>
<ellipse fill="lightgray" stroke="black" cx="17495.61" cy="-31264.31" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="17495.61" y="-31275.61" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="17495.61" y="-31260.61" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="17495.61" y="-31245.61" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m13_res1&#45;&gt;m13_route -->
<g id="edge182" class="edge">
<title>m13_res1&#45;&gt;m13_route</title>
<path fill="none" stroke="black" d="M17656.67,-31479.8C17660.79,-31444.48 17662.92,-31380.63 17633.61,-31337.78 17620.5,-31318.62 17600.68,-31304.16 17580.11,-31293.4"/>
<polygon fill="black" stroke="black" points="17581.47,-31290.17 17570.95,-31288.87 17578.36,-31296.44 17581.47,-31290.17"/>
</g>
<!-- m13_final -->
<g id="node163" class="node">
<title>m13_final</title>
<ellipse fill="lightpink" stroke="black" cx="18069.61" cy="-30941.01" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="18069.61" y="-30944.81" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="18069.61" y="-30929.81" font-family="Times,serif" font-size="14.00">GPU: 3725</text>
</g>
<!-- m13_res1&#45;&gt;m13_final -->
<g id="edge190" class="edge">
<title>m13_res1&#45;&gt;m13_final</title>
<path fill="none" stroke="black" d="M17728.87,-31501.04C17862.66,-31488.38 18125.61,-31441.12 18125.61,-31265.31 18125.61,-31265.31 18125.61,-31265.31 18125.61,-31152.35 18125.61,-31089.03 18101.62,-31018.48 18085.04,-30977.3"/>
<polygon fill="black" stroke="black" points="18088.25,-30975.9 18081.22,-30967.98 18081.78,-30978.56 18088.25,-30975.9"/>
</g>
<!-- m13_gate&#45;&gt;m13_route -->
<g id="edge181" class="edge">
<title>m13_gate&#45;&gt;m13_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17495.61,-31337.71C17495.61,-31329.28 17495.61,-31320.6 17495.61,-31312.29"/>
<polygon fill="black" stroke="black" points="17499.11,-31312.03 17495.61,-31302.03 17492.11,-31312.03 17499.11,-31312.03"/>
</g>
<!-- m13_expert0 -->
<g id="node159" class="node">
<title>m13_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="16579.61" cy="-31153.35" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="16579.61" y="-31164.65" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="16579.61" y="-31149.65" font-family="Times,serif" font-size="14.00">Node 80 GPU 0</text>
<text text-anchor="middle" x="16579.61" y="-31134.65" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m13_route&#45;&gt;m13_expert0 -->
<g id="edge183" class="edge">
<title>m13_route&#45;&gt;m13_expert0</title>
<path fill="none" stroke="black" d="M17401.3,-31252.11C17281.44,-31237.88 17068.16,-31212.55 16885.61,-31190.83 16858.41,-31187.59 16829.84,-31184.19 16801.54,-31180.82"/>
<polygon fill="black" stroke="black" points="16801.89,-31177.34 16791.55,-31179.63 16801.06,-31184.29 16801.89,-31177.34"/>
</g>
<!-- m13_expert1 -->
<g id="node160" class="node">
<title>m13_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="17190.61" cy="-31153.35" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="17190.61" y="-31164.65" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="17190.61" y="-31149.65" font-family="Times,serif" font-size="14.00">Node 80 GPU 1</text>
<text text-anchor="middle" x="17190.61" y="-31134.65" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m13_route&#45;&gt;m13_expert1 -->
<g id="edge185" class="edge">
<title>m13_route&#45;&gt;m13_expert1</title>
<path fill="none" stroke="black" d="M17424.49,-31237.9C17386.44,-31224.31 17338.83,-31207.3 17296.52,-31192.19"/>
<polygon fill="black" stroke="black" points="17297.61,-31188.86 17287.02,-31188.79 17295.26,-31195.45 17297.61,-31188.86"/>
</g>
<!-- m13_expert2 -->
<g id="node161" class="node">
<title>m13_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="17801.61" cy="-31153.35" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="17801.61" y="-31164.65" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="17801.61" y="-31149.65" font-family="Times,serif" font-size="14.00">Node 80 GPU 2</text>
<text text-anchor="middle" x="17801.61" y="-31134.65" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m13_route&#45;&gt;m13_expert2 -->
<g id="edge187" class="edge">
<title>m13_route&#45;&gt;m13_expert2</title>
<path fill="none" stroke="black" d="M17566.97,-31237.9C17605.14,-31224.31 17652.9,-31207.3 17695.36,-31192.19"/>
<polygon fill="black" stroke="black" points="17696.64,-31195.44 17704.89,-31188.79 17694.3,-31188.85 17696.64,-31195.44"/>
</g>
<!-- m13_agg -->
<g id="node162" class="node">
<title>m13_agg</title>
<polygon fill="purple" stroke="black" points="17660.23,-31079.88 17399.95,-31079.88 17333,-31003.88 17593.27,-31003.88 17660.23,-31079.88"/>
<text text-anchor="middle" x="17496.61" y="-31045.68" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="17496.61" y="-31030.68" font-family="Times,serif" font-size="14.00">GPU: 3725</text>
</g>
<!-- m13_expert0&#45;&gt;m13_agg -->
<g id="edge184" class="edge">
<title>m13_expert0&#45;&gt;m13_agg</title>
<path fill="none" stroke="black" d="M16791.14,-31127.1C16969.91,-31105.76 17220.08,-31075.89 17369.48,-31058.05"/>
<polygon fill="black" stroke="black" points="17370.1,-31061.5 17379.62,-31056.84 17369.27,-31054.55 17370.1,-31061.5"/>
</g>
<!-- m13_expert1&#45;&gt;m13_agg -->
<g id="edge186" class="edge">
<title>m13_expert1&#45;&gt;m13_agg</title>
<path fill="none" stroke="black" d="M17287.01,-31117.86C17319.3,-31106.31 17355.5,-31093.36 17388.62,-31081.51"/>
<polygon fill="black" stroke="black" points="17390.09,-31084.7 17398.33,-31078.04 17387.73,-31078.11 17390.09,-31084.7"/>
</g>
<!-- m13_expert2&#45;&gt;m13_agg -->
<g id="edge188" class="edge">
<title>m13_expert2&#45;&gt;m13_agg</title>
<path fill="none" stroke="black" d="M17705.53,-31117.86C17675.07,-31106.93 17641.11,-31094.74 17609.57,-31083.42"/>
<polygon fill="black" stroke="black" points="17610.47,-31080.02 17599.87,-31079.94 17608.1,-31086.61 17610.47,-31080.02"/>
</g>
<!-- m13_agg&#45;&gt;m13_final -->
<g id="edge189" class="edge">
<title>m13_agg&#45;&gt;m13_final</title>
<path fill="none" stroke="black" d="M17609.13,-31021.46C17715.17,-31003.17 17872.36,-30976.04 17972.9,-30958.69"/>
<polygon fill="black" stroke="black" points="17973.79,-30962.09 17983.05,-30956.94 17972.6,-30955.19 17973.79,-30962.09"/>
</g>
<!-- m14_res1 -->
<g id="node168" class="node">
<title>m14_res1</title>
<ellipse fill="lightpink" stroke="black" cx="18182.61" cy="-30851.27" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="18182.61" y="-30855.07" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18182.61" y="-30840.07" font-family="Times,serif" font-size="14.00">GPU: 3726</text>
</g>
<!-- m13_final&#45;&gt;m14_res1 -->
<g id="edge195" class="edge">
<title>m13_final&#45;&gt;m14_res1</title>
<path fill="none" stroke="black" d="M18101.39,-30915.33C18114.6,-30905.08 18130.05,-30893.08 18143.9,-30882.32"/>
<polygon fill="black" stroke="black" points="18146.1,-30885.05 18151.85,-30876.15 18141.81,-30879.52 18146.1,-30885.05"/>
</g>
<!-- m14_ln1 -->
<g id="node164" class="node">
<title>m14_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="18296.61" cy="-31264.31" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="18296.61" y="-31268.11" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18296.61" y="-31253.11" font-family="Times,serif" font-size="14.00">GPU: 3726</text>
</g>
<!-- m14_qkv -->
<g id="node165" class="node">
<title>m14_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="18296.61" cy="-31153.35" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="18296.61" y="-31157.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18296.61" y="-31142.15" font-family="Times,serif" font-size="14.00">GPU: 3726</text>
</g>
<!-- m14_ln1&#45;&gt;m14_qkv -->
<g id="edge191" class="edge">
<title>m14_ln1&#45;&gt;m14_qkv</title>
<path fill="none" stroke="black" d="M18296.61,-31237.21C18296.61,-31223.19 18296.61,-31205.7 18296.61,-31190.41"/>
<polygon fill="black" stroke="black" points="18300.11,-31190.24 18296.61,-31180.24 18293.11,-31190.24 18300.11,-31190.24"/>
</g>
<!-- m14_mha -->
<g id="node166" class="node">
<title>m14_mha</title>
<ellipse fill="lightblue" stroke="black" cx="18296.61" cy="-31041.88" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18296.61" y="-31045.68" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="18296.61" y="-31030.68" font-family="Times,serif" font-size="14.00">GPU: 3726</text>
</g>
<!-- m14_qkv&#45;&gt;m14_mha -->
<g id="edge192" class="edge">
<title>m14_qkv&#45;&gt;m14_mha</title>
<path fill="none" stroke="black" d="M18296.61,-31126.41C18296.61,-31112.33 18296.61,-31094.7 18296.61,-31079.27"/>
<polygon fill="black" stroke="black" points="18300.11,-31079.01 18296.61,-31069.01 18293.11,-31079.01 18300.11,-31079.01"/>
</g>
<!-- m14_out -->
<g id="node167" class="node">
<title>m14_out</title>
<ellipse fill="lightblue" stroke="black" cx="18296.61" cy="-30941.01" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="18296.61" y="-30944.81" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18296.61" y="-30929.81" font-family="Times,serif" font-size="14.00">GPU: 3726</text>
</g>
<!-- m14_mha&#45;&gt;m14_out -->
<g id="edge193" class="edge">
<title>m14_mha&#45;&gt;m14_out</title>
<path fill="none" stroke="black" d="M18296.61,-31014.9C18296.61,-31003.75 18296.61,-30990.52 18296.61,-30978.42"/>
<polygon fill="black" stroke="black" points="18300.11,-30978.15 18296.61,-30968.15 18293.11,-30978.15 18300.11,-30978.15"/>
</g>
<!-- m14_out&#45;&gt;m14_res1 -->
<g id="edge194" class="edge">
<title>m14_out&#45;&gt;m14_res1</title>
<path fill="none" stroke="black" d="M18264.55,-30915.33C18251.23,-30905.08 18235.64,-30893.08 18221.66,-30882.32"/>
<polygon fill="black" stroke="black" points="18223.7,-30879.48 18213.64,-30876.15 18219.43,-30885.02 18223.7,-30879.48"/>
</g>
<!-- m14_gate -->
<g id="node169" class="node">
<title>m14_gate</title>
<polygon fill="orange" stroke="black" points="18154.23,-30788.4 17949.63,-30788.4 17897,-30682.4 18101.59,-30682.4 18154.23,-30788.4"/>
<text text-anchor="middle" x="18025.61" y="-30746.7" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="18025.61" y="-30731.7" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="18025.61" y="-30716.7" font-family="Times,serif" font-size="14.00">GPU: 3726</text>
</g>
<!-- m14_res1&#45;&gt;m14_gate -->
<g id="edge196" class="edge">
<title>m14_res1&#45;&gt;m14_gate</title>
<path fill="none" stroke="black" d="M18150.08,-30826.67C18137.08,-30817.24 18121.48,-30805.93 18105.79,-30794.55"/>
<polygon fill="black" stroke="black" points="18107.74,-30791.64 18097.59,-30788.6 18103.63,-30797.3 18107.74,-30791.64"/>
</g>
<!-- m14_route -->
<g id="node170" class="node">
<title>m14_route</title>
<ellipse fill="lightgray" stroke="black" cx="18025.61" cy="-30608.92" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="18025.61" y="-30620.22" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="18025.61" y="-30605.22" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="18025.61" y="-30590.22" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m14_res1&#45;&gt;m14_route -->
<g id="edge198" class="edge">
<title>m14_res1&#45;&gt;m14_route</title>
<path fill="none" stroke="black" d="M18186.67,-30824.42C18190.79,-30789.09 18192.92,-30725.24 18163.61,-30682.4 18150.5,-30663.23 18130.68,-30648.77 18110.11,-30638.02"/>
<polygon fill="black" stroke="black" points="18111.47,-30634.78 18100.95,-30633.48 18108.36,-30641.05 18111.47,-30634.78"/>
</g>
<!-- m14_final -->
<g id="node175" class="node">
<title>m14_final</title>
<ellipse fill="lightpink" stroke="black" cx="18599.61" cy="-30285.62" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="18599.61" y="-30289.42" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="18599.61" y="-30274.42" font-family="Times,serif" font-size="14.00">GPU: 3726</text>
</g>
<!-- m14_res1&#45;&gt;m14_final -->
<g id="edge206" class="edge">
<title>m14_res1&#45;&gt;m14_final</title>
<path fill="none" stroke="black" d="M18258.87,-30845.65C18392.66,-30832.99 18655.61,-30785.74 18655.61,-30609.92 18655.61,-30609.92 18655.61,-30609.92 18655.61,-30496.97 18655.61,-30433.64 18631.62,-30363.09 18615.04,-30321.91"/>
<polygon fill="black" stroke="black" points="18618.25,-30320.51 18611.22,-30312.59 18611.78,-30323.17 18618.25,-30320.51"/>
</g>
<!-- m14_gate&#45;&gt;m14_route -->
<g id="edge197" class="edge">
<title>m14_gate&#45;&gt;m14_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18025.61,-30682.33C18025.61,-30673.9 18025.61,-30665.21 18025.61,-30656.91"/>
<polygon fill="black" stroke="black" points="18029.11,-30656.65 18025.61,-30646.65 18022.11,-30656.65 18029.11,-30656.65"/>
</g>
<!-- m14_expert0 -->
<g id="node171" class="node">
<title>m14_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="17109.61" cy="-30497.97" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="17109.61" y="-30509.27" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="17109.61" y="-30494.27" font-family="Times,serif" font-size="14.00">Node 88 GPU 0</text>
<text text-anchor="middle" x="17109.61" y="-30479.27" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m14_route&#45;&gt;m14_expert0 -->
<g id="edge199" class="edge">
<title>m14_route&#45;&gt;m14_expert0</title>
<path fill="none" stroke="black" d="M17931.3,-30596.73C17811.44,-30582.5 17598.16,-30557.17 17415.61,-30535.44 17388.41,-30532.2 17359.84,-30528.8 17331.54,-30525.43"/>
<polygon fill="black" stroke="black" points="17331.89,-30521.95 17321.55,-30524.24 17331.06,-30528.9 17331.89,-30521.95"/>
</g>
<!-- m14_expert1 -->
<g id="node172" class="node">
<title>m14_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="17720.61" cy="-30497.97" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="17720.61" y="-30509.27" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="17720.61" y="-30494.27" font-family="Times,serif" font-size="14.00">Node 88 GPU 1</text>
<text text-anchor="middle" x="17720.61" y="-30479.27" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m14_route&#45;&gt;m14_expert1 -->
<g id="edge201" class="edge">
<title>m14_route&#45;&gt;m14_expert1</title>
<path fill="none" stroke="black" d="M17954.49,-30582.51C17916.44,-30568.92 17868.83,-30551.91 17826.52,-30536.8"/>
<polygon fill="black" stroke="black" points="17827.61,-30533.47 17817.02,-30533.4 17825.26,-30540.06 17827.61,-30533.47"/>
</g>
<!-- m14_expert2 -->
<g id="node173" class="node">
<title>m14_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="18331.61" cy="-30497.97" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="18331.61" y="-30509.27" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="18331.61" y="-30494.27" font-family="Times,serif" font-size="14.00">Node 88 GPU 2</text>
<text text-anchor="middle" x="18331.61" y="-30479.27" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m14_route&#45;&gt;m14_expert2 -->
<g id="edge203" class="edge">
<title>m14_route&#45;&gt;m14_expert2</title>
<path fill="none" stroke="black" d="M18096.97,-30582.51C18135.14,-30568.92 18182.9,-30551.91 18225.36,-30536.8"/>
<polygon fill="black" stroke="black" points="18226.64,-30540.06 18234.89,-30533.4 18224.3,-30533.46 18226.64,-30540.06"/>
</g>
<!-- m14_agg -->
<g id="node174" class="node">
<title>m14_agg</title>
<polygon fill="purple" stroke="black" points="18190.23,-30424.49 17929.95,-30424.49 17863,-30348.49 18123.27,-30348.49 18190.23,-30424.49"/>
<text text-anchor="middle" x="18026.61" y="-30390.29" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="18026.61" y="-30375.29" font-family="Times,serif" font-size="14.00">GPU: 3726</text>
</g>
<!-- m14_expert0&#45;&gt;m14_agg -->
<g id="edge200" class="edge">
<title>m14_expert0&#45;&gt;m14_agg</title>
<path fill="none" stroke="black" d="M17321.14,-30471.71C17499.91,-30450.37 17750.08,-30420.5 17899.48,-30402.67"/>
<polygon fill="black" stroke="black" points="17900.1,-30406.12 17909.62,-30401.46 17899.27,-30399.17 17900.1,-30406.12"/>
</g>
<!-- m14_expert1&#45;&gt;m14_agg -->
<g id="edge202" class="edge">
<title>m14_expert1&#45;&gt;m14_agg</title>
<path fill="none" stroke="black" d="M17817.01,-30462.48C17849.3,-30450.93 17885.5,-30437.97 17918.62,-30426.13"/>
<polygon fill="black" stroke="black" points="17920.09,-30429.32 17928.33,-30422.65 17917.73,-30422.73 17920.09,-30429.32"/>
</g>
<!-- m14_expert2&#45;&gt;m14_agg -->
<g id="edge204" class="edge">
<title>m14_expert2&#45;&gt;m14_agg</title>
<path fill="none" stroke="black" d="M18235.53,-30462.48C18205.07,-30451.54 18171.11,-30439.35 18139.57,-30428.04"/>
<polygon fill="black" stroke="black" points="18140.47,-30424.64 18129.87,-30424.55 18138.1,-30431.23 18140.47,-30424.64"/>
</g>
<!-- m14_agg&#45;&gt;m14_final -->
<g id="edge205" class="edge">
<title>m14_agg&#45;&gt;m14_final</title>
<path fill="none" stroke="black" d="M18139.13,-30366.07C18245.17,-30347.78 18402.36,-30320.65 18502.9,-30303.31"/>
<polygon fill="black" stroke="black" points="18503.79,-30306.7 18513.05,-30301.56 18502.6,-30299.81 18503.79,-30306.7"/>
</g>
<!-- m15_res1 -->
<g id="node180" class="node">
<title>m15_res1</title>
<ellipse fill="lightpink" stroke="black" cx="18712.61" cy="-30195.88" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="18712.61" y="-30199.68" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="18712.61" y="-30184.68" font-family="Times,serif" font-size="14.00">GPU: 3727</text>
</g>
<!-- m14_final&#45;&gt;m15_res1 -->
<g id="edge211" class="edge">
<title>m14_final&#45;&gt;m15_res1</title>
<path fill="none" stroke="black" d="M18631.39,-30259.95C18644.6,-30249.69 18660.05,-30237.7 18673.9,-30226.93"/>
<polygon fill="black" stroke="black" points="18676.1,-30229.66 18681.85,-30220.76 18671.81,-30224.13 18676.1,-30229.66"/>
</g>
<!-- m15_ln1 -->
<g id="node176" class="node">
<title>m15_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="18826.61" cy="-30608.92" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="18826.61" y="-30612.72" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="18826.61" y="-30597.72" font-family="Times,serif" font-size="14.00">GPU: 3727</text>
</g>
<!-- m15_qkv -->
<g id="node177" class="node">
<title>m15_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="18826.61" cy="-30497.97" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="18826.61" y="-30501.77" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18826.61" y="-30486.77" font-family="Times,serif" font-size="14.00">GPU: 3727</text>
</g>
<!-- m15_ln1&#45;&gt;m15_qkv -->
<g id="edge207" class="edge">
<title>m15_ln1&#45;&gt;m15_qkv</title>
<path fill="none" stroke="black" d="M18826.61,-30581.82C18826.61,-30567.81 18826.61,-30550.31 18826.61,-30535.02"/>
<polygon fill="black" stroke="black" points="18830.11,-30534.85 18826.61,-30524.85 18823.11,-30534.85 18830.11,-30534.85"/>
</g>
<!-- m15_mha -->
<g id="node178" class="node">
<title>m15_mha</title>
<ellipse fill="lightblue" stroke="black" cx="18826.61" cy="-30386.49" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="18826.61" y="-30390.29" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="18826.61" y="-30375.29" font-family="Times,serif" font-size="14.00">GPU: 3727</text>
</g>
<!-- m15_qkv&#45;&gt;m15_mha -->
<g id="edge208" class="edge">
<title>m15_qkv&#45;&gt;m15_mha</title>
<path fill="none" stroke="black" d="M18826.61,-30471.02C18826.61,-30456.95 18826.61,-30439.32 18826.61,-30423.89"/>
<polygon fill="black" stroke="black" points="18830.11,-30423.63 18826.61,-30413.63 18823.11,-30423.63 18830.11,-30423.63"/>
</g>
<!-- m15_out -->
<g id="node179" class="node">
<title>m15_out</title>
<ellipse fill="lightblue" stroke="black" cx="18826.61" cy="-30285.62" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="18826.61" y="-30289.42" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18826.61" y="-30274.42" font-family="Times,serif" font-size="14.00">GPU: 3727</text>
</g>
<!-- m15_mha&#45;&gt;m15_out -->
<g id="edge209" class="edge">
<title>m15_mha&#45;&gt;m15_out</title>
<path fill="none" stroke="black" d="M18826.61,-30359.51C18826.61,-30348.36 18826.61,-30335.14 18826.61,-30323.03"/>
<polygon fill="black" stroke="black" points="18830.11,-30322.77 18826.61,-30312.77 18823.11,-30322.77 18830.11,-30322.77"/>
</g>
<!-- m15_out&#45;&gt;m15_res1 -->
<g id="edge210" class="edge">
<title>m15_out&#45;&gt;m15_res1</title>
<path fill="none" stroke="black" d="M18794.55,-30259.95C18781.23,-30249.69 18765.64,-30237.7 18751.66,-30226.93"/>
<polygon fill="black" stroke="black" points="18753.7,-30224.09 18743.64,-30220.76 18749.43,-30229.64 18753.7,-30224.09"/>
</g>
<!-- m15_gate -->
<g id="node181" class="node">
<title>m15_gate</title>
<polygon fill="orange" stroke="black" points="18684.23,-30133.01 18479.63,-30133.01 18427,-30027.01 18631.59,-30027.01 18684.23,-30133.01"/>
<text text-anchor="middle" x="18555.61" y="-30091.31" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="18555.61" y="-30076.31" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="18555.61" y="-30061.31" font-family="Times,serif" font-size="14.00">GPU: 3727</text>
</g>
<!-- m15_res1&#45;&gt;m15_gate -->
<g id="edge212" class="edge">
<title>m15_res1&#45;&gt;m15_gate</title>
<path fill="none" stroke="black" d="M18680.08,-30171.29C18667.08,-30161.85 18651.48,-30150.54 18635.79,-30139.16"/>
<polygon fill="black" stroke="black" points="18637.74,-30136.25 18627.59,-30133.21 18633.63,-30141.92 18637.74,-30136.25"/>
</g>
<!-- m15_route -->
<g id="node182" class="node">
<title>m15_route</title>
<ellipse fill="lightgray" stroke="black" cx="18555.61" cy="-29953.53" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="18555.61" y="-29964.83" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="18555.61" y="-29949.83" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="18555.61" y="-29934.83" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m15_res1&#45;&gt;m15_route -->
<g id="edge214" class="edge">
<title>m15_res1&#45;&gt;m15_route</title>
<path fill="none" stroke="black" d="M18716.67,-30169.03C18720.79,-30133.7 18722.92,-30069.86 18693.61,-30027.01 18680.5,-30007.84 18660.68,-29993.38 18640.11,-29982.63"/>
<polygon fill="black" stroke="black" points="18641.47,-29979.39 18630.95,-29978.09 18638.36,-29985.67 18641.47,-29979.39"/>
</g>
<!-- m15_final -->
<g id="node187" class="node">
<title>m15_final</title>
<ellipse fill="lightpink" stroke="black" cx="19128.61" cy="-29630.23" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="19128.61" y="-29634.03" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="19128.61" y="-29619.03" font-family="Times,serif" font-size="14.00">GPU: 3727</text>
</g>
<!-- m15_res1&#45;&gt;m15_final -->
<g id="edge222" class="edge">
<title>m15_res1&#45;&gt;m15_final</title>
<path fill="none" stroke="black" d="M18788.71,-30190.21C18922.21,-30177.45 19184.61,-30130.05 19184.61,-29954.53 19184.61,-29954.53 19184.61,-29954.53 19184.61,-29841.58 19184.61,-29778.25 19160.62,-29707.71 19144.04,-29666.52"/>
<polygon fill="black" stroke="black" points="19147.25,-29665.12 19140.22,-29657.2 19140.78,-29667.78 19147.25,-29665.12"/>
</g>
<!-- m15_gate&#45;&gt;m15_route -->
<g id="edge213" class="edge">
<title>m15_gate&#45;&gt;m15_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18555.61,-30026.94C18555.61,-30018.51 18555.61,-30009.82 18555.61,-30001.52"/>
<polygon fill="black" stroke="black" points="18559.11,-30001.26 18555.61,-29991.26 18552.11,-30001.26 18559.11,-30001.26"/>
</g>
<!-- m15_expert0 -->
<g id="node183" class="node">
<title>m15_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="17638.61" cy="-29842.58" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="17638.61" y="-29853.88" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="17638.61" y="-29838.88" font-family="Times,serif" font-size="14.00">Node 96 GPU 0</text>
<text text-anchor="middle" x="17638.61" y="-29823.88" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m15_route&#45;&gt;m15_expert0 -->
<g id="edge215" class="edge">
<title>m15_route&#45;&gt;m15_expert0</title>
<path fill="none" stroke="black" d="M18461.15,-29941.34C18341.09,-29927.12 18127.46,-29901.8 17944.61,-29880.06 17917.41,-29876.82 17888.84,-29873.42 17860.54,-29870.05"/>
<polygon fill="black" stroke="black" points="17860.89,-29866.57 17850.55,-29868.86 17860.06,-29873.52 17860.89,-29866.57"/>
</g>
<!-- m15_expert1 -->
<g id="node184" class="node">
<title>m15_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="18249.61" cy="-29842.58" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="18249.61" y="-29853.88" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="18249.61" y="-29838.88" font-family="Times,serif" font-size="14.00">Node 96 GPU 1</text>
<text text-anchor="middle" x="18249.61" y="-29823.88" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m15_route&#45;&gt;m15_expert1 -->
<g id="edge217" class="edge">
<title>m15_route&#45;&gt;m15_expert1</title>
<path fill="none" stroke="black" d="M18484.26,-29927.13C18446.08,-29913.53 18398.32,-29896.53 18355.87,-29881.41"/>
<polygon fill="black" stroke="black" points="18356.93,-29878.07 18346.33,-29878.02 18354.58,-29884.67 18356.93,-29878.07"/>
</g>
<!-- m15_expert2 -->
<g id="node185" class="node">
<title>m15_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="18860.61" cy="-29842.58" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="18860.61" y="-29853.88" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="18860.61" y="-29838.88" font-family="Times,serif" font-size="14.00">Node 96 GPU 2</text>
<text text-anchor="middle" x="18860.61" y="-29823.88" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m15_route&#45;&gt;m15_expert2 -->
<g id="edge219" class="edge">
<title>m15_route&#45;&gt;m15_expert2</title>
<path fill="none" stroke="black" d="M18626.74,-29927.13C18664.78,-29913.53 18712.39,-29896.53 18754.7,-29881.41"/>
<polygon fill="black" stroke="black" points="18755.97,-29884.68 18764.21,-29878.02 18753.61,-29878.09 18755.97,-29884.68"/>
</g>
<!-- m15_agg -->
<g id="node186" class="node">
<title>m15_agg</title>
<polygon fill="purple" stroke="black" points="18719.23,-29769.1 18458.95,-29769.1 18392,-29693.1 18652.27,-29693.1 18719.23,-29769.1"/>
<text text-anchor="middle" x="18555.61" y="-29734.9" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="18555.61" y="-29719.9" font-family="Times,serif" font-size="14.00">GPU: 3727</text>
</g>
<!-- m15_expert0&#45;&gt;m15_agg -->
<g id="edge216" class="edge">
<title>m15_expert0&#45;&gt;m15_agg</title>
<path fill="none" stroke="black" d="M17850.14,-29816.33C18028.91,-29794.98 18279.08,-29765.12 18428.48,-29747.28"/>
<polygon fill="black" stroke="black" points="18429.1,-29750.73 18438.62,-29746.07 18428.27,-29743.78 18429.1,-29750.73"/>
</g>
<!-- m15_expert1&#45;&gt;m15_agg -->
<g id="edge218" class="edge">
<title>m15_expert1&#45;&gt;m15_agg</title>
<path fill="none" stroke="black" d="M18346.01,-29807.09C18378.3,-29795.54 18414.5,-29782.59 18447.62,-29770.74"/>
<polygon fill="black" stroke="black" points="18449.09,-29773.93 18457.33,-29767.27 18446.73,-29767.34 18449.09,-29773.93"/>
</g>
<!-- m15_expert2&#45;&gt;m15_agg -->
<g id="edge220" class="edge">
<title>m15_expert2&#45;&gt;m15_agg</title>
<path fill="none" stroke="black" d="M18764.53,-29807.09C18734.07,-29796.16 18700.11,-29783.97 18668.57,-29772.65"/>
<polygon fill="black" stroke="black" points="18669.47,-29769.25 18658.87,-29769.17 18667.1,-29775.84 18669.47,-29769.25"/>
</g>
<!-- m15_agg&#45;&gt;m15_final -->
<g id="edge221" class="edge">
<title>m15_agg&#45;&gt;m15_final</title>
<path fill="none" stroke="black" d="M18668.13,-29710.69C18774.17,-29692.39 18931.36,-29665.27 19031.9,-29647.92"/>
<polygon fill="black" stroke="black" points="19032.79,-29651.32 19042.05,-29646.17 19031.6,-29644.42 19032.79,-29651.32"/>
</g>
<!-- m16_res1 -->
<g id="node192" class="node">
<title>m16_res1</title>
<ellipse fill="lightpink" stroke="black" cx="19241.61" cy="-29540.49" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="19241.61" y="-29544.29" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19241.61" y="-29529.29" font-family="Times,serif" font-size="14.00">GPU: 3728</text>
</g>
<!-- m15_final&#45;&gt;m16_res1 -->
<g id="edge227" class="edge">
<title>m15_final&#45;&gt;m16_res1</title>
<path fill="none" stroke="black" d="M19160.39,-29604.56C19173.6,-29594.3 19189.05,-29582.31 19202.9,-29571.55"/>
<polygon fill="black" stroke="black" points="19205.1,-29574.27 19210.85,-29565.38 19200.81,-29568.74 19205.1,-29574.27"/>
</g>
<!-- m16_ln1 -->
<g id="node188" class="node">
<title>m16_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="19355.61" cy="-29953.53" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="19355.61" y="-29957.33" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19355.61" y="-29942.33" font-family="Times,serif" font-size="14.00">GPU: 3728</text>
</g>
<!-- m16_qkv -->
<g id="node189" class="node">
<title>m16_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="19355.61" cy="-29842.58" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="19355.61" y="-29846.38" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19355.61" y="-29831.38" font-family="Times,serif" font-size="14.00">GPU: 3728</text>
</g>
<!-- m16_ln1&#45;&gt;m16_qkv -->
<g id="edge223" class="edge">
<title>m16_ln1&#45;&gt;m16_qkv</title>
<path fill="none" stroke="black" d="M19355.61,-29926.44C19355.61,-29912.42 19355.61,-29894.93 19355.61,-29879.63"/>
<polygon fill="black" stroke="black" points="19359.11,-29879.46 19355.61,-29869.46 19352.11,-29879.46 19359.11,-29879.46"/>
</g>
<!-- m16_mha -->
<g id="node190" class="node">
<title>m16_mha</title>
<ellipse fill="lightblue" stroke="black" cx="19355.61" cy="-29731.1" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="19355.61" y="-29734.9" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="19355.61" y="-29719.9" font-family="Times,serif" font-size="14.00">GPU: 3728</text>
</g>
<!-- m16_qkv&#45;&gt;m16_mha -->
<g id="edge224" class="edge">
<title>m16_qkv&#45;&gt;m16_mha</title>
<path fill="none" stroke="black" d="M19355.61,-29815.63C19355.61,-29801.56 19355.61,-29783.93 19355.61,-29768.5"/>
<polygon fill="black" stroke="black" points="19359.11,-29768.24 19355.61,-29758.24 19352.11,-29768.24 19359.11,-29768.24"/>
</g>
<!-- m16_out -->
<g id="node191" class="node">
<title>m16_out</title>
<ellipse fill="lightblue" stroke="black" cx="19355.61" cy="-29630.23" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="19355.61" y="-29634.03" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="19355.61" y="-29619.03" font-family="Times,serif" font-size="14.00">GPU: 3728</text>
</g>
<!-- m16_mha&#45;&gt;m16_out -->
<g id="edge225" class="edge">
<title>m16_mha&#45;&gt;m16_out</title>
<path fill="none" stroke="black" d="M19355.61,-29704.13C19355.61,-29692.97 19355.61,-29679.75 19355.61,-29667.65"/>
<polygon fill="black" stroke="black" points="19359.11,-29667.38 19355.61,-29657.38 19352.11,-29667.38 19359.11,-29667.38"/>
</g>
<!-- m16_out&#45;&gt;m16_res1 -->
<g id="edge226" class="edge">
<title>m16_out&#45;&gt;m16_res1</title>
<path fill="none" stroke="black" d="M19323.55,-29604.56C19310.23,-29594.3 19294.64,-29582.31 19280.66,-29571.55"/>
<polygon fill="black" stroke="black" points="19282.7,-29568.7 19272.64,-29565.38 19278.43,-29574.25 19282.7,-29568.7"/>
</g>
<!-- m16_gate -->
<g id="node193" class="node">
<title>m16_gate</title>
<polygon fill="orange" stroke="black" points="19213.23,-29477.62 19008.63,-29477.62 18956,-29371.62 19160.59,-29371.62 19213.23,-29477.62"/>
<text text-anchor="middle" x="19084.61" y="-29435.92" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="19084.61" y="-29420.92" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="19084.61" y="-29405.92" font-family="Times,serif" font-size="14.00">GPU: 3728</text>
</g>
<!-- m16_res1&#45;&gt;m16_gate -->
<g id="edge228" class="edge">
<title>m16_res1&#45;&gt;m16_gate</title>
<path fill="none" stroke="black" d="M19209.08,-29515.9C19196.08,-29506.47 19180.48,-29495.15 19164.79,-29483.77"/>
<polygon fill="black" stroke="black" points="19166.74,-29480.86 19156.59,-29477.83 19162.63,-29486.53 19166.74,-29480.86"/>
</g>
<!-- m16_route -->
<g id="node194" class="node">
<title>m16_route</title>
<ellipse fill="lightgray" stroke="black" cx="19084.61" cy="-29298.15" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="19084.61" y="-29309.45" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="19084.61" y="-29294.45" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="19084.61" y="-29279.45" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m16_res1&#45;&gt;m16_route -->
<g id="edge230" class="edge">
<title>m16_res1&#45;&gt;m16_route</title>
<path fill="none" stroke="black" d="M19245.67,-29513.64C19249.79,-29478.32 19251.92,-29414.47 19222.61,-29371.62 19209.5,-29352.46 19189.68,-29338 19169.11,-29327.24"/>
<polygon fill="black" stroke="black" points="19170.47,-29324.01 19159.95,-29322.71 19167.36,-29330.28 19170.47,-29324.01"/>
</g>
<!-- m16_final -->
<g id="node199" class="node">
<title>m16_final</title>
<ellipse fill="lightpink" stroke="black" cx="19657.61" cy="-28974.85" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="19657.61" y="-28978.65" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="19657.61" y="-28963.65" font-family="Times,serif" font-size="14.00">GPU: 3728</text>
</g>
<!-- m16_res1&#45;&gt;m16_final -->
<g id="edge238" class="edge">
<title>m16_res1&#45;&gt;m16_final</title>
<path fill="none" stroke="black" d="M19317.71,-29534.82C19451.21,-29522.06 19713.61,-29474.67 19713.61,-29299.15 19713.61,-29299.15 19713.61,-29299.15 19713.61,-29186.19 19713.61,-29122.87 19689.62,-29052.32 19673.04,-29011.14"/>
<polygon fill="black" stroke="black" points="19676.25,-29009.74 19669.22,-29001.82 19669.78,-29012.4 19676.25,-29009.74"/>
</g>
<!-- m16_gate&#45;&gt;m16_route -->
<g id="edge229" class="edge">
<title>m16_gate&#45;&gt;m16_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19084.61,-29371.55C19084.61,-29363.12 19084.61,-29354.43 19084.61,-29346.13"/>
<polygon fill="black" stroke="black" points="19088.11,-29345.87 19084.61,-29335.87 19081.11,-29345.87 19088.11,-29345.87"/>
</g>
<!-- m16_expert0 -->
<g id="node195" class="node">
<title>m16_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="18167.61" cy="-29187.19" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="18167.61" y="-29198.49" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="18167.61" y="-29183.49" font-family="Times,serif" font-size="14.00">Node 104 GPU 0</text>
<text text-anchor="middle" x="18167.61" y="-29168.49" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m16_route&#45;&gt;m16_expert0 -->
<g id="edge231" class="edge">
<title>m16_route&#45;&gt;m16_expert0</title>
<path fill="none" stroke="black" d="M18990.15,-29285.96C18870.09,-29271.73 18656.46,-29246.41 18473.61,-29224.67 18446.41,-29221.43 18417.84,-29218.03 18389.54,-29214.66"/>
<polygon fill="black" stroke="black" points="18389.89,-29211.18 18379.55,-29213.47 18389.06,-29218.13 18389.89,-29211.18"/>
</g>
<!-- m16_expert1 -->
<g id="node196" class="node">
<title>m16_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="18778.61" cy="-29187.19" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="18778.61" y="-29198.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="18778.61" y="-29183.49" font-family="Times,serif" font-size="14.00">Node 104 GPU 1</text>
<text text-anchor="middle" x="18778.61" y="-29168.49" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m16_route&#45;&gt;m16_expert1 -->
<g id="edge233" class="edge">
<title>m16_route&#45;&gt;m16_expert1</title>
<path fill="none" stroke="black" d="M19013.26,-29271.74C18975.08,-29258.15 18927.32,-29241.14 18884.87,-29226.03"/>
<polygon fill="black" stroke="black" points="18885.93,-29222.69 18875.33,-29222.63 18883.58,-29229.28 18885.93,-29222.69"/>
</g>
<!-- m16_expert2 -->
<g id="node197" class="node">
<title>m16_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="19389.61" cy="-29187.19" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="19389.61" y="-29198.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="19389.61" y="-29183.49" font-family="Times,serif" font-size="14.00">Node 104 GPU 2</text>
<text text-anchor="middle" x="19389.61" y="-29168.49" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m16_route&#45;&gt;m16_expert2 -->
<g id="edge235" class="edge">
<title>m16_route&#45;&gt;m16_expert2</title>
<path fill="none" stroke="black" d="M19155.74,-29271.74C19193.78,-29258.15 19241.39,-29241.14 19283.7,-29226.03"/>
<polygon fill="black" stroke="black" points="19284.97,-29229.29 19293.21,-29222.63 19282.61,-29222.7 19284.97,-29229.29"/>
</g>
<!-- m16_agg -->
<g id="node198" class="node">
<title>m16_agg</title>
<polygon fill="purple" stroke="black" points="19248.23,-29113.72 18987.95,-29113.72 18921,-29037.72 19181.27,-29037.72 19248.23,-29113.72"/>
<text text-anchor="middle" x="19084.61" y="-29079.52" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="19084.61" y="-29064.52" font-family="Times,serif" font-size="14.00">GPU: 3728</text>
</g>
<!-- m16_expert0&#45;&gt;m16_agg -->
<g id="edge232" class="edge">
<title>m16_expert0&#45;&gt;m16_agg</title>
<path fill="none" stroke="black" d="M18379.14,-29160.94C18557.91,-29139.6 18808.08,-29109.73 18957.48,-29091.89"/>
<polygon fill="black" stroke="black" points="18958.1,-29095.34 18967.62,-29090.68 18957.27,-29088.39 18958.1,-29095.34"/>
</g>
<!-- m16_expert1&#45;&gt;m16_agg -->
<g id="edge234" class="edge">
<title>m16_expert1&#45;&gt;m16_agg</title>
<path fill="none" stroke="black" d="M18875.01,-29151.7C18907.3,-29140.15 18943.5,-29127.2 18976.62,-29115.35"/>
<polygon fill="black" stroke="black" points="18978.09,-29118.54 18986.33,-29111.88 18975.73,-29111.95 18978.09,-29118.54"/>
</g>
<!-- m16_expert2&#45;&gt;m16_agg -->
<g id="edge236" class="edge">
<title>m16_expert2&#45;&gt;m16_agg</title>
<path fill="none" stroke="black" d="M19293.53,-29151.7C19263.07,-29140.77 19229.11,-29128.58 19197.57,-29117.26"/>
<polygon fill="black" stroke="black" points="19198.47,-29113.86 19187.87,-29113.78 19196.1,-29120.45 19198.47,-29113.86"/>
</g>
<!-- m16_agg&#45;&gt;m16_final -->
<g id="edge237" class="edge">
<title>m16_agg&#45;&gt;m16_final</title>
<path fill="none" stroke="black" d="M19197.13,-29055.3C19303.17,-29037 19460.36,-29009.88 19560.9,-28992.53"/>
<polygon fill="black" stroke="black" points="19561.79,-28995.93 19571.05,-28990.78 19560.6,-28989.03 19561.79,-28995.93"/>
</g>
<!-- m17_res1 -->
<g id="node204" class="node">
<title>m17_res1</title>
<ellipse fill="lightpink" stroke="black" cx="19770.61" cy="-28885.11" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="19770.61" y="-28888.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="19770.61" y="-28873.91" font-family="Times,serif" font-size="14.00">GPU: 3729</text>
</g>
<!-- m16_final&#45;&gt;m17_res1 -->
<g id="edge243" class="edge">
<title>m16_final&#45;&gt;m17_res1</title>
<path fill="none" stroke="black" d="M19689.39,-28949.17C19702.6,-28938.92 19718.05,-28926.92 19731.9,-28916.16"/>
<polygon fill="black" stroke="black" points="19734.1,-28918.89 19739.85,-28909.99 19729.81,-28913.36 19734.1,-28918.89"/>
</g>
<!-- m17_ln1 -->
<g id="node200" class="node">
<title>m17_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="19884.61" cy="-29298.15" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="19884.61" y="-29301.95" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="19884.61" y="-29286.95" font-family="Times,serif" font-size="14.00">GPU: 3729</text>
</g>
<!-- m17_qkv -->
<g id="node201" class="node">
<title>m17_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="19884.61" cy="-29187.19" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="19884.61" y="-29190.99" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19884.61" y="-29175.99" font-family="Times,serif" font-size="14.00">GPU: 3729</text>
</g>
<!-- m17_ln1&#45;&gt;m17_qkv -->
<g id="edge239" class="edge">
<title>m17_ln1&#45;&gt;m17_qkv</title>
<path fill="none" stroke="black" d="M19884.61,-29271.05C19884.61,-29257.03 19884.61,-29239.54 19884.61,-29224.25"/>
<polygon fill="black" stroke="black" points="19888.11,-29224.08 19884.61,-29214.08 19881.11,-29224.08 19888.11,-29224.08"/>
</g>
<!-- m17_mha -->
<g id="node202" class="node">
<title>m17_mha</title>
<ellipse fill="lightblue" stroke="black" cx="19884.61" cy="-29075.72" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="19884.61" y="-29079.52" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="19884.61" y="-29064.52" font-family="Times,serif" font-size="14.00">GPU: 3729</text>
</g>
<!-- m17_qkv&#45;&gt;m17_mha -->
<g id="edge240" class="edge">
<title>m17_qkv&#45;&gt;m17_mha</title>
<path fill="none" stroke="black" d="M19884.61,-29160.25C19884.61,-29146.17 19884.61,-29128.54 19884.61,-29113.11"/>
<polygon fill="black" stroke="black" points="19888.11,-29112.85 19884.61,-29102.85 19881.11,-29112.85 19888.11,-29112.85"/>
</g>
<!-- m17_out -->
<g id="node203" class="node">
<title>m17_out</title>
<ellipse fill="lightblue" stroke="black" cx="19884.61" cy="-28974.85" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="19884.61" y="-28978.65" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="19884.61" y="-28963.65" font-family="Times,serif" font-size="14.00">GPU: 3729</text>
</g>
<!-- m17_mha&#45;&gt;m17_out -->
<g id="edge241" class="edge">
<title>m17_mha&#45;&gt;m17_out</title>
<path fill="none" stroke="black" d="M19884.61,-29048.74C19884.61,-29037.59 19884.61,-29024.36 19884.61,-29012.26"/>
<polygon fill="black" stroke="black" points="19888.11,-29011.99 19884.61,-29001.99 19881.11,-29011.99 19888.11,-29011.99"/>
</g>
<!-- m17_out&#45;&gt;m17_res1 -->
<g id="edge242" class="edge">
<title>m17_out&#45;&gt;m17_res1</title>
<path fill="none" stroke="black" d="M19852.55,-28949.17C19839.23,-28938.92 19823.64,-28926.92 19809.66,-28916.16"/>
<polygon fill="black" stroke="black" points="19811.7,-28913.31 19801.64,-28909.99 19807.43,-28918.86 19811.7,-28913.31"/>
</g>
<!-- m17_gate -->
<g id="node205" class="node">
<title>m17_gate</title>
<polygon fill="orange" stroke="black" points="19742.23,-28822.24 19537.63,-28822.24 19485,-28716.24 19689.59,-28716.24 19742.23,-28822.24"/>
<text text-anchor="middle" x="19613.61" y="-28780.54" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="19613.61" y="-28765.54" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="19613.61" y="-28750.54" font-family="Times,serif" font-size="14.00">GPU: 3729</text>
</g>
<!-- m17_res1&#45;&gt;m17_gate -->
<g id="edge244" class="edge">
<title>m17_res1&#45;&gt;m17_gate</title>
<path fill="none" stroke="black" d="M19738.08,-28860.51C19725.08,-28851.08 19709.48,-28839.77 19693.79,-28828.39"/>
<polygon fill="black" stroke="black" points="19695.74,-28825.48 19685.59,-28822.44 19691.63,-28831.14 19695.74,-28825.48"/>
</g>
<!-- m17_route -->
<g id="node206" class="node">
<title>m17_route</title>
<ellipse fill="lightgray" stroke="black" cx="19613.61" cy="-28642.76" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="19613.61" y="-28654.06" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="19613.61" y="-28639.06" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="19613.61" y="-28624.06" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m17_res1&#45;&gt;m17_route -->
<g id="edge246" class="edge">
<title>m17_res1&#45;&gt;m17_route</title>
<path fill="none" stroke="black" d="M19774.67,-28858.25C19778.79,-28822.93 19780.92,-28759.08 19751.61,-28716.24 19738.5,-28697.07 19718.68,-28682.61 19698.11,-28671.86"/>
<polygon fill="black" stroke="black" points="19699.47,-28668.62 19688.95,-28667.32 19696.36,-28674.89 19699.47,-28668.62"/>
</g>
<!-- m17_final -->
<g id="node211" class="node">
<title>m17_final</title>
<ellipse fill="lightpink" stroke="black" cx="20186.61" cy="-28319.46" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="20186.61" y="-28323.26" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="20186.61" y="-28308.26" font-family="Times,serif" font-size="14.00">GPU: 3729</text>
</g>
<!-- m17_res1&#45;&gt;m17_final -->
<g id="edge254" class="edge">
<title>m17_res1&#45;&gt;m17_final</title>
<path fill="none" stroke="black" d="M19846.71,-28879.43C19980.21,-28866.68 20242.61,-28819.28 20242.61,-28643.76 20242.61,-28643.76 20242.61,-28643.76 20242.61,-28530.81 20242.61,-28467.48 20218.62,-28396.93 20202.04,-28355.75"/>
<polygon fill="black" stroke="black" points="20205.25,-28354.35 20198.22,-28346.43 20198.78,-28357.01 20205.25,-28354.35"/>
</g>
<!-- m17_gate&#45;&gt;m17_route -->
<g id="edge245" class="edge">
<title>m17_gate&#45;&gt;m17_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19613.61,-28716.17C19613.61,-28707.74 19613.61,-28699.05 19613.61,-28690.75"/>
<polygon fill="black" stroke="black" points="19617.11,-28690.49 19613.61,-28680.49 19610.11,-28690.49 19617.11,-28690.49"/>
</g>
<!-- m17_expert0 -->
<g id="node207" class="node">
<title>m17_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="18696.61" cy="-28531.81" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="18696.61" y="-28543.11" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="18696.61" y="-28528.11" font-family="Times,serif" font-size="14.00">Node 112 GPU 0</text>
<text text-anchor="middle" x="18696.61" y="-28513.11" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m17_route&#45;&gt;m17_expert0 -->
<g id="edge247" class="edge">
<title>m17_route&#45;&gt;m17_expert0</title>
<path fill="none" stroke="black" d="M19519.15,-28630.57C19399.09,-28616.35 19185.46,-28591.02 19002.61,-28569.28 18975.41,-28566.05 18946.84,-28562.65 18918.54,-28559.28"/>
<polygon fill="black" stroke="black" points="18918.89,-28555.79 18908.55,-28558.09 18918.06,-28562.74 18918.89,-28555.79"/>
</g>
<!-- m17_expert1 -->
<g id="node208" class="node">
<title>m17_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="19307.61" cy="-28531.81" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="19307.61" y="-28543.11" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="19307.61" y="-28528.11" font-family="Times,serif" font-size="14.00">Node 112 GPU 1</text>
<text text-anchor="middle" x="19307.61" y="-28513.11" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m17_route&#45;&gt;m17_expert1 -->
<g id="edge249" class="edge">
<title>m17_route&#45;&gt;m17_expert1</title>
<path fill="none" stroke="black" d="M19542.26,-28616.35C19504.08,-28602.76 19456.32,-28585.75 19413.87,-28570.64"/>
<polygon fill="black" stroke="black" points="19414.93,-28567.3 19404.33,-28567.24 19412.58,-28573.9 19414.93,-28567.3"/>
</g>
<!-- m17_expert2 -->
<g id="node209" class="node">
<title>m17_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="19918.61" cy="-28531.81" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="19918.61" y="-28543.11" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="19918.61" y="-28528.11" font-family="Times,serif" font-size="14.00">Node 112 GPU 2</text>
<text text-anchor="middle" x="19918.61" y="-28513.11" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m17_route&#45;&gt;m17_expert2 -->
<g id="edge251" class="edge">
<title>m17_route&#45;&gt;m17_expert2</title>
<path fill="none" stroke="black" d="M19684.74,-28616.35C19722.78,-28602.76 19770.39,-28585.75 19812.7,-28570.64"/>
<polygon fill="black" stroke="black" points="19813.97,-28573.9 19822.21,-28567.24 19811.61,-28567.31 19813.97,-28573.9"/>
</g>
<!-- m17_agg -->
<g id="node210" class="node">
<title>m17_agg</title>
<polygon fill="purple" stroke="black" points="19777.23,-28458.33 19516.95,-28458.33 19450,-28382.33 19710.27,-28382.33 19777.23,-28458.33"/>
<text text-anchor="middle" x="19613.61" y="-28424.13" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="19613.61" y="-28409.13" font-family="Times,serif" font-size="14.00">GPU: 3729</text>
</g>
<!-- m17_expert0&#45;&gt;m17_agg -->
<g id="edge248" class="edge">
<title>m17_expert0&#45;&gt;m17_agg</title>
<path fill="none" stroke="black" d="M18908.14,-28505.55C19086.91,-28484.21 19337.08,-28454.34 19486.48,-28436.51"/>
<polygon fill="black" stroke="black" points="19487.1,-28439.96 19496.62,-28435.3 19486.27,-28433.01 19487.1,-28439.96"/>
</g>
<!-- m17_expert1&#45;&gt;m17_agg -->
<g id="edge250" class="edge">
<title>m17_expert1&#45;&gt;m17_agg</title>
<path fill="none" stroke="black" d="M19404.01,-28496.32C19436.3,-28484.77 19472.5,-28471.81 19505.62,-28459.97"/>
<polygon fill="black" stroke="black" points="19507.09,-28463.16 19515.33,-28456.49 19504.73,-28456.57 19507.09,-28463.16"/>
</g>
<!-- m17_expert2&#45;&gt;m17_agg -->
<g id="edge252" class="edge">
<title>m17_expert2&#45;&gt;m17_agg</title>
<path fill="none" stroke="black" d="M19822.53,-28496.32C19792.07,-28485.38 19758.11,-28473.19 19726.57,-28461.87"/>
<polygon fill="black" stroke="black" points="19727.47,-28458.48 19716.87,-28458.39 19725.1,-28465.07 19727.47,-28458.48"/>
</g>
<!-- m17_agg&#45;&gt;m17_final -->
<g id="edge253" class="edge">
<title>m17_agg&#45;&gt;m17_final</title>
<path fill="none" stroke="black" d="M19726.13,-28399.91C19832.17,-28381.62 19989.36,-28354.49 20089.9,-28337.15"/>
<polygon fill="black" stroke="black" points="20090.79,-28340.54 20100.05,-28335.39 20089.6,-28333.65 20090.79,-28340.54"/>
</g>
<!-- m18_res1 -->
<g id="node216" class="node">
<title>m18_res1</title>
<ellipse fill="lightpink" stroke="black" cx="20299.61" cy="-28229.72" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="20299.61" y="-28233.52" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20299.61" y="-28218.52" font-family="Times,serif" font-size="14.00">GPU: 3730</text>
</g>
<!-- m17_final&#45;&gt;m18_res1 -->
<g id="edge259" class="edge">
<title>m17_final&#45;&gt;m18_res1</title>
<path fill="none" stroke="black" d="M20218.39,-28293.78C20231.6,-28283.53 20247.05,-28271.53 20260.9,-28260.77"/>
<polygon fill="black" stroke="black" points="20263.1,-28263.5 20268.85,-28254.6 20258.81,-28257.97 20263.1,-28263.5"/>
</g>
<!-- m18_ln1 -->
<g id="node212" class="node">
<title>m18_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="20413.61" cy="-28642.76" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="20413.61" y="-28646.56" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20413.61" y="-28631.56" font-family="Times,serif" font-size="14.00">GPU: 3730</text>
</g>
<!-- m18_qkv -->
<g id="node213" class="node">
<title>m18_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="20413.61" cy="-28531.81" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="20413.61" y="-28535.61" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20413.61" y="-28520.61" font-family="Times,serif" font-size="14.00">GPU: 3730</text>
</g>
<!-- m18_ln1&#45;&gt;m18_qkv -->
<g id="edge255" class="edge">
<title>m18_ln1&#45;&gt;m18_qkv</title>
<path fill="none" stroke="black" d="M20413.61,-28615.66C20413.61,-28601.65 20413.61,-28584.15 20413.61,-28568.86"/>
<polygon fill="black" stroke="black" points="20417.11,-28568.69 20413.61,-28558.69 20410.11,-28568.69 20417.11,-28568.69"/>
</g>
<!-- m18_mha -->
<g id="node214" class="node">
<title>m18_mha</title>
<ellipse fill="lightblue" stroke="black" cx="20413.61" cy="-28420.33" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="20413.61" y="-28424.13" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="20413.61" y="-28409.13" font-family="Times,serif" font-size="14.00">GPU: 3730</text>
</g>
<!-- m18_qkv&#45;&gt;m18_mha -->
<g id="edge256" class="edge">
<title>m18_qkv&#45;&gt;m18_mha</title>
<path fill="none" stroke="black" d="M20413.61,-28504.86C20413.61,-28490.78 20413.61,-28473.16 20413.61,-28457.73"/>
<polygon fill="black" stroke="black" points="20417.11,-28457.47 20413.61,-28447.47 20410.11,-28457.47 20417.11,-28457.47"/>
</g>
<!-- m18_out -->
<g id="node215" class="node">
<title>m18_out</title>
<ellipse fill="lightblue" stroke="black" cx="20413.61" cy="-28319.46" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="20413.61" y="-28323.26" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="20413.61" y="-28308.26" font-family="Times,serif" font-size="14.00">GPU: 3730</text>
</g>
<!-- m18_mha&#45;&gt;m18_out -->
<g id="edge257" class="edge">
<title>m18_mha&#45;&gt;m18_out</title>
<path fill="none" stroke="black" d="M20413.61,-28393.35C20413.61,-28382.2 20413.61,-28368.98 20413.61,-28356.87"/>
<polygon fill="black" stroke="black" points="20417.11,-28356.61 20413.61,-28346.61 20410.11,-28356.61 20417.11,-28356.61"/>
</g>
<!-- m18_out&#45;&gt;m18_res1 -->
<g id="edge258" class="edge">
<title>m18_out&#45;&gt;m18_res1</title>
<path fill="none" stroke="black" d="M20381.55,-28293.78C20368.23,-28283.53 20352.64,-28271.53 20338.66,-28260.77"/>
<polygon fill="black" stroke="black" points="20340.7,-28257.93 20330.64,-28254.6 20336.43,-28263.48 20340.7,-28257.93"/>
</g>
<!-- m18_gate -->
<g id="node217" class="node">
<title>m18_gate</title>
<polygon fill="orange" stroke="black" points="20271.23,-28166.85 20066.63,-28166.85 20014,-28060.85 20218.59,-28060.85 20271.23,-28166.85"/>
<text text-anchor="middle" x="20142.61" y="-28125.15" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="20142.61" y="-28110.15" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="20142.61" y="-28095.15" font-family="Times,serif" font-size="14.00">GPU: 3730</text>
</g>
<!-- m18_res1&#45;&gt;m18_gate -->
<g id="edge260" class="edge">
<title>m18_res1&#45;&gt;m18_gate</title>
<path fill="none" stroke="black" d="M20267.08,-28205.12C20254.08,-28195.69 20238.48,-28184.38 20222.79,-28173"/>
<polygon fill="black" stroke="black" points="20224.74,-28170.09 20214.59,-28167.05 20220.63,-28175.76 20224.74,-28170.09"/>
</g>
<!-- m18_route -->
<g id="node218" class="node">
<title>m18_route</title>
<ellipse fill="lightgray" stroke="black" cx="20142.61" cy="-27987.37" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="20142.61" y="-27998.67" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="20142.61" y="-27983.67" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="20142.61" y="-27968.67" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m18_res1&#45;&gt;m18_route -->
<g id="edge262" class="edge">
<title>m18_res1&#45;&gt;m18_route</title>
<path fill="none" stroke="black" d="M20303.67,-28202.87C20307.79,-28167.54 20309.92,-28103.7 20280.61,-28060.85 20267.5,-28041.68 20247.68,-28027.22 20227.11,-28016.47"/>
<polygon fill="black" stroke="black" points="20228.47,-28013.23 20217.95,-28011.93 20225.36,-28019.51 20228.47,-28013.23"/>
</g>
<!-- m18_final -->
<g id="node223" class="node">
<title>m18_final</title>
<ellipse fill="lightpink" stroke="black" cx="20715.61" cy="-27664.07" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="20715.61" y="-27667.87" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="20715.61" y="-27652.87" font-family="Times,serif" font-size="14.00">GPU: 3730</text>
</g>
<!-- m18_res1&#45;&gt;m18_final -->
<g id="edge270" class="edge">
<title>m18_res1&#45;&gt;m18_final</title>
<path fill="none" stroke="black" d="M20375.71,-28224.05C20509.21,-28211.29 20771.61,-28163.89 20771.61,-27988.37 20771.61,-27988.37 20771.61,-27988.37 20771.61,-27875.42 20771.61,-27812.09 20747.62,-27741.55 20731.04,-27700.36"/>
<polygon fill="black" stroke="black" points="20734.25,-27698.96 20727.22,-27691.04 20727.78,-27701.62 20734.25,-27698.96"/>
</g>
<!-- m18_gate&#45;&gt;m18_route -->
<g id="edge261" class="edge">
<title>m18_gate&#45;&gt;m18_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20142.61,-28060.78C20142.61,-28052.35 20142.61,-28043.66 20142.61,-28035.36"/>
<polygon fill="black" stroke="black" points="20146.11,-28035.1 20142.61,-28025.1 20139.11,-28035.1 20146.11,-28035.1"/>
</g>
<!-- m18_expert0 -->
<g id="node219" class="node">
<title>m18_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="19225.61" cy="-27876.42" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="19225.61" y="-27887.72" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="19225.61" y="-27872.72" font-family="Times,serif" font-size="14.00">Node 120 GPU 0</text>
<text text-anchor="middle" x="19225.61" y="-27857.72" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m18_route&#45;&gt;m18_expert0 -->
<g id="edge263" class="edge">
<title>m18_route&#45;&gt;m18_expert0</title>
<path fill="none" stroke="black" d="M20048.15,-27975.18C19928.09,-27960.96 19714.46,-27935.64 19531.61,-27913.9 19504.41,-27910.66 19475.84,-27907.26 19447.54,-27903.89"/>
<polygon fill="black" stroke="black" points="19447.89,-27900.41 19437.55,-27902.7 19447.06,-27907.36 19447.89,-27900.41"/>
</g>
<!-- m18_expert1 -->
<g id="node220" class="node">
<title>m18_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="19836.61" cy="-27876.42" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="19836.61" y="-27887.72" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="19836.61" y="-27872.72" font-family="Times,serif" font-size="14.00">Node 120 GPU 1</text>
<text text-anchor="middle" x="19836.61" y="-27857.72" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m18_route&#45;&gt;m18_expert1 -->
<g id="edge265" class="edge">
<title>m18_route&#45;&gt;m18_expert1</title>
<path fill="none" stroke="black" d="M20071.26,-27960.96C20033.08,-27947.37 19985.32,-27930.37 19942.87,-27915.25"/>
<polygon fill="black" stroke="black" points="19943.93,-27911.91 19933.33,-27911.86 19941.58,-27918.51 19943.93,-27911.91"/>
</g>
<!-- m18_expert2 -->
<g id="node221" class="node">
<title>m18_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="20447.61" cy="-27876.42" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="20447.61" y="-27887.72" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="20447.61" y="-27872.72" font-family="Times,serif" font-size="14.00">Node 120 GPU 2</text>
<text text-anchor="middle" x="20447.61" y="-27857.72" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m18_route&#45;&gt;m18_expert2 -->
<g id="edge267" class="edge">
<title>m18_route&#45;&gt;m18_expert2</title>
<path fill="none" stroke="black" d="M20213.74,-27960.96C20251.78,-27947.37 20299.39,-27930.37 20341.7,-27915.25"/>
<polygon fill="black" stroke="black" points="20342.97,-27918.52 20351.21,-27911.86 20340.61,-27911.93 20342.97,-27918.52"/>
</g>
<!-- m18_agg -->
<g id="node222" class="node">
<title>m18_agg</title>
<polygon fill="purple" stroke="black" points="20306.23,-27802.94 20045.95,-27802.94 19979,-27726.94 20239.27,-27726.94 20306.23,-27802.94"/>
<text text-anchor="middle" x="20142.61" y="-27768.74" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="20142.61" y="-27753.74" font-family="Times,serif" font-size="14.00">GPU: 3730</text>
</g>
<!-- m18_expert0&#45;&gt;m18_agg -->
<g id="edge264" class="edge">
<title>m18_expert0&#45;&gt;m18_agg</title>
<path fill="none" stroke="black" d="M19437.14,-27850.16C19615.91,-27828.82 19866.08,-27798.96 20015.48,-27781.12"/>
<polygon fill="black" stroke="black" points="20016.1,-27784.57 20025.62,-27779.91 20015.27,-27777.62 20016.1,-27784.57"/>
</g>
<!-- m18_expert1&#45;&gt;m18_agg -->
<g id="edge266" class="edge">
<title>m18_expert1&#45;&gt;m18_agg</title>
<path fill="none" stroke="black" d="M19933.01,-27840.93C19965.3,-27829.38 20001.5,-27816.43 20034.62,-27804.58"/>
<polygon fill="black" stroke="black" points="20036.09,-27807.77 20044.33,-27801.11 20033.73,-27801.18 20036.09,-27807.77"/>
</g>
<!-- m18_expert2&#45;&gt;m18_agg -->
<g id="edge268" class="edge">
<title>m18_expert2&#45;&gt;m18_agg</title>
<path fill="none" stroke="black" d="M20351.53,-27840.93C20321.07,-27830 20287.11,-27817.81 20255.57,-27806.49"/>
<polygon fill="black" stroke="black" points="20256.47,-27803.09 20245.87,-27803.01 20254.1,-27809.68 20256.47,-27803.09"/>
</g>
<!-- m18_agg&#45;&gt;m18_final -->
<g id="edge269" class="edge">
<title>m18_agg&#45;&gt;m18_final</title>
<path fill="none" stroke="black" d="M20255.13,-27744.53C20361.17,-27726.23 20518.36,-27699.11 20618.9,-27681.76"/>
<polygon fill="black" stroke="black" points="20619.79,-27685.16 20629.05,-27680.01 20618.6,-27678.26 20619.79,-27685.16"/>
</g>
<!-- m19_res1 -->
<g id="node228" class="node">
<title>m19_res1</title>
<ellipse fill="lightpink" stroke="black" cx="20828.61" cy="-27574.33" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="20828.61" y="-27578.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="20828.61" y="-27563.13" font-family="Times,serif" font-size="14.00">GPU: 3731</text>
</g>
<!-- m18_final&#45;&gt;m19_res1 -->
<g id="edge275" class="edge">
<title>m18_final&#45;&gt;m19_res1</title>
<path fill="none" stroke="black" d="M20747.39,-27638.4C20760.6,-27628.14 20776.05,-27616.15 20789.9,-27605.39"/>
<polygon fill="black" stroke="black" points="20792.1,-27608.11 20797.85,-27599.22 20787.81,-27602.58 20792.1,-27608.11"/>
</g>
<!-- m19_ln1 -->
<g id="node224" class="node">
<title>m19_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="20942.61" cy="-27987.37" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="20942.61" y="-27991.17" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="20942.61" y="-27976.17" font-family="Times,serif" font-size="14.00">GPU: 3731</text>
</g>
<!-- m19_qkv -->
<g id="node225" class="node">
<title>m19_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="20942.61" cy="-27876.42" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="20942.61" y="-27880.22" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="20942.61" y="-27865.22" font-family="Times,serif" font-size="14.00">GPU: 3731</text>
</g>
<!-- m19_ln1&#45;&gt;m19_qkv -->
<g id="edge271" class="edge">
<title>m19_ln1&#45;&gt;m19_qkv</title>
<path fill="none" stroke="black" d="M20942.61,-27960.27C20942.61,-27946.26 20942.61,-27928.77 20942.61,-27913.47"/>
<polygon fill="black" stroke="black" points="20946.11,-27913.3 20942.61,-27903.3 20939.11,-27913.3 20946.11,-27913.3"/>
</g>
<!-- m19_mha -->
<g id="node226" class="node">
<title>m19_mha</title>
<ellipse fill="lightblue" stroke="black" cx="20942.61" cy="-27764.94" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="20942.61" y="-27768.74" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="20942.61" y="-27753.74" font-family="Times,serif" font-size="14.00">GPU: 3731</text>
</g>
<!-- m19_qkv&#45;&gt;m19_mha -->
<g id="edge272" class="edge">
<title>m19_qkv&#45;&gt;m19_mha</title>
<path fill="none" stroke="black" d="M20942.61,-27849.47C20942.61,-27835.4 20942.61,-27817.77 20942.61,-27802.34"/>
<polygon fill="black" stroke="black" points="20946.11,-27802.08 20942.61,-27792.08 20939.11,-27802.08 20946.11,-27802.08"/>
</g>
<!-- m19_out -->
<g id="node227" class="node">
<title>m19_out</title>
<ellipse fill="lightblue" stroke="black" cx="20942.61" cy="-27664.07" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="20942.61" y="-27667.87" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="20942.61" y="-27652.87" font-family="Times,serif" font-size="14.00">GPU: 3731</text>
</g>
<!-- m19_mha&#45;&gt;m19_out -->
<g id="edge273" class="edge">
<title>m19_mha&#45;&gt;m19_out</title>
<path fill="none" stroke="black" d="M20942.61,-27737.96C20942.61,-27726.81 20942.61,-27713.59 20942.61,-27701.49"/>
<polygon fill="black" stroke="black" points="20946.11,-27701.22 20942.61,-27691.22 20939.11,-27701.22 20946.11,-27701.22"/>
</g>
<!-- m19_out&#45;&gt;m19_res1 -->
<g id="edge274" class="edge">
<title>m19_out&#45;&gt;m19_res1</title>
<path fill="none" stroke="black" d="M20910.55,-27638.4C20897.23,-27628.14 20881.64,-27616.15 20867.66,-27605.39"/>
<polygon fill="black" stroke="black" points="20869.7,-27602.54 20859.64,-27599.22 20865.43,-27608.09 20869.7,-27602.54"/>
</g>
<!-- m19_gate -->
<g id="node229" class="node">
<title>m19_gate</title>
<polygon fill="orange" stroke="black" points="20800.23,-27511.46 20595.63,-27511.46 20543,-27405.46 20747.59,-27405.46 20800.23,-27511.46"/>
<text text-anchor="middle" x="20671.61" y="-27469.76" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="20671.61" y="-27454.76" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="20671.61" y="-27439.76" font-family="Times,serif" font-size="14.00">GPU: 3731</text>
</g>
<!-- m19_res1&#45;&gt;m19_gate -->
<g id="edge276" class="edge">
<title>m19_res1&#45;&gt;m19_gate</title>
<path fill="none" stroke="black" d="M20796.08,-27549.74C20783.08,-27540.31 20767.48,-27528.99 20751.79,-27517.61"/>
<polygon fill="black" stroke="black" points="20753.74,-27514.7 20743.59,-27511.67 20749.63,-27520.37 20753.74,-27514.7"/>
</g>
<!-- m19_route -->
<g id="node230" class="node">
<title>m19_route</title>
<ellipse fill="lightgray" stroke="black" cx="20671.61" cy="-27331.99" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="20671.61" y="-27343.29" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="20671.61" y="-27328.29" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="20671.61" y="-27313.29" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m19_res1&#45;&gt;m19_route -->
<g id="edge278" class="edge">
<title>m19_res1&#45;&gt;m19_route</title>
<path fill="none" stroke="black" d="M20832.67,-27547.48C20836.79,-27512.16 20838.92,-27448.31 20809.61,-27405.46 20796.5,-27386.3 20776.68,-27371.84 20756.11,-27361.08"/>
<polygon fill="black" stroke="black" points="20757.47,-27357.85 20746.95,-27356.55 20754.36,-27364.12 20757.47,-27357.85"/>
</g>
<!-- m19_final -->
<g id="node235" class="node">
<title>m19_final</title>
<ellipse fill="lightpink" stroke="black" cx="21244.61" cy="-27008.68" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="21244.61" y="-27012.48" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="21244.61" y="-26997.48" font-family="Times,serif" font-size="14.00">GPU: 3731</text>
</g>
<!-- m19_res1&#45;&gt;m19_final -->
<g id="edge286" class="edge">
<title>m19_res1&#45;&gt;m19_final</title>
<path fill="none" stroke="black" d="M20904.71,-27568.66C21038.21,-27555.9 21300.61,-27508.51 21300.61,-27332.99 21300.61,-27332.99 21300.61,-27332.99 21300.61,-27220.03 21300.61,-27156.71 21276.62,-27086.16 21260.04,-27044.98"/>
<polygon fill="black" stroke="black" points="21263.25,-27043.58 21256.22,-27035.66 21256.78,-27046.24 21263.25,-27043.58"/>
</g>
<!-- m19_gate&#45;&gt;m19_route -->
<g id="edge277" class="edge">
<title>m19_gate&#45;&gt;m19_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20671.61,-27405.39C20671.61,-27396.96 20671.61,-27388.27 20671.61,-27379.97"/>
<polygon fill="black" stroke="black" points="20675.11,-27379.71 20671.61,-27369.71 20668.11,-27379.71 20675.11,-27379.71"/>
</g>
<!-- m19_expert0 -->
<g id="node231" class="node">
<title>m19_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="19754.61" cy="-27221.03" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="19754.61" y="-27232.33" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="19754.61" y="-27217.33" font-family="Times,serif" font-size="14.00">Node 128 GPU 0</text>
<text text-anchor="middle" x="19754.61" y="-27202.33" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m19_route&#45;&gt;m19_expert0 -->
<g id="edge279" class="edge">
<title>m19_route&#45;&gt;m19_expert0</title>
<path fill="none" stroke="black" d="M20577.15,-27319.8C20457.09,-27305.57 20243.46,-27280.25 20060.61,-27258.51 20033.41,-27255.27 20004.84,-27251.87 19976.54,-27248.5"/>
<polygon fill="black" stroke="black" points="19976.89,-27245.02 19966.55,-27247.31 19976.06,-27251.97 19976.89,-27245.02"/>
</g>
<!-- m19_expert1 -->
<g id="node232" class="node">
<title>m19_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="20365.61" cy="-27221.03" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="20365.61" y="-27232.33" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="20365.61" y="-27217.33" font-family="Times,serif" font-size="14.00">Node 128 GPU 1</text>
<text text-anchor="middle" x="20365.61" y="-27202.33" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m19_route&#45;&gt;m19_expert1 -->
<g id="edge281" class="edge">
<title>m19_route&#45;&gt;m19_expert1</title>
<path fill="none" stroke="black" d="M20600.26,-27305.58C20562.08,-27291.99 20514.32,-27274.98 20471.87,-27259.87"/>
<polygon fill="black" stroke="black" points="20472.93,-27256.53 20462.33,-27256.47 20470.58,-27263.12 20472.93,-27256.53"/>
</g>
<!-- m19_expert2 -->
<g id="node233" class="node">
<title>m19_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="20976.61" cy="-27221.03" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="20976.61" y="-27232.33" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="20976.61" y="-27217.33" font-family="Times,serif" font-size="14.00">Node 128 GPU 2</text>
<text text-anchor="middle" x="20976.61" y="-27202.33" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m19_route&#45;&gt;m19_expert2 -->
<g id="edge283" class="edge">
<title>m19_route&#45;&gt;m19_expert2</title>
<path fill="none" stroke="black" d="M20742.74,-27305.58C20780.78,-27291.99 20828.39,-27274.98 20870.7,-27259.87"/>
<polygon fill="black" stroke="black" points="20871.97,-27263.13 20880.21,-27256.47 20869.61,-27256.54 20871.97,-27263.13"/>
</g>
<!-- m19_agg -->
<g id="node234" class="node">
<title>m19_agg</title>
<polygon fill="purple" stroke="black" points="20835.23,-27147.56 20574.95,-27147.56 20508,-27071.56 20768.27,-27071.56 20835.23,-27147.56"/>
<text text-anchor="middle" x="20671.61" y="-27113.36" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="20671.61" y="-27098.36" font-family="Times,serif" font-size="14.00">GPU: 3731</text>
</g>
<!-- m19_expert0&#45;&gt;m19_agg -->
<g id="edge280" class="edge">
<title>m19_expert0&#45;&gt;m19_agg</title>
<path fill="none" stroke="black" d="M19966.14,-27194.78C20144.91,-27173.44 20395.08,-27143.57 20544.48,-27125.73"/>
<polygon fill="black" stroke="black" points="20545.1,-27129.18 20554.62,-27124.52 20544.27,-27122.23 20545.1,-27129.18"/>
</g>
<!-- m19_expert1&#45;&gt;m19_agg -->
<g id="edge282" class="edge">
<title>m19_expert1&#45;&gt;m19_agg</title>
<path fill="none" stroke="black" d="M20462.01,-27185.54C20494.3,-27173.99 20530.5,-27161.04 20563.62,-27149.19"/>
<polygon fill="black" stroke="black" points="20565.09,-27152.38 20573.33,-27145.72 20562.73,-27145.79 20565.09,-27152.38"/>
</g>
<!-- m19_expert2&#45;&gt;m19_agg -->
<g id="edge284" class="edge">
<title>m19_expert2&#45;&gt;m19_agg</title>
<path fill="none" stroke="black" d="M20880.53,-27185.54C20850.07,-27174.61 20816.11,-27162.42 20784.57,-27151.1"/>
<polygon fill="black" stroke="black" points="20785.47,-27147.7 20774.87,-27147.62 20783.1,-27154.29 20785.47,-27147.7"/>
</g>
<!-- m19_agg&#45;&gt;m19_final -->
<g id="edge285" class="edge">
<title>m19_agg&#45;&gt;m19_final</title>
<path fill="none" stroke="black" d="M20784.13,-27089.14C20890.17,-27070.84 21047.36,-27043.72 21147.9,-27026.37"/>
<polygon fill="black" stroke="black" points="21148.79,-27029.77 21158.05,-27024.62 21147.6,-27022.87 21148.79,-27029.77"/>
</g>
<!-- m20_res1 -->
<g id="node240" class="node">
<title>m20_res1</title>
<ellipse fill="lightpink" stroke="black" cx="21357.61" cy="-26918.94" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="21357.61" y="-26922.74" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21357.61" y="-26907.74" font-family="Times,serif" font-size="14.00">GPU: 3732</text>
</g>
<!-- m19_final&#45;&gt;m20_res1 -->
<g id="edge291" class="edge">
<title>m19_final&#45;&gt;m20_res1</title>
<path fill="none" stroke="black" d="M21276.39,-26983.01C21289.6,-26972.76 21305.05,-26960.76 21318.9,-26950"/>
<polygon fill="black" stroke="black" points="21321.1,-26952.73 21326.85,-26943.83 21316.81,-26947.2 21321.1,-26952.73"/>
</g>
<!-- m20_ln1 -->
<g id="node236" class="node">
<title>m20_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="21471.61" cy="-27331.99" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="21471.61" y="-27335.79" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="21471.61" y="-27320.79" font-family="Times,serif" font-size="14.00">GPU: 3732</text>
</g>
<!-- m20_qkv -->
<g id="node237" class="node">
<title>m20_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="21471.61" cy="-27221.03" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="21471.61" y="-27224.83" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="21471.61" y="-27209.83" font-family="Times,serif" font-size="14.00">GPU: 3732</text>
</g>
<!-- m20_ln1&#45;&gt;m20_qkv -->
<g id="edge287" class="edge">
<title>m20_ln1&#45;&gt;m20_qkv</title>
<path fill="none" stroke="black" d="M21471.61,-27304.89C21471.61,-27290.87 21471.61,-27273.38 21471.61,-27258.08"/>
<polygon fill="black" stroke="black" points="21475.11,-27257.92 21471.61,-27247.92 21468.11,-27257.92 21475.11,-27257.92"/>
</g>
<!-- m20_mha -->
<g id="node238" class="node">
<title>m20_mha</title>
<ellipse fill="lightblue" stroke="black" cx="21471.61" cy="-27109.56" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="21471.61" y="-27113.36" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="21471.61" y="-27098.36" font-family="Times,serif" font-size="14.00">GPU: 3732</text>
</g>
<!-- m20_qkv&#45;&gt;m20_mha -->
<g id="edge288" class="edge">
<title>m20_qkv&#45;&gt;m20_mha</title>
<path fill="none" stroke="black" d="M21471.61,-27194.09C21471.61,-27180.01 21471.61,-27162.38 21471.61,-27146.95"/>
<polygon fill="black" stroke="black" points="21475.11,-27146.69 21471.61,-27136.69 21468.11,-27146.69 21475.11,-27146.69"/>
</g>
<!-- m20_out -->
<g id="node239" class="node">
<title>m20_out</title>
<ellipse fill="lightblue" stroke="black" cx="21471.61" cy="-27008.68" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="21471.61" y="-27012.48" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="21471.61" y="-26997.48" font-family="Times,serif" font-size="14.00">GPU: 3732</text>
</g>
<!-- m20_mha&#45;&gt;m20_out -->
<g id="edge289" class="edge">
<title>m20_mha&#45;&gt;m20_out</title>
<path fill="none" stroke="black" d="M21471.61,-27082.58C21471.61,-27071.43 21471.61,-27058.2 21471.61,-27046.1"/>
<polygon fill="black" stroke="black" points="21475.11,-27045.83 21471.61,-27035.83 21468.11,-27045.83 21475.11,-27045.83"/>
</g>
<!-- m20_out&#45;&gt;m20_res1 -->
<g id="edge290" class="edge">
<title>m20_out&#45;&gt;m20_res1</title>
<path fill="none" stroke="black" d="M21439.55,-26983.01C21426.23,-26972.76 21410.64,-26960.76 21396.66,-26950"/>
<polygon fill="black" stroke="black" points="21398.7,-26947.15 21388.64,-26943.83 21394.43,-26952.7 21398.7,-26947.15"/>
</g>
<!-- m20_gate -->
<g id="node241" class="node">
<title>m20_gate</title>
<polygon fill="orange" stroke="black" points="21329.23,-26856.07 21124.63,-26856.07 21072,-26750.07 21276.59,-26750.07 21329.23,-26856.07"/>
<text text-anchor="middle" x="21200.61" y="-26814.37" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="21200.61" y="-26799.37" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="21200.61" y="-26784.37" font-family="Times,serif" font-size="14.00">GPU: 3732</text>
</g>
<!-- m20_res1&#45;&gt;m20_gate -->
<g id="edge292" class="edge">
<title>m20_res1&#45;&gt;m20_gate</title>
<path fill="none" stroke="black" d="M21325.08,-26894.35C21312.08,-26884.92 21296.48,-26873.61 21280.79,-26862.23"/>
<polygon fill="black" stroke="black" points="21282.74,-26859.32 21272.59,-26856.28 21278.63,-26864.98 21282.74,-26859.32"/>
</g>
<!-- m20_route -->
<g id="node242" class="node">
<title>m20_route</title>
<ellipse fill="lightgray" stroke="black" cx="21200.61" cy="-26676.6" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="21200.61" y="-26687.9" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="21200.61" y="-26672.9" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="21200.61" y="-26657.9" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m20_res1&#45;&gt;m20_route -->
<g id="edge294" class="edge">
<title>m20_res1&#45;&gt;m20_route</title>
<path fill="none" stroke="black" d="M21361.67,-26892.09C21365.79,-26856.77 21367.92,-26792.92 21338.61,-26750.07 21325.5,-26730.91 21305.68,-26716.45 21285.11,-26705.69"/>
<polygon fill="black" stroke="black" points="21286.47,-26702.46 21275.95,-26701.16 21283.36,-26708.73 21286.47,-26702.46"/>
</g>
<!-- m20_final -->
<g id="node247" class="node">
<title>m20_final</title>
<ellipse fill="lightpink" stroke="black" cx="21773.61" cy="-26353.3" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="21773.61" y="-26357.1" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="21773.61" y="-26342.1" font-family="Times,serif" font-size="14.00">GPU: 3732</text>
</g>
<!-- m20_res1&#45;&gt;m20_final -->
<g id="edge302" class="edge">
<title>m20_res1&#45;&gt;m20_final</title>
<path fill="none" stroke="black" d="M21433.71,-26913.27C21567.21,-26900.52 21829.61,-26853.12 21829.61,-26677.6 21829.61,-26677.6 21829.61,-26677.6 21829.61,-26564.64 21829.61,-26501.32 21805.62,-26430.77 21789.04,-26389.59"/>
<polygon fill="black" stroke="black" points="21792.25,-26388.19 21785.22,-26380.27 21785.78,-26390.85 21792.25,-26388.19"/>
</g>
<!-- m20_gate&#45;&gt;m20_route -->
<g id="edge293" class="edge">
<title>m20_gate&#45;&gt;m20_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21200.61,-26750.01C21200.61,-26741.58 21200.61,-26732.89 21200.61,-26724.59"/>
<polygon fill="black" stroke="black" points="21204.11,-26724.32 21200.61,-26714.32 21197.11,-26724.32 21204.11,-26724.32"/>
</g>
<!-- m20_expert0 -->
<g id="node243" class="node">
<title>m20_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="20283.61" cy="-26565.64" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="20283.61" y="-26576.94" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20283.61" y="-26561.94" font-family="Times,serif" font-size="14.00">Node 136 GPU 0</text>
<text text-anchor="middle" x="20283.61" y="-26546.94" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m20_route&#45;&gt;m20_expert0 -->
<g id="edge295" class="edge">
<title>m20_route&#45;&gt;m20_expert0</title>
<path fill="none" stroke="black" d="M21106.15,-26664.41C20986.09,-26650.19 20772.46,-26624.86 20589.61,-26603.12 20562.41,-26599.89 20533.84,-26596.49 20505.54,-26593.12"/>
<polygon fill="black" stroke="black" points="20505.89,-26589.63 20495.55,-26591.92 20505.06,-26596.58 20505.89,-26589.63"/>
</g>
<!-- m20_expert1 -->
<g id="node244" class="node">
<title>m20_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="20894.61" cy="-26565.64" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="20894.61" y="-26576.94" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="20894.61" y="-26561.94" font-family="Times,serif" font-size="14.00">Node 136 GPU 1</text>
<text text-anchor="middle" x="20894.61" y="-26546.94" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m20_route&#45;&gt;m20_expert1 -->
<g id="edge297" class="edge">
<title>m20_route&#45;&gt;m20_expert1</title>
<path fill="none" stroke="black" d="M21129.26,-26650.19C21091.08,-26636.6 21043.32,-26619.59 21000.87,-26604.48"/>
<polygon fill="black" stroke="black" points="21001.93,-26601.14 20991.33,-26601.08 20999.58,-26607.74 21001.93,-26601.14"/>
</g>
<!-- m20_expert2 -->
<g id="node245" class="node">
<title>m20_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="21505.61" cy="-26565.64" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="21505.61" y="-26576.94" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="21505.61" y="-26561.94" font-family="Times,serif" font-size="14.00">Node 136 GPU 2</text>
<text text-anchor="middle" x="21505.61" y="-26546.94" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m20_route&#45;&gt;m20_expert2 -->
<g id="edge299" class="edge">
<title>m20_route&#45;&gt;m20_expert2</title>
<path fill="none" stroke="black" d="M21271.74,-26650.19C21309.78,-26636.6 21357.39,-26619.59 21399.7,-26604.48"/>
<polygon fill="black" stroke="black" points="21400.97,-26607.74 21409.21,-26601.08 21398.61,-26601.15 21400.97,-26607.74"/>
</g>
<!-- m20_agg -->
<g id="node246" class="node">
<title>m20_agg</title>
<polygon fill="purple" stroke="black" points="21364.23,-26492.17 21103.95,-26492.17 21037,-26416.17 21297.27,-26416.17 21364.23,-26492.17"/>
<text text-anchor="middle" x="21200.61" y="-26457.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="21200.61" y="-26442.97" font-family="Times,serif" font-size="14.00">GPU: 3732</text>
</g>
<!-- m20_expert0&#45;&gt;m20_agg -->
<g id="edge296" class="edge">
<title>m20_expert0&#45;&gt;m20_agg</title>
<path fill="none" stroke="black" d="M20495.14,-26539.39C20673.91,-26518.05 20924.08,-26488.18 21073.48,-26470.35"/>
<polygon fill="black" stroke="black" points="21074.1,-26473.8 21083.62,-26469.14 21073.27,-26466.85 21074.1,-26473.8"/>
</g>
<!-- m20_expert1&#45;&gt;m20_agg -->
<g id="edge298" class="edge">
<title>m20_expert1&#45;&gt;m20_agg</title>
<path fill="none" stroke="black" d="M20991.01,-26530.16C21023.3,-26518.6 21059.5,-26505.65 21092.62,-26493.81"/>
<polygon fill="black" stroke="black" points="21094.09,-26497 21102.33,-26490.33 21091.73,-26490.4 21094.09,-26497"/>
</g>
<!-- m20_expert2&#45;&gt;m20_agg -->
<g id="edge300" class="edge">
<title>m20_expert2&#45;&gt;m20_agg</title>
<path fill="none" stroke="black" d="M21409.53,-26530.16C21379.07,-26519.22 21345.11,-26507.03 21313.57,-26495.71"/>
<polygon fill="black" stroke="black" points="21314.47,-26492.32 21303.87,-26492.23 21312.1,-26498.9 21314.47,-26492.32"/>
</g>
<!-- m20_agg&#45;&gt;m20_final -->
<g id="edge301" class="edge">
<title>m20_agg&#45;&gt;m20_final</title>
<path fill="none" stroke="black" d="M21313.13,-26433.75C21419.17,-26415.46 21576.36,-26388.33 21676.9,-26370.99"/>
<polygon fill="black" stroke="black" points="21677.79,-26374.38 21687.05,-26369.23 21676.6,-26367.49 21677.79,-26374.38"/>
</g>
<!-- m21_res1 -->
<g id="node252" class="node">
<title>m21_res1</title>
<ellipse fill="lightpink" stroke="black" cx="21886.61" cy="-26263.56" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="21886.61" y="-26267.36" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="21886.61" y="-26252.36" font-family="Times,serif" font-size="14.00">GPU: 3733</text>
</g>
<!-- m20_final&#45;&gt;m21_res1 -->
<g id="edge307" class="edge">
<title>m20_final&#45;&gt;m21_res1</title>
<path fill="none" stroke="black" d="M21805.39,-26327.62C21818.6,-26317.37 21834.05,-26305.37 21847.9,-26294.61"/>
<polygon fill="black" stroke="black" points="21850.1,-26297.34 21855.85,-26288.44 21845.81,-26291.81 21850.1,-26297.34"/>
</g>
<!-- m21_ln1 -->
<g id="node248" class="node">
<title>m21_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="22000.61" cy="-26676.6" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="22000.61" y="-26680.4" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22000.61" y="-26665.4" font-family="Times,serif" font-size="14.00">GPU: 3733</text>
</g>
<!-- m21_qkv -->
<g id="node249" class="node">
<title>m21_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="22000.61" cy="-26565.64" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="22000.61" y="-26569.44" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="22000.61" y="-26554.44" font-family="Times,serif" font-size="14.00">GPU: 3733</text>
</g>
<!-- m21_ln1&#45;&gt;m21_qkv -->
<g id="edge303" class="edge">
<title>m21_ln1&#45;&gt;m21_qkv</title>
<path fill="none" stroke="black" d="M22000.61,-26649.5C22000.61,-26635.49 22000.61,-26617.99 22000.61,-26602.7"/>
<polygon fill="black" stroke="black" points="22004.11,-26602.53 22000.61,-26592.53 21997.11,-26602.53 22004.11,-26602.53"/>
</g>
<!-- m21_mha -->
<g id="node250" class="node">
<title>m21_mha</title>
<ellipse fill="lightblue" stroke="black" cx="22000.61" cy="-26454.17" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22000.61" y="-26457.97" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="22000.61" y="-26442.97" font-family="Times,serif" font-size="14.00">GPU: 3733</text>
</g>
<!-- m21_qkv&#45;&gt;m21_mha -->
<g id="edge304" class="edge">
<title>m21_qkv&#45;&gt;m21_mha</title>
<path fill="none" stroke="black" d="M22000.61,-26538.7C22000.61,-26524.62 22000.61,-26507 22000.61,-26491.57"/>
<polygon fill="black" stroke="black" points="22004.11,-26491.31 22000.61,-26481.31 21997.11,-26491.31 22004.11,-26491.31"/>
</g>
<!-- m21_out -->
<g id="node251" class="node">
<title>m21_out</title>
<ellipse fill="lightblue" stroke="black" cx="22000.61" cy="-26353.3" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="22000.61" y="-26357.1" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="22000.61" y="-26342.1" font-family="Times,serif" font-size="14.00">GPU: 3733</text>
</g>
<!-- m21_mha&#45;&gt;m21_out -->
<g id="edge305" class="edge">
<title>m21_mha&#45;&gt;m21_out</title>
<path fill="none" stroke="black" d="M22000.61,-26427.19C22000.61,-26416.04 22000.61,-26402.82 22000.61,-26390.71"/>
<polygon fill="black" stroke="black" points="22004.11,-26390.44 22000.61,-26380.44 21997.11,-26390.44 22004.11,-26390.44"/>
</g>
<!-- m21_out&#45;&gt;m21_res1 -->
<g id="edge306" class="edge">
<title>m21_out&#45;&gt;m21_res1</title>
<path fill="none" stroke="black" d="M21968.55,-26327.62C21955.23,-26317.37 21939.64,-26305.37 21925.66,-26294.61"/>
<polygon fill="black" stroke="black" points="21927.7,-26291.77 21917.64,-26288.44 21923.43,-26297.31 21927.7,-26291.77"/>
</g>
<!-- m21_gate -->
<g id="node253" class="node">
<title>m21_gate</title>
<polygon fill="orange" stroke="black" points="21858.23,-26200.69 21653.63,-26200.69 21601,-26094.69 21805.59,-26094.69 21858.23,-26200.69"/>
<text text-anchor="middle" x="21729.61" y="-26158.99" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="21729.61" y="-26143.99" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="21729.61" y="-26128.99" font-family="Times,serif" font-size="14.00">GPU: 3733</text>
</g>
<!-- m21_res1&#45;&gt;m21_gate -->
<g id="edge308" class="edge">
<title>m21_res1&#45;&gt;m21_gate</title>
<path fill="none" stroke="black" d="M21854.08,-26238.96C21841.08,-26229.53 21825.48,-26218.22 21809.79,-26206.84"/>
<polygon fill="black" stroke="black" points="21811.74,-26203.93 21801.59,-26200.89 21807.63,-26209.6 21811.74,-26203.93"/>
</g>
<!-- m21_route -->
<g id="node254" class="node">
<title>m21_route</title>
<ellipse fill="lightgray" stroke="black" cx="21729.61" cy="-26021.21" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="21729.61" y="-26032.51" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="21729.61" y="-26017.51" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="21729.61" y="-26002.51" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m21_res1&#45;&gt;m21_route -->
<g id="edge310" class="edge">
<title>m21_res1&#45;&gt;m21_route</title>
<path fill="none" stroke="black" d="M21890.67,-26236.71C21894.79,-26201.38 21896.92,-26137.54 21867.61,-26094.69 21854.5,-26075.52 21834.68,-26061.06 21814.11,-26050.31"/>
<polygon fill="black" stroke="black" points="21815.47,-26047.07 21804.95,-26045.77 21812.36,-26053.35 21815.47,-26047.07"/>
</g>
<!-- m21_final -->
<g id="node259" class="node">
<title>m21_final</title>
<ellipse fill="lightpink" stroke="black" cx="22302.61" cy="-25697.91" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="22302.61" y="-25701.71" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="22302.61" y="-25686.71" font-family="Times,serif" font-size="14.00">GPU: 3733</text>
</g>
<!-- m21_res1&#45;&gt;m21_final -->
<g id="edge318" class="edge">
<title>m21_res1&#45;&gt;m21_final</title>
<path fill="none" stroke="black" d="M21962.71,-26257.89C22096.21,-26245.13 22358.61,-26197.73 22358.61,-26022.21 22358.61,-26022.21 22358.61,-26022.21 22358.61,-25909.26 22358.61,-25845.93 22334.62,-25775.39 22318.04,-25734.2"/>
<polygon fill="black" stroke="black" points="22321.25,-25732.8 22314.22,-25724.88 22314.78,-25735.46 22321.25,-25732.8"/>
</g>
<!-- m21_gate&#45;&gt;m21_route -->
<g id="edge309" class="edge">
<title>m21_gate&#45;&gt;m21_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21729.61,-26094.62C21729.61,-26086.19 21729.61,-26077.5 21729.61,-26069.2"/>
<polygon fill="black" stroke="black" points="21733.11,-26068.94 21729.61,-26058.94 21726.11,-26068.94 21733.11,-26068.94"/>
</g>
<!-- m21_expert0 -->
<g id="node255" class="node">
<title>m21_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="20812.61" cy="-25910.26" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="20812.61" y="-25921.56" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="20812.61" y="-25906.56" font-family="Times,serif" font-size="14.00">Node 144 GPU 0</text>
<text text-anchor="middle" x="20812.61" y="-25891.56" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m21_route&#45;&gt;m21_expert0 -->
<g id="edge311" class="edge">
<title>m21_route&#45;&gt;m21_expert0</title>
<path fill="none" stroke="black" d="M21635.15,-26009.02C21515.09,-25994.8 21301.46,-25969.48 21118.61,-25947.73 21091.41,-25944.5 21062.84,-25941.1 21034.54,-25937.73"/>
<polygon fill="black" stroke="black" points="21034.89,-25934.25 21024.55,-25936.54 21034.06,-25941.2 21034.89,-25934.25"/>
</g>
<!-- m21_expert1 -->
<g id="node256" class="node">
<title>m21_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="21423.61" cy="-25910.26" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="21423.61" y="-25921.56" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="21423.61" y="-25906.56" font-family="Times,serif" font-size="14.00">Node 144 GPU 1</text>
<text text-anchor="middle" x="21423.61" y="-25891.56" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m21_route&#45;&gt;m21_expert1 -->
<g id="edge313" class="edge">
<title>m21_route&#45;&gt;m21_expert1</title>
<path fill="none" stroke="black" d="M21658.26,-25994.8C21620.08,-25981.21 21572.32,-25964.21 21529.87,-25949.09"/>
<polygon fill="black" stroke="black" points="21530.93,-25945.75 21520.33,-25945.7 21528.58,-25952.35 21530.93,-25945.75"/>
</g>
<!-- m21_expert2 -->
<g id="node257" class="node">
<title>m21_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="22034.61" cy="-25910.26" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="22034.61" y="-25921.56" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="22034.61" y="-25906.56" font-family="Times,serif" font-size="14.00">Node 144 GPU 2</text>
<text text-anchor="middle" x="22034.61" y="-25891.56" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m21_route&#45;&gt;m21_expert2 -->
<g id="edge315" class="edge">
<title>m21_route&#45;&gt;m21_expert2</title>
<path fill="none" stroke="black" d="M21800.74,-25994.8C21838.78,-25981.21 21886.39,-25964.21 21928.7,-25949.09"/>
<polygon fill="black" stroke="black" points="21929.97,-25952.36 21938.21,-25945.7 21927.61,-25945.76 21929.97,-25952.36"/>
</g>
<!-- m21_agg -->
<g id="node258" class="node">
<title>m21_agg</title>
<polygon fill="purple" stroke="black" points="21893.23,-25836.78 21632.95,-25836.78 21566,-25760.78 21826.27,-25760.78 21893.23,-25836.78"/>
<text text-anchor="middle" x="21729.61" y="-25802.58" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="21729.61" y="-25787.58" font-family="Times,serif" font-size="14.00">GPU: 3733</text>
</g>
<!-- m21_expert0&#45;&gt;m21_agg -->
<g id="edge312" class="edge">
<title>m21_expert0&#45;&gt;m21_agg</title>
<path fill="none" stroke="black" d="M21024.14,-25884C21202.91,-25862.66 21453.08,-25832.8 21602.48,-25814.96"/>
<polygon fill="black" stroke="black" points="21603.1,-25818.41 21612.62,-25813.75 21602.27,-25811.46 21603.1,-25818.41"/>
</g>
<!-- m21_expert1&#45;&gt;m21_agg -->
<g id="edge314" class="edge">
<title>m21_expert1&#45;&gt;m21_agg</title>
<path fill="none" stroke="black" d="M21520.01,-25874.77C21552.3,-25863.22 21588.5,-25850.27 21621.62,-25838.42"/>
<polygon fill="black" stroke="black" points="21623.09,-25841.61 21631.33,-25834.94 21620.73,-25835.02 21623.09,-25841.61"/>
</g>
<!-- m21_expert2&#45;&gt;m21_agg -->
<g id="edge316" class="edge">
<title>m21_expert2&#45;&gt;m21_agg</title>
<path fill="none" stroke="black" d="M21938.53,-25874.77C21908.07,-25863.84 21874.11,-25851.65 21842.57,-25840.33"/>
<polygon fill="black" stroke="black" points="21843.47,-25836.93 21832.87,-25836.84 21841.1,-25843.52 21843.47,-25836.93"/>
</g>
<!-- m21_agg&#45;&gt;m21_final -->
<g id="edge317" class="edge">
<title>m21_agg&#45;&gt;m21_final</title>
<path fill="none" stroke="black" d="M21842.13,-25778.37C21948.17,-25760.07 22105.36,-25732.95 22205.9,-25715.6"/>
<polygon fill="black" stroke="black" points="22206.79,-25719 22216.05,-25713.85 22205.6,-25712.1 22206.79,-25719"/>
</g>
<!-- m22_res1 -->
<g id="node264" class="node">
<title>m22_res1</title>
<ellipse fill="lightpink" stroke="black" cx="22415.61" cy="-25608.17" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="22415.61" y="-25611.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="22415.61" y="-25596.97" font-family="Times,serif" font-size="14.00">GPU: 3734</text>
</g>
<!-- m21_final&#45;&gt;m22_res1 -->
<g id="edge323" class="edge">
<title>m21_final&#45;&gt;m22_res1</title>
<path fill="none" stroke="black" d="M22334.39,-25672.24C22347.6,-25661.98 22363.05,-25649.99 22376.9,-25639.23"/>
<polygon fill="black" stroke="black" points="22379.1,-25641.95 22384.85,-25633.06 22374.81,-25636.42 22379.1,-25641.95"/>
</g>
<!-- m22_ln1 -->
<g id="node260" class="node">
<title>m22_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="22529.61" cy="-26021.21" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="22529.61" y="-26025.01" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="22529.61" y="-26010.01" font-family="Times,serif" font-size="14.00">GPU: 3734</text>
</g>
<!-- m22_qkv -->
<g id="node261" class="node">
<title>m22_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="22529.61" cy="-25910.26" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="22529.61" y="-25914.06" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="22529.61" y="-25899.06" font-family="Times,serif" font-size="14.00">GPU: 3734</text>
</g>
<!-- m22_ln1&#45;&gt;m22_qkv -->
<g id="edge319" class="edge">
<title>m22_ln1&#45;&gt;m22_qkv</title>
<path fill="none" stroke="black" d="M22529.61,-25994.11C22529.61,-25980.1 22529.61,-25962.61 22529.61,-25947.31"/>
<polygon fill="black" stroke="black" points="22533.11,-25947.14 22529.61,-25937.14 22526.11,-25947.14 22533.11,-25947.14"/>
</g>
<!-- m22_mha -->
<g id="node262" class="node">
<title>m22_mha</title>
<ellipse fill="lightblue" stroke="black" cx="22529.61" cy="-25798.78" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="22529.61" y="-25802.58" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="22529.61" y="-25787.58" font-family="Times,serif" font-size="14.00">GPU: 3734</text>
</g>
<!-- m22_qkv&#45;&gt;m22_mha -->
<g id="edge320" class="edge">
<title>m22_qkv&#45;&gt;m22_mha</title>
<path fill="none" stroke="black" d="M22529.61,-25883.31C22529.61,-25869.24 22529.61,-25851.61 22529.61,-25836.18"/>
<polygon fill="black" stroke="black" points="22533.11,-25835.92 22529.61,-25825.92 22526.11,-25835.92 22533.11,-25835.92"/>
</g>
<!-- m22_out -->
<g id="node263" class="node">
<title>m22_out</title>
<ellipse fill="lightblue" stroke="black" cx="22529.61" cy="-25697.91" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="22529.61" y="-25701.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="22529.61" y="-25686.71" font-family="Times,serif" font-size="14.00">GPU: 3734</text>
</g>
<!-- m22_mha&#45;&gt;m22_out -->
<g id="edge321" class="edge">
<title>m22_mha&#45;&gt;m22_out</title>
<path fill="none" stroke="black" d="M22529.61,-25771.8C22529.61,-25760.65 22529.61,-25747.43 22529.61,-25735.33"/>
<polygon fill="black" stroke="black" points="22533.11,-25735.06 22529.61,-25725.06 22526.11,-25735.06 22533.11,-25735.06"/>
</g>
<!-- m22_out&#45;&gt;m22_res1 -->
<g id="edge322" class="edge">
<title>m22_out&#45;&gt;m22_res1</title>
<path fill="none" stroke="black" d="M22497.55,-25672.24C22484.23,-25661.98 22468.64,-25649.99 22454.66,-25639.23"/>
<polygon fill="black" stroke="black" points="22456.7,-25636.38 22446.64,-25633.06 22452.43,-25641.93 22456.7,-25636.38"/>
</g>
<!-- m22_gate -->
<g id="node265" class="node">
<title>m22_gate</title>
<polygon fill="orange" stroke="black" points="22387.23,-25545.3 22182.63,-25545.3 22130,-25439.3 22334.59,-25439.3 22387.23,-25545.3"/>
<text text-anchor="middle" x="22258.61" y="-25503.6" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="22258.61" y="-25488.6" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="22258.61" y="-25473.6" font-family="Times,serif" font-size="14.00">GPU: 3734</text>
</g>
<!-- m22_res1&#45;&gt;m22_gate -->
<g id="edge324" class="edge">
<title>m22_res1&#45;&gt;m22_gate</title>
<path fill="none" stroke="black" d="M22383.08,-25583.58C22370.08,-25574.15 22354.48,-25562.83 22338.79,-25551.45"/>
<polygon fill="black" stroke="black" points="22340.74,-25548.54 22330.59,-25545.51 22336.63,-25554.21 22340.74,-25548.54"/>
</g>
<!-- m22_route -->
<g id="node266" class="node">
<title>m22_route</title>
<ellipse fill="lightgray" stroke="black" cx="22258.61" cy="-25365.82" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="22258.61" y="-25377.12" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="22258.61" y="-25362.12" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="22258.61" y="-25347.12" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m22_res1&#45;&gt;m22_route -->
<g id="edge326" class="edge">
<title>m22_res1&#45;&gt;m22_route</title>
<path fill="none" stroke="black" d="M22419.67,-25581.32C22423.79,-25546 22425.92,-25482.15 22396.61,-25439.3 22383.5,-25420.14 22363.68,-25405.68 22343.11,-25394.92"/>
<polygon fill="black" stroke="black" points="22344.47,-25391.69 22333.95,-25390.39 22341.36,-25397.96 22344.47,-25391.69"/>
</g>
<!-- m22_final -->
<g id="node271" class="node">
<title>m22_final</title>
<ellipse fill="lightpink" stroke="black" cx="22831.61" cy="-25042.52" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="22831.61" y="-25046.32" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="22831.61" y="-25031.32" font-family="Times,serif" font-size="14.00">GPU: 3734</text>
</g>
<!-- m22_res1&#45;&gt;m22_final -->
<g id="edge334" class="edge">
<title>m22_res1&#45;&gt;m22_final</title>
<path fill="none" stroke="black" d="M22491.71,-25602.5C22625.21,-25589.74 22887.61,-25542.35 22887.61,-25366.82 22887.61,-25366.82 22887.61,-25366.82 22887.61,-25253.87 22887.61,-25190.55 22863.62,-25120 22847.04,-25078.82"/>
<polygon fill="black" stroke="black" points="22850.25,-25077.42 22843.22,-25069.5 22843.78,-25080.08 22850.25,-25077.42"/>
</g>
<!-- m22_gate&#45;&gt;m22_route -->
<g id="edge325" class="edge">
<title>m22_gate&#45;&gt;m22_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22258.61,-25439.23C22258.61,-25430.8 22258.61,-25422.11 22258.61,-25413.81"/>
<polygon fill="black" stroke="black" points="22262.11,-25413.55 22258.61,-25403.55 22255.11,-25413.55 22262.11,-25413.55"/>
</g>
<!-- m22_expert0 -->
<g id="node267" class="node">
<title>m22_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="21341.61" cy="-25254.87" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="21341.61" y="-25266.17" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="21341.61" y="-25251.17" font-family="Times,serif" font-size="14.00">Node 152 GPU 0</text>
<text text-anchor="middle" x="21341.61" y="-25236.17" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m22_route&#45;&gt;m22_expert0 -->
<g id="edge327" class="edge">
<title>m22_route&#45;&gt;m22_expert0</title>
<path fill="none" stroke="black" d="M22164.15,-25353.64C22044.09,-25339.41 21830.46,-25314.09 21647.61,-25292.35 21620.41,-25289.11 21591.84,-25285.71 21563.54,-25282.34"/>
<polygon fill="black" stroke="black" points="21563.89,-25278.86 21553.55,-25281.15 21563.06,-25285.81 21563.89,-25278.86"/>
</g>
<!-- m22_expert1 -->
<g id="node268" class="node">
<title>m22_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="21952.61" cy="-25254.87" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="21952.61" y="-25266.17" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="21952.61" y="-25251.17" font-family="Times,serif" font-size="14.00">Node 152 GPU 1</text>
<text text-anchor="middle" x="21952.61" y="-25236.17" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m22_route&#45;&gt;m22_expert1 -->
<g id="edge329" class="edge">
<title>m22_route&#45;&gt;m22_expert1</title>
<path fill="none" stroke="black" d="M22187.26,-25339.42C22149.08,-25325.83 22101.32,-25308.82 22058.87,-25293.7"/>
<polygon fill="black" stroke="black" points="22059.93,-25290.37 22049.33,-25290.31 22057.58,-25296.96 22059.93,-25290.37"/>
</g>
<!-- m22_expert2 -->
<g id="node269" class="node">
<title>m22_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="22563.61" cy="-25254.87" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="22563.61" y="-25266.17" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="22563.61" y="-25251.17" font-family="Times,serif" font-size="14.00">Node 152 GPU 2</text>
<text text-anchor="middle" x="22563.61" y="-25236.17" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m22_route&#45;&gt;m22_expert2 -->
<g id="edge331" class="edge">
<title>m22_route&#45;&gt;m22_expert2</title>
<path fill="none" stroke="black" d="M22329.74,-25339.42C22367.78,-25325.83 22415.39,-25308.82 22457.7,-25293.7"/>
<polygon fill="black" stroke="black" points="22458.97,-25296.97 22467.21,-25290.31 22456.61,-25290.38 22458.97,-25296.97"/>
</g>
<!-- m22_agg -->
<g id="node270" class="node">
<title>m22_agg</title>
<polygon fill="purple" stroke="black" points="22422.23,-25181.39 22161.95,-25181.39 22095,-25105.39 22355.27,-25105.39 22422.23,-25181.39"/>
<text text-anchor="middle" x="22258.61" y="-25147.19" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="22258.61" y="-25132.19" font-family="Times,serif" font-size="14.00">GPU: 3734</text>
</g>
<!-- m22_expert0&#45;&gt;m22_agg -->
<g id="edge328" class="edge">
<title>m22_expert0&#45;&gt;m22_agg</title>
<path fill="none" stroke="black" d="M21553.14,-25228.62C21731.91,-25207.27 21982.08,-25177.41 22131.48,-25159.57"/>
<polygon fill="black" stroke="black" points="22132.1,-25163.02 22141.62,-25158.36 22131.27,-25156.07 22132.1,-25163.02"/>
</g>
<!-- m22_expert1&#45;&gt;m22_agg -->
<g id="edge330" class="edge">
<title>m22_expert1&#45;&gt;m22_agg</title>
<path fill="none" stroke="black" d="M22049.01,-25219.38C22081.3,-25207.83 22117.5,-25194.88 22150.62,-25183.03"/>
<polygon fill="black" stroke="black" points="22152.09,-25186.22 22160.33,-25179.56 22149.73,-25179.63 22152.09,-25186.22"/>
</g>
<!-- m22_expert2&#45;&gt;m22_agg -->
<g id="edge332" class="edge">
<title>m22_expert2&#45;&gt;m22_agg</title>
<path fill="none" stroke="black" d="M22467.53,-25219.38C22437.07,-25208.45 22403.11,-25196.26 22371.57,-25184.94"/>
<polygon fill="black" stroke="black" points="22372.47,-25181.54 22361.87,-25181.46 22370.1,-25188.13 22372.47,-25181.54"/>
</g>
<!-- m22_agg&#45;&gt;m22_final -->
<g id="edge333" class="edge">
<title>m22_agg&#45;&gt;m22_final</title>
<path fill="none" stroke="black" d="M22371.13,-25122.98C22477.17,-25104.68 22634.36,-25077.56 22734.9,-25060.21"/>
<polygon fill="black" stroke="black" points="22735.79,-25063.61 22745.05,-25058.46 22734.6,-25056.71 22735.79,-25063.61"/>
</g>
<!-- m23_res1 -->
<g id="node276" class="node">
<title>m23_res1</title>
<ellipse fill="lightpink" stroke="black" cx="22944.61" cy="-24952.78" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="22944.61" y="-24956.58" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="22944.61" y="-24941.58" font-family="Times,serif" font-size="14.00">GPU: 3735</text>
</g>
<!-- m22_final&#45;&gt;m23_res1 -->
<g id="edge339" class="edge">
<title>m22_final&#45;&gt;m23_res1</title>
<path fill="none" stroke="black" d="M22863.39,-25016.85C22876.6,-25006.6 22892.05,-24994.6 22905.9,-24983.84"/>
<polygon fill="black" stroke="black" points="22908.1,-24986.57 22913.85,-24977.67 22903.81,-24981.04 22908.1,-24986.57"/>
</g>
<!-- m23_ln1 -->
<g id="node272" class="node">
<title>m23_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="23058.61" cy="-25365.82" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="23058.61" y="-25369.62" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="23058.61" y="-25354.62" font-family="Times,serif" font-size="14.00">GPU: 3735</text>
</g>
<!-- m23_qkv -->
<g id="node273" class="node">
<title>m23_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="23058.61" cy="-25254.87" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="23058.61" y="-25258.67" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="23058.61" y="-25243.67" font-family="Times,serif" font-size="14.00">GPU: 3735</text>
</g>
<!-- m23_ln1&#45;&gt;m23_qkv -->
<g id="edge335" class="edge">
<title>m23_ln1&#45;&gt;m23_qkv</title>
<path fill="none" stroke="black" d="M23058.61,-25338.73C23058.61,-25324.71 23058.61,-25307.22 23058.61,-25291.92"/>
<polygon fill="black" stroke="black" points="23062.11,-25291.76 23058.61,-25281.76 23055.11,-25291.76 23062.11,-25291.76"/>
</g>
<!-- m23_mha -->
<g id="node274" class="node">
<title>m23_mha</title>
<ellipse fill="lightblue" stroke="black" cx="23058.61" cy="-25143.39" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="23058.61" y="-25147.19" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="23058.61" y="-25132.19" font-family="Times,serif" font-size="14.00">GPU: 3735</text>
</g>
<!-- m23_qkv&#45;&gt;m23_mha -->
<g id="edge336" class="edge">
<title>m23_qkv&#45;&gt;m23_mha</title>
<path fill="none" stroke="black" d="M23058.61,-25227.93C23058.61,-25213.85 23058.61,-25196.22 23058.61,-25180.79"/>
<polygon fill="black" stroke="black" points="23062.11,-25180.53 23058.61,-25170.53 23055.11,-25180.53 23062.11,-25180.53"/>
</g>
<!-- m23_out -->
<g id="node275" class="node">
<title>m23_out</title>
<ellipse fill="lightblue" stroke="black" cx="23058.61" cy="-25042.52" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="23058.61" y="-25046.32" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="23058.61" y="-25031.32" font-family="Times,serif" font-size="14.00">GPU: 3735</text>
</g>
<!-- m23_mha&#45;&gt;m23_out -->
<g id="edge337" class="edge">
<title>m23_mha&#45;&gt;m23_out</title>
<path fill="none" stroke="black" d="M23058.61,-25116.42C23058.61,-25105.27 23058.61,-25092.04 23058.61,-25079.94"/>
<polygon fill="black" stroke="black" points="23062.11,-25079.67 23058.61,-25069.67 23055.11,-25079.67 23062.11,-25079.67"/>
</g>
<!-- m23_out&#45;&gt;m23_res1 -->
<g id="edge338" class="edge">
<title>m23_out&#45;&gt;m23_res1</title>
<path fill="none" stroke="black" d="M23026.55,-25016.85C23013.23,-25006.6 22997.64,-24994.6 22983.66,-24983.84"/>
<polygon fill="black" stroke="black" points="22985.7,-24980.99 22975.64,-24977.67 22981.43,-24986.54 22985.7,-24980.99"/>
</g>
<!-- m23_gate -->
<g id="node277" class="node">
<title>m23_gate</title>
<polygon fill="orange" stroke="black" points="22916.23,-24889.91 22711.63,-24889.91 22659,-24783.91 22863.59,-24783.91 22916.23,-24889.91"/>
<text text-anchor="middle" x="22787.61" y="-24848.21" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="22787.61" y="-24833.21" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="22787.61" y="-24818.21" font-family="Times,serif" font-size="14.00">GPU: 3735</text>
</g>
<!-- m23_res1&#45;&gt;m23_gate -->
<g id="edge340" class="edge">
<title>m23_res1&#45;&gt;m23_gate</title>
<path fill="none" stroke="black" d="M22912.08,-24928.19C22899.08,-24918.76 22883.48,-24907.45 22867.79,-24896.07"/>
<polygon fill="black" stroke="black" points="22869.74,-24893.16 22859.59,-24890.12 22865.63,-24898.82 22869.74,-24893.16"/>
</g>
<!-- m23_route -->
<g id="node278" class="node">
<title>m23_route</title>
<ellipse fill="lightgray" stroke="black" cx="22787.61" cy="-24710.44" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="22787.61" y="-24721.74" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="22787.61" y="-24706.74" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="22787.61" y="-24691.74" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m23_res1&#45;&gt;m23_route -->
<g id="edge342" class="edge">
<title>m23_res1&#45;&gt;m23_route</title>
<path fill="none" stroke="black" d="M22948.67,-24925.93C22952.79,-24890.61 22954.92,-24826.76 22925.61,-24783.91 22912.5,-24764.75 22892.68,-24750.29 22872.11,-24739.53"/>
<polygon fill="black" stroke="black" points="22873.47,-24736.3 22862.95,-24735 22870.36,-24742.57 22873.47,-24736.3"/>
</g>
<!-- m23_final -->
<g id="node283" class="node">
<title>m23_final</title>
<ellipse fill="lightpink" stroke="black" cx="23360.61" cy="-24387.14" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="23360.61" y="-24390.94" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="23360.61" y="-24375.94" font-family="Times,serif" font-size="14.00">GPU: 3735</text>
</g>
<!-- m23_res1&#45;&gt;m23_final -->
<g id="edge350" class="edge">
<title>m23_res1&#45;&gt;m23_final</title>
<path fill="none" stroke="black" d="M23020.71,-24947.11C23154.21,-24934.36 23416.61,-24886.96 23416.61,-24711.44 23416.61,-24711.44 23416.61,-24711.44 23416.61,-24598.48 23416.61,-24535.16 23392.62,-24464.61 23376.04,-24423.43"/>
<polygon fill="black" stroke="black" points="23379.25,-24422.03 23372.22,-24414.11 23372.78,-24424.69 23379.25,-24422.03"/>
</g>
<!-- m23_gate&#45;&gt;m23_route -->
<g id="edge341" class="edge">
<title>m23_gate&#45;&gt;m23_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22787.61,-24783.85C22787.61,-24775.41 22787.61,-24766.73 22787.61,-24758.42"/>
<polygon fill="black" stroke="black" points="22791.11,-24758.16 22787.61,-24748.16 22784.11,-24758.16 22791.11,-24758.16"/>
</g>
<!-- m23_expert0 -->
<g id="node279" class="node">
<title>m23_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="21870.61" cy="-24599.48" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="21870.61" y="-24610.78" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="21870.61" y="-24595.78" font-family="Times,serif" font-size="14.00">Node 160 GPU 0</text>
<text text-anchor="middle" x="21870.61" y="-24580.78" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m23_route&#45;&gt;m23_expert0 -->
<g id="edge343" class="edge">
<title>m23_route&#45;&gt;m23_expert0</title>
<path fill="none" stroke="black" d="M22693.15,-24698.25C22573.09,-24684.03 22359.46,-24658.7 22176.61,-24636.96 22149.41,-24633.73 22120.84,-24630.32 22092.54,-24626.95"/>
<polygon fill="black" stroke="black" points="22092.89,-24623.47 22082.55,-24625.76 22092.06,-24630.42 22092.89,-24623.47"/>
</g>
<!-- m23_expert1 -->
<g id="node280" class="node">
<title>m23_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="22481.61" cy="-24599.48" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="22481.61" y="-24610.78" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="22481.61" y="-24595.78" font-family="Times,serif" font-size="14.00">Node 160 GPU 1</text>
<text text-anchor="middle" x="22481.61" y="-24580.78" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m23_route&#45;&gt;m23_expert1 -->
<g id="edge345" class="edge">
<title>m23_route&#45;&gt;m23_expert1</title>
<path fill="none" stroke="black" d="M22716.26,-24684.03C22678.08,-24670.44 22630.32,-24653.43 22587.87,-24638.32"/>
<polygon fill="black" stroke="black" points="22588.93,-24634.98 22578.33,-24634.92 22586.58,-24641.57 22588.93,-24634.98"/>
</g>
<!-- m23_expert2 -->
<g id="node281" class="node">
<title>m23_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="23092.61" cy="-24599.48" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="23092.61" y="-24610.78" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="23092.61" y="-24595.78" font-family="Times,serif" font-size="14.00">Node 160 GPU 2</text>
<text text-anchor="middle" x="23092.61" y="-24580.78" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m23_route&#45;&gt;m23_expert2 -->
<g id="edge347" class="edge">
<title>m23_route&#45;&gt;m23_expert2</title>
<path fill="none" stroke="black" d="M22858.74,-24684.03C22896.78,-24670.44 22944.39,-24653.43 22986.7,-24638.32"/>
<polygon fill="black" stroke="black" points="22987.97,-24641.58 22996.21,-24634.92 22985.61,-24634.99 22987.97,-24641.58"/>
</g>
<!-- m23_agg -->
<g id="node282" class="node">
<title>m23_agg</title>
<polygon fill="purple" stroke="black" points="22951.23,-24526.01 22690.95,-24526.01 22624,-24450.01 22884.27,-24450.01 22951.23,-24526.01"/>
<text text-anchor="middle" x="22787.61" y="-24491.81" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="22787.61" y="-24476.81" font-family="Times,serif" font-size="14.00">GPU: 3735</text>
</g>
<!-- m23_expert0&#45;&gt;m23_agg -->
<g id="edge344" class="edge">
<title>m23_expert0&#45;&gt;m23_agg</title>
<path fill="none" stroke="black" d="M22082.14,-24573.23C22260.91,-24551.89 22511.08,-24522.02 22660.48,-24504.19"/>
<polygon fill="black" stroke="black" points="22661.1,-24507.64 22670.62,-24502.97 22660.27,-24500.69 22661.1,-24507.64"/>
</g>
<!-- m23_expert1&#45;&gt;m23_agg -->
<g id="edge346" class="edge">
<title>m23_expert1&#45;&gt;m23_agg</title>
<path fill="none" stroke="black" d="M22578.01,-24564C22610.3,-24552.44 22646.5,-24539.49 22679.62,-24527.64"/>
<polygon fill="black" stroke="black" points="22681.09,-24530.83 22689.33,-24524.17 22678.73,-24524.24 22681.09,-24530.83"/>
</g>
<!-- m23_expert2&#45;&gt;m23_agg -->
<g id="edge348" class="edge">
<title>m23_expert2&#45;&gt;m23_agg</title>
<path fill="none" stroke="black" d="M22996.53,-24564C22966.07,-24553.06 22932.11,-24540.87 22900.57,-24529.55"/>
<polygon fill="black" stroke="black" points="22901.47,-24526.16 22890.87,-24526.07 22899.1,-24532.74 22901.47,-24526.16"/>
</g>
<!-- m23_agg&#45;&gt;m23_final -->
<g id="edge349" class="edge">
<title>m23_agg&#45;&gt;m23_final</title>
<path fill="none" stroke="black" d="M22900.13,-24467.59C23006.17,-24449.3 23163.36,-24422.17 23263.9,-24404.83"/>
<polygon fill="black" stroke="black" points="23264.79,-24408.22 23274.05,-24403.07 23263.6,-24401.32 23264.79,-24408.22"/>
</g>
<!-- m24_res1 -->
<g id="node288" class="node">
<title>m24_res1</title>
<ellipse fill="lightpink" stroke="black" cx="23473.61" cy="-24297.4" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="23473.61" y="-24301.2" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="23473.61" y="-24286.2" font-family="Times,serif" font-size="14.00">GPU: 3736</text>
</g>
<!-- m23_final&#45;&gt;m24_res1 -->
<g id="edge355" class="edge">
<title>m23_final&#45;&gt;m24_res1</title>
<path fill="none" stroke="black" d="M23392.39,-24361.46C23405.6,-24351.21 23421.05,-24339.21 23434.9,-24328.45"/>
<polygon fill="black" stroke="black" points="23437.1,-24331.18 23442.85,-24322.28 23432.81,-24325.65 23437.1,-24331.18"/>
</g>
<!-- m24_ln1 -->
<g id="node284" class="node">
<title>m24_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="23587.61" cy="-24710.44" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="23587.61" y="-24714.24" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="23587.61" y="-24699.24" font-family="Times,serif" font-size="14.00">GPU: 3736</text>
</g>
<!-- m24_qkv -->
<g id="node285" class="node">
<title>m24_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="23587.61" cy="-24599.48" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="23587.61" y="-24603.28" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="23587.61" y="-24588.28" font-family="Times,serif" font-size="14.00">GPU: 3736</text>
</g>
<!-- m24_ln1&#45;&gt;m24_qkv -->
<g id="edge351" class="edge">
<title>m24_ln1&#45;&gt;m24_qkv</title>
<path fill="none" stroke="black" d="M23587.61,-24683.34C23587.61,-24669.33 23587.61,-24651.83 23587.61,-24636.54"/>
<polygon fill="black" stroke="black" points="23591.11,-24636.37 23587.61,-24626.37 23584.11,-24636.37 23591.11,-24636.37"/>
</g>
<!-- m24_mha -->
<g id="node286" class="node">
<title>m24_mha</title>
<ellipse fill="lightblue" stroke="black" cx="23587.61" cy="-24488.01" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="23587.61" y="-24491.81" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="23587.61" y="-24476.81" font-family="Times,serif" font-size="14.00">GPU: 3736</text>
</g>
<!-- m24_qkv&#45;&gt;m24_mha -->
<g id="edge352" class="edge">
<title>m24_qkv&#45;&gt;m24_mha</title>
<path fill="none" stroke="black" d="M23587.61,-24572.54C23587.61,-24558.46 23587.61,-24540.84 23587.61,-24525.41"/>
<polygon fill="black" stroke="black" points="23591.11,-24525.15 23587.61,-24515.15 23584.11,-24525.15 23591.11,-24525.15"/>
</g>
<!-- m24_out -->
<g id="node287" class="node">
<title>m24_out</title>
<ellipse fill="lightblue" stroke="black" cx="23587.61" cy="-24387.14" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="23587.61" y="-24390.94" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="23587.61" y="-24375.94" font-family="Times,serif" font-size="14.00">GPU: 3736</text>
</g>
<!-- m24_mha&#45;&gt;m24_out -->
<g id="edge353" class="edge">
<title>m24_mha&#45;&gt;m24_out</title>
<path fill="none" stroke="black" d="M23587.61,-24461.03C23587.61,-24449.88 23587.61,-24436.65 23587.61,-24424.55"/>
<polygon fill="black" stroke="black" points="23591.11,-24424.28 23587.61,-24414.28 23584.11,-24424.28 23591.11,-24424.28"/>
</g>
<!-- m24_out&#45;&gt;m24_res1 -->
<g id="edge354" class="edge">
<title>m24_out&#45;&gt;m24_res1</title>
<path fill="none" stroke="black" d="M23555.55,-24361.46C23542.23,-24351.21 23526.64,-24339.21 23512.66,-24328.45"/>
<polygon fill="black" stroke="black" points="23514.7,-24325.61 23504.64,-24322.28 23510.43,-24331.15 23514.7,-24325.61"/>
</g>
<!-- m24_gate -->
<g id="node289" class="node">
<title>m24_gate</title>
<polygon fill="orange" stroke="black" points="23445.23,-24234.53 23240.63,-24234.53 23188,-24128.53 23392.59,-24128.53 23445.23,-24234.53"/>
<text text-anchor="middle" x="23316.61" y="-24192.83" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="23316.61" y="-24177.83" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="23316.61" y="-24162.83" font-family="Times,serif" font-size="14.00">GPU: 3736</text>
</g>
<!-- m24_res1&#45;&gt;m24_gate -->
<g id="edge356" class="edge">
<title>m24_res1&#45;&gt;m24_gate</title>
<path fill="none" stroke="black" d="M23441.08,-24272.8C23428.08,-24263.37 23412.48,-24252.06 23396.79,-24240.68"/>
<polygon fill="black" stroke="black" points="23398.74,-24237.77 23388.59,-24234.73 23394.63,-24243.44 23398.74,-24237.77"/>
</g>
<!-- m24_route -->
<g id="node290" class="node">
<title>m24_route</title>
<ellipse fill="lightgray" stroke="black" cx="23316.61" cy="-24055.05" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="23316.61" y="-24066.35" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="23316.61" y="-24051.35" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="23316.61" y="-24036.35" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m24_res1&#45;&gt;m24_route -->
<g id="edge358" class="edge">
<title>m24_res1&#45;&gt;m24_route</title>
<path fill="none" stroke="black" d="M23477.67,-24270.55C23481.79,-24235.22 23483.92,-24171.38 23454.61,-24128.53 23441.5,-24109.36 23421.68,-24094.9 23401.11,-24084.15"/>
<polygon fill="black" stroke="black" points="23402.47,-24080.91 23391.95,-24079.61 23399.36,-24087.19 23402.47,-24080.91"/>
</g>
<!-- m24_final -->
<g id="node295" class="node">
<title>m24_final</title>
<ellipse fill="lightpink" stroke="black" cx="23890.61" cy="-23731.75" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="23890.61" y="-23735.55" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="23890.61" y="-23720.55" font-family="Times,serif" font-size="14.00">GPU: 3736</text>
</g>
<!-- m24_res1&#45;&gt;m24_final -->
<g id="edge366" class="edge">
<title>m24_res1&#45;&gt;m24_final</title>
<path fill="none" stroke="black" d="M23549.87,-24291.78C23683.66,-24279.12 23946.61,-24231.87 23946.61,-24056.05 23946.61,-24056.05 23946.61,-24056.05 23946.61,-23943.1 23946.61,-23879.77 23922.62,-23809.23 23906.04,-23768.04"/>
<polygon fill="black" stroke="black" points="23909.25,-23766.64 23902.22,-23758.72 23902.78,-23769.3 23909.25,-23766.64"/>
</g>
<!-- m24_gate&#45;&gt;m24_route -->
<g id="edge357" class="edge">
<title>m24_gate&#45;&gt;m24_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23316.61,-24128.46C23316.61,-24120.03 23316.61,-24111.34 23316.61,-24103.04"/>
<polygon fill="black" stroke="black" points="23320.11,-24102.78 23316.61,-24092.78 23313.11,-24102.78 23320.11,-24102.78"/>
</g>
<!-- m24_expert0 -->
<g id="node291" class="node">
<title>m24_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="22400.61" cy="-23944.1" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="22400.61" y="-23955.4" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="22400.61" y="-23940.4" font-family="Times,serif" font-size="14.00">Node 168 GPU 0</text>
<text text-anchor="middle" x="22400.61" y="-23925.4" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m24_route&#45;&gt;m24_expert0 -->
<g id="edge359" class="edge">
<title>m24_route&#45;&gt;m24_expert0</title>
<path fill="none" stroke="black" d="M23222.3,-24042.86C23102.44,-24028.63 22889.16,-24003.3 22706.61,-23981.57 22679.41,-23978.34 22650.84,-23974.93 22622.54,-23971.56"/>
<polygon fill="black" stroke="black" points="22622.89,-23968.08 22612.55,-23970.37 22622.06,-23975.03 22622.89,-23968.08"/>
</g>
<!-- m24_expert1 -->
<g id="node292" class="node">
<title>m24_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="23011.61" cy="-23944.1" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="23011.61" y="-23955.4" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="23011.61" y="-23940.4" font-family="Times,serif" font-size="14.00">Node 168 GPU 1</text>
<text text-anchor="middle" x="23011.61" y="-23925.4" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m24_route&#45;&gt;m24_expert1 -->
<g id="edge361" class="edge">
<title>m24_route&#45;&gt;m24_expert1</title>
<path fill="none" stroke="black" d="M23245.49,-24028.64C23207.44,-24015.05 23159.83,-23998.05 23117.52,-23982.93"/>
<polygon fill="black" stroke="black" points="23118.61,-23979.6 23108.02,-23979.54 23116.26,-23986.2 23118.61,-23979.6"/>
</g>
<!-- m24_expert2 -->
<g id="node293" class="node">
<title>m24_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="23622.61" cy="-23944.1" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="23622.61" y="-23955.4" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="23622.61" y="-23940.4" font-family="Times,serif" font-size="14.00">Node 168 GPU 2</text>
<text text-anchor="middle" x="23622.61" y="-23925.4" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m24_route&#45;&gt;m24_expert2 -->
<g id="edge363" class="edge">
<title>m24_route&#45;&gt;m24_expert2</title>
<path fill="none" stroke="black" d="M23387.97,-24028.64C23426.14,-24015.05 23473.9,-23998.05 23516.36,-23982.93"/>
<polygon fill="black" stroke="black" points="23517.64,-23986.19 23525.89,-23979.54 23515.3,-23979.59 23517.64,-23986.19"/>
</g>
<!-- m24_agg -->
<g id="node294" class="node">
<title>m24_agg</title>
<polygon fill="purple" stroke="black" points="23481.23,-23870.62 23220.95,-23870.62 23154,-23794.62 23414.27,-23794.62 23481.23,-23870.62"/>
<text text-anchor="middle" x="23317.61" y="-23836.42" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="23317.61" y="-23821.42" font-family="Times,serif" font-size="14.00">GPU: 3736</text>
</g>
<!-- m24_expert0&#45;&gt;m24_agg -->
<g id="edge360" class="edge">
<title>m24_expert0&#45;&gt;m24_agg</title>
<path fill="none" stroke="black" d="M22612.14,-23917.84C22790.91,-23896.5 23041.08,-23866.63 23190.48,-23848.8"/>
<polygon fill="black" stroke="black" points="23191.1,-23852.25 23200.62,-23847.59 23190.27,-23845.3 23191.1,-23852.25"/>
</g>
<!-- m24_expert1&#45;&gt;m24_agg -->
<g id="edge362" class="edge">
<title>m24_expert1&#45;&gt;m24_agg</title>
<path fill="none" stroke="black" d="M23108.01,-23908.61C23140.3,-23897.06 23176.5,-23884.11 23209.62,-23872.26"/>
<polygon fill="black" stroke="black" points="23211.09,-23875.45 23219.33,-23868.78 23208.73,-23868.86 23211.09,-23875.45"/>
</g>
<!-- m24_expert2&#45;&gt;m24_agg -->
<g id="edge364" class="edge">
<title>m24_expert2&#45;&gt;m24_agg</title>
<path fill="none" stroke="black" d="M23526.53,-23908.61C23496.07,-23897.67 23462.11,-23885.49 23430.57,-23874.17"/>
<polygon fill="black" stroke="black" points="23431.47,-23870.77 23420.87,-23870.68 23429.1,-23877.36 23431.47,-23870.77"/>
</g>
<!-- m24_agg&#45;&gt;m24_final -->
<g id="edge365" class="edge">
<title>m24_agg&#45;&gt;m24_final</title>
<path fill="none" stroke="black" d="M23430.13,-23812.21C23536.17,-23793.91 23693.36,-23766.79 23793.9,-23749.44"/>
<polygon fill="black" stroke="black" points="23794.79,-23752.84 23804.05,-23747.69 23793.6,-23745.94 23794.79,-23752.84"/>
</g>
<!-- m25_res1 -->
<g id="node300" class="node">
<title>m25_res1</title>
<ellipse fill="lightpink" stroke="black" cx="24003.61" cy="-23642.01" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="24003.61" y="-23645.81" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="24003.61" y="-23630.81" font-family="Times,serif" font-size="14.00">GPU: 3737</text>
</g>
<!-- m24_final&#45;&gt;m25_res1 -->
<g id="edge371" class="edge">
<title>m24_final&#45;&gt;m25_res1</title>
<path fill="none" stroke="black" d="M23922.39,-23706.08C23935.6,-23695.82 23951.05,-23683.83 23964.9,-23673.07"/>
<polygon fill="black" stroke="black" points="23967.1,-23675.79 23972.85,-23666.89 23962.81,-23670.26 23967.1,-23675.79"/>
</g>
<!-- m25_ln1 -->
<g id="node296" class="node">
<title>m25_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="24117.61" cy="-24055.05" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="24117.61" y="-24058.85" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="24117.61" y="-24043.85" font-family="Times,serif" font-size="14.00">GPU: 3737</text>
</g>
<!-- m25_qkv -->
<g id="node297" class="node">
<title>m25_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="24117.61" cy="-23944.1" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="24117.61" y="-23947.9" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="24117.61" y="-23932.9" font-family="Times,serif" font-size="14.00">GPU: 3737</text>
</g>
<!-- m25_ln1&#45;&gt;m25_qkv -->
<g id="edge367" class="edge">
<title>m25_ln1&#45;&gt;m25_qkv</title>
<path fill="none" stroke="black" d="M24117.61,-24027.95C24117.61,-24013.94 24117.61,-23996.45 24117.61,-23981.15"/>
<polygon fill="black" stroke="black" points="24121.11,-23980.98 24117.61,-23970.98 24114.11,-23980.98 24121.11,-23980.98"/>
</g>
<!-- m25_mha -->
<g id="node298" class="node">
<title>m25_mha</title>
<ellipse fill="lightblue" stroke="black" cx="24117.61" cy="-23832.62" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="24117.61" y="-23836.42" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="24117.61" y="-23821.42" font-family="Times,serif" font-size="14.00">GPU: 3737</text>
</g>
<!-- m25_qkv&#45;&gt;m25_mha -->
<g id="edge368" class="edge">
<title>m25_qkv&#45;&gt;m25_mha</title>
<path fill="none" stroke="black" d="M24117.61,-23917.15C24117.61,-23903.08 24117.61,-23885.45 24117.61,-23870.02"/>
<polygon fill="black" stroke="black" points="24121.11,-23869.76 24117.61,-23859.76 24114.11,-23869.76 24121.11,-23869.76"/>
</g>
<!-- m25_out -->
<g id="node299" class="node">
<title>m25_out</title>
<ellipse fill="lightblue" stroke="black" cx="24117.61" cy="-23731.75" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="24117.61" y="-23735.55" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="24117.61" y="-23720.55" font-family="Times,serif" font-size="14.00">GPU: 3737</text>
</g>
<!-- m25_mha&#45;&gt;m25_out -->
<g id="edge369" class="edge">
<title>m25_mha&#45;&gt;m25_out</title>
<path fill="none" stroke="black" d="M24117.61,-23805.64C24117.61,-23794.49 24117.61,-23781.27 24117.61,-23769.16"/>
<polygon fill="black" stroke="black" points="24121.11,-23768.9 24117.61,-23758.9 24114.11,-23768.9 24121.11,-23768.9"/>
</g>
<!-- m25_out&#45;&gt;m25_res1 -->
<g id="edge370" class="edge">
<title>m25_out&#45;&gt;m25_res1</title>
<path fill="none" stroke="black" d="M24085.55,-23706.08C24072.23,-23695.82 24056.64,-23683.83 24042.66,-23673.07"/>
<polygon fill="black" stroke="black" points="24044.7,-23670.22 24034.64,-23666.89 24040.43,-23675.77 24044.7,-23670.22"/>
</g>
<!-- m25_gate -->
<g id="node301" class="node">
<title>m25_gate</title>
<polygon fill="orange" stroke="black" points="23975.23,-23579.14 23770.63,-23579.14 23718,-23473.14 23922.59,-23473.14 23975.23,-23579.14"/>
<text text-anchor="middle" x="23846.61" y="-23537.44" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="23846.61" y="-23522.44" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="23846.61" y="-23507.44" font-family="Times,serif" font-size="14.00">GPU: 3737</text>
</g>
<!-- m25_res1&#45;&gt;m25_gate -->
<g id="edge372" class="edge">
<title>m25_res1&#45;&gt;m25_gate</title>
<path fill="none" stroke="black" d="M23971.08,-23617.42C23958.08,-23607.99 23942.48,-23596.67 23926.79,-23585.29"/>
<polygon fill="black" stroke="black" points="23928.74,-23582.38 23918.59,-23579.34 23924.63,-23588.05 23928.74,-23582.38"/>
</g>
<!-- m25_route -->
<g id="node302" class="node">
<title>m25_route</title>
<ellipse fill="lightgray" stroke="black" cx="23846.61" cy="-23399.66" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="23846.61" y="-23410.96" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="23846.61" y="-23395.96" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="23846.61" y="-23380.96" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m25_res1&#45;&gt;m25_route -->
<g id="edge374" class="edge">
<title>m25_res1&#45;&gt;m25_route</title>
<path fill="none" stroke="black" d="M24007.67,-23615.16C24011.79,-23579.83 24013.92,-23515.99 23984.61,-23473.14 23971.5,-23453.98 23951.68,-23439.52 23931.11,-23428.76"/>
<polygon fill="black" stroke="black" points="23932.47,-23425.53 23921.95,-23424.23 23929.36,-23431.8 23932.47,-23425.53"/>
</g>
<!-- m25_final -->
<g id="node307" class="node">
<title>m25_final</title>
<ellipse fill="lightpink" stroke="black" cx="24420.61" cy="-23076.36" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="24420.61" y="-23080.16" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="24420.61" y="-23065.16" font-family="Times,serif" font-size="14.00">GPU: 3737</text>
</g>
<!-- m25_res1&#45;&gt;m25_final -->
<g id="edge382" class="edge">
<title>m25_res1&#45;&gt;m25_final</title>
<path fill="none" stroke="black" d="M24079.87,-23636.4C24213.66,-23623.73 24476.61,-23576.48 24476.61,-23400.66 24476.61,-23400.66 24476.61,-23400.66 24476.61,-23287.71 24476.61,-23224.39 24452.62,-23153.84 24436.04,-23112.66"/>
<polygon fill="black" stroke="black" points="24439.25,-23111.26 24432.22,-23103.34 24432.78,-23113.92 24439.25,-23111.26"/>
</g>
<!-- m25_gate&#45;&gt;m25_route -->
<g id="edge373" class="edge">
<title>m25_gate&#45;&gt;m25_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23846.61,-23473.07C23846.61,-23464.64 23846.61,-23455.95 23846.61,-23447.65"/>
<polygon fill="black" stroke="black" points="23850.11,-23447.39 23846.61,-23437.39 23843.11,-23447.39 23850.11,-23447.39"/>
</g>
<!-- m25_expert0 -->
<g id="node303" class="node">
<title>m25_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="22930.61" cy="-23288.71" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="22930.61" y="-23300.01" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="22930.61" y="-23285.01" font-family="Times,serif" font-size="14.00">Node 176 GPU 0</text>
<text text-anchor="middle" x="22930.61" y="-23270.01" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m25_route&#45;&gt;m25_expert0 -->
<g id="edge375" class="edge">
<title>m25_route&#45;&gt;m25_expert0</title>
<path fill="none" stroke="black" d="M23752.3,-23387.47C23632.44,-23373.24 23419.16,-23347.91 23236.61,-23326.19 23209.41,-23322.95 23180.84,-23319.55 23152.54,-23316.18"/>
<polygon fill="black" stroke="black" points="23152.89,-23312.69 23142.55,-23314.99 23152.06,-23319.64 23152.89,-23312.69"/>
</g>
<!-- m25_expert1 -->
<g id="node304" class="node">
<title>m25_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="23541.61" cy="-23288.71" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="23541.61" y="-23300.01" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="23541.61" y="-23285.01" font-family="Times,serif" font-size="14.00">Node 176 GPU 1</text>
<text text-anchor="middle" x="23541.61" y="-23270.01" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m25_route&#45;&gt;m25_expert1 -->
<g id="edge377" class="edge">
<title>m25_route&#45;&gt;m25_expert1</title>
<path fill="none" stroke="black" d="M23775.49,-23373.26C23737.44,-23359.66 23689.83,-23342.66 23647.52,-23327.54"/>
<polygon fill="black" stroke="black" points="23648.61,-23324.22 23638.02,-23324.15 23646.26,-23330.81 23648.61,-23324.22"/>
</g>
<!-- m25_expert2 -->
<g id="node305" class="node">
<title>m25_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="24152.61" cy="-23288.71" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="24152.61" y="-23300.01" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="24152.61" y="-23285.01" font-family="Times,serif" font-size="14.00">Node 176 GPU 2</text>
<text text-anchor="middle" x="24152.61" y="-23270.01" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m25_route&#45;&gt;m25_expert2 -->
<g id="edge379" class="edge">
<title>m25_route&#45;&gt;m25_expert2</title>
<path fill="none" stroke="black" d="M23917.97,-23373.26C23956.14,-23359.66 24003.9,-23342.66 24046.36,-23327.54"/>
<polygon fill="black" stroke="black" points="24047.64,-23330.8 24055.89,-23324.15 24045.3,-23324.21 24047.64,-23330.8"/>
</g>
<!-- m25_agg -->
<g id="node306" class="node">
<title>m25_agg</title>
<polygon fill="purple" stroke="black" points="24011.23,-23215.23 23750.95,-23215.23 23684,-23139.23 23944.27,-23139.23 24011.23,-23215.23"/>
<text text-anchor="middle" x="23847.61" y="-23181.03" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="23847.61" y="-23166.03" font-family="Times,serif" font-size="14.00">GPU: 3737</text>
</g>
<!-- m25_expert0&#45;&gt;m25_agg -->
<g id="edge376" class="edge">
<title>m25_expert0&#45;&gt;m25_agg</title>
<path fill="none" stroke="black" d="M23142.14,-23262.46C23320.91,-23241.11 23571.08,-23211.25 23720.48,-23193.41"/>
<polygon fill="black" stroke="black" points="23721.1,-23196.86 23730.62,-23192.2 23720.27,-23189.91 23721.1,-23196.86"/>
</g>
<!-- m25_expert1&#45;&gt;m25_agg -->
<g id="edge378" class="edge">
<title>m25_expert1&#45;&gt;m25_agg</title>
<path fill="none" stroke="black" d="M23638.01,-23253.22C23670.3,-23241.67 23706.5,-23228.72 23739.62,-23216.87"/>
<polygon fill="black" stroke="black" points="23741.09,-23220.06 23749.33,-23213.4 23738.73,-23213.47 23741.09,-23220.06"/>
</g>
<!-- m25_expert2&#45;&gt;m25_agg -->
<g id="edge380" class="edge">
<title>m25_expert2&#45;&gt;m25_agg</title>
<path fill="none" stroke="black" d="M24056.53,-23253.22C24026.07,-23242.29 23992.11,-23230.1 23960.57,-23218.78"/>
<polygon fill="black" stroke="black" points="23961.47,-23215.38 23950.87,-23215.3 23959.1,-23221.97 23961.47,-23215.38"/>
</g>
<!-- m25_agg&#45;&gt;m25_final -->
<g id="edge381" class="edge">
<title>m25_agg&#45;&gt;m25_final</title>
<path fill="none" stroke="black" d="M23960.13,-23156.82C24066.17,-23138.52 24223.36,-23111.4 24323.9,-23094.05"/>
<polygon fill="black" stroke="black" points="24324.79,-23097.45 24334.05,-23092.3 24323.6,-23090.55 24324.79,-23097.45"/>
</g>
<!-- m26_res1 -->
<g id="node312" class="node">
<title>m26_res1</title>
<ellipse fill="lightpink" stroke="black" cx="24533.61" cy="-22986.62" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="24533.61" y="-22990.42" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="24533.61" y="-22975.42" font-family="Times,serif" font-size="14.00">GPU: 3738</text>
</g>
<!-- m25_final&#45;&gt;m26_res1 -->
<g id="edge387" class="edge">
<title>m25_final&#45;&gt;m26_res1</title>
<path fill="none" stroke="black" d="M24452.39,-23050.69C24465.6,-23040.44 24481.05,-23028.44 24494.9,-23017.68"/>
<polygon fill="black" stroke="black" points="24497.1,-23020.41 24502.85,-23011.51 24492.81,-23014.88 24497.1,-23020.41"/>
</g>
<!-- m26_ln1 -->
<g id="node308" class="node">
<title>m26_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="24647.61" cy="-23399.66" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="24647.61" y="-23403.46" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="24647.61" y="-23388.46" font-family="Times,serif" font-size="14.00">GPU: 3738</text>
</g>
<!-- m26_qkv -->
<g id="node309" class="node">
<title>m26_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="24647.61" cy="-23288.71" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="24647.61" y="-23292.51" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="24647.61" y="-23277.51" font-family="Times,serif" font-size="14.00">GPU: 3738</text>
</g>
<!-- m26_ln1&#45;&gt;m26_qkv -->
<g id="edge383" class="edge">
<title>m26_ln1&#45;&gt;m26_qkv</title>
<path fill="none" stroke="black" d="M24647.61,-23372.57C24647.61,-23358.55 24647.61,-23341.06 24647.61,-23325.76"/>
<polygon fill="black" stroke="black" points="24651.11,-23325.59 24647.61,-23315.59 24644.11,-23325.59 24651.11,-23325.59"/>
</g>
<!-- m26_mha -->
<g id="node310" class="node">
<title>m26_mha</title>
<ellipse fill="lightblue" stroke="black" cx="24647.61" cy="-23177.23" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="24647.61" y="-23181.03" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="24647.61" y="-23166.03" font-family="Times,serif" font-size="14.00">GPU: 3738</text>
</g>
<!-- m26_qkv&#45;&gt;m26_mha -->
<g id="edge384" class="edge">
<title>m26_qkv&#45;&gt;m26_mha</title>
<path fill="none" stroke="black" d="M24647.61,-23261.77C24647.61,-23247.69 24647.61,-23230.06 24647.61,-23214.63"/>
<polygon fill="black" stroke="black" points="24651.11,-23214.37 24647.61,-23204.37 24644.11,-23214.37 24651.11,-23214.37"/>
</g>
<!-- m26_out -->
<g id="node311" class="node">
<title>m26_out</title>
<ellipse fill="lightblue" stroke="black" cx="24647.61" cy="-23076.36" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="24647.61" y="-23080.16" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="24647.61" y="-23065.16" font-family="Times,serif" font-size="14.00">GPU: 3738</text>
</g>
<!-- m26_mha&#45;&gt;m26_out -->
<g id="edge385" class="edge">
<title>m26_mha&#45;&gt;m26_out</title>
<path fill="none" stroke="black" d="M24647.61,-23150.26C24647.61,-23139.11 24647.61,-23125.88 24647.61,-23113.78"/>
<polygon fill="black" stroke="black" points="24651.11,-23113.51 24647.61,-23103.51 24644.11,-23113.51 24651.11,-23113.51"/>
</g>
<!-- m26_out&#45;&gt;m26_res1 -->
<g id="edge386" class="edge">
<title>m26_out&#45;&gt;m26_res1</title>
<path fill="none" stroke="black" d="M24615.55,-23050.69C24602.23,-23040.44 24586.64,-23028.44 24572.66,-23017.68"/>
<polygon fill="black" stroke="black" points="24574.7,-23014.83 24564.64,-23011.51 24570.43,-23020.38 24574.7,-23014.83"/>
</g>
<!-- m26_gate -->
<g id="node313" class="node">
<title>m26_gate</title>
<polygon fill="orange" stroke="black" points="24505.23,-22923.75 24300.63,-22923.75 24248,-22817.75 24452.59,-22817.75 24505.23,-22923.75"/>
<text text-anchor="middle" x="24376.61" y="-22882.05" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="24376.61" y="-22867.05" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="24376.61" y="-22852.05" font-family="Times,serif" font-size="14.00">GPU: 3738</text>
</g>
<!-- m26_res1&#45;&gt;m26_gate -->
<g id="edge388" class="edge">
<title>m26_res1&#45;&gt;m26_gate</title>
<path fill="none" stroke="black" d="M24501.08,-22962.03C24488.08,-22952.6 24472.48,-22941.28 24456.79,-22929.9"/>
<polygon fill="black" stroke="black" points="24458.74,-22927 24448.59,-22923.96 24454.63,-22932.66 24458.74,-22927"/>
</g>
<!-- m26_route -->
<g id="node314" class="node">
<title>m26_route</title>
<ellipse fill="lightgray" stroke="black" cx="24376.61" cy="-22744.28" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="24376.61" y="-22755.58" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="24376.61" y="-22740.58" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="24376.61" y="-22725.58" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m26_res1&#45;&gt;m26_route -->
<g id="edge390" class="edge">
<title>m26_res1&#45;&gt;m26_route</title>
<path fill="none" stroke="black" d="M24537.67,-22959.77C24541.79,-22924.45 24543.92,-22860.6 24514.61,-22817.75 24501.5,-22798.59 24481.68,-22784.13 24461.11,-22773.37"/>
<polygon fill="black" stroke="black" points="24462.47,-22770.14 24451.95,-22768.84 24459.36,-22776.41 24462.47,-22770.14"/>
</g>
<!-- m26_final -->
<g id="node319" class="node">
<title>m26_final</title>
<ellipse fill="lightpink" stroke="black" cx="24949.61" cy="-22420.98" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="24949.61" y="-22424.78" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="24949.61" y="-22409.78" font-family="Times,serif" font-size="14.00">GPU: 3738</text>
</g>
<!-- m26_res1&#45;&gt;m26_final -->
<g id="edge398" class="edge">
<title>m26_res1&#45;&gt;m26_final</title>
<path fill="none" stroke="black" d="M24609.71,-22980.95C24743.21,-22968.2 25005.61,-22920.8 25005.61,-22745.28 25005.61,-22745.28 25005.61,-22745.28 25005.61,-22632.32 25005.61,-22569 24981.62,-22498.45 24965.04,-22457.27"/>
<polygon fill="black" stroke="black" points="24968.25,-22455.87 24961.22,-22447.95 24961.78,-22458.53 24968.25,-22455.87"/>
</g>
<!-- m26_gate&#45;&gt;m26_route -->
<g id="edge389" class="edge">
<title>m26_gate&#45;&gt;m26_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24376.61,-22817.69C24376.61,-22809.25 24376.61,-22800.57 24376.61,-22792.26"/>
<polygon fill="black" stroke="black" points="24380.11,-22792 24376.61,-22782 24373.11,-22792 24380.11,-22792"/>
</g>
<!-- m26_expert0 -->
<g id="node315" class="node">
<title>m26_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="23459.61" cy="-22633.32" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="23459.61" y="-22644.62" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="23459.61" y="-22629.62" font-family="Times,serif" font-size="14.00">Node 184 GPU 0</text>
<text text-anchor="middle" x="23459.61" y="-22614.62" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m26_route&#45;&gt;m26_expert0 -->
<g id="edge391" class="edge">
<title>m26_route&#45;&gt;m26_expert0</title>
<path fill="none" stroke="black" d="M24282.15,-22732.09C24162.09,-22717.86 23948.46,-22692.54 23765.61,-22670.8 23738.41,-22667.57 23709.84,-22664.16 23681.54,-22660.79"/>
<polygon fill="black" stroke="black" points="23681.89,-22657.31 23671.55,-22659.6 23681.06,-22664.26 23681.89,-22657.31"/>
</g>
<!-- m26_expert1 -->
<g id="node316" class="node">
<title>m26_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="24070.61" cy="-22633.32" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="24070.61" y="-22644.62" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="24070.61" y="-22629.62" font-family="Times,serif" font-size="14.00">Node 184 GPU 1</text>
<text text-anchor="middle" x="24070.61" y="-22614.62" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m26_route&#45;&gt;m26_expert1 -->
<g id="edge393" class="edge">
<title>m26_route&#45;&gt;m26_expert1</title>
<path fill="none" stroke="black" d="M24305.26,-22717.87C24267.08,-22704.28 24219.32,-22687.27 24176.87,-22672.16"/>
<polygon fill="black" stroke="black" points="24177.93,-22668.82 24167.33,-22668.76 24175.58,-22675.41 24177.93,-22668.82"/>
</g>
<!-- m26_expert2 -->
<g id="node317" class="node">
<title>m26_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="24681.61" cy="-22633.32" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="24681.61" y="-22644.62" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="24681.61" y="-22629.62" font-family="Times,serif" font-size="14.00">Node 184 GPU 2</text>
<text text-anchor="middle" x="24681.61" y="-22614.62" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m26_route&#45;&gt;m26_expert2 -->
<g id="edge395" class="edge">
<title>m26_route&#45;&gt;m26_expert2</title>
<path fill="none" stroke="black" d="M24447.74,-22717.87C24485.78,-22704.28 24533.39,-22687.27 24575.7,-22672.16"/>
<polygon fill="black" stroke="black" points="24576.97,-22675.42 24585.21,-22668.76 24574.61,-22668.83 24576.97,-22675.42"/>
</g>
<!-- m26_agg -->
<g id="node318" class="node">
<title>m26_agg</title>
<polygon fill="purple" stroke="black" points="24540.23,-22559.85 24279.95,-22559.85 24213,-22483.85 24473.27,-22483.85 24540.23,-22559.85"/>
<text text-anchor="middle" x="24376.61" y="-22525.65" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="24376.61" y="-22510.65" font-family="Times,serif" font-size="14.00">GPU: 3738</text>
</g>
<!-- m26_expert0&#45;&gt;m26_agg -->
<g id="edge392" class="edge">
<title>m26_expert0&#45;&gt;m26_agg</title>
<path fill="none" stroke="black" d="M23671.14,-22607.07C23849.91,-22585.73 24100.08,-22555.86 24249.48,-22538.02"/>
<polygon fill="black" stroke="black" points="24250.1,-22541.48 24259.62,-22536.81 24249.27,-22534.52 24250.1,-22541.48"/>
</g>
<!-- m26_expert1&#45;&gt;m26_agg -->
<g id="edge394" class="edge">
<title>m26_expert1&#45;&gt;m26_agg</title>
<path fill="none" stroke="black" d="M24167.01,-22597.83C24199.3,-22586.28 24235.5,-22573.33 24268.62,-22561.48"/>
<polygon fill="black" stroke="black" points="24270.09,-22564.67 24278.33,-22558.01 24267.73,-22558.08 24270.09,-22564.67"/>
</g>
<!-- m26_expert2&#45;&gt;m26_agg -->
<g id="edge396" class="edge">
<title>m26_expert2&#45;&gt;m26_agg</title>
<path fill="none" stroke="black" d="M24585.53,-22597.83C24555.07,-22586.9 24521.11,-22574.71 24489.57,-22563.39"/>
<polygon fill="black" stroke="black" points="24490.47,-22559.99 24479.87,-22559.91 24488.1,-22566.58 24490.47,-22559.99"/>
</g>
<!-- m26_agg&#45;&gt;m26_final -->
<g id="edge397" class="edge">
<title>m26_agg&#45;&gt;m26_final</title>
<path fill="none" stroke="black" d="M24489.13,-22501.43C24595.17,-22483.14 24752.36,-22456.01 24852.9,-22438.66"/>
<polygon fill="black" stroke="black" points="24853.79,-22442.06 24863.05,-22436.91 24852.6,-22435.16 24853.79,-22442.06"/>
</g>
<!-- m27_res1 -->
<g id="node324" class="node">
<title>m27_res1</title>
<ellipse fill="lightpink" stroke="black" cx="25062.61" cy="-22331.24" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="25062.61" y="-22335.04" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="25062.61" y="-22320.04" font-family="Times,serif" font-size="14.00">GPU: 3739</text>
</g>
<!-- m26_final&#45;&gt;m27_res1 -->
<g id="edge403" class="edge">
<title>m26_final&#45;&gt;m27_res1</title>
<path fill="none" stroke="black" d="M24981.39,-22395.3C24994.6,-22385.05 25010.05,-22373.05 25023.9,-22362.29"/>
<polygon fill="black" stroke="black" points="25026.1,-22365.02 25031.85,-22356.12 25021.81,-22359.49 25026.1,-22365.02"/>
</g>
<!-- m27_ln1 -->
<g id="node320" class="node">
<title>m27_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="25176.61" cy="-22744.28" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="25176.61" y="-22748.08" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="25176.61" y="-22733.08" font-family="Times,serif" font-size="14.00">GPU: 3739</text>
</g>
<!-- m27_qkv -->
<g id="node321" class="node">
<title>m27_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="25176.61" cy="-22633.32" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="25176.61" y="-22637.12" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="25176.61" y="-22622.12" font-family="Times,serif" font-size="14.00">GPU: 3739</text>
</g>
<!-- m27_ln1&#45;&gt;m27_qkv -->
<g id="edge399" class="edge">
<title>m27_ln1&#45;&gt;m27_qkv</title>
<path fill="none" stroke="black" d="M25176.61,-22717.18C25176.61,-22703.16 25176.61,-22685.67 25176.61,-22670.38"/>
<polygon fill="black" stroke="black" points="25180.11,-22670.21 25176.61,-22660.21 25173.11,-22670.21 25180.11,-22670.21"/>
</g>
<!-- m27_mha -->
<g id="node322" class="node">
<title>m27_mha</title>
<ellipse fill="lightblue" stroke="black" cx="25176.61" cy="-22521.85" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="25176.61" y="-22525.65" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="25176.61" y="-22510.65" font-family="Times,serif" font-size="14.00">GPU: 3739</text>
</g>
<!-- m27_qkv&#45;&gt;m27_mha -->
<g id="edge400" class="edge">
<title>m27_qkv&#45;&gt;m27_mha</title>
<path fill="none" stroke="black" d="M25176.61,-22606.38C25176.61,-22592.3 25176.61,-22574.67 25176.61,-22559.24"/>
<polygon fill="black" stroke="black" points="25180.11,-22558.98 25176.61,-22548.98 25173.11,-22558.98 25180.11,-22558.98"/>
</g>
<!-- m27_out -->
<g id="node323" class="node">
<title>m27_out</title>
<ellipse fill="lightblue" stroke="black" cx="25176.61" cy="-22420.98" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="25176.61" y="-22424.78" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="25176.61" y="-22409.78" font-family="Times,serif" font-size="14.00">GPU: 3739</text>
</g>
<!-- m27_mha&#45;&gt;m27_out -->
<g id="edge401" class="edge">
<title>m27_mha&#45;&gt;m27_out</title>
<path fill="none" stroke="black" d="M25176.61,-22494.87C25176.61,-22483.72 25176.61,-22470.49 25176.61,-22458.39"/>
<polygon fill="black" stroke="black" points="25180.11,-22458.12 25176.61,-22448.12 25173.11,-22458.12 25180.11,-22458.12"/>
</g>
<!-- m27_out&#45;&gt;m27_res1 -->
<g id="edge402" class="edge">
<title>m27_out&#45;&gt;m27_res1</title>
<path fill="none" stroke="black" d="M25144.55,-22395.3C25131.23,-22385.05 25115.64,-22373.05 25101.66,-22362.29"/>
<polygon fill="black" stroke="black" points="25103.7,-22359.45 25093.64,-22356.12 25099.43,-22364.99 25103.7,-22359.45"/>
</g>
<!-- m27_gate -->
<g id="node325" class="node">
<title>m27_gate</title>
<polygon fill="orange" stroke="black" points="25034.23,-22268.37 24829.63,-22268.37 24777,-22162.37 24981.59,-22162.37 25034.23,-22268.37"/>
<text text-anchor="middle" x="24905.61" y="-22226.67" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="24905.61" y="-22211.67" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="24905.61" y="-22196.67" font-family="Times,serif" font-size="14.00">GPU: 3739</text>
</g>
<!-- m27_res1&#45;&gt;m27_gate -->
<g id="edge404" class="edge">
<title>m27_res1&#45;&gt;m27_gate</title>
<path fill="none" stroke="black" d="M25030.08,-22306.64C25017.08,-22297.21 25001.48,-22285.9 24985.79,-22274.52"/>
<polygon fill="black" stroke="black" points="24987.74,-22271.61 24977.59,-22268.57 24983.63,-22277.28 24987.74,-22271.61"/>
</g>
<!-- m27_route -->
<g id="node326" class="node">
<title>m27_route</title>
<ellipse fill="lightgray" stroke="black" cx="24905.61" cy="-22088.89" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="24905.61" y="-22100.19" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="24905.61" y="-22085.19" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="24905.61" y="-22070.19" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m27_res1&#45;&gt;m27_route -->
<g id="edge406" class="edge">
<title>m27_res1&#45;&gt;m27_route</title>
<path fill="none" stroke="black" d="M25066.67,-22304.39C25070.79,-22269.06 25072.92,-22205.22 25043.61,-22162.37 25030.5,-22143.2 25010.68,-22128.74 24990.11,-22117.99"/>
<polygon fill="black" stroke="black" points="24991.47,-22114.75 24980.95,-22113.45 24988.36,-22121.03 24991.47,-22114.75"/>
</g>
<!-- m27_final -->
<g id="node331" class="node">
<title>m27_final</title>
<ellipse fill="lightpink" stroke="black" cx="25479.61" cy="-21765.59" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="25479.61" y="-21769.39" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="25479.61" y="-21754.39" font-family="Times,serif" font-size="14.00">GPU: 3739</text>
</g>
<!-- m27_res1&#45;&gt;m27_final -->
<g id="edge414" class="edge">
<title>m27_res1&#45;&gt;m27_final</title>
<path fill="none" stroke="black" d="M25138.87,-22325.62C25272.66,-22312.96 25535.61,-22265.71 25535.61,-22089.89 25535.61,-22089.89 25535.61,-22089.89 25535.61,-21976.94 25535.61,-21913.61 25511.62,-21843.07 25495.04,-21801.88"/>
<polygon fill="black" stroke="black" points="25498.25,-21800.48 25491.22,-21792.56 25491.78,-21803.14 25498.25,-21800.48"/>
</g>
<!-- m27_gate&#45;&gt;m27_route -->
<g id="edge405" class="edge">
<title>m27_gate&#45;&gt;m27_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24905.61,-22162.3C24905.61,-22153.87 24905.61,-22145.18 24905.61,-22136.88"/>
<polygon fill="black" stroke="black" points="24909.11,-22136.62 24905.61,-22126.62 24902.11,-22136.62 24909.11,-22136.62"/>
</g>
<!-- m27_expert0 -->
<g id="node327" class="node">
<title>m27_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="23989.61" cy="-21977.94" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="23989.61" y="-21989.24" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="23989.61" y="-21974.24" font-family="Times,serif" font-size="14.00">Node 192 GPU 0</text>
<text text-anchor="middle" x="23989.61" y="-21959.24" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m27_route&#45;&gt;m27_expert0 -->
<g id="edge407" class="edge">
<title>m27_route&#45;&gt;m27_expert0</title>
<path fill="none" stroke="black" d="M24811.3,-22076.7C24691.44,-22062.47 24478.16,-22037.14 24295.61,-22015.41 24268.41,-22012.18 24239.84,-22008.77 24211.54,-22005.4"/>
<polygon fill="black" stroke="black" points="24211.89,-22001.92 24201.55,-22004.21 24211.06,-22008.87 24211.89,-22001.92"/>
</g>
<!-- m27_expert1 -->
<g id="node328" class="node">
<title>m27_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="24600.61" cy="-21977.94" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="24600.61" y="-21989.24" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="24600.61" y="-21974.24" font-family="Times,serif" font-size="14.00">Node 192 GPU 1</text>
<text text-anchor="middle" x="24600.61" y="-21959.24" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m27_route&#45;&gt;m27_expert1 -->
<g id="edge409" class="edge">
<title>m27_route&#45;&gt;m27_expert1</title>
<path fill="none" stroke="black" d="M24834.49,-22062.48C24796.44,-22048.89 24748.83,-22031.89 24706.52,-22016.77"/>
<polygon fill="black" stroke="black" points="24707.61,-22013.44 24697.02,-22013.38 24705.26,-22020.04 24707.61,-22013.44"/>
</g>
<!-- m27_expert2 -->
<g id="node329" class="node">
<title>m27_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="25211.61" cy="-21977.94" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="25211.61" y="-21989.24" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="25211.61" y="-21974.24" font-family="Times,serif" font-size="14.00">Node 192 GPU 2</text>
<text text-anchor="middle" x="25211.61" y="-21959.24" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m27_route&#45;&gt;m27_expert2 -->
<g id="edge411" class="edge">
<title>m27_route&#45;&gt;m27_expert2</title>
<path fill="none" stroke="black" d="M24976.97,-22062.48C25015.14,-22048.89 25062.9,-22031.89 25105.36,-22016.77"/>
<polygon fill="black" stroke="black" points="25106.64,-22020.03 25114.89,-22013.38 25104.3,-22013.43 25106.64,-22020.03"/>
</g>
<!-- m27_agg -->
<g id="node330" class="node">
<title>m27_agg</title>
<polygon fill="purple" stroke="black" points="25070.23,-21904.46 24809.95,-21904.46 24743,-21828.46 25003.27,-21828.46 25070.23,-21904.46"/>
<text text-anchor="middle" x="24906.61" y="-21870.26" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="24906.61" y="-21855.26" font-family="Times,serif" font-size="14.00">GPU: 3739</text>
</g>
<!-- m27_expert0&#45;&gt;m27_agg -->
<g id="edge408" class="edge">
<title>m27_expert0&#45;&gt;m27_agg</title>
<path fill="none" stroke="black" d="M24201.14,-21951.68C24379.91,-21930.34 24630.08,-21900.47 24779.48,-21882.64"/>
<polygon fill="black" stroke="black" points="24780.1,-21886.09 24789.62,-21881.43 24779.27,-21879.14 24780.1,-21886.09"/>
</g>
<!-- m27_expert1&#45;&gt;m27_agg -->
<g id="edge410" class="edge">
<title>m27_expert1&#45;&gt;m27_agg</title>
<path fill="none" stroke="black" d="M24697.01,-21942.45C24729.3,-21930.9 24765.5,-21917.94 24798.62,-21906.1"/>
<polygon fill="black" stroke="black" points="24800.09,-21909.29 24808.33,-21902.62 24797.73,-21902.7 24800.09,-21909.29"/>
</g>
<!-- m27_expert2&#45;&gt;m27_agg -->
<g id="edge412" class="edge">
<title>m27_expert2&#45;&gt;m27_agg</title>
<path fill="none" stroke="black" d="M25115.53,-21942.45C25085.07,-21931.51 25051.11,-21919.33 25019.57,-21908.01"/>
<polygon fill="black" stroke="black" points="25020.47,-21904.61 25009.87,-21904.52 25018.1,-21911.2 25020.47,-21904.61"/>
</g>
<!-- m27_agg&#45;&gt;m27_final -->
<g id="edge413" class="edge">
<title>m27_agg&#45;&gt;m27_final</title>
<path fill="none" stroke="black" d="M25019.13,-21846.04C25125.17,-21827.75 25282.36,-21800.62 25382.9,-21783.28"/>
<polygon fill="black" stroke="black" points="25383.79,-21786.68 25393.05,-21781.53 25382.6,-21779.78 25383.79,-21786.68"/>
</g>
<!-- m28_res1 -->
<g id="node336" class="node">
<title>m28_res1</title>
<ellipse fill="lightpink" stroke="black" cx="25592.61" cy="-21675.85" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="25592.61" y="-21679.65" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="25592.61" y="-21664.65" font-family="Times,serif" font-size="14.00">GPU: 3740</text>
</g>
<!-- m27_final&#45;&gt;m28_res1 -->
<g id="edge419" class="edge">
<title>m27_final&#45;&gt;m28_res1</title>
<path fill="none" stroke="black" d="M25511.39,-21739.92C25524.6,-21729.66 25540.05,-21717.67 25553.9,-21706.9"/>
<polygon fill="black" stroke="black" points="25556.1,-21709.63 25561.85,-21700.73 25551.81,-21704.1 25556.1,-21709.63"/>
</g>
<!-- m28_ln1 -->
<g id="node332" class="node">
<title>m28_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="25706.61" cy="-22088.89" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="25706.61" y="-22092.69" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="25706.61" y="-22077.69" font-family="Times,serif" font-size="14.00">GPU: 3740</text>
</g>
<!-- m28_qkv -->
<g id="node333" class="node">
<title>m28_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="25706.61" cy="-21977.94" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="25706.61" y="-21981.74" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="25706.61" y="-21966.74" font-family="Times,serif" font-size="14.00">GPU: 3740</text>
</g>
<!-- m28_ln1&#45;&gt;m28_qkv -->
<g id="edge415" class="edge">
<title>m28_ln1&#45;&gt;m28_qkv</title>
<path fill="none" stroke="black" d="M25706.61,-22061.79C25706.61,-22047.78 25706.61,-22030.29 25706.61,-22014.99"/>
<polygon fill="black" stroke="black" points="25710.11,-22014.82 25706.61,-22004.82 25703.11,-22014.82 25710.11,-22014.82"/>
</g>
<!-- m28_mha -->
<g id="node334" class="node">
<title>m28_mha</title>
<ellipse fill="lightblue" stroke="black" cx="25706.61" cy="-21866.46" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="25706.61" y="-21870.26" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="25706.61" y="-21855.26" font-family="Times,serif" font-size="14.00">GPU: 3740</text>
</g>
<!-- m28_qkv&#45;&gt;m28_mha -->
<g id="edge416" class="edge">
<title>m28_qkv&#45;&gt;m28_mha</title>
<path fill="none" stroke="black" d="M25706.61,-21950.99C25706.61,-21936.92 25706.61,-21919.29 25706.61,-21903.86"/>
<polygon fill="black" stroke="black" points="25710.11,-21903.6 25706.61,-21893.6 25703.11,-21903.6 25710.11,-21903.6"/>
</g>
<!-- m28_out -->
<g id="node335" class="node">
<title>m28_out</title>
<ellipse fill="lightblue" stroke="black" cx="25706.61" cy="-21765.59" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="25706.61" y="-21769.39" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="25706.61" y="-21754.39" font-family="Times,serif" font-size="14.00">GPU: 3740</text>
</g>
<!-- m28_mha&#45;&gt;m28_out -->
<g id="edge417" class="edge">
<title>m28_mha&#45;&gt;m28_out</title>
<path fill="none" stroke="black" d="M25706.61,-21839.48C25706.61,-21828.33 25706.61,-21815.11 25706.61,-21803"/>
<polygon fill="black" stroke="black" points="25710.11,-21802.74 25706.61,-21792.74 25703.11,-21802.74 25710.11,-21802.74"/>
</g>
<!-- m28_out&#45;&gt;m28_res1 -->
<g id="edge418" class="edge">
<title>m28_out&#45;&gt;m28_res1</title>
<path fill="none" stroke="black" d="M25674.55,-21739.92C25661.23,-21729.66 25645.64,-21717.67 25631.66,-21706.9"/>
<polygon fill="black" stroke="black" points="25633.7,-21704.06 25623.64,-21700.73 25629.43,-21709.61 25633.7,-21704.06"/>
</g>
<!-- m28_gate -->
<g id="node337" class="node">
<title>m28_gate</title>
<polygon fill="orange" stroke="black" points="25564.23,-21612.98 25359.63,-21612.98 25307,-21506.98 25511.59,-21506.98 25564.23,-21612.98"/>
<text text-anchor="middle" x="25435.61" y="-21571.28" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="25435.61" y="-21556.28" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="25435.61" y="-21541.28" font-family="Times,serif" font-size="14.00">GPU: 3740</text>
</g>
<!-- m28_res1&#45;&gt;m28_gate -->
<g id="edge420" class="edge">
<title>m28_res1&#45;&gt;m28_gate</title>
<path fill="none" stroke="black" d="M25560.08,-21651.26C25547.08,-21641.83 25531.48,-21630.51 25515.79,-21619.13"/>
<polygon fill="black" stroke="black" points="25517.74,-21616.22 25507.59,-21613.18 25513.63,-21621.89 25517.74,-21616.22"/>
</g>
<!-- m28_route -->
<g id="node338" class="node">
<title>m28_route</title>
<ellipse fill="lightgray" stroke="black" cx="25435.61" cy="-21433.5" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="25435.61" y="-21444.8" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="25435.61" y="-21429.8" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="25435.61" y="-21414.8" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m28_res1&#45;&gt;m28_route -->
<g id="edge422" class="edge">
<title>m28_res1&#45;&gt;m28_route</title>
<path fill="none" stroke="black" d="M25596.67,-21649C25600.79,-21613.67 25602.92,-21549.83 25573.61,-21506.98 25560.5,-21487.82 25540.68,-21473.36 25520.11,-21462.6"/>
<polygon fill="black" stroke="black" points="25521.47,-21459.37 25510.95,-21458.06 25518.36,-21465.64 25521.47,-21459.37"/>
</g>
<!-- m28_final -->
<g id="node343" class="node">
<title>m28_final</title>
<ellipse fill="lightpink" stroke="black" cx="26008.61" cy="-21110.2" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="26008.61" y="-21114" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="26008.61" y="-21099" font-family="Times,serif" font-size="14.00">GPU: 3740</text>
</g>
<!-- m28_res1&#45;&gt;m28_final -->
<g id="edge430" class="edge">
<title>m28_res1&#45;&gt;m28_final</title>
<path fill="none" stroke="black" d="M25668.71,-21670.18C25802.21,-21657.42 26064.61,-21610.03 26064.61,-21434.5 26064.61,-21434.5 26064.61,-21434.5 26064.61,-21321.55 26064.61,-21258.23 26040.62,-21187.68 26024.04,-21146.49"/>
<polygon fill="black" stroke="black" points="26027.25,-21145.1 26020.22,-21137.17 26020.78,-21147.75 26027.25,-21145.1"/>
</g>
<!-- m28_gate&#45;&gt;m28_route -->
<g id="edge421" class="edge">
<title>m28_gate&#45;&gt;m28_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25435.61,-21506.91C25435.61,-21498.48 25435.61,-21489.79 25435.61,-21481.49"/>
<polygon fill="black" stroke="black" points="25439.11,-21481.23 25435.61,-21471.23 25432.11,-21481.23 25439.11,-21481.23"/>
</g>
<!-- m28_expert0 -->
<g id="node339" class="node">
<title>m28_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="24518.61" cy="-21322.55" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="24518.61" y="-21333.85" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="24518.61" y="-21318.85" font-family="Times,serif" font-size="14.00">Node 200 GPU 0</text>
<text text-anchor="middle" x="24518.61" y="-21303.85" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m28_route&#45;&gt;m28_expert0 -->
<g id="edge423" class="edge">
<title>m28_route&#45;&gt;m28_expert0</title>
<path fill="none" stroke="black" d="M25341.15,-21421.31C25221.09,-21407.09 25007.46,-21381.77 24824.61,-21360.03 24797.41,-21356.79 24768.84,-21353.39 24740.54,-21350.02"/>
<polygon fill="black" stroke="black" points="24740.89,-21346.54 24730.55,-21348.83 24740.06,-21353.49 24740.89,-21346.54"/>
</g>
<!-- m28_expert1 -->
<g id="node340" class="node">
<title>m28_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="25129.61" cy="-21322.55" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="25129.61" y="-21333.85" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="25129.61" y="-21318.85" font-family="Times,serif" font-size="14.00">Node 200 GPU 1</text>
<text text-anchor="middle" x="25129.61" y="-21303.85" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m28_route&#45;&gt;m28_expert1 -->
<g id="edge425" class="edge">
<title>m28_route&#45;&gt;m28_expert1</title>
<path fill="none" stroke="black" d="M25364.26,-21407.1C25326.08,-21393.5 25278.32,-21376.5 25235.87,-21361.38"/>
<polygon fill="black" stroke="black" points="25236.93,-21358.05 25226.33,-21357.99 25234.58,-21364.64 25236.93,-21358.05"/>
</g>
<!-- m28_expert2 -->
<g id="node341" class="node">
<title>m28_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="25740.61" cy="-21322.55" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="25740.61" y="-21333.85" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="25740.61" y="-21318.85" font-family="Times,serif" font-size="14.00">Node 200 GPU 2</text>
<text text-anchor="middle" x="25740.61" y="-21303.85" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m28_route&#45;&gt;m28_expert2 -->
<g id="edge427" class="edge">
<title>m28_route&#45;&gt;m28_expert2</title>
<path fill="none" stroke="black" d="M25506.74,-21407.1C25544.78,-21393.5 25592.39,-21376.5 25634.7,-21361.38"/>
<polygon fill="black" stroke="black" points="25635.97,-21364.65 25644.21,-21357.99 25633.61,-21358.06 25635.97,-21364.65"/>
</g>
<!-- m28_agg -->
<g id="node342" class="node">
<title>m28_agg</title>
<polygon fill="purple" stroke="black" points="25599.23,-21249.07 25338.95,-21249.07 25272,-21173.07 25532.27,-21173.07 25599.23,-21249.07"/>
<text text-anchor="middle" x="25435.61" y="-21214.87" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="25435.61" y="-21199.87" font-family="Times,serif" font-size="14.00">GPU: 3740</text>
</g>
<!-- m28_expert0&#45;&gt;m28_agg -->
<g id="edge424" class="edge">
<title>m28_expert0&#45;&gt;m28_agg</title>
<path fill="none" stroke="black" d="M24730.14,-21296.3C24908.91,-21274.95 25159.08,-21245.09 25308.48,-21227.25"/>
<polygon fill="black" stroke="black" points="25309.1,-21230.7 25318.62,-21226.04 25308.27,-21223.75 25309.1,-21230.7"/>
</g>
<!-- m28_expert1&#45;&gt;m28_agg -->
<g id="edge426" class="edge">
<title>m28_expert1&#45;&gt;m28_agg</title>
<path fill="none" stroke="black" d="M25226.01,-21287.06C25258.3,-21275.51 25294.5,-21262.56 25327.62,-21250.71"/>
<polygon fill="black" stroke="black" points="25329.09,-21253.9 25337.33,-21247.24 25326.73,-21247.31 25329.09,-21253.9"/>
</g>
<!-- m28_expert2&#45;&gt;m28_agg -->
<g id="edge428" class="edge">
<title>m28_expert2&#45;&gt;m28_agg</title>
<path fill="none" stroke="black" d="M25644.53,-21287.06C25614.07,-21276.13 25580.11,-21263.94 25548.57,-21252.62"/>
<polygon fill="black" stroke="black" points="25549.47,-21249.22 25538.87,-21249.14 25547.1,-21255.81 25549.47,-21249.22"/>
</g>
<!-- m28_agg&#45;&gt;m28_final -->
<g id="edge429" class="edge">
<title>m28_agg&#45;&gt;m28_final</title>
<path fill="none" stroke="black" d="M25548.13,-21190.66C25654.17,-21172.36 25811.36,-21145.24 25911.9,-21127.89"/>
<polygon fill="black" stroke="black" points="25912.79,-21131.29 25922.05,-21126.14 25911.6,-21124.39 25912.79,-21131.29"/>
</g>
<!-- m29_res1 -->
<g id="node348" class="node">
<title>m29_res1</title>
<ellipse fill="lightpink" stroke="black" cx="26121.61" cy="-21020.46" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="26121.61" y="-21024.26" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="26121.61" y="-21009.26" font-family="Times,serif" font-size="14.00">GPU: 3741</text>
</g>
<!-- m28_final&#45;&gt;m29_res1 -->
<g id="edge435" class="edge">
<title>m28_final&#45;&gt;m29_res1</title>
<path fill="none" stroke="black" d="M26040.39,-21084.53C26053.6,-21074.28 26069.05,-21062.28 26082.9,-21051.52"/>
<polygon fill="black" stroke="black" points="26085.1,-21054.24 26090.85,-21045.35 26080.81,-21048.72 26085.1,-21054.24"/>
</g>
<!-- m29_ln1 -->
<g id="node344" class="node">
<title>m29_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="26235.61" cy="-21433.5" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="26235.61" y="-21437.3" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26235.61" y="-21422.3" font-family="Times,serif" font-size="14.00">GPU: 3741</text>
</g>
<!-- m29_qkv -->
<g id="node345" class="node">
<title>m29_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="26235.61" cy="-21322.55" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="26235.61" y="-21326.35" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="26235.61" y="-21311.35" font-family="Times,serif" font-size="14.00">GPU: 3741</text>
</g>
<!-- m29_ln1&#45;&gt;m29_qkv -->
<g id="edge431" class="edge">
<title>m29_ln1&#45;&gt;m29_qkv</title>
<path fill="none" stroke="black" d="M26235.61,-21406.41C26235.61,-21392.39 26235.61,-21374.9 26235.61,-21359.6"/>
<polygon fill="black" stroke="black" points="26239.11,-21359.43 26235.61,-21349.43 26232.11,-21359.43 26239.11,-21359.43"/>
</g>
<!-- m29_mha -->
<g id="node346" class="node">
<title>m29_mha</title>
<ellipse fill="lightblue" stroke="black" cx="26235.61" cy="-21211.07" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="26235.61" y="-21214.87" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="26235.61" y="-21199.87" font-family="Times,serif" font-size="14.00">GPU: 3741</text>
</g>
<!-- m29_qkv&#45;&gt;m29_mha -->
<g id="edge432" class="edge">
<title>m29_qkv&#45;&gt;m29_mha</title>
<path fill="none" stroke="black" d="M26235.61,-21295.61C26235.61,-21281.53 26235.61,-21263.9 26235.61,-21248.47"/>
<polygon fill="black" stroke="black" points="26239.11,-21248.21 26235.61,-21238.21 26232.11,-21248.21 26239.11,-21248.21"/>
</g>
<!-- m29_out -->
<g id="node347" class="node">
<title>m29_out</title>
<ellipse fill="lightblue" stroke="black" cx="26235.61" cy="-21110.2" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="26235.61" y="-21114" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="26235.61" y="-21099" font-family="Times,serif" font-size="14.00">GPU: 3741</text>
</g>
<!-- m29_mha&#45;&gt;m29_out -->
<g id="edge433" class="edge">
<title>m29_mha&#45;&gt;m29_out</title>
<path fill="none" stroke="black" d="M26235.61,-21184.1C26235.61,-21172.94 26235.61,-21159.72 26235.61,-21147.62"/>
<polygon fill="black" stroke="black" points="26239.11,-21147.35 26235.61,-21137.35 26232.11,-21147.35 26239.11,-21147.35"/>
</g>
<!-- m29_out&#45;&gt;m29_res1 -->
<g id="edge434" class="edge">
<title>m29_out&#45;&gt;m29_res1</title>
<path fill="none" stroke="black" d="M26203.55,-21084.53C26190.23,-21074.28 26174.64,-21062.28 26160.66,-21051.52"/>
<polygon fill="black" stroke="black" points="26162.7,-21048.67 26152.64,-21045.35 26158.43,-21054.22 26162.7,-21048.67"/>
</g>
<!-- m29_gate -->
<g id="node349" class="node">
<title>m29_gate</title>
<polygon fill="orange" stroke="black" points="26093.23,-20957.59 25888.63,-20957.59 25836,-20851.59 26040.59,-20851.59 26093.23,-20957.59"/>
<text text-anchor="middle" x="25964.61" y="-20915.89" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="25964.61" y="-20900.89" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="25964.61" y="-20885.89" font-family="Times,serif" font-size="14.00">GPU: 3741</text>
</g>
<!-- m29_res1&#45;&gt;m29_gate -->
<g id="edge436" class="edge">
<title>m29_res1&#45;&gt;m29_gate</title>
<path fill="none" stroke="black" d="M26089.08,-20995.87C26076.08,-20986.44 26060.48,-20975.12 26044.79,-20963.74"/>
<polygon fill="black" stroke="black" points="26046.74,-20960.84 26036.59,-20957.8 26042.63,-20966.5 26046.74,-20960.84"/>
</g>
<!-- m29_route -->
<g id="node350" class="node">
<title>m29_route</title>
<ellipse fill="lightgray" stroke="black" cx="25964.61" cy="-20778.12" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="25964.61" y="-20789.42" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="25964.61" y="-20774.42" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="25964.61" y="-20759.42" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m29_res1&#45;&gt;m29_route -->
<g id="edge438" class="edge">
<title>m29_res1&#45;&gt;m29_route</title>
<path fill="none" stroke="black" d="M26125.67,-20993.61C26129.79,-20958.29 26131.92,-20894.44 26102.61,-20851.59 26089.5,-20832.43 26069.68,-20817.97 26049.11,-20807.21"/>
<polygon fill="black" stroke="black" points="26050.47,-20803.98 26039.95,-20802.68 26047.36,-20810.25 26050.47,-20803.98"/>
</g>
<!-- m29_final -->
<g id="node355" class="node">
<title>m29_final</title>
<ellipse fill="lightpink" stroke="black" cx="26538.61" cy="-20454.82" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="26538.61" y="-20458.62" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="26538.61" y="-20443.62" font-family="Times,serif" font-size="14.00">GPU: 3741</text>
</g>
<!-- m29_res1&#45;&gt;m29_final -->
<g id="edge446" class="edge">
<title>m29_res1&#45;&gt;m29_final</title>
<path fill="none" stroke="black" d="M26197.87,-21014.85C26331.66,-21002.19 26594.61,-20954.93 26594.61,-20779.12 26594.61,-20779.12 26594.61,-20779.12 26594.61,-20666.16 26594.61,-20602.84 26570.62,-20532.29 26554.04,-20491.11"/>
<polygon fill="black" stroke="black" points="26557.25,-20489.71 26550.22,-20481.79 26550.78,-20492.37 26557.25,-20489.71"/>
</g>
<!-- m29_gate&#45;&gt;m29_route -->
<g id="edge437" class="edge">
<title>m29_gate&#45;&gt;m29_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25964.61,-20851.52C25964.61,-20843.09 25964.61,-20834.41 25964.61,-20826.1"/>
<polygon fill="black" stroke="black" points="25968.11,-20825.84 25964.61,-20815.84 25961.11,-20825.84 25968.11,-20825.84"/>
</g>
<!-- m29_expert0 -->
<g id="node351" class="node">
<title>m29_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="25048.61" cy="-20667.16" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="25048.61" y="-20678.46" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="25048.61" y="-20663.46" font-family="Times,serif" font-size="14.00">Node 208 GPU 0</text>
<text text-anchor="middle" x="25048.61" y="-20648.46" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m29_route&#45;&gt;m29_expert0 -->
<g id="edge439" class="edge">
<title>m29_route&#45;&gt;m29_expert0</title>
<path fill="none" stroke="black" d="M25870.3,-20765.92C25750.44,-20751.69 25537.16,-20726.36 25354.61,-20704.64 25327.41,-20701.4 25298.84,-20698 25270.54,-20694.63"/>
<polygon fill="black" stroke="black" points="25270.89,-20691.15 25260.55,-20693.44 25270.06,-20698.1 25270.89,-20691.15"/>
</g>
<!-- m29_expert1 -->
<g id="node352" class="node">
<title>m29_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="25659.61" cy="-20667.16" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="25659.61" y="-20678.46" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="25659.61" y="-20663.46" font-family="Times,serif" font-size="14.00">Node 208 GPU 1</text>
<text text-anchor="middle" x="25659.61" y="-20648.46" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m29_route&#45;&gt;m29_expert1 -->
<g id="edge441" class="edge">
<title>m29_route&#45;&gt;m29_expert1</title>
<path fill="none" stroke="black" d="M25893.49,-20751.71C25855.44,-20738.12 25807.83,-20721.11 25765.52,-20706"/>
<polygon fill="black" stroke="black" points="25766.61,-20702.67 25756.02,-20702.6 25764.26,-20709.26 25766.61,-20702.67"/>
</g>
<!-- m29_expert2 -->
<g id="node353" class="node">
<title>m29_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="26270.61" cy="-20667.16" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="26270.61" y="-20678.46" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="26270.61" y="-20663.46" font-family="Times,serif" font-size="14.00">Node 208 GPU 2</text>
<text text-anchor="middle" x="26270.61" y="-20648.46" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m29_route&#45;&gt;m29_expert2 -->
<g id="edge443" class="edge">
<title>m29_route&#45;&gt;m29_expert2</title>
<path fill="none" stroke="black" d="M26035.97,-20751.71C26074.14,-20738.12 26121.9,-20721.11 26164.36,-20706"/>
<polygon fill="black" stroke="black" points="26165.64,-20709.25 26173.89,-20702.6 26163.3,-20702.66 26165.64,-20709.25"/>
</g>
<!-- m29_agg -->
<g id="node354" class="node">
<title>m29_agg</title>
<polygon fill="purple" stroke="black" points="26129.23,-20593.69 25868.95,-20593.69 25802,-20517.69 26062.27,-20517.69 26129.23,-20593.69"/>
<text text-anchor="middle" x="25965.61" y="-20559.49" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="25965.61" y="-20544.49" font-family="Times,serif" font-size="14.00">GPU: 3741</text>
</g>
<!-- m29_expert0&#45;&gt;m29_agg -->
<g id="edge440" class="edge">
<title>m29_expert0&#45;&gt;m29_agg</title>
<path fill="none" stroke="black" d="M25260.14,-20640.91C25438.91,-20619.57 25689.08,-20589.7 25838.48,-20571.86"/>
<polygon fill="black" stroke="black" points="25839.1,-20575.31 25848.62,-20570.65 25838.27,-20568.36 25839.1,-20575.31"/>
</g>
<!-- m29_expert1&#45;&gt;m29_agg -->
<g id="edge442" class="edge">
<title>m29_expert1&#45;&gt;m29_agg</title>
<path fill="none" stroke="black" d="M25756.01,-20631.67C25788.3,-20620.12 25824.5,-20607.17 25857.62,-20595.32"/>
<polygon fill="black" stroke="black" points="25859.09,-20598.51 25867.33,-20591.85 25856.73,-20591.92 25859.09,-20598.51"/>
</g>
<!-- m29_expert2&#45;&gt;m29_agg -->
<g id="edge444" class="edge">
<title>m29_expert2&#45;&gt;m29_agg</title>
<path fill="none" stroke="black" d="M26174.53,-20631.67C26144.07,-20620.74 26110.11,-20608.55 26078.57,-20597.23"/>
<polygon fill="black" stroke="black" points="26079.47,-20593.83 26068.87,-20593.75 26077.1,-20600.42 26079.47,-20593.83"/>
</g>
<!-- m29_agg&#45;&gt;m29_final -->
<g id="edge445" class="edge">
<title>m29_agg&#45;&gt;m29_final</title>
<path fill="none" stroke="black" d="M26078.13,-20535.27C26184.17,-20516.98 26341.36,-20489.85 26441.9,-20472.5"/>
<polygon fill="black" stroke="black" points="26442.79,-20475.9 26452.05,-20470.75 26441.6,-20469 26442.79,-20475.9"/>
</g>
<!-- m30_res1 -->
<g id="node360" class="node">
<title>m30_res1</title>
<ellipse fill="lightpink" stroke="black" cx="26651.61" cy="-20365.08" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="26651.61" y="-20368.88" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="26651.61" y="-20353.88" font-family="Times,serif" font-size="14.00">GPU: 3742</text>
</g>
<!-- m29_final&#45;&gt;m30_res1 -->
<g id="edge451" class="edge">
<title>m29_final&#45;&gt;m30_res1</title>
<path fill="none" stroke="black" d="M26570.39,-20429.14C26583.6,-20418.89 26599.05,-20406.89 26612.9,-20396.13"/>
<polygon fill="black" stroke="black" points="26615.1,-20398.86 26620.85,-20389.96 26610.81,-20393.33 26615.1,-20398.86"/>
</g>
<!-- m30_ln1 -->
<g id="node356" class="node">
<title>m30_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="26765.61" cy="-20778.12" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="26765.61" y="-20781.92" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="26765.61" y="-20766.92" font-family="Times,serif" font-size="14.00">GPU: 3742</text>
</g>
<!-- m30_qkv -->
<g id="node357" class="node">
<title>m30_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="26765.61" cy="-20667.16" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="26765.61" y="-20670.96" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="26765.61" y="-20655.96" font-family="Times,serif" font-size="14.00">GPU: 3742</text>
</g>
<!-- m30_ln1&#45;&gt;m30_qkv -->
<g id="edge447" class="edge">
<title>m30_ln1&#45;&gt;m30_qkv</title>
<path fill="none" stroke="black" d="M26765.61,-20751.02C26765.61,-20737 26765.61,-20719.51 26765.61,-20704.22"/>
<polygon fill="black" stroke="black" points="26769.11,-20704.05 26765.61,-20694.05 26762.11,-20704.05 26769.11,-20704.05"/>
</g>
<!-- m30_mha -->
<g id="node358" class="node">
<title>m30_mha</title>
<ellipse fill="lightblue" stroke="black" cx="26765.61" cy="-20555.69" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="26765.61" y="-20559.49" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="26765.61" y="-20544.49" font-family="Times,serif" font-size="14.00">GPU: 3742</text>
</g>
<!-- m30_qkv&#45;&gt;m30_mha -->
<g id="edge448" class="edge">
<title>m30_qkv&#45;&gt;m30_mha</title>
<path fill="none" stroke="black" d="M26765.61,-20640.22C26765.61,-20626.14 26765.61,-20608.51 26765.61,-20593.08"/>
<polygon fill="black" stroke="black" points="26769.11,-20592.82 26765.61,-20582.82 26762.11,-20592.82 26769.11,-20592.82"/>
</g>
<!-- m30_out -->
<g id="node359" class="node">
<title>m30_out</title>
<ellipse fill="lightblue" stroke="black" cx="26765.61" cy="-20454.82" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="26765.61" y="-20458.62" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="26765.61" y="-20443.62" font-family="Times,serif" font-size="14.00">GPU: 3742</text>
</g>
<!-- m30_mha&#45;&gt;m30_out -->
<g id="edge449" class="edge">
<title>m30_mha&#45;&gt;m30_out</title>
<path fill="none" stroke="black" d="M26765.61,-20528.71C26765.61,-20517.56 26765.61,-20504.33 26765.61,-20492.23"/>
<polygon fill="black" stroke="black" points="26769.11,-20491.96 26765.61,-20481.96 26762.11,-20491.96 26769.11,-20491.96"/>
</g>
<!-- m30_out&#45;&gt;m30_res1 -->
<g id="edge450" class="edge">
<title>m30_out&#45;&gt;m30_res1</title>
<path fill="none" stroke="black" d="M26733.55,-20429.14C26720.23,-20418.89 26704.64,-20406.89 26690.66,-20396.13"/>
<polygon fill="black" stroke="black" points="26692.7,-20393.29 26682.64,-20389.96 26688.43,-20398.83 26692.7,-20393.29"/>
</g>
<!-- m30_gate -->
<g id="node361" class="node">
<title>m30_gate</title>
<polygon fill="orange" stroke="black" points="26623.23,-20302.21 26418.63,-20302.21 26366,-20196.21 26570.59,-20196.21 26623.23,-20302.21"/>
<text text-anchor="middle" x="26494.61" y="-20260.51" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="26494.61" y="-20245.51" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="26494.61" y="-20230.51" font-family="Times,serif" font-size="14.00">GPU: 3742</text>
</g>
<!-- m30_res1&#45;&gt;m30_gate -->
<g id="edge452" class="edge">
<title>m30_res1&#45;&gt;m30_gate</title>
<path fill="none" stroke="black" d="M26619.08,-20340.48C26606.08,-20331.05 26590.48,-20319.74 26574.79,-20308.36"/>
<polygon fill="black" stroke="black" points="26576.74,-20305.45 26566.59,-20302.41 26572.63,-20311.11 26576.74,-20305.45"/>
</g>
<!-- m30_route -->
<g id="node362" class="node">
<title>m30_route</title>
<ellipse fill="lightgray" stroke="black" cx="26494.61" cy="-20122.73" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="26494.61" y="-20134.03" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="26494.61" y="-20119.03" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="26494.61" y="-20104.03" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m30_res1&#45;&gt;m30_route -->
<g id="edge454" class="edge">
<title>m30_res1&#45;&gt;m30_route</title>
<path fill="none" stroke="black" d="M26655.67,-20338.23C26659.79,-20302.9 26661.92,-20239.05 26632.61,-20196.21 26619.5,-20177.04 26599.68,-20162.58 26579.11,-20151.83"/>
<polygon fill="black" stroke="black" points="26580.47,-20148.59 26569.95,-20147.29 26577.36,-20154.86 26580.47,-20148.59"/>
</g>
<!-- m30_final -->
<g id="node367" class="node">
<title>m30_final</title>
<ellipse fill="lightpink" stroke="black" cx="27068.61" cy="-19799.43" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="27068.61" y="-19803.23" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="27068.61" y="-19788.23" font-family="Times,serif" font-size="14.00">GPU: 3742</text>
</g>
<!-- m30_res1&#45;&gt;m30_final -->
<g id="edge462" class="edge">
<title>m30_res1&#45;&gt;m30_final</title>
<path fill="none" stroke="black" d="M26727.87,-20359.46C26861.66,-20346.8 27124.61,-20299.55 27124.61,-20123.73 27124.61,-20123.73 27124.61,-20123.73 27124.61,-20010.78 27124.61,-19947.45 27100.62,-19876.9 27084.04,-19835.72"/>
<polygon fill="black" stroke="black" points="27087.25,-19834.32 27080.22,-19826.4 27080.78,-19836.98 27087.25,-19834.32"/>
</g>
<!-- m30_gate&#45;&gt;m30_route -->
<g id="edge453" class="edge">
<title>m30_gate&#45;&gt;m30_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26494.61,-20196.14C26494.61,-20187.71 26494.61,-20179.02 26494.61,-20170.72"/>
<polygon fill="black" stroke="black" points="26498.11,-20170.46 26494.61,-20160.46 26491.11,-20170.46 26498.11,-20170.46"/>
</g>
<!-- m30_expert0 -->
<g id="node363" class="node">
<title>m30_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="25578.61" cy="-20011.78" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="25578.61" y="-20023.08" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="25578.61" y="-20008.08" font-family="Times,serif" font-size="14.00">Node 216 GPU 0</text>
<text text-anchor="middle" x="25578.61" y="-19993.08" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m30_route&#45;&gt;m30_expert0 -->
<g id="edge455" class="edge">
<title>m30_route&#45;&gt;m30_expert0</title>
<path fill="none" stroke="black" d="M26400.3,-20110.54C26280.44,-20096.31 26067.16,-20070.98 25884.61,-20049.25 25857.41,-20046.01 25828.84,-20042.61 25800.54,-20039.24"/>
<polygon fill="black" stroke="black" points="25800.89,-20035.76 25790.55,-20038.05 25800.06,-20042.71 25800.89,-20035.76"/>
</g>
<!-- m30_expert1 -->
<g id="node364" class="node">
<title>m30_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="26189.61" cy="-20011.78" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="26189.61" y="-20023.08" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="26189.61" y="-20008.08" font-family="Times,serif" font-size="14.00">Node 216 GPU 1</text>
<text text-anchor="middle" x="26189.61" y="-19993.08" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m30_route&#45;&gt;m30_expert1 -->
<g id="edge457" class="edge">
<title>m30_route&#45;&gt;m30_expert1</title>
<path fill="none" stroke="black" d="M26423.49,-20096.32C26385.44,-20082.73 26337.83,-20065.72 26295.52,-20050.61"/>
<polygon fill="black" stroke="black" points="26296.61,-20047.28 26286.02,-20047.21 26294.26,-20053.87 26296.61,-20047.28"/>
</g>
<!-- m30_expert2 -->
<g id="node365" class="node">
<title>m30_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="26800.61" cy="-20011.78" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="26800.61" y="-20023.08" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="26800.61" y="-20008.08" font-family="Times,serif" font-size="14.00">Node 216 GPU 2</text>
<text text-anchor="middle" x="26800.61" y="-19993.08" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m30_route&#45;&gt;m30_expert2 -->
<g id="edge459" class="edge">
<title>m30_route&#45;&gt;m30_expert2</title>
<path fill="none" stroke="black" d="M26565.97,-20096.32C26604.14,-20082.73 26651.9,-20065.72 26694.36,-20050.61"/>
<polygon fill="black" stroke="black" points="26695.64,-20053.87 26703.89,-20047.21 26693.3,-20047.27 26695.64,-20053.87"/>
</g>
<!-- m30_agg -->
<g id="node366" class="node">
<title>m30_agg</title>
<polygon fill="purple" stroke="black" points="26659.23,-19938.3 26398.95,-19938.3 26332,-19862.3 26592.27,-19862.3 26659.23,-19938.3"/>
<text text-anchor="middle" x="26495.61" y="-19904.1" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="26495.61" y="-19889.1" font-family="Times,serif" font-size="14.00">GPU: 3742</text>
</g>
<!-- m30_expert0&#45;&gt;m30_agg -->
<g id="edge456" class="edge">
<title>m30_expert0&#45;&gt;m30_agg</title>
<path fill="none" stroke="black" d="M25790.14,-19985.52C25968.91,-19964.18 26219.08,-19934.31 26368.48,-19916.48"/>
<polygon fill="black" stroke="black" points="26369.1,-19919.93 26378.62,-19915.27 26368.27,-19912.98 26369.1,-19919.93"/>
</g>
<!-- m30_expert1&#45;&gt;m30_agg -->
<g id="edge458" class="edge">
<title>m30_expert1&#45;&gt;m30_agg</title>
<path fill="none" stroke="black" d="M26286.01,-19976.29C26318.3,-19964.74 26354.5,-19951.78 26387.62,-19939.94"/>
<polygon fill="black" stroke="black" points="26389.09,-19943.13 26397.33,-19936.46 26386.73,-19936.54 26389.09,-19943.13"/>
</g>
<!-- m30_expert2&#45;&gt;m30_agg -->
<g id="edge460" class="edge">
<title>m30_expert2&#45;&gt;m30_agg</title>
<path fill="none" stroke="black" d="M26704.53,-19976.29C26674.07,-19965.35 26640.11,-19953.16 26608.57,-19941.85"/>
<polygon fill="black" stroke="black" points="26609.47,-19938.45 26598.87,-19938.36 26607.1,-19945.04 26609.47,-19938.45"/>
</g>
<!-- m30_agg&#45;&gt;m30_final -->
<g id="edge461" class="edge">
<title>m30_agg&#45;&gt;m30_final</title>
<path fill="none" stroke="black" d="M26608.13,-19879.88C26714.17,-19861.59 26871.36,-19834.46 26971.9,-19817.12"/>
<polygon fill="black" stroke="black" points="26972.79,-19820.51 26982.05,-19815.37 26971.6,-19813.62 26972.79,-19820.51"/>
</g>
<!-- m31_res1 -->
<g id="node372" class="node">
<title>m31_res1</title>
<ellipse fill="lightpink" stroke="black" cx="27181.61" cy="-19709.69" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="27181.61" y="-19713.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="27181.61" y="-19698.49" font-family="Times,serif" font-size="14.00">GPU: 3743</text>
</g>
<!-- m30_final&#45;&gt;m31_res1 -->
<g id="edge467" class="edge">
<title>m30_final&#45;&gt;m31_res1</title>
<path fill="none" stroke="black" d="M27100.39,-19773.76C27113.6,-19763.5 27129.05,-19751.51 27142.9,-19740.74"/>
<polygon fill="black" stroke="black" points="27145.1,-19743.47 27150.85,-19734.57 27140.81,-19737.94 27145.1,-19743.47"/>
</g>
<!-- m31_ln1 -->
<g id="node368" class="node">
<title>m31_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="27295.61" cy="-20122.73" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="27295.61" y="-20126.53" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="27295.61" y="-20111.53" font-family="Times,serif" font-size="14.00">GPU: 3743</text>
</g>
<!-- m31_qkv -->
<g id="node369" class="node">
<title>m31_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="27295.61" cy="-20011.78" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="27295.61" y="-20015.58" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="27295.61" y="-20000.58" font-family="Times,serif" font-size="14.00">GPU: 3743</text>
</g>
<!-- m31_ln1&#45;&gt;m31_qkv -->
<g id="edge463" class="edge">
<title>m31_ln1&#45;&gt;m31_qkv</title>
<path fill="none" stroke="black" d="M27295.61,-20095.63C27295.61,-20081.62 27295.61,-20064.12 27295.61,-20048.83"/>
<polygon fill="black" stroke="black" points="27299.11,-20048.66 27295.61,-20038.66 27292.11,-20048.66 27299.11,-20048.66"/>
</g>
<!-- m31_mha -->
<g id="node370" class="node">
<title>m31_mha</title>
<ellipse fill="lightblue" stroke="black" cx="27295.61" cy="-19900.3" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="27295.61" y="-19904.1" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="27295.61" y="-19889.1" font-family="Times,serif" font-size="14.00">GPU: 3743</text>
</g>
<!-- m31_qkv&#45;&gt;m31_mha -->
<g id="edge464" class="edge">
<title>m31_qkv&#45;&gt;m31_mha</title>
<path fill="none" stroke="black" d="M27295.61,-19984.83C27295.61,-19970.76 27295.61,-19953.13 27295.61,-19937.7"/>
<polygon fill="black" stroke="black" points="27299.11,-19937.44 27295.61,-19927.44 27292.11,-19937.44 27299.11,-19937.44"/>
</g>
<!-- m31_out -->
<g id="node371" class="node">
<title>m31_out</title>
<ellipse fill="lightblue" stroke="black" cx="27295.61" cy="-19799.43" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="27295.61" y="-19803.23" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="27295.61" y="-19788.23" font-family="Times,serif" font-size="14.00">GPU: 3743</text>
</g>
<!-- m31_mha&#45;&gt;m31_out -->
<g id="edge465" class="edge">
<title>m31_mha&#45;&gt;m31_out</title>
<path fill="none" stroke="black" d="M27295.61,-19873.32C27295.61,-19862.17 27295.61,-19848.95 27295.61,-19836.84"/>
<polygon fill="black" stroke="black" points="27299.11,-19836.58 27295.61,-19826.58 27292.11,-19836.58 27299.11,-19836.58"/>
</g>
<!-- m31_out&#45;&gt;m31_res1 -->
<g id="edge466" class="edge">
<title>m31_out&#45;&gt;m31_res1</title>
<path fill="none" stroke="black" d="M27263.55,-19773.76C27250.23,-19763.5 27234.64,-19751.51 27220.66,-19740.74"/>
<polygon fill="black" stroke="black" points="27222.7,-19737.9 27212.64,-19734.57 27218.43,-19743.45 27222.7,-19737.9"/>
</g>
<!-- m31_gate -->
<g id="node373" class="node">
<title>m31_gate</title>
<polygon fill="orange" stroke="black" points="27153.23,-19646.82 26948.63,-19646.82 26896,-19540.82 27100.59,-19540.82 27153.23,-19646.82"/>
<text text-anchor="middle" x="27024.61" y="-19605.12" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="27024.61" y="-19590.12" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="27024.61" y="-19575.12" font-family="Times,serif" font-size="14.00">GPU: 3743</text>
</g>
<!-- m31_res1&#45;&gt;m31_gate -->
<g id="edge468" class="edge">
<title>m31_res1&#45;&gt;m31_gate</title>
<path fill="none" stroke="black" d="M27149.08,-19685.1C27136.08,-19675.66 27120.48,-19664.35 27104.79,-19652.97"/>
<polygon fill="black" stroke="black" points="27106.74,-19650.06 27096.59,-19647.02 27102.63,-19655.73 27106.74,-19650.06"/>
</g>
<!-- m31_route -->
<g id="node374" class="node">
<title>m31_route</title>
<ellipse fill="lightgray" stroke="black" cx="27024.61" cy="-19467.34" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="27024.61" y="-19478.64" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="27024.61" y="-19463.64" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="27024.61" y="-19448.64" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m31_res1&#45;&gt;m31_route -->
<g id="edge470" class="edge">
<title>m31_res1&#45;&gt;m31_route</title>
<path fill="none" stroke="black" d="M27185.67,-19682.84C27189.79,-19647.51 27191.92,-19583.67 27162.61,-19540.82 27149.5,-19521.65 27129.68,-19507.19 27109.11,-19496.44"/>
<polygon fill="black" stroke="black" points="27110.47,-19493.2 27099.95,-19491.9 27107.36,-19499.48 27110.47,-19493.2"/>
</g>
<!-- m31_final -->
<g id="node379" class="node">
<title>m31_final</title>
<ellipse fill="lightpink" stroke="black" cx="27597.61" cy="-19144.04" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="27597.61" y="-19147.84" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="27597.61" y="-19132.84" font-family="Times,serif" font-size="14.00">GPU: 3743</text>
</g>
<!-- m31_res1&#45;&gt;m31_final -->
<g id="edge478" class="edge">
<title>m31_res1&#45;&gt;m31_final</title>
<path fill="none" stroke="black" d="M27257.71,-19704.02C27391.21,-19691.26 27653.61,-19643.86 27653.61,-19468.34 27653.61,-19468.34 27653.61,-19468.34 27653.61,-19355.39 27653.61,-19292.07 27629.62,-19221.52 27613.04,-19180.33"/>
<polygon fill="black" stroke="black" points="27616.25,-19178.93 27609.22,-19171.01 27609.78,-19181.59 27616.25,-19178.93"/>
</g>
<!-- m31_gate&#45;&gt;m31_route -->
<g id="edge469" class="edge">
<title>m31_gate&#45;&gt;m31_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27024.61,-19540.75C27024.61,-19532.32 27024.61,-19523.63 27024.61,-19515.33"/>
<polygon fill="black" stroke="black" points="27028.11,-19515.07 27024.61,-19505.07 27021.11,-19515.07 27028.11,-19515.07"/>
</g>
<!-- m31_expert0 -->
<g id="node375" class="node">
<title>m31_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="26107.61" cy="-19356.39" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="26107.61" y="-19367.69" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="26107.61" y="-19352.69" font-family="Times,serif" font-size="14.00">Node 224 GPU 0</text>
<text text-anchor="middle" x="26107.61" y="-19337.69" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m31_route&#45;&gt;m31_expert0 -->
<g id="edge471" class="edge">
<title>m31_route&#45;&gt;m31_expert0</title>
<path fill="none" stroke="black" d="M26930.15,-19455.15C26810.09,-19440.93 26596.46,-19415.61 26413.61,-19393.87 26386.41,-19390.63 26357.84,-19387.23 26329.54,-19383.86"/>
<polygon fill="black" stroke="black" points="26329.89,-19380.38 26319.55,-19382.67 26329.06,-19387.33 26329.89,-19380.38"/>
</g>
<!-- m31_expert1 -->
<g id="node376" class="node">
<title>m31_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="26718.61" cy="-19356.39" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="26718.61" y="-19367.69" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="26718.61" y="-19352.69" font-family="Times,serif" font-size="14.00">Node 224 GPU 1</text>
<text text-anchor="middle" x="26718.61" y="-19337.69" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m31_route&#45;&gt;m31_expert1 -->
<g id="edge473" class="edge">
<title>m31_route&#45;&gt;m31_expert1</title>
<path fill="none" stroke="black" d="M26953.26,-19440.94C26915.08,-19427.34 26867.32,-19410.34 26824.87,-19395.22"/>
<polygon fill="black" stroke="black" points="26825.93,-19391.88 26815.33,-19391.83 26823.58,-19398.48 26825.93,-19391.88"/>
</g>
<!-- m31_expert2 -->
<g id="node377" class="node">
<title>m31_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="27329.61" cy="-19356.39" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="27329.61" y="-19367.69" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="27329.61" y="-19352.69" font-family="Times,serif" font-size="14.00">Node 224 GPU 2</text>
<text text-anchor="middle" x="27329.61" y="-19337.69" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m31_route&#45;&gt;m31_expert2 -->
<g id="edge475" class="edge">
<title>m31_route&#45;&gt;m31_expert2</title>
<path fill="none" stroke="black" d="M27095.74,-19440.94C27133.78,-19427.34 27181.39,-19410.34 27223.7,-19395.22"/>
<polygon fill="black" stroke="black" points="27224.97,-19398.49 27233.21,-19391.83 27222.61,-19391.9 27224.97,-19398.49"/>
</g>
<!-- m31_agg -->
<g id="node378" class="node">
<title>m31_agg</title>
<polygon fill="purple" stroke="black" points="27188.23,-19282.91 26927.95,-19282.91 26861,-19206.91 27121.27,-19206.91 27188.23,-19282.91"/>
<text text-anchor="middle" x="27024.61" y="-19248.71" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="27024.61" y="-19233.71" font-family="Times,serif" font-size="14.00">GPU: 3743</text>
</g>
<!-- m31_expert0&#45;&gt;m31_agg -->
<g id="edge472" class="edge">
<title>m31_expert0&#45;&gt;m31_agg</title>
<path fill="none" stroke="black" d="M26319.14,-19330.14C26497.91,-19308.79 26748.08,-19278.93 26897.48,-19261.09"/>
<polygon fill="black" stroke="black" points="26898.1,-19264.54 26907.62,-19259.88 26897.27,-19257.59 26898.1,-19264.54"/>
</g>
<!-- m31_expert1&#45;&gt;m31_agg -->
<g id="edge474" class="edge">
<title>m31_expert1&#45;&gt;m31_agg</title>
<path fill="none" stroke="black" d="M26815.01,-19320.9C26847.3,-19309.35 26883.5,-19296.4 26916.62,-19284.55"/>
<polygon fill="black" stroke="black" points="26918.09,-19287.74 26926.33,-19281.08 26915.73,-19281.15 26918.09,-19287.74"/>
</g>
<!-- m31_expert2&#45;&gt;m31_agg -->
<g id="edge476" class="edge">
<title>m31_expert2&#45;&gt;m31_agg</title>
<path fill="none" stroke="black" d="M27233.53,-19320.9C27203.07,-19309.97 27169.11,-19297.78 27137.57,-19286.46"/>
<polygon fill="black" stroke="black" points="27138.47,-19283.06 27127.87,-19282.98 27136.1,-19289.65 27138.47,-19283.06"/>
</g>
<!-- m31_agg&#45;&gt;m31_final -->
<g id="edge477" class="edge">
<title>m31_agg&#45;&gt;m31_final</title>
<path fill="none" stroke="black" d="M27137.13,-19224.5C27243.17,-19206.2 27400.36,-19179.08 27500.9,-19161.73"/>
<polygon fill="black" stroke="black" points="27501.79,-19165.13 27511.05,-19159.98 27500.6,-19158.23 27501.79,-19165.13"/>
</g>
<!-- m32_res1 -->
<g id="node384" class="node">
<title>m32_res1</title>
<ellipse fill="lightpink" stroke="black" cx="27710.61" cy="-19054.3" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="27710.61" y="-19058.1" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="27710.61" y="-19043.1" font-family="Times,serif" font-size="14.00">GPU: 3744</text>
</g>
<!-- m31_final&#45;&gt;m32_res1 -->
<g id="edge483" class="edge">
<title>m31_final&#45;&gt;m32_res1</title>
<path fill="none" stroke="black" d="M27629.39,-19118.37C27642.6,-19108.11 27658.05,-19096.12 27671.9,-19085.36"/>
<polygon fill="black" stroke="black" points="27674.1,-19088.08 27679.85,-19079.19 27669.81,-19082.55 27674.1,-19088.08"/>
</g>
<!-- m32_ln1 -->
<g id="node380" class="node">
<title>m32_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="27824.61" cy="-19467.34" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="27824.61" y="-19471.14" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="27824.61" y="-19456.14" font-family="Times,serif" font-size="14.00">GPU: 3744</text>
</g>
<!-- m32_qkv -->
<g id="node381" class="node">
<title>m32_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="27824.61" cy="-19356.39" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="27824.61" y="-19360.19" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="27824.61" y="-19345.19" font-family="Times,serif" font-size="14.00">GPU: 3744</text>
</g>
<!-- m32_ln1&#45;&gt;m32_qkv -->
<g id="edge479" class="edge">
<title>m32_ln1&#45;&gt;m32_qkv</title>
<path fill="none" stroke="black" d="M27824.61,-19440.25C27824.61,-19426.23 27824.61,-19408.74 27824.61,-19393.44"/>
<polygon fill="black" stroke="black" points="27828.11,-19393.27 27824.61,-19383.27 27821.11,-19393.27 27828.11,-19393.27"/>
</g>
<!-- m32_mha -->
<g id="node382" class="node">
<title>m32_mha</title>
<ellipse fill="lightblue" stroke="black" cx="27824.61" cy="-19244.91" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="27824.61" y="-19248.71" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="27824.61" y="-19233.71" font-family="Times,serif" font-size="14.00">GPU: 3744</text>
</g>
<!-- m32_qkv&#45;&gt;m32_mha -->
<g id="edge480" class="edge">
<title>m32_qkv&#45;&gt;m32_mha</title>
<path fill="none" stroke="black" d="M27824.61,-19329.44C27824.61,-19315.37 27824.61,-19297.74 27824.61,-19282.31"/>
<polygon fill="black" stroke="black" points="27828.11,-19282.05 27824.61,-19272.05 27821.11,-19282.05 27828.11,-19282.05"/>
</g>
<!-- m32_out -->
<g id="node383" class="node">
<title>m32_out</title>
<ellipse fill="lightblue" stroke="black" cx="27824.61" cy="-19144.04" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="27824.61" y="-19147.84" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="27824.61" y="-19132.84" font-family="Times,serif" font-size="14.00">GPU: 3744</text>
</g>
<!-- m32_mha&#45;&gt;m32_out -->
<g id="edge481" class="edge">
<title>m32_mha&#45;&gt;m32_out</title>
<path fill="none" stroke="black" d="M27824.61,-19217.94C27824.61,-19206.78 27824.61,-19193.56 27824.61,-19181.46"/>
<polygon fill="black" stroke="black" points="27828.11,-19181.19 27824.61,-19171.19 27821.11,-19181.19 27828.11,-19181.19"/>
</g>
<!-- m32_out&#45;&gt;m32_res1 -->
<g id="edge482" class="edge">
<title>m32_out&#45;&gt;m32_res1</title>
<path fill="none" stroke="black" d="M27792.55,-19118.37C27779.23,-19108.11 27763.64,-19096.12 27749.66,-19085.36"/>
<polygon fill="black" stroke="black" points="27751.7,-19082.51 27741.64,-19079.19 27747.43,-19088.06 27751.7,-19082.51"/>
</g>
<!-- m32_gate -->
<g id="node385" class="node">
<title>m32_gate</title>
<polygon fill="orange" stroke="black" points="27682.23,-18991.43 27477.63,-18991.43 27425,-18885.43 27629.59,-18885.43 27682.23,-18991.43"/>
<text text-anchor="middle" x="27553.61" y="-18949.73" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="27553.61" y="-18934.73" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="27553.61" y="-18919.73" font-family="Times,serif" font-size="14.00">GPU: 3744</text>
</g>
<!-- m32_res1&#45;&gt;m32_gate -->
<g id="edge484" class="edge">
<title>m32_res1&#45;&gt;m32_gate</title>
<path fill="none" stroke="black" d="M27678.08,-19029.71C27665.08,-19020.28 27649.48,-19008.96 27633.79,-18997.58"/>
<polygon fill="black" stroke="black" points="27635.74,-18994.67 27625.59,-18991.64 27631.63,-19000.34 27635.74,-18994.67"/>
</g>
<!-- m32_route -->
<g id="node386" class="node">
<title>m32_route</title>
<ellipse fill="lightgray" stroke="black" cx="27553.61" cy="-18811.96" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="27553.61" y="-18823.26" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="27553.61" y="-18808.26" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="27553.61" y="-18793.26" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m32_res1&#45;&gt;m32_route -->
<g id="edge486" class="edge">
<title>m32_res1&#45;&gt;m32_route</title>
<path fill="none" stroke="black" d="M27714.67,-19027.45C27718.79,-18992.13 27720.92,-18928.28 27691.61,-18885.43 27678.5,-18866.27 27658.68,-18851.81 27638.11,-18841.05"/>
<polygon fill="black" stroke="black" points="27639.47,-18837.82 27628.95,-18836.52 27636.36,-18844.09 27639.47,-18837.82"/>
</g>
<!-- m32_final -->
<g id="node391" class="node">
<title>m32_final</title>
<ellipse fill="lightpink" stroke="black" cx="28127.61" cy="-18488.66" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="28127.61" y="-18492.46" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="28127.61" y="-18477.46" font-family="Times,serif" font-size="14.00">GPU: 3744</text>
</g>
<!-- m32_res1&#45;&gt;m32_final -->
<g id="edge494" class="edge">
<title>m32_res1&#45;&gt;m32_final</title>
<path fill="none" stroke="black" d="M27786.87,-19048.69C27920.66,-19036.03 28183.61,-18988.77 28183.61,-18812.96 28183.61,-18812.96 28183.61,-18812.96 28183.61,-18700 28183.61,-18636.68 28159.62,-18566.13 28143.04,-18524.95"/>
<polygon fill="black" stroke="black" points="28146.25,-18523.55 28139.22,-18515.63 28139.78,-18526.21 28146.25,-18523.55"/>
</g>
<!-- m32_gate&#45;&gt;m32_route -->
<g id="edge485" class="edge">
<title>m32_gate&#45;&gt;m32_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27553.61,-18885.36C27553.61,-18876.93 27553.61,-18868.24 27553.61,-18859.94"/>
<polygon fill="black" stroke="black" points="27557.11,-18859.68 27553.61,-18849.68 27550.11,-18859.68 27557.11,-18859.68"/>
</g>
<!-- m32_expert0 -->
<g id="node387" class="node">
<title>m32_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="26637.61" cy="-18701" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="26637.61" y="-18712.3" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="26637.61" y="-18697.3" font-family="Times,serif" font-size="14.00">Node 232 GPU 0</text>
<text text-anchor="middle" x="26637.61" y="-18682.3" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m32_route&#45;&gt;m32_expert0 -->
<g id="edge487" class="edge">
<title>m32_route&#45;&gt;m32_expert0</title>
<path fill="none" stroke="black" d="M27459.3,-18799.76C27339.44,-18785.53 27126.16,-18760.2 26943.61,-18738.48 26916.41,-18735.24 26887.84,-18731.84 26859.54,-18728.47"/>
<polygon fill="black" stroke="black" points="26859.89,-18724.98 26849.55,-18727.28 26859.06,-18731.94 26859.89,-18724.98"/>
</g>
<!-- m32_expert1 -->
<g id="node388" class="node">
<title>m32_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="27248.61" cy="-18701" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="27248.61" y="-18712.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="27248.61" y="-18697.3" font-family="Times,serif" font-size="14.00">Node 232 GPU 1</text>
<text text-anchor="middle" x="27248.61" y="-18682.3" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m32_route&#45;&gt;m32_expert1 -->
<g id="edge489" class="edge">
<title>m32_route&#45;&gt;m32_expert1</title>
<path fill="none" stroke="black" d="M27482.49,-18785.55C27444.44,-18771.96 27396.83,-18754.95 27354.52,-18739.84"/>
<polygon fill="black" stroke="black" points="27355.61,-18736.51 27345.02,-18736.44 27353.26,-18743.1 27355.61,-18736.51"/>
</g>
<!-- m32_expert2 -->
<g id="node389" class="node">
<title>m32_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="27859.61" cy="-18701" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="27859.61" y="-18712.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="27859.61" y="-18697.3" font-family="Times,serif" font-size="14.00">Node 232 GPU 2</text>
<text text-anchor="middle" x="27859.61" y="-18682.3" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m32_route&#45;&gt;m32_expert2 -->
<g id="edge491" class="edge">
<title>m32_route&#45;&gt;m32_expert2</title>
<path fill="none" stroke="black" d="M27624.97,-18785.55C27663.14,-18771.96 27710.9,-18754.95 27753.36,-18739.84"/>
<polygon fill="black" stroke="black" points="27754.64,-18743.09 27762.89,-18736.44 27752.3,-18736.5 27754.64,-18743.09"/>
</g>
<!-- m32_agg -->
<g id="node390" class="node">
<title>m32_agg</title>
<polygon fill="purple" stroke="black" points="27718.23,-18627.53 27457.95,-18627.53 27391,-18551.53 27651.27,-18551.53 27718.23,-18627.53"/>
<text text-anchor="middle" x="27554.61" y="-18593.33" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="27554.61" y="-18578.33" font-family="Times,serif" font-size="14.00">GPU: 3744</text>
</g>
<!-- m32_expert0&#45;&gt;m32_agg -->
<g id="edge488" class="edge">
<title>m32_expert0&#45;&gt;m32_agg</title>
<path fill="none" stroke="black" d="M26849.14,-18674.75C27027.91,-18653.41 27278.08,-18623.54 27427.48,-18605.7"/>
<polygon fill="black" stroke="black" points="27428.1,-18609.15 27437.62,-18604.49 27427.27,-18602.2 27428.1,-18609.15"/>
</g>
<!-- m32_expert1&#45;&gt;m32_agg -->
<g id="edge490" class="edge">
<title>m32_expert1&#45;&gt;m32_agg</title>
<path fill="none" stroke="black" d="M27345.01,-18665.51C27377.3,-18653.96 27413.5,-18641.01 27446.62,-18629.16"/>
<polygon fill="black" stroke="black" points="27448.09,-18632.35 27456.33,-18625.69 27445.73,-18625.76 27448.09,-18632.35"/>
</g>
<!-- m32_expert2&#45;&gt;m32_agg -->
<g id="edge492" class="edge">
<title>m32_expert2&#45;&gt;m32_agg</title>
<path fill="none" stroke="black" d="M27763.53,-18665.51C27733.07,-18654.58 27699.11,-18642.39 27667.57,-18631.07"/>
<polygon fill="black" stroke="black" points="27668.47,-18627.67 27657.87,-18627.59 27666.1,-18634.26 27668.47,-18627.67"/>
</g>
<!-- m32_agg&#45;&gt;m32_final -->
<g id="edge493" class="edge">
<title>m32_agg&#45;&gt;m32_final</title>
<path fill="none" stroke="black" d="M27667.13,-18569.11C27773.17,-18550.81 27930.36,-18523.69 28030.9,-18506.34"/>
<polygon fill="black" stroke="black" points="28031.79,-18509.74 28041.05,-18504.59 28030.6,-18502.84 28031.79,-18509.74"/>
</g>
<!-- m33_res1 -->
<g id="node396" class="node">
<title>m33_res1</title>
<ellipse fill="lightpink" stroke="black" cx="28240.61" cy="-18398.92" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="28240.61" y="-18402.72" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="28240.61" y="-18387.72" font-family="Times,serif" font-size="14.00">GPU: 3745</text>
</g>
<!-- m32_final&#45;&gt;m33_res1 -->
<g id="edge499" class="edge">
<title>m32_final&#45;&gt;m33_res1</title>
<path fill="none" stroke="black" d="M28159.39,-18462.98C28172.6,-18452.73 28188.05,-18440.73 28201.9,-18429.97"/>
<polygon fill="black" stroke="black" points="28204.1,-18432.7 28209.85,-18423.8 28199.81,-18427.17 28204.1,-18432.7"/>
</g>
<!-- m33_ln1 -->
<g id="node392" class="node">
<title>m33_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="28354.61" cy="-18811.96" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="28354.61" y="-18815.76" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28354.61" y="-18800.76" font-family="Times,serif" font-size="14.00">GPU: 3745</text>
</g>
<!-- m33_qkv -->
<g id="node393" class="node">
<title>m33_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="28354.61" cy="-18701" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="28354.61" y="-18704.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="28354.61" y="-18689.8" font-family="Times,serif" font-size="14.00">GPU: 3745</text>
</g>
<!-- m33_ln1&#45;&gt;m33_qkv -->
<g id="edge495" class="edge">
<title>m33_ln1&#45;&gt;m33_qkv</title>
<path fill="none" stroke="black" d="M28354.61,-18784.86C28354.61,-18770.84 28354.61,-18753.35 28354.61,-18738.06"/>
<polygon fill="black" stroke="black" points="28358.11,-18737.89 28354.61,-18727.89 28351.11,-18737.89 28358.11,-18737.89"/>
</g>
<!-- m33_mha -->
<g id="node394" class="node">
<title>m33_mha</title>
<ellipse fill="lightblue" stroke="black" cx="28354.61" cy="-18589.53" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28354.61" y="-18593.33" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="28354.61" y="-18578.33" font-family="Times,serif" font-size="14.00">GPU: 3745</text>
</g>
<!-- m33_qkv&#45;&gt;m33_mha -->
<g id="edge496" class="edge">
<title>m33_qkv&#45;&gt;m33_mha</title>
<path fill="none" stroke="black" d="M28354.61,-18674.06C28354.61,-18659.98 28354.61,-18642.35 28354.61,-18626.92"/>
<polygon fill="black" stroke="black" points="28358.11,-18626.66 28354.61,-18616.66 28351.11,-18626.66 28358.11,-18626.66"/>
</g>
<!-- m33_out -->
<g id="node395" class="node">
<title>m33_out</title>
<ellipse fill="lightblue" stroke="black" cx="28354.61" cy="-18488.66" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="28354.61" y="-18492.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="28354.61" y="-18477.46" font-family="Times,serif" font-size="14.00">GPU: 3745</text>
</g>
<!-- m33_mha&#45;&gt;m33_out -->
<g id="edge497" class="edge">
<title>m33_mha&#45;&gt;m33_out</title>
<path fill="none" stroke="black" d="M28354.61,-18562.55C28354.61,-18551.4 28354.61,-18538.17 28354.61,-18526.07"/>
<polygon fill="black" stroke="black" points="28358.11,-18525.8 28354.61,-18515.8 28351.11,-18525.8 28358.11,-18525.8"/>
</g>
<!-- m33_out&#45;&gt;m33_res1 -->
<g id="edge498" class="edge">
<title>m33_out&#45;&gt;m33_res1</title>
<path fill="none" stroke="black" d="M28322.55,-18462.98C28309.23,-18452.73 28293.64,-18440.73 28279.66,-18429.97"/>
<polygon fill="black" stroke="black" points="28281.7,-18427.13 28271.64,-18423.8 28277.43,-18432.67 28281.7,-18427.13"/>
</g>
<!-- m33_gate -->
<g id="node397" class="node">
<title>m33_gate</title>
<polygon fill="orange" stroke="black" points="28212.23,-18336.05 28007.63,-18336.05 27955,-18230.05 28159.59,-18230.05 28212.23,-18336.05"/>
<text text-anchor="middle" x="28083.61" y="-18294.35" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="28083.61" y="-18279.35" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="28083.61" y="-18264.35" font-family="Times,serif" font-size="14.00">GPU: 3745</text>
</g>
<!-- m33_res1&#45;&gt;m33_gate -->
<g id="edge500" class="edge">
<title>m33_res1&#45;&gt;m33_gate</title>
<path fill="none" stroke="black" d="M28208.08,-18374.32C28195.08,-18364.89 28179.48,-18353.58 28163.79,-18342.2"/>
<polygon fill="black" stroke="black" points="28165.74,-18339.29 28155.59,-18336.25 28161.63,-18344.95 28165.74,-18339.29"/>
</g>
<!-- m33_route -->
<g id="node398" class="node">
<title>m33_route</title>
<ellipse fill="lightgray" stroke="black" cx="28083.61" cy="-18156.57" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="28083.61" y="-18167.87" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="28083.61" y="-18152.87" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="28083.61" y="-18137.87" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m33_res1&#45;&gt;m33_route -->
<g id="edge502" class="edge">
<title>m33_res1&#45;&gt;m33_route</title>
<path fill="none" stroke="black" d="M28244.67,-18372.06C28248.79,-18336.74 28250.92,-18272.89 28221.61,-18230.05 28208.5,-18210.88 28188.68,-18196.42 28168.11,-18185.67"/>
<polygon fill="black" stroke="black" points="28169.47,-18182.43 28158.95,-18181.13 28166.36,-18188.7 28169.47,-18182.43"/>
</g>
<!-- m33_final -->
<g id="node403" class="node">
<title>m33_final</title>
<ellipse fill="lightpink" stroke="black" cx="28656.61" cy="-17833.27" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="28656.61" y="-17837.07" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="28656.61" y="-17822.07" font-family="Times,serif" font-size="14.00">GPU: 3745</text>
</g>
<!-- m33_res1&#45;&gt;m33_final -->
<g id="edge510" class="edge">
<title>m33_res1&#45;&gt;m33_final</title>
<path fill="none" stroke="black" d="M28316.71,-18393.24C28450.21,-18380.49 28712.61,-18333.09 28712.61,-18157.57 28712.61,-18157.57 28712.61,-18157.57 28712.61,-18044.62 28712.61,-17981.29 28688.62,-17910.74 28672.04,-17869.56"/>
<polygon fill="black" stroke="black" points="28675.25,-17868.16 28668.22,-17860.24 28668.78,-17870.82 28675.25,-17868.16"/>
</g>
<!-- m33_gate&#45;&gt;m33_route -->
<g id="edge501" class="edge">
<title>m33_gate&#45;&gt;m33_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28083.61,-18229.98C28083.61,-18221.55 28083.61,-18212.86 28083.61,-18204.56"/>
<polygon fill="black" stroke="black" points="28087.11,-18204.3 28083.61,-18194.3 28080.11,-18204.3 28087.11,-18204.3"/>
</g>
<!-- m33_expert0 -->
<g id="node399" class="node">
<title>m33_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="27166.61" cy="-18045.62" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="27166.61" y="-18056.92" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="27166.61" y="-18041.92" font-family="Times,serif" font-size="14.00">Node 240 GPU 0</text>
<text text-anchor="middle" x="27166.61" y="-18026.92" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m33_route&#45;&gt;m33_expert0 -->
<g id="edge503" class="edge">
<title>m33_route&#45;&gt;m33_expert0</title>
<path fill="none" stroke="black" d="M27989.15,-18144.38C27869.09,-18130.16 27655.46,-18104.83 27472.61,-18083.09 27445.41,-18079.86 27416.84,-18076.46 27388.54,-18073.09"/>
<polygon fill="black" stroke="black" points="27388.89,-18069.6 27378.55,-18071.9 27388.06,-18076.55 27388.89,-18069.6"/>
</g>
<!-- m33_expert1 -->
<g id="node400" class="node">
<title>m33_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="27777.61" cy="-18045.62" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="27777.61" y="-18056.92" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="27777.61" y="-18041.92" font-family="Times,serif" font-size="14.00">Node 240 GPU 1</text>
<text text-anchor="middle" x="27777.61" y="-18026.92" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m33_route&#45;&gt;m33_expert1 -->
<g id="edge505" class="edge">
<title>m33_route&#45;&gt;m33_expert1</title>
<path fill="none" stroke="black" d="M28012.26,-18130.16C27974.08,-18116.57 27926.32,-18099.56 27883.87,-18084.45"/>
<polygon fill="black" stroke="black" points="27884.93,-18081.11 27874.33,-18081.05 27882.58,-18087.71 27884.93,-18081.11"/>
</g>
<!-- m33_expert2 -->
<g id="node401" class="node">
<title>m33_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="28388.61" cy="-18045.62" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="28388.61" y="-18056.92" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="28388.61" y="-18041.92" font-family="Times,serif" font-size="14.00">Node 240 GPU 2</text>
<text text-anchor="middle" x="28388.61" y="-18026.92" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m33_route&#45;&gt;m33_expert2 -->
<g id="edge507" class="edge">
<title>m33_route&#45;&gt;m33_expert2</title>
<path fill="none" stroke="black" d="M28154.74,-18130.16C28192.78,-18116.57 28240.39,-18099.56 28282.7,-18084.45"/>
<polygon fill="black" stroke="black" points="28283.97,-18087.71 28292.21,-18081.05 28281.61,-18081.12 28283.97,-18087.71"/>
</g>
<!-- m33_agg -->
<g id="node402" class="node">
<title>m33_agg</title>
<polygon fill="purple" stroke="black" points="28247.23,-17972.14 27986.95,-17972.14 27920,-17896.14 28180.27,-17896.14 28247.23,-17972.14"/>
<text text-anchor="middle" x="28083.61" y="-17937.94" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="28083.61" y="-17922.94" font-family="Times,serif" font-size="14.00">GPU: 3745</text>
</g>
<!-- m33_expert0&#45;&gt;m33_agg -->
<g id="edge504" class="edge">
<title>m33_expert0&#45;&gt;m33_agg</title>
<path fill="none" stroke="black" d="M27378.14,-18019.36C27556.91,-17998.02 27807.08,-17968.15 27956.48,-17950.32"/>
<polygon fill="black" stroke="black" points="27957.1,-17953.77 27966.62,-17949.11 27956.27,-17946.82 27957.1,-17953.77"/>
</g>
<!-- m33_expert1&#45;&gt;m33_agg -->
<g id="edge506" class="edge">
<title>m33_expert1&#45;&gt;m33_agg</title>
<path fill="none" stroke="black" d="M27874.01,-18010.13C27906.3,-17998.58 27942.5,-17985.62 27975.62,-17973.78"/>
<polygon fill="black" stroke="black" points="27977.09,-17976.97 27985.33,-17970.3 27974.73,-17970.38 27977.09,-17976.97"/>
</g>
<!-- m33_expert2&#45;&gt;m33_agg -->
<g id="edge508" class="edge">
<title>m33_expert2&#45;&gt;m33_agg</title>
<path fill="none" stroke="black" d="M28292.53,-18010.13C28262.07,-17999.19 28228.11,-17987 28196.57,-17975.69"/>
<polygon fill="black" stroke="black" points="28197.47,-17972.29 28186.87,-17972.2 28195.1,-17978.88 28197.47,-17972.29"/>
</g>
<!-- m33_agg&#45;&gt;m33_final -->
<g id="edge509" class="edge">
<title>m33_agg&#45;&gt;m33_final</title>
<path fill="none" stroke="black" d="M28196.13,-17913.72C28302.17,-17895.43 28459.36,-17868.3 28559.9,-17850.96"/>
<polygon fill="black" stroke="black" points="28560.79,-17854.35 28570.05,-17849.2 28559.6,-17847.46 28560.79,-17854.35"/>
</g>
<!-- m34_res1 -->
<g id="node408" class="node">
<title>m34_res1</title>
<ellipse fill="lightpink" stroke="black" cx="28769.61" cy="-17743.53" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="28769.61" y="-17747.33" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="28769.61" y="-17732.33" font-family="Times,serif" font-size="14.00">GPU: 3746</text>
</g>
<!-- m33_final&#45;&gt;m34_res1 -->
<g id="edge515" class="edge">
<title>m33_final&#45;&gt;m34_res1</title>
<path fill="none" stroke="black" d="M28688.39,-17807.59C28701.6,-17797.34 28717.05,-17785.34 28730.9,-17774.58"/>
<polygon fill="black" stroke="black" points="28733.1,-17777.31 28738.85,-17768.41 28728.81,-17771.78 28733.1,-17777.31"/>
</g>
<!-- m34_ln1 -->
<g id="node404" class="node">
<title>m34_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="28883.61" cy="-18156.57" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="28883.61" y="-18160.37" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="28883.61" y="-18145.37" font-family="Times,serif" font-size="14.00">GPU: 3746</text>
</g>
<!-- m34_qkv -->
<g id="node405" class="node">
<title>m34_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="28883.61" cy="-18045.62" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="28883.61" y="-18049.42" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="28883.61" y="-18034.42" font-family="Times,serif" font-size="14.00">GPU: 3746</text>
</g>
<!-- m34_ln1&#45;&gt;m34_qkv -->
<g id="edge511" class="edge">
<title>m34_ln1&#45;&gt;m34_qkv</title>
<path fill="none" stroke="black" d="M28883.61,-18129.47C28883.61,-18115.46 28883.61,-18097.96 28883.61,-18082.67"/>
<polygon fill="black" stroke="black" points="28887.11,-18082.5 28883.61,-18072.5 28880.11,-18082.5 28887.11,-18082.5"/>
</g>
<!-- m34_mha -->
<g id="node406" class="node">
<title>m34_mha</title>
<ellipse fill="lightblue" stroke="black" cx="28883.61" cy="-17934.14" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="28883.61" y="-17937.94" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="28883.61" y="-17922.94" font-family="Times,serif" font-size="14.00">GPU: 3746</text>
</g>
<!-- m34_qkv&#45;&gt;m34_mha -->
<g id="edge512" class="edge">
<title>m34_qkv&#45;&gt;m34_mha</title>
<path fill="none" stroke="black" d="M28883.61,-18018.67C28883.61,-18004.59 28883.61,-17986.97 28883.61,-17971.54"/>
<polygon fill="black" stroke="black" points="28887.11,-17971.28 28883.61,-17961.28 28880.11,-17971.28 28887.11,-17971.28"/>
</g>
<!-- m34_out -->
<g id="node407" class="node">
<title>m34_out</title>
<ellipse fill="lightblue" stroke="black" cx="28883.61" cy="-17833.27" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="28883.61" y="-17837.07" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="28883.61" y="-17822.07" font-family="Times,serif" font-size="14.00">GPU: 3746</text>
</g>
<!-- m34_mha&#45;&gt;m34_out -->
<g id="edge513" class="edge">
<title>m34_mha&#45;&gt;m34_out</title>
<path fill="none" stroke="black" d="M28883.61,-17907.16C28883.61,-17896.01 28883.61,-17882.79 28883.61,-17870.68"/>
<polygon fill="black" stroke="black" points="28887.11,-17870.42 28883.61,-17860.42 28880.11,-17870.42 28887.11,-17870.42"/>
</g>
<!-- m34_out&#45;&gt;m34_res1 -->
<g id="edge514" class="edge">
<title>m34_out&#45;&gt;m34_res1</title>
<path fill="none" stroke="black" d="M28851.55,-17807.59C28838.23,-17797.34 28822.64,-17785.34 28808.66,-17774.58"/>
<polygon fill="black" stroke="black" points="28810.7,-17771.74 28800.64,-17768.41 28806.43,-17777.29 28810.7,-17771.74"/>
</g>
<!-- m34_gate -->
<g id="node409" class="node">
<title>m34_gate</title>
<polygon fill="orange" stroke="black" points="28741.23,-17680.66 28536.63,-17680.66 28484,-17574.66 28688.59,-17574.66 28741.23,-17680.66"/>
<text text-anchor="middle" x="28612.61" y="-17638.96" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="28612.61" y="-17623.96" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="28612.61" y="-17608.96" font-family="Times,serif" font-size="14.00">GPU: 3746</text>
</g>
<!-- m34_res1&#45;&gt;m34_gate -->
<g id="edge516" class="edge">
<title>m34_res1&#45;&gt;m34_gate</title>
<path fill="none" stroke="black" d="M28737.08,-17718.93C28724.08,-17709.5 28708.48,-17698.19 28692.79,-17686.81"/>
<polygon fill="black" stroke="black" points="28694.74,-17683.9 28684.59,-17680.86 28690.63,-17689.57 28694.74,-17683.9"/>
</g>
<!-- m34_route -->
<g id="node410" class="node">
<title>m34_route</title>
<ellipse fill="lightgray" stroke="black" cx="28612.61" cy="-17501.18" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="28612.61" y="-17512.48" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="28612.61" y="-17497.48" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="28612.61" y="-17482.48" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m34_res1&#45;&gt;m34_route -->
<g id="edge518" class="edge">
<title>m34_res1&#45;&gt;m34_route</title>
<path fill="none" stroke="black" d="M28773.67,-17716.68C28777.79,-17681.35 28779.92,-17617.51 28750.61,-17574.66 28737.5,-17555.49 28717.68,-17541.03 28697.11,-17530.28"/>
<polygon fill="black" stroke="black" points="28698.47,-17527.04 28687.95,-17525.74 28695.36,-17533.32 28698.47,-17527.04"/>
</g>
<!-- m34_final -->
<g id="node415" class="node">
<title>m34_final</title>
<ellipse fill="lightpink" stroke="black" cx="29186.61" cy="-17177.88" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="29186.61" y="-17181.68" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="29186.61" y="-17166.68" font-family="Times,serif" font-size="14.00">GPU: 3746</text>
</g>
<!-- m34_res1&#45;&gt;m34_final -->
<g id="edge526" class="edge">
<title>m34_res1&#45;&gt;m34_final</title>
<path fill="none" stroke="black" d="M28845.87,-17737.91C28979.66,-17725.25 29242.61,-17678 29242.61,-17502.18 29242.61,-17502.18 29242.61,-17502.18 29242.61,-17389.23 29242.61,-17325.9 29218.62,-17255.36 29202.04,-17214.17"/>
<polygon fill="black" stroke="black" points="29205.25,-17212.77 29198.22,-17204.85 29198.78,-17215.43 29205.25,-17212.77"/>
</g>
<!-- m34_gate&#45;&gt;m34_route -->
<g id="edge517" class="edge">
<title>m34_gate&#45;&gt;m34_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28612.61,-17574.59C28612.61,-17566.16 28612.61,-17557.47 28612.61,-17549.17"/>
<polygon fill="black" stroke="black" points="28616.11,-17548.91 28612.61,-17538.91 28609.11,-17548.91 28616.11,-17548.91"/>
</g>
<!-- m34_expert0 -->
<g id="node411" class="node">
<title>m34_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="27696.61" cy="-17390.23" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="27696.61" y="-17401.53" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="27696.61" y="-17386.53" font-family="Times,serif" font-size="14.00">Node 248 GPU 0</text>
<text text-anchor="middle" x="27696.61" y="-17371.53" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m34_route&#45;&gt;m34_expert0 -->
<g id="edge519" class="edge">
<title>m34_route&#45;&gt;m34_expert0</title>
<path fill="none" stroke="black" d="M28518.3,-17488.99C28398.44,-17474.76 28185.16,-17449.43 28002.61,-17427.71 27975.41,-17424.47 27946.84,-17421.07 27918.54,-17417.69"/>
<polygon fill="black" stroke="black" points="27918.89,-17414.21 27908.55,-17416.5 27918.06,-17421.16 27918.89,-17414.21"/>
</g>
<!-- m34_expert1 -->
<g id="node412" class="node">
<title>m34_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="28307.61" cy="-17390.23" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="28307.61" y="-17401.53" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="28307.61" y="-17386.53" font-family="Times,serif" font-size="14.00">Node 248 GPU 1</text>
<text text-anchor="middle" x="28307.61" y="-17371.53" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m34_route&#45;&gt;m34_expert1 -->
<g id="edge521" class="edge">
<title>m34_route&#45;&gt;m34_expert1</title>
<path fill="none" stroke="black" d="M28541.49,-17474.77C28503.44,-17461.18 28455.83,-17444.18 28413.52,-17429.06"/>
<polygon fill="black" stroke="black" points="28414.61,-17425.74 28404.02,-17425.67 28412.26,-17432.33 28414.61,-17425.74"/>
</g>
<!-- m34_expert2 -->
<g id="node413" class="node">
<title>m34_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="28918.61" cy="-17390.23" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="28918.61" y="-17401.53" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="28918.61" y="-17386.53" font-family="Times,serif" font-size="14.00">Node 248 GPU 2</text>
<text text-anchor="middle" x="28918.61" y="-17371.53" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m34_route&#45;&gt;m34_expert2 -->
<g id="edge523" class="edge">
<title>m34_route&#45;&gt;m34_expert2</title>
<path fill="none" stroke="black" d="M28683.97,-17474.77C28722.14,-17461.18 28769.9,-17444.18 28812.36,-17429.06"/>
<polygon fill="black" stroke="black" points="28813.64,-17432.32 28821.89,-17425.67 28811.3,-17425.72 28813.64,-17432.32"/>
</g>
<!-- m34_agg -->
<g id="node414" class="node">
<title>m34_agg</title>
<polygon fill="purple" stroke="black" points="28777.23,-17316.75 28516.95,-17316.75 28450,-17240.75 28710.27,-17240.75 28777.23,-17316.75"/>
<text text-anchor="middle" x="28613.61" y="-17282.55" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="28613.61" y="-17267.55" font-family="Times,serif" font-size="14.00">GPU: 3746</text>
</g>
<!-- m34_expert0&#45;&gt;m34_agg -->
<g id="edge520" class="edge">
<title>m34_expert0&#45;&gt;m34_agg</title>
<path fill="none" stroke="black" d="M27908.14,-17363.98C28086.91,-17342.63 28337.08,-17312.77 28486.48,-17294.93"/>
<polygon fill="black" stroke="black" points="28487.1,-17298.38 28496.62,-17293.72 28486.27,-17291.43 28487.1,-17298.38"/>
</g>
<!-- m34_expert1&#45;&gt;m34_agg -->
<g id="edge522" class="edge">
<title>m34_expert1&#45;&gt;m34_agg</title>
<path fill="none" stroke="black" d="M28404.01,-17354.74C28436.3,-17343.19 28472.5,-17330.24 28505.62,-17318.39"/>
<polygon fill="black" stroke="black" points="28507.09,-17321.58 28515.33,-17314.92 28504.73,-17314.99 28507.09,-17321.58"/>
</g>
<!-- m34_expert2&#45;&gt;m34_agg -->
<g id="edge524" class="edge">
<title>m34_expert2&#45;&gt;m34_agg</title>
<path fill="none" stroke="black" d="M28822.53,-17354.74C28792.07,-17343.81 28758.11,-17331.62 28726.57,-17320.3"/>
<polygon fill="black" stroke="black" points="28727.47,-17316.9 28716.87,-17316.82 28725.1,-17323.49 28727.47,-17316.9"/>
</g>
<!-- m34_agg&#45;&gt;m34_final -->
<g id="edge525" class="edge">
<title>m34_agg&#45;&gt;m34_final</title>
<path fill="none" stroke="black" d="M28726.13,-17258.34C28832.17,-17240.04 28989.36,-17212.92 29089.9,-17195.57"/>
<polygon fill="black" stroke="black" points="29090.79,-17198.97 29100.05,-17193.82 29089.6,-17192.07 29090.79,-17198.97"/>
</g>
<!-- m35_res1 -->
<g id="node420" class="node">
<title>m35_res1</title>
<ellipse fill="lightpink" stroke="black" cx="29299.61" cy="-17088.14" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="29299.61" y="-17091.94" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="29299.61" y="-17076.94" font-family="Times,serif" font-size="14.00">GPU: 3747</text>
</g>
<!-- m34_final&#45;&gt;m35_res1 -->
<g id="edge531" class="edge">
<title>m34_final&#45;&gt;m35_res1</title>
<path fill="none" stroke="black" d="M29218.39,-17152.21C29231.6,-17141.95 29247.05,-17129.96 29260.9,-17119.2"/>
<polygon fill="black" stroke="black" points="29263.1,-17121.92 29268.85,-17113.03 29258.81,-17116.39 29263.1,-17121.92"/>
</g>
<!-- m35_ln1 -->
<g id="node416" class="node">
<title>m35_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="29413.61" cy="-17501.18" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="29413.61" y="-17504.98" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="29413.61" y="-17489.98" font-family="Times,serif" font-size="14.00">GPU: 3747</text>
</g>
<!-- m35_qkv -->
<g id="node417" class="node">
<title>m35_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="29413.61" cy="-17390.23" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="29413.61" y="-17394.03" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="29413.61" y="-17379.03" font-family="Times,serif" font-size="14.00">GPU: 3747</text>
</g>
<!-- m35_ln1&#45;&gt;m35_qkv -->
<g id="edge527" class="edge">
<title>m35_ln1&#45;&gt;m35_qkv</title>
<path fill="none" stroke="black" d="M29413.61,-17474.08C29413.61,-17460.07 29413.61,-17442.58 29413.61,-17427.28"/>
<polygon fill="black" stroke="black" points="29417.11,-17427.11 29413.61,-17417.11 29410.11,-17427.11 29417.11,-17427.11"/>
</g>
<!-- m35_mha -->
<g id="node418" class="node">
<title>m35_mha</title>
<ellipse fill="lightblue" stroke="black" cx="29413.61" cy="-17278.75" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="29413.61" y="-17282.55" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="29413.61" y="-17267.55" font-family="Times,serif" font-size="14.00">GPU: 3747</text>
</g>
<!-- m35_qkv&#45;&gt;m35_mha -->
<g id="edge528" class="edge">
<title>m35_qkv&#45;&gt;m35_mha</title>
<path fill="none" stroke="black" d="M29413.61,-17363.28C29413.61,-17349.21 29413.61,-17331.58 29413.61,-17316.15"/>
<polygon fill="black" stroke="black" points="29417.11,-17315.89 29413.61,-17305.89 29410.11,-17315.89 29417.11,-17315.89"/>
</g>
<!-- m35_out -->
<g id="node419" class="node">
<title>m35_out</title>
<ellipse fill="lightblue" stroke="black" cx="29413.61" cy="-17177.88" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="29413.61" y="-17181.68" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="29413.61" y="-17166.68" font-family="Times,serif" font-size="14.00">GPU: 3747</text>
</g>
<!-- m35_mha&#45;&gt;m35_out -->
<g id="edge529" class="edge">
<title>m35_mha&#45;&gt;m35_out</title>
<path fill="none" stroke="black" d="M29413.61,-17251.78C29413.61,-17240.62 29413.61,-17227.4 29413.61,-17215.3"/>
<polygon fill="black" stroke="black" points="29417.11,-17215.03 29413.61,-17205.03 29410.11,-17215.03 29417.11,-17215.03"/>
</g>
<!-- m35_out&#45;&gt;m35_res1 -->
<g id="edge530" class="edge">
<title>m35_out&#45;&gt;m35_res1</title>
<path fill="none" stroke="black" d="M29381.55,-17152.21C29368.23,-17141.95 29352.64,-17129.96 29338.66,-17119.2"/>
<polygon fill="black" stroke="black" points="29340.7,-17116.35 29330.64,-17113.03 29336.43,-17121.9 29340.7,-17116.35"/>
</g>
<!-- m35_gate -->
<g id="node421" class="node">
<title>m35_gate</title>
<polygon fill="orange" stroke="black" points="29271.23,-17025.27 29066.63,-17025.27 29014,-16919.27 29218.59,-16919.27 29271.23,-17025.27"/>
<text text-anchor="middle" x="29142.61" y="-16983.57" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="29142.61" y="-16968.57" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="29142.61" y="-16953.57" font-family="Times,serif" font-size="14.00">GPU: 3747</text>
</g>
<!-- m35_res1&#45;&gt;m35_gate -->
<g id="edge532" class="edge">
<title>m35_res1&#45;&gt;m35_gate</title>
<path fill="none" stroke="black" d="M29267.08,-17063.55C29254.08,-17054.12 29238.48,-17042.8 29222.79,-17031.42"/>
<polygon fill="black" stroke="black" points="29224.74,-17028.51 29214.59,-17025.48 29220.63,-17034.18 29224.74,-17028.51"/>
</g>
<!-- m35_route -->
<g id="node422" class="node">
<title>m35_route</title>
<ellipse fill="lightgray" stroke="black" cx="29142.61" cy="-16845.8" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="29142.61" y="-16857.1" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="29142.61" y="-16842.1" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="29142.61" y="-16827.1" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m35_res1&#45;&gt;m35_route -->
<g id="edge534" class="edge">
<title>m35_res1&#45;&gt;m35_route</title>
<path fill="none" stroke="black" d="M29303.67,-17061.29C29307.79,-17025.97 29309.92,-16962.12 29280.61,-16919.27 29267.5,-16900.11 29247.68,-16885.65 29227.11,-16874.89"/>
<polygon fill="black" stroke="black" points="29228.47,-16871.66 29217.95,-16870.36 29225.36,-16877.93 29228.47,-16871.66"/>
</g>
<!-- m35_final -->
<g id="node427" class="node">
<title>m35_final</title>
<ellipse fill="lightpink" stroke="black" cx="29716.61" cy="-16522.5" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="29716.61" y="-16526.3" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="29716.61" y="-16511.3" font-family="Times,serif" font-size="14.00">GPU: 3747</text>
</g>
<!-- m35_res1&#45;&gt;m35_final -->
<g id="edge542" class="edge">
<title>m35_res1&#45;&gt;m35_final</title>
<path fill="none" stroke="black" d="M29375.87,-17082.53C29509.66,-17069.86 29772.61,-17022.61 29772.61,-16846.8 29772.61,-16846.8 29772.61,-16846.8 29772.61,-16733.84 29772.61,-16670.52 29748.62,-16599.97 29732.04,-16558.79"/>
<polygon fill="black" stroke="black" points="29735.25,-16557.39 29728.22,-16549.47 29728.78,-16560.05 29735.25,-16557.39"/>
</g>
<!-- m35_gate&#45;&gt;m35_route -->
<g id="edge533" class="edge">
<title>m35_gate&#45;&gt;m35_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29142.61,-16919.2C29142.61,-16910.77 29142.61,-16902.08 29142.61,-16893.78"/>
<polygon fill="black" stroke="black" points="29146.11,-16893.52 29142.61,-16883.52 29139.11,-16893.52 29146.11,-16893.52"/>
</g>
<!-- m35_expert0 -->
<g id="node423" class="node">
<title>m35_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="28226.61" cy="-16734.84" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="28226.61" y="-16746.14" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="28226.61" y="-16731.14" font-family="Times,serif" font-size="14.00">Node 256 GPU 0</text>
<text text-anchor="middle" x="28226.61" y="-16716.14" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m35_route&#45;&gt;m35_expert0 -->
<g id="edge535" class="edge">
<title>m35_route&#45;&gt;m35_expert0</title>
<path fill="none" stroke="black" d="M29048.3,-16833.6C28928.44,-16819.37 28715.16,-16794.04 28532.61,-16772.32 28505.41,-16769.08 28476.84,-16765.68 28448.54,-16762.31"/>
<polygon fill="black" stroke="black" points="28448.89,-16758.82 28438.55,-16761.12 28448.06,-16765.78 28448.89,-16758.82"/>
</g>
<!-- m35_expert1 -->
<g id="node424" class="node">
<title>m35_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="28837.61" cy="-16734.84" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="28837.61" y="-16746.14" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="28837.61" y="-16731.14" font-family="Times,serif" font-size="14.00">Node 256 GPU 1</text>
<text text-anchor="middle" x="28837.61" y="-16716.14" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m35_route&#45;&gt;m35_expert1 -->
<g id="edge537" class="edge">
<title>m35_route&#45;&gt;m35_expert1</title>
<path fill="none" stroke="black" d="M29071.49,-16819.39C29033.44,-16805.8 28985.83,-16788.79 28943.52,-16773.68"/>
<polygon fill="black" stroke="black" points="28944.61,-16770.35 28934.02,-16770.28 28942.26,-16776.94 28944.61,-16770.35"/>
</g>
<!-- m35_expert2 -->
<g id="node425" class="node">
<title>m35_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="29448.61" cy="-16734.84" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="29448.61" y="-16746.14" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="29448.61" y="-16731.14" font-family="Times,serif" font-size="14.00">Node 256 GPU 2</text>
<text text-anchor="middle" x="29448.61" y="-16716.14" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m35_route&#45;&gt;m35_expert2 -->
<g id="edge539" class="edge">
<title>m35_route&#45;&gt;m35_expert2</title>
<path fill="none" stroke="black" d="M29213.97,-16819.39C29252.14,-16805.8 29299.9,-16788.79 29342.36,-16773.68"/>
<polygon fill="black" stroke="black" points="29343.64,-16776.93 29351.89,-16770.28 29341.3,-16770.34 29343.64,-16776.93"/>
</g>
<!-- m35_agg -->
<g id="node426" class="node">
<title>m35_agg</title>
<polygon fill="purple" stroke="black" points="29307.23,-16661.37 29046.95,-16661.37 28980,-16585.37 29240.27,-16585.37 29307.23,-16661.37"/>
<text text-anchor="middle" x="29143.61" y="-16627.17" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="29143.61" y="-16612.17" font-family="Times,serif" font-size="14.00">GPU: 3747</text>
</g>
<!-- m35_expert0&#45;&gt;m35_agg -->
<g id="edge536" class="edge">
<title>m35_expert0&#45;&gt;m35_agg</title>
<path fill="none" stroke="black" d="M28438.14,-16708.59C28616.91,-16687.25 28867.08,-16657.38 29016.48,-16639.54"/>
<polygon fill="black" stroke="black" points="29017.1,-16642.99 29026.62,-16638.33 29016.27,-16636.04 29017.1,-16642.99"/>
</g>
<!-- m35_expert1&#45;&gt;m35_agg -->
<g id="edge538" class="edge">
<title>m35_expert1&#45;&gt;m35_agg</title>
<path fill="none" stroke="black" d="M28934.01,-16699.35C28966.3,-16687.8 29002.5,-16674.85 29035.62,-16663"/>
<polygon fill="black" stroke="black" points="29037.09,-16666.19 29045.33,-16659.53 29034.73,-16659.6 29037.09,-16666.19"/>
</g>
<!-- m35_expert2&#45;&gt;m35_agg -->
<g id="edge540" class="edge">
<title>m35_expert2&#45;&gt;m35_agg</title>
<path fill="none" stroke="black" d="M29352.53,-16699.35C29322.07,-16688.42 29288.11,-16676.23 29256.57,-16664.91"/>
<polygon fill="black" stroke="black" points="29257.47,-16661.51 29246.87,-16661.43 29255.1,-16668.1 29257.47,-16661.51"/>
</g>
<!-- m35_agg&#45;&gt;m35_final -->
<g id="edge541" class="edge">
<title>m35_agg&#45;&gt;m35_final</title>
<path fill="none" stroke="black" d="M29256.13,-16602.95C29362.17,-16584.65 29519.36,-16557.53 29619.9,-16540.18"/>
<polygon fill="black" stroke="black" points="29620.79,-16543.58 29630.05,-16538.43 29619.6,-16536.68 29620.79,-16543.58"/>
</g>
<!-- m36_res1 -->
<g id="node432" class="node">
<title>m36_res1</title>
<ellipse fill="lightpink" stroke="black" cx="29829.61" cy="-16432.75" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="29829.61" y="-16436.55" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="29829.61" y="-16421.55" font-family="Times,serif" font-size="14.00">GPU: 3748</text>
</g>
<!-- m35_final&#45;&gt;m36_res1 -->
<g id="edge547" class="edge">
<title>m35_final&#45;&gt;m36_res1</title>
<path fill="none" stroke="black" d="M29748.39,-16496.82C29761.6,-16486.57 29777.05,-16474.57 29790.9,-16463.81"/>
<polygon fill="black" stroke="black" points="29793.1,-16466.54 29798.85,-16457.64 29788.81,-16461.01 29793.1,-16466.54"/>
</g>
<!-- m36_ln1 -->
<g id="node428" class="node">
<title>m36_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="29943.61" cy="-16845.8" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="29943.61" y="-16849.6" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="29943.61" y="-16834.6" font-family="Times,serif" font-size="14.00">GPU: 3748</text>
</g>
<!-- m36_qkv -->
<g id="node429" class="node">
<title>m36_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="29943.61" cy="-16734.84" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="29943.61" y="-16738.64" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="29943.61" y="-16723.64" font-family="Times,serif" font-size="14.00">GPU: 3748</text>
</g>
<!-- m36_ln1&#45;&gt;m36_qkv -->
<g id="edge543" class="edge">
<title>m36_ln1&#45;&gt;m36_qkv</title>
<path fill="none" stroke="black" d="M29943.61,-16818.7C29943.61,-16804.68 29943.61,-16787.19 29943.61,-16771.89"/>
<polygon fill="black" stroke="black" points="29947.11,-16771.73 29943.61,-16761.73 29940.11,-16771.73 29947.11,-16771.73"/>
</g>
<!-- m36_mha -->
<g id="node430" class="node">
<title>m36_mha</title>
<ellipse fill="lightblue" stroke="black" cx="29943.61" cy="-16623.37" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="29943.61" y="-16627.17" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="29943.61" y="-16612.17" font-family="Times,serif" font-size="14.00">GPU: 3748</text>
</g>
<!-- m36_qkv&#45;&gt;m36_mha -->
<g id="edge544" class="edge">
<title>m36_qkv&#45;&gt;m36_mha</title>
<path fill="none" stroke="black" d="M29943.61,-16707.9C29943.61,-16693.82 29943.61,-16676.19 29943.61,-16660.76"/>
<polygon fill="black" stroke="black" points="29947.11,-16660.5 29943.61,-16650.5 29940.11,-16660.5 29947.11,-16660.5"/>
</g>
<!-- m36_out -->
<g id="node431" class="node">
<title>m36_out</title>
<ellipse fill="lightblue" stroke="black" cx="29943.61" cy="-16522.5" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="29943.61" y="-16526.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="29943.61" y="-16511.3" font-family="Times,serif" font-size="14.00">GPU: 3748</text>
</g>
<!-- m36_mha&#45;&gt;m36_out -->
<g id="edge545" class="edge">
<title>m36_mha&#45;&gt;m36_out</title>
<path fill="none" stroke="black" d="M29943.61,-16596.39C29943.61,-16585.24 29943.61,-16572.01 29943.61,-16559.91"/>
<polygon fill="black" stroke="black" points="29947.11,-16559.64 29943.61,-16549.64 29940.11,-16559.64 29947.11,-16559.64"/>
</g>
<!-- m36_out&#45;&gt;m36_res1 -->
<g id="edge546" class="edge">
<title>m36_out&#45;&gt;m36_res1</title>
<path fill="none" stroke="black" d="M29911.55,-16496.82C29898.23,-16486.57 29882.64,-16474.57 29868.66,-16463.81"/>
<polygon fill="black" stroke="black" points="29870.7,-16460.96 29860.64,-16457.64 29866.43,-16466.51 29870.7,-16460.96"/>
</g>
<!-- m36_gate -->
<g id="node433" class="node">
<title>m36_gate</title>
<polygon fill="orange" stroke="black" points="29801.23,-16369.88 29596.63,-16369.88 29544,-16263.88 29748.59,-16263.88 29801.23,-16369.88"/>
<text text-anchor="middle" x="29672.61" y="-16328.18" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="29672.61" y="-16313.18" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="29672.61" y="-16298.18" font-family="Times,serif" font-size="14.00">GPU: 3748</text>
</g>
<!-- m36_res1&#45;&gt;m36_gate -->
<g id="edge548" class="edge">
<title>m36_res1&#45;&gt;m36_gate</title>
<path fill="none" stroke="black" d="M29797.08,-16408.16C29784.08,-16398.73 29768.48,-16387.42 29752.79,-16376.04"/>
<polygon fill="black" stroke="black" points="29754.74,-16373.13 29744.59,-16370.09 29750.63,-16378.79 29754.74,-16373.13"/>
</g>
<!-- m36_route -->
<g id="node434" class="node">
<title>m36_route</title>
<ellipse fill="lightgray" stroke="black" cx="29672.61" cy="-16190.41" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="29672.61" y="-16201.71" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="29672.61" y="-16186.71" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="29672.61" y="-16171.71" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m36_res1&#45;&gt;m36_route -->
<g id="edge550" class="edge">
<title>m36_res1&#45;&gt;m36_route</title>
<path fill="none" stroke="black" d="M29833.67,-16405.9C29837.79,-16370.58 29839.92,-16306.73 29810.61,-16263.88 29797.5,-16244.72 29777.68,-16230.26 29757.11,-16219.5"/>
<polygon fill="black" stroke="black" points="29758.47,-16216.27 29747.95,-16214.97 29755.36,-16222.54 29758.47,-16216.27"/>
</g>
<!-- m36_final -->
<g id="node439" class="node">
<title>m36_final</title>
<ellipse fill="lightpink" stroke="black" cx="30246.61" cy="-15867.11" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="30246.61" y="-15870.91" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="30246.61" y="-15855.91" font-family="Times,serif" font-size="14.00">GPU: 3748</text>
</g>
<!-- m36_res1&#45;&gt;m36_final -->
<g id="edge558" class="edge">
<title>m36_res1&#45;&gt;m36_final</title>
<path fill="none" stroke="black" d="M29905.87,-16427.14C30039.66,-16414.48 30302.61,-16367.23 30302.61,-16191.41 30302.61,-16191.41 30302.61,-16191.41 30302.61,-16078.45 30302.61,-16015.13 30278.62,-15944.58 30262.04,-15903.4"/>
<polygon fill="black" stroke="black" points="30265.25,-15902 30258.22,-15894.08 30258.78,-15904.66 30265.25,-15902"/>
</g>
<!-- m36_gate&#45;&gt;m36_route -->
<g id="edge549" class="edge">
<title>m36_gate&#45;&gt;m36_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29672.61,-16263.82C29672.61,-16255.39 29672.61,-16246.7 29672.61,-16238.4"/>
<polygon fill="black" stroke="black" points="29676.11,-16238.13 29672.61,-16228.13 29669.11,-16238.13 29676.11,-16238.13"/>
</g>
<!-- m36_expert0 -->
<g id="node435" class="node">
<title>m36_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="28756.61" cy="-16079.45" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="28756.61" y="-16090.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="28756.61" y="-16075.75" font-family="Times,serif" font-size="14.00">Node 264 GPU 0</text>
<text text-anchor="middle" x="28756.61" y="-16060.75" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m36_route&#45;&gt;m36_expert0 -->
<g id="edge551" class="edge">
<title>m36_route&#45;&gt;m36_expert0</title>
<path fill="none" stroke="black" d="M29578.3,-16178.21C29458.44,-16163.98 29245.16,-16138.66 29062.61,-16116.93 29035.41,-16113.69 29006.84,-16110.29 28978.54,-16106.92"/>
<polygon fill="black" stroke="black" points="28978.89,-16103.44 28968.55,-16105.73 28978.06,-16110.39 28978.89,-16103.44"/>
</g>
<!-- m36_expert1 -->
<g id="node436" class="node">
<title>m36_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="29367.61" cy="-16079.45" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="29367.61" y="-16090.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="29367.61" y="-16075.75" font-family="Times,serif" font-size="14.00">Node 264 GPU 1</text>
<text text-anchor="middle" x="29367.61" y="-16060.75" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m36_route&#45;&gt;m36_expert1 -->
<g id="edge553" class="edge">
<title>m36_route&#45;&gt;m36_expert1</title>
<path fill="none" stroke="black" d="M29601.49,-16164C29563.44,-16150.41 29515.83,-16133.4 29473.52,-16118.29"/>
<polygon fill="black" stroke="black" points="29474.61,-16114.96 29464.02,-16114.89 29472.26,-16121.55 29474.61,-16114.96"/>
</g>
<!-- m36_expert2 -->
<g id="node437" class="node">
<title>m36_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="29978.61" cy="-16079.45" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="29978.61" y="-16090.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="29978.61" y="-16075.75" font-family="Times,serif" font-size="14.00">Node 264 GPU 2</text>
<text text-anchor="middle" x="29978.61" y="-16060.75" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m36_route&#45;&gt;m36_expert2 -->
<g id="edge555" class="edge">
<title>m36_route&#45;&gt;m36_expert2</title>
<path fill="none" stroke="black" d="M29743.97,-16164C29782.14,-16150.41 29829.9,-16133.4 29872.36,-16118.29"/>
<polygon fill="black" stroke="black" points="29873.64,-16121.55 29881.89,-16114.89 29871.3,-16114.95 29873.64,-16121.55"/>
</g>
<!-- m36_agg -->
<g id="node438" class="node">
<title>m36_agg</title>
<polygon fill="purple" stroke="black" points="29837.23,-16005.98 29576.95,-16005.98 29510,-15929.98 29770.27,-15929.98 29837.23,-16005.98"/>
<text text-anchor="middle" x="29673.61" y="-15971.78" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="29673.61" y="-15956.78" font-family="Times,serif" font-size="14.00">GPU: 3748</text>
</g>
<!-- m36_expert0&#45;&gt;m36_agg -->
<g id="edge552" class="edge">
<title>m36_expert0&#45;&gt;m36_agg</title>
<path fill="none" stroke="black" d="M28968.14,-16053.2C29146.91,-16031.86 29397.08,-16001.99 29546.48,-15984.16"/>
<polygon fill="black" stroke="black" points="29547.1,-15987.61 29556.62,-15982.95 29546.27,-15980.66 29547.1,-15987.61"/>
</g>
<!-- m36_expert1&#45;&gt;m36_agg -->
<g id="edge554" class="edge">
<title>m36_expert1&#45;&gt;m36_agg</title>
<path fill="none" stroke="black" d="M29464.01,-16043.97C29496.3,-16032.41 29532.5,-16019.46 29565.62,-16007.62"/>
<polygon fill="black" stroke="black" points="29567.09,-16010.81 29575.33,-16004.14 29564.73,-16004.21 29567.09,-16010.81"/>
</g>
<!-- m36_expert2&#45;&gt;m36_agg -->
<g id="edge556" class="edge">
<title>m36_expert2&#45;&gt;m36_agg</title>
<path fill="none" stroke="black" d="M29882.53,-16043.97C29852.07,-16033.03 29818.11,-16020.84 29786.57,-16009.52"/>
<polygon fill="black" stroke="black" points="29787.47,-16006.13 29776.87,-16006.04 29785.1,-16012.71 29787.47,-16006.13"/>
</g>
<!-- m36_agg&#45;&gt;m36_final -->
<g id="edge557" class="edge">
<title>m36_agg&#45;&gt;m36_final</title>
<path fill="none" stroke="black" d="M29786.13,-15947.56C29892.17,-15929.27 30049.36,-15902.14 30149.9,-15884.8"/>
<polygon fill="black" stroke="black" points="30150.79,-15888.19 30160.05,-15883.04 30149.6,-15881.3 30150.79,-15888.19"/>
</g>
<!-- m37_res1 -->
<g id="node444" class="node">
<title>m37_res1</title>
<ellipse fill="lightpink" stroke="black" cx="30359.61" cy="-15777.37" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="30359.61" y="-15781.17" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="30359.61" y="-15766.17" font-family="Times,serif" font-size="14.00">GPU: 3749</text>
</g>
<!-- m36_final&#45;&gt;m37_res1 -->
<g id="edge563" class="edge">
<title>m36_final&#45;&gt;m37_res1</title>
<path fill="none" stroke="black" d="M30278.39,-15841.43C30291.6,-15831.18 30307.05,-15819.18 30320.9,-15808.42"/>
<polygon fill="black" stroke="black" points="30323.1,-15811.15 30328.85,-15802.25 30318.81,-15805.62 30323.1,-15811.15"/>
</g>
<!-- m37_ln1 -->
<g id="node440" class="node">
<title>m37_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="30473.61" cy="-16190.41" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="30473.61" y="-16194.21" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="30473.61" y="-16179.21" font-family="Times,serif" font-size="14.00">GPU: 3749</text>
</g>
<!-- m37_qkv -->
<g id="node441" class="node">
<title>m37_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="30473.61" cy="-16079.45" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="30473.61" y="-16083.25" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="30473.61" y="-16068.25" font-family="Times,serif" font-size="14.00">GPU: 3749</text>
</g>
<!-- m37_ln1&#45;&gt;m37_qkv -->
<g id="edge559" class="edge">
<title>m37_ln1&#45;&gt;m37_qkv</title>
<path fill="none" stroke="black" d="M30473.61,-16163.31C30473.61,-16149.3 30473.61,-16131.8 30473.61,-16116.51"/>
<polygon fill="black" stroke="black" points="30477.11,-16116.34 30473.61,-16106.34 30470.11,-16116.34 30477.11,-16116.34"/>
</g>
<!-- m37_mha -->
<g id="node442" class="node">
<title>m37_mha</title>
<ellipse fill="lightblue" stroke="black" cx="30473.61" cy="-15967.98" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="30473.61" y="-15971.78" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="30473.61" y="-15956.78" font-family="Times,serif" font-size="14.00">GPU: 3749</text>
</g>
<!-- m37_qkv&#45;&gt;m37_mha -->
<g id="edge560" class="edge">
<title>m37_qkv&#45;&gt;m37_mha</title>
<path fill="none" stroke="black" d="M30473.61,-16052.51C30473.61,-16038.43 30473.61,-16020.81 30473.61,-16005.38"/>
<polygon fill="black" stroke="black" points="30477.11,-16005.12 30473.61,-15995.12 30470.11,-16005.12 30477.11,-16005.12"/>
</g>
<!-- m37_out -->
<g id="node443" class="node">
<title>m37_out</title>
<ellipse fill="lightblue" stroke="black" cx="30473.61" cy="-15867.11" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="30473.61" y="-15870.91" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="30473.61" y="-15855.91" font-family="Times,serif" font-size="14.00">GPU: 3749</text>
</g>
<!-- m37_mha&#45;&gt;m37_out -->
<g id="edge561" class="edge">
<title>m37_mha&#45;&gt;m37_out</title>
<path fill="none" stroke="black" d="M30473.61,-15941C30473.61,-15929.85 30473.61,-15916.63 30473.61,-15904.52"/>
<polygon fill="black" stroke="black" points="30477.11,-15904.25 30473.61,-15894.25 30470.11,-15904.25 30477.11,-15904.25"/>
</g>
<!-- m37_out&#45;&gt;m37_res1 -->
<g id="edge562" class="edge">
<title>m37_out&#45;&gt;m37_res1</title>
<path fill="none" stroke="black" d="M30441.55,-15841.43C30428.23,-15831.18 30412.64,-15819.18 30398.66,-15808.42"/>
<polygon fill="black" stroke="black" points="30400.7,-15805.58 30390.64,-15802.25 30396.43,-15811.12 30400.7,-15805.58"/>
</g>
<!-- m37_gate -->
<g id="node445" class="node">
<title>m37_gate</title>
<polygon fill="orange" stroke="black" points="30331.23,-15714.5 30126.63,-15714.5 30074,-15608.5 30278.59,-15608.5 30331.23,-15714.5"/>
<text text-anchor="middle" x="30202.61" y="-15672.8" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="30202.61" y="-15657.8" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="30202.61" y="-15642.8" font-family="Times,serif" font-size="14.00">GPU: 3749</text>
</g>
<!-- m37_res1&#45;&gt;m37_gate -->
<g id="edge564" class="edge">
<title>m37_res1&#45;&gt;m37_gate</title>
<path fill="none" stroke="black" d="M30327.08,-15752.77C30314.08,-15743.34 30298.48,-15732.03 30282.79,-15720.65"/>
<polygon fill="black" stroke="black" points="30284.74,-15717.74 30274.59,-15714.7 30280.63,-15723.41 30284.74,-15717.74"/>
</g>
<!-- m37_route -->
<g id="node446" class="node">
<title>m37_route</title>
<ellipse fill="lightgray" stroke="black" cx="30202.61" cy="-15535.02" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="30202.61" y="-15546.32" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="30202.61" y="-15531.32" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="30202.61" y="-15516.32" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m37_res1&#45;&gt;m37_route -->
<g id="edge566" class="edge">
<title>m37_res1&#45;&gt;m37_route</title>
<path fill="none" stroke="black" d="M30363.67,-15750.52C30367.79,-15715.19 30369.92,-15651.35 30340.61,-15608.5 30327.5,-15589.33 30307.68,-15574.87 30287.11,-15564.12"/>
<polygon fill="black" stroke="black" points="30288.47,-15560.88 30277.95,-15559.58 30285.36,-15567.16 30288.47,-15560.88"/>
</g>
<!-- m37_final -->
<g id="node451" class="node">
<title>m37_final</title>
<ellipse fill="lightpink" stroke="black" cx="30776.61" cy="-15211.72" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="30776.61" y="-15215.52" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="30776.61" y="-15200.52" font-family="Times,serif" font-size="14.00">GPU: 3749</text>
</g>
<!-- m37_res1&#45;&gt;m37_final -->
<g id="edge574" class="edge">
<title>m37_res1&#45;&gt;m37_final</title>
<path fill="none" stroke="black" d="M30435.87,-15771.75C30569.66,-15759.09 30832.61,-15711.84 30832.61,-15536.02 30832.61,-15536.02 30832.61,-15536.02 30832.61,-15423.07 30832.61,-15359.74 30808.62,-15289.2 30792.04,-15248.01"/>
<polygon fill="black" stroke="black" points="30795.25,-15246.61 30788.22,-15238.69 30788.78,-15249.27 30795.25,-15246.61"/>
</g>
<!-- m37_gate&#45;&gt;m37_route -->
<g id="edge565" class="edge">
<title>m37_gate&#45;&gt;m37_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30202.61,-15608.43C30202.61,-15600 30202.61,-15591.31 30202.61,-15583.01"/>
<polygon fill="black" stroke="black" points="30206.11,-15582.75 30202.61,-15572.75 30199.11,-15582.75 30206.11,-15582.75"/>
</g>
<!-- m37_expert0 -->
<g id="node447" class="node">
<title>m37_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="29286.61" cy="-15424.07" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="29286.61" y="-15435.37" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="29286.61" y="-15420.37" font-family="Times,serif" font-size="14.00">Node 272 GPU 0</text>
<text text-anchor="middle" x="29286.61" y="-15405.37" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m37_route&#45;&gt;m37_expert0 -->
<g id="edge567" class="edge">
<title>m37_route&#45;&gt;m37_expert0</title>
<path fill="none" stroke="black" d="M30108.3,-15522.83C29988.44,-15508.6 29775.16,-15483.27 29592.61,-15461.54 29565.41,-15458.31 29536.84,-15454.9 29508.54,-15451.53"/>
<polygon fill="black" stroke="black" points="29508.89,-15448.05 29498.55,-15450.34 29508.06,-15455 29508.89,-15448.05"/>
</g>
<!-- m37_expert1 -->
<g id="node448" class="node">
<title>m37_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="29897.61" cy="-15424.07" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="29897.61" y="-15435.37" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="29897.61" y="-15420.37" font-family="Times,serif" font-size="14.00">Node 272 GPU 1</text>
<text text-anchor="middle" x="29897.61" y="-15405.37" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m37_route&#45;&gt;m37_expert1 -->
<g id="edge569" class="edge">
<title>m37_route&#45;&gt;m37_expert1</title>
<path fill="none" stroke="black" d="M30131.49,-15508.61C30093.44,-15495.02 30045.83,-15478.02 30003.52,-15462.9"/>
<polygon fill="black" stroke="black" points="30004.61,-15459.57 29994.02,-15459.51 30002.26,-15466.17 30004.61,-15459.57"/>
</g>
<!-- m37_expert2 -->
<g id="node449" class="node">
<title>m37_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="30508.61" cy="-15424.07" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="30508.61" y="-15435.37" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="30508.61" y="-15420.37" font-family="Times,serif" font-size="14.00">Node 272 GPU 2</text>
<text text-anchor="middle" x="30508.61" y="-15405.37" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m37_route&#45;&gt;m37_expert2 -->
<g id="edge571" class="edge">
<title>m37_route&#45;&gt;m37_expert2</title>
<path fill="none" stroke="black" d="M30273.97,-15508.61C30312.14,-15495.02 30359.9,-15478.02 30402.36,-15462.9"/>
<polygon fill="black" stroke="black" points="30403.64,-15466.16 30411.89,-15459.51 30401.3,-15459.56 30403.64,-15466.16"/>
</g>
<!-- m37_agg -->
<g id="node450" class="node">
<title>m37_agg</title>
<polygon fill="purple" stroke="black" points="30367.23,-15350.59 30106.95,-15350.59 30040,-15274.59 30300.27,-15274.59 30367.23,-15350.59"/>
<text text-anchor="middle" x="30203.61" y="-15316.39" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="30203.61" y="-15301.39" font-family="Times,serif" font-size="14.00">GPU: 3749</text>
</g>
<!-- m37_expert0&#45;&gt;m37_agg -->
<g id="edge568" class="edge">
<title>m37_expert0&#45;&gt;m37_agg</title>
<path fill="none" stroke="black" d="M29498.14,-15397.81C29676.91,-15376.47 29927.08,-15346.61 30076.48,-15328.77"/>
<polygon fill="black" stroke="black" points="30077.1,-15332.22 30086.62,-15327.56 30076.27,-15325.27 30077.1,-15332.22"/>
</g>
<!-- m37_expert1&#45;&gt;m37_agg -->
<g id="edge570" class="edge">
<title>m37_expert1&#45;&gt;m37_agg</title>
<path fill="none" stroke="black" d="M29994.01,-15388.58C30026.3,-15377.03 30062.5,-15364.08 30095.62,-15352.23"/>
<polygon fill="black" stroke="black" points="30097.09,-15355.42 30105.33,-15348.75 30094.73,-15348.83 30097.09,-15355.42"/>
</g>
<!-- m37_expert2&#45;&gt;m37_agg -->
<g id="edge572" class="edge">
<title>m37_expert2&#45;&gt;m37_agg</title>
<path fill="none" stroke="black" d="M30412.53,-15388.58C30382.07,-15377.65 30348.11,-15365.46 30316.57,-15354.14"/>
<polygon fill="black" stroke="black" points="30317.47,-15350.74 30306.87,-15350.66 30315.1,-15357.33 30317.47,-15350.74"/>
</g>
<!-- m37_agg&#45;&gt;m37_final -->
<g id="edge573" class="edge">
<title>m37_agg&#45;&gt;m37_final</title>
<path fill="none" stroke="black" d="M30316.13,-15292.18C30422.17,-15273.88 30579.36,-15246.76 30679.9,-15229.41"/>
<polygon fill="black" stroke="black" points="30680.79,-15232.81 30690.05,-15227.66 30679.6,-15225.91 30680.79,-15232.81"/>
</g>
<!-- m38_res1 -->
<g id="node456" class="node">
<title>m38_res1</title>
<ellipse fill="lightpink" stroke="black" cx="30889.61" cy="-15121.98" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="30889.61" y="-15125.78" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="30889.61" y="-15110.78" font-family="Times,serif" font-size="14.00">GPU: 3750</text>
</g>
<!-- m37_final&#45;&gt;m38_res1 -->
<g id="edge579" class="edge">
<title>m37_final&#45;&gt;m38_res1</title>
<path fill="none" stroke="black" d="M30808.39,-15186.05C30821.6,-15175.79 30837.05,-15163.8 30850.9,-15153.04"/>
<polygon fill="black" stroke="black" points="30853.1,-15155.76 30858.85,-15146.87 30848.81,-15150.23 30853.1,-15155.76"/>
</g>
<!-- m38_ln1 -->
<g id="node452" class="node">
<title>m38_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="31003.61" cy="-15535.02" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="31003.61" y="-15538.82" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="31003.61" y="-15523.82" font-family="Times,serif" font-size="14.00">GPU: 3750</text>
</g>
<!-- m38_qkv -->
<g id="node453" class="node">
<title>m38_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="31003.61" cy="-15424.07" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="31003.61" y="-15427.87" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="31003.61" y="-15412.87" font-family="Times,serif" font-size="14.00">GPU: 3750</text>
</g>
<!-- m38_ln1&#45;&gt;m38_qkv -->
<g id="edge575" class="edge">
<title>m38_ln1&#45;&gt;m38_qkv</title>
<path fill="none" stroke="black" d="M31003.61,-15507.92C31003.61,-15493.91 31003.61,-15476.42 31003.61,-15461.12"/>
<polygon fill="black" stroke="black" points="31007.11,-15460.95 31003.61,-15450.95 31000.11,-15460.95 31007.11,-15460.95"/>
</g>
<!-- m38_mha -->
<g id="node454" class="node">
<title>m38_mha</title>
<ellipse fill="lightblue" stroke="black" cx="31003.61" cy="-15312.59" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="31003.61" y="-15316.39" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="31003.61" y="-15301.39" font-family="Times,serif" font-size="14.00">GPU: 3750</text>
</g>
<!-- m38_qkv&#45;&gt;m38_mha -->
<g id="edge576" class="edge">
<title>m38_qkv&#45;&gt;m38_mha</title>
<path fill="none" stroke="black" d="M31003.61,-15397.12C31003.61,-15383.05 31003.61,-15365.42 31003.61,-15349.99"/>
<polygon fill="black" stroke="black" points="31007.11,-15349.73 31003.61,-15339.73 31000.11,-15349.73 31007.11,-15349.73"/>
</g>
<!-- m38_out -->
<g id="node455" class="node">
<title>m38_out</title>
<ellipse fill="lightblue" stroke="black" cx="31003.61" cy="-15211.72" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="31003.61" y="-15215.52" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="31003.61" y="-15200.52" font-family="Times,serif" font-size="14.00">GPU: 3750</text>
</g>
<!-- m38_mha&#45;&gt;m38_out -->
<g id="edge577" class="edge">
<title>m38_mha&#45;&gt;m38_out</title>
<path fill="none" stroke="black" d="M31003.61,-15285.61C31003.61,-15274.46 31003.61,-15261.24 31003.61,-15249.14"/>
<polygon fill="black" stroke="black" points="31007.11,-15248.87 31003.61,-15238.87 31000.11,-15248.87 31007.11,-15248.87"/>
</g>
<!-- m38_out&#45;&gt;m38_res1 -->
<g id="edge578" class="edge">
<title>m38_out&#45;&gt;m38_res1</title>
<path fill="none" stroke="black" d="M30971.55,-15186.05C30958.23,-15175.79 30942.64,-15163.8 30928.66,-15153.04"/>
<polygon fill="black" stroke="black" points="30930.7,-15150.19 30920.64,-15146.87 30926.43,-15155.74 30930.7,-15150.19"/>
</g>
<!-- m38_gate -->
<g id="node457" class="node">
<title>m38_gate</title>
<polygon fill="orange" stroke="black" points="30861.23,-15059.11 30656.63,-15059.11 30604,-14953.11 30808.59,-14953.11 30861.23,-15059.11"/>
<text text-anchor="middle" x="30732.61" y="-15017.41" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="30732.61" y="-15002.41" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="30732.61" y="-14987.41" font-family="Times,serif" font-size="14.00">GPU: 3750</text>
</g>
<!-- m38_res1&#45;&gt;m38_gate -->
<g id="edge580" class="edge">
<title>m38_res1&#45;&gt;m38_gate</title>
<path fill="none" stroke="black" d="M30857.08,-15097.39C30844.08,-15087.96 30828.48,-15076.64 30812.79,-15065.26"/>
<polygon fill="black" stroke="black" points="30814.74,-15062.35 30804.59,-15059.32 30810.63,-15068.02 30814.74,-15062.35"/>
</g>
<!-- m38_route -->
<g id="node458" class="node">
<title>m38_route</title>
<ellipse fill="lightgray" stroke="black" cx="30732.61" cy="-14879.63" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="30732.61" y="-14890.93" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="30732.61" y="-14875.93" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="30732.61" y="-14860.93" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m38_res1&#45;&gt;m38_route -->
<g id="edge582" class="edge">
<title>m38_res1&#45;&gt;m38_route</title>
<path fill="none" stroke="black" d="M30893.67,-15095.13C30897.79,-15059.81 30899.92,-14995.96 30870.61,-14953.11 30857.5,-14933.95 30837.68,-14919.49 30817.11,-14908.73"/>
<polygon fill="black" stroke="black" points="30818.47,-14905.5 30807.95,-14904.2 30815.36,-14911.77 30818.47,-14905.5"/>
</g>
<!-- m38_final -->
<g id="node463" class="node">
<title>m38_final</title>
<ellipse fill="lightpink" stroke="black" cx="31306.61" cy="-14556.33" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="31306.61" y="-14560.13" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="31306.61" y="-14545.13" font-family="Times,serif" font-size="14.00">GPU: 3750</text>
</g>
<!-- m38_res1&#45;&gt;m38_final -->
<g id="edge590" class="edge">
<title>m38_res1&#45;&gt;m38_final</title>
<path fill="none" stroke="black" d="M30965.87,-15116.37C31099.66,-15103.7 31362.61,-15056.45 31362.61,-14880.63 31362.61,-14880.63 31362.61,-14880.63 31362.61,-14767.68 31362.61,-14704.36 31338.62,-14633.81 31322.04,-14592.63"/>
<polygon fill="black" stroke="black" points="31325.25,-14591.23 31318.22,-14583.31 31318.78,-14593.89 31325.25,-14591.23"/>
</g>
<!-- m38_gate&#45;&gt;m38_route -->
<g id="edge581" class="edge">
<title>m38_gate&#45;&gt;m38_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30732.61,-14953.04C30732.61,-14944.61 30732.61,-14935.92 30732.61,-14927.62"/>
<polygon fill="black" stroke="black" points="30736.11,-14927.36 30732.61,-14917.36 30729.11,-14927.36 30736.11,-14927.36"/>
</g>
<!-- m38_expert0 -->
<g id="node459" class="node">
<title>m38_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="29816.61" cy="-14768.68" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="29816.61" y="-14779.98" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="29816.61" y="-14764.98" font-family="Times,serif" font-size="14.00">Node 280 GPU 0</text>
<text text-anchor="middle" x="29816.61" y="-14749.98" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m38_route&#45;&gt;m38_expert0 -->
<g id="edge583" class="edge">
<title>m38_route&#45;&gt;m38_expert0</title>
<path fill="none" stroke="black" d="M30638.3,-14867.44C30518.44,-14853.21 30305.16,-14827.88 30122.61,-14806.16 30095.41,-14802.92 30066.84,-14799.52 30038.54,-14796.15"/>
<polygon fill="black" stroke="black" points="30038.89,-14792.66 30028.55,-14794.96 30038.06,-14799.61 30038.89,-14792.66"/>
</g>
<!-- m38_expert1 -->
<g id="node460" class="node">
<title>m38_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="30427.61" cy="-14768.68" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="30427.61" y="-14779.98" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="30427.61" y="-14764.98" font-family="Times,serif" font-size="14.00">Node 280 GPU 1</text>
<text text-anchor="middle" x="30427.61" y="-14749.98" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m38_route&#45;&gt;m38_expert1 -->
<g id="edge585" class="edge">
<title>m38_route&#45;&gt;m38_expert1</title>
<path fill="none" stroke="black" d="M30661.49,-14853.23C30623.44,-14839.64 30575.83,-14822.63 30533.52,-14807.51"/>
<polygon fill="black" stroke="black" points="30534.61,-14804.19 30524.02,-14804.12 30532.26,-14810.78 30534.61,-14804.19"/>
</g>
<!-- m38_expert2 -->
<g id="node461" class="node">
<title>m38_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="31038.61" cy="-14768.68" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="31038.61" y="-14779.98" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="31038.61" y="-14764.98" font-family="Times,serif" font-size="14.00">Node 280 GPU 2</text>
<text text-anchor="middle" x="31038.61" y="-14749.98" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m38_route&#45;&gt;m38_expert2 -->
<g id="edge587" class="edge">
<title>m38_route&#45;&gt;m38_expert2</title>
<path fill="none" stroke="black" d="M30803.97,-14853.23C30842.14,-14839.64 30889.9,-14822.63 30932.36,-14807.51"/>
<polygon fill="black" stroke="black" points="30933.64,-14810.77 30941.89,-14804.12 30931.3,-14804.18 30933.64,-14810.77"/>
</g>
<!-- m38_agg -->
<g id="node462" class="node">
<title>m38_agg</title>
<polygon fill="purple" stroke="black" points="30897.23,-14695.2 30636.95,-14695.2 30570,-14619.2 30830.27,-14619.2 30897.23,-14695.2"/>
<text text-anchor="middle" x="30733.61" y="-14661" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="30733.61" y="-14646" font-family="Times,serif" font-size="14.00">GPU: 3750</text>
</g>
<!-- m38_expert0&#45;&gt;m38_agg -->
<g id="edge584" class="edge">
<title>m38_expert0&#45;&gt;m38_agg</title>
<path fill="none" stroke="black" d="M30028.14,-14742.43C30206.91,-14721.08 30457.08,-14691.22 30606.48,-14673.38"/>
<polygon fill="black" stroke="black" points="30607.1,-14676.83 30616.62,-14672.17 30606.27,-14669.88 30607.1,-14676.83"/>
</g>
<!-- m38_expert1&#45;&gt;m38_agg -->
<g id="edge586" class="edge">
<title>m38_expert1&#45;&gt;m38_agg</title>
<path fill="none" stroke="black" d="M30524.01,-14733.19C30556.3,-14721.64 30592.5,-14708.69 30625.62,-14696.84"/>
<polygon fill="black" stroke="black" points="30627.09,-14700.03 30635.33,-14693.37 30624.73,-14693.44 30627.09,-14700.03"/>
</g>
<!-- m38_expert2&#45;&gt;m38_agg -->
<g id="edge588" class="edge">
<title>m38_expert2&#45;&gt;m38_agg</title>
<path fill="none" stroke="black" d="M30942.53,-14733.19C30912.07,-14722.26 30878.11,-14710.07 30846.57,-14698.75"/>
<polygon fill="black" stroke="black" points="30847.47,-14695.35 30836.87,-14695.27 30845.1,-14701.94 30847.47,-14695.35"/>
</g>
<!-- m38_agg&#45;&gt;m38_final -->
<g id="edge589" class="edge">
<title>m38_agg&#45;&gt;m38_final</title>
<path fill="none" stroke="black" d="M30846.13,-14636.79C30952.17,-14618.49 31109.36,-14591.37 31209.9,-14574.02"/>
<polygon fill="black" stroke="black" points="31210.79,-14577.42 31220.05,-14572.27 31209.6,-14570.52 31210.79,-14577.42"/>
</g>
<!-- m39_res1 -->
<g id="node468" class="node">
<title>m39_res1</title>
<ellipse fill="lightpink" stroke="black" cx="31419.61" cy="-14466.59" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="31419.61" y="-14470.39" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="31419.61" y="-14455.39" font-family="Times,serif" font-size="14.00">GPU: 3751</text>
</g>
<!-- m38_final&#45;&gt;m39_res1 -->
<g id="edge595" class="edge">
<title>m38_final&#45;&gt;m39_res1</title>
<path fill="none" stroke="black" d="M31338.39,-14530.66C31351.6,-14520.41 31367.05,-14508.41 31380.9,-14497.65"/>
<polygon fill="black" stroke="black" points="31383.1,-14500.38 31388.85,-14491.48 31378.81,-14494.85 31383.1,-14500.38"/>
</g>
<!-- m39_ln1 -->
<g id="node464" class="node">
<title>m39_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="31533.61" cy="-14879.63" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="31533.61" y="-14883.43" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="31533.61" y="-14868.43" font-family="Times,serif" font-size="14.00">GPU: 3751</text>
</g>
<!-- m39_qkv -->
<g id="node465" class="node">
<title>m39_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="31533.61" cy="-14768.68" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="31533.61" y="-14772.48" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="31533.61" y="-14757.48" font-family="Times,serif" font-size="14.00">GPU: 3751</text>
</g>
<!-- m39_ln1&#45;&gt;m39_qkv -->
<g id="edge591" class="edge">
<title>m39_ln1&#45;&gt;m39_qkv</title>
<path fill="none" stroke="black" d="M31533.61,-14852.54C31533.61,-14838.52 31533.61,-14821.03 31533.61,-14805.73"/>
<polygon fill="black" stroke="black" points="31537.11,-14805.57 31533.61,-14795.57 31530.11,-14805.57 31537.11,-14805.57"/>
</g>
<!-- m39_mha -->
<g id="node466" class="node">
<title>m39_mha</title>
<ellipse fill="lightblue" stroke="black" cx="31533.61" cy="-14657.2" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="31533.61" y="-14661" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="31533.61" y="-14646" font-family="Times,serif" font-size="14.00">GPU: 3751</text>
</g>
<!-- m39_qkv&#45;&gt;m39_mha -->
<g id="edge592" class="edge">
<title>m39_qkv&#45;&gt;m39_mha</title>
<path fill="none" stroke="black" d="M31533.61,-14741.74C31533.61,-14727.66 31533.61,-14710.03 31533.61,-14694.6"/>
<polygon fill="black" stroke="black" points="31537.11,-14694.34 31533.61,-14684.34 31530.11,-14694.34 31537.11,-14694.34"/>
</g>
<!-- m39_out -->
<g id="node467" class="node">
<title>m39_out</title>
<ellipse fill="lightblue" stroke="black" cx="31533.61" cy="-14556.33" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="31533.61" y="-14560.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="31533.61" y="-14545.13" font-family="Times,serif" font-size="14.00">GPU: 3751</text>
</g>
<!-- m39_mha&#45;&gt;m39_out -->
<g id="edge593" class="edge">
<title>m39_mha&#45;&gt;m39_out</title>
<path fill="none" stroke="black" d="M31533.61,-14630.23C31533.61,-14619.08 31533.61,-14605.85 31533.61,-14593.75"/>
<polygon fill="black" stroke="black" points="31537.11,-14593.48 31533.61,-14583.48 31530.11,-14593.48 31537.11,-14593.48"/>
</g>
<!-- m39_out&#45;&gt;m39_res1 -->
<g id="edge594" class="edge">
<title>m39_out&#45;&gt;m39_res1</title>
<path fill="none" stroke="black" d="M31501.55,-14530.66C31488.23,-14520.41 31472.64,-14508.41 31458.66,-14497.65"/>
<polygon fill="black" stroke="black" points="31460.7,-14494.8 31450.64,-14491.48 31456.43,-14500.35 31460.7,-14494.8"/>
</g>
<!-- m39_gate -->
<g id="node469" class="node">
<title>m39_gate</title>
<polygon fill="orange" stroke="black" points="31391.23,-14403.72 31186.63,-14403.72 31134,-14297.72 31338.59,-14297.72 31391.23,-14403.72"/>
<text text-anchor="middle" x="31262.61" y="-14362.02" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="31262.61" y="-14347.02" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="31262.61" y="-14332.02" font-family="Times,serif" font-size="14.00">GPU: 3751</text>
</g>
<!-- m39_res1&#45;&gt;m39_gate -->
<g id="edge596" class="edge">
<title>m39_res1&#45;&gt;m39_gate</title>
<path fill="none" stroke="black" d="M31387.08,-14442C31374.08,-14432.57 31358.48,-14421.26 31342.79,-14409.88"/>
<polygon fill="black" stroke="black" points="31344.74,-14406.97 31334.59,-14403.93 31340.63,-14412.63 31344.74,-14406.97"/>
</g>
<!-- m39_route -->
<g id="node470" class="node">
<title>m39_route</title>
<ellipse fill="lightgray" stroke="black" cx="31262.61" cy="-14224.25" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="31262.61" y="-14235.55" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="31262.61" y="-14220.55" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="31262.61" y="-14205.55" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m39_res1&#45;&gt;m39_route -->
<g id="edge598" class="edge">
<title>m39_res1&#45;&gt;m39_route</title>
<path fill="none" stroke="black" d="M31423.67,-14439.74C31427.79,-14404.42 31429.92,-14340.57 31400.61,-14297.72 31387.5,-14278.56 31367.68,-14264.1 31347.11,-14253.34"/>
<polygon fill="black" stroke="black" points="31348.47,-14250.11 31337.95,-14248.81 31345.36,-14256.38 31348.47,-14250.11"/>
</g>
<!-- m39_final -->
<g id="node475" class="node">
<title>m39_final</title>
<ellipse fill="lightpink" stroke="black" cx="31836.61" cy="-13900.95" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="31836.61" y="-13904.75" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="31836.61" y="-13889.75" font-family="Times,serif" font-size="14.00">GPU: 3751</text>
</g>
<!-- m39_res1&#45;&gt;m39_final -->
<g id="edge606" class="edge">
<title>m39_res1&#45;&gt;m39_final</title>
<path fill="none" stroke="black" d="M31495.87,-14460.98C31629.66,-14448.32 31892.61,-14401.07 31892.61,-14225.25 31892.61,-14225.25 31892.61,-14225.25 31892.61,-14112.29 31892.61,-14048.97 31868.62,-13978.42 31852.04,-13937.24"/>
<polygon fill="black" stroke="black" points="31855.25,-13935.84 31848.22,-13927.92 31848.78,-13938.5 31855.25,-13935.84"/>
</g>
<!-- m39_gate&#45;&gt;m39_route -->
<g id="edge597" class="edge">
<title>m39_gate&#45;&gt;m39_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31262.61,-14297.66C31262.61,-14289.22 31262.61,-14280.54 31262.61,-14272.24"/>
<polygon fill="black" stroke="black" points="31266.11,-14271.97 31262.61,-14261.97 31259.11,-14271.97 31266.11,-14271.97"/>
</g>
<!-- m39_expert0 -->
<g id="node471" class="node">
<title>m39_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="30346.61" cy="-14113.29" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="30346.61" y="-14124.59" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="30346.61" y="-14109.59" font-family="Times,serif" font-size="14.00">Node 288 GPU 0</text>
<text text-anchor="middle" x="30346.61" y="-14094.59" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m39_route&#45;&gt;m39_expert0 -->
<g id="edge599" class="edge">
<title>m39_route&#45;&gt;m39_expert0</title>
<path fill="none" stroke="black" d="M31168.3,-14212.05C31048.44,-14197.82 30835.16,-14172.5 30652.61,-14150.77 30625.41,-14147.53 30596.84,-14144.13 30568.54,-14140.76"/>
<polygon fill="black" stroke="black" points="30568.89,-14137.28 30558.55,-14139.57 30568.06,-14144.23 30568.89,-14137.28"/>
</g>
<!-- m39_expert1 -->
<g id="node472" class="node">
<title>m39_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="30957.61" cy="-14113.29" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="30957.61" y="-14124.59" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="30957.61" y="-14109.59" font-family="Times,serif" font-size="14.00">Node 288 GPU 1</text>
<text text-anchor="middle" x="30957.61" y="-14094.59" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m39_route&#45;&gt;m39_expert1 -->
<g id="edge601" class="edge">
<title>m39_route&#45;&gt;m39_expert1</title>
<path fill="none" stroke="black" d="M31191.49,-14197.84C31153.44,-14184.25 31105.83,-14167.24 31063.52,-14152.13"/>
<polygon fill="black" stroke="black" points="31064.61,-14148.8 31054.02,-14148.73 31062.26,-14155.39 31064.61,-14148.8"/>
</g>
<!-- m39_expert2 -->
<g id="node473" class="node">
<title>m39_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="31568.61" cy="-14113.29" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="31568.61" y="-14124.59" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="31568.61" y="-14109.59" font-family="Times,serif" font-size="14.00">Node 288 GPU 2</text>
<text text-anchor="middle" x="31568.61" y="-14094.59" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m39_route&#45;&gt;m39_expert2 -->
<g id="edge603" class="edge">
<title>m39_route&#45;&gt;m39_expert2</title>
<path fill="none" stroke="black" d="M31333.97,-14197.84C31372.14,-14184.25 31419.9,-14167.24 31462.36,-14152.13"/>
<polygon fill="black" stroke="black" points="31463.64,-14155.38 31471.89,-14148.73 31461.3,-14148.79 31463.64,-14155.38"/>
</g>
<!-- m39_agg -->
<g id="node474" class="node">
<title>m39_agg</title>
<polygon fill="purple" stroke="black" points="31427.23,-14039.82 31166.95,-14039.82 31100,-13963.82 31360.27,-13963.82 31427.23,-14039.82"/>
<text text-anchor="middle" x="31263.61" y="-14005.62" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="31263.61" y="-13990.62" font-family="Times,serif" font-size="14.00">GPU: 3751</text>
</g>
<!-- m39_expert0&#45;&gt;m39_agg -->
<g id="edge600" class="edge">
<title>m39_expert0&#45;&gt;m39_agg</title>
<path fill="none" stroke="black" d="M30558.14,-14087.04C30736.91,-14065.7 30987.08,-14035.83 31136.48,-14018"/>
<polygon fill="black" stroke="black" points="31137.1,-14021.45 31146.62,-14016.79 31136.27,-14014.5 31137.1,-14021.45"/>
</g>
<!-- m39_expert1&#45;&gt;m39_agg -->
<g id="edge602" class="edge">
<title>m39_expert1&#45;&gt;m39_agg</title>
<path fill="none" stroke="black" d="M31054.01,-14077.81C31086.3,-14066.25 31122.5,-14053.3 31155.62,-14041.45"/>
<polygon fill="black" stroke="black" points="31157.09,-14044.64 31165.33,-14037.98 31154.73,-14038.05 31157.09,-14044.64"/>
</g>
<!-- m39_expert2&#45;&gt;m39_agg -->
<g id="edge604" class="edge">
<title>m39_expert2&#45;&gt;m39_agg</title>
<path fill="none" stroke="black" d="M31472.53,-14077.81C31442.07,-14066.87 31408.11,-14054.68 31376.57,-14043.36"/>
<polygon fill="black" stroke="black" points="31377.47,-14039.97 31366.87,-14039.88 31375.1,-14046.55 31377.47,-14039.97"/>
</g>
<!-- m39_agg&#45;&gt;m39_final -->
<g id="edge605" class="edge">
<title>m39_agg&#45;&gt;m39_final</title>
<path fill="none" stroke="black" d="M31376.13,-13981.4C31482.17,-13963.11 31639.36,-13935.98 31739.9,-13918.64"/>
<polygon fill="black" stroke="black" points="31740.79,-13922.03 31750.05,-13916.88 31739.6,-13915.14 31740.79,-13922.03"/>
</g>
<!-- m40_res1 -->
<g id="node480" class="node">
<title>m40_res1</title>
<ellipse fill="lightpink" stroke="black" cx="31949.61" cy="-13811.21" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="31949.61" y="-13815.01" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="31949.61" y="-13800.01" font-family="Times,serif" font-size="14.00">GPU: 3752</text>
</g>
<!-- m39_final&#45;&gt;m40_res1 -->
<g id="edge611" class="edge">
<title>m39_final&#45;&gt;m40_res1</title>
<path fill="none" stroke="black" d="M31868.39,-13875.27C31881.6,-13865.02 31897.05,-13853.02 31910.9,-13842.26"/>
<polygon fill="black" stroke="black" points="31913.1,-13844.99 31918.85,-13836.09 31908.81,-13839.46 31913.1,-13844.99"/>
</g>
<!-- m40_ln1 -->
<g id="node476" class="node">
<title>m40_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="32063.61" cy="-14224.25" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="32063.61" y="-14228.05" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="32063.61" y="-14213.05" font-family="Times,serif" font-size="14.00">GPU: 3752</text>
</g>
<!-- m40_qkv -->
<g id="node477" class="node">
<title>m40_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="32063.61" cy="-14113.29" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="32063.61" y="-14117.09" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="32063.61" y="-14102.09" font-family="Times,serif" font-size="14.00">GPU: 3752</text>
</g>
<!-- m40_ln1&#45;&gt;m40_qkv -->
<g id="edge607" class="edge">
<title>m40_ln1&#45;&gt;m40_qkv</title>
<path fill="none" stroke="black" d="M32063.61,-14197.15C32063.61,-14183.14 32063.61,-14165.64 32063.61,-14150.35"/>
<polygon fill="black" stroke="black" points="32067.11,-14150.18 32063.61,-14140.18 32060.11,-14150.18 32067.11,-14150.18"/>
</g>
<!-- m40_mha -->
<g id="node478" class="node">
<title>m40_mha</title>
<ellipse fill="lightblue" stroke="black" cx="32063.61" cy="-14001.82" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="32063.61" y="-14005.62" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="32063.61" y="-13990.62" font-family="Times,serif" font-size="14.00">GPU: 3752</text>
</g>
<!-- m40_qkv&#45;&gt;m40_mha -->
<g id="edge608" class="edge">
<title>m40_qkv&#45;&gt;m40_mha</title>
<path fill="none" stroke="black" d="M32063.61,-14086.35C32063.61,-14072.27 32063.61,-14054.65 32063.61,-14039.22"/>
<polygon fill="black" stroke="black" points="32067.11,-14038.96 32063.61,-14028.96 32060.11,-14038.96 32067.11,-14038.96"/>
</g>
<!-- m40_out -->
<g id="node479" class="node">
<title>m40_out</title>
<ellipse fill="lightblue" stroke="black" cx="32063.61" cy="-13900.95" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="32063.61" y="-13904.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="32063.61" y="-13889.75" font-family="Times,serif" font-size="14.00">GPU: 3752</text>
</g>
<!-- m40_mha&#45;&gt;m40_out -->
<g id="edge609" class="edge">
<title>m40_mha&#45;&gt;m40_out</title>
<path fill="none" stroke="black" d="M32063.61,-13974.84C32063.61,-13963.69 32063.61,-13950.46 32063.61,-13938.36"/>
<polygon fill="black" stroke="black" points="32067.11,-13938.09 32063.61,-13928.09 32060.11,-13938.09 32067.11,-13938.09"/>
</g>
<!-- m40_out&#45;&gt;m40_res1 -->
<g id="edge610" class="edge">
<title>m40_out&#45;&gt;m40_res1</title>
<path fill="none" stroke="black" d="M32031.55,-13875.27C32018.23,-13865.02 32002.64,-13853.02 31988.66,-13842.26"/>
<polygon fill="black" stroke="black" points="31990.7,-13839.42 31980.64,-13836.09 31986.43,-13844.96 31990.7,-13839.42"/>
</g>
<!-- m40_gate -->
<g id="node481" class="node">
<title>m40_gate</title>
<polygon fill="orange" stroke="black" points="31921.23,-13748.34 31716.63,-13748.34 31664,-13642.34 31868.59,-13642.34 31921.23,-13748.34"/>
<text text-anchor="middle" x="31792.61" y="-13706.64" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="31792.61" y="-13691.64" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="31792.61" y="-13676.64" font-family="Times,serif" font-size="14.00">GPU: 3752</text>
</g>
<!-- m40_res1&#45;&gt;m40_gate -->
<g id="edge612" class="edge">
<title>m40_res1&#45;&gt;m40_gate</title>
<path fill="none" stroke="black" d="M31917.08,-13786.61C31904.08,-13777.18 31888.48,-13765.87 31872.79,-13754.49"/>
<polygon fill="black" stroke="black" points="31874.74,-13751.58 31864.59,-13748.54 31870.63,-13757.25 31874.74,-13751.58"/>
</g>
<!-- m40_route -->
<g id="node482" class="node">
<title>m40_route</title>
<ellipse fill="lightgray" stroke="black" cx="31792.61" cy="-13568.86" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="31792.61" y="-13580.16" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="31792.61" y="-13565.16" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="31792.61" y="-13550.16" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m40_res1&#45;&gt;m40_route -->
<g id="edge614" class="edge">
<title>m40_res1&#45;&gt;m40_route</title>
<path fill="none" stroke="black" d="M31953.67,-13784.36C31957.79,-13749.03 31959.92,-13685.19 31930.61,-13642.34 31917.5,-13623.17 31897.68,-13608.71 31877.11,-13597.96"/>
<polygon fill="black" stroke="black" points="31878.47,-13594.72 31867.95,-13593.42 31875.36,-13601 31878.47,-13594.72"/>
</g>
<!-- m40_final -->
<g id="node487" class="node">
<title>m40_final</title>
<ellipse fill="lightpink" stroke="black" cx="32365.61" cy="-13245.56" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="32365.61" y="-13249.36" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="32365.61" y="-13234.36" font-family="Times,serif" font-size="14.00">GPU: 3752</text>
</g>
<!-- m40_res1&#45;&gt;m40_final -->
<g id="edge622" class="edge">
<title>m40_res1&#45;&gt;m40_final</title>
<path fill="none" stroke="black" d="M32025.71,-13805.54C32159.21,-13792.78 32421.61,-13745.38 32421.61,-13569.86 32421.61,-13569.86 32421.61,-13569.86 32421.61,-13456.91 32421.61,-13393.58 32397.62,-13323.04 32381.04,-13281.85"/>
<polygon fill="black" stroke="black" points="32384.25,-13280.45 32377.22,-13272.53 32377.78,-13283.11 32384.25,-13280.45"/>
</g>
<!-- m40_gate&#45;&gt;m40_route -->
<g id="edge613" class="edge">
<title>m40_gate&#45;&gt;m40_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31792.61,-13642.27C31792.61,-13633.84 31792.61,-13625.15 31792.61,-13616.85"/>
<polygon fill="black" stroke="black" points="31796.11,-13616.59 31792.61,-13606.59 31789.11,-13616.59 31796.11,-13616.59"/>
</g>
<!-- m40_expert0 -->
<g id="node483" class="node">
<title>m40_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="30875.61" cy="-13457.91" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="30875.61" y="-13469.21" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="30875.61" y="-13454.21" font-family="Times,serif" font-size="14.00">Node 296 GPU 0</text>
<text text-anchor="middle" x="30875.61" y="-13439.21" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m40_route&#45;&gt;m40_expert0 -->
<g id="edge615" class="edge">
<title>m40_route&#45;&gt;m40_expert0</title>
<path fill="none" stroke="black" d="M31698.15,-13556.67C31578.09,-13542.45 31364.46,-13517.13 31181.61,-13495.38 31154.41,-13492.15 31125.84,-13488.75 31097.54,-13485.38"/>
<polygon fill="black" stroke="black" points="31097.89,-13481.89 31087.55,-13484.19 31097.06,-13488.85 31097.89,-13481.89"/>
</g>
<!-- m40_expert1 -->
<g id="node484" class="node">
<title>m40_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="31486.61" cy="-13457.91" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="31486.61" y="-13469.21" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="31486.61" y="-13454.21" font-family="Times,serif" font-size="14.00">Node 296 GPU 1</text>
<text text-anchor="middle" x="31486.61" y="-13439.21" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m40_route&#45;&gt;m40_expert1 -->
<g id="edge617" class="edge">
<title>m40_route&#45;&gt;m40_expert1</title>
<path fill="none" stroke="black" d="M31721.26,-13542.45C31683.08,-13528.86 31635.32,-13511.86 31592.87,-13496.74"/>
<polygon fill="black" stroke="black" points="31593.93,-13493.4 31583.33,-13493.35 31591.58,-13500 31593.93,-13493.4"/>
</g>
<!-- m40_expert2 -->
<g id="node485" class="node">
<title>m40_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="32097.61" cy="-13457.91" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="32097.61" y="-13469.21" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="32097.61" y="-13454.21" font-family="Times,serif" font-size="14.00">Node 296 GPU 2</text>
<text text-anchor="middle" x="32097.61" y="-13439.21" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m40_route&#45;&gt;m40_expert2 -->
<g id="edge619" class="edge">
<title>m40_route&#45;&gt;m40_expert2</title>
<path fill="none" stroke="black" d="M31863.74,-13542.45C31901.78,-13528.86 31949.39,-13511.86 31991.7,-13496.74"/>
<polygon fill="black" stroke="black" points="31992.97,-13500.01 32001.21,-13493.35 31990.61,-13493.41 31992.97,-13500.01"/>
</g>
<!-- m40_agg -->
<g id="node486" class="node">
<title>m40_agg</title>
<polygon fill="purple" stroke="black" points="31956.23,-13384.43 31695.95,-13384.43 31629,-13308.43 31889.27,-13308.43 31956.23,-13384.43"/>
<text text-anchor="middle" x="31792.61" y="-13350.23" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="31792.61" y="-13335.23" font-family="Times,serif" font-size="14.00">GPU: 3752</text>
</g>
<!-- m40_expert0&#45;&gt;m40_agg -->
<g id="edge616" class="edge">
<title>m40_expert0&#45;&gt;m40_agg</title>
<path fill="none" stroke="black" d="M31087.14,-13431.65C31265.91,-13410.31 31516.08,-13380.44 31665.48,-13362.61"/>
<polygon fill="black" stroke="black" points="31666.1,-13366.06 31675.62,-13361.4 31665.27,-13359.11 31666.1,-13366.06"/>
</g>
<!-- m40_expert1&#45;&gt;m40_agg -->
<g id="edge618" class="edge">
<title>m40_expert1&#45;&gt;m40_agg</title>
<path fill="none" stroke="black" d="M31583.01,-13422.42C31615.3,-13410.87 31651.5,-13397.92 31684.62,-13386.07"/>
<polygon fill="black" stroke="black" points="31686.09,-13389.26 31694.33,-13382.59 31683.73,-13382.67 31686.09,-13389.26"/>
</g>
<!-- m40_expert2&#45;&gt;m40_agg -->
<g id="edge620" class="edge">
<title>m40_expert2&#45;&gt;m40_agg</title>
<path fill="none" stroke="black" d="M32001.53,-13422.42C31971.07,-13411.48 31937.11,-13399.3 31905.57,-13387.98"/>
<polygon fill="black" stroke="black" points="31906.47,-13384.58 31895.87,-13384.49 31904.1,-13391.17 31906.47,-13384.58"/>
</g>
<!-- m40_agg&#45;&gt;m40_final -->
<g id="edge621" class="edge">
<title>m40_agg&#45;&gt;m40_final</title>
<path fill="none" stroke="black" d="M31905.13,-13326.02C32011.17,-13307.72 32168.36,-13280.6 32268.9,-13263.25"/>
<polygon fill="black" stroke="black" points="32269.79,-13266.65 32279.05,-13261.5 32268.6,-13259.75 32269.79,-13266.65"/>
</g>
<!-- m41_res1 -->
<g id="node492" class="node">
<title>m41_res1</title>
<ellipse fill="lightpink" stroke="black" cx="32478.61" cy="-13155.82" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="32478.61" y="-13159.62" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="32478.61" y="-13144.62" font-family="Times,serif" font-size="14.00">GPU: 3753</text>
</g>
<!-- m40_final&#45;&gt;m41_res1 -->
<g id="edge627" class="edge">
<title>m40_final&#45;&gt;m41_res1</title>
<path fill="none" stroke="black" d="M32397.39,-13219.89C32410.6,-13209.63 32426.05,-13197.64 32439.9,-13186.88"/>
<polygon fill="black" stroke="black" points="32442.1,-13189.6 32447.85,-13180.7 32437.81,-13184.07 32442.1,-13189.6"/>
</g>
<!-- m41_ln1 -->
<g id="node488" class="node">
<title>m41_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="32592.61" cy="-13568.86" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="32592.61" y="-13572.66" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="32592.61" y="-13557.66" font-family="Times,serif" font-size="14.00">GPU: 3753</text>
</g>
<!-- m41_qkv -->
<g id="node489" class="node">
<title>m41_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="32592.61" cy="-13457.91" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="32592.61" y="-13461.71" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="32592.61" y="-13446.71" font-family="Times,serif" font-size="14.00">GPU: 3753</text>
</g>
<!-- m41_ln1&#45;&gt;m41_qkv -->
<g id="edge623" class="edge">
<title>m41_ln1&#45;&gt;m41_qkv</title>
<path fill="none" stroke="black" d="M32592.61,-13541.76C32592.61,-13527.75 32592.61,-13510.26 32592.61,-13494.96"/>
<polygon fill="black" stroke="black" points="32596.11,-13494.79 32592.61,-13484.79 32589.11,-13494.79 32596.11,-13494.79"/>
</g>
<!-- m41_mha -->
<g id="node490" class="node">
<title>m41_mha</title>
<ellipse fill="lightblue" stroke="black" cx="32592.61" cy="-13346.43" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="32592.61" y="-13350.23" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="32592.61" y="-13335.23" font-family="Times,serif" font-size="14.00">GPU: 3753</text>
</g>
<!-- m41_qkv&#45;&gt;m41_mha -->
<g id="edge624" class="edge">
<title>m41_qkv&#45;&gt;m41_mha</title>
<path fill="none" stroke="black" d="M32592.61,-13430.96C32592.61,-13416.89 32592.61,-13399.26 32592.61,-13383.83"/>
<polygon fill="black" stroke="black" points="32596.11,-13383.57 32592.61,-13373.57 32589.11,-13383.57 32596.11,-13383.57"/>
</g>
<!-- m41_out -->
<g id="node491" class="node">
<title>m41_out</title>
<ellipse fill="lightblue" stroke="black" cx="32592.61" cy="-13245.56" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="32592.61" y="-13249.36" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="32592.61" y="-13234.36" font-family="Times,serif" font-size="14.00">GPU: 3753</text>
</g>
<!-- m41_mha&#45;&gt;m41_out -->
<g id="edge625" class="edge">
<title>m41_mha&#45;&gt;m41_out</title>
<path fill="none" stroke="black" d="M32592.61,-13319.45C32592.61,-13308.3 32592.61,-13295.08 32592.61,-13282.97"/>
<polygon fill="black" stroke="black" points="32596.11,-13282.71 32592.61,-13272.71 32589.11,-13282.71 32596.11,-13282.71"/>
</g>
<!-- m41_out&#45;&gt;m41_res1 -->
<g id="edge626" class="edge">
<title>m41_out&#45;&gt;m41_res1</title>
<path fill="none" stroke="black" d="M32560.55,-13219.89C32547.23,-13209.63 32531.64,-13197.64 32517.66,-13186.88"/>
<polygon fill="black" stroke="black" points="32519.7,-13184.03 32509.64,-13180.7 32515.43,-13189.58 32519.7,-13184.03"/>
</g>
<!-- m41_gate -->
<g id="node493" class="node">
<title>m41_gate</title>
<polygon fill="orange" stroke="black" points="32450.23,-13092.95 32245.63,-13092.95 32193,-12986.95 32397.59,-12986.95 32450.23,-13092.95"/>
<text text-anchor="middle" x="32321.61" y="-13051.25" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="32321.61" y="-13036.25" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="32321.61" y="-13021.25" font-family="Times,serif" font-size="14.00">GPU: 3753</text>
</g>
<!-- m41_res1&#45;&gt;m41_gate -->
<g id="edge628" class="edge">
<title>m41_res1&#45;&gt;m41_gate</title>
<path fill="none" stroke="black" d="M32446.08,-13131.23C32433.08,-13121.8 32417.48,-13110.48 32401.79,-13099.1"/>
<polygon fill="black" stroke="black" points="32403.74,-13096.19 32393.59,-13093.15 32399.63,-13101.86 32403.74,-13096.19"/>
</g>
<!-- m41_route -->
<g id="node494" class="node">
<title>m41_route</title>
<ellipse fill="lightgray" stroke="black" cx="32321.61" cy="-12913.47" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="32321.61" y="-12924.77" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="32321.61" y="-12909.77" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="32321.61" y="-12894.77" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m41_res1&#45;&gt;m41_route -->
<g id="edge630" class="edge">
<title>m41_res1&#45;&gt;m41_route</title>
<path fill="none" stroke="black" d="M32482.67,-13128.97C32486.79,-13093.65 32488.92,-13029.8 32459.61,-12986.95 32446.5,-12967.79 32426.68,-12953.33 32406.11,-12942.57"/>
<polygon fill="black" stroke="black" points="32407.47,-12939.34 32396.95,-12938.04 32404.36,-12945.61 32407.47,-12939.34"/>
</g>
<!-- m41_final -->
<g id="node499" class="node">
<title>m41_final</title>
<ellipse fill="lightpink" stroke="black" cx="32895.61" cy="-12590.17" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="32895.61" y="-12593.97" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="32895.61" y="-12578.97" font-family="Times,serif" font-size="14.00">GPU: 3753</text>
</g>
<!-- m41_res1&#45;&gt;m41_final -->
<g id="edge638" class="edge">
<title>m41_res1&#45;&gt;m41_final</title>
<path fill="none" stroke="black" d="M32554.87,-13150.21C32688.66,-13137.54 32951.61,-13090.29 32951.61,-12914.47 32951.61,-12914.47 32951.61,-12914.47 32951.61,-12801.52 32951.61,-12738.2 32927.62,-12667.65 32911.04,-12626.47"/>
<polygon fill="black" stroke="black" points="32914.25,-12625.07 32907.22,-12617.15 32907.78,-12627.73 32914.25,-12625.07"/>
</g>
<!-- m41_gate&#45;&gt;m41_route -->
<g id="edge629" class="edge">
<title>m41_gate&#45;&gt;m41_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32321.61,-12986.88C32321.61,-12978.45 32321.61,-12969.76 32321.61,-12961.46"/>
<polygon fill="black" stroke="black" points="32325.11,-12961.2 32321.61,-12951.2 32318.11,-12961.2 32325.11,-12961.2"/>
</g>
<!-- m41_expert0 -->
<g id="node495" class="node">
<title>m41_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="31405.61" cy="-12802.52" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="31405.61" y="-12813.82" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="31405.61" y="-12798.82" font-family="Times,serif" font-size="14.00">Node 304 GPU 0</text>
<text text-anchor="middle" x="31405.61" y="-12783.82" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m41_route&#45;&gt;m41_expert0 -->
<g id="edge631" class="edge">
<title>m41_route&#45;&gt;m41_expert0</title>
<path fill="none" stroke="black" d="M32227.3,-12901.28C32107.44,-12887.05 31894.16,-12861.72 31711.61,-12840 31684.41,-12836.76 31655.84,-12833.36 31627.54,-12829.99"/>
<polygon fill="black" stroke="black" points="31627.89,-12826.5 31617.55,-12828.8 31627.06,-12833.45 31627.89,-12826.5"/>
</g>
<!-- m41_expert1 -->
<g id="node496" class="node">
<title>m41_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="32016.61" cy="-12802.52" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="32016.61" y="-12813.82" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="32016.61" y="-12798.82" font-family="Times,serif" font-size="14.00">Node 304 GPU 1</text>
<text text-anchor="middle" x="32016.61" y="-12783.82" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m41_route&#45;&gt;m41_expert1 -->
<g id="edge633" class="edge">
<title>m41_route&#45;&gt;m41_expert1</title>
<path fill="none" stroke="black" d="M32250.49,-12887.07C32212.44,-12873.47 32164.83,-12856.47 32122.52,-12841.35"/>
<polygon fill="black" stroke="black" points="32123.61,-12838.03 32113.02,-12837.96 32121.26,-12844.62 32123.61,-12838.03"/>
</g>
<!-- m41_expert2 -->
<g id="node497" class="node">
<title>m41_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="32627.61" cy="-12802.52" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="32627.61" y="-12813.82" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="32627.61" y="-12798.82" font-family="Times,serif" font-size="14.00">Node 304 GPU 2</text>
<text text-anchor="middle" x="32627.61" y="-12783.82" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m41_route&#45;&gt;m41_expert2 -->
<g id="edge635" class="edge">
<title>m41_route&#45;&gt;m41_expert2</title>
<path fill="none" stroke="black" d="M32392.97,-12887.07C32431.14,-12873.47 32478.9,-12856.47 32521.36,-12841.35"/>
<polygon fill="black" stroke="black" points="32522.64,-12844.61 32530.89,-12837.96 32520.3,-12838.02 32522.64,-12844.61"/>
</g>
<!-- m41_agg -->
<g id="node498" class="node">
<title>m41_agg</title>
<polygon fill="purple" stroke="black" points="32486.23,-12729.04 32225.95,-12729.04 32159,-12653.04 32419.27,-12653.04 32486.23,-12729.04"/>
<text text-anchor="middle" x="32322.61" y="-12694.84" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="32322.61" y="-12679.84" font-family="Times,serif" font-size="14.00">GPU: 3753</text>
</g>
<!-- m41_expert0&#45;&gt;m41_agg -->
<g id="edge632" class="edge">
<title>m41_expert0&#45;&gt;m41_agg</title>
<path fill="none" stroke="black" d="M31617.14,-12776.27C31795.91,-12754.92 32046.08,-12725.06 32195.48,-12707.22"/>
<polygon fill="black" stroke="black" points="32196.1,-12710.67 32205.62,-12706.01 32195.27,-12703.72 32196.1,-12710.67"/>
</g>
<!-- m41_expert1&#45;&gt;m41_agg -->
<g id="edge634" class="edge">
<title>m41_expert1&#45;&gt;m41_agg</title>
<path fill="none" stroke="black" d="M32113.01,-12767.03C32145.3,-12755.48 32181.5,-12742.53 32214.62,-12730.68"/>
<polygon fill="black" stroke="black" points="32216.09,-12733.87 32224.33,-12727.21 32213.73,-12727.28 32216.09,-12733.87"/>
</g>
<!-- m41_expert2&#45;&gt;m41_agg -->
<g id="edge636" class="edge">
<title>m41_expert2&#45;&gt;m41_agg</title>
<path fill="none" stroke="black" d="M32531.53,-12767.03C32501.07,-12756.1 32467.11,-12743.91 32435.57,-12732.59"/>
<polygon fill="black" stroke="black" points="32436.47,-12729.19 32425.87,-12729.11 32434.1,-12735.78 32436.47,-12729.19"/>
</g>
<!-- m41_agg&#45;&gt;m41_final -->
<g id="edge637" class="edge">
<title>m41_agg&#45;&gt;m41_final</title>
<path fill="none" stroke="black" d="M32435.13,-12670.63C32541.17,-12652.33 32698.36,-12625.21 32798.9,-12607.86"/>
<polygon fill="black" stroke="black" points="32799.79,-12611.26 32809.05,-12606.11 32798.6,-12604.36 32799.79,-12611.26"/>
</g>
<!-- m42_res1 -->
<g id="node504" class="node">
<title>m42_res1</title>
<ellipse fill="lightpink" stroke="black" cx="33008.61" cy="-12500.43" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="33008.61" y="-12504.23" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="33008.61" y="-12489.23" font-family="Times,serif" font-size="14.00">GPU: 3754</text>
</g>
<!-- m41_final&#45;&gt;m42_res1 -->
<g id="edge643" class="edge">
<title>m41_final&#45;&gt;m42_res1</title>
<path fill="none" stroke="black" d="M32927.39,-12564.5C32940.6,-12554.25 32956.05,-12542.25 32969.9,-12531.49"/>
<polygon fill="black" stroke="black" points="32972.1,-12534.22 32977.85,-12525.32 32967.81,-12528.69 32972.1,-12534.22"/>
</g>
<!-- m42_ln1 -->
<g id="node500" class="node">
<title>m42_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="33122.61" cy="-12913.47" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="33122.61" y="-12917.27" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="33122.61" y="-12902.27" font-family="Times,serif" font-size="14.00">GPU: 3754</text>
</g>
<!-- m42_qkv -->
<g id="node501" class="node">
<title>m42_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="33122.61" cy="-12802.52" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="33122.61" y="-12806.32" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="33122.61" y="-12791.32" font-family="Times,serif" font-size="14.00">GPU: 3754</text>
</g>
<!-- m42_ln1&#45;&gt;m42_qkv -->
<g id="edge639" class="edge">
<title>m42_ln1&#45;&gt;m42_qkv</title>
<path fill="none" stroke="black" d="M33122.61,-12886.38C33122.61,-12872.36 33122.61,-12854.87 33122.61,-12839.57"/>
<polygon fill="black" stroke="black" points="33126.11,-12839.4 33122.61,-12829.4 33119.11,-12839.4 33126.11,-12839.4"/>
</g>
<!-- m42_mha -->
<g id="node502" class="node">
<title>m42_mha</title>
<ellipse fill="lightblue" stroke="black" cx="33122.61" cy="-12691.04" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="33122.61" y="-12694.84" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="33122.61" y="-12679.84" font-family="Times,serif" font-size="14.00">GPU: 3754</text>
</g>
<!-- m42_qkv&#45;&gt;m42_mha -->
<g id="edge640" class="edge">
<title>m42_qkv&#45;&gt;m42_mha</title>
<path fill="none" stroke="black" d="M33122.61,-12775.58C33122.61,-12761.5 33122.61,-12743.87 33122.61,-12728.44"/>
<polygon fill="black" stroke="black" points="33126.11,-12728.18 33122.61,-12718.18 33119.11,-12728.18 33126.11,-12728.18"/>
</g>
<!-- m42_out -->
<g id="node503" class="node">
<title>m42_out</title>
<ellipse fill="lightblue" stroke="black" cx="33122.61" cy="-12590.17" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="33122.61" y="-12593.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="33122.61" y="-12578.97" font-family="Times,serif" font-size="14.00">GPU: 3754</text>
</g>
<!-- m42_mha&#45;&gt;m42_out -->
<g id="edge641" class="edge">
<title>m42_mha&#45;&gt;m42_out</title>
<path fill="none" stroke="black" d="M33122.61,-12664.07C33122.61,-12652.92 33122.61,-12639.69 33122.61,-12627.59"/>
<polygon fill="black" stroke="black" points="33126.11,-12627.32 33122.61,-12617.32 33119.11,-12627.32 33126.11,-12627.32"/>
</g>
<!-- m42_out&#45;&gt;m42_res1 -->
<g id="edge642" class="edge">
<title>m42_out&#45;&gt;m42_res1</title>
<path fill="none" stroke="black" d="M33090.55,-12564.5C33077.23,-12554.25 33061.64,-12542.25 33047.66,-12531.49"/>
<polygon fill="black" stroke="black" points="33049.7,-12528.64 33039.64,-12525.32 33045.43,-12534.19 33049.7,-12528.64"/>
</g>
<!-- m42_gate -->
<g id="node505" class="node">
<title>m42_gate</title>
<polygon fill="orange" stroke="black" points="32980.23,-12437.56 32775.63,-12437.56 32723,-12331.56 32927.59,-12331.56 32980.23,-12437.56"/>
<text text-anchor="middle" x="32851.61" y="-12395.86" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="32851.61" y="-12380.86" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="32851.61" y="-12365.86" font-family="Times,serif" font-size="14.00">GPU: 3754</text>
</g>
<!-- m42_res1&#45;&gt;m42_gate -->
<g id="edge644" class="edge">
<title>m42_res1&#45;&gt;m42_gate</title>
<path fill="none" stroke="black" d="M32976.08,-12475.84C32963.08,-12466.41 32947.48,-12455.09 32931.79,-12443.72"/>
<polygon fill="black" stroke="black" points="32933.74,-12440.81 32923.59,-12437.77 32929.63,-12446.47 32933.74,-12440.81"/>
</g>
<!-- m42_route -->
<g id="node506" class="node">
<title>m42_route</title>
<ellipse fill="lightgray" stroke="black" cx="32851.61" cy="-12258.09" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="32851.61" y="-12269.39" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="32851.61" y="-12254.39" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="32851.61" y="-12239.39" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m42_res1&#45;&gt;m42_route -->
<g id="edge646" class="edge">
<title>m42_res1&#45;&gt;m42_route</title>
<path fill="none" stroke="black" d="M33012.67,-12473.58C33016.79,-12438.26 33018.92,-12374.41 32989.61,-12331.56 32976.5,-12312.4 32956.68,-12297.94 32936.11,-12287.18"/>
<polygon fill="black" stroke="black" points="32937.47,-12283.95 32926.95,-12282.65 32934.36,-12290.22 32937.47,-12283.95"/>
</g>
<!-- m42_final -->
<g id="node511" class="node">
<title>m42_final</title>
<ellipse fill="lightpink" stroke="black" cx="33425.61" cy="-11934.79" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="33425.61" y="-11938.59" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="33425.61" y="-11923.59" font-family="Times,serif" font-size="14.00">GPU: 3754</text>
</g>
<!-- m42_res1&#45;&gt;m42_final -->
<g id="edge654" class="edge">
<title>m42_res1&#45;&gt;m42_final</title>
<path fill="none" stroke="black" d="M33084.87,-12494.82C33218.66,-12482.16 33481.61,-12434.9 33481.61,-12259.09 33481.61,-12259.09 33481.61,-12259.09 33481.61,-12146.13 33481.61,-12082.81 33457.62,-12012.26 33441.04,-11971.08"/>
<polygon fill="black" stroke="black" points="33444.25,-11969.68 33437.22,-11961.76 33437.78,-11972.34 33444.25,-11969.68"/>
</g>
<!-- m42_gate&#45;&gt;m42_route -->
<g id="edge645" class="edge">
<title>m42_gate&#45;&gt;m42_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32851.61,-12331.5C32851.61,-12323.06 32851.61,-12314.38 32851.61,-12306.07"/>
<polygon fill="black" stroke="black" points="32855.11,-12305.81 32851.61,-12295.81 32848.11,-12305.81 32855.11,-12305.81"/>
</g>
<!-- m42_expert0 -->
<g id="node507" class="node">
<title>m42_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="31935.61" cy="-12147.13" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="31935.61" y="-12158.43" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="31935.61" y="-12143.43" font-family="Times,serif" font-size="14.00">Node 312 GPU 0</text>
<text text-anchor="middle" x="31935.61" y="-12128.43" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m42_route&#45;&gt;m42_expert0 -->
<g id="edge647" class="edge">
<title>m42_route&#45;&gt;m42_expert0</title>
<path fill="none" stroke="black" d="M32757.3,-12245.89C32637.44,-12231.66 32424.16,-12206.34 32241.61,-12184.61 32214.41,-12181.37 32185.84,-12177.97 32157.54,-12174.6"/>
<polygon fill="black" stroke="black" points="32157.89,-12171.12 32147.55,-12173.41 32157.06,-12178.07 32157.89,-12171.12"/>
</g>
<!-- m42_expert1 -->
<g id="node508" class="node">
<title>m42_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="32546.61" cy="-12147.13" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="32546.61" y="-12158.43" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="32546.61" y="-12143.43" font-family="Times,serif" font-size="14.00">Node 312 GPU 1</text>
<text text-anchor="middle" x="32546.61" y="-12128.43" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m42_route&#45;&gt;m42_expert1 -->
<g id="edge649" class="edge">
<title>m42_route&#45;&gt;m42_expert1</title>
<path fill="none" stroke="black" d="M32780.49,-12231.68C32742.44,-12218.09 32694.83,-12201.08 32652.52,-12185.97"/>
<polygon fill="black" stroke="black" points="32653.61,-12182.64 32643.02,-12182.57 32651.26,-12189.23 32653.61,-12182.64"/>
</g>
<!-- m42_expert2 -->
<g id="node509" class="node">
<title>m42_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="33157.61" cy="-12147.13" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="33157.61" y="-12158.43" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="33157.61" y="-12143.43" font-family="Times,serif" font-size="14.00">Node 312 GPU 2</text>
<text text-anchor="middle" x="33157.61" y="-12128.43" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m42_route&#45;&gt;m42_expert2 -->
<g id="edge651" class="edge">
<title>m42_route&#45;&gt;m42_expert2</title>
<path fill="none" stroke="black" d="M32922.97,-12231.68C32961.14,-12218.09 33008.9,-12201.08 33051.36,-12185.97"/>
<polygon fill="black" stroke="black" points="33052.64,-12189.22 33060.89,-12182.57 33050.3,-12182.63 33052.64,-12189.22"/>
</g>
<!-- m42_agg -->
<g id="node510" class="node">
<title>m42_agg</title>
<polygon fill="purple" stroke="black" points="33016.23,-12073.66 32755.95,-12073.66 32689,-11997.66 32949.27,-11997.66 33016.23,-12073.66"/>
<text text-anchor="middle" x="32852.61" y="-12039.46" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="32852.61" y="-12024.46" font-family="Times,serif" font-size="14.00">GPU: 3754</text>
</g>
<!-- m42_expert0&#45;&gt;m42_agg -->
<g id="edge648" class="edge">
<title>m42_expert0&#45;&gt;m42_agg</title>
<path fill="none" stroke="black" d="M32147.14,-12120.88C32325.91,-12099.54 32576.08,-12069.67 32725.48,-12051.83"/>
<polygon fill="black" stroke="black" points="32726.1,-12055.29 32735.62,-12050.62 32725.27,-12048.33 32726.1,-12055.29"/>
</g>
<!-- m42_expert1&#45;&gt;m42_agg -->
<g id="edge650" class="edge">
<title>m42_expert1&#45;&gt;m42_agg</title>
<path fill="none" stroke="black" d="M32643.01,-12111.64C32675.3,-12100.09 32711.5,-12087.14 32744.62,-12075.29"/>
<polygon fill="black" stroke="black" points="32746.09,-12078.48 32754.33,-12071.82 32743.73,-12071.89 32746.09,-12078.48"/>
</g>
<!-- m42_expert2&#45;&gt;m42_agg -->
<g id="edge652" class="edge">
<title>m42_expert2&#45;&gt;m42_agg</title>
<path fill="none" stroke="black" d="M33061.53,-12111.64C33031.07,-12100.71 32997.11,-12088.52 32965.57,-12077.2"/>
<polygon fill="black" stroke="black" points="32966.47,-12073.8 32955.87,-12073.72 32964.1,-12080.39 32966.47,-12073.8"/>
</g>
<!-- m42_agg&#45;&gt;m42_final -->
<g id="edge653" class="edge">
<title>m42_agg&#45;&gt;m42_final</title>
<path fill="none" stroke="black" d="M32965.13,-12015.24C33071.17,-11996.95 33228.36,-11969.82 33328.9,-11952.47"/>
<polygon fill="black" stroke="black" points="33329.79,-11955.87 33339.05,-11950.72 33328.6,-11948.97 33329.79,-11955.87"/>
</g>
<!-- m43_res1 -->
<g id="node516" class="node">
<title>m43_res1</title>
<ellipse fill="lightpink" stroke="black" cx="33538.61" cy="-11845.05" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="33538.61" y="-11848.85" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="33538.61" y="-11833.85" font-family="Times,serif" font-size="14.00">GPU: 3755</text>
</g>
<!-- m42_final&#45;&gt;m43_res1 -->
<g id="edge659" class="edge">
<title>m42_final&#45;&gt;m43_res1</title>
<path fill="none" stroke="black" d="M33457.39,-11909.11C33470.6,-11898.86 33486.05,-11886.86 33499.9,-11876.1"/>
<polygon fill="black" stroke="black" points="33502.1,-11878.83 33507.85,-11869.93 33497.81,-11873.3 33502.1,-11878.83"/>
</g>
<!-- m43_ln1 -->
<g id="node512" class="node">
<title>m43_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="33652.61" cy="-12258.09" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="33652.61" y="-12261.89" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="33652.61" y="-12246.89" font-family="Times,serif" font-size="14.00">GPU: 3755</text>
</g>
<!-- m43_qkv -->
<g id="node513" class="node">
<title>m43_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="33652.61" cy="-12147.13" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="33652.61" y="-12150.93" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="33652.61" y="-12135.93" font-family="Times,serif" font-size="14.00">GPU: 3755</text>
</g>
<!-- m43_ln1&#45;&gt;m43_qkv -->
<g id="edge655" class="edge">
<title>m43_ln1&#45;&gt;m43_qkv</title>
<path fill="none" stroke="black" d="M33652.61,-12230.99C33652.61,-12216.97 33652.61,-12199.48 33652.61,-12184.19"/>
<polygon fill="black" stroke="black" points="33656.11,-12184.02 33652.61,-12174.02 33649.11,-12184.02 33656.11,-12184.02"/>
</g>
<!-- m43_mha -->
<g id="node514" class="node">
<title>m43_mha</title>
<ellipse fill="lightblue" stroke="black" cx="33652.61" cy="-12035.66" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="33652.61" y="-12039.46" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="33652.61" y="-12024.46" font-family="Times,serif" font-size="14.00">GPU: 3755</text>
</g>
<!-- m43_qkv&#45;&gt;m43_mha -->
<g id="edge656" class="edge">
<title>m43_qkv&#45;&gt;m43_mha</title>
<path fill="none" stroke="black" d="M33652.61,-12120.19C33652.61,-12106.11 33652.61,-12088.48 33652.61,-12073.05"/>
<polygon fill="black" stroke="black" points="33656.11,-12072.79 33652.61,-12062.79 33649.11,-12072.79 33656.11,-12072.79"/>
</g>
<!-- m43_out -->
<g id="node515" class="node">
<title>m43_out</title>
<ellipse fill="lightblue" stroke="black" cx="33652.61" cy="-11934.79" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="33652.61" y="-11938.59" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="33652.61" y="-11923.59" font-family="Times,serif" font-size="14.00">GPU: 3755</text>
</g>
<!-- m43_mha&#45;&gt;m43_out -->
<g id="edge657" class="edge">
<title>m43_mha&#45;&gt;m43_out</title>
<path fill="none" stroke="black" d="M33652.61,-12008.68C33652.61,-11997.53 33652.61,-11984.3 33652.61,-11972.2"/>
<polygon fill="black" stroke="black" points="33656.11,-11971.93 33652.61,-11961.93 33649.11,-11971.93 33656.11,-11971.93"/>
</g>
<!-- m43_out&#45;&gt;m43_res1 -->
<g id="edge658" class="edge">
<title>m43_out&#45;&gt;m43_res1</title>
<path fill="none" stroke="black" d="M33620.55,-11909.11C33607.23,-11898.86 33591.64,-11886.86 33577.66,-11876.1"/>
<polygon fill="black" stroke="black" points="33579.7,-11873.26 33569.64,-11869.93 33575.43,-11878.8 33579.7,-11873.26"/>
</g>
<!-- m43_gate -->
<g id="node517" class="node">
<title>m43_gate</title>
<polygon fill="orange" stroke="black" points="33510.23,-11782.18 33305.63,-11782.18 33253,-11676.18 33457.59,-11676.18 33510.23,-11782.18"/>
<text text-anchor="middle" x="33381.61" y="-11740.48" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="33381.61" y="-11725.48" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="33381.61" y="-11710.48" font-family="Times,serif" font-size="14.00">GPU: 3755</text>
</g>
<!-- m43_res1&#45;&gt;m43_gate -->
<g id="edge660" class="edge">
<title>m43_res1&#45;&gt;m43_gate</title>
<path fill="none" stroke="black" d="M33506.08,-11820.45C33493.08,-11811.02 33477.48,-11799.71 33461.79,-11788.33"/>
<polygon fill="black" stroke="black" points="33463.74,-11785.42 33453.59,-11782.38 33459.63,-11791.09 33463.74,-11785.42"/>
</g>
<!-- m43_route -->
<g id="node518" class="node">
<title>m43_route</title>
<ellipse fill="lightgray" stroke="black" cx="33381.61" cy="-11602.7" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="33381.61" y="-11614" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="33381.61" y="-11599" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="33381.61" y="-11584" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m43_res1&#45;&gt;m43_route -->
<g id="edge662" class="edge">
<title>m43_res1&#45;&gt;m43_route</title>
<path fill="none" stroke="black" d="M33542.67,-11818.2C33546.79,-11782.87 33548.92,-11719.03 33519.61,-11676.18 33506.5,-11657.01 33486.68,-11642.55 33466.11,-11631.8"/>
<polygon fill="black" stroke="black" points="33467.47,-11628.56 33456.95,-11627.26 33464.36,-11634.84 33467.47,-11628.56"/>
</g>
<!-- m43_final -->
<g id="node523" class="node">
<title>m43_final</title>
<ellipse fill="lightpink" stroke="black" cx="33955.61" cy="-11279.4" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="33955.61" y="-11283.2" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="33955.61" y="-11268.2" font-family="Times,serif" font-size="14.00">GPU: 3755</text>
</g>
<!-- m43_res1&#45;&gt;m43_final -->
<g id="edge670" class="edge">
<title>m43_res1&#45;&gt;m43_final</title>
<path fill="none" stroke="black" d="M33614.87,-11839.43C33748.66,-11826.77 34011.61,-11779.52 34011.61,-11603.7 34011.61,-11603.7 34011.61,-11603.7 34011.61,-11490.75 34011.61,-11427.42 33987.62,-11356.88 33971.04,-11315.69"/>
<polygon fill="black" stroke="black" points="33974.25,-11314.29 33967.22,-11306.37 33967.78,-11316.95 33974.25,-11314.29"/>
</g>
<!-- m43_gate&#45;&gt;m43_route -->
<g id="edge661" class="edge">
<title>m43_gate&#45;&gt;m43_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33381.61,-11676.11C33381.61,-11667.68 33381.61,-11658.99 33381.61,-11650.69"/>
<polygon fill="black" stroke="black" points="33385.11,-11650.43 33381.61,-11640.43 33378.11,-11650.43 33385.11,-11650.43"/>
</g>
<!-- m43_expert0 -->
<g id="node519" class="node">
<title>m43_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="32465.61" cy="-11491.75" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="32465.61" y="-11503.05" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="32465.61" y="-11488.05" font-family="Times,serif" font-size="14.00">Node 320 GPU 0</text>
<text text-anchor="middle" x="32465.61" y="-11473.05" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m43_route&#45;&gt;m43_expert0 -->
<g id="edge663" class="edge">
<title>m43_route&#45;&gt;m43_expert0</title>
<path fill="none" stroke="black" d="M33287.3,-11590.51C33167.44,-11576.28 32954.16,-11550.95 32771.61,-11529.22 32744.41,-11525.99 32715.84,-11522.58 32687.54,-11519.21"/>
<polygon fill="black" stroke="black" points="32687.89,-11515.73 32677.55,-11518.02 32687.06,-11522.68 32687.89,-11515.73"/>
</g>
<!-- m43_expert1 -->
<g id="node520" class="node">
<title>m43_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="33076.61" cy="-11491.75" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="33076.61" y="-11503.05" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="33076.61" y="-11488.05" font-family="Times,serif" font-size="14.00">Node 320 GPU 1</text>
<text text-anchor="middle" x="33076.61" y="-11473.05" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m43_route&#45;&gt;m43_expert1 -->
<g id="edge665" class="edge">
<title>m43_route&#45;&gt;m43_expert1</title>
<path fill="none" stroke="black" d="M33310.49,-11576.29C33272.44,-11562.7 33224.83,-11545.7 33182.52,-11530.58"/>
<polygon fill="black" stroke="black" points="33183.61,-11527.25 33173.02,-11527.19 33181.26,-11533.85 33183.61,-11527.25"/>
</g>
<!-- m43_expert2 -->
<g id="node521" class="node">
<title>m43_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="33687.61" cy="-11491.75" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="33687.61" y="-11503.05" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="33687.61" y="-11488.05" font-family="Times,serif" font-size="14.00">Node 320 GPU 2</text>
<text text-anchor="middle" x="33687.61" y="-11473.05" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m43_route&#45;&gt;m43_expert2 -->
<g id="edge667" class="edge">
<title>m43_route&#45;&gt;m43_expert2</title>
<path fill="none" stroke="black" d="M33452.97,-11576.29C33491.14,-11562.7 33538.9,-11545.7 33581.36,-11530.58"/>
<polygon fill="black" stroke="black" points="33582.64,-11533.84 33590.89,-11527.19 33580.3,-11527.24 33582.64,-11533.84"/>
</g>
<!-- m43_agg -->
<g id="node522" class="node">
<title>m43_agg</title>
<polygon fill="purple" stroke="black" points="33546.23,-11418.27 33285.95,-11418.27 33219,-11342.27 33479.27,-11342.27 33546.23,-11418.27"/>
<text text-anchor="middle" x="33382.61" y="-11384.07" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="33382.61" y="-11369.07" font-family="Times,serif" font-size="14.00">GPU: 3755</text>
</g>
<!-- m43_expert0&#45;&gt;m43_agg -->
<g id="edge664" class="edge">
<title>m43_expert0&#45;&gt;m43_agg</title>
<path fill="none" stroke="black" d="M32677.14,-11465.49C32855.91,-11444.15 33106.08,-11414.28 33255.48,-11396.45"/>
<polygon fill="black" stroke="black" points="33256.1,-11399.9 33265.62,-11395.24 33255.27,-11392.95 33256.1,-11399.9"/>
</g>
<!-- m43_expert1&#45;&gt;m43_agg -->
<g id="edge666" class="edge">
<title>m43_expert1&#45;&gt;m43_agg</title>
<path fill="none" stroke="black" d="M33173.01,-11456.26C33205.3,-11444.71 33241.5,-11431.75 33274.62,-11419.91"/>
<polygon fill="black" stroke="black" points="33276.09,-11423.1 33284.33,-11416.43 33273.73,-11416.51 33276.09,-11423.1"/>
</g>
<!-- m43_expert2&#45;&gt;m43_agg -->
<g id="edge668" class="edge">
<title>m43_expert2&#45;&gt;m43_agg</title>
<path fill="none" stroke="black" d="M33591.53,-11456.26C33561.07,-11445.32 33527.11,-11433.14 33495.57,-11421.82"/>
<polygon fill="black" stroke="black" points="33496.47,-11418.42 33485.87,-11418.33 33494.1,-11425.01 33496.47,-11418.42"/>
</g>
<!-- m43_agg&#45;&gt;m43_final -->
<g id="edge669" class="edge">
<title>m43_agg&#45;&gt;m43_final</title>
<path fill="none" stroke="black" d="M33495.13,-11359.85C33601.17,-11341.56 33758.36,-11314.43 33858.9,-11297.09"/>
<polygon fill="black" stroke="black" points="33859.79,-11300.49 33869.05,-11295.34 33858.6,-11293.59 33859.79,-11300.49"/>
</g>
<!-- m44_res1 -->
<g id="node528" class="node">
<title>m44_res1</title>
<ellipse fill="lightpink" stroke="black" cx="34068.61" cy="-11189.66" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="34068.61" y="-11193.46" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="34068.61" y="-11178.46" font-family="Times,serif" font-size="14.00">GPU: 3756</text>
</g>
<!-- m43_final&#45;&gt;m44_res1 -->
<g id="edge675" class="edge">
<title>m43_final&#45;&gt;m44_res1</title>
<path fill="none" stroke="black" d="M33987.39,-11253.73C34000.6,-11243.47 34016.05,-11231.48 34029.9,-11220.71"/>
<polygon fill="black" stroke="black" points="34032.1,-11223.44 34037.85,-11214.54 34027.81,-11217.91 34032.1,-11223.44"/>
</g>
<!-- m44_ln1 -->
<g id="node524" class="node">
<title>m44_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="34182.61" cy="-11602.7" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="34182.61" y="-11606.5" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="34182.61" y="-11591.5" font-family="Times,serif" font-size="14.00">GPU: 3756</text>
</g>
<!-- m44_qkv -->
<g id="node525" class="node">
<title>m44_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="34182.61" cy="-11491.75" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="34182.61" y="-11495.55" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="34182.61" y="-11480.55" font-family="Times,serif" font-size="14.00">GPU: 3756</text>
</g>
<!-- m44_ln1&#45;&gt;m44_qkv -->
<g id="edge671" class="edge">
<title>m44_ln1&#45;&gt;m44_qkv</title>
<path fill="none" stroke="black" d="M34182.61,-11575.6C34182.61,-11561.59 34182.61,-11544.1 34182.61,-11528.8"/>
<polygon fill="black" stroke="black" points="34186.11,-11528.63 34182.61,-11518.63 34179.11,-11528.63 34186.11,-11528.63"/>
</g>
<!-- m44_mha -->
<g id="node526" class="node">
<title>m44_mha</title>
<ellipse fill="lightblue" stroke="black" cx="34182.61" cy="-11380.27" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="34182.61" y="-11384.07" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="34182.61" y="-11369.07" font-family="Times,serif" font-size="14.00">GPU: 3756</text>
</g>
<!-- m44_qkv&#45;&gt;m44_mha -->
<g id="edge672" class="edge">
<title>m44_qkv&#45;&gt;m44_mha</title>
<path fill="none" stroke="black" d="M34182.61,-11464.8C34182.61,-11450.73 34182.61,-11433.1 34182.61,-11417.67"/>
<polygon fill="black" stroke="black" points="34186.11,-11417.41 34182.61,-11407.41 34179.11,-11417.41 34186.11,-11417.41"/>
</g>
<!-- m44_out -->
<g id="node527" class="node">
<title>m44_out</title>
<ellipse fill="lightblue" stroke="black" cx="34182.61" cy="-11279.4" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="34182.61" y="-11283.2" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="34182.61" y="-11268.2" font-family="Times,serif" font-size="14.00">GPU: 3756</text>
</g>
<!-- m44_mha&#45;&gt;m44_out -->
<g id="edge673" class="edge">
<title>m44_mha&#45;&gt;m44_out</title>
<path fill="none" stroke="black" d="M34182.61,-11353.29C34182.61,-11342.14 34182.61,-11328.92 34182.61,-11316.81"/>
<polygon fill="black" stroke="black" points="34186.11,-11316.55 34182.61,-11306.55 34179.11,-11316.55 34186.11,-11316.55"/>
</g>
<!-- m44_out&#45;&gt;m44_res1 -->
<g id="edge674" class="edge">
<title>m44_out&#45;&gt;m44_res1</title>
<path fill="none" stroke="black" d="M34150.55,-11253.73C34137.23,-11243.47 34121.64,-11231.48 34107.66,-11220.71"/>
<polygon fill="black" stroke="black" points="34109.7,-11217.87 34099.64,-11214.54 34105.43,-11223.42 34109.7,-11217.87"/>
</g>
<!-- m44_gate -->
<g id="node529" class="node">
<title>m44_gate</title>
<polygon fill="orange" stroke="black" points="34040.23,-11126.79 33835.63,-11126.79 33783,-11020.79 33987.59,-11020.79 34040.23,-11126.79"/>
<text text-anchor="middle" x="33911.61" y="-11085.09" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="33911.61" y="-11070.09" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="33911.61" y="-11055.09" font-family="Times,serif" font-size="14.00">GPU: 3756</text>
</g>
<!-- m44_res1&#45;&gt;m44_gate -->
<g id="edge676" class="edge">
<title>m44_res1&#45;&gt;m44_gate</title>
<path fill="none" stroke="black" d="M34036.08,-11165.07C34023.08,-11155.64 34007.48,-11144.32 33991.79,-11132.94"/>
<polygon fill="black" stroke="black" points="33993.74,-11130.03 33983.59,-11126.99 33989.63,-11135.7 33993.74,-11130.03"/>
</g>
<!-- m44_route -->
<g id="node530" class="node">
<title>m44_route</title>
<ellipse fill="lightgray" stroke="black" cx="33911.61" cy="-10947.31" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="33911.61" y="-10958.61" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="33911.61" y="-10943.61" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="33911.61" y="-10928.61" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m44_res1&#45;&gt;m44_route -->
<g id="edge678" class="edge">
<title>m44_res1&#45;&gt;m44_route</title>
<path fill="none" stroke="black" d="M34072.67,-11162.81C34076.79,-11127.48 34078.92,-11063.64 34049.61,-11020.79 34036.5,-11001.63 34016.68,-10987.17 33996.11,-10976.41"/>
<polygon fill="black" stroke="black" points="33997.47,-10973.18 33986.95,-10971.87 33994.36,-10979.45 33997.47,-10973.18"/>
</g>
<!-- m44_final -->
<g id="node535" class="node">
<title>m44_final</title>
<ellipse fill="lightpink" stroke="black" cx="34485.61" cy="-10624.01" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="34485.61" y="-10627.81" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="34485.61" y="-10612.81" font-family="Times,serif" font-size="14.00">GPU: 3756</text>
</g>
<!-- m44_res1&#45;&gt;m44_final -->
<g id="edge686" class="edge">
<title>m44_res1&#45;&gt;m44_final</title>
<path fill="none" stroke="black" d="M34144.87,-11184.05C34278.66,-11171.38 34541.61,-11124.13 34541.61,-10948.31 34541.61,-10948.31 34541.61,-10948.31 34541.61,-10835.36 34541.61,-10772.04 34517.62,-10701.49 34501.04,-10660.3"/>
<polygon fill="black" stroke="black" points="34504.25,-10658.91 34497.22,-10650.98 34497.78,-10661.56 34504.25,-10658.91"/>
</g>
<!-- m44_gate&#45;&gt;m44_route -->
<g id="edge677" class="edge">
<title>m44_gate&#45;&gt;m44_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33911.61,-11020.72C33911.61,-11012.29 33911.61,-11003.6 33911.61,-10995.3"/>
<polygon fill="black" stroke="black" points="33915.11,-10995.04 33911.61,-10985.04 33908.11,-10995.04 33915.11,-10995.04"/>
</g>
<!-- m44_expert0 -->
<g id="node531" class="node">
<title>m44_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="32995.61" cy="-10836.36" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="32995.61" y="-10847.66" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="32995.61" y="-10832.66" font-family="Times,serif" font-size="14.00">Node 328 GPU 0</text>
<text text-anchor="middle" x="32995.61" y="-10817.66" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m44_route&#45;&gt;m44_expert0 -->
<g id="edge679" class="edge">
<title>m44_route&#45;&gt;m44_expert0</title>
<path fill="none" stroke="black" d="M33817.3,-10935.12C33697.44,-10920.89 33484.16,-10895.56 33301.61,-10873.84 33274.41,-10870.6 33245.84,-10867.2 33217.54,-10863.83"/>
<polygon fill="black" stroke="black" points="33217.89,-10860.34 33207.55,-10862.63 33217.06,-10867.29 33217.89,-10860.34"/>
</g>
<!-- m44_expert1 -->
<g id="node532" class="node">
<title>m44_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="33606.61" cy="-10836.36" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="33606.61" y="-10847.66" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="33606.61" y="-10832.66" font-family="Times,serif" font-size="14.00">Node 328 GPU 1</text>
<text text-anchor="middle" x="33606.61" y="-10817.66" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m44_route&#45;&gt;m44_expert1 -->
<g id="edge681" class="edge">
<title>m44_route&#45;&gt;m44_expert1</title>
<path fill="none" stroke="black" d="M33840.49,-10920.91C33802.44,-10907.31 33754.83,-10890.31 33712.52,-10875.19"/>
<polygon fill="black" stroke="black" points="33713.61,-10871.87 33703.02,-10871.8 33711.26,-10878.46 33713.61,-10871.87"/>
</g>
<!-- m44_expert2 -->
<g id="node533" class="node">
<title>m44_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="34217.61" cy="-10836.36" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="34217.61" y="-10847.66" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="34217.61" y="-10832.66" font-family="Times,serif" font-size="14.00">Node 328 GPU 2</text>
<text text-anchor="middle" x="34217.61" y="-10817.66" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m44_route&#45;&gt;m44_expert2 -->
<g id="edge683" class="edge">
<title>m44_route&#45;&gt;m44_expert2</title>
<path fill="none" stroke="black" d="M33982.97,-10920.91C34021.14,-10907.31 34068.9,-10890.31 34111.36,-10875.19"/>
<polygon fill="black" stroke="black" points="34112.64,-10878.45 34120.89,-10871.8 34110.3,-10871.86 34112.64,-10878.45"/>
</g>
<!-- m44_agg -->
<g id="node534" class="node">
<title>m44_agg</title>
<polygon fill="purple" stroke="black" points="34076.23,-10762.88 33815.95,-10762.88 33749,-10686.88 34009.27,-10686.88 34076.23,-10762.88"/>
<text text-anchor="middle" x="33912.61" y="-10728.68" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="33912.61" y="-10713.68" font-family="Times,serif" font-size="14.00">GPU: 3756</text>
</g>
<!-- m44_expert0&#45;&gt;m44_agg -->
<g id="edge680" class="edge">
<title>m44_expert0&#45;&gt;m44_agg</title>
<path fill="none" stroke="black" d="M33207.14,-10810.11C33385.91,-10788.76 33636.08,-10758.9 33785.48,-10741.06"/>
<polygon fill="black" stroke="black" points="33786.1,-10744.51 33795.62,-10739.85 33785.27,-10737.56 33786.1,-10744.51"/>
</g>
<!-- m44_expert1&#45;&gt;m44_agg -->
<g id="edge682" class="edge">
<title>m44_expert1&#45;&gt;m44_agg</title>
<path fill="none" stroke="black" d="M33703.01,-10800.87C33735.3,-10789.32 33771.5,-10776.37 33804.62,-10764.52"/>
<polygon fill="black" stroke="black" points="33806.09,-10767.71 33814.33,-10761.05 33803.73,-10761.12 33806.09,-10767.71"/>
</g>
<!-- m44_expert2&#45;&gt;m44_agg -->
<g id="edge684" class="edge">
<title>m44_expert2&#45;&gt;m44_agg</title>
<path fill="none" stroke="black" d="M34121.53,-10800.87C34091.07,-10789.94 34057.11,-10777.75 34025.57,-10766.43"/>
<polygon fill="black" stroke="black" points="34026.47,-10763.03 34015.87,-10762.95 34024.1,-10769.62 34026.47,-10763.03"/>
</g>
<!-- m44_agg&#45;&gt;m44_final -->
<g id="edge685" class="edge">
<title>m44_agg&#45;&gt;m44_final</title>
<path fill="none" stroke="black" d="M34025.13,-10704.47C34131.17,-10686.17 34288.36,-10659.05 34388.9,-10641.7"/>
<polygon fill="black" stroke="black" points="34389.79,-10645.1 34399.05,-10639.95 34388.6,-10638.2 34389.79,-10645.1"/>
</g>
<!-- m45_res1 -->
<g id="node540" class="node">
<title>m45_res1</title>
<ellipse fill="lightpink" stroke="black" cx="34598.61" cy="-10534.27" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="34598.61" y="-10538.07" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="34598.61" y="-10523.07" font-family="Times,serif" font-size="14.00">GPU: 3757</text>
</g>
<!-- m44_final&#45;&gt;m45_res1 -->
<g id="edge691" class="edge">
<title>m44_final&#45;&gt;m45_res1</title>
<path fill="none" stroke="black" d="M34517.39,-10598.34C34530.6,-10588.09 34546.05,-10576.09 34559.9,-10565.33"/>
<polygon fill="black" stroke="black" points="34562.1,-10568.05 34567.85,-10559.16 34557.81,-10562.53 34562.1,-10568.05"/>
</g>
<!-- m45_ln1 -->
<g id="node536" class="node">
<title>m45_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="34712.61" cy="-10947.31" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="34712.61" y="-10951.11" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="34712.61" y="-10936.11" font-family="Times,serif" font-size="14.00">GPU: 3757</text>
</g>
<!-- m45_qkv -->
<g id="node537" class="node">
<title>m45_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="34712.61" cy="-10836.36" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="34712.61" y="-10840.16" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="34712.61" y="-10825.16" font-family="Times,serif" font-size="14.00">GPU: 3757</text>
</g>
<!-- m45_ln1&#45;&gt;m45_qkv -->
<g id="edge687" class="edge">
<title>m45_ln1&#45;&gt;m45_qkv</title>
<path fill="none" stroke="black" d="M34712.61,-10920.22C34712.61,-10906.2 34712.61,-10888.71 34712.61,-10873.41"/>
<polygon fill="black" stroke="black" points="34716.11,-10873.24 34712.61,-10863.24 34709.11,-10873.24 34716.11,-10873.24"/>
</g>
<!-- m45_mha -->
<g id="node538" class="node">
<title>m45_mha</title>
<ellipse fill="lightblue" stroke="black" cx="34712.61" cy="-10724.88" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="34712.61" y="-10728.68" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="34712.61" y="-10713.68" font-family="Times,serif" font-size="14.00">GPU: 3757</text>
</g>
<!-- m45_qkv&#45;&gt;m45_mha -->
<g id="edge688" class="edge">
<title>m45_qkv&#45;&gt;m45_mha</title>
<path fill="none" stroke="black" d="M34712.61,-10809.42C34712.61,-10795.34 34712.61,-10777.71 34712.61,-10762.28"/>
<polygon fill="black" stroke="black" points="34716.11,-10762.02 34712.61,-10752.02 34709.11,-10762.02 34716.11,-10762.02"/>
</g>
<!-- m45_out -->
<g id="node539" class="node">
<title>m45_out</title>
<ellipse fill="lightblue" stroke="black" cx="34712.61" cy="-10624.01" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="34712.61" y="-10627.81" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="34712.61" y="-10612.81" font-family="Times,serif" font-size="14.00">GPU: 3757</text>
</g>
<!-- m45_mha&#45;&gt;m45_out -->
<g id="edge689" class="edge">
<title>m45_mha&#45;&gt;m45_out</title>
<path fill="none" stroke="black" d="M34712.61,-10697.91C34712.61,-10686.76 34712.61,-10673.53 34712.61,-10661.43"/>
<polygon fill="black" stroke="black" points="34716.11,-10661.16 34712.61,-10651.16 34709.11,-10661.16 34716.11,-10661.16"/>
</g>
<!-- m45_out&#45;&gt;m45_res1 -->
<g id="edge690" class="edge">
<title>m45_out&#45;&gt;m45_res1</title>
<path fill="none" stroke="black" d="M34680.55,-10598.34C34667.23,-10588.09 34651.64,-10576.09 34637.66,-10565.33"/>
<polygon fill="black" stroke="black" points="34639.7,-10562.48 34629.64,-10559.16 34635.43,-10568.03 34639.7,-10562.48"/>
</g>
<!-- m45_gate -->
<g id="node541" class="node">
<title>m45_gate</title>
<polygon fill="orange" stroke="black" points="34570.23,-10471.4 34365.63,-10471.4 34313,-10365.4 34517.59,-10365.4 34570.23,-10471.4"/>
<text text-anchor="middle" x="34441.61" y="-10429.7" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="34441.61" y="-10414.7" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="34441.61" y="-10399.7" font-family="Times,serif" font-size="14.00">GPU: 3757</text>
</g>
<!-- m45_res1&#45;&gt;m45_gate -->
<g id="edge692" class="edge">
<title>m45_res1&#45;&gt;m45_gate</title>
<path fill="none" stroke="black" d="M34566.08,-10509.68C34553.08,-10500.25 34537.48,-10488.93 34521.79,-10477.55"/>
<polygon fill="black" stroke="black" points="34523.74,-10474.65 34513.59,-10471.61 34519.63,-10480.31 34523.74,-10474.65"/>
</g>
<!-- m45_route -->
<g id="node542" class="node">
<title>m45_route</title>
<ellipse fill="lightgray" stroke="black" cx="34441.61" cy="-10291.93" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="34441.61" y="-10303.23" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="34441.61" y="-10288.23" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="34441.61" y="-10273.23" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m45_res1&#45;&gt;m45_route -->
<g id="edge694" class="edge">
<title>m45_res1&#45;&gt;m45_route</title>
<path fill="none" stroke="black" d="M34602.67,-10507.42C34606.79,-10472.1 34608.92,-10408.25 34579.61,-10365.4 34566.5,-10346.24 34546.68,-10331.78 34526.11,-10321.02"/>
<polygon fill="black" stroke="black" points="34527.47,-10317.79 34516.95,-10316.49 34524.36,-10324.06 34527.47,-10317.79"/>
</g>
<!-- m45_final -->
<g id="node547" class="node">
<title>m45_final</title>
<ellipse fill="lightpink" stroke="black" cx="35015.61" cy="-9968.63" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="35015.61" y="-9972.43" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="35015.61" y="-9957.43" font-family="Times,serif" font-size="14.00">GPU: 3757</text>
</g>
<!-- m45_res1&#45;&gt;m45_final -->
<g id="edge702" class="edge">
<title>m45_res1&#45;&gt;m45_final</title>
<path fill="none" stroke="black" d="M34674.87,-10528.66C34808.66,-10516 35071.61,-10468.74 35071.61,-10292.93 35071.61,-10292.93 35071.61,-10292.93 35071.61,-10179.97 35071.61,-10116.65 35047.62,-10046.1 35031.04,-10004.92"/>
<polygon fill="black" stroke="black" points="35034.25,-10003.52 35027.22,-9995.6 35027.78,-10006.18 35034.25,-10003.52"/>
</g>
<!-- m45_gate&#45;&gt;m45_route -->
<g id="edge693" class="edge">
<title>m45_gate&#45;&gt;m45_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34441.61,-10365.34C34441.61,-10356.9 34441.61,-10348.22 34441.61,-10339.91"/>
<polygon fill="black" stroke="black" points="34445.11,-10339.65 34441.61,-10329.65 34438.11,-10339.65 34445.11,-10339.65"/>
</g>
<!-- m45_expert0 -->
<g id="node543" class="node">
<title>m45_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="33525.61" cy="-10180.97" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="33525.61" y="-10192.27" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="33525.61" y="-10177.27" font-family="Times,serif" font-size="14.00">Node 336 GPU 0</text>
<text text-anchor="middle" x="33525.61" y="-10162.27" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m45_route&#45;&gt;m45_expert0 -->
<g id="edge695" class="edge">
<title>m45_route&#45;&gt;m45_expert0</title>
<path fill="none" stroke="black" d="M34347.3,-10279.73C34227.44,-10265.5 34014.16,-10240.17 33831.61,-10218.45 33804.41,-10215.21 33775.84,-10211.81 33747.54,-10208.44"/>
<polygon fill="black" stroke="black" points="33747.89,-10204.96 33737.55,-10207.25 33747.06,-10211.91 33747.89,-10204.96"/>
</g>
<!-- m45_expert1 -->
<g id="node544" class="node">
<title>m45_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="34136.61" cy="-10180.97" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="34136.61" y="-10192.27" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="34136.61" y="-10177.27" font-family="Times,serif" font-size="14.00">Node 336 GPU 1</text>
<text text-anchor="middle" x="34136.61" y="-10162.27" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m45_route&#45;&gt;m45_expert1 -->
<g id="edge697" class="edge">
<title>m45_route&#45;&gt;m45_expert1</title>
<path fill="none" stroke="black" d="M34370.49,-10265.52C34332.44,-10251.93 34284.83,-10234.92 34242.52,-10219.81"/>
<polygon fill="black" stroke="black" points="34243.61,-10216.48 34233.02,-10216.41 34241.26,-10223.07 34243.61,-10216.48"/>
</g>
<!-- m45_expert2 -->
<g id="node545" class="node">
<title>m45_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="34747.61" cy="-10180.97" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="34747.61" y="-10192.27" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="34747.61" y="-10177.27" font-family="Times,serif" font-size="14.00">Node 336 GPU 2</text>
<text text-anchor="middle" x="34747.61" y="-10162.27" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m45_route&#45;&gt;m45_expert2 -->
<g id="edge699" class="edge">
<title>m45_route&#45;&gt;m45_expert2</title>
<path fill="none" stroke="black" d="M34512.97,-10265.52C34551.14,-10251.93 34598.9,-10234.92 34641.36,-10219.81"/>
<polygon fill="black" stroke="black" points="34642.64,-10223.06 34650.89,-10216.41 34640.3,-10216.47 34642.64,-10223.06"/>
</g>
<!-- m45_agg -->
<g id="node546" class="node">
<title>m45_agg</title>
<polygon fill="purple" stroke="black" points="34606.23,-10107.5 34345.95,-10107.5 34279,-10031.5 34539.27,-10031.5 34606.23,-10107.5"/>
<text text-anchor="middle" x="34442.61" y="-10073.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="34442.61" y="-10058.3" font-family="Times,serif" font-size="14.00">GPU: 3757</text>
</g>
<!-- m45_expert0&#45;&gt;m45_agg -->
<g id="edge696" class="edge">
<title>m45_expert0&#45;&gt;m45_agg</title>
<path fill="none" stroke="black" d="M33737.14,-10154.72C33915.91,-10133.38 34166.08,-10103.51 34315.48,-10085.67"/>
<polygon fill="black" stroke="black" points="34316.1,-10089.12 34325.62,-10084.46 34315.27,-10082.17 34316.1,-10089.12"/>
</g>
<!-- m45_expert1&#45;&gt;m45_agg -->
<g id="edge698" class="edge">
<title>m45_expert1&#45;&gt;m45_agg</title>
<path fill="none" stroke="black" d="M34233.01,-10145.48C34265.3,-10133.93 34301.5,-10120.98 34334.62,-10109.13"/>
<polygon fill="black" stroke="black" points="34336.09,-10112.32 34344.33,-10105.66 34333.73,-10105.73 34336.09,-10112.32"/>
</g>
<!-- m45_expert2&#45;&gt;m45_agg -->
<g id="edge700" class="edge">
<title>m45_expert2&#45;&gt;m45_agg</title>
<path fill="none" stroke="black" d="M34651.53,-10145.48C34621.07,-10134.55 34587.11,-10122.36 34555.57,-10111.04"/>
<polygon fill="black" stroke="black" points="34556.47,-10107.64 34545.87,-10107.56 34554.1,-10114.23 34556.47,-10107.64"/>
</g>
<!-- m45_agg&#45;&gt;m45_final -->
<g id="edge701" class="edge">
<title>m45_agg&#45;&gt;m45_final</title>
<path fill="none" stroke="black" d="M34555.13,-10049.08C34661.17,-10030.79 34818.36,-10003.66 34918.9,-9986.31"/>
<polygon fill="black" stroke="black" points="34919.79,-9989.71 34929.05,-9984.56 34918.6,-9982.81 34919.79,-9989.71"/>
</g>
<!-- m46_res1 -->
<g id="node552" class="node">
<title>m46_res1</title>
<ellipse fill="lightpink" stroke="black" cx="35128.61" cy="-9878.89" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="35128.61" y="-9882.69" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="35128.61" y="-9867.69" font-family="Times,serif" font-size="14.00">GPU: 3758</text>
</g>
<!-- m45_final&#45;&gt;m46_res1 -->
<g id="edge707" class="edge">
<title>m45_final&#45;&gt;m46_res1</title>
<path fill="none" stroke="black" d="M35047.39,-9942.95C35060.6,-9932.7 35076.05,-9920.7 35089.9,-9909.94"/>
<polygon fill="black" stroke="black" points="35092.1,-9912.67 35097.85,-9903.77 35087.81,-9907.14 35092.1,-9912.67"/>
</g>
<!-- m46_ln1 -->
<g id="node548" class="node">
<title>m46_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="35242.61" cy="-10291.93" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="35242.61" y="-10295.73" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="35242.61" y="-10280.73" font-family="Times,serif" font-size="14.00">GPU: 3758</text>
</g>
<!-- m46_qkv -->
<g id="node549" class="node">
<title>m46_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="35242.61" cy="-10180.97" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="35242.61" y="-10184.77" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="35242.61" y="-10169.77" font-family="Times,serif" font-size="14.00">GPU: 3758</text>
</g>
<!-- m46_ln1&#45;&gt;m46_qkv -->
<g id="edge703" class="edge">
<title>m46_ln1&#45;&gt;m46_qkv</title>
<path fill="none" stroke="black" d="M35242.61,-10264.83C35242.61,-10250.81 35242.61,-10233.32 35242.61,-10218.03"/>
<polygon fill="black" stroke="black" points="35246.11,-10217.86 35242.61,-10207.86 35239.11,-10217.86 35246.11,-10217.86"/>
</g>
<!-- m46_mha -->
<g id="node550" class="node">
<title>m46_mha</title>
<ellipse fill="lightblue" stroke="black" cx="35242.61" cy="-10069.5" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="35242.61" y="-10073.3" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="35242.61" y="-10058.3" font-family="Times,serif" font-size="14.00">GPU: 3758</text>
</g>
<!-- m46_qkv&#45;&gt;m46_mha -->
<g id="edge704" class="edge">
<title>m46_qkv&#45;&gt;m46_mha</title>
<path fill="none" stroke="black" d="M35242.61,-10154.03C35242.61,-10139.95 35242.61,-10122.32 35242.61,-10106.89"/>
<polygon fill="black" stroke="black" points="35246.11,-10106.63 35242.61,-10096.63 35239.11,-10106.63 35246.11,-10106.63"/>
</g>
<!-- m46_out -->
<g id="node551" class="node">
<title>m46_out</title>
<ellipse fill="lightblue" stroke="black" cx="35242.61" cy="-9968.63" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="35242.61" y="-9972.43" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="35242.61" y="-9957.43" font-family="Times,serif" font-size="14.00">GPU: 3758</text>
</g>
<!-- m46_mha&#45;&gt;m46_out -->
<g id="edge705" class="edge">
<title>m46_mha&#45;&gt;m46_out</title>
<path fill="none" stroke="black" d="M35242.61,-10042.52C35242.61,-10031.37 35242.61,-10018.14 35242.61,-10006.04"/>
<polygon fill="black" stroke="black" points="35246.11,-10005.77 35242.61,-9995.77 35239.11,-10005.77 35246.11,-10005.77"/>
</g>
<!-- m46_out&#45;&gt;m46_res1 -->
<g id="edge706" class="edge">
<title>m46_out&#45;&gt;m46_res1</title>
<path fill="none" stroke="black" d="M35210.55,-9942.95C35197.23,-9932.7 35181.64,-9920.7 35167.66,-9909.94"/>
<polygon fill="black" stroke="black" points="35169.7,-9907.1 35159.64,-9903.77 35165.43,-9912.64 35169.7,-9907.1"/>
</g>
<!-- m46_gate -->
<g id="node553" class="node">
<title>m46_gate</title>
<polygon fill="orange" stroke="black" points="35100.23,-9816.02 34895.63,-9816.02 34843,-9710.02 35047.59,-9710.02 35100.23,-9816.02"/>
<text text-anchor="middle" x="34971.61" y="-9774.32" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="34971.61" y="-9759.32" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="34971.61" y="-9744.32" font-family="Times,serif" font-size="14.00">GPU: 3758</text>
</g>
<!-- m46_res1&#45;&gt;m46_gate -->
<g id="edge708" class="edge">
<title>m46_res1&#45;&gt;m46_gate</title>
<path fill="none" stroke="black" d="M35096.08,-9854.29C35083.08,-9844.86 35067.48,-9833.55 35051.79,-9822.17"/>
<polygon fill="black" stroke="black" points="35053.74,-9819.26 35043.59,-9816.22 35049.63,-9824.92 35053.74,-9819.26"/>
</g>
<!-- m46_route -->
<g id="node554" class="node">
<title>m46_route</title>
<ellipse fill="lightgray" stroke="black" cx="34971.61" cy="-9636.54" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="34971.61" y="-9647.84" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="34971.61" y="-9632.84" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="34971.61" y="-9617.84" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m46_res1&#45;&gt;m46_route -->
<g id="edge710" class="edge">
<title>m46_res1&#45;&gt;m46_route</title>
<path fill="none" stroke="black" d="M35132.67,-9852.04C35136.79,-9816.71 35138.92,-9752.86 35109.61,-9710.02 35096.5,-9690.85 35076.68,-9676.39 35056.11,-9665.64"/>
<polygon fill="black" stroke="black" points="35057.47,-9662.4 35046.95,-9661.1 35054.36,-9668.68 35057.47,-9662.4"/>
</g>
<!-- m46_final -->
<g id="node559" class="node">
<title>m46_final</title>
<ellipse fill="lightpink" stroke="black" cx="35544.61" cy="-9313.24" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="35544.61" y="-9317.04" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="35544.61" y="-9302.04" font-family="Times,serif" font-size="14.00">GPU: 3758</text>
</g>
<!-- m46_res1&#45;&gt;m46_final -->
<g id="edge718" class="edge">
<title>m46_res1&#45;&gt;m46_final</title>
<path fill="none" stroke="black" d="M35204.71,-9873.21C35338.21,-9860.46 35600.61,-9813.06 35600.61,-9637.54 35600.61,-9637.54 35600.61,-9637.54 35600.61,-9524.59 35600.61,-9461.26 35576.62,-9390.71 35560.04,-9349.53"/>
<polygon fill="black" stroke="black" points="35563.25,-9348.13 35556.22,-9340.21 35556.78,-9350.79 35563.25,-9348.13"/>
</g>
<!-- m46_gate&#45;&gt;m46_route -->
<g id="edge709" class="edge">
<title>m46_gate&#45;&gt;m46_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34971.61,-9709.95C34971.61,-9701.52 34971.61,-9692.83 34971.61,-9684.53"/>
<polygon fill="black" stroke="black" points="34975.11,-9684.27 34971.61,-9674.27 34968.11,-9684.27 34975.11,-9684.27"/>
</g>
<!-- m46_expert0 -->
<g id="node555" class="node">
<title>m46_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="34054.61" cy="-9525.59" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="34054.61" y="-9536.89" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="34054.61" y="-9521.89" font-family="Times,serif" font-size="14.00">Node 344 GPU 0</text>
<text text-anchor="middle" x="34054.61" y="-9506.89" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m46_route&#45;&gt;m46_expert0 -->
<g id="edge711" class="edge">
<title>m46_route&#45;&gt;m46_expert0</title>
<path fill="none" stroke="black" d="M34877.15,-9624.35C34757.09,-9610.13 34543.46,-9584.81 34360.61,-9563.06 34333.41,-9559.83 34304.84,-9556.43 34276.54,-9553.06"/>
<polygon fill="black" stroke="black" points="34276.89,-9549.57 34266.55,-9551.87 34276.06,-9556.52 34276.89,-9549.57"/>
</g>
<!-- m46_expert1 -->
<g id="node556" class="node">
<title>m46_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="34665.61" cy="-9525.59" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="34665.61" y="-9536.89" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="34665.61" y="-9521.89" font-family="Times,serif" font-size="14.00">Node 344 GPU 1</text>
<text text-anchor="middle" x="34665.61" y="-9506.89" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m46_route&#45;&gt;m46_expert1 -->
<g id="edge713" class="edge">
<title>m46_route&#45;&gt;m46_expert1</title>
<path fill="none" stroke="black" d="M34900.26,-9610.13C34862.08,-9596.54 34814.32,-9579.53 34771.87,-9564.42"/>
<polygon fill="black" stroke="black" points="34772.93,-9561.08 34762.33,-9561.02 34770.58,-9567.68 34772.93,-9561.08"/>
</g>
<!-- m46_expert2 -->
<g id="node557" class="node">
<title>m46_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="35276.61" cy="-9525.59" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="35276.61" y="-9536.89" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="35276.61" y="-9521.89" font-family="Times,serif" font-size="14.00">Node 344 GPU 2</text>
<text text-anchor="middle" x="35276.61" y="-9506.89" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m46_route&#45;&gt;m46_expert2 -->
<g id="edge715" class="edge">
<title>m46_route&#45;&gt;m46_expert2</title>
<path fill="none" stroke="black" d="M35042.74,-9610.13C35080.78,-9596.54 35128.39,-9579.53 35170.7,-9564.42"/>
<polygon fill="black" stroke="black" points="35171.97,-9567.68 35180.21,-9561.02 35169.61,-9561.09 35171.97,-9567.68"/>
</g>
<!-- m46_agg -->
<g id="node558" class="node">
<title>m46_agg</title>
<polygon fill="purple" stroke="black" points="35135.23,-9452.11 34874.95,-9452.11 34808,-9376.11 35068.27,-9376.11 35135.23,-9452.11"/>
<text text-anchor="middle" x="34971.61" y="-9417.91" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="34971.61" y="-9402.91" font-family="Times,serif" font-size="14.00">GPU: 3758</text>
</g>
<!-- m46_expert0&#45;&gt;m46_agg -->
<g id="edge712" class="edge">
<title>m46_expert0&#45;&gt;m46_agg</title>
<path fill="none" stroke="black" d="M34266.14,-9499.33C34444.91,-9477.99 34695.08,-9448.12 34844.48,-9430.29"/>
<polygon fill="black" stroke="black" points="34845.1,-9433.74 34854.62,-9429.08 34844.27,-9426.79 34845.1,-9433.74"/>
</g>
<!-- m46_expert1&#45;&gt;m46_agg -->
<g id="edge714" class="edge">
<title>m46_expert1&#45;&gt;m46_agg</title>
<path fill="none" stroke="black" d="M34762.01,-9490.1C34794.3,-9478.55 34830.5,-9465.59 34863.62,-9453.75"/>
<polygon fill="black" stroke="black" points="34865.09,-9456.94 34873.33,-9450.27 34862.73,-9450.35 34865.09,-9456.94"/>
</g>
<!-- m46_expert2&#45;&gt;m46_agg -->
<g id="edge716" class="edge">
<title>m46_expert2&#45;&gt;m46_agg</title>
<path fill="none" stroke="black" d="M35180.53,-9490.1C35150.07,-9479.16 35116.11,-9466.97 35084.57,-9455.66"/>
<polygon fill="black" stroke="black" points="35085.47,-9452.26 35074.87,-9452.17 35083.1,-9458.85 35085.47,-9452.26"/>
</g>
<!-- m46_agg&#45;&gt;m46_final -->
<g id="edge717" class="edge">
<title>m46_agg&#45;&gt;m46_final</title>
<path fill="none" stroke="black" d="M35084.13,-9393.69C35190.17,-9375.4 35347.36,-9348.27 35447.9,-9330.93"/>
<polygon fill="black" stroke="black" points="35448.79,-9334.33 35458.05,-9329.18 35447.6,-9327.43 35448.79,-9334.33"/>
</g>
<!-- m47_res1 -->
<g id="node564" class="node">
<title>m47_res1</title>
<ellipse fill="lightpink" stroke="black" cx="35657.61" cy="-9223.5" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="35657.61" y="-9227.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="35657.61" y="-9212.3" font-family="Times,serif" font-size="14.00">GPU: 3759</text>
</g>
<!-- m46_final&#45;&gt;m47_res1 -->
<g id="edge723" class="edge">
<title>m46_final&#45;&gt;m47_res1</title>
<path fill="none" stroke="black" d="M35576.39,-9287.57C35589.6,-9277.31 35605.05,-9265.32 35618.9,-9254.55"/>
<polygon fill="black" stroke="black" points="35621.1,-9257.28 35626.85,-9248.38 35616.81,-9251.75 35621.1,-9257.28"/>
</g>
<!-- m47_ln1 -->
<g id="node560" class="node">
<title>m47_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="35771.61" cy="-9636.54" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="35771.61" y="-9640.34" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="35771.61" y="-9625.34" font-family="Times,serif" font-size="14.00">GPU: 3759</text>
</g>
<!-- m47_qkv -->
<g id="node561" class="node">
<title>m47_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="35771.61" cy="-9525.59" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="35771.61" y="-9529.39" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="35771.61" y="-9514.39" font-family="Times,serif" font-size="14.00">GPU: 3759</text>
</g>
<!-- m47_ln1&#45;&gt;m47_qkv -->
<g id="edge719" class="edge">
<title>m47_ln1&#45;&gt;m47_qkv</title>
<path fill="none" stroke="black" d="M35771.61,-9609.44C35771.61,-9595.43 35771.61,-9577.93 35771.61,-9562.64"/>
<polygon fill="black" stroke="black" points="35775.11,-9562.47 35771.61,-9552.47 35768.11,-9562.47 35775.11,-9562.47"/>
</g>
<!-- m47_mha -->
<g id="node562" class="node">
<title>m47_mha</title>
<ellipse fill="lightblue" stroke="black" cx="35771.61" cy="-9414.11" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="35771.61" y="-9417.91" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="35771.61" y="-9402.91" font-family="Times,serif" font-size="14.00">GPU: 3759</text>
</g>
<!-- m47_qkv&#45;&gt;m47_mha -->
<g id="edge720" class="edge">
<title>m47_qkv&#45;&gt;m47_mha</title>
<path fill="none" stroke="black" d="M35771.61,-9498.64C35771.61,-9484.57 35771.61,-9466.94 35771.61,-9451.51"/>
<polygon fill="black" stroke="black" points="35775.11,-9451.25 35771.61,-9441.25 35768.11,-9451.25 35775.11,-9451.25"/>
</g>
<!-- m47_out -->
<g id="node563" class="node">
<title>m47_out</title>
<ellipse fill="lightblue" stroke="black" cx="35771.61" cy="-9313.24" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="35771.61" y="-9317.04" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="35771.61" y="-9302.04" font-family="Times,serif" font-size="14.00">GPU: 3759</text>
</g>
<!-- m47_mha&#45;&gt;m47_out -->
<g id="edge721" class="edge">
<title>m47_mha&#45;&gt;m47_out</title>
<path fill="none" stroke="black" d="M35771.61,-9387.13C35771.61,-9375.98 35771.61,-9362.76 35771.61,-9350.65"/>
<polygon fill="black" stroke="black" points="35775.11,-9350.39 35771.61,-9340.39 35768.11,-9350.39 35775.11,-9350.39"/>
</g>
<!-- m47_out&#45;&gt;m47_res1 -->
<g id="edge722" class="edge">
<title>m47_out&#45;&gt;m47_res1</title>
<path fill="none" stroke="black" d="M35739.55,-9287.57C35726.23,-9277.31 35710.64,-9265.32 35696.66,-9254.55"/>
<polygon fill="black" stroke="black" points="35698.7,-9251.71 35688.64,-9248.38 35694.43,-9257.26 35698.7,-9251.71"/>
</g>
<!-- m47_gate -->
<g id="node565" class="node">
<title>m47_gate</title>
<polygon fill="orange" stroke="black" points="35629.23,-9160.63 35424.63,-9160.63 35372,-9054.63 35576.59,-9054.63 35629.23,-9160.63"/>
<text text-anchor="middle" x="35500.61" y="-9118.93" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="35500.61" y="-9103.93" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="35500.61" y="-9088.93" font-family="Times,serif" font-size="14.00">GPU: 3759</text>
</g>
<!-- m47_res1&#45;&gt;m47_gate -->
<g id="edge724" class="edge">
<title>m47_res1&#45;&gt;m47_gate</title>
<path fill="none" stroke="black" d="M35625.08,-9198.91C35612.08,-9189.47 35596.48,-9178.16 35580.79,-9166.78"/>
<polygon fill="black" stroke="black" points="35582.74,-9163.87 35572.59,-9160.83 35578.63,-9169.54 35582.74,-9163.87"/>
</g>
<!-- m47_route -->
<g id="node566" class="node">
<title>m47_route</title>
<ellipse fill="lightgray" stroke="black" cx="35500.61" cy="-8981.15" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="35500.61" y="-8992.45" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="35500.61" y="-8977.45" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="35500.61" y="-8962.45" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m47_res1&#45;&gt;m47_route -->
<g id="edge726" class="edge">
<title>m47_res1&#45;&gt;m47_route</title>
<path fill="none" stroke="black" d="M35661.67,-9196.65C35665.79,-9161.32 35667.92,-9097.48 35638.61,-9054.63 35625.5,-9035.46 35605.68,-9021.01 35585.11,-9010.25"/>
<polygon fill="black" stroke="black" points="35586.47,-9007.01 35575.95,-9005.71 35583.36,-9013.29 35586.47,-9007.01"/>
</g>
<!-- m47_final -->
<g id="node571" class="node">
<title>m47_final</title>
<ellipse fill="lightpink" stroke="black" cx="36074.61" cy="-8657.85" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="36074.61" y="-8661.65" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="36074.61" y="-8646.65" font-family="Times,serif" font-size="14.00">GPU: 3759</text>
</g>
<!-- m47_res1&#45;&gt;m47_final -->
<g id="edge734" class="edge">
<title>m47_res1&#45;&gt;m47_final</title>
<path fill="none" stroke="black" d="M35733.87,-9217.89C35867.66,-9205.22 36130.61,-9157.97 36130.61,-8982.15 36130.61,-8982.15 36130.61,-8982.15 36130.61,-8869.2 36130.61,-8805.88 36106.62,-8735.33 36090.04,-8694.14"/>
<polygon fill="black" stroke="black" points="36093.25,-8692.74 36086.22,-8684.82 36086.78,-8695.4 36093.25,-8692.74"/>
</g>
<!-- m47_gate&#45;&gt;m47_route -->
<g id="edge725" class="edge">
<title>m47_gate&#45;&gt;m47_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35500.61,-9054.56C35500.61,-9046.13 35500.61,-9037.44 35500.61,-9029.14"/>
<polygon fill="black" stroke="black" points="35504.11,-9028.88 35500.61,-9018.88 35497.11,-9028.88 35504.11,-9028.88"/>
</g>
<!-- m47_expert0 -->
<g id="node567" class="node">
<title>m47_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="34584.61" cy="-8870.2" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="34584.61" y="-8881.5" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="34584.61" y="-8866.5" font-family="Times,serif" font-size="14.00">Node 352 GPU 0</text>
<text text-anchor="middle" x="34584.61" y="-8851.5" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m47_route&#45;&gt;m47_expert0 -->
<g id="edge727" class="edge">
<title>m47_route&#45;&gt;m47_expert0</title>
<path fill="none" stroke="black" d="M35406.3,-8968.96C35286.44,-8954.73 35073.16,-8929.4 34890.61,-8907.68 34863.41,-8904.44 34834.84,-8901.04 34806.54,-8897.66"/>
<polygon fill="black" stroke="black" points="34806.89,-8894.18 34796.55,-8896.47 34806.06,-8901.13 34806.89,-8894.18"/>
</g>
<!-- m47_expert1 -->
<g id="node568" class="node">
<title>m47_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="35195.61" cy="-8870.2" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="35195.61" y="-8881.5" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="35195.61" y="-8866.5" font-family="Times,serif" font-size="14.00">Node 352 GPU 1</text>
<text text-anchor="middle" x="35195.61" y="-8851.5" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m47_route&#45;&gt;m47_expert1 -->
<g id="edge729" class="edge">
<title>m47_route&#45;&gt;m47_expert1</title>
<path fill="none" stroke="black" d="M35429.49,-8954.75C35391.44,-8941.15 35343.83,-8924.15 35301.52,-8909.03"/>
<polygon fill="black" stroke="black" points="35302.61,-8905.71 35292.02,-8905.64 35300.26,-8912.3 35302.61,-8905.71"/>
</g>
<!-- m47_expert2 -->
<g id="node569" class="node">
<title>m47_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="35806.61" cy="-8870.2" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="35806.61" y="-8881.5" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="35806.61" y="-8866.5" font-family="Times,serif" font-size="14.00">Node 352 GPU 2</text>
<text text-anchor="middle" x="35806.61" y="-8851.5" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m47_route&#45;&gt;m47_expert2 -->
<g id="edge731" class="edge">
<title>m47_route&#45;&gt;m47_expert2</title>
<path fill="none" stroke="black" d="M35571.97,-8954.75C35610.14,-8941.15 35657.9,-8924.15 35700.36,-8909.03"/>
<polygon fill="black" stroke="black" points="35701.64,-8912.29 35709.89,-8905.64 35699.3,-8905.7 35701.64,-8912.29"/>
</g>
<!-- m47_agg -->
<g id="node570" class="node">
<title>m47_agg</title>
<polygon fill="purple" stroke="black" points="35665.23,-8796.72 35404.95,-8796.72 35338,-8720.72 35598.27,-8720.72 35665.23,-8796.72"/>
<text text-anchor="middle" x="35501.61" y="-8762.52" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="35501.61" y="-8747.52" font-family="Times,serif" font-size="14.00">GPU: 3759</text>
</g>
<!-- m47_expert0&#45;&gt;m47_agg -->
<g id="edge728" class="edge">
<title>m47_expert0&#45;&gt;m47_agg</title>
<path fill="none" stroke="black" d="M34796.14,-8843.95C34974.91,-8822.6 35225.08,-8792.74 35374.48,-8774.9"/>
<polygon fill="black" stroke="black" points="35375.1,-8778.35 35384.62,-8773.69 35374.27,-8771.4 35375.1,-8778.35"/>
</g>
<!-- m47_expert1&#45;&gt;m47_agg -->
<g id="edge730" class="edge">
<title>m47_expert1&#45;&gt;m47_agg</title>
<path fill="none" stroke="black" d="M35292.01,-8834.71C35324.3,-8823.16 35360.5,-8810.21 35393.62,-8798.36"/>
<polygon fill="black" stroke="black" points="35395.09,-8801.55 35403.33,-8794.89 35392.73,-8794.96 35395.09,-8801.55"/>
</g>
<!-- m47_expert2&#45;&gt;m47_agg -->
<g id="edge732" class="edge">
<title>m47_expert2&#45;&gt;m47_agg</title>
<path fill="none" stroke="black" d="M35710.53,-8834.71C35680.07,-8823.78 35646.11,-8811.59 35614.57,-8800.27"/>
<polygon fill="black" stroke="black" points="35615.47,-8796.87 35604.87,-8796.79 35613.1,-8803.46 35615.47,-8796.87"/>
</g>
<!-- m47_agg&#45;&gt;m47_final -->
<g id="edge733" class="edge">
<title>m47_agg&#45;&gt;m47_final</title>
<path fill="none" stroke="black" d="M35614.13,-8738.31C35720.17,-8720.01 35877.36,-8692.89 35977.9,-8675.54"/>
<polygon fill="black" stroke="black" points="35978.79,-8678.94 35988.05,-8673.79 35977.6,-8672.04 35978.79,-8678.94"/>
</g>
<!-- m48_res1 -->
<g id="node576" class="node">
<title>m48_res1</title>
<ellipse fill="lightpink" stroke="black" cx="36187.61" cy="-8568.11" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="36187.61" y="-8571.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="36187.61" y="-8556.91" font-family="Times,serif" font-size="14.00">GPU: 3760</text>
</g>
<!-- m47_final&#45;&gt;m48_res1 -->
<g id="edge739" class="edge">
<title>m47_final&#45;&gt;m48_res1</title>
<path fill="none" stroke="black" d="M36106.39,-8632.18C36119.6,-8621.92 36135.05,-8609.93 36148.9,-8599.17"/>
<polygon fill="black" stroke="black" points="36151.1,-8601.89 36156.85,-8593 36146.81,-8596.36 36151.1,-8601.89"/>
</g>
<!-- m48_ln1 -->
<g id="node572" class="node">
<title>m48_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="36301.61" cy="-8981.15" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="36301.61" y="-8984.95" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="36301.61" y="-8969.95" font-family="Times,serif" font-size="14.00">GPU: 3760</text>
</g>
<!-- m48_qkv -->
<g id="node573" class="node">
<title>m48_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="36301.61" cy="-8870.2" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="36301.61" y="-8874" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="36301.61" y="-8859" font-family="Times,serif" font-size="14.00">GPU: 3760</text>
</g>
<!-- m48_ln1&#45;&gt;m48_qkv -->
<g id="edge735" class="edge">
<title>m48_ln1&#45;&gt;m48_qkv</title>
<path fill="none" stroke="black" d="M36301.61,-8954.06C36301.61,-8940.04 36301.61,-8922.55 36301.61,-8907.25"/>
<polygon fill="black" stroke="black" points="36305.11,-8907.08 36301.61,-8897.08 36298.11,-8907.08 36305.11,-8907.08"/>
</g>
<!-- m48_mha -->
<g id="node574" class="node">
<title>m48_mha</title>
<ellipse fill="lightblue" stroke="black" cx="36301.61" cy="-8758.72" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="36301.61" y="-8762.52" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="36301.61" y="-8747.52" font-family="Times,serif" font-size="14.00">GPU: 3760</text>
</g>
<!-- m48_qkv&#45;&gt;m48_mha -->
<g id="edge736" class="edge">
<title>m48_qkv&#45;&gt;m48_mha</title>
<path fill="none" stroke="black" d="M36301.61,-8843.25C36301.61,-8829.18 36301.61,-8811.55 36301.61,-8796.12"/>
<polygon fill="black" stroke="black" points="36305.11,-8795.86 36301.61,-8785.86 36298.11,-8795.86 36305.11,-8795.86"/>
</g>
<!-- m48_out -->
<g id="node575" class="node">
<title>m48_out</title>
<ellipse fill="lightblue" stroke="black" cx="36301.61" cy="-8657.85" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="36301.61" y="-8661.65" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="36301.61" y="-8646.65" font-family="Times,serif" font-size="14.00">GPU: 3760</text>
</g>
<!-- m48_mha&#45;&gt;m48_out -->
<g id="edge737" class="edge">
<title>m48_mha&#45;&gt;m48_out</title>
<path fill="none" stroke="black" d="M36301.61,-8731.75C36301.61,-8720.59 36301.61,-8707.37 36301.61,-8695.27"/>
<polygon fill="black" stroke="black" points="36305.11,-8695 36301.61,-8685 36298.11,-8695 36305.11,-8695"/>
</g>
<!-- m48_out&#45;&gt;m48_res1 -->
<g id="edge738" class="edge">
<title>m48_out&#45;&gt;m48_res1</title>
<path fill="none" stroke="black" d="M36269.55,-8632.18C36256.23,-8621.92 36240.64,-8609.93 36226.66,-8599.17"/>
<polygon fill="black" stroke="black" points="36228.7,-8596.32 36218.64,-8593 36224.43,-8601.87 36228.7,-8596.32"/>
</g>
<!-- m48_gate -->
<g id="node577" class="node">
<title>m48_gate</title>
<polygon fill="orange" stroke="black" points="36159.23,-8505.24 35954.63,-8505.24 35902,-8399.24 36106.59,-8399.24 36159.23,-8505.24"/>
<text text-anchor="middle" x="36030.61" y="-8463.54" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="36030.61" y="-8448.54" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="36030.61" y="-8433.54" font-family="Times,serif" font-size="14.00">GPU: 3760</text>
</g>
<!-- m48_res1&#45;&gt;m48_gate -->
<g id="edge740" class="edge">
<title>m48_res1&#45;&gt;m48_gate</title>
<path fill="none" stroke="black" d="M36155.08,-8543.52C36142.08,-8534.09 36126.48,-8522.77 36110.79,-8511.39"/>
<polygon fill="black" stroke="black" points="36112.74,-8508.48 36102.59,-8505.45 36108.63,-8514.15 36112.74,-8508.48"/>
</g>
<!-- m48_route -->
<g id="node578" class="node">
<title>m48_route</title>
<ellipse fill="lightgray" stroke="black" cx="36030.61" cy="-8325.77" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="36030.61" y="-8337.07" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="36030.61" y="-8322.07" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="36030.61" y="-8307.07" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m48_res1&#45;&gt;m48_route -->
<g id="edge742" class="edge">
<title>m48_res1&#45;&gt;m48_route</title>
<path fill="none" stroke="black" d="M36191.67,-8541.26C36195.79,-8505.94 36197.92,-8442.09 36168.61,-8399.24 36155.5,-8380.08 36135.68,-8365.62 36115.11,-8354.86"/>
<polygon fill="black" stroke="black" points="36116.47,-8351.63 36105.95,-8350.33 36113.36,-8357.9 36116.47,-8351.63"/>
</g>
<!-- m48_final -->
<g id="node583" class="node">
<title>m48_final</title>
<ellipse fill="lightpink" stroke="black" cx="36604.61" cy="-8002.47" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="36604.61" y="-8006.27" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="36604.61" y="-7991.27" font-family="Times,serif" font-size="14.00">GPU: 3760</text>
</g>
<!-- m48_res1&#45;&gt;m48_final -->
<g id="edge750" class="edge">
<title>m48_res1&#45;&gt;m48_final</title>
<path fill="none" stroke="black" d="M36263.87,-8562.5C36397.66,-8549.84 36660.61,-8502.58 36660.61,-8326.77 36660.61,-8326.77 36660.61,-8326.77 36660.61,-8213.81 36660.61,-8150.49 36636.62,-8079.94 36620.04,-8038.76"/>
<polygon fill="black" stroke="black" points="36623.25,-8037.36 36616.22,-8029.44 36616.78,-8040.02 36623.25,-8037.36"/>
</g>
<!-- m48_gate&#45;&gt;m48_route -->
<g id="edge741" class="edge">
<title>m48_gate&#45;&gt;m48_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36030.61,-8399.17C36030.61,-8390.74 36030.61,-8382.06 36030.61,-8373.75"/>
<polygon fill="black" stroke="black" points="36034.11,-8373.49 36030.61,-8363.49 36027.11,-8373.49 36034.11,-8373.49"/>
</g>
<!-- m48_expert0 -->
<g id="node579" class="node">
<title>m48_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="35114.61" cy="-8214.81" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="35114.61" y="-8226.11" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="35114.61" y="-8211.11" font-family="Times,serif" font-size="14.00">Node 360 GPU 0</text>
<text text-anchor="middle" x="35114.61" y="-8196.11" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m48_route&#45;&gt;m48_expert0 -->
<g id="edge743" class="edge">
<title>m48_route&#45;&gt;m48_expert0</title>
<path fill="none" stroke="black" d="M35936.3,-8313.57C35816.44,-8299.34 35603.16,-8274.01 35420.61,-8252.29 35393.41,-8249.05 35364.84,-8245.65 35336.54,-8242.28"/>
<polygon fill="black" stroke="black" points="35336.89,-8238.79 35326.55,-8241.09 35336.06,-8245.75 35336.89,-8238.79"/>
</g>
<!-- m48_expert1 -->
<g id="node580" class="node">
<title>m48_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="35725.61" cy="-8214.81" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="35725.61" y="-8226.11" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="35725.61" y="-8211.11" font-family="Times,serif" font-size="14.00">Node 360 GPU 1</text>
<text text-anchor="middle" x="35725.61" y="-8196.11" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m48_route&#45;&gt;m48_expert1 -->
<g id="edge745" class="edge">
<title>m48_route&#45;&gt;m48_expert1</title>
<path fill="none" stroke="black" d="M35959.49,-8299.36C35921.44,-8285.77 35873.83,-8268.76 35831.52,-8253.65"/>
<polygon fill="black" stroke="black" points="35832.61,-8250.32 35822.02,-8250.25 35830.26,-8256.91 35832.61,-8250.32"/>
</g>
<!-- m48_expert2 -->
<g id="node581" class="node">
<title>m48_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="36336.61" cy="-8214.81" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="36336.61" y="-8226.11" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="36336.61" y="-8211.11" font-family="Times,serif" font-size="14.00">Node 360 GPU 2</text>
<text text-anchor="middle" x="36336.61" y="-8196.11" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m48_route&#45;&gt;m48_expert2 -->
<g id="edge747" class="edge">
<title>m48_route&#45;&gt;m48_expert2</title>
<path fill="none" stroke="black" d="M36101.97,-8299.36C36140.14,-8285.77 36187.9,-8268.76 36230.36,-8253.65"/>
<polygon fill="black" stroke="black" points="36231.64,-8256.9 36239.89,-8250.25 36229.3,-8250.31 36231.64,-8256.9"/>
</g>
<!-- m48_agg -->
<g id="node582" class="node">
<title>m48_agg</title>
<polygon fill="purple" stroke="black" points="36195.23,-8141.34 35934.95,-8141.34 35868,-8065.34 36128.27,-8065.34 36195.23,-8141.34"/>
<text text-anchor="middle" x="36031.61" y="-8107.14" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="36031.61" y="-8092.14" font-family="Times,serif" font-size="14.00">GPU: 3760</text>
</g>
<!-- m48_expert0&#45;&gt;m48_agg -->
<g id="edge744" class="edge">
<title>m48_expert0&#45;&gt;m48_agg</title>
<path fill="none" stroke="black" d="M35326.14,-8188.56C35504.91,-8167.22 35755.08,-8137.35 35904.48,-8119.51"/>
<polygon fill="black" stroke="black" points="35905.1,-8122.96 35914.62,-8118.3 35904.27,-8116.01 35905.1,-8122.96"/>
</g>
<!-- m48_expert1&#45;&gt;m48_agg -->
<g id="edge746" class="edge">
<title>m48_expert1&#45;&gt;m48_agg</title>
<path fill="none" stroke="black" d="M35822.01,-8179.32C35854.3,-8167.77 35890.5,-8154.82 35923.62,-8142.97"/>
<polygon fill="black" stroke="black" points="35925.09,-8146.16 35933.33,-8139.5 35922.73,-8139.57 35925.09,-8146.16"/>
</g>
<!-- m48_expert2&#45;&gt;m48_agg -->
<g id="edge748" class="edge">
<title>m48_expert2&#45;&gt;m48_agg</title>
<path fill="none" stroke="black" d="M36240.53,-8179.32C36210.07,-8168.39 36176.11,-8156.2 36144.57,-8144.88"/>
<polygon fill="black" stroke="black" points="36145.47,-8141.48 36134.87,-8141.4 36143.1,-8148.07 36145.47,-8141.48"/>
</g>
<!-- m48_agg&#45;&gt;m48_final -->
<g id="edge749" class="edge">
<title>m48_agg&#45;&gt;m48_final</title>
<path fill="none" stroke="black" d="M36144.13,-8082.92C36250.17,-8064.62 36407.36,-8037.5 36507.9,-8020.15"/>
<polygon fill="black" stroke="black" points="36508.79,-8023.55 36518.05,-8018.4 36507.6,-8016.65 36508.79,-8023.55"/>
</g>
<!-- m49_res1 -->
<g id="node588" class="node">
<title>m49_res1</title>
<ellipse fill="lightpink" stroke="black" cx="36717.61" cy="-7912.73" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="36717.61" y="-7916.53" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="36717.61" y="-7901.53" font-family="Times,serif" font-size="14.00">GPU: 3761</text>
</g>
<!-- m48_final&#45;&gt;m49_res1 -->
<g id="edge755" class="edge">
<title>m48_final&#45;&gt;m49_res1</title>
<path fill="none" stroke="black" d="M36636.39,-7976.79C36649.6,-7966.54 36665.05,-7954.54 36678.9,-7943.78"/>
<polygon fill="black" stroke="black" points="36681.1,-7946.51 36686.85,-7937.61 36676.81,-7940.98 36681.1,-7946.51"/>
</g>
<!-- m49_ln1 -->
<g id="node584" class="node">
<title>m49_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="36831.61" cy="-8325.77" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="36831.61" y="-8329.57" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="36831.61" y="-8314.57" font-family="Times,serif" font-size="14.00">GPU: 3761</text>
</g>
<!-- m49_qkv -->
<g id="node585" class="node">
<title>m49_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="36831.61" cy="-8214.81" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="36831.61" y="-8218.61" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="36831.61" y="-8203.61" font-family="Times,serif" font-size="14.00">GPU: 3761</text>
</g>
<!-- m49_ln1&#45;&gt;m49_qkv -->
<g id="edge751" class="edge">
<title>m49_ln1&#45;&gt;m49_qkv</title>
<path fill="none" stroke="black" d="M36831.61,-8298.67C36831.61,-8284.65 36831.61,-8267.16 36831.61,-8251.87"/>
<polygon fill="black" stroke="black" points="36835.11,-8251.7 36831.61,-8241.7 36828.11,-8251.7 36835.11,-8251.7"/>
</g>
<!-- m49_mha -->
<g id="node586" class="node">
<title>m49_mha</title>
<ellipse fill="lightblue" stroke="black" cx="36831.61" cy="-8103.34" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="36831.61" y="-8107.14" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="36831.61" y="-8092.14" font-family="Times,serif" font-size="14.00">GPU: 3761</text>
</g>
<!-- m49_qkv&#45;&gt;m49_mha -->
<g id="edge752" class="edge">
<title>m49_qkv&#45;&gt;m49_mha</title>
<path fill="none" stroke="black" d="M36831.61,-8187.87C36831.61,-8173.79 36831.61,-8156.16 36831.61,-8140.73"/>
<polygon fill="black" stroke="black" points="36835.11,-8140.47 36831.61,-8130.47 36828.11,-8140.47 36835.11,-8140.47"/>
</g>
<!-- m49_out -->
<g id="node587" class="node">
<title>m49_out</title>
<ellipse fill="lightblue" stroke="black" cx="36831.61" cy="-8002.47" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="36831.61" y="-8006.27" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="36831.61" y="-7991.27" font-family="Times,serif" font-size="14.00">GPU: 3761</text>
</g>
<!-- m49_mha&#45;&gt;m49_out -->
<g id="edge753" class="edge">
<title>m49_mha&#45;&gt;m49_out</title>
<path fill="none" stroke="black" d="M36831.61,-8076.36C36831.61,-8065.21 36831.61,-8051.98 36831.61,-8039.88"/>
<polygon fill="black" stroke="black" points="36835.11,-8039.61 36831.61,-8029.61 36828.11,-8039.61 36835.11,-8039.61"/>
</g>
<!-- m49_out&#45;&gt;m49_res1 -->
<g id="edge754" class="edge">
<title>m49_out&#45;&gt;m49_res1</title>
<path fill="none" stroke="black" d="M36799.55,-7976.79C36786.23,-7966.54 36770.64,-7954.54 36756.66,-7943.78"/>
<polygon fill="black" stroke="black" points="36758.7,-7940.94 36748.64,-7937.61 36754.43,-7946.48 36758.7,-7940.94"/>
</g>
<!-- m49_gate -->
<g id="node589" class="node">
<title>m49_gate</title>
<polygon fill="orange" stroke="black" points="36689.23,-7849.86 36484.63,-7849.86 36432,-7743.86 36636.59,-7743.86 36689.23,-7849.86"/>
<text text-anchor="middle" x="36560.61" y="-7808.16" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="36560.61" y="-7793.16" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="36560.61" y="-7778.16" font-family="Times,serif" font-size="14.00">GPU: 3761</text>
</g>
<!-- m49_res1&#45;&gt;m49_gate -->
<g id="edge756" class="edge">
<title>m49_res1&#45;&gt;m49_gate</title>
<path fill="none" stroke="black" d="M36685.08,-7888.13C36672.08,-7878.7 36656.48,-7867.39 36640.79,-7856.01"/>
<polygon fill="black" stroke="black" points="36642.74,-7853.1 36632.59,-7850.06 36638.63,-7858.76 36642.74,-7853.1"/>
</g>
<!-- m49_route -->
<g id="node590" class="node">
<title>m49_route</title>
<ellipse fill="lightgray" stroke="black" cx="36560.61" cy="-7670.38" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="36560.61" y="-7681.68" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="36560.61" y="-7666.68" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="36560.61" y="-7651.68" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m49_res1&#45;&gt;m49_route -->
<g id="edge758" class="edge">
<title>m49_res1&#45;&gt;m49_route</title>
<path fill="none" stroke="black" d="M36721.67,-7885.87C36725.79,-7850.55 36727.92,-7786.7 36698.61,-7743.86 36685.5,-7724.69 36665.68,-7710.23 36645.11,-7699.48"/>
<polygon fill="black" stroke="black" points="36646.47,-7696.24 36635.95,-7694.94 36643.36,-7702.51 36646.47,-7696.24"/>
</g>
<!-- m49_final -->
<g id="node595" class="node">
<title>m49_final</title>
<ellipse fill="lightpink" stroke="black" cx="37134.61" cy="-7347.08" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="37134.61" y="-7350.88" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="37134.61" y="-7335.88" font-family="Times,serif" font-size="14.00">GPU: 3761</text>
</g>
<!-- m49_res1&#45;&gt;m49_final -->
<g id="edge766" class="edge">
<title>m49_res1&#45;&gt;m49_final</title>
<path fill="none" stroke="black" d="M36793.87,-7907.11C36927.66,-7894.45 37190.61,-7847.2 37190.61,-7671.38 37190.61,-7671.38 37190.61,-7671.38 37190.61,-7558.43 37190.61,-7495.1 37166.62,-7424.55 37150.04,-7383.37"/>
<polygon fill="black" stroke="black" points="37153.25,-7381.97 37146.22,-7374.05 37146.78,-7384.63 37153.25,-7381.97"/>
</g>
<!-- m49_gate&#45;&gt;m49_route -->
<g id="edge757" class="edge">
<title>m49_gate&#45;&gt;m49_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36560.61,-7743.79C36560.61,-7735.36 36560.61,-7726.67 36560.61,-7718.37"/>
<polygon fill="black" stroke="black" points="36564.11,-7718.11 36560.61,-7708.11 36557.11,-7718.11 36564.11,-7718.11"/>
</g>
<!-- m49_expert0 -->
<g id="node591" class="node">
<title>m49_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="35644.61" cy="-7559.43" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="35644.61" y="-7570.73" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="35644.61" y="-7555.73" font-family="Times,serif" font-size="14.00">Node 368 GPU 0</text>
<text text-anchor="middle" x="35644.61" y="-7540.73" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m49_route&#45;&gt;m49_expert0 -->
<g id="edge759" class="edge">
<title>m49_route&#45;&gt;m49_expert0</title>
<path fill="none" stroke="black" d="M36466.3,-7658.18C36346.44,-7643.96 36133.16,-7618.63 35950.61,-7596.9 35923.41,-7593.66 35894.84,-7590.26 35866.54,-7586.89"/>
<polygon fill="black" stroke="black" points="35866.89,-7583.41 35856.55,-7585.7 35866.06,-7590.36 35866.89,-7583.41"/>
</g>
<!-- m49_expert1 -->
<g id="node592" class="node">
<title>m49_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="36255.61" cy="-7559.43" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="36255.61" y="-7570.73" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="36255.61" y="-7555.73" font-family="Times,serif" font-size="14.00">Node 368 GPU 1</text>
<text text-anchor="middle" x="36255.61" y="-7540.73" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m49_route&#45;&gt;m49_expert1 -->
<g id="edge761" class="edge">
<title>m49_route&#45;&gt;m49_expert1</title>
<path fill="none" stroke="black" d="M36489.49,-7643.97C36451.44,-7630.38 36403.83,-7613.37 36361.52,-7598.26"/>
<polygon fill="black" stroke="black" points="36362.61,-7594.93 36352.02,-7594.86 36360.26,-7601.52 36362.61,-7594.93"/>
</g>
<!-- m49_expert2 -->
<g id="node593" class="node">
<title>m49_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="36866.61" cy="-7559.43" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="36866.61" y="-7570.73" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="36866.61" y="-7555.73" font-family="Times,serif" font-size="14.00">Node 368 GPU 2</text>
<text text-anchor="middle" x="36866.61" y="-7540.73" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m49_route&#45;&gt;m49_expert2 -->
<g id="edge763" class="edge">
<title>m49_route&#45;&gt;m49_expert2</title>
<path fill="none" stroke="black" d="M36631.97,-7643.97C36670.14,-7630.38 36717.9,-7613.37 36760.36,-7598.26"/>
<polygon fill="black" stroke="black" points="36761.64,-7601.52 36769.89,-7594.86 36759.3,-7594.92 36761.64,-7601.52"/>
</g>
<!-- m49_agg -->
<g id="node594" class="node">
<title>m49_agg</title>
<polygon fill="purple" stroke="black" points="36725.23,-7485.95 36464.95,-7485.95 36398,-7409.95 36658.27,-7409.95 36725.23,-7485.95"/>
<text text-anchor="middle" x="36561.61" y="-7451.75" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="36561.61" y="-7436.75" font-family="Times,serif" font-size="14.00">GPU: 3761</text>
</g>
<!-- m49_expert0&#45;&gt;m49_agg -->
<g id="edge760" class="edge">
<title>m49_expert0&#45;&gt;m49_agg</title>
<path fill="none" stroke="black" d="M35856.14,-7533.17C36034.91,-7511.83 36285.08,-7481.96 36434.48,-7464.13"/>
<polygon fill="black" stroke="black" points="36435.1,-7467.58 36444.62,-7462.92 36434.27,-7460.63 36435.1,-7467.58"/>
</g>
<!-- m49_expert1&#45;&gt;m49_agg -->
<g id="edge762" class="edge">
<title>m49_expert1&#45;&gt;m49_agg</title>
<path fill="none" stroke="black" d="M36352.01,-7523.94C36384.3,-7512.39 36420.5,-7499.43 36453.62,-7487.59"/>
<polygon fill="black" stroke="black" points="36455.09,-7490.78 36463.33,-7484.11 36452.73,-7484.19 36455.09,-7490.78"/>
</g>
<!-- m49_expert2&#45;&gt;m49_agg -->
<g id="edge764" class="edge">
<title>m49_expert2&#45;&gt;m49_agg</title>
<path fill="none" stroke="black" d="M36770.53,-7523.94C36740.07,-7513 36706.11,-7500.81 36674.57,-7489.5"/>
<polygon fill="black" stroke="black" points="36675.47,-7486.1 36664.87,-7486.01 36673.1,-7492.69 36675.47,-7486.1"/>
</g>
<!-- m49_agg&#45;&gt;m49_final -->
<g id="edge765" class="edge">
<title>m49_agg&#45;&gt;m49_final</title>
<path fill="none" stroke="black" d="M36674.13,-7427.53C36780.17,-7409.24 36937.36,-7382.11 37037.9,-7364.77"/>
<polygon fill="black" stroke="black" points="37038.79,-7368.16 37048.05,-7363.01 37037.6,-7361.27 37038.79,-7368.16"/>
</g>
<!-- m50_res1 -->
<g id="node600" class="node">
<title>m50_res1</title>
<ellipse fill="lightpink" stroke="black" cx="37247.61" cy="-7257.34" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="37247.61" y="-7261.14" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="37247.61" y="-7246.14" font-family="Times,serif" font-size="14.00">GPU: 3762</text>
</g>
<!-- m49_final&#45;&gt;m50_res1 -->
<g id="edge771" class="edge">
<title>m49_final&#45;&gt;m50_res1</title>
<path fill="none" stroke="black" d="M37166.39,-7321.4C37179.6,-7311.15 37195.05,-7299.15 37208.9,-7288.39"/>
<polygon fill="black" stroke="black" points="37211.1,-7291.12 37216.85,-7282.22 37206.81,-7285.59 37211.1,-7291.12"/>
</g>
<!-- m50_ln1 -->
<g id="node596" class="node">
<title>m50_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="37361.61" cy="-7670.38" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="37361.61" y="-7674.18" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="37361.61" y="-7659.18" font-family="Times,serif" font-size="14.00">GPU: 3762</text>
</g>
<!-- m50_qkv -->
<g id="node597" class="node">
<title>m50_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="37361.61" cy="-7559.43" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="37361.61" y="-7563.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="37361.61" y="-7548.23" font-family="Times,serif" font-size="14.00">GPU: 3762</text>
</g>
<!-- m50_ln1&#45;&gt;m50_qkv -->
<g id="edge767" class="edge">
<title>m50_ln1&#45;&gt;m50_qkv</title>
<path fill="none" stroke="black" d="M37361.61,-7643.28C37361.61,-7629.27 37361.61,-7611.77 37361.61,-7596.48"/>
<polygon fill="black" stroke="black" points="37365.11,-7596.31 37361.61,-7586.31 37358.11,-7596.31 37365.11,-7596.31"/>
</g>
<!-- m50_mha -->
<g id="node598" class="node">
<title>m50_mha</title>
<ellipse fill="lightblue" stroke="black" cx="37361.61" cy="-7447.95" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="37361.61" y="-7451.75" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="37361.61" y="-7436.75" font-family="Times,serif" font-size="14.00">GPU: 3762</text>
</g>
<!-- m50_qkv&#45;&gt;m50_mha -->
<g id="edge768" class="edge">
<title>m50_qkv&#45;&gt;m50_mha</title>
<path fill="none" stroke="black" d="M37361.61,-7532.48C37361.61,-7518.4 37361.61,-7500.78 37361.61,-7485.35"/>
<polygon fill="black" stroke="black" points="37365.11,-7485.09 37361.61,-7475.09 37358.11,-7485.09 37365.11,-7485.09"/>
</g>
<!-- m50_out -->
<g id="node599" class="node">
<title>m50_out</title>
<ellipse fill="lightblue" stroke="black" cx="37361.61" cy="-7347.08" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="37361.61" y="-7350.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="37361.61" y="-7335.88" font-family="Times,serif" font-size="14.00">GPU: 3762</text>
</g>
<!-- m50_mha&#45;&gt;m50_out -->
<g id="edge769" class="edge">
<title>m50_mha&#45;&gt;m50_out</title>
<path fill="none" stroke="black" d="M37361.61,-7420.97C37361.61,-7409.82 37361.61,-7396.6 37361.61,-7384.49"/>
<polygon fill="black" stroke="black" points="37365.11,-7384.23 37361.61,-7374.23 37358.11,-7384.23 37365.11,-7384.23"/>
</g>
<!-- m50_out&#45;&gt;m50_res1 -->
<g id="edge770" class="edge">
<title>m50_out&#45;&gt;m50_res1</title>
<path fill="none" stroke="black" d="M37329.55,-7321.4C37316.23,-7311.15 37300.64,-7299.15 37286.66,-7288.39"/>
<polygon fill="black" stroke="black" points="37288.7,-7285.55 37278.64,-7282.22 37284.43,-7291.1 37288.7,-7285.55"/>
</g>
<!-- m50_gate -->
<g id="node601" class="node">
<title>m50_gate</title>
<polygon fill="orange" stroke="black" points="37219.23,-7194.47 37014.63,-7194.47 36962,-7088.47 37166.59,-7088.47 37219.23,-7194.47"/>
<text text-anchor="middle" x="37090.61" y="-7152.77" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="37090.61" y="-7137.77" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="37090.61" y="-7122.77" font-family="Times,serif" font-size="14.00">GPU: 3762</text>
</g>
<!-- m50_res1&#45;&gt;m50_gate -->
<g id="edge772" class="edge">
<title>m50_res1&#45;&gt;m50_gate</title>
<path fill="none" stroke="black" d="M37215.08,-7232.74C37202.08,-7223.31 37186.48,-7212 37170.79,-7200.62"/>
<polygon fill="black" stroke="black" points="37172.74,-7197.71 37162.59,-7194.67 37168.63,-7203.38 37172.74,-7197.71"/>
</g>
<!-- m50_route -->
<g id="node602" class="node">
<title>m50_route</title>
<ellipse fill="lightgray" stroke="black" cx="37090.61" cy="-7014.99" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="37090.61" y="-7026.29" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="37090.61" y="-7011.29" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="37090.61" y="-6996.29" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m50_res1&#45;&gt;m50_route -->
<g id="edge774" class="edge">
<title>m50_res1&#45;&gt;m50_route</title>
<path fill="none" stroke="black" d="M37251.67,-7230.49C37255.79,-7195.16 37257.92,-7131.32 37228.61,-7088.47 37215.5,-7069.3 37195.68,-7054.84 37175.11,-7044.09"/>
<polygon fill="black" stroke="black" points="37176.47,-7040.85 37165.95,-7039.55 37173.36,-7047.13 37176.47,-7040.85"/>
</g>
<!-- m50_final -->
<g id="node607" class="node">
<title>m50_final</title>
<ellipse fill="lightpink" stroke="black" cx="37663.61" cy="-6691.69" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="37663.61" y="-6695.49" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="37663.61" y="-6680.49" font-family="Times,serif" font-size="14.00">GPU: 3762</text>
</g>
<!-- m50_res1&#45;&gt;m50_final -->
<g id="edge782" class="edge">
<title>m50_res1&#45;&gt;m50_final</title>
<path fill="none" stroke="black" d="M37323.71,-7251.67C37457.21,-7238.91 37719.61,-7191.51 37719.61,-7015.99 37719.61,-7015.99 37719.61,-7015.99 37719.61,-6903.04 37719.61,-6839.71 37695.62,-6769.17 37679.04,-6727.98"/>
<polygon fill="black" stroke="black" points="37682.25,-6726.58 37675.22,-6718.66 37675.78,-6729.24 37682.25,-6726.58"/>
</g>
<!-- m50_gate&#45;&gt;m50_route -->
<g id="edge773" class="edge">
<title>m50_gate&#45;&gt;m50_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37090.61,-7088.4C37090.61,-7079.97 37090.61,-7071.28 37090.61,-7062.98"/>
<polygon fill="black" stroke="black" points="37094.11,-7062.72 37090.61,-7052.72 37087.11,-7062.72 37094.11,-7062.72"/>
</g>
<!-- m50_expert0 -->
<g id="node603" class="node">
<title>m50_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="36173.61" cy="-6904.04" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="36173.61" y="-6915.34" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="36173.61" y="-6900.34" font-family="Times,serif" font-size="14.00">Node 376 GPU 0</text>
<text text-anchor="middle" x="36173.61" y="-6885.34" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m50_route&#45;&gt;m50_expert0 -->
<g id="edge775" class="edge">
<title>m50_route&#45;&gt;m50_expert0</title>
<path fill="none" stroke="black" d="M36996.15,-7002.8C36876.09,-6988.58 36662.46,-6963.26 36479.61,-6941.52 36452.41,-6938.28 36423.84,-6934.88 36395.54,-6931.51"/>
<polygon fill="black" stroke="black" points="36395.89,-6928.03 36385.55,-6930.32 36395.06,-6934.98 36395.89,-6928.03"/>
</g>
<!-- m50_expert1 -->
<g id="node604" class="node">
<title>m50_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="36784.61" cy="-6904.04" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="36784.61" y="-6915.34" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="36784.61" y="-6900.34" font-family="Times,serif" font-size="14.00">Node 376 GPU 1</text>
<text text-anchor="middle" x="36784.61" y="-6885.34" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m50_route&#45;&gt;m50_expert1 -->
<g id="edge777" class="edge">
<title>m50_route&#45;&gt;m50_expert1</title>
<path fill="none" stroke="black" d="M37019.26,-6988.58C36981.08,-6974.99 36933.32,-6957.99 36890.87,-6942.87"/>
<polygon fill="black" stroke="black" points="36891.93,-6939.53 36881.33,-6939.48 36889.58,-6946.13 36891.93,-6939.53"/>
</g>
<!-- m50_expert2 -->
<g id="node605" class="node">
<title>m50_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="37395.61" cy="-6904.04" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="37395.61" y="-6915.34" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="37395.61" y="-6900.34" font-family="Times,serif" font-size="14.00">Node 376 GPU 2</text>
<text text-anchor="middle" x="37395.61" y="-6885.34" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m50_route&#45;&gt;m50_expert2 -->
<g id="edge779" class="edge">
<title>m50_route&#45;&gt;m50_expert2</title>
<path fill="none" stroke="black" d="M37161.74,-6988.58C37199.78,-6974.99 37247.39,-6957.99 37289.7,-6942.87"/>
<polygon fill="black" stroke="black" points="37290.97,-6946.14 37299.21,-6939.48 37288.61,-6939.55 37290.97,-6946.14"/>
</g>
<!-- m50_agg -->
<g id="node606" class="node">
<title>m50_agg</title>
<polygon fill="purple" stroke="black" points="37254.23,-6830.56 36993.95,-6830.56 36927,-6754.56 37187.27,-6754.56 37254.23,-6830.56"/>
<text text-anchor="middle" x="37090.61" y="-6796.36" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="37090.61" y="-6781.36" font-family="Times,serif" font-size="14.00">GPU: 3762</text>
</g>
<!-- m50_expert0&#45;&gt;m50_agg -->
<g id="edge776" class="edge">
<title>m50_expert0&#45;&gt;m50_agg</title>
<path fill="none" stroke="black" d="M36385.14,-6877.79C36563.91,-6856.44 36814.08,-6826.58 36963.48,-6808.74"/>
<polygon fill="black" stroke="black" points="36964.1,-6812.19 36973.62,-6807.53 36963.27,-6805.24 36964.1,-6812.19"/>
</g>
<!-- m50_expert1&#45;&gt;m50_agg -->
<g id="edge778" class="edge">
<title>m50_expert1&#45;&gt;m50_agg</title>
<path fill="none" stroke="black" d="M36881.01,-6868.55C36913.3,-6857 36949.5,-6844.05 36982.62,-6832.2"/>
<polygon fill="black" stroke="black" points="36984.09,-6835.39 36992.33,-6828.73 36981.73,-6828.8 36984.09,-6835.39"/>
</g>
<!-- m50_expert2&#45;&gt;m50_agg -->
<g id="edge780" class="edge">
<title>m50_expert2&#45;&gt;m50_agg</title>
<path fill="none" stroke="black" d="M37299.53,-6868.55C37269.07,-6857.62 37235.11,-6845.43 37203.57,-6834.11"/>
<polygon fill="black" stroke="black" points="37204.47,-6830.71 37193.87,-6830.63 37202.1,-6837.3 37204.47,-6830.71"/>
</g>
<!-- m50_agg&#45;&gt;m50_final -->
<g id="edge781" class="edge">
<title>m50_agg&#45;&gt;m50_final</title>
<path fill="none" stroke="black" d="M37203.13,-6772.15C37309.17,-6753.85 37466.36,-6726.73 37566.9,-6709.38"/>
<polygon fill="black" stroke="black" points="37567.79,-6712.78 37577.05,-6707.63 37566.6,-6705.88 37567.79,-6712.78"/>
</g>
<!-- m51_res1 -->
<g id="node612" class="node">
<title>m51_res1</title>
<ellipse fill="lightpink" stroke="black" cx="37776.61" cy="-6601.95" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="37776.61" y="-6605.75" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="37776.61" y="-6590.75" font-family="Times,serif" font-size="14.00">GPU: 3763</text>
</g>
<!-- m50_final&#45;&gt;m51_res1 -->
<g id="edge787" class="edge">
<title>m50_final&#45;&gt;m51_res1</title>
<path fill="none" stroke="black" d="M37695.39,-6666.02C37708.6,-6655.76 37724.05,-6643.77 37737.9,-6633.01"/>
<polygon fill="black" stroke="black" points="37740.1,-6635.73 37745.85,-6626.84 37735.81,-6630.2 37740.1,-6635.73"/>
</g>
<!-- m51_ln1 -->
<g id="node608" class="node">
<title>m51_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="37890.61" cy="-7014.99" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="37890.61" y="-7018.79" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="37890.61" y="-7003.79" font-family="Times,serif" font-size="14.00">GPU: 3763</text>
</g>
<!-- m51_qkv -->
<g id="node609" class="node">
<title>m51_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="37890.61" cy="-6904.04" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="37890.61" y="-6907.84" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="37890.61" y="-6892.84" font-family="Times,serif" font-size="14.00">GPU: 3763</text>
</g>
<!-- m51_ln1&#45;&gt;m51_qkv -->
<g id="edge783" class="edge">
<title>m51_ln1&#45;&gt;m51_qkv</title>
<path fill="none" stroke="black" d="M37890.61,-6987.9C37890.61,-6973.88 37890.61,-6956.39 37890.61,-6941.09"/>
<polygon fill="black" stroke="black" points="37894.11,-6940.92 37890.61,-6930.92 37887.11,-6940.92 37894.11,-6940.92"/>
</g>
<!-- m51_mha -->
<g id="node610" class="node">
<title>m51_mha</title>
<ellipse fill="lightblue" stroke="black" cx="37890.61" cy="-6792.56" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="37890.61" y="-6796.36" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="37890.61" y="-6781.36" font-family="Times,serif" font-size="14.00">GPU: 3763</text>
</g>
<!-- m51_qkv&#45;&gt;m51_mha -->
<g id="edge784" class="edge">
<title>m51_qkv&#45;&gt;m51_mha</title>
<path fill="none" stroke="black" d="M37890.61,-6877.09C37890.61,-6863.02 37890.61,-6845.39 37890.61,-6829.96"/>
<polygon fill="black" stroke="black" points="37894.11,-6829.7 37890.61,-6819.7 37887.11,-6829.7 37894.11,-6829.7"/>
</g>
<!-- m51_out -->
<g id="node611" class="node">
<title>m51_out</title>
<ellipse fill="lightblue" stroke="black" cx="37890.61" cy="-6691.69" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="37890.61" y="-6695.49" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="37890.61" y="-6680.49" font-family="Times,serif" font-size="14.00">GPU: 3763</text>
</g>
<!-- m51_mha&#45;&gt;m51_out -->
<g id="edge785" class="edge">
<title>m51_mha&#45;&gt;m51_out</title>
<path fill="none" stroke="black" d="M37890.61,-6765.59C37890.61,-6754.43 37890.61,-6741.21 37890.61,-6729.11"/>
<polygon fill="black" stroke="black" points="37894.11,-6728.84 37890.61,-6718.84 37887.11,-6728.84 37894.11,-6728.84"/>
</g>
<!-- m51_out&#45;&gt;m51_res1 -->
<g id="edge786" class="edge">
<title>m51_out&#45;&gt;m51_res1</title>
<path fill="none" stroke="black" d="M37858.55,-6666.02C37845.23,-6655.76 37829.64,-6643.77 37815.66,-6633.01"/>
<polygon fill="black" stroke="black" points="37817.7,-6630.16 37807.64,-6626.84 37813.43,-6635.71 37817.7,-6630.16"/>
</g>
<!-- m51_gate -->
<g id="node613" class="node">
<title>m51_gate</title>
<polygon fill="orange" stroke="black" points="37748.23,-6539.08 37543.63,-6539.08 37491,-6433.08 37695.59,-6433.08 37748.23,-6539.08"/>
<text text-anchor="middle" x="37619.61" y="-6497.38" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="37619.61" y="-6482.38" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="37619.61" y="-6467.38" font-family="Times,serif" font-size="14.00">GPU: 3763</text>
</g>
<!-- m51_res1&#45;&gt;m51_gate -->
<g id="edge788" class="edge">
<title>m51_res1&#45;&gt;m51_gate</title>
<path fill="none" stroke="black" d="M37744.08,-6577.36C37731.08,-6567.93 37715.48,-6556.61 37699.79,-6545.23"/>
<polygon fill="black" stroke="black" points="37701.74,-6542.32 37691.59,-6539.29 37697.63,-6547.99 37701.74,-6542.32"/>
</g>
<!-- m51_route -->
<g id="node614" class="node">
<title>m51_route</title>
<ellipse fill="lightgray" stroke="black" cx="37619.61" cy="-6359.61" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="37619.61" y="-6370.91" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="37619.61" y="-6355.91" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="37619.61" y="-6340.91" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m51_res1&#45;&gt;m51_route -->
<g id="edge790" class="edge">
<title>m51_res1&#45;&gt;m51_route</title>
<path fill="none" stroke="black" d="M37780.67,-6575.1C37784.79,-6539.78 37786.92,-6475.93 37757.61,-6433.08 37744.5,-6413.92 37724.68,-6399.46 37704.11,-6388.7"/>
<polygon fill="black" stroke="black" points="37705.47,-6385.47 37694.95,-6384.17 37702.36,-6391.74 37705.47,-6385.47"/>
</g>
<!-- m51_final -->
<g id="node619" class="node">
<title>m51_final</title>
<ellipse fill="lightpink" stroke="black" cx="38192.61" cy="-6036.31" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="38192.61" y="-6040.11" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="38192.61" y="-6025.11" font-family="Times,serif" font-size="14.00">GPU: 3763</text>
</g>
<!-- m51_res1&#45;&gt;m51_final -->
<g id="edge798" class="edge">
<title>m51_res1&#45;&gt;m51_final</title>
<path fill="none" stroke="black" d="M37852.71,-6596.28C37986.21,-6583.52 38248.61,-6536.13 38248.61,-6360.61 38248.61,-6360.61 38248.61,-6360.61 38248.61,-6247.65 38248.61,-6184.33 38224.62,-6113.78 38208.04,-6072.6"/>
<polygon fill="black" stroke="black" points="38211.25,-6071.2 38204.22,-6063.28 38204.78,-6073.86 38211.25,-6071.2"/>
</g>
<!-- m51_gate&#45;&gt;m51_route -->
<g id="edge789" class="edge">
<title>m51_gate&#45;&gt;m51_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37619.61,-6433.01C37619.61,-6424.58 37619.61,-6415.89 37619.61,-6407.59"/>
<polygon fill="black" stroke="black" points="37623.11,-6407.33 37619.61,-6397.33 37616.11,-6407.33 37623.11,-6407.33"/>
</g>
<!-- m51_expert0 -->
<g id="node615" class="node">
<title>m51_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="36702.61" cy="-6248.65" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="36702.61" y="-6259.95" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="36702.61" y="-6244.95" font-family="Times,serif" font-size="14.00">Node 384 GPU 0</text>
<text text-anchor="middle" x="36702.61" y="-6229.95" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m51_route&#45;&gt;m51_expert0 -->
<g id="edge791" class="edge">
<title>m51_route&#45;&gt;m51_expert0</title>
<path fill="none" stroke="black" d="M37525.15,-6347.42C37405.09,-6333.19 37191.46,-6307.87 37008.61,-6286.13 36981.41,-6282.89 36952.84,-6279.49 36924.54,-6276.12"/>
<polygon fill="black" stroke="black" points="36924.89,-6272.64 36914.55,-6274.93 36924.06,-6279.59 36924.89,-6272.64"/>
</g>
<!-- m51_expert1 -->
<g id="node616" class="node">
<title>m51_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="37313.61" cy="-6248.65" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="37313.61" y="-6259.95" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="37313.61" y="-6244.95" font-family="Times,serif" font-size="14.00">Node 384 GPU 1</text>
<text text-anchor="middle" x="37313.61" y="-6229.95" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m51_route&#45;&gt;m51_expert1 -->
<g id="edge793" class="edge">
<title>m51_route&#45;&gt;m51_expert1</title>
<path fill="none" stroke="black" d="M37548.26,-6333.2C37510.08,-6319.61 37462.32,-6302.6 37419.87,-6287.49"/>
<polygon fill="black" stroke="black" points="37420.93,-6284.15 37410.33,-6284.09 37418.58,-6290.74 37420.93,-6284.15"/>
</g>
<!-- m51_expert2 -->
<g id="node617" class="node">
<title>m51_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="37924.61" cy="-6248.65" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="37924.61" y="-6259.95" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="37924.61" y="-6244.95" font-family="Times,serif" font-size="14.00">Node 384 GPU 2</text>
<text text-anchor="middle" x="37924.61" y="-6229.95" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m51_route&#45;&gt;m51_expert2 -->
<g id="edge795" class="edge">
<title>m51_route&#45;&gt;m51_expert2</title>
<path fill="none" stroke="black" d="M37690.74,-6333.2C37728.78,-6319.61 37776.39,-6302.6 37818.7,-6287.49"/>
<polygon fill="black" stroke="black" points="37819.97,-6290.75 37828.21,-6284.09 37817.61,-6284.16 37819.97,-6290.75"/>
</g>
<!-- m51_agg -->
<g id="node618" class="node">
<title>m51_agg</title>
<polygon fill="purple" stroke="black" points="37783.23,-6175.18 37522.95,-6175.18 37456,-6099.18 37716.27,-6099.18 37783.23,-6175.18"/>
<text text-anchor="middle" x="37619.61" y="-6140.98" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="37619.61" y="-6125.98" font-family="Times,serif" font-size="14.00">GPU: 3763</text>
</g>
<!-- m51_expert0&#45;&gt;m51_agg -->
<g id="edge792" class="edge">
<title>m51_expert0&#45;&gt;m51_agg</title>
<path fill="none" stroke="black" d="M36914.14,-6222.4C37092.91,-6201.06 37343.08,-6171.19 37492.48,-6153.35"/>
<polygon fill="black" stroke="black" points="37493.1,-6156.8 37502.62,-6152.14 37492.27,-6149.85 37493.1,-6156.8"/>
</g>
<!-- m51_expert1&#45;&gt;m51_agg -->
<g id="edge794" class="edge">
<title>m51_expert1&#45;&gt;m51_agg</title>
<path fill="none" stroke="black" d="M37410.01,-6213.16C37442.3,-6201.61 37478.5,-6188.66 37511.62,-6176.81"/>
<polygon fill="black" stroke="black" points="37513.09,-6180 37521.33,-6173.34 37510.73,-6173.41 37513.09,-6180"/>
</g>
<!-- m51_expert2&#45;&gt;m51_agg -->
<g id="edge796" class="edge">
<title>m51_expert2&#45;&gt;m51_agg</title>
<path fill="none" stroke="black" d="M37828.53,-6213.16C37798.07,-6202.23 37764.11,-6190.04 37732.57,-6178.72"/>
<polygon fill="black" stroke="black" points="37733.47,-6175.32 37722.87,-6175.24 37731.1,-6181.91 37733.47,-6175.32"/>
</g>
<!-- m51_agg&#45;&gt;m51_final -->
<g id="edge797" class="edge">
<title>m51_agg&#45;&gt;m51_final</title>
<path fill="none" stroke="black" d="M37732.13,-6116.76C37838.17,-6098.46 37995.36,-6071.34 38095.9,-6053.99"/>
<polygon fill="black" stroke="black" points="38096.79,-6057.39 38106.05,-6052.24 38095.6,-6050.49 38096.79,-6057.39"/>
</g>
<!-- m52_res1 -->
<g id="node624" class="node">
<title>m52_res1</title>
<ellipse fill="lightpink" stroke="black" cx="38305.61" cy="-5946.57" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="38305.61" y="-5950.37" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="38305.61" y="-5935.37" font-family="Times,serif" font-size="14.00">GPU: 3764</text>
</g>
<!-- m51_final&#45;&gt;m52_res1 -->
<g id="edge803" class="edge">
<title>m51_final&#45;&gt;m52_res1</title>
<path fill="none" stroke="black" d="M38224.39,-6010.63C38237.6,-6000.38 38253.05,-5988.38 38266.9,-5977.62"/>
<polygon fill="black" stroke="black" points="38269.1,-5980.35 38274.85,-5971.45 38264.81,-5974.82 38269.1,-5980.35"/>
</g>
<!-- m52_ln1 -->
<g id="node620" class="node">
<title>m52_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="38419.61" cy="-6359.61" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="38419.61" y="-6363.41" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="38419.61" y="-6348.41" font-family="Times,serif" font-size="14.00">GPU: 3764</text>
</g>
<!-- m52_qkv -->
<g id="node621" class="node">
<title>m52_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="38419.61" cy="-6248.65" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="38419.61" y="-6252.45" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="38419.61" y="-6237.45" font-family="Times,serif" font-size="14.00">GPU: 3764</text>
</g>
<!-- m52_ln1&#45;&gt;m52_qkv -->
<g id="edge799" class="edge">
<title>m52_ln1&#45;&gt;m52_qkv</title>
<path fill="none" stroke="black" d="M38419.61,-6332.51C38419.61,-6318.49 38419.61,-6301 38419.61,-6285.7"/>
<polygon fill="black" stroke="black" points="38423.11,-6285.54 38419.61,-6275.54 38416.11,-6285.54 38423.11,-6285.54"/>
</g>
<!-- m52_mha -->
<g id="node622" class="node">
<title>m52_mha</title>
<ellipse fill="lightblue" stroke="black" cx="38419.61" cy="-6137.18" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="38419.61" y="-6140.98" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="38419.61" y="-6125.98" font-family="Times,serif" font-size="14.00">GPU: 3764</text>
</g>
<!-- m52_qkv&#45;&gt;m52_mha -->
<g id="edge800" class="edge">
<title>m52_qkv&#45;&gt;m52_mha</title>
<path fill="none" stroke="black" d="M38419.61,-6221.71C38419.61,-6207.63 38419.61,-6190 38419.61,-6174.57"/>
<polygon fill="black" stroke="black" points="38423.11,-6174.31 38419.61,-6164.31 38416.11,-6174.31 38423.11,-6174.31"/>
</g>
<!-- m52_out -->
<g id="node623" class="node">
<title>m52_out</title>
<ellipse fill="lightblue" stroke="black" cx="38419.61" cy="-6036.31" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="38419.61" y="-6040.11" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="38419.61" y="-6025.11" font-family="Times,serif" font-size="14.00">GPU: 3764</text>
</g>
<!-- m52_mha&#45;&gt;m52_out -->
<g id="edge801" class="edge">
<title>m52_mha&#45;&gt;m52_out</title>
<path fill="none" stroke="black" d="M38419.61,-6110.2C38419.61,-6099.05 38419.61,-6085.82 38419.61,-6073.72"/>
<polygon fill="black" stroke="black" points="38423.11,-6073.45 38419.61,-6063.45 38416.11,-6073.45 38423.11,-6073.45"/>
</g>
<!-- m52_out&#45;&gt;m52_res1 -->
<g id="edge802" class="edge">
<title>m52_out&#45;&gt;m52_res1</title>
<path fill="none" stroke="black" d="M38387.55,-6010.63C38374.23,-6000.38 38358.64,-5988.38 38344.66,-5977.62"/>
<polygon fill="black" stroke="black" points="38346.7,-5974.77 38336.64,-5971.45 38342.43,-5980.32 38346.7,-5974.77"/>
</g>
<!-- m52_gate -->
<g id="node625" class="node">
<title>m52_gate</title>
<polygon fill="orange" stroke="black" points="38277.23,-5883.7 38072.63,-5883.7 38020,-5777.7 38224.59,-5777.7 38277.23,-5883.7"/>
<text text-anchor="middle" x="38148.61" y="-5842" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="38148.61" y="-5827" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="38148.61" y="-5812" font-family="Times,serif" font-size="14.00">GPU: 3764</text>
</g>
<!-- m52_res1&#45;&gt;m52_gate -->
<g id="edge804" class="edge">
<title>m52_res1&#45;&gt;m52_gate</title>
<path fill="none" stroke="black" d="M38273.08,-5921.97C38260.08,-5912.54 38244.48,-5901.23 38228.79,-5889.85"/>
<polygon fill="black" stroke="black" points="38230.74,-5886.94 38220.59,-5883.9 38226.63,-5892.6 38230.74,-5886.94"/>
</g>
<!-- m52_route -->
<g id="node626" class="node">
<title>m52_route</title>
<ellipse fill="lightgray" stroke="black" cx="38148.61" cy="-5704.22" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="38148.61" y="-5715.52" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="38148.61" y="-5700.52" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="38148.61" y="-5685.52" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m52_res1&#45;&gt;m52_route -->
<g id="edge806" class="edge">
<title>m52_res1&#45;&gt;m52_route</title>
<path fill="none" stroke="black" d="M38309.67,-5919.71C38313.79,-5884.39 38315.92,-5820.54 38286.61,-5777.7 38273.5,-5758.53 38253.68,-5744.07 38233.11,-5733.31"/>
<polygon fill="black" stroke="black" points="38234.47,-5730.08 38223.95,-5728.78 38231.36,-5736.35 38234.47,-5730.08"/>
</g>
<!-- m52_final -->
<g id="node631" class="node">
<title>m52_final</title>
<ellipse fill="lightpink" stroke="black" cx="38721.61" cy="-5380.92" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="38721.61" y="-5384.72" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="38721.61" y="-5369.72" font-family="Times,serif" font-size="14.00">GPU: 3764</text>
</g>
<!-- m52_res1&#45;&gt;m52_final -->
<g id="edge814" class="edge">
<title>m52_res1&#45;&gt;m52_final</title>
<path fill="none" stroke="black" d="M38381.71,-5940.89C38515.21,-5928.14 38777.61,-5880.74 38777.61,-5705.22 38777.61,-5705.22 38777.61,-5705.22 38777.61,-5592.27 38777.61,-5528.94 38753.62,-5458.39 38737.04,-5417.21"/>
<polygon fill="black" stroke="black" points="38740.25,-5415.81 38733.22,-5407.89 38733.78,-5418.47 38740.25,-5415.81"/>
</g>
<!-- m52_gate&#45;&gt;m52_route -->
<g id="edge805" class="edge">
<title>m52_gate&#45;&gt;m52_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38148.61,-5777.63C38148.61,-5769.2 38148.61,-5760.51 38148.61,-5752.21"/>
<polygon fill="black" stroke="black" points="38152.11,-5751.94 38148.61,-5741.94 38145.11,-5751.94 38152.11,-5751.94"/>
</g>
<!-- m52_expert0 -->
<g id="node627" class="node">
<title>m52_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="37231.61" cy="-5593.27" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="37231.61" y="-5604.57" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="37231.61" y="-5589.57" font-family="Times,serif" font-size="14.00">Node 392 GPU 0</text>
<text text-anchor="middle" x="37231.61" y="-5574.57" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m52_route&#45;&gt;m52_expert0 -->
<g id="edge807" class="edge">
<title>m52_route&#45;&gt;m52_expert0</title>
<path fill="none" stroke="black" d="M38054.15,-5692.03C37934.09,-5677.81 37720.46,-5652.48 37537.61,-5630.74 37510.41,-5627.51 37481.84,-5624.11 37453.54,-5620.74"/>
<polygon fill="black" stroke="black" points="37453.89,-5617.25 37443.55,-5619.54 37453.06,-5624.2 37453.89,-5617.25"/>
</g>
<!-- m52_expert1 -->
<g id="node628" class="node">
<title>m52_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="37842.61" cy="-5593.27" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="37842.61" y="-5604.57" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="37842.61" y="-5589.57" font-family="Times,serif" font-size="14.00">Node 392 GPU 1</text>
<text text-anchor="middle" x="37842.61" y="-5574.57" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m52_route&#45;&gt;m52_expert1 -->
<g id="edge809" class="edge">
<title>m52_route&#45;&gt;m52_expert1</title>
<path fill="none" stroke="black" d="M38077.26,-5677.81C38039.08,-5664.22 37991.32,-5647.21 37948.87,-5632.1"/>
<polygon fill="black" stroke="black" points="37949.93,-5628.76 37939.33,-5628.7 37947.58,-5635.36 37949.93,-5628.76"/>
</g>
<!-- m52_expert2 -->
<g id="node629" class="node">
<title>m52_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="38453.61" cy="-5593.27" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="38453.61" y="-5604.57" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="38453.61" y="-5589.57" font-family="Times,serif" font-size="14.00">Node 392 GPU 2</text>
<text text-anchor="middle" x="38453.61" y="-5574.57" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m52_route&#45;&gt;m52_expert2 -->
<g id="edge811" class="edge">
<title>m52_route&#45;&gt;m52_expert2</title>
<path fill="none" stroke="black" d="M38219.74,-5677.81C38257.78,-5664.22 38305.39,-5647.21 38347.7,-5632.1"/>
<polygon fill="black" stroke="black" points="38348.97,-5635.36 38357.21,-5628.7 38346.61,-5628.77 38348.97,-5635.36"/>
</g>
<!-- m52_agg -->
<g id="node630" class="node">
<title>m52_agg</title>
<polygon fill="purple" stroke="black" points="38312.23,-5519.79 38051.95,-5519.79 37985,-5443.79 38245.27,-5443.79 38312.23,-5519.79"/>
<text text-anchor="middle" x="38148.61" y="-5485.59" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="38148.61" y="-5470.59" font-family="Times,serif" font-size="14.00">GPU: 3764</text>
</g>
<!-- m52_expert0&#45;&gt;m52_agg -->
<g id="edge808" class="edge">
<title>m52_expert0&#45;&gt;m52_agg</title>
<path fill="none" stroke="black" d="M37443.14,-5567.01C37621.91,-5545.67 37872.08,-5515.8 38021.48,-5497.97"/>
<polygon fill="black" stroke="black" points="38022.1,-5501.42 38031.62,-5496.76 38021.27,-5494.47 38022.1,-5501.42"/>
</g>
<!-- m52_expert1&#45;&gt;m52_agg -->
<g id="edge810" class="edge">
<title>m52_expert1&#45;&gt;m52_agg</title>
<path fill="none" stroke="black" d="M37939.01,-5557.78C37971.3,-5546.22 38007.5,-5533.27 38040.62,-5521.43"/>
<polygon fill="black" stroke="black" points="38042.09,-5524.62 38050.33,-5517.95 38039.73,-5518.02 38042.09,-5524.62"/>
</g>
<!-- m52_expert2&#45;&gt;m52_agg -->
<g id="edge812" class="edge">
<title>m52_expert2&#45;&gt;m52_agg</title>
<path fill="none" stroke="black" d="M38357.53,-5557.78C38327.07,-5546.84 38293.11,-5534.65 38261.57,-5523.33"/>
<polygon fill="black" stroke="black" points="38262.47,-5519.94 38251.87,-5519.85 38260.1,-5526.52 38262.47,-5519.94"/>
</g>
<!-- m52_agg&#45;&gt;m52_final -->
<g id="edge813" class="edge">
<title>m52_agg&#45;&gt;m52_final</title>
<path fill="none" stroke="black" d="M38261.13,-5461.37C38367.17,-5443.08 38524.36,-5415.95 38624.9,-5398.61"/>
<polygon fill="black" stroke="black" points="38625.79,-5402 38635.05,-5396.85 38624.6,-5395.11 38625.79,-5402"/>
</g>
<!-- m53_res1 -->
<g id="node636" class="node">
<title>m53_res1</title>
<ellipse fill="lightpink" stroke="black" cx="38834.61" cy="-5291.18" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="38834.61" y="-5294.98" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="38834.61" y="-5279.98" font-family="Times,serif" font-size="14.00">GPU: 3765</text>
</g>
<!-- m52_final&#45;&gt;m53_res1 -->
<g id="edge819" class="edge">
<title>m52_final&#45;&gt;m53_res1</title>
<path fill="none" stroke="black" d="M38753.39,-5355.24C38766.6,-5344.99 38782.05,-5332.99 38795.9,-5322.23"/>
<polygon fill="black" stroke="black" points="38798.1,-5324.96 38803.85,-5316.06 38793.81,-5319.43 38798.1,-5324.96"/>
</g>
<!-- m53_ln1 -->
<g id="node632" class="node">
<title>m53_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="38948.61" cy="-5704.22" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="38948.61" y="-5708.02" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="38948.61" y="-5693.02" font-family="Times,serif" font-size="14.00">GPU: 3765</text>
</g>
<!-- m53_qkv -->
<g id="node633" class="node">
<title>m53_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="38948.61" cy="-5593.27" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="38948.61" y="-5597.07" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="38948.61" y="-5582.07" font-family="Times,serif" font-size="14.00">GPU: 3765</text>
</g>
<!-- m53_ln1&#45;&gt;m53_qkv -->
<g id="edge815" class="edge">
<title>m53_ln1&#45;&gt;m53_qkv</title>
<path fill="none" stroke="black" d="M38948.61,-5677.12C38948.61,-5663.11 38948.61,-5645.61 38948.61,-5630.32"/>
<polygon fill="black" stroke="black" points="38952.11,-5630.15 38948.61,-5620.15 38945.11,-5630.15 38952.11,-5630.15"/>
</g>
<!-- m53_mha -->
<g id="node634" class="node">
<title>m53_mha</title>
<ellipse fill="lightblue" stroke="black" cx="38948.61" cy="-5481.79" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="38948.61" y="-5485.59" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="38948.61" y="-5470.59" font-family="Times,serif" font-size="14.00">GPU: 3765</text>
</g>
<!-- m53_qkv&#45;&gt;m53_mha -->
<g id="edge816" class="edge">
<title>m53_qkv&#45;&gt;m53_mha</title>
<path fill="none" stroke="black" d="M38948.61,-5566.32C38948.61,-5552.24 38948.61,-5534.62 38948.61,-5519.19"/>
<polygon fill="black" stroke="black" points="38952.11,-5518.93 38948.61,-5508.93 38945.11,-5518.93 38952.11,-5518.93"/>
</g>
<!-- m53_out -->
<g id="node635" class="node">
<title>m53_out</title>
<ellipse fill="lightblue" stroke="black" cx="38948.61" cy="-5380.92" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="38948.61" y="-5384.72" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="38948.61" y="-5369.72" font-family="Times,serif" font-size="14.00">GPU: 3765</text>
</g>
<!-- m53_mha&#45;&gt;m53_out -->
<g id="edge817" class="edge">
<title>m53_mha&#45;&gt;m53_out</title>
<path fill="none" stroke="black" d="M38948.61,-5454.81C38948.61,-5443.66 38948.61,-5430.44 38948.61,-5418.33"/>
<polygon fill="black" stroke="black" points="38952.11,-5418.07 38948.61,-5408.07 38945.11,-5418.07 38952.11,-5418.07"/>
</g>
<!-- m53_out&#45;&gt;m53_res1 -->
<g id="edge818" class="edge">
<title>m53_out&#45;&gt;m53_res1</title>
<path fill="none" stroke="black" d="M38916.55,-5355.24C38903.23,-5344.99 38887.64,-5332.99 38873.66,-5322.23"/>
<polygon fill="black" stroke="black" points="38875.7,-5319.39 38865.64,-5316.06 38871.43,-5324.93 38875.7,-5319.39"/>
</g>
<!-- m53_gate -->
<g id="node637" class="node">
<title>m53_gate</title>
<polygon fill="orange" stroke="black" points="38806.23,-5228.31 38601.63,-5228.31 38549,-5122.31 38753.59,-5122.31 38806.23,-5228.31"/>
<text text-anchor="middle" x="38677.61" y="-5186.61" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="38677.61" y="-5171.61" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="38677.61" y="-5156.61" font-family="Times,serif" font-size="14.00">GPU: 3765</text>
</g>
<!-- m53_res1&#45;&gt;m53_gate -->
<g id="edge820" class="edge">
<title>m53_res1&#45;&gt;m53_gate</title>
<path fill="none" stroke="black" d="M38802.08,-5266.58C38789.08,-5257.15 38773.48,-5245.84 38757.79,-5234.46"/>
<polygon fill="black" stroke="black" points="38759.74,-5231.55 38749.59,-5228.51 38755.63,-5237.22 38759.74,-5231.55"/>
</g>
<!-- m53_route -->
<g id="node638" class="node">
<title>m53_route</title>
<ellipse fill="lightgray" stroke="black" cx="38677.61" cy="-5048.83" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="38677.61" y="-5060.13" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="38677.61" y="-5045.13" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="38677.61" y="-5030.13" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m53_res1&#45;&gt;m53_route -->
<g id="edge822" class="edge">
<title>m53_res1&#45;&gt;m53_route</title>
<path fill="none" stroke="black" d="M38838.67,-5264.33C38842.79,-5229 38844.92,-5165.16 38815.61,-5122.31 38802.5,-5103.14 38782.68,-5088.68 38762.11,-5077.93"/>
<polygon fill="black" stroke="black" points="38763.47,-5074.69 38752.95,-5073.39 38760.36,-5080.97 38763.47,-5074.69"/>
</g>
<!-- m53_final -->
<g id="node643" class="node">
<title>m53_final</title>
<ellipse fill="lightpink" stroke="black" cx="39250.61" cy="-4725.53" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="39250.61" y="-4729.33" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="39250.61" y="-4714.33" font-family="Times,serif" font-size="14.00">GPU: 3765</text>
</g>
<!-- m53_res1&#45;&gt;m53_final -->
<g id="edge830" class="edge">
<title>m53_res1&#45;&gt;m53_final</title>
<path fill="none" stroke="black" d="M38910.71,-5285.51C39044.21,-5272.75 39306.61,-5225.35 39306.61,-5049.83 39306.61,-5049.83 39306.61,-5049.83 39306.61,-4936.88 39306.61,-4873.55 39282.62,-4803.01 39266.04,-4761.82"/>
<polygon fill="black" stroke="black" points="39269.25,-4760.42 39262.22,-4752.5 39262.78,-4763.08 39269.25,-4760.42"/>
</g>
<!-- m53_gate&#45;&gt;m53_route -->
<g id="edge821" class="edge">
<title>m53_gate&#45;&gt;m53_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M38677.61,-5122.24C38677.61,-5113.81 38677.61,-5105.12 38677.61,-5096.82"/>
<polygon fill="black" stroke="black" points="38681.11,-5096.56 38677.61,-5086.56 38674.11,-5096.56 38681.11,-5096.56"/>
</g>
<!-- m53_expert0 -->
<g id="node639" class="node">
<title>m53_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="37760.61" cy="-4937.88" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="37760.61" y="-4949.18" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="37760.61" y="-4934.18" font-family="Times,serif" font-size="14.00">Node 400 GPU 0</text>
<text text-anchor="middle" x="37760.61" y="-4919.18" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m53_route&#45;&gt;m53_expert0 -->
<g id="edge823" class="edge">
<title>m53_route&#45;&gt;m53_expert0</title>
<path fill="none" stroke="black" d="M38583.15,-5036.64C38463.09,-5022.42 38249.46,-4997.1 38066.61,-4975.35 38039.41,-4972.12 38010.84,-4968.72 37982.54,-4965.35"/>
<polygon fill="black" stroke="black" points="37982.89,-4961.87 37972.55,-4964.16 37982.06,-4968.82 37982.89,-4961.87"/>
</g>
<!-- m53_expert1 -->
<g id="node640" class="node">
<title>m53_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="38371.61" cy="-4937.88" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="38371.61" y="-4949.18" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="38371.61" y="-4934.18" font-family="Times,serif" font-size="14.00">Node 400 GPU 1</text>
<text text-anchor="middle" x="38371.61" y="-4919.18" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m53_route&#45;&gt;m53_expert1 -->
<g id="edge825" class="edge">
<title>m53_route&#45;&gt;m53_expert1</title>
<path fill="none" stroke="black" d="M38606.26,-5022.42C38568.08,-5008.83 38520.32,-4991.83 38477.87,-4976.71"/>
<polygon fill="black" stroke="black" points="38478.93,-4973.37 38468.33,-4973.32 38476.58,-4979.97 38478.93,-4973.37"/>
</g>
<!-- m53_expert2 -->
<g id="node641" class="node">
<title>m53_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="38982.61" cy="-4937.88" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="38982.61" y="-4949.18" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="38982.61" y="-4934.18" font-family="Times,serif" font-size="14.00">Node 400 GPU 2</text>
<text text-anchor="middle" x="38982.61" y="-4919.18" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m53_route&#45;&gt;m53_expert2 -->
<g id="edge827" class="edge">
<title>m53_route&#45;&gt;m53_expert2</title>
<path fill="none" stroke="black" d="M38748.74,-5022.42C38786.78,-5008.83 38834.39,-4991.83 38876.7,-4976.71"/>
<polygon fill="black" stroke="black" points="38877.97,-4979.98 38886.21,-4973.32 38875.61,-4973.38 38877.97,-4979.98"/>
</g>
<!-- m53_agg -->
<g id="node642" class="node">
<title>m53_agg</title>
<polygon fill="purple" stroke="black" points="38841.23,-4864.4 38580.95,-4864.4 38514,-4788.4 38774.27,-4788.4 38841.23,-4864.4"/>
<text text-anchor="middle" x="38677.61" y="-4830.2" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="38677.61" y="-4815.2" font-family="Times,serif" font-size="14.00">GPU: 3765</text>
</g>
<!-- m53_expert0&#45;&gt;m53_agg -->
<g id="edge824" class="edge">
<title>m53_expert0&#45;&gt;m53_agg</title>
<path fill="none" stroke="black" d="M37972.14,-4911.62C38150.91,-4890.28 38401.08,-4860.42 38550.48,-4842.58"/>
<polygon fill="black" stroke="black" points="38551.1,-4846.03 38560.62,-4841.37 38550.27,-4839.08 38551.1,-4846.03"/>
</g>
<!-- m53_expert1&#45;&gt;m53_agg -->
<g id="edge826" class="edge">
<title>m53_expert1&#45;&gt;m53_agg</title>
<path fill="none" stroke="black" d="M38468.01,-4902.39C38500.3,-4890.84 38536.5,-4877.89 38569.62,-4866.04"/>
<polygon fill="black" stroke="black" points="38571.09,-4869.23 38579.33,-4862.56 38568.73,-4862.64 38571.09,-4869.23"/>
</g>
<!-- m53_expert2&#45;&gt;m53_agg -->
<g id="edge828" class="edge">
<title>m53_expert2&#45;&gt;m53_agg</title>
<path fill="none" stroke="black" d="M38886.53,-4902.39C38856.07,-4891.46 38822.11,-4879.27 38790.57,-4867.95"/>
<polygon fill="black" stroke="black" points="38791.47,-4864.55 38780.87,-4864.47 38789.1,-4871.14 38791.47,-4864.55"/>
</g>
<!-- m53_agg&#45;&gt;m53_final -->
<g id="edge829" class="edge">
<title>m53_agg&#45;&gt;m53_final</title>
<path fill="none" stroke="black" d="M38790.13,-4805.99C38896.17,-4787.69 39053.36,-4760.57 39153.9,-4743.22"/>
<polygon fill="black" stroke="black" points="39154.79,-4746.62 39164.05,-4741.47 39153.6,-4739.72 39154.79,-4746.62"/>
</g>
<!-- m54_res1 -->
<g id="node648" class="node">
<title>m54_res1</title>
<ellipse fill="lightpink" stroke="black" cx="39363.61" cy="-4635.79" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="39363.61" y="-4639.59" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="39363.61" y="-4624.59" font-family="Times,serif" font-size="14.00">GPU: 3766</text>
</g>
<!-- m53_final&#45;&gt;m54_res1 -->
<g id="edge835" class="edge">
<title>m53_final&#45;&gt;m54_res1</title>
<path fill="none" stroke="black" d="M39282.39,-4699.86C39295.6,-4689.6 39311.05,-4677.61 39324.9,-4666.85"/>
<polygon fill="black" stroke="black" points="39327.1,-4669.57 39332.85,-4660.68 39322.81,-4664.04 39327.1,-4669.57"/>
</g>
<!-- m54_ln1 -->
<g id="node644" class="node">
<title>m54_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="39477.61" cy="-5048.83" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="39477.61" y="-5052.63" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="39477.61" y="-5037.63" font-family="Times,serif" font-size="14.00">GPU: 3766</text>
</g>
<!-- m54_qkv -->
<g id="node645" class="node">
<title>m54_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="39477.61" cy="-4937.88" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="39477.61" y="-4941.68" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="39477.61" y="-4926.68" font-family="Times,serif" font-size="14.00">GPU: 3766</text>
</g>
<!-- m54_ln1&#45;&gt;m54_qkv -->
<g id="edge831" class="edge">
<title>m54_ln1&#45;&gt;m54_qkv</title>
<path fill="none" stroke="black" d="M39477.61,-5021.73C39477.61,-5007.72 39477.61,-4990.23 39477.61,-4974.93"/>
<polygon fill="black" stroke="black" points="39481.11,-4974.76 39477.61,-4964.76 39474.11,-4974.76 39481.11,-4974.76"/>
</g>
<!-- m54_mha -->
<g id="node646" class="node">
<title>m54_mha</title>
<ellipse fill="lightblue" stroke="black" cx="39477.61" cy="-4826.4" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="39477.61" y="-4830.2" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="39477.61" y="-4815.2" font-family="Times,serif" font-size="14.00">GPU: 3766</text>
</g>
<!-- m54_qkv&#45;&gt;m54_mha -->
<g id="edge832" class="edge">
<title>m54_qkv&#45;&gt;m54_mha</title>
<path fill="none" stroke="black" d="M39477.61,-4910.93C39477.61,-4896.86 39477.61,-4879.23 39477.61,-4863.8"/>
<polygon fill="black" stroke="black" points="39481.11,-4863.54 39477.61,-4853.54 39474.11,-4863.54 39481.11,-4863.54"/>
</g>
<!-- m54_out -->
<g id="node647" class="node">
<title>m54_out</title>
<ellipse fill="lightblue" stroke="black" cx="39477.61" cy="-4725.53" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="39477.61" y="-4729.33" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="39477.61" y="-4714.33" font-family="Times,serif" font-size="14.00">GPU: 3766</text>
</g>
<!-- m54_mha&#45;&gt;m54_out -->
<g id="edge833" class="edge">
<title>m54_mha&#45;&gt;m54_out</title>
<path fill="none" stroke="black" d="M39477.61,-4799.42C39477.61,-4788.27 39477.61,-4775.05 39477.61,-4762.95"/>
<polygon fill="black" stroke="black" points="39481.11,-4762.68 39477.61,-4752.68 39474.11,-4762.68 39481.11,-4762.68"/>
</g>
<!-- m54_out&#45;&gt;m54_res1 -->
<g id="edge834" class="edge">
<title>m54_out&#45;&gt;m54_res1</title>
<path fill="none" stroke="black" d="M39445.55,-4699.86C39432.23,-4689.6 39416.64,-4677.61 39402.66,-4666.85"/>
<polygon fill="black" stroke="black" points="39404.7,-4664 39394.64,-4660.68 39400.43,-4669.55 39404.7,-4664"/>
</g>
<!-- m54_gate -->
<g id="node649" class="node">
<title>m54_gate</title>
<polygon fill="orange" stroke="black" points="39335.23,-4572.92 39130.63,-4572.92 39078,-4466.92 39282.59,-4466.92 39335.23,-4572.92"/>
<text text-anchor="middle" x="39206.61" y="-4531.22" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="39206.61" y="-4516.22" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="39206.61" y="-4501.22" font-family="Times,serif" font-size="14.00">GPU: 3766</text>
</g>
<!-- m54_res1&#45;&gt;m54_gate -->
<g id="edge836" class="edge">
<title>m54_res1&#45;&gt;m54_gate</title>
<path fill="none" stroke="black" d="M39331.08,-4611.2C39318.08,-4601.77 39302.48,-4590.45 39286.79,-4579.07"/>
<polygon fill="black" stroke="black" points="39288.74,-4576.16 39278.59,-4573.13 39284.63,-4581.83 39288.74,-4576.16"/>
</g>
<!-- m54_route -->
<g id="node650" class="node">
<title>m54_route</title>
<ellipse fill="lightgray" stroke="black" cx="39206.61" cy="-4393.44" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="39206.61" y="-4404.74" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="39206.61" y="-4389.74" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="39206.61" y="-4374.74" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m54_res1&#45;&gt;m54_route -->
<g id="edge838" class="edge">
<title>m54_res1&#45;&gt;m54_route</title>
<path fill="none" stroke="black" d="M39367.67,-4608.94C39371.79,-4573.62 39373.92,-4509.77 39344.61,-4466.92 39331.5,-4447.76 39311.68,-4433.3 39291.11,-4422.54"/>
<polygon fill="black" stroke="black" points="39292.47,-4419.31 39281.95,-4418.01 39289.36,-4425.58 39292.47,-4419.31"/>
</g>
<!-- m54_final -->
<g id="node655" class="node">
<title>m54_final</title>
<ellipse fill="lightpink" stroke="black" cx="39779.61" cy="-4070.14" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="39779.61" y="-4073.94" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="39779.61" y="-4058.94" font-family="Times,serif" font-size="14.00">GPU: 3766</text>
</g>
<!-- m54_res1&#45;&gt;m54_final -->
<g id="edge846" class="edge">
<title>m54_res1&#45;&gt;m54_final</title>
<path fill="none" stroke="black" d="M39439.71,-4630.12C39573.21,-4617.36 39835.61,-4569.97 39835.61,-4394.44 39835.61,-4394.44 39835.61,-4394.44 39835.61,-4281.49 39835.61,-4218.17 39811.62,-4147.62 39795.04,-4106.44"/>
<polygon fill="black" stroke="black" points="39798.25,-4105.04 39791.22,-4097.12 39791.78,-4107.7 39798.25,-4105.04"/>
</g>
<!-- m54_gate&#45;&gt;m54_route -->
<g id="edge837" class="edge">
<title>m54_gate&#45;&gt;m54_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39206.61,-4466.85C39206.61,-4458.42 39206.61,-4449.73 39206.61,-4441.43"/>
<polygon fill="black" stroke="black" points="39210.11,-4441.17 39206.61,-4431.17 39203.11,-4441.17 39210.11,-4441.17"/>
</g>
<!-- m54_expert0 -->
<g id="node651" class="node">
<title>m54_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="38289.61" cy="-4282.49" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="38289.61" y="-4293.79" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="38289.61" y="-4278.79" font-family="Times,serif" font-size="14.00">Node 408 GPU 0</text>
<text text-anchor="middle" x="38289.61" y="-4263.79" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m54_route&#45;&gt;m54_expert0 -->
<g id="edge839" class="edge">
<title>m54_route&#45;&gt;m54_expert0</title>
<path fill="none" stroke="black" d="M39112.15,-4381.26C38992.09,-4367.03 38778.46,-4341.71 38595.61,-4319.97 38568.41,-4316.73 38539.84,-4313.33 38511.54,-4309.96"/>
<polygon fill="black" stroke="black" points="38511.89,-4306.48 38501.55,-4308.77 38511.06,-4313.43 38511.89,-4306.48"/>
</g>
<!-- m54_expert1 -->
<g id="node652" class="node">
<title>m54_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="38900.61" cy="-4282.49" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="38900.61" y="-4293.79" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="38900.61" y="-4278.79" font-family="Times,serif" font-size="14.00">Node 408 GPU 1</text>
<text text-anchor="middle" x="38900.61" y="-4263.79" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m54_route&#45;&gt;m54_expert1 -->
<g id="edge841" class="edge">
<title>m54_route&#45;&gt;m54_expert1</title>
<path fill="none" stroke="black" d="M39135.26,-4367.04C39097.08,-4353.45 39049.32,-4336.44 39006.87,-4321.32"/>
<polygon fill="black" stroke="black" points="39007.93,-4317.99 38997.33,-4317.93 39005.58,-4324.58 39007.93,-4317.99"/>
</g>
<!-- m54_expert2 -->
<g id="node653" class="node">
<title>m54_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="39511.61" cy="-4282.49" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="39511.61" y="-4293.79" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="39511.61" y="-4278.79" font-family="Times,serif" font-size="14.00">Node 408 GPU 2</text>
<text text-anchor="middle" x="39511.61" y="-4263.79" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m54_route&#45;&gt;m54_expert2 -->
<g id="edge843" class="edge">
<title>m54_route&#45;&gt;m54_expert2</title>
<path fill="none" stroke="black" d="M39277.74,-4367.04C39315.78,-4353.45 39363.39,-4336.44 39405.7,-4321.32"/>
<polygon fill="black" stroke="black" points="39406.97,-4324.59 39415.21,-4317.93 39404.61,-4318 39406.97,-4324.59"/>
</g>
<!-- m54_agg -->
<g id="node654" class="node">
<title>m54_agg</title>
<polygon fill="purple" stroke="black" points="39370.23,-4209.01 39109.95,-4209.01 39043,-4133.01 39303.27,-4133.01 39370.23,-4209.01"/>
<text text-anchor="middle" x="39206.61" y="-4174.81" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="39206.61" y="-4159.81" font-family="Times,serif" font-size="14.00">GPU: 3766</text>
</g>
<!-- m54_expert0&#45;&gt;m54_agg -->
<g id="edge840" class="edge">
<title>m54_expert0&#45;&gt;m54_agg</title>
<path fill="none" stroke="black" d="M38501.14,-4256.24C38679.91,-4234.9 38930.08,-4205.03 39079.48,-4187.19"/>
<polygon fill="black" stroke="black" points="39080.1,-4190.64 39089.62,-4185.98 39079.27,-4183.69 39080.1,-4190.64"/>
</g>
<!-- m54_expert1&#45;&gt;m54_agg -->
<g id="edge842" class="edge">
<title>m54_expert1&#45;&gt;m54_agg</title>
<path fill="none" stroke="black" d="M38997.01,-4247C39029.3,-4235.45 39065.5,-4222.5 39098.62,-4210.65"/>
<polygon fill="black" stroke="black" points="39100.09,-4213.84 39108.33,-4207.18 39097.73,-4207.25 39100.09,-4213.84"/>
</g>
<!-- m54_expert2&#45;&gt;m54_agg -->
<g id="edge844" class="edge">
<title>m54_expert2&#45;&gt;m54_agg</title>
<path fill="none" stroke="black" d="M39415.53,-4247C39385.07,-4236.07 39351.11,-4223.88 39319.57,-4212.56"/>
<polygon fill="black" stroke="black" points="39320.47,-4209.16 39309.87,-4209.08 39318.1,-4215.75 39320.47,-4209.16"/>
</g>
<!-- m54_agg&#45;&gt;m54_final -->
<g id="edge845" class="edge">
<title>m54_agg&#45;&gt;m54_final</title>
<path fill="none" stroke="black" d="M39319.13,-4150.6C39425.17,-4132.3 39582.36,-4105.18 39682.9,-4087.83"/>
<polygon fill="black" stroke="black" points="39683.79,-4091.23 39693.05,-4086.08 39682.6,-4084.33 39683.79,-4091.23"/>
</g>
<!-- m55_res1 -->
<g id="node660" class="node">
<title>m55_res1</title>
<ellipse fill="lightpink" stroke="black" cx="39892.61" cy="-3980.4" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="39892.61" y="-3984.2" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="39892.61" y="-3969.2" font-family="Times,serif" font-size="14.00">GPU: 3767</text>
</g>
<!-- m54_final&#45;&gt;m55_res1 -->
<g id="edge851" class="edge">
<title>m54_final&#45;&gt;m55_res1</title>
<path fill="none" stroke="black" d="M39811.39,-4044.47C39824.6,-4034.22 39840.05,-4022.22 39853.9,-4011.46"/>
<polygon fill="black" stroke="black" points="39856.1,-4014.19 39861.85,-4005.29 39851.81,-4008.66 39856.1,-4014.19"/>
</g>
<!-- m55_ln1 -->
<g id="node656" class="node">
<title>m55_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="40006.61" cy="-4393.44" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="40006.61" y="-4397.24" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="40006.61" y="-4382.24" font-family="Times,serif" font-size="14.00">GPU: 3767</text>
</g>
<!-- m55_qkv -->
<g id="node657" class="node">
<title>m55_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="40006.61" cy="-4282.49" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="40006.61" y="-4286.29" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="40006.61" y="-4271.29" font-family="Times,serif" font-size="14.00">GPU: 3767</text>
</g>
<!-- m55_ln1&#45;&gt;m55_qkv -->
<g id="edge847" class="edge">
<title>m55_ln1&#45;&gt;m55_qkv</title>
<path fill="none" stroke="black" d="M40006.61,-4366.35C40006.61,-4352.33 40006.61,-4334.84 40006.61,-4319.54"/>
<polygon fill="black" stroke="black" points="40010.11,-4319.38 40006.61,-4309.38 40003.11,-4319.38 40010.11,-4319.38"/>
</g>
<!-- m55_mha -->
<g id="node658" class="node">
<title>m55_mha</title>
<ellipse fill="lightblue" stroke="black" cx="40006.61" cy="-4171.01" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="40006.61" y="-4174.81" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="40006.61" y="-4159.81" font-family="Times,serif" font-size="14.00">GPU: 3767</text>
</g>
<!-- m55_qkv&#45;&gt;m55_mha -->
<g id="edge848" class="edge">
<title>m55_qkv&#45;&gt;m55_mha</title>
<path fill="none" stroke="black" d="M40006.61,-4255.55C40006.61,-4241.47 40006.61,-4223.84 40006.61,-4208.41"/>
<polygon fill="black" stroke="black" points="40010.11,-4208.15 40006.61,-4198.15 40003.11,-4208.15 40010.11,-4208.15"/>
</g>
<!-- m55_out -->
<g id="node659" class="node">
<title>m55_out</title>
<ellipse fill="lightblue" stroke="black" cx="40006.61" cy="-4070.14" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="40006.61" y="-4073.94" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="40006.61" y="-4058.94" font-family="Times,serif" font-size="14.00">GPU: 3767</text>
</g>
<!-- m55_mha&#45;&gt;m55_out -->
<g id="edge849" class="edge">
<title>m55_mha&#45;&gt;m55_out</title>
<path fill="none" stroke="black" d="M40006.61,-4144.04C40006.61,-4132.89 40006.61,-4119.66 40006.61,-4107.56"/>
<polygon fill="black" stroke="black" points="40010.11,-4107.29 40006.61,-4097.29 40003.11,-4107.29 40010.11,-4107.29"/>
</g>
<!-- m55_out&#45;&gt;m55_res1 -->
<g id="edge850" class="edge">
<title>m55_out&#45;&gt;m55_res1</title>
<path fill="none" stroke="black" d="M39974.55,-4044.47C39961.23,-4034.22 39945.64,-4022.22 39931.66,-4011.46"/>
<polygon fill="black" stroke="black" points="39933.7,-4008.61 39923.64,-4005.29 39929.43,-4014.16 39933.7,-4008.61"/>
</g>
<!-- m55_gate -->
<g id="node661" class="node">
<title>m55_gate</title>
<polygon fill="orange" stroke="black" points="39864.23,-3917.53 39659.63,-3917.53 39607,-3811.53 39811.59,-3811.53 39864.23,-3917.53"/>
<text text-anchor="middle" x="39735.61" y="-3875.83" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="39735.61" y="-3860.83" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="39735.61" y="-3845.83" font-family="Times,serif" font-size="14.00">GPU: 3767</text>
</g>
<!-- m55_res1&#45;&gt;m55_gate -->
<g id="edge852" class="edge">
<title>m55_res1&#45;&gt;m55_gate</title>
<path fill="none" stroke="black" d="M39860.08,-3955.81C39847.08,-3946.38 39831.48,-3935.07 39815.79,-3923.69"/>
<polygon fill="black" stroke="black" points="39817.74,-3920.78 39807.59,-3917.74 39813.63,-3926.44 39817.74,-3920.78"/>
</g>
<!-- m55_route -->
<g id="node662" class="node">
<title>m55_route</title>
<ellipse fill="lightgray" stroke="black" cx="39735.61" cy="-3738.06" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="39735.61" y="-3749.36" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="39735.61" y="-3734.36" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="39735.61" y="-3719.36" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m55_res1&#45;&gt;m55_route -->
<g id="edge854" class="edge">
<title>m55_res1&#45;&gt;m55_route</title>
<path fill="none" stroke="black" d="M39896.67,-3953.55C39900.79,-3918.23 39902.92,-3854.38 39873.61,-3811.53 39860.5,-3792.37 39840.68,-3777.91 39820.11,-3767.15"/>
<polygon fill="black" stroke="black" points="39821.47,-3763.92 39810.95,-3762.62 39818.36,-3770.19 39821.47,-3763.92"/>
</g>
<!-- m55_final -->
<g id="node667" class="node">
<title>m55_final</title>
<ellipse fill="lightpink" stroke="black" cx="40308.61" cy="-3414.76" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="40308.61" y="-3418.56" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="40308.61" y="-3403.56" font-family="Times,serif" font-size="14.00">GPU: 3767</text>
</g>
<!-- m55_res1&#45;&gt;m55_final -->
<g id="edge862" class="edge">
<title>m55_res1&#45;&gt;m55_final</title>
<path fill="none" stroke="black" d="M39968.71,-3974.73C40102.21,-3961.98 40364.61,-3914.58 40364.61,-3739.06 40364.61,-3739.06 40364.61,-3739.06 40364.61,-3626.1 40364.61,-3562.78 40340.62,-3492.23 40324.04,-3451.05"/>
<polygon fill="black" stroke="black" points="40327.25,-3449.65 40320.22,-3441.73 40320.78,-3452.31 40327.25,-3449.65"/>
</g>
<!-- m55_gate&#45;&gt;m55_route -->
<g id="edge853" class="edge">
<title>m55_gate&#45;&gt;m55_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39735.61,-3811.47C39735.61,-3803.03 39735.61,-3794.35 39735.61,-3786.05"/>
<polygon fill="black" stroke="black" points="39739.11,-3785.78 39735.61,-3775.78 39732.11,-3785.78 39739.11,-3785.78"/>
</g>
<!-- m55_expert0 -->
<g id="node663" class="node">
<title>m55_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="38818.61" cy="-3627.1" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="38818.61" y="-3638.4" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="38818.61" y="-3623.4" font-family="Times,serif" font-size="14.00">Node 416 GPU 0</text>
<text text-anchor="middle" x="38818.61" y="-3608.4" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m55_route&#45;&gt;m55_expert0 -->
<g id="edge855" class="edge">
<title>m55_route&#45;&gt;m55_expert0</title>
<path fill="none" stroke="black" d="M39641.15,-3725.87C39521.09,-3711.65 39307.46,-3686.32 39124.61,-3664.58 39097.41,-3661.35 39068.84,-3657.95 39040.54,-3654.57"/>
<polygon fill="black" stroke="black" points="39040.89,-3651.09 39030.55,-3653.38 39040.06,-3658.04 39040.89,-3651.09"/>
</g>
<!-- m55_expert1 -->
<g id="node664" class="node">
<title>m55_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="39429.61" cy="-3627.1" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="39429.61" y="-3638.4" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="39429.61" y="-3623.4" font-family="Times,serif" font-size="14.00">Node 416 GPU 1</text>
<text text-anchor="middle" x="39429.61" y="-3608.4" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m55_route&#45;&gt;m55_expert1 -->
<g id="edge857" class="edge">
<title>m55_route&#45;&gt;m55_expert1</title>
<path fill="none" stroke="black" d="M39664.26,-3711.65C39626.08,-3698.06 39578.32,-3681.05 39535.87,-3665.94"/>
<polygon fill="black" stroke="black" points="39536.93,-3662.6 39526.33,-3662.54 39534.58,-3669.19 39536.93,-3662.6"/>
</g>
<!-- m55_expert2 -->
<g id="node665" class="node">
<title>m55_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="40040.61" cy="-3627.1" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="40040.61" y="-3638.4" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="40040.61" y="-3623.4" font-family="Times,serif" font-size="14.00">Node 416 GPU 2</text>
<text text-anchor="middle" x="40040.61" y="-3608.4" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m55_route&#45;&gt;m55_expert2 -->
<g id="edge859" class="edge">
<title>m55_route&#45;&gt;m55_expert2</title>
<path fill="none" stroke="black" d="M39806.74,-3711.65C39844.78,-3698.06 39892.39,-3681.05 39934.7,-3665.94"/>
<polygon fill="black" stroke="black" points="39935.97,-3669.2 39944.21,-3662.54 39933.61,-3662.61 39935.97,-3669.2"/>
</g>
<!-- m55_agg -->
<g id="node666" class="node">
<title>m55_agg</title>
<polygon fill="purple" stroke="black" points="39899.23,-3553.63 39638.95,-3553.63 39572,-3477.63 39832.27,-3477.63 39899.23,-3553.63"/>
<text text-anchor="middle" x="39735.61" y="-3519.43" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="39735.61" y="-3504.43" font-family="Times,serif" font-size="14.00">GPU: 3767</text>
</g>
<!-- m55_expert0&#45;&gt;m55_agg -->
<g id="edge856" class="edge">
<title>m55_expert0&#45;&gt;m55_agg</title>
<path fill="none" stroke="black" d="M39030.14,-3600.85C39208.91,-3579.51 39459.08,-3549.64 39608.48,-3531.81"/>
<polygon fill="black" stroke="black" points="39609.1,-3535.26 39618.62,-3530.6 39608.27,-3528.31 39609.1,-3535.26"/>
</g>
<!-- m55_expert1&#45;&gt;m55_agg -->
<g id="edge858" class="edge">
<title>m55_expert1&#45;&gt;m55_agg</title>
<path fill="none" stroke="black" d="M39526.01,-3591.62C39558.3,-3580.06 39594.5,-3567.11 39627.62,-3555.26"/>
<polygon fill="black" stroke="black" points="39629.09,-3558.46 39637.33,-3551.79 39626.73,-3551.86 39629.09,-3558.46"/>
</g>
<!-- m55_expert2&#45;&gt;m55_agg -->
<g id="edge860" class="edge">
<title>m55_expert2&#45;&gt;m55_agg</title>
<path fill="none" stroke="black" d="M39944.53,-3591.62C39914.07,-3580.68 39880.11,-3568.49 39848.57,-3557.17"/>
<polygon fill="black" stroke="black" points="39849.47,-3553.78 39838.87,-3553.69 39847.1,-3560.36 39849.47,-3553.78"/>
</g>
<!-- m55_agg&#45;&gt;m55_final -->
<g id="edge861" class="edge">
<title>m55_agg&#45;&gt;m55_final</title>
<path fill="none" stroke="black" d="M39848.13,-3495.21C39954.17,-3476.92 40111.36,-3449.79 40211.9,-3432.45"/>
<polygon fill="black" stroke="black" points="40212.79,-3435.84 40222.05,-3430.69 40211.6,-3428.95 40212.79,-3435.84"/>
</g>
<!-- m56_res1 -->
<g id="node672" class="node">
<title>m56_res1</title>
<ellipse fill="lightpink" stroke="black" cx="40421.61" cy="-3325.02" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="40421.61" y="-3328.82" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="40421.61" y="-3313.82" font-family="Times,serif" font-size="14.00">GPU: 3768</text>
</g>
<!-- m55_final&#45;&gt;m56_res1 -->
<g id="edge867" class="edge">
<title>m55_final&#45;&gt;m56_res1</title>
<path fill="none" stroke="black" d="M40340.39,-3389.08C40353.6,-3378.83 40369.05,-3366.83 40382.9,-3356.07"/>
<polygon fill="black" stroke="black" points="40385.1,-3358.8 40390.85,-3349.9 40380.81,-3353.27 40385.1,-3358.8"/>
</g>
<!-- m56_ln1 -->
<g id="node668" class="node">
<title>m56_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="40535.61" cy="-3738.06" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="40535.61" y="-3741.86" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="40535.61" y="-3726.86" font-family="Times,serif" font-size="14.00">GPU: 3768</text>
</g>
<!-- m56_qkv -->
<g id="node669" class="node">
<title>m56_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="40535.61" cy="-3627.1" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="40535.61" y="-3630.9" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="40535.61" y="-3615.9" font-family="Times,serif" font-size="14.00">GPU: 3768</text>
</g>
<!-- m56_ln1&#45;&gt;m56_qkv -->
<g id="edge863" class="edge">
<title>m56_ln1&#45;&gt;m56_qkv</title>
<path fill="none" stroke="black" d="M40535.61,-3710.96C40535.61,-3696.95 40535.61,-3679.45 40535.61,-3664.16"/>
<polygon fill="black" stroke="black" points="40539.11,-3663.99 40535.61,-3653.99 40532.11,-3663.99 40539.11,-3663.99"/>
</g>
<!-- m56_mha -->
<g id="node670" class="node">
<title>m56_mha</title>
<ellipse fill="lightblue" stroke="black" cx="40535.61" cy="-3515.63" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="40535.61" y="-3519.43" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="40535.61" y="-3504.43" font-family="Times,serif" font-size="14.00">GPU: 3768</text>
</g>
<!-- m56_qkv&#45;&gt;m56_mha -->
<g id="edge864" class="edge">
<title>m56_qkv&#45;&gt;m56_mha</title>
<path fill="none" stroke="black" d="M40535.61,-3600.16C40535.61,-3586.08 40535.61,-3568.46 40535.61,-3553.03"/>
<polygon fill="black" stroke="black" points="40539.11,-3552.77 40535.61,-3542.77 40532.11,-3552.77 40539.11,-3552.77"/>
</g>
<!-- m56_out -->
<g id="node671" class="node">
<title>m56_out</title>
<ellipse fill="lightblue" stroke="black" cx="40535.61" cy="-3414.76" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="40535.61" y="-3418.56" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="40535.61" y="-3403.56" font-family="Times,serif" font-size="14.00">GPU: 3768</text>
</g>
<!-- m56_mha&#45;&gt;m56_out -->
<g id="edge865" class="edge">
<title>m56_mha&#45;&gt;m56_out</title>
<path fill="none" stroke="black" d="M40535.61,-3488.65C40535.61,-3477.5 40535.61,-3464.27 40535.61,-3452.17"/>
<polygon fill="black" stroke="black" points="40539.11,-3451.9 40535.61,-3441.9 40532.11,-3451.9 40539.11,-3451.9"/>
</g>
<!-- m56_out&#45;&gt;m56_res1 -->
<g id="edge866" class="edge">
<title>m56_out&#45;&gt;m56_res1</title>
<path fill="none" stroke="black" d="M40503.55,-3389.08C40490.23,-3378.83 40474.64,-3366.83 40460.66,-3356.07"/>
<polygon fill="black" stroke="black" points="40462.7,-3353.23 40452.64,-3349.9 40458.43,-3358.77 40462.7,-3353.23"/>
</g>
<!-- m56_gate -->
<g id="node673" class="node">
<title>m56_gate</title>
<polygon fill="orange" stroke="black" points="40393.23,-3262.15 40188.63,-3262.15 40136,-3156.15 40340.59,-3156.15 40393.23,-3262.15"/>
<text text-anchor="middle" x="40264.61" y="-3220.45" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="40264.61" y="-3205.45" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="40264.61" y="-3190.45" font-family="Times,serif" font-size="14.00">GPU: 3768</text>
</g>
<!-- m56_res1&#45;&gt;m56_gate -->
<g id="edge868" class="edge">
<title>m56_res1&#45;&gt;m56_gate</title>
<path fill="none" stroke="black" d="M40389.08,-3300.42C40376.08,-3290.99 40360.48,-3279.68 40344.79,-3268.3"/>
<polygon fill="black" stroke="black" points="40346.74,-3265.39 40336.59,-3262.35 40342.63,-3271.06 40346.74,-3265.39"/>
</g>
<!-- m56_route -->
<g id="node674" class="node">
<title>m56_route</title>
<ellipse fill="lightgray" stroke="black" cx="40264.61" cy="-3082.67" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="40264.61" y="-3093.97" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="40264.61" y="-3078.97" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="40264.61" y="-3063.97" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m56_res1&#45;&gt;m56_route -->
<g id="edge870" class="edge">
<title>m56_res1&#45;&gt;m56_route</title>
<path fill="none" stroke="black" d="M40425.67,-3298.17C40429.79,-3262.84 40431.92,-3199 40402.61,-3156.15 40389.5,-3136.98 40369.68,-3122.52 40349.11,-3111.77"/>
<polygon fill="black" stroke="black" points="40350.47,-3108.53 40339.95,-3107.23 40347.36,-3114.81 40350.47,-3108.53"/>
</g>
<!-- m56_final -->
<g id="node679" class="node">
<title>m56_final</title>
<ellipse fill="lightpink" stroke="black" cx="40838.61" cy="-2759.37" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="40838.61" y="-2763.17" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="40838.61" y="-2748.17" font-family="Times,serif" font-size="14.00">GPU: 3768</text>
</g>
<!-- m56_res1&#45;&gt;m56_final -->
<g id="edge878" class="edge">
<title>m56_res1&#45;&gt;m56_final</title>
<path fill="none" stroke="black" d="M40497.87,-3319.4C40631.66,-3306.74 40894.61,-3259.49 40894.61,-3083.67 40894.61,-3083.67 40894.61,-3083.67 40894.61,-2970.72 40894.61,-2907.39 40870.62,-2836.85 40854.04,-2795.66"/>
<polygon fill="black" stroke="black" points="40857.25,-2794.26 40850.22,-2786.34 40850.78,-2796.92 40857.25,-2794.26"/>
</g>
<!-- m56_gate&#45;&gt;m56_route -->
<g id="edge869" class="edge">
<title>m56_gate&#45;&gt;m56_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40264.61,-3156.08C40264.61,-3147.65 40264.61,-3138.96 40264.61,-3130.66"/>
<polygon fill="black" stroke="black" points="40268.11,-3130.4 40264.61,-3120.4 40261.11,-3130.4 40268.11,-3130.4"/>
</g>
<!-- m56_expert0 -->
<g id="node675" class="node">
<title>m56_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="39348.61" cy="-2971.72" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="39348.61" y="-2983.02" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="39348.61" y="-2968.02" font-family="Times,serif" font-size="14.00">Node 424 GPU 0</text>
<text text-anchor="middle" x="39348.61" y="-2953.02" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m56_route&#45;&gt;m56_expert0 -->
<g id="edge871" class="edge">
<title>m56_route&#45;&gt;m56_expert0</title>
<path fill="none" stroke="black" d="M40170.3,-3070.48C40050.44,-3056.25 39837.16,-3030.92 39654.61,-3009.19 39627.41,-3005.96 39598.84,-3002.55 39570.54,-2999.18"/>
<polygon fill="black" stroke="black" points="39570.89,-2995.7 39560.55,-2997.99 39570.06,-3002.65 39570.89,-2995.7"/>
</g>
<!-- m56_expert1 -->
<g id="node676" class="node">
<title>m56_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="39959.61" cy="-2971.72" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="39959.61" y="-2983.02" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="39959.61" y="-2968.02" font-family="Times,serif" font-size="14.00">Node 424 GPU 1</text>
<text text-anchor="middle" x="39959.61" y="-2953.02" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m56_route&#45;&gt;m56_expert1 -->
<g id="edge873" class="edge">
<title>m56_route&#45;&gt;m56_expert1</title>
<path fill="none" stroke="black" d="M40193.49,-3056.26C40155.44,-3042.67 40107.83,-3025.67 40065.52,-3010.55"/>
<polygon fill="black" stroke="black" points="40066.61,-3007.22 40056.02,-3007.16 40064.26,-3013.82 40066.61,-3007.22"/>
</g>
<!-- m56_expert2 -->
<g id="node677" class="node">
<title>m56_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="40570.61" cy="-2971.72" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="40570.61" y="-2983.02" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="40570.61" y="-2968.02" font-family="Times,serif" font-size="14.00">Node 424 GPU 2</text>
<text text-anchor="middle" x="40570.61" y="-2953.02" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m56_route&#45;&gt;m56_expert2 -->
<g id="edge875" class="edge">
<title>m56_route&#45;&gt;m56_expert2</title>
<path fill="none" stroke="black" d="M40335.97,-3056.26C40374.14,-3042.67 40421.9,-3025.67 40464.36,-3010.55"/>
<polygon fill="black" stroke="black" points="40465.64,-3013.81 40473.89,-3007.16 40463.3,-3007.21 40465.64,-3013.81"/>
</g>
<!-- m56_agg -->
<g id="node678" class="node">
<title>m56_agg</title>
<polygon fill="purple" stroke="black" points="40429.23,-2898.24 40168.95,-2898.24 40102,-2822.24 40362.27,-2822.24 40429.23,-2898.24"/>
<text text-anchor="middle" x="40265.61" y="-2864.04" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="40265.61" y="-2849.04" font-family="Times,serif" font-size="14.00">GPU: 3768</text>
</g>
<!-- m56_expert0&#45;&gt;m56_agg -->
<g id="edge872" class="edge">
<title>m56_expert0&#45;&gt;m56_agg</title>
<path fill="none" stroke="black" d="M39560.14,-2945.46C39738.91,-2924.12 39989.08,-2894.25 40138.48,-2876.42"/>
<polygon fill="black" stroke="black" points="40139.1,-2879.87 40148.62,-2875.21 40138.27,-2872.92 40139.1,-2879.87"/>
</g>
<!-- m56_expert1&#45;&gt;m56_agg -->
<g id="edge874" class="edge">
<title>m56_expert1&#45;&gt;m56_agg</title>
<path fill="none" stroke="black" d="M40056.01,-2936.23C40088.3,-2924.68 40124.5,-2911.73 40157.62,-2899.88"/>
<polygon fill="black" stroke="black" points="40159.09,-2903.07 40167.33,-2896.4 40156.73,-2896.48 40159.09,-2903.07"/>
</g>
<!-- m56_expert2&#45;&gt;m56_agg -->
<g id="edge876" class="edge">
<title>m56_expert2&#45;&gt;m56_agg</title>
<path fill="none" stroke="black" d="M40474.53,-2936.23C40444.07,-2925.29 40410.11,-2913.11 40378.57,-2901.79"/>
<polygon fill="black" stroke="black" points="40379.47,-2898.39 40368.87,-2898.3 40377.1,-2904.98 40379.47,-2898.39"/>
</g>
<!-- m56_agg&#45;&gt;m56_final -->
<g id="edge877" class="edge">
<title>m56_agg&#45;&gt;m56_final</title>
<path fill="none" stroke="black" d="M40378.13,-2839.83C40484.17,-2821.53 40641.36,-2794.41 40741.9,-2777.06"/>
<polygon fill="black" stroke="black" points="40742.79,-2780.46 40752.05,-2775.31 40741.6,-2773.56 40742.79,-2780.46"/>
</g>
<!-- m57_res1 -->
<g id="node684" class="node">
<title>m57_res1</title>
<ellipse fill="lightpink" stroke="black" cx="40951.61" cy="-2669.63" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="40951.61" y="-2673.43" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="40951.61" y="-2658.43" font-family="Times,serif" font-size="14.00">GPU: 3769</text>
</g>
<!-- m56_final&#45;&gt;m57_res1 -->
<g id="edge883" class="edge">
<title>m56_final&#45;&gt;m57_res1</title>
<path fill="none" stroke="black" d="M40870.39,-2733.7C40883.6,-2723.44 40899.05,-2711.45 40912.9,-2700.69"/>
<polygon fill="black" stroke="black" points="40915.1,-2703.41 40920.85,-2694.51 40910.81,-2697.88 40915.1,-2703.41"/>
</g>
<!-- m57_ln1 -->
<g id="node680" class="node">
<title>m57_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="41065.61" cy="-3082.67" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="41065.61" y="-3086.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="41065.61" y="-3071.47" font-family="Times,serif" font-size="14.00">GPU: 3769</text>
</g>
<!-- m57_qkv -->
<g id="node681" class="node">
<title>m57_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="41065.61" cy="-2971.72" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="41065.61" y="-2975.52" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="41065.61" y="-2960.52" font-family="Times,serif" font-size="14.00">GPU: 3769</text>
</g>
<!-- m57_ln1&#45;&gt;m57_qkv -->
<g id="edge879" class="edge">
<title>m57_ln1&#45;&gt;m57_qkv</title>
<path fill="none" stroke="black" d="M41065.61,-3055.57C41065.61,-3041.56 41065.61,-3024.07 41065.61,-3008.77"/>
<polygon fill="black" stroke="black" points="41069.11,-3008.6 41065.61,-2998.6 41062.11,-3008.6 41069.11,-3008.6"/>
</g>
<!-- m57_mha -->
<g id="node682" class="node">
<title>m57_mha</title>
<ellipse fill="lightblue" stroke="black" cx="41065.61" cy="-2860.24" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="41065.61" y="-2864.04" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="41065.61" y="-2849.04" font-family="Times,serif" font-size="14.00">GPU: 3769</text>
</g>
<!-- m57_qkv&#45;&gt;m57_mha -->
<g id="edge880" class="edge">
<title>m57_qkv&#45;&gt;m57_mha</title>
<path fill="none" stroke="black" d="M41065.61,-2944.77C41065.61,-2930.7 41065.61,-2913.07 41065.61,-2897.64"/>
<polygon fill="black" stroke="black" points="41069.11,-2897.38 41065.61,-2887.38 41062.11,-2897.38 41069.11,-2897.38"/>
</g>
<!-- m57_out -->
<g id="node683" class="node">
<title>m57_out</title>
<ellipse fill="lightblue" stroke="black" cx="41065.61" cy="-2759.37" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="41065.61" y="-2763.17" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="41065.61" y="-2748.17" font-family="Times,serif" font-size="14.00">GPU: 3769</text>
</g>
<!-- m57_mha&#45;&gt;m57_out -->
<g id="edge881" class="edge">
<title>m57_mha&#45;&gt;m57_out</title>
<path fill="none" stroke="black" d="M41065.61,-2833.26C41065.61,-2822.11 41065.61,-2808.89 41065.61,-2796.78"/>
<polygon fill="black" stroke="black" points="41069.11,-2796.52 41065.61,-2786.52 41062.11,-2796.52 41069.11,-2796.52"/>
</g>
<!-- m57_out&#45;&gt;m57_res1 -->
<g id="edge882" class="edge">
<title>m57_out&#45;&gt;m57_res1</title>
<path fill="none" stroke="black" d="M41033.55,-2733.7C41020.23,-2723.44 41004.64,-2711.45 40990.66,-2700.69"/>
<polygon fill="black" stroke="black" points="40992.7,-2697.84 40982.64,-2694.51 40988.43,-2703.39 40992.7,-2697.84"/>
</g>
<!-- m57_gate -->
<g id="node685" class="node">
<title>m57_gate</title>
<polygon fill="orange" stroke="black" points="40923.23,-2606.76 40718.63,-2606.76 40666,-2500.76 40870.59,-2500.76 40923.23,-2606.76"/>
<text text-anchor="middle" x="40794.61" y="-2565.06" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="40794.61" y="-2550.06" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="40794.61" y="-2535.06" font-family="Times,serif" font-size="14.00">GPU: 3769</text>
</g>
<!-- m57_res1&#45;&gt;m57_gate -->
<g id="edge884" class="edge">
<title>m57_res1&#45;&gt;m57_gate</title>
<path fill="none" stroke="black" d="M40919.08,-2645.04C40906.08,-2635.61 40890.48,-2624.29 40874.79,-2612.91"/>
<polygon fill="black" stroke="black" points="40876.74,-2610 40866.59,-2606.96 40872.63,-2615.67 40876.74,-2610"/>
</g>
<!-- m57_route -->
<g id="node686" class="node">
<title>m57_route</title>
<ellipse fill="lightgray" stroke="black" cx="40794.61" cy="-2427.28" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="40794.61" y="-2438.58" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="40794.61" y="-2423.58" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="40794.61" y="-2408.58" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m57_res1&#45;&gt;m57_route -->
<g id="edge886" class="edge">
<title>m57_res1&#45;&gt;m57_route</title>
<path fill="none" stroke="black" d="M40955.67,-2642.78C40959.79,-2607.46 40961.92,-2543.61 40932.61,-2500.76 40919.5,-2481.6 40899.68,-2467.14 40879.11,-2456.38"/>
<polygon fill="black" stroke="black" points="40880.47,-2453.15 40869.95,-2451.85 40877.36,-2459.42 40880.47,-2453.15"/>
</g>
<!-- m57_final -->
<g id="node691" class="node">
<title>m57_final</title>
<ellipse fill="lightpink" stroke="black" cx="41368.61" cy="-2103.98" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="41368.61" y="-2107.78" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="41368.61" y="-2092.78" font-family="Times,serif" font-size="14.00">GPU: 3769</text>
</g>
<!-- m57_res1&#45;&gt;m57_final -->
<g id="edge894" class="edge">
<title>m57_res1&#45;&gt;m57_final</title>
<path fill="none" stroke="black" d="M41027.87,-2664.02C41161.66,-2651.35 41424.61,-2604.1 41424.61,-2428.28 41424.61,-2428.28 41424.61,-2428.28 41424.61,-2315.33 41424.61,-2252.01 41400.62,-2181.46 41384.04,-2140.28"/>
<polygon fill="black" stroke="black" points="41387.25,-2138.88 41380.22,-2130.96 41380.78,-2141.54 41387.25,-2138.88"/>
</g>
<!-- m57_gate&#45;&gt;m57_route -->
<g id="edge885" class="edge">
<title>m57_gate&#45;&gt;m57_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40794.61,-2500.69C40794.61,-2492.26 40794.61,-2483.57 40794.61,-2475.27"/>
<polygon fill="black" stroke="black" points="40798.11,-2475.01 40794.61,-2465.01 40791.11,-2475.01 40798.11,-2475.01"/>
</g>
<!-- m57_expert0 -->
<g id="node687" class="node">
<title>m57_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="39878.61" cy="-2316.33" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="39878.61" y="-2327.63" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="39878.61" y="-2312.63" font-family="Times,serif" font-size="14.00">Node 432 GPU 0</text>
<text text-anchor="middle" x="39878.61" y="-2297.63" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m57_route&#45;&gt;m57_expert0 -->
<g id="edge887" class="edge">
<title>m57_route&#45;&gt;m57_expert0</title>
<path fill="none" stroke="black" d="M40700.3,-2415.09C40580.44,-2400.86 40367.16,-2375.53 40184.61,-2353.81 40157.41,-2350.57 40128.84,-2347.17 40100.54,-2343.8"/>
<polygon fill="black" stroke="black" points="40100.89,-2340.31 40090.55,-2342.61 40100.06,-2347.26 40100.89,-2340.31"/>
</g>
<!-- m57_expert1 -->
<g id="node688" class="node">
<title>m57_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="40489.61" cy="-2316.33" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="40489.61" y="-2327.63" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="40489.61" y="-2312.63" font-family="Times,serif" font-size="14.00">Node 432 GPU 1</text>
<text text-anchor="middle" x="40489.61" y="-2297.63" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m57_route&#45;&gt;m57_expert1 -->
<g id="edge889" class="edge">
<title>m57_route&#45;&gt;m57_expert1</title>
<path fill="none" stroke="black" d="M40723.49,-2400.88C40685.44,-2387.29 40637.83,-2370.28 40595.52,-2355.16"/>
<polygon fill="black" stroke="black" points="40596.61,-2351.84 40586.02,-2351.77 40594.26,-2358.43 40596.61,-2351.84"/>
</g>
<!-- m57_expert2 -->
<g id="node689" class="node">
<title>m57_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="41100.61" cy="-2316.33" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="41100.61" y="-2327.63" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="41100.61" y="-2312.63" font-family="Times,serif" font-size="14.00">Node 432 GPU 2</text>
<text text-anchor="middle" x="41100.61" y="-2297.63" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m57_route&#45;&gt;m57_expert2 -->
<g id="edge891" class="edge">
<title>m57_route&#45;&gt;m57_expert2</title>
<path fill="none" stroke="black" d="M40865.97,-2400.88C40904.14,-2387.29 40951.9,-2370.28 40994.36,-2355.16"/>
<polygon fill="black" stroke="black" points="40995.64,-2358.42 41003.89,-2351.77 40993.3,-2351.83 40995.64,-2358.42"/>
</g>
<!-- m57_agg -->
<g id="node690" class="node">
<title>m57_agg</title>
<polygon fill="purple" stroke="black" points="40959.23,-2242.85 40698.95,-2242.85 40632,-2166.85 40892.27,-2166.85 40959.23,-2242.85"/>
<text text-anchor="middle" x="40795.61" y="-2208.65" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="40795.61" y="-2193.65" font-family="Times,serif" font-size="14.00">GPU: 3769</text>
</g>
<!-- m57_expert0&#45;&gt;m57_agg -->
<g id="edge888" class="edge">
<title>m57_expert0&#45;&gt;m57_agg</title>
<path fill="none" stroke="black" d="M40090.14,-2290.08C40268.91,-2268.73 40519.08,-2238.87 40668.48,-2221.03"/>
<polygon fill="black" stroke="black" points="40669.1,-2224.48 40678.62,-2219.82 40668.27,-2217.53 40669.1,-2224.48"/>
</g>
<!-- m57_expert1&#45;&gt;m57_agg -->
<g id="edge890" class="edge">
<title>m57_expert1&#45;&gt;m57_agg</title>
<path fill="none" stroke="black" d="M40586.01,-2280.84C40618.3,-2269.29 40654.5,-2256.34 40687.62,-2244.49"/>
<polygon fill="black" stroke="black" points="40689.09,-2247.68 40697.33,-2241.02 40686.73,-2241.09 40689.09,-2247.68"/>
</g>
<!-- m57_expert2&#45;&gt;m57_agg -->
<g id="edge892" class="edge">
<title>m57_expert2&#45;&gt;m57_agg</title>
<path fill="none" stroke="black" d="M41004.53,-2280.84C40974.07,-2269.91 40940.11,-2257.72 40908.57,-2246.4"/>
<polygon fill="black" stroke="black" points="40909.47,-2243 40898.87,-2242.92 40907.1,-2249.59 40909.47,-2243"/>
</g>
<!-- m57_agg&#45;&gt;m57_final -->
<g id="edge893" class="edge">
<title>m57_agg&#45;&gt;m57_final</title>
<path fill="none" stroke="black" d="M40908.13,-2184.44C41014.17,-2166.14 41171.36,-2139.02 41271.9,-2121.67"/>
<polygon fill="black" stroke="black" points="41272.79,-2125.07 41282.05,-2119.92 41271.6,-2118.17 41272.79,-2125.07"/>
</g>
<!-- m58_res1 -->
<g id="node696" class="node">
<title>m58_res1</title>
<ellipse fill="lightpink" stroke="black" cx="41481.61" cy="-2014.24" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="41481.61" y="-2018.04" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="41481.61" y="-2003.04" font-family="Times,serif" font-size="14.00">GPU: 3770</text>
</g>
<!-- m57_final&#45;&gt;m58_res1 -->
<g id="edge899" class="edge">
<title>m57_final&#45;&gt;m58_res1</title>
<path fill="none" stroke="black" d="M41400.39,-2078.31C41413.6,-2068.06 41429.05,-2056.06 41442.9,-2045.3"/>
<polygon fill="black" stroke="black" points="41445.1,-2048.03 41450.85,-2039.13 41440.81,-2042.5 41445.1,-2048.03"/>
</g>
<!-- m58_ln1 -->
<g id="node692" class="node">
<title>m58_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="41595.61" cy="-2427.28" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="41595.61" y="-2431.08" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="41595.61" y="-2416.08" font-family="Times,serif" font-size="14.00">GPU: 3770</text>
</g>
<!-- m58_qkv -->
<g id="node693" class="node">
<title>m58_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="41595.61" cy="-2316.33" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="41595.61" y="-2320.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="41595.61" y="-2305.13" font-family="Times,serif" font-size="14.00">GPU: 3770</text>
</g>
<!-- m58_ln1&#45;&gt;m58_qkv -->
<g id="edge895" class="edge">
<title>m58_ln1&#45;&gt;m58_qkv</title>
<path fill="none" stroke="black" d="M41595.61,-2400.19C41595.61,-2386.17 41595.61,-2368.68 41595.61,-2353.38"/>
<polygon fill="black" stroke="black" points="41599.11,-2353.21 41595.61,-2343.21 41592.11,-2353.21 41599.11,-2353.21"/>
</g>
<!-- m58_mha -->
<g id="node694" class="node">
<title>m58_mha</title>
<ellipse fill="lightblue" stroke="black" cx="41595.61" cy="-2204.85" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="41595.61" y="-2208.65" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="41595.61" y="-2193.65" font-family="Times,serif" font-size="14.00">GPU: 3770</text>
</g>
<!-- m58_qkv&#45;&gt;m58_mha -->
<g id="edge896" class="edge">
<title>m58_qkv&#45;&gt;m58_mha</title>
<path fill="none" stroke="black" d="M41595.61,-2289.39C41595.61,-2275.31 41595.61,-2257.68 41595.61,-2242.25"/>
<polygon fill="black" stroke="black" points="41599.11,-2241.99 41595.61,-2231.99 41592.11,-2241.99 41599.11,-2241.99"/>
</g>
<!-- m58_out -->
<g id="node695" class="node">
<title>m58_out</title>
<ellipse fill="lightblue" stroke="black" cx="41595.61" cy="-2103.98" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="41595.61" y="-2107.78" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="41595.61" y="-2092.78" font-family="Times,serif" font-size="14.00">GPU: 3770</text>
</g>
<!-- m58_mha&#45;&gt;m58_out -->
<g id="edge897" class="edge">
<title>m58_mha&#45;&gt;m58_out</title>
<path fill="none" stroke="black" d="M41595.61,-2177.88C41595.61,-2166.73 41595.61,-2153.5 41595.61,-2141.4"/>
<polygon fill="black" stroke="black" points="41599.11,-2141.13 41595.61,-2131.13 41592.11,-2141.13 41599.11,-2141.13"/>
</g>
<!-- m58_out&#45;&gt;m58_res1 -->
<g id="edge898" class="edge">
<title>m58_out&#45;&gt;m58_res1</title>
<path fill="none" stroke="black" d="M41563.55,-2078.31C41550.23,-2068.06 41534.64,-2056.06 41520.66,-2045.3"/>
<polygon fill="black" stroke="black" points="41522.7,-2042.45 41512.64,-2039.13 41518.43,-2048 41522.7,-2042.45"/>
</g>
<!-- m58_gate -->
<g id="node697" class="node">
<title>m58_gate</title>
<polygon fill="orange" stroke="black" points="41453.23,-1951.37 41248.63,-1951.37 41196,-1845.37 41400.59,-1845.37 41453.23,-1951.37"/>
<text text-anchor="middle" x="41324.61" y="-1909.67" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="41324.61" y="-1894.67" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="41324.61" y="-1879.67" font-family="Times,serif" font-size="14.00">GPU: 3770</text>
</g>
<!-- m58_res1&#45;&gt;m58_gate -->
<g id="edge900" class="edge">
<title>m58_res1&#45;&gt;m58_gate</title>
<path fill="none" stroke="black" d="M41449.08,-1989.65C41436.08,-1980.22 41420.48,-1968.9 41404.79,-1957.53"/>
<polygon fill="black" stroke="black" points="41406.74,-1954.62 41396.59,-1951.58 41402.63,-1960.28 41406.74,-1954.62"/>
</g>
<!-- m58_route -->
<g id="node698" class="node">
<title>m58_route</title>
<ellipse fill="lightgray" stroke="black" cx="41324.61" cy="-1771.9" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="41324.61" y="-1783.2" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="41324.61" y="-1768.2" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="41324.61" y="-1753.2" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m58_res1&#45;&gt;m58_route -->
<g id="edge902" class="edge">
<title>m58_res1&#45;&gt;m58_route</title>
<path fill="none" stroke="black" d="M41485.67,-1987.39C41489.79,-1952.07 41491.92,-1888.22 41462.61,-1845.37 41449.5,-1826.21 41429.68,-1811.75 41409.11,-1800.99"/>
<polygon fill="black" stroke="black" points="41410.47,-1797.76 41399.95,-1796.46 41407.36,-1804.03 41410.47,-1797.76"/>
</g>
<!-- m58_final -->
<g id="node703" class="node">
<title>m58_final</title>
<ellipse fill="lightpink" stroke="black" cx="41897.61" cy="-1448.6" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="41897.61" y="-1452.4" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="41897.61" y="-1437.4" font-family="Times,serif" font-size="14.00">GPU: 3770</text>
</g>
<!-- m58_res1&#45;&gt;m58_final -->
<g id="edge910" class="edge">
<title>m58_res1&#45;&gt;m58_final</title>
<path fill="none" stroke="black" d="M41557.71,-2008.57C41691.21,-1995.82 41953.61,-1948.42 41953.61,-1772.9 41953.61,-1772.9 41953.61,-1772.9 41953.61,-1659.94 41953.61,-1596.62 41929.62,-1526.07 41913.04,-1484.89"/>
<polygon fill="black" stroke="black" points="41916.25,-1483.49 41909.22,-1475.57 41909.78,-1486.15 41916.25,-1483.49"/>
</g>
<!-- m58_gate&#45;&gt;m58_route -->
<g id="edge901" class="edge">
<title>m58_gate&#45;&gt;m58_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41324.61,-1845.31C41324.61,-1836.87 41324.61,-1828.19 41324.61,-1819.88"/>
<polygon fill="black" stroke="black" points="41328.11,-1819.62 41324.61,-1809.62 41321.11,-1819.62 41328.11,-1819.62"/>
</g>
<!-- m58_expert0 -->
<g id="node699" class="node">
<title>m58_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="40407.61" cy="-1660.94" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="40407.61" y="-1672.24" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="40407.61" y="-1657.24" font-family="Times,serif" font-size="14.00">Node 440 GPU 0</text>
<text text-anchor="middle" x="40407.61" y="-1642.24" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m58_route&#45;&gt;m58_expert0 -->
<g id="edge903" class="edge">
<title>m58_route&#45;&gt;m58_expert0</title>
<path fill="none" stroke="black" d="M41230.15,-1759.71C41110.09,-1745.49 40896.46,-1720.16 40713.61,-1698.42 40686.41,-1695.19 40657.84,-1691.78 40629.54,-1688.41"/>
<polygon fill="black" stroke="black" points="40629.89,-1684.93 40619.55,-1687.22 40629.06,-1691.88 40629.89,-1684.93"/>
</g>
<!-- m58_expert1 -->
<g id="node700" class="node">
<title>m58_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="41018.61" cy="-1660.94" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="41018.61" y="-1672.24" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="41018.61" y="-1657.24" font-family="Times,serif" font-size="14.00">Node 440 GPU 1</text>
<text text-anchor="middle" x="41018.61" y="-1642.24" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m58_route&#45;&gt;m58_expert1 -->
<g id="edge905" class="edge">
<title>m58_route&#45;&gt;m58_expert1</title>
<path fill="none" stroke="black" d="M41253.26,-1745.49C41215.08,-1731.9 41167.32,-1714.89 41124.87,-1699.78"/>
<polygon fill="black" stroke="black" points="41125.93,-1696.44 41115.33,-1696.38 41123.58,-1703.03 41125.93,-1696.44"/>
</g>
<!-- m58_expert2 -->
<g id="node701" class="node">
<title>m58_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="41629.61" cy="-1660.94" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="41629.61" y="-1672.24" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="41629.61" y="-1657.24" font-family="Times,serif" font-size="14.00">Node 440 GPU 2</text>
<text text-anchor="middle" x="41629.61" y="-1642.24" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m58_route&#45;&gt;m58_expert2 -->
<g id="edge907" class="edge">
<title>m58_route&#45;&gt;m58_expert2</title>
<path fill="none" stroke="black" d="M41395.74,-1745.49C41433.78,-1731.9 41481.39,-1714.89 41523.7,-1699.78"/>
<polygon fill="black" stroke="black" points="41524.97,-1703.04 41533.21,-1696.38 41522.61,-1696.45 41524.97,-1703.04"/>
</g>
<!-- m58_agg -->
<g id="node702" class="node">
<title>m58_agg</title>
<polygon fill="purple" stroke="black" points="41488.23,-1587.47 41227.95,-1587.47 41161,-1511.47 41421.27,-1511.47 41488.23,-1587.47"/>
<text text-anchor="middle" x="41324.61" y="-1553.27" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="41324.61" y="-1538.27" font-family="Times,serif" font-size="14.00">GPU: 3770</text>
</g>
<!-- m58_expert0&#45;&gt;m58_agg -->
<g id="edge904" class="edge">
<title>m58_expert0&#45;&gt;m58_agg</title>
<path fill="none" stroke="black" d="M40619.14,-1634.69C40797.91,-1613.35 41048.08,-1583.48 41197.48,-1565.64"/>
<polygon fill="black" stroke="black" points="41198.1,-1569.1 41207.62,-1564.43 41197.27,-1562.14 41198.1,-1569.1"/>
</g>
<!-- m58_expert1&#45;&gt;m58_agg -->
<g id="edge906" class="edge">
<title>m58_expert1&#45;&gt;m58_agg</title>
<path fill="none" stroke="black" d="M41115.01,-1625.45C41147.3,-1613.9 41183.5,-1600.95 41216.62,-1589.1"/>
<polygon fill="black" stroke="black" points="41218.09,-1592.29 41226.33,-1585.63 41215.73,-1585.7 41218.09,-1592.29"/>
</g>
<!-- m58_expert2&#45;&gt;m58_agg -->
<g id="edge908" class="edge">
<title>m58_expert2&#45;&gt;m58_agg</title>
<path fill="none" stroke="black" d="M41533.53,-1625.45C41503.07,-1614.52 41469.11,-1602.33 41437.57,-1591.01"/>
<polygon fill="black" stroke="black" points="41438.47,-1587.62 41427.87,-1587.53 41436.1,-1594.2 41438.47,-1587.62"/>
</g>
<!-- m58_agg&#45;&gt;m58_final -->
<g id="edge909" class="edge">
<title>m58_agg&#45;&gt;m58_final</title>
<path fill="none" stroke="black" d="M41437.13,-1529.05C41543.17,-1510.76 41700.36,-1483.63 41800.9,-1466.29"/>
<polygon fill="black" stroke="black" points="41801.79,-1469.68 41811.05,-1464.53 41800.6,-1462.78 41801.79,-1469.68"/>
</g>
<!-- m59_res1 -->
<g id="node708" class="node">
<title>m59_res1</title>
<ellipse fill="lightpink" stroke="black" cx="42010.61" cy="-1358.86" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="42010.61" y="-1362.66" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="42010.61" y="-1347.66" font-family="Times,serif" font-size="14.00">GPU: 3771</text>
</g>
<!-- m58_final&#45;&gt;m59_res1 -->
<g id="edge915" class="edge">
<title>m58_final&#45;&gt;m59_res1</title>
<path fill="none" stroke="black" d="M41929.39,-1422.92C41942.6,-1412.67 41958.05,-1400.67 41971.9,-1389.91"/>
<polygon fill="black" stroke="black" points="41974.1,-1392.64 41979.85,-1383.74 41969.81,-1387.11 41974.1,-1392.64"/>
</g>
<!-- m59_ln1 -->
<g id="node704" class="node">
<title>m59_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="42124.61" cy="-1771.9" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="42124.61" y="-1775.7" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="42124.61" y="-1760.7" font-family="Times,serif" font-size="14.00">GPU: 3771</text>
</g>
<!-- m59_qkv -->
<g id="node705" class="node">
<title>m59_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="42124.61" cy="-1660.94" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="42124.61" y="-1664.74" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="42124.61" y="-1649.74" font-family="Times,serif" font-size="14.00">GPU: 3771</text>
</g>
<!-- m59_ln1&#45;&gt;m59_qkv -->
<g id="edge911" class="edge">
<title>m59_ln1&#45;&gt;m59_qkv</title>
<path fill="none" stroke="black" d="M42124.61,-1744.8C42124.61,-1730.78 42124.61,-1713.29 42124.61,-1698"/>
<polygon fill="black" stroke="black" points="42128.11,-1697.83 42124.61,-1687.83 42121.11,-1697.83 42128.11,-1697.83"/>
</g>
<!-- m59_mha -->
<g id="node706" class="node">
<title>m59_mha</title>
<ellipse fill="lightblue" stroke="black" cx="42124.61" cy="-1549.47" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="42124.61" y="-1553.27" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="42124.61" y="-1538.27" font-family="Times,serif" font-size="14.00">GPU: 3771</text>
</g>
<!-- m59_qkv&#45;&gt;m59_mha -->
<g id="edge912" class="edge">
<title>m59_qkv&#45;&gt;m59_mha</title>
<path fill="none" stroke="black" d="M42124.61,-1634C42124.61,-1619.92 42124.61,-1602.29 42124.61,-1586.87"/>
<polygon fill="black" stroke="black" points="42128.11,-1586.6 42124.61,-1576.6 42121.11,-1586.6 42128.11,-1586.6"/>
</g>
<!-- m59_out -->
<g id="node707" class="node">
<title>m59_out</title>
<ellipse fill="lightblue" stroke="black" cx="42124.61" cy="-1448.6" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="42124.61" y="-1452.4" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="42124.61" y="-1437.4" font-family="Times,serif" font-size="14.00">GPU: 3771</text>
</g>
<!-- m59_mha&#45;&gt;m59_out -->
<g id="edge913" class="edge">
<title>m59_mha&#45;&gt;m59_out</title>
<path fill="none" stroke="black" d="M42124.61,-1522.49C42124.61,-1511.34 42124.61,-1498.11 42124.61,-1486.01"/>
<polygon fill="black" stroke="black" points="42128.11,-1485.74 42124.61,-1475.74 42121.11,-1485.74 42128.11,-1485.74"/>
</g>
<!-- m59_out&#45;&gt;m59_res1 -->
<g id="edge914" class="edge">
<title>m59_out&#45;&gt;m59_res1</title>
<path fill="none" stroke="black" d="M42092.55,-1422.92C42079.23,-1412.67 42063.64,-1400.67 42049.66,-1389.91"/>
<polygon fill="black" stroke="black" points="42051.7,-1387.07 42041.64,-1383.74 42047.43,-1392.61 42051.7,-1387.07"/>
</g>
<!-- m59_gate -->
<g id="node709" class="node">
<title>m59_gate</title>
<polygon fill="orange" stroke="black" points="41982.23,-1295.99 41777.63,-1295.99 41725,-1189.99 41929.59,-1189.99 41982.23,-1295.99"/>
<text text-anchor="middle" x="41853.61" y="-1254.29" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="41853.61" y="-1239.29" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="41853.61" y="-1224.29" font-family="Times,serif" font-size="14.00">GPU: 3771</text>
</g>
<!-- m59_res1&#45;&gt;m59_gate -->
<g id="edge916" class="edge">
<title>m59_res1&#45;&gt;m59_gate</title>
<path fill="none" stroke="black" d="M41978.08,-1334.26C41965.08,-1324.83 41949.48,-1313.52 41933.79,-1302.14"/>
<polygon fill="black" stroke="black" points="41935.74,-1299.23 41925.59,-1296.19 41931.63,-1304.9 41935.74,-1299.23"/>
</g>
<!-- m59_route -->
<g id="node710" class="node">
<title>m59_route</title>
<ellipse fill="lightgray" stroke="black" cx="41853.61" cy="-1116.51" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="41853.61" y="-1127.81" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="41853.61" y="-1112.81" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="41853.61" y="-1097.81" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m59_res1&#45;&gt;m59_route -->
<g id="edge918" class="edge">
<title>m59_res1&#45;&gt;m59_route</title>
<path fill="none" stroke="black" d="M42014.67,-1332.01C42018.79,-1296.68 42020.92,-1232.84 41991.61,-1189.99 41978.5,-1170.82 41958.68,-1156.36 41938.11,-1145.61"/>
<polygon fill="black" stroke="black" points="41939.47,-1142.37 41928.95,-1141.07 41936.36,-1148.65 41939.47,-1142.37"/>
</g>
<!-- m59_final -->
<g id="node715" class="node">
<title>m59_final</title>
<ellipse fill="lightpink" stroke="black" cx="42426.61" cy="-793.21" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="42426.61" y="-797.01" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="42426.61" y="-782.01" font-family="Times,serif" font-size="14.00">GPU: 3771</text>
</g>
<!-- m59_res1&#45;&gt;m59_final -->
<g id="edge926" class="edge">
<title>m59_res1&#45;&gt;m59_final</title>
<path fill="none" stroke="black" d="M42086.71,-1353.19C42220.21,-1340.43 42482.61,-1293.03 42482.61,-1117.51 42482.61,-1117.51 42482.61,-1117.51 42482.61,-1004.56 42482.61,-941.23 42458.62,-870.69 42442.04,-829.5"/>
<polygon fill="black" stroke="black" points="42445.25,-828.1 42438.22,-820.18 42438.78,-830.76 42445.25,-828.1"/>
</g>
<!-- m59_gate&#45;&gt;m59_route -->
<g id="edge917" class="edge">
<title>m59_gate&#45;&gt;m59_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41853.61,-1189.92C41853.61,-1181.49 41853.61,-1172.8 41853.61,-1164.5"/>
<polygon fill="black" stroke="black" points="41857.11,-1164.24 41853.61,-1154.24 41850.11,-1164.24 41857.11,-1164.24"/>
</g>
<!-- m59_expert0 -->
<g id="node711" class="node">
<title>m59_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="40936.61" cy="-1005.56" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="40936.61" y="-1016.86" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="40936.61" y="-1001.86" font-family="Times,serif" font-size="14.00">Node 448 GPU 0</text>
<text text-anchor="middle" x="40936.61" y="-986.86" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m59_route&#45;&gt;m59_expert0 -->
<g id="edge919" class="edge">
<title>m59_route&#45;&gt;m59_expert0</title>
<path fill="none" stroke="black" d="M41759.15,-1104.32C41639.09,-1090.1 41425.46,-1064.78 41242.61,-1043.03 41215.41,-1039.8 41186.84,-1036.4 41158.54,-1033.03"/>
<polygon fill="black" stroke="black" points="41158.89,-1029.54 41148.55,-1031.84 41158.06,-1036.5 41158.89,-1029.54"/>
</g>
<!-- m59_expert1 -->
<g id="node712" class="node">
<title>m59_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="41547.61" cy="-1005.56" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="41547.61" y="-1016.86" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="41547.61" y="-1001.86" font-family="Times,serif" font-size="14.00">Node 448 GPU 1</text>
<text text-anchor="middle" x="41547.61" y="-986.86" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m59_route&#45;&gt;m59_expert1 -->
<g id="edge921" class="edge">
<title>m59_route&#45;&gt;m59_expert1</title>
<path fill="none" stroke="black" d="M41782.26,-1090.1C41744.08,-1076.51 41696.32,-1059.51 41653.87,-1044.39"/>
<polygon fill="black" stroke="black" points="41654.93,-1041.05 41644.33,-1041 41652.58,-1047.65 41654.93,-1041.05"/>
</g>
<!-- m59_expert2 -->
<g id="node713" class="node">
<title>m59_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="42158.61" cy="-1005.56" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="42158.61" y="-1016.86" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="42158.61" y="-1001.86" font-family="Times,serif" font-size="14.00">Node 448 GPU 2</text>
<text text-anchor="middle" x="42158.61" y="-986.86" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m59_route&#45;&gt;m59_expert2 -->
<g id="edge923" class="edge">
<title>m59_route&#45;&gt;m59_expert2</title>
<path fill="none" stroke="black" d="M41924.74,-1090.1C41962.78,-1076.51 42010.39,-1059.51 42052.7,-1044.39"/>
<polygon fill="black" stroke="black" points="42053.97,-1047.66 42062.21,-1041 42051.61,-1041.06 42053.97,-1047.66"/>
</g>
<!-- m59_agg -->
<g id="node714" class="node">
<title>m59_agg</title>
<polygon fill="purple" stroke="black" points="42017.23,-932.08 41756.95,-932.08 41690,-856.08 41950.27,-856.08 42017.23,-932.08"/>
<text text-anchor="middle" x="41853.61" y="-897.88" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="41853.61" y="-882.88" font-family="Times,serif" font-size="14.00">GPU: 3771</text>
</g>
<!-- m59_expert0&#45;&gt;m59_agg -->
<g id="edge920" class="edge">
<title>m59_expert0&#45;&gt;m59_agg</title>
<path fill="none" stroke="black" d="M41148.14,-979.3C41326.91,-957.96 41577.08,-928.09 41726.48,-910.26"/>
<polygon fill="black" stroke="black" points="41727.1,-913.71 41736.62,-909.05 41726.27,-906.76 41727.1,-913.71"/>
</g>
<!-- m59_expert1&#45;&gt;m59_agg -->
<g id="edge922" class="edge">
<title>m59_expert1&#45;&gt;m59_agg</title>
<path fill="none" stroke="black" d="M41644.01,-970.07C41676.3,-958.52 41712.5,-945.56 41745.62,-933.72"/>
<polygon fill="black" stroke="black" points="41747.09,-936.91 41755.33,-930.24 41744.73,-930.32 41747.09,-936.91"/>
</g>
<!-- m59_expert2&#45;&gt;m59_agg -->
<g id="edge924" class="edge">
<title>m59_expert2&#45;&gt;m59_agg</title>
<path fill="none" stroke="black" d="M42062.53,-970.07C42032.07,-959.13 41998.11,-946.95 41966.57,-935.63"/>
<polygon fill="black" stroke="black" points="41967.47,-932.23 41956.87,-932.14 41965.1,-938.82 41967.47,-932.23"/>
</g>
<!-- m59_agg&#45;&gt;m59_final -->
<g id="edge925" class="edge">
<title>m59_agg&#45;&gt;m59_final</title>
<path fill="none" stroke="black" d="M41966.13,-873.66C42072.17,-855.37 42229.36,-828.24 42329.9,-810.9"/>
<polygon fill="black" stroke="black" points="42330.79,-814.3 42340.05,-809.15 42329.6,-807.4 42330.79,-814.3"/>
</g>
<!-- m60_res1 -->
<g id="node720" class="node">
<title>m60_res1</title>
<ellipse fill="lightpink" stroke="black" cx="42539.61" cy="-703.47" rx="77.56" ry="26.74"/>
<text text-anchor="middle" x="42539.61" y="-707.27" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="42539.61" y="-692.27" font-family="Times,serif" font-size="14.00">GPU: 3772</text>
</g>
<!-- m59_final&#45;&gt;m60_res1 -->
<g id="edge931" class="edge">
<title>m59_final&#45;&gt;m60_res1</title>
<path fill="none" stroke="black" d="M42458.39,-767.54C42471.6,-757.28 42487.05,-745.29 42500.9,-734.52"/>
<polygon fill="black" stroke="black" points="42503.1,-737.25 42508.85,-728.35 42498.81,-731.72 42503.1,-737.25"/>
</g>
<!-- m60_ln1 -->
<g id="node716" class="node">
<title>m60_ln1</title>
<ellipse fill="lightyellow" stroke="black" cx="42653.61" cy="-1116.51" rx="69.09" ry="26.74"/>
<text text-anchor="middle" x="42653.61" y="-1120.31" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="42653.61" y="-1105.31" font-family="Times,serif" font-size="14.00">GPU: 3772</text>
</g>
<!-- m60_qkv -->
<g id="node717" class="node">
<title>m60_qkv</title>
<ellipse fill="lightblue" stroke="black" cx="42653.61" cy="-1005.56" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="42653.61" y="-1009.36" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="42653.61" y="-994.36" font-family="Times,serif" font-size="14.00">GPU: 3772</text>
</g>
<!-- m60_ln1&#45;&gt;m60_qkv -->
<g id="edge927" class="edge">
<title>m60_ln1&#45;&gt;m60_qkv</title>
<path fill="none" stroke="black" d="M42653.61,-1089.41C42653.61,-1075.4 42653.61,-1057.91 42653.61,-1042.61"/>
<polygon fill="black" stroke="black" points="42657.11,-1042.44 42653.61,-1032.44 42650.11,-1042.44 42657.11,-1042.44"/>
</g>
<!-- m60_mha -->
<g id="node718" class="node">
<title>m60_mha</title>
<ellipse fill="lightblue" stroke="black" cx="42653.61" cy="-894.08" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="42653.61" y="-897.88" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="42653.61" y="-882.88" font-family="Times,serif" font-size="14.00">GPU: 3772</text>
</g>
<!-- m60_qkv&#45;&gt;m60_mha -->
<g id="edge928" class="edge">
<title>m60_qkv&#45;&gt;m60_mha</title>
<path fill="none" stroke="black" d="M42653.61,-978.61C42653.61,-964.54 42653.61,-946.91 42653.61,-931.48"/>
<polygon fill="black" stroke="black" points="42657.11,-931.22 42653.61,-921.22 42650.11,-931.22 42657.11,-931.22"/>
</g>
<!-- m60_out -->
<g id="node719" class="node">
<title>m60_out</title>
<ellipse fill="lightblue" stroke="black" cx="42653.61" cy="-793.21" rx="101.65" ry="26.74"/>
<text text-anchor="middle" x="42653.61" y="-797.01" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="42653.61" y="-782.01" font-family="Times,serif" font-size="14.00">GPU: 3772</text>
</g>
<!-- m60_mha&#45;&gt;m60_out -->
<g id="edge929" class="edge">
<title>m60_mha&#45;&gt;m60_out</title>
<path fill="none" stroke="black" d="M42653.61,-867.1C42653.61,-855.95 42653.61,-842.73 42653.61,-830.62"/>
<polygon fill="black" stroke="black" points="42657.11,-830.36 42653.61,-820.36 42650.11,-830.36 42657.11,-830.36"/>
</g>
<!-- m60_out&#45;&gt;m60_res1 -->
<g id="edge930" class="edge">
<title>m60_out&#45;&gt;m60_res1</title>
<path fill="none" stroke="black" d="M42621.55,-767.54C42608.23,-757.28 42592.64,-745.29 42578.66,-734.52"/>
<polygon fill="black" stroke="black" points="42580.7,-731.68 42570.64,-728.35 42576.43,-737.23 42580.7,-731.68"/>
</g>
<!-- m60_gate -->
<g id="node721" class="node">
<title>m60_gate</title>
<polygon fill="orange" stroke="black" points="42511.23,-640.6 42306.63,-640.6 42254,-534.6 42458.59,-534.6 42511.23,-640.6"/>
<text text-anchor="middle" x="42382.61" y="-598.9" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="42382.61" y="-583.9" font-family="Times,serif" font-size="14.00">Top&#45;2 selection</text>
<text text-anchor="middle" x="42382.61" y="-568.9" font-family="Times,serif" font-size="14.00">GPU: 3772</text>
</g>
<!-- m60_res1&#45;&gt;m60_gate -->
<g id="edge932" class="edge">
<title>m60_res1&#45;&gt;m60_gate</title>
<path fill="none" stroke="black" d="M42507.08,-678.88C42494.08,-669.45 42478.48,-658.13 42462.79,-646.75"/>
<polygon fill="black" stroke="black" points="42464.74,-643.84 42454.59,-640.8 42460.63,-649.51 42464.74,-643.84"/>
</g>
<!-- m60_route -->
<g id="node722" class="node">
<title>m60_route</title>
<ellipse fill="lightgray" stroke="black" cx="42382.61" cy="-461.12" rx="99.9" ry="37.45"/>
<text text-anchor="middle" x="42382.61" y="-472.42" font-family="Times,serif" font-size="14.00">Expert Router</text>
<text text-anchor="middle" x="42382.61" y="-457.42" font-family="Times,serif" font-size="14.00">Distribute tokens</text>
<text text-anchor="middle" x="42382.61" y="-442.42" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m60_res1&#45;&gt;m60_route -->
<g id="edge934" class="edge">
<title>m60_res1&#45;&gt;m60_route</title>
<path fill="none" stroke="black" d="M42543.67,-676.62C42547.79,-641.29 42549.92,-577.45 42520.61,-534.6 42507.5,-515.44 42487.68,-500.98 42467.11,-490.22"/>
<polygon fill="black" stroke="black" points="42468.47,-486.99 42457.95,-485.69 42465.36,-493.26 42468.47,-486.99"/>
</g>
<!-- m60_final -->
<g id="node727" class="node">
<title>m60_final</title>
<ellipse fill="lightpink" stroke="black" cx="42544.61" cy="-137.82" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="42544.61" y="-141.62" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="42544.61" y="-126.62" font-family="Times,serif" font-size="14.00">GPU: 3772</text>
</g>
<!-- m60_res1&#45;&gt;m60_final -->
<g id="edge942" class="edge">
<title>m60_res1&#45;&gt;m60_final</title>
<path fill="none" stroke="black" d="M42615.71,-697.8C42749.21,-685.04 43011.61,-637.65 43011.61,-462.12 43011.61,-462.12 43011.61,-462.12 43011.61,-349.17 43011.61,-195.62 42799.13,-153.51 42660.82,-142.37"/>
<polygon fill="black" stroke="black" points="42660.82,-138.86 42650.58,-141.59 42660.29,-145.84 42660.82,-138.86"/>
</g>
<!-- m60_gate&#45;&gt;m60_route -->
<g id="edge933" class="edge">
<title>m60_gate&#45;&gt;m60_route</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42382.61,-534.53C42382.61,-526.1 42382.61,-517.41 42382.61,-509.11"/>
<polygon fill="black" stroke="black" points="42386.11,-508.85 42382.61,-498.85 42379.11,-508.85 42386.11,-508.85"/>
</g>
<!-- m60_expert0 -->
<g id="node723" class="node">
<title>m60_expert0</title>
<ellipse fill="lightblue" stroke="black" cx="41465.61" cy="-350.17" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="41465.61" y="-361.47" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="41465.61" y="-346.47" font-family="Times,serif" font-size="14.00">Node 456 GPU 0</text>
<text text-anchor="middle" x="41465.61" y="-331.47" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m60_route&#45;&gt;m60_expert0 -->
<g id="edge935" class="edge">
<title>m60_route&#45;&gt;m60_expert0</title>
<path fill="none" stroke="black" d="M42288.15,-448.93C42168.09,-434.71 41954.46,-409.39 41771.61,-387.65 41744.41,-384.41 41715.84,-381.01 41687.54,-377.64"/>
<polygon fill="black" stroke="black" points="41687.89,-374.16 41677.55,-376.45 41687.06,-381.11 41687.89,-374.16"/>
</g>
<!-- m60_expert1 -->
<g id="node724" class="node">
<title>m60_expert1</title>
<ellipse fill="lightblue" stroke="black" cx="42076.61" cy="-350.17" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="42076.61" y="-361.47" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="42076.61" y="-346.47" font-family="Times,serif" font-size="14.00">Node 456 GPU 1</text>
<text text-anchor="middle" x="42076.61" y="-331.47" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m60_route&#45;&gt;m60_expert1 -->
<g id="edge937" class="edge">
<title>m60_route&#45;&gt;m60_expert1</title>
<path fill="none" stroke="black" d="M42311.26,-434.72C42273.08,-421.12 42225.32,-404.12 42182.87,-389"/>
<polygon fill="black" stroke="black" points="42183.93,-385.67 42173.33,-385.61 42181.58,-392.26 42183.93,-385.67"/>
</g>
<!-- m60_expert2 -->
<g id="node725" class="node">
<title>m60_expert2</title>
<ellipse fill="lightblue" stroke="black" cx="42687.61" cy="-350.17" rx="296.06" ry="37.45"/>
<text text-anchor="middle" x="42687.61" y="-361.47" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="42687.61" y="-346.47" font-family="Times,serif" font-size="14.00">Node 456 GPU 2</text>
<text text-anchor="middle" x="42687.61" y="-331.47" font-family="Times,serif" font-size="14.00">Input: batch_size=32, seq_len=2048, hidden_size=7168</text>
</g>
<!-- m60_route&#45;&gt;m60_expert2 -->
<g id="edge939" class="edge">
<title>m60_route&#45;&gt;m60_expert2</title>
<path fill="none" stroke="black" d="M42453.74,-434.72C42491.78,-421.12 42539.39,-404.12 42581.7,-389"/>
<polygon fill="black" stroke="black" points="42582.97,-392.27 42591.21,-385.61 42580.61,-385.68 42582.97,-392.27"/>
</g>
<!-- m60_agg -->
<g id="node726" class="node">
<title>m60_agg</title>
<polygon fill="purple" stroke="black" points="42546.23,-276.69 42285.95,-276.69 42219,-200.69 42479.27,-200.69 42546.23,-276.69"/>
<text text-anchor="middle" x="42382.61" y="-242.49" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="42382.61" y="-227.49" font-family="Times,serif" font-size="14.00">GPU: 3772</text>
</g>
<!-- m60_expert0&#45;&gt;m60_agg -->
<g id="edge936" class="edge">
<title>m60_expert0&#45;&gt;m60_agg</title>
<path fill="none" stroke="black" d="M41677.14,-323.92C41855.91,-302.57 42106.08,-272.71 42255.48,-254.87"/>
<polygon fill="black" stroke="black" points="42256.1,-258.32 42265.62,-253.66 42255.27,-251.37 42256.1,-258.32"/>
</g>
<!-- m60_expert1&#45;&gt;m60_agg -->
<g id="edge938" class="edge">
<title>m60_expert1&#45;&gt;m60_agg</title>
<path fill="none" stroke="black" d="M42173.01,-314.68C42205.3,-303.13 42241.5,-290.18 42274.62,-278.33"/>
<polygon fill="black" stroke="black" points="42276.09,-281.52 42284.33,-274.86 42273.73,-274.93 42276.09,-281.52"/>
</g>
<!-- m60_expert2&#45;&gt;m60_agg -->
<g id="edge940" class="edge">
<title>m60_expert2&#45;&gt;m60_agg</title>
<path fill="none" stroke="black" d="M42591.53,-314.68C42561.07,-303.75 42527.11,-291.56 42495.57,-280.24"/>
<polygon fill="black" stroke="black" points="42496.47,-276.84 42485.87,-276.76 42494.1,-283.43 42496.47,-276.84"/>
</g>
<!-- m60_agg&#45;&gt;m60_final -->
<g id="edge941" class="edge">
<title>m60_agg&#45;&gt;m60_final</title>
<path fill="none" stroke="black" d="M42443.4,-200.6C42460.82,-189.96 42479.58,-178.52 42496.15,-168.4"/>
<polygon fill="black" stroke="black" points="42498.4,-171.13 42505.11,-162.93 42494.75,-165.15 42498.4,-171.13"/>
</g>
<!-- output -->
<g id="node728" class="node">
<title>output</title>
<ellipse fill="lightcoral" stroke="black" cx="42544.61" cy="-37.48" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="42544.61" y="-48.78" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="42544.61" y="-33.78" font-family="Times,serif" font-size="14.00">batch_size=32, seq_len=2048, hidden_size=7168</text>
<text text-anchor="middle" x="42544.61" y="-18.78" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- m60_final&#45;&gt;output -->
<g id="edge943" class="edge">
<title>m60_final&#45;&gt;output</title>
<path fill="none" stroke="black" d="M42544.61,-110.73C42544.61,-102.87 42544.61,-94.01 42544.61,-85.24"/>
<polygon fill="black" stroke="black" points="42548.11,-85.06 42544.61,-75.06 42541.11,-85.06 42548.11,-85.06"/>
</g>
</g>
</svg>
