// Layer 10
digraph {
	rankdir=TB size="50,100"
	input [label="Input\nbatch_size=32, seq_len=2048, hidden_size=7168\nGPU: 3712"]
	ln1 [label="LayerNorm\nGPU: 3712"]
	qkv [label="QKV Projection\nGPU: 3712"]
	attn [label="MHA Attention\nGPU: 3712"]
	out [label="Output Projection\nGPU: 3712"]
	res1 [label="Residual Add\nGPU: 3712"]
	gate [label="Expert Gate\nGPU: 3712" shape=parallelogram]
	route [label="Expert Router\nGPU: All" shape=ellipse]
	expert0 [label="Expert 0\nGPU: 448"]
	expert1 [label="Expert 1\nGPU: 449"]
	expert2 [label="Expert 2\nGPU: 450"]
	expert3 [label="Expert 3\nGPU: 451"]
	expert4 [label="Expert 4\nGPU: 452"]
	expert5 [label="Expert 5\nGPU: 453"]
	expert6 [label="Expert 6\nGPU: 454"]
	expert7 [label="Expert 7\nGPU: 455"]
	expert8 [label="Expert 8\nGPU: 456"]
	expert9 [label="Expert 9\nGPU: 457"]
	expert10 [label="Expert 10\nGPU: 458"]
	expert11 [label="Expert 11\nGPU: 459"]
	expert12 [label="Expert 12\nGPU: 460"]
	expert13 [label="Expert 13\nGPU: 461"]
	expert14 [label="Expert 14\nGPU: 462"]
	expert15 [label="Expert 15\nGPU: 463"]
	expert16 [label="Expert 16\nGPU: 464"]
	expert17 [label="Expert 17\nGPU: 465"]
	expert18 [label="Expert 18\nGPU: 466"]
	expert19 [label="Expert 19\nGPU: 467"]
	expert20 [label="Expert 20\nGPU: 468"]
	expert21 [label="Expert 21\nGPU: 469"]
	expert22 [label="Expert 22\nGPU: 470"]
	expert23 [label="Expert 23\nGPU: 471"]
	expert24 [label="Expert 24\nGPU: 472"]
	expert25 [label="Expert 25\nGPU: 473"]
	expert26 [label="Expert 26\nGPU: 474"]
	expert27 [label="Expert 27\nGPU: 475"]
	expert28 [label="Expert 28\nGPU: 476"]
	expert29 [label="Expert 29\nGPU: 477"]
	expert30 [label="Expert 30\nGPU: 478"]
	expert31 [label="Expert 31\nGPU: 479"]
	expert32 [label="Expert 32\nGPU: 480"]
	expert33 [label="Expert 33\nGPU: 481"]
	expert34 [label="Expert 34\nGPU: 482"]
	expert35 [label="Expert 35\nGPU: 483"]
	expert36 [label="Expert 36\nGPU: 484"]
	expert37 [label="Expert 37\nGPU: 485"]
	expert38 [label="Expert 38\nGPU: 486"]
	expert39 [label="Expert 39\nGPU: 487"]
	expert40 [label="Expert 40\nGPU: 488"]
	expert41 [label="Expert 41\nGPU: 489"]
	expert42 [label="Expert 42\nGPU: 490"]
	expert43 [label="Expert 43\nGPU: 491"]
	expert44 [label="Expert 44\nGPU: 492"]
	expert45 [label="Expert 45\nGPU: 493"]
	expert46 [label="Expert 46\nGPU: 494"]
	expert47 [label="Expert 47\nGPU: 495"]
	expert48 [label="Expert 48\nGPU: 496"]
	expert49 [label="Expert 49\nGPU: 497"]
	expert50 [label="Expert 50\nGPU: 498"]
	expert51 [label="Expert 51\nGPU: 499"]
	expert52 [label="Expert 52\nGPU: 500"]
	expert53 [label="Expert 53\nGPU: 501"]
	expert54 [label="Expert 54\nGPU: 502"]
	expert55 [label="Expert 55\nGPU: 503"]
	expert56 [label="Expert 56\nGPU: 504"]
	expert57 [label="Expert 57\nGPU: 505"]
	expert58 [label="Expert 58\nGPU: 506"]
	expert59 [label="Expert 59\nGPU: 507"]
	expert60 [label="Expert 60\nGPU: 508"]
	expert61 [label="Expert 61\nGPU: 509"]
	expert62 [label="Expert 62\nGPU: 510"]
	expert63 [label="Expert 63\nGPU: 511"]
	agg [label="Expert Aggregation\nGPU: 3712" shape=parallelogram]
	final [label="Final Residual Add\nGPU: 3712"]
	input -> ln1
	ln1 -> qkv
	qkv -> attn
	attn -> out
	out -> res1
	input -> res1
	res1 -> gate
	gate -> route [style=dashed]
	res1 -> route
	route -> expert0
	expert0 -> agg
	route -> expert1
	expert1 -> agg
	route -> expert2
	expert2 -> agg
	route -> expert3
	expert3 -> agg
	route -> expert4
	expert4 -> agg
	route -> expert5
	expert5 -> agg
	route -> expert6
	expert6 -> agg
	route -> expert7
	expert7 -> agg
	route -> expert8
	expert8 -> agg
	route -> expert9
	expert9 -> agg
	route -> expert10
	expert10 -> agg
	route -> expert11
	expert11 -> agg
	route -> expert12
	expert12 -> agg
	route -> expert13
	expert13 -> agg
	route -> expert14
	expert14 -> agg
	route -> expert15
	expert15 -> agg
	route -> expert16
	expert16 -> agg
	route -> expert17
	expert17 -> agg
	route -> expert18
	expert18 -> agg
	route -> expert19
	expert19 -> agg
	route -> expert20
	expert20 -> agg
	route -> expert21
	expert21 -> agg
	route -> expert22
	expert22 -> agg
	route -> expert23
	expert23 -> agg
	route -> expert24
	expert24 -> agg
	route -> expert25
	expert25 -> agg
	route -> expert26
	expert26 -> agg
	route -> expert27
	expert27 -> agg
	route -> expert28
	expert28 -> agg
	route -> expert29
	expert29 -> agg
	route -> expert30
	expert30 -> agg
	route -> expert31
	expert31 -> agg
	route -> expert32
	expert32 -> agg
	route -> expert33
	expert33 -> agg
	route -> expert34
	expert34 -> agg
	route -> expert35
	expert35 -> agg
	route -> expert36
	expert36 -> agg
	route -> expert37
	expert37 -> agg
	route -> expert38
	expert38 -> agg
	route -> expert39
	expert39 -> agg
	route -> expert40
	expert40 -> agg
	route -> expert41
	expert41 -> agg
	route -> expert42
	expert42 -> agg
	route -> expert43
	expert43 -> agg
	route -> expert44
	expert44 -> agg
	route -> expert45
	expert45 -> agg
	route -> expert46
	expert46 -> agg
	route -> expert47
	expert47 -> agg
	route -> expert48
	expert48 -> agg
	route -> expert49
	expert49 -> agg
	route -> expert50
	expert50 -> agg
	route -> expert51
	expert51 -> agg
	route -> expert52
	expert52 -> agg
	route -> expert53
	expert53 -> agg
	route -> expert54
	expert54 -> agg
	route -> expert55
	expert55 -> agg
	route -> expert56
	expert56 -> agg
	route -> expert57
	expert57 -> agg
	route -> expert58
	expert58 -> agg
	route -> expert59
	expert59 -> agg
	route -> expert60
	expert60 -> agg
	route -> expert61
	expert61 -> agg
	route -> expert62
	expert62 -> agg
	route -> expert63
	expert63 -> agg
	agg -> final
	res1 -> final
}
