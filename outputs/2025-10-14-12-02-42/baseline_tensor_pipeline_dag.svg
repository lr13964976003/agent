<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tensor_pipeline Pages: 1 -->
<svg width="18113pt" height="1926pt"
 viewBox="0.00 0.00 18113.00 1925.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1921.71)">
<title>baseline_tensor_pipeline</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1921.71 18109,-1921.71 18109,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-8 8,-1813.55 11670,-1813.55 11670,-8 8,-8"/>
<text text-anchor="middle" x="5839" y="-1798.35" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;7)</text>
<text text-anchor="middle" x="5839" y="-1783.35" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="11720,-1280.17 11720,-1470.17 18097,-1470.17 18097,-1280.17 11720,-1280.17"/>
<text text-anchor="middle" x="14908.5" y="-1454.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 8&#45;15)</text>
<text text-anchor="middle" x="14908.5" y="-1439.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="none" stroke="black" cx="5596" cy="-1869.63" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="5596" y="-1888.43" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="5596" y="-1873.43" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5596" y="-1858.43" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5596" y="-1843.43" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_QKV_Split -->
<g id="node2" class="node">
<title>Layer0_QKV_Split</title>
<polygon fill="none" stroke="black" points="6081.4,-1767.55 5309.24,-1767.55 5110.6,-1631.55 5882.76,-1631.55 6081.4,-1767.55"/>
<text text-anchor="middle" x="5596" y="-1718.35" font-family="Times,serif" font-size="14.00">Split</text>
<text text-anchor="middle" x="5596" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5596" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5596" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Input&#45;&gt;Layer0_QKV_Split -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;Layer0_QKV_Split</title>
<path fill="none" stroke="black" d="M5596,-1821.36C5596,-1807.87 5596,-1792.81 5596,-1778.01"/>
<polygon fill="black" stroke="black" points="5599.5,-1777.84 5596,-1767.84 5592.5,-1777.84 5599.5,-1777.84"/>
</g>
<!-- Layer0_Q_Linear0 -->
<g id="node3" class="node">
<title>Layer0_Q_Linear0</title>
<polygon fill="none" stroke="black" points="484,-1570.86 16,-1570.86 16,-1502.86 484,-1502.86 484,-1570.86"/>
<text text-anchor="middle" x="250" y="-1555.66" font-family="Times,serif" font-size="14.00">Q Linear 0</text>
<text text-anchor="middle" x="250" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="250" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="250" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear0 -->
<g id="edge2" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear0</title>
<path fill="none" stroke="black" d="M5203.63,-1695.44C4088.98,-1685.93 954.21,-1654.27 493,-1595.55 454.8,-1590.68 413.86,-1582.25 376.67,-1573.31"/>
<polygon fill="black" stroke="black" points="377.34,-1569.87 366.8,-1570.9 375.69,-1576.67 377.34,-1569.87"/>
</g>
<!-- Layer0_Q_Linear1 -->
<g id="node4" class="node">
<title>Layer0_Q_Linear1</title>
<polygon fill="none" stroke="black" points="970,-1570.86 502,-1570.86 502,-1502.86 970,-1502.86 970,-1570.86"/>
<text text-anchor="middle" x="736" y="-1555.66" font-family="Times,serif" font-size="14.00">Q Linear 1</text>
<text text-anchor="middle" x="736" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="736" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="736" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear1 -->
<g id="edge3" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear1</title>
<path fill="none" stroke="black" d="M5202.31,-1694.52C4161.93,-1683.2 1391.03,-1648.45 979,-1595.55 940.9,-1590.65 900.07,-1582.24 862.97,-1573.33"/>
<polygon fill="black" stroke="black" points="863.66,-1569.89 853.11,-1570.93 862,-1576.69 863.66,-1569.89"/>
</g>
<!-- Layer0_Q_Linear2 -->
<g id="node5" class="node">
<title>Layer0_Q_Linear2</title>
<polygon fill="none" stroke="black" points="1456,-1570.86 988,-1570.86 988,-1502.86 1456,-1502.86 1456,-1570.86"/>
<text text-anchor="middle" x="1222" y="-1555.66" font-family="Times,serif" font-size="14.00">Q Linear 2</text>
<text text-anchor="middle" x="1222" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1222" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1222" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear2 -->
<g id="edge4" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear2</title>
<path fill="none" stroke="black" d="M5209.03,-1699.17C4325.52,-1698.93 2181.12,-1688.45 1465,-1595.55 1426.91,-1590.6 1386.08,-1582.18 1348.98,-1573.26"/>
<polygon fill="black" stroke="black" points="1349.67,-1569.83 1339.12,-1570.87 1348.01,-1576.63 1349.67,-1569.83"/>
</g>
<!-- Layer0_Q_Linear3 -->
<g id="node6" class="node">
<title>Layer0_Q_Linear3</title>
<polygon fill="none" stroke="black" points="1942,-1570.86 1474,-1570.86 1474,-1502.86 1942,-1502.86 1942,-1570.86"/>
<text text-anchor="middle" x="1708" y="-1555.66" font-family="Times,serif" font-size="14.00">Q Linear 3</text>
<text text-anchor="middle" x="1708" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1708" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="1708" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear3 -->
<g id="edge5" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear3</title>
<path fill="none" stroke="black" d="M5206.78,-1697.62C4400.26,-1694.05 2570.23,-1676.93 1951,-1595.55 1913.02,-1590.55 1872.31,-1582.14 1835.28,-1573.25"/>
<polygon fill="black" stroke="black" points="1835.98,-1569.82 1825.44,-1570.86 1834.33,-1576.62 1835.98,-1569.82"/>
</g>
<!-- Layer0_Q_Linear4 -->
<g id="node7" class="node">
<title>Layer0_Q_Linear4</title>
<polygon fill="none" stroke="black" points="2428,-1570.86 1960,-1570.86 1960,-1502.86 2428,-1502.86 2428,-1570.86"/>
<text text-anchor="middle" x="2194" y="-1555.66" font-family="Times,serif" font-size="14.00">Q Linear 4</text>
<text text-anchor="middle" x="2194" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2194" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2194" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear4 -->
<g id="edge6" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear4</title>
<path fill="none" stroke="black" d="M5203.84,-1695.57C4479.94,-1688.45 2959.99,-1665.43 2437,-1595.55 2399.22,-1590.5 2358.74,-1582.12 2321.87,-1573.28"/>
<polygon fill="black" stroke="black" points="2322.61,-1569.86 2312.07,-1570.91 2320.96,-1576.67 2322.61,-1569.86"/>
</g>
<!-- Layer0_Q_Linear5 -->
<g id="node8" class="node">
<title>Layer0_Q_Linear5</title>
<polygon fill="none" stroke="black" points="2914,-1570.86 2446,-1570.86 2446,-1502.86 2914,-1502.86 2914,-1570.86"/>
<text text-anchor="middle" x="2680" y="-1555.66" font-family="Times,serif" font-size="14.00">Q Linear 5</text>
<text text-anchor="middle" x="2680" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2680" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="2680" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear5 -->
<g id="edge7" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear5</title>
<path fill="none" stroke="black" d="M5199.8,-1692.74C4565.62,-1681.84 3350.49,-1653.96 2923,-1595.55 2885.44,-1590.41 2845.19,-1582.06 2808.46,-1573.28"/>
<polygon fill="black" stroke="black" points="2809.25,-1569.87 2798.71,-1570.92 2807.6,-1576.67 2809.25,-1569.87"/>
</g>
<!-- Layer0_Q_Linear6 -->
<g id="node9" class="node">
<title>Layer0_Q_Linear6</title>
<polygon fill="none" stroke="black" points="3400,-1570.86 2932,-1570.86 2932,-1502.86 3400,-1502.86 3400,-1570.86"/>
<text text-anchor="middle" x="3166" y="-1555.66" font-family="Times,serif" font-size="14.00">Q Linear 6</text>
<text text-anchor="middle" x="3166" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3166" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3166" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear6 -->
<g id="edge8" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear6</title>
<path fill="none" stroke="black" d="M5193.77,-1688.56C4658.77,-1673.73 3741.87,-1642.48 3409,-1595.55 3371.81,-1590.3 3331.98,-1582 3295.54,-1573.32"/>
<polygon fill="black" stroke="black" points="3295.9,-1569.8 3285.36,-1570.86 3294.26,-1576.61 3295.9,-1569.8"/>
</g>
<!-- Layer0_Q_Linear7 -->
<g id="node10" class="node">
<title>Layer0_Q_Linear7</title>
<polygon fill="none" stroke="black" points="3886,-1570.86 3418,-1570.86 3418,-1502.86 3886,-1502.86 3886,-1570.86"/>
<text text-anchor="middle" x="3652" y="-1555.66" font-family="Times,serif" font-size="14.00">Q Linear 7</text>
<text text-anchor="middle" x="3652" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3652" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="3652" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear7 -->
<g id="edge9" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_Q_Linear7</title>
<path fill="none" stroke="black" d="M5201.3,-1693.9C4855.27,-1685.26 4339.5,-1661.26 3895,-1595.55 3858.34,-1590.13 3819.08,-1581.9 3783.03,-1573.33"/>
<polygon fill="black" stroke="black" points="3783.49,-1569.85 3772.95,-1570.91 3781.86,-1576.65 3783.49,-1569.85"/>
</g>
<!-- Layer0_K_Linear0 -->
<g id="node11" class="node">
<title>Layer0_K_Linear0</title>
<polygon fill="none" stroke="black" points="4372,-1570.86 3904,-1570.86 3904,-1502.86 4372,-1502.86 4372,-1570.86"/>
<text text-anchor="middle" x="4138" y="-1555.66" font-family="Times,serif" font-size="14.00">K Linear 0</text>
<text text-anchor="middle" x="4138" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4138" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4138" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_K_Linear0 -->
<g id="edge10" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_K_Linear0</title>
<path fill="none" stroke="black" d="M5179.07,-1678.54C4943.71,-1663.42 4644.77,-1637.8 4381,-1595.55 4345.09,-1589.79 4306.63,-1581.62 4271.15,-1573.23"/>
<polygon fill="black" stroke="black" points="4271.76,-1569.78 4261.22,-1570.86 4270.14,-1576.58 4271.76,-1569.78"/>
</g>
<!-- Layer0_K_Linear1 -->
<g id="node12" class="node">
<title>Layer0_K_Linear1</title>
<polygon fill="none" stroke="black" points="4858,-1570.86 4390,-1570.86 4390,-1502.86 4858,-1502.86 4858,-1570.86"/>
<text text-anchor="middle" x="4624" y="-1555.66" font-family="Times,serif" font-size="14.00">K Linear 1</text>
<text text-anchor="middle" x="4624" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4624" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4624" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_K_Linear1 -->
<g id="edge11" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_K_Linear1</title>
<path fill="none" stroke="black" d="M5119.48,-1637.71C5035.15,-1625.09 4948.32,-1610.91 4867,-1595.55 4833.26,-1589.17 4797.15,-1581.22 4763.35,-1573.28"/>
<polygon fill="black" stroke="black" points="4763.95,-1569.83 4753.42,-1570.93 4762.34,-1576.64 4763.95,-1569.83"/>
</g>
<!-- Layer0_K_Linear2 -->
<g id="node13" class="node">
<title>Layer0_K_Linear2</title>
<polygon fill="none" stroke="black" points="5344,-1570.86 4876,-1570.86 4876,-1502.86 5344,-1502.86 5344,-1570.86"/>
<text text-anchor="middle" x="5110" y="-1555.66" font-family="Times,serif" font-size="14.00">K Linear 2</text>
<text text-anchor="middle" x="5110" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5110" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5110" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_K_Linear2 -->
<g id="edge12" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_K_Linear2</title>
<path fill="none" stroke="black" d="M5393.06,-1631.45C5333.64,-1611.8 5270.94,-1591.07 5219.69,-1574.12"/>
<polygon fill="black" stroke="black" points="5220.52,-1570.71 5209.92,-1570.9 5218.32,-1577.36 5220.52,-1570.71"/>
</g>
<!-- Layer0_K_Linear3 -->
<g id="node14" class="node">
<title>Layer0_K_Linear3</title>
<polygon fill="none" stroke="black" points="5830,-1570.86 5362,-1570.86 5362,-1502.86 5830,-1502.86 5830,-1570.86"/>
<text text-anchor="middle" x="5596" y="-1555.66" font-family="Times,serif" font-size="14.00">K Linear 3</text>
<text text-anchor="middle" x="5596" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5596" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5596" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_K_Linear3 -->
<g id="edge13" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_K_Linear3</title>
<path fill="none" stroke="black" d="M5596,-1631.33C5596,-1614.42 5596,-1596.71 5596,-1581.31"/>
<polygon fill="black" stroke="black" points="5599.5,-1581.06 5596,-1571.06 5592.5,-1581.06 5599.5,-1581.06"/>
</g>
<!-- Layer0_K_Linear4 -->
<g id="node15" class="node">
<title>Layer0_K_Linear4</title>
<polygon fill="none" stroke="black" points="6316,-1570.86 5848,-1570.86 5848,-1502.86 6316,-1502.86 6316,-1570.86"/>
<text text-anchor="middle" x="6082" y="-1555.66" font-family="Times,serif" font-size="14.00">K Linear 4</text>
<text text-anchor="middle" x="6082" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="6082" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="6082" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_K_Linear4 -->
<g id="edge14" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_K_Linear4</title>
<path fill="none" stroke="black" d="M5798.94,-1631.45C5858.36,-1611.8 5921.06,-1591.07 5972.31,-1574.12"/>
<polygon fill="black" stroke="black" points="5973.68,-1577.36 5982.08,-1570.9 5971.48,-1570.71 5973.68,-1577.36"/>
</g>
<!-- Layer0_K_Linear5 -->
<g id="node16" class="node">
<title>Layer0_K_Linear5</title>
<polygon fill="none" stroke="black" points="6802,-1570.86 6334,-1570.86 6334,-1502.86 6802,-1502.86 6802,-1570.86"/>
<text text-anchor="middle" x="6568" y="-1555.66" font-family="Times,serif" font-size="14.00">K Linear 5</text>
<text text-anchor="middle" x="6568" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="6568" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="6568" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_K_Linear5 -->
<g id="edge15" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_K_Linear5</title>
<path fill="none" stroke="black" d="M5916.76,-1654.62C6092.85,-1630.26 6283.75,-1603.34 6325,-1595.55 6358.74,-1589.17 6394.85,-1581.22 6428.65,-1573.28"/>
<polygon fill="black" stroke="black" points="6429.66,-1576.64 6438.58,-1570.93 6428.05,-1569.83 6429.66,-1576.64"/>
</g>
<!-- Layer0_K_Linear6 -->
<g id="node17" class="node">
<title>Layer0_K_Linear6</title>
<polygon fill="none" stroke="black" points="7288,-1570.86 6820,-1570.86 6820,-1502.86 7288,-1502.86 7288,-1570.86"/>
<text text-anchor="middle" x="7054" y="-1555.66" font-family="Times,serif" font-size="14.00">K Linear 6</text>
<text text-anchor="middle" x="7054" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7054" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7054" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_K_Linear6 -->
<g id="edge16" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_K_Linear6</title>
<path fill="none" stroke="black" d="M5912.42,-1651.66C5971.67,-1644.04 6033.14,-1636.9 6091,-1631.55 6410.04,-1602.03 6493.8,-1640.74 6811,-1595.55 6848.08,-1590.26 6887.8,-1581.98 6924.16,-1573.32"/>
<polygon fill="black" stroke="black" points="6925.42,-1576.61 6934.32,-1570.87 6923.78,-1569.81 6925.42,-1576.61"/>
</g>
<!-- Layer0_K_Linear7 -->
<g id="node18" class="node">
<title>Layer0_K_Linear7</title>
<polygon fill="none" stroke="black" points="7774,-1570.86 7306,-1570.86 7306,-1502.86 7774,-1502.86 7774,-1570.86"/>
<text text-anchor="middle" x="7540" y="-1555.66" font-family="Times,serif" font-size="14.00">K Linear 7</text>
<text text-anchor="middle" x="7540" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7540" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7540" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_K_Linear7 -->
<g id="edge17" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_K_Linear7</title>
<path fill="none" stroke="black" d="M5911.02,-1650.88C5970.67,-1643.28 6032.66,-1636.35 6091,-1631.55 6625.43,-1587.52 6765.39,-1665.84 7297,-1595.55 7334.88,-1590.54 7375.48,-1582.14 7412.43,-1573.28"/>
<polygon fill="black" stroke="black" points="7413.35,-1576.66 7422.25,-1570.9 7411.7,-1569.86 7413.35,-1576.66"/>
</g>
<!-- Layer0_V_Linear0 -->
<g id="node19" class="node">
<title>Layer0_V_Linear0</title>
<polygon fill="none" stroke="black" points="8260,-1570.86 7792,-1570.86 7792,-1502.86 8260,-1502.86 8260,-1570.86"/>
<text text-anchor="middle" x="8026" y="-1555.66" font-family="Times,serif" font-size="14.00">V Linear 0</text>
<text text-anchor="middle" x="8026" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8026" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8026" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_V_Linear0 -->
<g id="edge18" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_V_Linear0</title>
<path fill="none" stroke="black" d="M5910.65,-1650.52C5970.41,-1642.94 6032.53,-1636.11 6091,-1631.55 6465.94,-1602.28 7409.95,-1643.25 7783,-1595.55 7821.2,-1590.66 7862.14,-1582.22 7899.32,-1573.28"/>
<polygon fill="black" stroke="black" points="7900.31,-1576.65 7909.2,-1570.88 7898.65,-1569.84 7900.31,-1576.65"/>
</g>
<!-- Layer0_V_Linear1 -->
<g id="node20" class="node">
<title>Layer0_V_Linear1</title>
<polygon fill="none" stroke="black" points="8746,-1570.86 8278,-1570.86 8278,-1502.86 8746,-1502.86 8746,-1570.86"/>
<text text-anchor="middle" x="8512" y="-1555.66" font-family="Times,serif" font-size="14.00">V Linear 1</text>
<text text-anchor="middle" x="8512" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8512" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8512" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_V_Linear1 -->
<g id="edge19" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_V_Linear1</title>
<path fill="none" stroke="black" d="M5910.3,-1650.33C5970.17,-1642.76 6032.41,-1635.98 6091,-1631.55 6573.69,-1595.02 7788.7,-1655.81 8269,-1595.55 8307.31,-1590.74 8348.37,-1582.3 8385.63,-1573.33"/>
<polygon fill="black" stroke="black" points="8386.63,-1576.69 8395.52,-1570.92 8384.98,-1569.89 8386.63,-1576.69"/>
</g>
<!-- Layer0_V_Linear2 -->
<g id="node21" class="node">
<title>Layer0_V_Linear2</title>
<polygon fill="none" stroke="black" points="9232,-1570.86 8764,-1570.86 8764,-1502.86 9232,-1502.86 9232,-1570.86"/>
<text text-anchor="middle" x="8998" y="-1555.66" font-family="Times,serif" font-size="14.00">V Linear 2</text>
<text text-anchor="middle" x="8998" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8998" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8998" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_V_Linear2 -->
<g id="edge20" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_V_Linear2</title>
<path fill="none" stroke="black" d="M5910.29,-1650.19C5970.16,-1642.63 6032.41,-1635.89 6091,-1631.55 6681.43,-1587.76 8167.44,-1668.36 8755,-1595.55 8793.41,-1590.79 8834.59,-1582.33 8871.92,-1573.33"/>
<polygon fill="black" stroke="black" points="8872.95,-1576.69 8881.84,-1570.91 8871.29,-1569.89 8872.95,-1576.69"/>
</g>
<!-- Layer0_V_Linear3 -->
<g id="node22" class="node">
<title>Layer0_V_Linear3</title>
<polygon fill="none" stroke="black" points="9718,-1570.86 9250,-1570.86 9250,-1502.86 9718,-1502.86 9718,-1570.86"/>
<text text-anchor="middle" x="9484" y="-1555.66" font-family="Times,serif" font-size="14.00">V Linear 3</text>
<text text-anchor="middle" x="9484" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="9484" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="9484" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_V_Linear3 -->
<g id="edge21" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_V_Linear3</title>
<path fill="none" stroke="black" d="M5909.95,-1650.13C5969.92,-1642.56 6032.29,-1635.84 6091,-1631.55 6789.18,-1580.5 8546.18,-1680.92 9241,-1595.55 9279.52,-1590.81 9320.81,-1582.34 9358.22,-1573.32"/>
<polygon fill="black" stroke="black" points="9359.27,-1576.66 9368.15,-1570.89 9357.6,-1569.86 9359.27,-1576.66"/>
</g>
<!-- Layer0_V_Linear4 -->
<g id="node23" class="node">
<title>Layer0_V_Linear4</title>
<polygon fill="none" stroke="black" points="10204,-1570.86 9736,-1570.86 9736,-1502.86 10204,-1502.86 10204,-1570.86"/>
<text text-anchor="middle" x="9970" y="-1555.66" font-family="Times,serif" font-size="14.00">V Linear 4</text>
<text text-anchor="middle" x="9970" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="9970" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="9970" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_V_Linear4 -->
<g id="edge22" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_V_Linear4</title>
<path fill="none" stroke="black" d="M5909.95,-1650.06C5969.92,-1642.5 6032.29,-1635.79 6091,-1631.55 6493.97,-1602.39 9325.96,-1644.51 9727,-1595.55 9765.52,-1590.84 9806.81,-1582.38 9844.22,-1573.35"/>
<polygon fill="black" stroke="black" points="9845.27,-1576.7 9854.15,-1570.92 9843.61,-1569.9 9845.27,-1576.7"/>
</g>
<!-- Layer0_V_Linear5 -->
<g id="node24" class="node">
<title>Layer0_V_Linear5</title>
<polygon fill="none" stroke="black" points="10690,-1570.86 10222,-1570.86 10222,-1502.86 10690,-1502.86 10690,-1570.86"/>
<text text-anchor="middle" x="10456" y="-1555.66" font-family="Times,serif" font-size="14.00">V Linear 5</text>
<text text-anchor="middle" x="10456" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="10456" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="10456" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_V_Linear5 -->
<g id="edge23" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_V_Linear5</title>
<path fill="none" stroke="black" d="M5909.94,-1650C5969.91,-1642.45 6032.29,-1635.76 6091,-1631.55 6547.84,-1598.76 9758.33,-1650.79 10213,-1595.55 10251.62,-1590.85 10293.03,-1582.36 10330.51,-1573.31"/>
<polygon fill="black" stroke="black" points="10331.58,-1576.65 10340.47,-1570.88 10329.92,-1569.85 10331.58,-1576.65"/>
</g>
<!-- Layer0_V_Linear6 -->
<g id="node25" class="node">
<title>Layer0_V_Linear6</title>
<polygon fill="none" stroke="black" points="11176,-1570.86 10708,-1570.86 10708,-1502.86 11176,-1502.86 11176,-1570.86"/>
<text text-anchor="middle" x="10942" y="-1555.66" font-family="Times,serif" font-size="14.00">V Linear 6</text>
<text text-anchor="middle" x="10942" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="10942" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="10942" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_V_Linear6 -->
<g id="edge24" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_V_Linear6</title>
<path fill="none" stroke="black" d="M5909.94,-1649.96C5969.91,-1642.41 6032.29,-1635.73 6091,-1631.55 6601.72,-1595.13 10190.69,-1657.07 10699,-1595.55 10737.63,-1590.87 10779.03,-1582.39 10816.52,-1573.34"/>
<polygon fill="black" stroke="black" points="10817.59,-1576.68 10826.47,-1570.9 10815.92,-1569.88 10817.59,-1576.68"/>
</g>
<!-- Layer0_V_Linear7 -->
<g id="node26" class="node">
<title>Layer0_V_Linear7</title>
<polygon fill="none" stroke="black" points="11662,-1570.86 11194,-1570.86 11194,-1502.86 11662,-1502.86 11662,-1570.86"/>
<text text-anchor="middle" x="11428" y="-1555.66" font-family="Times,serif" font-size="14.00">V Linear 7</text>
<text text-anchor="middle" x="11428" y="-1540.66" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="11428" y="-1525.66" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="11428" y="-1510.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Layer0_QKV_Split&#45;&gt;Layer0_V_Linear7 -->
<g id="edge25" class="edge">
<title>Layer0_QKV_Split&#45;&gt;Layer0_V_Linear7</title>
<path fill="none" stroke="black" d="M5909.94,-1649.92C5969.91,-1642.38 6032.29,-1635.71 6091,-1631.55 6655.6,-1591.51 10623.06,-1663.35 11185,-1595.55 11223.63,-1590.89 11265.03,-1582.4 11302.52,-1573.35"/>
<polygon fill="black" stroke="black" points="11303.59,-1576.69 11312.47,-1570.92 11301.92,-1569.9 11303.59,-1576.69"/>
</g>
<!-- Layer0_QKV_AllGather -->
<g id="node27" class="node">
<title>Layer0_QKV_AllGather</title>
<polygon fill="none" stroke="black" points="6333.56,-1424.17 5546.82,-1424.17 5344.44,-1288.17 6131.18,-1288.17 6333.56,-1424.17"/>
<text text-anchor="middle" x="5839" y="-1374.97" font-family="Times,serif" font-size="14.00">All&#45;Gather</text>
<text text-anchor="middle" x="5839" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]×8</text>
<text text-anchor="middle" x="5839" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5839" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_Q_Linear0&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge26" class="edge">
<title>Layer0_Q_Linear0&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M367.11,-1502.79C406.76,-1493.01 451.5,-1483.5 493,-1478.17 978.19,-1415.79 4288.31,-1374.1 5442.79,-1361.32"/>
<polygon fill="black" stroke="black" points="5442.95,-1364.82 5452.91,-1361.21 5442.87,-1357.82 5442.95,-1364.82"/>
</g>
<!-- Layer0_Q_Linear1&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge27" class="edge">
<title>Layer0_Q_Linear1&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M853.12,-1502.85C892.76,-1493.07 937.51,-1483.55 979,-1478.17 1835.82,-1367.03 4430.6,-1356.26 5435.46,-1356.41"/>
<polygon fill="black" stroke="black" points="5435.74,-1359.91 5445.74,-1356.41 5435.74,-1352.91 5435.74,-1359.91"/>
</g>
<!-- Layer0_Q_Linear2&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge28" class="edge">
<title>Layer0_Q_Linear2&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M1339.44,-1502.84C1379.01,-1493.09 1423.62,-1483.59 1465,-1478.17 2225.43,-1378.46 4507.34,-1360.76 5437.61,-1357.74"/>
<polygon fill="black" stroke="black" points="5437.82,-1361.24 5447.81,-1357.7 5437.8,-1354.24 5437.82,-1361.24"/>
</g>
<!-- Layer0_Q_Linear3&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge29" class="edge">
<title>Layer0_Q_Linear3&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M1825.76,-1502.85C1865.25,-1493.13 1909.74,-1483.65 1951,-1478.17 2615.56,-1389.86 4587.86,-1365.75 5439.75,-1359.37"/>
<polygon fill="black" stroke="black" points="5440.06,-1362.87 5450.04,-1359.3 5440.01,-1355.87 5440.06,-1362.87"/>
</g>
<!-- Layer0_Q_Linear4&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge30" class="edge">
<title>Layer0_Q_Linear4&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M2312.39,-1502.8C2351.73,-1493.15 2395.96,-1483.71 2437,-1478.17 3006.62,-1401.19 4674.73,-1371.33 5443.13,-1361.43"/>
<polygon fill="black" stroke="black" points="5443.3,-1364.93 5453.25,-1361.3 5443.21,-1357.93 5443.3,-1364.93"/>
</g>
<!-- Layer0_Q_Linear5&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge31" class="edge">
<title>Layer0_Q_Linear5&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M2799.03,-1502.79C2838.21,-1493.2 2882.2,-1483.8 2923,-1478.17 3398.45,-1412.48 4767.21,-1377.75 5446.7,-1364.13"/>
<polygon fill="black" stroke="black" points="5446.97,-1367.62 5456.9,-1363.93 5446.83,-1360.63 5446.97,-1367.62"/>
</g>
<!-- Layer0_Q_Linear6&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge32" class="edge">
<title>Layer0_Q_Linear6&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M3285.68,-1502.84C3324.7,-1493.31 3368.43,-1483.94 3409,-1478.17 3791.6,-1423.69 4868.77,-1385.27 5452.1,-1367.79"/>
<polygon fill="black" stroke="black" points="5452.47,-1371.28 5462.36,-1367.48 5452.26,-1364.28 5452.47,-1371.28"/>
</g>
<!-- Layer0_Q_Linear7&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge33" class="edge">
<title>Layer0_Q_Linear7&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M3772.96,-1502.84C3811.68,-1493.43 3854.9,-1484.13 3895,-1478.17 4427.45,-1398.99 5049.42,-1371.49 5443.68,-1362.02"/>
<polygon fill="black" stroke="black" points="5443.91,-1365.52 5453.82,-1361.78 5443.74,-1358.52 5443.91,-1365.52"/>
</g>
<!-- Layer0_K_Linear0&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge34" class="edge">
<title>Layer0_K_Linear0&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M4261.22,-1502.81C4299.37,-1493.61 4341.71,-1484.42 4381,-1478.17 4744.81,-1420.22 5164.39,-1389.1 5459.76,-1373"/>
<polygon fill="black" stroke="black" points="5459.98,-1376.49 5469.77,-1372.46 5459.6,-1369.5 5459.98,-1376.49"/>
</g>
<!-- Layer0_K_Linear1&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge35" class="edge">
<title>Layer0_K_Linear1&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M4751.45,-1502.83C4788.54,-1493.98 4829.24,-1484.98 4867,-1478.17 5071.07,-1441.35 5301.28,-1412.16 5486.42,-1391.67"/>
<polygon fill="black" stroke="black" points="5487.03,-1395.13 5496.59,-1390.55 5486.27,-1388.17 5487.03,-1395.13"/>
</g>
<!-- Layer0_K_Linear2&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge36" class="edge">
<title>Layer0_K_Linear2&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M5244.98,-1502.77C5332.09,-1481.42 5448.69,-1452.84 5555.5,-1426.66"/>
<polygon fill="black" stroke="black" points="5556.6,-1429.99 5565.48,-1424.21 5554.93,-1423.19 5556.6,-1429.99"/>
</g>
<!-- Layer0_K_Linear3&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge37" class="edge">
<title>Layer0_K_Linear3&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M5641.14,-1502.66C5668.84,-1482.3 5705.44,-1455.38 5739.63,-1430.24"/>
<polygon fill="black" stroke="black" points="5741.82,-1432.97 5747.8,-1424.23 5737.67,-1427.33 5741.82,-1432.97"/>
</g>
<!-- Layer0_K_Linear4&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge38" class="edge">
<title>Layer0_K_Linear4&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M6036.86,-1502.66C6009.16,-1482.3 5972.56,-1455.38 5938.37,-1430.24"/>
<polygon fill="black" stroke="black" points="5940.33,-1427.33 5930.2,-1424.23 5936.18,-1432.97 5940.33,-1427.33"/>
</g>
<!-- Layer0_K_Linear5&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge39" class="edge">
<title>Layer0_K_Linear5&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M6433.02,-1502.77C6345.91,-1481.42 6229.31,-1452.84 6122.5,-1426.66"/>
<polygon fill="black" stroke="black" points="6123.07,-1423.19 6112.52,-1424.21 6121.4,-1429.99 6123.07,-1423.19"/>
</g>
<!-- Layer0_K_Linear6&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge40" class="edge">
<title>Layer0_K_Linear6&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M6926.55,-1502.83C6889.46,-1493.98 6848.76,-1484.98 6811,-1478.17 6650.31,-1449.18 6473.43,-1424.92 6315.1,-1405.91"/>
<polygon fill="black" stroke="black" points="6315.04,-1402.38 6304.7,-1404.67 6314.21,-1409.33 6315.04,-1402.38"/>
</g>
<!-- Layer0_K_Linear7&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge41" class="edge">
<title>Layer0_K_Linear7&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M7416.78,-1502.81C7378.63,-1493.61 7336.29,-1484.42 7297,-1478.17 6954.6,-1423.63 6562.79,-1392.85 6271.63,-1376"/>
<polygon fill="black" stroke="black" points="6271.5,-1372.49 6261.32,-1375.4 6271.1,-1379.47 6271.5,-1372.49"/>
</g>
<!-- Layer0_V_Linear0&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge42" class="edge">
<title>Layer0_V_Linear0&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M7905.04,-1502.84C7866.32,-1493.43 7823.1,-1484.13 7783,-1478.17 7258.42,-1400.16 6646.96,-1372.32 6251.96,-1362.45"/>
<polygon fill="black" stroke="black" points="6251.88,-1358.95 6241.8,-1362.2 6251.71,-1365.95 6251.88,-1358.95"/>
</g>
<!-- Layer0_V_Linear1&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge43" class="edge">
<title>Layer0_V_Linear1&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M8392.32,-1502.84C8353.3,-1493.31 8309.57,-1483.94 8269,-1478.17 7894,-1424.78 6851.75,-1386.81 6261.24,-1368.85"/>
<polygon fill="black" stroke="black" points="6260.95,-1365.34 6250.85,-1368.54 6260.73,-1372.34 6260.95,-1365.34"/>
</g>
<!-- Layer0_V_Linear2&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge44" class="edge">
<title>Layer0_V_Linear2&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M8878.97,-1502.79C8839.79,-1493.2 8795.8,-1483.8 8755,-1478.17 8284.95,-1413.23 6941.79,-1378.54 6254.74,-1364.6"/>
<polygon fill="black" stroke="black" points="6254.74,-1361.1 6244.67,-1364.4 6254.6,-1368.1 6254.74,-1361.1"/>
</g>
<!-- Layer0_V_Linear3&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge45" class="edge">
<title>Layer0_V_Linear3&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M9365.61,-1502.8C9326.27,-1493.15 9282.04,-1483.71 9241,-1478.17 8675.3,-1401.72 7026.17,-1371.75 6250.85,-1361.64"/>
<polygon fill="black" stroke="black" points="6250.68,-1358.14 6240.64,-1361.51 6250.59,-1365.14 6250.68,-1358.14"/>
</g>
<!-- Layer0_V_Linear4&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge46" class="edge">
<title>Layer0_V_Linear4&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M9852.24,-1502.85C9812.75,-1493.13 9768.26,-1483.65 9727,-1478.17 9064.76,-1390.17 7103.86,-1365.92 6247.19,-1359.44"/>
<polygon fill="black" stroke="black" points="6247.19,-1355.94 6237.16,-1359.36 6247.13,-1362.94 6247.19,-1355.94"/>
</g>
<!-- Layer0_V_Linear5&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge47" class="edge">
<title>Layer0_V_Linear5&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M10338.56,-1502.84C10298.99,-1493.09 10254.38,-1483.59 10213,-1478.17 9453.86,-1378.63 7178.4,-1360.82 6245.14,-1357.75"/>
<polygon fill="black" stroke="black" points="6244.91,-1354.25 6234.9,-1357.72 6244.89,-1361.25 6244.91,-1354.25"/>
</g>
<!-- Layer0_V_Linear6&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge48" class="edge">
<title>Layer0_V_Linear6&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M10824.88,-1502.85C10785.24,-1493.07 10740.49,-1483.55 10699,-1478.17 9842.44,-1367.06 7248.98,-1356.27 6243.46,-1356.41"/>
<polygon fill="black" stroke="black" points="6243.17,-1352.91 6233.17,-1356.41 6243.17,-1359.91 6243.17,-1352.91"/>
</g>
<!-- Layer0_V_Linear7&#45;&gt;Layer0_QKV_AllGather -->
<g id="edge49" class="edge">
<title>Layer0_V_Linear7&#45;&gt;Layer0_QKV_AllGather</title>
<path fill="none" stroke="black" d="M11310.89,-1502.79C11271.24,-1493.01 11226.5,-1483.5 11185,-1478.17 10701.93,-1416.06 7418.51,-1374.47 6250.44,-1361.49"/>
<polygon fill="black" stroke="black" points="6250.23,-1357.99 6240.2,-1361.38 6250.16,-1364.99 6250.23,-1357.99"/>
</g>
<!-- Layer0_Attention_Score -->
<g id="node28" class="node">
<title>Layer0_Attention_Score</title>
<polygon fill="none" stroke="black" points="6122,-1238.08 5556,-1238.08 5556,-1170.08 6122,-1170.08 6122,-1238.08"/>
<text text-anchor="middle" x="5839" y="-1222.88" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="5839" y="-1207.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5839" y="-1192.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="5839" y="-1177.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_QKV_AllGather&#45;&gt;Layer0_Attention_Score -->
<g id="edge50" class="edge">
<title>Layer0_QKV_AllGather&#45;&gt;Layer0_Attention_Score</title>
<path fill="none" stroke="black" d="M5839,-1288.03C5839,-1274.49 5839,-1260.61 5839,-1248.17"/>
<polygon fill="black" stroke="black" points="5842.5,-1248.09 5839,-1238.09 5835.5,-1248.09 5842.5,-1248.09"/>
</g>
<!-- Layer0_Attention_Softmax -->
<g id="node29" class="node">
<title>Layer0_Attention_Softmax</title>
<polygon fill="none" stroke="black" points="6122,-1120 5556,-1120 5556,-1052 6122,-1052 6122,-1120"/>
<text text-anchor="middle" x="5839" y="-1104.8" font-family="Times,serif" font-size="14.00">Attention Softmax</text>
<text text-anchor="middle" x="5839" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="5839" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="5839" y="-1059.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_Attention_Score&#45;&gt;Layer0_Attention_Softmax -->
<g id="edge51" class="edge">
<title>Layer0_Attention_Score&#45;&gt;Layer0_Attention_Softmax</title>
<path fill="none" stroke="black" d="M5839,-1169.82C5839,-1157.55 5839,-1143.47 5839,-1130.44"/>
<polygon fill="black" stroke="black" points="5842.5,-1130.27 5839,-1120.27 5835.5,-1130.27 5842.5,-1130.27"/>
</g>
<!-- Layer0_Attention_Output -->
<g id="node30" class="node">
<title>Layer0_Attention_Output</title>
<polygon fill="none" stroke="black" points="6116,-1016 5562,-1016 5562,-948 6116,-948 6116,-1016"/>
<text text-anchor="middle" x="5839" y="-1000.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5839" y="-985.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="5839" y="-970.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5839" y="-955.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_Attention_Softmax&#45;&gt;Layer0_Attention_Output -->
<g id="edge52" class="edge">
<title>Layer0_Attention_Softmax&#45;&gt;Layer0_Attention_Output</title>
<path fill="none" stroke="black" d="M5839,-1051.88C5839,-1043.78 5839,-1034.98 5839,-1026.47"/>
<polygon fill="black" stroke="black" points="5842.5,-1026.3 5839,-1016.3 5835.5,-1026.3 5842.5,-1026.3"/>
</g>
<!-- Layer0_MLP_Linear1_Split -->
<g id="node31" class="node">
<title>Layer0_MLP_Linear1_Split</title>
<polygon fill="none" stroke="black" points="6324.4,-912 5552.24,-912 5353.6,-776 6125.76,-776 6324.4,-912"/>
<text text-anchor="middle" x="5839" y="-862.8" font-family="Times,serif" font-size="14.00">Split</text>
<text text-anchor="middle" x="5839" y="-847.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5839" y="-832.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5839" y="-817.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_Attention_Output&#45;&gt;Layer0_MLP_Linear1_Split -->
<g id="edge53" class="edge">
<title>Layer0_Attention_Output&#45;&gt;Layer0_MLP_Linear1_Split</title>
<path fill="none" stroke="black" d="M5839,-947.73C5839,-939.9 5839,-931.24 5839,-922.35"/>
<polygon fill="black" stroke="black" points="5842.5,-922.26 5839,-912.26 5835.5,-922.26 5842.5,-922.26"/>
</g>
<!-- Layer0_MLP_Linear1_0 -->
<g id="node32" class="node">
<title>Layer0_MLP_Linear1_0</title>
<polygon fill="none" stroke="black" points="4372,-740 3904,-740 3904,-672 4372,-672 4372,-740"/>
<text text-anchor="middle" x="4138" y="-724.8" font-family="Times,serif" font-size="14.00">MLP Linear1 0</text>
<text text-anchor="middle" x="4138" y="-709.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4138" y="-694.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4138" y="-679.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_0 -->
<g id="edge54" class="edge">
<title>Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_0</title>
<path fill="none" stroke="black" d="M5418.47,-820.49C5129.58,-803.28 4737.17,-776.47 4382.02,-740.08"/>
<polygon fill="black" stroke="black" points="4382.36,-736.6 4372.05,-739.06 4381.64,-743.56 4382.36,-736.6"/>
</g>
<!-- Layer0_MLP_Linear1_1 -->
<g id="node33" class="node">
<title>Layer0_MLP_Linear1_1</title>
<polygon fill="none" stroke="black" points="4858,-740 4390,-740 4390,-672 4858,-672 4858,-740"/>
<text text-anchor="middle" x="4624" y="-724.8" font-family="Times,serif" font-size="14.00">MLP Linear1 1</text>
<text text-anchor="middle" x="4624" y="-709.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4624" y="-694.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4624" y="-679.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_1 -->
<g id="edge55" class="edge">
<title>Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_1</title>
<path fill="none" stroke="black" d="M5385.28,-797.71C5224.91,-780.98 5043.06,-761.19 4868.24,-740.14"/>
<polygon fill="black" stroke="black" points="4868.41,-736.64 4858.07,-738.91 4867.58,-743.59 4868.41,-736.64"/>
</g>
<!-- Layer0_MLP_Linear1_2 -->
<g id="node34" class="node">
<title>Layer0_MLP_Linear1_2</title>
<polygon fill="none" stroke="black" points="5344,-740 4876,-740 4876,-672 5344,-672 5344,-740"/>
<text text-anchor="middle" x="5110" y="-724.8" font-family="Times,serif" font-size="14.00">MLP Linear1 2</text>
<text text-anchor="middle" x="5110" y="-709.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5110" y="-694.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5110" y="-679.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_2 -->
<g id="edge56" class="edge">
<title>Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_2</title>
<path fill="none" stroke="black" d="M5479.84,-776C5416.61,-764.2 5353.16,-752.36 5297.12,-741.91"/>
<polygon fill="black" stroke="black" points="5297.57,-738.43 5287.1,-740.04 5296.29,-745.31 5297.57,-738.43"/>
</g>
<!-- Layer0_MLP_Linear1_3 -->
<g id="node35" class="node">
<title>Layer0_MLP_Linear1_3</title>
<polygon fill="none" stroke="black" points="5830,-740 5362,-740 5362,-672 5830,-672 5830,-740"/>
<text text-anchor="middle" x="5596" y="-724.8" font-family="Times,serif" font-size="14.00">MLP Linear1 3</text>
<text text-anchor="middle" x="5596" y="-709.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5596" y="-694.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5596" y="-679.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_3 -->
<g id="edge57" class="edge">
<title>Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_3</title>
<path fill="none" stroke="black" d="M5719.28,-776C5700.3,-765.38 5681.27,-754.72 5664.03,-745.08"/>
<polygon fill="black" stroke="black" points="5665.63,-741.96 5655.19,-740.13 5662.21,-748.07 5665.63,-741.96"/>
</g>
<!-- Layer0_MLP_Linear1_4 -->
<g id="node36" class="node">
<title>Layer0_MLP_Linear1_4</title>
<polygon fill="none" stroke="black" points="6316,-740 5848,-740 5848,-672 6316,-672 6316,-740"/>
<text text-anchor="middle" x="6082" y="-724.8" font-family="Times,serif" font-size="14.00">MLP Linear1 4</text>
<text text-anchor="middle" x="6082" y="-709.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6082" y="-694.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6082" y="-679.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_4 -->
<g id="edge58" class="edge">
<title>Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_4</title>
<path fill="none" stroke="black" d="M5958.72,-776C5977.7,-765.38 5996.73,-754.72 6013.97,-745.08"/>
<polygon fill="black" stroke="black" points="6015.79,-748.07 6022.81,-740.13 6012.37,-741.96 6015.79,-748.07"/>
</g>
<!-- Layer0_MLP_Linear1_5 -->
<g id="node37" class="node">
<title>Layer0_MLP_Linear1_5</title>
<polygon fill="none" stroke="black" points="6802,-740 6334,-740 6334,-672 6802,-672 6802,-740"/>
<text text-anchor="middle" x="6568" y="-724.8" font-family="Times,serif" font-size="14.00">MLP Linear1 5</text>
<text text-anchor="middle" x="6568" y="-709.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6568" y="-694.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6568" y="-679.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_5 -->
<g id="edge59" class="edge">
<title>Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_5</title>
<path fill="none" stroke="black" d="M6141.3,-786.6C6222.43,-771.47 6307.8,-755.54 6380.67,-741.95"/>
<polygon fill="black" stroke="black" points="6381.68,-745.32 6390.87,-740.04 6380.4,-738.44 6381.68,-745.32"/>
</g>
<!-- Layer0_MLP_Linear1_6 -->
<g id="node38" class="node">
<title>Layer0_MLP_Linear1_6</title>
<polygon fill="none" stroke="black" points="7288,-740 6820,-740 6820,-672 7288,-672 7288,-740"/>
<text text-anchor="middle" x="7054" y="-724.8" font-family="Times,serif" font-size="14.00">MLP Linear1 6</text>
<text text-anchor="middle" x="7054" y="-709.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7054" y="-694.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7054" y="-679.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_6 -->
<g id="edge60" class="edge">
<title>Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_6</title>
<path fill="none" stroke="black" d="M6175.25,-809.83C6359.72,-791.02 6592.71,-766.28 6809.93,-740.12"/>
<polygon fill="black" stroke="black" points="6810.42,-743.59 6819.93,-738.91 6809.59,-736.64 6810.42,-743.59"/>
</g>
<!-- Layer0_MLP_Linear1_7 -->
<g id="node39" class="node">
<title>Layer0_MLP_Linear1_7</title>
<polygon fill="none" stroke="black" points="7774,-740 7306,-740 7306,-672 7774,-672 7774,-740"/>
<text text-anchor="middle" x="7540" y="-724.8" font-family="Times,serif" font-size="14.00">MLP Linear1 7</text>
<text text-anchor="middle" x="7540" y="-709.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7540" y="-694.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7540" y="-679.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_7 -->
<g id="edge61" class="edge">
<title>Layer0_MLP_Linear1_Split&#45;&gt;Layer0_MLP_Linear1_7</title>
<path fill="none" stroke="black" d="M6196.45,-824.19C6489.35,-807.25 6914.76,-779.13 7295.82,-740.1"/>
<polygon fill="black" stroke="black" points="7296.36,-743.56 7305.95,-739.06 7295.64,-736.6 7296.36,-743.56"/>
</g>
<!-- Layer0_MLP_GELU_0 -->
<g id="node40" class="node">
<title>Layer0_MLP_GELU_0</title>
<polygon fill="none" stroke="black" points="4372,-636 3904,-636 3904,-568 4372,-568 4372,-636"/>
<text text-anchor="middle" x="4138" y="-620.8" font-family="Times,serif" font-size="14.00">GELU 0</text>
<text text-anchor="middle" x="4138" y="-605.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4138" y="-590.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4138" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_MLP_Linear1_0&#45;&gt;Layer0_MLP_GELU_0 -->
<g id="edge62" class="edge">
<title>Layer0_MLP_Linear1_0&#45;&gt;Layer0_MLP_GELU_0</title>
<path fill="none" stroke="black" d="M4138,-671.88C4138,-663.78 4138,-654.98 4138,-646.47"/>
<polygon fill="black" stroke="black" points="4141.5,-646.3 4138,-636.3 4134.5,-646.3 4141.5,-646.3"/>
</g>
<!-- Layer0_MLP_GELU_1 -->
<g id="node41" class="node">
<title>Layer0_MLP_GELU_1</title>
<polygon fill="none" stroke="black" points="4858,-636 4390,-636 4390,-568 4858,-568 4858,-636"/>
<text text-anchor="middle" x="4624" y="-620.8" font-family="Times,serif" font-size="14.00">GELU 1</text>
<text text-anchor="middle" x="4624" y="-605.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4624" y="-590.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4624" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer0_MLP_Linear1_1&#45;&gt;Layer0_MLP_GELU_1 -->
<g id="edge63" class="edge">
<title>Layer0_MLP_Linear1_1&#45;&gt;Layer0_MLP_GELU_1</title>
<path fill="none" stroke="black" d="M4624,-671.88C4624,-663.78 4624,-654.98 4624,-646.47"/>
<polygon fill="black" stroke="black" points="4627.5,-646.3 4624,-636.3 4620.5,-646.3 4627.5,-646.3"/>
</g>
<!-- Layer0_MLP_GELU_2 -->
<g id="node42" class="node">
<title>Layer0_MLP_GELU_2</title>
<polygon fill="none" stroke="black" points="5344,-636 4876,-636 4876,-568 5344,-568 5344,-636"/>
<text text-anchor="middle" x="5110" y="-620.8" font-family="Times,serif" font-size="14.00">GELU 2</text>
<text text-anchor="middle" x="5110" y="-605.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5110" y="-590.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5110" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Layer0_MLP_Linear1_2&#45;&gt;Layer0_MLP_GELU_2 -->
<g id="edge64" class="edge">
<title>Layer0_MLP_Linear1_2&#45;&gt;Layer0_MLP_GELU_2</title>
<path fill="none" stroke="black" d="M5110,-671.88C5110,-663.78 5110,-654.98 5110,-646.47"/>
<polygon fill="black" stroke="black" points="5113.5,-646.3 5110,-636.3 5106.5,-646.3 5113.5,-646.3"/>
</g>
<!-- Layer0_MLP_GELU_3 -->
<g id="node43" class="node">
<title>Layer0_MLP_GELU_3</title>
<polygon fill="none" stroke="black" points="5830,-636 5362,-636 5362,-568 5830,-568 5830,-636"/>
<text text-anchor="middle" x="5596" y="-620.8" font-family="Times,serif" font-size="14.00">GELU 3</text>
<text text-anchor="middle" x="5596" y="-605.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5596" y="-590.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5596" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Layer0_MLP_Linear1_3&#45;&gt;Layer0_MLP_GELU_3 -->
<g id="edge65" class="edge">
<title>Layer0_MLP_Linear1_3&#45;&gt;Layer0_MLP_GELU_3</title>
<path fill="none" stroke="black" d="M5596,-671.88C5596,-663.78 5596,-654.98 5596,-646.47"/>
<polygon fill="black" stroke="black" points="5599.5,-646.3 5596,-636.3 5592.5,-646.3 5599.5,-646.3"/>
</g>
<!-- Layer0_MLP_GELU_4 -->
<g id="node44" class="node">
<title>Layer0_MLP_GELU_4</title>
<polygon fill="none" stroke="black" points="6316,-636 5848,-636 5848,-568 6316,-568 6316,-636"/>
<text text-anchor="middle" x="6082" y="-620.8" font-family="Times,serif" font-size="14.00">GELU 4</text>
<text text-anchor="middle" x="6082" y="-605.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6082" y="-590.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6082" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Layer0_MLP_Linear1_4&#45;&gt;Layer0_MLP_GELU_4 -->
<g id="edge66" class="edge">
<title>Layer0_MLP_Linear1_4&#45;&gt;Layer0_MLP_GELU_4</title>
<path fill="none" stroke="black" d="M6082,-671.88C6082,-663.78 6082,-654.98 6082,-646.47"/>
<polygon fill="black" stroke="black" points="6085.5,-646.3 6082,-636.3 6078.5,-646.3 6085.5,-646.3"/>
</g>
<!-- Layer0_MLP_GELU_5 -->
<g id="node45" class="node">
<title>Layer0_MLP_GELU_5</title>
<polygon fill="none" stroke="black" points="6802,-636 6334,-636 6334,-568 6802,-568 6802,-636"/>
<text text-anchor="middle" x="6568" y="-620.8" font-family="Times,serif" font-size="14.00">GELU 5</text>
<text text-anchor="middle" x="6568" y="-605.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6568" y="-590.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6568" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Layer0_MLP_Linear1_5&#45;&gt;Layer0_MLP_GELU_5 -->
<g id="edge67" class="edge">
<title>Layer0_MLP_Linear1_5&#45;&gt;Layer0_MLP_GELU_5</title>
<path fill="none" stroke="black" d="M6568,-671.88C6568,-663.78 6568,-654.98 6568,-646.47"/>
<polygon fill="black" stroke="black" points="6571.5,-646.3 6568,-636.3 6564.5,-646.3 6571.5,-646.3"/>
</g>
<!-- Layer0_MLP_GELU_6 -->
<g id="node46" class="node">
<title>Layer0_MLP_GELU_6</title>
<polygon fill="none" stroke="black" points="7288,-636 6820,-636 6820,-568 7288,-568 7288,-636"/>
<text text-anchor="middle" x="7054" y="-620.8" font-family="Times,serif" font-size="14.00">GELU 6</text>
<text text-anchor="middle" x="7054" y="-605.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7054" y="-590.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7054" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Layer0_MLP_Linear1_6&#45;&gt;Layer0_MLP_GELU_6 -->
<g id="edge68" class="edge">
<title>Layer0_MLP_Linear1_6&#45;&gt;Layer0_MLP_GELU_6</title>
<path fill="none" stroke="black" d="M7054,-671.88C7054,-663.78 7054,-654.98 7054,-646.47"/>
<polygon fill="black" stroke="black" points="7057.5,-646.3 7054,-636.3 7050.5,-646.3 7057.5,-646.3"/>
</g>
<!-- Layer0_MLP_GELU_7 -->
<g id="node47" class="node">
<title>Layer0_MLP_GELU_7</title>
<polygon fill="none" stroke="black" points="7774,-636 7306,-636 7306,-568 7774,-568 7774,-636"/>
<text text-anchor="middle" x="7540" y="-620.8" font-family="Times,serif" font-size="14.00">GELU 7</text>
<text text-anchor="middle" x="7540" y="-605.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7540" y="-590.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7540" y="-575.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Layer0_MLP_Linear1_7&#45;&gt;Layer0_MLP_GELU_7 -->
<g id="edge69" class="edge">
<title>Layer0_MLP_Linear1_7&#45;&gt;Layer0_MLP_GELU_7</title>
<path fill="none" stroke="black" d="M7540,-671.88C7540,-663.78 7540,-654.98 7540,-646.47"/>
<polygon fill="black" stroke="black" points="7543.5,-646.3 7540,-636.3 7536.5,-646.3 7543.5,-646.3"/>
</g>
<!-- Layer0_MLP_Linear2_0 -->
<g id="node48" class="node">
<title>Layer0_MLP_Linear2_0</title>
<polygon fill="none" stroke="black" points="4372,-532 3904,-532 3904,-464 4372,-464 4372,-532"/>
<text text-anchor="middle" x="4138" y="-516.8" font-family="Times,serif" font-size="14.00">MLP Linear2 0</text>
<text text-anchor="middle" x="4138" y="-501.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4138" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4138" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_MLP_GELU_0&#45;&gt;Layer0_MLP_Linear2_0 -->
<g id="edge70" class="edge">
<title>Layer0_MLP_GELU_0&#45;&gt;Layer0_MLP_Linear2_0</title>
<path fill="none" stroke="black" d="M4138,-567.88C4138,-559.78 4138,-550.98 4138,-542.47"/>
<polygon fill="black" stroke="black" points="4141.5,-542.3 4138,-532.3 4134.5,-542.3 4141.5,-542.3"/>
</g>
<!-- Layer0_MLP_Linear2_1 -->
<g id="node49" class="node">
<title>Layer0_MLP_Linear2_1</title>
<polygon fill="none" stroke="black" points="4858,-532 4390,-532 4390,-464 4858,-464 4858,-532"/>
<text text-anchor="middle" x="4624" y="-516.8" font-family="Times,serif" font-size="14.00">MLP Linear2 1</text>
<text text-anchor="middle" x="4624" y="-501.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="4624" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="4624" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer0_MLP_GELU_1&#45;&gt;Layer0_MLP_Linear2_1 -->
<g id="edge71" class="edge">
<title>Layer0_MLP_GELU_1&#45;&gt;Layer0_MLP_Linear2_1</title>
<path fill="none" stroke="black" d="M4624,-567.88C4624,-559.78 4624,-550.98 4624,-542.47"/>
<polygon fill="black" stroke="black" points="4627.5,-542.3 4624,-532.3 4620.5,-542.3 4627.5,-542.3"/>
</g>
<!-- Layer0_MLP_Linear2_2 -->
<g id="node50" class="node">
<title>Layer0_MLP_Linear2_2</title>
<polygon fill="none" stroke="black" points="5344,-532 4876,-532 4876,-464 5344,-464 5344,-532"/>
<text text-anchor="middle" x="5110" y="-516.8" font-family="Times,serif" font-size="14.00">MLP Linear2 2</text>
<text text-anchor="middle" x="5110" y="-501.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5110" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5110" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Layer0_MLP_GELU_2&#45;&gt;Layer0_MLP_Linear2_2 -->
<g id="edge72" class="edge">
<title>Layer0_MLP_GELU_2&#45;&gt;Layer0_MLP_Linear2_2</title>
<path fill="none" stroke="black" d="M5110,-567.88C5110,-559.78 5110,-550.98 5110,-542.47"/>
<polygon fill="black" stroke="black" points="5113.5,-542.3 5110,-532.3 5106.5,-542.3 5113.5,-542.3"/>
</g>
<!-- Layer0_MLP_Linear2_3 -->
<g id="node51" class="node">
<title>Layer0_MLP_Linear2_3</title>
<polygon fill="none" stroke="black" points="5830,-532 5362,-532 5362,-464 5830,-464 5830,-532"/>
<text text-anchor="middle" x="5596" y="-516.8" font-family="Times,serif" font-size="14.00">MLP Linear2 3</text>
<text text-anchor="middle" x="5596" y="-501.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="5596" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5596" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Layer0_MLP_GELU_3&#45;&gt;Layer0_MLP_Linear2_3 -->
<g id="edge73" class="edge">
<title>Layer0_MLP_GELU_3&#45;&gt;Layer0_MLP_Linear2_3</title>
<path fill="none" stroke="black" d="M5596,-567.88C5596,-559.78 5596,-550.98 5596,-542.47"/>
<polygon fill="black" stroke="black" points="5599.5,-542.3 5596,-532.3 5592.5,-542.3 5599.5,-542.3"/>
</g>
<!-- Layer0_MLP_Linear2_4 -->
<g id="node52" class="node">
<title>Layer0_MLP_Linear2_4</title>
<polygon fill="none" stroke="black" points="6316,-532 5848,-532 5848,-464 6316,-464 6316,-532"/>
<text text-anchor="middle" x="6082" y="-516.8" font-family="Times,serif" font-size="14.00">MLP Linear2 4</text>
<text text-anchor="middle" x="6082" y="-501.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6082" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="6082" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Layer0_MLP_GELU_4&#45;&gt;Layer0_MLP_Linear2_4 -->
<g id="edge74" class="edge">
<title>Layer0_MLP_GELU_4&#45;&gt;Layer0_MLP_Linear2_4</title>
<path fill="none" stroke="black" d="M6082,-567.88C6082,-559.78 6082,-550.98 6082,-542.47"/>
<polygon fill="black" stroke="black" points="6085.5,-542.3 6082,-532.3 6078.5,-542.3 6085.5,-542.3"/>
</g>
<!-- Layer0_MLP_Linear2_5 -->
<g id="node53" class="node">
<title>Layer0_MLP_Linear2_5</title>
<polygon fill="none" stroke="black" points="6802,-532 6334,-532 6334,-464 6802,-464 6802,-532"/>
<text text-anchor="middle" x="6568" y="-516.8" font-family="Times,serif" font-size="14.00">MLP Linear2 5</text>
<text text-anchor="middle" x="6568" y="-501.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="6568" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="6568" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Layer0_MLP_GELU_5&#45;&gt;Layer0_MLP_Linear2_5 -->
<g id="edge75" class="edge">
<title>Layer0_MLP_GELU_5&#45;&gt;Layer0_MLP_Linear2_5</title>
<path fill="none" stroke="black" d="M6568,-567.88C6568,-559.78 6568,-550.98 6568,-542.47"/>
<polygon fill="black" stroke="black" points="6571.5,-542.3 6568,-532.3 6564.5,-542.3 6571.5,-542.3"/>
</g>
<!-- Layer0_MLP_Linear2_6 -->
<g id="node54" class="node">
<title>Layer0_MLP_Linear2_6</title>
<polygon fill="none" stroke="black" points="7288,-532 6820,-532 6820,-464 7288,-464 7288,-532"/>
<text text-anchor="middle" x="7054" y="-516.8" font-family="Times,serif" font-size="14.00">MLP Linear2 6</text>
<text text-anchor="middle" x="7054" y="-501.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7054" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7054" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Layer0_MLP_GELU_6&#45;&gt;Layer0_MLP_Linear2_6 -->
<g id="edge76" class="edge">
<title>Layer0_MLP_GELU_6&#45;&gt;Layer0_MLP_Linear2_6</title>
<path fill="none" stroke="black" d="M7054,-567.88C7054,-559.78 7054,-550.98 7054,-542.47"/>
<polygon fill="black" stroke="black" points="7057.5,-542.3 7054,-532.3 7050.5,-542.3 7057.5,-542.3"/>
</g>
<!-- Layer0_MLP_Linear2_7 -->
<g id="node55" class="node">
<title>Layer0_MLP_Linear2_7</title>
<polygon fill="none" stroke="black" points="7774,-532 7306,-532 7306,-464 7774,-464 7774,-532"/>
<text text-anchor="middle" x="7540" y="-516.8" font-family="Times,serif" font-size="14.00">MLP Linear2 7</text>
<text text-anchor="middle" x="7540" y="-501.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=4096]</text>
<text text-anchor="middle" x="7540" y="-486.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7540" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Layer0_MLP_GELU_7&#45;&gt;Layer0_MLP_Linear2_7 -->
<g id="edge77" class="edge">
<title>Layer0_MLP_GELU_7&#45;&gt;Layer0_MLP_Linear2_7</title>
<path fill="none" stroke="black" d="M7540,-567.88C7540,-559.78 7540,-550.98 7540,-542.47"/>
<polygon fill="black" stroke="black" points="7543.5,-542.3 7540,-532.3 7536.5,-542.3 7543.5,-542.3"/>
</g>
<!-- Layer0_MLP_AllReduce -->
<g id="node56" class="node">
<title>Layer0_MLP_AllReduce</title>
<polygon fill="none" stroke="black" points="6333.56,-428 5546.82,-428 5344.44,-292 6131.18,-292 6333.56,-428"/>
<text text-anchor="middle" x="5839" y="-378.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="5839" y="-363.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]×8</text>
<text text-anchor="middle" x="5839" y="-348.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5839" y="-333.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_MLP_Linear2_0&#45;&gt;Layer0_MLP_AllReduce -->
<g id="edge78" class="edge">
<title>Layer0_MLP_Linear2_0&#45;&gt;Layer0_MLP_AllReduce</title>
<path fill="none" stroke="black" d="M4372.05,-464.94C4375.05,-464.62 4378.04,-464.31 4381,-464 4748.98,-426.06 5170.67,-397.93 5465.56,-380.74"/>
<polygon fill="black" stroke="black" points="5465.78,-384.23 5475.56,-380.16 5465.37,-377.24 5465.78,-384.23"/>
</g>
<!-- Layer0_MLP_Linear2_1&#45;&gt;Layer0_MLP_AllReduce -->
<g id="edge79" class="edge">
<title>Layer0_MLP_Linear2_1&#45;&gt;Layer0_MLP_AllReduce</title>
<path fill="none" stroke="black" d="M4858.07,-465.09C4861.06,-464.72 4864.04,-464.36 4867,-464 5072.23,-439.2 5302.24,-414.67 5486.98,-395.78"/>
<polygon fill="black" stroke="black" points="5487.54,-399.25 5497.13,-394.75 5486.83,-392.28 5487.54,-399.25"/>
</g>
<!-- Layer0_MLP_Linear2_2&#45;&gt;Layer0_MLP_AllReduce -->
<g id="edge80" class="edge">
<title>Layer0_MLP_Linear2_2&#45;&gt;Layer0_MLP_AllReduce</title>
<path fill="none" stroke="black" d="M5286.94,-463.99C5357.66,-450.8 5441.33,-435.19 5521.87,-420.16"/>
<polygon fill="black" stroke="black" points="5522.99,-423.51 5532.18,-418.24 5521.71,-416.63 5522.99,-423.51"/>
</g>
<!-- Layer0_MLP_Linear2_3&#45;&gt;Layer0_MLP_AllReduce -->
<g id="edge81" class="edge">
<title>Layer0_MLP_Linear2_3&#45;&gt;Layer0_MLP_AllReduce</title>
<path fill="none" stroke="black" d="M5655.13,-463.9C5671.95,-454.5 5690.94,-443.86 5710.19,-433.09"/>
<polygon fill="black" stroke="black" points="5712.02,-436.08 5719.04,-428.14 5708.6,-429.97 5712.02,-436.08"/>
</g>
<!-- Layer0_MLP_Linear2_4&#45;&gt;Layer0_MLP_AllReduce -->
<g id="edge82" class="edge">
<title>Layer0_MLP_Linear2_4&#45;&gt;Layer0_MLP_AllReduce</title>
<path fill="none" stroke="black" d="M6022.87,-463.9C6006.05,-454.5 5987.06,-443.86 5967.81,-433.09"/>
<polygon fill="black" stroke="black" points="5969.4,-429.97 5958.96,-428.14 5965.98,-436.08 5969.4,-429.97"/>
</g>
<!-- Layer0_MLP_Linear2_5&#45;&gt;Layer0_MLP_AllReduce -->
<g id="edge83" class="edge">
<title>Layer0_MLP_Linear2_5&#45;&gt;Layer0_MLP_AllReduce</title>
<path fill="none" stroke="black" d="M6391.06,-463.99C6335.56,-453.64 6272.08,-441.79 6208.4,-429.92"/>
<polygon fill="black" stroke="black" points="6208.66,-426.4 6198.18,-428.01 6207.37,-433.28 6208.66,-426.4"/>
</g>
<!-- Layer0_MLP_Linear2_6&#45;&gt;Layer0_MLP_AllReduce -->
<g id="edge84" class="edge">
<title>Layer0_MLP_Linear2_6&#45;&gt;Layer0_MLP_AllReduce</title>
<path fill="none" stroke="black" d="M6819.93,-465.09C6816.94,-464.72 6813.96,-464.36 6811,-464 6649.04,-444.43 6471.64,-425.03 6313.24,-408.43"/>
<polygon fill="black" stroke="black" points="6313.14,-404.9 6302.83,-407.34 6312.41,-411.87 6313.14,-404.9"/>
</g>
<!-- Layer0_MLP_Linear2_7&#45;&gt;Layer0_MLP_AllReduce -->
<g id="edge85" class="edge">
<title>Layer0_MLP_Linear2_7&#45;&gt;Layer0_MLP_AllReduce</title>
<path fill="none" stroke="black" d="M7305.95,-464.94C7302.95,-464.62 7299.96,-464.31 7297,-464 6955.71,-428.81 6568.22,-402.06 6278.53,-384.65"/>
<polygon fill="black" stroke="black" points="6278.46,-381.14 6268.27,-384.03 6278.04,-388.13 6278.46,-381.14"/>
</g>
<!-- Layer0_Add -->
<g id="node57" class="node">
<title>Layer0_Add</title>
<polygon fill="none" stroke="black" points="6077.5,-256 5600.5,-256 5600.5,-188 6077.5,-188 6077.5,-256"/>
<text text-anchor="middle" x="5839" y="-240.8" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5839" y="-225.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="5839" y="-210.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5839" y="-195.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_MLP_AllReduce&#45;&gt;Layer0_Add -->
<g id="edge86" class="edge">
<title>Layer0_MLP_AllReduce&#45;&gt;Layer0_Add</title>
<path fill="none" stroke="black" d="M5839,-291.8C5839,-283.04 5839,-274.28 5839,-266.07"/>
<polygon fill="black" stroke="black" points="5842.5,-266.02 5839,-256.02 5835.5,-266.02 5842.5,-266.02"/>
</g>
<!-- Layer1_QKV_Split -->
<g id="node58" class="node">
<title>Layer1_QKV_Split</title>
<polygon fill="none" stroke="black" points="6324.4,-152 5552.24,-152 5353.6,-16 6125.76,-16 6324.4,-152"/>
<text text-anchor="middle" x="5839" y="-102.8" font-family="Times,serif" font-size="14.00">Split</text>
<text text-anchor="middle" x="5839" y="-87.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="5839" y="-72.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="5839" y="-57.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_Add&#45;&gt;Layer1_QKV_Split -->
<g id="edge87" class="edge">
<title>Layer0_Add&#45;&gt;Layer1_QKV_Split</title>
<path fill="none" stroke="black" d="M5839,-187.73C5839,-179.9 5839,-171.24 5839,-162.35"/>
<polygon fill="black" stroke="black" points="5842.5,-162.26 5839,-152.26 5835.5,-162.26 5842.5,-162.26"/>
</g>
<!-- Layer1_Q_Linear0 -->
<g id="node59" class="node">
<title>Layer1_Q_Linear0</title>
<polygon fill="none" stroke="black" points="11166,-1733.55 10698,-1733.55 10698,-1665.55 11166,-1665.55 11166,-1733.55"/>
<text text-anchor="middle" x="10932" y="-1718.35" font-family="Times,serif" font-size="14.00">Q Linear 0</text>
<text text-anchor="middle" x="10932" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="10932" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="10932" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer1_Q_Linear1 -->
<g id="node60" class="node">
<title>Layer1_Q_Linear1</title>
<polygon fill="none" stroke="black" points="10679,-1733.55 10211,-1733.55 10211,-1665.55 10679,-1665.55 10679,-1733.55"/>
<text text-anchor="middle" x="10445" y="-1718.35" font-family="Times,serif" font-size="14.00">Q Linear 1</text>
<text text-anchor="middle" x="10445" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="10445" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="10445" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Q_Linear2 -->
<g id="node61" class="node">
<title>Layer1_Q_Linear2</title>
<polygon fill="none" stroke="black" points="10192,-1733.55 9724,-1733.55 9724,-1665.55 10192,-1665.55 10192,-1733.55"/>
<text text-anchor="middle" x="9958" y="-1718.35" font-family="Times,serif" font-size="14.00">Q Linear 2</text>
<text text-anchor="middle" x="9958" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="9958" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="9958" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Layer1_Q_Linear3 -->
<g id="node62" class="node">
<title>Layer1_Q_Linear3</title>
<polygon fill="none" stroke="black" points="9703,-1733.55 9235,-1733.55 9235,-1665.55 9703,-1665.55 9703,-1733.55"/>
<text text-anchor="middle" x="9469" y="-1718.35" font-family="Times,serif" font-size="14.00">Q Linear 3</text>
<text text-anchor="middle" x="9469" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="9469" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="9469" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- Layer1_Q_Linear4 -->
<g id="node63" class="node">
<title>Layer1_Q_Linear4</title>
<polygon fill="none" stroke="black" points="9211,-1733.55 8743,-1733.55 8743,-1665.55 9211,-1665.55 9211,-1733.55"/>
<text text-anchor="middle" x="8977" y="-1718.35" font-family="Times,serif" font-size="14.00">Q Linear 4</text>
<text text-anchor="middle" x="8977" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8977" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8977" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- Layer1_Q_Linear5 -->
<g id="node64" class="node">
<title>Layer1_Q_Linear5</title>
<polygon fill="none" stroke="black" points="8713,-1733.55 8245,-1733.55 8245,-1665.55 8713,-1665.55 8713,-1733.55"/>
<text text-anchor="middle" x="8479" y="-1718.35" font-family="Times,serif" font-size="14.00">Q Linear 5</text>
<text text-anchor="middle" x="8479" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8479" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="8479" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- Layer1_Q_Linear6 -->
<g id="node65" class="node">
<title>Layer1_Q_Linear6</title>
<polygon fill="none" stroke="black" points="8203,-1733.55 7735,-1733.55 7735,-1665.55 8203,-1665.55 8203,-1733.55"/>
<text text-anchor="middle" x="7969" y="-1718.35" font-family="Times,serif" font-size="14.00">Q Linear 6</text>
<text text-anchor="middle" x="7969" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7969" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7969" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- Layer1_Q_Linear7 -->
<g id="node66" class="node">
<title>Layer1_Q_Linear7</title>
<polygon fill="none" stroke="black" points="7670,-1733.55 7202,-1733.55 7202,-1665.55 7670,-1665.55 7670,-1733.55"/>
<text text-anchor="middle" x="7436" y="-1718.35" font-family="Times,serif" font-size="14.00">Q Linear 7</text>
<text text-anchor="middle" x="7436" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7436" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="7436" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- Layer1_MLP_AllReduce -->
<g id="node67" class="node">
<title>Layer1_MLP_AllReduce</title>
<polygon fill="none" stroke="black" points="7089.56,-1767.55 6302.82,-1767.55 6100.44,-1631.55 6887.18,-1631.55 7089.56,-1767.55"/>
<text text-anchor="middle" x="6595" y="-1718.35" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="6595" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]×8</text>
<text text-anchor="middle" x="6595" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="6595" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer1_Add -->
<g id="node68" class="node">
<title>Layer1_Add</title>
<polygon fill="none" stroke="black" points="11661.5,-1733.55 11184.5,-1733.55 11184.5,-1665.55 11661.5,-1665.55 11661.5,-1733.55"/>
<text text-anchor="middle" x="11423" y="-1718.35" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11423" y="-1703.35" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="11423" y="-1688.35" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="11423" y="-1673.35" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Pipeline_Comm_Stage0_1 -->
<g id="node81" class="node">
<title>Pipeline_Comm_Stage0_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="14807" cy="-1536.86" rx="330.85" ry="58.88"/>
<text text-anchor="middle" x="14807" y="-1563.16" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="14807" y="-1548.16" font-family="Times,serif" font-size="14.00">Stage 0 → Stage 1</text>
<text text-anchor="middle" x="14807" y="-1533.16" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14807" y="-1518.16" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14807" y="-1503.16" font-family="Times,serif" font-size="14.00">GPU: 7→8</text>
</g>
<!-- Layer1_Add&#45;&gt;Pipeline_Comm_Stage0_1 -->
<g id="edge88" class="edge">
<title>Layer1_Add&#45;&gt;Pipeline_Comm_Stage0_1</title>
<path fill="none" stroke="black" d="M11661.63,-1687.21C12255.23,-1659.03 13799.32,-1585.71 14478.4,-1553.46"/>
<polygon fill="black" stroke="black" points="14478.76,-1556.95 14488.58,-1552.98 14478.43,-1549.95 14478.76,-1556.95"/>
</g>
<!-- Layer8_QKV_Split -->
<g id="node69" class="node">
<title>Layer8_QKV_Split</title>
<polygon fill="none" stroke="black" points="18089.4,-1424.17 17317.24,-1424.17 17118.6,-1288.17 17890.76,-1288.17 18089.4,-1424.17"/>
<text text-anchor="middle" x="17604" y="-1374.97" font-family="Times,serif" font-size="14.00">Split</text>
<text text-anchor="middle" x="17604" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="17604" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="17604" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer8_Q_Linear0 -->
<g id="node70" class="node">
<title>Layer8_Q_Linear0</title>
<polygon fill="none" stroke="black" points="17101,-1390.17 16633,-1390.17 16633,-1322.17 17101,-1322.17 17101,-1390.17"/>
<text text-anchor="middle" x="16867" y="-1374.97" font-family="Times,serif" font-size="14.00">Q Linear 0</text>
<text text-anchor="middle" x="16867" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="16867" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="16867" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- Layer8_Q_Linear1 -->
<g id="node71" class="node">
<title>Layer8_Q_Linear1</title>
<polygon fill="none" stroke="black" points="16615,-1390.17 16147,-1390.17 16147,-1322.17 16615,-1322.17 16615,-1390.17"/>
<text text-anchor="middle" x="16381" y="-1374.97" font-family="Times,serif" font-size="14.00">Q Linear 1</text>
<text text-anchor="middle" x="16381" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="16381" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="16381" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- Layer8_Q_Linear2 -->
<g id="node72" class="node">
<title>Layer8_Q_Linear2</title>
<polygon fill="none" stroke="black" points="16129,-1390.17 15661,-1390.17 15661,-1322.17 16129,-1322.17 16129,-1390.17"/>
<text text-anchor="middle" x="15895" y="-1374.97" font-family="Times,serif" font-size="14.00">Q Linear 2</text>
<text text-anchor="middle" x="15895" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="15895" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="15895" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- Layer8_Q_Linear3 -->
<g id="node73" class="node">
<title>Layer8_Q_Linear3</title>
<polygon fill="none" stroke="black" points="15643,-1390.17 15175,-1390.17 15175,-1322.17 15643,-1322.17 15643,-1390.17"/>
<text text-anchor="middle" x="15409" y="-1374.97" font-family="Times,serif" font-size="14.00">Q Linear 3</text>
<text text-anchor="middle" x="15409" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="15409" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="15409" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- Layer8_Q_Linear4 -->
<g id="node74" class="node">
<title>Layer8_Q_Linear4</title>
<polygon fill="none" stroke="black" points="15157,-1390.17 14689,-1390.17 14689,-1322.17 15157,-1322.17 15157,-1390.17"/>
<text text-anchor="middle" x="14923" y="-1374.97" font-family="Times,serif" font-size="14.00">Q Linear 4</text>
<text text-anchor="middle" x="14923" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="14923" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="14923" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- Layer8_Q_Linear5 -->
<g id="node75" class="node">
<title>Layer8_Q_Linear5</title>
<polygon fill="none" stroke="black" points="14671,-1390.17 14203,-1390.17 14203,-1322.17 14671,-1322.17 14671,-1390.17"/>
<text text-anchor="middle" x="14437" y="-1374.97" font-family="Times,serif" font-size="14.00">Q Linear 5</text>
<text text-anchor="middle" x="14437" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="14437" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="14437" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- Layer8_Q_Linear6 -->
<g id="node76" class="node">
<title>Layer8_Q_Linear6</title>
<polygon fill="none" stroke="black" points="14185,-1390.17 13717,-1390.17 13717,-1322.17 14185,-1322.17 14185,-1390.17"/>
<text text-anchor="middle" x="13951" y="-1374.97" font-family="Times,serif" font-size="14.00">Q Linear 6</text>
<text text-anchor="middle" x="13951" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="13951" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="13951" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- Layer8_Q_Linear7 -->
<g id="node77" class="node">
<title>Layer8_Q_Linear7</title>
<polygon fill="none" stroke="black" points="13699,-1390.17 13231,-1390.17 13231,-1322.17 13699,-1322.17 13699,-1390.17"/>
<text text-anchor="middle" x="13465" y="-1374.97" font-family="Times,serif" font-size="14.00">Q Linear 7</text>
<text text-anchor="middle" x="13465" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="13465" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=1024]</text>
<text text-anchor="middle" x="13465" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_MLP_AllReduce -->
<g id="node78" class="node">
<title>Layer15_MLP_AllReduce</title>
<polygon fill="none" stroke="black" points="13212.56,-1424.17 12425.82,-1424.17 12223.44,-1288.17 13010.18,-1288.17 13212.56,-1424.17"/>
<text text-anchor="middle" x="12718" y="-1374.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="12718" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=1024]×8</text>
<text text-anchor="middle" x="12718" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12718" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer15_Add -->
<g id="node79" class="node">
<title>Layer15_Add</title>
<polygon fill="none" stroke="black" points="12205.5,-1390.17 11728.5,-1390.17 11728.5,-1322.17 12205.5,-1322.17 12205.5,-1390.17"/>
<text text-anchor="middle" x="11967" y="-1374.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11967" y="-1359.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="11967" y="-1344.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="11967" y="-1329.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Output -->
<g id="node80" class="node">
<title>Output</title>
<ellipse fill="none" stroke="black" cx="12009" cy="-1204.08" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="12009" y="-1222.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="12009" y="-1207.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12009" y="-1192.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12009" y="-1177.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer15_Add&#45;&gt;Output -->
<g id="edge90" class="edge">
<title>Layer15_Add&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M11976.32,-1321.86C11981.24,-1304.27 11987.42,-1282.2 11993.08,-1261.99"/>
<polygon fill="black" stroke="black" points="11996.48,-1262.82 11995.8,-1252.25 11989.74,-1260.93 11996.48,-1262.82"/>
</g>
<!-- Pipeline_Comm_Stage0_1&#45;&gt;Layer8_QKV_Split -->
<g id="edge89" class="edge">
<title>Pipeline_Comm_Stage0_1&#45;&gt;Layer8_QKV_Split</title>
<path fill="none" stroke="black" d="M15137.88,-1534.41C15681.17,-1530.69 16739.01,-1517.42 17110,-1470.17 17186.95,-1460.37 17269.49,-1443.91 17344.64,-1426.55"/>
<polygon fill="black" stroke="black" points="17345.77,-1429.88 17354.72,-1424.21 17344.18,-1423.06 17345.77,-1429.88"/>
</g>
</g>
</svg>
