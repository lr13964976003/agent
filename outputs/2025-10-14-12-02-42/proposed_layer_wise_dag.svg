<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_layer_wise Pages: 1 -->
<svg width="3663pt" height="2968pt"
 viewBox="0.00 0.00 3663.43 2968.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2964.5)">
<title>proposed_layer_wise</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2964.5 3659.43,-2964.5 3659.43,4 -4,4"/>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="none" stroke="black" cx="1074.5" cy="-2912.42" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="1074.5" y="-2931.22" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1074.5" y="-2916.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1074.5" y="-2901.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1074.5" y="-2886.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Q_Linear -->
<g id="node2" class="node">
<title>Layer0_Q_Linear</title>
<polygon fill="none" stroke="black" points="562.5,-2828.33 94.5,-2828.33 94.5,-2760.33 562.5,-2760.33 562.5,-2828.33"/>
<text text-anchor="middle" x="328.5" y="-2813.13" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="328.5" y="-2798.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="328.5" y="-2783.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="328.5" y="-2768.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Input&#45;&gt;Layer0_Q_Linear -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;Layer0_Q_Linear</title>
<path fill="none" stroke="black" d="M851.94,-2876.78C756.76,-2861.97 645.89,-2844.72 550.75,-2829.92"/>
<polygon fill="black" stroke="black" points="551.13,-2826.43 540.71,-2828.35 550.06,-2833.35 551.13,-2826.43"/>
</g>
<!-- Layer0_K_Linear -->
<g id="node3" class="node">
<title>Layer0_K_Linear</title>
<polygon fill="none" stroke="black" points="1072.5,-2828.33 604.5,-2828.33 604.5,-2760.33 1072.5,-2760.33 1072.5,-2828.33"/>
<text text-anchor="middle" x="838.5" y="-2813.13" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="838.5" y="-2798.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="838.5" y="-2783.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="838.5" y="-2768.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Input&#45;&gt;Layer0_K_Linear -->
<g id="edge2" class="edge">
<title>Input&#45;&gt;Layer0_K_Linear</title>
<path fill="none" stroke="black" d="M982.58,-2866.2C960.16,-2855.17 936.41,-2843.49 914.81,-2832.87"/>
<polygon fill="black" stroke="black" points="916.21,-2829.66 905.69,-2828.38 913.12,-2835.94 916.21,-2829.66"/>
</g>
<!-- Layer0_V_Linear -->
<g id="node4" class="node">
<title>Layer0_V_Linear</title>
<polygon fill="none" stroke="black" points="1558.5,-2828.33 1090.5,-2828.33 1090.5,-2760.33 1558.5,-2760.33 1558.5,-2828.33"/>
<text text-anchor="middle" x="1324.5" y="-2813.13" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="1324.5" y="-2798.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1324.5" y="-2783.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1324.5" y="-2768.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Input&#45;&gt;Layer0_V_Linear -->
<g id="edge3" class="edge">
<title>Input&#45;&gt;Layer0_V_Linear</title>
<path fill="none" stroke="black" d="M1171.51,-2866.37C1195.4,-2855.28 1220.72,-2843.52 1243.74,-2832.83"/>
<polygon fill="black" stroke="black" points="1245.52,-2835.86 1253.12,-2828.48 1242.58,-2829.51 1245.52,-2835.86"/>
</g>
<!-- Layer0_Add1 -->
<g id="node13" class="node">
<title>Layer0_Add1</title>
<polygon fill="none" stroke="black" points="1708,-2100.33 1231,-2100.33 1231,-2032.33 1708,-2032.33 1708,-2100.33"/>
<text text-anchor="middle" x="1469.5" y="-2085.13" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1469.5" y="-2070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="1469.5" y="-2055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1469.5" y="-2040.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Input&#45;&gt;Layer0_Add1 -->
<g id="edge15" class="edge">
<title>Input&#45;&gt;Layer0_Add1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1361.83,-2888.55C1450.95,-2876.09 1534.5,-2857.09 1567.5,-2828.33 1615.61,-2786.41 1610.5,-2755.15 1610.5,-2691.33 1610.5,-2691.33 1610.5,-2691.33 1610.5,-2273.33 1610.5,-2209.9 1607.76,-2187.67 1570.5,-2136.33 1562.37,-2125.13 1551.83,-2115.16 1540.64,-2106.52"/>
<polygon fill="black" stroke="black" points="1542.53,-2103.57 1532.4,-2100.46 1538.39,-2109.21 1542.53,-2103.57"/>
</g>
<!-- Layer0_Reshape_Q -->
<g id="node5" class="node">
<title>Layer0_Reshape_Q</title>
<polygon fill="none" stroke="black" points="563,-2724.33 0,-2724.33 0,-2656.33 563,-2656.33 563,-2724.33"/>
<text text-anchor="middle" x="281.5" y="-2709.13" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="281.5" y="-2694.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="281.5" y="-2679.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="281.5" y="-2664.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Q_Linear&#45;&gt;Layer0_Reshape_Q -->
<g id="edge4" class="edge">
<title>Layer0_Q_Linear&#45;&gt;Layer0_Reshape_Q</title>
<path fill="none" stroke="black" d="M313.24,-2760.22C309.38,-2751.84 305.18,-2742.73 301.14,-2733.96"/>
<polygon fill="black" stroke="black" points="304.21,-2732.25 296.84,-2724.63 297.85,-2735.18 304.21,-2732.25"/>
</g>
<!-- Layer0_Reshape_K -->
<g id="node6" class="node">
<title>Layer0_Reshape_K</title>
<polygon fill="none" stroke="black" points="1144,-2724.33 581,-2724.33 581,-2656.33 1144,-2656.33 1144,-2724.33"/>
<text text-anchor="middle" x="862.5" y="-2709.13" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="862.5" y="-2694.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="862.5" y="-2679.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="862.5" y="-2664.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_K_Linear&#45;&gt;Layer0_Reshape_K -->
<g id="edge5" class="edge">
<title>Layer0_K_Linear&#45;&gt;Layer0_Reshape_K</title>
<path fill="none" stroke="black" d="M846.29,-2760.22C848.22,-2752.02 850.31,-2743.12 852.34,-2734.52"/>
<polygon fill="black" stroke="black" points="855.78,-2735.17 854.66,-2724.63 848.97,-2733.56 855.78,-2735.17"/>
</g>
<!-- Layer0_Reshape_V -->
<g id="node7" class="node">
<title>Layer0_Reshape_V</title>
<polygon fill="none" stroke="black" points="1582,-2620.33 1019,-2620.33 1019,-2552.33 1582,-2552.33 1582,-2620.33"/>
<text text-anchor="middle" x="1300.5" y="-2605.13" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1300.5" y="-2590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1300.5" y="-2575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1300.5" y="-2560.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_V_Linear&#45;&gt;Layer0_Reshape_V -->
<g id="edge6" class="edge">
<title>Layer0_V_Linear&#45;&gt;Layer0_Reshape_V</title>
<path fill="none" stroke="black" d="M1320.64,-2760.24C1316.55,-2725.1 1310.06,-2669.41 1305.56,-2630.76"/>
<polygon fill="black" stroke="black" points="1308.98,-2629.88 1304.35,-2620.35 1302.03,-2630.69 1308.98,-2629.88"/>
</g>
<!-- Layer0_Attention_Score -->
<g id="node8" class="node">
<title>Layer0_Attention_Score</title>
<polygon fill="none" stroke="black" points="1000.5,-2620.33 428.5,-2620.33 428.5,-2552.33 1000.5,-2552.33 1000.5,-2620.33"/>
<text text-anchor="middle" x="714.5" y="-2605.13" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="714.5" y="-2590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]×2</text>
<text text-anchor="middle" x="714.5" y="-2575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="714.5" y="-2560.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Reshape_Q&#45;&gt;Layer0_Attention_Score -->
<g id="edge7" class="edge">
<title>Layer0_Reshape_Q&#45;&gt;Layer0_Attention_Score</title>
<path fill="none" stroke="black" d="M421.78,-2656.29C467.33,-2645.56 518.03,-2633.61 564.27,-2622.72"/>
<polygon fill="black" stroke="black" points="565.14,-2626.11 574.07,-2620.41 563.53,-2619.3 565.14,-2626.11"/>
</g>
<!-- Layer0_Reshape_K&#45;&gt;Layer0_Attention_Score -->
<g id="edge8" class="edge">
<title>Layer0_Reshape_K&#45;&gt;Layer0_Attention_Score</title>
<path fill="none" stroke="black" d="M814.45,-2656.22C800.55,-2646.64 785.25,-2636.09 770.89,-2626.2"/>
<polygon fill="black" stroke="black" points="772.78,-2623.25 762.56,-2620.46 768.81,-2629.01 772.78,-2623.25"/>
</g>
<!-- Layer0_Attention_Output -->
<g id="node10" class="node">
<title>Layer0_Attention_Output</title>
<polygon fill="none" stroke="black" points="1582,-2412.33 1019,-2412.33 1019,-2344.33 1582,-2344.33 1582,-2412.33"/>
<text text-anchor="middle" x="1300.5" y="-2397.13" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1300.5" y="-2382.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1300.5" y="-2367.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1300.5" y="-2352.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Reshape_V&#45;&gt;Layer0_Attention_Output -->
<g id="edge9" class="edge">
<title>Layer0_Reshape_V&#45;&gt;Layer0_Attention_Output</title>
<path fill="none" stroke="black" d="M1300.5,-2552.24C1300.5,-2517.1 1300.5,-2461.41 1300.5,-2422.76"/>
<polygon fill="black" stroke="black" points="1304,-2422.35 1300.5,-2412.35 1297,-2422.35 1304,-2422.35"/>
</g>
<!-- Layer0_Attention_Softmax -->
<g id="node9" class="node">
<title>Layer0_Attention_Softmax</title>
<polygon fill="none" stroke="black" points="1135.5,-2516.33 569.5,-2516.33 569.5,-2448.33 1135.5,-2448.33 1135.5,-2516.33"/>
<text text-anchor="middle" x="852.5" y="-2501.13" font-family="Times,serif" font-size="14.00">Attention Softmax</text>
<text text-anchor="middle" x="852.5" y="-2486.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="852.5" y="-2471.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="852.5" y="-2456.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Attention_Score&#45;&gt;Layer0_Attention_Softmax -->
<g id="edge10" class="edge">
<title>Layer0_Attention_Score&#45;&gt;Layer0_Attention_Softmax</title>
<path fill="none" stroke="black" d="M759.3,-2552.22C772.08,-2542.77 786.12,-2532.4 799.34,-2522.62"/>
<polygon fill="black" stroke="black" points="801.49,-2525.39 807.45,-2516.63 797.33,-2519.76 801.49,-2525.39"/>
</g>
<!-- Layer0_Attention_Softmax&#45;&gt;Layer0_Attention_Output -->
<g id="edge11" class="edge">
<title>Layer0_Attention_Softmax&#45;&gt;Layer0_Attention_Output</title>
<path fill="none" stroke="black" d="M997.64,-2448.29C1044.87,-2437.54 1097.45,-2425.56 1145.37,-2414.65"/>
<polygon fill="black" stroke="black" points="1146.23,-2418.05 1155.2,-2412.41 1144.68,-2411.22 1146.23,-2418.05"/>
</g>
<!-- Layer0_Reshape_Back -->
<g id="node11" class="node">
<title>Layer0_Reshape_Back</title>
<polygon fill="none" stroke="black" points="1579,-2308.33 1028,-2308.33 1028,-2240.33 1579,-2240.33 1579,-2308.33"/>
<text text-anchor="middle" x="1303.5" y="-2293.13" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1303.5" y="-2278.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1303.5" y="-2263.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1303.5" y="-2248.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Attention_Output&#45;&gt;Layer0_Reshape_Back -->
<g id="edge12" class="edge">
<title>Layer0_Attention_Output&#45;&gt;Layer0_Reshape_Back</title>
<path fill="none" stroke="black" d="M1301.47,-2344.22C1301.71,-2336.11 1301.97,-2327.32 1302.22,-2318.81"/>
<polygon fill="black" stroke="black" points="1305.73,-2318.73 1302.52,-2308.63 1298.73,-2318.53 1305.73,-2318.73"/>
</g>
<!-- Layer0_Output_Linear -->
<g id="node12" class="node">
<title>Layer0_Output_Linear</title>
<polygon fill="none" stroke="black" points="1561.5,-2204.33 1093.5,-2204.33 1093.5,-2136.33 1561.5,-2136.33 1561.5,-2204.33"/>
<text text-anchor="middle" x="1327.5" y="-2189.13" font-family="Times,serif" font-size="14.00">Output Linear</text>
<text text-anchor="middle" x="1327.5" y="-2174.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1327.5" y="-2159.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1327.5" y="-2144.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Reshape_Back&#45;&gt;Layer0_Output_Linear -->
<g id="edge13" class="edge">
<title>Layer0_Reshape_Back&#45;&gt;Layer0_Output_Linear</title>
<path fill="none" stroke="black" d="M1311.29,-2240.22C1313.22,-2232.02 1315.31,-2223.12 1317.34,-2214.52"/>
<polygon fill="black" stroke="black" points="1320.78,-2215.17 1319.66,-2204.63 1313.97,-2213.56 1320.78,-2215.17"/>
</g>
<!-- Layer0_Output_Linear&#45;&gt;Layer0_Add1 -->
<g id="edge14" class="edge">
<title>Layer0_Output_Linear&#45;&gt;Layer0_Add1</title>
<path fill="none" stroke="black" d="M1373.6,-2136.22C1386.75,-2126.77 1401.2,-2116.4 1414.8,-2106.62"/>
<polygon fill="black" stroke="black" points="1417.06,-2109.31 1423.14,-2100.63 1412.98,-2103.62 1417.06,-2109.31"/>
</g>
<!-- Layer0_MLP_Linear1 -->
<g id="node14" class="node">
<title>Layer0_MLP_Linear1</title>
<polygon fill="none" stroke="black" points="1575,-1996.33 1098,-1996.33 1098,-1928.33 1575,-1928.33 1575,-1996.33"/>
<text text-anchor="middle" x="1336.5" y="-1981.13" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="1336.5" y="-1966.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1336.5" y="-1951.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="1336.5" y="-1936.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Add1&#45;&gt;Layer0_MLP_Linear1 -->
<g id="edge16" class="edge">
<title>Layer0_Add1&#45;&gt;Layer0_MLP_Linear1</title>
<path fill="none" stroke="black" d="M1426.32,-2032.22C1414.12,-2022.86 1400.73,-2012.59 1388.09,-2002.9"/>
<polygon fill="black" stroke="black" points="1389.98,-1999.94 1379.92,-1996.63 1385.72,-2005.5 1389.98,-1999.94"/>
</g>
<!-- Layer0_Add2 -->
<g id="node17" class="node">
<title>Layer0_Add2</title>
<polygon fill="none" stroke="black" points="1711,-1684.33 1234,-1684.33 1234,-1616.33 1711,-1616.33 1711,-1684.33"/>
<text text-anchor="middle" x="1472.5" y="-1669.13" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1472.5" y="-1654.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="1472.5" y="-1639.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1472.5" y="-1624.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_Add1&#45;&gt;Layer0_Add2 -->
<g id="edge20" class="edge">
<title>Layer0_Add1&#45;&gt;Layer0_Add2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1548.55,-2032.32C1562.55,-2022.81 1575.26,-2010.94 1583.5,-1996.33 1643.73,-1889.47 1642.39,-1827.39 1582.5,-1720.33 1576.05,-1708.81 1566.8,-1698.95 1556.36,-1690.59"/>
<polygon fill="black" stroke="black" points="1558.28,-1687.66 1548.17,-1684.49 1554.1,-1693.27 1558.28,-1687.66"/>
</g>
<!-- Layer0_MLP_GELU -->
<g id="node15" class="node">
<title>Layer0_MLP_GELU</title>
<polygon fill="none" stroke="black" points="1575,-1892.33 1098,-1892.33 1098,-1824.33 1575,-1824.33 1575,-1892.33"/>
<text text-anchor="middle" x="1336.5" y="-1877.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1336.5" y="-1862.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="1336.5" y="-1847.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="1336.5" y="-1832.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_MLP_Linear1&#45;&gt;Layer0_MLP_GELU -->
<g id="edge17" class="edge">
<title>Layer0_MLP_Linear1&#45;&gt;Layer0_MLP_GELU</title>
<path fill="none" stroke="black" d="M1336.5,-1928.22C1336.5,-1920.11 1336.5,-1911.32 1336.5,-1902.81"/>
<polygon fill="black" stroke="black" points="1340,-1902.63 1336.5,-1892.63 1333,-1902.63 1340,-1902.63"/>
</g>
<!-- Layer0_MLP_Linear2 -->
<g id="node16" class="node">
<title>Layer0_MLP_Linear2</title>
<polygon fill="none" stroke="black" points="1573.5,-1788.33 1105.5,-1788.33 1105.5,-1720.33 1573.5,-1720.33 1573.5,-1788.33"/>
<text text-anchor="middle" x="1339.5" y="-1773.13" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="1339.5" y="-1758.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="1339.5" y="-1743.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1339.5" y="-1728.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- Layer0_MLP_GELU&#45;&gt;Layer0_MLP_Linear2 -->
<g id="edge18" class="edge">
<title>Layer0_MLP_GELU&#45;&gt;Layer0_MLP_Linear2</title>
<path fill="none" stroke="black" d="M1337.47,-1824.22C1337.71,-1816.11 1337.97,-1807.32 1338.22,-1798.81"/>
<polygon fill="black" stroke="black" points="1341.73,-1798.73 1338.52,-1788.63 1334.73,-1798.53 1341.73,-1798.73"/>
</g>
<!-- Layer0_MLP_Linear2&#45;&gt;Layer0_Add2 -->
<g id="edge19" class="edge">
<title>Layer0_MLP_Linear2&#45;&gt;Layer0_Add2</title>
<path fill="none" stroke="black" d="M1382.68,-1720.22C1394.88,-1710.86 1408.27,-1700.59 1420.91,-1690.9"/>
<polygon fill="black" stroke="black" points="1423.28,-1693.5 1429.08,-1684.63 1419.02,-1687.94 1423.28,-1693.5"/>
</g>
<!-- Comm0_1 -->
<g id="node18" class="node">
<title>Comm0_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1472.5" cy="-1532.25" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="1472.5" y="-1551.05" font-family="Times,serif" font-size="14.00">GPU&#45;to&#45;GPU Transfer</text>
<text text-anchor="middle" x="1472.5" y="-1536.05" font-family="Times,serif" font-size="14.00">GPU 0 → GPU 1</text>
<text text-anchor="middle" x="1472.5" y="-1521.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1472.5" y="-1506.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
</g>
<!-- Layer0_Add2&#45;&gt;Comm0_1 -->
<g id="edge21" class="edge">
<title>Layer0_Add2&#45;&gt;Comm0_1</title>
<path fill="none" stroke="black" d="M1472.5,-1616.07C1472.5,-1608.07 1472.5,-1599.31 1472.5,-1590.57"/>
<polygon fill="black" stroke="black" points="1476,-1590.36 1472.5,-1580.36 1469,-1590.36 1476,-1590.36"/>
</g>
<!-- Layer1_Q_Linear -->
<g id="node19" class="node">
<title>Layer1_Q_Linear</title>
<polygon fill="none" stroke="black" points="953.5,-1448.17 485.5,-1448.17 485.5,-1380.17 953.5,-1380.17 953.5,-1448.17"/>
<text text-anchor="middle" x="719.5" y="-1432.97" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="719.5" y="-1417.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="719.5" y="-1402.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="719.5" y="-1387.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Comm0_1&#45;&gt;Layer1_Q_Linear -->
<g id="edge22" class="edge">
<title>Comm0_1&#45;&gt;Layer1_Q_Linear</title>
<path fill="none" stroke="black" d="M1248.87,-1496.77C1152.56,-1481.93 1040.17,-1464.6 943.79,-1449.74"/>
<polygon fill="black" stroke="black" points="944.03,-1446.24 933.62,-1448.17 942.97,-1453.16 944.03,-1446.24"/>
</g>
<!-- Layer1_K_Linear -->
<g id="node20" class="node">
<title>Layer1_K_Linear</title>
<polygon fill="none" stroke="black" points="1463.5,-1448.17 995.5,-1448.17 995.5,-1380.17 1463.5,-1380.17 1463.5,-1448.17"/>
<text text-anchor="middle" x="1229.5" y="-1432.97" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="1229.5" y="-1417.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1229.5" y="-1402.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1229.5" y="-1387.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Comm0_1&#45;&gt;Layer1_K_Linear -->
<g id="edge23" class="edge">
<title>Comm0_1&#45;&gt;Layer1_K_Linear</title>
<path fill="none" stroke="black" d="M1377.85,-1486.04C1354.66,-1474.96 1330.1,-1463.22 1307.77,-1452.56"/>
<polygon fill="black" stroke="black" points="1309.21,-1449.37 1298.68,-1448.22 1306.2,-1455.68 1309.21,-1449.37"/>
</g>
<!-- Layer1_V_Linear -->
<g id="node21" class="node">
<title>Layer1_V_Linear</title>
<polygon fill="none" stroke="black" points="1949.5,-1448.17 1481.5,-1448.17 1481.5,-1380.17 1949.5,-1380.17 1949.5,-1448.17"/>
<text text-anchor="middle" x="1715.5" y="-1432.97" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="1715.5" y="-1417.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1715.5" y="-1402.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1715.5" y="-1387.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Comm0_1&#45;&gt;Layer1_V_Linear -->
<g id="edge24" class="edge">
<title>Comm0_1&#45;&gt;Layer1_V_Linear</title>
<path fill="none" stroke="black" d="M1567.15,-1486.04C1590.34,-1474.96 1614.9,-1463.22 1637.23,-1452.56"/>
<polygon fill="black" stroke="black" points="1638.8,-1455.68 1646.32,-1448.22 1635.79,-1449.37 1638.8,-1455.68"/>
</g>
<!-- Layer1_Add1 -->
<g id="node30" class="node">
<title>Layer1_Add1</title>
<polygon fill="none" stroke="black" points="2076,-720.17 1599,-720.17 1599,-652.17 2076,-652.17 2076,-720.17"/>
<text text-anchor="middle" x="1837.5" y="-704.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1837.5" y="-689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="1837.5" y="-674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1837.5" y="-659.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Comm0_1&#45;&gt;Layer1_Add1 -->
<g id="edge36" class="edge">
<title>Comm0_1&#45;&gt;Layer1_Add1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1761.65,-1508.77C1847.9,-1496.4 1927.71,-1477.36 1958.5,-1448.17 2003.8,-1405.21 1989.5,-1373.59 1989.5,-1311.17 1989.5,-1311.17 1989.5,-1311.17 1989.5,-893.17 1989.5,-829.74 1987.96,-806.61 1949.5,-756.17 1940.73,-744.66 1929.43,-734.62 1917.4,-726.02"/>
<polygon fill="black" stroke="black" points="1919.22,-723.03 1908.98,-720.31 1915.29,-728.82 1919.22,-723.03"/>
</g>
<!-- Layer1_Reshape_Q -->
<g id="node22" class="node">
<title>Layer1_Reshape_Q</title>
<polygon fill="none" stroke="black" points="954,-1344.17 391,-1344.17 391,-1276.17 954,-1276.17 954,-1344.17"/>
<text text-anchor="middle" x="672.5" y="-1328.97" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="672.5" y="-1313.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="672.5" y="-1298.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="672.5" y="-1283.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Q_Linear&#45;&gt;Layer1_Reshape_Q -->
<g id="edge25" class="edge">
<title>Layer1_Q_Linear&#45;&gt;Layer1_Reshape_Q</title>
<path fill="none" stroke="black" d="M704.24,-1380.05C700.38,-1371.68 696.18,-1362.57 692.14,-1353.8"/>
<polygon fill="black" stroke="black" points="695.21,-1352.08 687.84,-1344.47 688.85,-1355.01 695.21,-1352.08"/>
</g>
<!-- Layer1_Reshape_K -->
<g id="node23" class="node">
<title>Layer1_Reshape_K</title>
<polygon fill="none" stroke="black" points="1535,-1344.17 972,-1344.17 972,-1276.17 1535,-1276.17 1535,-1344.17"/>
<text text-anchor="middle" x="1253.5" y="-1328.97" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1253.5" y="-1313.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1253.5" y="-1298.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1253.5" y="-1283.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_K_Linear&#45;&gt;Layer1_Reshape_K -->
<g id="edge26" class="edge">
<title>Layer1_K_Linear&#45;&gt;Layer1_Reshape_K</title>
<path fill="none" stroke="black" d="M1237.29,-1380.05C1239.22,-1371.86 1241.31,-1362.96 1243.34,-1354.36"/>
<polygon fill="black" stroke="black" points="1246.78,-1355 1245.66,-1344.47 1239.97,-1353.4 1246.78,-1355"/>
</g>
<!-- Layer1_Reshape_V -->
<g id="node24" class="node">
<title>Layer1_Reshape_V</title>
<polygon fill="none" stroke="black" points="1961,-1240.17 1398,-1240.17 1398,-1172.17 1961,-1172.17 1961,-1240.17"/>
<text text-anchor="middle" x="1679.5" y="-1224.97" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1679.5" y="-1209.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1679.5" y="-1194.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1679.5" y="-1179.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_V_Linear&#45;&gt;Layer1_Reshape_V -->
<g id="edge27" class="edge">
<title>Layer1_V_Linear&#45;&gt;Layer1_Reshape_V</title>
<path fill="none" stroke="black" d="M1709.72,-1380.07C1703.55,-1344.78 1693.76,-1288.77 1687,-1250.1"/>
<polygon fill="black" stroke="black" points="1690.44,-1249.43 1685.27,-1240.18 1683.54,-1250.64 1690.44,-1249.43"/>
</g>
<!-- Layer1_Attention_Score -->
<g id="node25" class="node">
<title>Layer1_Attention_Score</title>
<polygon fill="none" stroke="black" points="1379.5,-1240.17 807.5,-1240.17 807.5,-1172.17 1379.5,-1172.17 1379.5,-1240.17"/>
<text text-anchor="middle" x="1093.5" y="-1224.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="1093.5" y="-1209.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]×2</text>
<text text-anchor="middle" x="1093.5" y="-1194.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1093.5" y="-1179.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Reshape_Q&#45;&gt;Layer1_Attention_Score -->
<g id="edge28" class="edge">
<title>Layer1_Reshape_Q&#45;&gt;Layer1_Attention_Score</title>
<path fill="none" stroke="black" d="M808.9,-1276.12C853.09,-1265.41 902.27,-1253.5 947.15,-1242.62"/>
<polygon fill="black" stroke="black" points="948.07,-1246 956.96,-1240.25 946.42,-1239.2 948.07,-1246"/>
</g>
<!-- Layer1_Reshape_K&#45;&gt;Layer1_Attention_Score -->
<g id="edge29" class="edge">
<title>Layer1_Reshape_K&#45;&gt;Layer1_Attention_Score</title>
<path fill="none" stroke="black" d="M1201.55,-1276.05C1186.39,-1266.38 1169.68,-1255.73 1154.03,-1245.75"/>
<polygon fill="black" stroke="black" points="1155.77,-1242.72 1145.46,-1240.29 1152.01,-1248.62 1155.77,-1242.72"/>
</g>
<!-- Layer1_Attention_Output -->
<g id="node27" class="node">
<title>Layer1_Attention_Output</title>
<polygon fill="none" stroke="black" points="1961,-1032.17 1398,-1032.17 1398,-964.17 1961,-964.17 1961,-1032.17"/>
<text text-anchor="middle" x="1679.5" y="-1016.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1679.5" y="-1001.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1679.5" y="-986.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1679.5" y="-971.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Reshape_V&#45;&gt;Layer1_Attention_Output -->
<g id="edge30" class="edge">
<title>Layer1_Reshape_V&#45;&gt;Layer1_Attention_Output</title>
<path fill="none" stroke="black" d="M1679.5,-1172.07C1679.5,-1136.93 1679.5,-1081.24 1679.5,-1042.6"/>
<polygon fill="black" stroke="black" points="1683,-1042.18 1679.5,-1032.18 1676,-1042.18 1683,-1042.18"/>
</g>
<!-- Layer1_Attention_Softmax -->
<g id="node26" class="node">
<title>Layer1_Attention_Softmax</title>
<polygon fill="none" stroke="black" points="1514.5,-1136.17 948.5,-1136.17 948.5,-1068.17 1514.5,-1068.17 1514.5,-1136.17"/>
<text text-anchor="middle" x="1231.5" y="-1120.97" font-family="Times,serif" font-size="14.00">Attention Softmax</text>
<text text-anchor="middle" x="1231.5" y="-1105.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1231.5" y="-1090.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1231.5" y="-1075.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Attention_Score&#45;&gt;Layer1_Attention_Softmax -->
<g id="edge31" class="edge">
<title>Layer1_Attention_Score&#45;&gt;Layer1_Attention_Softmax</title>
<path fill="none" stroke="black" d="M1138.3,-1172.05C1151.08,-1162.61 1165.12,-1152.23 1178.34,-1142.46"/>
<polygon fill="black" stroke="black" points="1180.49,-1145.22 1186.45,-1136.47 1176.33,-1139.6 1180.49,-1145.22"/>
</g>
<!-- Layer1_Attention_Softmax&#45;&gt;Layer1_Attention_Output -->
<g id="edge32" class="edge">
<title>Layer1_Attention_Softmax&#45;&gt;Layer1_Attention_Output</title>
<path fill="none" stroke="black" d="M1376.64,-1068.12C1423.87,-1057.37 1476.45,-1045.4 1524.37,-1034.49"/>
<polygon fill="black" stroke="black" points="1525.23,-1037.88 1534.2,-1032.25 1523.68,-1031.05 1525.23,-1037.88"/>
</g>
<!-- Layer1_Reshape_Back -->
<g id="node28" class="node">
<title>Layer1_Reshape_Back</title>
<polygon fill="none" stroke="black" points="1958,-928.17 1407,-928.17 1407,-860.17 1958,-860.17 1958,-928.17"/>
<text text-anchor="middle" x="1682.5" y="-912.97" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1682.5" y="-897.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1682.5" y="-882.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1682.5" y="-867.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Attention_Output&#45;&gt;Layer1_Reshape_Back -->
<g id="edge33" class="edge">
<title>Layer1_Attention_Output&#45;&gt;Layer1_Reshape_Back</title>
<path fill="none" stroke="black" d="M1680.47,-964.05C1680.71,-955.94 1680.97,-947.15 1681.22,-938.64"/>
<polygon fill="black" stroke="black" points="1684.73,-938.56 1681.52,-928.47 1677.73,-938.36 1684.73,-938.56"/>
</g>
<!-- Layer1_Output_Linear -->
<g id="node29" class="node">
<title>Layer1_Output_Linear</title>
<polygon fill="none" stroke="black" points="1940.5,-824.17 1472.5,-824.17 1472.5,-756.17 1940.5,-756.17 1940.5,-824.17"/>
<text text-anchor="middle" x="1706.5" y="-808.97" font-family="Times,serif" font-size="14.00">Output Linear</text>
<text text-anchor="middle" x="1706.5" y="-793.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1706.5" y="-778.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1706.5" y="-763.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Reshape_Back&#45;&gt;Layer1_Output_Linear -->
<g id="edge34" class="edge">
<title>Layer1_Reshape_Back&#45;&gt;Layer1_Output_Linear</title>
<path fill="none" stroke="black" d="M1690.29,-860.05C1692.22,-851.86 1694.31,-842.96 1696.34,-834.36"/>
<polygon fill="black" stroke="black" points="1699.78,-835 1698.66,-824.47 1692.97,-833.4 1699.78,-835"/>
</g>
<!-- Layer1_Output_Linear&#45;&gt;Layer1_Add1 -->
<g id="edge35" class="edge">
<title>Layer1_Output_Linear&#45;&gt;Layer1_Add1</title>
<path fill="none" stroke="black" d="M1749.03,-756.05C1761.04,-746.7 1774.24,-736.43 1786.68,-726.73"/>
<polygon fill="black" stroke="black" points="1788.99,-729.37 1794.73,-720.47 1784.69,-723.85 1788.99,-729.37"/>
</g>
<!-- Layer1_MLP_Linear1 -->
<g id="node31" class="node">
<title>Layer1_MLP_Linear1</title>
<polygon fill="none" stroke="black" points="1943,-616.17 1466,-616.17 1466,-548.17 1943,-548.17 1943,-616.17"/>
<text text-anchor="middle" x="1704.5" y="-600.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="1704.5" y="-585.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1704.5" y="-570.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="1704.5" y="-555.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Add1&#45;&gt;Layer1_MLP_Linear1 -->
<g id="edge37" class="edge">
<title>Layer1_Add1&#45;&gt;Layer1_MLP_Linear1</title>
<path fill="none" stroke="black" d="M1794.32,-652.05C1782.12,-642.7 1768.73,-632.43 1756.09,-622.73"/>
<polygon fill="black" stroke="black" points="1757.98,-619.77 1747.92,-616.47 1753.72,-625.33 1757.98,-619.77"/>
</g>
<!-- Layer1_Add2 -->
<g id="node34" class="node">
<title>Layer1_Add2</title>
<polygon fill="none" stroke="black" points="2077,-304.17 1600,-304.17 1600,-236.17 2077,-236.17 2077,-304.17"/>
<text text-anchor="middle" x="1838.5" y="-288.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1838.5" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="1838.5" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1838.5" y="-243.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_Add1&#45;&gt;Layer1_Add2 -->
<g id="edge41" class="edge">
<title>Layer1_Add1&#45;&gt;Layer1_Add2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1916.55,-652.16C1930.55,-642.65 1943.26,-630.78 1951.5,-616.17 2011.73,-509.3 2010.83,-446.98 1950.5,-340.17 1943.97,-328.6 1934.62,-318.73 1924.07,-310.37"/>
<polygon fill="black" stroke="black" points="1925.93,-307.39 1915.8,-304.28 1921.78,-313.03 1925.93,-307.39"/>
</g>
<!-- Layer1_MLP_GELU -->
<g id="node32" class="node">
<title>Layer1_MLP_GELU</title>
<polygon fill="none" stroke="black" points="1943,-512.17 1466,-512.17 1466,-444.17 1943,-444.17 1943,-512.17"/>
<text text-anchor="middle" x="1704.5" y="-496.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1704.5" y="-481.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="1704.5" y="-466.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="1704.5" y="-451.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_MLP_Linear1&#45;&gt;Layer1_MLP_GELU -->
<g id="edge38" class="edge">
<title>Layer1_MLP_Linear1&#45;&gt;Layer1_MLP_GELU</title>
<path fill="none" stroke="black" d="M1704.5,-548.05C1704.5,-539.94 1704.5,-531.15 1704.5,-522.64"/>
<polygon fill="black" stroke="black" points="1708,-522.47 1704.5,-512.47 1701,-522.47 1708,-522.47"/>
</g>
<!-- Layer1_MLP_Linear2 -->
<g id="node33" class="node">
<title>Layer1_MLP_Linear2</title>
<polygon fill="none" stroke="black" points="1941.5,-408.17 1473.5,-408.17 1473.5,-340.17 1941.5,-340.17 1941.5,-408.17"/>
<text text-anchor="middle" x="1707.5" y="-392.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="1707.5" y="-377.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="1707.5" y="-362.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1707.5" y="-347.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- Layer1_MLP_GELU&#45;&gt;Layer1_MLP_Linear2 -->
<g id="edge39" class="edge">
<title>Layer1_MLP_GELU&#45;&gt;Layer1_MLP_Linear2</title>
<path fill="none" stroke="black" d="M1705.47,-444.05C1705.71,-435.94 1705.97,-427.15 1706.22,-418.64"/>
<polygon fill="black" stroke="black" points="1709.73,-418.56 1706.52,-408.47 1702.73,-418.36 1709.73,-418.56"/>
</g>
<!-- Layer1_MLP_Linear2&#45;&gt;Layer1_Add2 -->
<g id="edge40" class="edge">
<title>Layer1_MLP_Linear2&#45;&gt;Layer1_Add2</title>
<path fill="none" stroke="black" d="M1750.03,-340.05C1762.04,-330.7 1775.24,-320.43 1787.68,-310.73"/>
<polygon fill="black" stroke="black" points="1789.99,-313.37 1795.73,-304.47 1785.69,-307.85 1789.99,-313.37"/>
</g>
<!-- Comm1_2 -->
<g id="node35" class="node">
<title>Comm1_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1838.5" cy="-152.08" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="1838.5" y="-170.88" font-family="Times,serif" font-size="14.00">GPU&#45;to&#45;GPU Transfer</text>
<text text-anchor="middle" x="1838.5" y="-155.88" font-family="Times,serif" font-size="14.00">GPU 1 → GPU 2</text>
<text text-anchor="middle" x="1838.5" y="-140.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1838.5" y="-125.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
</g>
<!-- Layer1_Add2&#45;&gt;Comm1_2 -->
<g id="edge42" class="edge">
<title>Layer1_Add2&#45;&gt;Comm1_2</title>
<path fill="none" stroke="black" d="M1838.5,-235.9C1838.5,-227.91 1838.5,-219.14 1838.5,-210.4"/>
<polygon fill="black" stroke="black" points="1842,-210.19 1838.5,-200.19 1835,-210.19 1842,-210.19"/>
</g>
<!-- Layer2_Q_Linear -->
<g id="node36" class="node">
<title>Layer2_Q_Linear</title>
<polygon fill="none" stroke="black" points="2072.5,-68 1604.5,-68 1604.5,0 2072.5,0 2072.5,-68"/>
<text text-anchor="middle" x="1838.5" y="-52.8" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="1838.5" y="-37.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1838.5" y="-22.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1838.5" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Comm1_2&#45;&gt;Layer2_Q_Linear -->
<g id="edge43" class="edge">
<title>Comm1_2&#45;&gt;Layer2_Q_Linear</title>
<path fill="none" stroke="black" d="M1838.5,-103.87C1838.5,-95.48 1838.5,-86.78 1838.5,-78.51"/>
<polygon fill="black" stroke="black" points="1842,-78.3 1838.5,-68.3 1835,-78.3 1842,-78.3"/>
</g>
<!-- Layer2_K_Linear -->
<g id="node37" class="node">
<title>Layer2_K_Linear</title>
<polygon fill="none" stroke="black" points="2009.5,-2946.42 1541.5,-2946.42 1541.5,-2878.42 2009.5,-2878.42 2009.5,-2946.42"/>
<text text-anchor="middle" x="1775.5" y="-2931.22" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="1775.5" y="-2916.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1775.5" y="-2901.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1775.5" y="-2886.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Layer2_V_Linear -->
<g id="node38" class="node">
<title>Layer2_V_Linear</title>
<polygon fill="none" stroke="black" points="2554.5,-2946.42 2086.5,-2946.42 2086.5,-2878.42 2554.5,-2878.42 2554.5,-2946.42"/>
<text text-anchor="middle" x="2320.5" y="-2931.22" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="2320.5" y="-2916.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2320.5" y="-2901.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2320.5" y="-2886.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- Comm14_15 -->
<g id="node39" class="node">
<title>Comm14_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2933.5" cy="-2912.42" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="2933.5" y="-2931.22" font-family="Times,serif" font-size="14.00">GPU&#45;to&#45;GPU Transfer</text>
<text text-anchor="middle" x="2933.5" y="-2916.22" font-family="Times,serif" font-size="14.00">GPU 14 → GPU 15</text>
<text text-anchor="middle" x="2933.5" y="-2901.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2933.5" y="-2886.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
</g>
<!-- Layer15_Q_Linear -->
<g id="node40" class="node">
<title>Layer15_Q_Linear</title>
<polygon fill="none" stroke="black" points="2394.5,-2828.33 1926.5,-2828.33 1926.5,-2760.33 2394.5,-2760.33 2394.5,-2828.33"/>
<text text-anchor="middle" x="2160.5" y="-2813.13" font-family="Times,serif" font-size="14.00">Q Linear</text>
<text text-anchor="middle" x="2160.5" y="-2798.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2160.5" y="-2783.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2160.5" y="-2768.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Comm14_15&#45;&gt;Layer15_Q_Linear -->
<g id="edge44" class="edge">
<title>Comm14_15&#45;&gt;Layer15_Q_Linear</title>
<path fill="none" stroke="black" d="M2706.8,-2877.37C2607.21,-2862.42 2490.43,-2844.88 2390.47,-2829.87"/>
<polygon fill="black" stroke="black" points="2390.95,-2826.4 2380.54,-2828.38 2389.91,-2833.32 2390.95,-2826.4"/>
</g>
<!-- Layer15_K_Linear -->
<g id="node41" class="node">
<title>Layer15_K_Linear</title>
<polygon fill="none" stroke="black" points="2927.5,-2828.33 2459.5,-2828.33 2459.5,-2760.33 2927.5,-2760.33 2927.5,-2828.33"/>
<text text-anchor="middle" x="2693.5" y="-2813.13" font-family="Times,serif" font-size="14.00">K Linear</text>
<text text-anchor="middle" x="2693.5" y="-2798.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2693.5" y="-2783.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2693.5" y="-2768.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Comm14_15&#45;&gt;Layer15_K_Linear -->
<g id="edge45" class="edge">
<title>Comm14_15&#45;&gt;Layer15_K_Linear</title>
<path fill="none" stroke="black" d="M2840.02,-2866.2C2817.22,-2855.17 2793.07,-2843.49 2771.1,-2832.87"/>
<polygon fill="black" stroke="black" points="2772.35,-2829.59 2761.83,-2828.38 2769.31,-2835.89 2772.35,-2829.59"/>
</g>
<!-- Layer15_V_Linear -->
<g id="node42" class="node">
<title>Layer15_V_Linear</title>
<polygon fill="none" stroke="black" points="3413.5,-2828.33 2945.5,-2828.33 2945.5,-2760.33 3413.5,-2760.33 3413.5,-2828.33"/>
<text text-anchor="middle" x="3179.5" y="-2813.13" font-family="Times,serif" font-size="14.00">V Linear</text>
<text text-anchor="middle" x="3179.5" y="-2798.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3179.5" y="-2783.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3179.5" y="-2768.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Comm14_15&#45;&gt;Layer15_V_Linear -->
<g id="edge46" class="edge">
<title>Comm14_15&#45;&gt;Layer15_V_Linear</title>
<path fill="none" stroke="black" d="M3028.96,-2866.37C3052.47,-2855.28 3077.38,-2843.52 3100.04,-2832.83"/>
<polygon fill="black" stroke="black" points="3101.71,-2835.91 3109.26,-2828.48 3098.72,-2829.58 3101.71,-2835.91"/>
</g>
<!-- Layer15_Add1 -->
<g id="node51" class="node">
<title>Layer15_Add1</title>
<polygon fill="none" stroke="black" points="3562,-2100.33 3085,-2100.33 3085,-2032.33 3562,-2032.33 3562,-2100.33"/>
<text text-anchor="middle" x="3323.5" y="-2085.13" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="3323.5" y="-2070.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="3323.5" y="-2055.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3323.5" y="-2040.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Comm14_15&#45;&gt;Layer15_Add1 -->
<g id="edge58" class="edge">
<title>Comm14_15&#45;&gt;Layer15_Add1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3219.49,-2888.18C3307.53,-2875.7 3389.9,-2856.78 3422.5,-2828.33 3470.58,-2786.37 3465.5,-2755.15 3465.5,-2691.33 3465.5,-2691.33 3465.5,-2691.33 3465.5,-2273.33 3465.5,-2209.9 3462.87,-2187.59 3425.5,-2136.33 3417.29,-2125.07 3406.65,-2115.07 3395.35,-2106.42"/>
<polygon fill="black" stroke="black" points="3397.17,-2103.42 3387.02,-2100.37 3393.05,-2109.08 3397.17,-2103.42"/>
</g>
<!-- Layer15_Reshape_Q -->
<g id="node43" class="node">
<title>Layer15_Reshape_Q</title>
<polygon fill="none" stroke="black" points="2418,-2724.33 1855,-2724.33 1855,-2656.33 2418,-2656.33 2418,-2724.33"/>
<text text-anchor="middle" x="2136.5" y="-2709.13" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="2136.5" y="-2694.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2136.5" y="-2679.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="2136.5" y="-2664.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Q_Linear&#45;&gt;Layer15_Reshape_Q -->
<g id="edge47" class="edge">
<title>Layer15_Q_Linear&#45;&gt;Layer15_Reshape_Q</title>
<path fill="none" stroke="black" d="M2152.71,-2760.22C2150.78,-2752.02 2148.69,-2743.12 2146.66,-2734.52"/>
<polygon fill="black" stroke="black" points="2150.03,-2733.56 2144.34,-2724.63 2143.22,-2735.17 2150.03,-2733.56"/>
</g>
<!-- Layer15_Reshape_K -->
<g id="node44" class="node">
<title>Layer15_Reshape_K</title>
<polygon fill="none" stroke="black" points="2999,-2724.33 2436,-2724.33 2436,-2656.33 2999,-2656.33 2999,-2724.33"/>
<text text-anchor="middle" x="2717.5" y="-2709.13" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="2717.5" y="-2694.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="2717.5" y="-2679.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="2717.5" y="-2664.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_K_Linear&#45;&gt;Layer15_Reshape_K -->
<g id="edge48" class="edge">
<title>Layer15_K_Linear&#45;&gt;Layer15_Reshape_K</title>
<path fill="none" stroke="black" d="M2701.29,-2760.22C2703.22,-2752.02 2705.31,-2743.12 2707.34,-2734.52"/>
<polygon fill="black" stroke="black" points="2710.78,-2735.17 2709.66,-2724.63 2703.97,-2733.56 2710.78,-2735.17"/>
</g>
<!-- Layer15_Reshape_V -->
<g id="node45" class="node">
<title>Layer15_Reshape_V</title>
<polygon fill="none" stroke="black" points="3437,-2620.33 2874,-2620.33 2874,-2552.33 3437,-2552.33 3437,-2620.33"/>
<text text-anchor="middle" x="3155.5" y="-2605.13" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="3155.5" y="-2590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3155.5" y="-2575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="3155.5" y="-2560.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_V_Linear&#45;&gt;Layer15_Reshape_V -->
<g id="edge49" class="edge">
<title>Layer15_V_Linear&#45;&gt;Layer15_Reshape_V</title>
<path fill="none" stroke="black" d="M3175.64,-2760.24C3171.55,-2725.1 3165.06,-2669.41 3160.56,-2630.76"/>
<polygon fill="black" stroke="black" points="3163.98,-2629.88 3159.35,-2620.35 3157.03,-2630.69 3163.98,-2629.88"/>
</g>
<!-- Layer15_Attention_Score -->
<g id="node46" class="node">
<title>Layer15_Attention_Score</title>
<polygon fill="none" stroke="black" points="2855.5,-2620.33 2283.5,-2620.33 2283.5,-2552.33 2855.5,-2552.33 2855.5,-2620.33"/>
<text text-anchor="middle" x="2569.5" y="-2605.13" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="2569.5" y="-2590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]×2</text>
<text text-anchor="middle" x="2569.5" y="-2575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2569.5" y="-2560.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Reshape_Q&#45;&gt;Layer15_Attention_Score -->
<g id="edge50" class="edge">
<title>Layer15_Reshape_Q&#45;&gt;Layer15_Attention_Score</title>
<path fill="none" stroke="black" d="M2276.78,-2656.29C2322.33,-2645.56 2373.03,-2633.61 2419.27,-2622.72"/>
<polygon fill="black" stroke="black" points="2420.14,-2626.11 2429.07,-2620.41 2418.53,-2619.3 2420.14,-2626.11"/>
</g>
<!-- Layer15_Reshape_K&#45;&gt;Layer15_Attention_Score -->
<g id="edge51" class="edge">
<title>Layer15_Reshape_K&#45;&gt;Layer15_Attention_Score</title>
<path fill="none" stroke="black" d="M2669.45,-2656.22C2655.55,-2646.64 2640.25,-2636.09 2625.89,-2626.2"/>
<polygon fill="black" stroke="black" points="2627.78,-2623.25 2617.56,-2620.46 2623.81,-2629.01 2627.78,-2623.25"/>
</g>
<!-- Layer15_Attention_Output -->
<g id="node48" class="node">
<title>Layer15_Attention_Output</title>
<polygon fill="none" stroke="black" points="3437,-2412.33 2874,-2412.33 2874,-2344.33 3437,-2344.33 3437,-2412.33"/>
<text text-anchor="middle" x="3155.5" y="-2397.13" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3155.5" y="-2382.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="3155.5" y="-2367.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="3155.5" y="-2352.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Reshape_V&#45;&gt;Layer15_Attention_Output -->
<g id="edge52" class="edge">
<title>Layer15_Reshape_V&#45;&gt;Layer15_Attention_Output</title>
<path fill="none" stroke="black" d="M3155.5,-2552.24C3155.5,-2517.1 3155.5,-2461.41 3155.5,-2422.76"/>
<polygon fill="black" stroke="black" points="3159,-2422.35 3155.5,-2412.35 3152,-2422.35 3159,-2422.35"/>
</g>
<!-- Layer15_Attention_Softmax -->
<g id="node47" class="node">
<title>Layer15_Attention_Softmax</title>
<polygon fill="none" stroke="black" points="2990.5,-2516.33 2424.5,-2516.33 2424.5,-2448.33 2990.5,-2448.33 2990.5,-2516.33"/>
<text text-anchor="middle" x="2707.5" y="-2501.13" font-family="Times,serif" font-size="14.00">Attention Softmax</text>
<text text-anchor="middle" x="2707.5" y="-2486.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2707.5" y="-2471.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="2707.5" y="-2456.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Attention_Score&#45;&gt;Layer15_Attention_Softmax -->
<g id="edge53" class="edge">
<title>Layer15_Attention_Score&#45;&gt;Layer15_Attention_Softmax</title>
<path fill="none" stroke="black" d="M2614.3,-2552.22C2627.08,-2542.77 2641.12,-2532.4 2654.34,-2522.62"/>
<polygon fill="black" stroke="black" points="2656.49,-2525.39 2662.45,-2516.63 2652.33,-2519.76 2656.49,-2525.39"/>
</g>
<!-- Layer15_Attention_Softmax&#45;&gt;Layer15_Attention_Output -->
<g id="edge54" class="edge">
<title>Layer15_Attention_Softmax&#45;&gt;Layer15_Attention_Output</title>
<path fill="none" stroke="black" d="M2852.64,-2448.29C2899.87,-2437.54 2952.45,-2425.56 3000.37,-2414.65"/>
<polygon fill="black" stroke="black" points="3001.23,-2418.05 3010.2,-2412.41 2999.68,-2411.22 3001.23,-2418.05"/>
</g>
<!-- Layer15_Reshape_Back -->
<g id="node49" class="node">
<title>Layer15_Reshape_Back</title>
<polygon fill="none" stroke="black" points="3434,-2308.33 2883,-2308.33 2883,-2240.33 3434,-2240.33 3434,-2308.33"/>
<text text-anchor="middle" x="3158.5" y="-2293.13" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="3158.5" y="-2278.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="3158.5" y="-2263.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3158.5" y="-2248.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Attention_Output&#45;&gt;Layer15_Reshape_Back -->
<g id="edge55" class="edge">
<title>Layer15_Attention_Output&#45;&gt;Layer15_Reshape_Back</title>
<path fill="none" stroke="black" d="M3156.47,-2344.22C3156.71,-2336.11 3156.97,-2327.32 3157.22,-2318.81"/>
<polygon fill="black" stroke="black" points="3160.73,-2318.73 3157.52,-2308.63 3153.73,-2318.53 3160.73,-2318.73"/>
</g>
<!-- Layer15_Output_Linear -->
<g id="node50" class="node">
<title>Layer15_Output_Linear</title>
<polygon fill="none" stroke="black" points="3416.5,-2204.33 2948.5,-2204.33 2948.5,-2136.33 3416.5,-2136.33 3416.5,-2204.33"/>
<text text-anchor="middle" x="3182.5" y="-2189.13" font-family="Times,serif" font-size="14.00">Output Linear</text>
<text text-anchor="middle" x="3182.5" y="-2174.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3182.5" y="-2159.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3182.5" y="-2144.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Reshape_Back&#45;&gt;Layer15_Output_Linear -->
<g id="edge56" class="edge">
<title>Layer15_Reshape_Back&#45;&gt;Layer15_Output_Linear</title>
<path fill="none" stroke="black" d="M3166.29,-2240.22C3168.22,-2232.02 3170.31,-2223.12 3172.34,-2214.52"/>
<polygon fill="black" stroke="black" points="3175.78,-2215.17 3174.66,-2204.63 3168.97,-2213.56 3175.78,-2215.17"/>
</g>
<!-- Layer15_Output_Linear&#45;&gt;Layer15_Add1 -->
<g id="edge57" class="edge">
<title>Layer15_Output_Linear&#45;&gt;Layer15_Add1</title>
<path fill="none" stroke="black" d="M3228.28,-2136.22C3241.33,-2126.77 3255.68,-2116.4 3269.19,-2106.62"/>
<polygon fill="black" stroke="black" points="3271.42,-2109.33 3277.47,-2100.63 3267.31,-2103.66 3271.42,-2109.33"/>
</g>
<!-- Layer15_MLP_Linear1 -->
<g id="node52" class="node">
<title>Layer15_MLP_Linear1</title>
<polygon fill="none" stroke="black" points="3428,-1996.33 2951,-1996.33 2951,-1928.33 3428,-1928.33 3428,-1996.33"/>
<text text-anchor="middle" x="3189.5" y="-1981.13" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="3189.5" y="-1966.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3189.5" y="-1951.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="3189.5" y="-1936.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Add1&#45;&gt;Layer15_MLP_Linear1 -->
<g id="edge59" class="edge">
<title>Layer15_Add1&#45;&gt;Layer15_MLP_Linear1</title>
<path fill="none" stroke="black" d="M3279.99,-2032.22C3267.71,-2022.86 3254.21,-2012.59 3241.48,-2002.9"/>
<polygon fill="black" stroke="black" points="3243.32,-1999.9 3233.25,-1996.63 3239.08,-2005.47 3243.32,-1999.9"/>
</g>
<!-- Layer15_Add2 -->
<g id="node55" class="node">
<title>Layer15_Add2</title>
<polygon fill="none" stroke="black" points="3563,-1684.33 3086,-1684.33 3086,-1616.33 3563,-1616.33 3563,-1684.33"/>
<text text-anchor="middle" x="3324.5" y="-1669.13" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="3324.5" y="-1654.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]×2</text>
<text text-anchor="middle" x="3324.5" y="-1639.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3324.5" y="-1624.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Add1&#45;&gt;Layer15_Add2 -->
<g id="edge63" class="edge">
<title>Layer15_Add1&#45;&gt;Layer15_Add2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3402.55,-2032.32C3416.55,-2022.81 3429.26,-2010.94 3437.5,-1996.33 3497.73,-1889.47 3496.13,-1826.97 3435.5,-1720.33 3428.93,-1708.78 3419.56,-1698.9 3409.01,-1690.54"/>
<polygon fill="black" stroke="black" points="3410.86,-1687.55 3400.74,-1684.43 3406.7,-1693.19 3410.86,-1687.55"/>
</g>
<!-- Layer15_MLP_GELU -->
<g id="node53" class="node">
<title>Layer15_MLP_GELU</title>
<polygon fill="none" stroke="black" points="3428,-1892.33 2951,-1892.33 2951,-1824.33 3428,-1824.33 3428,-1892.33"/>
<text text-anchor="middle" x="3189.5" y="-1877.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3189.5" y="-1862.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="3189.5" y="-1847.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="3189.5" y="-1832.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_MLP_Linear1&#45;&gt;Layer15_MLP_GELU -->
<g id="edge60" class="edge">
<title>Layer15_MLP_Linear1&#45;&gt;Layer15_MLP_GELU</title>
<path fill="none" stroke="black" d="M3189.5,-1928.22C3189.5,-1920.11 3189.5,-1911.32 3189.5,-1902.81"/>
<polygon fill="black" stroke="black" points="3193,-1902.63 3189.5,-1892.63 3186,-1902.63 3193,-1902.63"/>
</g>
<!-- Layer15_MLP_Linear2 -->
<g id="node54" class="node">
<title>Layer15_MLP_Linear2</title>
<polygon fill="none" stroke="black" points="3426.5,-1788.33 2958.5,-1788.33 2958.5,-1720.33 3426.5,-1720.33 3426.5,-1788.33"/>
<text text-anchor="middle" x="3192.5" y="-1773.13" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="3192.5" y="-1758.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=32768]</text>
<text text-anchor="middle" x="3192.5" y="-1743.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3192.5" y="-1728.13" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_MLP_GELU&#45;&gt;Layer15_MLP_Linear2 -->
<g id="edge61" class="edge">
<title>Layer15_MLP_GELU&#45;&gt;Layer15_MLP_Linear2</title>
<path fill="none" stroke="black" d="M3190.47,-1824.22C3190.71,-1816.11 3190.97,-1807.32 3191.22,-1798.81"/>
<polygon fill="black" stroke="black" points="3194.73,-1798.73 3191.52,-1788.63 3187.73,-1798.53 3194.73,-1798.73"/>
</g>
<!-- Layer15_MLP_Linear2&#45;&gt;Layer15_Add2 -->
<g id="edge62" class="edge">
<title>Layer15_MLP_Linear2&#45;&gt;Layer15_Add2</title>
<path fill="none" stroke="black" d="M3235.36,-1720.22C3247.46,-1710.86 3260.75,-1700.59 3273.29,-1690.9"/>
<polygon fill="black" stroke="black" points="3275.63,-1693.52 3281.41,-1684.63 3271.35,-1687.98 3275.63,-1693.52"/>
</g>
<!-- Output -->
<g id="node56" class="node">
<title>Output</title>
<ellipse fill="none" stroke="black" cx="3324.5" cy="-1532.25" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="3324.5" y="-1551.05" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3324.5" y="-1536.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3324.5" y="-1521.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="3324.5" y="-1506.05" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- Layer15_Add2&#45;&gt;Output -->
<g id="edge64" class="edge">
<title>Layer15_Add2&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M3324.5,-1616.07C3324.5,-1608.07 3324.5,-1599.31 3324.5,-1590.57"/>
<polygon fill="black" stroke="black" points="3328,-1590.36 3324.5,-1580.36 3321,-1590.36 3328,-1590.36"/>
</g>
</g>
</svg>
