<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_deployment Pages: 1 -->
<svg width="1055pt" height="2819pt"
 viewBox="0.00 0.00 1055.05 2819.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2815.5)">
<title>baseline_deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2815.5 1051.05,-2815.5 1051.05,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="407.75,-1481.83 407.75,-2667.5 935.75,-2667.5 935.75,-1481.83 407.75,-1481.83"/>
<text text-anchor="middle" x="671.75" y="-2652.3" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="671.75" y="-2637.3" font-family="Times,serif" font-size="14.00">GPUs: [0,1,2,3,4,5,6,7]</text>
<text text-anchor="middle" x="671.75" y="-2622.3" font-family="Times,serif" font-size="14.00">Tensor Parallel Group</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="407.75,-164 407.75,-1349.67 935.75,-1349.67 935.75,-164 407.75,-164"/>
<text text-anchor="middle" x="671.75" y="-1334.47" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="671.75" y="-1319.47" font-family="Times,serif" font-size="14.00">GPUs: [8,9,10,11,12,13,14,15]</text>
<text text-anchor="middle" x="671.75" y="-1304.47" font-family="Times,serif" font-size="14.00">Tensor Parallel Group</text>
</g>
<!-- ellipse -->
<g id="node1" class="node">
<title>ellipse</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="35.75" cy="-2743.5" rx="36" ry="18"/>
<text text-anchor="middle" x="35.75" y="-2739.8" font-family="Arial" font-size="14.00">ellipse</text>
</g>
<!-- parallelogram -->
<g id="node2" class="node">
<title>parallelogram</title>
<polygon fill="lightblue" stroke="lightblue" points="277.93,-2761.5 128.11,-2761.5 89.56,-2725.5 239.39,-2725.5 277.93,-2761.5"/>
<text text-anchor="middle" x="183.75" y="-2739.8" font-family="Arial" font-size="14.00">parallelogram</text>
</g>
<!-- Input -->
<g id="node3" class="node">
<title>Input</title>
<polygon fill="lightblue" stroke="lightblue" points="1046.86,-2811.5 450.14,-2811.5 296.64,-2675.5 893.35,-2675.5 1046.86,-2811.5"/>
<text text-anchor="middle" x="671.75" y="-2762.3" font-family="Arial" font-size="14.00">Input</text>
<text text-anchor="middle" x="671.75" y="-2747.3" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-2732.3" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-2717.3" font-family="Arial" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- Layer0_Input_Split -->
<g id="node4" class="node">
<title>Layer0_Input_Split</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-2558.42" rx="251.05" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-2577.22" font-family="Arial" font-size="14.00">TP Split</text>
<text text-anchor="middle" x="671.75" y="-2562.22" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-2547.22" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-2532.22" font-family="Arial" font-size="14.00">GPU: all GPUs in stage 0</text>
</g>
<!-- Input&#45;&gt;Layer0_Input_Split -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;Layer0_Input_Split</title>
<path fill="none" stroke="black" d="M671.75,-2675.36C671.75,-2656.08 671.75,-2635.23 671.75,-2616.6"/>
<polygon fill="black" stroke="black" points="675.25,-2616.5 671.75,-2606.5 668.25,-2616.5 675.25,-2616.5"/>
</g>
<!-- Layer0_Linear1 -->
<g id="node5" class="node">
<title>Layer0_Linear1</title>
<polygon fill="yellow" stroke="yellow" points="849.25,-2474.33 494.25,-2474.33 494.25,-2406.33 849.25,-2406.33 849.25,-2474.33"/>
<text text-anchor="middle" x="671.75" y="-2459.13" font-family="Arial" font-size="14.00">Linear 1 (7.5B params)</text>
<text text-anchor="middle" x="671.75" y="-2444.13" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-2429.13" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-2414.13" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer0_Input_Split&#45;&gt;Layer0_Linear1 -->
<g id="edge2" class="edge">
<title>Layer0_Input_Split&#45;&gt;Layer0_Linear1</title>
<path fill="none" stroke="black" d="M671.75,-2510.2C671.75,-2501.81 671.75,-2493.12 671.75,-2484.84"/>
<polygon fill="black" stroke="black" points="675.25,-2484.64 671.75,-2474.64 668.25,-2484.64 675.25,-2484.64"/>
</g>
<!-- Layer0_Activation -->
<g id="node6" class="node">
<title>Layer0_Activation</title>
<polygon fill="pink" stroke="pink" points="849.25,-2370.33 494.25,-2370.33 494.25,-2302.33 849.25,-2302.33 849.25,-2370.33"/>
<text text-anchor="middle" x="671.75" y="-2355.13" font-family="Arial" font-size="14.00">Activation</text>
<text text-anchor="middle" x="671.75" y="-2340.13" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-2325.13" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-2310.13" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer0_Linear1&#45;&gt;Layer0_Activation -->
<g id="edge3" class="edge">
<title>Layer0_Linear1&#45;&gt;Layer0_Activation</title>
<path fill="none" stroke="black" d="M671.75,-2406.22C671.75,-2398.11 671.75,-2389.31 671.75,-2380.8"/>
<polygon fill="black" stroke="black" points="675.25,-2380.63 671.75,-2370.63 668.25,-2380.63 675.25,-2380.63"/>
</g>
<!-- Layer0_Linear2 -->
<g id="node7" class="node">
<title>Layer0_Linear2</title>
<polygon fill="yellow" stroke="yellow" points="849.25,-2266.33 494.25,-2266.33 494.25,-2198.33 849.25,-2198.33 849.25,-2266.33"/>
<text text-anchor="middle" x="671.75" y="-2251.13" font-family="Arial" font-size="14.00">Linear 2 (7.5B params)</text>
<text text-anchor="middle" x="671.75" y="-2236.13" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-2221.13" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-2206.13" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer0_Activation&#45;&gt;Layer0_Linear2 -->
<g id="edge4" class="edge">
<title>Layer0_Activation&#45;&gt;Layer0_Linear2</title>
<path fill="none" stroke="black" d="M671.75,-2302.22C671.75,-2294.11 671.75,-2285.31 671.75,-2276.8"/>
<polygon fill="black" stroke="black" points="675.25,-2276.63 671.75,-2266.63 668.25,-2276.63 675.25,-2276.63"/>
</g>
<!-- Layer0_AllReduce -->
<g id="node8" class="node">
<title>Layer0_AllReduce</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-2114.25" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-2133.05" font-family="Arial" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="671.75" y="-2118.05" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-2103.05" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-2088.05" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer0_Linear2&#45;&gt;Layer0_AllReduce -->
<g id="edge5" class="edge">
<title>Layer0_Linear2&#45;&gt;Layer0_AllReduce</title>
<path fill="none" stroke="black" d="M671.75,-2198.07C671.75,-2190.07 671.75,-2181.31 671.75,-2172.56"/>
<polygon fill="black" stroke="black" points="675.25,-2172.36 671.75,-2162.36 668.25,-2172.36 675.25,-2172.36"/>
</g>
<!-- Layer1_Input_Split -->
<g id="node9" class="node">
<title>Layer1_Input_Split</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-1982.08" rx="251.05" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-2000.88" font-family="Arial" font-size="14.00">TP Split</text>
<text text-anchor="middle" x="671.75" y="-1985.88" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-1970.88" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1955.88" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer0_AllReduce&#45;&gt;Layer1_Input_Split -->
<g id="edge6" class="edge">
<title>Layer0_AllReduce&#45;&gt;Layer1_Input_Split</title>
<path fill="none" stroke="black" d="M671.75,-2065.89C671.75,-2057.62 671.75,-2048.94 671.75,-2040.43"/>
<polygon fill="black" stroke="black" points="675.25,-2040.19 671.75,-2030.19 668.25,-2040.19 675.25,-2040.19"/>
</g>
<!-- Layer1_Linear1 -->
<g id="node10" class="node">
<title>Layer1_Linear1</title>
<polygon fill="yellow" stroke="yellow" points="849.25,-1898 494.25,-1898 494.25,-1830 849.25,-1830 849.25,-1898"/>
<text text-anchor="middle" x="671.75" y="-1882.8" font-family="Arial" font-size="14.00">Linear 1 (7.5B params)</text>
<text text-anchor="middle" x="671.75" y="-1867.8" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1852.8" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1837.8" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer1_Input_Split&#45;&gt;Layer1_Linear1 -->
<g id="edge7" class="edge">
<title>Layer1_Input_Split&#45;&gt;Layer1_Linear1</title>
<path fill="none" stroke="black" d="M671.75,-1933.87C671.75,-1925.48 671.75,-1916.78 671.75,-1908.51"/>
<polygon fill="black" stroke="black" points="675.25,-1908.3 671.75,-1898.3 668.25,-1908.3 675.25,-1908.3"/>
</g>
<!-- Layer1_Activation -->
<g id="node11" class="node">
<title>Layer1_Activation</title>
<polygon fill="pink" stroke="pink" points="849.25,-1794 494.25,-1794 494.25,-1726 849.25,-1726 849.25,-1794"/>
<text text-anchor="middle" x="671.75" y="-1778.8" font-family="Arial" font-size="14.00">Activation</text>
<text text-anchor="middle" x="671.75" y="-1763.8" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1748.8" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1733.8" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer1_Linear1&#45;&gt;Layer1_Activation -->
<g id="edge8" class="edge">
<title>Layer1_Linear1&#45;&gt;Layer1_Activation</title>
<path fill="none" stroke="black" d="M671.75,-1829.88C671.75,-1821.78 671.75,-1812.98 671.75,-1804.47"/>
<polygon fill="black" stroke="black" points="675.25,-1804.3 671.75,-1794.3 668.25,-1804.3 675.25,-1804.3"/>
</g>
<!-- Layer1_Linear2 -->
<g id="node12" class="node">
<title>Layer1_Linear2</title>
<polygon fill="yellow" stroke="yellow" points="849.25,-1690 494.25,-1690 494.25,-1622 849.25,-1622 849.25,-1690"/>
<text text-anchor="middle" x="671.75" y="-1674.8" font-family="Arial" font-size="14.00">Linear 2 (7.5B params)</text>
<text text-anchor="middle" x="671.75" y="-1659.8" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1644.8" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1629.8" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer1_Activation&#45;&gt;Layer1_Linear2 -->
<g id="edge9" class="edge">
<title>Layer1_Activation&#45;&gt;Layer1_Linear2</title>
<path fill="none" stroke="black" d="M671.75,-1725.88C671.75,-1717.78 671.75,-1708.98 671.75,-1700.47"/>
<polygon fill="black" stroke="black" points="675.25,-1700.3 671.75,-1690.3 668.25,-1700.3 675.25,-1700.3"/>
</g>
<!-- Layer1_AllReduce -->
<g id="node13" class="node">
<title>Layer1_AllReduce</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-1537.92" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-1556.72" font-family="Arial" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="671.75" y="-1541.72" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1526.72" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-1511.72" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7]</text>
</g>
<!-- Layer1_Linear2&#45;&gt;Layer1_AllReduce -->
<g id="edge10" class="edge">
<title>Layer1_Linear2&#45;&gt;Layer1_AllReduce</title>
<path fill="none" stroke="black" d="M671.75,-1621.73C671.75,-1613.74 671.75,-1604.98 671.75,-1596.23"/>
<polygon fill="black" stroke="black" points="675.25,-1596.03 671.75,-1586.03 668.25,-1596.03 675.25,-1596.03"/>
</g>
<!-- Stage0_to_Stage1 -->
<g id="node14" class="node">
<title>Stage0_to_Stage1</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-1405.75" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-1424.55" font-family="Arial" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="671.75" y="-1409.55" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-1394.55" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-1379.55" font-family="Arial" font-size="14.00">GPU: [0,1,2,3,4,5,6,7] â†’ [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer1_AllReduce&#45;&gt;Stage0_to_Stage1 -->
<g id="edge11" class="edge">
<title>Layer1_AllReduce&#45;&gt;Stage0_to_Stage1</title>
<path fill="none" stroke="black" d="M671.75,-1489.55C671.75,-1481.29 671.75,-1472.6 671.75,-1464.1"/>
<polygon fill="black" stroke="black" points="675.25,-1463.86 671.75,-1453.86 668.25,-1463.86 675.25,-1463.86"/>
</g>
<!-- Layer2_Input_Split -->
<g id="node15" class="node">
<title>Layer2_Input_Split</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-1240.58" rx="251.05" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-1259.38" font-family="Arial" font-size="14.00">TP Split</text>
<text text-anchor="middle" x="671.75" y="-1244.38" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-1229.38" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1214.38" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Stage0_to_Stage1&#45;&gt;Layer2_Input_Split -->
<g id="edge12" class="edge">
<title>Stage0_to_Stage1&#45;&gt;Layer2_Input_Split</title>
<path fill="none" stroke="black" d="M671.75,-1357.55C671.75,-1339.21 671.75,-1318.01 671.75,-1298.81"/>
<polygon fill="black" stroke="black" points="675.25,-1298.67 671.75,-1288.67 668.25,-1298.67 675.25,-1298.67"/>
</g>
<!-- Layer2_Linear1 -->
<g id="node16" class="node">
<title>Layer2_Linear1</title>
<polygon fill="yellow" stroke="yellow" points="849.25,-1156.5 494.25,-1156.5 494.25,-1088.5 849.25,-1088.5 849.25,-1156.5"/>
<text text-anchor="middle" x="671.75" y="-1141.3" font-family="Arial" font-size="14.00">Linear 1 (7.5B params)</text>
<text text-anchor="middle" x="671.75" y="-1126.3" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1111.3" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1096.3" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer2_Input_Split&#45;&gt;Layer2_Linear1 -->
<g id="edge13" class="edge">
<title>Layer2_Input_Split&#45;&gt;Layer2_Linear1</title>
<path fill="none" stroke="black" d="M671.75,-1192.37C671.75,-1183.98 671.75,-1175.28 671.75,-1167.01"/>
<polygon fill="black" stroke="black" points="675.25,-1166.8 671.75,-1156.8 668.25,-1166.8 675.25,-1166.8"/>
</g>
<!-- Layer2_Activation -->
<g id="node17" class="node">
<title>Layer2_Activation</title>
<polygon fill="pink" stroke="pink" points="849.25,-1052.5 494.25,-1052.5 494.25,-984.5 849.25,-984.5 849.25,-1052.5"/>
<text text-anchor="middle" x="671.75" y="-1037.3" font-family="Arial" font-size="14.00">Activation</text>
<text text-anchor="middle" x="671.75" y="-1022.3" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-1007.3" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-992.3" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer2_Linear1&#45;&gt;Layer2_Activation -->
<g id="edge14" class="edge">
<title>Layer2_Linear1&#45;&gt;Layer2_Activation</title>
<path fill="none" stroke="black" d="M671.75,-1088.38C671.75,-1080.28 671.75,-1071.48 671.75,-1062.97"/>
<polygon fill="black" stroke="black" points="675.25,-1062.8 671.75,-1052.8 668.25,-1062.8 675.25,-1062.8"/>
</g>
<!-- Layer2_Linear2 -->
<g id="node18" class="node">
<title>Layer2_Linear2</title>
<polygon fill="yellow" stroke="yellow" points="849.25,-948.5 494.25,-948.5 494.25,-880.5 849.25,-880.5 849.25,-948.5"/>
<text text-anchor="middle" x="671.75" y="-933.3" font-family="Arial" font-size="14.00">Linear 2 (7.5B params)</text>
<text text-anchor="middle" x="671.75" y="-918.3" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-903.3" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-888.3" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer2_Activation&#45;&gt;Layer2_Linear2 -->
<g id="edge15" class="edge">
<title>Layer2_Activation&#45;&gt;Layer2_Linear2</title>
<path fill="none" stroke="black" d="M671.75,-984.38C671.75,-976.28 671.75,-967.48 671.75,-958.97"/>
<polygon fill="black" stroke="black" points="675.25,-958.8 671.75,-948.8 668.25,-958.8 675.25,-958.8"/>
</g>
<!-- Layer2_AllReduce -->
<g id="node19" class="node">
<title>Layer2_AllReduce</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-796.42" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-815.22" font-family="Arial" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="671.75" y="-800.22" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-785.22" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-770.22" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer2_Linear2&#45;&gt;Layer2_AllReduce -->
<g id="edge16" class="edge">
<title>Layer2_Linear2&#45;&gt;Layer2_AllReduce</title>
<path fill="none" stroke="black" d="M671.75,-880.23C671.75,-872.24 671.75,-863.48 671.75,-854.73"/>
<polygon fill="black" stroke="black" points="675.25,-854.53 671.75,-844.53 668.25,-854.53 675.25,-854.53"/>
</g>
<!-- Layer3_Input_Split -->
<g id="node20" class="node">
<title>Layer3_Input_Split</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-664.25" rx="251.05" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-683.05" font-family="Arial" font-size="14.00">TP Split</text>
<text text-anchor="middle" x="671.75" y="-668.05" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-653.05" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-638.05" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer2_AllReduce&#45;&gt;Layer3_Input_Split -->
<g id="edge17" class="edge">
<title>Layer2_AllReduce&#45;&gt;Layer3_Input_Split</title>
<path fill="none" stroke="black" d="M671.75,-748.05C671.75,-739.79 671.75,-731.1 671.75,-722.6"/>
<polygon fill="black" stroke="black" points="675.25,-722.36 671.75,-712.36 668.25,-722.36 675.25,-722.36"/>
</g>
<!-- Layer3_Linear1 -->
<g id="node21" class="node">
<title>Layer3_Linear1</title>
<polygon fill="yellow" stroke="yellow" points="849.25,-580.17 494.25,-580.17 494.25,-512.17 849.25,-512.17 849.25,-580.17"/>
<text text-anchor="middle" x="671.75" y="-564.97" font-family="Arial" font-size="14.00">Linear 1 (7.5B params)</text>
<text text-anchor="middle" x="671.75" y="-549.97" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-534.97" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-519.97" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer3_Input_Split&#45;&gt;Layer3_Linear1 -->
<g id="edge18" class="edge">
<title>Layer3_Input_Split&#45;&gt;Layer3_Linear1</title>
<path fill="none" stroke="black" d="M671.75,-616.03C671.75,-607.65 671.75,-598.95 671.75,-590.67"/>
<polygon fill="black" stroke="black" points="675.25,-590.47 671.75,-580.47 668.25,-590.47 675.25,-590.47"/>
</g>
<!-- Layer3_Activation -->
<g id="node22" class="node">
<title>Layer3_Activation</title>
<polygon fill="pink" stroke="pink" points="849.25,-476.17 494.25,-476.17 494.25,-408.17 849.25,-408.17 849.25,-476.17"/>
<text text-anchor="middle" x="671.75" y="-460.97" font-family="Arial" font-size="14.00">Activation</text>
<text text-anchor="middle" x="671.75" y="-445.97" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-430.97" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-415.97" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer3_Linear1&#45;&gt;Layer3_Activation -->
<g id="edge19" class="edge">
<title>Layer3_Linear1&#45;&gt;Layer3_Activation</title>
<path fill="none" stroke="black" d="M671.75,-512.05C671.75,-503.94 671.75,-495.15 671.75,-486.64"/>
<polygon fill="black" stroke="black" points="675.25,-486.47 671.75,-476.47 668.25,-486.47 675.25,-486.47"/>
</g>
<!-- Layer3_Linear2 -->
<g id="node23" class="node">
<title>Layer3_Linear2</title>
<polygon fill="yellow" stroke="yellow" points="849.25,-372.17 494.25,-372.17 494.25,-304.17 849.25,-304.17 849.25,-372.17"/>
<text text-anchor="middle" x="671.75" y="-356.97" font-family="Arial" font-size="14.00">Linear 2 (7.5B params)</text>
<text text-anchor="middle" x="671.75" y="-341.97" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-326.97" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-311.97" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer3_Activation&#45;&gt;Layer3_Linear2 -->
<g id="edge20" class="edge">
<title>Layer3_Activation&#45;&gt;Layer3_Linear2</title>
<path fill="none" stroke="black" d="M671.75,-408.05C671.75,-399.94 671.75,-391.15 671.75,-382.64"/>
<polygon fill="black" stroke="black" points="675.25,-382.47 671.75,-372.47 668.25,-382.47 675.25,-382.47"/>
</g>
<!-- Layer3_AllReduce -->
<g id="node24" class="node">
<title>Layer3_AllReduce</title>
<ellipse fill="lightgrey" stroke="lightgrey" cx="671.75" cy="-220.08" rx="255.95" ry="48.17"/>
<text text-anchor="middle" x="671.75" y="-238.88" font-family="Arial" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="671.75" y="-223.88" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=2048]</text>
<text text-anchor="middle" x="671.75" y="-208.88" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-193.88" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer3_Linear2&#45;&gt;Layer3_AllReduce -->
<g id="edge21" class="edge">
<title>Layer3_Linear2&#45;&gt;Layer3_AllReduce</title>
<path fill="none" stroke="black" d="M671.75,-303.9C671.75,-295.91 671.75,-287.14 671.75,-278.4"/>
<polygon fill="black" stroke="black" points="675.25,-278.19 671.75,-268.19 668.25,-278.19 675.25,-278.19"/>
</g>
<!-- Output -->
<g id="node25" class="node">
<title>Output</title>
<polygon fill="lightblue" stroke="lightblue" points="1046.86,-136 450.14,-136 296.64,0 893.35,0 1046.86,-136"/>
<text text-anchor="middle" x="671.75" y="-86.8" font-family="Arial" font-size="14.00">Output</text>
<text text-anchor="middle" x="671.75" y="-71.8" font-family="Arial" font-size="14.00">Input: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-56.8" font-family="Arial" font-size="14.00">Output: [batch_size=128, seq_len=10000, hidden=16384]</text>
<text text-anchor="middle" x="671.75" y="-41.8" font-family="Arial" font-size="14.00">GPU: [8,9,10,11,12,13,14,15]</text>
</g>
<!-- Layer3_AllReduce&#45;&gt;Output -->
<g id="edge22" class="edge">
<title>Layer3_AllReduce&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M671.75,-171.6C671.75,-163.51 671.75,-154.93 671.75,-146.31"/>
<polygon fill="black" stroke="black" points="675.25,-146.19 671.75,-136.19 668.25,-146.19 675.25,-146.19"/>
</g>
</g>
</svg>
