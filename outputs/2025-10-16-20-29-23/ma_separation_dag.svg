<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: ma_separation Pages: 1 -->
<svg width="11972pt" height="4691pt"
 viewBox="0.00 0.00 11971.98 4691.04" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4687.04)">
<title>ma_separation</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4687.04 11967.98,-4687.04 11967.98,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_attention</title>
<path fill="lightblue" stroke="blue" d="M1391,-1962.31C1391,-1962.31 11250,-1962.31 11250,-1962.31 11256,-1962.31 11262,-1968.31 11262,-1974.31 11262,-1974.31 11262,-4663.04 11262,-4663.04 11262,-4669.04 11256,-4675.04 11250,-4675.04 11250,-4675.04 1391,-4675.04 1391,-4675.04 1385,-4675.04 1379,-4669.04 1379,-4663.04 1379,-4663.04 1379,-1974.31 1379,-1974.31 1379,-1968.31 1385,-1962.31 1391,-1962.31"/>
<text text-anchor="middle" x="6320.5" y="-4659.84" font-family="Times,serif" font-size="14.00">Attention Computation (GPUs 0&#45;11)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_moe</title>
<path fill="lightcoral" stroke="red" d="M20,-8C20,-8 11250,-8 11250,-8 11256,-8 11262,-14 11262,-20 11262,-20 11262,-1845.31 11262,-1845.31 11262,-1851.31 11256,-1857.31 11250,-1857.31 11250,-1857.31 20,-1857.31 20,-1857.31 14,-1857.31 8,-1851.31 8,-1845.31 8,-1845.31 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="5635" y="-1842.11" font-family="Times,serif" font-size="14.00">MoE Computation (GPUs 12&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="6332" cy="-4595.95" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="6332" y="-4614.75" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="6332" y="-4599.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="6332" y="-4584.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6332" y="-4569.75" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<ellipse fill="none" stroke="black" cx="6332" cy="-4355.79" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="6332" y="-4374.59" font-family="Times,serif" font-size="14.00">Token Embedding</text>
<text text-anchor="middle" x="6332" y="-4359.59" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="6332" y="-4344.59" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6332" y="-4329.59" font-family="Times,serif" font-size="14.00">GPU: 0&#45;11</text>
</g>
<!-- input&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M6332,-4547.61C6332,-4509.22 6332,-4454.97 6332,-4414.12"/>
<polygon fill="black" stroke="black" points="6335.5,-4414.04 6332,-4404.04 6328.5,-4414.04 6335.5,-4414.04"/>
</g>
<!-- ln1_l0 -->
<g id="node3" class="node">
<title>ln1_l0</title>
<ellipse fill="none" stroke="black" cx="6332" cy="-4115.62" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="6332" y="-4134.42" font-family="Times,serif" font-size="14.00">LayerNorm L0</text>
<text text-anchor="middle" x="6332" y="-4119.42" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6332" y="-4104.42" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6332" y="-4089.42" font-family="Times,serif" font-size="14.00">GPU: 0&#45;11</text>
</g>
<!-- embed&#45;&gt;ln1_l0 -->
<g id="edge2" class="edge">
<title>embed&#45;&gt;ln1_l0</title>
<path fill="none" stroke="black" d="M6332,-4307.45C6332,-4269.06 6332,-4214.8 6332,-4173.95"/>
<polygon fill="black" stroke="black" points="6335.5,-4173.87 6332,-4163.87 6328.5,-4173.87 6335.5,-4173.87"/>
</g>
<!-- qkv_l0_gpu0 -->
<g id="node4" class="node">
<title>qkv_l0_gpu0</title>
<ellipse fill="none" stroke="black" cx="8346" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="8346" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8346" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8346" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8346" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128, 3]</text>
<text text-anchor="middle" x="8346" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu0 -->
<g id="edge3" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu0</title>
<path fill="none" stroke="black" d="M6587.91,-4086.09C6905.53,-4050.25 7463.67,-3985.87 7941,-3923.54 7981.42,-3918.26 8024.08,-3912.45 8065.93,-3906.61"/>
<polygon fill="black" stroke="black" points="8066.56,-3910.05 8075.98,-3905.2 8065.6,-3903.12 8066.56,-3910.05"/>
</g>
<!-- qkv_l0_gpu1 -->
<g id="node5" class="node">
<title>qkv_l0_gpu1</title>
<ellipse fill="none" stroke="black" cx="9149" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="9149" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9149" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9149" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9149" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128, 3]</text>
<text text-anchor="middle" x="9149" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu1 -->
<g id="edge4" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu1</title>
<path fill="none" stroke="black" d="M6630.82,-4097.06C7087.48,-4068.85 7986.05,-4007.92 8746,-3923.54 8787.71,-3918.91 8831.75,-3913.32 8874.8,-3907.47"/>
<polygon fill="black" stroke="black" points="8875.4,-3910.92 8884.84,-3906.1 8874.45,-3903.98 8875.4,-3910.92"/>
</g>
<!-- qkv_l0_gpu2 -->
<g id="node6" class="node">
<title>qkv_l0_gpu2</title>
<ellipse fill="none" stroke="black" cx="9976" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="9976" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9976" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9976" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9976" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128, 3]</text>
<text text-anchor="middle" x="9976" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu2 -->
<g id="edge5" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu2</title>
<path fill="none" stroke="black" d="M6645.98,-4103.79C7222.26,-4082.18 8487.12,-4026.66 9549,-3923.54 9596.89,-3918.89 9647.67,-3912.93 9696.86,-3906.62"/>
<polygon fill="black" stroke="black" points="9697.54,-3910.06 9707.01,-3905.31 9696.64,-3903.12 9697.54,-3910.06"/>
</g>
<!-- qkv_l0_gpu3 -->
<g id="node7" class="node">
<title>qkv_l0_gpu3</title>
<ellipse fill="none" stroke="black" cx="10813" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="10813" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10813" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="10813" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10813" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128, 3]</text>
<text text-anchor="middle" x="10813" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu3 -->
<g id="edge6" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu3</title>
<path fill="none" stroke="black" d="M6652.41,-4108.63C7337.15,-4093.81 8993.36,-4047.25 10376,-3923.54 10426.75,-3919 10480.66,-3912.92 10532.66,-3906.4"/>
<polygon fill="black" stroke="black" points="10533.21,-3909.86 10542.69,-3905.14 10532.33,-3902.92 10533.21,-3909.86"/>
</g>
<!-- qkv_l0_gpu4 -->
<g id="node8" class="node">
<title>qkv_l0_gpu4</title>
<ellipse fill="none" stroke="black" cx="1774" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="1774" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1774" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1774" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1774" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128, 3]</text>
<text text-anchor="middle" x="1774" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu4 -->
<g id="edge7" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu4</title>
<path fill="none" stroke="black" d="M6012.68,-4107.53C5324.79,-4090.53 3652.06,-4039.9 2255,-3923.54 2193.64,-3918.43 2128.04,-3911.52 2065.64,-3904.27"/>
<polygon fill="black" stroke="black" points="2065.99,-3900.78 2055.65,-3903.1 2065.18,-3907.74 2065.99,-3900.78"/>
</g>
<!-- qkv_l0_gpu5 -->
<g id="node9" class="node">
<title>qkv_l0_gpu5</title>
<ellipse fill="none" stroke="black" cx="2655" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="2655" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2655" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2655" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2655" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128, 3]</text>
<text text-anchor="middle" x="2655" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu5 -->
<g id="edge8" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu5</title>
<path fill="none" stroke="black" d="M6018.38,-4103.56C5439.64,-4081.48 4165.08,-4025.14 3095,-3923.54 3044.11,-3918.71 2990.05,-3912.5 2937.87,-3905.97"/>
<polygon fill="black" stroke="black" points="2938.16,-3902.47 2927.8,-3904.7 2937.29,-3909.42 2938.16,-3902.47"/>
</g>
<!-- qkv_l0_gpu6 -->
<g id="node10" class="node">
<title>qkv_l0_gpu6</title>
<ellipse fill="none" stroke="black" cx="3495" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="3495" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3495" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3495" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3495" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128, 3]</text>
<text text-anchor="middle" x="3495" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu6 -->
<g id="edge9" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu6</title>
<path fill="none" stroke="black" d="M6034.28,-4096.62C5577.58,-4067.77 4676.91,-4005.91 3915,-3923.54 3869.57,-3918.63 3821.47,-3912.7 3774.68,-3906.55"/>
<polygon fill="black" stroke="black" points="3775.08,-3903.07 3764.71,-3905.23 3774.17,-3910.01 3775.08,-3903.07"/>
</g>
<!-- qkv_l0_gpu7 -->
<g id="node11" class="node">
<title>qkv_l0_gpu7</title>
<ellipse fill="none" stroke="black" cx="4315" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="4315" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4315" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4315" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4315" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128, 3]</text>
<text text-anchor="middle" x="4315" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu7 -->
<g id="edge10" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu7</title>
<path fill="none" stroke="black" d="M6076.78,-4085.98C5759.62,-4050 5201.97,-3985.44 4725,-3923.54 4683.5,-3918.15 4639.68,-3912.23 4596.73,-3906.3"/>
<polygon fill="black" stroke="black" points="4597.09,-3902.82 4586.71,-3904.91 4596.13,-3909.75 4597.09,-3902.82"/>
</g>
<!-- qkv_l0_gpu8 -->
<g id="node12" class="node">
<title>qkv_l0_gpu8</title>
<ellipse fill="none" stroke="black" cx="5125" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="5125" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5125" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5125" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5125" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128, 3]</text>
<text text-anchor="middle" x="5125" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu8 -->
<g id="edge11" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu8</title>
<path fill="none" stroke="black" d="M6145.72,-4076.23C5933.78,-4032.54 5587.38,-3961.15 5357.8,-3913.83"/>
<polygon fill="black" stroke="black" points="5358.49,-3910.4 5347.98,-3911.81 5357.07,-3917.25 5358.49,-3910.4"/>
</g>
<!-- qkv_l0_gpu9 -->
<g id="node13" class="node">
<title>qkv_l0_gpu9</title>
<ellipse fill="none" stroke="black" cx="5930" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="5930" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5930" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5930" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5930" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128, 3]</text>
<text text-anchor="middle" x="5930" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu9 -->
<g id="edge12" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu9</title>
<path fill="none" stroke="black" d="M6257.8,-4068.7C6193.49,-4028.9 6099.9,-3970.99 6029.18,-3927.22"/>
<polygon fill="black" stroke="black" points="6031.02,-3924.24 6020.67,-3921.96 6027.33,-3930.2 6031.02,-3924.24"/>
</g>
<!-- qkv_l0_gpu10 -->
<g id="node14" class="node">
<title>qkv_l0_gpu10</title>
<ellipse fill="none" stroke="black" cx="6733" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="6733" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6733" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6733" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6733" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128, 3]</text>
<text text-anchor="middle" x="6733" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu10 -->
<g id="edge13" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu10</title>
<path fill="none" stroke="black" d="M6406.02,-4068.7C6470.04,-4028.98 6563.14,-3971.23 6633.64,-3927.49"/>
<polygon fill="black" stroke="black" points="6635.9,-3930.2 6642.56,-3921.96 6632.21,-3924.26 6635.9,-3930.2"/>
</g>
<!-- qkv_l0_gpu11 -->
<g id="node15" class="node">
<title>qkv_l0_gpu11</title>
<ellipse fill="none" stroke="black" cx="7541" cy="-3864.85" rx="371.46" ry="58.88"/>
<text text-anchor="middle" x="7541" y="-3891.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7541" y="-3876.15" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7541" y="-3861.15" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7541" y="-3846.15" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128, 3]</text>
<text text-anchor="middle" x="7541" y="-3831.15" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0_gpu11 -->
<g id="edge14" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0_gpu11</title>
<path fill="none" stroke="black" d="M6518.59,-4076.23C6730.88,-4032.54 7077.85,-3961.15 7307.81,-3913.83"/>
<polygon fill="black" stroke="black" points="7308.56,-3917.25 7317.65,-3911.81 7307.15,-3910.39 7308.56,-3917.25"/>
</g>
<!-- scores_l0_gpu0 -->
<g id="node16" class="node">
<title>scores_l0_gpu0</title>
<ellipse fill="none" stroke="black" cx="8378" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="8378" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8378" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8378" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="8378" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="8378" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- qkv_l0_gpu0&#45;&gt;scores_l0_gpu0 -->
<g id="edge15" class="edge">
<title>qkv_l0_gpu0&#45;&gt;scores_l0_gpu0</title>
<path fill="none" stroke="black" d="M8353.14,-3805.96C8358.03,-3766.37 8364.52,-3713.75 8369.64,-3672.21"/>
<polygon fill="black" stroke="black" points="8373.13,-3672.53 8370.88,-3662.18 8366.18,-3671.67 8373.13,-3672.53"/>
</g>
<!-- scores_l0_gpu1 -->
<g id="node17" class="node">
<title>scores_l0_gpu1</title>
<ellipse fill="none" stroke="black" cx="9157" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="9157" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9157" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9157" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="9157" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="9157" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- qkv_l0_gpu1&#45;&gt;scores_l0_gpu1 -->
<g id="edge16" class="edge">
<title>qkv_l0_gpu1&#45;&gt;scores_l0_gpu1</title>
<path fill="none" stroke="black" d="M9150.79,-3805.96C9152.01,-3766.37 9153.63,-3713.75 9154.91,-3672.21"/>
<polygon fill="black" stroke="black" points="9158.41,-3672.28 9155.22,-3662.18 9151.41,-3672.07 9158.41,-3672.28"/>
</g>
<!-- scores_l0_gpu2 -->
<g id="node18" class="node">
<title>scores_l0_gpu2</title>
<ellipse fill="none" stroke="black" cx="9994" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="9994" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9994" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9994" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="9994" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="9994" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- qkv_l0_gpu2&#45;&gt;scores_l0_gpu2 -->
<g id="edge17" class="edge">
<title>qkv_l0_gpu2&#45;&gt;scores_l0_gpu2</title>
<path fill="none" stroke="black" d="M9980.02,-3805.96C9982.76,-3766.37 9986.42,-3713.75 9989.3,-3672.21"/>
<polygon fill="black" stroke="black" points="9992.79,-3672.4 9990,-3662.18 9985.81,-3671.91 9992.79,-3672.4"/>
</g>
<!-- scores_l0_gpu3 -->
<g id="node19" class="node">
<title>scores_l0_gpu3</title>
<ellipse fill="none" stroke="black" cx="10832" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="10832" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10832" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="10832" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="10832" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="10832" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- qkv_l0_gpu3&#45;&gt;scores_l0_gpu3 -->
<g id="edge18" class="edge">
<title>qkv_l0_gpu3&#45;&gt;scores_l0_gpu3</title>
<path fill="none" stroke="black" d="M10817.24,-3805.96C10820.14,-3766.37 10823.99,-3713.75 10827.04,-3672.21"/>
<polygon fill="black" stroke="black" points="10830.53,-3672.41 10827.77,-3662.18 10823.55,-3671.9 10830.53,-3672.41"/>
</g>
<!-- scores_l0_gpu4 -->
<g id="node20" class="node">
<title>scores_l0_gpu4</title>
<ellipse fill="none" stroke="black" cx="1773" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="1773" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1773" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1773" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1773" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="1773" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- qkv_l0_gpu4&#45;&gt;scores_l0_gpu4 -->
<g id="edge19" class="edge">
<title>qkv_l0_gpu4&#45;&gt;scores_l0_gpu4</title>
<path fill="none" stroke="black" d="M1773.78,-3805.96C1773.62,-3766.37 1773.42,-3713.75 1773.26,-3672.21"/>
<polygon fill="black" stroke="black" points="1776.76,-3672.16 1773.22,-3662.18 1769.76,-3672.19 1776.76,-3672.16"/>
</g>
<!-- scores_l0_gpu5 -->
<g id="node21" class="node">
<title>scores_l0_gpu5</title>
<ellipse fill="none" stroke="black" cx="2627" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="2627" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2627" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2627" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2627" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="2627" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- qkv_l0_gpu5&#45;&gt;scores_l0_gpu5 -->
<g id="edge20" class="edge">
<title>qkv_l0_gpu5&#45;&gt;scores_l0_gpu5</title>
<path fill="none" stroke="black" d="M2648.75,-3805.96C2644.48,-3766.37 2638.8,-3713.75 2634.31,-3672.21"/>
<polygon fill="black" stroke="black" points="2637.78,-3671.74 2633.23,-3662.18 2630.82,-3672.5 2637.78,-3671.74"/>
</g>
<!-- scores_l0_gpu6 -->
<g id="node22" class="node">
<title>scores_l0_gpu6</title>
<ellipse fill="none" stroke="black" cx="3478" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="3478" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3478" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3478" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3478" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="3478" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- qkv_l0_gpu6&#45;&gt;scores_l0_gpu6 -->
<g id="edge21" class="edge">
<title>qkv_l0_gpu6&#45;&gt;scores_l0_gpu6</title>
<path fill="none" stroke="black" d="M3491.21,-3805.96C3488.61,-3766.37 3485.16,-3713.75 3482.44,-3672.21"/>
<polygon fill="black" stroke="black" points="3485.93,-3671.93 3481.78,-3662.18 3478.94,-3672.39 3485.93,-3671.93"/>
</g>
<!-- scores_l0_gpu7 -->
<g id="node23" class="node">
<title>scores_l0_gpu7</title>
<ellipse fill="none" stroke="black" cx="4271" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="4271" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="4271" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4271" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4271" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="4271" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- qkv_l0_gpu7&#45;&gt;scores_l0_gpu7 -->
<g id="edge22" class="edge">
<title>qkv_l0_gpu7&#45;&gt;scores_l0_gpu7</title>
<path fill="none" stroke="black" d="M4305.18,-3805.96C4298.46,-3766.37 4289.54,-3713.75 4282.49,-3672.21"/>
<polygon fill="black" stroke="black" points="4285.91,-3671.45 4280.79,-3662.18 4279.01,-3672.62 4285.91,-3671.45"/>
</g>
<!-- scores_l0_gpu8 -->
<g id="node24" class="node">
<title>scores_l0_gpu8</title>
<ellipse fill="none" stroke="black" cx="5103" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="5103" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="5103" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5103" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5103" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, seq_len=2048]</text>
<text text-anchor="middle" x="5103" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- qkv_l0_gpu8&#45;&gt;scores_l0_gpu8 -->
<g id="edge23" class="edge">
<title>qkv_l0_gpu8&#45;&gt;scores_l0_gpu8</title>
<path fill="none" stroke="black" d="M5120.09,-3805.96C5116.73,-3766.37 5112.27,-3713.75 5108.75,-3672.21"/>
<polygon fill="black" stroke="black" points="5112.23,-3671.85 5107.89,-3662.18 5105.25,-3672.44 5112.23,-3671.85"/>
</g>
<!-- scores_l0_gpu9 -->
<g id="node25" class="node">
<title>scores_l0_gpu9</title>
<ellipse fill="none" stroke="black" cx="5919" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="5919" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="5919" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5919" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5919" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, seq_len=2048]</text>
<text text-anchor="middle" x="5919" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- qkv_l0_gpu9&#45;&gt;scores_l0_gpu9 -->
<g id="edge24" class="edge">
<title>qkv_l0_gpu9&#45;&gt;scores_l0_gpu9</title>
<path fill="none" stroke="black" d="M5927.55,-3805.96C5925.87,-3766.37 5923.63,-3713.75 5921.87,-3672.21"/>
<polygon fill="black" stroke="black" points="5925.37,-3672.02 5921.45,-3662.18 5918.37,-3672.32 5925.37,-3672.02"/>
</g>
<!-- scores_l0_gpu10 -->
<g id="node26" class="node">
<title>scores_l0_gpu10</title>
<ellipse fill="none" stroke="black" cx="6734" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="6734" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6734" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6734" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6734" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, seq_len=2048]</text>
<text text-anchor="middle" x="6734" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- qkv_l0_gpu10&#45;&gt;scores_l0_gpu10 -->
<g id="edge25" class="edge">
<title>qkv_l0_gpu10&#45;&gt;scores_l0_gpu10</title>
<path fill="none" stroke="black" d="M6733.22,-3805.96C6733.38,-3766.37 6733.58,-3713.75 6733.74,-3672.21"/>
<polygon fill="black" stroke="black" points="6737.24,-3672.19 6733.78,-3662.18 6730.24,-3672.16 6737.24,-3672.19"/>
</g>
<!-- scores_l0_gpu11 -->
<g id="node27" class="node">
<title>scores_l0_gpu11</title>
<ellipse fill="none" stroke="black" cx="7555" cy="-3603.47" rx="354.02" ry="58.88"/>
<text text-anchor="middle" x="7555" y="-3629.77" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="7555" y="-3614.77" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7555" y="-3599.77" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7555" y="-3584.77" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, seq_len=2048]</text>
<text text-anchor="middle" x="7555" y="-3569.77" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- qkv_l0_gpu11&#45;&gt;scores_l0_gpu11 -->
<g id="edge26" class="edge">
<title>qkv_l0_gpu11&#45;&gt;scores_l0_gpu11</title>
<path fill="none" stroke="black" d="M7544.12,-3805.96C7546.26,-3766.37 7549.1,-3713.75 7551.34,-3672.21"/>
<polygon fill="black" stroke="black" points="7554.84,-3672.35 7551.89,-3662.18 7547.85,-3671.97 7554.84,-3672.35"/>
</g>
<!-- softmax_l0_gpu0 -->
<g id="node28" class="node">
<title>softmax_l0_gpu0</title>
<ellipse fill="none" stroke="black" cx="8388" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="8388" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8388" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8388" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="8388" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- scores_l0_gpu0&#45;&gt;softmax_l0_gpu0 -->
<g id="edge27" class="edge">
<title>scores_l0_gpu0&#45;&gt;softmax_l0_gpu0</title>
<path fill="none" stroke="black" d="M8380.32,-3544.77C8381.93,-3504.63 8384.08,-3451.33 8385.69,-3411.23"/>
<polygon fill="black" stroke="black" points="8389.19,-3411.21 8386.1,-3401.07 8382.2,-3410.92 8389.19,-3411.21"/>
</g>
<!-- softmax_l0_gpu1 -->
<g id="node29" class="node">
<title>softmax_l0_gpu1</title>
<ellipse fill="none" stroke="black" cx="9215" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="9215" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9215" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9215" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="9215" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- scores_l0_gpu1&#45;&gt;softmax_l0_gpu1 -->
<g id="edge28" class="edge">
<title>scores_l0_gpu1&#45;&gt;softmax_l0_gpu1</title>
<path fill="none" stroke="black" d="M9170.45,-3544.77C9179.83,-3504.54 9192.29,-3451.11 9201.65,-3410.97"/>
<polygon fill="black" stroke="black" points="9205.09,-3411.61 9203.95,-3401.07 9198.27,-3410.02 9205.09,-3411.61"/>
</g>
<!-- softmax_l0_gpu2 -->
<g id="node30" class="node">
<title>softmax_l0_gpu2</title>
<ellipse fill="none" stroke="black" cx="10042" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="10042" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10042" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="10042" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="10042" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- scores_l0_gpu2&#45;&gt;softmax_l0_gpu2 -->
<g id="edge29" class="edge">
<title>scores_l0_gpu2&#45;&gt;softmax_l0_gpu2</title>
<path fill="none" stroke="black" d="M10005.13,-3544.77C10012.89,-3504.54 10023.2,-3451.11 10030.95,-3410.97"/>
<polygon fill="black" stroke="black" points="10034.4,-3411.55 10032.86,-3401.07 10027.53,-3410.23 10034.4,-3411.55"/>
</g>
<!-- softmax_l0_gpu3 -->
<g id="node31" class="node">
<title>softmax_l0_gpu3</title>
<ellipse fill="none" stroke="black" cx="10869" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="10869" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10869" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="10869" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="10869" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- scores_l0_gpu3&#45;&gt;softmax_l0_gpu3 -->
<g id="edge30" class="edge">
<title>scores_l0_gpu3&#45;&gt;softmax_l0_gpu3</title>
<path fill="none" stroke="black" d="M10840.58,-3544.77C10846.56,-3504.54 10854.51,-3451.11 10860.48,-3410.97"/>
<polygon fill="black" stroke="black" points="10863.94,-3411.48 10861.95,-3401.07 10857.02,-3410.45 10863.94,-3411.48"/>
</g>
<!-- softmax_l0_gpu4 -->
<g id="node32" class="node">
<title>softmax_l0_gpu4</title>
<ellipse fill="none" stroke="black" cx="1772" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="1772" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1772" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1772" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="1772" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- scores_l0_gpu4&#45;&gt;softmax_l0_gpu4 -->
<g id="edge31" class="edge">
<title>scores_l0_gpu4&#45;&gt;softmax_l0_gpu4</title>
<path fill="none" stroke="black" d="M1772.77,-3544.77C1772.61,-3504.63 1772.39,-3451.33 1772.23,-3411.23"/>
<polygon fill="black" stroke="black" points="1775.73,-3411.06 1772.19,-3401.07 1768.73,-3411.09 1775.73,-3411.06"/>
</g>
<!-- softmax_l0_gpu5 -->
<g id="node33" class="node">
<title>softmax_l0_gpu5</title>
<ellipse fill="none" stroke="black" cx="2599" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="2599" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2599" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2599" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="2599" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- scores_l0_gpu5&#45;&gt;softmax_l0_gpu5 -->
<g id="edge32" class="edge">
<title>scores_l0_gpu5&#45;&gt;softmax_l0_gpu5</title>
<path fill="none" stroke="black" d="M2620.51,-3544.77C2615.99,-3504.63 2609.99,-3451.33 2605.48,-3411.23"/>
<polygon fill="black" stroke="black" points="2608.93,-3410.62 2604.33,-3401.07 2601.97,-3411.4 2608.93,-3410.62"/>
</g>
<!-- softmax_l0_gpu6 -->
<g id="node34" class="node">
<title>softmax_l0_gpu6</title>
<ellipse fill="none" stroke="black" cx="3426" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="3426" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3426" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3426" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="3426" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- scores_l0_gpu6&#45;&gt;softmax_l0_gpu6 -->
<g id="edge33" class="edge">
<title>scores_l0_gpu6&#45;&gt;softmax_l0_gpu6</title>
<path fill="none" stroke="black" d="M3465.94,-3544.77C3457.53,-3504.54 3446.36,-3451.11 3437.97,-3410.97"/>
<polygon fill="black" stroke="black" points="3441.38,-3410.14 3435.9,-3401.07 3434.52,-3411.58 3441.38,-3410.14"/>
</g>
<!-- softmax_l0_gpu7 -->
<g id="node35" class="node">
<title>softmax_l0_gpu7</title>
<ellipse fill="none" stroke="black" cx="4253" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="4253" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4253" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4253" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=3, seq_len=2048]</text>
<text text-anchor="middle" x="4253" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- scores_l0_gpu7&#45;&gt;softmax_l0_gpu7 -->
<g id="edge34" class="edge">
<title>scores_l0_gpu7&#45;&gt;softmax_l0_gpu7</title>
<path fill="none" stroke="black" d="M4266.83,-3544.77C4263.92,-3504.63 4260.06,-3451.33 4257.16,-3411.23"/>
<polygon fill="black" stroke="black" points="4260.64,-3410.79 4256.43,-3401.07 4253.66,-3411.3 4260.64,-3410.79"/>
</g>
<!-- softmax_l0_gpu8 -->
<g id="node36" class="node">
<title>softmax_l0_gpu8</title>
<ellipse fill="none" stroke="black" cx="5080" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="5080" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5080" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5080" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=2, seq_len=2048]</text>
<text text-anchor="middle" x="5080" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- scores_l0_gpu8&#45;&gt;softmax_l0_gpu8 -->
<g id="edge35" class="edge">
<title>scores_l0_gpu8&#45;&gt;softmax_l0_gpu8</title>
<path fill="none" stroke="black" d="M5097.67,-3544.77C5093.95,-3504.63 5089.03,-3451.33 5085.32,-3411.23"/>
<polygon fill="black" stroke="black" points="5088.79,-3410.71 5084.38,-3401.07 5081.82,-3411.35 5088.79,-3410.71"/>
</g>
<!-- softmax_l0_gpu9 -->
<g id="node37" class="node">
<title>softmax_l0_gpu9</title>
<ellipse fill="none" stroke="black" cx="5907" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="5907" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5907" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5907" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=2, seq_len=2048]</text>
<text text-anchor="middle" x="5907" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- scores_l0_gpu9&#45;&gt;softmax_l0_gpu9 -->
<g id="edge36" class="edge">
<title>scores_l0_gpu9&#45;&gt;softmax_l0_gpu9</title>
<path fill="none" stroke="black" d="M5916.22,-3544.77C5914.28,-3504.63 5911.71,-3451.33 5909.78,-3411.23"/>
<polygon fill="black" stroke="black" points="5913.26,-3410.89 5909.29,-3401.07 5906.27,-3411.23 5913.26,-3410.89"/>
</g>
<!-- softmax_l0_gpu10 -->
<g id="node38" class="node">
<title>softmax_l0_gpu10</title>
<ellipse fill="none" stroke="black" cx="6734" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="6734" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6734" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6734" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=2, seq_len=2048]</text>
<text text-anchor="middle" x="6734" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- scores_l0_gpu10&#45;&gt;softmax_l0_gpu10 -->
<g id="edge37" class="edge">
<title>scores_l0_gpu10&#45;&gt;softmax_l0_gpu10</title>
<path fill="none" stroke="black" d="M6734,-3544.77C6734,-3504.63 6734,-3451.33 6734,-3411.23"/>
<polygon fill="black" stroke="black" points="6737.5,-3411.07 6734,-3401.07 6730.5,-3411.07 6737.5,-3411.07"/>
</g>
<!-- softmax_l0_gpu11 -->
<g id="node39" class="node">
<title>softmax_l0_gpu11</title>
<ellipse fill="none" stroke="black" cx="7561" cy="-3352.69" rx="384.83" ry="48.17"/>
<text text-anchor="middle" x="7561" y="-3371.49" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="7561" y="-3356.49" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7561" y="-3341.49" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, heads=2, seq_len=2048]</text>
<text text-anchor="middle" x="7561" y="-3326.49" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- scores_l0_gpu11&#45;&gt;softmax_l0_gpu11 -->
<g id="edge38" class="edge">
<title>scores_l0_gpu11&#45;&gt;softmax_l0_gpu11</title>
<path fill="none" stroke="black" d="M7556.39,-3544.77C7557.36,-3504.63 7558.65,-3451.33 7559.61,-3411.23"/>
<polygon fill="black" stroke="black" points="7563.12,-3411.15 7559.86,-3401.07 7556.12,-3410.99 7563.12,-3411.15"/>
</g>
<!-- attn_out_l0_gpu0 -->
<g id="node40" class="node">
<title>attn_out_l0_gpu0</title>
<ellipse fill="none" stroke="black" cx="8343" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="8343" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8343" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8343" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="8343" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="8343" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- softmax_l0_gpu0&#45;&gt;attn_out_l0_gpu0 -->
<g id="edge39" class="edge">
<title>softmax_l0_gpu0&#45;&gt;attn_out_l0_gpu0</title>
<path fill="none" stroke="black" d="M8379.48,-3304.61C8372.64,-3266.79 8362.94,-3213.18 8355.27,-3170.73"/>
<polygon fill="black" stroke="black" points="8358.69,-3169.97 8353.46,-3160.75 8351.8,-3171.22 8358.69,-3169.97"/>
</g>
<!-- attn_out_l0_gpu1 -->
<g id="node41" class="node">
<title>attn_out_l0_gpu1</title>
<ellipse fill="none" stroke="black" cx="9167" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="9167" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9167" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9167" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="9167" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="9167" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- softmax_l0_gpu1&#45;&gt;attn_out_l0_gpu1 -->
<g id="edge40" class="edge">
<title>softmax_l0_gpu1&#45;&gt;attn_out_l0_gpu1</title>
<path fill="none" stroke="black" d="M9205.92,-3304.61C9198.62,-3266.79 9188.27,-3213.18 9180.08,-3170.73"/>
<polygon fill="black" stroke="black" points="9183.49,-3169.91 9178.16,-3160.75 9176.62,-3171.24 9183.49,-3169.91"/>
</g>
<!-- attn_out_l0_gpu2 -->
<g id="node42" class="node">
<title>attn_out_l0_gpu2</title>
<ellipse fill="none" stroke="black" cx="9992" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="9992" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9992" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9992" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="9992" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="9992" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- softmax_l0_gpu2&#45;&gt;attn_out_l0_gpu2 -->
<g id="edge41" class="edge">
<title>softmax_l0_gpu2&#45;&gt;attn_out_l0_gpu2</title>
<path fill="none" stroke="black" d="M10032.54,-3304.61C10024.94,-3266.79 10014.16,-3213.18 10005.63,-3170.73"/>
<polygon fill="black" stroke="black" points="10009.03,-3169.87 10003.62,-3160.75 10002.16,-3171.25 10009.03,-3169.87"/>
</g>
<!-- attn_out_l0_gpu3 -->
<g id="node43" class="node">
<title>attn_out_l0_gpu3</title>
<ellipse fill="none" stroke="black" cx="10818" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="10818" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10818" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="10818" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="10818" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="10818" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- softmax_l0_gpu3&#45;&gt;attn_out_l0_gpu3 -->
<g id="edge42" class="edge">
<title>softmax_l0_gpu3&#45;&gt;attn_out_l0_gpu3</title>
<path fill="none" stroke="black" d="M10859.35,-3304.61C10851.59,-3266.79 10840.6,-3213.18 10831.9,-3170.73"/>
<polygon fill="black" stroke="black" points="10835.29,-3169.85 10829.86,-3160.75 10828.44,-3171.25 10835.29,-3169.85"/>
</g>
<!-- attn_out_l0_gpu4 -->
<g id="node44" class="node">
<title>attn_out_l0_gpu4</title>
<ellipse fill="none" stroke="black" cx="1798" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="1798" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1798" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1798" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1798" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="1798" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- softmax_l0_gpu4&#45;&gt;attn_out_l0_gpu4 -->
<g id="edge43" class="edge">
<title>softmax_l0_gpu4&#45;&gt;attn_out_l0_gpu4</title>
<path fill="none" stroke="black" d="M1776.92,-3304.61C1780.87,-3266.79 1786.48,-3213.18 1790.91,-3170.73"/>
<polygon fill="black" stroke="black" points="1794.4,-3171.06 1791.96,-3160.75 1787.44,-3170.34 1794.4,-3171.06"/>
</g>
<!-- attn_out_l0_gpu5 -->
<g id="node45" class="node">
<title>attn_out_l0_gpu5</title>
<ellipse fill="none" stroke="black" cx="2677" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="2677" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2677" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2677" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2677" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="2677" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- softmax_l0_gpu5&#45;&gt;attn_out_l0_gpu5 -->
<g id="edge44" class="edge">
<title>softmax_l0_gpu5&#45;&gt;attn_out_l0_gpu5</title>
<path fill="none" stroke="black" d="M2613.76,-3304.61C2625.65,-3266.71 2642.5,-3212.95 2655.82,-3170.46"/>
<polygon fill="black" stroke="black" points="2659.22,-3171.34 2658.87,-3160.75 2652.54,-3169.25 2659.22,-3171.34"/>
</g>
<!-- attn_out_l0_gpu6 -->
<g id="node46" class="node">
<title>attn_out_l0_gpu6</title>
<ellipse fill="none" stroke="black" cx="3504" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="3504" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3504" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3504" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3504" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="3504" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- softmax_l0_gpu6&#45;&gt;attn_out_l0_gpu6 -->
<g id="edge45" class="edge">
<title>softmax_l0_gpu6&#45;&gt;attn_out_l0_gpu6</title>
<path fill="none" stroke="black" d="M3440.76,-3304.61C3452.65,-3266.71 3469.5,-3212.95 3482.82,-3170.46"/>
<polygon fill="black" stroke="black" points="3486.22,-3171.34 3485.87,-3160.75 3479.54,-3169.25 3486.22,-3171.34"/>
</g>
<!-- attn_out_l0_gpu7 -->
<g id="node47" class="node">
<title>attn_out_l0_gpu7</title>
<ellipse fill="none" stroke="black" cx="4305" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="4305" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4305" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4305" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4305" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=3, head_dim=128]</text>
<text text-anchor="middle" x="4305" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- softmax_l0_gpu7&#45;&gt;attn_out_l0_gpu7 -->
<g id="edge46" class="edge">
<title>softmax_l0_gpu7&#45;&gt;attn_out_l0_gpu7</title>
<path fill="none" stroke="black" d="M4262.84,-3304.61C4270.75,-3266.79 4281.95,-3213.18 4290.83,-3170.73"/>
<polygon fill="black" stroke="black" points="4294.29,-3171.26 4292.91,-3160.75 4287.44,-3169.83 4294.29,-3171.26"/>
</g>
<!-- attn_out_l0_gpu8 -->
<g id="node48" class="node">
<title>attn_out_l0_gpu8</title>
<ellipse fill="none" stroke="black" cx="5105" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="5105" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5105" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5105" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5105" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5105" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- softmax_l0_gpu8&#45;&gt;attn_out_l0_gpu8 -->
<g id="edge47" class="edge">
<title>softmax_l0_gpu8&#45;&gt;attn_out_l0_gpu8</title>
<path fill="none" stroke="black" d="M5084.73,-3304.61C5088.53,-3266.79 5093.92,-3213.18 5098.19,-3170.73"/>
<polygon fill="black" stroke="black" points="5101.67,-3171.05 5099.19,-3160.75 5094.71,-3170.35 5101.67,-3171.05"/>
</g>
<!-- attn_out_l0_gpu9 -->
<g id="node49" class="node">
<title>attn_out_l0_gpu9</title>
<ellipse fill="none" stroke="black" cx="5917" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="5917" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5917" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5917" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5917" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="5917" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- softmax_l0_gpu9&#45;&gt;attn_out_l0_gpu9 -->
<g id="edge48" class="edge">
<title>softmax_l0_gpu9&#45;&gt;attn_out_l0_gpu9</title>
<path fill="none" stroke="black" d="M5908.89,-3304.61C5910.41,-3266.87 5912.56,-3213.4 5914.26,-3171"/>
<polygon fill="black" stroke="black" points="5917.77,-3170.89 5914.68,-3160.75 5910.78,-3170.61 5917.77,-3170.89"/>
</g>
<!-- attn_out_l0_gpu10 -->
<g id="node50" class="node">
<title>attn_out_l0_gpu10</title>
<ellipse fill="none" stroke="black" cx="6708" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="6708" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6708" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6708" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6708" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="6708" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- softmax_l0_gpu10&#45;&gt;attn_out_l0_gpu10 -->
<g id="edge49" class="edge">
<title>softmax_l0_gpu10&#45;&gt;attn_out_l0_gpu10</title>
<path fill="none" stroke="black" d="M6729.08,-3304.61C6725.13,-3266.79 6719.52,-3213.18 6715.09,-3170.73"/>
<polygon fill="black" stroke="black" points="6718.56,-3170.34 6714.04,-3160.75 6711.6,-3171.06 6718.56,-3170.34"/>
</g>
<!-- attn_out_l0_gpu11 -->
<g id="node51" class="node">
<title>attn_out_l0_gpu11</title>
<ellipse fill="none" stroke="black" cx="7522" cy="-3101.92" rx="358.51" ry="58.88"/>
<text text-anchor="middle" x="7522" y="-3128.22" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7522" y="-3113.22" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7522" y="-3098.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7522" y="-3083.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, heads=2, head_dim=128]</text>
<text text-anchor="middle" x="7522" y="-3068.22" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- softmax_l0_gpu11&#45;&gt;attn_out_l0_gpu11 -->
<g id="edge50" class="edge">
<title>softmax_l0_gpu11&#45;&gt;attn_out_l0_gpu11</title>
<path fill="none" stroke="black" d="M7553.62,-3304.61C7547.69,-3266.79 7539.28,-3213.18 7532.63,-3170.73"/>
<polygon fill="black" stroke="black" points="7536.07,-3170.09 7531.07,-3160.75 7529.16,-3171.18 7536.07,-3170.09"/>
</g>
<!-- o_proj_l0_gpu0 -->
<g id="node52" class="node">
<title>o_proj_l0_gpu0</title>
<ellipse fill="none" stroke="black" cx="8192" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="8192" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="8192" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8192" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=384]</text>
<text text-anchor="middle" x="8192" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="8192" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_out_l0_gpu0&#45;&gt;o_proj_l0_gpu0 -->
<g id="edge51" class="edge">
<title>attn_out_l0_gpu0&#45;&gt;o_proj_l0_gpu0</title>
<path fill="none" stroke="black" d="M8309.49,-3043.36C8286.13,-3003.23 8254.9,-2949.59 8230.51,-2907.7"/>
<polygon fill="black" stroke="black" points="8233.47,-2905.83 8225.42,-2898.95 8227.42,-2909.35 8233.47,-2905.83"/>
</g>
<!-- o_proj_l0_gpu1 -->
<g id="node53" class="node">
<title>o_proj_l0_gpu1</title>
<ellipse fill="none" stroke="black" cx="9070" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="9070" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9070" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9070" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=384]</text>
<text text-anchor="middle" x="9070" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="9070" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_out_l0_gpu1&#45;&gt;o_proj_l0_gpu1 -->
<g id="edge52" class="edge">
<title>attn_out_l0_gpu1&#45;&gt;o_proj_l0_gpu1</title>
<path fill="none" stroke="black" d="M9145.35,-3043.03C9130.49,-3003.28 9110.7,-2950.38 9095.14,-2908.76"/>
<polygon fill="black" stroke="black" points="9098.36,-2907.39 9091.58,-2899.25 9091.81,-2909.84 9098.36,-2907.39"/>
</g>
<!-- o_proj_l0_gpu2 -->
<g id="node54" class="node">
<title>o_proj_l0_gpu2</title>
<ellipse fill="none" stroke="black" cx="9877" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="9877" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="9877" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="9877" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=384]</text>
<text text-anchor="middle" x="9877" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="9877" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_out_l0_gpu2&#45;&gt;o_proj_l0_gpu2 -->
<g id="edge53" class="edge">
<title>attn_out_l0_gpu2&#45;&gt;o_proj_l0_gpu2</title>
<path fill="none" stroke="black" d="M9966.48,-3043.36C9948.82,-3003.53 9925.27,-2950.41 9906.76,-2908.66"/>
<polygon fill="black" stroke="black" points="9909.9,-2907.12 9902.65,-2899.39 9903.5,-2909.95 9909.9,-2907.12"/>
</g>
<!-- o_proj_l0_gpu3 -->
<g id="node55" class="node">
<title>o_proj_l0_gpu3</title>
<ellipse fill="none" stroke="black" cx="10694" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="10694" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="10694" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="10694" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=384]</text>
<text text-anchor="middle" x="10694" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="10694" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_out_l0_gpu3&#45;&gt;o_proj_l0_gpu3 -->
<g id="edge54" class="edge">
<title>attn_out_l0_gpu3&#45;&gt;o_proj_l0_gpu3</title>
<path fill="none" stroke="black" d="M10790.48,-3043.36C10771.44,-3003.53 10746.05,-2950.41 10726.09,-2908.66"/>
<polygon fill="black" stroke="black" points="10729.13,-2906.91 10721.66,-2899.39 10722.81,-2909.93 10729.13,-2906.91"/>
</g>
<!-- o_proj_l0_gpu4 -->
<g id="node56" class="node">
<title>o_proj_l0_gpu4</title>
<ellipse fill="none" stroke="black" cx="1849" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="1849" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="1849" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1849" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=384]</text>
<text text-anchor="middle" x="1849" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="1849" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_out_l0_gpu4&#45;&gt;o_proj_l0_gpu4 -->
<g id="edge55" class="edge">
<title>attn_out_l0_gpu4&#45;&gt;o_proj_l0_gpu4</title>
<path fill="none" stroke="black" d="M1809.38,-3043.03C1817.17,-3003.45 1827.51,-2950.83 1835.68,-2909.29"/>
<polygon fill="black" stroke="black" points="1839.16,-2909.74 1837.65,-2899.25 1832.29,-2908.39 1839.16,-2909.74"/>
</g>
<!-- o_proj_l0_gpu5 -->
<g id="node57" class="node">
<title>o_proj_l0_gpu5</title>
<ellipse fill="none" stroke="black" cx="2864" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="2864" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="2864" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2864" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=384]</text>
<text text-anchor="middle" x="2864" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="2864" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_out_l0_gpu5&#45;&gt;o_proj_l0_gpu5 -->
<g id="edge56" class="edge">
<title>attn_out_l0_gpu5&#45;&gt;o_proj_l0_gpu5</title>
<path fill="none" stroke="black" d="M2718.5,-3043.36C2747.55,-3003.06 2786.43,-2949.14 2816.68,-2907.17"/>
<polygon fill="black" stroke="black" points="2819.61,-2909.1 2822.61,-2898.95 2813.93,-2905.01 2819.61,-2909.1"/>
</g>
<!-- o_proj_l0_gpu6 -->
<g id="node58" class="node">
<title>o_proj_l0_gpu6</title>
<ellipse fill="none" stroke="black" cx="3718" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="3718" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="3718" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3718" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=384]</text>
<text text-anchor="middle" x="3718" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="3718" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_out_l0_gpu6&#45;&gt;o_proj_l0_gpu6 -->
<g id="edge57" class="edge">
<title>attn_out_l0_gpu6&#45;&gt;o_proj_l0_gpu6</title>
<path fill="none" stroke="black" d="M3551.23,-3043.68C3584.72,-3003.09 3629.7,-2948.56 3664.52,-2906.37"/>
<polygon fill="black" stroke="black" points="3667.23,-2908.58 3670.89,-2898.64 3661.83,-2904.12 3667.23,-2908.58"/>
</g>
<!-- o_proj_l0_gpu7 -->
<g id="node59" class="node">
<title>o_proj_l0_gpu7</title>
<ellipse fill="none" stroke="black" cx="4491" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="4491" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="4491" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4491" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=384]</text>
<text text-anchor="middle" x="4491" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="4491" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_out_l0_gpu7&#45;&gt;o_proj_l0_gpu7 -->
<g id="edge58" class="edge">
<title>attn_out_l0_gpu7&#45;&gt;o_proj_l0_gpu7</title>
<path fill="none" stroke="black" d="M4346.28,-3043.36C4375.18,-3003.06 4413.84,-2949.14 4443.94,-2907.17"/>
<polygon fill="black" stroke="black" points="4446.85,-2909.11 4449.84,-2898.95 4441.16,-2905.03 4446.85,-2909.11"/>
</g>
<!-- o_proj_l0_gpu8 -->
<g id="node60" class="node">
<title>o_proj_l0_gpu8</title>
<ellipse fill="none" stroke="black" cx="5224" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="5224" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="5224" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5224" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=256]</text>
<text text-anchor="middle" x="5224" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="5224" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_out_l0_gpu8&#45;&gt;o_proj_l0_gpu8 -->
<g id="edge59" class="edge">
<title>attn_out_l0_gpu8&#45;&gt;o_proj_l0_gpu8</title>
<path fill="none" stroke="black" d="M5131.41,-3043.36C5149.68,-3003.53 5174.05,-2950.41 5193.21,-2908.66"/>
<polygon fill="black" stroke="black" points="5196.47,-2909.94 5197.46,-2899.39 5190.11,-2907.02 5196.47,-2909.94"/>
</g>
<!-- o_proj_l0_gpu9 -->
<g id="node61" class="node">
<title>o_proj_l0_gpu9</title>
<ellipse fill="none" stroke="black" cx="5937" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="5937" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="5937" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5937" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=256]</text>
<text text-anchor="middle" x="5937" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="5937" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_out_l0_gpu9&#45;&gt;o_proj_l0_gpu9 -->
<g id="edge60" class="edge">
<title>attn_out_l0_gpu9&#45;&gt;o_proj_l0_gpu9</title>
<path fill="none" stroke="black" d="M5921.46,-3043.03C5924.52,-3003.45 5928.57,-2950.83 5931.78,-2909.29"/>
<polygon fill="black" stroke="black" points="5935.27,-2909.49 5932.55,-2899.25 5928.29,-2908.95 5935.27,-2909.49"/>
</g>
<!-- o_proj_l0_gpu10 -->
<g id="node62" class="node">
<title>o_proj_l0_gpu10</title>
<ellipse fill="none" stroke="black" cx="6684" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="6684" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="6684" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="6684" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=256]</text>
<text text-anchor="middle" x="6684" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="6684" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_out_l0_gpu10&#45;&gt;o_proj_l0_gpu10 -->
<g id="edge61" class="edge">
<title>attn_out_l0_gpu10&#45;&gt;o_proj_l0_gpu10</title>
<path fill="none" stroke="black" d="M6702.64,-3043.03C6698.98,-3003.45 6694.11,-2950.83 6690.27,-2909.29"/>
<polygon fill="black" stroke="black" points="6693.75,-2908.89 6689.34,-2899.25 6686.78,-2909.53 6693.75,-2908.89"/>
</g>
<!-- o_proj_l0_gpu11 -->
<g id="node63" class="node">
<title>o_proj_l0_gpu11</title>
<ellipse fill="none" stroke="black" cx="7435" cy="-2840.54" rx="317.48" ry="58.88"/>
<text text-anchor="middle" x="7435" y="-2866.84" font-family="Times,serif" font-size="14.00">O Projection</text>
<text text-anchor="middle" x="7435" y="-2851.84" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7435" y="-2836.84" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, dim=256]</text>
<text text-anchor="middle" x="7435" y="-2821.84" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=341]</text>
<text text-anchor="middle" x="7435" y="-2806.84" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_out_l0_gpu11&#45;&gt;o_proj_l0_gpu11 -->
<g id="edge62" class="edge">
<title>attn_out_l0_gpu11&#45;&gt;o_proj_l0_gpu11</title>
<path fill="none" stroke="black" d="M7502.58,-3043.03C7489.25,-3003.28 7471.51,-2950.38 7457.55,-2908.76"/>
<polygon fill="black" stroke="black" points="7460.86,-2907.62 7454.36,-2899.25 7454.22,-2909.85 7460.86,-2907.62"/>
</g>
<!-- all_reduce_attn_l0 -->
<g id="node64" class="node">
<title>all_reduce_attn_l0</title>
<ellipse fill="yellow" stroke="black" cx="5948" cy="-2579.16" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="5948" y="-2605.46" font-family="Times,serif" font-size="14.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="5948" y="-2590.46" font-family="Times,serif" font-size="14.00">Hierarchical</text>
<text text-anchor="middle" x="5948" y="-2575.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5948" y="-2560.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5948" y="-2545.46" font-family="Times,serif" font-size="14.00">GPU: 0&#45;11</text>
</g>
<!-- o_proj_l0_gpu0&#45;&gt;all_reduce_attn_l0 -->
<g id="edge63" class="edge">
<title>o_proj_l0_gpu0&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M7944.94,-2803.64C7890.95,-2796.14 7834.09,-2788.5 7781,-2781.85 7237.12,-2713.77 6600.86,-2646.54 6239.05,-2609.48"/>
<polygon fill="black" stroke="black" points="6239.27,-2605.98 6228.96,-2608.44 6238.55,-2612.95 6239.27,-2605.98"/>
</g>
<!-- o_proj_l0_gpu1&#45;&gt;all_reduce_attn_l0 -->
<g id="edge64" class="edge">
<title>o_proj_l0_gpu1&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M8802.25,-2808.91C8717.76,-2799.67 8624.03,-2789.86 8538,-2781.85 7716.52,-2705.34 6746.58,-2635.19 6259.8,-2601.38"/>
<polygon fill="black" stroke="black" points="6260.04,-2597.89 6249.82,-2600.69 6259.55,-2604.87 6260.04,-2597.89"/>
</g>
<!-- o_proj_l0_gpu2&#45;&gt;all_reduce_attn_l0 -->
<g id="edge65" class="edge">
<title>o_proj_l0_gpu2&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M9624.61,-2804.89C9556.95,-2796.44 9483.77,-2788.06 9416,-2781.85 8263.74,-2676.37 6890.77,-2615.71 6275.07,-2591.94"/>
<polygon fill="black" stroke="black" points="6274.84,-2588.43 6264.71,-2591.54 6274.57,-2595.42 6274.84,-2588.43"/>
</g>
<!-- o_proj_l0_gpu3&#45;&gt;all_reduce_attn_l0 -->
<g id="edge66" class="edge">
<title>o_proj_l0_gpu3&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M10441.06,-2805.03C10370.58,-2796.38 10293.9,-2787.86 10223,-2781.85 8755.77,-2657.56 6998.29,-2604.84 6279.21,-2587.36"/>
<polygon fill="black" stroke="black" points="6279.05,-2583.85 6268.97,-2587.11 6278.88,-2590.85 6279.05,-2583.85"/>
</g>
<!-- o_proj_l0_gpu4&#45;&gt;all_reduce_attn_l0 -->
<g id="edge67" class="edge">
<title>o_proj_l0_gpu4&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M2130.84,-2813.52C2250.2,-2802.94 2390.83,-2791.07 2518,-2781.85 3660.55,-2699.01 5019.1,-2626.96 5626.63,-2596.13"/>
<polygon fill="black" stroke="black" points="5627.04,-2599.61 5636.85,-2595.61 5626.69,-2592.62 5627.04,-2599.61"/>
</g>
<!-- o_proj_l0_gpu5&#45;&gt;all_reduce_attn_l0 -->
<g id="edge68" class="edge">
<title>o_proj_l0_gpu5&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M3127.81,-2807.81C3206.33,-2798.85 3292.59,-2789.47 3372,-2781.85 4187.54,-2703.64 5150.54,-2634.37 5635.51,-2601.09"/>
<polygon fill="black" stroke="black" points="5636.07,-2604.56 5645.81,-2600.39 5635.59,-2597.58 5636.07,-2604.56"/>
</g>
<!-- o_proj_l0_gpu6&#45;&gt;all_reduce_attn_l0 -->
<g id="edge69" class="edge">
<title>o_proj_l0_gpu6&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M3969.35,-2804.61C4027.02,-2796.86 4088.11,-2788.88 4145,-2781.85 4679.1,-2715.91 5303.4,-2648.15 5659.58,-2610.37"/>
<polygon fill="black" stroke="black" points="5660.21,-2613.82 5669.78,-2609.29 5659.47,-2606.86 5660.21,-2613.82"/>
</g>
<!-- o_proj_l0_gpu7&#45;&gt;all_reduce_attn_l0 -->
<g id="edge70" class="edge">
<title>o_proj_l0_gpu7&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M4717.06,-2799.3C4986.49,-2751.33 5434.7,-2671.54 5709.5,-2622.62"/>
<polygon fill="black" stroke="black" points="5710.38,-2626.02 5719.61,-2620.82 5709.15,-2619.13 5710.38,-2626.02"/>
</g>
<!-- o_proj_l0_gpu8&#45;&gt;all_reduce_attn_l0 -->
<g id="edge71" class="edge">
<title>o_proj_l0_gpu8&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M5367.47,-2788.14C5490.72,-2743.99 5667.96,-2680.49 5794.13,-2635.29"/>
<polygon fill="black" stroke="black" points="5795.65,-2638.46 5803.88,-2631.79 5793.29,-2631.87 5795.65,-2638.46"/>
</g>
<!-- o_proj_l0_gpu9&#45;&gt;all_reduce_attn_l0 -->
<g id="edge72" class="edge">
<title>o_proj_l0_gpu9&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M5939.45,-2781.65C5941.13,-2742.07 5943.37,-2689.45 5945.13,-2647.91"/>
<polygon fill="black" stroke="black" points="5948.63,-2648.01 5945.55,-2637.87 5941.63,-2647.71 5948.63,-2648.01"/>
</g>
<!-- o_proj_l0_gpu10&#45;&gt;all_reduce_attn_l0 -->
<g id="edge73" class="edge">
<title>o_proj_l0_gpu10&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M6538.59,-2788.3C6413.02,-2744.04 6232.05,-2680.27 6103.59,-2635"/>
<polygon fill="black" stroke="black" points="6104.65,-2631.66 6094.05,-2631.63 6102.32,-2638.26 6104.65,-2631.66"/>
</g>
<!-- o_proj_l0_gpu11&#45;&gt;all_reduce_attn_l0 -->
<g id="edge74" class="edge">
<title>o_proj_l0_gpu11&#45;&gt;all_reduce_attn_l0</title>
<path fill="none" stroke="black" d="M7206.73,-2799.72C6931.15,-2751.66 6469.81,-2671.18 6188.76,-2622.16"/>
<polygon fill="black" stroke="black" points="6189.29,-2618.7 6178.84,-2620.43 6188.09,-2625.59 6189.29,-2618.7"/>
</g>
<!-- res1_l0 -->
<g id="node65" class="node">
<title>res1_l0</title>
<ellipse fill="pink" stroke="black" cx="5948" cy="-2328.39" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="5948" y="-2347.19" font-family="Times,serif" font-size="14.00">Residual Add L0</text>
<text text-anchor="middle" x="5948" y="-2332.19" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5948" y="-2317.19" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5948" y="-2302.19" font-family="Times,serif" font-size="14.00">GPU: 0&#45;11</text>
</g>
<!-- all_reduce_attn_l0&#45;&gt;res1_l0 -->
<g id="edge75" class="edge">
<title>all_reduce_attn_l0&#45;&gt;res1_l0</title>
<path fill="none" stroke="black" d="M5948,-2520.46C5948,-2480.32 5948,-2427.03 5948,-2386.92"/>
<polygon fill="black" stroke="black" points="5951.5,-2386.77 5948,-2376.77 5944.5,-2386.77 5951.5,-2386.77"/>
</g>
<!-- broadcast_l0 -->
<g id="node66" class="node">
<title>broadcast_l0</title>
<polygon fill="lightcyan" stroke="black" points="6406.49,-2136.31 5677.14,-2136.31 5489.51,-1970.31 6218.86,-1970.31 6406.49,-2136.31"/>
<text text-anchor="middle" x="5948" y="-2079.61" font-family="Times,serif" font-size="14.00">Broadcast to MoE</text>
<text text-anchor="middle" x="5948" y="-2064.61" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="5948" y="-2049.61" font-family="Times,serif" font-size="14.00">From: GPUs 0&#45;11</text>
<text text-anchor="middle" x="5948" y="-2034.61" font-family="Times,serif" font-size="14.00">To: GPUs 12&#45;15</text>
<text text-anchor="middle" x="5948" y="-2019.61" font-family="Times,serif" font-size="14.00">Data: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- res1_l0&#45;&gt;broadcast_l0 -->
<g id="edge76" class="edge">
<title>res1_l0&#45;&gt;broadcast_l0</title>
<path fill="none" stroke="black" d="M5948,-2280.13C5948,-2243.45 5948,-2191.45 5948,-2146.59"/>
<polygon fill="black" stroke="black" points="5951.5,-2146.54 5948,-2136.54 5944.5,-2146.54 5951.5,-2146.54"/>
</g>
<!-- recv_moe_l0 -->
<g id="node68" class="node">
<title>recv_moe_l0</title>
<polygon fill="lightcyan" stroke="black" points="6406.49,-1826.31 5677.14,-1826.31 5489.51,-1660.31 6218.86,-1660.31 6406.49,-1826.31"/>
<text text-anchor="middle" x="5948" y="-1769.61" font-family="Times,serif" font-size="14.00">Receive from Attention</text>
<text text-anchor="middle" x="5948" y="-1754.61" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="5948" y="-1739.61" font-family="Times,serif" font-size="14.00">From: GPUs 0&#45;11</text>
<text text-anchor="middle" x="5948" y="-1724.61" font-family="Times,serif" font-size="14.00">To: GPUs 12&#45;15</text>
<text text-anchor="middle" x="5948" y="-1709.61" font-family="Times,serif" font-size="14.00">Data: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- broadcast_l0&#45;&gt;recv_moe_l0 -->
<g id="edge77" class="edge">
<title>broadcast_l0&#45;&gt;recv_moe_l0</title>
<path fill="none" stroke="black" d="M5948,-1962.31C5948,-1932.65 5948,-1899.14 5948,-1867.46"/>
<polygon fill="black" stroke="black" points="5951.5,-1867.3 5948,-1857.3 5944.5,-1867.3 5951.5,-1867.3"/>
</g>
<!-- ln1_l1 -->
<g id="node67" class="node">
<title>ln1_l1</title>
<ellipse fill="none" stroke="black" cx="10930" cy="-4595.95" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="10930" y="-4614.75" font-family="Times,serif" font-size="14.00">LayerNorm L1</text>
<text text-anchor="middle" x="10930" y="-4599.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10930" y="-4584.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10930" y="-4569.75" font-family="Times,serif" font-size="14.00">GPU: 0&#45;11</text>
</g>
<!-- ln_moe_l0_gpu12 -->
<g id="node69" class="node">
<title>ln_moe_l0_gpu12</title>
<ellipse fill="none" stroke="black" cx="6638" cy="-1468.22" rx="354.02" ry="48.17"/>
<text text-anchor="middle" x="6638" y="-1487.02" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6638" y="-1472.02" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6638" y="-1457.02" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6638" y="-1442.02" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_moe_l0&#45;&gt;ln_moe_l0_gpu12 -->
<g id="edge78" class="edge">
<title>recv_moe_l0&#45;&gt;ln_moe_l0_gpu12</title>
<path fill="none" stroke="black" d="M6155.49,-1660.19C6272.95,-1613.7 6415.84,-1557.15 6515.51,-1517.7"/>
<polygon fill="black" stroke="black" points="6517.01,-1520.87 6525.02,-1513.94 6514.43,-1514.36 6517.01,-1520.87"/>
</g>
<!-- ln_moe_l0_gpu13 -->
<g id="node70" class="node">
<title>ln_moe_l0_gpu13</title>
<ellipse fill="none" stroke="black" cx="9462" cy="-1468.22" rx="354.02" ry="48.17"/>
<text text-anchor="middle" x="9462" y="-1487.02" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9462" y="-1472.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="9462" y="-1457.02" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9462" y="-1442.02" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_moe_l0&#45;&gt;ln_moe_l0_gpu13 -->
<g id="edge79" class="edge">
<title>recv_moe_l0&#45;&gt;ln_moe_l0_gpu13</title>
<path fill="none" stroke="black" d="M6282.55,-1716.31C6960.3,-1663.64 8487.02,-1544.99 9147.57,-1493.66"/>
<polygon fill="black" stroke="black" points="9148.02,-1497.13 9157.72,-1492.87 9147.47,-1490.15 9148.02,-1497.13"/>
</g>
<!-- ln_moe_l0_gpu14 -->
<g id="node71" class="node">
<title>ln_moe_l0_gpu14</title>
<ellipse fill="none" stroke="black" cx="1806" cy="-1468.22" rx="354.02" ry="48.17"/>
<text text-anchor="middle" x="1806" y="-1487.02" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1806" y="-1472.02" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1806" y="-1457.02" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1806" y="-1442.02" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_moe_l0&#45;&gt;ln_moe_l0_gpu14 -->
<g id="edge80" class="edge">
<title>recv_moe_l0&#45;&gt;ln_moe_l0_gpu14</title>
<path fill="none" stroke="black" d="M5552.72,-1716.25C4737.72,-1662.51 2884.08,-1540.3 2132.07,-1490.72"/>
<polygon fill="black" stroke="black" points="2132.11,-1487.22 2121.9,-1490.05 2131.65,-1494.2 2132.11,-1487.22"/>
</g>
<!-- ln_moe_l0_gpu15 -->
<g id="node72" class="node">
<title>ln_moe_l0_gpu15</title>
<ellipse fill="none" stroke="black" cx="4821" cy="-1468.22" rx="354.02" ry="48.17"/>
<text text-anchor="middle" x="4821" y="-1487.02" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4821" y="-1472.02" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="4821" y="-1457.02" font-family="Times,serif" font-size="14.00">Input/Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4821" y="-1442.02" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_moe_l0&#45;&gt;ln_moe_l0_gpu15 -->
<g id="edge81" class="edge">
<title>recv_moe_l0&#45;&gt;ln_moe_l0_gpu15</title>
<path fill="none" stroke="black" d="M5609.48,-1660.28C5409.61,-1611.85 5164.56,-1552.47 5001.2,-1512.89"/>
<polygon fill="black" stroke="black" points="5001.6,-1509.38 4991.05,-1510.43 4999.95,-1516.18 5001.6,-1509.38"/>
</g>
<!-- expert_l0_0_gpu12 -->
<g id="node77" class="node">
<title>expert_l0_0_gpu12</title>
<ellipse fill="none" stroke="black" cx="6694" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="6694" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6694" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6694" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6694" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6694" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_0_gpu12 -->
<g id="edge86" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_0_gpu12</title>
<path fill="none" stroke="black" d="M5959.39,-1660.27C5981.88,-1527.74 6043.94,-1265.69 6198,-1110.14 6273.1,-1034.31 6380.6,-985.93 6476.33,-955.63"/>
<polygon fill="black" stroke="black" points="6477.64,-958.89 6486.15,-952.57 6475.56,-952.21 6477.64,-958.89"/>
</g>
<!-- expert_l0_1_gpu12 -->
<g id="node78" class="node">
<title>expert_l0_1_gpu12</title>
<ellipse fill="none" stroke="black" cx="7400" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="7400" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7400" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7400" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7400" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7400" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_1_gpu12 -->
<g id="edge87" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_1_gpu12</title>
<path fill="none" stroke="black" d="M6265.65,-1701.58C6535.75,-1662.25 6898.69,-1596.89 7021,-1516.31 7221.9,-1383.93 7335.6,-1104.49 7379.16,-975.86"/>
<polygon fill="black" stroke="black" points="7382.57,-976.71 7382.43,-966.12 7375.93,-974.49 7382.57,-976.71"/>
</g>
<!-- expert_l0_2_gpu12 -->
<g id="node79" class="node">
<title>expert_l0_2_gpu12</title>
<ellipse fill="none" stroke="black" cx="8106" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="8106" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8106" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8106" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8106" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8106" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_2_gpu12 -->
<g id="edge88" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_2_gpu12</title>
<path fill="none" stroke="black" d="M6272.87,-1707.96C6505.57,-1676.22 6823.28,-1618.07 7088,-1516.31 7462.83,-1372.22 7857.54,-1094.75 8024.17,-970.85"/>
<polygon fill="black" stroke="black" points="8026.49,-973.49 8032.42,-964.71 8022.31,-967.88 8026.49,-973.49"/>
</g>
<!-- expert_l0_3_gpu12 -->
<g id="node80" class="node">
<title>expert_l0_3_gpu12</title>
<ellipse fill="none" stroke="black" cx="5988" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="5988" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5988" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="5988" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5988" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5988" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_3_gpu12 -->
<g id="edge89" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_3_gpu12</title>
<path fill="none" stroke="black" d="M5951.94,-1660.07C5959.84,-1495.49 5977.45,-1128.41 5984.74,-976.4"/>
<polygon fill="black" stroke="black" points="5988.24,-976.42 5985.23,-966.26 5981.25,-976.08 5988.24,-976.42"/>
</g>
<!-- expert_l0_4_gpu13 -->
<g id="node81" class="node">
<title>expert_l0_4_gpu13</title>
<ellipse fill="none" stroke="black" cx="9518" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="9518" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="9518" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="9518" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9518" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9518" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_4_gpu13 -->
<g id="edge90" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_4_gpu13</title>
<path fill="none" stroke="black" d="M6266.79,-1702.38C6555.51,-1663.65 6991.68,-1598.7 7366,-1516.31 8117.45,-1350.89 8995.22,-1077.27 9353.32,-962.13"/>
<polygon fill="black" stroke="black" points="9354.53,-965.42 9362.98,-959.02 9352.39,-958.75 9354.53,-965.42"/>
</g>
<!-- expert_l0_5_gpu13 -->
<g id="node82" class="node">
<title>expert_l0_5_gpu13</title>
<ellipse fill="none" stroke="black" cx="10224" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="10224" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10224" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10224" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10224" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10224" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_5_gpu13 -->
<g id="edge91" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_5_gpu13</title>
<path fill="none" stroke="black" d="M6308.01,-1739.15C7214.52,-1728.71 9540.81,-1685.57 9845,-1516.31 10056.77,-1398.47 10165.75,-1107.8 10205.72,-975.71"/>
<polygon fill="black" stroke="black" points="10209.08,-976.68 10208.59,-966.1 10202.37,-974.68 10209.08,-976.68"/>
</g>
<!-- expert_l0_6_gpu13 -->
<g id="node83" class="node">
<title>expert_l0_6_gpu13</title>
<ellipse fill="none" stroke="black" cx="10930" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="10930" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10930" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10930" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10930" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10930" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_6_gpu13 -->
<g id="edge92" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_6_gpu13</title>
<path fill="none" stroke="black" d="M6299.84,-1731.94C7207.05,-1703.85 9578.6,-1621.27 9919,-1516.31 10304.64,-1397.4 10695.6,-1101.4 10855.21,-971.39"/>
<polygon fill="black" stroke="black" points="10857.56,-973.98 10863.09,-964.95 10853.13,-968.56 10857.56,-973.98"/>
</g>
<!-- expert_l0_7_gpu13 -->
<g id="node84" class="node">
<title>expert_l0_7_gpu13</title>
<ellipse fill="none" stroke="black" cx="8812" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="8812" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8812" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8812" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8812" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8812" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_7_gpu13 -->
<g id="edge93" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_7_gpu13</title>
<path fill="none" stroke="black" d="M6265.87,-1701.88C6522.84,-1665.25 6892.46,-1603.59 7208,-1516.31 7772.12,-1360.27 8415.5,-1085.53 8683.92,-966.33"/>
<polygon fill="black" stroke="black" points="8685.59,-969.42 8693.31,-962.16 8682.75,-963.02 8685.59,-969.42"/>
</g>
<!-- expert_l0_8_gpu14 -->
<g id="node85" class="node">
<title>expert_l0_8_gpu14</title>
<ellipse fill="none" stroke="black" cx="1752" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="1752" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1752" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1752" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1752" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1752" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_8_gpu14 -->
<g id="edge94" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_8_gpu14</title>
<path fill="none" stroke="black" d="M5564.91,-1727.14C5115.72,-1703.96 4350.59,-1647.66 3706,-1516.31 3013.46,-1375.18 2217.27,-1086.31 1896.74,-964.55"/>
<polygon fill="black" stroke="black" points="1897.52,-961.1 1886.93,-960.82 1895.03,-967.65 1897.52,-961.1"/>
</g>
<!-- expert_l0_9_gpu14 -->
<g id="node86" class="node">
<title>expert_l0_9_gpu14</title>
<ellipse fill="none" stroke="black" cx="2458" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="2458" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2458" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="2458" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2458" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2458" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_9_gpu14 -->
<g id="edge95" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_9_gpu14</title>
<path fill="none" stroke="black" d="M5569.68,-1731.57C5170.72,-1712.66 4526.83,-1660.45 3990,-1516.31 3564.6,-1402.08 3495.66,-1271.99 3086,-1110.14 2938.48,-1051.86 2766.74,-997.6 2640.18,-960.07"/>
<polygon fill="black" stroke="black" points="2640.97,-956.65 2630.38,-957.17 2638.98,-963.36 2640.97,-956.65"/>
</g>
<!-- expert_l0_10_gpu14 -->
<g id="node87" class="node">
<title>expert_l0_10_gpu14</title>
<ellipse fill="none" stroke="black" cx="340" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="340" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="340" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="340" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="340" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="340" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_10_gpu14 -->
<g id="edge96" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_10_gpu14</title>
<path fill="none" stroke="black" d="M5574,-1735.22C4540.07,-1714.09 1692.84,-1644.83 1290,-1516.31 922.79,-1399.15 558.59,-1102.75 409.9,-972.04"/>
<polygon fill="black" stroke="black" points="411.94,-969.17 402.12,-965.18 407.31,-974.42 411.94,-969.17"/>
</g>
<!-- expert_l0_11_gpu14 -->
<g id="node88" class="node">
<title>expert_l0_11_gpu14</title>
<ellipse fill="none" stroke="black" cx="1046" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="1046" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="1046" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1046" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1046" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1046" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_11_gpu14 -->
<g id="edge97" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_11_gpu14</title>
<path fill="none" stroke="black" d="M5581.87,-1742.41C4569.29,-1740.14 1782.27,-1715.64 1423,-1516.31 1211.4,-1398.9 1103.49,-1108.01 1064.02,-975.79"/>
<polygon fill="black" stroke="black" points="1067.37,-974.77 1061.19,-966.16 1060.66,-976.75 1067.37,-974.77"/>
</g>
<!-- expert_l0_12_gpu15 -->
<g id="node89" class="node">
<title>expert_l0_12_gpu15</title>
<ellipse fill="none" stroke="black" cx="4576" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="4576" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="4576" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="4576" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4576" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4576" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_12_gpu15 -->
<g id="edge98" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_12_gpu15</title>
<path fill="none" stroke="black" d="M5850.74,-1660.08C5694.36,-1530.74 5373.9,-1277.3 5072,-1110.14 4964.76,-1050.76 4836.39,-999.04 4737.11,-962.84"/>
<polygon fill="black" stroke="black" points="4738.19,-959.51 4727.6,-959.39 4735.8,-966.09 4738.19,-959.51"/>
</g>
<!-- expert_l0_13_gpu15 -->
<g id="node90" class="node">
<title>expert_l0_13_gpu15</title>
<ellipse fill="none" stroke="black" cx="5282" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="5282" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5282" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="5282" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5282" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5282" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_13_gpu15 -->
<g id="edge99" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_13_gpu15</title>
<path fill="none" stroke="black" d="M5895.92,-1660.16C5815.68,-1536.01 5654.19,-1295.44 5493,-1110.14 5450.17,-1060.91 5397.05,-1010.17 5354.81,-971.9"/>
<polygon fill="black" stroke="black" points="5357.1,-969.25 5347.33,-965.15 5352.41,-974.45 5357.1,-969.25"/>
</g>
<!-- expert_l0_14_gpu15 -->
<g id="node91" class="node">
<title>expert_l0_14_gpu15</title>
<ellipse fill="none" stroke="black" cx="3164" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="3164" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="3164" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3164" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3164" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3164" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_14_gpu15 -->
<g id="edge100" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_14_gpu15</title>
<path fill="none" stroke="black" d="M5573.31,-1734.78C5218.01,-1718.04 4673.51,-1667.18 4226,-1516.31 3831.11,-1383.17 3417.84,-1097.16 3246.22,-970.73"/>
<polygon fill="black" stroke="black" points="3248.11,-967.78 3237.98,-964.65 3243.95,-973.41 3248.11,-967.78"/>
</g>
<!-- expert_l0_15_gpu15 -->
<g id="node92" class="node">
<title>expert_l0_15_gpu15</title>
<ellipse fill="none" stroke="black" cx="3870" cy="-907.45" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="3870" y="-933.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3870" y="-918.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="3870" y="-903.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3870" y="-888.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3870" y="-873.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- recv_moe_l0&#45;&gt;expert_l0_15_gpu15 -->
<g id="edge101" class="edge">
<title>recv_moe_l0&#45;&gt;expert_l0_15_gpu15</title>
<path fill="none" stroke="black" d="M5570.14,-1731.67C5257.38,-1712.17 4806.27,-1659.03 4438,-1516.31 4259.35,-1447.07 4210.52,-1416.41 4080,-1276.14 3995.43,-1185.25 3931.05,-1054.26 3897.02,-975.63"/>
<polygon fill="black" stroke="black" points="3900.18,-974.12 3893.02,-966.31 3893.75,-976.88 3900.18,-974.12"/>
</g>
<!-- gate_l0_gpu12 -->
<g id="node73" class="node">
<title>gate_l0_gpu12</title>
<polygon fill="orange" stroke="black" points="7160.58,-1276.14 6418.36,-1276.14 6227.42,-1110.14 6969.64,-1110.14 7160.58,-1276.14"/>
<text text-anchor="middle" x="6694" y="-1219.44" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="6694" y="-1204.44" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6694" y="-1189.44" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6694" y="-1174.44" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="6694" y="-1159.44" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ln_moe_l0_gpu12&#45;&gt;gate_l0_gpu12 -->
<g id="edge82" class="edge">
<title>ln_moe_l0_gpu12&#45;&gt;gate_l0_gpu12</title>
<path fill="none" stroke="black" d="M6647.69,-1419.97C6655.21,-1383.28 6665.88,-1331.28 6675.08,-1286.42"/>
<polygon fill="black" stroke="black" points="6678.56,-1286.88 6677.14,-1276.38 6671.7,-1285.47 6678.56,-1286.88"/>
</g>
<!-- gate_l0_gpu13 -->
<g id="node74" class="node">
<title>gate_l0_gpu13</title>
<polygon fill="orange" stroke="black" points="9984.58,-1276.14 9242.36,-1276.14 9051.42,-1110.14 9793.64,-1110.14 9984.58,-1276.14"/>
<text text-anchor="middle" x="9518" y="-1219.44" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="9518" y="-1204.44" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="9518" y="-1189.44" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9518" y="-1174.44" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="9518" y="-1159.44" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ln_moe_l0_gpu13&#45;&gt;gate_l0_gpu13 -->
<g id="edge83" class="edge">
<title>ln_moe_l0_gpu13&#45;&gt;gate_l0_gpu13</title>
<path fill="none" stroke="black" d="M9471.69,-1419.97C9479.21,-1383.28 9489.88,-1331.28 9499.08,-1286.42"/>
<polygon fill="black" stroke="black" points="9502.56,-1286.88 9501.14,-1276.38 9495.7,-1285.47 9502.56,-1286.88"/>
</g>
<!-- gate_l0_gpu14 -->
<g id="node75" class="node">
<title>gate_l0_gpu14</title>
<polygon fill="orange" stroke="black" points="2218.58,-1276.14 1476.36,-1276.14 1285.42,-1110.14 2027.64,-1110.14 2218.58,-1276.14"/>
<text text-anchor="middle" x="1752" y="-1219.44" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1752" y="-1204.44" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1752" y="-1189.44" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1752" y="-1174.44" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="1752" y="-1159.44" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ln_moe_l0_gpu14&#45;&gt;gate_l0_gpu14 -->
<g id="edge84" class="edge">
<title>ln_moe_l0_gpu14&#45;&gt;gate_l0_gpu14</title>
<path fill="none" stroke="black" d="M1796.66,-1419.97C1789.4,-1383.28 1779.12,-1331.28 1770.25,-1286.42"/>
<polygon fill="black" stroke="black" points="1773.64,-1285.51 1768.26,-1276.38 1766.77,-1286.87 1773.64,-1285.51"/>
</g>
<!-- gate_l0_gpu15 -->
<g id="node76" class="node">
<title>gate_l0_gpu15</title>
<polygon fill="orange" stroke="black" points="5042.58,-1276.14 4300.36,-1276.14 4109.42,-1110.14 4851.64,-1110.14 5042.58,-1276.14"/>
<text text-anchor="middle" x="4576" y="-1219.44" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="4576" y="-1204.44" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="4576" y="-1189.44" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4576" y="-1174.44" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="4576" y="-1159.44" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ln_moe_l0_gpu15&#45;&gt;gate_l0_gpu15 -->
<g id="edge85" class="edge">
<title>ln_moe_l0_gpu15&#45;&gt;gate_l0_gpu15</title>
<path fill="none" stroke="black" d="M4778.88,-1420.28C4745.32,-1382.86 4697.33,-1329.38 4656.46,-1283.82"/>
<polygon fill="black" stroke="black" points="4658.98,-1281.39 4649.7,-1276.29 4653.77,-1286.07 4658.98,-1281.39"/>
</g>
<!-- gate_l0_gpu12&#45;&gt;expert_l0_0_gpu12 -->
<g id="edge102" class="edge">
<title>gate_l0_gpu12&#45;&gt;expert_l0_0_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6694,-1110.08C6694,-1067.78 6694,-1016.8 6694,-976.68"/>
<polygon fill="black" stroke="black" points="6697.5,-976.47 6694,-966.47 6690.5,-976.47 6697.5,-976.47"/>
</g>
<!-- gate_l0_gpu12&#45;&gt;expert_l0_1_gpu12 -->
<g id="edge103" class="edge">
<title>gate_l0_gpu12&#45;&gt;expert_l0_1_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6898.2,-1110.08C7014.01,-1063.55 7155.97,-1006.51 7259.31,-964.98"/>
<polygon fill="black" stroke="black" points="7260.9,-968.11 7268.88,-961.14 7258.29,-961.62 7260.9,-968.11"/>
</g>
<!-- gate_l0_gpu12&#45;&gt;expert_l0_2_gpu12 -->
<g id="edge104" class="edge">
<title>gate_l0_gpu12&#45;&gt;expert_l0_2_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6994.75,-1131.72C7260.53,-1078.31 7642.19,-1001.63 7881.95,-953.46"/>
<polygon fill="black" stroke="black" points="7882.73,-956.88 7891.84,-951.48 7881.35,-950.01 7882.73,-956.88"/>
</g>
<!-- gate_l0_gpu12&#45;&gt;expert_l0_3_gpu12 -->
<g id="edge105" class="edge">
<title>gate_l0_gpu12&#45;&gt;expert_l0_3_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6489.8,-1110.08C6373.99,-1063.55 6232.03,-1006.51 6128.69,-964.98"/>
<polygon fill="black" stroke="black" points="6129.71,-961.62 6119.12,-961.14 6127.1,-968.11 6129.71,-961.62"/>
</g>
<!-- gate_l0_gpu13&#45;&gt;expert_l0_4_gpu13 -->
<g id="edge106" class="edge">
<title>gate_l0_gpu13&#45;&gt;expert_l0_4_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9518,-1110.08C9518,-1067.78 9518,-1016.8 9518,-976.68"/>
<polygon fill="black" stroke="black" points="9521.5,-976.47 9518,-966.47 9514.5,-976.47 9521.5,-976.47"/>
</g>
<!-- gate_l0_gpu13&#45;&gt;expert_l0_5_gpu13 -->
<g id="edge107" class="edge">
<title>gate_l0_gpu13&#45;&gt;expert_l0_5_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9722.2,-1110.08C9838.01,-1063.55 9979.97,-1006.51 10083.31,-964.98"/>
<polygon fill="black" stroke="black" points="10084.9,-968.11 10092.88,-961.14 10082.29,-961.62 10084.9,-968.11"/>
</g>
<!-- gate_l0_gpu13&#45;&gt;expert_l0_6_gpu13 -->
<g id="edge108" class="edge">
<title>gate_l0_gpu13&#45;&gt;expert_l0_6_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9818.75,-1131.72C10084.53,-1078.31 10466.19,-1001.63 10705.95,-953.46"/>
<polygon fill="black" stroke="black" points="10706.73,-956.88 10715.84,-951.48 10705.35,-950.01 10706.73,-956.88"/>
</g>
<!-- gate_l0_gpu13&#45;&gt;expert_l0_7_gpu13 -->
<g id="edge109" class="edge">
<title>gate_l0_gpu13&#45;&gt;expert_l0_7_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9313.8,-1110.08C9197.99,-1063.55 9056.03,-1006.51 8952.69,-964.98"/>
<polygon fill="black" stroke="black" points="8953.71,-961.62 8943.12,-961.14 8951.1,-968.11 8953.71,-961.62"/>
</g>
<!-- gate_l0_gpu14&#45;&gt;expert_l0_8_gpu14 -->
<g id="edge110" class="edge">
<title>gate_l0_gpu14&#45;&gt;expert_l0_8_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1752,-1110.08C1752,-1067.78 1752,-1016.8 1752,-976.68"/>
<polygon fill="black" stroke="black" points="1755.5,-976.47 1752,-966.47 1748.5,-976.47 1755.5,-976.47"/>
</g>
<!-- gate_l0_gpu14&#45;&gt;expert_l0_9_gpu14 -->
<g id="edge111" class="edge">
<title>gate_l0_gpu14&#45;&gt;expert_l0_9_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1956.2,-1110.08C2072.01,-1063.55 2213.97,-1006.51 2317.31,-964.98"/>
<polygon fill="black" stroke="black" points="2318.9,-968.11 2326.88,-961.14 2316.29,-961.62 2318.9,-968.11"/>
</g>
<!-- gate_l0_gpu14&#45;&gt;expert_l0_10_gpu14 -->
<g id="edge112" class="edge">
<title>gate_l0_gpu14&#45;&gt;expert_l0_10_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1343.59,-1110.08C1089.83,-1059.1 773.29,-995.5 564.34,-953.52"/>
<polygon fill="black" stroke="black" points="564.96,-950.08 554.47,-951.54 563.59,-956.94 564.96,-950.08"/>
</g>
<!-- gate_l0_gpu14&#45;&gt;expert_l0_11_gpu14 -->
<g id="edge113" class="edge">
<title>gate_l0_gpu14&#45;&gt;expert_l0_11_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1547.8,-1110.08C1431.99,-1063.55 1290.03,-1006.51 1186.69,-964.98"/>
<polygon fill="black" stroke="black" points="1187.71,-961.62 1177.12,-961.14 1185.1,-968.11 1187.71,-961.62"/>
</g>
<!-- gate_l0_gpu15&#45;&gt;expert_l0_12_gpu15 -->
<g id="edge114" class="edge">
<title>gate_l0_gpu15&#45;&gt;expert_l0_12_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4576,-1110.08C4576,-1067.78 4576,-1016.8 4576,-976.68"/>
<polygon fill="black" stroke="black" points="4579.5,-976.47 4576,-966.47 4572.5,-976.47 4579.5,-976.47"/>
</g>
<!-- gate_l0_gpu15&#45;&gt;expert_l0_13_gpu15 -->
<g id="edge115" class="edge">
<title>gate_l0_gpu15&#45;&gt;expert_l0_13_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4780.2,-1110.08C4896.01,-1063.55 5037.97,-1006.51 5141.31,-964.98"/>
<polygon fill="black" stroke="black" points="5142.9,-968.11 5150.88,-961.14 5140.29,-961.62 5142.9,-968.11"/>
</g>
<!-- gate_l0_gpu15&#45;&gt;expert_l0_14_gpu15 -->
<g id="edge116" class="edge">
<title>gate_l0_gpu15&#45;&gt;expert_l0_14_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4167.59,-1110.08C3913.83,-1059.1 3597.29,-995.5 3388.34,-953.52"/>
<polygon fill="black" stroke="black" points="3388.96,-950.08 3378.47,-951.54 3387.59,-956.94 3388.96,-950.08"/>
</g>
<!-- gate_l0_gpu15&#45;&gt;expert_l0_15_gpu15 -->
<g id="edge117" class="edge">
<title>gate_l0_gpu15&#45;&gt;expert_l0_15_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4371.8,-1110.08C4255.99,-1063.55 4114.03,-1006.51 4010.69,-964.98"/>
<polygon fill="black" stroke="black" points="4011.71,-961.62 4001.12,-961.14 4009.1,-968.11 4011.71,-961.62"/>
</g>
<!-- expert_agg_l0_gpu12 -->
<g id="node93" class="node">
<title>expert_agg_l0_gpu12</title>
<ellipse fill="lightyellow" stroke="black" cx="7047" cy="-646.07" rx="364.32" ry="58.88"/>
<text text-anchor="middle" x="7047" y="-672.37" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7047" y="-657.37" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7047" y="-642.37" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096, top_k=2]</text>
<text text-anchor="middle" x="7047" y="-627.37" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7047" y="-612.37" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_l0_0_gpu12&#45;&gt;expert_agg_l0_gpu12 -->
<g id="edge118" class="edge">
<title>expert_l0_0_gpu12&#45;&gt;expert_agg_l0_gpu12</title>
<path fill="none" stroke="black" d="M6770.6,-850.17C6827.05,-808.69 6903.83,-752.27 6962.15,-709.42"/>
<polygon fill="black" stroke="black" points="6964.26,-712.21 6970.25,-703.46 6960.12,-706.57 6964.26,-712.21"/>
</g>
<!-- expert_l0_1_gpu12&#45;&gt;expert_agg_l0_gpu12 -->
<g id="edge119" class="edge">
<title>expert_l0_1_gpu12&#45;&gt;expert_agg_l0_gpu12</title>
<path fill="none" stroke="black" d="M7323.4,-850.17C7266.95,-808.69 7190.17,-752.27 7131.85,-709.42"/>
<polygon fill="black" stroke="black" points="7133.88,-706.57 7123.75,-703.46 7129.74,-712.21 7133.88,-706.57"/>
</g>
<!-- expert_l0_2_gpu12&#45;&gt;expert_agg_l0_gpu12 -->
<g id="edge120" class="edge">
<title>expert_l0_2_gpu12&#45;&gt;expert_agg_l0_gpu12</title>
<path fill="none" stroke="black" d="M7915.75,-859.85C7729.52,-814.24 7446.57,-744.94 7254.6,-697.92"/>
<polygon fill="black" stroke="black" points="7255.21,-694.46 7244.67,-695.48 7253.55,-701.26 7255.21,-694.46"/>
</g>
<!-- expert_l0_3_gpu12&#45;&gt;expert_agg_l0_gpu12 -->
<g id="edge121" class="edge">
<title>expert_l0_3_gpu12&#45;&gt;expert_agg_l0_gpu12</title>
<path fill="none" stroke="black" d="M6178.25,-859.85C6364.48,-814.24 6647.43,-744.94 6839.4,-697.92"/>
<polygon fill="black" stroke="black" points="6840.45,-701.26 6849.33,-695.48 6838.79,-694.46 6840.45,-701.26"/>
</g>
<!-- expert_agg_l0_gpu13 -->
<g id="node94" class="node">
<title>expert_agg_l0_gpu13</title>
<ellipse fill="lightyellow" stroke="black" cx="9518" cy="-646.07" rx="364.32" ry="58.88"/>
<text text-anchor="middle" x="9518" y="-672.37" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9518" y="-657.37" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="9518" y="-642.37" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096, top_k=2]</text>
<text text-anchor="middle" x="9518" y="-627.37" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9518" y="-612.37" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_l0_4_gpu13&#45;&gt;expert_agg_l0_gpu13 -->
<g id="edge122" class="edge">
<title>expert_l0_4_gpu13&#45;&gt;expert_agg_l0_gpu13</title>
<path fill="none" stroke="black" d="M9518,-848.56C9518,-808.98 9518,-756.35 9518,-714.82"/>
<polygon fill="black" stroke="black" points="9521.5,-714.78 9518,-704.78 9514.5,-714.78 9521.5,-714.78"/>
</g>
<!-- expert_l0_5_gpu13&#45;&gt;expert_agg_l0_gpu13 -->
<g id="edge123" class="edge">
<title>expert_l0_5_gpu13&#45;&gt;expert_agg_l0_gpu13</title>
<path fill="none" stroke="black" d="M10082.83,-854.58C9963.9,-810.89 9794.06,-748.49 9671.72,-703.55"/>
<polygon fill="black" stroke="black" points="9672.85,-700.23 9662.26,-700.07 9670.44,-706.8 9672.85,-700.23"/>
</g>
<!-- expert_l0_6_gpu13&#45;&gt;expert_agg_l0_gpu13 -->
<g id="edge124" class="edge">
<title>expert_l0_6_gpu13&#45;&gt;expert_agg_l0_gpu13</title>
<path fill="none" stroke="black" d="M10705.09,-865.13C10448.71,-818.04 10030.89,-741.29 9765.46,-692.53"/>
<polygon fill="black" stroke="black" points="9765.77,-689.03 9755.3,-690.66 9764.5,-695.91 9765.77,-689.03"/>
</g>
<!-- expert_l0_7_gpu13&#45;&gt;expert_agg_l0_gpu13 -->
<g id="edge125" class="edge">
<title>expert_l0_7_gpu13&#45;&gt;expert_agg_l0_gpu13</title>
<path fill="none" stroke="black" d="M8953.17,-854.58C9072.1,-810.89 9241.94,-748.49 9364.28,-703.55"/>
<polygon fill="black" stroke="black" points="9365.56,-706.8 9373.74,-700.07 9363.15,-700.23 9365.56,-706.8"/>
</g>
<!-- expert_agg_l0_gpu14 -->
<g id="node95" class="node">
<title>expert_agg_l0_gpu14</title>
<ellipse fill="lightyellow" stroke="black" cx="1752" cy="-646.07" rx="364.32" ry="58.88"/>
<text text-anchor="middle" x="1752" y="-672.37" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1752" y="-657.37" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1752" y="-642.37" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096, top_k=2]</text>
<text text-anchor="middle" x="1752" y="-627.37" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1752" y="-612.37" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_l0_8_gpu14&#45;&gt;expert_agg_l0_gpu14 -->
<g id="edge126" class="edge">
<title>expert_l0_8_gpu14&#45;&gt;expert_agg_l0_gpu14</title>
<path fill="none" stroke="black" d="M1752,-848.56C1752,-808.98 1752,-756.35 1752,-714.82"/>
<polygon fill="black" stroke="black" points="1755.5,-714.78 1752,-704.78 1748.5,-714.78 1755.5,-714.78"/>
</g>
<!-- expert_l0_9_gpu14&#45;&gt;expert_agg_l0_gpu14 -->
<g id="edge127" class="edge">
<title>expert_l0_9_gpu14&#45;&gt;expert_agg_l0_gpu14</title>
<path fill="none" stroke="black" d="M2316.83,-854.58C2197.9,-810.89 2028.06,-748.49 1905.72,-703.55"/>
<polygon fill="black" stroke="black" points="1906.85,-700.23 1896.26,-700.07 1904.44,-706.8 1906.85,-700.23"/>
</g>
<!-- expert_l0_10_gpu14&#45;&gt;expert_agg_l0_gpu14 -->
<g id="edge128" class="edge">
<title>expert_l0_10_gpu14&#45;&gt;expert_agg_l0_gpu14</title>
<path fill="none" stroke="black" d="M564.91,-865.13C821.29,-818.04 1239.11,-741.29 1504.54,-692.53"/>
<polygon fill="black" stroke="black" points="1505.5,-695.91 1514.7,-690.66 1504.23,-689.03 1505.5,-695.91"/>
</g>
<!-- expert_l0_11_gpu14&#45;&gt;expert_agg_l0_gpu14 -->
<g id="edge129" class="edge">
<title>expert_l0_11_gpu14&#45;&gt;expert_agg_l0_gpu14</title>
<path fill="none" stroke="black" d="M1187.17,-854.58C1306.1,-810.89 1475.94,-748.49 1598.28,-703.55"/>
<polygon fill="black" stroke="black" points="1599.56,-706.8 1607.74,-700.07 1597.15,-700.23 1599.56,-706.8"/>
</g>
<!-- expert_agg_l0_gpu15 -->
<g id="node96" class="node">
<title>expert_agg_l0_gpu15</title>
<ellipse fill="lightyellow" stroke="black" cx="4576" cy="-646.07" rx="364.32" ry="58.88"/>
<text text-anchor="middle" x="4576" y="-672.37" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4576" y="-657.37" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="4576" y="-642.37" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096, top_k=2]</text>
<text text-anchor="middle" x="4576" y="-627.37" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4576" y="-612.37" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_l0_12_gpu15&#45;&gt;expert_agg_l0_gpu15 -->
<g id="edge130" class="edge">
<title>expert_l0_12_gpu15&#45;&gt;expert_agg_l0_gpu15</title>
<path fill="none" stroke="black" d="M4576,-848.56C4576,-808.98 4576,-756.35 4576,-714.82"/>
<polygon fill="black" stroke="black" points="4579.5,-714.78 4576,-704.78 4572.5,-714.78 4579.5,-714.78"/>
</g>
<!-- expert_l0_13_gpu15&#45;&gt;expert_agg_l0_gpu15 -->
<g id="edge131" class="edge">
<title>expert_l0_13_gpu15&#45;&gt;expert_agg_l0_gpu15</title>
<path fill="none" stroke="black" d="M5140.83,-854.58C5021.9,-810.89 4852.06,-748.49 4729.72,-703.55"/>
<polygon fill="black" stroke="black" points="4730.85,-700.23 4720.26,-700.07 4728.44,-706.8 4730.85,-700.23"/>
</g>
<!-- expert_l0_14_gpu15&#45;&gt;expert_agg_l0_gpu15 -->
<g id="edge132" class="edge">
<title>expert_l0_14_gpu15&#45;&gt;expert_agg_l0_gpu15</title>
<path fill="none" stroke="black" d="M3388.91,-865.13C3645.29,-818.04 4063.11,-741.29 4328.54,-692.53"/>
<polygon fill="black" stroke="black" points="4329.5,-695.91 4338.7,-690.66 4328.23,-689.03 4329.5,-695.91"/>
</g>
<!-- expert_l0_15_gpu15&#45;&gt;expert_agg_l0_gpu15 -->
<g id="edge133" class="edge">
<title>expert_l0_15_gpu15&#45;&gt;expert_agg_l0_gpu15</title>
<path fill="none" stroke="black" d="M4011.17,-854.58C4130.1,-810.89 4299.94,-748.49 4422.28,-703.55"/>
<polygon fill="black" stroke="black" points="4423.56,-706.8 4431.74,-700.07 4421.15,-700.23 4423.56,-706.8"/>
</g>
<!-- all_to_all_l0_gpu12 -->
<g id="node97" class="node">
<title>all_to_all_l0_gpu12</title>
<ellipse fill="yellow" stroke="black" cx="7047" cy="-384.69" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="7047" y="-410.99" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="7047" y="-395.99" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7047" y="-380.99" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7047" y="-365.99" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7047" y="-350.99" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- expert_agg_l0_gpu12&#45;&gt;all_to_all_l0_gpu12 -->
<g id="edge134" class="edge">
<title>expert_agg_l0_gpu12&#45;&gt;all_to_all_l0_gpu12</title>
<path fill="none" stroke="black" d="M7047,-587.18C7047,-547.6 7047,-494.97 7047,-453.44"/>
<polygon fill="black" stroke="black" points="7050.5,-453.4 7047,-443.4 7043.5,-453.4 7050.5,-453.4"/>
</g>
<!-- all_to_all_l0_gpu13 -->
<g id="node98" class="node">
<title>all_to_all_l0_gpu13</title>
<ellipse fill="yellow" stroke="black" cx="8812" cy="-384.69" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="8812" y="-410.99" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="8812" y="-395.99" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="8812" y="-380.99" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8812" y="-365.99" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8812" y="-350.99" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- expert_agg_l0_gpu13&#45;&gt;all_to_all_l0_gpu13 -->
<g id="edge135" class="edge">
<title>expert_agg_l0_gpu13&#45;&gt;all_to_all_l0_gpu13</title>
<path fill="none" stroke="black" d="M9373.85,-592.11C9254.07,-548.1 9084.19,-485.69 8962.64,-441.03"/>
<polygon fill="black" stroke="black" points="8963.83,-437.74 8953.24,-437.58 8961.42,-444.31 8963.83,-437.74"/>
</g>
<!-- all_to_all_l0_gpu14 -->
<g id="node99" class="node">
<title>all_to_all_l0_gpu14</title>
<ellipse fill="yellow" stroke="black" cx="2458" cy="-384.69" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="2458" y="-410.99" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="2458" y="-395.99" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="2458" y="-380.99" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2458" y="-365.99" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2458" y="-350.99" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- expert_agg_l0_gpu14&#45;&gt;all_to_all_l0_gpu14 -->
<g id="edge136" class="edge">
<title>expert_agg_l0_gpu14&#45;&gt;all_to_all_l0_gpu14</title>
<path fill="none" stroke="black" d="M1896.15,-592.11C2015.93,-548.1 2185.81,-485.69 2307.36,-441.03"/>
<polygon fill="black" stroke="black" points="2308.58,-444.31 2316.76,-437.58 2306.17,-437.74 2308.58,-444.31"/>
</g>
<!-- all_to_all_l0_gpu15 -->
<g id="node100" class="node">
<title>all_to_all_l0_gpu15</title>
<ellipse fill="yellow" stroke="black" cx="5282" cy="-384.69" rx="323.71" ry="58.88"/>
<text text-anchor="middle" x="5282" y="-410.99" font-family="Times,serif" font-size="14.00">All&#45;to&#45;All</text>
<text text-anchor="middle" x="5282" y="-395.99" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="5282" y="-380.99" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5282" y="-365.99" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5282" y="-350.99" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- expert_agg_l0_gpu15&#45;&gt;all_to_all_l0_gpu15 -->
<g id="edge137" class="edge">
<title>expert_agg_l0_gpu15&#45;&gt;all_to_all_l0_gpu15</title>
<path fill="none" stroke="black" d="M4720.15,-592.11C4839.93,-548.1 5009.81,-485.69 5131.36,-441.03"/>
<polygon fill="black" stroke="black" points="5132.58,-444.31 5140.76,-437.58 5130.17,-437.74 5132.58,-444.31"/>
</g>
<!-- return_l0 -->
<g id="node101" class="node">
<title>return_l0</title>
<polygon fill="lightcyan" stroke="black" points="7505.49,-182 6776.14,-182 6588.51,-16 7317.86,-16 7505.49,-182"/>
<text text-anchor="middle" x="7047" y="-125.3" font-family="Times,serif" font-size="14.00">Return to Attention</text>
<text text-anchor="middle" x="7047" y="-110.3" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="7047" y="-95.3" font-family="Times,serif" font-size="14.00">From: GPUs 12&#45;15</text>
<text text-anchor="middle" x="7047" y="-80.3" font-family="Times,serif" font-size="14.00">To: GPUs 0&#45;11</text>
<text text-anchor="middle" x="7047" y="-65.3" font-family="Times,serif" font-size="14.00">Data: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- all_to_all_l0_gpu12&#45;&gt;return_l0 -->
<g id="edge138" class="edge">
<title>all_to_all_l0_gpu12&#45;&gt;return_l0</title>
<path fill="none" stroke="black" d="M7047,-325.94C7047,-287.54 7047,-236.27 7047,-192.27"/>
<polygon fill="black" stroke="black" points="7050.5,-192.13 7047,-182.13 7043.5,-192.13 7050.5,-192.13"/>
</g>
<!-- all_to_all_l0_gpu13&#45;&gt;return_l0 -->
<g id="edge139" class="edge">
<title>all_to_all_l0_gpu13&#45;&gt;return_l0</title>
<path fill="none" stroke="black" d="M8572.13,-345.13C8298.77,-301.2 7845.76,-228.39 7504.32,-173.51"/>
<polygon fill="black" stroke="black" points="7504.68,-170.02 7494.25,-171.89 7503.57,-176.93 7504.68,-170.02"/>
</g>
<!-- all_to_all_l0_gpu14&#45;&gt;return_l0 -->
<g id="edge140" class="edge">
<title>all_to_all_l0_gpu14&#45;&gt;return_l0</title>
<path fill="none" stroke="black" d="M2763.1,-364.83C3582.53,-314.17 5827.94,-175.36 6697.02,-121.64"/>
<polygon fill="black" stroke="black" points="6697.42,-125.12 6707.19,-121.01 6696.99,-118.13 6697.42,-125.12"/>
</g>
<!-- all_to_all_l0_gpu15&#45;&gt;return_l0 -->
<g id="edge141" class="edge">
<title>all_to_all_l0_gpu15&#45;&gt;return_l0</title>
<path fill="none" stroke="black" d="M5521.87,-345.13C5834.5,-294.89 6382.13,-206.86 6729.09,-151.1"/>
<polygon fill="black" stroke="black" points="6729.72,-154.54 6739.03,-149.5 6728.61,-147.63 6729.72,-154.54"/>
</g>
<!-- return_l0&#45;&gt;ln1_l1 -->
<g id="edge142" class="edge">
<title>return_l0&#45;&gt;ln1_l1</title>
<path fill="none" stroke="black" d="M7422.51,-108.5C8469.02,-137.15 11342,-251.63 11342,-645.07 11342,-4116.62 11342,-4116.62 11342,-4116.62 11342,-4312.49 11141.22,-4468 11019.99,-4544.04"/>
<polygon fill="black" stroke="black" points="11018.04,-4541.13 11011.4,-4549.38 11021.74,-4547.07 11018.04,-4541.13"/>
</g>
<!-- final_output -->
<g id="node102" class="node">
<title>final_output</title>
<ellipse fill="lightgreen" stroke="black" cx="11638" cy="-4595.95" rx="325.95" ry="48.17"/>
<text text-anchor="middle" x="11638" y="-4614.75" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="11638" y="-4599.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11638" y="-4584.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, vocab_size=50265]</text>
<text text-anchor="middle" x="11638" y="-4569.75" font-family="Times,serif" font-size="14.00">GPU: 0&#45;11</text>
</g>
</g>
</svg>
