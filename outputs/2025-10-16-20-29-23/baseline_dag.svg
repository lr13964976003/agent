<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tp8_pp2 Pages: 1 -->
<svg width="956pt" height="12487pt"
 viewBox="0.00 0.00 956.00 12487.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 12483.33)">
<title>baseline_tp8_pp2</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-12483.33 952,-12483.33 952,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightblue" stroke="blue" d="M20,-5811.83C20,-5811.83 928,-5811.83 928,-5811.83 934,-5811.83 940,-5817.83 940,-5823.83 940,-5823.83 940,-12459.33 940,-12459.33 940,-12465.33 934,-12471.33 928,-12471.33 928,-12471.33 20,-12471.33 20,-12471.33 14,-12471.33 8,-12465.33 8,-12459.33 8,-12459.33 8,-5823.83 8,-5823.83 8,-5817.83 14,-5811.83 20,-5811.83"/>
<text text-anchor="middle" x="474" y="-12456.13" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgreen" stroke="green" d="M20,-8C20,-8 928,-8 928,-8 934,-8 940,-14 940,-20 940,-20 940,-5694.83 940,-5694.83 940,-5700.83 934,-5706.83 928,-5706.83 928,-5706.83 20,-5706.83 20,-5706.83 14,-5706.83 8,-5700.83 8,-5694.83 8,-5694.83 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="474" y="-5691.63" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (GPUs 8&#45;15)</text>
</g>
<!-- input_l0 -->
<g id="node1" class="node">
<title>input_l0</title>
<ellipse fill="lightgreen" stroke="black" cx="474" cy="-12392.24" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-12411.04" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="474" y="-12396.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-12381.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-12366.04" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- embed_l0 -->
<g id="node2" class="node">
<title>embed_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-12152.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-12170.88" font-family="Times,serif" font-size="14.00">Token Embedding</text>
<text text-anchor="middle" x="474" y="-12155.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="474" y="-12140.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-12125.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- input_l0&#45;&gt;embed_l0 -->
<g id="edge1" class="edge">
<title>input_l0&#45;&gt;embed_l0</title>
<path fill="none" stroke="black" d="M474,-12343.9C474,-12305.51 474,-12251.26 474,-12210.4"/>
<polygon fill="black" stroke="black" points="477.5,-12210.33 474,-12200.33 470.5,-12210.33 477.5,-12210.33"/>
</g>
<!-- ln1_l0 -->
<g id="node3" class="node">
<title>ln1_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-11911.91" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-11930.71" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="474" y="-11915.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-11900.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-11885.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP)</text>
</g>
<!-- embed_l0&#45;&gt;ln1_l0 -->
<g id="edge2" class="edge">
<title>embed_l0&#45;&gt;ln1_l0</title>
<path fill="none" stroke="black" d="M474,-12103.74C474,-12065.34 474,-12011.09 474,-11970.24"/>
<polygon fill="black" stroke="black" points="477.5,-11970.16 474,-11960.16 470.5,-11970.16 477.5,-11970.16"/>
</g>
<!-- qkv_l0 -->
<g id="node4" class="node">
<title>qkv_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-11671.74" rx="404.43" ry="48.17"/>
<text text-anchor="middle" x="474" y="-11690.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="474" y="-11675.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-11660.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=32, head_dim=128, 3]</text>
<text text-anchor="middle" x="474" y="-11645.54" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP split: 512 dim per GPU)</text>
</g>
<!-- ln1_l0&#45;&gt;qkv_l0 -->
<g id="edge3" class="edge">
<title>ln1_l0&#45;&gt;qkv_l0</title>
<path fill="none" stroke="black" d="M474,-11863.57C474,-11825.18 474,-11770.92 474,-11730.07"/>
<polygon fill="black" stroke="black" points="477.5,-11729.99 474,-11719.99 470.5,-11729.99 477.5,-11729.99"/>
</g>
<!-- attn_scores_l0 -->
<g id="node5" class="node">
<title>attn_scores_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-11431.58" rx="381.26" ry="48.17"/>
<text text-anchor="middle" x="474" y="-11450.38" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="474" y="-11435.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="474" y="-11420.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=4, seq_len=2048]</text>
<text text-anchor="middle" x="474" y="-11405.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (4 heads per GPU)</text>
</g>
<!-- qkv_l0&#45;&gt;attn_scores_l0 -->
<g id="edge4" class="edge">
<title>qkv_l0&#45;&gt;attn_scores_l0</title>
<path fill="none" stroke="black" d="M474,-11623.4C474,-11585.01 474,-11530.76 474,-11489.91"/>
<polygon fill="black" stroke="black" points="477.5,-11489.83 474,-11479.83 470.5,-11489.83 477.5,-11489.83"/>
</g>
<!-- attn_weights_l0 -->
<g id="node6" class="node">
<title>attn_weights_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-11191.41" rx="381.26" ry="48.17"/>
<text text-anchor="middle" x="474" y="-11210.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="474" y="-11195.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, num_heads=4, seq_len=2048]</text>
<text text-anchor="middle" x="474" y="-11180.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=4, seq_len=2048]</text>
<text text-anchor="middle" x="474" y="-11165.21" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_scores_l0&#45;&gt;attn_weights_l0 -->
<g id="edge5" class="edge">
<title>attn_scores_l0&#45;&gt;attn_weights_l0</title>
<path fill="none" stroke="black" d="M474,-11383.24C474,-11344.84 474,-11290.59 474,-11249.74"/>
<polygon fill="black" stroke="black" points="477.5,-11249.66 474,-11239.66 470.5,-11249.66 477.5,-11249.66"/>
</g>
<!-- attn_output_l0 -->
<g id="node7" class="node">
<title>attn_output_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-10951.24" rx="385.25" ry="48.17"/>
<text text-anchor="middle" x="474" y="-10970.04" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="474" y="-10955.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="474" y="-10940.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="474" y="-10925.04" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_weights_l0&#45;&gt;attn_output_l0 -->
<g id="edge6" class="edge">
<title>attn_weights_l0&#45;&gt;attn_output_l0</title>
<path fill="none" stroke="black" d="M474,-11143.07C474,-11104.68 474,-11050.42 474,-11009.57"/>
<polygon fill="black" stroke="black" points="477.5,-11009.49 474,-10999.49 470.5,-11009.49 477.5,-11009.49"/>
</g>
<!-- o_proj_l0 -->
<g id="node8" class="node">
<title>o_proj_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-10711.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-10729.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="474" y="-10714.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-10699.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-10684.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP row split)</text>
</g>
<!-- attn_output_l0&#45;&gt;o_proj_l0 -->
<g id="edge7" class="edge">
<title>attn_output_l0&#45;&gt;o_proj_l0</title>
<path fill="none" stroke="black" d="M474,-10902.9C474,-10864.51 474,-10810.26 474,-10769.41"/>
<polygon fill="black" stroke="black" points="477.5,-10769.33 474,-10759.33 470.5,-10769.33 477.5,-10769.33"/>
</g>
<!-- all_reduce_l0 -->
<g id="node9" class="node">
<title>all_reduce_l0</title>
<ellipse fill="yellow" stroke="black" cx="474" cy="-10470.91" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-10489.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="474" y="-10474.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-10459.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-10444.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- o_proj_l0&#45;&gt;all_reduce_l0 -->
<g id="edge8" class="edge">
<title>o_proj_l0&#45;&gt;all_reduce_l0</title>
<path fill="none" stroke="black" d="M474,-10662.74C474,-10624.35 474,-10570.09 474,-10529.24"/>
<polygon fill="black" stroke="black" points="477.5,-10529.16 474,-10519.16 470.5,-10529.16 477.5,-10529.16"/>
</g>
<!-- res1_l0 -->
<g id="node10" class="node">
<title>res1_l0</title>
<ellipse fill="pink" stroke="black" cx="474" cy="-10230.74" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-10249.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="474" y="-10234.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-10219.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-10204.54" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- all_reduce_l0&#45;&gt;res1_l0 -->
<g id="edge9" class="edge">
<title>all_reduce_l0&#45;&gt;res1_l0</title>
<path fill="none" stroke="black" d="M474,-10422.57C474,-10384.18 474,-10329.92 474,-10289.07"/>
<polygon fill="black" stroke="black" points="477.5,-10288.99 474,-10278.99 470.5,-10288.99 477.5,-10288.99"/>
</g>
<!-- ln2_l0 -->
<g id="node11" class="node">
<title>ln2_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-9990.58" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-10009.38" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="474" y="-9994.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-9979.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-9964.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- res1_l0&#45;&gt;ln2_l0 -->
<g id="edge10" class="edge">
<title>res1_l0&#45;&gt;ln2_l0</title>
<path fill="none" stroke="black" d="M474,-10182.41C474,-10144.01 474,-10089.76 474,-10048.91"/>
<polygon fill="black" stroke="black" points="477.5,-10048.83 474,-10038.83 470.5,-10048.83 477.5,-10048.83"/>
</g>
<!-- mlp_up_l0 -->
<g id="node12" class="node">
<title>mlp_up_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-9750.41" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="474" y="-9769.21" font-family="Times,serif" font-size="14.00">MLP Up&#45;Projection</text>
<text text-anchor="middle" x="474" y="-9754.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-9739.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-9724.21" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP column split)</text>
</g>
<!-- ln2_l0&#45;&gt;mlp_up_l0 -->
<g id="edge11" class="edge">
<title>ln2_l0&#45;&gt;mlp_up_l0</title>
<path fill="none" stroke="black" d="M474,-9942.24C474,-9903.85 474,-9849.59 474,-9808.74"/>
<polygon fill="black" stroke="black" points="477.5,-9808.66 474,-9798.66 470.5,-9808.66 477.5,-9808.66"/>
</g>
<!-- mlp_act_l0 -->
<g id="node13" class="node">
<title>mlp_act_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-9510.24" rx="263.5" ry="48.17"/>
<text text-anchor="middle" x="474" y="-9529.04" font-family="Times,serif" font-size="14.00">GeLU Activation</text>
<text text-anchor="middle" x="474" y="-9514.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-9499.04" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-9484.04" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_up_l0&#45;&gt;mlp_act_l0 -->
<g id="edge12" class="edge">
<title>mlp_up_l0&#45;&gt;mlp_act_l0</title>
<path fill="none" stroke="black" d="M474,-9702.07C474,-9663.68 474,-9609.42 474,-9568.57"/>
<polygon fill="black" stroke="black" points="477.5,-9568.49 474,-9558.49 470.5,-9568.49 477.5,-9568.49"/>
</g>
<!-- mlp_down_l0 -->
<g id="node14" class="node">
<title>mlp_down_l0</title>
<ellipse fill="none" stroke="black" cx="474" cy="-9270.08" rx="257.27" ry="48.17"/>
<text text-anchor="middle" x="474" y="-9288.88" font-family="Times,serif" font-size="14.00">MLP Down&#45;Projection</text>
<text text-anchor="middle" x="474" y="-9273.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-9258.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 4096]</text>
<text text-anchor="middle" x="474" y="-9243.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP row split)</text>
</g>
<!-- mlp_act_l0&#45;&gt;mlp_down_l0 -->
<g id="edge13" class="edge">
<title>mlp_act_l0&#45;&gt;mlp_down_l0</title>
<path fill="none" stroke="black" d="M474,-9461.91C474,-9423.51 474,-9369.26 474,-9328.41"/>
<polygon fill="black" stroke="black" points="477.5,-9328.33 474,-9318.33 470.5,-9328.33 477.5,-9328.33"/>
</g>
<!-- all_reduce_mlp_l0 -->
<g id="node15" class="node">
<title>all_reduce_mlp_l0</title>
<ellipse fill="yellow" stroke="black" cx="474" cy="-9029.91" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-9048.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="474" y="-9033.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-9018.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-9003.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_down_l0&#45;&gt;all_reduce_mlp_l0 -->
<g id="edge14" class="edge">
<title>mlp_down_l0&#45;&gt;all_reduce_mlp_l0</title>
<path fill="none" stroke="black" d="M474,-9221.74C474,-9183.35 474,-9129.09 474,-9088.24"/>
<polygon fill="black" stroke="black" points="477.5,-9088.16 474,-9078.16 470.5,-9088.16 477.5,-9088.16"/>
</g>
<!-- res2_l0 -->
<g id="node16" class="node">
<title>res2_l0</title>
<ellipse fill="pink" stroke="black" cx="474" cy="-8789.75" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-8808.55" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="474" y="-8793.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-8778.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-8763.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- all_reduce_mlp_l0&#45;&gt;res2_l0 -->
<g id="edge15" class="edge">
<title>all_reduce_mlp_l0&#45;&gt;res2_l0</title>
<path fill="none" stroke="black" d="M474,-8981.57C474,-8943.18 474,-8888.92 474,-8848.07"/>
<polygon fill="black" stroke="black" points="477.5,-8847.99 474,-8837.99 470.5,-8847.99 477.5,-8847.99"/>
</g>
<!-- ln1_l1 -->
<g id="node17" class="node">
<title>ln1_l1</title>
<ellipse fill="none" stroke="black" cx="474" cy="-8549.58" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-8568.38" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="474" y="-8553.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-8538.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-8523.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- res2_l0&#45;&gt;ln1_l1 -->
<g id="edge16" class="edge">
<title>res2_l0&#45;&gt;ln1_l1</title>
<path fill="none" stroke="black" d="M474,-8741.41C474,-8703.01 474,-8648.76 474,-8607.91"/>
<polygon fill="black" stroke="black" points="477.5,-8607.83 474,-8597.83 470.5,-8607.83 477.5,-8607.83"/>
</g>
<!-- qkv_l1 -->
<g id="node18" class="node">
<title>qkv_l1</title>
<ellipse fill="none" stroke="black" cx="474" cy="-8309.41" rx="404.43" ry="48.17"/>
<text text-anchor="middle" x="474" y="-8328.21" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="474" y="-8313.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-8298.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=32, head_dim=128, 3]</text>
<text text-anchor="middle" x="474" y="-8283.21" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (TP split)</text>
</g>
<!-- ln1_l1&#45;&gt;qkv_l1 -->
<g id="edge17" class="edge">
<title>ln1_l1&#45;&gt;qkv_l1</title>
<path fill="none" stroke="black" d="M474,-8501.24C474,-8462.85 474,-8408.59 474,-8367.74"/>
<polygon fill="black" stroke="black" points="477.5,-8367.66 474,-8357.66 470.5,-8367.66 477.5,-8367.66"/>
</g>
<!-- attn_scores_l1 -->
<g id="node19" class="node">
<title>attn_scores_l1</title>
<ellipse fill="none" stroke="black" cx="474" cy="-8069.25" rx="381.26" ry="48.17"/>
<text text-anchor="middle" x="474" y="-8088.05" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="474" y="-8073.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="474" y="-8058.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=4, seq_len=2048]</text>
<text text-anchor="middle" x="474" y="-8043.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- qkv_l1&#45;&gt;attn_scores_l1 -->
<g id="edge18" class="edge">
<title>qkv_l1&#45;&gt;attn_scores_l1</title>
<path fill="none" stroke="black" d="M474,-8261.07C474,-8222.68 474,-8168.42 474,-8127.57"/>
<polygon fill="black" stroke="black" points="477.5,-8127.49 474,-8117.49 470.5,-8127.49 477.5,-8127.49"/>
</g>
<!-- o_proj_l1 -->
<g id="node20" class="node">
<title>o_proj_l1</title>
<ellipse fill="none" stroke="black" cx="474" cy="-7829.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-7847.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="474" y="-7832.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-7817.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-7802.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- attn_scores_l1&#45;&gt;o_proj_l1 -->
<g id="edge19" class="edge">
<title>attn_scores_l1&#45;&gt;o_proj_l1</title>
<path fill="none" stroke="black" d="M474,-8020.91C474,-7982.51 474,-7928.26 474,-7887.41"/>
<polygon fill="black" stroke="black" points="477.5,-7887.33 474,-7877.33 470.5,-7887.33 477.5,-7887.33"/>
</g>
<!-- all_reduce_l1 -->
<g id="node21" class="node">
<title>all_reduce_l1</title>
<ellipse fill="yellow" stroke="black" cx="474" cy="-7588.91" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-7607.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="474" y="-7592.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-7577.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-7562.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- o_proj_l1&#45;&gt;all_reduce_l1 -->
<g id="edge20" class="edge">
<title>o_proj_l1&#45;&gt;all_reduce_l1</title>
<path fill="none" stroke="black" d="M474,-7780.74C474,-7742.35 474,-7688.09 474,-7647.24"/>
<polygon fill="black" stroke="black" points="477.5,-7647.16 474,-7637.16 470.5,-7647.16 477.5,-7647.16"/>
</g>
<!-- res1_l1 -->
<g id="node22" class="node">
<title>res1_l1</title>
<ellipse fill="pink" stroke="black" cx="474" cy="-7348.75" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-7367.55" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="474" y="-7352.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-7337.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-7322.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- all_reduce_l1&#45;&gt;res1_l1 -->
<g id="edge21" class="edge">
<title>all_reduce_l1&#45;&gt;res1_l1</title>
<path fill="none" stroke="black" d="M474,-7540.57C474,-7502.18 474,-7447.92 474,-7407.07"/>
<polygon fill="black" stroke="black" points="477.5,-7407 474,-7397 470.5,-7407 477.5,-7407"/>
</g>
<!-- ln2_l1 -->
<g id="node23" class="node">
<title>ln2_l1</title>
<ellipse fill="none" stroke="black" cx="474" cy="-7108.58" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-7127.38" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="474" y="-7112.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-7097.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-7082.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- res1_l1&#45;&gt;ln2_l1 -->
<g id="edge22" class="edge">
<title>res1_l1&#45;&gt;ln2_l1</title>
<path fill="none" stroke="black" d="M474,-7300.41C474,-7262.01 474,-7207.76 474,-7166.91"/>
<polygon fill="black" stroke="black" points="477.5,-7166.83 474,-7156.83 470.5,-7166.83 477.5,-7166.83"/>
</g>
<!-- mlp_up_l1 -->
<g id="node24" class="node">
<title>mlp_up_l1</title>
<ellipse fill="none" stroke="black" cx="474" cy="-6868.41" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="474" y="-6887.21" font-family="Times,serif" font-size="14.00">MLP Up&#45;Projection</text>
<text text-anchor="middle" x="474" y="-6872.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-6857.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-6842.21" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln2_l1&#45;&gt;mlp_up_l1 -->
<g id="edge23" class="edge">
<title>ln2_l1&#45;&gt;mlp_up_l1</title>
<path fill="none" stroke="black" d="M474,-7060.24C474,-7021.85 474,-6967.59 474,-6926.74"/>
<polygon fill="black" stroke="black" points="477.5,-6926.66 474,-6916.66 470.5,-6926.66 477.5,-6926.66"/>
</g>
<!-- mlp_down_l1 -->
<g id="node25" class="node">
<title>mlp_down_l1</title>
<ellipse fill="none" stroke="black" cx="474" cy="-6628.25" rx="257.27" ry="48.17"/>
<text text-anchor="middle" x="474" y="-6647.05" font-family="Times,serif" font-size="14.00">MLP Down&#45;Projection</text>
<text text-anchor="middle" x="474" y="-6632.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-6617.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 4096]</text>
<text text-anchor="middle" x="474" y="-6602.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_up_l1&#45;&gt;mlp_down_l1 -->
<g id="edge24" class="edge">
<title>mlp_up_l1&#45;&gt;mlp_down_l1</title>
<path fill="none" stroke="black" d="M474,-6820.07C474,-6781.68 474,-6727.43 474,-6686.57"/>
<polygon fill="black" stroke="black" points="477.5,-6686.5 474,-6676.5 470.5,-6686.5 477.5,-6686.5"/>
</g>
<!-- all_reduce_mlp_l1 -->
<g id="node26" class="node">
<title>all_reduce_mlp_l1</title>
<ellipse fill="yellow" stroke="black" cx="474" cy="-6388.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-6406.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="474" y="-6391.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-6376.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-6361.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mlp_down_l1&#45;&gt;all_reduce_mlp_l1 -->
<g id="edge25" class="edge">
<title>mlp_down_l1&#45;&gt;all_reduce_mlp_l1</title>
<path fill="none" stroke="black" d="M474,-6579.91C474,-6541.51 474,-6487.26 474,-6446.41"/>
<polygon fill="black" stroke="black" points="477.5,-6446.33 474,-6436.33 470.5,-6446.33 477.5,-6446.33"/>
</g>
<!-- res2_l1 -->
<g id="node27" class="node">
<title>res2_l1</title>
<ellipse fill="pink" stroke="black" cx="474" cy="-6147.91" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-6166.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="474" y="-6151.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-6136.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-6121.71" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- all_reduce_mlp_l1&#45;&gt;res2_l1 -->
<g id="edge26" class="edge">
<title>all_reduce_mlp_l1&#45;&gt;res2_l1</title>
<path fill="none" stroke="black" d="M474,-6339.74C474,-6301.35 474,-6247.09 474,-6206.24"/>
<polygon fill="black" stroke="black" points="477.5,-6206.16 474,-6196.16 470.5,-6206.16 477.5,-6206.16"/>
</g>
<!-- send_stage1 -->
<g id="node28" class="node">
<title>send_stage1</title>
<polygon fill="lightcyan" stroke="black" points="932.49,-5955.83 203.14,-5955.83 15.51,-5819.83 744.86,-5819.83 932.49,-5955.83"/>
<text text-anchor="middle" x="474" y="-5906.63" font-family="Times,serif" font-size="14.00">Send to Stage 1</text>
<text text-anchor="middle" x="474" y="-5891.63" font-family="Times,serif" font-size="14.00">From: GPUs 0&#45;7</text>
<text text-anchor="middle" x="474" y="-5876.63" font-family="Times,serif" font-size="14.00">To: GPUs 8&#45;15</text>
<text text-anchor="middle" x="474" y="-5861.63" font-family="Times,serif" font-size="14.00">Data: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- res2_l1&#45;&gt;send_stage1 -->
<g id="edge27" class="edge">
<title>res2_l1&#45;&gt;send_stage1</title>
<path fill="none" stroke="black" d="M474,-6099.58C474,-6062.39 474,-6009.84 474,-5966.51"/>
<polygon fill="black" stroke="black" points="477.5,-5966.28 474,-5956.28 470.5,-5966.28 477.5,-5966.28"/>
</g>
<!-- recv_stage1 -->
<g id="node29" class="node">
<title>recv_stage1</title>
<polygon fill="lightcyan" stroke="black" points="932.49,-5675.83 203.14,-5675.83 15.51,-5539.83 744.86,-5539.83 932.49,-5675.83"/>
<text text-anchor="middle" x="474" y="-5626.63" font-family="Times,serif" font-size="14.00">Receive from Stage 0</text>
<text text-anchor="middle" x="474" y="-5611.63" font-family="Times,serif" font-size="14.00">From: GPUs 0&#45;7</text>
<text text-anchor="middle" x="474" y="-5596.63" font-family="Times,serif" font-size="14.00">To: GPUs 8&#45;15</text>
<text text-anchor="middle" x="474" y="-5581.63" font-family="Times,serif" font-size="14.00">Data: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- send_stage1&#45;&gt;recv_stage1 -->
<g id="edge28" class="edge">
<title>send_stage1&#45;&gt;recv_stage1</title>
<path fill="none" stroke="black" d="M474,-5811.83C474,-5782.67 474,-5748.69 474,-5716.97"/>
<polygon fill="black" stroke="black" points="477.5,-5716.83 474,-5706.83 470.5,-5716.83 477.5,-5716.83"/>
</g>
<!-- ln1_l2 -->
<g id="node30" class="node">
<title>ln1_l2</title>
<ellipse fill="none" stroke="black" cx="474" cy="-5347.75" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-5366.55" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="474" y="-5351.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-5336.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-5321.55" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- recv_stage1&#45;&gt;ln1_l2 -->
<g id="edge29" class="edge">
<title>recv_stage1&#45;&gt;ln1_l2</title>
<path fill="none" stroke="black" d="M474,-5539.7C474,-5498.2 474,-5445.52 474,-5406"/>
<polygon fill="black" stroke="black" points="477.5,-5406 474,-5396 470.5,-5406 477.5,-5406"/>
</g>
<!-- qkv_l2 -->
<g id="node31" class="node">
<title>qkv_l2</title>
<ellipse fill="none" stroke="black" cx="474" cy="-5107.58" rx="404.43" ry="48.17"/>
<text text-anchor="middle" x="474" y="-5126.38" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="474" y="-5111.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-5096.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=32, head_dim=128, 3]</text>
<text text-anchor="middle" x="474" y="-5081.38" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln1_l2&#45;&gt;qkv_l2 -->
<g id="edge30" class="edge">
<title>ln1_l2&#45;&gt;qkv_l2</title>
<path fill="none" stroke="black" d="M474,-5299.41C474,-5261.01 474,-5206.76 474,-5165.91"/>
<polygon fill="black" stroke="black" points="477.5,-5165.83 474,-5155.83 470.5,-5165.83 477.5,-5165.83"/>
</g>
<!-- attn_scores_l2 -->
<g id="node32" class="node">
<title>attn_scores_l2</title>
<ellipse fill="none" stroke="black" cx="474" cy="-4867.41" rx="381.26" ry="48.17"/>
<text text-anchor="middle" x="474" y="-4886.21" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="474" y="-4871.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="474" y="-4856.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=4, seq_len=2048]</text>
<text text-anchor="middle" x="474" y="-4841.21" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- qkv_l2&#45;&gt;attn_scores_l2 -->
<g id="edge31" class="edge">
<title>qkv_l2&#45;&gt;attn_scores_l2</title>
<path fill="none" stroke="black" d="M474,-5059.24C474,-5020.85 474,-4966.59 474,-4925.74"/>
<polygon fill="black" stroke="black" points="477.5,-4925.66 474,-4915.66 470.5,-4925.66 477.5,-4925.66"/>
</g>
<!-- o_proj_l2 -->
<g id="node33" class="node">
<title>o_proj_l2</title>
<ellipse fill="none" stroke="black" cx="474" cy="-4627.25" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-4646.05" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="474" y="-4631.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-4616.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-4601.05" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- attn_scores_l2&#45;&gt;o_proj_l2 -->
<g id="edge32" class="edge">
<title>attn_scores_l2&#45;&gt;o_proj_l2</title>
<path fill="none" stroke="black" d="M474,-4819.07C474,-4780.68 474,-4726.43 474,-4685.58"/>
<polygon fill="black" stroke="black" points="477.5,-4685.5 474,-4675.5 470.5,-4685.5 477.5,-4685.5"/>
</g>
<!-- all_reduce_l2 -->
<g id="node34" class="node">
<title>all_reduce_l2</title>
<ellipse fill="yellow" stroke="black" cx="474" cy="-4387.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-4405.88" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="474" y="-4390.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-4375.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-4360.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- o_proj_l2&#45;&gt;all_reduce_l2 -->
<g id="edge33" class="edge">
<title>o_proj_l2&#45;&gt;all_reduce_l2</title>
<path fill="none" stroke="black" d="M474,-4578.91C474,-4540.52 474,-4486.26 474,-4445.41"/>
<polygon fill="black" stroke="black" points="477.5,-4445.33 474,-4435.33 470.5,-4445.33 477.5,-4445.33"/>
</g>
<!-- res1_l2 -->
<g id="node35" class="node">
<title>res1_l2</title>
<ellipse fill="pink" stroke="black" cx="474" cy="-4146.91" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-4165.71" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="474" y="-4150.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-4135.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-4120.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- all_reduce_l2&#45;&gt;res1_l2 -->
<g id="edge34" class="edge">
<title>all_reduce_l2&#45;&gt;res1_l2</title>
<path fill="none" stroke="black" d="M474,-4338.74C474,-4300.35 474,-4246.09 474,-4205.24"/>
<polygon fill="black" stroke="black" points="477.5,-4205.16 474,-4195.16 470.5,-4205.16 477.5,-4205.16"/>
</g>
<!-- ln2_l2 -->
<g id="node36" class="node">
<title>ln2_l2</title>
<ellipse fill="none" stroke="black" cx="474" cy="-3906.75" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-3925.55" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="474" y="-3910.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-3895.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-3880.55" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- res1_l2&#45;&gt;ln2_l2 -->
<g id="edge35" class="edge">
<title>res1_l2&#45;&gt;ln2_l2</title>
<path fill="none" stroke="black" d="M474,-4098.58C474,-4060.18 474,-4005.93 474,-3965.08"/>
<polygon fill="black" stroke="black" points="477.5,-3965 474,-3955 470.5,-3965 477.5,-3965"/>
</g>
<!-- mlp_up_l2 -->
<g id="node37" class="node">
<title>mlp_up_l2</title>
<ellipse fill="none" stroke="black" cx="474" cy="-3666.58" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="474" y="-3685.38" font-family="Times,serif" font-size="14.00">MLP Up&#45;Projection</text>
<text text-anchor="middle" x="474" y="-3670.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-3655.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-3640.38" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln2_l2&#45;&gt;mlp_up_l2 -->
<g id="edge36" class="edge">
<title>ln2_l2&#45;&gt;mlp_up_l2</title>
<path fill="none" stroke="black" d="M474,-3858.41C474,-3820.02 474,-3765.76 474,-3724.91"/>
<polygon fill="black" stroke="black" points="477.5,-3724.83 474,-3714.83 470.5,-3724.83 477.5,-3724.83"/>
</g>
<!-- mlp_down_l2 -->
<g id="node38" class="node">
<title>mlp_down_l2</title>
<ellipse fill="none" stroke="black" cx="474" cy="-3426.41" rx="257.27" ry="48.17"/>
<text text-anchor="middle" x="474" y="-3445.21" font-family="Times,serif" font-size="14.00">MLP Down&#45;Projection</text>
<text text-anchor="middle" x="474" y="-3430.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-3415.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 4096]</text>
<text text-anchor="middle" x="474" y="-3400.21" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mlp_up_l2&#45;&gt;mlp_down_l2 -->
<g id="edge37" class="edge">
<title>mlp_up_l2&#45;&gt;mlp_down_l2</title>
<path fill="none" stroke="black" d="M474,-3618.24C474,-3579.85 474,-3525.59 474,-3484.74"/>
<polygon fill="black" stroke="black" points="477.5,-3484.66 474,-3474.66 470.5,-3484.66 477.5,-3484.66"/>
</g>
<!-- all_reduce_mlp_l2 -->
<g id="node39" class="node">
<title>all_reduce_mlp_l2</title>
<ellipse fill="yellow" stroke="black" cx="474" cy="-3186.25" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-3205.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="474" y="-3190.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-3175.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-3160.05" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mlp_down_l2&#45;&gt;all_reduce_mlp_l2 -->
<g id="edge38" class="edge">
<title>mlp_down_l2&#45;&gt;all_reduce_mlp_l2</title>
<path fill="none" stroke="black" d="M474,-3378.08C474,-3339.68 474,-3285.43 474,-3244.58"/>
<polygon fill="black" stroke="black" points="477.5,-3244.5 474,-3234.5 470.5,-3244.5 477.5,-3244.5"/>
</g>
<!-- res2_l2 -->
<g id="node40" class="node">
<title>res2_l2</title>
<ellipse fill="pink" stroke="black" cx="474" cy="-2946.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-2964.88" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="474" y="-2949.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-2934.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-2919.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- all_reduce_mlp_l2&#45;&gt;res2_l2 -->
<g id="edge39" class="edge">
<title>all_reduce_mlp_l2&#45;&gt;res2_l2</title>
<path fill="none" stroke="black" d="M474,-3137.91C474,-3099.52 474,-3045.26 474,-3004.41"/>
<polygon fill="black" stroke="black" points="477.5,-3004.33 474,-2994.33 470.5,-3004.33 477.5,-3004.33"/>
</g>
<!-- ln1_l3 -->
<g id="node41" class="node">
<title>ln1_l3</title>
<ellipse fill="none" stroke="black" cx="474" cy="-2705.92" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-2724.72" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="474" y="-2709.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-2694.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-2679.72" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- res2_l2&#45;&gt;ln1_l3 -->
<g id="edge40" class="edge">
<title>res2_l2&#45;&gt;ln1_l3</title>
<path fill="none" stroke="black" d="M474,-2897.74C474,-2859.35 474,-2805.09 474,-2764.24"/>
<polygon fill="black" stroke="black" points="477.5,-2764.16 474,-2754.16 470.5,-2764.16 477.5,-2764.16"/>
</g>
<!-- qkv_l3 -->
<g id="node42" class="node">
<title>qkv_l3</title>
<ellipse fill="none" stroke="black" cx="474" cy="-2465.75" rx="404.43" ry="48.17"/>
<text text-anchor="middle" x="474" y="-2484.55" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="474" y="-2469.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-2454.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=32, head_dim=128, 3]</text>
<text text-anchor="middle" x="474" y="-2439.55" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln1_l3&#45;&gt;qkv_l3 -->
<g id="edge41" class="edge">
<title>ln1_l3&#45;&gt;qkv_l3</title>
<path fill="none" stroke="black" d="M474,-2657.58C474,-2619.18 474,-2564.93 474,-2524.08"/>
<polygon fill="black" stroke="black" points="477.5,-2524 474,-2514 470.5,-2524 477.5,-2524"/>
</g>
<!-- attn_scores_l3 -->
<g id="node43" class="node">
<title>attn_scores_l3</title>
<ellipse fill="none" stroke="black" cx="474" cy="-2225.58" rx="381.26" ry="48.17"/>
<text text-anchor="middle" x="474" y="-2244.38" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="474" y="-2229.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, num_heads=4, head_dim=128]</text>
<text text-anchor="middle" x="474" y="-2214.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, num_heads=4, seq_len=2048]</text>
<text text-anchor="middle" x="474" y="-2199.38" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- qkv_l3&#45;&gt;attn_scores_l3 -->
<g id="edge42" class="edge">
<title>qkv_l3&#45;&gt;attn_scores_l3</title>
<path fill="none" stroke="black" d="M474,-2417.41C474,-2379.02 474,-2324.76 474,-2283.91"/>
<polygon fill="black" stroke="black" points="477.5,-2283.83 474,-2273.83 470.5,-2283.83 477.5,-2283.83"/>
</g>
<!-- o_proj_l3 -->
<g id="node44" class="node">
<title>o_proj_l3</title>
<ellipse fill="none" stroke="black" cx="474" cy="-1985.42" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-2004.22" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="474" y="-1989.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1974.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1959.22" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- attn_scores_l3&#45;&gt;o_proj_l3 -->
<g id="edge43" class="edge">
<title>attn_scores_l3&#45;&gt;o_proj_l3</title>
<path fill="none" stroke="black" d="M474,-2177.24C474,-2138.85 474,-2084.59 474,-2043.74"/>
<polygon fill="black" stroke="black" points="477.5,-2043.66 474,-2033.66 470.5,-2043.66 477.5,-2043.66"/>
</g>
<!-- all_reduce_l3 -->
<g id="node45" class="node">
<title>all_reduce_l3</title>
<ellipse fill="yellow" stroke="black" cx="474" cy="-1745.25" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-1764.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="474" y="-1749.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1734.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1719.05" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- o_proj_l3&#45;&gt;all_reduce_l3 -->
<g id="edge44" class="edge">
<title>o_proj_l3&#45;&gt;all_reduce_l3</title>
<path fill="none" stroke="black" d="M474,-1937.08C474,-1898.68 474,-1844.43 474,-1803.58"/>
<polygon fill="black" stroke="black" points="477.5,-1803.5 474,-1793.5 470.5,-1803.5 477.5,-1803.5"/>
</g>
<!-- res1_l3 -->
<g id="node46" class="node">
<title>res1_l3</title>
<ellipse fill="pink" stroke="black" cx="474" cy="-1505.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-1523.88" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="474" y="-1508.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1493.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1478.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- all_reduce_l3&#45;&gt;res1_l3 -->
<g id="edge45" class="edge">
<title>all_reduce_l3&#45;&gt;res1_l3</title>
<path fill="none" stroke="black" d="M474,-1696.91C474,-1658.52 474,-1604.26 474,-1563.41"/>
<polygon fill="black" stroke="black" points="477.5,-1563.33 474,-1553.33 470.5,-1563.33 477.5,-1563.33"/>
</g>
<!-- ln2_l3 -->
<g id="node47" class="node">
<title>ln2_l3</title>
<ellipse fill="none" stroke="black" cx="474" cy="-1264.92" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-1283.72" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="474" y="-1268.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1253.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1238.72" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- res1_l3&#45;&gt;ln2_l3 -->
<g id="edge46" class="edge">
<title>res1_l3&#45;&gt;ln2_l3</title>
<path fill="none" stroke="black" d="M474,-1456.74C474,-1418.35 474,-1364.09 474,-1323.24"/>
<polygon fill="black" stroke="black" points="477.5,-1323.17 474,-1313.17 470.5,-1323.17 477.5,-1323.17"/>
</g>
<!-- mlp_up_l3 -->
<g id="node48" class="node">
<title>mlp_up_l3</title>
<ellipse fill="none" stroke="black" cx="474" cy="-1024.75" rx="315.24" ry="48.17"/>
<text text-anchor="middle" x="474" y="-1043.55" font-family="Times,serif" font-size="14.00">MLP Up&#45;Projection</text>
<text text-anchor="middle" x="474" y="-1028.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-1013.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-998.55" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln2_l3&#45;&gt;mlp_up_l3 -->
<g id="edge47" class="edge">
<title>ln2_l3&#45;&gt;mlp_up_l3</title>
<path fill="none" stroke="black" d="M474,-1216.58C474,-1178.18 474,-1123.93 474,-1083.08"/>
<polygon fill="black" stroke="black" points="477.5,-1083 474,-1073 470.5,-1083 477.5,-1083"/>
</g>
<!-- mlp_down_l3 -->
<g id="node49" class="node">
<title>mlp_down_l3</title>
<ellipse fill="none" stroke="black" cx="474" cy="-784.58" rx="257.27" ry="48.17"/>
<text text-anchor="middle" x="474" y="-803.38" font-family="Times,serif" font-size="14.00">MLP Down&#45;Projection</text>
<text text-anchor="middle" x="474" y="-788.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, 16384]</text>
<text text-anchor="middle" x="474" y="-773.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, 4096]</text>
<text text-anchor="middle" x="474" y="-758.38" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mlp_up_l3&#45;&gt;mlp_down_l3 -->
<g id="edge48" class="edge">
<title>mlp_up_l3&#45;&gt;mlp_down_l3</title>
<path fill="none" stroke="black" d="M474,-976.41C474,-938.02 474,-883.76 474,-842.91"/>
<polygon fill="black" stroke="black" points="477.5,-842.83 474,-832.83 470.5,-842.83 477.5,-842.83"/>
</g>
<!-- all_reduce_mlp_l3 -->
<g id="node50" class="node">
<title>all_reduce_mlp_l3</title>
<ellipse fill="yellow" stroke="black" cx="474" cy="-544.42" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-563.22" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="474" y="-548.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-533.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-518.22" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mlp_down_l3&#45;&gt;all_reduce_mlp_l3 -->
<g id="edge49" class="edge">
<title>mlp_down_l3&#45;&gt;all_reduce_mlp_l3</title>
<path fill="none" stroke="black" d="M474,-736.24C474,-697.85 474,-643.6 474,-602.74"/>
<polygon fill="black" stroke="black" points="477.5,-602.67 474,-592.67 470.5,-602.67 477.5,-602.67"/>
</g>
<!-- res2_l3 -->
<g id="node51" class="node">
<title>res2_l3</title>
<ellipse fill="pink" stroke="black" cx="474" cy="-304.25" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="474" y="-323.05" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="474" y="-308.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-293.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-278.05" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- all_reduce_mlp_l3&#45;&gt;res2_l3 -->
<g id="edge50" class="edge">
<title>all_reduce_mlp_l3&#45;&gt;res2_l3</title>
<path fill="none" stroke="black" d="M474,-496.08C474,-457.68 474,-403.43 474,-362.58"/>
<polygon fill="black" stroke="black" points="477.5,-362.5 474,-352.5 470.5,-362.5 477.5,-362.5"/>
</g>
<!-- output -->
<g id="node52" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="474" cy="-64.08" rx="325.95" ry="48.17"/>
<text text-anchor="middle" x="474" y="-82.88" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="474" y="-67.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="474" y="-52.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048, vocab_size=50265]</text>
<text text-anchor="middle" x="474" y="-37.88" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- res2_l3&#45;&gt;output -->
<g id="edge51" class="edge">
<title>res2_l3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M474,-255.91C474,-217.52 474,-163.26 474,-122.41"/>
<polygon fill="black" stroke="black" points="477.5,-122.33 474,-112.33 470.5,-122.33 477.5,-122.33"/>
</g>
</g>
</svg>
