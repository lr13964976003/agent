<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: LLM_Complete_Deployment Pages: 1 -->
<svg width="3366pt" height="3885pt"
 viewBox="0.00 0.00 3365.96 3884.81" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3880.81)">
<title>LLM_Complete_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3880.81 3361.96,-3880.81 3361.96,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ep0</title>
<polygon fill="#e6f3ff" stroke="black" points="1392,-1065.85 1392,-1763.85 2716.97,-1763.85 2716.97,-1065.85 1392,-1065.85"/>
<text text-anchor="middle" x="2054.48" y="-1750.25" font-family="Arial" font-size="12.00">EP Group 0 (GPUs 0&#45;1) &#45; 128 experts total, 64 per GPU</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_ep1</title>
<polygon fill="#ffe6f3" stroke="black" points="1392,-557.85 1392,-975.85 2376.22,-975.85 2376.22,-557.85 1392,-557.85"/>
<text text-anchor="middle" x="1884.11" y="-962.25" font-family="Arial" font-size="12.00">EP Group 1 (GPUs 2&#45;3) &#45; 128 experts total, 64 per GPU</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ep2</title>
<polygon fill="#f3ffe6" stroke="black" points="1392,-1853.85 1392,-2131.85 2376.22,-2131.85 2376.22,-1853.85 1392,-1853.85"/>
<text text-anchor="middle" x="1884.11" y="-2118.25" font-family="Arial" font-size="12.00">EP Group 2 (GPUs 4&#45;5) &#45; 128 experts total, 64 per GPU</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_ep3</title>
<polygon fill="#e6f3ff" stroke="black" points="1392,-189.85 1392,-467.85 2376.22,-467.85 2376.22,-189.85 1392,-189.85"/>
<text text-anchor="middle" x="1884.11" y="-454.25" font-family="Arial" font-size="12.00">EP Group 3 (GPUs 6&#45;7) &#45; 128 experts total, 64 per GPU</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_ep4</title>
<polygon fill="#ffe6f3" stroke="black" points="1392,-3550.85 1392,-3828.85 2376.22,-3828.85 2376.22,-3550.85 1392,-3550.85"/>
<text text-anchor="middle" x="1884.11" y="-3815.25" font-family="Arial" font-size="12.00">EP Group 4 (GPUs 8&#45;9) &#45; 128 experts total, 64 per GPU</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_ep5</title>
<polygon fill="#f3ffe6" stroke="black" points="1392,-3125.85 1392,-3403.85 2376.22,-3403.85 2376.22,-3125.85 1392,-3125.85"/>
<text text-anchor="middle" x="1884.11" y="-3390.25" font-family="Arial" font-size="12.00">EP Group 5 (GPUs 10&#45;11) &#45; 128 experts total, 64 per GPU</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_ep6</title>
<polygon fill="#e6f3ff" stroke="black" points="1392,-2757.85 1392,-3035.85 2376.22,-3035.85 2376.22,-2757.85 1392,-2757.85"/>
<text text-anchor="middle" x="1884.11" y="-3022.25" font-family="Arial" font-size="12.00">EP Group 6 (GPUs 12&#45;13) &#45; 128 experts total, 64 per GPU</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_ep7</title>
<polygon fill="#ffe6f3" stroke="black" points="1392,-2389.85 1392,-2667.85 2376.22,-2667.85 2376.22,-2389.85 1392,-2389.85"/>
<text text-anchor="middle" x="1884.11" y="-2654.25" font-family="Arial" font-size="12.00">EP Group 7 (GPUs 14&#45;15) &#45; 128 experts total, 64 per GPU</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="#9999ff" stroke="black" cx="173.24" cy="-2081.85" rx="173.48" ry="28.98"/>
<text text-anchor="middle" x="173.24" y="-2090.35" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="173.24" y="-2079.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="173.24" y="-2068.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Global_Gate -->
<g id="node2" class="node">
<title>Global_Gate</title>
<polygon fill="#99ff99" stroke="black" points="886.28,-1702.85 485.62,-1702.85 382.55,-1620.85 783.21,-1620.85 886.28,-1702.85"/>
<text text-anchor="middle" x="634.41" y="-1670.35" font-family="Arial" font-size="10.00">Global Gate</text>
<text text-anchor="middle" x="634.41" y="-1659.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="634.41" y="-1648.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, experts=128]</text>
</g>
<!-- Input&#45;&gt;Global_Gate -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;Global_Gate</title>
<path fill="none" stroke="black" d="M184.7,-2052.85C209.2,-1988.87 276.42,-1834.56 382.48,-1749.85 407.98,-1729.49 438.53,-1713.66 469.4,-1701.41"/>
<polygon fill="black" stroke="black" points="470.9,-1704.58 478.98,-1697.73 468.39,-1698.05 470.9,-1704.58"/>
</g>
<!-- GPU0_RMSNorm -->
<g id="node4" class="node">
<title>GPU0_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1645,-1115.35 1400,-1115.35 1400,-1074.35 1645,-1074.35 1645,-1115.35"/>
<text text-anchor="middle" x="1522.5" y="-1103.35" font-family="Arial" font-size="10.00">GPU0: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-1092.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1081.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU0_RMSNorm -->
<g id="edge2" class="edge">
<title>Input&#45;&gt;GPU0_RMSNorm</title>
<path fill="none" stroke="black" d="M174.43,-2052.51C176.71,-1949.81 198.3,-1602.58 382.48,-1415.85 524.39,-1271.98 1120.79,-1159.67 1389.39,-1115.37"/>
<polygon fill="black" stroke="black" points="1390.29,-1118.77 1399.59,-1113.7 1389.15,-1111.86 1390.29,-1118.77"/>
</g>
<!-- GPU1_RMSNorm -->
<g id="node10" class="node">
<title>GPU1_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1645,-1174.35 1400,-1174.35 1400,-1133.35 1645,-1133.35 1645,-1174.35"/>
<text text-anchor="middle" x="1522.5" y="-1162.35" font-family="Arial" font-size="10.00">GPU1: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-1151.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1140.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU1_RMSNorm -->
<g id="edge3" class="edge">
<title>Input&#45;&gt;GPU1_RMSNorm</title>
<path fill="none" stroke="black" d="M179.08,-2052.82C194.1,-1971.67 247.24,-1739.99 382.48,-1611.85 721.24,-1290.88 1016.73,-1550.59 1364,-1238.85 1384.41,-1220.53 1370.4,-1200.75 1392,-1183.85 1393.85,-1182.41 1395.75,-1181.03 1397.7,-1179.72"/>
<polygon fill="black" stroke="black" points="1399.82,-1182.53 1406.57,-1174.37 1396.2,-1176.54 1399.82,-1182.53"/>
</g>
<!-- GPU2_RMSNorm -->
<g id="node24" class="node">
<title>GPU2_RMSNorm</title>
<polygon fill="#ffe6f3" stroke="black" points="1645,-607.35 1400,-607.35 1400,-566.35 1645,-566.35 1645,-607.35"/>
<text text-anchor="middle" x="1522.5" y="-595.35" font-family="Arial" font-size="10.00">GPU2: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-584.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-573.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU2_RMSNorm -->
<g id="edge4" class="edge">
<title>Input&#45;&gt;GPU2_RMSNorm</title>
<path fill="none" stroke="black" d="M176.33,-2052.76C187.83,-1900.33 247.73,-1194.58 382.48,-1030.85 640.59,-717.23 1149.34,-624.38 1389.74,-597.49"/>
<polygon fill="black" stroke="black" points="1390.37,-600.94 1399.93,-596.37 1389.61,-593.98 1390.37,-600.94"/>
</g>
<!-- GPU3_RMSNorm -->
<g id="node27" class="node">
<title>GPU3_RMSNorm</title>
<polygon fill="#ffe6f3" stroke="black" points="1645,-666.35 1400,-666.35 1400,-625.35 1645,-625.35 1645,-666.35"/>
<text text-anchor="middle" x="1522.5" y="-654.35" font-family="Arial" font-size="10.00">GPU3: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-643.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-632.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU3_RMSNorm -->
<g id="edge5" class="edge">
<title>Input&#45;&gt;GPU3_RMSNorm</title>
<path fill="none" stroke="black" d="M177.5,-2052.87C193.35,-1916.81 266.27,-1342.58 382.48,-1211.85 691.28,-864.46 1068.67,-1209.77 1364,-850.85 1414.05,-790.03 1338.26,-733.44 1392,-675.85 1392.91,-674.88 1393.84,-673.93 1394.8,-673.02"/>
<polygon fill="black" stroke="black" points="1397.13,-675.63 1402.55,-666.52 1392.64,-670.26 1397.13,-675.63"/>
</g>
<!-- GPU4_RMSNorm -->
<g id="node34" class="node">
<title>GPU4_RMSNorm</title>
<polygon fill="#f3ffe6" stroke="black" points="1645,-2102.35 1400,-2102.35 1400,-2061.35 1645,-2061.35 1645,-2102.35"/>
<text text-anchor="middle" x="1522.5" y="-2090.35" font-family="Arial" font-size="10.00">GPU4: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-2079.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2068.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU4_RMSNorm -->
<g id="edge6" class="edge">
<title>Input&#45;&gt;GPU4_RMSNorm</title>
<path fill="none" stroke="black" d="M346.58,-2081.85C619.41,-2081.85 1144.89,-2081.85 1389.83,-2081.85"/>
<polygon fill="black" stroke="black" points="1389.85,-2085.35 1399.85,-2081.85 1389.85,-2078.35 1389.85,-2085.35"/>
</g>
<!-- GPU5_RMSNorm -->
<g id="node37" class="node">
<title>GPU5_RMSNorm</title>
<polygon fill="#f3ffe6" stroke="black" points="1645,-2043.35 1400,-2043.35 1400,-2002.35 1645,-2002.35 1645,-2043.35"/>
<text text-anchor="middle" x="1522.5" y="-2031.35" font-family="Arial" font-size="10.00">GPU5: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-2020.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2009.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU5_RMSNorm -->
<g id="edge7" class="edge">
<title>Input&#45;&gt;GPU5_RMSNorm</title>
<path fill="none" stroke="black" d="M341.13,-2074.54C612.25,-2062.67 1142.85,-2039.43 1389.55,-2028.63"/>
<polygon fill="black" stroke="black" points="1389.8,-2032.12 1399.64,-2028.19 1389.5,-2025.13 1389.8,-2032.12"/>
</g>
<!-- GPU6_RMSNorm -->
<g id="node42" class="node">
<title>GPU6_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1645,-239.35 1400,-239.35 1400,-198.35 1645,-198.35 1645,-239.35"/>
<text text-anchor="middle" x="1522.5" y="-227.35" font-family="Arial" font-size="10.00">GPU6: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-216.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-205.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU6_RMSNorm -->
<g id="edge8" class="edge">
<title>Input&#45;&gt;GPU6_RMSNorm</title>
<path fill="none" stroke="black" d="M175.71,-2052.57C186.77,-1837.27 259.97,-504.07 382.48,-378.85 520.02,-238.28 1120.19,-219.31 1389.67,-218.03"/>
<polygon fill="black" stroke="black" points="1389.92,-221.53 1399.9,-217.99 1389.89,-214.53 1389.92,-221.53"/>
</g>
<!-- GPU7_RMSNorm -->
<g id="node45" class="node">
<title>GPU7_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1645,-298.35 1400,-298.35 1400,-257.35 1645,-257.35 1645,-298.35"/>
<text text-anchor="middle" x="1522.5" y="-286.35" font-family="Arial" font-size="10.00">GPU7: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-275.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-264.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU7_RMSNorm -->
<g id="edge9" class="edge">
<title>Input&#45;&gt;GPU7_RMSNorm</title>
<path fill="none" stroke="black" d="M176.03,-2052.6C188.91,-1845.91 270.32,-610.42 382.48,-491.85 417.16,-455.2 1097.01,-344.56 1389.53,-298.42"/>
<polygon fill="black" stroke="black" points="1390.43,-301.82 1399.77,-296.8 1389.34,-294.9 1390.43,-301.82"/>
</g>
<!-- GPU8_RMSNorm -->
<g id="node50" class="node">
<title>GPU8_RMSNorm</title>
<polygon fill="#ffe6f3" stroke="black" points="1645,-3799.35 1400,-3799.35 1400,-3758.35 1645,-3758.35 1645,-3799.35"/>
<text text-anchor="middle" x="1522.5" y="-3787.35" font-family="Arial" font-size="10.00">GPU8: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-3776.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-3765.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU8_RMSNorm -->
<g id="edge10" class="edge">
<title>Input&#45;&gt;GPU8_RMSNorm</title>
<path fill="none" stroke="black" d="M174.15,-2110.9C174.19,-2295.79 183.59,-3307.49 382.48,-3523.85 644.59,-3808.99 1150.22,-3810.5 1389.65,-3792.96"/>
<polygon fill="black" stroke="black" points="1390.09,-3796.43 1399.8,-3792.19 1389.56,-3789.45 1390.09,-3796.43"/>
</g>
<!-- GPU9_RMSNorm -->
<g id="node53" class="node">
<title>GPU9_RMSNorm</title>
<polygon fill="#ffe6f3" stroke="black" points="1645,-3740.35 1400,-3740.35 1400,-3699.35 1645,-3699.35 1645,-3740.35"/>
<text text-anchor="middle" x="1522.5" y="-3728.35" font-family="Arial" font-size="10.00">GPU9: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-3717.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-3706.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU9_RMSNorm -->
<g id="edge11" class="edge">
<title>Input&#45;&gt;GPU9_RMSNorm</title>
<path fill="none" stroke="black" d="M174.43,-2111.11C176.16,-2290.81 194.23,-3244.26 382.48,-3448.85 400.39,-3468.31 1142.39,-3635.33 1418.98,-3697.05"/>
<polygon fill="black" stroke="black" points="1418.5,-3700.53 1429.02,-3699.29 1420.02,-3693.7 1418.5,-3700.53"/>
</g>
<!-- GPU10_RMSNorm -->
<g id="node58" class="node">
<title>GPU10_RMSNorm</title>
<polygon fill="#f3ffe6" stroke="black" points="1645,-3374.35 1400,-3374.35 1400,-3333.35 1645,-3333.35 1645,-3374.35"/>
<text text-anchor="middle" x="1522.5" y="-3362.35" font-family="Arial" font-size="10.00">GPU10: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-3351.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-3340.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU10_RMSNorm -->
<g id="edge12" class="edge">
<title>Input&#45;&gt;GPU10_RMSNorm</title>
<path fill="none" stroke="black" d="M175.55,-2110.88C183.2,-2266.93 227.29,-3004.74 382.48,-3156.85 523.54,-3295.11 1121.11,-3337.22 1389.74,-3349.3"/>
<polygon fill="black" stroke="black" points="1389.8,-3352.81 1399.94,-3349.75 1390.11,-3345.81 1389.8,-3352.81"/>
</g>
<!-- GPU11_RMSNorm -->
<g id="node61" class="node">
<title>GPU11_RMSNorm</title>
<polygon fill="#f3ffe6" stroke="black" points="1645,-3315.35 1400,-3315.35 1400,-3274.35 1645,-3274.35 1645,-3315.35"/>
<text text-anchor="middle" x="1522.5" y="-3303.35" font-family="Arial" font-size="10.00">GPU11: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-3292.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-3281.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU11_RMSNorm -->
<g id="edge13" class="edge">
<title>Input&#45;&gt;GPU11_RMSNorm</title>
<path fill="none" stroke="black" d="M175.97,-2111.09C185.44,-2261.06 236.13,-2942.31 382.48,-3080.85 702.92,-3384.17 981.83,-3009.33 1364,-3229.85 1381.26,-3239.81 1375.14,-3254.24 1392,-3264.85 1394.83,-3266.63 1397.76,-3268.31 1400.76,-3269.89"/>
<polygon fill="black" stroke="black" points="1399.44,-3273.14 1409.97,-3274.33 1402.48,-3266.83 1399.44,-3273.14"/>
</g>
<!-- GPU12_RMSNorm -->
<g id="node66" class="node">
<title>GPU12_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1645,-2947.35 1400,-2947.35 1400,-2906.35 1645,-2906.35 1645,-2947.35"/>
<text text-anchor="middle" x="1522.5" y="-2935.35" font-family="Arial" font-size="10.00">GPU12: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-2924.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2913.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU12_RMSNorm -->
<g id="edge14" class="edge">
<title>Input&#45;&gt;GPU12_RMSNorm</title>
<path fill="none" stroke="black" d="M181.13,-2111.06C200.06,-2184.96 259.77,-2380.97 382.48,-2486.85 731.35,-2787.89 1034.12,-2499.12 1364,-2820.85 1389.77,-2845.98 1365,-2873.04 1392,-2896.85 1393.37,-2898.06 1394.78,-2899.22 1396.22,-2900.34"/>
<polygon fill="black" stroke="black" points="1394.62,-2903.48 1404.84,-2906.26 1398.58,-2897.71 1394.62,-2903.48"/>
</g>
<!-- GPU13_RMSNorm -->
<g id="node69" class="node">
<title>GPU13_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1645,-3006.35 1400,-3006.35 1400,-2965.35 1645,-2965.35 1645,-3006.35"/>
<text text-anchor="middle" x="1522.5" y="-2994.35" font-family="Arial" font-size="10.00">GPU13: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-2983.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2972.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU13_RMSNorm -->
<g id="edge15" class="edge">
<title>Input&#45;&gt;GPU13_RMSNorm</title>
<path fill="none" stroke="black" d="M178.26,-2111.09C191.39,-2195.71 240.66,-2443.41 382.48,-2579.85 669.44,-2855.93 1156.47,-2945.78 1389.56,-2973.81"/>
<polygon fill="black" stroke="black" points="1389.44,-2977.32 1399.78,-2975.02 1390.26,-2970.37 1389.44,-2977.32"/>
</g>
<!-- GPU14_RMSNorm -->
<g id="node74" class="node">
<title>GPU14_RMSNorm</title>
<polygon fill="#ffe6f3" stroke="black" points="1645,-2579.35 1400,-2579.35 1400,-2538.35 1645,-2538.35 1645,-2579.35"/>
<text text-anchor="middle" x="1522.5" y="-2567.35" font-family="Arial" font-size="10.00">GPU14: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-2556.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2545.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU14_RMSNorm -->
<g id="edge16" class="edge">
<title>Input&#45;&gt;GPU14_RMSNorm</title>
<path fill="none" stroke="black" d="M194.98,-2110.79C228.9,-2155.87 300.69,-2242.4 382.48,-2287.85 556.15,-2384.35 1128.76,-2491.5 1389.77,-2536.76"/>
<polygon fill="black" stroke="black" points="1389.23,-2540.22 1399.68,-2538.47 1390.43,-2533.32 1389.23,-2540.22"/>
</g>
<!-- GPU15_RMSNorm -->
<g id="node77" class="node">
<title>GPU15_RMSNorm</title>
<polygon fill="#ffe6f3" stroke="black" points="1645,-2638.35 1400,-2638.35 1400,-2597.35 1645,-2597.35 1645,-2638.35"/>
<text text-anchor="middle" x="1522.5" y="-2626.35" font-family="Arial" font-size="10.00">GPU15: RMSNorm</text>
<text text-anchor="middle" x="1522.5" y="-2615.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2604.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU15_RMSNorm -->
<g id="edge17" class="edge">
<title>Input&#45;&gt;GPU15_RMSNorm</title>
<path fill="none" stroke="black" d="M186.24,-2110.99C212.41,-2170.71 280.54,-2307.19 382.48,-2375.85 697.68,-2588.16 1164.15,-2619.16 1389.77,-2620.64"/>
<polygon fill="black" stroke="black" points="1389.98,-2624.14 1400,-2620.69 1390.02,-2617.14 1389.98,-2624.14"/>
</g>
<!-- Expert_Select -->
<g id="node3" class="node">
<title>Expert_Select</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1363.83,-1653.85 1012.81,-1653.85 922.52,-1593.85 1273.53,-1593.85 1363.83,-1653.85"/>
<text text-anchor="middle" x="1143.17" y="-1626.85" font-family="Arial" font-size="10.00">Expert Selection</text>
<text text-anchor="middle" x="1143.17" y="-1615.85" font-family="Arial" font-size="10.00">Top&#45;8 experts per token across all EP groups</text>
</g>
<!-- Global_Gate&#45;&gt;Expert_Select -->
<g id="edge18" class="edge">
<title>Global_Gate&#45;&gt;Expert_Select</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M817.65,-1648.19C868.99,-1644.34 924.57,-1640.17 974.99,-1636.39"/>
<polygon fill="black" stroke="black" points="975.29,-1639.87 985,-1635.64 974.77,-1632.89 975.29,-1639.87"/>
</g>
<!-- GPU0_Expert00 -->
<g id="node16" class="node">
<title>GPU0_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-1454.85 1403,-1454.85 1403,-1402.85 1642,-1402.85 1642,-1454.85"/>
<text text-anchor="middle" x="1522.5" y="-1442.85" font-family="Arial" font-size="10.00">GPU0: Expert_E0</text>
<text text-anchor="middle" x="1522.5" y="-1431.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1420.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1409.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert00 -->
<g id="edge109" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1182.36,-1593.8C1229.27,-1558.19 1312.46,-1499.24 1392,-1463.85 1396.18,-1461.99 1400.49,-1460.21 1404.87,-1458.51"/>
<polygon fill="black" stroke="black" points="1406.41,-1461.67 1414.57,-1454.9 1403.98,-1455.1 1406.41,-1461.67"/>
</g>
<!-- GPU0_Expert01 -->
<g id="node17" class="node">
<title>GPU0_Expert01</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-1384.85 1403,-1384.85 1403,-1332.85 1642,-1332.85 1642,-1384.85"/>
<text text-anchor="middle" x="1522.5" y="-1372.85" font-family="Arial" font-size="10.00">GPU0: Expert_E1</text>
<text text-anchor="middle" x="1522.5" y="-1361.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1350.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1339.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert01 -->
<g id="edge110" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1168.21,-1593.54C1208.95,-1544.21 1296.5,-1446.77 1392,-1393.85 1395.05,-1392.16 1398.18,-1390.55 1401.38,-1389.02"/>
<polygon fill="black" stroke="black" points="1402.87,-1392.18 1410.54,-1384.88 1399.99,-1385.8 1402.87,-1392.18"/>
</g>
<!-- GPU0_Expert02 -->
<g id="node18" class="node">
<title>GPU0_Expert02</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-1314.85 1403,-1314.85 1403,-1262.85 1642,-1262.85 1642,-1314.85"/>
<text text-anchor="middle" x="1522.5" y="-1302.85" font-family="Arial" font-size="10.00">GPU0: Expert_E2</text>
<text text-anchor="middle" x="1522.5" y="-1291.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1280.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1269.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert02 -->
<g id="edge111" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert02</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1184.71,-1593.69C1233.64,-1555.31 1315.4,-1484.61 1364,-1406.85 1384.64,-1373.84 1363.64,-1350.52 1392,-1323.85 1392.98,-1322.93 1393.98,-1322.04 1395,-1321.16"/>
<polygon fill="black" stroke="black" points="1397.36,-1323.76 1403.19,-1314.91 1393.12,-1318.2 1397.36,-1323.76"/>
</g>
<!-- GPU0_Expert03 -->
<g id="node19" class="node">
<title>GPU0_Expert03</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-1244.85 1403,-1244.85 1403,-1192.85 1642,-1192.85 1642,-1244.85"/>
<text text-anchor="middle" x="1522.5" y="-1232.85" font-family="Arial" font-size="10.00">GPU0: Expert_E3</text>
<text text-anchor="middle" x="1522.5" y="-1221.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1210.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1199.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert03 -->
<g id="edge112" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert03</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1187.95,-1593.79C1238.92,-1556.28 1321.51,-1487.2 1364,-1406.85 1396.32,-1345.74 1345.19,-1304.72 1392,-1253.85 1393.04,-1252.73 1394.1,-1251.64 1395.2,-1250.58"/>
<polygon fill="black" stroke="black" points="1397.49,-1253.23 1402.84,-1244.09 1392.96,-1247.89 1397.49,-1253.23"/>
</g>
<!-- GPU1_Expert00 -->
<g id="node20" class="node">
<title>GPU1_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-1734.85 1403,-1734.85 1403,-1682.85 1642,-1682.85 1642,-1734.85"/>
<text text-anchor="middle" x="1522.5" y="-1722.85" font-family="Arial" font-size="10.00">GPU1: Expert_E0</text>
<text text-anchor="middle" x="1522.5" y="-1711.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1700.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1689.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert00 -->
<g id="edge113" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1329.19,-1653.92C1341.03,-1656.69 1352.72,-1659.67 1364,-1662.85 1376.87,-1666.48 1379.31,-1669.66 1392,-1673.85 1398.24,-1675.91 1404.68,-1677.95 1411.2,-1679.93"/>
<polygon fill="black" stroke="black" points="1410.2,-1683.29 1420.78,-1682.8 1412.21,-1676.58 1410.2,-1683.29"/>
</g>
<!-- GPU1_Expert01 -->
<g id="node21" class="node">
<title>GPU1_Expert01</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-1664.85 1403,-1664.85 1403,-1612.85 1642,-1612.85 1642,-1664.85"/>
<text text-anchor="middle" x="1522.5" y="-1652.85" font-family="Arial" font-size="10.00">GPU1: Expert_E1</text>
<text text-anchor="middle" x="1522.5" y="-1641.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1630.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1619.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert01 -->
<g id="edge114" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1329.8,-1631.23C1351.06,-1632.08 1372.38,-1632.92 1392.67,-1633.73"/>
<polygon fill="black" stroke="black" points="1392.72,-1637.23 1402.85,-1634.13 1393,-1630.24 1392.72,-1637.23"/>
</g>
<!-- GPU1_Expert02 -->
<g id="node22" class="node">
<title>GPU1_Expert02</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-1594.85 1403,-1594.85 1403,-1542.85 1642,-1542.85 1642,-1594.85"/>
<text text-anchor="middle" x="1522.5" y="-1582.85" font-family="Arial" font-size="10.00">GPU1: Expert_E2</text>
<text text-anchor="middle" x="1522.5" y="-1571.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1560.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1549.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert02 -->
<g id="edge115" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert02</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1287.36,-1602.98C1322.09,-1597.92 1359,-1592.54 1393,-1587.58"/>
<polygon fill="black" stroke="black" points="1393.58,-1591.03 1402.97,-1586.13 1392.57,-1584.11 1393.58,-1591.03"/>
</g>
<!-- GPU1_Expert03 -->
<g id="node23" class="node">
<title>GPU1_Expert03</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-1524.85 1403,-1524.85 1403,-1472.85 1642,-1472.85 1642,-1524.85"/>
<text text-anchor="middle" x="1522.5" y="-1512.85" font-family="Arial" font-size="10.00">GPU1: Expert_E3</text>
<text text-anchor="middle" x="1522.5" y="-1501.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1490.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1479.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert03 -->
<g id="edge116" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert03</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1221.73,-1593.78C1270.3,-1575.42 1334.39,-1552.06 1392,-1533.85 1398.49,-1531.8 1405.19,-1529.76 1411.96,-1527.76"/>
<polygon fill="black" stroke="black" points="1413.3,-1531.01 1421.92,-1524.85 1411.34,-1524.29 1413.3,-1531.01"/>
</g>
<!-- GPU2_Expert00 -->
<g id="node30" class="node">
<title>GPU2_Expert00</title>
<polygon fill="#ffe6f3" stroke="black" points="1642,-806.85 1403,-806.85 1403,-754.85 1642,-754.85 1642,-806.85"/>
<text text-anchor="middle" x="1522.5" y="-794.85" font-family="Arial" font-size="10.00">GPU2: Expert_E128</text>
<text text-anchor="middle" x="1522.5" y="-783.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-772.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-761.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU2_Expert00 -->
<g id="edge117" class="edge">
<title>Expert_Select&#45;&gt;GPU2_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1160.49,-1593.77C1202.41,-1514.91 1314.08,-1294.62 1364,-1096.85 1379.36,-1036.01 1351.43,-863.72 1392,-815.85 1393.01,-814.66 1394.06,-813.5 1395.14,-812.38"/>
<polygon fill="black" stroke="black" points="1397.65,-814.83 1402.74,-805.54 1392.97,-809.63 1397.65,-814.83"/>
</g>
<!-- GPU2_Expert01 -->
<g id="node31" class="node">
<title>GPU2_Expert01</title>
<polygon fill="#ffe6f3" stroke="black" points="1642,-736.85 1403,-736.85 1403,-684.85 1642,-684.85 1642,-736.85"/>
<text text-anchor="middle" x="1522.5" y="-724.85" font-family="Arial" font-size="10.00">GPU2: Expert_E129</text>
<text text-anchor="middle" x="1522.5" y="-713.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-702.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-691.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU2_Expert01 -->
<g id="edge118" class="edge">
<title>Expert_Select&#45;&gt;GPU2_Expert01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1160.71,-1593.82C1203.17,-1515.1 1316.03,-1295.1 1364,-1096.85 1382.4,-1020.8 1342,-806.04 1392,-745.85 1393.02,-744.62 1394.09,-743.43 1395.18,-742.28"/>
<polygon fill="black" stroke="black" points="1397.87,-744.56 1402.91,-735.24 1393.16,-739.39 1397.87,-744.56"/>
</g>
<!-- GPU3_Expert00 -->
<g id="node32" class="node">
<title>GPU3_Expert00</title>
<polygon fill="#ffe6f3" stroke="black" points="1642,-946.85 1403,-946.85 1403,-894.85 1642,-894.85 1642,-946.85"/>
<text text-anchor="middle" x="1522.5" y="-934.85" font-family="Arial" font-size="10.00">GPU3: Expert_E192</text>
<text text-anchor="middle" x="1522.5" y="-923.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-912.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-901.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU3_Expert00 -->
<g id="edge119" class="edge">
<title>Expert_Select&#45;&gt;GPU3_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.53,-1593.78C1181.4,-1506.77 1269.59,-1249.05 1392,-1061.85 1418.63,-1021.12 1457.16,-980.86 1485.27,-953.85"/>
<polygon fill="black" stroke="black" points="1487.7,-956.37 1492.54,-946.94 1482.88,-951.29 1487.7,-956.37"/>
</g>
<!-- GPU3_Expert01 -->
<g id="node33" class="node">
<title>GPU3_Expert01</title>
<polygon fill="#ffe6f3" stroke="black" points="1642,-876.85 1403,-876.85 1403,-824.85 1642,-824.85 1642,-876.85"/>
<text text-anchor="middle" x="1522.5" y="-864.85" font-family="Arial" font-size="10.00">GPU3: Expert_E193</text>
<text text-anchor="middle" x="1522.5" y="-853.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-842.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-831.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU3_Expert01 -->
<g id="edge120" class="edge">
<title>Expert_Select&#45;&gt;GPU3_Expert01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1160.12,-1593.67C1201.14,-1514.58 1310.86,-1293.78 1364,-1096.85 1376.32,-1051.18 1360.83,-921.43 1392,-885.85 1393.03,-884.67 1394.1,-883.53 1395.2,-882.43"/>
<polygon fill="black" stroke="black" points="1397.69,-884.9 1402.89,-875.67 1393.07,-879.64 1397.69,-884.9"/>
</g>
<!-- GPU4_Expert00 -->
<g id="node40" class="node">
<title>GPU4_Expert00</title>
<polygon fill="#f3ffe6" stroke="black" points="1642,-1983.85 1403,-1983.85 1403,-1931.85 1642,-1931.85 1642,-1983.85"/>
<text text-anchor="middle" x="1522.5" y="-1971.85" font-family="Arial" font-size="10.00">GPU4: Expert_E256</text>
<text text-anchor="middle" x="1522.5" y="-1960.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1949.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1938.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU4_Expert00 -->
<g id="edge121" class="edge">
<title>Expert_Select&#45;&gt;GPU4_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1354.82,-1654.08C1358.03,-1656.81 1361.09,-1659.74 1364,-1662.85 1443.33,-1747.79 1316.5,-1834.49 1392,-1922.85 1393.02,-1924.04 1394.07,-1925.19 1395.16,-1926.31"/>
<polygon fill="black" stroke="black" points="1392.99,-1929.07 1402.78,-1933.13 1397.66,-1923.85 1392.99,-1929.07"/>
</g>
<!-- GPU5_Expert00 -->
<g id="node41" class="node">
<title>GPU5_Expert00</title>
<polygon fill="#f3ffe6" stroke="black" points="1642,-1913.85 1403,-1913.85 1403,-1861.85 1642,-1861.85 1642,-1913.85"/>
<text text-anchor="middle" x="1522.5" y="-1901.85" font-family="Arial" font-size="10.00">GPU5: Expert_E320</text>
<text text-anchor="middle" x="1522.5" y="-1890.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-1879.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-1868.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU5_Expert00 -->
<g id="edge122" class="edge">
<title>Expert_Select&#45;&gt;GPU5_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1353.26,-1654.03C1356.99,-1656.77 1360.58,-1659.7 1364,-1662.85 1399.57,-1695.52 1367.09,-1726.48 1392,-1767.85 1413.01,-1802.74 1447.1,-1833.74 1475.03,-1855.49"/>
<polygon fill="black" stroke="black" points="1473.03,-1858.37 1483.11,-1861.66 1477.28,-1852.81 1473.03,-1858.37"/>
</g>
<!-- GPU6_Expert00 -->
<g id="node48" class="node">
<title>GPU6_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-438.85 1403,-438.85 1403,-386.85 1642,-386.85 1642,-438.85"/>
<text text-anchor="middle" x="1522.5" y="-426.85" font-family="Arial" font-size="10.00">GPU6: Expert_E384</text>
<text text-anchor="middle" x="1522.5" y="-415.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-404.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-393.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU6_Expert00 -->
<g id="edge123" class="edge">
<title>Expert_Select&#45;&gt;GPU6_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1145.58,-1593.85C1152.81,-1462.74 1193.66,-929.98 1392,-553.85 1414.34,-511.48 1452.57,-472.13 1481.72,-445.82"/>
<polygon fill="black" stroke="black" points="1484.15,-448.35 1489.3,-439.09 1479.5,-443.12 1484.15,-448.35"/>
</g>
<!-- GPU7_Expert00 -->
<g id="node49" class="node">
<title>GPU7_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-368.85 1403,-368.85 1403,-316.85 1642,-316.85 1642,-368.85"/>
<text text-anchor="middle" x="1522.5" y="-356.85" font-family="Arial" font-size="10.00">GPU7: Expert_E448</text>
<text text-anchor="middle" x="1522.5" y="-345.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-334.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-323.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU7_Expert00 -->
<g id="edge124" class="edge">
<title>Expert_Select&#45;&gt;GPU7_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1149.25,-1593.68C1180.64,-1407.82 1348.38,-424.53 1392,-377.85 1393.04,-376.73 1394.12,-375.65 1395.22,-374.6"/>
<polygon fill="black" stroke="black" points="1397.5,-377.26 1402.91,-368.15 1393,-371.9 1397.5,-377.26"/>
</g>
<!-- GPU8_Expert00 -->
<g id="node56" class="node">
<title>GPU8_Expert00</title>
<polygon fill="#ffe6f3" stroke="black" points="1642,-3680.85 1403,-3680.85 1403,-3628.85 1642,-3628.85 1642,-3680.85"/>
<text text-anchor="middle" x="1522.5" y="-3668.85" font-family="Arial" font-size="10.00">GPU8: Expert_E512</text>
<text text-anchor="middle" x="1522.5" y="-3657.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-3646.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-3635.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU8_Expert00 -->
<g id="edge125" class="edge">
<title>Expert_Select&#45;&gt;GPU8_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.65,-1654.11C1358.57,-1656.84 1361.36,-1659.75 1364,-1662.85 1434.44,-1745.68 1325.29,-3533.99 1392,-3619.85 1393.11,-3621.27 1394.26,-3622.64 1395.47,-3623.96"/>
<polygon fill="black" stroke="black" points="1393.18,-3626.61 1402.85,-3630.94 1397.99,-3621.53 1393.18,-3626.61"/>
</g>
<!-- GPU9_Expert00 -->
<g id="node57" class="node">
<title>GPU9_Expert00</title>
<polygon fill="#ffe6f3" stroke="black" points="1642,-3610.85 1403,-3610.85 1403,-3558.85 1642,-3558.85 1642,-3610.85"/>
<text text-anchor="middle" x="1522.5" y="-3598.85" font-family="Arial" font-size="10.00">GPU9: Expert_E576</text>
<text text-anchor="middle" x="1522.5" y="-3587.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-3576.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-3565.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU9_Expert00 -->
<g id="edge126" class="edge">
<title>Expert_Select&#45;&gt;GPU9_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.64,-1654.11C1358.57,-1656.84 1361.36,-1659.75 1364,-1662.85 1395.44,-1699.75 1376.57,-3361.89 1392,-3407.85 1411.01,-3464.49 1455.38,-3518.2 1486.87,-3551.29"/>
<polygon fill="black" stroke="black" points="1484.7,-3554.09 1494.17,-3558.84 1489.73,-3549.22 1484.7,-3554.09"/>
</g>
<!-- GPU10_Expert00 -->
<g id="node64" class="node">
<title>GPU10_Expert00</title>
<polygon fill="#f3ffe6" stroke="black" points="1642,-3255.85 1403,-3255.85 1403,-3203.85 1642,-3203.85 1642,-3255.85"/>
<text text-anchor="middle" x="1522.5" y="-3243.85" font-family="Arial" font-size="10.00">GPU10: Expert_E640</text>
<text text-anchor="middle" x="1522.5" y="-3232.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-3221.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-3210.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU10_Expert00 -->
<g id="edge127" class="edge">
<title>Expert_Select&#45;&gt;GPU10_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.63,-1654.12C1358.56,-1656.85 1361.36,-1659.76 1364,-1662.85 1419.28,-1727.59 1339.64,-3127.74 1392,-3194.85 1393.11,-3196.27 1394.27,-3197.64 1395.47,-3198.95"/>
<polygon fill="black" stroke="black" points="1393.19,-3201.61 1402.87,-3205.93 1398,-3196.52 1393.19,-3201.61"/>
</g>
<!-- GPU11_Expert00 -->
<g id="node65" class="node">
<title>GPU11_Expert00</title>
<polygon fill="#f3ffe6" stroke="black" points="1642,-3185.85 1403,-3185.85 1403,-3133.85 1642,-3133.85 1642,-3185.85"/>
<text text-anchor="middle" x="1522.5" y="-3173.85" font-family="Arial" font-size="10.00">GPU11: Expert_E704</text>
<text text-anchor="middle" x="1522.5" y="-3162.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-3151.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-3140.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU11_Expert00 -->
<g id="edge128" class="edge">
<title>Expert_Select&#45;&gt;GPU11_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.62,-1654.13C1358.56,-1656.85 1361.36,-1659.76 1364,-1662.85 1413.75,-1720.99 1360.67,-2970.04 1392,-3039.85 1408.34,-3076.25 1441.54,-3106.65 1470.23,-3127.75"/>
<polygon fill="black" stroke="black" points="1468.4,-3130.75 1478.57,-3133.72 1472.48,-3125.06 1468.4,-3130.75"/>
</g>
<!-- GPU12_Expert00 -->
<g id="node72" class="node">
<title>GPU12_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-2887.85 1403,-2887.85 1403,-2835.85 1642,-2835.85 1642,-2887.85"/>
<text text-anchor="middle" x="1522.5" y="-2875.85" font-family="Arial" font-size="10.00">GPU12: Expert_E768</text>
<text text-anchor="middle" x="1522.5" y="-2864.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-2853.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2842.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU12_Expert00 -->
<g id="edge129" class="edge">
<title>Expert_Select&#45;&gt;GPU12_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.61,-1654.14C1358.55,-1656.86 1361.35,-1659.76 1364,-1662.85 1406.15,-1711.92 1352.06,-2775.97 1392,-2826.85 1393.11,-2828.27 1394.28,-2829.63 1395.49,-2830.94"/>
<polygon fill="black" stroke="black" points="1393.21,-2833.61 1402.9,-2837.9 1398.01,-2828.51 1393.21,-2833.61"/>
</g>
<!-- GPU13_Expert00 -->
<g id="node73" class="node">
<title>GPU13_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="1642,-2817.85 1403,-2817.85 1403,-2765.85 1642,-2765.85 1642,-2817.85"/>
<text text-anchor="middle" x="1522.5" y="-2805.85" font-family="Arial" font-size="10.00">GPU13: Expert_E832</text>
<text text-anchor="middle" x="1522.5" y="-2794.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-2783.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2772.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU13_Expert00 -->
<g id="edge130" class="edge">
<title>Expert_Select&#45;&gt;GPU13_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.59,-1654.16C1358.53,-1656.87 1361.34,-1659.77 1364,-1662.85 1400.62,-1705.32 1368.85,-2620.78 1392,-2671.85 1408.47,-2708.19 1441.67,-2738.59 1470.33,-2759.71"/>
<polygon fill="black" stroke="black" points="1468.49,-2762.7 1478.66,-2765.68 1472.57,-2757.01 1468.49,-2762.7"/>
</g>
<!-- GPU14_Expert00 -->
<g id="node80" class="node">
<title>GPU14_Expert00</title>
<polygon fill="#ffe6f3" stroke="black" points="1642,-2519.85 1403,-2519.85 1403,-2467.85 1642,-2467.85 1642,-2519.85"/>
<text text-anchor="middle" x="1522.5" y="-2507.85" font-family="Arial" font-size="10.00">GPU14: Expert_E896</text>
<text text-anchor="middle" x="1522.5" y="-2496.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-2485.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2474.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU14_Expert00 -->
<g id="edge131" class="edge">
<title>Expert_Select&#45;&gt;GPU14_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.56,-1654.18C1358.51,-1656.89 1361.33,-1659.78 1364,-1662.85 1422.04,-1729.67 1336.98,-2389.54 1392,-2458.85 1393.12,-2460.26 1394.29,-2461.62 1395.51,-2462.93"/>
<polygon fill="black" stroke="black" points="1393.25,-2465.61 1402.96,-2469.86 1398.02,-2460.48 1393.25,-2465.61"/>
</g>
<!-- GPU15_Expert00 -->
<g id="node81" class="node">
<title>GPU15_Expert00</title>
<polygon fill="#ffe6f3" stroke="black" points="1642,-2449.85 1403,-2449.85 1403,-2397.85 1642,-2397.85 1642,-2449.85"/>
<text text-anchor="middle" x="1522.5" y="-2437.85" font-family="Arial" font-size="10.00">GPU15: Expert_E960</text>
<text text-anchor="middle" x="1522.5" y="-2426.85" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1522.5" y="-2415.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1522.5" y="-2404.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_Select&#45;&gt;GPU15_Expert00 -->
<g id="edge132" class="edge">
<title>Expert_Select&#45;&gt;GPU15_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.03,-1653.89C1358.17,-1656.68 1361.17,-1659.67 1364,-1662.85 1399,-1702.18 1379.44,-2084.72 1392,-2135.85 1415.62,-2232.03 1470.4,-2335.89 1500.59,-2388.69"/>
<polygon fill="black" stroke="black" points="1497.72,-2390.72 1505.75,-2397.63 1503.79,-2387.22 1497.72,-2390.72"/>
</g>
<!-- GPU0_Q_Proj_CP -->
<g id="node5" class="node">
<title>GPU0_Q_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-1116.35 1719.24,-1116.35 1719.24,-1075.35 1989.24,-1075.35 1989.24,-1116.35"/>
<text text-anchor="middle" x="1854.24" y="-1104.35" font-family="Arial" font-size="10.00">GPU0: Q&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1854.24" y="-1093.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1854.24" y="-1082.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_Q_Proj_CP -->
<g id="edge19" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_Q_Proj_CP</title>
<path fill="none" stroke="black" d="M1645.35,-1095.22C1666.1,-1095.28 1687.82,-1095.35 1709.08,-1095.41"/>
<polygon fill="black" stroke="black" points="1709.13,-1098.91 1719.14,-1095.44 1709.15,-1091.91 1709.13,-1098.91"/>
</g>
<!-- GPU0_K_Proj_CP -->
<g id="node6" class="node">
<title>GPU0_K_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-1175.35 1719.24,-1175.35 1719.24,-1134.35 1989.24,-1134.35 1989.24,-1175.35"/>
<text text-anchor="middle" x="1854.24" y="-1163.35" font-family="Arial" font-size="10.00">GPU0: K&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1854.24" y="-1152.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1854.24" y="-1141.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_K_Proj_CP -->
<g id="edge20" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_K_Proj_CP</title>
<path fill="none" stroke="black" d="M1625.51,-1115.36C1643.97,-1118.94 1663.04,-1122.57 1681,-1125.85 1693.36,-1128.11 1706.23,-1130.39 1719.13,-1132.64"/>
<polygon fill="black" stroke="black" points="1718.53,-1136.09 1728.98,-1134.35 1719.73,-1129.19 1718.53,-1136.09"/>
</g>
<!-- GPU0_V_Proj_CP -->
<g id="node7" class="node">
<title>GPU0_V_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-1234.35 1719.24,-1234.35 1719.24,-1193.35 1989.24,-1193.35 1989.24,-1234.35"/>
<text text-anchor="middle" x="1854.24" y="-1222.35" font-family="Arial" font-size="10.00">GPU0: V&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1854.24" y="-1211.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1854.24" y="-1200.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_V_Proj_CP -->
<g id="edge21" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_V_Proj_CP</title>
<path fill="none" stroke="black" d="M1629.61,-1115.4C1635.02,-1118.17 1640.2,-1121.3 1645,-1124.85 1670.02,-1143.33 1655.31,-1167.33 1681,-1184.85 1689.73,-1190.81 1699.28,-1195.68 1709.26,-1199.65"/>
<polygon fill="black" stroke="black" points="1708.36,-1203.05 1718.95,-1203.19 1710.76,-1196.47 1708.36,-1203.05"/>
</g>
<!-- GPU0_Attention -->
<g id="node8" class="node">
<title>GPU0_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="2371.72,-1160.35 2101.72,-1160.35 2101.72,-1119.35 2371.72,-1119.35 2371.72,-1160.35"/>
<text text-anchor="middle" x="2236.72" y="-1148.35" font-family="Arial" font-size="10.00">GPU0: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="2236.72" y="-1137.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-1126.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_Q_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge22" class="edge">
<title>GPU0_Q_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1989.39,-1111.36C2022.35,-1115.18 2057.78,-1119.27 2091.2,-1123.14"/>
<polygon fill="black" stroke="black" points="2091.17,-1126.66 2101.51,-1124.33 2091.98,-1119.7 2091.17,-1126.66"/>
</g>
<!-- GPU0_K_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge23" class="edge">
<title>GPU0_K_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1989.39,-1149.56C2022.35,-1148.26 2057.78,-1146.87 2091.2,-1145.55"/>
<polygon fill="black" stroke="black" points="2091.66,-1149.03 2101.51,-1145.14 2091.38,-1142.04 2091.66,-1149.03"/>
</g>
<!-- GPU0_V_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge24" class="edge">
<title>GPU0_V_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1981.41,-1193.29C1996.95,-1190.56 2012.59,-1187.71 2027.48,-1184.85 2062.69,-1178.09 2101.09,-1169.99 2135.22,-1162.55"/>
<polygon fill="black" stroke="black" points="2136.18,-1165.92 2145.2,-1160.36 2134.68,-1159.08 2136.18,-1165.92"/>
</g>
<!-- GPU0_O_Proj_RP -->
<g id="node9" class="node">
<title>GPU0_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="2708.97,-1145.35 2445.97,-1145.35 2445.97,-1104.35 2708.97,-1104.35 2708.97,-1145.35"/>
<text text-anchor="middle" x="2577.47" y="-1133.35" font-family="Arial" font-size="10.00">GPU0: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2577.47" y="-1122.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2577.47" y="-1111.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU0_Attention&#45;&gt;GPU0_O_Proj_RP -->
<g id="edge25" class="edge">
<title>GPU0_Attention&#45;&gt;GPU0_O_Proj_RP</title>
<path fill="none" stroke="black" d="M2372.09,-1133.9C2392.97,-1132.98 2414.58,-1132.02 2435.59,-1131.09"/>
<polygon fill="black" stroke="black" points="2436.02,-1134.57 2445.86,-1130.63 2435.71,-1127.58 2436.02,-1134.57"/>
</g>
<!-- Attn_AllReduce_EP0 -->
<g id="node82" class="node">
<title>Attn_AllReduce_EP0</title>
<ellipse fill="#ff9999" stroke="black" cx="634.41" cy="-85.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="634.41" y="-99.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="634.41" y="-88.85" font-family="Arial" font-size="10.00">EP Group 0 Attention</text>
<text text-anchor="middle" x="634.41" y="-77.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="634.41" y="-66.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU0_O_Proj_RP&#45;&gt;Attn_AllReduce_EP0 -->
<g id="edge61" class="edge">
<title>GPU0_O_Proj_RP&#45;&gt;Attn_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M2576.54,-1104.08C2576.59,-969.5 2569.56,-222.11 2409.97,-79.85 2225.75,84.35 2102.02,-55.85 1855.24,-55.85 1521.5,-55.85 1521.5,-55.85 1521.5,-55.85 1275.64,-55.85 991.63,-67.53 812.78,-76.31"/>
<polygon fill="black" stroke="black" points="812.57,-72.82 802.75,-76.81 812.92,-79.81 812.57,-72.82"/>
</g>
<!-- GPU1_Q_Proj_CP -->
<g id="node11" class="node">
<title>GPU1_Q_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-1293.35 1719.24,-1293.35 1719.24,-1252.35 1989.24,-1252.35 1989.24,-1293.35"/>
<text text-anchor="middle" x="1854.24" y="-1281.35" font-family="Arial" font-size="10.00">GPU1: Q&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1854.24" y="-1270.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1854.24" y="-1259.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_Q_Proj_CP -->
<g id="edge26" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_Q_Proj_CP</title>
<path fill="none" stroke="black" d="M1629.61,-1174.4C1635.02,-1177.17 1640.2,-1180.3 1645,-1183.85 1670.02,-1202.33 1655.31,-1226.33 1681,-1243.85 1689.73,-1249.81 1699.28,-1254.68 1709.26,-1258.65"/>
<polygon fill="black" stroke="black" points="1708.36,-1262.05 1718.95,-1262.19 1710.76,-1255.47 1708.36,-1262.05"/>
</g>
<!-- GPU1_K_Proj_CP -->
<g id="node12" class="node">
<title>GPU1_K_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-1352.35 1719.24,-1352.35 1719.24,-1311.35 1989.24,-1311.35 1989.24,-1352.35"/>
<text text-anchor="middle" x="1854.24" y="-1340.35" font-family="Arial" font-size="10.00">GPU1: K&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1854.24" y="-1329.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1854.24" y="-1318.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_K_Proj_CP -->
<g id="edge27" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_K_Proj_CP</title>
<path fill="none" stroke="black" d="M1632.96,-1174.44C1637.25,-1177.21 1641.3,-1180.34 1645,-1183.85 1685.07,-1221.9 1639.53,-1266.34 1681,-1302.85 1689.54,-1310.37 1699.27,-1316.3 1709.67,-1320.96"/>
<polygon fill="black" stroke="black" points="1708.38,-1324.22 1718.96,-1324.73 1711.01,-1317.73 1708.38,-1324.22"/>
</g>
<!-- GPU1_V_Proj_CP -->
<g id="node13" class="node">
<title>GPU1_V_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-1411.35 1719.24,-1411.35 1719.24,-1370.35 1989.24,-1370.35 1989.24,-1411.35"/>
<text text-anchor="middle" x="1854.24" y="-1399.35" font-family="Arial" font-size="10.00">GPU1: V&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1854.24" y="-1388.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1854.24" y="-1377.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_V_Proj_CP -->
<g id="edge28" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_V_Proj_CP</title>
<path fill="none" stroke="black" d="M1633.91,-1174.39C1637.89,-1177.18 1641.62,-1180.32 1645,-1183.85 1700.85,-1242.12 1623,-1305.72 1681,-1361.85 1689.34,-1369.92 1699.04,-1376.23 1709.51,-1381.12"/>
<polygon fill="black" stroke="black" points="1708.31,-1384.41 1718.88,-1385.06 1711.02,-1377.96 1708.31,-1384.41"/>
</g>
<!-- GPU1_Attention -->
<g id="node14" class="node">
<title>GPU1_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="2371.72,-1322.35 2101.72,-1322.35 2101.72,-1281.35 2371.72,-1281.35 2371.72,-1322.35"/>
<text text-anchor="middle" x="2236.72" y="-1310.35" font-family="Arial" font-size="10.00">GPU1: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="2236.72" y="-1299.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-1288.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_Q_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge29" class="edge">
<title>GPU1_Q_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M1989.39,-1283.08C2022.35,-1285.59 2057.78,-1288.29 2091.2,-1290.84"/>
<polygon fill="black" stroke="black" points="2091.27,-1294.35 2101.51,-1291.62 2091.8,-1287.37 2091.27,-1294.35"/>
</g>
<!-- GPU1_K_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge30" class="edge">
<title>GPU1_K_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M1989.39,-1321.27C2022.35,-1318.68 2057.78,-1315.88 2091.2,-1313.25"/>
<polygon fill="black" stroke="black" points="2091.82,-1316.71 2101.51,-1312.43 2091.27,-1309.73 2091.82,-1316.71"/>
</g>
<!-- GPU1_V_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge31" class="edge">
<title>GPU1_V_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M1986.74,-1370.3C2000.54,-1367.67 2014.33,-1364.84 2027.48,-1361.85 2072.56,-1351.6 2122.34,-1337.36 2161.92,-1325.33"/>
<polygon fill="black" stroke="black" points="2162.95,-1328.68 2171.49,-1322.41 2160.91,-1321.98 2162.95,-1328.68"/>
</g>
<!-- GPU1_O_Proj_RP -->
<g id="node15" class="node">
<title>GPU1_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="2708.97,-1248.35 2445.97,-1248.35 2445.97,-1207.35 2708.97,-1207.35 2708.97,-1248.35"/>
<text text-anchor="middle" x="2577.47" y="-1236.35" font-family="Arial" font-size="10.00">GPU1: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2577.47" y="-1225.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2577.47" y="-1214.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU1_Attention&#45;&gt;GPU1_O_Proj_RP -->
<g id="edge32" class="edge">
<title>GPU1_Attention&#45;&gt;GPU1_O_Proj_RP</title>
<path fill="none" stroke="black" d="M2331.63,-1281.34C2375.41,-1271.77 2427.65,-1260.36 2472.6,-1250.54"/>
<polygon fill="black" stroke="black" points="2473.35,-1253.96 2482.37,-1248.41 2471.86,-1247.12 2473.35,-1253.96"/>
</g>
<!-- GPU1_O_Proj_RP&#45;&gt;Attn_AllReduce_EP0 -->
<g id="edge62" class="edge">
<title>GPU1_O_Proj_RP&#45;&gt;Attn_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M2511.74,-1207.32C2486.82,-1195.96 2460.8,-1179.1 2445.97,-1154.85 2389.75,-1062.94 2480.68,-267.14 2409.97,-185.85 2392.12,-165.34 1985.55,-93.85 1855.24,-93.85 1521.5,-93.85 1521.5,-93.85 1521.5,-93.85 1277.85,-93.85 996.52,-90.79 817.4,-88.45"/>
<polygon fill="black" stroke="black" points="817.39,-84.95 807.35,-88.32 817.3,-91.95 817.39,-84.95"/>
</g>
<!-- Expert_AllReduce_EP0 -->
<g id="node91" class="node">
<title>Expert_AllReduce_EP0</title>
<ellipse fill="#ff9999" stroke="black" cx="1854.24" cy="-1808.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1854.24" y="-1822.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1854.24" y="-1811.85" font-family="Arial" font-size="10.00">EP Group 0 Experts</text>
<text text-anchor="middle" x="1854.24" y="-1800.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1854.24" y="-1789.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU0_Expert00&#45;&gt;Expert_AllReduce_EP0 -->
<g id="edge133" class="edge">
<title>GPU0_Expert00&#45;&gt;Expert_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M1635.9,-1454.92C1639.18,-1457.62 1642.23,-1460.59 1645,-1463.85 1733.08,-1567.55 1590.52,-1666.24 1681,-1767.85 1686.39,-1773.9 1692.5,-1779.15 1699.12,-1783.68"/>
<polygon fill="black" stroke="black" points="1697.42,-1786.74 1707.76,-1789.05 1701.11,-1780.8 1697.42,-1786.74"/>
</g>
<!-- GPU0_Expert01&#45;&gt;Expert_AllReduce_EP0 -->
<g id="edge134" class="edge">
<title>GPU0_Expert01&#45;&gt;Expert_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M1636.24,-1385.05C1639.4,-1387.72 1642.34,-1390.64 1645,-1393.85 1698.35,-1458.08 1626.16,-1704.89 1681,-1767.85 1686.32,-1773.96 1692.38,-1779.25 1698.96,-1783.82"/>
<polygon fill="black" stroke="black" points="1697.22,-1786.86 1707.55,-1789.23 1700.95,-1780.94 1697.22,-1786.86"/>
</g>
<!-- GPU0_Expert02&#45;&gt;Expert_AllReduce_EP0 -->
<g id="edge135" class="edge">
<title>GPU0_Expert02&#45;&gt;Expert_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M1636.3,-1315C1639.44,-1317.68 1642.36,-1320.62 1645,-1323.85 1707.68,-1400.47 1616.55,-1692.72 1681,-1767.85 1686.21,-1773.92 1692.13,-1779.18 1698.58,-1783.73"/>
<polygon fill="black" stroke="black" points="1696.7,-1786.68 1707.01,-1789.13 1700.48,-1780.79 1696.7,-1786.68"/>
</g>
<!-- GPU0_Expert03&#45;&gt;Expert_AllReduce_EP0 -->
<g id="edge136" class="edge">
<title>GPU0_Expert03&#45;&gt;Expert_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M1636.35,-1244.96C1639.48,-1247.65 1642.38,-1250.61 1645,-1253.85 1717.01,-1342.88 1606.93,-1680.54 1681,-1767.85 1686.06,-1773.81 1691.81,-1779 1698.07,-1783.49"/>
<polygon fill="black" stroke="black" points="1696.61,-1786.72 1706.91,-1789.21 1700.42,-1780.84 1696.61,-1786.72"/>
</g>
<!-- GPU1_Expert00&#45;&gt;Expert_AllReduce_EP0 -->
<g id="edge137" class="edge">
<title>GPU1_Expert00&#45;&gt;Expert_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M1587.63,-1734.94C1615.97,-1745.94 1649.86,-1758.35 1681,-1767.85 1694.74,-1772.04 1709.2,-1776.07 1723.66,-1779.85"/>
<polygon fill="black" stroke="black" points="1723.1,-1783.32 1733.66,-1782.43 1724.85,-1776.54 1723.1,-1783.32"/>
</g>
<!-- GPU1_Expert01&#45;&gt;Expert_AllReduce_EP0 -->
<g id="edge138" class="edge">
<title>GPU1_Expert01&#45;&gt;Expert_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M1633.55,-1664.93C1637.6,-1667.62 1641.44,-1670.58 1645,-1673.85 1677.95,-1704.11 1647.35,-1738.37 1681,-1767.85 1687.72,-1773.74 1695.14,-1778.82 1703,-1783.19"/>
<polygon fill="black" stroke="black" points="1701.56,-1786.39 1712.06,-1787.84 1704.76,-1780.16 1701.56,-1786.39"/>
</g>
<!-- GPU1_Expert02&#45;&gt;Expert_AllReduce_EP0 -->
<g id="edge139" class="edge">
<title>GPU1_Expert02&#45;&gt;Expert_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M1634.97,-1594.88C1638.56,-1597.59 1641.92,-1600.57 1645,-1603.85 1696.04,-1658.29 1628.7,-1714.62 1681,-1767.85 1686.83,-1773.79 1693.36,-1778.93 1700.36,-1783.37"/>
<polygon fill="black" stroke="black" points="1699.07,-1786.66 1709.48,-1788.63 1702.57,-1780.6 1699.07,-1786.66"/>
</g>
<!-- GPU1_Expert03&#45;&gt;Expert_AllReduce_EP0 -->
<g id="edge140" class="edge">
<title>GPU1_Expert03&#45;&gt;Expert_AllReduce_EP0</title>
<path fill="none" stroke="black" d="M1635.75,-1525.04C1639.07,-1527.71 1642.17,-1530.64 1645,-1533.85 1714.5,-1612.86 1609.67,-1690.49 1681,-1767.85 1686.57,-1773.89 1692.85,-1779.11 1699.64,-1783.63"/>
<polygon fill="black" stroke="black" points="1698.12,-1786.8 1708.49,-1788.97 1701.74,-1780.81 1698.12,-1786.8"/>
</g>
<!-- GPU2_Attention -->
<g id="node25" class="node">
<title>GPU2_Attention</title>
<polygon fill="#ffe6f3" stroke="black" points="1989.24,-685.35 1719.24,-685.35 1719.24,-644.35 1989.24,-644.35 1989.24,-685.35"/>
<text text-anchor="middle" x="1854.24" y="-673.35" font-family="Arial" font-size="10.00">GPU2: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-662.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-651.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU2_RMSNorm&#45;&gt;GPU2_Attention -->
<g id="edge33" class="edge">
<title>GPU2_RMSNorm&#45;&gt;GPU2_Attention</title>
<path fill="none" stroke="black" d="M1611.4,-607.4C1622.76,-610.39 1634.19,-613.57 1645,-616.85 1661.28,-621.79 1664.62,-625.26 1681,-629.85 1696.84,-634.3 1713.65,-638.42 1730.32,-642.16"/>
<polygon fill="black" stroke="black" points="1729.59,-645.59 1740.11,-644.32 1731.09,-638.75 1729.59,-645.59"/>
</g>
<!-- GPU2_O_Proj_RP -->
<g id="node26" class="node">
<title>GPU2_O_Proj_RP</title>
<polygon fill="#ffe6f3" stroke="black" points="2368.22,-646.35 2105.22,-646.35 2105.22,-605.35 2368.22,-605.35 2368.22,-646.35"/>
<text text-anchor="middle" x="2236.72" y="-634.35" font-family="Arial" font-size="10.00">GPU2: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-623.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-612.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU2_Attention&#45;&gt;GPU2_O_Proj_RP -->
<g id="edge34" class="edge">
<title>GPU2_Attention&#45;&gt;GPU2_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-651.1C2023.56,-647.6 2060.39,-643.82 2094.89,-640.29"/>
<polygon fill="black" stroke="black" points="2095.44,-643.75 2105.03,-639.25 2094.73,-636.79 2095.44,-643.75"/>
</g>
<!-- Attn_AllReduce_EP1 -->
<g id="node83" class="node">
<title>Attn_AllReduce_EP1</title>
<ellipse fill="#ff9999" stroke="black" cx="634.41" cy="-537.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="634.41" y="-551.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="634.41" y="-540.85" font-family="Arial" font-size="10.00">EP Group 1 Attention</text>
<text text-anchor="middle" x="634.41" y="-529.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="634.41" y="-518.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU2_O_Proj_RP&#45;&gt;Attn_AllReduce_EP1 -->
<g id="edge63" class="edge">
<title>GPU2_O_Proj_RP&#45;&gt;Attn_AllReduce_EP1</title>
<path fill="none" stroke="black" d="M2105,-610.58C1942.52,-591.52 1685.78,-561.14 1681,-558.85 1660.87,-549.23 1665.68,-532.25 1645,-523.85 1496.21,-463.44 1082.89,-519.94 922.34,-523.85 886.68,-524.72 848.55,-526.2 812.11,-527.87"/>
<polygon fill="black" stroke="black" points="811.71,-524.39 801.88,-528.35 812.03,-531.38 811.71,-524.39"/>
</g>
<!-- GPU3_Attention -->
<g id="node28" class="node">
<title>GPU3_Attention</title>
<polygon fill="#ffe6f3" stroke="black" points="1989.24,-744.35 1719.24,-744.35 1719.24,-703.35 1989.24,-703.35 1989.24,-744.35"/>
<text text-anchor="middle" x="1854.24" y="-732.35" font-family="Arial" font-size="10.00">GPU3: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-721.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-710.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU3_RMSNorm&#45;&gt;GPU3_Attention -->
<g id="edge35" class="edge">
<title>GPU3_RMSNorm&#45;&gt;GPU3_Attention</title>
<path fill="none" stroke="black" d="M1616.76,-666.4C1626.4,-669.26 1635.97,-672.41 1645,-675.85 1661.91,-682.29 1663.86,-689.05 1681,-694.85 1690.16,-697.95 1699.7,-700.72 1709.4,-703.21"/>
<polygon fill="black" stroke="black" points="1708.59,-706.62 1719.14,-705.6 1710.26,-699.82 1708.59,-706.62"/>
</g>
<!-- GPU3_O_Proj_RP -->
<g id="node29" class="node">
<title>GPU3_O_Proj_RP</title>
<polygon fill="#ffe6f3" stroke="black" points="2368.22,-724.35 2105.22,-724.35 2105.22,-683.35 2368.22,-683.35 2368.22,-724.35"/>
<text text-anchor="middle" x="2236.72" y="-712.35" font-family="Arial" font-size="10.00">GPU3: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-701.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-690.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU3_Attention&#45;&gt;GPU3_O_Proj_RP -->
<g id="edge36" class="edge">
<title>GPU3_Attention&#45;&gt;GPU3_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-716.8C2023.56,-715 2060.39,-713.07 2094.89,-711.25"/>
<polygon fill="black" stroke="black" points="2095.23,-714.74 2105.03,-710.72 2094.86,-707.75 2095.23,-714.74"/>
</g>
<!-- GPU3_O_Proj_RP&#45;&gt;Attn_AllReduce_EP1 -->
<g id="edge64" class="edge">
<title>GPU3_O_Proj_RP&#45;&gt;Attn_AllReduce_EP1</title>
<path fill="none" stroke="black" d="M2146.76,-683.34C2119.58,-675.94 2089.9,-666.69 2063.48,-655.85 2046.55,-648.9 2044.89,-641.5 2027.48,-635.85 1879.94,-587.96 1820.47,-661.74 1681,-593.85 1660.66,-583.95 1665.82,-566.72 1645,-557.85 1571.25,-526.44 1087.55,-529.71 817.33,-534.13"/>
<polygon fill="black" stroke="black" points="816.95,-530.63 807.01,-534.3 817.07,-537.63 816.95,-530.63"/>
</g>
<!-- Expert_AllReduce_EP1 -->
<g id="node92" class="node">
<title>Expert_AllReduce_EP1</title>
<ellipse fill="#ff9999" stroke="black" cx="1854.24" cy="-1020.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1854.24" y="-1034.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1854.24" y="-1023.85" font-family="Arial" font-size="10.00">EP Group 1 Experts</text>
<text text-anchor="middle" x="1854.24" y="-1012.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1854.24" y="-1001.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU2_Expert00&#45;&gt;Expert_AllReduce_EP1 -->
<g id="edge141" class="edge">
<title>GPU2_Expert00&#45;&gt;Expert_AllReduce_EP1</title>
<path fill="none" stroke="black" d="M1634.97,-806.88C1638.56,-809.59 1641.92,-812.57 1645,-815.85 1696.04,-870.29 1628.7,-926.62 1681,-979.85 1686.83,-985.79 1693.36,-990.93 1700.36,-995.37"/>
<polygon fill="black" stroke="black" points="1699.07,-998.66 1709.48,-1000.63 1702.57,-992.6 1699.07,-998.66"/>
</g>
<!-- GPU2_Expert01&#45;&gt;Expert_AllReduce_EP1 -->
<g id="edge142" class="edge">
<title>GPU2_Expert01&#45;&gt;Expert_AllReduce_EP1</title>
<path fill="none" stroke="black" d="M1635.75,-737.04C1639.07,-739.71 1642.17,-742.64 1645,-745.85 1714.5,-824.86 1609.67,-902.49 1681,-979.85 1686.57,-985.89 1692.85,-991.11 1699.64,-995.63"/>
<polygon fill="black" stroke="black" points="1698.12,-998.8 1708.49,-1000.97 1701.74,-992.81 1698.12,-998.8"/>
</g>
<!-- GPU3_Expert00&#45;&gt;Expert_AllReduce_EP1 -->
<g id="edge143" class="edge">
<title>GPU3_Expert00&#45;&gt;Expert_AllReduce_EP1</title>
<path fill="none" stroke="black" d="M1587.63,-946.94C1615.97,-957.94 1649.86,-970.35 1681,-979.85 1694.74,-984.04 1709.2,-988.07 1723.66,-991.85"/>
<polygon fill="black" stroke="black" points="1723.1,-995.32 1733.66,-994.43 1724.85,-988.54 1723.1,-995.32"/>
</g>
<!-- GPU3_Expert01&#45;&gt;Expert_AllReduce_EP1 -->
<g id="edge144" class="edge">
<title>GPU3_Expert01&#45;&gt;Expert_AllReduce_EP1</title>
<path fill="none" stroke="black" d="M1633.55,-876.93C1637.6,-879.62 1641.44,-882.58 1645,-885.85 1677.95,-916.11 1647.35,-950.37 1681,-979.85 1687.72,-985.74 1695.14,-990.82 1703,-995.19"/>
<polygon fill="black" stroke="black" points="1701.56,-998.39 1712.06,-999.84 1704.76,-992.16 1701.56,-998.39"/>
</g>
<!-- GPU4_Attention -->
<g id="node35" class="node">
<title>GPU4_Attention</title>
<polygon fill="#f3ffe6" stroke="black" points="1989.24,-2086.35 1719.24,-2086.35 1719.24,-2045.35 1989.24,-2045.35 1989.24,-2086.35"/>
<text text-anchor="middle" x="1854.24" y="-2074.35" font-family="Arial" font-size="10.00">GPU4: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-2063.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-2052.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU4_RMSNorm&#45;&gt;GPU4_Attention -->
<g id="edge37" class="edge">
<title>GPU4_RMSNorm&#45;&gt;GPU4_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-2075.94C1666.1,-2074.93 1687.82,-2073.88 1709.08,-2072.85"/>
<polygon fill="black" stroke="black" points="1709.32,-2076.34 1719.14,-2072.36 1708.98,-2069.35 1709.32,-2076.34"/>
</g>
<!-- GPU4_O_Proj_RP -->
<g id="node36" class="node">
<title>GPU4_O_Proj_RP</title>
<polygon fill="#f3ffe6" stroke="black" points="2368.22,-2051.35 2105.22,-2051.35 2105.22,-2010.35 2368.22,-2010.35 2368.22,-2051.35"/>
<text text-anchor="middle" x="2236.72" y="-2039.35" font-family="Arial" font-size="10.00">GPU4: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-2028.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-2017.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU4_Attention&#45;&gt;GPU4_O_Proj_RP -->
<g id="edge38" class="edge">
<title>GPU4_Attention&#45;&gt;GPU4_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-2053.51C2023.56,-2050.37 2060.39,-2046.98 2094.89,-2043.81"/>
<polygon fill="black" stroke="black" points="2095.39,-2047.27 2105.03,-2042.87 2094.75,-2040.3 2095.39,-2047.27"/>
</g>
<!-- Attn_AllReduce_EP2 -->
<g id="node84" class="node">
<title>Attn_AllReduce_EP2</title>
<ellipse fill="#ff9999" stroke="black" cx="634.41" cy="-1795.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="634.41" y="-1809.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="634.41" y="-1798.85" font-family="Arial" font-size="10.00">EP Group 2 Attention</text>
<text text-anchor="middle" x="634.41" y="-1787.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="634.41" y="-1776.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU4_O_Proj_RP&#45;&gt;Attn_AllReduce_EP2 -->
<g id="edge65" class="edge">
<title>GPU4_O_Proj_RP&#45;&gt;Attn_AllReduce_EP2</title>
<path fill="none" stroke="black" d="M2178.33,-2010.26C2136.78,-1995.81 2079.1,-1976.67 2027.48,-1962.85 1875.47,-1922.14 1818.85,-1965.77 1681,-1889.85 1660.9,-1878.78 1665.88,-1862.37 1645,-1852.85 1571.96,-1819.55 1087.96,-1804.74 817.5,-1798.99"/>
<polygon fill="black" stroke="black" points="817.24,-1795.49 807.17,-1798.78 817.1,-1802.49 817.24,-1795.49"/>
</g>
<!-- GPU5_Attention -->
<g id="node38" class="node">
<title>GPU5_Attention</title>
<polygon fill="#f3ffe6" stroke="black" points="1989.24,-2012.35 1719.24,-2012.35 1719.24,-1971.35 1989.24,-1971.35 1989.24,-2012.35"/>
<text text-anchor="middle" x="1854.24" y="-2000.35" font-family="Arial" font-size="10.00">GPU5: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-1989.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-1978.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU5_RMSNorm&#45;&gt;GPU5_Attention -->
<g id="edge39" class="edge">
<title>GPU5_RMSNorm&#45;&gt;GPU5_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-2011.4C1666.1,-2009.45 1687.82,-2007.4 1709.08,-2005.4"/>
<polygon fill="black" stroke="black" points="1709.51,-2008.88 1719.14,-2004.46 1708.85,-2001.91 1709.51,-2008.88"/>
</g>
<!-- GPU5_O_Proj_RP -->
<g id="node39" class="node">
<title>GPU5_O_Proj_RP</title>
<polygon fill="#f3ffe6" stroke="black" points="2368.22,-1957.35 2105.22,-1957.35 2105.22,-1916.35 2368.22,-1916.35 2368.22,-1957.35"/>
<text text-anchor="middle" x="2236.72" y="-1945.35" font-family="Arial" font-size="10.00">GPU5: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-1934.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-1923.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU5_Attention&#45;&gt;GPU5_O_Proj_RP -->
<g id="edge40" class="edge">
<title>GPU5_Attention&#45;&gt;GPU5_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-1972.46C2023.56,-1967.52 2060.39,-1962.2 2094.89,-1957.21"/>
<polygon fill="black" stroke="black" points="2095.63,-1960.64 2105.03,-1955.74 2094.63,-1953.71 2095.63,-1960.64"/>
</g>
<!-- GPU5_O_Proj_RP&#45;&gt;Attn_AllReduce_EP2 -->
<g id="edge66" class="edge">
<title>GPU5_O_Proj_RP&#45;&gt;Attn_AllReduce_EP2</title>
<path fill="none" stroke="black" d="M2133.2,-1916.35C2099.59,-1909.98 2062.01,-1903.22 2027.48,-1897.85 1874.15,-1874 1820.9,-1921.98 1681,-1854.85 1660.88,-1845.2 1665.58,-1828.49 1645,-1819.85 1499.46,-1758.74 1059.17,-1771.72 810.78,-1784.8"/>
<polygon fill="black" stroke="black" points="810.36,-1781.32 800.56,-1785.35 810.73,-1788.31 810.36,-1781.32"/>
</g>
<!-- Expert_AllReduce_EP2 -->
<g id="node93" class="node">
<title>Expert_AllReduce_EP2</title>
<ellipse fill="#ff9999" stroke="black" cx="1854.24" cy="-2176.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1854.24" y="-2190.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1854.24" y="-2179.85" font-family="Arial" font-size="10.00">EP Group 2 Experts</text>
<text text-anchor="middle" x="1854.24" y="-2168.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1854.24" y="-2157.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU4_Expert00&#45;&gt;Expert_AllReduce_EP2 -->
<g id="edge145" class="edge">
<title>GPU4_Expert00&#45;&gt;Expert_AllReduce_EP2</title>
<path fill="none" stroke="black" d="M1633.52,-1983.96C1637.64,-1986.92 1641.5,-1990.2 1645,-1993.85 1690.11,-2040.8 1634.63,-2090.15 1681,-2135.85 1686.93,-2141.69 1693.53,-2146.76 1700.59,-2151.14"/>
<polygon fill="black" stroke="black" points="1699.34,-2154.46 1709.77,-2156.34 1702.79,-2148.37 1699.34,-2154.46"/>
</g>
<!-- GPU5_Expert00&#45;&gt;Expert_AllReduce_EP2 -->
<g id="edge146" class="edge">
<title>GPU5_Expert00&#45;&gt;Expert_AllReduce_EP2</title>
<path fill="none" stroke="black" d="M1635.44,-1913.89C1638.87,-1916.6 1642.08,-1919.58 1645,-1922.85 1708.95,-1994.47 1615.4,-2065.75 1681,-2135.85 1686.61,-2141.85 1692.93,-2147.04 1699.74,-2151.53"/>
<polygon fill="black" stroke="black" points="1698.25,-2154.71 1708.62,-2156.85 1701.84,-2148.71 1698.25,-2154.71"/>
</g>
<!-- GPU6_Attention -->
<g id="node43" class="node">
<title>GPU6_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-239.35 1719.24,-239.35 1719.24,-198.35 1989.24,-198.35 1989.24,-239.35"/>
<text text-anchor="middle" x="1854.24" y="-227.35" font-family="Arial" font-size="10.00">GPU6: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-216.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-205.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU6_RMSNorm&#45;&gt;GPU6_Attention -->
<g id="edge41" class="edge">
<title>GPU6_RMSNorm&#45;&gt;GPU6_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-218.85C1666.1,-218.85 1687.82,-218.85 1709.08,-218.85"/>
<polygon fill="black" stroke="black" points="1709.14,-222.35 1719.14,-218.85 1709.14,-215.35 1709.14,-222.35"/>
</g>
<!-- GPU6_O_Proj_RP -->
<g id="node44" class="node">
<title>GPU6_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="2368.22,-239.35 2105.22,-239.35 2105.22,-198.35 2368.22,-198.35 2368.22,-239.35"/>
<text text-anchor="middle" x="2236.72" y="-227.35" font-family="Arial" font-size="10.00">GPU6: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-216.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-205.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU6_Attention&#45;&gt;GPU6_O_Proj_RP -->
<g id="edge42" class="edge">
<title>GPU6_Attention&#45;&gt;GPU6_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-218.85C2023.56,-218.85 2060.39,-218.85 2094.89,-218.85"/>
<polygon fill="black" stroke="black" points="2095.03,-222.35 2105.03,-218.85 2095.03,-215.35 2095.03,-222.35"/>
</g>
<!-- Attn_AllReduce_EP3 -->
<g id="node85" class="node">
<title>Attn_AllReduce_EP3</title>
<ellipse fill="#ff9999" stroke="black" cx="634.41" cy="-177.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="634.41" y="-191.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="634.41" y="-180.85" font-family="Arial" font-size="10.00">EP Group 3 Attention</text>
<text text-anchor="middle" x="634.41" y="-169.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="634.41" y="-158.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU6_O_Proj_RP&#45;&gt;Attn_AllReduce_EP3 -->
<g id="edge67" class="edge">
<title>GPU6_O_Proj_RP&#45;&gt;Attn_AllReduce_EP3</title>
<path fill="none" stroke="black" d="M2183.21,-198.27C2141.68,-183.15 2081.85,-163.89 2027.48,-155.85 1541.6,-83.96 1413.16,-137.06 922.34,-155.85 884.19,-157.31 843.25,-159.86 804.58,-162.72"/>
<polygon fill="black" stroke="black" points="803.98,-159.25 794.27,-163.49 804.51,-166.23 803.98,-159.25"/>
</g>
<!-- GPU7_Attention -->
<g id="node46" class="node">
<title>GPU7_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-298.35 1719.24,-298.35 1719.24,-257.35 1989.24,-257.35 1989.24,-298.35"/>
<text text-anchor="middle" x="1854.24" y="-286.35" font-family="Arial" font-size="10.00">GPU7: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-275.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-264.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU7_RMSNorm&#45;&gt;GPU7_Attention -->
<g id="edge43" class="edge">
<title>GPU7_RMSNorm&#45;&gt;GPU7_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-277.85C1666.1,-277.85 1687.82,-277.85 1709.08,-277.85"/>
<polygon fill="black" stroke="black" points="1709.14,-281.35 1719.14,-277.85 1709.14,-274.35 1709.14,-281.35"/>
</g>
<!-- GPU7_O_Proj_RP -->
<g id="node47" class="node">
<title>GPU7_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="2368.22,-298.35 2105.22,-298.35 2105.22,-257.35 2368.22,-257.35 2368.22,-298.35"/>
<text text-anchor="middle" x="2236.72" y="-286.35" font-family="Arial" font-size="10.00">GPU7: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-275.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-264.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU7_Attention&#45;&gt;GPU7_O_Proj_RP -->
<g id="edge44" class="edge">
<title>GPU7_Attention&#45;&gt;GPU7_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-277.85C2023.56,-277.85 2060.39,-277.85 2094.89,-277.85"/>
<polygon fill="black" stroke="black" points="2095.03,-281.35 2105.03,-277.85 2095.03,-274.35 2095.03,-281.35"/>
</g>
<!-- GPU7_O_Proj_RP&#45;&gt;Attn_AllReduce_EP3 -->
<g id="edge68" class="edge">
<title>GPU7_O_Proj_RP&#45;&gt;Attn_AllReduce_EP3</title>
<path fill="none" stroke="black" d="M2105.02,-268.24C2090.26,-263.63 2076.04,-257.35 2063.48,-248.85 2038.04,-231.64 2054.21,-205 2027.48,-189.85 1975.83,-160.57 1183.02,-169.17 817.49,-174.75"/>
<polygon fill="black" stroke="black" points="817.28,-171.26 807.34,-174.91 817.39,-178.25 817.28,-171.26"/>
</g>
<!-- Expert_AllReduce_EP3 -->
<g id="node94" class="node">
<title>Expert_AllReduce_EP3</title>
<ellipse fill="#ff9999" stroke="black" cx="1854.24" cy="-512.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1854.24" y="-526.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1854.24" y="-515.85" font-family="Arial" font-size="10.00">EP Group 3 Experts</text>
<text text-anchor="middle" x="1854.24" y="-504.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1854.24" y="-493.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU6_Expert00&#45;&gt;Expert_AllReduce_EP3 -->
<g id="edge147" class="edge">
<title>GPU6_Expert00&#45;&gt;Expert_AllReduce_EP3</title>
<path fill="none" stroke="black" d="M1587.63,-438.94C1615.97,-449.94 1649.86,-462.35 1681,-471.85 1694.74,-476.04 1709.2,-480.07 1723.66,-483.85"/>
<polygon fill="black" stroke="black" points="1723.1,-487.32 1733.66,-486.43 1724.85,-480.54 1723.1,-487.32"/>
</g>
<!-- GPU7_Expert00&#45;&gt;Expert_AllReduce_EP3 -->
<g id="edge148" class="edge">
<title>GPU7_Expert00&#45;&gt;Expert_AllReduce_EP3</title>
<path fill="none" stroke="black" d="M1633.55,-368.93C1637.6,-371.62 1641.44,-374.58 1645,-377.85 1677.95,-408.11 1647.35,-442.37 1681,-471.85 1687.72,-477.74 1695.14,-482.82 1703,-487.19"/>
<polygon fill="black" stroke="black" points="1701.56,-490.39 1712.06,-491.84 1704.76,-484.16 1701.56,-490.39"/>
</g>
<!-- GPU8_Attention -->
<g id="node51" class="node">
<title>GPU8_Attention</title>
<polygon fill="#ffe6f3" stroke="black" points="1989.24,-3799.35 1719.24,-3799.35 1719.24,-3758.35 1989.24,-3758.35 1989.24,-3799.35"/>
<text text-anchor="middle" x="1854.24" y="-3787.35" font-family="Arial" font-size="10.00">GPU8: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-3776.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-3765.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU8_RMSNorm&#45;&gt;GPU8_Attention -->
<g id="edge45" class="edge">
<title>GPU8_RMSNorm&#45;&gt;GPU8_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-3778.85C1666.1,-3778.85 1687.82,-3778.85 1709.08,-3778.85"/>
<polygon fill="black" stroke="black" points="1709.14,-3782.35 1719.14,-3778.85 1709.14,-3775.35 1709.14,-3782.35"/>
</g>
<!-- GPU8_O_Proj_RP -->
<g id="node52" class="node">
<title>GPU8_O_Proj_RP</title>
<polygon fill="#ffe6f3" stroke="black" points="2368.22,-3799.35 2105.22,-3799.35 2105.22,-3758.35 2368.22,-3758.35 2368.22,-3799.35"/>
<text text-anchor="middle" x="2236.72" y="-3787.35" font-family="Arial" font-size="10.00">GPU8: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-3776.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-3765.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU8_Attention&#45;&gt;GPU8_O_Proj_RP -->
<g id="edge46" class="edge">
<title>GPU8_Attention&#45;&gt;GPU8_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-3778.85C2023.56,-3778.85 2060.39,-3778.85 2094.89,-3778.85"/>
<polygon fill="black" stroke="black" points="2095.03,-3782.35 2105.03,-3778.85 2095.03,-3775.35 2095.03,-3782.35"/>
</g>
<!-- Attn_AllReduce_EP4 -->
<g id="node86" class="node">
<title>Attn_AllReduce_EP4</title>
<ellipse fill="#ff9999" stroke="black" cx="634.41" cy="-3827.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="634.41" y="-3841.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="634.41" y="-3830.85" font-family="Arial" font-size="10.00">EP Group 4 Attention</text>
<text text-anchor="middle" x="634.41" y="-3819.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="634.41" y="-3808.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU8_O_Proj_RP&#45;&gt;Attn_AllReduce_EP4 -->
<g id="edge69" class="edge">
<title>GPU8_O_Proj_RP&#45;&gt;Attn_AllReduce_EP4</title>
<path fill="none" stroke="black" d="M2183.21,-3799.44C2141.68,-3814.56 2081.85,-3833.81 2027.48,-3841.85 1541.6,-3913.74 1413.37,-3853.82 922.34,-3841.85 886.68,-3840.98 848.55,-3839.51 812.11,-3837.83"/>
<polygon fill="black" stroke="black" points="812.03,-3834.32 801.88,-3837.35 811.71,-3841.31 812.03,-3834.32"/>
</g>
<!-- GPU9_Attention -->
<g id="node54" class="node">
<title>GPU9_Attention</title>
<polygon fill="#ffe6f3" stroke="black" points="1989.24,-3740.35 1719.24,-3740.35 1719.24,-3699.35 1989.24,-3699.35 1989.24,-3740.35"/>
<text text-anchor="middle" x="1854.24" y="-3728.35" font-family="Arial" font-size="10.00">GPU9: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-3717.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-3706.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU9_RMSNorm&#45;&gt;GPU9_Attention -->
<g id="edge47" class="edge">
<title>GPU9_RMSNorm&#45;&gt;GPU9_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-3719.85C1666.1,-3719.85 1687.82,-3719.85 1709.08,-3719.85"/>
<polygon fill="black" stroke="black" points="1709.14,-3723.35 1719.14,-3719.85 1709.14,-3716.35 1709.14,-3723.35"/>
</g>
<!-- GPU9_O_Proj_RP -->
<g id="node55" class="node">
<title>GPU9_O_Proj_RP</title>
<polygon fill="#ffe6f3" stroke="black" points="2368.22,-3740.35 2105.22,-3740.35 2105.22,-3699.35 2368.22,-3699.35 2368.22,-3740.35"/>
<text text-anchor="middle" x="2236.72" y="-3728.35" font-family="Arial" font-size="10.00">GPU9: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-3717.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-3706.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU9_Attention&#45;&gt;GPU9_O_Proj_RP -->
<g id="edge48" class="edge">
<title>GPU9_Attention&#45;&gt;GPU9_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-3719.85C2023.56,-3719.85 2060.39,-3719.85 2094.89,-3719.85"/>
<polygon fill="black" stroke="black" points="2095.03,-3723.35 2105.03,-3719.85 2095.03,-3716.35 2095.03,-3723.35"/>
</g>
<!-- GPU9_O_Proj_RP&#45;&gt;Attn_AllReduce_EP4 -->
<g id="edge70" class="edge">
<title>GPU9_O_Proj_RP&#45;&gt;Attn_AllReduce_EP4</title>
<path fill="none" stroke="black" d="M2105,-3730.27C2090.24,-3734.96 2076.03,-3741.31 2063.48,-3749.85 2038.09,-3767.14 2054.17,-3793.63 2027.48,-3808.85 1975.92,-3838.26 1183.56,-3833.72 817.85,-3830.02"/>
<polygon fill="black" stroke="black" points="817.73,-3826.52 807.69,-3829.91 817.65,-3833.52 817.73,-3826.52"/>
</g>
<!-- Expert_AllReduce_EP4 -->
<g id="node95" class="node">
<title>Expert_AllReduce_EP4</title>
<ellipse fill="#ff9999" stroke="black" cx="1854.24" cy="-3505.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1854.24" y="-3519.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1854.24" y="-3508.85" font-family="Arial" font-size="10.00">EP Group 4 Experts</text>
<text text-anchor="middle" x="1854.24" y="-3497.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1854.24" y="-3486.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU8_Expert00&#45;&gt;Expert_AllReduce_EP4 -->
<g id="edge149" class="edge">
<title>GPU8_Expert00&#45;&gt;Expert_AllReduce_EP4</title>
<path fill="none" stroke="black" d="M1632.61,-3628.7C1636.97,-3626.03 1641.13,-3623.09 1645,-3619.85 1672.75,-3596.64 1652.72,-3569.41 1681,-3546.85 1688.24,-3541.08 1696.15,-3536.1 1704.49,-3531.8"/>
<polygon fill="black" stroke="black" points="1706.18,-3534.88 1713.69,-3527.41 1703.16,-3528.56 1706.18,-3534.88"/>
</g>
<!-- GPU9_Expert00&#45;&gt;Expert_AllReduce_EP4 -->
<g id="edge150" class="edge">
<title>GPU9_Expert00&#45;&gt;Expert_AllReduce_EP4</title>
<path fill="none" stroke="black" d="M1631.09,-3558.85C1647.8,-3554.82 1664.86,-3550.72 1681,-3546.85 1696.23,-3543.2 1712.21,-3539.38 1728.05,-3535.61"/>
<polygon fill="black" stroke="black" points="1728.97,-3538.98 1737.88,-3533.26 1727.34,-3532.17 1728.97,-3538.98"/>
</g>
<!-- GPU10_Attention -->
<g id="node59" class="node">
<title>GPU10_Attention</title>
<polygon fill="#f3ffe6" stroke="black" points="1989.24,-3374.35 1719.24,-3374.35 1719.24,-3333.35 1989.24,-3333.35 1989.24,-3374.35"/>
<text text-anchor="middle" x="1854.24" y="-3362.35" font-family="Arial" font-size="10.00">GPU10: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-3351.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-3340.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU10_RMSNorm&#45;&gt;GPU10_Attention -->
<g id="edge49" class="edge">
<title>GPU10_RMSNorm&#45;&gt;GPU10_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-3353.85C1666.1,-3353.85 1687.82,-3353.85 1709.08,-3353.85"/>
<polygon fill="black" stroke="black" points="1709.14,-3357.35 1719.14,-3353.85 1709.14,-3350.35 1709.14,-3357.35"/>
</g>
<!-- GPU10_O_Proj_RP -->
<g id="node60" class="node">
<title>GPU10_O_Proj_RP</title>
<polygon fill="#f3ffe6" stroke="black" points="2368.22,-3374.35 2105.22,-3374.35 2105.22,-3333.35 2368.22,-3333.35 2368.22,-3374.35"/>
<text text-anchor="middle" x="2236.72" y="-3362.35" font-family="Arial" font-size="10.00">GPU10: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-3351.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-3340.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU10_Attention&#45;&gt;GPU10_O_Proj_RP -->
<g id="edge50" class="edge">
<title>GPU10_Attention&#45;&gt;GPU10_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-3353.85C2023.56,-3353.85 2060.39,-3353.85 2094.89,-3353.85"/>
<polygon fill="black" stroke="black" points="2095.03,-3357.35 2105.03,-3353.85 2095.03,-3350.35 2095.03,-3357.35"/>
</g>
<!-- Attn_AllReduce_EP5 -->
<g id="node87" class="node">
<title>Attn_AllReduce_EP5</title>
<ellipse fill="#ff9999" stroke="black" cx="634.41" cy="-3402.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="634.41" y="-3416.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="634.41" y="-3405.85" font-family="Arial" font-size="10.00">EP Group 5 Attention</text>
<text text-anchor="middle" x="634.41" y="-3394.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="634.41" y="-3383.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU10_O_Proj_RP&#45;&gt;Attn_AllReduce_EP5 -->
<g id="edge71" class="edge">
<title>GPU10_O_Proj_RP&#45;&gt;Attn_AllReduce_EP5</title>
<path fill="none" stroke="black" d="M2183.21,-3374.44C2141.68,-3389.56 2081.85,-3408.81 2027.48,-3416.85 1541.6,-3488.74 1413.37,-3428.82 922.34,-3416.85 886.68,-3415.98 848.55,-3414.51 812.11,-3412.83"/>
<polygon fill="black" stroke="black" points="812.03,-3409.32 801.88,-3412.35 811.71,-3416.31 812.03,-3409.32"/>
</g>
<!-- GPU11_Attention -->
<g id="node62" class="node">
<title>GPU11_Attention</title>
<polygon fill="#f3ffe6" stroke="black" points="1989.24,-3315.35 1719.24,-3315.35 1719.24,-3274.35 1989.24,-3274.35 1989.24,-3315.35"/>
<text text-anchor="middle" x="1854.24" y="-3303.35" font-family="Arial" font-size="10.00">GPU11: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-3292.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-3281.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU11_RMSNorm&#45;&gt;GPU11_Attention -->
<g id="edge51" class="edge">
<title>GPU11_RMSNorm&#45;&gt;GPU11_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-3294.85C1666.1,-3294.85 1687.82,-3294.85 1709.08,-3294.85"/>
<polygon fill="black" stroke="black" points="1709.14,-3298.35 1719.14,-3294.85 1709.14,-3291.35 1709.14,-3298.35"/>
</g>
<!-- GPU11_O_Proj_RP -->
<g id="node63" class="node">
<title>GPU11_O_Proj_RP</title>
<polygon fill="#f3ffe6" stroke="black" points="2368.22,-3315.35 2105.22,-3315.35 2105.22,-3274.35 2368.22,-3274.35 2368.22,-3315.35"/>
<text text-anchor="middle" x="2236.72" y="-3303.35" font-family="Arial" font-size="10.00">GPU11: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-3292.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-3281.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU11_Attention&#45;&gt;GPU11_O_Proj_RP -->
<g id="edge52" class="edge">
<title>GPU11_Attention&#45;&gt;GPU11_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-3294.85C2023.56,-3294.85 2060.39,-3294.85 2094.89,-3294.85"/>
<polygon fill="black" stroke="black" points="2095.03,-3298.35 2105.03,-3294.85 2095.03,-3291.35 2095.03,-3298.35"/>
</g>
<!-- GPU11_O_Proj_RP&#45;&gt;Attn_AllReduce_EP5 -->
<g id="edge72" class="edge">
<title>GPU11_O_Proj_RP&#45;&gt;Attn_AllReduce_EP5</title>
<path fill="none" stroke="black" d="M2105,-3305.27C2090.24,-3309.96 2076.03,-3316.31 2063.48,-3324.85 2038.09,-3342.14 2054.17,-3368.63 2027.48,-3383.85 1975.92,-3413.26 1183.56,-3408.72 817.85,-3405.02"/>
<polygon fill="black" stroke="black" points="817.73,-3401.52 807.69,-3404.91 817.65,-3408.52 817.73,-3401.52"/>
</g>
<!-- Expert_AllReduce_EP5 -->
<g id="node96" class="node">
<title>Expert_AllReduce_EP5</title>
<ellipse fill="#ff9999" stroke="black" cx="1854.24" cy="-3080.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1854.24" y="-3094.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1854.24" y="-3083.85" font-family="Arial" font-size="10.00">EP Group 5 Experts</text>
<text text-anchor="middle" x="1854.24" y="-3072.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1854.24" y="-3061.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU10_Expert00&#45;&gt;Expert_AllReduce_EP5 -->
<g id="edge151" class="edge">
<title>GPU10_Expert00&#45;&gt;Expert_AllReduce_EP5</title>
<path fill="none" stroke="black" d="M1632.61,-3203.7C1636.97,-3201.03 1641.13,-3198.09 1645,-3194.85 1672.75,-3171.64 1652.72,-3144.41 1681,-3121.85 1688.24,-3116.08 1696.15,-3111.1 1704.49,-3106.8"/>
<polygon fill="black" stroke="black" points="1706.18,-3109.88 1713.69,-3102.41 1703.16,-3103.56 1706.18,-3109.88"/>
</g>
<!-- GPU11_Expert00&#45;&gt;Expert_AllReduce_EP5 -->
<g id="edge152" class="edge">
<title>GPU11_Expert00&#45;&gt;Expert_AllReduce_EP5</title>
<path fill="none" stroke="black" d="M1631.09,-3133.85C1647.8,-3129.82 1664.86,-3125.72 1681,-3121.85 1696.23,-3118.2 1712.21,-3114.38 1728.05,-3110.61"/>
<polygon fill="black" stroke="black" points="1728.97,-3113.98 1737.88,-3108.26 1727.34,-3107.17 1728.97,-3113.98"/>
</g>
<!-- GPU12_Attention -->
<g id="node67" class="node">
<title>GPU12_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-2890.35 1719.24,-2890.35 1719.24,-2849.35 1989.24,-2849.35 1989.24,-2890.35"/>
<text text-anchor="middle" x="1854.24" y="-2878.35" font-family="Arial" font-size="10.00">GPU12: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-2867.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-2856.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU12_RMSNorm&#45;&gt;GPU12_Attention -->
<g id="edge53" class="edge">
<title>GPU12_RMSNorm&#45;&gt;GPU12_Attention</title>
<path fill="none" stroke="black" d="M1642.55,-2906.27C1669.24,-2901.66 1697.68,-2896.74 1724.75,-2892.06"/>
<polygon fill="black" stroke="black" points="1725.39,-2895.5 1734.65,-2890.35 1724.2,-2888.61 1725.39,-2895.5"/>
</g>
<!-- GPU12_O_Proj_RP -->
<g id="node68" class="node">
<title>GPU12_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="2368.22,-2904.35 2105.22,-2904.35 2105.22,-2863.35 2368.22,-2863.35 2368.22,-2904.35"/>
<text text-anchor="middle" x="2236.72" y="-2892.35" font-family="Arial" font-size="10.00">GPU12: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-2881.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-2870.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU12_Attention&#45;&gt;GPU12_O_Proj_RP -->
<g id="edge54" class="edge">
<title>GPU12_Attention&#45;&gt;GPU12_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-2874.79C2023.56,-2876.04 2060.39,-2877.4 2094.89,-2878.67"/>
<polygon fill="black" stroke="black" points="2094.91,-2882.17 2105.03,-2879.04 2095.17,-2875.18 2094.91,-2882.17"/>
</g>
<!-- Attn_AllReduce_EP6 -->
<g id="node88" class="node">
<title>Attn_AllReduce_EP6</title>
<ellipse fill="#ff9999" stroke="black" cx="634.41" cy="-3034.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="634.41" y="-3048.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="634.41" y="-3037.85" font-family="Arial" font-size="10.00">EP Group 6 Attention</text>
<text text-anchor="middle" x="634.41" y="-3026.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="634.41" y="-3015.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU12_O_Proj_RP&#45;&gt;Attn_AllReduce_EP6 -->
<g id="edge73" class="edge">
<title>GPU12_O_Proj_RP&#45;&gt;Attn_AllReduce_EP6</title>
<path fill="none" stroke="black" d="M2168.82,-2904.38C2136.65,-2914.75 2097.73,-2928.06 2063.48,-2941.85 2047.07,-2948.46 2044.55,-2954.16 2027.48,-2958.85 1878.32,-2999.82 1826.76,-2940.05 1681,-2991.85 1662.88,-2998.29 1663.35,-3010.11 1645,-3015.85 1568.61,-3039.77 1087.29,-3039.23 817.75,-3036.96"/>
<polygon fill="black" stroke="black" points="817.48,-3033.45 807.45,-3036.87 817.42,-3040.45 817.48,-3033.45"/>
</g>
<!-- GPU13_Attention -->
<g id="node70" class="node">
<title>GPU13_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="1989.24,-2949.35 1719.24,-2949.35 1719.24,-2908.35 1989.24,-2908.35 1989.24,-2949.35"/>
<text text-anchor="middle" x="1854.24" y="-2937.35" font-family="Arial" font-size="10.00">GPU13: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-2926.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-2915.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU13_RMSNorm&#45;&gt;GPU13_Attention -->
<g id="edge55" class="edge">
<title>GPU13_RMSNorm&#45;&gt;GPU13_Attention</title>
<path fill="none" stroke="black" d="M1642.55,-2965.27C1669.24,-2960.66 1697.68,-2955.74 1724.75,-2951.06"/>
<polygon fill="black" stroke="black" points="1725.39,-2954.5 1734.65,-2949.35 1724.2,-2947.61 1725.39,-2954.5"/>
</g>
<!-- GPU13_O_Proj_RP -->
<g id="node71" class="node">
<title>GPU13_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="2368.22,-2991.35 2105.22,-2991.35 2105.22,-2950.35 2368.22,-2950.35 2368.22,-2991.35"/>
<text text-anchor="middle" x="2236.72" y="-2979.35" font-family="Arial" font-size="10.00">GPU13: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-2968.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-2957.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU13_Attention&#45;&gt;GPU13_O_Proj_RP -->
<g id="edge56" class="edge">
<title>GPU13_Attention&#45;&gt;GPU13_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-2943.66C2023.56,-2947.43 2060.39,-2951.5 2094.89,-2955.3"/>
<polygon fill="black" stroke="black" points="2094.71,-2958.81 2105.03,-2956.42 2095.48,-2951.85 2094.71,-2958.81"/>
</g>
<!-- GPU13_O_Proj_RP&#45;&gt;Attn_AllReduce_EP6 -->
<g id="edge74" class="edge">
<title>GPU13_O_Proj_RP&#45;&gt;Attn_AllReduce_EP6</title>
<path fill="none" stroke="black" d="M2105.18,-2984.14C1954.2,-2999.79 1721.14,-3024.91 1681,-3034.85 1664.34,-3038.98 1661.87,-3045.69 1645,-3048.85 1329.33,-3108.07 1243.43,-3056.68 922.34,-3048.85 886.68,-3047.98 848.55,-3046.51 812.11,-3044.83"/>
<polygon fill="black" stroke="black" points="812.03,-3041.32 801.88,-3044.35 811.71,-3048.31 812.03,-3041.32"/>
</g>
<!-- Expert_AllReduce_EP6 -->
<g id="node97" class="node">
<title>Expert_AllReduce_EP6</title>
<ellipse fill="#ff9999" stroke="black" cx="1854.24" cy="-2712.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1854.24" y="-2726.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1854.24" y="-2715.85" font-family="Arial" font-size="10.00">EP Group 6 Experts</text>
<text text-anchor="middle" x="1854.24" y="-2704.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1854.24" y="-2693.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU12_Expert00&#45;&gt;Expert_AllReduce_EP6 -->
<g id="edge153" class="edge">
<title>GPU12_Expert00&#45;&gt;Expert_AllReduce_EP6</title>
<path fill="none" stroke="black" d="M1632.61,-2835.7C1636.97,-2833.03 1641.13,-2830.09 1645,-2826.85 1672.75,-2803.64 1652.72,-2776.41 1681,-2753.85 1688.24,-2748.08 1696.15,-2743.1 1704.49,-2738.8"/>
<polygon fill="black" stroke="black" points="1706.18,-2741.88 1713.69,-2734.41 1703.16,-2735.56 1706.18,-2741.88"/>
</g>
<!-- GPU13_Expert00&#45;&gt;Expert_AllReduce_EP6 -->
<g id="edge154" class="edge">
<title>GPU13_Expert00&#45;&gt;Expert_AllReduce_EP6</title>
<path fill="none" stroke="black" d="M1631.09,-2765.85C1647.8,-2761.82 1664.86,-2757.72 1681,-2753.85 1696.23,-2750.2 1712.21,-2746.38 1728.05,-2742.61"/>
<polygon fill="black" stroke="black" points="1728.97,-2745.98 1737.88,-2740.26 1727.34,-2739.17 1728.97,-2745.98"/>
</g>
<!-- GPU14_Attention -->
<g id="node75" class="node">
<title>GPU14_Attention</title>
<polygon fill="#ffe6f3" stroke="black" points="1989.24,-2509.35 1719.24,-2509.35 1719.24,-2468.35 1989.24,-2468.35 1989.24,-2509.35"/>
<text text-anchor="middle" x="1854.24" y="-2497.35" font-family="Arial" font-size="10.00">GPU14: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-2486.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-2475.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU14_RMSNorm&#45;&gt;GPU14_Attention -->
<g id="edge57" class="edge">
<title>GPU14_RMSNorm&#45;&gt;GPU14_Attention</title>
<path fill="none" stroke="black" d="M1620.21,-2538.32C1659.88,-2529.9 1705.95,-2520.12 1746.6,-2511.49"/>
<polygon fill="black" stroke="black" points="1747.48,-2514.88 1756.54,-2509.38 1746.03,-2508.03 1747.48,-2514.88"/>
</g>
<!-- GPU14_O_Proj_RP -->
<g id="node76" class="node">
<title>GPU14_O_Proj_RP</title>
<polygon fill="#ffe6f3" stroke="black" points="2368.22,-2474.35 2105.22,-2474.35 2105.22,-2433.35 2368.22,-2433.35 2368.22,-2474.35"/>
<text text-anchor="middle" x="2236.72" y="-2462.35" font-family="Arial" font-size="10.00">GPU14: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-2451.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-2440.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU14_Attention&#45;&gt;GPU14_O_Proj_RP -->
<g id="edge58" class="edge">
<title>GPU14_Attention&#45;&gt;GPU14_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-2476.51C2023.56,-2473.37 2060.39,-2469.98 2094.89,-2466.81"/>
<polygon fill="black" stroke="black" points="2095.39,-2470.27 2105.03,-2465.87 2094.75,-2463.3 2095.39,-2470.27"/>
</g>
<!-- Attn_AllReduce_EP7 -->
<g id="node89" class="node">
<title>Attn_AllReduce_EP7</title>
<ellipse fill="#ff9999" stroke="black" cx="634.41" cy="-2241.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="634.41" y="-2255.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="634.41" y="-2244.85" font-family="Arial" font-size="10.00">EP Group 7 Attention</text>
<text text-anchor="middle" x="634.41" y="-2233.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="634.41" y="-2222.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU14_O_Proj_RP&#45;&gt;Attn_AllReduce_EP7 -->
<g id="edge75" class="edge">
<title>GPU14_O_Proj_RP&#45;&gt;Attn_AllReduce_EP7</title>
<path fill="none" stroke="black" d="M2209.73,-2433.26C2175.2,-2405.53 2112.83,-2354.07 2063.48,-2305.85 2046.38,-2289.13 2049.25,-2275.77 2027.48,-2265.85 1920.26,-2216.98 1168.68,-2228.64 816.6,-2236.97"/>
<polygon fill="black" stroke="black" points="816.47,-2233.47 806.55,-2237.21 816.63,-2240.47 816.47,-2233.47"/>
</g>
<!-- GPU15_Attention -->
<g id="node78" class="node">
<title>GPU15_Attention</title>
<polygon fill="#ffe6f3" stroke="black" points="1989.24,-2603.35 1719.24,-2603.35 1719.24,-2562.35 1989.24,-2562.35 1989.24,-2603.35"/>
<text text-anchor="middle" x="1854.24" y="-2591.35" font-family="Arial" font-size="10.00">GPU15: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1854.24" y="-2580.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1854.24" y="-2569.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU15_RMSNorm&#45;&gt;GPU15_Attention -->
<g id="edge59" class="edge">
<title>GPU15_RMSNorm&#45;&gt;GPU15_Attention</title>
<path fill="none" stroke="black" d="M1645.35,-2604.92C1666.1,-2602.72 1687.82,-2600.41 1709.08,-2598.15"/>
<polygon fill="black" stroke="black" points="1709.56,-2601.62 1719.14,-2597.09 1708.82,-2594.66 1709.56,-2601.62"/>
</g>
<!-- GPU15_O_Proj_RP -->
<g id="node79" class="node">
<title>GPU15_O_Proj_RP</title>
<polygon fill="#ffe6f3" stroke="black" points="2368.22,-2568.35 2105.22,-2568.35 2105.22,-2527.35 2368.22,-2527.35 2368.22,-2568.35"/>
<text text-anchor="middle" x="2236.72" y="-2556.35" font-family="Arial" font-size="10.00">GPU15: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2236.72" y="-2545.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2236.72" y="-2534.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU15_Attention&#45;&gt;GPU15_O_Proj_RP -->
<g id="edge60" class="edge">
<title>GPU15_Attention&#45;&gt;GPU15_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1989.39,-2570.51C2023.56,-2567.37 2060.39,-2563.98 2094.89,-2560.81"/>
<polygon fill="black" stroke="black" points="2095.39,-2564.27 2105.03,-2559.87 2094.75,-2557.3 2095.39,-2564.27"/>
</g>
<!-- GPU15_O_Proj_RP&#45;&gt;Attn_AllReduce_EP7 -->
<g id="edge76" class="edge">
<title>GPU15_O_Proj_RP&#45;&gt;Attn_AllReduce_EP7</title>
<path fill="none" stroke="black" d="M2129.53,-2527.33C2104.74,-2517.87 2080.61,-2504.04 2063.48,-2483.85 2009.29,-2419.98 2091.02,-2353.44 2027.48,-2298.85 2004.83,-2279.39 1188.49,-2256.03 816.65,-2246.37"/>
<polygon fill="black" stroke="black" points="816.68,-2242.87 806.6,-2246.11 816.5,-2249.87 816.68,-2242.87"/>
</g>
<!-- Expert_AllReduce_EP7 -->
<g id="node98" class="node">
<title>Expert_AllReduce_EP7</title>
<ellipse fill="#ff9999" stroke="black" cx="1854.24" cy="-2344.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1854.24" y="-2358.85" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1854.24" y="-2347.85" font-family="Arial" font-size="10.00">EP Group 7 Experts</text>
<text text-anchor="middle" x="1854.24" y="-2336.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1854.24" y="-2325.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU14_Expert00&#45;&gt;Expert_AllReduce_EP7 -->
<g id="edge155" class="edge">
<title>GPU14_Expert00&#45;&gt;Expert_AllReduce_EP7</title>
<path fill="none" stroke="black" d="M1632.61,-2467.7C1636.97,-2465.03 1641.13,-2462.09 1645,-2458.85 1672.75,-2435.64 1652.72,-2408.41 1681,-2385.85 1688.24,-2380.08 1696.15,-2375.1 1704.49,-2370.8"/>
<polygon fill="black" stroke="black" points="1706.18,-2373.88 1713.69,-2366.41 1703.16,-2367.56 1706.18,-2373.88"/>
</g>
<!-- GPU15_Expert00&#45;&gt;Expert_AllReduce_EP7 -->
<g id="edge156" class="edge">
<title>GPU15_Expert00&#45;&gt;Expert_AllReduce_EP7</title>
<path fill="none" stroke="black" d="M1631.09,-2397.85C1647.8,-2393.82 1664.86,-2389.72 1681,-2385.85 1696.23,-2382.2 1712.21,-2378.38 1728.05,-2374.61"/>
<polygon fill="black" stroke="black" points="1728.97,-2377.98 1737.88,-2372.26 1727.34,-2371.17 1728.97,-2377.98"/>
</g>
<!-- Global_Attn_AllReduce -->
<g id="node90" class="node">
<title>Global_Attn_AllReduce</title>
<ellipse fill="#ff6666" stroke="black" cx="1143.17" cy="-1708.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1143.17" y="-1722.85" font-family="Arial" font-size="10.00">Global All&#45;Reduce</text>
<text text-anchor="middle" x="1143.17" y="-1711.85" font-family="Arial" font-size="10.00">All EP Groups</text>
<text text-anchor="middle" x="1143.17" y="-1700.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1143.17" y="-1689.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Attn_AllReduce_EP0&#45;&gt;Global_Attn_AllReduce -->
<g id="edge77" class="edge">
<title>Attn_AllReduce_EP0&#45;&gt;Global_Attn_AllReduce</title>
<path fill="none" stroke="black" d="M807.8,-85.9C837.94,-93.94 866.07,-108.1 886.34,-131.85 941.58,-196.57 867.93,-1597.45 922.34,-1662.85 934.23,-1677.14 949.32,-1687.7 966,-1695.43"/>
<polygon fill="black" stroke="black" points="964.84,-1698.74 975.41,-1699.44 967.58,-1692.3 964.84,-1698.74"/>
</g>
<!-- Attn_AllReduce_EP1&#45;&gt;Global_Attn_AllReduce -->
<g id="edge78" class="edge">
<title>Attn_AllReduce_EP1&#45;&gt;Global_Attn_AllReduce</title>
<path fill="none" stroke="black" d="M642.44,-574.84C678.02,-760.37 839.72,-1583.74 922.34,-1662.85 936.07,-1676 952.55,-1685.8 970.22,-1693.07"/>
<polygon fill="black" stroke="black" points="968.97,-1696.34 979.56,-1696.64 971.47,-1689.8 968.97,-1696.34"/>
</g>
<!-- Attn_AllReduce_EP2&#45;&gt;Global_Attn_AllReduce -->
<g id="edge79" class="edge">
<title>Attn_AllReduce_EP2&#45;&gt;Global_Attn_AllReduce</title>
<path fill="none" stroke="black" d="M769.55,-1772.82C839.85,-1760.75 926,-1745.96 997.76,-1733.64"/>
<polygon fill="black" stroke="black" points="998.52,-1737.06 1007.78,-1731.92 997.34,-1730.17 998.52,-1737.06"/>
</g>
<!-- Attn_AllReduce_EP3&#45;&gt;Global_Attn_AllReduce -->
<g id="edge80" class="edge">
<title>Attn_AllReduce_EP3&#45;&gt;Global_Attn_AllReduce</title>
<path fill="none" stroke="black" d="M677.66,-213.72C737.13,-267.22 843.1,-374.29 886.34,-491.85 908.81,-552.94 880.53,-1612.97 922.34,-1662.85 934.29,-1677.1 949.4,-1687.63 966.1,-1695.34"/>
<polygon fill="black" stroke="black" points="964.95,-1698.66 975.53,-1699.34 967.69,-1692.22 964.95,-1698.66"/>
</g>
<!-- Attn_AllReduce_EP4&#45;&gt;Global_Attn_AllReduce -->
<g id="edge81" class="edge">
<title>Attn_AllReduce_EP4&#45;&gt;Global_Attn_AllReduce</title>
<path fill="none" stroke="black" d="M667.46,-3791.68C722.26,-3727.6 833.19,-3587.78 886.34,-3448.85 1129.78,-2812.57 1143.21,-1963.66 1142.64,-1756.1"/>
<polygon fill="black" stroke="black" points="1146.14,-1755.84 1142.6,-1745.86 1139.14,-1755.87 1146.14,-1755.84"/>
</g>
<!-- Attn_AllReduce_EP5&#45;&gt;Global_Attn_AllReduce -->
<g id="edge82" class="edge">
<title>Attn_AllReduce_EP5&#45;&gt;Global_Attn_AllReduce</title>
<path fill="none" stroke="black" d="M673.38,-3366.71C729.47,-3310.97 833.52,-3198.14 886.34,-3080.85 1104.38,-2596.72 1136.59,-1936.11 1141.35,-1755.89"/>
<polygon fill="black" stroke="black" points="1144.85,-1755.78 1141.6,-1745.7 1137.86,-1755.61 1144.85,-1755.78"/>
</g>
<!-- Attn_AllReduce_EP6&#45;&gt;Global_Attn_AllReduce -->
<g id="edge83" class="edge">
<title>Attn_AllReduce_EP6&#45;&gt;Global_Attn_AllReduce</title>
<path fill="none" stroke="black" d="M649.5,-2998C721.17,-2810.45 1045.16,-1962.7 1124.56,-1754.93"/>
<polygon fill="black" stroke="black" points="1127.86,-1756.11 1128.16,-1745.52 1121.32,-1753.61 1127.86,-1756.11"/>
</g>
<!-- Attn_AllReduce_EP7&#45;&gt;Global_Attn_AllReduce -->
<g id="edge84" class="edge">
<title>Attn_AllReduce_EP7&#45;&gt;Global_Attn_AllReduce</title>
<path fill="none" stroke="black" d="M669.85,-2205.63C760.04,-2110.77 1002.94,-1855.3 1100.63,-1752.54"/>
<polygon fill="black" stroke="black" points="1103.34,-1754.78 1107.69,-1745.12 1098.27,-1749.95 1103.34,-1754.78"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU0_Expert00 -->
<g id="edge85" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU0_Expert00</title>
<path fill="none" stroke="black" d="M1308.91,-1698C1329.67,-1690.26 1348.88,-1679.01 1364,-1662.85 1425.02,-1597.63 1332.89,-1530.8 1392,-1463.85 1393.04,-1462.68 1394.11,-1461.54 1395.21,-1460.44"/>
<polygon fill="black" stroke="black" points="1397.7,-1462.92 1402.93,-1453.7 1393.1,-1457.64 1397.7,-1462.92"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU0_Expert01 -->
<g id="edge86" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU0_Expert01</title>
<path fill="none" stroke="black" d="M1309.44,-1698.49C1330.12,-1690.68 1349.18,-1679.28 1364,-1662.85 1444.53,-1573.61 1314.08,-1485.38 1392,-1393.85 1393.02,-1392.66 1394.07,-1391.51 1395.15,-1390.39"/>
<polygon fill="black" stroke="black" points="1397.66,-1392.84 1402.76,-1383.55 1392.98,-1387.63 1397.66,-1392.84"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU0_Expert02 -->
<g id="edge87" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU0_Expert02</title>
<path fill="none" stroke="black" d="M1310.03,-1698.67C1330.56,-1690.83 1349.42,-1679.36 1364,-1662.85 1414.04,-1606.2 1343.62,-1381.93 1392,-1323.85 1393.03,-1322.62 1394.09,-1321.43 1395.19,-1320.28"/>
<polygon fill="black" stroke="black" points="1397.88,-1322.57 1402.93,-1313.25 1393.17,-1317.39 1397.88,-1322.57"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU0_Expert03 -->
<g id="edge88" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU0_Expert03</title>
<path fill="none" stroke="black" d="M1310.25,-1698.85C1330.74,-1690.99 1349.53,-1679.47 1364,-1662.85 1423.83,-1594.15 1334.18,-1324.25 1392,-1253.85 1393.02,-1252.61 1394.07,-1251.42 1395.16,-1250.26"/>
<polygon fill="black" stroke="black" points="1397.86,-1252.54 1402.86,-1243.2 1393.12,-1247.38 1397.86,-1252.54"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU1_Expert00 -->
<g id="edge89" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU1_Expert00</title>
<path fill="none" stroke="black" d="M1316.55,-1708.85C1342.24,-1708.85 1368.33,-1708.85 1392.91,-1708.85"/>
<polygon fill="black" stroke="black" points="1392.98,-1712.35 1402.98,-1708.85 1392.98,-1705.35 1392.98,-1712.35"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU1_Expert01 -->
<g id="edge90" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU1_Expert01</title>
<path fill="none" stroke="black" d="M1274.29,-1684.71C1312.63,-1677.6 1354.55,-1669.82 1392.81,-1662.73"/>
<polygon fill="black" stroke="black" points="1393.77,-1666.11 1402.97,-1660.84 1392.5,-1659.22 1393.77,-1666.11"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU1_Expert02 -->
<g id="edge91" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU1_Expert02</title>
<path fill="none" stroke="black" d="M1302.53,-1694.25C1324.69,-1687.11 1346,-1677.02 1364,-1662.85 1386.81,-1644.9 1369.72,-1622.46 1392,-1603.85 1393.35,-1602.72 1394.74,-1601.63 1396.15,-1600.57"/>
<polygon fill="black" stroke="black" points="1398.24,-1603.39 1404.56,-1594.89 1394.32,-1597.59 1398.24,-1603.39"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU1_Expert03 -->
<g id="edge92" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU1_Expert03</title>
<path fill="none" stroke="black" d="M1307.56,-1697.06C1328.58,-1689.47 1348.23,-1678.51 1364,-1662.85 1405.64,-1621.52 1351.57,-1576.36 1392,-1533.85 1393.05,-1532.74 1394.14,-1531.67 1395.25,-1530.63"/>
<polygon fill="black" stroke="black" points="1397.52,-1533.3 1402.99,-1524.22 1393.06,-1527.9 1397.52,-1533.3"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU2_Expert00 -->
<g id="edge93" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU2_Expert00</title>
<path fill="none" stroke="black" d="M1310.78,-1699.31C1331.21,-1691.38 1349.83,-1679.72 1364,-1662.85 1424.57,-1590.76 1333.53,-889.66 1392,-815.85 1393.12,-814.44 1394.29,-813.08 1395.5,-811.77"/>
<polygon fill="black" stroke="black" points="1398.02,-814.21 1402.95,-804.84 1393.25,-809.09 1398.02,-814.21"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU2_Expert01 -->
<g id="edge94" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU2_Expert01</title>
<path fill="none" stroke="black" d="M1310.82,-1699.35C1331.24,-1691.41 1349.85,-1679.74 1364,-1662.85 1429.48,-1584.72 1328.81,-825.83 1392,-745.85 1393.12,-744.44 1394.29,-743.08 1395.5,-741.77"/>
<polygon fill="black" stroke="black" points="1398.01,-744.21 1402.93,-734.83 1393.24,-739.09 1398.01,-744.21"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU3_Expert00 -->
<g id="edge95" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU3_Expert00</title>
<path fill="none" stroke="black" d="M1310.58,-1699.14C1331.03,-1691.23 1349.72,-1679.62 1364,-1662.85 1407.35,-1611.96 1366.29,-1123.56 1392,-1061.85 1410.25,-1018.06 1448.41,-979.26 1478.6,-953.51"/>
<polygon fill="black" stroke="black" points="1481.06,-956.02 1486.49,-946.92 1476.57,-950.65 1481.06,-956.02"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU3_Expert01 -->
<g id="edge96" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU3_Expert01</title>
<path fill="none" stroke="black" d="M1310.74,-1699.28C1331.17,-1691.35 1349.8,-1679.7 1364,-1662.85 1419.67,-1596.79 1338.26,-953.49 1392,-885.85 1393.12,-884.44 1394.29,-883.08 1395.51,-881.78"/>
<polygon fill="black" stroke="black" points="1398.02,-884.22 1402.96,-874.85 1393.26,-879.09 1398.02,-884.22"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU4_Expert00 -->
<g id="edge97" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU4_Expert00</title>
<path fill="none" stroke="black" d="M1176.14,-1745.15C1220.11,-1792.85 1303.89,-1876.06 1392,-1922.85 1395.28,-1924.59 1398.65,-1926.25 1402.09,-1927.83"/>
<polygon fill="black" stroke="black" points="1400.78,-1931.08 1411.35,-1931.84 1403.56,-1924.66 1400.78,-1931.08"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU5_Expert00 -->
<g id="edge98" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU5_Expert00</title>
<path fill="none" stroke="black" d="M1215.15,-1742.52C1284.77,-1775.55 1390.01,-1825.47 1457.24,-1857.36"/>
<polygon fill="black" stroke="black" points="1455.93,-1860.62 1466.46,-1861.74 1458.93,-1854.29 1455.93,-1860.62"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU6_Expert00 -->
<g id="edge99" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU6_Expert00</title>
<path fill="none" stroke="black" d="M1310.9,-1699.41C1331.31,-1691.47 1349.9,-1679.77 1364,-1662.85 1403.46,-1615.51 1368.91,-610.99 1392,-553.85 1409.72,-510.01 1447.75,-471.34 1478.03,-445.64"/>
<polygon fill="black" stroke="black" points="1480.49,-448.15 1485.95,-439.07 1476.02,-442.77 1480.49,-448.15"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU7_Expert00 -->
<g id="edge100" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU7_Expert00</title>
<path fill="none" stroke="black" d="M1310.96,-1699.46C1331.35,-1691.5 1349.92,-1679.8 1364,-1662.85 1409.63,-1607.92 1347.98,-434.07 1392,-377.85 1393.11,-376.43 1394.27,-375.07 1395.48,-373.76"/>
<polygon fill="black" stroke="black" points="1398,-376.19 1402.89,-366.79 1393.21,-371.09 1398,-376.19"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU8_Expert00 -->
<g id="edge101" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU8_Expert00</title>
<path fill="none" stroke="black" d="M1146.52,-1745.9C1162.92,-1999.43 1263.33,-3472.52 1392,-3619.85 1393.03,-3621.03 1394.09,-3622.17 1395.19,-3623.27"/>
<polygon fill="black" stroke="black" points="1393.06,-3626.06 1402.88,-3630.04 1397.69,-3620.81 1393.06,-3626.06"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU9_Expert00 -->
<g id="edge102" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU9_Expert00</title>
<path fill="none" stroke="black" d="M1147.13,-1745.89C1164.97,-1964.68 1261.81,-3089.53 1392,-3407.85 1414.69,-3463.32 1458.42,-3517.48 1488.75,-3550.98"/>
<polygon fill="black" stroke="black" points="1486.43,-3553.63 1495.77,-3558.63 1491.59,-3548.9 1486.43,-3553.63"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU10_Expert00 -->
<g id="edge103" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU10_Expert00</title>
<path fill="none" stroke="black" d="M1147.94,-1745.75C1170.54,-1964.26 1290.65,-3082.97 1392,-3194.85 1393.03,-3195.98 1394.09,-3197.08 1395.17,-3198.15"/>
<polygon fill="black" stroke="black" points="1392.91,-3200.81 1402.77,-3204.68 1397.48,-3195.51 1392.91,-3200.81"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU11_Expert00 -->
<g id="edge104" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU11_Expert00</title>
<path fill="none" stroke="black" d="M1147.87,-1745.65C1167.44,-1935.62 1262.86,-2805.57 1392,-3039.85 1411.53,-3075.28 1445.34,-3106.07 1473.52,-3127.59"/>
<polygon fill="black" stroke="black" points="1471.57,-3130.5 1481.68,-3133.69 1475.76,-3124.9 1471.57,-3130.5"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU12_Expert00 -->
<g id="edge105" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU12_Expert00</title>
<path fill="none" stroke="black" d="M1153.88,-1745.72C1186.69,-1871.2 1295.21,-2293.46 1364,-2646.85 1371.74,-2686.59 1364.99,-2796.7 1392,-2826.85 1393.05,-2828.02 1394.12,-2829.14 1395.23,-2830.24"/>
<polygon fill="black" stroke="black" points="1393.14,-2833.05 1403,-2836.94 1397.71,-2827.75 1393.14,-2833.05"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU13_Expert00 -->
<g id="edge106" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU13_Expert00</title>
<path fill="none" stroke="black" d="M1146.25,-1745.76C1155.27,-1879.72 1199.7,-2349.35 1392,-2671.85 1412.86,-2706.83 1446.96,-2737.83 1474.93,-2759.56"/>
<polygon fill="black" stroke="black" points="1472.94,-2762.44 1483.01,-2765.71 1477.18,-2756.87 1472.94,-2762.44"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU14_Expert00 -->
<g id="edge107" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU14_Expert00</title>
<path fill="none" stroke="black" d="M1154.11,-1745.61C1193.24,-1889.2 1337.16,-2406.95 1392,-2458.85 1392.98,-2459.77 1393.97,-2460.67 1394.99,-2461.55"/>
<polygon fill="black" stroke="black" points="1393.1,-2464.51 1403.16,-2467.82 1397.36,-2458.96 1393.1,-2464.51"/>
</g>
<!-- Global_Attn_AllReduce&#45;&gt;GPU15_Expert00 -->
<g id="edge108" class="edge">
<title>Global_Attn_AllReduce&#45;&gt;GPU15_Expert00</title>
<path fill="none" stroke="black" d="M1163.67,-1745.79C1228.89,-1869.39 1439.02,-2267.56 1502.9,-2388.61"/>
<polygon fill="black" stroke="black" points="1499.83,-2390.29 1507.59,-2397.5 1506.02,-2387.02 1499.83,-2390.29"/>
</g>
<!-- Global_Expert_AllReduce -->
<g id="node99" class="node">
<title>Global_Expert_AllReduce</title>
<ellipse fill="#ff6666" stroke="black" cx="2236.72" cy="-2259.85" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="2236.72" y="-2273.85" font-family="Arial" font-size="10.00">Global All&#45;Reduce</text>
<text text-anchor="middle" x="2236.72" y="-2262.85" font-family="Arial" font-size="10.00">All Expert Outputs</text>
<text text-anchor="middle" x="2236.72" y="-2251.85" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="2236.72" y="-2240.85" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Expert_AllReduce_EP0&#45;&gt;Global_Expert_AllReduce -->
<g id="edge157" class="edge">
<title>Expert_AllReduce_EP0&#45;&gt;Global_Expert_AllReduce</title>
<path fill="none" stroke="black" d="M2000.66,-1828.72C2010.65,-1834.32 2019.79,-1841.27 2027.48,-1849.85 2113.03,-1945.22 1998.05,-2025.71 2063.48,-2135.85 2084.9,-2171.91 2121.33,-2200.42 2155.18,-2220.96"/>
<polygon fill="black" stroke="black" points="2153.79,-2224.2 2164.18,-2226.28 2157.35,-2218.18 2153.79,-2224.2"/>
</g>
<!-- Expert_AllReduce_EP1&#45;&gt;Global_Expert_AllReduce -->
<g id="edge158" class="edge">
<title>Expert_AllReduce_EP1&#45;&gt;Global_Expert_AllReduce</title>
<path fill="none" stroke="black" d="M2001.93,-1040.2C2011.57,-1045.93 2020.29,-1053.05 2027.48,-1061.85 2103.05,-1154.29 2007.27,-2030.51 2063.48,-2135.85 2083.07,-2172.56 2118.88,-2201 2152.8,-2221.34"/>
<polygon fill="black" stroke="black" points="2151.43,-2224.59 2161.84,-2226.6 2154.95,-2218.54 2151.43,-2224.59"/>
</g>
<!-- Expert_AllReduce_EP2&#45;&gt;Global_Expert_AllReduce -->
<g id="edge159" class="edge">
<title>Expert_AllReduce_EP2&#45;&gt;Global_Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1975.63,-2203.11C2016.85,-2212.1 2063.15,-2222.2 2105.13,-2231.36"/>
<polygon fill="black" stroke="black" points="2104.63,-2234.83 2115.14,-2233.55 2106.12,-2228 2104.63,-2234.83"/>
</g>
<!-- Expert_AllReduce_EP3&#45;&gt;Global_Expert_AllReduce -->
<g id="edge160" class="edge">
<title>Expert_AllReduce_EP3&#45;&gt;Global_Expert_AllReduce</title>
<path fill="none" stroke="black" d="M2002.03,-532.11C2011.65,-537.86 2020.33,-545.01 2027.48,-553.85 2082.76,-622.21 2022.51,-2058.07 2063.48,-2135.85 2082.87,-2172.66 2118.66,-2201.12 2152.62,-2221.44"/>
<polygon fill="black" stroke="black" points="2151.26,-2224.7 2161.66,-2226.69 2154.77,-2218.64 2151.26,-2224.7"/>
</g>
<!-- Expert_AllReduce_EP4&#45;&gt;Global_Expert_AllReduce -->
<g id="edge161" class="edge">
<title>Expert_AllReduce_EP4&#45;&gt;Global_Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1947.51,-3474.72C1978.28,-3459.53 2009.31,-3437.87 2027.48,-3407.85 2086.33,-3310.65 2010.29,-2486.26 2063.48,-2385.85 2083.39,-2348.28 2120.07,-2319.07 2154.48,-2298.27"/>
<polygon fill="black" stroke="black" points="2156.32,-2301.25 2163.17,-2293.17 2152.77,-2295.22 2156.32,-2301.25"/>
</g>
<!-- Expert_AllReduce_EP5&#45;&gt;Global_Expert_AllReduce -->
<g id="edge162" class="edge">
<title>Expert_AllReduce_EP5&#45;&gt;Global_Expert_AllReduce</title>
<path fill="none" stroke="black" d="M2001.72,-3061.33C2011.41,-3055.64 2020.19,-3048.58 2027.48,-3039.85 2120.81,-2928.16 1994.07,-2513.79 2063.48,-2385.85 2083.76,-2348.47 2120.48,-2319.29 2154.82,-2298.46"/>
<polygon fill="black" stroke="black" points="2156.65,-2301.44 2163.49,-2293.34 2153.09,-2295.41 2156.65,-2301.44"/>
</g>
<!-- Expert_AllReduce_EP6&#45;&gt;Global_Expert_AllReduce -->
<g id="edge163" class="edge">
<title>Expert_AllReduce_EP6&#45;&gt;Global_Expert_AllReduce</title>
<path fill="none" stroke="black" d="M2000.66,-2692.99C2010.65,-2687.38 2019.79,-2680.43 2027.48,-2671.85 2113.03,-2576.48 1998.47,-2496.25 2063.48,-2385.85 2085.24,-2348.91 2122.51,-2319.63 2156.83,-2298.62"/>
<polygon fill="black" stroke="black" points="2158.68,-2301.59 2165.48,-2293.46 2155.09,-2295.58 2158.68,-2301.59"/>
</g>
<!-- Expert_AllReduce_EP7&#45;&gt;Global_Expert_AllReduce -->
<g id="edge164" class="edge">
<title>Expert_AllReduce_EP7&#45;&gt;Global_Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1974.32,-2318.25C2016.39,-2308.85 2063.88,-2298.24 2106.73,-2288.67"/>
<polygon fill="black" stroke="black" points="2107.65,-2292.05 2116.65,-2286.45 2106.13,-2285.22 2107.65,-2292.05"/>
</g>
<!-- Final_RMSNorm -->
<g id="node100" class="node">
<title>Final_RMSNorm</title>
<polygon fill="#ff99ff" stroke="black" points="2699.97,-2280.35 2454.97,-2280.35 2454.97,-2239.35 2699.97,-2239.35 2699.97,-2280.35"/>
<text text-anchor="middle" x="2577.47" y="-2268.35" font-family="Arial" font-size="10.00">Final RMSNorm</text>
<text text-anchor="middle" x="2577.47" y="-2257.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="2577.47" y="-2246.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Global_Expert_AllReduce&#45;&gt;Final_RMSNorm -->
<g id="edge165" class="edge">
<title>Global_Expert_AllReduce&#45;&gt;Final_RMSNorm</title>
<path fill="none" stroke="black" d="M2410.07,-2259.85C2421.58,-2259.85 2433.08,-2259.85 2444.34,-2259.85"/>
<polygon fill="black" stroke="black" points="2444.61,-2263.35 2454.61,-2259.85 2444.61,-2256.35 2444.61,-2263.35"/>
</g>
<!-- Output_Proj -->
<g id="node101" class="node">
<title>Output_Proj</title>
<polygon fill="#ff99ff" stroke="black" points="2983.97,-2280.35 2744.97,-2280.35 2744.97,-2239.35 2983.97,-2239.35 2983.97,-2280.35"/>
<text text-anchor="middle" x="2864.47" y="-2268.35" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2864.47" y="-2257.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="2864.47" y="-2246.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, vocab_size]</text>
</g>
<!-- Final_RMSNorm&#45;&gt;Output_Proj -->
<g id="edge166" class="edge">
<title>Final_RMSNorm&#45;&gt;Output_Proj</title>
<path fill="none" stroke="black" d="M2700.16,-2259.85C2711.63,-2259.85 2723.28,-2259.85 2734.81,-2259.85"/>
<polygon fill="black" stroke="black" points="2734.9,-2263.35 2744.9,-2259.85 2734.9,-2256.35 2734.9,-2263.35"/>
</g>
<!-- Output -->
<g id="node102" class="node">
<title>Output</title>
<ellipse fill="#ff99ff" stroke="black" cx="3188.96" cy="-2259.85" rx="169" ry="28.98"/>
<text text-anchor="middle" x="3188.96" y="-2268.35" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="3188.96" y="-2257.35" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, vocab_size]</text>
<text text-anchor="middle" x="3188.96" y="-2246.35" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, vocab_size]</text>
</g>
<!-- Output_Proj&#45;&gt;Output -->
<g id="edge167" class="edge">
<title>Output_Proj&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M2984.18,-2259.85C2992.57,-2259.85 3001.13,-2259.85 3009.75,-2259.85"/>
<polygon fill="black" stroke="black" points="3009.89,-2263.35 3019.89,-2259.85 3009.89,-2256.35 3009.89,-2263.35"/>
</g>
</g>
</svg>
