<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: LLM_Deployment Pages: 1 -->
<svg width="2907pt" height="826pt"
 viewBox="0.00 0.00 2906.87 825.76" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 821.76)">
<title>LLM_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-821.76 2902.87,-821.76 2902.87,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ep0</title>
<polygon fill="#e6f3ff" stroke="black" points="1284.39,-81.77 1284.39,-779.77 2532.87,-779.77 2532.87,-81.77 1284.39,-81.77"/>
<text text-anchor="middle" x="1908.63" y="-766.17" font-family="Arial" font-size="12.00">EP Group 0 (GPUs 0&#45;1) &#45; 128 experts total, 64 per GPU</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="#9999ff" stroke="black" cx="1083.14" cy="-695.77" rx="173.48" ry="28.98"/>
<text text-anchor="middle" x="1083.14" y="-704.27" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="1083.14" y="-693.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1083.14" y="-682.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU0_RMSNorm -->
<g id="node2" class="node">
<title>GPU0_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1537.39,-750.27 1292.39,-750.27 1292.39,-709.27 1537.39,-709.27 1537.39,-750.27"/>
<text text-anchor="middle" x="1414.89" y="-738.27" font-family="Arial" font-size="10.00">GPU0: RMSNorm</text>
<text text-anchor="middle" x="1414.89" y="-727.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-716.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU0_RMSNorm -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;GPU0_RMSNorm</title>
<path fill="none" stroke="black" d="M1231.17,-710.93C1248.1,-712.68 1265.28,-714.45 1281.98,-716.17"/>
<polygon fill="black" stroke="black" points="1282.01,-719.69 1292.32,-717.23 1282.73,-712.73 1282.01,-719.69"/>
</g>
<!-- GPU1_RMSNorm -->
<g id="node8" class="node">
<title>GPU1_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1537.39,-691.27 1292.39,-691.27 1292.39,-650.27 1537.39,-650.27 1537.39,-691.27"/>
<text text-anchor="middle" x="1414.89" y="-679.27" font-family="Arial" font-size="10.00">GPU1: RMSNorm</text>
<text text-anchor="middle" x="1414.89" y="-668.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-657.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU1_RMSNorm -->
<g id="edge2" class="edge">
<title>Input&#45;&gt;GPU1_RMSNorm</title>
<path fill="none" stroke="black" d="M1241.29,-683.86C1254.9,-682.82 1268.59,-681.79 1281.97,-680.77"/>
<polygon fill="black" stroke="black" points="1282.43,-684.25 1292.14,-680 1281.91,-677.27 1282.43,-684.25"/>
</g>
<!-- GPU0_Q_Proj_CP -->
<g id="node3" class="node">
<title>GPU0_Q_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1881.63,-632.27 1611.63,-632.27 1611.63,-591.27 1881.63,-591.27 1881.63,-632.27"/>
<text text-anchor="middle" x="1746.63" y="-620.27" font-family="Arial" font-size="10.00">GPU0: Q&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1746.63" y="-609.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1746.63" y="-598.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_Q_Proj_CP -->
<g id="edge3" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_Q_Proj_CP</title>
<path fill="none" stroke="black" d="M1523.72,-709.18C1528.5,-706.69 1533.09,-703.89 1537.39,-700.77 1562.23,-682.71 1547.99,-659.06 1573.39,-641.77 1582.13,-635.82 1591.69,-630.93 1601.68,-626.92"/>
<polygon fill="black" stroke="black" points="1603.2,-630.09 1611.37,-623.35 1600.78,-623.52 1603.2,-630.09"/>
</g>
<!-- GPU0_K_Proj_CP -->
<g id="node4" class="node">
<title>GPU0_K_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1881.63,-691.27 1611.63,-691.27 1611.63,-650.27 1881.63,-650.27 1881.63,-691.27"/>
<text text-anchor="middle" x="1746.63" y="-679.27" font-family="Arial" font-size="10.00">GPU0: K&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1746.63" y="-668.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1746.63" y="-657.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_K_Proj_CP -->
<g id="edge4" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_K_Proj_CP</title>
<path fill="none" stroke="black" d="M1526.86,-709.2C1542.48,-706.34 1558.33,-703.47 1573.39,-700.77 1587.47,-698.25 1602.2,-695.64 1616.87,-693.06"/>
<polygon fill="black" stroke="black" points="1617.76,-696.45 1627,-691.28 1616.55,-689.56 1617.76,-696.45"/>
</g>
<!-- GPU0_V_Proj_CP -->
<g id="node5" class="node">
<title>GPU0_V_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1881.63,-750.27 1611.63,-750.27 1611.63,-709.27 1881.63,-709.27 1881.63,-750.27"/>
<text text-anchor="middle" x="1746.63" y="-738.27" font-family="Arial" font-size="10.00">GPU0: V&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1746.63" y="-727.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1746.63" y="-716.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_V_Proj_CP -->
<g id="edge5" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_V_Proj_CP</title>
<path fill="none" stroke="black" d="M1537.73,-729.77C1558.48,-729.77 1580.2,-729.77 1601.46,-729.77"/>
<polygon fill="black" stroke="black" points="1601.52,-733.27 1611.52,-729.77 1601.52,-726.27 1601.52,-733.27"/>
</g>
<!-- GPU0_Attention -->
<g id="node6" class="node">
<title>GPU0_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="2225.87,-706.27 1955.87,-706.27 1955.87,-665.27 2225.87,-665.27 2225.87,-706.27"/>
<text text-anchor="middle" x="2090.87" y="-694.27" font-family="Arial" font-size="10.00">GPU0: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="2090.87" y="-683.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2090.87" y="-672.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_Q_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge9" class="edge">
<title>GPU0_Q_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1872.51,-632.29C1888.49,-635.28 1904.59,-638.47 1919.87,-641.77 1948,-647.85 1978.5,-655.43 2005.8,-662.58"/>
<polygon fill="black" stroke="black" points="2005.14,-666.02 2015.7,-665.18 2006.92,-659.25 2005.14,-666.02"/>
</g>
<!-- GPU0_K_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge10" class="edge">
<title>GPU0_K_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1881.91,-676.65C1902.84,-677.57 1924.55,-678.52 1945.7,-679.45"/>
<polygon fill="black" stroke="black" points="1945.55,-682.95 1955.69,-679.89 1945.86,-675.95 1945.55,-682.95"/>
</g>
<!-- GPU0_V_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge11" class="edge">
<title>GPU0_V_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1881.91,-712.51C1902.84,-709.81 1924.55,-707.02 1945.7,-704.3"/>
<polygon fill="black" stroke="black" points="1946.22,-707.77 1955.69,-703.02 1945.33,-700.82 1946.22,-707.77"/>
</g>
<!-- GPU0_O_Proj_RP -->
<g id="node7" class="node">
<title>GPU0_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="2524.87,-735.27 2261.87,-735.27 2261.87,-694.27 2524.87,-694.27 2524.87,-735.27"/>
<text text-anchor="middle" x="2393.37" y="-723.27" font-family="Arial" font-size="10.00">GPU0: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2393.37" y="-712.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2393.37" y="-701.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU0_Attention&#45;&gt;GPU0_O_Proj_RP -->
<g id="edge15" class="edge">
<title>GPU0_Attention&#45;&gt;GPU0_O_Proj_RP</title>
<path fill="none" stroke="black" d="M2226.3,-698.74C2234.63,-699.55 2243.03,-700.36 2251.39,-701.16"/>
<polygon fill="black" stroke="black" points="2251.27,-704.67 2261.56,-702.15 2251.94,-697.7 2251.27,-704.67"/>
</g>
<!-- Attn_AllReduce -->
<g id="node22" class="node">
<title>Attn_AllReduce</title>
<ellipse fill="#ff9999" stroke="black" cx="173.24" cy="-448.77" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="173.24" y="-462.77" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="173.24" y="-451.77" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="173.24" y="-440.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="173.24" y="-429.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU0_O_Proj_RP&#45;&gt;Attn_AllReduce -->
<g id="edge17" class="edge">
<title>GPU0_O_Proj_RP&#45;&gt;Attn_AllReduce</title>
<path fill="none" stroke="black" d="M2314.09,-735.29C2193.4,-765.07 1954.16,-816.77 1747.63,-816.77 1082.14,-816.77 1082.14,-816.77 1082.14,-816.77 764.93,-816.77 658.23,-832.57 382.48,-675.77 303.87,-631.07 238.26,-546.39 202.77,-494.04"/>
<polygon fill="black" stroke="black" points="205.6,-491.97 197.12,-485.61 199.78,-495.87 205.6,-491.97"/>
</g>
<!-- GPU1_Q_Proj_CP -->
<g id="node9" class="node">
<title>GPU1_Q_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1881.63,-455.27 1611.63,-455.27 1611.63,-414.27 1881.63,-414.27 1881.63,-455.27"/>
<text text-anchor="middle" x="1746.63" y="-443.27" font-family="Arial" font-size="10.00">GPU1: Q&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1746.63" y="-432.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1746.63" y="-421.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_Q_Proj_CP -->
<g id="edge6" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_Q_Proj_CP</title>
<path fill="none" stroke="black" d="M1526.28,-650.22C1530.27,-647.43 1534,-644.3 1537.39,-640.77 1592.69,-583.19 1516.11,-520.39 1573.39,-464.77 1581.72,-456.67 1591.42,-450.33 1601.88,-445.39"/>
<polygon fill="black" stroke="black" points="1603.42,-448.54 1611.25,-441.41 1600.68,-442.1 1603.42,-448.54"/>
</g>
<!-- GPU1_K_Proj_CP -->
<g id="node10" class="node">
<title>GPU1_K_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1881.63,-514.27 1611.63,-514.27 1611.63,-473.27 1881.63,-473.27 1881.63,-514.27"/>
<text text-anchor="middle" x="1746.63" y="-502.27" font-family="Arial" font-size="10.00">GPU1: K&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1746.63" y="-491.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1746.63" y="-480.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_K_Proj_CP -->
<g id="edge7" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_K_Proj_CP</title>
<path fill="none" stroke="black" d="M1525.32,-650.16C1529.62,-647.39 1533.67,-644.28 1537.39,-640.77 1576.93,-603.4 1532.57,-559.74 1573.39,-523.77 1581.93,-516.24 1591.66,-510.28 1602.06,-505.58"/>
<polygon fill="black" stroke="black" points="1603.43,-508.8 1611.36,-501.76 1600.78,-502.32 1603.43,-508.8"/>
</g>
<!-- GPU1_V_Proj_CP -->
<g id="node11" class="node">
<title>GPU1_V_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1881.63,-573.27 1611.63,-573.27 1611.63,-532.27 1881.63,-532.27 1881.63,-573.27"/>
<text text-anchor="middle" x="1746.63" y="-561.27" font-family="Arial" font-size="10.00">GPU1: V&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1746.63" y="-550.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1746.63" y="-539.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_V_Proj_CP -->
<g id="edge8" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_V_Proj_CP</title>
<path fill="none" stroke="black" d="M1521.93,-650.13C1527.36,-647.39 1532.55,-644.28 1537.39,-640.77 1561.92,-622.93 1548.24,-599.75 1573.39,-582.77 1582.25,-576.79 1591.93,-571.88 1602.04,-567.87"/>
<polygon fill="black" stroke="black" points="1603.24,-571.16 1611.43,-564.44 1600.84,-564.59 1603.24,-571.16"/>
</g>
<!-- GPU1_Attention -->
<g id="node12" class="node">
<title>GPU1_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="2225.87,-543.27 1955.87,-543.27 1955.87,-502.27 2225.87,-502.27 2225.87,-543.27"/>
<text text-anchor="middle" x="2090.87" y="-531.27" font-family="Arial" font-size="10.00">GPU1: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="2090.87" y="-520.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2090.87" y="-509.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_Q_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge12" class="edge">
<title>GPU1_Q_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M1878.34,-455.32C1892.42,-458.19 1906.49,-461.34 1919.87,-464.77 1955.87,-473.99 1995.19,-487.19 2026.94,-498.67"/>
<polygon fill="black" stroke="black" points="2025.95,-502.04 2036.54,-502.17 2028.35,-495.46 2025.95,-502.04"/>
</g>
<!-- GPU1_K_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge13" class="edge">
<title>GPU1_K_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M1881.91,-505.15C1902.84,-506.92 1924.55,-508.76 1945.7,-510.55"/>
<polygon fill="black" stroke="black" points="1945.43,-514.04 1955.69,-511.4 1946.03,-507.07 1945.43,-514.04"/>
</g>
<!-- GPU1_V_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge14" class="edge">
<title>GPU1_V_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M1881.91,-541C1902.84,-539.16 1924.55,-537.26 1945.7,-535.41"/>
<polygon fill="black" stroke="black" points="1946.04,-538.89 1955.69,-534.53 1945.43,-531.92 1946.04,-538.89"/>
</g>
<!-- GPU1_O_Proj_RP -->
<g id="node13" class="node">
<title>GPU1_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="2524.87,-603.27 2261.87,-603.27 2261.87,-562.27 2524.87,-562.27 2524.87,-603.27"/>
<text text-anchor="middle" x="2393.37" y="-591.27" font-family="Arial" font-size="10.00">GPU1: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="2393.37" y="-580.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2393.37" y="-569.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU1_Attention&#45;&gt;GPU1_O_Proj_RP -->
<g id="edge16" class="edge">
<title>GPU1_Attention&#45;&gt;GPU1_O_Proj_RP</title>
<path fill="none" stroke="black" d="M2194.86,-543.33C2222.1,-548.77 2251.64,-554.67 2279.38,-560.21"/>
<polygon fill="black" stroke="black" points="2279.02,-563.71 2289.51,-562.23 2280.39,-556.84 2279.02,-563.71"/>
</g>
<!-- GPU1_O_Proj_RP&#45;&gt;Attn_AllReduce -->
<g id="edge18" class="edge">
<title>GPU1_O_Proj_RP&#45;&gt;Attn_AllReduce</title>
<path fill="none" stroke="black" d="M2365.96,-603.28C2339.48,-623.92 2297.62,-656.77 2261.87,-685.77 2245.69,-698.89 2244.9,-707.3 2225.87,-715.77 2220.38,-718.21 1839.35,-778.77 1747.63,-778.77 1082.14,-778.77 1082.14,-778.77 1082.14,-778.77 746.62,-778.77 381.03,-577.23 237.28,-489.15"/>
<polygon fill="black" stroke="black" points="238.9,-486.04 228.55,-483.77 235.23,-492 238.9,-486.04"/>
</g>
<!-- GPU0_Expert00 -->
<g id="node14" class="node">
<title>GPU0_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="1534.39,-351.77 1295.39,-351.77 1295.39,-299.77 1534.39,-299.77 1534.39,-351.77"/>
<text text-anchor="middle" x="1414.89" y="-339.77" font-family="Arial" font-size="10.00">GPU0: Expert_L0_E0</text>
<text text-anchor="middle" x="1414.89" y="-328.77" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1414.89" y="-317.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-306.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Expert_AllReduce -->
<g id="node25" class="node">
<title>Expert_AllReduce</title>
<ellipse fill="#ff9999" stroke="black" cx="1746.63" cy="-36.77" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1746.63" y="-50.77" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1746.63" y="-39.77" font-family="Arial" font-size="10.00">Expert Outputs</text>
<text text-anchor="middle" x="1746.63" y="-28.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1746.63" y="-17.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU0_Expert00&#45;&gt;Expert_AllReduce -->
<g id="edge37" class="edge">
<title>GPU0_Expert00&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1527.82,-299.73C1531.25,-297.02 1534.46,-294.04 1537.39,-290.77 1601.33,-219.15 1507.78,-147.87 1573.39,-77.77 1579,-71.77 1585.31,-66.58 1592.13,-62.09"/>
<polygon fill="black" stroke="black" points="1594.23,-64.91 1601.01,-56.77 1590.63,-58.91 1594.23,-64.91"/>
</g>
<!-- GPU0_Expert01 -->
<g id="node15" class="node">
<title>GPU0_Expert01</title>
<polygon fill="#e6f3ff" stroke="black" points="1534.39,-281.77 1295.39,-281.77 1295.39,-229.77 1534.39,-229.77 1534.39,-281.77"/>
<text text-anchor="middle" x="1414.89" y="-269.77" font-family="Arial" font-size="10.00">GPU0: Expert_L0_E1</text>
<text text-anchor="middle" x="1414.89" y="-258.77" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1414.89" y="-247.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-236.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU0_Expert01&#45;&gt;Expert_AllReduce -->
<g id="edge38" class="edge">
<title>GPU0_Expert01&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1527.23,-229.62C1530.85,-226.95 1534.26,-224 1537.39,-220.77 1582.94,-173.65 1526.74,-123.81 1573.39,-77.77 1579.31,-71.92 1585.9,-66.86 1592.96,-62.47"/>
<polygon fill="black" stroke="black" points="1595.17,-65.24 1602.14,-57.26 1591.71,-59.15 1595.17,-65.24"/>
</g>
<!-- GPU0_Expert02 -->
<g id="node16" class="node">
<title>GPU0_Expert02</title>
<polygon fill="#e6f3ff" stroke="black" points="1534.39,-211.77 1295.39,-211.77 1295.39,-159.77 1534.39,-159.77 1534.39,-211.77"/>
<text text-anchor="middle" x="1414.89" y="-199.77" font-family="Arial" font-size="10.00">GPU0: Expert_L0_E2</text>
<text text-anchor="middle" x="1414.89" y="-188.77" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1414.89" y="-177.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-166.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU0_Expert02&#45;&gt;Expert_AllReduce -->
<g id="edge39" class="edge">
<title>GPU0_Expert02&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1525,-159.62C1529.36,-156.95 1533.51,-154.01 1537.39,-150.77 1565.13,-127.56 1545.1,-100.32 1573.39,-77.77 1580.62,-72 1588.54,-67.02 1596.88,-62.72"/>
<polygon fill="black" stroke="black" points="1598.56,-65.8 1606.07,-58.33 1595.54,-59.48 1598.56,-65.8"/>
</g>
<!-- GPU0_Expert03 -->
<g id="node17" class="node">
<title>GPU0_Expert03</title>
<polygon fill="#e6f3ff" stroke="black" points="1534.39,-141.77 1295.39,-141.77 1295.39,-89.77 1534.39,-89.77 1534.39,-141.77"/>
<text text-anchor="middle" x="1414.89" y="-129.77" font-family="Arial" font-size="10.00">GPU0: Expert_L0_E3</text>
<text text-anchor="middle" x="1414.89" y="-118.77" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1414.89" y="-107.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-96.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU0_Expert03&#45;&gt;Expert_AllReduce -->
<g id="edge40" class="edge">
<title>GPU0_Expert03&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1523.47,-89.77C1540.18,-85.74 1557.25,-81.64 1573.39,-77.77 1588.61,-74.12 1604.59,-70.3 1620.43,-66.52"/>
<polygon fill="black" stroke="black" points="1621.35,-69.9 1630.27,-64.18 1619.73,-63.09 1621.35,-69.9"/>
</g>
<!-- GPU1_Expert00 -->
<g id="node18" class="node">
<title>GPU1_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="1534.39,-631.77 1295.39,-631.77 1295.39,-579.77 1534.39,-579.77 1534.39,-631.77"/>
<text text-anchor="middle" x="1414.89" y="-619.77" font-family="Arial" font-size="10.00">GPU1: Expert_L0_E0</text>
<text text-anchor="middle" x="1414.89" y="-608.77" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1414.89" y="-597.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-586.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU1_Expert00&#45;&gt;Expert_AllReduce -->
<g id="edge41" class="edge">
<title>GPU1_Expert00&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1528.72,-579.65C1531.85,-576.96 1534.76,-574.01 1537.39,-570.77 1606.59,-485.47 1502.2,-161.43 1573.39,-77.77 1578.57,-71.68 1584.48,-66.4 1590.91,-61.84"/>
<polygon fill="black" stroke="black" points="1592.8,-64.78 1599.32,-56.43 1589.02,-58.89 1592.8,-64.78"/>
</g>
<!-- GPU1_Expert01 -->
<g id="node19" class="node">
<title>GPU1_Expert01</title>
<polygon fill="#e6f3ff" stroke="black" points="1534.39,-561.77 1295.39,-561.77 1295.39,-509.77 1534.39,-509.77 1534.39,-561.77"/>
<text text-anchor="middle" x="1414.89" y="-549.77" font-family="Arial" font-size="10.00">GPU1: Expert_L0_E1</text>
<text text-anchor="middle" x="1414.89" y="-538.77" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1414.89" y="-527.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-516.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU1_Expert01&#45;&gt;Expert_AllReduce -->
<g id="edge42" class="edge">
<title>GPU1_Expert01&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1528.67,-509.61C1531.81,-506.93 1534.74,-503.99 1537.39,-500.77 1597.26,-427.87 1511.82,-149.25 1573.39,-77.77 1578.67,-71.63 1584.7,-66.32 1591.26,-61.73"/>
<polygon fill="black" stroke="black" points="1593.26,-64.61 1599.83,-56.3 1589.51,-58.69 1593.26,-64.61"/>
</g>
<!-- GPU1_Expert02 -->
<g id="node20" class="node">
<title>GPU1_Expert02</title>
<polygon fill="#e6f3ff" stroke="black" points="1534.39,-491.77 1295.39,-491.77 1295.39,-439.77 1534.39,-439.77 1534.39,-491.77"/>
<text text-anchor="middle" x="1414.89" y="-479.77" font-family="Arial" font-size="10.00">GPU1: Expert_L0_E2</text>
<text text-anchor="middle" x="1414.89" y="-468.77" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1414.89" y="-457.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-446.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU1_Expert02&#45;&gt;Expert_AllReduce -->
<g id="edge43" class="edge">
<title>GPU1_Expert02&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1528.6,-439.55C1531.77,-436.89 1534.71,-433.97 1537.39,-430.77 1638.49,-309.74 1469.47,-196.4 1573.39,-77.77 1578.73,-71.67 1584.79,-66.4 1591.38,-61.84"/>
<polygon fill="black" stroke="black" points="1593.38,-64.72 1599.99,-56.44 1589.66,-58.79 1593.38,-64.72"/>
</g>
<!-- GPU1_Expert03 -->
<g id="node21" class="node">
<title>GPU1_Expert03</title>
<polygon fill="#e6f3ff" stroke="black" points="1534.39,-421.77 1295.39,-421.77 1295.39,-369.77 1534.39,-369.77 1534.39,-421.77"/>
<text text-anchor="middle" x="1414.89" y="-409.77" font-family="Arial" font-size="10.00">GPU1: Expert_L0_E3</text>
<text text-anchor="middle" x="1414.89" y="-398.77" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1414.89" y="-387.77" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1414.89" y="-376.77" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU1_Expert03&#45;&gt;Expert_AllReduce -->
<g id="edge44" class="edge">
<title>GPU1_Expert03&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1528.25,-369.67C1531.53,-366.98 1534.6,-364.02 1537.39,-360.77 1619.88,-264.49 1488.66,-172.1 1573.39,-77.77 1578.8,-71.74 1584.93,-66.52 1591.56,-62"/>
<polygon fill="black" stroke="black" points="1593.56,-64.88 1600.22,-56.65 1589.88,-58.93 1593.56,-64.88"/>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU0_Expert00 -->
<g id="edge20" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU0_Expert00</title>
<path fill="none" stroke="black" d="M219.95,-413.34C260.21,-384.51 321.74,-346.03 382.48,-329.77 697.87,-245.36 1087.2,-279.16 1285.16,-305.6"/>
<polygon fill="black" stroke="black" points="1284.93,-309.1 1295.31,-306.97 1285.87,-302.16 1284.93,-309.1"/>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU0_Expert01 -->
<g id="edge21" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU0_Expert01</title>
<path fill="none" stroke="black" d="M203.13,-412.48C239.64,-369.78 306.92,-301.13 382.48,-272.77 543.95,-212.16 1046.3,-233.13 1285.18,-247.23"/>
<polygon fill="black" stroke="black" points="1285.12,-250.73 1295.31,-247.83 1285.53,-243.75 1285.12,-250.73"/>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU0_Expert02 -->
<g id="edge22" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU0_Expert02</title>
<path fill="none" stroke="black" d="M195.85,-411.88C228.65,-359.89 296.39,-267.04 382.48,-227.77 539.61,-156.11 1044.74,-168.54 1284.82,-179.07"/>
<polygon fill="black" stroke="black" points="1284.86,-182.57 1295,-179.52 1285.17,-175.58 1284.86,-182.57"/>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU0_Expert03 -->
<g id="edge23" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU0_Expert03</title>
<path fill="none" stroke="black" d="M188.73,-412.1C215.91,-348.92 281.1,-221.11 382.48,-166.77 673.79,-10.62 1080.42,-52.92 1285.2,-88.83"/>
<polygon fill="black" stroke="black" points="1284.64,-92.28 1295.1,-90.58 1285.87,-85.39 1284.64,-92.28"/>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU1_Expert00 -->
<g id="edge24" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU1_Expert00</title>
<path fill="none" stroke="black" d="M265.02,-480.04C301.17,-491.37 343.41,-503.23 382.48,-510.77 703.54,-572.72 1088.88,-594.59 1285.2,-602.07"/>
<polygon fill="black" stroke="black" points="1285.14,-605.57 1295.26,-602.44 1285.4,-598.57 1285.14,-605.57"/>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU1_Expert01 -->
<g id="edge25" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU1_Expert01</title>
<path fill="none" stroke="black" d="M311.23,-471.02C334.94,-474.34 359.39,-477.43 382.48,-479.77 706.47,-512.61 1089.79,-527.04 1285.25,-532.65"/>
<polygon fill="black" stroke="black" points="1285.18,-536.15 1295.27,-532.93 1285.38,-529.15 1285.18,-536.15"/>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU1_Expert02 -->
<g id="edge26" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU1_Expert02</title>
<path fill="none" stroke="black" d="M337.32,-460.74C352.58,-461.55 367.82,-462.26 382.48,-462.77 707.23,-474.15 1089.84,-470.9 1285.1,-468.05"/>
<polygon fill="black" stroke="black" points="1285.17,-471.55 1295.12,-467.9 1285.06,-464.55 1285.17,-471.55"/>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU1_Expert03 -->
<g id="edge27" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU1_Expert03</title>
<path fill="none" stroke="black" d="M346.56,-450.27C560.39,-450.68 935.98,-446.68 1256.39,-418.77 1265.78,-417.95 1275.48,-416.94 1285.22,-415.81"/>
<polygon fill="black" stroke="black" points="1285.87,-419.25 1295.38,-414.58 1285.03,-412.3 1285.87,-419.25"/>
</g>
<!-- Gate -->
<g id="node23" class="node">
<title>Gate</title>
<polygon fill="#99ff99" stroke="black" points="874.11,-420.77 482.91,-420.77 382.27,-338.77 773.48,-338.77 874.11,-420.77"/>
<text text-anchor="middle" x="628.19" y="-388.27" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="628.19" y="-377.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="628.19" y="-366.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, experts=8]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;Gate -->
<g id="edge19" class="edge">
<title>Attn_AllReduce&#45;&gt;Gate</title>
<path fill="none" stroke="black" d="M314.46,-427.41C358.27,-420.74 407.14,-413.29 453,-406.31"/>
<polygon fill="black" stroke="black" points="453.68,-409.74 463.04,-404.78 452.62,-402.82 453.68,-409.74"/>
</g>
<!-- Expert_Select -->
<g id="node24" class="node">
<title>Expert_Select</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1206.39,-409.77 1010.33,-409.77 959.9,-349.77 1155.96,-349.77 1206.39,-409.77"/>
<text text-anchor="middle" x="1083.14" y="-382.77" font-family="Arial" font-size="10.00">Expert Selection</text>
<text text-anchor="middle" x="1083.14" y="-371.77" font-family="Arial" font-size="10.00">Top&#45;8 experts per token</text>
</g>
<!-- Gate&#45;&gt;Expert_Select -->
<g id="edge28" class="edge">
<title>Gate&#45;&gt;Expert_Select</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M823.91,-379.77C875.63,-379.77 929.6,-379.77 974.75,-379.77"/>
<polygon fill="black" stroke="black" points="974.84,-383.27 984.84,-379.77 974.84,-376.27 974.84,-383.27"/>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert00 -->
<g id="edge29" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1169.49,-365.79C1204.7,-360.03 1246.27,-353.22 1285.05,-346.87"/>
<polygon fill="black" stroke="black" points="1286.07,-350.25 1295.37,-345.18 1284.93,-343.34 1286.07,-350.25"/>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert01 -->
<g id="edge30" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1145.38,-349.6C1184.52,-331.06 1236.7,-307.7 1284.39,-290.77 1290.01,-288.77 1295.81,-286.83 1301.68,-284.94"/>
<polygon fill="black" stroke="black" points="1303.14,-288.15 1311.63,-281.82 1301.04,-281.47 1303.14,-288.15"/>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert02 -->
<g id="edge31" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert02</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1113.95,-349.51C1150.82,-313.74 1217.02,-254.78 1284.39,-220.77 1287.91,-218.99 1291.54,-217.29 1295.23,-215.67"/>
<polygon fill="black" stroke="black" points="1296.66,-218.87 1304.56,-211.81 1293.98,-212.41 1296.66,-218.87"/>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert03 -->
<g id="edge32" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert03</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1102.18,-349.44C1133.11,-300.11 1201.06,-202.79 1284.39,-150.77 1286.84,-149.24 1289.36,-147.77 1291.94,-146.37"/>
<polygon fill="black" stroke="black" points="1293.54,-149.48 1300.88,-141.84 1290.38,-143.23 1293.54,-149.48"/>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert00 -->
<g id="edge33" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1107.54,-410.12C1141.79,-452.43 1209.66,-528.69 1284.39,-570.77 1287.28,-572.4 1290.25,-573.95 1293.28,-575.44"/>
<polygon fill="black" stroke="black" points="1292,-578.7 1302.55,-579.69 1294.92,-572.34 1292,-578.7"/>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert01 -->
<g id="edge34" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1126.02,-409.86C1165.3,-436.89 1226.49,-476.03 1284.39,-500.77 1288.84,-502.67 1293.42,-504.49 1298.08,-506.24"/>
<polygon fill="black" stroke="black" points="1297.15,-509.62 1307.74,-509.71 1299.52,-503.04 1297.15,-509.62"/>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert02 -->
<g id="edge35" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert02</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1199.47,-409.85C1233.45,-418.71 1270.52,-428.38 1304.13,-437.14"/>
<polygon fill="black" stroke="black" points="1303.42,-440.58 1313.98,-439.71 1305.19,-433.8 1303.42,-440.58"/>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert03 -->
<g id="edge36" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert03</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1185.32,-384.68C1216.8,-386.21 1251.94,-387.91 1285.05,-389.52"/>
<polygon fill="black" stroke="black" points="1285.1,-393.02 1295.25,-390.01 1285.43,-386.03 1285.1,-393.02"/>
</g>
<!-- Final_RMSNorm -->
<g id="node26" class="node">
<title>Final_RMSNorm</title>
<polygon fill="#ff99ff" stroke="black" points="2213.37,-57.27 1968.37,-57.27 1968.37,-16.27 2213.37,-16.27 2213.37,-57.27"/>
<text text-anchor="middle" x="2090.87" y="-45.27" font-family="Arial" font-size="10.00">Final RMSNorm</text>
<text text-anchor="middle" x="2090.87" y="-34.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="2090.87" y="-23.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Expert_AllReduce&#45;&gt;Final_RMSNorm -->
<g id="edge45" class="edge">
<title>Expert_AllReduce&#45;&gt;Final_RMSNorm</title>
<path fill="none" stroke="black" d="M1920,-36.77C1932.73,-36.77 1945.45,-36.77 1957.89,-36.77"/>
<polygon fill="black" stroke="black" points="1958.25,-40.27 1968.25,-36.77 1958.25,-33.27 1958.25,-40.27"/>
</g>
<!-- Output_Proj -->
<g id="node27" class="node">
<title>Output_Proj</title>
<polygon fill="#ff99ff" stroke="black" points="2512.87,-57.27 2273.87,-57.27 2273.87,-16.27 2512.87,-16.27 2512.87,-57.27"/>
<text text-anchor="middle" x="2393.37" y="-45.27" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2393.37" y="-34.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="2393.37" y="-23.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, vocab_size]</text>
</g>
<!-- Final_RMSNorm&#45;&gt;Output_Proj -->
<g id="edge46" class="edge">
<title>Final_RMSNorm&#45;&gt;Output_Proj</title>
<path fill="none" stroke="black" d="M2213.66,-36.77C2230.1,-36.77 2247.01,-36.77 2263.56,-36.77"/>
<polygon fill="black" stroke="black" points="2263.81,-40.27 2273.81,-36.77 2263.81,-33.27 2263.81,-40.27"/>
</g>
<!-- Output -->
<g id="node28" class="node">
<title>Output</title>
<ellipse fill="#ff99ff" stroke="black" cx="2729.87" cy="-36.77" rx="169" ry="28.98"/>
<text text-anchor="middle" x="2729.87" y="-45.27" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="2729.87" y="-34.27" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, vocab_size]</text>
<text text-anchor="middle" x="2729.87" y="-23.27" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, vocab_size]</text>
</g>
<!-- Output_Proj&#45;&gt;Output -->
<g id="edge47" class="edge">
<title>Output_Proj&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M2513.24,-36.77C2525.39,-36.77 2537.91,-36.77 2550.52,-36.77"/>
<polygon fill="black" stroke="black" points="2550.64,-40.27 2560.64,-36.77 2550.64,-33.27 2550.64,-40.27"/>
</g>
</g>
</svg>
