<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: LLM_Deployment Pages: 1 -->
<svg width="2077pt" height="1145pt"
 viewBox="0.00 0.00 2077.00 1145.04" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1141.04)">
<title>LLM_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1141.04 2073,-1141.04 2073,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ep0</title>
<polygon fill="#e6f3ff" stroke="black" points="203,-762.06 203,-1071.06 1929,-1071.06 1929,-762.06 203,-762.06"/>
<text text-anchor="middle" x="1066" y="-1057.46" font-family="Arial" font-size="12.00">EP Group 0 (GPUs 0&#45;1)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_experts_ep0</title>
<polygon fill="#e6f3ff" stroke="black" points="8,-349.52 8,-438.52 2061,-438.52 2061,-349.52 8,-349.52"/>
<text text-anchor="middle" x="1034.5" y="-424.92" font-family="Arial" font-size="12.00">Experts EP0 (64 experts per GPU)</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="#9999ff" stroke="black" cx="1066" cy="-1108.05" rx="173.48" ry="28.98"/>
<text text-anchor="middle" x="1066" y="-1116.55" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="1066" y="-1105.55" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1066" y="-1094.55" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU0_RMSNorm -->
<g id="node2" class="node">
<title>GPU0_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="1476.5,-1042.06 1231.5,-1042.06 1231.5,-1001.06 1476.5,-1001.06 1476.5,-1042.06"/>
<text text-anchor="middle" x="1354" y="-1030.06" font-family="Arial" font-size="10.00">GPU0: RMSNorm</text>
<text text-anchor="middle" x="1354" y="-1019.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1354" y="-1008.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU0_RMSNorm -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;GPU0_RMSNorm</title>
<path fill="none" stroke="black" d="M1149.3,-1082.61C1189.73,-1070.75 1237.98,-1056.6 1277.47,-1045.01"/>
<polygon fill="black" stroke="black" points="1278.71,-1048.3 1287.32,-1042.12 1276.74,-1041.58 1278.71,-1048.3"/>
</g>
<!-- GPU1_RMSNorm -->
<g id="node8" class="node">
<title>GPU1_RMSNorm</title>
<polygon fill="#e6f3ff" stroke="black" points="900.5,-1042.06 655.5,-1042.06 655.5,-1001.06 900.5,-1001.06 900.5,-1042.06"/>
<text text-anchor="middle" x="778" y="-1030.06" font-family="Arial" font-size="10.00">GPU1: RMSNorm</text>
<text text-anchor="middle" x="778" y="-1019.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="778" y="-1008.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Input&#45;&gt;GPU1_RMSNorm -->
<g id="edge2" class="edge">
<title>Input&#45;&gt;GPU1_RMSNorm</title>
<path fill="none" stroke="black" d="M982.7,-1082.61C942.27,-1070.75 894.02,-1056.6 854.53,-1045.01"/>
<polygon fill="black" stroke="black" points="855.26,-1041.58 844.68,-1042.12 853.29,-1048.3 855.26,-1041.58"/>
</g>
<!-- GPU0_Q_Proj_CP -->
<g id="node3" class="node">
<title>GPU0_Q_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1345,-965.06 1075,-965.06 1075,-924.06 1345,-924.06 1345,-965.06"/>
<text text-anchor="middle" x="1210" y="-953.06" font-family="Arial" font-size="10.00">GPU0: Q&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1210" y="-942.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1210" y="-931.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_Q_Proj_CP -->
<g id="edge3" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_Q_Proj_CP</title>
<path fill="none" stroke="black" d="M1316.54,-1001.05C1298.2,-991.5 1275.93,-979.9 1256.51,-969.78"/>
<polygon fill="black" stroke="black" points="1258.01,-966.62 1247.52,-965.1 1254.77,-972.83 1258.01,-966.62"/>
</g>
<!-- GPU0_K_Proj_CP -->
<g id="node4" class="node">
<title>GPU0_K_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1633,-965.06 1363,-965.06 1363,-924.06 1633,-924.06 1633,-965.06"/>
<text text-anchor="middle" x="1498" y="-953.06" font-family="Arial" font-size="10.00">GPU0: K&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1498" y="-942.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1498" y="-931.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_K_Proj_CP -->
<g id="edge4" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_K_Proj_CP</title>
<path fill="none" stroke="black" d="M1391.46,-1001.05C1409.8,-991.5 1432.07,-979.9 1451.49,-969.78"/>
<polygon fill="black" stroke="black" points="1453.23,-972.83 1460.48,-965.1 1449.99,-966.62 1453.23,-972.83"/>
</g>
<!-- GPU0_V_Proj_CP -->
<g id="node5" class="node">
<title>GPU0_V_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1921,-965.06 1651,-965.06 1651,-924.06 1921,-924.06 1921,-965.06"/>
<text text-anchor="middle" x="1786" y="-953.06" font-family="Arial" font-size="10.00">GPU0: V&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="1786" y="-942.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1786" y="-931.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_RMSNorm&#45;&gt;GPU0_V_Proj_CP -->
<g id="edge5" class="edge">
<title>GPU0_RMSNorm&#45;&gt;GPU0_V_Proj_CP</title>
<path fill="none" stroke="black" d="M1466.38,-1001.05C1526.76,-990.57 1601.31,-977.62 1663.22,-966.88"/>
<polygon fill="black" stroke="black" points="1664.18,-970.26 1673.44,-965.1 1662.99,-963.37 1664.18,-970.26"/>
</g>
<!-- GPU0_Attention -->
<g id="node6" class="node">
<title>GPU0_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="1368,-888.06 1098,-888.06 1098,-847.06 1368,-847.06 1368,-888.06"/>
<text text-anchor="middle" x="1233" y="-876.06" font-family="Arial" font-size="10.00">GPU0: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="1233" y="-865.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1233" y="-854.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU0_Q_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge9" class="edge">
<title>GPU0_Q_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1216.04,-923.86C1218.47,-915.93 1221.33,-906.63 1223.99,-897.94"/>
<polygon fill="black" stroke="black" points="1227.41,-898.72 1227,-888.13 1220.72,-896.67 1227.41,-898.72"/>
</g>
<!-- GPU0_K_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge10" class="edge">
<title>GPU0_K_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1429.07,-924.05C1393.17,-913.89 1349.11,-901.42 1311.86,-890.88"/>
<polygon fill="black" stroke="black" points="1312.62,-887.46 1302.05,-888.1 1310.72,-894.19 1312.62,-887.46"/>
</g>
<!-- GPU0_V_Proj_CP&#45;&gt;GPU0_Attention -->
<g id="edge11" class="edge">
<title>GPU0_V_Proj_CP&#45;&gt;GPU0_Attention</title>
<path fill="none" stroke="black" d="M1650.72,-925.21C1568.14,-914.01 1462.58,-899.7 1378.23,-888.26"/>
<polygon fill="black" stroke="black" points="1378.7,-884.79 1368.32,-886.91 1377.76,-891.73 1378.7,-884.79"/>
</g>
<!-- GPU0_O_Proj_RP -->
<g id="node7" class="node">
<title>GPU0_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="1350.5,-811.06 1087.5,-811.06 1087.5,-770.06 1350.5,-770.06 1350.5,-811.06"/>
<text text-anchor="middle" x="1219" y="-799.06" font-family="Arial" font-size="10.00">GPU0: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="1219" y="-788.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1219" y="-777.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU0_Attention&#45;&gt;GPU0_O_Proj_RP -->
<g id="edge15" class="edge">
<title>GPU0_Attention&#45;&gt;GPU0_O_Proj_RP</title>
<path fill="none" stroke="black" d="M1229.32,-846.86C1227.86,-839.02 1226.14,-829.83 1224.54,-821.22"/>
<polygon fill="black" stroke="black" points="1227.93,-820.32 1222.65,-811.13 1221.05,-821.61 1227.93,-820.32"/>
</g>
<!-- Attn_AllReduce -->
<g id="node14" class="node">
<title>Attn_AllReduce</title>
<ellipse fill="#ff9999" stroke="black" cx="1052" cy="-697.29" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1052" y="-711.29" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1052" y="-700.29" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1052" y="-689.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1052" y="-678.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU0_O_Proj_RP&#45;&gt;Attn_AllReduce -->
<g id="edge17" class="edge">
<title>GPU0_O_Proj_RP&#45;&gt;Attn_AllReduce</title>
<path fill="none" stroke="black" d="M1183.17,-769.98C1165.4,-760.27 1143.28,-748.18 1122.31,-736.72"/>
<polygon fill="black" stroke="black" points="1123.86,-733.57 1113.4,-731.85 1120.5,-739.72 1123.86,-733.57"/>
</g>
<!-- GPU1_Q_Proj_CP -->
<g id="node9" class="node">
<title>GPU1_Q_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="481,-965.06 211,-965.06 211,-924.06 481,-924.06 481,-965.06"/>
<text text-anchor="middle" x="346" y="-953.06" font-family="Arial" font-size="10.00">GPU1: Q&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="346" y="-942.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="346" y="-931.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_Q_Proj_CP -->
<g id="edge6" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_Q_Proj_CP</title>
<path fill="none" stroke="black" d="M665.62,-1001.05C605.24,-990.57 530.69,-977.62 468.78,-966.88"/>
<polygon fill="black" stroke="black" points="469.01,-963.37 458.56,-965.1 467.82,-970.26 469.01,-963.37"/>
</g>
<!-- GPU1_K_Proj_CP -->
<g id="node10" class="node">
<title>GPU1_K_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="769,-965.06 499,-965.06 499,-924.06 769,-924.06 769,-965.06"/>
<text text-anchor="middle" x="634" y="-953.06" font-family="Arial" font-size="10.00">GPU1: K&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="634" y="-942.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="634" y="-931.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_K_Proj_CP -->
<g id="edge7" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_K_Proj_CP</title>
<path fill="none" stroke="black" d="M740.54,-1001.05C722.2,-991.5 699.93,-979.9 680.51,-969.78"/>
<polygon fill="black" stroke="black" points="682.01,-966.62 671.52,-965.1 678.77,-972.83 682.01,-966.62"/>
</g>
<!-- GPU1_V_Proj_CP -->
<g id="node11" class="node">
<title>GPU1_V_Proj_CP</title>
<polygon fill="#e6f3ff" stroke="black" points="1057,-965.06 787,-965.06 787,-924.06 1057,-924.06 1057,-965.06"/>
<text text-anchor="middle" x="922" y="-953.06" font-family="Arial" font-size="10.00">GPU1: V&#45;Projection&#45;CP</text>
<text text-anchor="middle" x="922" y="-942.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="922" y="-931.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_RMSNorm&#45;&gt;GPU1_V_Proj_CP -->
<g id="edge8" class="edge">
<title>GPU1_RMSNorm&#45;&gt;GPU1_V_Proj_CP</title>
<path fill="none" stroke="black" d="M815.46,-1001.05C833.8,-991.5 856.07,-979.9 875.49,-969.78"/>
<polygon fill="black" stroke="black" points="877.23,-972.83 884.48,-965.1 873.99,-966.62 877.23,-972.83"/>
</g>
<!-- GPU1_Attention -->
<g id="node12" class="node">
<title>GPU1_Attention</title>
<polygon fill="#e6f3ff" stroke="black" points="1034,-888.06 764,-888.06 764,-847.06 1034,-847.06 1034,-888.06"/>
<text text-anchor="middle" x="899" y="-876.06" font-family="Arial" font-size="10.00">GPU1: Scaled&#45;Dot&#45;Attention</text>
<text text-anchor="middle" x="899" y="-865.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="899" y="-854.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- GPU1_Q_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge12" class="edge">
<title>GPU1_Q_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M481.28,-925.21C563.86,-914.01 669.42,-899.7 753.77,-888.26"/>
<polygon fill="black" stroke="black" points="754.24,-891.73 763.68,-886.91 753.3,-884.79 754.24,-891.73"/>
</g>
<!-- GPU1_K_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge13" class="edge">
<title>GPU1_K_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M702.93,-924.05C738.83,-913.89 782.89,-901.42 820.14,-890.88"/>
<polygon fill="black" stroke="black" points="821.28,-894.19 829.95,-888.1 819.38,-887.46 821.28,-894.19"/>
</g>
<!-- GPU1_V_Proj_CP&#45;&gt;GPU1_Attention -->
<g id="edge14" class="edge">
<title>GPU1_V_Proj_CP&#45;&gt;GPU1_Attention</title>
<path fill="none" stroke="black" d="M915.96,-923.86C913.53,-915.93 910.67,-906.63 908.01,-897.94"/>
<polygon fill="black" stroke="black" points="911.28,-896.67 905,-888.13 904.59,-898.72 911.28,-896.67"/>
</g>
<!-- GPU1_O_Proj_RP -->
<g id="node13" class="node">
<title>GPU1_O_Proj_RP</title>
<polygon fill="#e6f3ff" stroke="black" points="1043.5,-811.06 780.5,-811.06 780.5,-770.06 1043.5,-770.06 1043.5,-811.06"/>
<text text-anchor="middle" x="912" y="-799.06" font-family="Arial" font-size="10.00">GPU1: O&#45;Projection&#45;RP</text>
<text text-anchor="middle" x="912" y="-788.06" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, heads=16, d_k=32]</text>
<text text-anchor="middle" x="912" y="-777.06" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- GPU1_Attention&#45;&gt;GPU1_O_Proj_RP -->
<g id="edge16" class="edge">
<title>GPU1_Attention&#45;&gt;GPU1_O_Proj_RP</title>
<path fill="none" stroke="black" d="M902.42,-846.86C903.77,-839.02 905.37,-829.83 906.86,-821.22"/>
<polygon fill="black" stroke="black" points="910.35,-821.59 908.61,-811.13 903.45,-820.39 910.35,-821.59"/>
</g>
<!-- GPU1_O_Proj_RP&#45;&gt;Attn_AllReduce -->
<g id="edge18" class="edge">
<title>GPU1_O_Proj_RP&#45;&gt;Attn_AllReduce</title>
<path fill="none" stroke="black" d="M942.03,-769.98C956.33,-760.66 973.98,-749.16 990.92,-738.11"/>
<polygon fill="black" stroke="black" points="993.22,-740.79 999.69,-732.39 989.4,-734.92 993.22,-740.79"/>
</g>
<!-- Gate -->
<g id="node15" class="node">
<title>Gate</title>
<polygon fill="#99ff99" stroke="black" points="1297.92,-624.52 906.72,-624.52 806.08,-542.52 1197.28,-542.52 1297.92,-624.52"/>
<text text-anchor="middle" x="1052" y="-592.02" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1052" y="-581.02" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1052" y="-570.02" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, experts=8]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;Gate -->
<g id="edge19" class="edge">
<title>Attn_AllReduce&#45;&gt;Gate</title>
<path fill="none" stroke="black" d="M1052,-660.31C1052,-652.24 1052,-643.52 1052,-634.98"/>
<polygon fill="black" stroke="black" points="1055.5,-634.7 1052,-624.7 1048.5,-634.7 1055.5,-634.7"/>
</g>
<!-- GPU0_Expert00 -->
<g id="node17" class="node">
<title>GPU0_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="254.5,-409.52 15.5,-409.52 15.5,-357.52 254.5,-357.52 254.5,-409.52"/>
<text text-anchor="middle" x="135" y="-397.52" font-family="Arial" font-size="10.00">GPU0: Expert_L0_E0</text>
<text text-anchor="middle" x="135" y="-386.52" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="135" y="-375.52" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="135" y="-364.52" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU0_Expert00 -->
<g id="edge20" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU0_Expert00</title>
<path fill="none" stroke="black" d="M886.47,-686.39C791.59,-677.11 671.38,-659.17 569,-624.52 415.67,-572.63 253.48,-467.52 178.14,-415.34"/>
<polygon fill="black" stroke="black" points="180.03,-412.39 169.82,-409.55 176.03,-418.13 180.03,-412.39"/>
</g>
<!-- GPU0_Expert01 -->
<g id="node18" class="node">
<title>GPU0_Expert01</title>
<polygon fill="#e6f3ff" stroke="black" points="1539.5,-409.52 1300.5,-409.52 1300.5,-357.52 1539.5,-357.52 1539.5,-409.52"/>
<text text-anchor="middle" x="1420" y="-397.52" font-family="Arial" font-size="10.00">GPU0: Expert_L0_E1</text>
<text text-anchor="middle" x="1420" y="-386.52" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1420" y="-375.52" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1420" y="-364.52" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU0_Expert01 -->
<g id="edge21" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU0_Expert01</title>
<path fill="none" stroke="black" d="M1209.54,-681.92C1252.03,-671.42 1295.24,-653.81 1328,-624.52 1388.37,-570.54 1409.38,-472.47 1416.5,-419.96"/>
<polygon fill="black" stroke="black" points="1420,-420.14 1417.78,-409.78 1413.06,-419.27 1420,-420.14"/>
</g>
<!-- GPU0_Expert02 -->
<g id="node19" class="node">
<title>GPU0_Expert02</title>
<polygon fill="#e6f3ff" stroke="black" points="1796.5,-409.52 1557.5,-409.52 1557.5,-357.52 1796.5,-357.52 1796.5,-409.52"/>
<text text-anchor="middle" x="1677" y="-397.52" font-family="Arial" font-size="10.00">GPU0: Expert_L0_E2</text>
<text text-anchor="middle" x="1677" y="-386.52" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1677" y="-375.52" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1677" y="-364.52" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU0_Expert02 -->
<g id="edge22" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU0_Expert02</title>
<path fill="none" stroke="black" d="M1197.27,-677.23C1252.8,-666.43 1315.58,-649.82 1369,-624.52 1482.58,-570.73 1593.17,-468.99 1645.55,-416.95"/>
<polygon fill="black" stroke="black" points="1648.25,-419.2 1652.85,-409.65 1643.3,-414.25 1648.25,-419.2"/>
</g>
<!-- GPU0_Expert03 -->
<g id="node20" class="node">
<title>GPU0_Expert03</title>
<polygon fill="#e6f3ff" stroke="black" points="2053.5,-409.52 1814.5,-409.52 1814.5,-357.52 2053.5,-357.52 2053.5,-409.52"/>
<text text-anchor="middle" x="1934" y="-397.52" font-family="Arial" font-size="10.00">GPU0: Expert_L0_E3</text>
<text text-anchor="middle" x="1934" y="-386.52" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1934" y="-375.52" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1934" y="-364.52" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU0_Expert03 -->
<g id="edge23" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU0_Expert03</title>
<path fill="none" stroke="black" d="M1202.62,-678.96C1277.35,-667.85 1368.24,-650.52 1447,-624.52 1614.93,-569.09 1798.28,-466.01 1884.26,-414.89"/>
<polygon fill="black" stroke="black" points="1886.22,-417.79 1893.01,-409.66 1882.63,-411.78 1886.22,-417.79"/>
</g>
<!-- GPU1_Expert00 -->
<g id="node21" class="node">
<title>GPU1_Expert00</title>
<polygon fill="#e6f3ff" stroke="black" points="511.5,-409.52 272.5,-409.52 272.5,-357.52 511.5,-357.52 511.5,-409.52"/>
<text text-anchor="middle" x="392" y="-397.52" font-family="Arial" font-size="10.00">GPU1: Expert_L0_E0</text>
<text text-anchor="middle" x="392" y="-386.52" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="392" y="-375.52" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="392" y="-364.52" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU1_Expert00 -->
<g id="edge24" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU1_Expert00</title>
<path fill="none" stroke="black" d="M899.18,-679.85C836.95,-669.33 765.56,-652.23 705,-624.52 589.56,-571.71 477.18,-469.53 423.96,-417.18"/>
<polygon fill="black" stroke="black" points="426.11,-414.38 416.54,-409.83 421.18,-419.35 426.11,-414.38"/>
</g>
<!-- GPU1_Expert01 -->
<g id="node22" class="node">
<title>GPU1_Expert01</title>
<polygon fill="#e6f3ff" stroke="black" points="768.5,-409.52 529.5,-409.52 529.5,-357.52 768.5,-357.52 768.5,-409.52"/>
<text text-anchor="middle" x="649" y="-397.52" font-family="Arial" font-size="10.00">GPU1: Expert_L0_E1</text>
<text text-anchor="middle" x="649" y="-386.52" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="649" y="-375.52" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="649" y="-364.52" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU1_Expert01 -->
<g id="edge25" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU1_Expert01</title>
<path fill="none" stroke="black" d="M899.15,-679.94C855.93,-669.43 811.14,-652.32 776,-624.52 708.58,-571.19 672.77,-472.07 657.75,-419.45"/>
<polygon fill="black" stroke="black" points="661.06,-418.28 655.02,-409.57 654.31,-420.14 661.06,-418.28"/>
</g>
<!-- GPU1_Expert02 -->
<g id="node23" class="node">
<title>GPU1_Expert02</title>
<polygon fill="#e6f3ff" stroke="black" points="1025.5,-409.52 786.5,-409.52 786.5,-357.52 1025.5,-357.52 1025.5,-409.52"/>
<text text-anchor="middle" x="906" y="-397.52" font-family="Arial" font-size="10.00">GPU1: Expert_L0_E2</text>
<text text-anchor="middle" x="906" y="-386.52" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="906" y="-375.52" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="906" y="-364.52" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU1_Expert02 -->
<g id="edge26" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU1_Expert02</title>
<path fill="none" stroke="black" d="M918.27,-673.83C865.13,-661.94 812.83,-645.42 797,-624.52 746.8,-558.25 822.75,-465.17 871.08,-416.71"/>
<polygon fill="black" stroke="black" points="873.62,-419.12 878.28,-409.61 868.7,-414.13 873.62,-419.12"/>
</g>
<!-- GPU1_Expert03 -->
<g id="node24" class="node">
<title>GPU1_Expert03</title>
<polygon fill="#e6f3ff" stroke="black" points="1282.5,-409.52 1043.5,-409.52 1043.5,-357.52 1282.5,-357.52 1282.5,-409.52"/>
<text text-anchor="middle" x="1163" y="-397.52" font-family="Arial" font-size="10.00">GPU1: Expert_L0_E3</text>
<text text-anchor="middle" x="1163" y="-386.52" font-family="Arial" font-size="10.00">MLP&#45;CP&#45;RP</text>
<text text-anchor="middle" x="1163" y="-375.52" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1163" y="-364.52" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=512]</text>
</g>
<!-- Attn_AllReduce&#45;&gt;GPU1_Expert03 -->
<g id="edge27" class="edge">
<title>Attn_AllReduce&#45;&gt;GPU1_Expert03</title>
<path fill="none" stroke="black" d="M1185.73,-673.83C1238.87,-661.94 1291.17,-645.42 1307,-624.52 1360.1,-554.42 1266.14,-463.48 1206.52,-416.21"/>
<polygon fill="black" stroke="black" points="1208.39,-413.23 1198.36,-409.83 1204.09,-418.75 1208.39,-413.23"/>
</g>
<!-- Expert_Select -->
<g id="node16" class="node">
<title>Expert_Select</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1175.25,-506.52 979.19,-506.52 928.75,-446.52 1124.81,-446.52 1175.25,-506.52"/>
<text text-anchor="middle" x="1052" y="-479.52" font-family="Arial" font-size="10.00">Expert Selection</text>
<text text-anchor="middle" x="1052" y="-468.52" font-family="Arial" font-size="10.00">Top&#45;8 experts per token</text>
</g>
<!-- Gate&#45;&gt;Expert_Select -->
<g id="edge28" class="edge">
<title>Gate&#45;&gt;Expert_Select</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052,-542.23C1052,-533.93 1052,-525.21 1052,-516.94"/>
<polygon fill="black" stroke="black" points="1055.5,-516.79 1052,-506.79 1048.5,-516.79 1055.5,-516.79"/>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert00 -->
<g id="edge29" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M952.79,-475.2C771,-473.89 391.38,-467.64 263,-438.52 239.13,-433.11 214.07,-423.5 192.52,-413.87"/>
<polygon fill="black" stroke="black" points="193.74,-410.59 183.19,-409.61 190.83,-416.95 193.74,-410.59"/>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert01 -->
<g id="edge30" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1142.02,-466.97C1187.55,-461.3 1243.33,-452.31 1292,-438.52 1314.54,-432.14 1338.4,-422.82 1359.33,-413.72"/>
<polygon fill="black" stroke="black" points="1361,-416.81 1368.73,-409.57 1358.17,-410.41 1361,-416.81"/>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert02 -->
<g id="edge31" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert02</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1146.37,-472.14C1268.71,-467.13 1475.14,-456.34 1549,-438.52 1572.59,-432.83 1597.41,-423.27 1618.85,-413.76"/>
<polygon fill="black" stroke="black" points="1620.46,-416.87 1628.13,-409.56 1617.57,-410.5 1620.46,-416.87"/>
</g>
<!-- Expert_Select&#45;&gt;GPU0_Expert03 -->
<g id="edge32" class="edge">
<title>Expert_Select&#45;&gt;GPU0_Expert03</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1148.86,-474.96C1323.37,-473.26 1683.81,-466.38 1806,-438.52 1829.86,-433.08 1854.92,-423.47 1876.48,-413.85"/>
<polygon fill="black" stroke="black" points="1878.16,-416.93 1885.8,-409.59 1875.25,-410.56 1878.16,-416.93"/>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert00 -->
<g id="edge33" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert00</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M950.35,-472.38C819.55,-467.66 599.79,-457.22 521,-438.52 497.23,-432.88 472.22,-423.33 450.62,-413.82"/>
<polygon fill="black" stroke="black" points="451.82,-410.52 441.26,-409.61 448.95,-416.91 451.82,-410.52"/>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert01 -->
<g id="edge34" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M946.63,-467.81C895.14,-462.4 832.66,-453.37 778,-438.52 755.04,-432.28 730.75,-422.91 709.52,-413.71"/>
<polygon fill="black" stroke="black" points="710.87,-410.48 700.31,-409.65 708.05,-416.89 710.87,-410.48"/>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert02 -->
<g id="edge35" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert02</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1005.4,-446.48C989.35,-436.47 971.33,-425.24 955.08,-415.11"/>
<polygon fill="black" stroke="black" points="956.6,-411.94 946.26,-409.62 952.9,-417.88 956.6,-411.94"/>
</g>
<!-- Expert_Select&#45;&gt;GPU1_Expert03 -->
<g id="edge36" class="edge">
<title>Expert_Select&#45;&gt;GPU1_Expert03</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1087.43,-446.48C1099.29,-436.75 1112.57,-425.86 1124.65,-415.96"/>
<polygon fill="black" stroke="black" points="1126.88,-418.66 1132.39,-409.62 1122.44,-413.25 1126.88,-418.66"/>
</g>
<!-- Expert_AllReduce -->
<g id="node25" class="node">
<title>Expert_AllReduce</title>
<ellipse fill="#ff9999" stroke="black" cx="1163" cy="-284.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1163" y="-298.75" font-family="Arial" font-size="10.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1163" y="-287.75" font-family="Arial" font-size="10.00">Expert Outputs</text>
<text text-anchor="middle" x="1163" y="-276.75" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="1163" y="-265.75" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- GPU0_Expert01&#45;&gt;Expert_AllReduce -->
<g id="edge37" class="edge">
<title>GPU0_Expert01&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1353.48,-357.48C1323.7,-346.26 1288.08,-332.85 1255.74,-320.67"/>
<polygon fill="black" stroke="black" points="1256.86,-317.36 1246.27,-317.11 1254.4,-323.91 1256.86,-317.36"/>
</g>
<!-- GPU0_Expert02&#45;&gt;Expert_AllReduce -->
<g id="edge38" class="edge">
<title>GPU0_Expert02&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1583.9,-357.49C1572.19,-354.65 1560.34,-351.92 1549,-349.52 1472.2,-333.31 1386.08,-318.74 1314.7,-307.63"/>
<polygon fill="black" stroke="black" points="1315.15,-304.16 1304.73,-306.09 1314.08,-311.08 1315.15,-304.16"/>
</g>
<!-- GPU0_Expert03&#45;&gt;Expert_AllReduce -->
<g id="edge39" class="edge">
<title>GPU0_Expert03&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1844.17,-357.51C1831.42,-354.51 1818.43,-351.73 1806,-349.52 1649.37,-321.73 1468.97,-305.16 1339.19,-295.91"/>
<polygon fill="black" stroke="black" points="1339.37,-292.42 1329.15,-295.2 1338.88,-299.4 1339.37,-292.42"/>
</g>
<!-- GPU1_Expert00&#45;&gt;Expert_AllReduce -->
<g id="edge40" class="edge">
<title>GPU1_Expert00&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M482.89,-357.44C495.62,-354.47 508.59,-351.71 521,-349.52 677.28,-321.93 857.22,-305.35 986.77,-296.04"/>
<polygon fill="black" stroke="black" points="987.06,-299.53 996.79,-295.33 986.56,-292.55 987.06,-299.53"/>
</g>
<!-- GPU1_Expert01&#45;&gt;Expert_AllReduce -->
<g id="edge41" class="edge">
<title>GPU1_Expert01&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M742.84,-357.51C754.64,-354.66 766.58,-351.92 778,-349.52 854.62,-333.41 940.52,-318.85 1011.71,-307.72"/>
<polygon fill="black" stroke="black" points="1012.31,-311.17 1021.65,-306.17 1011.23,-304.25 1012.31,-311.17"/>
</g>
<!-- GPU1_Expert02&#45;&gt;Expert_AllReduce -->
<g id="edge42" class="edge">
<title>GPU1_Expert02&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M972.52,-357.48C1002.3,-346.26 1037.92,-332.85 1070.26,-320.67"/>
<polygon fill="black" stroke="black" points="1071.6,-323.91 1079.73,-317.11 1069.14,-317.36 1071.6,-323.91"/>
</g>
<!-- GPU1_Expert03&#45;&gt;Expert_AllReduce -->
<g id="edge43" class="edge">
<title>GPU1_Expert03&#45;&gt;Expert_AllReduce</title>
<path fill="none" stroke="black" d="M1163,-357.35C1163,-349.54 1163,-340.68 1163,-331.91"/>
<polygon fill="black" stroke="black" points="1166.5,-331.73 1163,-321.73 1159.5,-331.73 1166.5,-331.73"/>
</g>
<!-- Final_RMSNorm -->
<g id="node26" class="node">
<title>Final_RMSNorm</title>
<polygon fill="#ff99ff" stroke="black" points="1285.5,-211.98 1040.5,-211.98 1040.5,-170.98 1285.5,-170.98 1285.5,-211.98"/>
<text text-anchor="middle" x="1163" y="-199.98" font-family="Arial" font-size="10.00">Final RMSNorm</text>
<text text-anchor="middle" x="1163" y="-188.98" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1163" y="-177.98" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, hidden=1024]</text>
</g>
<!-- Expert_AllReduce&#45;&gt;Final_RMSNorm -->
<g id="edge44" class="edge">
<title>Expert_AllReduce&#45;&gt;Final_RMSNorm</title>
<path fill="none" stroke="black" d="M1163,-247.94C1163,-239.47 1163,-230.52 1163,-222.35"/>
<polygon fill="black" stroke="black" points="1166.5,-222.14 1163,-212.14 1159.5,-222.14 1166.5,-222.14"/>
</g>
<!-- Output_Proj -->
<g id="node27" class="node">
<title>Output_Proj</title>
<polygon fill="#ff99ff" stroke="black" points="1282.5,-134.98 1043.5,-134.98 1043.5,-93.98 1282.5,-93.98 1282.5,-134.98"/>
<text text-anchor="middle" x="1163" y="-122.98" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="1163" y="-111.98" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="1163" y="-100.98" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, vocab_size]</text>
</g>
<!-- Final_RMSNorm&#45;&gt;Output_Proj -->
<g id="edge45" class="edge">
<title>Final_RMSNorm&#45;&gt;Output_Proj</title>
<path fill="none" stroke="black" d="M1163,-170.78C1163,-162.94 1163,-153.75 1163,-145.14"/>
<polygon fill="black" stroke="black" points="1166.5,-145.06 1163,-135.06 1159.5,-145.06 1166.5,-145.06"/>
</g>
<!-- Output -->
<g id="node28" class="node">
<title>Output</title>
<ellipse fill="#ff99ff" stroke="black" cx="1163" cy="-28.99" rx="169" ry="28.98"/>
<text text-anchor="middle" x="1163" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="1163" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=1024, vocab_size]</text>
<text text-anchor="middle" x="1163" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=1024, vocab_size]</text>
</g>
<!-- Output_Proj&#45;&gt;Output -->
<g id="edge46" class="edge">
<title>Output_Proj&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M1163,-93.7C1163,-86.07 1163,-77.08 1163,-68.29"/>
<polygon fill="black" stroke="black" points="1166.5,-68.17 1163,-58.17 1159.5,-68.17 1166.5,-68.17"/>
</g>
</g>
</svg>
