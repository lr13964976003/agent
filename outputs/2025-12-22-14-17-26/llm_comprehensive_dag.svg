<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7062pt" height="2908pt"
 viewBox="0.00 0.00 7062.00 2908.01" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2904.01)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2904.01 7058,-2904.01 7058,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="3526.5" cy="-2863.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-2877.24" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="3526.5" y="-2866.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2855.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2844.24" font-family="Arial" font-size="10.00">GPUs: All</text>
</g>
<!-- layernorm1_s1 -->
<g id="node2" class="node">
<title>layernorm1_s1</title>
<polygon fill="lightblue" stroke="black" points="3633.5,-2790.47 3419.5,-2790.47 3419.5,-2738.47 3633.5,-2738.47 3633.5,-2790.47"/>
<text text-anchor="middle" x="3526.5" y="-2778.47" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3526.5" y="-2767.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2756.47" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2745.47" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- input&#45;&gt;layernorm1_s1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layernorm1_s1</title>
<path fill="none" stroke="black" d="M3526.5,-2826.21C3526.5,-2817.89 3526.5,-2809.06 3526.5,-2800.78"/>
<polygon fill="black" stroke="black" points="3530,-2800.67 3526.5,-2790.67 3523,-2800.67 3530,-2800.67"/>
</g>
<!-- qkv_proj_s1 -->
<g id="node3" class="node">
<title>qkv_proj_s1</title>
<polygon fill="lightblue" stroke="black" points="3646,-2702.47 3407,-2702.47 3407,-2650.47 3646,-2650.47 3646,-2702.47"/>
<text text-anchor="middle" x="3526.5" y="-2690.47" font-family="Arial" font-size="10.00">QKV Projection (TP8)</text>
<text text-anchor="middle" x="3526.5" y="-2679.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2668.47" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-2657.47" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1&#45;&gt;qkv_proj_s1 -->
<g id="edge2" class="edge">
<title>layernorm1_s1&#45;&gt;qkv_proj_s1</title>
<path fill="none" stroke="black" d="M3526.5,-2738.13C3526.5,-2730.17 3526.5,-2721.23 3526.5,-2712.71"/>
<polygon fill="black" stroke="black" points="3530,-2712.63 3526.5,-2702.63 3523,-2712.63 3530,-2712.63"/>
</g>
<!-- allreduce_qkv_s1 -->
<g id="node4" class="node">
<title>allreduce_qkv_s1</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-2577.7" rx="169" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-2591.7" font-family="Arial" font-size="10.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="3526.5" y="-2580.7" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-2569.7" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-2558.7" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1&#45;&gt;allreduce_qkv_s1 -->
<g id="edge3" class="edge">
<title>qkv_proj_s1&#45;&gt;allreduce_qkv_s1</title>
<path fill="none" stroke="black" d="M3526.5,-2650.3C3526.5,-2642.49 3526.5,-2633.62 3526.5,-2624.85"/>
<polygon fill="black" stroke="black" points="3530,-2624.68 3526.5,-2614.68 3523,-2624.68 3530,-2624.68"/>
</g>
<!-- attention_s1 -->
<g id="node5" class="node">
<title>attention_s1</title>
<polygon fill="lightblue" stroke="black" points="3646,-2504.93 3407,-2504.93 3407,-2452.93 3646,-2452.93 3646,-2504.93"/>
<text text-anchor="middle" x="3526.5" y="-2492.93" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3526.5" y="-2481.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-2470.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-2459.93" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1&#45;&gt;attention_s1 -->
<g id="edge4" class="edge">
<title>allreduce_qkv_s1&#45;&gt;attention_s1</title>
<path fill="none" stroke="black" d="M3526.5,-2540.67C3526.5,-2532.35 3526.5,-2523.52 3526.5,-2515.24"/>
<polygon fill="black" stroke="black" points="3530,-2515.13 3526.5,-2505.13 3523,-2515.13 3530,-2515.13"/>
</g>
<!-- attn_out_proj_s1 -->
<g id="node6" class="node">
<title>attn_out_proj_s1</title>
<polygon fill="lightblue" stroke="black" points="3642.5,-2416.93 3410.5,-2416.93 3410.5,-2364.93 3642.5,-2364.93 3642.5,-2416.93"/>
<text text-anchor="middle" x="3526.5" y="-2404.93" font-family="Arial" font-size="10.00">Attention Output Proj (TP8)</text>
<text text-anchor="middle" x="3526.5" y="-2393.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-2382.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2371.93" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1&#45;&gt;attn_out_proj_s1 -->
<g id="edge5" class="edge">
<title>attention_s1&#45;&gt;attn_out_proj_s1</title>
<path fill="none" stroke="black" d="M3526.5,-2452.59C3526.5,-2444.63 3526.5,-2435.69 3526.5,-2427.18"/>
<polygon fill="black" stroke="black" points="3530,-2427.09 3526.5,-2417.09 3523,-2427.09 3530,-2427.09"/>
</g>
<!-- allreduce_attn_out_s1 -->
<g id="node7" class="node">
<title>allreduce_attn_out_s1</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-2292.16" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-2306.16" font-family="Arial" font-size="10.00">All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="3526.5" y="-2295.16" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2284.16" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2273.16" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1&#45;&gt;allreduce_attn_out_s1 -->
<g id="edge6" class="edge">
<title>attn_out_proj_s1&#45;&gt;allreduce_attn_out_s1</title>
<path fill="none" stroke="black" d="M3526.5,-2364.76C3526.5,-2356.95 3526.5,-2348.08 3526.5,-2339.32"/>
<polygon fill="black" stroke="black" points="3530,-2339.14 3526.5,-2329.14 3523,-2339.14 3530,-2339.14"/>
</g>
<!-- moe_gate_s1 -->
<g id="node8" class="node">
<title>moe_gate_s1</title>
<polygon fill="orange" stroke="black" points="3748.23,-2219.39 3395.51,-2219.39 3304.77,-2115.39 3657.49,-2115.39 3748.23,-2219.39"/>
<text text-anchor="middle" x="3526.5" y="-2181.39" font-family="Arial" font-size="10.00">MoE Gate (Router)</text>
<text text-anchor="middle" x="3526.5" y="-2170.39" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2159.39" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2148.39" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1&#45;&gt;moe_gate_s1 -->
<g id="edge7" class="edge">
<title>allreduce_attn_out_s1&#45;&gt;moe_gate_s1</title>
<path fill="none" stroke="black" d="M3526.5,-2255.32C3526.5,-2247.28 3526.5,-2238.53 3526.5,-2229.79"/>
<polygon fill="black" stroke="black" points="3530,-2229.56 3526.5,-2219.56 3523,-2229.56 3530,-2229.56"/>
</g>
<!-- expert_dispatch_s1 -->
<g id="node9" class="node">
<title>expert_dispatch_s1</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-2042.62" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-2056.62" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="3526.5" y="-2045.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2034.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-2023.62" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1&#45;&gt;expert_dispatch_s1 -->
<g id="edge8" class="edge">
<title>moe_gate_s1&#45;&gt;expert_dispatch_s1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3526.5,-2115.04C3526.5,-2106.63 3526.5,-2097.96 3526.5,-2089.69"/>
<polygon fill="black" stroke="black" points="3530,-2089.48 3526.5,-2079.48 3523,-2089.48 3530,-2089.48"/>
</g>
<!-- expert_0_s1 -->
<g id="node10" class="node">
<title>expert_0_s1</title>
<polygon fill="lightblue" stroke="black" points="203,-1969.85 0,-1969.85 0,-1917.85 203,-1917.85 203,-1969.85"/>
<text text-anchor="middle" x="101.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="101.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="101.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="101.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_0_s1 -->
<g id="edge9" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_0_s1</title>
<path fill="none" stroke="black" d="M3375.51,-2040.15C2774.89,-2034.04 570.84,-2009.23 213.29,-1969.9"/>
<polygon fill="black" stroke="black" points="213.59,-1966.42 203.25,-1968.74 212.78,-1973.37 213.59,-1966.42"/>
</g>
<!-- expert_1_s1 -->
<g id="node11" class="node">
<title>expert_1_s1</title>
<polygon fill="lightblue" stroke="black" points="424,-1969.85 221,-1969.85 221,-1917.85 424,-1917.85 424,-1969.85"/>
<text text-anchor="middle" x="322.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="322.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="322.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="322.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_1_s1 -->
<g id="edge10" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_1_s1</title>
<path fill="none" stroke="black" d="M3375.1,-2042.12C2839.1,-2043.27 1032.15,-2041.67 434.27,-1969.95"/>
<polygon fill="black" stroke="black" points="434.6,-1966.47 424.25,-1968.73 433.76,-1973.42 434.6,-1966.47"/>
</g>
<!-- expert_2_s1 -->
<g id="node12" class="node">
<title>expert_2_s1</title>
<polygon fill="lightblue" stroke="black" points="645,-1969.85 442,-1969.85 442,-1917.85 645,-1917.85 645,-1969.85"/>
<text text-anchor="middle" x="543.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="543.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="543.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="543.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_2_s1 -->
<g id="edge11" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_2_s1</title>
<path fill="none" stroke="black" d="M3374.93,-2041.8C2864.21,-2041.8 1207.82,-2036.59 655.31,-1969.96"/>
<polygon fill="black" stroke="black" points="655.61,-1966.47 645.26,-1968.73 654.75,-1973.42 655.61,-1966.47"/>
</g>
<!-- expert_3_s1 -->
<g id="node13" class="node">
<title>expert_3_s1</title>
<polygon fill="lightblue" stroke="black" points="866,-1969.85 663,-1969.85 663,-1917.85 866,-1917.85 866,-1969.85"/>
<text text-anchor="middle" x="764.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="764.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="764.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="764.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_3_s1 -->
<g id="edge12" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_3_s1</title>
<path fill="none" stroke="black" d="M3374.83,-2041.43C2890.46,-2040.21 1383.37,-2031.52 876.22,-1969.95"/>
<polygon fill="black" stroke="black" points="876.61,-1966.47 866.26,-1968.72 875.75,-1973.42 876.61,-1966.47"/>
</g>
<!-- expert_4_s1 -->
<g id="node14" class="node">
<title>expert_4_s1</title>
<polygon fill="lightblue" stroke="black" points="1087,-1969.85 884,-1969.85 884,-1917.85 1087,-1917.85 1087,-1969.85"/>
<text text-anchor="middle" x="985.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="985.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="985.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="985.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_4_s1 -->
<g id="edge13" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_4_s1</title>
<path fill="none" stroke="black" d="M3375.09,-2040.99C2918.65,-2038.5 1559.59,-2026.49 1097.34,-1969.97"/>
<polygon fill="black" stroke="black" points="1097.61,-1966.47 1087.26,-1968.71 1096.75,-1973.42 1097.61,-1966.47"/>
</g>
<!-- expert_5_s1 -->
<g id="node15" class="node">
<title>expert_5_s1</title>
<polygon fill="lightblue" stroke="black" points="1308,-1969.85 1105,-1969.85 1105,-1917.85 1308,-1917.85 1308,-1969.85"/>
<text text-anchor="middle" x="1206.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1206.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_5_s1 -->
<g id="edge14" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_5_s1</title>
<path fill="none" stroke="black" d="M3375.26,-2040.47C2947.85,-2036.63 1735.55,-2021.48 1318.27,-1969.96"/>
<polygon fill="black" stroke="black" points="1318.62,-1966.48 1308.26,-1968.7 1317.74,-1973.42 1318.62,-1966.48"/>
</g>
<!-- expert_6_s1 -->
<g id="node16" class="node">
<title>expert_6_s1</title>
<polygon fill="lightblue" stroke="black" points="1529,-1969.85 1326,-1969.85 1326,-1917.85 1529,-1917.85 1529,-1969.85"/>
<text text-anchor="middle" x="1427.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="1427.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1427.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1427.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_6_s1 -->
<g id="edge15" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_6_s1</title>
<path fill="none" stroke="black" d="M3375.49,-2039.84C2978.63,-2034.56 1911.84,-2016.49 1539.27,-1969.96"/>
<polygon fill="black" stroke="black" points="1539.62,-1966.48 1529.26,-1968.68 1538.74,-1973.42 1539.62,-1966.48"/>
</g>
<!-- expert_7_s1 -->
<g id="node17" class="node">
<title>expert_7_s1</title>
<polygon fill="lightblue" stroke="black" points="1750,-1969.85 1547,-1969.85 1547,-1917.85 1750,-1917.85 1750,-1969.85"/>
<text text-anchor="middle" x="1648.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="1648.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1648.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1648.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_7_s1 -->
<g id="edge16" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_7_s1</title>
<path fill="none" stroke="black" d="M3375.74,-2039.05C3011.16,-2032.25 2088.3,-2011.53 1760.27,-1969.97"/>
<polygon fill="black" stroke="black" points="1760.63,-1966.48 1750.26,-1968.67 1759.73,-1973.43 1760.63,-1966.48"/>
</g>
<!-- expert_8_s1 -->
<g id="node18" class="node">
<title>expert_8_s1</title>
<polygon fill="lightblue" stroke="black" points="1971,-1969.85 1768,-1969.85 1768,-1917.85 1971,-1917.85 1971,-1969.85"/>
<text text-anchor="middle" x="1869.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="1869.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1869.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1869.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_8_s1 -->
<g id="edge17" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_8_s1</title>
<path fill="none" stroke="black" d="M3376.31,-2038.04C3046.34,-2029.64 2265.62,-2006.63 1981.57,-1970.01"/>
<polygon fill="black" stroke="black" points="1981.64,-1966.49 1971.27,-1968.65 1980.72,-1973.43 1981.64,-1966.49"/>
</g>
<!-- expert_9_s1 -->
<g id="node19" class="node">
<title>expert_9_s1</title>
<polygon fill="lightblue" stroke="black" points="2192,-1969.85 1989,-1969.85 1989,-1917.85 2192,-1917.85 2192,-1969.85"/>
<text text-anchor="middle" x="2090.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="2090.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2090.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2090.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_9_s1 -->
<g id="edge18" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_9_s1</title>
<path fill="none" stroke="black" d="M3375.06,-2041.74C3129.9,-2040.09 2631.07,-2029.06 2202.38,-1970.02"/>
<polygon fill="black" stroke="black" points="2202.66,-1966.53 2192.27,-1968.62 2201.69,-1973.46 2202.66,-1966.53"/>
</g>
<!-- expert_10_s1 -->
<g id="node20" class="node">
<title>expert_10_s1</title>
<polygon fill="lightblue" stroke="black" points="2413,-1969.85 2210,-1969.85 2210,-1917.85 2413,-1917.85 2413,-1969.85"/>
<text text-anchor="middle" x="2311.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="2311.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2311.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2311.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_10_s1 -->
<g id="edge19" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_10_s1</title>
<path fill="none" stroke="black" d="M3375.58,-2039.39C3164.12,-2034.55 2767.78,-2019.31 2423.2,-1970.01"/>
<polygon fill="black" stroke="black" points="2423.67,-1966.54 2413.27,-1968.58 2422.67,-1973.47 2423.67,-1966.54"/>
</g>
<!-- expert_11_s1 -->
<g id="node21" class="node">
<title>expert_11_s1</title>
<polygon fill="lightblue" stroke="black" points="2634,-1969.85 2431,-1969.85 2431,-1917.85 2634,-1917.85 2634,-1969.85"/>
<text text-anchor="middle" x="2532.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="2532.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2532.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2532.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_11_s1 -->
<g id="edge20" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_11_s1</title>
<path fill="none" stroke="black" d="M3377.55,-2036.01C3203.47,-2027.97 2906.79,-2009.7 2644.39,-1970.06"/>
<polygon fill="black" stroke="black" points="2644.7,-1966.57 2634.28,-1968.52 2643.64,-1973.49 2644.7,-1966.57"/>
</g>
<!-- expert_12_s1 -->
<g id="node22" class="node">
<title>expert_12_s1</title>
<polygon fill="lightblue" stroke="black" points="2855,-1969.85 2652,-1969.85 2652,-1917.85 2855,-1917.85 2855,-1969.85"/>
<text text-anchor="middle" x="2753.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="2753.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2753.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2753.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_12_s1 -->
<g id="edge21" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_12_s1</title>
<path fill="none" stroke="black" d="M3382.94,-2030.9C3250.64,-2019.91 3048.8,-2000.31 2865.12,-1970.05"/>
<polygon fill="black" stroke="black" points="2865.44,-1966.56 2855,-1968.37 2864.29,-1973.46 2865.44,-1966.56"/>
</g>
<!-- expert_13_s1 -->
<g id="node23" class="node">
<title>expert_13_s1</title>
<polygon fill="lightblue" stroke="black" points="3076,-1969.85 2873,-1969.85 2873,-1917.85 3076,-1917.85 3076,-1969.85"/>
<text text-anchor="middle" x="2974.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="2974.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2974.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2974.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_13_s1 -->
<g id="edge22" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_13_s1</title>
<path fill="none" stroke="black" d="M3398.47,-2023C3312.61,-2009.99 3196.82,-1991.47 3086.05,-1970.11"/>
<polygon fill="black" stroke="black" points="3086.52,-1966.64 3076.04,-1968.17 3085.19,-1973.51 3086.52,-1966.64"/>
</g>
<!-- expert_14_s1 -->
<g id="node24" class="node">
<title>expert_14_s1</title>
<polygon fill="lightblue" stroke="black" points="3297,-1969.85 3094,-1969.85 3094,-1917.85 3297,-1917.85 3297,-1969.85"/>
<text text-anchor="middle" x="3195.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="3195.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3195.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3195.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_14_s1 -->
<g id="edge23" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_14_s1</title>
<path fill="none" stroke="black" d="M3431.65,-2013.89C3387.42,-2000.96 3334.91,-1985.61 3290.64,-1972.67"/>
<polygon fill="black" stroke="black" points="3291.62,-1969.31 3281.04,-1969.86 3289.66,-1976.03 3291.62,-1969.31"/>
</g>
<!-- expert_15_s1 -->
<g id="node25" class="node">
<title>expert_15_s1</title>
<polygon fill="lightblue" stroke="black" points="3518,-1969.85 3315,-1969.85 3315,-1917.85 3518,-1917.85 3518,-1969.85"/>
<text text-anchor="middle" x="3416.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="3416.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3416.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3416.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_15_s1 -->
<g id="edge24" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_15_s1</title>
<path fill="none" stroke="black" d="M3487.1,-2006.96C3475.89,-1997.1 3463.73,-1986.4 3452.72,-1976.72"/>
<polygon fill="black" stroke="black" points="3454.75,-1973.84 3444.93,-1969.87 3450.13,-1979.1 3454.75,-1973.84"/>
</g>
<!-- expert_16_s1 -->
<g id="node26" class="node">
<title>expert_16_s1</title>
<polygon fill="lightblue" stroke="black" points="3739,-1969.85 3536,-1969.85 3536,-1917.85 3739,-1917.85 3739,-1969.85"/>
<text text-anchor="middle" x="3637.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 16</text>
<text text-anchor="middle" x="3637.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_16_s1 -->
<g id="edge25" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_16_s1</title>
<path fill="none" stroke="black" d="M3566.26,-2006.96C3577.57,-1997.1 3589.84,-1986.4 3600.95,-1976.72"/>
<polygon fill="black" stroke="black" points="3603.57,-1979.08 3608.81,-1969.87 3598.97,-1973.8 3603.57,-1979.08"/>
</g>
<!-- expert_17_s1 -->
<g id="node27" class="node">
<title>expert_17_s1</title>
<polygon fill="lightblue" stroke="black" points="3960,-1969.85 3757,-1969.85 3757,-1917.85 3960,-1917.85 3960,-1969.85"/>
<text text-anchor="middle" x="3858.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 17</text>
<text text-anchor="middle" x="3858.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3858.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3858.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_17_s1 -->
<g id="edge26" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_17_s1</title>
<path fill="none" stroke="black" d="M3621.64,-2013.89C3666,-2000.96 3718.67,-1985.61 3763.07,-1972.67"/>
<polygon fill="black" stroke="black" points="3764.08,-1976.02 3772.7,-1969.86 3762.12,-1969.3 3764.08,-1976.02"/>
</g>
<!-- expert_18_s1 -->
<g id="node28" class="node">
<title>expert_18_s1</title>
<polygon fill="lightblue" stroke="black" points="4181,-1969.85 3978,-1969.85 3978,-1917.85 4181,-1917.85 4181,-1969.85"/>
<text text-anchor="middle" x="4079.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 18</text>
<text text-anchor="middle" x="4079.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4079.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4079.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_18_s1 -->
<g id="edge27" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_18_s1</title>
<path fill="none" stroke="black" d="M3654.82,-2023.01C3740.88,-2010.02 3856.93,-1991.5 3967.93,-1970.12"/>
<polygon fill="black" stroke="black" points="3968.81,-1973.51 3977.96,-1968.17 3967.48,-1966.64 3968.81,-1973.51"/>
</g>
<!-- expert_19_s1 -->
<g id="node29" class="node">
<title>expert_19_s1</title>
<polygon fill="lightblue" stroke="black" points="4402,-1969.85 4199,-1969.85 4199,-1917.85 4402,-1917.85 4402,-1969.85"/>
<text text-anchor="middle" x="4300.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 19</text>
<text text-anchor="middle" x="4300.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4300.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4300.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_19_s1 -->
<g id="edge28" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_19_s1</title>
<path fill="none" stroke="black" d="M3670.28,-2030.92C3802.78,-2019.93 4004.92,-2000.34 4188.86,-1970.05"/>
<polygon fill="black" stroke="black" points="4189.7,-1973.46 4199,-1968.37 4188.56,-1966.56 4189.7,-1973.46"/>
</g>
<!-- expert_20_s1 -->
<g id="node30" class="node">
<title>expert_20_s1</title>
<polygon fill="lightblue" stroke="black" points="4623,-1969.85 4420,-1969.85 4420,-1917.85 4623,-1917.85 4623,-1969.85"/>
<text text-anchor="middle" x="4521.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 20</text>
<text text-anchor="middle" x="4521.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4521.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4521.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_20_s1 -->
<g id="edge29" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_20_s1</title>
<path fill="none" stroke="black" d="M3675.62,-2036.02C3849.89,-2028 4146.91,-2009.73 4409.6,-1970.06"/>
<polygon fill="black" stroke="black" points="4410.36,-1973.49 4419.72,-1968.52 4409.3,-1966.57 4410.36,-1973.49"/>
</g>
<!-- expert_21_s1 -->
<g id="node31" class="node">
<title>expert_21_s1</title>
<polygon fill="lightblue" stroke="black" points="4844,-1969.85 4641,-1969.85 4641,-1917.85 4844,-1917.85 4844,-1969.85"/>
<text text-anchor="middle" x="4742.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 21</text>
<text text-anchor="middle" x="4742.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4742.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4742.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_21_s1 -->
<g id="edge30" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_21_s1</title>
<path fill="none" stroke="black" d="M3677.56,-2039.4C3889.21,-2034.58 4285.9,-2019.34 4630.79,-1970.01"/>
<polygon fill="black" stroke="black" points="4631.33,-1973.47 4640.73,-1968.58 4630.33,-1966.54 4631.33,-1973.47"/>
</g>
<!-- expert_22_s1 -->
<g id="node32" class="node">
<title>expert_22_s1</title>
<polygon fill="lightblue" stroke="black" points="5065,-1969.85 4862,-1969.85 4862,-1917.85 5065,-1917.85 5065,-1969.85"/>
<text text-anchor="middle" x="4963.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 22</text>
<text text-anchor="middle" x="4963.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4963.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4963.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_22_s1 -->
<g id="edge31" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_22_s1</title>
<path fill="none" stroke="black" d="M3677.8,-2041.75C3923.06,-2040.11 4422.46,-2029.12 4851.61,-1970.02"/>
<polygon fill="black" stroke="black" points="4852.31,-1973.46 4861.73,-1968.62 4851.34,-1966.53 4852.31,-1973.46"/>
</g>
<!-- expert_23_s1 -->
<g id="node33" class="node">
<title>expert_23_s1</title>
<polygon fill="lightblue" stroke="black" points="5286,-1969.85 5083,-1969.85 5083,-1917.85 5286,-1917.85 5286,-1969.85"/>
<text text-anchor="middle" x="5184.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 23</text>
<text text-anchor="middle" x="5184.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5184.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5184.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_23_s1 -->
<g id="edge32" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_23_s1</title>
<path fill="none" stroke="black" d="M3676.79,-2038.05C4006.97,-2029.65 4788.2,-2006.65 5072.43,-1970.01"/>
<polygon fill="black" stroke="black" points="5073.28,-1973.43 5082.73,-1968.65 5072.36,-1966.49 5073.28,-1973.43"/>
</g>
<!-- expert_24_s1 -->
<g id="node34" class="node">
<title>expert_24_s1</title>
<polygon fill="lightblue" stroke="black" points="5507,-1969.85 5304,-1969.85 5304,-1917.85 5507,-1917.85 5507,-1969.85"/>
<text text-anchor="middle" x="5405.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 24</text>
<text text-anchor="middle" x="5405.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5405.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5405.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_24_s1 -->
<g id="edge33" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_24_s1</title>
<path fill="none" stroke="black" d="M3677.34,-2039.05C4042.13,-2032.26 4965.52,-2011.55 5293.73,-1969.97"/>
<polygon fill="black" stroke="black" points="5294.27,-1973.43 5303.74,-1968.67 5293.37,-1966.48 5294.27,-1973.43"/>
</g>
<!-- expert_25_s1 -->
<g id="node35" class="node">
<title>expert_25_s1</title>
<polygon fill="lightblue" stroke="black" points="5728,-1969.85 5525,-1969.85 5525,-1917.85 5728,-1917.85 5728,-1969.85"/>
<text text-anchor="middle" x="5626.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 25</text>
<text text-anchor="middle" x="5626.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5626.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5626.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_25_s1 -->
<g id="edge34" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_25_s1</title>
<path fill="none" stroke="black" d="M3677.59,-2039.84C4074.64,-2034.57 5141.97,-2016.51 5514.72,-1969.96"/>
<polygon fill="black" stroke="black" points="5515.26,-1973.42 5524.74,-1968.68 5514.38,-1966.48 5515.26,-1973.42"/>
</g>
<!-- expert_26_s1 -->
<g id="node36" class="node">
<title>expert_26_s1</title>
<polygon fill="lightblue" stroke="black" points="5949,-1969.85 5746,-1969.85 5746,-1917.85 5949,-1917.85 5949,-1969.85"/>
<text text-anchor="middle" x="5847.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 26</text>
<text text-anchor="middle" x="5847.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5847.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5847.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_26_s1 -->
<g id="edge35" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_26_s1</title>
<path fill="none" stroke="black" d="M3677.81,-2040.47C4105.41,-2036.64 5318.26,-2021.5 5735.73,-1969.96"/>
<polygon fill="black" stroke="black" points="5736.26,-1973.42 5745.74,-1968.7 5735.38,-1966.48 5736.26,-1973.42"/>
</g>
<!-- expert_27_s1 -->
<g id="node37" class="node">
<title>expert_27_s1</title>
<polygon fill="lightblue" stroke="black" points="6170,-1969.85 5967,-1969.85 5967,-1917.85 6170,-1917.85 6170,-1969.85"/>
<text text-anchor="middle" x="6068.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 27</text>
<text text-anchor="middle" x="6068.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6068.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6068.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_27_s1 -->
<g id="edge36" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_27_s1</title>
<path fill="none" stroke="black" d="M3677.97,-2041C4134.6,-2038.51 5494.21,-2026.51 5956.65,-1969.97"/>
<polygon fill="black" stroke="black" points="5957.25,-1973.42 5966.74,-1968.71 5956.39,-1966.47 5957.25,-1973.42"/>
</g>
<!-- expert_28_s1 -->
<g id="node38" class="node">
<title>expert_28_s1</title>
<polygon fill="lightblue" stroke="black" points="6391,-1969.85 6188,-1969.85 6188,-1917.85 6391,-1917.85 6391,-1969.85"/>
<text text-anchor="middle" x="6289.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 28</text>
<text text-anchor="middle" x="6289.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6289.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6289.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_28_s1 -->
<g id="edge37" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_28_s1</title>
<path fill="none" stroke="black" d="M3677.8,-2041.43C4161.89,-2040.22 5670.29,-2031.56 6177.77,-1969.95"/>
<polygon fill="black" stroke="black" points="6178.25,-1973.42 6187.74,-1968.72 6177.39,-1966.47 6178.25,-1973.42"/>
</g>
<!-- expert_29_s1 -->
<g id="node39" class="node">
<title>expert_29_s1</title>
<polygon fill="lightblue" stroke="black" points="6612,-1969.85 6409,-1969.85 6409,-1917.85 6612,-1917.85 6612,-1969.85"/>
<text text-anchor="middle" x="6510.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 29</text>
<text text-anchor="middle" x="6510.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6510.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6510.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_29_s1 -->
<g id="edge38" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_29_s1</title>
<path fill="none" stroke="black" d="M3678.12,-2041.8C4189.02,-2041.8 5845.99,-2036.61 6398.69,-1969.96"/>
<polygon fill="black" stroke="black" points="6399.25,-1973.42 6408.74,-1968.73 6398.39,-1966.47 6399.25,-1973.42"/>
</g>
<!-- expert_30_s1 -->
<g id="node40" class="node">
<title>expert_30_s1</title>
<polygon fill="lightblue" stroke="black" points="6833,-1969.85 6630,-1969.85 6630,-1917.85 6833,-1917.85 6833,-1969.85"/>
<text text-anchor="middle" x="6731.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 30</text>
<text text-anchor="middle" x="6731.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6731.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6731.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_30_s1 -->
<g id="edge39" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_30_s1</title>
<path fill="none" stroke="black" d="M3677.95,-2042.12C4214.12,-2043.28 6021.65,-2041.69 6619.73,-1969.95"/>
<polygon fill="black" stroke="black" points="6620.24,-1973.42 6629.75,-1968.73 6619.4,-1966.47 6620.24,-1973.42"/>
</g>
<!-- expert_31_s1 -->
<g id="node41" class="node">
<title>expert_31_s1</title>
<polygon fill="lightblue" stroke="black" points="7054,-1969.85 6851,-1969.85 6851,-1917.85 7054,-1917.85 7054,-1969.85"/>
<text text-anchor="middle" x="6952.5" y="-1957.85" font-family="Arial" font-size="10.00">Expert 31</text>
<text text-anchor="middle" x="6952.5" y="-1946.85" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6952.5" y="-1935.85" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6952.5" y="-1924.85" font-family="Arial" font-size="10.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1&#45;&gt;expert_31_s1 -->
<g id="edge40" class="edge">
<title>expert_dispatch_s1&#45;&gt;expert_31_s1</title>
<path fill="none" stroke="black" d="M3677.54,-2040.15C4278.34,-2034.04 6483.05,-2009.24 6840.71,-1969.91"/>
<polygon fill="black" stroke="black" points="6841.22,-1973.37 6850.75,-1968.74 6840.41,-1966.42 6841.22,-1973.37"/>
</g>
<!-- expert_combine_s1 -->
<g id="node42" class="node">
<title>expert_combine_s1</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-1845.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-1859.08" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="3526.5" y="-1848.08" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3526.5" y="-1837.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1826.08" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1&#45;&gt;expert_combine_s1 -->
<g id="edge41" class="edge">
<title>expert_0_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M203.25,-1918.97C206.03,-1918.56 208.78,-1918.19 211.5,-1917.85 525.44,-1879.18 2743.85,-1854.01 3365.14,-1847.66"/>
<polygon fill="black" stroke="black" points="3365.55,-1851.16 3375.51,-1847.56 3365.47,-1844.16 3365.55,-1851.16"/>
</g>
<!-- expert_1_s1&#45;&gt;expert_combine_s1 -->
<g id="edge42" class="edge">
<title>expert_1_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M424.25,-1918.97C427.03,-1918.56 429.78,-1918.19 432.5,-1917.85 1008.17,-1846.49 2813.85,-1844.45 3365.09,-1845.56"/>
<polygon fill="black" stroke="black" points="3365.1,-1849.06 3375.1,-1845.58 3365.11,-1842.06 3365.1,-1849.06"/>
</g>
<!-- expert_2_s1&#45;&gt;expert_combine_s1 -->
<g id="edge43" class="edge">
<title>expert_2_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M645.26,-1918.98C648.03,-1918.57 650.78,-1918.19 653.5,-1917.85 1183.91,-1851.62 2839.06,-1845.98 3364.62,-1845.9"/>
<polygon fill="black" stroke="black" points="3364.93,-1849.4 3374.93,-1845.9 3364.93,-1842.4 3364.93,-1849.4"/>
</g>
<!-- expert_3_s1&#45;&gt;expert_combine_s1 -->
<g id="edge44" class="edge">
<title>expert_3_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M866.26,-1918.99C869.03,-1918.57 871.78,-1918.19 874.5,-1917.85 1359.98,-1856.72 2866.46,-1847.62 3364.69,-1846.3"/>
<polygon fill="black" stroke="black" points="3364.84,-1849.8 3374.83,-1846.27 3364.82,-1842.8 3364.84,-1849.8"/>
</g>
<!-- expert_4_s1&#45;&gt;expert_combine_s1 -->
<g id="edge45" class="edge">
<title>expert_4_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M1087.26,-1919C1090.03,-1918.58 1092.78,-1918.2 1095.5,-1917.85 1536.24,-1861.8 2895.18,-1849.4 3364.84,-1846.77"/>
<polygon fill="black" stroke="black" points="3365.11,-1850.27 3375.09,-1846.71 3365.07,-1843.27 3365.11,-1850.27"/>
</g>
<!-- expert_5_s1&#45;&gt;expert_combine_s1 -->
<g id="edge46" class="edge">
<title>expert_5_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M1308.26,-1919.01C1311.03,-1918.59 1313.78,-1918.2 1316.5,-1917.85 1712.69,-1866.87 2925.23,-1851.35 3365.02,-1847.33"/>
<polygon fill="black" stroke="black" points="3365.3,-1850.82 3375.26,-1847.23 3365.23,-1843.82 3365.3,-1850.82"/>
</g>
<!-- expert_6_s1&#45;&gt;expert_combine_s1 -->
<g id="edge47" class="edge">
<title>expert_6_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M1529.26,-1919.02C1532.03,-1918.6 1534.78,-1918.21 1537.5,-1917.85 1889.39,-1871.93 2957.09,-1853.5 3365.38,-1848"/>
<polygon fill="black" stroke="black" points="3365.54,-1851.5 3375.49,-1847.87 3365.44,-1844.5 3365.54,-1851.5"/>
</g>
<!-- expert_7_s1&#45;&gt;expert_combine_s1 -->
<g id="edge48" class="edge">
<title>expert_7_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M1750.26,-1919.04C1753.03,-1918.61 1755.78,-1918.21 1758.5,-1917.85 2066.31,-1876.98 2990.48,-1855.9 3365.62,-1848.85"/>
<polygon fill="black" stroke="black" points="3365.81,-1852.34 3375.74,-1848.66 3365.68,-1845.35 3365.81,-1852.34"/>
</g>
<!-- expert_8_s1&#45;&gt;expert_combine_s1 -->
<g id="edge49" class="edge">
<title>expert_8_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M1971.27,-1919.06C1974.03,-1918.62 1976.78,-1918.22 1979.5,-1917.85 2243.58,-1882 3026.38,-1858.64 3366.14,-1849.92"/>
<polygon fill="black" stroke="black" points="3366.4,-1853.41 3376.31,-1849.66 3366.22,-1846.42 3366.4,-1853.41"/>
</g>
<!-- expert_9_s1&#45;&gt;expert_combine_s1 -->
<g id="edge50" class="edge">
<title>expert_9_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M2192.27,-1919.08C2195.04,-1918.64 2197.78,-1918.23 2200.5,-1917.85 2617.41,-1859.62 3114.18,-1847.95 3364.79,-1846.04"/>
<polygon fill="black" stroke="black" points="3365.09,-1849.54 3375.06,-1845.96 3365.04,-1842.54 3365.09,-1849.54"/>
</g>
<!-- expert_10_s1&#45;&gt;expert_combine_s1 -->
<g id="edge51" class="edge">
<title>expert_10_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M2413.27,-1919.12C2416.04,-1918.67 2418.79,-1918.25 2421.5,-1917.85 2754.85,-1869.46 3149.54,-1853.69 3365.43,-1848.55"/>
<polygon fill="black" stroke="black" points="3365.66,-1852.05 3375.58,-1848.32 3365.5,-1845.05 3365.66,-1852.05"/>
</g>
<!-- expert_11_s1&#45;&gt;expert_combine_s1 -->
<g id="edge52" class="edge">
<title>expert_11_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M2634.28,-1919.18C2637.05,-1918.71 2639.79,-1918.27 2642.5,-1917.85 2894.25,-1879.23 3189.74,-1860.55 3367.34,-1852.17"/>
<polygon fill="black" stroke="black" points="3367.72,-1855.66 3377.55,-1851.7 3367.4,-1848.67 3367.72,-1855.66"/>
</g>
<!-- expert_12_s1&#45;&gt;expert_combine_s1 -->
<g id="edge53" class="edge">
<title>expert_12_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M2855,-1919.33C2857.86,-1918.82 2860.7,-1918.32 2863.5,-1917.85 3037.01,-1888.84 3238.12,-1868.99 3372.94,-1857.64"/>
<polygon fill="black" stroke="black" points="3373.26,-1861.12 3382.94,-1856.8 3372.68,-1854.15 3373.26,-1861.12"/>
</g>
<!-- expert_13_s1&#45;&gt;expert_combine_s1 -->
<g id="edge54" class="edge">
<title>expert_13_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M3076.04,-1919.53C3078.89,-1918.96 3081.71,-1918.39 3084.5,-1917.85 3185.9,-1898.12 3301.12,-1879.53 3388.49,-1866.22"/>
<polygon fill="black" stroke="black" points="3389.11,-1869.67 3398.47,-1864.71 3388.06,-1862.75 3389.11,-1869.67"/>
</g>
<!-- expert_14_s1&#45;&gt;expert_combine_s1 -->
<g id="edge55" class="edge">
<title>expert_14_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M3281.17,-1917.81C3324.09,-1905.26 3376.43,-1889.96 3421.72,-1876.72"/>
<polygon fill="black" stroke="black" points="3422.95,-1880 3431.57,-1873.84 3420.99,-1873.28 3422.95,-1880"/>
</g>
<!-- expert_15_s1&#45;&gt;expert_combine_s1 -->
<g id="edge56" class="edge">
<title>expert_15_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M3445.11,-1917.68C3455.66,-1908.4 3467.91,-1897.63 3479.65,-1887.3"/>
<polygon fill="black" stroke="black" points="3482.07,-1889.83 3487.26,-1880.6 3477.44,-1884.58 3482.07,-1889.83"/>
</g>
<!-- expert_16_s1&#45;&gt;expert_combine_s1 -->
<g id="edge57" class="edge">
<title>expert_16_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M3608.63,-1917.68C3597.98,-1908.4 3585.63,-1897.63 3573.78,-1887.3"/>
<polygon fill="black" stroke="black" points="3575.93,-1884.53 3566.09,-1880.6 3571.33,-1889.81 3575.93,-1884.53"/>
</g>
<!-- expert_17_s1&#45;&gt;expert_combine_s1 -->
<g id="edge58" class="edge">
<title>expert_17_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M3772.57,-1917.81C3729.34,-1905.21 3676.59,-1889.83 3631.03,-1876.55"/>
<polygon fill="black" stroke="black" points="3632,-1873.19 3621.42,-1873.75 3630.04,-1879.91 3632,-1873.19"/>
</g>
<!-- expert_18_s1&#45;&gt;expert_combine_s1 -->
<g id="edge59" class="edge">
<title>expert_18_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M3977.96,-1919.53C3975.11,-1918.95 3972.29,-1918.39 3969.5,-1917.85 3867.87,-1898.09 3752.39,-1879.51 3664.82,-1866.2"/>
<polygon fill="black" stroke="black" points="3665.24,-1862.73 3654.82,-1864.69 3664.19,-1869.65 3665.24,-1862.73"/>
</g>
<!-- expert_19_s1&#45;&gt;expert_combine_s1 -->
<g id="edge60" class="edge">
<title>expert_19_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M4199,-1919.33C4196.14,-1918.82 4193.3,-1918.32 4190.5,-1917.85 4016.73,-1888.81 3815.31,-1868.96 3680.29,-1857.62"/>
<polygon fill="black" stroke="black" points="3680.54,-1854.13 3670.28,-1856.79 3679.96,-1861.11 3680.54,-1854.13"/>
</g>
<!-- expert_20_s1&#45;&gt;expert_combine_s1 -->
<g id="edge61" class="edge">
<title>expert_20_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M4419.72,-1919.18C4416.95,-1918.71 4414.21,-1918.27 4411.5,-1917.85 4159.46,-1879.19 3863.64,-1860.53 3685.84,-1852.16"/>
<polygon fill="black" stroke="black" points="3685.77,-1848.65 3675.62,-1851.68 3685.45,-1855.65 3685.77,-1848.65"/>
</g>
<!-- expert_21_s1&#45;&gt;expert_combine_s1 -->
<g id="edge62" class="edge">
<title>expert_21_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M4640.73,-1919.12C4637.96,-1918.67 4635.21,-1918.25 4632.5,-1917.85 4298.84,-1869.42 3903.8,-1853.67 3687.71,-1848.54"/>
<polygon fill="black" stroke="black" points="3687.64,-1845.04 3677.56,-1848.31 3687.47,-1852.04 3687.64,-1845.04"/>
</g>
<!-- expert_22_s1&#45;&gt;expert_combine_s1 -->
<g id="edge63" class="edge">
<title>expert_22_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M4861.73,-1919.08C4858.96,-1918.64 4856.22,-1918.23 4853.5,-1917.85 4436.13,-1859.57 3938.8,-1847.92 3688.08,-1846.03"/>
<polygon fill="black" stroke="black" points="3687.82,-1842.53 3677.8,-1845.95 3687.77,-1849.53 3687.82,-1842.53"/>
</g>
<!-- expert_23_s1&#45;&gt;expert_combine_s1 -->
<g id="edge64" class="edge">
<title>expert_23_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M5082.73,-1919.06C5079.97,-1918.62 5077.22,-1918.22 5074.5,-1917.85 4810.24,-1881.99 4026.95,-1858.63 3686.97,-1849.92"/>
<polygon fill="black" stroke="black" points="3686.88,-1846.41 3676.79,-1849.66 3686.7,-1853.41 3686.88,-1846.41"/>
</g>
<!-- expert_24_s1&#45;&gt;expert_combine_s1 -->
<g id="edge65" class="edge">
<title>expert_24_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M5303.74,-1919.04C5300.97,-1918.61 5298.22,-1918.21 5295.5,-1917.85 4987.52,-1876.96 4062.82,-1855.89 3687.47,-1848.84"/>
<polygon fill="black" stroke="black" points="3687.41,-1845.34 3677.34,-1848.65 3687.28,-1852.34 3687.41,-1845.34"/>
</g>
<!-- expert_25_s1&#45;&gt;expert_combine_s1 -->
<g id="edge66" class="edge">
<title>expert_25_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M5524.74,-1919.02C5521.97,-1918.6 5519.22,-1918.21 5516.5,-1917.85 5164.43,-1871.91 4096.19,-1853.49 3687.71,-1848"/>
<polygon fill="black" stroke="black" points="3687.63,-1844.5 3677.59,-1847.87 3687.54,-1851.5 3687.63,-1844.5"/>
</g>
<!-- expert_26_s1&#45;&gt;expert_combine_s1 -->
<g id="edge67" class="edge">
<title>expert_26_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M5745.74,-1919.01C5742.97,-1918.59 5740.22,-1918.2 5737.5,-1917.85 5341.14,-1866.85 4128.04,-1851.34 3688.05,-1847.32"/>
<polygon fill="black" stroke="black" points="3687.84,-1843.82 3677.81,-1847.23 3687.77,-1850.82 3687.84,-1843.82"/>
</g>
<!-- expert_27_s1&#45;&gt;expert_combine_s1 -->
<g id="edge68" class="edge">
<title>expert_27_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M5966.74,-1919C5963.97,-1918.58 5961.22,-1918.2 5958.5,-1917.85 5517.58,-1861.78 4158.08,-1849.4 3688.23,-1846.76"/>
<polygon fill="black" stroke="black" points="3687.99,-1843.26 3677.97,-1846.71 3687.95,-1850.26 3687.99,-1843.26"/>
</g>
<!-- expert_28_s1&#45;&gt;expert_combine_s1 -->
<g id="edge69" class="edge">
<title>expert_28_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M6187.74,-1918.99C6184.97,-1918.57 6182.22,-1918.19 6179.5,-1917.85 5693.69,-1856.68 4185.91,-1847.61 3687.94,-1846.3"/>
<polygon fill="black" stroke="black" points="3687.81,-1842.8 3677.8,-1846.27 3687.79,-1849.8 3687.81,-1842.8"/>
</g>
<!-- expert_29_s1&#45;&gt;expert_combine_s1 -->
<g id="edge70" class="edge">
<title>expert_29_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M6408.74,-1918.98C6405.97,-1918.57 6403.22,-1918.19 6400.5,-1917.85 5869.91,-1851.6 4214.18,-1845.97 3688.44,-1845.9"/>
<polygon fill="black" stroke="black" points="3688.12,-1842.4 3678.12,-1845.9 3688.12,-1849.4 3688.12,-1842.4"/>
</g>
<!-- expert_30_s1&#45;&gt;expert_combine_s1 -->
<g id="edge71" class="edge">
<title>expert_30_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M6629.75,-1918.97C6626.97,-1918.56 6624.22,-1918.19 6621.5,-1917.85 6045.64,-1846.47 4239.38,-1844.44 3687.96,-1845.56"/>
<polygon fill="black" stroke="black" points="3687.94,-1842.06 3677.95,-1845.58 3687.95,-1849.06 3687.94,-1842.06"/>
</g>
<!-- expert_31_s1&#45;&gt;expert_combine_s1 -->
<g id="edge72" class="edge">
<title>expert_31_s1&#45;&gt;expert_combine_s1</title>
<path fill="none" stroke="black" d="M6850.75,-1918.97C6847.97,-1918.56 6845.22,-1918.19 6842.5,-1917.85 6528.47,-1879.17 4309.38,-1854.01 3687.91,-1847.66"/>
<polygon fill="black" stroke="black" points="3687.57,-1844.16 3677.54,-1847.56 3687.5,-1851.16 3687.57,-1844.16"/>
</g>
<!-- moe_out_proj_s1 -->
<g id="node43" class="node">
<title>moe_out_proj_s1</title>
<polygon fill="lightblue" stroke="black" points="3633.5,-1772.31 3419.5,-1772.31 3419.5,-1720.31 3633.5,-1720.31 3633.5,-1772.31"/>
<text text-anchor="middle" x="3526.5" y="-1760.31" font-family="Arial" font-size="10.00">MoE Output Proj (TP8)</text>
<text text-anchor="middle" x="3526.5" y="-1749.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1738.31" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1727.31" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1&#45;&gt;moe_out_proj_s1 -->
<g id="edge73" class="edge">
<title>expert_combine_s1&#45;&gt;moe_out_proj_s1</title>
<path fill="none" stroke="black" d="M3526.5,-1808.05C3526.5,-1799.74 3526.5,-1790.9 3526.5,-1782.62"/>
<polygon fill="black" stroke="black" points="3530,-1782.51 3526.5,-1772.51 3523,-1782.51 3530,-1782.51"/>
</g>
<!-- allreduce_moe_out_s1 -->
<g id="node44" class="node">
<title>allreduce_moe_out_s1</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-1647.54" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-1661.54" font-family="Arial" font-size="10.00">All&#45;Reduce MoE Output</text>
<text text-anchor="middle" x="3526.5" y="-1650.54" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1639.54" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1628.54" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1&#45;&gt;allreduce_moe_out_s1 -->
<g id="edge74" class="edge">
<title>moe_out_proj_s1&#45;&gt;allreduce_moe_out_s1</title>
<path fill="none" stroke="black" d="M3526.5,-1720.14C3526.5,-1712.33 3526.5,-1703.47 3526.5,-1694.7"/>
<polygon fill="black" stroke="black" points="3530,-1694.52 3526.5,-1684.52 3523,-1694.52 3530,-1694.52"/>
</g>
<!-- layernorm2_s1 -->
<g id="node45" class="node">
<title>layernorm2_s1</title>
<polygon fill="lightblue" stroke="black" points="3633.5,-1574.77 3419.5,-1574.77 3419.5,-1522.77 3633.5,-1522.77 3633.5,-1574.77"/>
<text text-anchor="middle" x="3526.5" y="-1562.77" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3526.5" y="-1551.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1540.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1529.77" font-family="Arial" font-size="10.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1&#45;&gt;layernorm2_s1 -->
<g id="edge75" class="edge">
<title>allreduce_moe_out_s1&#45;&gt;layernorm2_s1</title>
<path fill="none" stroke="black" d="M3526.5,-1610.51C3526.5,-1602.2 3526.5,-1593.36 3526.5,-1585.08"/>
<polygon fill="black" stroke="black" points="3530,-1584.97 3526.5,-1574.97 3523,-1584.97 3530,-1584.97"/>
</g>
<!-- pp_transfer_s1_s2 -->
<g id="node46" class="node">
<title>pp_transfer_s1_s2</title>
<ellipse fill="red" stroke="black" cx="3526.5" cy="-1450" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-1464" font-family="Arial" font-size="10.00">Pipeline Transfer S1S2</text>
<text text-anchor="middle" x="3526.5" y="-1453" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1442" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1431" font-family="Arial" font-size="10.00">GPUs: 1023  1024</text>
</g>
<!-- layernorm2_s1&#45;&gt;pp_transfer_s1_s2 -->
<g id="edge76" class="edge">
<title>layernorm2_s1&#45;&gt;pp_transfer_s1_s2</title>
<path fill="none" stroke="black" d="M3526.5,-1522.6C3526.5,-1514.79 3526.5,-1505.93 3526.5,-1497.16"/>
<polygon fill="black" stroke="black" points="3530,-1496.98 3526.5,-1486.98 3523,-1496.98 3530,-1496.98"/>
</g>
<!-- layernorm1_s2 -->
<g id="node47" class="node">
<title>layernorm1_s2</title>
<polygon fill="lightblue" stroke="black" points="3633.5,-1377.23 3419.5,-1377.23 3419.5,-1325.23 3633.5,-1325.23 3633.5,-1377.23"/>
<text text-anchor="middle" x="3526.5" y="-1365.23" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3526.5" y="-1354.23" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1343.23" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1332.23" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- pp_transfer_s1_s2&#45;&gt;layernorm1_s2 -->
<g id="edge77" class="edge">
<title>pp_transfer_s1_s2&#45;&gt;layernorm1_s2</title>
<path fill="none" stroke="black" d="M3526.5,-1412.97C3526.5,-1404.66 3526.5,-1395.82 3526.5,-1387.54"/>
<polygon fill="black" stroke="black" points="3530,-1387.43 3526.5,-1377.43 3523,-1387.43 3530,-1387.43"/>
</g>
<!-- qkv_proj_s2 -->
<g id="node48" class="node">
<title>qkv_proj_s2</title>
<polygon fill="lightblue" stroke="black" points="3646,-1289.23 3407,-1289.23 3407,-1237.23 3646,-1237.23 3646,-1289.23"/>
<text text-anchor="middle" x="3526.5" y="-1277.23" font-family="Arial" font-size="10.00">QKV Projection (TP8)</text>
<text text-anchor="middle" x="3526.5" y="-1266.23" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-1255.23" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-1244.23" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2&#45;&gt;qkv_proj_s2 -->
<g id="edge78" class="edge">
<title>layernorm1_s2&#45;&gt;qkv_proj_s2</title>
<path fill="none" stroke="black" d="M3526.5,-1324.9C3526.5,-1316.94 3526.5,-1308 3526.5,-1299.48"/>
<polygon fill="black" stroke="black" points="3530,-1299.39 3526.5,-1289.39 3523,-1299.39 3530,-1299.39"/>
</g>
<!-- allreduce_qkv_s2 -->
<g id="node49" class="node">
<title>allreduce_qkv_s2</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-1164.47" rx="169" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-1178.47" font-family="Arial" font-size="10.00">All&#45;Reduce QKV</text>
<text text-anchor="middle" x="3526.5" y="-1167.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-1156.47" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-1145.47" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2&#45;&gt;allreduce_qkv_s2 -->
<g id="edge79" class="edge">
<title>qkv_proj_s2&#45;&gt;allreduce_qkv_s2</title>
<path fill="none" stroke="black" d="M3526.5,-1237.06C3526.5,-1229.25 3526.5,-1220.39 3526.5,-1211.62"/>
<polygon fill="black" stroke="black" points="3530,-1211.44 3526.5,-1201.44 3523,-1211.44 3530,-1211.44"/>
</g>
<!-- attention_s2 -->
<g id="node50" class="node">
<title>attention_s2</title>
<polygon fill="lightblue" stroke="black" points="3646,-1091.7 3407,-1091.7 3407,-1039.7 3646,-1039.7 3646,-1091.7"/>
<text text-anchor="middle" x="3526.5" y="-1079.7" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="3526.5" y="-1068.7" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-1057.7" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-1046.7" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2&#45;&gt;attention_s2 -->
<g id="edge80" class="edge">
<title>allreduce_qkv_s2&#45;&gt;attention_s2</title>
<path fill="none" stroke="black" d="M3526.5,-1127.43C3526.5,-1119.12 3526.5,-1110.29 3526.5,-1102"/>
<polygon fill="black" stroke="black" points="3530,-1101.89 3526.5,-1091.89 3523,-1101.89 3530,-1101.89"/>
</g>
<!-- attn_out_proj_s2 -->
<g id="node51" class="node">
<title>attn_out_proj_s2</title>
<polygon fill="lightblue" stroke="black" points="3642.5,-1003.7 3410.5,-1003.7 3410.5,-951.7 3642.5,-951.7 3642.5,-1003.7"/>
<text text-anchor="middle" x="3526.5" y="-991.7" font-family="Arial" font-size="10.00">Attention Output Proj (TP8)</text>
<text text-anchor="middle" x="3526.5" y="-980.7" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3526.5" y="-969.7" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-958.7" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2&#45;&gt;attn_out_proj_s2 -->
<g id="edge81" class="edge">
<title>attention_s2&#45;&gt;attn_out_proj_s2</title>
<path fill="none" stroke="black" d="M3526.5,-1039.36C3526.5,-1031.4 3526.5,-1022.46 3526.5,-1013.94"/>
<polygon fill="black" stroke="black" points="3530,-1013.85 3526.5,-1003.85 3523,-1013.85 3530,-1013.85"/>
</g>
<!-- allreduce_attn_out_s2 -->
<g id="node52" class="node">
<title>allreduce_attn_out_s2</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-878.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-892.93" font-family="Arial" font-size="10.00">All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="3526.5" y="-881.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-870.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-859.93" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2&#45;&gt;allreduce_attn_out_s2 -->
<g id="edge82" class="edge">
<title>attn_out_proj_s2&#45;&gt;allreduce_attn_out_s2</title>
<path fill="none" stroke="black" d="M3526.5,-951.52C3526.5,-943.71 3526.5,-934.85 3526.5,-926.08"/>
<polygon fill="black" stroke="black" points="3530,-925.9 3526.5,-915.9 3523,-925.9 3530,-925.9"/>
</g>
<!-- moe_gate_s2 -->
<g id="node53" class="node">
<title>moe_gate_s2</title>
<polygon fill="orange" stroke="black" points="3748.23,-806.16 3395.51,-806.16 3304.77,-702.16 3657.49,-702.16 3748.23,-806.16"/>
<text text-anchor="middle" x="3526.5" y="-768.16" font-family="Arial" font-size="10.00">MoE Gate (Router)</text>
<text text-anchor="middle" x="3526.5" y="-757.16" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-746.16" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-735.16" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2&#45;&gt;moe_gate_s2 -->
<g id="edge83" class="edge">
<title>allreduce_attn_out_s2&#45;&gt;moe_gate_s2</title>
<path fill="none" stroke="black" d="M3526.5,-842.09C3526.5,-834.05 3526.5,-825.3 3526.5,-816.55"/>
<polygon fill="black" stroke="black" points="3530,-816.32 3526.5,-806.32 3523,-816.32 3530,-816.32"/>
</g>
<!-- expert_dispatch_s2 -->
<g id="node54" class="node">
<title>expert_dispatch_s2</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-629.39" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-643.39" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="3526.5" y="-632.39" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-621.39" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-610.39" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2&#45;&gt;expert_dispatch_s2 -->
<g id="edge84" class="edge">
<title>moe_gate_s2&#45;&gt;expert_dispatch_s2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3526.5,-701.8C3526.5,-693.39 3526.5,-684.73 3526.5,-676.46"/>
<polygon fill="black" stroke="black" points="3530,-676.24 3526.5,-666.24 3523,-676.24 3530,-676.24"/>
</g>
<!-- expert_32_s2 -->
<g id="node55" class="node">
<title>expert_32_s2</title>
<polygon fill="lightblue" stroke="black" points="203,-556.62 0,-556.62 0,-504.62 203,-504.62 203,-556.62"/>
<text text-anchor="middle" x="101.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 32</text>
<text text-anchor="middle" x="101.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="101.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="101.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_32_s2 -->
<g id="edge85" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_32_s2</title>
<path fill="none" stroke="black" d="M3375.51,-626.91C2774.89,-620.8 570.84,-596 213.29,-556.67"/>
<polygon fill="black" stroke="black" points="213.59,-553.18 203.25,-555.5 212.78,-560.13 213.59,-553.18"/>
</g>
<!-- expert_33_s2 -->
<g id="node56" class="node">
<title>expert_33_s2</title>
<polygon fill="lightblue" stroke="black" points="424,-556.62 221,-556.62 221,-504.62 424,-504.62 424,-556.62"/>
<text text-anchor="middle" x="322.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 33</text>
<text text-anchor="middle" x="322.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="322.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="322.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_33_s2 -->
<g id="edge86" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_33_s2</title>
<path fill="none" stroke="black" d="M3375.1,-628.89C2839.1,-630.03 1032.15,-628.44 434.27,-556.72"/>
<polygon fill="black" stroke="black" points="434.6,-553.23 424.25,-555.5 433.76,-560.18 434.6,-553.23"/>
</g>
<!-- expert_34_s2 -->
<g id="node57" class="node">
<title>expert_34_s2</title>
<polygon fill="lightblue" stroke="black" points="645,-556.62 442,-556.62 442,-504.62 645,-504.62 645,-556.62"/>
<text text-anchor="middle" x="543.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 34</text>
<text text-anchor="middle" x="543.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="543.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="543.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_34_s2 -->
<g id="edge87" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_34_s2</title>
<path fill="none" stroke="black" d="M3374.93,-628.57C2864.21,-628.56 1207.82,-623.35 655.31,-556.72"/>
<polygon fill="black" stroke="black" points="655.61,-553.24 645.26,-555.49 654.75,-560.18 655.61,-553.24"/>
</g>
<!-- expert_35_s2 -->
<g id="node58" class="node">
<title>expert_35_s2</title>
<polygon fill="lightblue" stroke="black" points="866,-556.62 663,-556.62 663,-504.62 866,-504.62 866,-556.62"/>
<text text-anchor="middle" x="764.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 35</text>
<text text-anchor="middle" x="764.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="764.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="764.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_35_s2 -->
<g id="edge88" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_35_s2</title>
<path fill="none" stroke="black" d="M3374.83,-628.2C2890.46,-626.98 1383.37,-618.29 876.22,-556.72"/>
<polygon fill="black" stroke="black" points="876.61,-553.24 866.26,-555.48 875.75,-560.18 876.61,-553.24"/>
</g>
<!-- expert_36_s2 -->
<g id="node59" class="node">
<title>expert_36_s2</title>
<polygon fill="lightblue" stroke="black" points="1087,-556.62 884,-556.62 884,-504.62 1087,-504.62 1087,-556.62"/>
<text text-anchor="middle" x="985.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 36</text>
<text text-anchor="middle" x="985.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="985.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="985.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_36_s2 -->
<g id="edge89" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_36_s2</title>
<path fill="none" stroke="black" d="M3375.09,-627.76C2918.65,-625.26 1559.59,-613.26 1097.34,-556.73"/>
<polygon fill="black" stroke="black" points="1097.61,-553.24 1087.26,-555.47 1096.75,-560.19 1097.61,-553.24"/>
</g>
<!-- expert_37_s2 -->
<g id="node60" class="node">
<title>expert_37_s2</title>
<polygon fill="lightblue" stroke="black" points="1308,-556.62 1105,-556.62 1105,-504.62 1308,-504.62 1308,-556.62"/>
<text text-anchor="middle" x="1206.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 37</text>
<text text-anchor="middle" x="1206.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_37_s2 -->
<g id="edge90" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_37_s2</title>
<path fill="none" stroke="black" d="M3375.26,-627.24C2947.85,-623.39 1735.55,-608.24 1318.27,-556.73"/>
<polygon fill="black" stroke="black" points="1318.62,-553.24 1308.26,-555.46 1317.74,-560.19 1318.62,-553.24"/>
</g>
<!-- expert_38_s2 -->
<g id="node61" class="node">
<title>expert_38_s2</title>
<polygon fill="lightblue" stroke="black" points="1529,-556.62 1326,-556.62 1326,-504.62 1529,-504.62 1529,-556.62"/>
<text text-anchor="middle" x="1427.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 38</text>
<text text-anchor="middle" x="1427.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1427.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1427.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_38_s2 -->
<g id="edge91" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_38_s2</title>
<path fill="none" stroke="black" d="M3375.49,-626.6C2978.63,-621.33 1911.84,-603.26 1539.27,-556.73"/>
<polygon fill="black" stroke="black" points="1539.62,-553.25 1529.26,-555.45 1538.74,-560.19 1539.62,-553.25"/>
</g>
<!-- expert_39_s2 -->
<g id="node62" class="node">
<title>expert_39_s2</title>
<polygon fill="lightblue" stroke="black" points="1750,-556.62 1547,-556.62 1547,-504.62 1750,-504.62 1750,-556.62"/>
<text text-anchor="middle" x="1648.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 39</text>
<text text-anchor="middle" x="1648.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1648.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1648.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_39_s2 -->
<g id="edge92" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_39_s2</title>
<path fill="none" stroke="black" d="M3375.74,-625.81C3011.16,-619.02 2088.3,-598.3 1760.27,-556.73"/>
<polygon fill="black" stroke="black" points="1760.63,-553.25 1750.26,-555.43 1759.73,-560.19 1760.63,-553.25"/>
</g>
<!-- expert_40_s2 -->
<g id="node63" class="node">
<title>expert_40_s2</title>
<polygon fill="lightblue" stroke="black" points="1971,-556.62 1768,-556.62 1768,-504.62 1971,-504.62 1971,-556.62"/>
<text text-anchor="middle" x="1869.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 40</text>
<text text-anchor="middle" x="1869.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1869.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1869.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_40_s2 -->
<g id="edge93" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_40_s2</title>
<path fill="none" stroke="black" d="M3376.31,-624.81C3046.34,-616.41 2265.62,-593.4 1981.57,-556.78"/>
<polygon fill="black" stroke="black" points="1981.64,-553.26 1971.27,-555.41 1980.72,-560.19 1981.64,-553.26"/>
</g>
<!-- expert_41_s2 -->
<g id="node64" class="node">
<title>expert_41_s2</title>
<polygon fill="lightblue" stroke="black" points="2192,-556.62 1989,-556.62 1989,-504.62 2192,-504.62 2192,-556.62"/>
<text text-anchor="middle" x="2090.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 41</text>
<text text-anchor="middle" x="2090.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2090.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2090.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_41_s2 -->
<g id="edge94" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_41_s2</title>
<path fill="none" stroke="black" d="M3375.06,-628.51C3129.9,-626.85 2631.07,-615.83 2202.38,-556.79"/>
<polygon fill="black" stroke="black" points="2202.66,-553.29 2192.27,-555.38 2201.69,-560.23 2202.66,-553.29"/>
</g>
<!-- expert_42_s2 -->
<g id="node65" class="node">
<title>expert_42_s2</title>
<polygon fill="lightblue" stroke="black" points="2413,-556.62 2210,-556.62 2210,-504.62 2413,-504.62 2413,-556.62"/>
<text text-anchor="middle" x="2311.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 42</text>
<text text-anchor="middle" x="2311.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2311.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2311.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_42_s2 -->
<g id="edge95" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_42_s2</title>
<path fill="none" stroke="black" d="M3375.58,-626.15C3164.12,-621.32 2767.78,-606.07 2423.2,-556.78"/>
<polygon fill="black" stroke="black" points="2423.67,-553.31 2413.27,-555.35 2422.67,-560.24 2423.67,-553.31"/>
</g>
<!-- expert_43_s2 -->
<g id="node66" class="node">
<title>expert_43_s2</title>
<polygon fill="lightblue" stroke="black" points="2634,-556.62 2431,-556.62 2431,-504.62 2634,-504.62 2634,-556.62"/>
<text text-anchor="middle" x="2532.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 43</text>
<text text-anchor="middle" x="2532.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2532.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2532.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_43_s2 -->
<g id="edge96" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_43_s2</title>
<path fill="none" stroke="black" d="M3377.55,-622.77C3203.47,-614.74 2906.79,-596.47 2644.39,-556.83"/>
<polygon fill="black" stroke="black" points="2644.7,-553.33 2634.28,-555.29 2643.64,-560.25 2644.7,-553.33"/>
</g>
<!-- expert_44_s2 -->
<g id="node67" class="node">
<title>expert_44_s2</title>
<polygon fill="lightblue" stroke="black" points="2855,-556.62 2652,-556.62 2652,-504.62 2855,-504.62 2855,-556.62"/>
<text text-anchor="middle" x="2753.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 44</text>
<text text-anchor="middle" x="2753.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2753.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2753.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_44_s2 -->
<g id="edge97" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_44_s2</title>
<path fill="none" stroke="black" d="M3382.94,-617.67C3250.64,-606.67 3048.8,-587.08 2865.12,-556.82"/>
<polygon fill="black" stroke="black" points="2865.44,-553.32 2855,-555.14 2864.29,-560.23 2865.44,-553.32"/>
</g>
<!-- expert_45_s2 -->
<g id="node68" class="node">
<title>expert_45_s2</title>
<polygon fill="lightblue" stroke="black" points="3076,-556.62 2873,-556.62 2873,-504.62 3076,-504.62 3076,-556.62"/>
<text text-anchor="middle" x="2974.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 45</text>
<text text-anchor="middle" x="2974.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2974.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2974.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_45_s2 -->
<g id="edge98" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_45_s2</title>
<path fill="none" stroke="black" d="M3398.47,-609.76C3312.61,-596.76 3196.82,-578.24 3086.05,-556.88"/>
<polygon fill="black" stroke="black" points="3086.52,-553.4 3076.04,-554.94 3085.19,-560.28 3086.52,-553.4"/>
</g>
<!-- expert_46_s2 -->
<g id="node69" class="node">
<title>expert_46_s2</title>
<polygon fill="lightblue" stroke="black" points="3297,-556.62 3094,-556.62 3094,-504.62 3297,-504.62 3297,-556.62"/>
<text text-anchor="middle" x="3195.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 46</text>
<text text-anchor="middle" x="3195.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3195.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3195.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_46_s2 -->
<g id="edge99" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_46_s2</title>
<path fill="none" stroke="black" d="M3431.65,-600.66C3387.42,-587.73 3334.91,-572.37 3290.64,-559.43"/>
<polygon fill="black" stroke="black" points="3291.62,-556.07 3281.04,-556.63 3289.66,-562.79 3291.62,-556.07"/>
</g>
<!-- expert_47_s2 -->
<g id="node70" class="node">
<title>expert_47_s2</title>
<polygon fill="lightblue" stroke="black" points="3518,-556.62 3315,-556.62 3315,-504.62 3518,-504.62 3518,-556.62"/>
<text text-anchor="middle" x="3416.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 47</text>
<text text-anchor="middle" x="3416.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3416.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3416.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_47_s2 -->
<g id="edge100" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_47_s2</title>
<path fill="none" stroke="black" d="M3487.1,-593.72C3475.89,-583.86 3463.73,-573.17 3452.72,-563.48"/>
<polygon fill="black" stroke="black" points="3454.75,-560.61 3444.93,-556.63 3450.13,-565.86 3454.75,-560.61"/>
</g>
<!-- expert_48_s2 -->
<g id="node71" class="node">
<title>expert_48_s2</title>
<polygon fill="lightblue" stroke="black" points="3739,-556.62 3536,-556.62 3536,-504.62 3739,-504.62 3739,-556.62"/>
<text text-anchor="middle" x="3637.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 48</text>
<text text-anchor="middle" x="3637.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_48_s2 -->
<g id="edge101" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_48_s2</title>
<path fill="none" stroke="black" d="M3566.26,-593.72C3577.57,-583.86 3589.84,-573.17 3600.95,-563.48"/>
<polygon fill="black" stroke="black" points="3603.57,-565.84 3608.81,-556.63 3598.97,-560.56 3603.57,-565.84"/>
</g>
<!-- expert_49_s2 -->
<g id="node72" class="node">
<title>expert_49_s2</title>
<polygon fill="lightblue" stroke="black" points="3960,-556.62 3757,-556.62 3757,-504.62 3960,-504.62 3960,-556.62"/>
<text text-anchor="middle" x="3858.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 49</text>
<text text-anchor="middle" x="3858.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3858.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3858.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_49_s2 -->
<g id="edge102" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_49_s2</title>
<path fill="none" stroke="black" d="M3621.64,-600.66C3666,-587.73 3718.67,-572.37 3763.07,-559.43"/>
<polygon fill="black" stroke="black" points="3764.08,-562.78 3772.7,-556.63 3762.12,-556.06 3764.08,-562.78"/>
</g>
<!-- expert_50_s2 -->
<g id="node73" class="node">
<title>expert_50_s2</title>
<polygon fill="lightblue" stroke="black" points="4181,-556.62 3978,-556.62 3978,-504.62 4181,-504.62 4181,-556.62"/>
<text text-anchor="middle" x="4079.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 50</text>
<text text-anchor="middle" x="4079.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4079.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4079.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_50_s2 -->
<g id="edge103" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_50_s2</title>
<path fill="none" stroke="black" d="M3654.82,-609.78C3740.88,-596.78 3856.93,-578.26 3967.93,-556.88"/>
<polygon fill="black" stroke="black" points="3968.81,-560.28 3977.96,-554.94 3967.48,-553.4 3968.81,-560.28"/>
</g>
<!-- expert_51_s2 -->
<g id="node74" class="node">
<title>expert_51_s2</title>
<polygon fill="lightblue" stroke="black" points="4402,-556.62 4199,-556.62 4199,-504.62 4402,-504.62 4402,-556.62"/>
<text text-anchor="middle" x="4300.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 51</text>
<text text-anchor="middle" x="4300.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4300.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4300.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_51_s2 -->
<g id="edge104" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_51_s2</title>
<path fill="none" stroke="black" d="M3670.28,-617.68C3802.78,-606.7 4004.92,-587.11 4188.86,-556.82"/>
<polygon fill="black" stroke="black" points="4189.7,-560.23 4199,-555.14 4188.56,-553.32 4189.7,-560.23"/>
</g>
<!-- expert_52_s2 -->
<g id="node75" class="node">
<title>expert_52_s2</title>
<polygon fill="lightblue" stroke="black" points="4623,-556.62 4420,-556.62 4420,-504.62 4623,-504.62 4623,-556.62"/>
<text text-anchor="middle" x="4521.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 52</text>
<text text-anchor="middle" x="4521.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4521.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4521.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_52_s2 -->
<g id="edge105" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_52_s2</title>
<path fill="none" stroke="black" d="M3675.62,-622.78C3849.89,-614.76 4146.91,-596.5 4409.6,-556.83"/>
<polygon fill="black" stroke="black" points="4410.36,-560.25 4419.72,-555.29 4409.3,-553.33 4410.36,-560.25"/>
</g>
<!-- expert_53_s2 -->
<g id="node76" class="node">
<title>expert_53_s2</title>
<polygon fill="lightblue" stroke="black" points="4844,-556.62 4641,-556.62 4641,-504.62 4844,-504.62 4844,-556.62"/>
<text text-anchor="middle" x="4742.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 53</text>
<text text-anchor="middle" x="4742.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4742.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4742.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_53_s2 -->
<g id="edge106" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_53_s2</title>
<path fill="none" stroke="black" d="M3677.56,-626.16C3889.21,-621.34 4285.9,-606.11 4630.79,-556.78"/>
<polygon fill="black" stroke="black" points="4631.33,-560.24 4640.73,-555.35 4630.33,-553.31 4631.33,-560.24"/>
</g>
<!-- expert_54_s2 -->
<g id="node77" class="node">
<title>expert_54_s2</title>
<polygon fill="lightblue" stroke="black" points="5065,-556.62 4862,-556.62 4862,-504.62 5065,-504.62 5065,-556.62"/>
<text text-anchor="middle" x="4963.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 54</text>
<text text-anchor="middle" x="4963.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4963.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4963.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_54_s2 -->
<g id="edge107" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_54_s2</title>
<path fill="none" stroke="black" d="M3677.8,-628.52C3923.06,-626.88 4422.46,-615.89 4851.61,-556.79"/>
<polygon fill="black" stroke="black" points="4852.31,-560.23 4861.73,-555.38 4851.34,-553.29 4852.31,-560.23"/>
</g>
<!-- expert_55_s2 -->
<g id="node78" class="node">
<title>expert_55_s2</title>
<polygon fill="lightblue" stroke="black" points="5286,-556.62 5083,-556.62 5083,-504.62 5286,-504.62 5286,-556.62"/>
<text text-anchor="middle" x="5184.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 55</text>
<text text-anchor="middle" x="5184.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5184.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5184.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_55_s2 -->
<g id="edge108" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_55_s2</title>
<path fill="none" stroke="black" d="M3676.79,-624.81C4006.97,-616.41 4788.2,-593.42 5072.43,-556.78"/>
<polygon fill="black" stroke="black" points="5073.28,-560.19 5082.73,-555.41 5072.36,-553.26 5073.28,-560.19"/>
</g>
<!-- expert_56_s2 -->
<g id="node79" class="node">
<title>expert_56_s2</title>
<polygon fill="lightblue" stroke="black" points="5507,-556.62 5304,-556.62 5304,-504.62 5507,-504.62 5507,-556.62"/>
<text text-anchor="middle" x="5405.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 56</text>
<text text-anchor="middle" x="5405.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5405.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5405.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_56_s2 -->
<g id="edge109" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_56_s2</title>
<path fill="none" stroke="black" d="M3677.34,-625.81C4042.13,-619.03 4965.52,-598.32 5293.73,-556.73"/>
<polygon fill="black" stroke="black" points="5294.27,-560.19 5303.74,-555.43 5293.37,-553.25 5294.27,-560.19"/>
</g>
<!-- expert_57_s2 -->
<g id="node80" class="node">
<title>expert_57_s2</title>
<polygon fill="lightblue" stroke="black" points="5728,-556.62 5525,-556.62 5525,-504.62 5728,-504.62 5728,-556.62"/>
<text text-anchor="middle" x="5626.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 57</text>
<text text-anchor="middle" x="5626.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5626.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5626.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_57_s2 -->
<g id="edge110" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_57_s2</title>
<path fill="none" stroke="black" d="M3677.59,-626.6C4074.64,-621.34 5141.97,-603.28 5514.72,-556.73"/>
<polygon fill="black" stroke="black" points="5515.26,-560.19 5524.74,-555.45 5514.38,-553.25 5515.26,-560.19"/>
</g>
<!-- expert_58_s2 -->
<g id="node81" class="node">
<title>expert_58_s2</title>
<polygon fill="lightblue" stroke="black" points="5949,-556.62 5746,-556.62 5746,-504.62 5949,-504.62 5949,-556.62"/>
<text text-anchor="middle" x="5847.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 58</text>
<text text-anchor="middle" x="5847.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5847.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5847.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_58_s2 -->
<g id="edge111" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_58_s2</title>
<path fill="none" stroke="black" d="M3677.81,-627.24C4105.41,-623.4 5318.26,-608.26 5735.73,-556.73"/>
<polygon fill="black" stroke="black" points="5736.26,-560.19 5745.74,-555.46 5735.38,-553.24 5736.26,-560.19"/>
</g>
<!-- expert_59_s2 -->
<g id="node82" class="node">
<title>expert_59_s2</title>
<polygon fill="lightblue" stroke="black" points="6170,-556.62 5967,-556.62 5967,-504.62 6170,-504.62 6170,-556.62"/>
<text text-anchor="middle" x="6068.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 59</text>
<text text-anchor="middle" x="6068.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6068.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6068.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_59_s2 -->
<g id="edge112" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_59_s2</title>
<path fill="none" stroke="black" d="M3677.97,-627.76C4134.6,-625.27 5494.21,-613.28 5956.65,-556.73"/>
<polygon fill="black" stroke="black" points="5957.25,-560.19 5966.74,-555.47 5956.39,-553.24 5957.25,-560.19"/>
</g>
<!-- expert_60_s2 -->
<g id="node83" class="node">
<title>expert_60_s2</title>
<polygon fill="lightblue" stroke="black" points="6391,-556.62 6188,-556.62 6188,-504.62 6391,-504.62 6391,-556.62"/>
<text text-anchor="middle" x="6289.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 60</text>
<text text-anchor="middle" x="6289.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6289.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6289.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_60_s2 -->
<g id="edge113" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_60_s2</title>
<path fill="none" stroke="black" d="M3677.8,-628.2C4161.89,-626.99 5670.29,-618.33 6177.77,-556.72"/>
<polygon fill="black" stroke="black" points="6178.25,-560.18 6187.74,-555.48 6177.39,-553.24 6178.25,-560.18"/>
</g>
<!-- expert_61_s2 -->
<g id="node84" class="node">
<title>expert_61_s2</title>
<polygon fill="lightblue" stroke="black" points="6612,-556.62 6409,-556.62 6409,-504.62 6612,-504.62 6612,-556.62"/>
<text text-anchor="middle" x="6510.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 61</text>
<text text-anchor="middle" x="6510.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6510.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6510.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_61_s2 -->
<g id="edge114" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_61_s2</title>
<path fill="none" stroke="black" d="M3678.12,-628.57C4189.02,-628.57 5845.99,-623.37 6398.69,-556.73"/>
<polygon fill="black" stroke="black" points="6399.25,-560.18 6408.74,-555.49 6398.39,-553.24 6399.25,-560.18"/>
</g>
<!-- expert_62_s2 -->
<g id="node85" class="node">
<title>expert_62_s2</title>
<polygon fill="lightblue" stroke="black" points="6833,-556.62 6630,-556.62 6630,-504.62 6833,-504.62 6833,-556.62"/>
<text text-anchor="middle" x="6731.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 62</text>
<text text-anchor="middle" x="6731.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6731.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6731.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_62_s2 -->
<g id="edge115" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_62_s2</title>
<path fill="none" stroke="black" d="M3677.95,-628.89C4214.12,-630.04 6021.65,-628.46 6619.73,-556.72"/>
<polygon fill="black" stroke="black" points="6620.24,-560.18 6629.75,-555.5 6619.4,-553.23 6620.24,-560.18"/>
</g>
<!-- expert_63_s2 -->
<g id="node86" class="node">
<title>expert_63_s2</title>
<polygon fill="lightblue" stroke="black" points="7054,-556.62 6851,-556.62 6851,-504.62 7054,-504.62 7054,-556.62"/>
<text text-anchor="middle" x="6952.5" y="-544.62" font-family="Arial" font-size="10.00">Expert 63</text>
<text text-anchor="middle" x="6952.5" y="-533.62" font-family="Arial" font-size="10.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="6952.5" y="-522.62" font-family="Arial" font-size="10.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="6952.5" y="-511.62" font-family="Arial" font-size="10.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2&#45;&gt;expert_63_s2 -->
<g id="edge116" class="edge">
<title>expert_dispatch_s2&#45;&gt;expert_63_s2</title>
<path fill="none" stroke="black" d="M3677.54,-626.91C4278.34,-620.81 6483.05,-596.01 6840.71,-556.67"/>
<polygon fill="black" stroke="black" points="6841.22,-560.13 6850.75,-555.5 6840.41,-553.18 6841.22,-560.13"/>
</g>
<!-- expert_combine_s2 -->
<g id="node87" class="node">
<title>expert_combine_s2</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-431.85" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-445.85" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="3526.5" y="-434.85" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3526.5" y="-423.85" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-412.85" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2&#45;&gt;expert_combine_s2 -->
<g id="edge117" class="edge">
<title>expert_32_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M203.25,-505.73C206.03,-505.33 208.78,-504.95 211.5,-504.62 525.44,-465.95 2743.85,-440.78 3365.14,-434.43"/>
<polygon fill="black" stroke="black" points="3365.55,-437.92 3375.51,-434.32 3365.47,-430.92 3365.55,-437.92"/>
</g>
<!-- expert_33_s2&#45;&gt;expert_combine_s2 -->
<g id="edge118" class="edge">
<title>expert_33_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M424.25,-505.74C427.03,-505.33 429.78,-504.95 432.5,-504.62 1008.17,-433.26 2813.85,-431.22 3365.09,-432.33"/>
<polygon fill="black" stroke="black" points="3365.1,-435.83 3375.1,-432.35 3365.11,-428.83 3365.1,-435.83"/>
</g>
<!-- expert_34_s2&#45;&gt;expert_combine_s2 -->
<g id="edge119" class="edge">
<title>expert_34_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M645.26,-505.74C648.03,-505.33 650.78,-504.96 653.5,-504.62 1183.91,-438.39 2839.06,-432.75 3364.62,-432.67"/>
<polygon fill="black" stroke="black" points="3364.93,-436.17 3374.93,-432.67 3364.93,-429.17 3364.93,-436.17"/>
</g>
<!-- expert_35_s2&#45;&gt;expert_combine_s2 -->
<g id="edge120" class="edge">
<title>expert_35_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M866.26,-505.75C869.03,-505.34 871.78,-504.96 874.5,-504.62 1359.98,-443.48 2866.46,-434.39 3364.69,-433.06"/>
<polygon fill="black" stroke="black" points="3364.84,-436.56 3374.83,-433.04 3364.82,-429.56 3364.84,-436.56"/>
</g>
<!-- expert_36_s2&#45;&gt;expert_combine_s2 -->
<g id="edge121" class="edge">
<title>expert_36_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M1087.26,-505.76C1090.03,-505.35 1092.78,-504.96 1095.5,-504.62 1536.24,-448.57 2895.18,-436.17 3364.84,-433.53"/>
<polygon fill="black" stroke="black" points="3365.11,-437.03 3375.09,-433.48 3365.07,-430.03 3365.11,-437.03"/>
</g>
<!-- expert_37_s2&#45;&gt;expert_combine_s2 -->
<g id="edge122" class="edge">
<title>expert_37_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M1308.26,-505.77C1311.03,-505.35 1313.78,-504.97 1316.5,-504.62 1712.69,-453.64 2925.23,-438.11 3365.02,-434.09"/>
<polygon fill="black" stroke="black" points="3365.3,-437.59 3375.26,-434 3365.23,-430.59 3365.3,-437.59"/>
</g>
<!-- expert_38_s2&#45;&gt;expert_combine_s2 -->
<g id="edge123" class="edge">
<title>expert_38_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M1529.26,-505.78C1532.03,-505.36 1534.78,-504.97 1537.5,-504.62 1889.39,-458.69 2957.09,-440.26 3365.38,-434.77"/>
<polygon fill="black" stroke="black" points="3365.54,-438.27 3375.49,-434.63 3365.44,-431.27 3365.54,-438.27"/>
</g>
<!-- expert_39_s2&#45;&gt;expert_combine_s2 -->
<g id="edge124" class="edge">
<title>expert_39_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M1750.26,-505.8C1753.03,-505.37 1755.78,-504.98 1758.5,-504.62 2066.31,-463.74 2990.48,-442.67 3365.62,-435.61"/>
<polygon fill="black" stroke="black" points="3365.81,-439.11 3375.74,-435.42 3365.68,-432.11 3365.81,-439.11"/>
</g>
<!-- expert_40_s2&#45;&gt;expert_combine_s2 -->
<g id="edge125" class="edge">
<title>expert_40_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M1971.27,-505.82C1974.03,-505.39 1976.78,-504.99 1979.5,-504.62 2243.58,-468.77 3026.38,-445.4 3366.14,-436.68"/>
<polygon fill="black" stroke="black" points="3366.4,-440.18 3376.31,-436.42 3366.22,-433.18 3366.4,-440.18"/>
</g>
<!-- expert_41_s2&#45;&gt;expert_combine_s2 -->
<g id="edge126" class="edge">
<title>expert_41_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M2192.27,-505.85C2195.04,-505.41 2197.78,-505 2200.5,-504.62 2617.41,-446.39 3114.18,-434.71 3364.79,-432.8"/>
<polygon fill="black" stroke="black" points="3365.09,-436.3 3375.06,-432.73 3365.04,-429.3 3365.09,-436.3"/>
</g>
<!-- expert_42_s2&#45;&gt;expert_combine_s2 -->
<g id="edge127" class="edge">
<title>expert_42_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M2413.27,-505.89C2416.04,-505.44 2418.79,-505.01 2421.5,-504.62 2754.85,-456.22 3149.54,-440.45 3365.43,-435.32"/>
<polygon fill="black" stroke="black" points="3365.66,-438.82 3375.58,-435.08 3365.5,-431.82 3365.66,-438.82"/>
</g>
<!-- expert_43_s2&#45;&gt;expert_combine_s2 -->
<g id="edge128" class="edge">
<title>expert_43_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M2634.28,-505.95C2637.05,-505.48 2639.79,-505.03 2642.5,-504.62 2894.25,-465.99 3189.74,-447.32 3367.34,-438.94"/>
<polygon fill="black" stroke="black" points="3367.72,-442.42 3377.55,-438.46 3367.4,-435.43 3367.72,-442.42"/>
</g>
<!-- expert_44_s2&#45;&gt;expert_combine_s2 -->
<g id="edge129" class="edge">
<title>expert_44_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M2855,-506.1C2857.86,-505.58 2860.7,-505.09 2863.5,-504.62 3037.01,-475.61 3238.12,-455.75 3372.94,-444.4"/>
<polygon fill="black" stroke="black" points="3373.26,-447.89 3382.94,-443.57 3372.68,-440.91 3373.26,-447.89"/>
</g>
<!-- expert_45_s2&#45;&gt;expert_combine_s2 -->
<g id="edge130" class="edge">
<title>expert_45_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M3076.04,-506.3C3078.89,-505.72 3081.71,-505.16 3084.5,-504.62 3185.9,-484.88 3301.12,-466.3 3388.49,-452.99"/>
<polygon fill="black" stroke="black" points="3389.11,-456.43 3398.47,-451.47 3388.06,-449.51 3389.11,-456.43"/>
</g>
<!-- expert_46_s2&#45;&gt;expert_combine_s2 -->
<g id="edge131" class="edge">
<title>expert_46_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M3281.17,-504.57C3324.09,-492.02 3376.43,-476.72 3421.72,-463.48"/>
<polygon fill="black" stroke="black" points="3422.95,-466.77 3431.57,-460.6 3420.99,-460.05 3422.95,-466.77"/>
</g>
<!-- expert_47_s2&#45;&gt;expert_combine_s2 -->
<g id="edge132" class="edge">
<title>expert_47_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M3445.11,-504.44C3455.66,-495.17 3467.91,-484.39 3479.65,-474.07"/>
<polygon fill="black" stroke="black" points="3482.07,-476.6 3487.26,-467.36 3477.44,-471.34 3482.07,-476.6"/>
</g>
<!-- expert_48_s2&#45;&gt;expert_combine_s2 -->
<g id="edge133" class="edge">
<title>expert_48_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M3608.63,-504.44C3597.98,-495.17 3585.63,-484.39 3573.78,-474.07"/>
<polygon fill="black" stroke="black" points="3575.93,-471.3 3566.09,-467.36 3571.33,-476.57 3575.93,-471.3"/>
</g>
<!-- expert_49_s2&#45;&gt;expert_combine_s2 -->
<g id="edge134" class="edge">
<title>expert_49_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M3772.57,-504.57C3729.34,-491.97 3676.59,-476.59 3631.03,-463.31"/>
<polygon fill="black" stroke="black" points="3632,-459.95 3621.42,-460.51 3630.04,-466.67 3632,-459.95"/>
</g>
<!-- expert_50_s2&#45;&gt;expert_combine_s2 -->
<g id="edge135" class="edge">
<title>expert_50_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M3977.96,-506.3C3975.11,-505.72 3972.29,-505.16 3969.5,-504.62 3867.87,-484.86 3752.39,-466.27 3664.82,-452.97"/>
<polygon fill="black" stroke="black" points="3665.24,-449.49 3654.82,-451.46 3664.19,-456.41 3665.24,-449.49"/>
</g>
<!-- expert_51_s2&#45;&gt;expert_combine_s2 -->
<g id="edge136" class="edge">
<title>expert_51_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M4199,-506.1C4196.14,-505.58 4193.3,-505.09 4190.5,-504.62 4016.73,-475.58 3815.31,-455.73 3680.29,-444.39"/>
<polygon fill="black" stroke="black" points="3680.54,-440.9 3670.28,-443.55 3679.96,-447.87 3680.54,-440.9"/>
</g>
<!-- expert_52_s2&#45;&gt;expert_combine_s2 -->
<g id="edge137" class="edge">
<title>expert_52_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M4419.72,-505.95C4416.95,-505.48 4414.21,-505.03 4411.5,-504.62 4159.46,-465.96 3863.64,-447.29 3685.84,-438.93"/>
<polygon fill="black" stroke="black" points="3685.77,-435.42 3675.62,-438.45 3685.45,-442.41 3685.77,-435.42"/>
</g>
<!-- expert_53_s2&#45;&gt;expert_combine_s2 -->
<g id="edge138" class="edge">
<title>expert_53_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M4640.73,-505.89C4637.96,-505.44 4635.21,-505.01 4632.5,-504.62 4298.84,-456.19 3903.8,-440.43 3687.71,-435.31"/>
<polygon fill="black" stroke="black" points="3687.64,-431.81 3677.56,-435.07 3687.47,-438.81 3687.64,-431.81"/>
</g>
<!-- expert_54_s2&#45;&gt;expert_combine_s2 -->
<g id="edge139" class="edge">
<title>expert_54_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M4861.73,-505.85C4858.96,-505.41 4856.22,-505 4853.5,-504.62 4436.13,-446.33 3938.8,-434.68 3688.08,-432.79"/>
<polygon fill="black" stroke="black" points="3687.82,-429.29 3677.8,-432.72 3687.77,-436.29 3687.82,-429.29"/>
</g>
<!-- expert_55_s2&#45;&gt;expert_combine_s2 -->
<g id="edge140" class="edge">
<title>expert_55_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M5082.73,-505.82C5079.97,-505.39 5077.22,-504.99 5074.5,-504.62 4810.24,-468.75 4026.95,-445.39 3686.97,-436.68"/>
<polygon fill="black" stroke="black" points="3686.88,-433.18 3676.79,-436.42 3686.7,-440.18 3686.88,-433.18"/>
</g>
<!-- expert_56_s2&#45;&gt;expert_combine_s2 -->
<g id="edge141" class="edge">
<title>expert_56_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M5303.74,-505.8C5300.97,-505.37 5298.22,-504.98 5295.5,-504.62 4987.52,-463.72 4062.82,-442.66 3687.47,-435.61"/>
<polygon fill="black" stroke="black" points="3687.41,-432.11 3677.34,-435.42 3687.28,-439.11 3687.41,-432.11"/>
</g>
<!-- expert_57_s2&#45;&gt;expert_combine_s2 -->
<g id="edge142" class="edge">
<title>expert_57_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M5524.74,-505.78C5521.97,-505.36 5519.22,-504.97 5516.5,-504.62 5164.43,-458.67 4096.19,-440.25 3687.71,-434.77"/>
<polygon fill="black" stroke="black" points="3687.63,-431.26 3677.59,-434.63 3687.54,-438.26 3687.63,-431.26"/>
</g>
<!-- expert_58_s2&#45;&gt;expert_combine_s2 -->
<g id="edge143" class="edge">
<title>expert_58_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M5745.74,-505.77C5742.97,-505.35 5740.22,-504.97 5737.5,-504.62 5341.14,-453.62 4128.04,-438.11 3688.05,-434.09"/>
<polygon fill="black" stroke="black" points="3687.84,-430.59 3677.81,-434 3687.77,-437.59 3687.84,-430.59"/>
</g>
<!-- expert_59_s2&#45;&gt;expert_combine_s2 -->
<g id="edge144" class="edge">
<title>expert_59_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M5966.74,-505.76C5963.97,-505.35 5961.22,-504.96 5958.5,-504.62 5517.58,-448.55 4158.08,-436.16 3688.23,-433.53"/>
<polygon fill="black" stroke="black" points="3687.99,-430.03 3677.97,-433.47 3687.95,-437.03 3687.99,-430.03"/>
</g>
<!-- expert_60_s2&#45;&gt;expert_combine_s2 -->
<g id="edge145" class="edge">
<title>expert_60_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M6187.74,-505.75C6184.97,-505.34 6182.22,-504.96 6179.5,-504.62 5693.69,-443.44 4185.91,-434.38 3687.94,-433.06"/>
<polygon fill="black" stroke="black" points="3687.81,-429.56 3677.8,-433.04 3687.79,-436.56 3687.81,-429.56"/>
</g>
<!-- expert_61_s2&#45;&gt;expert_combine_s2 -->
<g id="edge146" class="edge">
<title>expert_61_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M6408.74,-505.74C6405.97,-505.33 6403.22,-504.96 6400.5,-504.62 5869.91,-438.36 4214.18,-432.74 3688.44,-432.67"/>
<polygon fill="black" stroke="black" points="3688.12,-429.17 3678.12,-432.66 3688.12,-436.17 3688.12,-429.17"/>
</g>
<!-- expert_62_s2&#45;&gt;expert_combine_s2 -->
<g id="edge147" class="edge">
<title>expert_62_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M6629.75,-505.74C6626.97,-505.33 6624.22,-504.95 6621.5,-504.62 6045.64,-433.23 4239.38,-431.21 3687.96,-432.33"/>
<polygon fill="black" stroke="black" points="3687.94,-428.83 3677.95,-432.35 3687.95,-435.83 3687.94,-428.83"/>
</g>
<!-- expert_63_s2&#45;&gt;expert_combine_s2 -->
<g id="edge148" class="edge">
<title>expert_63_s2&#45;&gt;expert_combine_s2</title>
<path fill="none" stroke="black" d="M6850.75,-505.73C6847.97,-505.33 6845.22,-504.95 6842.5,-504.62 6528.47,-465.94 4309.38,-440.77 3687.91,-434.43"/>
<polygon fill="black" stroke="black" points="3687.57,-430.92 3677.54,-434.32 3687.5,-437.92 3687.57,-430.92"/>
</g>
<!-- moe_out_proj_s2 -->
<g id="node88" class="node">
<title>moe_out_proj_s2</title>
<polygon fill="lightblue" stroke="black" points="3633.5,-359.08 3419.5,-359.08 3419.5,-307.08 3633.5,-307.08 3633.5,-359.08"/>
<text text-anchor="middle" x="3526.5" y="-347.08" font-family="Arial" font-size="10.00">MoE Output Proj (TP8)</text>
<text text-anchor="middle" x="3526.5" y="-336.08" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-325.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-314.08" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2&#45;&gt;moe_out_proj_s2 -->
<g id="edge149" class="edge">
<title>expert_combine_s2&#45;&gt;moe_out_proj_s2</title>
<path fill="none" stroke="black" d="M3526.5,-394.81C3526.5,-386.5 3526.5,-377.67 3526.5,-369.39"/>
<polygon fill="black" stroke="black" points="3530,-369.27 3526.5,-359.27 3523,-369.27 3530,-369.27"/>
</g>
<!-- allreduce_moe_out_s2 -->
<g id="node89" class="node">
<title>allreduce_moe_out_s2</title>
<ellipse fill="yellow" stroke="black" cx="3526.5" cy="-234.31" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-248.31" font-family="Arial" font-size="10.00">All&#45;Reduce MoE Output</text>
<text text-anchor="middle" x="3526.5" y="-237.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-226.31" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-215.31" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2&#45;&gt;allreduce_moe_out_s2 -->
<g id="edge150" class="edge">
<title>moe_out_proj_s2&#45;&gt;allreduce_moe_out_s2</title>
<path fill="none" stroke="black" d="M3526.5,-306.91C3526.5,-299.1 3526.5,-290.23 3526.5,-281.46"/>
<polygon fill="black" stroke="black" points="3530,-281.29 3526.5,-271.29 3523,-281.29 3530,-281.29"/>
</g>
<!-- layernorm2_s2 -->
<g id="node90" class="node">
<title>layernorm2_s2</title>
<polygon fill="lightblue" stroke="black" points="3633.5,-161.54 3419.5,-161.54 3419.5,-109.54 3633.5,-109.54 3633.5,-161.54"/>
<text text-anchor="middle" x="3526.5" y="-149.54" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3526.5" y="-138.54" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-127.54" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-116.54" font-family="Arial" font-size="10.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2&#45;&gt;layernorm2_s2 -->
<g id="edge151" class="edge">
<title>allreduce_moe_out_s2&#45;&gt;layernorm2_s2</title>
<path fill="none" stroke="black" d="M3526.5,-197.28C3526.5,-188.96 3526.5,-180.13 3526.5,-171.85"/>
<polygon fill="black" stroke="black" points="3530,-171.74 3526.5,-161.74 3523,-171.74 3530,-171.74"/>
</g>
<!-- output -->
<g id="node91" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="3526.5" cy="-36.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3526.5" y="-50.77" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="3526.5" y="-39.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-28.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526.5" y="-17.77" font-family="Arial" font-size="10.00">GPUs: All</text>
</g>
<!-- layernorm2_s2&#45;&gt;output -->
<g id="edge152" class="edge">
<title>layernorm2_s2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3526.5,-109.37C3526.5,-101.56 3526.5,-92.69 3526.5,-83.92"/>
<polygon fill="black" stroke="black" points="3530,-83.75 3526.5,-73.75 3523,-83.75 3530,-83.75"/>
</g>
</g>
</svg>
