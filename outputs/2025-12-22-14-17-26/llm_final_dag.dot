// LLM EP64-TP8-PP2-DP2 Deployment DAG - Final
digraph {
	bgcolor=white fontname=Arial rankdir=TB
	node [fontname=Arial fontsize=10]
	edge [fontname=Arial fontsize=8]
	input [label="Input\n[batch_size=128, seq_len=1024, hidden=1024]\nGPU: All" fillcolor=lightgray shape=octagon style=filled]
	layer0_ln1 [label="LayerNorm0\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer0_qkv [label="QKV0\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer0_attn [label="Self-Attention0\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer0_attn_out [label="Attention Output0\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer0_res1 [label="Residual10\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer0_ln2 [label="LayerNorm20\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer0_route [label="MoE Route0\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 0-1023" fillcolor=yellow shape=parallelogram style=filled]
	layer0_dispatch [label="Expert Dispatch0\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer0_expert0 [label="Expert0_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 0" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert1 [label="Expert0_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert2 [label="Expert0_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 4" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert3 [label="Expert0_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 6" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert4 [label="Expert0_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 8" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert5 [label="Expert0_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 10" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert6 [label="Expert0_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 12" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert7 [label="Expert0_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 14" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert8 [label="Expert0_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 16" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert9 [label="Expert0_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 18" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert10 [label="Expert0_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 20" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert11 [label="Expert0_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 22" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert12 [label="Expert0_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 24" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert13 [label="Expert0_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 26" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert14 [label="Expert0_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 28" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert15 [label="Expert0_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 30" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert16 [label="Expert0_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 32" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert17 [label="Expert0_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 34" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert18 [label="Expert0_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 36" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert19 [label="Expert0_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 38" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert20 [label="Expert0_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 40" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert21 [label="Expert0_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 42" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert22 [label="Expert0_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 44" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert23 [label="Expert0_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 46" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert24 [label="Expert0_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 48" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert25 [label="Expert0_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 50" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert26 [label="Expert0_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 52" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert27 [label="Expert0_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 54" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert28 [label="Expert0_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 56" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert29 [label="Expert0_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 58" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert30 [label="Expert0_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 60" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert31 [label="Expert0_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 62" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert32 [label="Expert0_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 64" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert33 [label="Expert0_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 66" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert34 [label="Expert0_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 68" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert35 [label="Expert0_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 70" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert36 [label="Expert0_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 72" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert37 [label="Expert0_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 74" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert38 [label="Expert0_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 76" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert39 [label="Expert0_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 78" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert40 [label="Expert0_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 80" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert41 [label="Expert0_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 82" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert42 [label="Expert0_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 84" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert43 [label="Expert0_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 86" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert44 [label="Expert0_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 88" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert45 [label="Expert0_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 90" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert46 [label="Expert0_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 92" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert47 [label="Expert0_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 94" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert48 [label="Expert0_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 96" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert49 [label="Expert0_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 98" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert50 [label="Expert0_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 100" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert51 [label="Expert0_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 102" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert52 [label="Expert0_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 104" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert53 [label="Expert0_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 106" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert54 [label="Expert0_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 108" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert55 [label="Expert0_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 110" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert56 [label="Expert0_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 112" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert57 [label="Expert0_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 114" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert58 [label="Expert0_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 116" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert59 [label="Expert0_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 118" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert60 [label="Expert0_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 120" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert61 [label="Expert0_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 122" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert62 [label="Expert0_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 124" fillcolor=lightblue shape=rectangle style=filled]
	layer0_expert63 [label="Expert0_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 126" fillcolor=lightblue shape=rectangle style=filled]
	layer0_combine [label="Expert Combine0\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer0_moe_out [label="MoE Output0\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer0_ar [label="All-Reduce0\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer0_res2 [label="Residual20\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer1_ln1 [label="LayerNorm1\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer1_qkv [label="QKV1\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer1_attn [label="Self-Attention1\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer1_attn_out [label="Attention Output1\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer1_res1 [label="Residual11\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer1_ln2 [label="LayerNorm21\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer1_route [label="MoE Route1\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 0-1023" fillcolor=yellow shape=parallelogram style=filled]
	layer1_dispatch [label="Expert Dispatch1\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer1_expert0 [label="Expert1_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 128" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert1 [label="Expert1_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 130" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert2 [label="Expert1_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 132" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert3 [label="Expert1_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 134" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert4 [label="Expert1_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 136" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert5 [label="Expert1_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 138" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert6 [label="Expert1_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 140" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert7 [label="Expert1_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 142" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert8 [label="Expert1_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 144" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert9 [label="Expert1_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 146" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert10 [label="Expert1_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 148" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert11 [label="Expert1_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 150" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert12 [label="Expert1_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 152" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert13 [label="Expert1_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 154" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert14 [label="Expert1_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 156" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert15 [label="Expert1_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 158" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert16 [label="Expert1_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 160" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert17 [label="Expert1_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 162" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert18 [label="Expert1_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 164" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert19 [label="Expert1_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 166" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert20 [label="Expert1_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 168" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert21 [label="Expert1_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 170" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert22 [label="Expert1_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 172" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert23 [label="Expert1_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 174" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert24 [label="Expert1_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 176" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert25 [label="Expert1_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 178" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert26 [label="Expert1_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 180" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert27 [label="Expert1_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 182" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert28 [label="Expert1_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 184" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert29 [label="Expert1_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 186" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert30 [label="Expert1_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 188" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert31 [label="Expert1_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 190" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert32 [label="Expert1_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 192" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert33 [label="Expert1_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 194" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert34 [label="Expert1_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 196" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert35 [label="Expert1_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 198" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert36 [label="Expert1_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 200" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert37 [label="Expert1_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 202" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert38 [label="Expert1_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 204" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert39 [label="Expert1_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 206" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert40 [label="Expert1_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 208" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert41 [label="Expert1_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 210" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert42 [label="Expert1_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 212" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert43 [label="Expert1_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 214" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert44 [label="Expert1_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 216" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert45 [label="Expert1_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 218" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert46 [label="Expert1_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 220" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert47 [label="Expert1_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 222" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert48 [label="Expert1_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 224" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert49 [label="Expert1_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 226" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert50 [label="Expert1_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 228" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert51 [label="Expert1_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 230" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert52 [label="Expert1_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 232" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert53 [label="Expert1_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 234" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert54 [label="Expert1_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 236" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert55 [label="Expert1_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 238" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert56 [label="Expert1_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 240" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert57 [label="Expert1_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 242" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert58 [label="Expert1_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 244" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert59 [label="Expert1_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 246" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert60 [label="Expert1_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 248" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert61 [label="Expert1_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 250" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert62 [label="Expert1_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 252" fillcolor=lightblue shape=rectangle style=filled]
	layer1_expert63 [label="Expert1_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 254" fillcolor=lightblue shape=rectangle style=filled]
	layer1_combine [label="Expert Combine1\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer1_moe_out [label="MoE Output1\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer1_ar [label="All-Reduce1\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer1_res2 [label="Residual21\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer2_ln1 [label="LayerNorm2\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer2_qkv [label="QKV2\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer2_attn [label="Self-Attention2\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer2_attn_out [label="Attention Output2\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer2_res1 [label="Residual12\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer2_ln2 [label="LayerNorm22\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer2_route [label="MoE Route2\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 0-1023" fillcolor=yellow shape=parallelogram style=filled]
	layer2_dispatch [label="Expert Dispatch2\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer2_expert0 [label="Expert2_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 256" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert1 [label="Expert2_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 258" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert2 [label="Expert2_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 260" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert3 [label="Expert2_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 262" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert4 [label="Expert2_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 264" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert5 [label="Expert2_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 266" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert6 [label="Expert2_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 268" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert7 [label="Expert2_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 270" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert8 [label="Expert2_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 272" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert9 [label="Expert2_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 274" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert10 [label="Expert2_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 276" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert11 [label="Expert2_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 278" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert12 [label="Expert2_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 280" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert13 [label="Expert2_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 282" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert14 [label="Expert2_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 284" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert15 [label="Expert2_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 286" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert16 [label="Expert2_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 288" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert17 [label="Expert2_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 290" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert18 [label="Expert2_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 292" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert19 [label="Expert2_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 294" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert20 [label="Expert2_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 296" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert21 [label="Expert2_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 298" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert22 [label="Expert2_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 300" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert23 [label="Expert2_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 302" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert24 [label="Expert2_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 304" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert25 [label="Expert2_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 306" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert26 [label="Expert2_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 308" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert27 [label="Expert2_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 310" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert28 [label="Expert2_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 312" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert29 [label="Expert2_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 314" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert30 [label="Expert2_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 316" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert31 [label="Expert2_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 318" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert32 [label="Expert2_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 320" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert33 [label="Expert2_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 322" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert34 [label="Expert2_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 324" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert35 [label="Expert2_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 326" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert36 [label="Expert2_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 328" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert37 [label="Expert2_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 330" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert38 [label="Expert2_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 332" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert39 [label="Expert2_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 334" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert40 [label="Expert2_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 336" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert41 [label="Expert2_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 338" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert42 [label="Expert2_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 340" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert43 [label="Expert2_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 342" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert44 [label="Expert2_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 344" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert45 [label="Expert2_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 346" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert46 [label="Expert2_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 348" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert47 [label="Expert2_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 350" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert48 [label="Expert2_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 352" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert49 [label="Expert2_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 354" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert50 [label="Expert2_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 356" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert51 [label="Expert2_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 358" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert52 [label="Expert2_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 360" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert53 [label="Expert2_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 362" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert54 [label="Expert2_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 364" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert55 [label="Expert2_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 366" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert56 [label="Expert2_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 368" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert57 [label="Expert2_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 370" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert58 [label="Expert2_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 372" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert59 [label="Expert2_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 374" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert60 [label="Expert2_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 376" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert61 [label="Expert2_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 378" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert62 [label="Expert2_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 380" fillcolor=lightblue shape=rectangle style=filled]
	layer2_expert63 [label="Expert2_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 382" fillcolor=lightblue shape=rectangle style=filled]
	layer2_combine [label="Expert Combine2\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer2_moe_out [label="MoE Output2\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer2_ar [label="All-Reduce2\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer2_res2 [label="Residual22\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer3_ln1 [label="LayerNorm3\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer3_qkv [label="QKV3\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer3_attn [label="Self-Attention3\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer3_attn_out [label="Attention Output3\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer3_res1 [label="Residual13\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer3_ln2 [label="LayerNorm23\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer3_route [label="MoE Route3\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 0-1023" fillcolor=yellow shape=parallelogram style=filled]
	layer3_dispatch [label="Expert Dispatch3\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer3_expert0 [label="Expert3_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 384" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert1 [label="Expert3_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 386" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert2 [label="Expert3_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 388" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert3 [label="Expert3_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 390" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert4 [label="Expert3_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 392" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert5 [label="Expert3_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 394" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert6 [label="Expert3_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 396" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert7 [label="Expert3_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 398" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert8 [label="Expert3_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 400" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert9 [label="Expert3_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 402" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert10 [label="Expert3_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 404" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert11 [label="Expert3_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 406" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert12 [label="Expert3_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 408" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert13 [label="Expert3_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 410" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert14 [label="Expert3_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 412" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert15 [label="Expert3_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 414" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert16 [label="Expert3_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 416" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert17 [label="Expert3_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 418" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert18 [label="Expert3_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 420" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert19 [label="Expert3_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 422" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert20 [label="Expert3_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 424" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert21 [label="Expert3_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 426" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert22 [label="Expert3_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 428" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert23 [label="Expert3_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 430" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert24 [label="Expert3_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 432" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert25 [label="Expert3_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 434" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert26 [label="Expert3_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 436" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert27 [label="Expert3_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 438" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert28 [label="Expert3_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 440" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert29 [label="Expert3_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 442" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert30 [label="Expert3_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 444" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert31 [label="Expert3_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 446" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert32 [label="Expert3_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 448" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert33 [label="Expert3_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 450" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert34 [label="Expert3_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 452" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert35 [label="Expert3_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 454" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert36 [label="Expert3_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 456" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert37 [label="Expert3_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 458" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert38 [label="Expert3_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 460" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert39 [label="Expert3_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 462" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert40 [label="Expert3_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 464" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert41 [label="Expert3_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 466" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert42 [label="Expert3_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 468" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert43 [label="Expert3_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 470" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert44 [label="Expert3_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 472" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert45 [label="Expert3_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 474" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert46 [label="Expert3_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 476" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert47 [label="Expert3_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 478" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert48 [label="Expert3_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 480" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert49 [label="Expert3_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 482" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert50 [label="Expert3_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 484" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert51 [label="Expert3_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 486" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert52 [label="Expert3_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 488" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert53 [label="Expert3_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 490" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert54 [label="Expert3_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 492" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert55 [label="Expert3_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 494" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert56 [label="Expert3_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 496" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert57 [label="Expert3_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 498" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert58 [label="Expert3_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 500" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert59 [label="Expert3_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 502" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert60 [label="Expert3_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 504" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert61 [label="Expert3_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 506" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert62 [label="Expert3_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 508" fillcolor=lightblue shape=rectangle style=filled]
	layer3_expert63 [label="Expert3_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 510" fillcolor=lightblue shape=rectangle style=filled]
	layer3_combine [label="Expert Combine3\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer3_moe_out [label="MoE Output3\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer3_ar [label="All-Reduce3\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer3_res2 [label="Residual23\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer4_ln1 [label="LayerNorm4\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer4_qkv [label="QKV4\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer4_attn [label="Self-Attention4\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer4_attn_out [label="Attention Output4\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer4_res1 [label="Residual14\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer4_ln2 [label="LayerNorm24\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer4_route [label="MoE Route4\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 0-1023" fillcolor=yellow shape=parallelogram style=filled]
	layer4_dispatch [label="Expert Dispatch4\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer4_expert0 [label="Expert4_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 512" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert1 [label="Expert4_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 514" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert2 [label="Expert4_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 516" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert3 [label="Expert4_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 518" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert4 [label="Expert4_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 520" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert5 [label="Expert4_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 522" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert6 [label="Expert4_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 524" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert7 [label="Expert4_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 526" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert8 [label="Expert4_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 528" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert9 [label="Expert4_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 530" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert10 [label="Expert4_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 532" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert11 [label="Expert4_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 534" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert12 [label="Expert4_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 536" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert13 [label="Expert4_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 538" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert14 [label="Expert4_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 540" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert15 [label="Expert4_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 542" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert16 [label="Expert4_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 544" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert17 [label="Expert4_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 546" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert18 [label="Expert4_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 548" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert19 [label="Expert4_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 550" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert20 [label="Expert4_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 552" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert21 [label="Expert4_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 554" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert22 [label="Expert4_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 556" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert23 [label="Expert4_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 558" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert24 [label="Expert4_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 560" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert25 [label="Expert4_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 562" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert26 [label="Expert4_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 564" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert27 [label="Expert4_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 566" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert28 [label="Expert4_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 568" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert29 [label="Expert4_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 570" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert30 [label="Expert4_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 572" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert31 [label="Expert4_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 574" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert32 [label="Expert4_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 576" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert33 [label="Expert4_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 578" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert34 [label="Expert4_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 580" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert35 [label="Expert4_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 582" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert36 [label="Expert4_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 584" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert37 [label="Expert4_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 586" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert38 [label="Expert4_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 588" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert39 [label="Expert4_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 590" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert40 [label="Expert4_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 592" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert41 [label="Expert4_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 594" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert42 [label="Expert4_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 596" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert43 [label="Expert4_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 598" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert44 [label="Expert4_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 600" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert45 [label="Expert4_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 602" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert46 [label="Expert4_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 604" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert47 [label="Expert4_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 606" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert48 [label="Expert4_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 608" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert49 [label="Expert4_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 610" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert50 [label="Expert4_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 612" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert51 [label="Expert4_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 614" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert52 [label="Expert4_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 616" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert53 [label="Expert4_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 618" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert54 [label="Expert4_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 620" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert55 [label="Expert4_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 622" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert56 [label="Expert4_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 624" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert57 [label="Expert4_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 626" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert58 [label="Expert4_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 628" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert59 [label="Expert4_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 630" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert60 [label="Expert4_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 632" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert61 [label="Expert4_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 634" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert62 [label="Expert4_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 636" fillcolor=lightblue shape=rectangle style=filled]
	layer4_expert63 [label="Expert4_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 638" fillcolor=lightblue shape=rectangle style=filled]
	layer4_combine [label="Expert Combine4\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer4_moe_out [label="MoE Output4\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer4_ar [label="All-Reduce4\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer4_res2 [label="Residual24\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer5_ln1 [label="LayerNorm5\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer5_qkv [label="QKV5\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer5_attn [label="Self-Attention5\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer5_attn_out [label="Attention Output5\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer5_res1 [label="Residual15\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer5_ln2 [label="LayerNorm25\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer5_route [label="MoE Route5\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 0-1023" fillcolor=yellow shape=parallelogram style=filled]
	layer5_dispatch [label="Expert Dispatch5\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer5_expert0 [label="Expert5_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 640" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert1 [label="Expert5_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 642" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert2 [label="Expert5_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 644" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert3 [label="Expert5_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 646" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert4 [label="Expert5_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 648" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert5 [label="Expert5_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 650" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert6 [label="Expert5_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 652" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert7 [label="Expert5_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 654" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert8 [label="Expert5_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 656" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert9 [label="Expert5_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 658" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert10 [label="Expert5_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 660" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert11 [label="Expert5_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 662" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert12 [label="Expert5_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 664" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert13 [label="Expert5_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 666" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert14 [label="Expert5_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 668" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert15 [label="Expert5_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 670" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert16 [label="Expert5_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 672" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert17 [label="Expert5_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 674" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert18 [label="Expert5_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 676" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert19 [label="Expert5_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 678" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert20 [label="Expert5_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 680" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert21 [label="Expert5_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 682" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert22 [label="Expert5_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 684" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert23 [label="Expert5_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 686" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert24 [label="Expert5_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 688" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert25 [label="Expert5_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 690" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert26 [label="Expert5_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 692" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert27 [label="Expert5_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 694" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert28 [label="Expert5_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 696" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert29 [label="Expert5_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 698" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert30 [label="Expert5_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 700" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert31 [label="Expert5_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 702" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert32 [label="Expert5_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 704" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert33 [label="Expert5_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 706" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert34 [label="Expert5_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 708" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert35 [label="Expert5_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 710" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert36 [label="Expert5_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 712" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert37 [label="Expert5_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 714" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert38 [label="Expert5_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 716" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert39 [label="Expert5_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 718" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert40 [label="Expert5_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 720" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert41 [label="Expert5_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 722" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert42 [label="Expert5_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 724" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert43 [label="Expert5_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 726" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert44 [label="Expert5_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 728" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert45 [label="Expert5_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 730" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert46 [label="Expert5_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 732" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert47 [label="Expert5_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 734" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert48 [label="Expert5_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 736" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert49 [label="Expert5_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 738" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert50 [label="Expert5_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 740" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert51 [label="Expert5_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 742" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert52 [label="Expert5_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 744" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert53 [label="Expert5_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 746" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert54 [label="Expert5_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 748" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert55 [label="Expert5_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 750" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert56 [label="Expert5_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 752" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert57 [label="Expert5_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 754" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert58 [label="Expert5_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 756" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert59 [label="Expert5_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 758" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert60 [label="Expert5_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 760" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert61 [label="Expert5_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 762" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert62 [label="Expert5_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 764" fillcolor=lightblue shape=rectangle style=filled]
	layer5_expert63 [label="Expert5_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 766" fillcolor=lightblue shape=rectangle style=filled]
	layer5_combine [label="Expert Combine5\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer5_moe_out [label="MoE Output5\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer5_ar [label="All-Reduce5\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer5_res2 [label="Residual25\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer6_ln1 [label="LayerNorm6\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer6_qkv [label="QKV6\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer6_attn [label="Self-Attention6\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer6_attn_out [label="Attention Output6\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer6_res1 [label="Residual16\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer6_ln2 [label="LayerNorm26\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer6_route [label="MoE Route6\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 0-1023" fillcolor=yellow shape=parallelogram style=filled]
	layer6_dispatch [label="Expert Dispatch6\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer6_expert0 [label="Expert6_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 768" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert1 [label="Expert6_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 770" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert2 [label="Expert6_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 772" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert3 [label="Expert6_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 774" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert4 [label="Expert6_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 776" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert5 [label="Expert6_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 778" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert6 [label="Expert6_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 780" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert7 [label="Expert6_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 782" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert8 [label="Expert6_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 784" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert9 [label="Expert6_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 786" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert10 [label="Expert6_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 788" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert11 [label="Expert6_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 790" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert12 [label="Expert6_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 792" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert13 [label="Expert6_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 794" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert14 [label="Expert6_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 796" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert15 [label="Expert6_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 798" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert16 [label="Expert6_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 800" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert17 [label="Expert6_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 802" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert18 [label="Expert6_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 804" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert19 [label="Expert6_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 806" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert20 [label="Expert6_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 808" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert21 [label="Expert6_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 810" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert22 [label="Expert6_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 812" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert23 [label="Expert6_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 814" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert24 [label="Expert6_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 816" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert25 [label="Expert6_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 818" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert26 [label="Expert6_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 820" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert27 [label="Expert6_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 822" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert28 [label="Expert6_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 824" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert29 [label="Expert6_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 826" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert30 [label="Expert6_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 828" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert31 [label="Expert6_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 830" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert32 [label="Expert6_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 832" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert33 [label="Expert6_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 834" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert34 [label="Expert6_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 836" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert35 [label="Expert6_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 838" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert36 [label="Expert6_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 840" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert37 [label="Expert6_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 842" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert38 [label="Expert6_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 844" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert39 [label="Expert6_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 846" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert40 [label="Expert6_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 848" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert41 [label="Expert6_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 850" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert42 [label="Expert6_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 852" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert43 [label="Expert6_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 854" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert44 [label="Expert6_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 856" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert45 [label="Expert6_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 858" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert46 [label="Expert6_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 860" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert47 [label="Expert6_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 862" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert48 [label="Expert6_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 864" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert49 [label="Expert6_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 866" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert50 [label="Expert6_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 868" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert51 [label="Expert6_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 870" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert52 [label="Expert6_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 872" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert53 [label="Expert6_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 874" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert54 [label="Expert6_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 876" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert55 [label="Expert6_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 878" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert56 [label="Expert6_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 880" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert57 [label="Expert6_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 882" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert58 [label="Expert6_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 884" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert59 [label="Expert6_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 886" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert60 [label="Expert6_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 888" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert61 [label="Expert6_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 890" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert62 [label="Expert6_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 892" fillcolor=lightblue shape=rectangle style=filled]
	layer6_expert63 [label="Expert6_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 894" fillcolor=lightblue shape=rectangle style=filled]
	layer6_combine [label="Expert Combine6\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer6_moe_out [label="MoE Output6\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer6_ar [label="All-Reduce6\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer6_res2 [label="Residual26\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer7_ln1 [label="LayerNorm7\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer7_qkv [label="QKV7\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer7_attn [label="Self-Attention7\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer7_attn_out [label="Attention Output7\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer7_res1 [label="Residual17\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer7_ln2 [label="LayerNorm27\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer7_route [label="MoE Route7\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 0-1023" fillcolor=yellow shape=parallelogram style=filled]
	layer7_dispatch [label="Expert Dispatch7\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer7_expert0 [label="Expert7_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 896" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert1 [label="Expert7_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 898" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert2 [label="Expert7_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 900" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert3 [label="Expert7_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 902" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert4 [label="Expert7_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 904" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert5 [label="Expert7_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 906" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert6 [label="Expert7_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 908" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert7 [label="Expert7_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 910" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert8 [label="Expert7_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 912" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert9 [label="Expert7_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 914" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert10 [label="Expert7_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 916" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert11 [label="Expert7_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 918" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert12 [label="Expert7_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 920" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert13 [label="Expert7_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 922" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert14 [label="Expert7_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 924" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert15 [label="Expert7_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 926" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert16 [label="Expert7_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 928" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert17 [label="Expert7_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 930" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert18 [label="Expert7_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 932" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert19 [label="Expert7_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 934" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert20 [label="Expert7_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 936" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert21 [label="Expert7_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 938" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert22 [label="Expert7_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 940" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert23 [label="Expert7_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 942" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert24 [label="Expert7_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 944" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert25 [label="Expert7_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 946" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert26 [label="Expert7_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 948" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert27 [label="Expert7_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 950" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert28 [label="Expert7_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 952" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert29 [label="Expert7_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 954" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert30 [label="Expert7_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 956" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert31 [label="Expert7_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 958" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert32 [label="Expert7_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 960" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert33 [label="Expert7_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 962" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert34 [label="Expert7_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 964" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert35 [label="Expert7_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 966" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert36 [label="Expert7_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 968" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert37 [label="Expert7_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 970" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert38 [label="Expert7_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 972" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert39 [label="Expert7_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 974" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert40 [label="Expert7_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 976" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert41 [label="Expert7_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 978" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert42 [label="Expert7_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 980" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert43 [label="Expert7_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 982" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert44 [label="Expert7_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 984" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert45 [label="Expert7_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 986" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert46 [label="Expert7_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 988" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert47 [label="Expert7_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 990" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert48 [label="Expert7_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 992" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert49 [label="Expert7_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 994" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert50 [label="Expert7_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 996" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert51 [label="Expert7_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 998" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert52 [label="Expert7_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1000" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert53 [label="Expert7_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1002" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert54 [label="Expert7_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1004" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert55 [label="Expert7_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1006" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert56 [label="Expert7_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1008" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert57 [label="Expert7_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1010" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert58 [label="Expert7_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1012" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert59 [label="Expert7_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1014" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert60 [label="Expert7_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1016" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert61 [label="Expert7_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1018" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert62 [label="Expert7_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1020" fillcolor=lightblue shape=rectangle style=filled]
	layer7_expert63 [label="Expert7_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1022" fillcolor=lightblue shape=rectangle style=filled]
	layer7_combine [label="Expert Combine7\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer7_moe_out [label="MoE Output7\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	layer7_ar [label="All-Reduce7\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightgreen shape=ellipse style=filled]
	layer7_res2 [label="Residual27\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 0-1023" fillcolor=lightblue shape=rectangle style=filled]
	pp_transfer [label="Pipeline Transfer\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: 10231024" fillcolor=lightgreen shape=ellipse style=filled]
	layer8_ln1 [label="LayerNorm8\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer8_qkv [label="QKV8\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer8_attn [label="Self-Attention8\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer8_attn_out [label="Attention Output8\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer8_res1 [label="Residual18\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer8_ln2 [label="LayerNorm28\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer8_route [label="MoE Route8\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 1024-2047" fillcolor=yellow shape=parallelogram style=filled]
	layer8_dispatch [label="Expert Dispatch8\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer8_expert0 [label="Expert8_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1024" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert1 [label="Expert8_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1026" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert2 [label="Expert8_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1028" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert3 [label="Expert8_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1030" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert4 [label="Expert8_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1032" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert5 [label="Expert8_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1034" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert6 [label="Expert8_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1036" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert7 [label="Expert8_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1038" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert8 [label="Expert8_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1040" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert9 [label="Expert8_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1042" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert10 [label="Expert8_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1044" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert11 [label="Expert8_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1046" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert12 [label="Expert8_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1048" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert13 [label="Expert8_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1050" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert14 [label="Expert8_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1052" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert15 [label="Expert8_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1054" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert16 [label="Expert8_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1056" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert17 [label="Expert8_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1058" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert18 [label="Expert8_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1060" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert19 [label="Expert8_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1062" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert20 [label="Expert8_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1064" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert21 [label="Expert8_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1066" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert22 [label="Expert8_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1068" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert23 [label="Expert8_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1070" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert24 [label="Expert8_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1072" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert25 [label="Expert8_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1074" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert26 [label="Expert8_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1076" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert27 [label="Expert8_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1078" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert28 [label="Expert8_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1080" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert29 [label="Expert8_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1082" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert30 [label="Expert8_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1084" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert31 [label="Expert8_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1086" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert32 [label="Expert8_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1088" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert33 [label="Expert8_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1090" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert34 [label="Expert8_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1092" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert35 [label="Expert8_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1094" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert36 [label="Expert8_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1096" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert37 [label="Expert8_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1098" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert38 [label="Expert8_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1100" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert39 [label="Expert8_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1102" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert40 [label="Expert8_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1104" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert41 [label="Expert8_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1106" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert42 [label="Expert8_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1108" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert43 [label="Expert8_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1110" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert44 [label="Expert8_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1112" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert45 [label="Expert8_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1114" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert46 [label="Expert8_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1116" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert47 [label="Expert8_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1118" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert48 [label="Expert8_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1120" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert49 [label="Expert8_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1122" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert50 [label="Expert8_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1124" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert51 [label="Expert8_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1126" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert52 [label="Expert8_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1128" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert53 [label="Expert8_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1130" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert54 [label="Expert8_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1132" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert55 [label="Expert8_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1134" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert56 [label="Expert8_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1136" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert57 [label="Expert8_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1138" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert58 [label="Expert8_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1140" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert59 [label="Expert8_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1142" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert60 [label="Expert8_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1144" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert61 [label="Expert8_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1146" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert62 [label="Expert8_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1148" fillcolor=lightblue shape=rectangle style=filled]
	layer8_expert63 [label="Expert8_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1150" fillcolor=lightblue shape=rectangle style=filled]
	layer8_combine [label="Expert Combine8\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer8_moe_out [label="MoE Output8\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer8_ar [label="All-Reduce8\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer8_res2 [label="Residual28\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer9_ln1 [label="LayerNorm9\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer9_qkv [label="QKV9\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer9_attn [label="Self-Attention9\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer9_attn_out [label="Attention Output9\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer9_res1 [label="Residual19\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer9_ln2 [label="LayerNorm29\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer9_route [label="MoE Route9\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 1024-2047" fillcolor=yellow shape=parallelogram style=filled]
	layer9_dispatch [label="Expert Dispatch9\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer9_expert0 [label="Expert9_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1152" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert1 [label="Expert9_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1154" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert2 [label="Expert9_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1156" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert3 [label="Expert9_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1158" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert4 [label="Expert9_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1160" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert5 [label="Expert9_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1162" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert6 [label="Expert9_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1164" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert7 [label="Expert9_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1166" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert8 [label="Expert9_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1168" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert9 [label="Expert9_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1170" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert10 [label="Expert9_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1172" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert11 [label="Expert9_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1174" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert12 [label="Expert9_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1176" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert13 [label="Expert9_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1178" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert14 [label="Expert9_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1180" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert15 [label="Expert9_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1182" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert16 [label="Expert9_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1184" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert17 [label="Expert9_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1186" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert18 [label="Expert9_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1188" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert19 [label="Expert9_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1190" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert20 [label="Expert9_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1192" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert21 [label="Expert9_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1194" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert22 [label="Expert9_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1196" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert23 [label="Expert9_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1198" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert24 [label="Expert9_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1200" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert25 [label="Expert9_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1202" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert26 [label="Expert9_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1204" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert27 [label="Expert9_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1206" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert28 [label="Expert9_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1208" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert29 [label="Expert9_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1210" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert30 [label="Expert9_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1212" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert31 [label="Expert9_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1214" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert32 [label="Expert9_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1216" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert33 [label="Expert9_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1218" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert34 [label="Expert9_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1220" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert35 [label="Expert9_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1222" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert36 [label="Expert9_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1224" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert37 [label="Expert9_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1226" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert38 [label="Expert9_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1228" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert39 [label="Expert9_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1230" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert40 [label="Expert9_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1232" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert41 [label="Expert9_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1234" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert42 [label="Expert9_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1236" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert43 [label="Expert9_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1238" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert44 [label="Expert9_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1240" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert45 [label="Expert9_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1242" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert46 [label="Expert9_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1244" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert47 [label="Expert9_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1246" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert48 [label="Expert9_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1248" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert49 [label="Expert9_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1250" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert50 [label="Expert9_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1252" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert51 [label="Expert9_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1254" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert52 [label="Expert9_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1256" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert53 [label="Expert9_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1258" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert54 [label="Expert9_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1260" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert55 [label="Expert9_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1262" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert56 [label="Expert9_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1264" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert57 [label="Expert9_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1266" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert58 [label="Expert9_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1268" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert59 [label="Expert9_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1270" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert60 [label="Expert9_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1272" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert61 [label="Expert9_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1274" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert62 [label="Expert9_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1276" fillcolor=lightblue shape=rectangle style=filled]
	layer9_expert63 [label="Expert9_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1278" fillcolor=lightblue shape=rectangle style=filled]
	layer9_combine [label="Expert Combine9\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer9_moe_out [label="MoE Output9\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer9_ar [label="All-Reduce9\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer9_res2 [label="Residual29\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer10_ln1 [label="LayerNorm10\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer10_qkv [label="QKV10\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer10_attn [label="Self-Attention10\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer10_attn_out [label="Attention Output10\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer10_res1 [label="Residual110\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer10_ln2 [label="LayerNorm210\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer10_route [label="MoE Route10\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 1024-2047" fillcolor=yellow shape=parallelogram style=filled]
	layer10_dispatch [label="Expert Dispatch10\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer10_expert0 [label="Expert10_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1280" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert1 [label="Expert10_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1282" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert2 [label="Expert10_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1284" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert3 [label="Expert10_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1286" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert4 [label="Expert10_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1288" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert5 [label="Expert10_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1290" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert6 [label="Expert10_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1292" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert7 [label="Expert10_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1294" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert8 [label="Expert10_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1296" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert9 [label="Expert10_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1298" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert10 [label="Expert10_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1300" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert11 [label="Expert10_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1302" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert12 [label="Expert10_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1304" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert13 [label="Expert10_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1306" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert14 [label="Expert10_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1308" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert15 [label="Expert10_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1310" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert16 [label="Expert10_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1312" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert17 [label="Expert10_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1314" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert18 [label="Expert10_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1316" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert19 [label="Expert10_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1318" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert20 [label="Expert10_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1320" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert21 [label="Expert10_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1322" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert22 [label="Expert10_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1324" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert23 [label="Expert10_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1326" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert24 [label="Expert10_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1328" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert25 [label="Expert10_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1330" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert26 [label="Expert10_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1332" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert27 [label="Expert10_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1334" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert28 [label="Expert10_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1336" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert29 [label="Expert10_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1338" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert30 [label="Expert10_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1340" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert31 [label="Expert10_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1342" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert32 [label="Expert10_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1344" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert33 [label="Expert10_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1346" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert34 [label="Expert10_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1348" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert35 [label="Expert10_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1350" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert36 [label="Expert10_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1352" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert37 [label="Expert10_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1354" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert38 [label="Expert10_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1356" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert39 [label="Expert10_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1358" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert40 [label="Expert10_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1360" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert41 [label="Expert10_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1362" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert42 [label="Expert10_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1364" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert43 [label="Expert10_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1366" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert44 [label="Expert10_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1368" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert45 [label="Expert10_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1370" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert46 [label="Expert10_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1372" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert47 [label="Expert10_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1374" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert48 [label="Expert10_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1376" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert49 [label="Expert10_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1378" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert50 [label="Expert10_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1380" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert51 [label="Expert10_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1382" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert52 [label="Expert10_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1384" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert53 [label="Expert10_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1386" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert54 [label="Expert10_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1388" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert55 [label="Expert10_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1390" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert56 [label="Expert10_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1392" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert57 [label="Expert10_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1394" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert58 [label="Expert10_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1396" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert59 [label="Expert10_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1398" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert60 [label="Expert10_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1400" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert61 [label="Expert10_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1402" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert62 [label="Expert10_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1404" fillcolor=lightblue shape=rectangle style=filled]
	layer10_expert63 [label="Expert10_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1406" fillcolor=lightblue shape=rectangle style=filled]
	layer10_combine [label="Expert Combine10\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer10_moe_out [label="MoE Output10\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer10_ar [label="All-Reduce10\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer10_res2 [label="Residual210\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer11_ln1 [label="LayerNorm11\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer11_qkv [label="QKV11\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer11_attn [label="Self-Attention11\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer11_attn_out [label="Attention Output11\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer11_res1 [label="Residual111\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer11_ln2 [label="LayerNorm211\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer11_route [label="MoE Route11\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 1024-2047" fillcolor=yellow shape=parallelogram style=filled]
	layer11_dispatch [label="Expert Dispatch11\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer11_expert0 [label="Expert11_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1408" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert1 [label="Expert11_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1410" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert2 [label="Expert11_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1412" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert3 [label="Expert11_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1414" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert4 [label="Expert11_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1416" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert5 [label="Expert11_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1418" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert6 [label="Expert11_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1420" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert7 [label="Expert11_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1422" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert8 [label="Expert11_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1424" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert9 [label="Expert11_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1426" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert10 [label="Expert11_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1428" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert11 [label="Expert11_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1430" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert12 [label="Expert11_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1432" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert13 [label="Expert11_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1434" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert14 [label="Expert11_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1436" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert15 [label="Expert11_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1438" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert16 [label="Expert11_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1440" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert17 [label="Expert11_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1442" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert18 [label="Expert11_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1444" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert19 [label="Expert11_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1446" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert20 [label="Expert11_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1448" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert21 [label="Expert11_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1450" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert22 [label="Expert11_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1452" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert23 [label="Expert11_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1454" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert24 [label="Expert11_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1456" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert25 [label="Expert11_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1458" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert26 [label="Expert11_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1460" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert27 [label="Expert11_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1462" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert28 [label="Expert11_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1464" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert29 [label="Expert11_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1466" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert30 [label="Expert11_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1468" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert31 [label="Expert11_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1470" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert32 [label="Expert11_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1472" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert33 [label="Expert11_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1474" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert34 [label="Expert11_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1476" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert35 [label="Expert11_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1478" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert36 [label="Expert11_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1480" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert37 [label="Expert11_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1482" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert38 [label="Expert11_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1484" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert39 [label="Expert11_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1486" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert40 [label="Expert11_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1488" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert41 [label="Expert11_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1490" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert42 [label="Expert11_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1492" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert43 [label="Expert11_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1494" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert44 [label="Expert11_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1496" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert45 [label="Expert11_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1498" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert46 [label="Expert11_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1500" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert47 [label="Expert11_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1502" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert48 [label="Expert11_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1504" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert49 [label="Expert11_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1506" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert50 [label="Expert11_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1508" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert51 [label="Expert11_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1510" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert52 [label="Expert11_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1512" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert53 [label="Expert11_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1514" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert54 [label="Expert11_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1516" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert55 [label="Expert11_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1518" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert56 [label="Expert11_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1520" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert57 [label="Expert11_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1522" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert58 [label="Expert11_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1524" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert59 [label="Expert11_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1526" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert60 [label="Expert11_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1528" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert61 [label="Expert11_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1530" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert62 [label="Expert11_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1532" fillcolor=lightblue shape=rectangle style=filled]
	layer11_expert63 [label="Expert11_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1534" fillcolor=lightblue shape=rectangle style=filled]
	layer11_combine [label="Expert Combine11\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer11_moe_out [label="MoE Output11\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer11_ar [label="All-Reduce11\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer11_res2 [label="Residual211\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer12_ln1 [label="LayerNorm12\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer12_qkv [label="QKV12\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer12_attn [label="Self-Attention12\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer12_attn_out [label="Attention Output12\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer12_res1 [label="Residual112\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer12_ln2 [label="LayerNorm212\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer12_route [label="MoE Route12\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 1024-2047" fillcolor=yellow shape=parallelogram style=filled]
	layer12_dispatch [label="Expert Dispatch12\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer12_expert0 [label="Expert12_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1536" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert1 [label="Expert12_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1538" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert2 [label="Expert12_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1540" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert3 [label="Expert12_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1542" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert4 [label="Expert12_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1544" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert5 [label="Expert12_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1546" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert6 [label="Expert12_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1548" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert7 [label="Expert12_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1550" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert8 [label="Expert12_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1552" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert9 [label="Expert12_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1554" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert10 [label="Expert12_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1556" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert11 [label="Expert12_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1558" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert12 [label="Expert12_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1560" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert13 [label="Expert12_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1562" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert14 [label="Expert12_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1564" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert15 [label="Expert12_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1566" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert16 [label="Expert12_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1568" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert17 [label="Expert12_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1570" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert18 [label="Expert12_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1572" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert19 [label="Expert12_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1574" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert20 [label="Expert12_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1576" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert21 [label="Expert12_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1578" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert22 [label="Expert12_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1580" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert23 [label="Expert12_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1582" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert24 [label="Expert12_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1584" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert25 [label="Expert12_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1586" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert26 [label="Expert12_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1588" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert27 [label="Expert12_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1590" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert28 [label="Expert12_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1592" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert29 [label="Expert12_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1594" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert30 [label="Expert12_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1596" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert31 [label="Expert12_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1598" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert32 [label="Expert12_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1600" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert33 [label="Expert12_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1602" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert34 [label="Expert12_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1604" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert35 [label="Expert12_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1606" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert36 [label="Expert12_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1608" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert37 [label="Expert12_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1610" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert38 [label="Expert12_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1612" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert39 [label="Expert12_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1614" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert40 [label="Expert12_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1616" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert41 [label="Expert12_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1618" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert42 [label="Expert12_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1620" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert43 [label="Expert12_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1622" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert44 [label="Expert12_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1624" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert45 [label="Expert12_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1626" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert46 [label="Expert12_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1628" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert47 [label="Expert12_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1630" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert48 [label="Expert12_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1632" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert49 [label="Expert12_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1634" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert50 [label="Expert12_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1636" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert51 [label="Expert12_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1638" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert52 [label="Expert12_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1640" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert53 [label="Expert12_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1642" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert54 [label="Expert12_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1644" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert55 [label="Expert12_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1646" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert56 [label="Expert12_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1648" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert57 [label="Expert12_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1650" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert58 [label="Expert12_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1652" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert59 [label="Expert12_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1654" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert60 [label="Expert12_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1656" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert61 [label="Expert12_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1658" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert62 [label="Expert12_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1660" fillcolor=lightblue shape=rectangle style=filled]
	layer12_expert63 [label="Expert12_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1662" fillcolor=lightblue shape=rectangle style=filled]
	layer12_combine [label="Expert Combine12\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer12_moe_out [label="MoE Output12\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer12_ar [label="All-Reduce12\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer12_res2 [label="Residual212\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer13_ln1 [label="LayerNorm13\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer13_qkv [label="QKV13\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer13_attn [label="Self-Attention13\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer13_attn_out [label="Attention Output13\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer13_res1 [label="Residual113\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer13_ln2 [label="LayerNorm213\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer13_route [label="MoE Route13\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 1024-2047" fillcolor=yellow shape=parallelogram style=filled]
	layer13_dispatch [label="Expert Dispatch13\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer13_expert0 [label="Expert13_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1664" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert1 [label="Expert13_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1666" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert2 [label="Expert13_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1668" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert3 [label="Expert13_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1670" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert4 [label="Expert13_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1672" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert5 [label="Expert13_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1674" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert6 [label="Expert13_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1676" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert7 [label="Expert13_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1678" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert8 [label="Expert13_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1680" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert9 [label="Expert13_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1682" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert10 [label="Expert13_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1684" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert11 [label="Expert13_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1686" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert12 [label="Expert13_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1688" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert13 [label="Expert13_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1690" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert14 [label="Expert13_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1692" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert15 [label="Expert13_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1694" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert16 [label="Expert13_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1696" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert17 [label="Expert13_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1698" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert18 [label="Expert13_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1700" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert19 [label="Expert13_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1702" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert20 [label="Expert13_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1704" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert21 [label="Expert13_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1706" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert22 [label="Expert13_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1708" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert23 [label="Expert13_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1710" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert24 [label="Expert13_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1712" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert25 [label="Expert13_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1714" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert26 [label="Expert13_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1716" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert27 [label="Expert13_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1718" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert28 [label="Expert13_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1720" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert29 [label="Expert13_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1722" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert30 [label="Expert13_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1724" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert31 [label="Expert13_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1726" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert32 [label="Expert13_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1728" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert33 [label="Expert13_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1730" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert34 [label="Expert13_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1732" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert35 [label="Expert13_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1734" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert36 [label="Expert13_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1736" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert37 [label="Expert13_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1738" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert38 [label="Expert13_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1740" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert39 [label="Expert13_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1742" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert40 [label="Expert13_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1744" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert41 [label="Expert13_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1746" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert42 [label="Expert13_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1748" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert43 [label="Expert13_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1750" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert44 [label="Expert13_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1752" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert45 [label="Expert13_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1754" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert46 [label="Expert13_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1756" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert47 [label="Expert13_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1758" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert48 [label="Expert13_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1760" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert49 [label="Expert13_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1762" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert50 [label="Expert13_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1764" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert51 [label="Expert13_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1766" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert52 [label="Expert13_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1768" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert53 [label="Expert13_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1770" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert54 [label="Expert13_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1772" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert55 [label="Expert13_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1774" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert56 [label="Expert13_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1776" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert57 [label="Expert13_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1778" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert58 [label="Expert13_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1780" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert59 [label="Expert13_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1782" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert60 [label="Expert13_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1784" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert61 [label="Expert13_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1786" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert62 [label="Expert13_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1788" fillcolor=lightblue shape=rectangle style=filled]
	layer13_expert63 [label="Expert13_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1790" fillcolor=lightblue shape=rectangle style=filled]
	layer13_combine [label="Expert Combine13\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer13_moe_out [label="MoE Output13\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer13_ar [label="All-Reduce13\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer13_res2 [label="Residual213\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer14_ln1 [label="LayerNorm14\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer14_qkv [label="QKV14\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer14_attn [label="Self-Attention14\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer14_attn_out [label="Attention Output14\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer14_res1 [label="Residual114\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer14_ln2 [label="LayerNorm214\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer14_route [label="MoE Route14\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 1024-2047" fillcolor=yellow shape=parallelogram style=filled]
	layer14_dispatch [label="Expert Dispatch14\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer14_expert0 [label="Expert14_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1792" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert1 [label="Expert14_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1794" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert2 [label="Expert14_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1796" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert3 [label="Expert14_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1798" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert4 [label="Expert14_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1800" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert5 [label="Expert14_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1802" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert6 [label="Expert14_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1804" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert7 [label="Expert14_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1806" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert8 [label="Expert14_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1808" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert9 [label="Expert14_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1810" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert10 [label="Expert14_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1812" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert11 [label="Expert14_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1814" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert12 [label="Expert14_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1816" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert13 [label="Expert14_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1818" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert14 [label="Expert14_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1820" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert15 [label="Expert14_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1822" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert16 [label="Expert14_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1824" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert17 [label="Expert14_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1826" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert18 [label="Expert14_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1828" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert19 [label="Expert14_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1830" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert20 [label="Expert14_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1832" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert21 [label="Expert14_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1834" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert22 [label="Expert14_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1836" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert23 [label="Expert14_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1838" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert24 [label="Expert14_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1840" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert25 [label="Expert14_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1842" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert26 [label="Expert14_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1844" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert27 [label="Expert14_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1846" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert28 [label="Expert14_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1848" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert29 [label="Expert14_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1850" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert30 [label="Expert14_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1852" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert31 [label="Expert14_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1854" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert32 [label="Expert14_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1856" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert33 [label="Expert14_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1858" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert34 [label="Expert14_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1860" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert35 [label="Expert14_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1862" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert36 [label="Expert14_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1864" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert37 [label="Expert14_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1866" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert38 [label="Expert14_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1868" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert39 [label="Expert14_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1870" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert40 [label="Expert14_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1872" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert41 [label="Expert14_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1874" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert42 [label="Expert14_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1876" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert43 [label="Expert14_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1878" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert44 [label="Expert14_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1880" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert45 [label="Expert14_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1882" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert46 [label="Expert14_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1884" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert47 [label="Expert14_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1886" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert48 [label="Expert14_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1888" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert49 [label="Expert14_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1890" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert50 [label="Expert14_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1892" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert51 [label="Expert14_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1894" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert52 [label="Expert14_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1896" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert53 [label="Expert14_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1898" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert54 [label="Expert14_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1900" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert55 [label="Expert14_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1902" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert56 [label="Expert14_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1904" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert57 [label="Expert14_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1906" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert58 [label="Expert14_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1908" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert59 [label="Expert14_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1910" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert60 [label="Expert14_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1912" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert61 [label="Expert14_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1914" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert62 [label="Expert14_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1916" fillcolor=lightblue shape=rectangle style=filled]
	layer14_expert63 [label="Expert14_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1918" fillcolor=lightblue shape=rectangle style=filled]
	layer14_combine [label="Expert Combine14\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer14_moe_out [label="MoE Output14\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer14_ar [label="All-Reduce14\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer14_res2 [label="Residual214\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer15_ln1 [label="LayerNorm15\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer15_qkv [label="QKV15\nInput: [128,1024,1024]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer15_attn [label="Self-Attention15\nInput: [128,1024,16,64]\nOutput: [128,1024,16,64]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer15_attn_out [label="Attention Output15\nInput: [128,1024,16,64]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer15_res1 [label="Residual115\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer15_ln2 [label="LayerNorm215\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer15_route [label="MoE Route15\nInput: [128,1024,1024]\nOutput: [128,1024,64]\nGPU: GPUs 1024-2047" fillcolor=yellow shape=parallelogram style=filled]
	layer15_dispatch [label="Expert Dispatch15\nInput: [128,1024,1024]\nOutput: [2,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer15_expert0 [label="Expert15_0\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1920" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert1 [label="Expert15_1\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1922" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert2 [label="Expert15_2\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1924" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert3 [label="Expert15_3\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1926" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert4 [label="Expert15_4\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1928" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert5 [label="Expert15_5\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1930" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert6 [label="Expert15_6\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1932" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert7 [label="Expert15_7\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1934" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert8 [label="Expert15_8\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1936" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert9 [label="Expert15_9\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1938" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert10 [label="Expert15_10\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1940" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert11 [label="Expert15_11\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1942" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert12 [label="Expert15_12\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1944" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert13 [label="Expert15_13\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1946" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert14 [label="Expert15_14\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1948" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert15 [label="Expert15_15\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1950" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert16 [label="Expert15_16\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1952" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert17 [label="Expert15_17\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1954" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert18 [label="Expert15_18\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1956" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert19 [label="Expert15_19\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1958" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert20 [label="Expert15_20\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1960" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert21 [label="Expert15_21\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1962" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert22 [label="Expert15_22\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1964" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert23 [label="Expert15_23\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1966" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert24 [label="Expert15_24\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1968" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert25 [label="Expert15_25\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1970" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert26 [label="Expert15_26\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1972" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert27 [label="Expert15_27\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1974" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert28 [label="Expert15_28\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1976" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert29 [label="Expert15_29\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1978" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert30 [label="Expert15_30\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1980" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert31 [label="Expert15_31\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1982" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert32 [label="Expert15_32\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1984" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert33 [label="Expert15_33\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1986" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert34 [label="Expert15_34\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1988" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert35 [label="Expert15_35\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1990" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert36 [label="Expert15_36\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1992" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert37 [label="Expert15_37\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1994" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert38 [label="Expert15_38\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1996" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert39 [label="Expert15_39\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 1998" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert40 [label="Expert15_40\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2000" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert41 [label="Expert15_41\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2002" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert42 [label="Expert15_42\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2004" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert43 [label="Expert15_43\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2006" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert44 [label="Expert15_44\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2008" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert45 [label="Expert15_45\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2010" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert46 [label="Expert15_46\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2012" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert47 [label="Expert15_47\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2014" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert48 [label="Expert15_48\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2016" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert49 [label="Expert15_49\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2018" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert50 [label="Expert15_50\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2020" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert51 [label="Expert15_51\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2022" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert52 [label="Expert15_52\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2024" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert53 [label="Expert15_53\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2026" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert54 [label="Expert15_54\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2028" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert55 [label="Expert15_55\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2030" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert56 [label="Expert15_56\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2032" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert57 [label="Expert15_57\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2034" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert58 [label="Expert15_58\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2036" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert59 [label="Expert15_59\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2038" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert60 [label="Expert15_60\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2040" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert61 [label="Expert15_61\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2042" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert62 [label="Expert15_62\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2044" fillcolor=lightblue shape=rectangle style=filled]
	layer15_expert63 [label="Expert15_63\nInput: [2,1024,1024]\nOutput: [2,1024,2048]\nGPU: 2046" fillcolor=lightblue shape=rectangle style=filled]
	layer15_combine [label="Expert Combine15\nInput: [2,1024,2048]\nOutput: [128,1024,2048]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer15_moe_out [label="MoE Output15\nInput: [128,1024,2048]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	layer15_ar [label="All-Reduce15\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightgreen shape=ellipse style=filled]
	layer15_res2 [label="Residual215\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: GPUs 1024-2047" fillcolor=lightblue shape=rectangle style=filled]
	final_ln [label="Final LayerNorm\nInput: [128,1024,1024]\nOutput: [128,1024,1024]\nGPU: 2047" fillcolor=lightblue shape=rectangle style=filled]
	output [label="Output\n[batch_size=128, seq_len=1024, vocab=32000]\nGPU: 2047" fillcolor=lightgray shape=doubleoctagon style=filled]
	input -> layer0_ln1
	layer0_ln1 -> layer0_qkv
	layer0_qkv -> layer0_attn
	layer0_attn -> layer0_attn_out
	layer0_attn_out -> layer0_res1
	layer0_res1 -> layer0_ln2
	layer0_ln2 -> layer0_route
	layer0_route -> layer0_dispatch [style=dashed]
	layer0_dispatch -> layer0_expert0
	layer0_expert0 -> layer0_combine
	layer0_dispatch -> layer0_expert1
	layer0_expert1 -> layer0_combine
	layer0_dispatch -> layer0_expert2
	layer0_expert2 -> layer0_combine
	layer0_dispatch -> layer0_expert3
	layer0_expert3 -> layer0_combine
	layer0_dispatch -> layer0_expert4
	layer0_expert4 -> layer0_combine
	layer0_dispatch -> layer0_expert5
	layer0_expert5 -> layer0_combine
	layer0_dispatch -> layer0_expert6
	layer0_expert6 -> layer0_combine
	layer0_dispatch -> layer0_expert7
	layer0_expert7 -> layer0_combine
	layer0_dispatch -> layer0_expert8
	layer0_expert8 -> layer0_combine
	layer0_dispatch -> layer0_expert9
	layer0_expert9 -> layer0_combine
	layer0_dispatch -> layer0_expert10
	layer0_expert10 -> layer0_combine
	layer0_dispatch -> layer0_expert11
	layer0_expert11 -> layer0_combine
	layer0_dispatch -> layer0_expert12
	layer0_expert12 -> layer0_combine
	layer0_dispatch -> layer0_expert13
	layer0_expert13 -> layer0_combine
	layer0_dispatch -> layer0_expert14
	layer0_expert14 -> layer0_combine
	layer0_dispatch -> layer0_expert15
	layer0_expert15 -> layer0_combine
	layer0_dispatch -> layer0_expert16
	layer0_expert16 -> layer0_combine
	layer0_dispatch -> layer0_expert17
	layer0_expert17 -> layer0_combine
	layer0_dispatch -> layer0_expert18
	layer0_expert18 -> layer0_combine
	layer0_dispatch -> layer0_expert19
	layer0_expert19 -> layer0_combine
	layer0_dispatch -> layer0_expert20
	layer0_expert20 -> layer0_combine
	layer0_dispatch -> layer0_expert21
	layer0_expert21 -> layer0_combine
	layer0_dispatch -> layer0_expert22
	layer0_expert22 -> layer0_combine
	layer0_dispatch -> layer0_expert23
	layer0_expert23 -> layer0_combine
	layer0_dispatch -> layer0_expert24
	layer0_expert24 -> layer0_combine
	layer0_dispatch -> layer0_expert25
	layer0_expert25 -> layer0_combine
	layer0_dispatch -> layer0_expert26
	layer0_expert26 -> layer0_combine
	layer0_dispatch -> layer0_expert27
	layer0_expert27 -> layer0_combine
	layer0_dispatch -> layer0_expert28
	layer0_expert28 -> layer0_combine
	layer0_dispatch -> layer0_expert29
	layer0_expert29 -> layer0_combine
	layer0_dispatch -> layer0_expert30
	layer0_expert30 -> layer0_combine
	layer0_dispatch -> layer0_expert31
	layer0_expert31 -> layer0_combine
	layer0_dispatch -> layer0_expert32
	layer0_expert32 -> layer0_combine
	layer0_dispatch -> layer0_expert33
	layer0_expert33 -> layer0_combine
	layer0_dispatch -> layer0_expert34
	layer0_expert34 -> layer0_combine
	layer0_dispatch -> layer0_expert35
	layer0_expert35 -> layer0_combine
	layer0_dispatch -> layer0_expert36
	layer0_expert36 -> layer0_combine
	layer0_dispatch -> layer0_expert37
	layer0_expert37 -> layer0_combine
	layer0_dispatch -> layer0_expert38
	layer0_expert38 -> layer0_combine
	layer0_dispatch -> layer0_expert39
	layer0_expert39 -> layer0_combine
	layer0_dispatch -> layer0_expert40
	layer0_expert40 -> layer0_combine
	layer0_dispatch -> layer0_expert41
	layer0_expert41 -> layer0_combine
	layer0_dispatch -> layer0_expert42
	layer0_expert42 -> layer0_combine
	layer0_dispatch -> layer0_expert43
	layer0_expert43 -> layer0_combine
	layer0_dispatch -> layer0_expert44
	layer0_expert44 -> layer0_combine
	layer0_dispatch -> layer0_expert45
	layer0_expert45 -> layer0_combine
	layer0_dispatch -> layer0_expert46
	layer0_expert46 -> layer0_combine
	layer0_dispatch -> layer0_expert47
	layer0_expert47 -> layer0_combine
	layer0_dispatch -> layer0_expert48
	layer0_expert48 -> layer0_combine
	layer0_dispatch -> layer0_expert49
	layer0_expert49 -> layer0_combine
	layer0_dispatch -> layer0_expert50
	layer0_expert50 -> layer0_combine
	layer0_dispatch -> layer0_expert51
	layer0_expert51 -> layer0_combine
	layer0_dispatch -> layer0_expert52
	layer0_expert52 -> layer0_combine
	layer0_dispatch -> layer0_expert53
	layer0_expert53 -> layer0_combine
	layer0_dispatch -> layer0_expert54
	layer0_expert54 -> layer0_combine
	layer0_dispatch -> layer0_expert55
	layer0_expert55 -> layer0_combine
	layer0_dispatch -> layer0_expert56
	layer0_expert56 -> layer0_combine
	layer0_dispatch -> layer0_expert57
	layer0_expert57 -> layer0_combine
	layer0_dispatch -> layer0_expert58
	layer0_expert58 -> layer0_combine
	layer0_dispatch -> layer0_expert59
	layer0_expert59 -> layer0_combine
	layer0_dispatch -> layer0_expert60
	layer0_expert60 -> layer0_combine
	layer0_dispatch -> layer0_expert61
	layer0_expert61 -> layer0_combine
	layer0_dispatch -> layer0_expert62
	layer0_expert62 -> layer0_combine
	layer0_dispatch -> layer0_expert63
	layer0_expert63 -> layer0_combine
	layer0_combine -> layer0_moe_out
	layer0_moe_out -> layer0_ar
	layer0_ar -> layer0_res2
	layer0_res2 -> layer1_ln1
	layer1_ln1 -> layer1_qkv
	layer1_qkv -> layer1_attn
	layer1_attn -> layer1_attn_out
	layer1_attn_out -> layer1_res1
	layer1_res1 -> layer1_ln2
	layer1_ln2 -> layer1_route
	layer1_route -> layer1_dispatch [style=dashed]
	layer1_dispatch -> layer1_expert0
	layer1_expert0 -> layer1_combine
	layer1_dispatch -> layer1_expert1
	layer1_expert1 -> layer1_combine
	layer1_dispatch -> layer1_expert2
	layer1_expert2 -> layer1_combine
	layer1_dispatch -> layer1_expert3
	layer1_expert3 -> layer1_combine
	layer1_dispatch -> layer1_expert4
	layer1_expert4 -> layer1_combine
	layer1_dispatch -> layer1_expert5
	layer1_expert5 -> layer1_combine
	layer1_dispatch -> layer1_expert6
	layer1_expert6 -> layer1_combine
	layer1_dispatch -> layer1_expert7
	layer1_expert7 -> layer1_combine
	layer1_dispatch -> layer1_expert8
	layer1_expert8 -> layer1_combine
	layer1_dispatch -> layer1_expert9
	layer1_expert9 -> layer1_combine
	layer1_dispatch -> layer1_expert10
	layer1_expert10 -> layer1_combine
	layer1_dispatch -> layer1_expert11
	layer1_expert11 -> layer1_combine
	layer1_dispatch -> layer1_expert12
	layer1_expert12 -> layer1_combine
	layer1_dispatch -> layer1_expert13
	layer1_expert13 -> layer1_combine
	layer1_dispatch -> layer1_expert14
	layer1_expert14 -> layer1_combine
	layer1_dispatch -> layer1_expert15
	layer1_expert15 -> layer1_combine
	layer1_dispatch -> layer1_expert16
	layer1_expert16 -> layer1_combine
	layer1_dispatch -> layer1_expert17
	layer1_expert17 -> layer1_combine
	layer1_dispatch -> layer1_expert18
	layer1_expert18 -> layer1_combine
	layer1_dispatch -> layer1_expert19
	layer1_expert19 -> layer1_combine
	layer1_dispatch -> layer1_expert20
	layer1_expert20 -> layer1_combine
	layer1_dispatch -> layer1_expert21
	layer1_expert21 -> layer1_combine
	layer1_dispatch -> layer1_expert22
	layer1_expert22 -> layer1_combine
	layer1_dispatch -> layer1_expert23
	layer1_expert23 -> layer1_combine
	layer1_dispatch -> layer1_expert24
	layer1_expert24 -> layer1_combine
	layer1_dispatch -> layer1_expert25
	layer1_expert25 -> layer1_combine
	layer1_dispatch -> layer1_expert26
	layer1_expert26 -> layer1_combine
	layer1_dispatch -> layer1_expert27
	layer1_expert27 -> layer1_combine
	layer1_dispatch -> layer1_expert28
	layer1_expert28 -> layer1_combine
	layer1_dispatch -> layer1_expert29
	layer1_expert29 -> layer1_combine
	layer1_dispatch -> layer1_expert30
	layer1_expert30 -> layer1_combine
	layer1_dispatch -> layer1_expert31
	layer1_expert31 -> layer1_combine
	layer1_dispatch -> layer1_expert32
	layer1_expert32 -> layer1_combine
	layer1_dispatch -> layer1_expert33
	layer1_expert33 -> layer1_combine
	layer1_dispatch -> layer1_expert34
	layer1_expert34 -> layer1_combine
	layer1_dispatch -> layer1_expert35
	layer1_expert35 -> layer1_combine
	layer1_dispatch -> layer1_expert36
	layer1_expert36 -> layer1_combine
	layer1_dispatch -> layer1_expert37
	layer1_expert37 -> layer1_combine
	layer1_dispatch -> layer1_expert38
	layer1_expert38 -> layer1_combine
	layer1_dispatch -> layer1_expert39
	layer1_expert39 -> layer1_combine
	layer1_dispatch -> layer1_expert40
	layer1_expert40 -> layer1_combine
	layer1_dispatch -> layer1_expert41
	layer1_expert41 -> layer1_combine
	layer1_dispatch -> layer1_expert42
	layer1_expert42 -> layer1_combine
	layer1_dispatch -> layer1_expert43
	layer1_expert43 -> layer1_combine
	layer1_dispatch -> layer1_expert44
	layer1_expert44 -> layer1_combine
	layer1_dispatch -> layer1_expert45
	layer1_expert45 -> layer1_combine
	layer1_dispatch -> layer1_expert46
	layer1_expert46 -> layer1_combine
	layer1_dispatch -> layer1_expert47
	layer1_expert47 -> layer1_combine
	layer1_dispatch -> layer1_expert48
	layer1_expert48 -> layer1_combine
	layer1_dispatch -> layer1_expert49
	layer1_expert49 -> layer1_combine
	layer1_dispatch -> layer1_expert50
	layer1_expert50 -> layer1_combine
	layer1_dispatch -> layer1_expert51
	layer1_expert51 -> layer1_combine
	layer1_dispatch -> layer1_expert52
	layer1_expert52 -> layer1_combine
	layer1_dispatch -> layer1_expert53
	layer1_expert53 -> layer1_combine
	layer1_dispatch -> layer1_expert54
	layer1_expert54 -> layer1_combine
	layer1_dispatch -> layer1_expert55
	layer1_expert55 -> layer1_combine
	layer1_dispatch -> layer1_expert56
	layer1_expert56 -> layer1_combine
	layer1_dispatch -> layer1_expert57
	layer1_expert57 -> layer1_combine
	layer1_dispatch -> layer1_expert58
	layer1_expert58 -> layer1_combine
	layer1_dispatch -> layer1_expert59
	layer1_expert59 -> layer1_combine
	layer1_dispatch -> layer1_expert60
	layer1_expert60 -> layer1_combine
	layer1_dispatch -> layer1_expert61
	layer1_expert61 -> layer1_combine
	layer1_dispatch -> layer1_expert62
	layer1_expert62 -> layer1_combine
	layer1_dispatch -> layer1_expert63
	layer1_expert63 -> layer1_combine
	layer1_combine -> layer1_moe_out
	layer1_moe_out -> layer1_ar
	layer1_ar -> layer1_res2
	layer1_res2 -> layer2_ln1
	layer2_ln1 -> layer2_qkv
	layer2_qkv -> layer2_attn
	layer2_attn -> layer2_attn_out
	layer2_attn_out -> layer2_res1
	layer2_res1 -> layer2_ln2
	layer2_ln2 -> layer2_route
	layer2_route -> layer2_dispatch [style=dashed]
	layer2_dispatch -> layer2_expert0
	layer2_expert0 -> layer2_combine
	layer2_dispatch -> layer2_expert1
	layer2_expert1 -> layer2_combine
	layer2_dispatch -> layer2_expert2
	layer2_expert2 -> layer2_combine
	layer2_dispatch -> layer2_expert3
	layer2_expert3 -> layer2_combine
	layer2_dispatch -> layer2_expert4
	layer2_expert4 -> layer2_combine
	layer2_dispatch -> layer2_expert5
	layer2_expert5 -> layer2_combine
	layer2_dispatch -> layer2_expert6
	layer2_expert6 -> layer2_combine
	layer2_dispatch -> layer2_expert7
	layer2_expert7 -> layer2_combine
	layer2_dispatch -> layer2_expert8
	layer2_expert8 -> layer2_combine
	layer2_dispatch -> layer2_expert9
	layer2_expert9 -> layer2_combine
	layer2_dispatch -> layer2_expert10
	layer2_expert10 -> layer2_combine
	layer2_dispatch -> layer2_expert11
	layer2_expert11 -> layer2_combine
	layer2_dispatch -> layer2_expert12
	layer2_expert12 -> layer2_combine
	layer2_dispatch -> layer2_expert13
	layer2_expert13 -> layer2_combine
	layer2_dispatch -> layer2_expert14
	layer2_expert14 -> layer2_combine
	layer2_dispatch -> layer2_expert15
	layer2_expert15 -> layer2_combine
	layer2_dispatch -> layer2_expert16
	layer2_expert16 -> layer2_combine
	layer2_dispatch -> layer2_expert17
	layer2_expert17 -> layer2_combine
	layer2_dispatch -> layer2_expert18
	layer2_expert18 -> layer2_combine
	layer2_dispatch -> layer2_expert19
	layer2_expert19 -> layer2_combine
	layer2_dispatch -> layer2_expert20
	layer2_expert20 -> layer2_combine
	layer2_dispatch -> layer2_expert21
	layer2_expert21 -> layer2_combine
	layer2_dispatch -> layer2_expert22
	layer2_expert22 -> layer2_combine
	layer2_dispatch -> layer2_expert23
	layer2_expert23 -> layer2_combine
	layer2_dispatch -> layer2_expert24
	layer2_expert24 -> layer2_combine
	layer2_dispatch -> layer2_expert25
	layer2_expert25 -> layer2_combine
	layer2_dispatch -> layer2_expert26
	layer2_expert26 -> layer2_combine
	layer2_dispatch -> layer2_expert27
	layer2_expert27 -> layer2_combine
	layer2_dispatch -> layer2_expert28
	layer2_expert28 -> layer2_combine
	layer2_dispatch -> layer2_expert29
	layer2_expert29 -> layer2_combine
	layer2_dispatch -> layer2_expert30
	layer2_expert30 -> layer2_combine
	layer2_dispatch -> layer2_expert31
	layer2_expert31 -> layer2_combine
	layer2_dispatch -> layer2_expert32
	layer2_expert32 -> layer2_combine
	layer2_dispatch -> layer2_expert33
	layer2_expert33 -> layer2_combine
	layer2_dispatch -> layer2_expert34
	layer2_expert34 -> layer2_combine
	layer2_dispatch -> layer2_expert35
	layer2_expert35 -> layer2_combine
	layer2_dispatch -> layer2_expert36
	layer2_expert36 -> layer2_combine
	layer2_dispatch -> layer2_expert37
	layer2_expert37 -> layer2_combine
	layer2_dispatch -> layer2_expert38
	layer2_expert38 -> layer2_combine
	layer2_dispatch -> layer2_expert39
	layer2_expert39 -> layer2_combine
	layer2_dispatch -> layer2_expert40
	layer2_expert40 -> layer2_combine
	layer2_dispatch -> layer2_expert41
	layer2_expert41 -> layer2_combine
	layer2_dispatch -> layer2_expert42
	layer2_expert42 -> layer2_combine
	layer2_dispatch -> layer2_expert43
	layer2_expert43 -> layer2_combine
	layer2_dispatch -> layer2_expert44
	layer2_expert44 -> layer2_combine
	layer2_dispatch -> layer2_expert45
	layer2_expert45 -> layer2_combine
	layer2_dispatch -> layer2_expert46
	layer2_expert46 -> layer2_combine
	layer2_dispatch -> layer2_expert47
	layer2_expert47 -> layer2_combine
	layer2_dispatch -> layer2_expert48
	layer2_expert48 -> layer2_combine
	layer2_dispatch -> layer2_expert49
	layer2_expert49 -> layer2_combine
	layer2_dispatch -> layer2_expert50
	layer2_expert50 -> layer2_combine
	layer2_dispatch -> layer2_expert51
	layer2_expert51 -> layer2_combine
	layer2_dispatch -> layer2_expert52
	layer2_expert52 -> layer2_combine
	layer2_dispatch -> layer2_expert53
	layer2_expert53 -> layer2_combine
	layer2_dispatch -> layer2_expert54
	layer2_expert54 -> layer2_combine
	layer2_dispatch -> layer2_expert55
	layer2_expert55 -> layer2_combine
	layer2_dispatch -> layer2_expert56
	layer2_expert56 -> layer2_combine
	layer2_dispatch -> layer2_expert57
	layer2_expert57 -> layer2_combine
	layer2_dispatch -> layer2_expert58
	layer2_expert58 -> layer2_combine
	layer2_dispatch -> layer2_expert59
	layer2_expert59 -> layer2_combine
	layer2_dispatch -> layer2_expert60
	layer2_expert60 -> layer2_combine
	layer2_dispatch -> layer2_expert61
	layer2_expert61 -> layer2_combine
	layer2_dispatch -> layer2_expert62
	layer2_expert62 -> layer2_combine
	layer2_dispatch -> layer2_expert63
	layer2_expert63 -> layer2_combine
	layer2_combine -> layer2_moe_out
	layer2_moe_out -> layer2_ar
	layer2_ar -> layer2_res2
	layer2_res2 -> layer3_ln1
	layer3_ln1 -> layer3_qkv
	layer3_qkv -> layer3_attn
	layer3_attn -> layer3_attn_out
	layer3_attn_out -> layer3_res1
	layer3_res1 -> layer3_ln2
	layer3_ln2 -> layer3_route
	layer3_route -> layer3_dispatch [style=dashed]
	layer3_dispatch -> layer3_expert0
	layer3_expert0 -> layer3_combine
	layer3_dispatch -> layer3_expert1
	layer3_expert1 -> layer3_combine
	layer3_dispatch -> layer3_expert2
	layer3_expert2 -> layer3_combine
	layer3_dispatch -> layer3_expert3
	layer3_expert3 -> layer3_combine
	layer3_dispatch -> layer3_expert4
	layer3_expert4 -> layer3_combine
	layer3_dispatch -> layer3_expert5
	layer3_expert5 -> layer3_combine
	layer3_dispatch -> layer3_expert6
	layer3_expert6 -> layer3_combine
	layer3_dispatch -> layer3_expert7
	layer3_expert7 -> layer3_combine
	layer3_dispatch -> layer3_expert8
	layer3_expert8 -> layer3_combine
	layer3_dispatch -> layer3_expert9
	layer3_expert9 -> layer3_combine
	layer3_dispatch -> layer3_expert10
	layer3_expert10 -> layer3_combine
	layer3_dispatch -> layer3_expert11
	layer3_expert11 -> layer3_combine
	layer3_dispatch -> layer3_expert12
	layer3_expert12 -> layer3_combine
	layer3_dispatch -> layer3_expert13
	layer3_expert13 -> layer3_combine
	layer3_dispatch -> layer3_expert14
	layer3_expert14 -> layer3_combine
	layer3_dispatch -> layer3_expert15
	layer3_expert15 -> layer3_combine
	layer3_dispatch -> layer3_expert16
	layer3_expert16 -> layer3_combine
	layer3_dispatch -> layer3_expert17
	layer3_expert17 -> layer3_combine
	layer3_dispatch -> layer3_expert18
	layer3_expert18 -> layer3_combine
	layer3_dispatch -> layer3_expert19
	layer3_expert19 -> layer3_combine
	layer3_dispatch -> layer3_expert20
	layer3_expert20 -> layer3_combine
	layer3_dispatch -> layer3_expert21
	layer3_expert21 -> layer3_combine
	layer3_dispatch -> layer3_expert22
	layer3_expert22 -> layer3_combine
	layer3_dispatch -> layer3_expert23
	layer3_expert23 -> layer3_combine
	layer3_dispatch -> layer3_expert24
	layer3_expert24 -> layer3_combine
	layer3_dispatch -> layer3_expert25
	layer3_expert25 -> layer3_combine
	layer3_dispatch -> layer3_expert26
	layer3_expert26 -> layer3_combine
	layer3_dispatch -> layer3_expert27
	layer3_expert27 -> layer3_combine
	layer3_dispatch -> layer3_expert28
	layer3_expert28 -> layer3_combine
	layer3_dispatch -> layer3_expert29
	layer3_expert29 -> layer3_combine
	layer3_dispatch -> layer3_expert30
	layer3_expert30 -> layer3_combine
	layer3_dispatch -> layer3_expert31
	layer3_expert31 -> layer3_combine
	layer3_dispatch -> layer3_expert32
	layer3_expert32 -> layer3_combine
	layer3_dispatch -> layer3_expert33
	layer3_expert33 -> layer3_combine
	layer3_dispatch -> layer3_expert34
	layer3_expert34 -> layer3_combine
	layer3_dispatch -> layer3_expert35
	layer3_expert35 -> layer3_combine
	layer3_dispatch -> layer3_expert36
	layer3_expert36 -> layer3_combine
	layer3_dispatch -> layer3_expert37
	layer3_expert37 -> layer3_combine
	layer3_dispatch -> layer3_expert38
	layer3_expert38 -> layer3_combine
	layer3_dispatch -> layer3_expert39
	layer3_expert39 -> layer3_combine
	layer3_dispatch -> layer3_expert40
	layer3_expert40 -> layer3_combine
	layer3_dispatch -> layer3_expert41
	layer3_expert41 -> layer3_combine
	layer3_dispatch -> layer3_expert42
	layer3_expert42 -> layer3_combine
	layer3_dispatch -> layer3_expert43
	layer3_expert43 -> layer3_combine
	layer3_dispatch -> layer3_expert44
	layer3_expert44 -> layer3_combine
	layer3_dispatch -> layer3_expert45
	layer3_expert45 -> layer3_combine
	layer3_dispatch -> layer3_expert46
	layer3_expert46 -> layer3_combine
	layer3_dispatch -> layer3_expert47
	layer3_expert47 -> layer3_combine
	layer3_dispatch -> layer3_expert48
	layer3_expert48 -> layer3_combine
	layer3_dispatch -> layer3_expert49
	layer3_expert49 -> layer3_combine
	layer3_dispatch -> layer3_expert50
	layer3_expert50 -> layer3_combine
	layer3_dispatch -> layer3_expert51
	layer3_expert51 -> layer3_combine
	layer3_dispatch -> layer3_expert52
	layer3_expert52 -> layer3_combine
	layer3_dispatch -> layer3_expert53
	layer3_expert53 -> layer3_combine
	layer3_dispatch -> layer3_expert54
	layer3_expert54 -> layer3_combine
	layer3_dispatch -> layer3_expert55
	layer3_expert55 -> layer3_combine
	layer3_dispatch -> layer3_expert56
	layer3_expert56 -> layer3_combine
	layer3_dispatch -> layer3_expert57
	layer3_expert57 -> layer3_combine
	layer3_dispatch -> layer3_expert58
	layer3_expert58 -> layer3_combine
	layer3_dispatch -> layer3_expert59
	layer3_expert59 -> layer3_combine
	layer3_dispatch -> layer3_expert60
	layer3_expert60 -> layer3_combine
	layer3_dispatch -> layer3_expert61
	layer3_expert61 -> layer3_combine
	layer3_dispatch -> layer3_expert62
	layer3_expert62 -> layer3_combine
	layer3_dispatch -> layer3_expert63
	layer3_expert63 -> layer3_combine
	layer3_combine -> layer3_moe_out
	layer3_moe_out -> layer3_ar
	layer3_ar -> layer3_res2
	layer3_res2 -> layer4_ln1
	layer4_ln1 -> layer4_qkv
	layer4_qkv -> layer4_attn
	layer4_attn -> layer4_attn_out
	layer4_attn_out -> layer4_res1
	layer4_res1 -> layer4_ln2
	layer4_ln2 -> layer4_route
	layer4_route -> layer4_dispatch [style=dashed]
	layer4_dispatch -> layer4_expert0
	layer4_expert0 -> layer4_combine
	layer4_dispatch -> layer4_expert1
	layer4_expert1 -> layer4_combine
	layer4_dispatch -> layer4_expert2
	layer4_expert2 -> layer4_combine
	layer4_dispatch -> layer4_expert3
	layer4_expert3 -> layer4_combine
	layer4_dispatch -> layer4_expert4
	layer4_expert4 -> layer4_combine
	layer4_dispatch -> layer4_expert5
	layer4_expert5 -> layer4_combine
	layer4_dispatch -> layer4_expert6
	layer4_expert6 -> layer4_combine
	layer4_dispatch -> layer4_expert7
	layer4_expert7 -> layer4_combine
	layer4_dispatch -> layer4_expert8
	layer4_expert8 -> layer4_combine
	layer4_dispatch -> layer4_expert9
	layer4_expert9 -> layer4_combine
	layer4_dispatch -> layer4_expert10
	layer4_expert10 -> layer4_combine
	layer4_dispatch -> layer4_expert11
	layer4_expert11 -> layer4_combine
	layer4_dispatch -> layer4_expert12
	layer4_expert12 -> layer4_combine
	layer4_dispatch -> layer4_expert13
	layer4_expert13 -> layer4_combine
	layer4_dispatch -> layer4_expert14
	layer4_expert14 -> layer4_combine
	layer4_dispatch -> layer4_expert15
	layer4_expert15 -> layer4_combine
	layer4_dispatch -> layer4_expert16
	layer4_expert16 -> layer4_combine
	layer4_dispatch -> layer4_expert17
	layer4_expert17 -> layer4_combine
	layer4_dispatch -> layer4_expert18
	layer4_expert18 -> layer4_combine
	layer4_dispatch -> layer4_expert19
	layer4_expert19 -> layer4_combine
	layer4_dispatch -> layer4_expert20
	layer4_expert20 -> layer4_combine
	layer4_dispatch -> layer4_expert21
	layer4_expert21 -> layer4_combine
	layer4_dispatch -> layer4_expert22
	layer4_expert22 -> layer4_combine
	layer4_dispatch -> layer4_expert23
	layer4_expert23 -> layer4_combine
	layer4_dispatch -> layer4_expert24
	layer4_expert24 -> layer4_combine
	layer4_dispatch -> layer4_expert25
	layer4_expert25 -> layer4_combine
	layer4_dispatch -> layer4_expert26
	layer4_expert26 -> layer4_combine
	layer4_dispatch -> layer4_expert27
	layer4_expert27 -> layer4_combine
	layer4_dispatch -> layer4_expert28
	layer4_expert28 -> layer4_combine
	layer4_dispatch -> layer4_expert29
	layer4_expert29 -> layer4_combine
	layer4_dispatch -> layer4_expert30
	layer4_expert30 -> layer4_combine
	layer4_dispatch -> layer4_expert31
	layer4_expert31 -> layer4_combine
	layer4_dispatch -> layer4_expert32
	layer4_expert32 -> layer4_combine
	layer4_dispatch -> layer4_expert33
	layer4_expert33 -> layer4_combine
	layer4_dispatch -> layer4_expert34
	layer4_expert34 -> layer4_combine
	layer4_dispatch -> layer4_expert35
	layer4_expert35 -> layer4_combine
	layer4_dispatch -> layer4_expert36
	layer4_expert36 -> layer4_combine
	layer4_dispatch -> layer4_expert37
	layer4_expert37 -> layer4_combine
	layer4_dispatch -> layer4_expert38
	layer4_expert38 -> layer4_combine
	layer4_dispatch -> layer4_expert39
	layer4_expert39 -> layer4_combine
	layer4_dispatch -> layer4_expert40
	layer4_expert40 -> layer4_combine
	layer4_dispatch -> layer4_expert41
	layer4_expert41 -> layer4_combine
	layer4_dispatch -> layer4_expert42
	layer4_expert42 -> layer4_combine
	layer4_dispatch -> layer4_expert43
	layer4_expert43 -> layer4_combine
	layer4_dispatch -> layer4_expert44
	layer4_expert44 -> layer4_combine
	layer4_dispatch -> layer4_expert45
	layer4_expert45 -> layer4_combine
	layer4_dispatch -> layer4_expert46
	layer4_expert46 -> layer4_combine
	layer4_dispatch -> layer4_expert47
	layer4_expert47 -> layer4_combine
	layer4_dispatch -> layer4_expert48
	layer4_expert48 -> layer4_combine
	layer4_dispatch -> layer4_expert49
	layer4_expert49 -> layer4_combine
	layer4_dispatch -> layer4_expert50
	layer4_expert50 -> layer4_combine
	layer4_dispatch -> layer4_expert51
	layer4_expert51 -> layer4_combine
	layer4_dispatch -> layer4_expert52
	layer4_expert52 -> layer4_combine
	layer4_dispatch -> layer4_expert53
	layer4_expert53 -> layer4_combine
	layer4_dispatch -> layer4_expert54
	layer4_expert54 -> layer4_combine
	layer4_dispatch -> layer4_expert55
	layer4_expert55 -> layer4_combine
	layer4_dispatch -> layer4_expert56
	layer4_expert56 -> layer4_combine
	layer4_dispatch -> layer4_expert57
	layer4_expert57 -> layer4_combine
	layer4_dispatch -> layer4_expert58
	layer4_expert58 -> layer4_combine
	layer4_dispatch -> layer4_expert59
	layer4_expert59 -> layer4_combine
	layer4_dispatch -> layer4_expert60
	layer4_expert60 -> layer4_combine
	layer4_dispatch -> layer4_expert61
	layer4_expert61 -> layer4_combine
	layer4_dispatch -> layer4_expert62
	layer4_expert62 -> layer4_combine
	layer4_dispatch -> layer4_expert63
	layer4_expert63 -> layer4_combine
	layer4_combine -> layer4_moe_out
	layer4_moe_out -> layer4_ar
	layer4_ar -> layer4_res2
	layer4_res2 -> layer5_ln1
	layer5_ln1 -> layer5_qkv
	layer5_qkv -> layer5_attn
	layer5_attn -> layer5_attn_out
	layer5_attn_out -> layer5_res1
	layer5_res1 -> layer5_ln2
	layer5_ln2 -> layer5_route
	layer5_route -> layer5_dispatch [style=dashed]
	layer5_dispatch -> layer5_expert0
	layer5_expert0 -> layer5_combine
	layer5_dispatch -> layer5_expert1
	layer5_expert1 -> layer5_combine
	layer5_dispatch -> layer5_expert2
	layer5_expert2 -> layer5_combine
	layer5_dispatch -> layer5_expert3
	layer5_expert3 -> layer5_combine
	layer5_dispatch -> layer5_expert4
	layer5_expert4 -> layer5_combine
	layer5_dispatch -> layer5_expert5
	layer5_expert5 -> layer5_combine
	layer5_dispatch -> layer5_expert6
	layer5_expert6 -> layer5_combine
	layer5_dispatch -> layer5_expert7
	layer5_expert7 -> layer5_combine
	layer5_dispatch -> layer5_expert8
	layer5_expert8 -> layer5_combine
	layer5_dispatch -> layer5_expert9
	layer5_expert9 -> layer5_combine
	layer5_dispatch -> layer5_expert10
	layer5_expert10 -> layer5_combine
	layer5_dispatch -> layer5_expert11
	layer5_expert11 -> layer5_combine
	layer5_dispatch -> layer5_expert12
	layer5_expert12 -> layer5_combine
	layer5_dispatch -> layer5_expert13
	layer5_expert13 -> layer5_combine
	layer5_dispatch -> layer5_expert14
	layer5_expert14 -> layer5_combine
	layer5_dispatch -> layer5_expert15
	layer5_expert15 -> layer5_combine
	layer5_dispatch -> layer5_expert16
	layer5_expert16 -> layer5_combine
	layer5_dispatch -> layer5_expert17
	layer5_expert17 -> layer5_combine
	layer5_dispatch -> layer5_expert18
	layer5_expert18 -> layer5_combine
	layer5_dispatch -> layer5_expert19
	layer5_expert19 -> layer5_combine
	layer5_dispatch -> layer5_expert20
	layer5_expert20 -> layer5_combine
	layer5_dispatch -> layer5_expert21
	layer5_expert21 -> layer5_combine
	layer5_dispatch -> layer5_expert22
	layer5_expert22 -> layer5_combine
	layer5_dispatch -> layer5_expert23
	layer5_expert23 -> layer5_combine
	layer5_dispatch -> layer5_expert24
	layer5_expert24 -> layer5_combine
	layer5_dispatch -> layer5_expert25
	layer5_expert25 -> layer5_combine
	layer5_dispatch -> layer5_expert26
	layer5_expert26 -> layer5_combine
	layer5_dispatch -> layer5_expert27
	layer5_expert27 -> layer5_combine
	layer5_dispatch -> layer5_expert28
	layer5_expert28 -> layer5_combine
	layer5_dispatch -> layer5_expert29
	layer5_expert29 -> layer5_combine
	layer5_dispatch -> layer5_expert30
	layer5_expert30 -> layer5_combine
	layer5_dispatch -> layer5_expert31
	layer5_expert31 -> layer5_combine
	layer5_dispatch -> layer5_expert32
	layer5_expert32 -> layer5_combine
	layer5_dispatch -> layer5_expert33
	layer5_expert33 -> layer5_combine
	layer5_dispatch -> layer5_expert34
	layer5_expert34 -> layer5_combine
	layer5_dispatch -> layer5_expert35
	layer5_expert35 -> layer5_combine
	layer5_dispatch -> layer5_expert36
	layer5_expert36 -> layer5_combine
	layer5_dispatch -> layer5_expert37
	layer5_expert37 -> layer5_combine
	layer5_dispatch -> layer5_expert38
	layer5_expert38 -> layer5_combine
	layer5_dispatch -> layer5_expert39
	layer5_expert39 -> layer5_combine
	layer5_dispatch -> layer5_expert40
	layer5_expert40 -> layer5_combine
	layer5_dispatch -> layer5_expert41
	layer5_expert41 -> layer5_combine
	layer5_dispatch -> layer5_expert42
	layer5_expert42 -> layer5_combine
	layer5_dispatch -> layer5_expert43
	layer5_expert43 -> layer5_combine
	layer5_dispatch -> layer5_expert44
	layer5_expert44 -> layer5_combine
	layer5_dispatch -> layer5_expert45
	layer5_expert45 -> layer5_combine
	layer5_dispatch -> layer5_expert46
	layer5_expert46 -> layer5_combine
	layer5_dispatch -> layer5_expert47
	layer5_expert47 -> layer5_combine
	layer5_dispatch -> layer5_expert48
	layer5_expert48 -> layer5_combine
	layer5_dispatch -> layer5_expert49
	layer5_expert49 -> layer5_combine
	layer5_dispatch -> layer5_expert50
	layer5_expert50 -> layer5_combine
	layer5_dispatch -> layer5_expert51
	layer5_expert51 -> layer5_combine
	layer5_dispatch -> layer5_expert52
	layer5_expert52 -> layer5_combine
	layer5_dispatch -> layer5_expert53
	layer5_expert53 -> layer5_combine
	layer5_dispatch -> layer5_expert54
	layer5_expert54 -> layer5_combine
	layer5_dispatch -> layer5_expert55
	layer5_expert55 -> layer5_combine
	layer5_dispatch -> layer5_expert56
	layer5_expert56 -> layer5_combine
	layer5_dispatch -> layer5_expert57
	layer5_expert57 -> layer5_combine
	layer5_dispatch -> layer5_expert58
	layer5_expert58 -> layer5_combine
	layer5_dispatch -> layer5_expert59
	layer5_expert59 -> layer5_combine
	layer5_dispatch -> layer5_expert60
	layer5_expert60 -> layer5_combine
	layer5_dispatch -> layer5_expert61
	layer5_expert61 -> layer5_combine
	layer5_dispatch -> layer5_expert62
	layer5_expert62 -> layer5_combine
	layer5_dispatch -> layer5_expert63
	layer5_expert63 -> layer5_combine
	layer5_combine -> layer5_moe_out
	layer5_moe_out -> layer5_ar
	layer5_ar -> layer5_res2
	layer5_res2 -> layer6_ln1
	layer6_ln1 -> layer6_qkv
	layer6_qkv -> layer6_attn
	layer6_attn -> layer6_attn_out
	layer6_attn_out -> layer6_res1
	layer6_res1 -> layer6_ln2
	layer6_ln2 -> layer6_route
	layer6_route -> layer6_dispatch [style=dashed]
	layer6_dispatch -> layer6_expert0
	layer6_expert0 -> layer6_combine
	layer6_dispatch -> layer6_expert1
	layer6_expert1 -> layer6_combine
	layer6_dispatch -> layer6_expert2
	layer6_expert2 -> layer6_combine
	layer6_dispatch -> layer6_expert3
	layer6_expert3 -> layer6_combine
	layer6_dispatch -> layer6_expert4
	layer6_expert4 -> layer6_combine
	layer6_dispatch -> layer6_expert5
	layer6_expert5 -> layer6_combine
	layer6_dispatch -> layer6_expert6
	layer6_expert6 -> layer6_combine
	layer6_dispatch -> layer6_expert7
	layer6_expert7 -> layer6_combine
	layer6_dispatch -> layer6_expert8
	layer6_expert8 -> layer6_combine
	layer6_dispatch -> layer6_expert9
	layer6_expert9 -> layer6_combine
	layer6_dispatch -> layer6_expert10
	layer6_expert10 -> layer6_combine
	layer6_dispatch -> layer6_expert11
	layer6_expert11 -> layer6_combine
	layer6_dispatch -> layer6_expert12
	layer6_expert12 -> layer6_combine
	layer6_dispatch -> layer6_expert13
	layer6_expert13 -> layer6_combine
	layer6_dispatch -> layer6_expert14
	layer6_expert14 -> layer6_combine
	layer6_dispatch -> layer6_expert15
	layer6_expert15 -> layer6_combine
	layer6_dispatch -> layer6_expert16
	layer6_expert16 -> layer6_combine
	layer6_dispatch -> layer6_expert17
	layer6_expert17 -> layer6_combine
	layer6_dispatch -> layer6_expert18
	layer6_expert18 -> layer6_combine
	layer6_dispatch -> layer6_expert19
	layer6_expert19 -> layer6_combine
	layer6_dispatch -> layer6_expert20
	layer6_expert20 -> layer6_combine
	layer6_dispatch -> layer6_expert21
	layer6_expert21 -> layer6_combine
	layer6_dispatch -> layer6_expert22
	layer6_expert22 -> layer6_combine
	layer6_dispatch -> layer6_expert23
	layer6_expert23 -> layer6_combine
	layer6_dispatch -> layer6_expert24
	layer6_expert24 -> layer6_combine
	layer6_dispatch -> layer6_expert25
	layer6_expert25 -> layer6_combine
	layer6_dispatch -> layer6_expert26
	layer6_expert26 -> layer6_combine
	layer6_dispatch -> layer6_expert27
	layer6_expert27 -> layer6_combine
	layer6_dispatch -> layer6_expert28
	layer6_expert28 -> layer6_combine
	layer6_dispatch -> layer6_expert29
	layer6_expert29 -> layer6_combine
	layer6_dispatch -> layer6_expert30
	layer6_expert30 -> layer6_combine
	layer6_dispatch -> layer6_expert31
	layer6_expert31 -> layer6_combine
	layer6_dispatch -> layer6_expert32
	layer6_expert32 -> layer6_combine
	layer6_dispatch -> layer6_expert33
	layer6_expert33 -> layer6_combine
	layer6_dispatch -> layer6_expert34
	layer6_expert34 -> layer6_combine
	layer6_dispatch -> layer6_expert35
	layer6_expert35 -> layer6_combine
	layer6_dispatch -> layer6_expert36
	layer6_expert36 -> layer6_combine
	layer6_dispatch -> layer6_expert37
	layer6_expert37 -> layer6_combine
	layer6_dispatch -> layer6_expert38
	layer6_expert38 -> layer6_combine
	layer6_dispatch -> layer6_expert39
	layer6_expert39 -> layer6_combine
	layer6_dispatch -> layer6_expert40
	layer6_expert40 -> layer6_combine
	layer6_dispatch -> layer6_expert41
	layer6_expert41 -> layer6_combine
	layer6_dispatch -> layer6_expert42
	layer6_expert42 -> layer6_combine
	layer6_dispatch -> layer6_expert43
	layer6_expert43 -> layer6_combine
	layer6_dispatch -> layer6_expert44
	layer6_expert44 -> layer6_combine
	layer6_dispatch -> layer6_expert45
	layer6_expert45 -> layer6_combine
	layer6_dispatch -> layer6_expert46
	layer6_expert46 -> layer6_combine
	layer6_dispatch -> layer6_expert47
	layer6_expert47 -> layer6_combine
	layer6_dispatch -> layer6_expert48
	layer6_expert48 -> layer6_combine
	layer6_dispatch -> layer6_expert49
	layer6_expert49 -> layer6_combine
	layer6_dispatch -> layer6_expert50
	layer6_expert50 -> layer6_combine
	layer6_dispatch -> layer6_expert51
	layer6_expert51 -> layer6_combine
	layer6_dispatch -> layer6_expert52
	layer6_expert52 -> layer6_combine
	layer6_dispatch -> layer6_expert53
	layer6_expert53 -> layer6_combine
	layer6_dispatch -> layer6_expert54
	layer6_expert54 -> layer6_combine
	layer6_dispatch -> layer6_expert55
	layer6_expert55 -> layer6_combine
	layer6_dispatch -> layer6_expert56
	layer6_expert56 -> layer6_combine
	layer6_dispatch -> layer6_expert57
	layer6_expert57 -> layer6_combine
	layer6_dispatch -> layer6_expert58
	layer6_expert58 -> layer6_combine
	layer6_dispatch -> layer6_expert59
	layer6_expert59 -> layer6_combine
	layer6_dispatch -> layer6_expert60
	layer6_expert60 -> layer6_combine
	layer6_dispatch -> layer6_expert61
	layer6_expert61 -> layer6_combine
	layer6_dispatch -> layer6_expert62
	layer6_expert62 -> layer6_combine
	layer6_dispatch -> layer6_expert63
	layer6_expert63 -> layer6_combine
	layer6_combine -> layer6_moe_out
	layer6_moe_out -> layer6_ar
	layer6_ar -> layer6_res2
	layer6_res2 -> layer7_ln1
	layer7_ln1 -> layer7_qkv
	layer7_qkv -> layer7_attn
	layer7_attn -> layer7_attn_out
	layer7_attn_out -> layer7_res1
	layer7_res1 -> layer7_ln2
	layer7_ln2 -> layer7_route
	layer7_route -> layer7_dispatch [style=dashed]
	layer7_dispatch -> layer7_expert0
	layer7_expert0 -> layer7_combine
	layer7_dispatch -> layer7_expert1
	layer7_expert1 -> layer7_combine
	layer7_dispatch -> layer7_expert2
	layer7_expert2 -> layer7_combine
	layer7_dispatch -> layer7_expert3
	layer7_expert3 -> layer7_combine
	layer7_dispatch -> layer7_expert4
	layer7_expert4 -> layer7_combine
	layer7_dispatch -> layer7_expert5
	layer7_expert5 -> layer7_combine
	layer7_dispatch -> layer7_expert6
	layer7_expert6 -> layer7_combine
	layer7_dispatch -> layer7_expert7
	layer7_expert7 -> layer7_combine
	layer7_dispatch -> layer7_expert8
	layer7_expert8 -> layer7_combine
	layer7_dispatch -> layer7_expert9
	layer7_expert9 -> layer7_combine
	layer7_dispatch -> layer7_expert10
	layer7_expert10 -> layer7_combine
	layer7_dispatch -> layer7_expert11
	layer7_expert11 -> layer7_combine
	layer7_dispatch -> layer7_expert12
	layer7_expert12 -> layer7_combine
	layer7_dispatch -> layer7_expert13
	layer7_expert13 -> layer7_combine
	layer7_dispatch -> layer7_expert14
	layer7_expert14 -> layer7_combine
	layer7_dispatch -> layer7_expert15
	layer7_expert15 -> layer7_combine
	layer7_dispatch -> layer7_expert16
	layer7_expert16 -> layer7_combine
	layer7_dispatch -> layer7_expert17
	layer7_expert17 -> layer7_combine
	layer7_dispatch -> layer7_expert18
	layer7_expert18 -> layer7_combine
	layer7_dispatch -> layer7_expert19
	layer7_expert19 -> layer7_combine
	layer7_dispatch -> layer7_expert20
	layer7_expert20 -> layer7_combine
	layer7_dispatch -> layer7_expert21
	layer7_expert21 -> layer7_combine
	layer7_dispatch -> layer7_expert22
	layer7_expert22 -> layer7_combine
	layer7_dispatch -> layer7_expert23
	layer7_expert23 -> layer7_combine
	layer7_dispatch -> layer7_expert24
	layer7_expert24 -> layer7_combine
	layer7_dispatch -> layer7_expert25
	layer7_expert25 -> layer7_combine
	layer7_dispatch -> layer7_expert26
	layer7_expert26 -> layer7_combine
	layer7_dispatch -> layer7_expert27
	layer7_expert27 -> layer7_combine
	layer7_dispatch -> layer7_expert28
	layer7_expert28 -> layer7_combine
	layer7_dispatch -> layer7_expert29
	layer7_expert29 -> layer7_combine
	layer7_dispatch -> layer7_expert30
	layer7_expert30 -> layer7_combine
	layer7_dispatch -> layer7_expert31
	layer7_expert31 -> layer7_combine
	layer7_dispatch -> layer7_expert32
	layer7_expert32 -> layer7_combine
	layer7_dispatch -> layer7_expert33
	layer7_expert33 -> layer7_combine
	layer7_dispatch -> layer7_expert34
	layer7_expert34 -> layer7_combine
	layer7_dispatch -> layer7_expert35
	layer7_expert35 -> layer7_combine
	layer7_dispatch -> layer7_expert36
	layer7_expert36 -> layer7_combine
	layer7_dispatch -> layer7_expert37
	layer7_expert37 -> layer7_combine
	layer7_dispatch -> layer7_expert38
	layer7_expert38 -> layer7_combine
	layer7_dispatch -> layer7_expert39
	layer7_expert39 -> layer7_combine
	layer7_dispatch -> layer7_expert40
	layer7_expert40 -> layer7_combine
	layer7_dispatch -> layer7_expert41
	layer7_expert41 -> layer7_combine
	layer7_dispatch -> layer7_expert42
	layer7_expert42 -> layer7_combine
	layer7_dispatch -> layer7_expert43
	layer7_expert43 -> layer7_combine
	layer7_dispatch -> layer7_expert44
	layer7_expert44 -> layer7_combine
	layer7_dispatch -> layer7_expert45
	layer7_expert45 -> layer7_combine
	layer7_dispatch -> layer7_expert46
	layer7_expert46 -> layer7_combine
	layer7_dispatch -> layer7_expert47
	layer7_expert47 -> layer7_combine
	layer7_dispatch -> layer7_expert48
	layer7_expert48 -> layer7_combine
	layer7_dispatch -> layer7_expert49
	layer7_expert49 -> layer7_combine
	layer7_dispatch -> layer7_expert50
	layer7_expert50 -> layer7_combine
	layer7_dispatch -> layer7_expert51
	layer7_expert51 -> layer7_combine
	layer7_dispatch -> layer7_expert52
	layer7_expert52 -> layer7_combine
	layer7_dispatch -> layer7_expert53
	layer7_expert53 -> layer7_combine
	layer7_dispatch -> layer7_expert54
	layer7_expert54 -> layer7_combine
	layer7_dispatch -> layer7_expert55
	layer7_expert55 -> layer7_combine
	layer7_dispatch -> layer7_expert56
	layer7_expert56 -> layer7_combine
	layer7_dispatch -> layer7_expert57
	layer7_expert57 -> layer7_combine
	layer7_dispatch -> layer7_expert58
	layer7_expert58 -> layer7_combine
	layer7_dispatch -> layer7_expert59
	layer7_expert59 -> layer7_combine
	layer7_dispatch -> layer7_expert60
	layer7_expert60 -> layer7_combine
	layer7_dispatch -> layer7_expert61
	layer7_expert61 -> layer7_combine
	layer7_dispatch -> layer7_expert62
	layer7_expert62 -> layer7_combine
	layer7_dispatch -> layer7_expert63
	layer7_expert63 -> layer7_combine
	layer7_combine -> layer7_moe_out
	layer7_moe_out -> layer7_ar
	layer7_ar -> layer7_res2
	layer7_res2 -> pp_transfer
	pp_transfer -> layer8_ln1
	layer8_ln1 -> layer8_qkv
	layer8_qkv -> layer8_attn
	layer8_attn -> layer8_attn_out
	layer8_attn_out -> layer8_res1
	layer8_res1 -> layer8_ln2
	layer8_ln2 -> layer8_route
	layer8_route -> layer8_dispatch [style=dashed]
	layer8_dispatch -> layer8_expert0
	layer8_expert0 -> layer8_combine
	layer8_dispatch -> layer8_expert1
	layer8_expert1 -> layer8_combine
	layer8_dispatch -> layer8_expert2
	layer8_expert2 -> layer8_combine
	layer8_dispatch -> layer8_expert3
	layer8_expert3 -> layer8_combine
	layer8_dispatch -> layer8_expert4
	layer8_expert4 -> layer8_combine
	layer8_dispatch -> layer8_expert5
	layer8_expert5 -> layer8_combine
	layer8_dispatch -> layer8_expert6
	layer8_expert6 -> layer8_combine
	layer8_dispatch -> layer8_expert7
	layer8_expert7 -> layer8_combine
	layer8_dispatch -> layer8_expert8
	layer8_expert8 -> layer8_combine
	layer8_dispatch -> layer8_expert9
	layer8_expert9 -> layer8_combine
	layer8_dispatch -> layer8_expert10
	layer8_expert10 -> layer8_combine
	layer8_dispatch -> layer8_expert11
	layer8_expert11 -> layer8_combine
	layer8_dispatch -> layer8_expert12
	layer8_expert12 -> layer8_combine
	layer8_dispatch -> layer8_expert13
	layer8_expert13 -> layer8_combine
	layer8_dispatch -> layer8_expert14
	layer8_expert14 -> layer8_combine
	layer8_dispatch -> layer8_expert15
	layer8_expert15 -> layer8_combine
	layer8_dispatch -> layer8_expert16
	layer8_expert16 -> layer8_combine
	layer8_dispatch -> layer8_expert17
	layer8_expert17 -> layer8_combine
	layer8_dispatch -> layer8_expert18
	layer8_expert18 -> layer8_combine
	layer8_dispatch -> layer8_expert19
	layer8_expert19 -> layer8_combine
	layer8_dispatch -> layer8_expert20
	layer8_expert20 -> layer8_combine
	layer8_dispatch -> layer8_expert21
	layer8_expert21 -> layer8_combine
	layer8_dispatch -> layer8_expert22
	layer8_expert22 -> layer8_combine
	layer8_dispatch -> layer8_expert23
	layer8_expert23 -> layer8_combine
	layer8_dispatch -> layer8_expert24
	layer8_expert24 -> layer8_combine
	layer8_dispatch -> layer8_expert25
	layer8_expert25 -> layer8_combine
	layer8_dispatch -> layer8_expert26
	layer8_expert26 -> layer8_combine
	layer8_dispatch -> layer8_expert27
	layer8_expert27 -> layer8_combine
	layer8_dispatch -> layer8_expert28
	layer8_expert28 -> layer8_combine
	layer8_dispatch -> layer8_expert29
	layer8_expert29 -> layer8_combine
	layer8_dispatch -> layer8_expert30
	layer8_expert30 -> layer8_combine
	layer8_dispatch -> layer8_expert31
	layer8_expert31 -> layer8_combine
	layer8_dispatch -> layer8_expert32
	layer8_expert32 -> layer8_combine
	layer8_dispatch -> layer8_expert33
	layer8_expert33 -> layer8_combine
	layer8_dispatch -> layer8_expert34
	layer8_expert34 -> layer8_combine
	layer8_dispatch -> layer8_expert35
	layer8_expert35 -> layer8_combine
	layer8_dispatch -> layer8_expert36
	layer8_expert36 -> layer8_combine
	layer8_dispatch -> layer8_expert37
	layer8_expert37 -> layer8_combine
	layer8_dispatch -> layer8_expert38
	layer8_expert38 -> layer8_combine
	layer8_dispatch -> layer8_expert39
	layer8_expert39 -> layer8_combine
	layer8_dispatch -> layer8_expert40
	layer8_expert40 -> layer8_combine
	layer8_dispatch -> layer8_expert41
	layer8_expert41 -> layer8_combine
	layer8_dispatch -> layer8_expert42
	layer8_expert42 -> layer8_combine
	layer8_dispatch -> layer8_expert43
	layer8_expert43 -> layer8_combine
	layer8_dispatch -> layer8_expert44
	layer8_expert44 -> layer8_combine
	layer8_dispatch -> layer8_expert45
	layer8_expert45 -> layer8_combine
	layer8_dispatch -> layer8_expert46
	layer8_expert46 -> layer8_combine
	layer8_dispatch -> layer8_expert47
	layer8_expert47 -> layer8_combine
	layer8_dispatch -> layer8_expert48
	layer8_expert48 -> layer8_combine
	layer8_dispatch -> layer8_expert49
	layer8_expert49 -> layer8_combine
	layer8_dispatch -> layer8_expert50
	layer8_expert50 -> layer8_combine
	layer8_dispatch -> layer8_expert51
	layer8_expert51 -> layer8_combine
	layer8_dispatch -> layer8_expert52
	layer8_expert52 -> layer8_combine
	layer8_dispatch -> layer8_expert53
	layer8_expert53 -> layer8_combine
	layer8_dispatch -> layer8_expert54
	layer8_expert54 -> layer8_combine
	layer8_dispatch -> layer8_expert55
	layer8_expert55 -> layer8_combine
	layer8_dispatch -> layer8_expert56
	layer8_expert56 -> layer8_combine
	layer8_dispatch -> layer8_expert57
	layer8_expert57 -> layer8_combine
	layer8_dispatch -> layer8_expert58
	layer8_expert58 -> layer8_combine
	layer8_dispatch -> layer8_expert59
	layer8_expert59 -> layer8_combine
	layer8_dispatch -> layer8_expert60
	layer8_expert60 -> layer8_combine
	layer8_dispatch -> layer8_expert61
	layer8_expert61 -> layer8_combine
	layer8_dispatch -> layer8_expert62
	layer8_expert62 -> layer8_combine
	layer8_dispatch -> layer8_expert63
	layer8_expert63 -> layer8_combine
	layer8_combine -> layer8_moe_out
	layer8_moe_out -> layer8_ar
	layer8_ar -> layer8_res2
	layer8_res2 -> layer9_ln1
	layer9_ln1 -> layer9_qkv
	layer9_qkv -> layer9_attn
	layer9_attn -> layer9_attn_out
	layer9_attn_out -> layer9_res1
	layer9_res1 -> layer9_ln2
	layer9_ln2 -> layer9_route
	layer9_route -> layer9_dispatch [style=dashed]
	layer9_dispatch -> layer9_expert0
	layer9_expert0 -> layer9_combine
	layer9_dispatch -> layer9_expert1
	layer9_expert1 -> layer9_combine
	layer9_dispatch -> layer9_expert2
	layer9_expert2 -> layer9_combine
	layer9_dispatch -> layer9_expert3
	layer9_expert3 -> layer9_combine
	layer9_dispatch -> layer9_expert4
	layer9_expert4 -> layer9_combine
	layer9_dispatch -> layer9_expert5
	layer9_expert5 -> layer9_combine
	layer9_dispatch -> layer9_expert6
	layer9_expert6 -> layer9_combine
	layer9_dispatch -> layer9_expert7
	layer9_expert7 -> layer9_combine
	layer9_dispatch -> layer9_expert8
	layer9_expert8 -> layer9_combine
	layer9_dispatch -> layer9_expert9
	layer9_expert9 -> layer9_combine
	layer9_dispatch -> layer9_expert10
	layer9_expert10 -> layer9_combine
	layer9_dispatch -> layer9_expert11
	layer9_expert11 -> layer9_combine
	layer9_dispatch -> layer9_expert12
	layer9_expert12 -> layer9_combine
	layer9_dispatch -> layer9_expert13
	layer9_expert13 -> layer9_combine
	layer9_dispatch -> layer9_expert14
	layer9_expert14 -> layer9_combine
	layer9_dispatch -> layer9_expert15
	layer9_expert15 -> layer9_combine
	layer9_dispatch -> layer9_expert16
	layer9_expert16 -> layer9_combine
	layer9_dispatch -> layer9_expert17
	layer9_expert17 -> layer9_combine
	layer9_dispatch -> layer9_expert18
	layer9_expert18 -> layer9_combine
	layer9_dispatch -> layer9_expert19
	layer9_expert19 -> layer9_combine
	layer9_dispatch -> layer9_expert20
	layer9_expert20 -> layer9_combine
	layer9_dispatch -> layer9_expert21
	layer9_expert21 -> layer9_combine
	layer9_dispatch -> layer9_expert22
	layer9_expert22 -> layer9_combine
	layer9_dispatch -> layer9_expert23
	layer9_expert23 -> layer9_combine
	layer9_dispatch -> layer9_expert24
	layer9_expert24 -> layer9_combine
	layer9_dispatch -> layer9_expert25
	layer9_expert25 -> layer9_combine
	layer9_dispatch -> layer9_expert26
	layer9_expert26 -> layer9_combine
	layer9_dispatch -> layer9_expert27
	layer9_expert27 -> layer9_combine
	layer9_dispatch -> layer9_expert28
	layer9_expert28 -> layer9_combine
	layer9_dispatch -> layer9_expert29
	layer9_expert29 -> layer9_combine
	layer9_dispatch -> layer9_expert30
	layer9_expert30 -> layer9_combine
	layer9_dispatch -> layer9_expert31
	layer9_expert31 -> layer9_combine
	layer9_dispatch -> layer9_expert32
	layer9_expert32 -> layer9_combine
	layer9_dispatch -> layer9_expert33
	layer9_expert33 -> layer9_combine
	layer9_dispatch -> layer9_expert34
	layer9_expert34 -> layer9_combine
	layer9_dispatch -> layer9_expert35
	layer9_expert35 -> layer9_combine
	layer9_dispatch -> layer9_expert36
	layer9_expert36 -> layer9_combine
	layer9_dispatch -> layer9_expert37
	layer9_expert37 -> layer9_combine
	layer9_dispatch -> layer9_expert38
	layer9_expert38 -> layer9_combine
	layer9_dispatch -> layer9_expert39
	layer9_expert39 -> layer9_combine
	layer9_dispatch -> layer9_expert40
	layer9_expert40 -> layer9_combine
	layer9_dispatch -> layer9_expert41
	layer9_expert41 -> layer9_combine
	layer9_dispatch -> layer9_expert42
	layer9_expert42 -> layer9_combine
	layer9_dispatch -> layer9_expert43
	layer9_expert43 -> layer9_combine
	layer9_dispatch -> layer9_expert44
	layer9_expert44 -> layer9_combine
	layer9_dispatch -> layer9_expert45
	layer9_expert45 -> layer9_combine
	layer9_dispatch -> layer9_expert46
	layer9_expert46 -> layer9_combine
	layer9_dispatch -> layer9_expert47
	layer9_expert47 -> layer9_combine
	layer9_dispatch -> layer9_expert48
	layer9_expert48 -> layer9_combine
	layer9_dispatch -> layer9_expert49
	layer9_expert49 -> layer9_combine
	layer9_dispatch -> layer9_expert50
	layer9_expert50 -> layer9_combine
	layer9_dispatch -> layer9_expert51
	layer9_expert51 -> layer9_combine
	layer9_dispatch -> layer9_expert52
	layer9_expert52 -> layer9_combine
	layer9_dispatch -> layer9_expert53
	layer9_expert53 -> layer9_combine
	layer9_dispatch -> layer9_expert54
	layer9_expert54 -> layer9_combine
	layer9_dispatch -> layer9_expert55
	layer9_expert55 -> layer9_combine
	layer9_dispatch -> layer9_expert56
	layer9_expert56 -> layer9_combine
	layer9_dispatch -> layer9_expert57
	layer9_expert57 -> layer9_combine
	layer9_dispatch -> layer9_expert58
	layer9_expert58 -> layer9_combine
	layer9_dispatch -> layer9_expert59
	layer9_expert59 -> layer9_combine
	layer9_dispatch -> layer9_expert60
	layer9_expert60 -> layer9_combine
	layer9_dispatch -> layer9_expert61
	layer9_expert61 -> layer9_combine
	layer9_dispatch -> layer9_expert62
	layer9_expert62 -> layer9_combine
	layer9_dispatch -> layer9_expert63
	layer9_expert63 -> layer9_combine
	layer9_combine -> layer9_moe_out
	layer9_moe_out -> layer9_ar
	layer9_ar -> layer9_res2
	layer9_res2 -> layer10_ln1
	layer10_ln1 -> layer10_qkv
	layer10_qkv -> layer10_attn
	layer10_attn -> layer10_attn_out
	layer10_attn_out -> layer10_res1
	layer10_res1 -> layer10_ln2
	layer10_ln2 -> layer10_route
	layer10_route -> layer10_dispatch [style=dashed]
	layer10_dispatch -> layer10_expert0
	layer10_expert0 -> layer10_combine
	layer10_dispatch -> layer10_expert1
	layer10_expert1 -> layer10_combine
	layer10_dispatch -> layer10_expert2
	layer10_expert2 -> layer10_combine
	layer10_dispatch -> layer10_expert3
	layer10_expert3 -> layer10_combine
	layer10_dispatch -> layer10_expert4
	layer10_expert4 -> layer10_combine
	layer10_dispatch -> layer10_expert5
	layer10_expert5 -> layer10_combine
	layer10_dispatch -> layer10_expert6
	layer10_expert6 -> layer10_combine
	layer10_dispatch -> layer10_expert7
	layer10_expert7 -> layer10_combine
	layer10_dispatch -> layer10_expert8
	layer10_expert8 -> layer10_combine
	layer10_dispatch -> layer10_expert9
	layer10_expert9 -> layer10_combine
	layer10_dispatch -> layer10_expert10
	layer10_expert10 -> layer10_combine
	layer10_dispatch -> layer10_expert11
	layer10_expert11 -> layer10_combine
	layer10_dispatch -> layer10_expert12
	layer10_expert12 -> layer10_combine
	layer10_dispatch -> layer10_expert13
	layer10_expert13 -> layer10_combine
	layer10_dispatch -> layer10_expert14
	layer10_expert14 -> layer10_combine
	layer10_dispatch -> layer10_expert15
	layer10_expert15 -> layer10_combine
	layer10_dispatch -> layer10_expert16
	layer10_expert16 -> layer10_combine
	layer10_dispatch -> layer10_expert17
	layer10_expert17 -> layer10_combine
	layer10_dispatch -> layer10_expert18
	layer10_expert18 -> layer10_combine
	layer10_dispatch -> layer10_expert19
	layer10_expert19 -> layer10_combine
	layer10_dispatch -> layer10_expert20
	layer10_expert20 -> layer10_combine
	layer10_dispatch -> layer10_expert21
	layer10_expert21 -> layer10_combine
	layer10_dispatch -> layer10_expert22
	layer10_expert22 -> layer10_combine
	layer10_dispatch -> layer10_expert23
	layer10_expert23 -> layer10_combine
	layer10_dispatch -> layer10_expert24
	layer10_expert24 -> layer10_combine
	layer10_dispatch -> layer10_expert25
	layer10_expert25 -> layer10_combine
	layer10_dispatch -> layer10_expert26
	layer10_expert26 -> layer10_combine
	layer10_dispatch -> layer10_expert27
	layer10_expert27 -> layer10_combine
	layer10_dispatch -> layer10_expert28
	layer10_expert28 -> layer10_combine
	layer10_dispatch -> layer10_expert29
	layer10_expert29 -> layer10_combine
	layer10_dispatch -> layer10_expert30
	layer10_expert30 -> layer10_combine
	layer10_dispatch -> layer10_expert31
	layer10_expert31 -> layer10_combine
	layer10_dispatch -> layer10_expert32
	layer10_expert32 -> layer10_combine
	layer10_dispatch -> layer10_expert33
	layer10_expert33 -> layer10_combine
	layer10_dispatch -> layer10_expert34
	layer10_expert34 -> layer10_combine
	layer10_dispatch -> layer10_expert35
	layer10_expert35 -> layer10_combine
	layer10_dispatch -> layer10_expert36
	layer10_expert36 -> layer10_combine
	layer10_dispatch -> layer10_expert37
	layer10_expert37 -> layer10_combine
	layer10_dispatch -> layer10_expert38
	layer10_expert38 -> layer10_combine
	layer10_dispatch -> layer10_expert39
	layer10_expert39 -> layer10_combine
	layer10_dispatch -> layer10_expert40
	layer10_expert40 -> layer10_combine
	layer10_dispatch -> layer10_expert41
	layer10_expert41 -> layer10_combine
	layer10_dispatch -> layer10_expert42
	layer10_expert42 -> layer10_combine
	layer10_dispatch -> layer10_expert43
	layer10_expert43 -> layer10_combine
	layer10_dispatch -> layer10_expert44
	layer10_expert44 -> layer10_combine
	layer10_dispatch -> layer10_expert45
	layer10_expert45 -> layer10_combine
	layer10_dispatch -> layer10_expert46
	layer10_expert46 -> layer10_combine
	layer10_dispatch -> layer10_expert47
	layer10_expert47 -> layer10_combine
	layer10_dispatch -> layer10_expert48
	layer10_expert48 -> layer10_combine
	layer10_dispatch -> layer10_expert49
	layer10_expert49 -> layer10_combine
	layer10_dispatch -> layer10_expert50
	layer10_expert50 -> layer10_combine
	layer10_dispatch -> layer10_expert51
	layer10_expert51 -> layer10_combine
	layer10_dispatch -> layer10_expert52
	layer10_expert52 -> layer10_combine
	layer10_dispatch -> layer10_expert53
	layer10_expert53 -> layer10_combine
	layer10_dispatch -> layer10_expert54
	layer10_expert54 -> layer10_combine
	layer10_dispatch -> layer10_expert55
	layer10_expert55 -> layer10_combine
	layer10_dispatch -> layer10_expert56
	layer10_expert56 -> layer10_combine
	layer10_dispatch -> layer10_expert57
	layer10_expert57 -> layer10_combine
	layer10_dispatch -> layer10_expert58
	layer10_expert58 -> layer10_combine
	layer10_dispatch -> layer10_expert59
	layer10_expert59 -> layer10_combine
	layer10_dispatch -> layer10_expert60
	layer10_expert60 -> layer10_combine
	layer10_dispatch -> layer10_expert61
	layer10_expert61 -> layer10_combine
	layer10_dispatch -> layer10_expert62
	layer10_expert62 -> layer10_combine
	layer10_dispatch -> layer10_expert63
	layer10_expert63 -> layer10_combine
	layer10_combine -> layer10_moe_out
	layer10_moe_out -> layer10_ar
	layer10_ar -> layer10_res2
	layer10_res2 -> layer11_ln1
	layer11_ln1 -> layer11_qkv
	layer11_qkv -> layer11_attn
	layer11_attn -> layer11_attn_out
	layer11_attn_out -> layer11_res1
	layer11_res1 -> layer11_ln2
	layer11_ln2 -> layer11_route
	layer11_route -> layer11_dispatch [style=dashed]
	layer11_dispatch -> layer11_expert0
	layer11_expert0 -> layer11_combine
	layer11_dispatch -> layer11_expert1
	layer11_expert1 -> layer11_combine
	layer11_dispatch -> layer11_expert2
	layer11_expert2 -> layer11_combine
	layer11_dispatch -> layer11_expert3
	layer11_expert3 -> layer11_combine
	layer11_dispatch -> layer11_expert4
	layer11_expert4 -> layer11_combine
	layer11_dispatch -> layer11_expert5
	layer11_expert5 -> layer11_combine
	layer11_dispatch -> layer11_expert6
	layer11_expert6 -> layer11_combine
	layer11_dispatch -> layer11_expert7
	layer11_expert7 -> layer11_combine
	layer11_dispatch -> layer11_expert8
	layer11_expert8 -> layer11_combine
	layer11_dispatch -> layer11_expert9
	layer11_expert9 -> layer11_combine
	layer11_dispatch -> layer11_expert10
	layer11_expert10 -> layer11_combine
	layer11_dispatch -> layer11_expert11
	layer11_expert11 -> layer11_combine
	layer11_dispatch -> layer11_expert12
	layer11_expert12 -> layer11_combine
	layer11_dispatch -> layer11_expert13
	layer11_expert13 -> layer11_combine
	layer11_dispatch -> layer11_expert14
	layer11_expert14 -> layer11_combine
	layer11_dispatch -> layer11_expert15
	layer11_expert15 -> layer11_combine
	layer11_dispatch -> layer11_expert16
	layer11_expert16 -> layer11_combine
	layer11_dispatch -> layer11_expert17
	layer11_expert17 -> layer11_combine
	layer11_dispatch -> layer11_expert18
	layer11_expert18 -> layer11_combine
	layer11_dispatch -> layer11_expert19
	layer11_expert19 -> layer11_combine
	layer11_dispatch -> layer11_expert20
	layer11_expert20 -> layer11_combine
	layer11_dispatch -> layer11_expert21
	layer11_expert21 -> layer11_combine
	layer11_dispatch -> layer11_expert22
	layer11_expert22 -> layer11_combine
	layer11_dispatch -> layer11_expert23
	layer11_expert23 -> layer11_combine
	layer11_dispatch -> layer11_expert24
	layer11_expert24 -> layer11_combine
	layer11_dispatch -> layer11_expert25
	layer11_expert25 -> layer11_combine
	layer11_dispatch -> layer11_expert26
	layer11_expert26 -> layer11_combine
	layer11_dispatch -> layer11_expert27
	layer11_expert27 -> layer11_combine
	layer11_dispatch -> layer11_expert28
	layer11_expert28 -> layer11_combine
	layer11_dispatch -> layer11_expert29
	layer11_expert29 -> layer11_combine
	layer11_dispatch -> layer11_expert30
	layer11_expert30 -> layer11_combine
	layer11_dispatch -> layer11_expert31
	layer11_expert31 -> layer11_combine
	layer11_dispatch -> layer11_expert32
	layer11_expert32 -> layer11_combine
	layer11_dispatch -> layer11_expert33
	layer11_expert33 -> layer11_combine
	layer11_dispatch -> layer11_expert34
	layer11_expert34 -> layer11_combine
	layer11_dispatch -> layer11_expert35
	layer11_expert35 -> layer11_combine
	layer11_dispatch -> layer11_expert36
	layer11_expert36 -> layer11_combine
	layer11_dispatch -> layer11_expert37
	layer11_expert37 -> layer11_combine
	layer11_dispatch -> layer11_expert38
	layer11_expert38 -> layer11_combine
	layer11_dispatch -> layer11_expert39
	layer11_expert39 -> layer11_combine
	layer11_dispatch -> layer11_expert40
	layer11_expert40 -> layer11_combine
	layer11_dispatch -> layer11_expert41
	layer11_expert41 -> layer11_combine
	layer11_dispatch -> layer11_expert42
	layer11_expert42 -> layer11_combine
	layer11_dispatch -> layer11_expert43
	layer11_expert43 -> layer11_combine
	layer11_dispatch -> layer11_expert44
	layer11_expert44 -> layer11_combine
	layer11_dispatch -> layer11_expert45
	layer11_expert45 -> layer11_combine
	layer11_dispatch -> layer11_expert46
	layer11_expert46 -> layer11_combine
	layer11_dispatch -> layer11_expert47
	layer11_expert47 -> layer11_combine
	layer11_dispatch -> layer11_expert48
	layer11_expert48 -> layer11_combine
	layer11_dispatch -> layer11_expert49
	layer11_expert49 -> layer11_combine
	layer11_dispatch -> layer11_expert50
	layer11_expert50 -> layer11_combine
	layer11_dispatch -> layer11_expert51
	layer11_expert51 -> layer11_combine
	layer11_dispatch -> layer11_expert52
	layer11_expert52 -> layer11_combine
	layer11_dispatch -> layer11_expert53
	layer11_expert53 -> layer11_combine
	layer11_dispatch -> layer11_expert54
	layer11_expert54 -> layer11_combine
	layer11_dispatch -> layer11_expert55
	layer11_expert55 -> layer11_combine
	layer11_dispatch -> layer11_expert56
	layer11_expert56 -> layer11_combine
	layer11_dispatch -> layer11_expert57
	layer11_expert57 -> layer11_combine
	layer11_dispatch -> layer11_expert58
	layer11_expert58 -> layer11_combine
	layer11_dispatch -> layer11_expert59
	layer11_expert59 -> layer11_combine
	layer11_dispatch -> layer11_expert60
	layer11_expert60 -> layer11_combine
	layer11_dispatch -> layer11_expert61
	layer11_expert61 -> layer11_combine
	layer11_dispatch -> layer11_expert62
	layer11_expert62 -> layer11_combine
	layer11_dispatch -> layer11_expert63
	layer11_expert63 -> layer11_combine
	layer11_combine -> layer11_moe_out
	layer11_moe_out -> layer11_ar
	layer11_ar -> layer11_res2
	layer11_res2 -> layer12_ln1
	layer12_ln1 -> layer12_qkv
	layer12_qkv -> layer12_attn
	layer12_attn -> layer12_attn_out
	layer12_attn_out -> layer12_res1
	layer12_res1 -> layer12_ln2
	layer12_ln2 -> layer12_route
	layer12_route -> layer12_dispatch [style=dashed]
	layer12_dispatch -> layer12_expert0
	layer12_expert0 -> layer12_combine
	layer12_dispatch -> layer12_expert1
	layer12_expert1 -> layer12_combine
	layer12_dispatch -> layer12_expert2
	layer12_expert2 -> layer12_combine
	layer12_dispatch -> layer12_expert3
	layer12_expert3 -> layer12_combine
	layer12_dispatch -> layer12_expert4
	layer12_expert4 -> layer12_combine
	layer12_dispatch -> layer12_expert5
	layer12_expert5 -> layer12_combine
	layer12_dispatch -> layer12_expert6
	layer12_expert6 -> layer12_combine
	layer12_dispatch -> layer12_expert7
	layer12_expert7 -> layer12_combine
	layer12_dispatch -> layer12_expert8
	layer12_expert8 -> layer12_combine
	layer12_dispatch -> layer12_expert9
	layer12_expert9 -> layer12_combine
	layer12_dispatch -> layer12_expert10
	layer12_expert10 -> layer12_combine
	layer12_dispatch -> layer12_expert11
	layer12_expert11 -> layer12_combine
	layer12_dispatch -> layer12_expert12
	layer12_expert12 -> layer12_combine
	layer12_dispatch -> layer12_expert13
	layer12_expert13 -> layer12_combine
	layer12_dispatch -> layer12_expert14
	layer12_expert14 -> layer12_combine
	layer12_dispatch -> layer12_expert15
	layer12_expert15 -> layer12_combine
	layer12_dispatch -> layer12_expert16
	layer12_expert16 -> layer12_combine
	layer12_dispatch -> layer12_expert17
	layer12_expert17 -> layer12_combine
	layer12_dispatch -> layer12_expert18
	layer12_expert18 -> layer12_combine
	layer12_dispatch -> layer12_expert19
	layer12_expert19 -> layer12_combine
	layer12_dispatch -> layer12_expert20
	layer12_expert20 -> layer12_combine
	layer12_dispatch -> layer12_expert21
	layer12_expert21 -> layer12_combine
	layer12_dispatch -> layer12_expert22
	layer12_expert22 -> layer12_combine
	layer12_dispatch -> layer12_expert23
	layer12_expert23 -> layer12_combine
	layer12_dispatch -> layer12_expert24
	layer12_expert24 -> layer12_combine
	layer12_dispatch -> layer12_expert25
	layer12_expert25 -> layer12_combine
	layer12_dispatch -> layer12_expert26
	layer12_expert26 -> layer12_combine
	layer12_dispatch -> layer12_expert27
	layer12_expert27 -> layer12_combine
	layer12_dispatch -> layer12_expert28
	layer12_expert28 -> layer12_combine
	layer12_dispatch -> layer12_expert29
	layer12_expert29 -> layer12_combine
	layer12_dispatch -> layer12_expert30
	layer12_expert30 -> layer12_combine
	layer12_dispatch -> layer12_expert31
	layer12_expert31 -> layer12_combine
	layer12_dispatch -> layer12_expert32
	layer12_expert32 -> layer12_combine
	layer12_dispatch -> layer12_expert33
	layer12_expert33 -> layer12_combine
	layer12_dispatch -> layer12_expert34
	layer12_expert34 -> layer12_combine
	layer12_dispatch -> layer12_expert35
	layer12_expert35 -> layer12_combine
	layer12_dispatch -> layer12_expert36
	layer12_expert36 -> layer12_combine
	layer12_dispatch -> layer12_expert37
	layer12_expert37 -> layer12_combine
	layer12_dispatch -> layer12_expert38
	layer12_expert38 -> layer12_combine
	layer12_dispatch -> layer12_expert39
	layer12_expert39 -> layer12_combine
	layer12_dispatch -> layer12_expert40
	layer12_expert40 -> layer12_combine
	layer12_dispatch -> layer12_expert41
	layer12_expert41 -> layer12_combine
	layer12_dispatch -> layer12_expert42
	layer12_expert42 -> layer12_combine
	layer12_dispatch -> layer12_expert43
	layer12_expert43 -> layer12_combine
	layer12_dispatch -> layer12_expert44
	layer12_expert44 -> layer12_combine
	layer12_dispatch -> layer12_expert45
	layer12_expert45 -> layer12_combine
	layer12_dispatch -> layer12_expert46
	layer12_expert46 -> layer12_combine
	layer12_dispatch -> layer12_expert47
	layer12_expert47 -> layer12_combine
	layer12_dispatch -> layer12_expert48
	layer12_expert48 -> layer12_combine
	layer12_dispatch -> layer12_expert49
	layer12_expert49 -> layer12_combine
	layer12_dispatch -> layer12_expert50
	layer12_expert50 -> layer12_combine
	layer12_dispatch -> layer12_expert51
	layer12_expert51 -> layer12_combine
	layer12_dispatch -> layer12_expert52
	layer12_expert52 -> layer12_combine
	layer12_dispatch -> layer12_expert53
	layer12_expert53 -> layer12_combine
	layer12_dispatch -> layer12_expert54
	layer12_expert54 -> layer12_combine
	layer12_dispatch -> layer12_expert55
	layer12_expert55 -> layer12_combine
	layer12_dispatch -> layer12_expert56
	layer12_expert56 -> layer12_combine
	layer12_dispatch -> layer12_expert57
	layer12_expert57 -> layer12_combine
	layer12_dispatch -> layer12_expert58
	layer12_expert58 -> layer12_combine
	layer12_dispatch -> layer12_expert59
	layer12_expert59 -> layer12_combine
	layer12_dispatch -> layer12_expert60
	layer12_expert60 -> layer12_combine
	layer12_dispatch -> layer12_expert61
	layer12_expert61 -> layer12_combine
	layer12_dispatch -> layer12_expert62
	layer12_expert62 -> layer12_combine
	layer12_dispatch -> layer12_expert63
	layer12_expert63 -> layer12_combine
	layer12_combine -> layer12_moe_out
	layer12_moe_out -> layer12_ar
	layer12_ar -> layer12_res2
	layer12_res2 -> layer13_ln1
	layer13_ln1 -> layer13_qkv
	layer13_qkv -> layer13_attn
	layer13_attn -> layer13_attn_out
	layer13_attn_out -> layer13_res1
	layer13_res1 -> layer13_ln2
	layer13_ln2 -> layer13_route
	layer13_route -> layer13_dispatch [style=dashed]
	layer13_dispatch -> layer13_expert0
	layer13_expert0 -> layer13_combine
	layer13_dispatch -> layer13_expert1
	layer13_expert1 -> layer13_combine
	layer13_dispatch -> layer13_expert2
	layer13_expert2 -> layer13_combine
	layer13_dispatch -> layer13_expert3
	layer13_expert3 -> layer13_combine
	layer13_dispatch -> layer13_expert4
	layer13_expert4 -> layer13_combine
	layer13_dispatch -> layer13_expert5
	layer13_expert5 -> layer13_combine
	layer13_dispatch -> layer13_expert6
	layer13_expert6 -> layer13_combine
	layer13_dispatch -> layer13_expert7
	layer13_expert7 -> layer13_combine
	layer13_dispatch -> layer13_expert8
	layer13_expert8 -> layer13_combine
	layer13_dispatch -> layer13_expert9
	layer13_expert9 -> layer13_combine
	layer13_dispatch -> layer13_expert10
	layer13_expert10 -> layer13_combine
	layer13_dispatch -> layer13_expert11
	layer13_expert11 -> layer13_combine
	layer13_dispatch -> layer13_expert12
	layer13_expert12 -> layer13_combine
	layer13_dispatch -> layer13_expert13
	layer13_expert13 -> layer13_combine
	layer13_dispatch -> layer13_expert14
	layer13_expert14 -> layer13_combine
	layer13_dispatch -> layer13_expert15
	layer13_expert15 -> layer13_combine
	layer13_dispatch -> layer13_expert16
	layer13_expert16 -> layer13_combine
	layer13_dispatch -> layer13_expert17
	layer13_expert17 -> layer13_combine
	layer13_dispatch -> layer13_expert18
	layer13_expert18 -> layer13_combine
	layer13_dispatch -> layer13_expert19
	layer13_expert19 -> layer13_combine
	layer13_dispatch -> layer13_expert20
	layer13_expert20 -> layer13_combine
	layer13_dispatch -> layer13_expert21
	layer13_expert21 -> layer13_combine
	layer13_dispatch -> layer13_expert22
	layer13_expert22 -> layer13_combine
	layer13_dispatch -> layer13_expert23
	layer13_expert23 -> layer13_combine
	layer13_dispatch -> layer13_expert24
	layer13_expert24 -> layer13_combine
	layer13_dispatch -> layer13_expert25
	layer13_expert25 -> layer13_combine
	layer13_dispatch -> layer13_expert26
	layer13_expert26 -> layer13_combine
	layer13_dispatch -> layer13_expert27
	layer13_expert27 -> layer13_combine
	layer13_dispatch -> layer13_expert28
	layer13_expert28 -> layer13_combine
	layer13_dispatch -> layer13_expert29
	layer13_expert29 -> layer13_combine
	layer13_dispatch -> layer13_expert30
	layer13_expert30 -> layer13_combine
	layer13_dispatch -> layer13_expert31
	layer13_expert31 -> layer13_combine
	layer13_dispatch -> layer13_expert32
	layer13_expert32 -> layer13_combine
	layer13_dispatch -> layer13_expert33
	layer13_expert33 -> layer13_combine
	layer13_dispatch -> layer13_expert34
	layer13_expert34 -> layer13_combine
	layer13_dispatch -> layer13_expert35
	layer13_expert35 -> layer13_combine
	layer13_dispatch -> layer13_expert36
	layer13_expert36 -> layer13_combine
	layer13_dispatch -> layer13_expert37
	layer13_expert37 -> layer13_combine
	layer13_dispatch -> layer13_expert38
	layer13_expert38 -> layer13_combine
	layer13_dispatch -> layer13_expert39
	layer13_expert39 -> layer13_combine
	layer13_dispatch -> layer13_expert40
	layer13_expert40 -> layer13_combine
	layer13_dispatch -> layer13_expert41
	layer13_expert41 -> layer13_combine
	layer13_dispatch -> layer13_expert42
	layer13_expert42 -> layer13_combine
	layer13_dispatch -> layer13_expert43
	layer13_expert43 -> layer13_combine
	layer13_dispatch -> layer13_expert44
	layer13_expert44 -> layer13_combine
	layer13_dispatch -> layer13_expert45
	layer13_expert45 -> layer13_combine
	layer13_dispatch -> layer13_expert46
	layer13_expert46 -> layer13_combine
	layer13_dispatch -> layer13_expert47
	layer13_expert47 -> layer13_combine
	layer13_dispatch -> layer13_expert48
	layer13_expert48 -> layer13_combine
	layer13_dispatch -> layer13_expert49
	layer13_expert49 -> layer13_combine
	layer13_dispatch -> layer13_expert50
	layer13_expert50 -> layer13_combine
	layer13_dispatch -> layer13_expert51
	layer13_expert51 -> layer13_combine
	layer13_dispatch -> layer13_expert52
	layer13_expert52 -> layer13_combine
	layer13_dispatch -> layer13_expert53
	layer13_expert53 -> layer13_combine
	layer13_dispatch -> layer13_expert54
	layer13_expert54 -> layer13_combine
	layer13_dispatch -> layer13_expert55
	layer13_expert55 -> layer13_combine
	layer13_dispatch -> layer13_expert56
	layer13_expert56 -> layer13_combine
	layer13_dispatch -> layer13_expert57
	layer13_expert57 -> layer13_combine
	layer13_dispatch -> layer13_expert58
	layer13_expert58 -> layer13_combine
	layer13_dispatch -> layer13_expert59
	layer13_expert59 -> layer13_combine
	layer13_dispatch -> layer13_expert60
	layer13_expert60 -> layer13_combine
	layer13_dispatch -> layer13_expert61
	layer13_expert61 -> layer13_combine
	layer13_dispatch -> layer13_expert62
	layer13_expert62 -> layer13_combine
	layer13_dispatch -> layer13_expert63
	layer13_expert63 -> layer13_combine
	layer13_combine -> layer13_moe_out
	layer13_moe_out -> layer13_ar
	layer13_ar -> layer13_res2
	layer13_res2 -> layer14_ln1
	layer14_ln1 -> layer14_qkv
	layer14_qkv -> layer14_attn
	layer14_attn -> layer14_attn_out
	layer14_attn_out -> layer14_res1
	layer14_res1 -> layer14_ln2
	layer14_ln2 -> layer14_route
	layer14_route -> layer14_dispatch [style=dashed]
	layer14_dispatch -> layer14_expert0
	layer14_expert0 -> layer14_combine
	layer14_dispatch -> layer14_expert1
	layer14_expert1 -> layer14_combine
	layer14_dispatch -> layer14_expert2
	layer14_expert2 -> layer14_combine
	layer14_dispatch -> layer14_expert3
	layer14_expert3 -> layer14_combine
	layer14_dispatch -> layer14_expert4
	layer14_expert4 -> layer14_combine
	layer14_dispatch -> layer14_expert5
	layer14_expert5 -> layer14_combine
	layer14_dispatch -> layer14_expert6
	layer14_expert6 -> layer14_combine
	layer14_dispatch -> layer14_expert7
	layer14_expert7 -> layer14_combine
	layer14_dispatch -> layer14_expert8
	layer14_expert8 -> layer14_combine
	layer14_dispatch -> layer14_expert9
	layer14_expert9 -> layer14_combine
	layer14_dispatch -> layer14_expert10
	layer14_expert10 -> layer14_combine
	layer14_dispatch -> layer14_expert11
	layer14_expert11 -> layer14_combine
	layer14_dispatch -> layer14_expert12
	layer14_expert12 -> layer14_combine
	layer14_dispatch -> layer14_expert13
	layer14_expert13 -> layer14_combine
	layer14_dispatch -> layer14_expert14
	layer14_expert14 -> layer14_combine
	layer14_dispatch -> layer14_expert15
	layer14_expert15 -> layer14_combine
	layer14_dispatch -> layer14_expert16
	layer14_expert16 -> layer14_combine
	layer14_dispatch -> layer14_expert17
	layer14_expert17 -> layer14_combine
	layer14_dispatch -> layer14_expert18
	layer14_expert18 -> layer14_combine
	layer14_dispatch -> layer14_expert19
	layer14_expert19 -> layer14_combine
	layer14_dispatch -> layer14_expert20
	layer14_expert20 -> layer14_combine
	layer14_dispatch -> layer14_expert21
	layer14_expert21 -> layer14_combine
	layer14_dispatch -> layer14_expert22
	layer14_expert22 -> layer14_combine
	layer14_dispatch -> layer14_expert23
	layer14_expert23 -> layer14_combine
	layer14_dispatch -> layer14_expert24
	layer14_expert24 -> layer14_combine
	layer14_dispatch -> layer14_expert25
	layer14_expert25 -> layer14_combine
	layer14_dispatch -> layer14_expert26
	layer14_expert26 -> layer14_combine
	layer14_dispatch -> layer14_expert27
	layer14_expert27 -> layer14_combine
	layer14_dispatch -> layer14_expert28
	layer14_expert28 -> layer14_combine
	layer14_dispatch -> layer14_expert29
	layer14_expert29 -> layer14_combine
	layer14_dispatch -> layer14_expert30
	layer14_expert30 -> layer14_combine
	layer14_dispatch -> layer14_expert31
	layer14_expert31 -> layer14_combine
	layer14_dispatch -> layer14_expert32
	layer14_expert32 -> layer14_combine
	layer14_dispatch -> layer14_expert33
	layer14_expert33 -> layer14_combine
	layer14_dispatch -> layer14_expert34
	layer14_expert34 -> layer14_combine
	layer14_dispatch -> layer14_expert35
	layer14_expert35 -> layer14_combine
	layer14_dispatch -> layer14_expert36
	layer14_expert36 -> layer14_combine
	layer14_dispatch -> layer14_expert37
	layer14_expert37 -> layer14_combine
	layer14_dispatch -> layer14_expert38
	layer14_expert38 -> layer14_combine
	layer14_dispatch -> layer14_expert39
	layer14_expert39 -> layer14_combine
	layer14_dispatch -> layer14_expert40
	layer14_expert40 -> layer14_combine
	layer14_dispatch -> layer14_expert41
	layer14_expert41 -> layer14_combine
	layer14_dispatch -> layer14_expert42
	layer14_expert42 -> layer14_combine
	layer14_dispatch -> layer14_expert43
	layer14_expert43 -> layer14_combine
	layer14_dispatch -> layer14_expert44
	layer14_expert44 -> layer14_combine
	layer14_dispatch -> layer14_expert45
	layer14_expert45 -> layer14_combine
	layer14_dispatch -> layer14_expert46
	layer14_expert46 -> layer14_combine
	layer14_dispatch -> layer14_expert47
	layer14_expert47 -> layer14_combine
	layer14_dispatch -> layer14_expert48
	layer14_expert48 -> layer14_combine
	layer14_dispatch -> layer14_expert49
	layer14_expert49 -> layer14_combine
	layer14_dispatch -> layer14_expert50
	layer14_expert50 -> layer14_combine
	layer14_dispatch -> layer14_expert51
	layer14_expert51 -> layer14_combine
	layer14_dispatch -> layer14_expert52
	layer14_expert52 -> layer14_combine
	layer14_dispatch -> layer14_expert53
	layer14_expert53 -> layer14_combine
	layer14_dispatch -> layer14_expert54
	layer14_expert54 -> layer14_combine
	layer14_dispatch -> layer14_expert55
	layer14_expert55 -> layer14_combine
	layer14_dispatch -> layer14_expert56
	layer14_expert56 -> layer14_combine
	layer14_dispatch -> layer14_expert57
	layer14_expert57 -> layer14_combine
	layer14_dispatch -> layer14_expert58
	layer14_expert58 -> layer14_combine
	layer14_dispatch -> layer14_expert59
	layer14_expert59 -> layer14_combine
	layer14_dispatch -> layer14_expert60
	layer14_expert60 -> layer14_combine
	layer14_dispatch -> layer14_expert61
	layer14_expert61 -> layer14_combine
	layer14_dispatch -> layer14_expert62
	layer14_expert62 -> layer14_combine
	layer14_dispatch -> layer14_expert63
	layer14_expert63 -> layer14_combine
	layer14_combine -> layer14_moe_out
	layer14_moe_out -> layer14_ar
	layer14_ar -> layer14_res2
	layer14_res2 -> layer15_ln1
	layer15_ln1 -> layer15_qkv
	layer15_qkv -> layer15_attn
	layer15_attn -> layer15_attn_out
	layer15_attn_out -> layer15_res1
	layer15_res1 -> layer15_ln2
	layer15_ln2 -> layer15_route
	layer15_route -> layer15_dispatch [style=dashed]
	layer15_dispatch -> layer15_expert0
	layer15_expert0 -> layer15_combine
	layer15_dispatch -> layer15_expert1
	layer15_expert1 -> layer15_combine
	layer15_dispatch -> layer15_expert2
	layer15_expert2 -> layer15_combine
	layer15_dispatch -> layer15_expert3
	layer15_expert3 -> layer15_combine
	layer15_dispatch -> layer15_expert4
	layer15_expert4 -> layer15_combine
	layer15_dispatch -> layer15_expert5
	layer15_expert5 -> layer15_combine
	layer15_dispatch -> layer15_expert6
	layer15_expert6 -> layer15_combine
	layer15_dispatch -> layer15_expert7
	layer15_expert7 -> layer15_combine
	layer15_dispatch -> layer15_expert8
	layer15_expert8 -> layer15_combine
	layer15_dispatch -> layer15_expert9
	layer15_expert9 -> layer15_combine
	layer15_dispatch -> layer15_expert10
	layer15_expert10 -> layer15_combine
	layer15_dispatch -> layer15_expert11
	layer15_expert11 -> layer15_combine
	layer15_dispatch -> layer15_expert12
	layer15_expert12 -> layer15_combine
	layer15_dispatch -> layer15_expert13
	layer15_expert13 -> layer15_combine
	layer15_dispatch -> layer15_expert14
	layer15_expert14 -> layer15_combine
	layer15_dispatch -> layer15_expert15
	layer15_expert15 -> layer15_combine
	layer15_dispatch -> layer15_expert16
	layer15_expert16 -> layer15_combine
	layer15_dispatch -> layer15_expert17
	layer15_expert17 -> layer15_combine
	layer15_dispatch -> layer15_expert18
	layer15_expert18 -> layer15_combine
	layer15_dispatch -> layer15_expert19
	layer15_expert19 -> layer15_combine
	layer15_dispatch -> layer15_expert20
	layer15_expert20 -> layer15_combine
	layer15_dispatch -> layer15_expert21
	layer15_expert21 -> layer15_combine
	layer15_dispatch -> layer15_expert22
	layer15_expert22 -> layer15_combine
	layer15_dispatch -> layer15_expert23
	layer15_expert23 -> layer15_combine
	layer15_dispatch -> layer15_expert24
	layer15_expert24 -> layer15_combine
	layer15_dispatch -> layer15_expert25
	layer15_expert25 -> layer15_combine
	layer15_dispatch -> layer15_expert26
	layer15_expert26 -> layer15_combine
	layer15_dispatch -> layer15_expert27
	layer15_expert27 -> layer15_combine
	layer15_dispatch -> layer15_expert28
	layer15_expert28 -> layer15_combine
	layer15_dispatch -> layer15_expert29
	layer15_expert29 -> layer15_combine
	layer15_dispatch -> layer15_expert30
	layer15_expert30 -> layer15_combine
	layer15_dispatch -> layer15_expert31
	layer15_expert31 -> layer15_combine
	layer15_dispatch -> layer15_expert32
	layer15_expert32 -> layer15_combine
	layer15_dispatch -> layer15_expert33
	layer15_expert33 -> layer15_combine
	layer15_dispatch -> layer15_expert34
	layer15_expert34 -> layer15_combine
	layer15_dispatch -> layer15_expert35
	layer15_expert35 -> layer15_combine
	layer15_dispatch -> layer15_expert36
	layer15_expert36 -> layer15_combine
	layer15_dispatch -> layer15_expert37
	layer15_expert37 -> layer15_combine
	layer15_dispatch -> layer15_expert38
	layer15_expert38 -> layer15_combine
	layer15_dispatch -> layer15_expert39
	layer15_expert39 -> layer15_combine
	layer15_dispatch -> layer15_expert40
	layer15_expert40 -> layer15_combine
	layer15_dispatch -> layer15_expert41
	layer15_expert41 -> layer15_combine
	layer15_dispatch -> layer15_expert42
	layer15_expert42 -> layer15_combine
	layer15_dispatch -> layer15_expert43
	layer15_expert43 -> layer15_combine
	layer15_dispatch -> layer15_expert44
	layer15_expert44 -> layer15_combine
	layer15_dispatch -> layer15_expert45
	layer15_expert45 -> layer15_combine
	layer15_dispatch -> layer15_expert46
	layer15_expert46 -> layer15_combine
	layer15_dispatch -> layer15_expert47
	layer15_expert47 -> layer15_combine
	layer15_dispatch -> layer15_expert48
	layer15_expert48 -> layer15_combine
	layer15_dispatch -> layer15_expert49
	layer15_expert49 -> layer15_combine
	layer15_dispatch -> layer15_expert50
	layer15_expert50 -> layer15_combine
	layer15_dispatch -> layer15_expert51
	layer15_expert51 -> layer15_combine
	layer15_dispatch -> layer15_expert52
	layer15_expert52 -> layer15_combine
	layer15_dispatch -> layer15_expert53
	layer15_expert53 -> layer15_combine
	layer15_dispatch -> layer15_expert54
	layer15_expert54 -> layer15_combine
	layer15_dispatch -> layer15_expert55
	layer15_expert55 -> layer15_combine
	layer15_dispatch -> layer15_expert56
	layer15_expert56 -> layer15_combine
	layer15_dispatch -> layer15_expert57
	layer15_expert57 -> layer15_combine
	layer15_dispatch -> layer15_expert58
	layer15_expert58 -> layer15_combine
	layer15_dispatch -> layer15_expert59
	layer15_expert59 -> layer15_combine
	layer15_dispatch -> layer15_expert60
	layer15_expert60 -> layer15_combine
	layer15_dispatch -> layer15_expert61
	layer15_expert61 -> layer15_combine
	layer15_dispatch -> layer15_expert62
	layer15_expert62 -> layer15_combine
	layer15_dispatch -> layer15_expert63
	layer15_expert63 -> layer15_combine
	layer15_combine -> layer15_moe_out
	layer15_moe_out -> layer15_ar
	layer15_ar -> layer15_res2
	layer15_res2 -> final_ln
	final_ln -> output
}
