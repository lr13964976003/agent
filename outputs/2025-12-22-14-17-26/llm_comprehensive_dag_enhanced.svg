<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="5974pt" height="19069pt"
 viewBox="0.00 0.00 5974.00 19068.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 19064.71)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-19064.71 5970,-19064.71 5970,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="2982.5" cy="-19029.6" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-19041.2" font-family="Arial" font-size="8.00">Input</text>
<text text-anchor="middle" x="2982.5" y="-19032.2" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-19023.2" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-19014.2" font-family="Arial" font-size="8.00">GPUs: All</text>
</g>
<!-- layernorm1_s1_l0 -->
<g id="node2" class="node">
<title>layernorm1_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-18962.48 2893.5,-18962.48 2893.5,-18918.48 3071.5,-18918.48 3071.5,-18962.48"/>
<text text-anchor="middle" x="2982.5" y="-18952.08" font-family="Arial" font-size="8.00">LayerNorm 1 (L0)</text>
<text text-anchor="middle" x="2982.5" y="-18943.08" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18934.08" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18925.08" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- input&#45;&gt;layernorm1_s1_l0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layernorm1_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18998.13C2982.5,-18989.85 2982.5,-18980.87 2982.5,-18972.56"/>
<polygon fill="black" stroke="black" points="2986,-18972.49 2982.5,-18962.49 2979,-18972.49 2986,-18972.49"/>
</g>
<!-- qkv_proj_s1_l0 -->
<g id="node3" class="node">
<title>qkv_proj_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3081,-18882.48 2884,-18882.48 2884,-18838.48 3081,-18838.48 3081,-18882.48"/>
<text text-anchor="middle" x="2982.5" y="-18872.08" font-family="Arial" font-size="8.00">QKV Projection L0 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-18863.08" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18854.08" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-18845.08" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1_l0&#45;&gt;qkv_proj_s1_l0 -->
<g id="edge2" class="edge">
<title>layernorm1_s1_l0&#45;&gt;qkv_proj_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18918.17C2982.5,-18910.28 2982.5,-18901.17 2982.5,-18892.59"/>
<polygon fill="black" stroke="black" points="2986,-18892.5 2982.5,-18882.5 2979,-18892.5 2986,-18892.5"/>
</g>
<!-- allreduce_qkv_s1_l0 -->
<g id="node4" class="node">
<title>allreduce_qkv_s1_l0</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-18771.37" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-18782.97" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L0</text>
<text text-anchor="middle" x="2982.5" y="-18773.97" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-18764.97" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-18755.97" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1_l0&#45;&gt;allreduce_qkv_s1_l0 -->
<g id="edge3" class="edge">
<title>qkv_proj_s1_l0&#45;&gt;allreduce_qkv_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18838.39C2982.5,-18830.72 2982.5,-18821.77 2982.5,-18812.98"/>
<polygon fill="black" stroke="black" points="2986,-18812.81 2982.5,-18802.81 2979,-18812.81 2986,-18812.81"/>
</g>
<!-- attention_s1_l0 -->
<g id="node5" class="node">
<title>attention_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3081,-18704.26 2884,-18704.26 2884,-18660.26 3081,-18660.26 3081,-18704.26"/>
<text text-anchor="middle" x="2982.5" y="-18693.86" font-family="Arial" font-size="8.00">Self&#45;Attention L0</text>
<text text-anchor="middle" x="2982.5" y="-18684.86" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-18675.86" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-18666.86" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1_l0&#45;&gt;attention_s1_l0 -->
<g id="edge4" class="edge">
<title>allreduce_qkv_s1_l0&#45;&gt;attention_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18739.9C2982.5,-18731.62 2982.5,-18722.65 2982.5,-18714.33"/>
<polygon fill="black" stroke="black" points="2986,-18714.26 2982.5,-18704.26 2979,-18714.26 2986,-18714.26"/>
</g>
<!-- attn_out_proj_s1_l0 -->
<g id="node6" class="node">
<title>attn_out_proj_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3078,-18624.26 2887,-18624.26 2887,-18580.26 3078,-18580.26 3078,-18624.26"/>
<text text-anchor="middle" x="2982.5" y="-18613.86" font-family="Arial" font-size="8.00">Attention Output Proj L0 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-18604.86" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-18595.86" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18586.86" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1_l0&#45;&gt;attn_out_proj_s1_l0 -->
<g id="edge5" class="edge">
<title>attention_s1_l0&#45;&gt;attn_out_proj_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18659.94C2982.5,-18652.05 2982.5,-18642.94 2982.5,-18634.36"/>
<polygon fill="black" stroke="black" points="2986,-18634.28 2982.5,-18624.28 2979,-18634.28 2986,-18634.28"/>
</g>
<!-- allreduce_attn_out_s1_l0 -->
<g id="node7" class="node">
<title>allreduce_attn_out_s1_l0</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-18513.14" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-18524.74" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L0</text>
<text text-anchor="middle" x="2982.5" y="-18515.74" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18506.74" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18497.74" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1_l0&#45;&gt;allreduce_attn_out_s1_l0 -->
<g id="edge6" class="edge">
<title>attn_out_proj_s1_l0&#45;&gt;allreduce_attn_out_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18580.17C2982.5,-18572.5 2982.5,-18563.54 2982.5,-18554.75"/>
<polygon fill="black" stroke="black" points="2986,-18554.59 2982.5,-18544.59 2979,-18554.59 2986,-18554.59"/>
</g>
<!-- moe_gate_s1_l0 -->
<g id="node8" class="node">
<title>moe_gate_s1_l0</title>
<polygon fill="orange" stroke="black" points="3167.08,-18446.03 2873.45,-18446.03 2797.92,-18358.03 3091.55,-18358.03 3167.08,-18446.03"/>
<text text-anchor="middle" x="2982.5" y="-18413.63" font-family="Arial" font-size="8.00">MoE Gate L0 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-18404.63" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18395.63" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18386.63" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1_l0&#45;&gt;moe_gate_s1_l0 -->
<g id="edge7" class="edge">
<title>allreduce_attn_out_s1_l0&#45;&gt;moe_gate_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18481.75C2982.5,-18473.86 2982.5,-18465.13 2982.5,-18456.44"/>
<polygon fill="black" stroke="black" points="2986,-18456.31 2982.5,-18446.31 2979,-18456.31 2986,-18456.31"/>
</g>
<!-- expert_dispatch_s1_l0 -->
<g id="node9" class="node">
<title>expert_dispatch_s1_l0</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-18290.92" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-18302.52" font-family="Arial" font-size="8.00">Expert Dispatch L0 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-18293.52" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18284.52" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18275.52" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1_l0&#45;&gt;expert_dispatch_s1_l0 -->
<g id="edge8" class="edge">
<title>moe_gate_s1_l0&#45;&gt;expert_dispatch_s1_l0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-18357.91C2982.5,-18349.53 2982.5,-18340.78 2982.5,-18332.49"/>
<polygon fill="black" stroke="black" points="2986,-18332.29 2982.5,-18322.29 2979,-18332.29 2986,-18332.29"/>
</g>
<!-- expert_0_s1_l0 -->
<g id="node10" class="node">
<title>expert_0_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="169,-18223.81 0,-18223.81 0,-18179.81 169,-18179.81 169,-18223.81"/>
<text text-anchor="middle" x="84.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 0 L0</text>
<text text-anchor="middle" x="84.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_0_s1_l0 -->
<g id="edge9" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_0_s1_l0</title>
<path fill="none" stroke="black" d="M2856.42,-18290.27C2385.23,-18291.07 727.13,-18289.16 178.99,-18223.85"/>
<polygon fill="black" stroke="black" points="179.37,-18220.37 169.02,-18222.64 178.53,-18227.32 179.37,-18220.37"/>
</g>
<!-- expert_1_s1_l0 -->
<g id="node11" class="node">
<title>expert_1_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="356,-18223.81 187,-18223.81 187,-18179.81 356,-18179.81 356,-18223.81"/>
<text text-anchor="middle" x="271.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 1 L0</text>
<text text-anchor="middle" x="271.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_1_s1_l0 -->
<g id="edge10" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_1_s1_l0</title>
<path fill="none" stroke="black" d="M2856.36,-18290.02C2405.73,-18289.88 875.66,-18284.88 366.03,-18223.86"/>
<polygon fill="black" stroke="black" points="366.37,-18220.37 356.02,-18222.63 365.52,-18227.32 366.37,-18220.37"/>
</g>
<!-- expert_2_s1_l0 -->
<g id="node12" class="node">
<title>expert_2_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="543,-18223.81 374,-18223.81 374,-18179.81 543,-18179.81 543,-18223.81"/>
<text text-anchor="middle" x="458.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 2 L0</text>
<text text-anchor="middle" x="458.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_2_s1_l0 -->
<g id="edge11" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_2_s1_l0</title>
<path fill="none" stroke="black" d="M2856.51,-18289.73C2427.43,-18288.6 1024.14,-18280.62 552.96,-18223.85"/>
<polygon fill="black" stroke="black" points="553.38,-18220.37 543.02,-18222.63 552.52,-18227.32 553.38,-18220.37"/>
</g>
<!-- expert_3_s1_l0 -->
<g id="node13" class="node">
<title>expert_3_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="730,-18223.81 561,-18223.81 561,-18179.81 730,-18179.81 730,-18223.81"/>
<text text-anchor="middle" x="645.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 3 L0</text>
<text text-anchor="middle" x="645.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_3_s1_l0 -->
<g id="edge12" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_3_s1_l0</title>
<path fill="none" stroke="black" d="M2856.69,-18289.4C2450.07,-18287.23 1173.13,-18276.38 740.1,-18223.87"/>
<polygon fill="black" stroke="black" points="740.38,-18220.37 730.02,-18222.62 739.52,-18227.32 740.38,-18220.37"/>
</g>
<!-- expert_4_s1_l0 -->
<g id="node14" class="node">
<title>expert_4_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="917,-18223.81 748,-18223.81 748,-18179.81 917,-18179.81 917,-18223.81"/>
<text text-anchor="middle" x="832.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 4 L0</text>
<text text-anchor="middle" x="832.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_4_s1_l0 -->
<g id="edge13" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_4_s1_l0</title>
<path fill="none" stroke="black" d="M2856.78,-18289.01C2473.43,-18285.73 1321.87,-18272.15 927.06,-18223.86"/>
<polygon fill="black" stroke="black" points="927.38,-18220.38 917.03,-18222.61 926.51,-18227.32 927.38,-18220.38"/>
</g>
<!-- expert_5_s1_l0 -->
<g id="node15" class="node">
<title>expert_5_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="1104,-18223.81 935,-18223.81 935,-18179.81 1104,-18179.81 1104,-18223.81"/>
<text text-anchor="middle" x="1019.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 5 L0</text>
<text text-anchor="middle" x="1019.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_5_s1_l0 -->
<g id="edge14" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_5_s1_l0</title>
<path fill="none" stroke="black" d="M2856.8,-18288.54C2497.73,-18284.1 1470.88,-18267.94 1114.13,-18223.87"/>
<polygon fill="black" stroke="black" points="1114.39,-18220.38 1104.03,-18222.6 1113.51,-18227.32 1114.39,-18220.38"/>
</g>
<!-- expert_6_s1_l0 -->
<g id="node16" class="node">
<title>expert_6_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="1291,-18223.81 1122,-18223.81 1122,-18179.81 1291,-18179.81 1291,-18223.81"/>
<text text-anchor="middle" x="1206.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 6 L0</text>
<text text-anchor="middle" x="1206.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_6_s1_l0 -->
<g id="edge15" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_6_s1_l0</title>
<path fill="none" stroke="black" d="M2857.17,-18287.97C2523.91,-18282.3 1620.17,-18263.76 1301.21,-18223.89"/>
<polygon fill="black" stroke="black" points="1301.39,-18220.38 1291.03,-18222.58 1300.5,-18227.33 1301.39,-18220.38"/>
</g>
<!-- expert_7_s1_l0 -->
<g id="node17" class="node">
<title>expert_7_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="1478,-18223.81 1309,-18223.81 1309,-18179.81 1478,-18179.81 1478,-18223.81"/>
<text text-anchor="middle" x="1393.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 7 L0</text>
<text text-anchor="middle" x="1393.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_7_s1_l0 -->
<g id="edge16" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_7_s1_l0</title>
<path fill="none" stroke="black" d="M2857.5,-18287.26C2551.41,-18280.29 1769.45,-18259.61 1488.23,-18223.9"/>
<polygon fill="black" stroke="black" points="1488.4,-18220.39 1478.03,-18222.56 1487.49,-18227.33 1488.4,-18220.39"/>
</g>
<!-- expert_8_s1_l0 -->
<g id="node18" class="node">
<title>expert_8_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="1665,-18223.81 1496,-18223.81 1496,-18179.81 1665,-18179.81 1665,-18223.81"/>
<text text-anchor="middle" x="1580.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 8 L0</text>
<text text-anchor="middle" x="1580.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_8_s1_l0 -->
<g id="edge17" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_8_s1_l0</title>
<path fill="none" stroke="black" d="M2856.38,-18290.72C2623.94,-18290.61 2112.47,-18283.04 1675.03,-18223.9"/>
<polygon fill="black" stroke="black" points="1675.42,-18220.42 1665.03,-18222.54 1674.47,-18227.36 1675.42,-18220.42"/>
</g>
<!-- expert_9_s1_l0 -->
<g id="node19" class="node">
<title>expert_9_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="1852,-18223.81 1683,-18223.81 1683,-18179.81 1852,-18179.81 1852,-18223.81"/>
<text text-anchor="middle" x="1767.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 9 L0</text>
<text text-anchor="middle" x="1767.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_9_s1_l0 -->
<g id="edge18" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_9_s1_l0</title>
<path fill="none" stroke="black" d="M2856.48,-18289.18C2650.05,-18286.49 2227.11,-18274.77 1862.01,-18223.91"/>
<polygon fill="black" stroke="black" points="1862.43,-18220.44 1852.04,-18222.51 1861.45,-18227.37 1862.43,-18220.44"/>
</g>
<!-- expert_10_s1_l0 -->
<g id="node20" class="node">
<title>expert_10_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="2039,-18223.81 1870,-18223.81 1870,-18179.81 2039,-18179.81 2039,-18223.81"/>
<text text-anchor="middle" x="1954.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 10 L0</text>
<text text-anchor="middle" x="1954.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_10_s1_l0 -->
<g id="edge19" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_10_s1_l0</title>
<path fill="none" stroke="black" d="M2857.46,-18287.09C2679.53,-18281.72 2343.14,-18266.6 2049.05,-18223.93"/>
<polygon fill="black" stroke="black" points="2049.45,-18220.45 2039.05,-18222.47 2048.43,-18227.38 2049.45,-18220.45"/>
</g>
<!-- expert_11_s1_l0 -->
<g id="node21" class="node">
<title>expert_11_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="2226,-18223.81 2057,-18223.81 2057,-18179.81 2226,-18179.81 2226,-18223.81"/>
<text text-anchor="middle" x="2141.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 11 L0</text>
<text text-anchor="middle" x="2141.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_11_s1_l0 -->
<g id="edge20" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_11_s1_l0</title>
<path fill="none" stroke="black" d="M2859.45,-18284.11C2712.89,-18276.03 2460.66,-18258.52 2236.05,-18223.96"/>
<polygon fill="black" stroke="black" points="2236.47,-18220.48 2226.05,-18222.4 2235.4,-18227.4 2236.47,-18220.48"/>
</g>
<!-- expert_12_s1_l0 -->
<g id="node22" class="node">
<title>expert_12_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="2413,-18223.81 2244,-18223.81 2244,-18179.81 2413,-18179.81 2413,-18223.81"/>
<text text-anchor="middle" x="2328.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 12 L0</text>
<text text-anchor="middle" x="2328.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_12_s1_l0 -->
<g id="edge21" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_12_s1_l0</title>
<path fill="none" stroke="black" d="M2864.87,-18279.67C2753.34,-18269.13 2580.99,-18250.67 2422.98,-18223.99"/>
<polygon fill="black" stroke="black" points="2423.52,-18220.53 2413.07,-18222.3 2422.34,-18227.43 2423.52,-18220.53"/>
</g>
<!-- expert_13_s1_l0 -->
<g id="node23" class="node">
<title>expert_13_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="2600,-18223.81 2431,-18223.81 2431,-18179.81 2600,-18179.81 2600,-18223.81"/>
<text text-anchor="middle" x="2515.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 13 L0</text>
<text text-anchor="middle" x="2515.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_13_s1_l0 -->
<g id="edge22" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_13_s1_l0</title>
<path fill="none" stroke="black" d="M2879.07,-18272.98C2806.34,-18260.76 2706.53,-18243.34 2610.04,-18224.08"/>
<polygon fill="black" stroke="black" points="2610.6,-18220.62 2600.11,-18222.09 2609.23,-18227.49 2610.6,-18220.62"/>
</g>
<!-- expert_14_s1_l0 -->
<g id="node24" class="node">
<title>expert_14_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="2787,-18223.81 2618,-18223.81 2618,-18179.81 2787,-18179.81 2787,-18223.81"/>
<text text-anchor="middle" x="2702.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 14 L0</text>
<text text-anchor="middle" x="2702.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_14_s1_l0 -->
<g id="edge23" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_14_s1_l0</title>
<path fill="none" stroke="black" d="M2905.99,-18266.12C2866.88,-18253.95 2819.39,-18239.17 2780.12,-18226.96"/>
<polygon fill="black" stroke="black" points="2780.91,-18223.54 2770.32,-18223.91 2778.83,-18230.22 2780.91,-18223.54"/>
</g>
<!-- expert_15_s1_l0 -->
<g id="node25" class="node">
<title>expert_15_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="2974,-18223.81 2805,-18223.81 2805,-18179.81 2974,-18179.81 2974,-18223.81"/>
<text text-anchor="middle" x="2889.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 15 L0</text>
<text text-anchor="middle" x="2889.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_15_s1_l0 -->
<g id="edge24" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_15_s1_l0</title>
<path fill="none" stroke="black" d="M2951.27,-18260.67C2941.01,-18251.06 2929.64,-18240.4 2919.47,-18230.88"/>
<polygon fill="black" stroke="black" points="2921.66,-18228.14 2911.97,-18223.86 2916.88,-18233.25 2921.66,-18228.14"/>
</g>
<!-- expert_16_s1_l0 -->
<g id="node26" class="node">
<title>expert_16_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3161,-18223.81 2992,-18223.81 2992,-18179.81 3161,-18179.81 3161,-18223.81"/>
<text text-anchor="middle" x="3076.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 16 L0</text>
<text text-anchor="middle" x="3076.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_16_s1_l0 -->
<g id="edge25" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_16_s1_l0</title>
<path fill="none" stroke="black" d="M3014.06,-18260.67C3024.43,-18251.06 3035.93,-18240.4 3046.21,-18230.88"/>
<polygon fill="black" stroke="black" points="3048.83,-18233.22 3053.78,-18223.86 3044.07,-18228.09 3048.83,-18233.22"/>
</g>
<!-- expert_17_s1_l0 -->
<g id="node27" class="node">
<title>expert_17_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3348,-18223.81 3179,-18223.81 3179,-18179.81 3348,-18179.81 3348,-18223.81"/>
<text text-anchor="middle" x="3263.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 17 L0</text>
<text text-anchor="middle" x="3263.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_17_s1_l0 -->
<g id="edge26" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_17_s1_l0</title>
<path fill="none" stroke="black" d="M3059.28,-18266.12C3098.53,-18253.95 3146.2,-18239.17 3185.6,-18226.96"/>
<polygon fill="black" stroke="black" points="3186.92,-18230.21 3195.43,-18223.91 3184.84,-18223.53 3186.92,-18230.21"/>
</g>
<!-- expert_18_s1_l0 -->
<g id="node28" class="node">
<title>expert_18_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3535,-18223.81 3366,-18223.81 3366,-18179.81 3535,-18179.81 3535,-18223.81"/>
<text text-anchor="middle" x="3450.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 18 L0</text>
<text text-anchor="middle" x="3450.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_18_s1_l0 -->
<g id="edge27" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_18_s1_l0</title>
<path fill="none" stroke="black" d="M3085.81,-18273.07C3158.76,-18260.84 3259.03,-18243.41 3355.92,-18224.09"/>
<polygon fill="black" stroke="black" points="3356.77,-18227.49 3365.89,-18222.09 3355.4,-18220.62 3356.77,-18227.49"/>
</g>
<!-- expert_19_s1_l0 -->
<g id="node29" class="node">
<title>expert_19_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3722,-18223.81 3553,-18223.81 3553,-18179.81 3722,-18179.81 3722,-18223.81"/>
<text text-anchor="middle" x="3637.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 19 L0</text>
<text text-anchor="middle" x="3637.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_19_s1_l0 -->
<g id="edge28" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_19_s1_l0</title>
<path fill="none" stroke="black" d="M3100.07,-18279.71C3211.79,-18269.18 3384.6,-18250.72 3543,-18223.99"/>
<polygon fill="black" stroke="black" points="3543.66,-18227.43 3552.93,-18222.3 3542.48,-18220.53 3543.66,-18227.43"/>
</g>
<!-- expert_20_s1_l0 -->
<g id="node30" class="node">
<title>expert_20_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3909,-18223.81 3740,-18223.81 3740,-18179.81 3909,-18179.81 3909,-18223.81"/>
<text text-anchor="middle" x="3824.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 20 L0</text>
<text text-anchor="middle" x="3824.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_20_s1_l0 -->
<g id="edge29" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_20_s1_l0</title>
<path fill="none" stroke="black" d="M3105.39,-18284.13C3252.09,-18276.08 3504.87,-18258.58 3729.93,-18223.96"/>
<polygon fill="black" stroke="black" points="3730.6,-18227.4 3739.95,-18222.4 3729.53,-18220.48 3730.6,-18227.4"/>
</g>
<!-- expert_21_s1_l0 -->
<g id="node31" class="node">
<title>expert_21_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="4096,-18223.81 3927,-18223.81 3927,-18179.81 4096,-18179.81 4096,-18223.81"/>
<text text-anchor="middle" x="4011.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 21 L0</text>
<text text-anchor="middle" x="4011.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_21_s1_l0 -->
<g id="edge30" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_21_s1_l0</title>
<path fill="none" stroke="black" d="M3107.68,-18287.1C3285.8,-18281.74 3622.55,-18266.63 3916.94,-18223.93"/>
<polygon fill="black" stroke="black" points="3917.57,-18227.38 3926.96,-18222.47 3916.55,-18220.45 3917.57,-18227.38"/>
</g>
<!-- expert_22_s1_l0 -->
<g id="node32" class="node">
<title>expert_22_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="4283,-18223.81 4114,-18223.81 4114,-18179.81 4283,-18179.81 4283,-18223.81"/>
<text text-anchor="middle" x="4198.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 22 L0</text>
<text text-anchor="middle" x="4198.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_22_s1_l0 -->
<g id="edge31" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_22_s1_l0</title>
<path fill="none" stroke="black" d="M3108.22,-18289.19C3314.67,-18286.52 3738.31,-18274.84 4103.98,-18223.91"/>
<polygon fill="black" stroke="black" points="4104.55,-18227.37 4113.96,-18222.51 4103.57,-18220.44 4104.55,-18227.37"/>
</g>
<!-- expert_23_s1_l0 -->
<g id="node33" class="node">
<title>expert_23_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="4470,-18223.81 4301,-18223.81 4301,-18179.81 4470,-18179.81 4470,-18223.81"/>
<text text-anchor="middle" x="4385.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 23 L0</text>
<text text-anchor="middle" x="4385.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_23_s1_l0 -->
<g id="edge32" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_23_s1_l0</title>
<path fill="none" stroke="black" d="M3108.71,-18290.72C3341.33,-18290.63 3853.2,-18283.08 4290.96,-18223.9"/>
<polygon fill="black" stroke="black" points="4291.53,-18227.36 4300.97,-18222.54 4290.58,-18220.42 4291.53,-18227.36"/>
</g>
<!-- expert_24_s1_l0 -->
<g id="node34" class="node">
<title>expert_24_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="4657,-18223.81 4488,-18223.81 4488,-18179.81 4657,-18179.81 4657,-18223.81"/>
<text text-anchor="middle" x="4572.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 24 L0</text>
<text text-anchor="middle" x="4572.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_24_s1_l0 -->
<g id="edge33" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_24_s1_l0</title>
<path fill="none" stroke="black" d="M3107.58,-18287.26C3413.87,-18280.3 4196.36,-18259.63 4477.77,-18223.9"/>
<polygon fill="black" stroke="black" points="4478.51,-18227.33 4487.97,-18222.56 4477.6,-18220.39 4478.51,-18227.33"/>
</g>
<!-- expert_25_s1_l0 -->
<g id="node35" class="node">
<title>expert_25_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="4844,-18223.81 4675,-18223.81 4675,-18179.81 4844,-18179.81 4844,-18223.81"/>
<text text-anchor="middle" x="4759.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 25 L0</text>
<text text-anchor="middle" x="4759.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_25_s1_l0 -->
<g id="edge34" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_25_s1_l0</title>
<path fill="none" stroke="black" d="M3107.91,-18287.97C3441.37,-18282.31 4345.64,-18263.78 4664.78,-18223.89"/>
<polygon fill="black" stroke="black" points="4665.5,-18227.33 4674.97,-18222.58 4664.61,-18220.38 4665.5,-18227.33"/>
</g>
<!-- expert_26_s1_l0 -->
<g id="node36" class="node">
<title>expert_26_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="5031,-18223.81 4862,-18223.81 4862,-18179.81 5031,-18179.81 5031,-18223.81"/>
<text text-anchor="middle" x="4946.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 26 L0</text>
<text text-anchor="middle" x="4946.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_26_s1_l0 -->
<g id="edge35" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_26_s1_l0</title>
<path fill="none" stroke="black" d="M3108.26,-18288.54C3467.53,-18284.11 4494.93,-18267.96 4851.87,-18223.88"/>
<polygon fill="black" stroke="black" points="4852.49,-18227.32 4861.97,-18222.6 4851.61,-18220.38 4852.49,-18227.32"/>
</g>
<!-- expert_27_s1_l0 -->
<g id="node37" class="node">
<title>expert_27_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="5218,-18223.81 5049,-18223.81 5049,-18179.81 5218,-18179.81 5218,-18223.81"/>
<text text-anchor="middle" x="5133.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 27 L0</text>
<text text-anchor="middle" x="5133.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_27_s1_l0 -->
<g id="edge36" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_27_s1_l0</title>
<path fill="none" stroke="black" d="M3108.28,-18289.01C3491.82,-18285.74 4643.94,-18272.17 5038.93,-18223.86"/>
<polygon fill="black" stroke="black" points="5039.49,-18227.32 5048.97,-18222.61 5038.62,-18220.38 5039.49,-18227.32"/>
</g>
<!-- expert_28_s1_l0 -->
<g id="node38" class="node">
<title>expert_28_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="5405,-18223.81 5236,-18223.81 5236,-18179.81 5405,-18179.81 5405,-18223.81"/>
<text text-anchor="middle" x="5320.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 28 L0</text>
<text text-anchor="middle" x="5320.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_28_s1_l0 -->
<g id="edge37" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_28_s1_l0</title>
<path fill="none" stroke="black" d="M3108.37,-18289.4C3515.16,-18287.23 4792.68,-18276.4 5225.9,-18223.87"/>
<polygon fill="black" stroke="black" points="5226.48,-18227.32 5235.98,-18222.62 5225.62,-18220.37 5226.48,-18227.32"/>
</g>
<!-- expert_29_s1_l0 -->
<g id="node39" class="node">
<title>expert_29_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="5592,-18223.81 5423,-18223.81 5423,-18179.81 5592,-18179.81 5592,-18223.81"/>
<text text-anchor="middle" x="5507.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 29 L0</text>
<text text-anchor="middle" x="5507.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_29_s1_l0 -->
<g id="edge38" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_29_s1_l0</title>
<path fill="none" stroke="black" d="M3108.54,-18289.74C3537.8,-18288.61 4941.67,-18280.64 5413.04,-18223.85"/>
<polygon fill="black" stroke="black" points="5413.48,-18227.32 5422.98,-18222.63 5412.62,-18220.37 5413.48,-18227.32"/>
</g>
<!-- expert_30_s1_l0 -->
<g id="node40" class="node">
<title>expert_30_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="5779,-18223.81 5610,-18223.81 5610,-18179.81 5779,-18179.81 5779,-18223.81"/>
<text text-anchor="middle" x="5694.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 30 L0</text>
<text text-anchor="middle" x="5694.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_30_s1_l0 -->
<g id="edge39" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_30_s1_l0</title>
<path fill="none" stroke="black" d="M3108.69,-18290.02C3559.49,-18289.88 5090.14,-18284.9 5599.96,-18223.86"/>
<polygon fill="black" stroke="black" points="5600.48,-18227.32 5609.98,-18222.63 5599.63,-18220.37 5600.48,-18227.32"/>
</g>
<!-- expert_31_s1_l0 -->
<g id="node41" class="node">
<title>expert_31_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="5966,-18223.81 5797,-18223.81 5797,-18179.81 5966,-18179.81 5966,-18223.81"/>
<text text-anchor="middle" x="5881.5" y="-18213.41" font-family="Arial" font-size="8.00">Expert 31 L0</text>
<text text-anchor="middle" x="5881.5" y="-18204.41" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-18195.41" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-18186.41" font-family="Arial" font-size="8.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1_l0&#45;&gt;expert_31_s1_l0 -->
<g id="edge40" class="edge">
<title>expert_dispatch_s1_l0&#45;&gt;expert_31_s1_l0</title>
<path fill="none" stroke="black" d="M3108.62,-18290.27C3579.98,-18291.08 5238.67,-18289.18 5787,-18223.85"/>
<polygon fill="black" stroke="black" points="5787.47,-18227.32 5796.98,-18222.64 5786.63,-18220.37 5787.47,-18227.32"/>
</g>
<!-- expert_combine_s1_l0 -->
<g id="node42" class="node">
<title>expert_combine_s1_l0</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-18112.69" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-18124.29" font-family="Arial" font-size="8.00">Expert Combine L0 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-18115.29" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-18106.29" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18097.29" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge41" class="edge">
<title>expert_0_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M169.02,-18180.97C171.88,-18180.54 174.71,-18180.15 177.5,-18179.81 702.97,-18114.94 2358.67,-18112.57 2846.17,-18113.32"/>
<polygon fill="black" stroke="black" points="2846.42,-18116.83 2856.42,-18113.34 2846.43,-18109.83 2846.42,-18116.83"/>
</g>
<!-- expert_1_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge42" class="edge">
<title>expert_1_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M356.02,-18180.98C358.88,-18180.55 361.71,-18180.15 364.5,-18179.81 851.71,-18119.25 2380.13,-18113.81 2846.21,-18113.6"/>
<polygon fill="black" stroke="black" points="2846.36,-18117.1 2856.36,-18113.59 2846.36,-18110.1 2846.36,-18117.1"/>
</g>
<!-- expert_2_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge43" class="edge">
<title>expert_2_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M543.02,-18180.99C545.88,-18180.55 548.71,-18180.16 551.5,-18179.81 1000.54,-18123.55 2402.24,-18115.15 2846.2,-18113.91"/>
<polygon fill="black" stroke="black" points="2846.52,-18117.41 2856.51,-18113.88 2846.5,-18110.41 2846.52,-18117.41"/>
</g>
<!-- expert_3_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge44" class="edge">
<title>expert_3_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M730.02,-18180.99C732.88,-18180.56 735.71,-18180.16 738.5,-18179.81 1149.63,-18127.83 2426.08,-18116.58 2846.61,-18114.27"/>
<polygon fill="black" stroke="black" points="2846.7,-18117.77 2856.69,-18114.21 2846.67,-18110.77 2846.7,-18117.77"/>
</g>
<!-- expert_4_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge45" class="edge">
<title>expert_4_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M917.03,-18181C919.88,-18180.56 922.71,-18180.16 925.5,-18179.81 1298.74,-18132.11 2450.22,-18118.14 2846.7,-18114.69"/>
<polygon fill="black" stroke="black" points="2846.81,-18118.19 2856.78,-18114.61 2846.75,-18111.19 2846.81,-18118.19"/>
</g>
<!-- expert_5_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge46" class="edge">
<title>expert_5_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M1104.03,-18181.02C1106.88,-18180.57 1109.71,-18180.17 1112.5,-18179.81 1447.94,-18136.39 2474.98,-18119.86 2846.54,-18115.21"/>
<polygon fill="black" stroke="black" points="2846.85,-18118.7 2856.8,-18115.08 2846.76,-18111.7 2846.85,-18118.7"/>
</g>
<!-- expert_6_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge47" class="edge">
<title>expert_6_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M1291.03,-18181.03C1293.88,-18180.58 1296.71,-18180.17 1299.5,-18179.81 1597.53,-18140.64 2502.38,-18121.74 2847.13,-18115.82"/>
<polygon fill="black" stroke="black" points="2847.23,-18119.32 2857.17,-18115.65 2847.11,-18112.32 2847.23,-18119.32"/>
</g>
<!-- expert_7_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge48" class="edge">
<title>expert_7_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M1478.03,-18181.05C1480.88,-18180.6 1483.71,-18180.18 1486.5,-18179.81 1747.22,-18144.89 2530.56,-18123.86 2847.35,-18116.59"/>
<polygon fill="black" stroke="black" points="2847.58,-18120.08 2857.5,-18116.35 2847.42,-18113.08 2847.58,-18120.08"/>
</g>
<!-- expert_8_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge49" class="edge">
<title>expert_8_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M1665.03,-18181.07C1667.88,-18180.61 1670.71,-18180.19 1673.5,-18179.81 2098.54,-18121.52 2607.53,-18113.23 2846.26,-18112.91"/>
<polygon fill="black" stroke="black" points="2846.39,-18116.41 2856.38,-18112.9 2846.38,-18109.41 2846.39,-18116.41"/>
</g>
<!-- expert_9_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge50" class="edge">
<title>expert_9_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M1852.04,-18181.1C1854.89,-18180.63 1857.71,-18180.2 1860.5,-18179.81 2213.6,-18129.88 2634.37,-18117.54 2846.24,-18114.57"/>
<polygon fill="black" stroke="black" points="2846.52,-18118.07 2856.48,-18114.43 2846.43,-18111.07 2846.52,-18118.07"/>
</g>
<!-- expert_10_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge51" class="edge">
<title>expert_10_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M2039.05,-18181.14C2041.89,-18180.67 2044.72,-18180.22 2047.5,-18179.81 2330.13,-18138.15 2664.83,-18122.54 2847.27,-18116.84"/>
<polygon fill="black" stroke="black" points="2847.57,-18120.33 2857.46,-18116.52 2847.35,-18113.33 2847.57,-18120.33"/>
</g>
<!-- expert_11_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge52" class="edge">
<title>expert_11_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M2226.05,-18181.21C2228.9,-18180.71 2231.72,-18180.24 2234.5,-18179.81 2448.23,-18146.38 2699.16,-18128.51 2849.26,-18120.07"/>
<polygon fill="black" stroke="black" points="2849.66,-18123.56 2859.45,-18119.51 2849.27,-18116.57 2849.66,-18123.56"/>
</g>
<!-- expert_12_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge53" class="edge">
<title>expert_12_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M2413.07,-18181.31C2415.91,-18180.79 2418.73,-18180.28 2421.5,-18179.81 2569.28,-18154.49 2740.64,-18135.83 2854.7,-18124.91"/>
<polygon fill="black" stroke="black" points="2855.24,-18128.37 2864.87,-18123.94 2854.58,-18121.4 2855.24,-18128.37"/>
</g>
<!-- expert_13_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge54" class="edge">
<title>expert_13_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M2600.11,-18181.52C2602.94,-18180.94 2605.74,-18180.36 2608.5,-18179.81 2695.55,-18162.29 2794.51,-18144.91 2868.76,-18132.37"/>
<polygon fill="black" stroke="black" points="2869.79,-18135.74 2879.07,-18130.63 2868.63,-18128.84 2869.79,-18135.74"/>
</g>
<!-- expert_14_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge55" class="edge">
<title>expert_14_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M2770.28,-18179.72C2808.19,-18167.92 2855.83,-18153.1 2896.36,-18140.49"/>
<polygon fill="black" stroke="black" points="2897.45,-18143.82 2905.96,-18137.51 2895.37,-18137.14 2897.45,-18143.82"/>
</g>
<!-- expert_15_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge56" class="edge">
<title>expert_15_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M2912.01,-18179.72C2921.53,-18170.8 2932.9,-18160.15 2943.7,-18150.03"/>
<polygon fill="black" stroke="black" points="2946.15,-18152.54 2951.06,-18143.14 2941.37,-18147.43 2946.15,-18152.54"/>
</g>
<!-- expert_16_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge57" class="edge">
<title>expert_16_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M3053.75,-18179.72C3044.12,-18170.8 3032.63,-18160.15 3021.71,-18150.03"/>
<polygon fill="black" stroke="black" points="3023.99,-18147.37 3014.28,-18143.14 3019.23,-18152.51 3023.99,-18147.37"/>
</g>
<!-- expert_17_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge58" class="edge">
<title>expert_17_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M3195.48,-18179.72C3157.36,-18167.9 3109.44,-18153.05 3068.71,-18140.42"/>
<polygon fill="black" stroke="black" points="3069.65,-18137.05 3059.06,-18137.43 3067.58,-18143.73 3069.65,-18137.05"/>
</g>
<!-- expert_18_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge59" class="edge">
<title>expert_18_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M3365.89,-18181.52C3363.06,-18180.93 3360.26,-18180.36 3357.5,-18179.81 3269.89,-18162.2 3170.24,-18144.75 3095.69,-18132.21"/>
<polygon fill="black" stroke="black" points="3096.25,-18128.75 3085.81,-18130.55 3095.09,-18135.66 3096.25,-18128.75"/>
</g>
<!-- expert_19_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge60" class="edge">
<title>expert_19_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M3552.93,-18181.31C3550.09,-18180.79 3547.27,-18180.28 3544.5,-18179.81 3396.34,-18154.44 3224.52,-18135.78 3110.26,-18124.87"/>
<polygon fill="black" stroke="black" points="3110.36,-18121.36 3100.07,-18123.9 3109.69,-18128.33 3110.36,-18121.36"/>
</g>
<!-- expert_20_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge61" class="edge">
<title>expert_20_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M3739.95,-18181.21C3737.1,-18180.71 3734.28,-18180.24 3731.5,-18179.81 3517.33,-18146.33 3265.85,-18128.46 3115.58,-18120.04"/>
<polygon fill="black" stroke="black" points="3115.57,-18116.54 3105.39,-18119.48 3115.18,-18123.53 3115.57,-18116.54"/>
</g>
<!-- expert_21_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge62" class="edge">
<title>expert_21_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M3926.96,-18181.14C3924.11,-18180.66 3921.28,-18180.22 3918.5,-18179.81 3635.57,-18138.12 3300.51,-18122.51 3117.87,-18116.83"/>
<polygon fill="black" stroke="black" points="3117.78,-18113.32 3107.68,-18116.51 3117.57,-18120.32 3117.78,-18113.32"/>
</g>
<!-- expert_22_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge63" class="edge">
<title>expert_22_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M4113.96,-18181.1C4111.11,-18180.63 4108.29,-18180.2 4105.5,-18179.81 3751.85,-18129.81 3330.37,-18117.51 3118.46,-18114.56"/>
<polygon fill="black" stroke="black" points="3118.26,-18111.05 3108.22,-18114.42 3118.17,-18118.05 3118.26,-18111.05"/>
</g>
<!-- expert_23_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge64" class="edge">
<title>expert_23_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M4300.97,-18181.07C4298.12,-18180.61 4295.29,-18180.19 4292.5,-18179.81 3867.13,-18121.49 3357.75,-18113.21 3118.84,-18112.9"/>
<polygon fill="black" stroke="black" points="3118.72,-18109.4 3108.71,-18112.89 3118.71,-18116.4 3118.72,-18109.4"/>
</g>
<!-- expert_24_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge65" class="edge">
<title>expert_24_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M4487.97,-18181.05C4485.12,-18180.6 4482.29,-18180.18 4479.5,-18179.81 4218.6,-18144.87 3434.74,-18123.86 3117.74,-18116.58"/>
<polygon fill="black" stroke="black" points="3117.66,-18113.08 3107.58,-18116.35 3117.5,-18120.08 3117.66,-18113.08"/>
</g>
<!-- expert_25_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge66" class="edge">
<title>expert_25_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M4674.97,-18181.03C4672.12,-18180.58 4669.29,-18180.17 4666.5,-18179.81 4368.29,-18140.62 3462.9,-18121.73 3117.95,-18115.82"/>
<polygon fill="black" stroke="black" points="3117.97,-18112.32 3107.91,-18115.64 3117.85,-18119.31 3117.97,-18112.32"/>
</g>
<!-- expert_26_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge67" class="edge">
<title>expert_26_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M4861.97,-18181.02C4859.12,-18180.57 4856.29,-18180.17 4853.5,-18179.81 4517.88,-18136.37 3490.29,-18119.85 3118.53,-18115.2"/>
<polygon fill="black" stroke="black" points="3118.31,-18111.7 3108.26,-18115.08 3118.22,-18118.7 3118.31,-18111.7"/>
</g>
<!-- expert_27_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge68" class="edge">
<title>expert_27_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M5048.97,-18181C5046.12,-18180.56 5043.29,-18180.16 5040.5,-18179.81 4667.07,-18132.09 3515.04,-18118.14 3118.36,-18114.69"/>
<polygon fill="black" stroke="black" points="3118.31,-18111.19 3108.28,-18114.6 3118.25,-18118.19 3118.31,-18111.19"/>
</g>
<!-- expert_28_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge69" class="edge">
<title>expert_28_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M5235.98,-18180.99C5233.12,-18180.56 5230.29,-18180.16 5227.5,-18179.81 4816.19,-18127.81 3539.17,-18116.58 3118.45,-18114.27"/>
<polygon fill="black" stroke="black" points="3118.39,-18110.77 3108.37,-18114.21 3118.35,-18117.77 3118.39,-18110.77"/>
</g>
<!-- expert_29_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge70" class="edge">
<title>expert_29_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M5422.98,-18180.99C5420.12,-18180.55 5417.29,-18180.16 5414.5,-18179.81 4965.28,-18123.53 3563,-18115.14 3118.86,-18113.91"/>
<polygon fill="black" stroke="black" points="3118.55,-18110.4 3108.54,-18113.88 3118.53,-18117.4 3118.55,-18110.4"/>
</g>
<!-- expert_30_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge71" class="edge">
<title>expert_30_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M5609.98,-18180.98C5607.12,-18180.55 5604.29,-18180.15 5601.5,-18179.81 5114.1,-18119.23 3585.1,-18113.81 3118.84,-18113.59"/>
<polygon fill="black" stroke="black" points="3118.69,-18110.09 3108.69,-18113.59 3118.69,-18117.09 3118.69,-18110.09"/>
</g>
<!-- expert_31_s1_l0&#45;&gt;expert_combine_s1_l0 -->
<g id="edge72" class="edge">
<title>expert_31_s1_l0&#45;&gt;expert_combine_s1_l0</title>
<path fill="none" stroke="black" d="M5796.98,-18180.97C5794.12,-18180.54 5791.29,-18180.15 5788.5,-18179.81 5262.84,-18114.92 3606.55,-18112.56 3118.88,-18113.32"/>
<polygon fill="black" stroke="black" points="3118.62,-18109.82 3108.62,-18113.34 3118.63,-18116.82 3118.62,-18109.82"/>
</g>
<!-- moe_out_proj_s1_l0 -->
<g id="node43" class="node">
<title>moe_out_proj_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-18045.58 2893.5,-18045.58 2893.5,-18001.58 3071.5,-18001.58 3071.5,-18045.58"/>
<text text-anchor="middle" x="2982.5" y="-18035.18" font-family="Arial" font-size="8.00">MoE Output Proj L0 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-18026.18" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18017.18" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-18008.18" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1_l0&#45;&gt;moe_out_proj_s1_l0 -->
<g id="edge73" class="edge">
<title>expert_combine_s1_l0&#45;&gt;moe_out_proj_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18081.23C2982.5,-18072.95 2982.5,-18063.97 2982.5,-18055.66"/>
<polygon fill="black" stroke="black" points="2986,-18055.59 2982.5,-18045.59 2979,-18055.59 2986,-18055.59"/>
</g>
<!-- allreduce_moe_out_s1_l0 -->
<g id="node44" class="node">
<title>allreduce_moe_out_s1_l0</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-17934.47" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-17946.07" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L0</text>
<text text-anchor="middle" x="2982.5" y="-17937.07" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17928.07" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17919.07" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1_l0&#45;&gt;allreduce_moe_out_s1_l0 -->
<g id="edge74" class="edge">
<title>moe_out_proj_s1_l0&#45;&gt;allreduce_moe_out_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-18001.49C2982.5,-17993.82 2982.5,-17984.87 2982.5,-17976.07"/>
<polygon fill="black" stroke="black" points="2986,-17975.91 2982.5,-17965.91 2979,-17975.91 2986,-17975.91"/>
</g>
<!-- layernorm2_s1_l0 -->
<g id="node45" class="node">
<title>layernorm2_s1_l0</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-17867.36 2893.5,-17867.36 2893.5,-17823.36 3071.5,-17823.36 3071.5,-17867.36"/>
<text text-anchor="middle" x="2982.5" y="-17856.96" font-family="Arial" font-size="8.00">LayerNorm 2 (L0)</text>
<text text-anchor="middle" x="2982.5" y="-17847.96" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17838.96" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17829.96" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1_l0&#45;&gt;layernorm2_s1_l0 -->
<g id="edge75" class="edge">
<title>allreduce_moe_out_s1_l0&#45;&gt;layernorm2_s1_l0</title>
<path fill="none" stroke="black" d="M2982.5,-17903C2982.5,-17894.72 2982.5,-17885.75 2982.5,-17877.43"/>
<polygon fill="black" stroke="black" points="2986,-17877.36 2982.5,-17867.36 2979,-17877.36 2986,-17877.36"/>
</g>
<!-- layernorm1_s1_l1 -->
<g id="node46" class="node">
<title>layernorm1_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-17787.36 2893.5,-17787.36 2893.5,-17743.36 3071.5,-17743.36 3071.5,-17787.36"/>
<text text-anchor="middle" x="2982.5" y="-17776.96" font-family="Arial" font-size="8.00">LayerNorm 1 (L1)</text>
<text text-anchor="middle" x="2982.5" y="-17767.96" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17758.96" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17749.96" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm2_s1_l0&#45;&gt;layernorm1_s1_l1 -->
<g id="edge76" class="edge">
<title>layernorm2_s1_l0&#45;&gt;layernorm1_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-17823.04C2982.5,-17815.15 2982.5,-17806.04 2982.5,-17797.46"/>
<polygon fill="black" stroke="black" points="2986,-17797.37 2982.5,-17787.37 2979,-17797.37 2986,-17797.37"/>
</g>
<!-- qkv_proj_s1_l1 -->
<g id="node47" class="node">
<title>qkv_proj_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3081,-17707.36 2884,-17707.36 2884,-17663.36 3081,-17663.36 3081,-17707.36"/>
<text text-anchor="middle" x="2982.5" y="-17696.96" font-family="Arial" font-size="8.00">QKV Projection L1 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-17687.96" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17678.96" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-17669.96" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1_l1&#45;&gt;qkv_proj_s1_l1 -->
<g id="edge77" class="edge">
<title>layernorm1_s1_l1&#45;&gt;qkv_proj_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-17743.04C2982.5,-17735.15 2982.5,-17726.04 2982.5,-17717.46"/>
<polygon fill="black" stroke="black" points="2986,-17717.37 2982.5,-17707.37 2979,-17717.37 2986,-17717.37"/>
</g>
<!-- allreduce_qkv_s1_l1 -->
<g id="node48" class="node">
<title>allreduce_qkv_s1_l1</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-17596.24" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-17607.84" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L1</text>
<text text-anchor="middle" x="2982.5" y="-17598.84" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-17589.84" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-17580.84" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1_l1&#45;&gt;allreduce_qkv_s1_l1 -->
<g id="edge78" class="edge">
<title>qkv_proj_s1_l1&#45;&gt;allreduce_qkv_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-17663.27C2982.5,-17655.6 2982.5,-17646.64 2982.5,-17637.85"/>
<polygon fill="black" stroke="black" points="2986,-17637.69 2982.5,-17627.69 2979,-17637.69 2986,-17637.69"/>
</g>
<!-- attention_s1_l1 -->
<g id="node49" class="node">
<title>attention_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3081,-17529.13 2884,-17529.13 2884,-17485.13 3081,-17485.13 3081,-17529.13"/>
<text text-anchor="middle" x="2982.5" y="-17518.73" font-family="Arial" font-size="8.00">Self&#45;Attention L1</text>
<text text-anchor="middle" x="2982.5" y="-17509.73" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-17500.73" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-17491.73" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1_l1&#45;&gt;attention_s1_l1 -->
<g id="edge79" class="edge">
<title>allreduce_qkv_s1_l1&#45;&gt;attention_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-17564.78C2982.5,-17556.5 2982.5,-17547.52 2982.5,-17539.21"/>
<polygon fill="black" stroke="black" points="2986,-17539.13 2982.5,-17529.13 2979,-17539.13 2986,-17539.13"/>
</g>
<!-- attn_out_proj_s1_l1 -->
<g id="node50" class="node">
<title>attn_out_proj_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3078,-17449.13 2887,-17449.13 2887,-17405.13 3078,-17405.13 3078,-17449.13"/>
<text text-anchor="middle" x="2982.5" y="-17438.73" font-family="Arial" font-size="8.00">Attention Output Proj L1 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-17429.73" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-17420.73" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17411.73" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1_l1&#45;&gt;attn_out_proj_s1_l1 -->
<g id="edge80" class="edge">
<title>attention_s1_l1&#45;&gt;attn_out_proj_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-17484.82C2982.5,-17476.93 2982.5,-17467.81 2982.5,-17459.23"/>
<polygon fill="black" stroke="black" points="2986,-17459.15 2982.5,-17449.15 2979,-17459.15 2986,-17459.15"/>
</g>
<!-- allreduce_attn_out_s1_l1 -->
<g id="node51" class="node">
<title>allreduce_attn_out_s1_l1</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-17338.02" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-17349.62" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L1</text>
<text text-anchor="middle" x="2982.5" y="-17340.62" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17331.62" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17322.62" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1_l1&#45;&gt;allreduce_attn_out_s1_l1 -->
<g id="edge81" class="edge">
<title>attn_out_proj_s1_l1&#45;&gt;allreduce_attn_out_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-17405.04C2982.5,-17397.37 2982.5,-17388.42 2982.5,-17379.62"/>
<polygon fill="black" stroke="black" points="2986,-17379.46 2982.5,-17369.46 2979,-17379.46 2986,-17379.46"/>
</g>
<!-- moe_gate_s1_l1 -->
<g id="node52" class="node">
<title>moe_gate_s1_l1</title>
<polygon fill="orange" stroke="black" points="3167.08,-17270.9 2873.45,-17270.9 2797.92,-17182.9 3091.55,-17182.9 3167.08,-17270.9"/>
<text text-anchor="middle" x="2982.5" y="-17238.5" font-family="Arial" font-size="8.00">MoE Gate L1 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-17229.5" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17220.5" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17211.5" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1_l1&#45;&gt;moe_gate_s1_l1 -->
<g id="edge82" class="edge">
<title>allreduce_attn_out_s1_l1&#45;&gt;moe_gate_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-17306.62C2982.5,-17298.74 2982.5,-17290.01 2982.5,-17281.32"/>
<polygon fill="black" stroke="black" points="2986,-17281.18 2982.5,-17271.18 2979,-17281.18 2986,-17281.18"/>
</g>
<!-- expert_dispatch_s1_l1 -->
<g id="node53" class="node">
<title>expert_dispatch_s1_l1</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-17115.79" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-17127.39" font-family="Arial" font-size="8.00">Expert Dispatch L1 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-17118.39" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17109.39" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-17100.39" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1_l1&#45;&gt;expert_dispatch_s1_l1 -->
<g id="edge83" class="edge">
<title>moe_gate_s1_l1&#45;&gt;expert_dispatch_s1_l1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-17182.78C2982.5,-17174.4 2982.5,-17165.65 2982.5,-17157.36"/>
<polygon fill="black" stroke="black" points="2986,-17157.17 2982.5,-17147.17 2979,-17157.17 2986,-17157.17"/>
</g>
<!-- expert_0_s1_l1 -->
<g id="node54" class="node">
<title>expert_0_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="169,-17048.68 0,-17048.68 0,-17004.68 169,-17004.68 169,-17048.68"/>
<text text-anchor="middle" x="84.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 0 L1</text>
<text text-anchor="middle" x="84.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_0_s1_l1 -->
<g id="edge84" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_0_s1_l1</title>
<path fill="none" stroke="black" d="M2856.42,-17115.14C2385.23,-17115.95 727.13,-17114.03 178.99,-17048.72"/>
<polygon fill="black" stroke="black" points="179.37,-17045.24 169.02,-17047.51 178.53,-17052.19 179.37,-17045.24"/>
</g>
<!-- expert_1_s1_l1 -->
<g id="node55" class="node">
<title>expert_1_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="356,-17048.68 187,-17048.68 187,-17004.68 356,-17004.68 356,-17048.68"/>
<text text-anchor="middle" x="271.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 1 L1</text>
<text text-anchor="middle" x="271.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_1_s1_l1 -->
<g id="edge85" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_1_s1_l1</title>
<path fill="none" stroke="black" d="M2856.36,-17114.89C2405.73,-17114.75 875.66,-17109.75 366.03,-17048.73"/>
<polygon fill="black" stroke="black" points="366.37,-17045.24 356.02,-17047.51 365.52,-17052.19 366.37,-17045.24"/>
</g>
<!-- expert_2_s1_l1 -->
<g id="node56" class="node">
<title>expert_2_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="543,-17048.68 374,-17048.68 374,-17004.68 543,-17004.68 543,-17048.68"/>
<text text-anchor="middle" x="458.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 2 L1</text>
<text text-anchor="middle" x="458.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_2_s1_l1 -->
<g id="edge86" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_2_s1_l1</title>
<path fill="none" stroke="black" d="M2856.51,-17114.61C2427.43,-17113.47 1024.14,-17105.49 552.96,-17048.72"/>
<polygon fill="black" stroke="black" points="553.38,-17045.25 543.02,-17047.5 552.52,-17052.19 553.38,-17045.25"/>
</g>
<!-- expert_3_s1_l1 -->
<g id="node57" class="node">
<title>expert_3_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="730,-17048.68 561,-17048.68 561,-17004.68 730,-17004.68 730,-17048.68"/>
<text text-anchor="middle" x="645.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 3 L1</text>
<text text-anchor="middle" x="645.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_3_s1_l1 -->
<g id="edge87" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_3_s1_l1</title>
<path fill="none" stroke="black" d="M2856.69,-17114.27C2450.07,-17112.1 1173.13,-17101.25 740.1,-17048.74"/>
<polygon fill="black" stroke="black" points="740.38,-17045.25 730.02,-17047.49 739.52,-17052.19 740.38,-17045.25"/>
</g>
<!-- expert_4_s1_l1 -->
<g id="node58" class="node">
<title>expert_4_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="917,-17048.68 748,-17048.68 748,-17004.68 917,-17004.68 917,-17048.68"/>
<text text-anchor="middle" x="832.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 4 L1</text>
<text text-anchor="middle" x="832.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_4_s1_l1 -->
<g id="edge88" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_4_s1_l1</title>
<path fill="none" stroke="black" d="M2856.78,-17113.88C2473.43,-17110.61 1321.87,-17097.02 927.06,-17048.74"/>
<polygon fill="black" stroke="black" points="927.38,-17045.25 917.03,-17047.48 926.51,-17052.2 927.38,-17045.25"/>
</g>
<!-- expert_5_s1_l1 -->
<g id="node59" class="node">
<title>expert_5_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="1104,-17048.68 935,-17048.68 935,-17004.68 1104,-17004.68 1104,-17048.68"/>
<text text-anchor="middle" x="1019.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 5 L1</text>
<text text-anchor="middle" x="1019.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_5_s1_l1 -->
<g id="edge89" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_5_s1_l1</title>
<path fill="none" stroke="black" d="M2856.8,-17113.41C2497.73,-17108.97 1470.88,-17092.81 1114.13,-17048.75"/>
<polygon fill="black" stroke="black" points="1114.39,-17045.25 1104.03,-17047.47 1113.51,-17052.2 1114.39,-17045.25"/>
</g>
<!-- expert_6_s1_l1 -->
<g id="node60" class="node">
<title>expert_6_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="1291,-17048.68 1122,-17048.68 1122,-17004.68 1291,-17004.68 1291,-17048.68"/>
<text text-anchor="middle" x="1206.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 6 L1</text>
<text text-anchor="middle" x="1206.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_6_s1_l1 -->
<g id="edge90" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_6_s1_l1</title>
<path fill="none" stroke="black" d="M2857.17,-17112.84C2523.91,-17107.18 1620.17,-17088.64 1301.21,-17048.76"/>
<polygon fill="black" stroke="black" points="1301.39,-17045.26 1291.03,-17047.46 1300.5,-17052.2 1301.39,-17045.26"/>
</g>
<!-- expert_7_s1_l1 -->
<g id="node61" class="node">
<title>expert_7_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="1478,-17048.68 1309,-17048.68 1309,-17004.68 1478,-17004.68 1478,-17048.68"/>
<text text-anchor="middle" x="1393.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 7 L1</text>
<text text-anchor="middle" x="1393.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_7_s1_l1 -->
<g id="edge91" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_7_s1_l1</title>
<path fill="none" stroke="black" d="M2857.5,-17112.13C2551.41,-17105.16 1769.45,-17084.49 1488.23,-17048.77"/>
<polygon fill="black" stroke="black" points="1488.4,-17045.26 1478.03,-17047.44 1487.49,-17052.2 1488.4,-17045.26"/>
</g>
<!-- expert_8_s1_l1 -->
<g id="node62" class="node">
<title>expert_8_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="1665,-17048.68 1496,-17048.68 1496,-17004.68 1665,-17004.68 1665,-17048.68"/>
<text text-anchor="middle" x="1580.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 8 L1</text>
<text text-anchor="middle" x="1580.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_8_s1_l1 -->
<g id="edge92" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_8_s1_l1</title>
<path fill="none" stroke="black" d="M2856.38,-17115.59C2623.94,-17115.49 2112.47,-17107.92 1675.03,-17048.78"/>
<polygon fill="black" stroke="black" points="1675.42,-17045.3 1665.03,-17047.41 1674.47,-17052.23 1675.42,-17045.3"/>
</g>
<!-- expert_9_s1_l1 -->
<g id="node63" class="node">
<title>expert_9_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="1852,-17048.68 1683,-17048.68 1683,-17004.68 1852,-17004.68 1852,-17048.68"/>
<text text-anchor="middle" x="1767.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 9 L1</text>
<text text-anchor="middle" x="1767.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_9_s1_l1 -->
<g id="edge93" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_9_s1_l1</title>
<path fill="none" stroke="black" d="M2856.48,-17114.05C2650.05,-17111.36 2227.11,-17099.64 1862.01,-17048.78"/>
<polygon fill="black" stroke="black" points="1862.43,-17045.31 1852.04,-17047.38 1861.45,-17052.24 1862.43,-17045.31"/>
</g>
<!-- expert_10_s1_l1 -->
<g id="node64" class="node">
<title>expert_10_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="2039,-17048.68 1870,-17048.68 1870,-17004.68 2039,-17004.68 2039,-17048.68"/>
<text text-anchor="middle" x="1954.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 10 L1</text>
<text text-anchor="middle" x="1954.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_10_s1_l1 -->
<g id="edge94" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_10_s1_l1</title>
<path fill="none" stroke="black" d="M2857.46,-17111.96C2679.53,-17106.59 2343.14,-17091.47 2049.05,-17048.81"/>
<polygon fill="black" stroke="black" points="2049.45,-17045.33 2039.05,-17047.34 2048.43,-17052.25 2049.45,-17045.33"/>
</g>
<!-- expert_11_s1_l1 -->
<g id="node65" class="node">
<title>expert_11_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="2226,-17048.68 2057,-17048.68 2057,-17004.68 2226,-17004.68 2226,-17048.68"/>
<text text-anchor="middle" x="2141.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 11 L1</text>
<text text-anchor="middle" x="2141.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_11_s1_l1 -->
<g id="edge95" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_11_s1_l1</title>
<path fill="none" stroke="black" d="M2859.45,-17108.98C2712.89,-17100.91 2460.66,-17083.39 2236.05,-17048.83"/>
<polygon fill="black" stroke="black" points="2236.47,-17045.35 2226.05,-17047.28 2235.4,-17052.27 2236.47,-17045.35"/>
</g>
<!-- expert_12_s1_l1 -->
<g id="node66" class="node">
<title>expert_12_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="2413,-17048.68 2244,-17048.68 2244,-17004.68 2413,-17004.68 2413,-17048.68"/>
<text text-anchor="middle" x="2328.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 12 L1</text>
<text text-anchor="middle" x="2328.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_12_s1_l1 -->
<g id="edge96" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_12_s1_l1</title>
<path fill="none" stroke="black" d="M2864.87,-17104.55C2753.34,-17094 2580.99,-17075.54 2422.98,-17048.86"/>
<polygon fill="black" stroke="black" points="2423.52,-17045.4 2413.07,-17047.17 2422.34,-17052.3 2423.52,-17045.4"/>
</g>
<!-- expert_13_s1_l1 -->
<g id="node67" class="node">
<title>expert_13_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="2600,-17048.68 2431,-17048.68 2431,-17004.68 2600,-17004.68 2600,-17048.68"/>
<text text-anchor="middle" x="2515.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 13 L1</text>
<text text-anchor="middle" x="2515.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_13_s1_l1 -->
<g id="edge97" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_13_s1_l1</title>
<path fill="none" stroke="black" d="M2879.07,-17097.85C2806.34,-17085.63 2706.53,-17068.22 2610.04,-17048.95"/>
<polygon fill="black" stroke="black" points="2610.6,-17045.5 2600.11,-17046.96 2609.23,-17052.36 2610.6,-17045.5"/>
</g>
<!-- expert_14_s1_l1 -->
<g id="node68" class="node">
<title>expert_14_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="2787,-17048.68 2618,-17048.68 2618,-17004.68 2787,-17004.68 2787,-17048.68"/>
<text text-anchor="middle" x="2702.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 14 L1</text>
<text text-anchor="middle" x="2702.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_14_s1_l1 -->
<g id="edge98" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_14_s1_l1</title>
<path fill="none" stroke="black" d="M2905.99,-17090.99C2866.88,-17078.82 2819.39,-17064.04 2780.12,-17051.83"/>
<polygon fill="black" stroke="black" points="2780.91,-17048.41 2770.32,-17048.78 2778.83,-17055.09 2780.91,-17048.41"/>
</g>
<!-- expert_15_s1_l1 -->
<g id="node69" class="node">
<title>expert_15_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="2974,-17048.68 2805,-17048.68 2805,-17004.68 2974,-17004.68 2974,-17048.68"/>
<text text-anchor="middle" x="2889.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 15 L1</text>
<text text-anchor="middle" x="2889.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_15_s1_l1 -->
<g id="edge99" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_15_s1_l1</title>
<path fill="none" stroke="black" d="M2951.27,-17085.54C2941.01,-17075.93 2929.64,-17065.28 2919.47,-17055.75"/>
<polygon fill="black" stroke="black" points="2921.66,-17053.01 2911.97,-17048.73 2916.88,-17058.12 2921.66,-17053.01"/>
</g>
<!-- expert_16_s1_l1 -->
<g id="node70" class="node">
<title>expert_16_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3161,-17048.68 2992,-17048.68 2992,-17004.68 3161,-17004.68 3161,-17048.68"/>
<text text-anchor="middle" x="3076.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 16 L1</text>
<text text-anchor="middle" x="3076.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_16_s1_l1 -->
<g id="edge100" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_16_s1_l1</title>
<path fill="none" stroke="black" d="M3014.06,-17085.54C3024.43,-17075.93 3035.93,-17065.28 3046.21,-17055.75"/>
<polygon fill="black" stroke="black" points="3048.83,-17058.09 3053.78,-17048.73 3044.07,-17052.96 3048.83,-17058.09"/>
</g>
<!-- expert_17_s1_l1 -->
<g id="node71" class="node">
<title>expert_17_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3348,-17048.68 3179,-17048.68 3179,-17004.68 3348,-17004.68 3348,-17048.68"/>
<text text-anchor="middle" x="3263.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 17 L1</text>
<text text-anchor="middle" x="3263.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_17_s1_l1 -->
<g id="edge101" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_17_s1_l1</title>
<path fill="none" stroke="black" d="M3059.28,-17090.99C3098.53,-17078.82 3146.2,-17064.04 3185.6,-17051.83"/>
<polygon fill="black" stroke="black" points="3186.92,-17055.08 3195.43,-17048.78 3184.84,-17048.4 3186.92,-17055.08"/>
</g>
<!-- expert_18_s1_l1 -->
<g id="node72" class="node">
<title>expert_18_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3535,-17048.68 3366,-17048.68 3366,-17004.68 3535,-17004.68 3535,-17048.68"/>
<text text-anchor="middle" x="3450.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 18 L1</text>
<text text-anchor="middle" x="3450.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_18_s1_l1 -->
<g id="edge102" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_18_s1_l1</title>
<path fill="none" stroke="black" d="M3085.81,-17097.94C3158.76,-17085.72 3259.03,-17068.28 3355.92,-17048.96"/>
<polygon fill="black" stroke="black" points="3356.77,-17052.36 3365.89,-17046.96 3355.4,-17045.5 3356.77,-17052.36"/>
</g>
<!-- expert_19_s1_l1 -->
<g id="node73" class="node">
<title>expert_19_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3722,-17048.68 3553,-17048.68 3553,-17004.68 3722,-17004.68 3722,-17048.68"/>
<text text-anchor="middle" x="3637.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 19 L1</text>
<text text-anchor="middle" x="3637.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_19_s1_l1 -->
<g id="edge103" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_19_s1_l1</title>
<path fill="none" stroke="black" d="M3100.07,-17104.59C3211.79,-17094.05 3384.6,-17075.59 3543,-17048.86"/>
<polygon fill="black" stroke="black" points="3543.66,-17052.3 3552.93,-17047.17 3542.48,-17045.4 3543.66,-17052.3"/>
</g>
<!-- expert_20_s1_l1 -->
<g id="node74" class="node">
<title>expert_20_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3909,-17048.68 3740,-17048.68 3740,-17004.68 3909,-17004.68 3909,-17048.68"/>
<text text-anchor="middle" x="3824.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 20 L1</text>
<text text-anchor="middle" x="3824.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_20_s1_l1 -->
<g id="edge104" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_20_s1_l1</title>
<path fill="none" stroke="black" d="M3105.39,-17109.01C3252.09,-17100.95 3504.87,-17083.45 3729.93,-17048.83"/>
<polygon fill="black" stroke="black" points="3730.6,-17052.27 3739.95,-17047.28 3729.53,-17045.35 3730.6,-17052.27"/>
</g>
<!-- expert_21_s1_l1 -->
<g id="node75" class="node">
<title>expert_21_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="4096,-17048.68 3927,-17048.68 3927,-17004.68 4096,-17004.68 4096,-17048.68"/>
<text text-anchor="middle" x="4011.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 21 L1</text>
<text text-anchor="middle" x="4011.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_21_s1_l1 -->
<g id="edge105" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_21_s1_l1</title>
<path fill="none" stroke="black" d="M3107.68,-17111.97C3285.8,-17106.61 3622.55,-17091.5 3916.94,-17048.81"/>
<polygon fill="black" stroke="black" points="3917.57,-17052.25 3926.96,-17047.34 3916.55,-17045.33 3917.57,-17052.25"/>
</g>
<!-- expert_22_s1_l1 -->
<g id="node76" class="node">
<title>expert_22_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="4283,-17048.68 4114,-17048.68 4114,-17004.68 4283,-17004.68 4283,-17048.68"/>
<text text-anchor="middle" x="4198.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 22 L1</text>
<text text-anchor="middle" x="4198.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_22_s1_l1 -->
<g id="edge106" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_22_s1_l1</title>
<path fill="none" stroke="black" d="M3108.22,-17114.07C3314.67,-17111.4 3738.31,-17099.71 4103.98,-17048.79"/>
<polygon fill="black" stroke="black" points="4104.55,-17052.24 4113.96,-17047.38 4103.57,-17045.31 4104.55,-17052.24"/>
</g>
<!-- expert_23_s1_l1 -->
<g id="node77" class="node">
<title>expert_23_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="4470,-17048.68 4301,-17048.68 4301,-17004.68 4470,-17004.68 4470,-17048.68"/>
<text text-anchor="middle" x="4385.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 23 L1</text>
<text text-anchor="middle" x="4385.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_23_s1_l1 -->
<g id="edge107" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_23_s1_l1</title>
<path fill="none" stroke="black" d="M3108.71,-17115.6C3341.33,-17115.5 3853.2,-17107.95 4290.96,-17048.78"/>
<polygon fill="black" stroke="black" points="4291.53,-17052.23 4300.97,-17047.41 4290.58,-17045.3 4291.53,-17052.23"/>
</g>
<!-- expert_24_s1_l1 -->
<g id="node78" class="node">
<title>expert_24_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="4657,-17048.68 4488,-17048.68 4488,-17004.68 4657,-17004.68 4657,-17048.68"/>
<text text-anchor="middle" x="4572.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 24 L1</text>
<text text-anchor="middle" x="4572.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_24_s1_l1 -->
<g id="edge108" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_24_s1_l1</title>
<path fill="none" stroke="black" d="M3107.58,-17112.13C3413.87,-17105.17 4196.36,-17084.51 4477.77,-17048.77"/>
<polygon fill="black" stroke="black" points="4478.51,-17052.2 4487.97,-17047.44 4477.6,-17045.26 4478.51,-17052.2"/>
</g>
<!-- expert_25_s1_l1 -->
<g id="node79" class="node">
<title>expert_25_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="4844,-17048.68 4675,-17048.68 4675,-17004.68 4844,-17004.68 4844,-17048.68"/>
<text text-anchor="middle" x="4759.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 25 L1</text>
<text text-anchor="middle" x="4759.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_25_s1_l1 -->
<g id="edge109" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_25_s1_l1</title>
<path fill="none" stroke="black" d="M3107.91,-17112.84C3441.37,-17107.18 4345.64,-17088.66 4664.78,-17048.76"/>
<polygon fill="black" stroke="black" points="4665.5,-17052.2 4674.97,-17047.46 4664.61,-17045.26 4665.5,-17052.2"/>
</g>
<!-- expert_26_s1_l1 -->
<g id="node80" class="node">
<title>expert_26_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="5031,-17048.68 4862,-17048.68 4862,-17004.68 5031,-17004.68 5031,-17048.68"/>
<text text-anchor="middle" x="4946.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 26 L1</text>
<text text-anchor="middle" x="4946.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_26_s1_l1 -->
<g id="edge110" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_26_s1_l1</title>
<path fill="none" stroke="black" d="M3108.26,-17113.41C3467.53,-17108.98 4494.93,-17092.83 4851.87,-17048.75"/>
<polygon fill="black" stroke="black" points="4852.49,-17052.2 4861.97,-17047.47 4851.61,-17045.25 4852.49,-17052.2"/>
</g>
<!-- expert_27_s1_l1 -->
<g id="node81" class="node">
<title>expert_27_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="5218,-17048.68 5049,-17048.68 5049,-17004.68 5218,-17004.68 5218,-17048.68"/>
<text text-anchor="middle" x="5133.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 27 L1</text>
<text text-anchor="middle" x="5133.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_27_s1_l1 -->
<g id="edge111" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_27_s1_l1</title>
<path fill="none" stroke="black" d="M3108.28,-17113.88C3491.82,-17110.61 4643.94,-17097.04 5038.93,-17048.74"/>
<polygon fill="black" stroke="black" points="5039.49,-17052.2 5048.97,-17047.48 5038.62,-17045.25 5039.49,-17052.2"/>
</g>
<!-- expert_28_s1_l1 -->
<g id="node82" class="node">
<title>expert_28_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="5405,-17048.68 5236,-17048.68 5236,-17004.68 5405,-17004.68 5405,-17048.68"/>
<text text-anchor="middle" x="5320.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 28 L1</text>
<text text-anchor="middle" x="5320.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_28_s1_l1 -->
<g id="edge112" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_28_s1_l1</title>
<path fill="none" stroke="black" d="M3108.37,-17114.27C3515.16,-17112.11 4792.68,-17101.27 5225.9,-17048.74"/>
<polygon fill="black" stroke="black" points="5226.48,-17052.19 5235.98,-17047.49 5225.62,-17045.25 5226.48,-17052.19"/>
</g>
<!-- expert_29_s1_l1 -->
<g id="node83" class="node">
<title>expert_29_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="5592,-17048.68 5423,-17048.68 5423,-17004.68 5592,-17004.68 5592,-17048.68"/>
<text text-anchor="middle" x="5507.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 29 L1</text>
<text text-anchor="middle" x="5507.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_29_s1_l1 -->
<g id="edge113" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_29_s1_l1</title>
<path fill="none" stroke="black" d="M3108.54,-17114.61C3537.8,-17113.48 4941.67,-17105.51 5413.04,-17048.72"/>
<polygon fill="black" stroke="black" points="5413.48,-17052.19 5422.98,-17047.5 5412.62,-17045.25 5413.48,-17052.19"/>
</g>
<!-- expert_30_s1_l1 -->
<g id="node84" class="node">
<title>expert_30_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="5779,-17048.68 5610,-17048.68 5610,-17004.68 5779,-17004.68 5779,-17048.68"/>
<text text-anchor="middle" x="5694.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 30 L1</text>
<text text-anchor="middle" x="5694.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_30_s1_l1 -->
<g id="edge114" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_30_s1_l1</title>
<path fill="none" stroke="black" d="M3108.69,-17114.9C3559.49,-17114.76 5090.14,-17109.77 5599.96,-17048.73"/>
<polygon fill="black" stroke="black" points="5600.48,-17052.19 5609.98,-17047.51 5599.63,-17045.24 5600.48,-17052.19"/>
</g>
<!-- expert_31_s1_l1 -->
<g id="node85" class="node">
<title>expert_31_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="5966,-17048.68 5797,-17048.68 5797,-17004.68 5966,-17004.68 5966,-17048.68"/>
<text text-anchor="middle" x="5881.5" y="-17038.28" font-family="Arial" font-size="8.00">Expert 31 L1</text>
<text text-anchor="middle" x="5881.5" y="-17029.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-17020.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-17011.28" font-family="Arial" font-size="8.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1_l1&#45;&gt;expert_31_s1_l1 -->
<g id="edge115" class="edge">
<title>expert_dispatch_s1_l1&#45;&gt;expert_31_s1_l1</title>
<path fill="none" stroke="black" d="M3108.62,-17115.15C3579.98,-17115.95 5238.67,-17114.05 5787,-17048.72"/>
<polygon fill="black" stroke="black" points="5787.47,-17052.19 5796.98,-17047.51 5786.63,-17045.24 5787.47,-17052.19"/>
</g>
<!-- expert_combine_s1_l1 -->
<g id="node86" class="node">
<title>expert_combine_s1_l1</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-16937.57" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-16949.17" font-family="Arial" font-size="8.00">Expert Combine L1 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-16940.17" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-16931.17" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16922.17" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge116" class="edge">
<title>expert_0_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M169.02,-17005.85C171.88,-17005.42 174.71,-17005.02 177.5,-17004.68 702.97,-16939.81 2358.67,-16937.44 2846.17,-16938.2"/>
<polygon fill="black" stroke="black" points="2846.42,-16941.7 2856.42,-16938.21 2846.43,-16934.7 2846.42,-16941.7"/>
</g>
<!-- expert_1_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge117" class="edge">
<title>expert_1_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M356.02,-17005.85C358.88,-17005.42 361.71,-17005.03 364.5,-17004.68 851.71,-16944.12 2380.13,-16938.69 2846.21,-16938.47"/>
<polygon fill="black" stroke="black" points="2846.36,-16941.97 2856.36,-16938.46 2846.36,-16934.97 2846.36,-16941.97"/>
</g>
<!-- expert_2_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge118" class="edge">
<title>expert_2_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M543.02,-17005.86C545.88,-17005.43 548.71,-17005.03 551.5,-17004.68 1000.54,-16948.42 2402.24,-16940.02 2846.2,-16938.78"/>
<polygon fill="black" stroke="black" points="2846.52,-16942.28 2856.51,-16938.75 2846.5,-16935.28 2846.52,-16942.28"/>
</g>
<!-- expert_3_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge119" class="edge">
<title>expert_3_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M730.02,-17005.87C732.88,-17005.43 735.71,-17005.03 738.5,-17004.68 1149.63,-16952.7 2426.08,-16941.46 2846.61,-16939.14"/>
<polygon fill="black" stroke="black" points="2846.7,-16942.64 2856.69,-16939.09 2846.67,-16935.64 2846.7,-16942.64"/>
</g>
<!-- expert_4_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge120" class="edge">
<title>expert_4_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M917.03,-17005.88C919.88,-17005.44 922.71,-17005.04 925.5,-17004.68 1298.74,-16956.98 2450.22,-16943.02 2846.7,-16939.57"/>
<polygon fill="black" stroke="black" points="2846.81,-16943.07 2856.78,-16939.48 2846.75,-16936.07 2846.81,-16943.07"/>
</g>
<!-- expert_5_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge121" class="edge">
<title>expert_5_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M1104.03,-17005.89C1106.88,-17005.45 1109.71,-17005.04 1112.5,-17004.68 1447.94,-16961.26 2474.98,-16944.74 2846.54,-16940.08"/>
<polygon fill="black" stroke="black" points="2846.85,-16943.57 2856.8,-16939.95 2846.76,-16936.58 2846.85,-16943.57"/>
</g>
<!-- expert_6_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge122" class="edge">
<title>expert_6_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M1291.03,-17005.9C1293.88,-17005.46 1296.71,-17005.05 1299.5,-17004.68 1597.53,-16965.51 2502.38,-16946.61 2847.13,-16940.69"/>
<polygon fill="black" stroke="black" points="2847.23,-16944.19 2857.17,-16940.52 2847.11,-16937.19 2847.23,-16944.19"/>
</g>
<!-- expert_7_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge123" class="edge">
<title>expert_7_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M1478.03,-17005.92C1480.88,-17005.47 1483.71,-17005.05 1486.5,-17004.68 1747.22,-16969.76 2530.56,-16948.74 2847.35,-16941.46"/>
<polygon fill="black" stroke="black" points="2847.58,-16944.95 2857.5,-16941.23 2847.42,-16937.96 2847.58,-16944.95"/>
</g>
<!-- expert_8_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge124" class="edge">
<title>expert_8_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M1665.03,-17005.94C1667.88,-17005.49 1670.71,-17005.06 1673.5,-17004.68 2098.54,-16946.4 2607.53,-16938.1 2846.26,-16937.78"/>
<polygon fill="black" stroke="black" points="2846.39,-16941.28 2856.38,-16937.77 2846.38,-16934.28 2846.39,-16941.28"/>
</g>
<!-- expert_9_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge125" class="edge">
<title>expert_9_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M1852.04,-17005.98C1854.89,-17005.51 1857.71,-17005.07 1860.5,-17004.68 2213.6,-16954.75 2634.37,-16942.42 2846.24,-16939.44"/>
<polygon fill="black" stroke="black" points="2846.52,-16942.94 2856.48,-16939.31 2846.43,-16935.94 2846.52,-16942.94"/>
</g>
<!-- expert_10_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge126" class="edge">
<title>expert_10_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M2039.05,-17006.02C2041.89,-17005.54 2044.72,-17005.09 2047.5,-17004.68 2330.13,-16963.02 2664.83,-16947.41 2847.27,-16941.71"/>
<polygon fill="black" stroke="black" points="2847.57,-16945.2 2857.46,-16941.4 2847.35,-16938.2 2847.57,-16945.2"/>
</g>
<!-- expert_11_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge127" class="edge">
<title>expert_11_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M2226.05,-17006.08C2228.9,-17005.58 2231.72,-17005.11 2234.5,-17004.68 2448.23,-16971.26 2699.16,-16953.39 2849.26,-16944.95"/>
<polygon fill="black" stroke="black" points="2849.66,-16948.43 2859.45,-16944.38 2849.27,-16941.44 2849.66,-16948.43"/>
</g>
<!-- expert_12_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge128" class="edge">
<title>expert_12_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M2413.07,-17006.19C2415.91,-17005.66 2418.73,-17005.15 2421.5,-17004.68 2569.28,-16979.36 2740.64,-16960.7 2854.7,-16949.78"/>
<polygon fill="black" stroke="black" points="2855.24,-16953.24 2864.87,-16948.81 2854.58,-16946.28 2855.24,-16953.24"/>
</g>
<!-- expert_13_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge129" class="edge">
<title>expert_13_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M2600.11,-17006.4C2602.94,-17005.81 2605.74,-17005.23 2608.5,-17004.68 2695.55,-16987.17 2794.51,-16969.78 2868.76,-16957.24"/>
<polygon fill="black" stroke="black" points="2869.79,-16960.62 2879.07,-16955.5 2868.63,-16953.71 2869.79,-16960.62"/>
</g>
<!-- expert_14_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge130" class="edge">
<title>expert_14_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M2770.28,-17004.59C2808.19,-16992.8 2855.83,-16977.98 2896.36,-16965.37"/>
<polygon fill="black" stroke="black" points="2897.45,-16968.69 2905.96,-16962.38 2895.37,-16962.01 2897.45,-16968.69"/>
</g>
<!-- expert_15_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge131" class="edge">
<title>expert_15_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M2912.01,-17004.59C2921.53,-16995.67 2932.9,-16985.02 2943.7,-16974.91"/>
<polygon fill="black" stroke="black" points="2946.15,-16977.41 2951.06,-16968.02 2941.37,-16972.3 2946.15,-16977.41"/>
</g>
<!-- expert_16_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge132" class="edge">
<title>expert_16_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M3053.75,-17004.59C3044.12,-16995.67 3032.63,-16985.02 3021.71,-16974.91"/>
<polygon fill="black" stroke="black" points="3023.99,-16972.25 3014.28,-16968.02 3019.23,-16977.38 3023.99,-16972.25"/>
</g>
<!-- expert_17_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge133" class="edge">
<title>expert_17_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M3195.48,-17004.59C3157.36,-16992.77 3109.44,-16977.92 3068.71,-16965.29"/>
<polygon fill="black" stroke="black" points="3069.65,-16961.92 3059.06,-16962.3 3067.58,-16968.61 3069.65,-16961.92"/>
</g>
<!-- expert_18_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge134" class="edge">
<title>expert_18_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M3365.89,-17006.39C3363.06,-17005.81 3360.26,-17005.23 3357.5,-17004.68 3269.89,-16987.07 3170.24,-16969.63 3095.69,-16957.08"/>
<polygon fill="black" stroke="black" points="3096.25,-16953.63 3085.81,-16955.42 3095.09,-16960.53 3096.25,-16953.63"/>
</g>
<!-- expert_19_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge135" class="edge">
<title>expert_19_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M3552.93,-17006.19C3550.09,-17005.66 3547.27,-17005.15 3544.5,-17004.68 3396.34,-16979.31 3224.52,-16960.65 3110.26,-16949.74"/>
<polygon fill="black" stroke="black" points="3110.36,-16946.23 3100.07,-16948.77 3109.69,-16953.2 3110.36,-16946.23"/>
</g>
<!-- expert_20_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge136" class="edge">
<title>expert_20_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M3739.95,-17006.08C3737.1,-17005.58 3734.28,-17005.11 3731.5,-17004.68 3517.33,-16971.2 3265.85,-16953.34 3115.58,-16944.92"/>
<polygon fill="black" stroke="black" points="3115.57,-16941.41 3105.39,-16944.35 3115.18,-16948.4 3115.57,-16941.41"/>
</g>
<!-- expert_21_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge137" class="edge">
<title>expert_21_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M3926.96,-17006.02C3924.11,-17005.54 3921.28,-17005.09 3918.5,-17004.68 3635.57,-16962.99 3300.51,-16947.39 3117.87,-16941.7"/>
<polygon fill="black" stroke="black" points="3117.78,-16938.19 3107.68,-16941.39 3117.57,-16945.19 3117.78,-16938.19"/>
</g>
<!-- expert_22_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge138" class="edge">
<title>expert_22_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M4113.96,-17005.97C4111.11,-17005.51 4108.29,-17005.07 4105.5,-17004.68 3751.85,-16954.68 3330.37,-16942.38 3118.46,-16939.43"/>
<polygon fill="black" stroke="black" points="3118.26,-16935.93 3108.22,-16939.29 3118.17,-16942.93 3118.26,-16935.93"/>
</g>
<!-- expert_23_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge139" class="edge">
<title>expert_23_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M4300.97,-17005.94C4298.12,-17005.49 4295.29,-17005.06 4292.5,-17004.68 3867.13,-16946.36 3357.75,-16938.08 3118.84,-16937.77"/>
<polygon fill="black" stroke="black" points="3118.72,-16934.27 3108.71,-16937.76 3118.71,-16941.27 3118.72,-16934.27"/>
</g>
<!-- expert_24_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge140" class="edge">
<title>expert_24_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M4487.97,-17005.92C4485.12,-17005.47 4482.29,-17005.05 4479.5,-17004.68 4218.6,-16969.75 3434.74,-16948.73 3117.74,-16941.46"/>
<polygon fill="black" stroke="black" points="3117.66,-16937.95 3107.58,-16941.22 3117.5,-16944.95 3117.66,-16937.95"/>
</g>
<!-- expert_25_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge141" class="edge">
<title>expert_25_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M4674.97,-17005.9C4672.12,-17005.46 4669.29,-17005.05 4666.5,-17004.68 4368.29,-16965.49 3462.9,-16946.61 3117.95,-16940.69"/>
<polygon fill="black" stroke="black" points="3117.97,-16937.19 3107.91,-16940.52 3117.85,-16944.19 3117.97,-16937.19"/>
</g>
<!-- expert_26_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge142" class="edge">
<title>expert_26_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M4861.97,-17005.89C4859.12,-17005.45 4856.29,-17005.04 4853.5,-17004.68 4517.88,-16961.24 3490.29,-16944.73 3118.53,-16940.08"/>
<polygon fill="black" stroke="black" points="3118.31,-16936.57 3108.26,-16939.95 3118.22,-16943.57 3118.31,-16936.57"/>
</g>
<!-- expert_27_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge143" class="edge">
<title>expert_27_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M5048.97,-17005.88C5046.12,-17005.44 5043.29,-17005.04 5040.5,-17004.68 4667.07,-16956.96 3515.04,-16943.01 3118.36,-16939.56"/>
<polygon fill="black" stroke="black" points="3118.31,-16936.06 3108.28,-16939.48 3118.25,-16943.06 3118.31,-16936.06"/>
</g>
<!-- expert_28_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge144" class="edge">
<title>expert_28_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M5235.98,-17005.87C5233.12,-17005.43 5230.29,-17005.03 5227.5,-17004.68 4816.19,-16952.68 3539.17,-16941.45 3118.45,-16939.14"/>
<polygon fill="black" stroke="black" points="3118.39,-16935.64 3108.37,-16939.08 3118.35,-16942.64 3118.39,-16935.64"/>
</g>
<!-- expert_29_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge145" class="edge">
<title>expert_29_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M5422.98,-17005.86C5420.12,-17005.43 5417.29,-17005.03 5414.5,-17004.68 4965.28,-16948.4 3563,-16940.02 3118.86,-16938.78"/>
<polygon fill="black" stroke="black" points="3118.55,-16935.28 3108.54,-16938.75 3118.53,-16942.28 3118.55,-16935.28"/>
</g>
<!-- expert_30_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge146" class="edge">
<title>expert_30_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M5609.98,-17005.85C5607.12,-17005.42 5604.29,-17005.03 5601.5,-17004.68 5114.1,-16944.1 3585.1,-16938.68 3118.84,-16938.47"/>
<polygon fill="black" stroke="black" points="3118.69,-16934.97 3108.69,-16938.46 3118.69,-16941.97 3118.69,-16934.97"/>
</g>
<!-- expert_31_s1_l1&#45;&gt;expert_combine_s1_l1 -->
<g id="edge147" class="edge">
<title>expert_31_s1_l1&#45;&gt;expert_combine_s1_l1</title>
<path fill="none" stroke="black" d="M5796.98,-17005.85C5794.12,-17005.42 5791.29,-17005.02 5788.5,-17004.68 5262.84,-16939.79 3606.55,-16937.43 3118.88,-16938.2"/>
<polygon fill="black" stroke="black" points="3118.62,-16934.7 3108.62,-16938.21 3118.63,-16941.7 3118.62,-16934.7"/>
</g>
<!-- moe_out_proj_s1_l1 -->
<g id="node87" class="node">
<title>moe_out_proj_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-16870.45 2893.5,-16870.45 2893.5,-16826.45 3071.5,-16826.45 3071.5,-16870.45"/>
<text text-anchor="middle" x="2982.5" y="-16860.05" font-family="Arial" font-size="8.00">MoE Output Proj L1 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-16851.05" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16842.05" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16833.05" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1_l1&#45;&gt;moe_out_proj_s1_l1 -->
<g id="edge148" class="edge">
<title>expert_combine_s1_l1&#45;&gt;moe_out_proj_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-16906.1C2982.5,-16897.82 2982.5,-16888.84 2982.5,-16880.53"/>
<polygon fill="black" stroke="black" points="2986,-16880.46 2982.5,-16870.46 2979,-16880.46 2986,-16880.46"/>
</g>
<!-- allreduce_moe_out_s1_l1 -->
<g id="node88" class="node">
<title>allreduce_moe_out_s1_l1</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-16759.34" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-16770.94" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L1</text>
<text text-anchor="middle" x="2982.5" y="-16761.94" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16752.94" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16743.94" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1_l1&#45;&gt;allreduce_moe_out_s1_l1 -->
<g id="edge149" class="edge">
<title>moe_out_proj_s1_l1&#45;&gt;allreduce_moe_out_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-16826.37C2982.5,-16818.69 2982.5,-16809.74 2982.5,-16800.95"/>
<polygon fill="black" stroke="black" points="2986,-16800.79 2982.5,-16790.79 2979,-16800.79 2986,-16800.79"/>
</g>
<!-- layernorm2_s1_l1 -->
<g id="node89" class="node">
<title>layernorm2_s1_l1</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-16692.23 2893.5,-16692.23 2893.5,-16648.23 3071.5,-16648.23 3071.5,-16692.23"/>
<text text-anchor="middle" x="2982.5" y="-16681.83" font-family="Arial" font-size="8.00">LayerNorm 2 (L1)</text>
<text text-anchor="middle" x="2982.5" y="-16672.83" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16663.83" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16654.83" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1_l1&#45;&gt;layernorm2_s1_l1 -->
<g id="edge150" class="edge">
<title>allreduce_moe_out_s1_l1&#45;&gt;layernorm2_s1_l1</title>
<path fill="none" stroke="black" d="M2982.5,-16727.87C2982.5,-16719.59 2982.5,-16710.62 2982.5,-16702.31"/>
<polygon fill="black" stroke="black" points="2986,-16702.23 2982.5,-16692.23 2979,-16702.23 2986,-16702.23"/>
</g>
<!-- layernorm1_s1_l2 -->
<g id="node90" class="node">
<title>layernorm1_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-16612.23 2893.5,-16612.23 2893.5,-16568.23 3071.5,-16568.23 3071.5,-16612.23"/>
<text text-anchor="middle" x="2982.5" y="-16601.83" font-family="Arial" font-size="8.00">LayerNorm 1 (L2)</text>
<text text-anchor="middle" x="2982.5" y="-16592.83" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16583.83" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16574.83" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm2_s1_l1&#45;&gt;layernorm1_s1_l2 -->
<g id="edge151" class="edge">
<title>layernorm2_s1_l1&#45;&gt;layernorm1_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-16647.91C2982.5,-16640.03 2982.5,-16630.91 2982.5,-16622.33"/>
<polygon fill="black" stroke="black" points="2986,-16622.25 2982.5,-16612.25 2979,-16622.25 2986,-16622.25"/>
</g>
<!-- qkv_proj_s1_l2 -->
<g id="node91" class="node">
<title>qkv_proj_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3081,-16532.23 2884,-16532.23 2884,-16488.23 3081,-16488.23 3081,-16532.23"/>
<text text-anchor="middle" x="2982.5" y="-16521.83" font-family="Arial" font-size="8.00">QKV Projection L2 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-16512.83" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16503.83" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-16494.83" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1_l2&#45;&gt;qkv_proj_s1_l2 -->
<g id="edge152" class="edge">
<title>layernorm1_s1_l2&#45;&gt;qkv_proj_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-16567.91C2982.5,-16560.03 2982.5,-16550.91 2982.5,-16542.33"/>
<polygon fill="black" stroke="black" points="2986,-16542.25 2982.5,-16532.25 2979,-16542.25 2986,-16542.25"/>
</g>
<!-- allreduce_qkv_s1_l2 -->
<g id="node92" class="node">
<title>allreduce_qkv_s1_l2</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-16421.12" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-16432.72" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L2</text>
<text text-anchor="middle" x="2982.5" y="-16423.72" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-16414.72" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-16405.72" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1_l2&#45;&gt;allreduce_qkv_s1_l2 -->
<g id="edge153" class="edge">
<title>qkv_proj_s1_l2&#45;&gt;allreduce_qkv_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-16488.14C2982.5,-16480.47 2982.5,-16471.51 2982.5,-16462.72"/>
<polygon fill="black" stroke="black" points="2986,-16462.56 2982.5,-16452.56 2979,-16462.56 2986,-16462.56"/>
</g>
<!-- attention_s1_l2 -->
<g id="node93" class="node">
<title>attention_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3081,-16354 2884,-16354 2884,-16310 3081,-16310 3081,-16354"/>
<text text-anchor="middle" x="2982.5" y="-16343.6" font-family="Arial" font-size="8.00">Self&#45;Attention L2</text>
<text text-anchor="middle" x="2982.5" y="-16334.6" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-16325.6" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-16316.6" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1_l2&#45;&gt;attention_s1_l2 -->
<g id="edge154" class="edge">
<title>allreduce_qkv_s1_l2&#45;&gt;attention_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-16389.65C2982.5,-16381.37 2982.5,-16372.39 2982.5,-16364.08"/>
<polygon fill="black" stroke="black" points="2986,-16364.01 2982.5,-16354.01 2979,-16364.01 2986,-16364.01"/>
</g>
<!-- attn_out_proj_s1_l2 -->
<g id="node94" class="node">
<title>attn_out_proj_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3078,-16274 2887,-16274 2887,-16230 3078,-16230 3078,-16274"/>
<text text-anchor="middle" x="2982.5" y="-16263.6" font-family="Arial" font-size="8.00">Attention Output Proj L2 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-16254.6" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-16245.6" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16236.6" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1_l2&#45;&gt;attn_out_proj_s1_l2 -->
<g id="edge155" class="edge">
<title>attention_s1_l2&#45;&gt;attn_out_proj_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-16309.69C2982.5,-16301.8 2982.5,-16292.69 2982.5,-16284.11"/>
<polygon fill="black" stroke="black" points="2986,-16284.02 2982.5,-16274.02 2979,-16284.02 2986,-16284.02"/>
</g>
<!-- allreduce_attn_out_s1_l2 -->
<g id="node95" class="node">
<title>allreduce_attn_out_s1_l2</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-16162.89" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-16174.49" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L2</text>
<text text-anchor="middle" x="2982.5" y="-16165.49" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16156.49" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16147.49" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1_l2&#45;&gt;allreduce_attn_out_s1_l2 -->
<g id="edge156" class="edge">
<title>attn_out_proj_s1_l2&#45;&gt;allreduce_attn_out_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-16229.92C2982.5,-16222.24 2982.5,-16213.29 2982.5,-16204.5"/>
<polygon fill="black" stroke="black" points="2986,-16204.34 2982.5,-16194.34 2979,-16204.34 2986,-16204.34"/>
</g>
<!-- moe_gate_s1_l2 -->
<g id="node96" class="node">
<title>moe_gate_s1_l2</title>
<polygon fill="orange" stroke="black" points="3167.08,-16095.78 2873.45,-16095.78 2797.92,-16007.78 3091.55,-16007.78 3167.08,-16095.78"/>
<text text-anchor="middle" x="2982.5" y="-16063.38" font-family="Arial" font-size="8.00">MoE Gate L2 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-16054.38" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16045.38" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-16036.38" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1_l2&#45;&gt;moe_gate_s1_l2 -->
<g id="edge157" class="edge">
<title>allreduce_attn_out_s1_l2&#45;&gt;moe_gate_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-16131.5C2982.5,-16123.61 2982.5,-16114.88 2982.5,-16106.19"/>
<polygon fill="black" stroke="black" points="2986,-16106.06 2982.5,-16096.06 2979,-16106.06 2986,-16106.06"/>
</g>
<!-- expert_dispatch_s1_l2 -->
<g id="node97" class="node">
<title>expert_dispatch_s1_l2</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-15940.67" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-15952.27" font-family="Arial" font-size="8.00">Expert Dispatch L2 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-15943.27" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15934.27" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15925.27" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1_l2&#45;&gt;expert_dispatch_s1_l2 -->
<g id="edge158" class="edge">
<title>moe_gate_s1_l2&#45;&gt;expert_dispatch_s1_l2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-16007.65C2982.5,-15999.28 2982.5,-15990.52 2982.5,-15982.23"/>
<polygon fill="black" stroke="black" points="2986,-15982.04 2982.5,-15972.04 2979,-15982.04 2986,-15982.04"/>
</g>
<!-- expert_0_s1_l2 -->
<g id="node98" class="node">
<title>expert_0_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="169,-15873.55 0,-15873.55 0,-15829.55 169,-15829.55 169,-15873.55"/>
<text text-anchor="middle" x="84.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 0 L2</text>
<text text-anchor="middle" x="84.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_0_s1_l2 -->
<g id="edge159" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_0_s1_l2</title>
<path fill="none" stroke="black" d="M2856.42,-15940.02C2385.23,-15940.82 727.13,-15938.91 178.99,-15873.6"/>
<polygon fill="black" stroke="black" points="179.37,-15870.12 169.02,-15872.39 178.53,-15877.06 179.37,-15870.12"/>
</g>
<!-- expert_1_s1_l2 -->
<g id="node99" class="node">
<title>expert_1_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="356,-15873.55 187,-15873.55 187,-15829.55 356,-15829.55 356,-15873.55"/>
<text text-anchor="middle" x="271.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 1 L2</text>
<text text-anchor="middle" x="271.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_1_s1_l2 -->
<g id="edge160" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_1_s1_l2</title>
<path fill="none" stroke="black" d="M2856.36,-15939.77C2405.73,-15939.62 875.66,-15934.63 366.03,-15873.6"/>
<polygon fill="black" stroke="black" points="366.37,-15870.12 356.02,-15872.38 365.52,-15877.07 366.37,-15870.12"/>
</g>
<!-- expert_2_s1_l2 -->
<g id="node100" class="node">
<title>expert_2_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="543,-15873.55 374,-15873.55 374,-15829.55 543,-15829.55 543,-15873.55"/>
<text text-anchor="middle" x="458.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 2 L2</text>
<text text-anchor="middle" x="458.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_2_s1_l2 -->
<g id="edge161" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_2_s1_l2</title>
<path fill="none" stroke="black" d="M2856.51,-15939.48C2427.43,-15938.35 1024.14,-15930.37 552.96,-15873.59"/>
<polygon fill="black" stroke="black" points="553.38,-15870.12 543.02,-15872.37 552.52,-15877.07 553.38,-15870.12"/>
</g>
<!-- expert_3_s1_l2 -->
<g id="node101" class="node">
<title>expert_3_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="730,-15873.55 561,-15873.55 561,-15829.55 730,-15829.55 730,-15873.55"/>
<text text-anchor="middle" x="645.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 3 L2</text>
<text text-anchor="middle" x="645.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_3_s1_l2 -->
<g id="edge162" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_3_s1_l2</title>
<path fill="none" stroke="black" d="M2856.69,-15939.15C2450.07,-15936.97 1173.13,-15926.13 740.1,-15873.61"/>
<polygon fill="black" stroke="black" points="740.38,-15870.12 730.02,-15872.36 739.52,-15877.07 740.38,-15870.12"/>
</g>
<!-- expert_4_s1_l2 -->
<g id="node102" class="node">
<title>expert_4_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="917,-15873.55 748,-15873.55 748,-15829.55 917,-15829.55 917,-15873.55"/>
<text text-anchor="middle" x="832.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 4 L2</text>
<text text-anchor="middle" x="832.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_4_s1_l2 -->
<g id="edge163" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_4_s1_l2</title>
<path fill="none" stroke="black" d="M2856.78,-15938.75C2473.43,-15935.48 1321.87,-15921.9 927.06,-15873.61"/>
<polygon fill="black" stroke="black" points="927.38,-15870.12 917.03,-15872.35 926.51,-15877.07 927.38,-15870.12"/>
</g>
<!-- expert_5_s1_l2 -->
<g id="node103" class="node">
<title>expert_5_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="1104,-15873.55 935,-15873.55 935,-15829.55 1104,-15829.55 1104,-15873.55"/>
<text text-anchor="middle" x="1019.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 5 L2</text>
<text text-anchor="middle" x="1019.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_5_s1_l2 -->
<g id="edge164" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_5_s1_l2</title>
<path fill="none" stroke="black" d="M2856.8,-15938.28C2497.73,-15933.85 1470.88,-15917.69 1114.13,-15873.62"/>
<polygon fill="black" stroke="black" points="1114.39,-15870.13 1104.03,-15872.34 1113.51,-15877.07 1114.39,-15870.13"/>
</g>
<!-- expert_6_s1_l2 -->
<g id="node104" class="node">
<title>expert_6_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="1291,-15873.55 1122,-15873.55 1122,-15829.55 1291,-15829.55 1291,-15873.55"/>
<text text-anchor="middle" x="1206.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 6 L2</text>
<text text-anchor="middle" x="1206.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_6_s1_l2 -->
<g id="edge165" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_6_s1_l2</title>
<path fill="none" stroke="black" d="M2857.17,-15937.71C2523.91,-15932.05 1620.17,-15913.51 1301.21,-15873.63"/>
<polygon fill="black" stroke="black" points="1301.39,-15870.13 1291.03,-15872.33 1300.5,-15877.07 1301.39,-15870.13"/>
</g>
<!-- expert_7_s1_l2 -->
<g id="node105" class="node">
<title>expert_7_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="1478,-15873.55 1309,-15873.55 1309,-15829.55 1478,-15829.55 1478,-15873.55"/>
<text text-anchor="middle" x="1393.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 7 L2</text>
<text text-anchor="middle" x="1393.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_7_s1_l2 -->
<g id="edge166" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_7_s1_l2</title>
<path fill="none" stroke="black" d="M2857.5,-15937.01C2551.41,-15930.04 1769.45,-15909.36 1488.23,-15873.64"/>
<polygon fill="black" stroke="black" points="1488.4,-15870.13 1478.03,-15872.31 1487.49,-15877.08 1488.4,-15870.13"/>
</g>
<!-- expert_8_s1_l2 -->
<g id="node106" class="node">
<title>expert_8_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="1665,-15873.55 1496,-15873.55 1496,-15829.55 1665,-15829.55 1665,-15873.55"/>
<text text-anchor="middle" x="1580.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 8 L2</text>
<text text-anchor="middle" x="1580.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_8_s1_l2 -->
<g id="edge167" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_8_s1_l2</title>
<path fill="none" stroke="black" d="M2856.38,-15940.46C2623.94,-15940.36 2112.47,-15932.79 1675.03,-15873.65"/>
<polygon fill="black" stroke="black" points="1675.42,-15870.17 1665.03,-15872.29 1674.47,-15877.11 1675.42,-15870.17"/>
</g>
<!-- expert_9_s1_l2 -->
<g id="node107" class="node">
<title>expert_9_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="1852,-15873.55 1683,-15873.55 1683,-15829.55 1852,-15829.55 1852,-15873.55"/>
<text text-anchor="middle" x="1767.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 9 L2</text>
<text text-anchor="middle" x="1767.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_9_s1_l2 -->
<g id="edge168" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_9_s1_l2</title>
<path fill="none" stroke="black" d="M2856.48,-15938.93C2650.05,-15936.23 2227.11,-15924.51 1862.01,-15873.66"/>
<polygon fill="black" stroke="black" points="1862.43,-15870.18 1852.04,-15872.26 1861.45,-15877.11 1862.43,-15870.18"/>
</g>
<!-- expert_10_s1_l2 -->
<g id="node108" class="node">
<title>expert_10_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="2039,-15873.55 1870,-15873.55 1870,-15829.55 2039,-15829.55 2039,-15873.55"/>
<text text-anchor="middle" x="1954.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 10 L2</text>
<text text-anchor="middle" x="1954.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_10_s1_l2 -->
<g id="edge169" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_10_s1_l2</title>
<path fill="none" stroke="black" d="M2857.46,-15936.84C2679.53,-15931.47 2343.14,-15916.34 2049.05,-15873.68"/>
<polygon fill="black" stroke="black" points="2049.45,-15870.2 2039.05,-15872.21 2048.43,-15877.13 2049.45,-15870.2"/>
</g>
<!-- expert_11_s1_l2 -->
<g id="node109" class="node">
<title>expert_11_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="2226,-15873.55 2057,-15873.55 2057,-15829.55 2226,-15829.55 2226,-15873.55"/>
<text text-anchor="middle" x="2141.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 11 L2</text>
<text text-anchor="middle" x="2141.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_11_s1_l2 -->
<g id="edge170" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_11_s1_l2</title>
<path fill="none" stroke="black" d="M2859.45,-15933.85C2712.89,-15925.78 2460.66,-15908.27 2236.05,-15873.7"/>
<polygon fill="black" stroke="black" points="2236.47,-15870.23 2226.05,-15872.15 2235.4,-15877.14 2236.47,-15870.23"/>
</g>
<!-- expert_12_s1_l2 -->
<g id="node110" class="node">
<title>expert_12_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="2413,-15873.55 2244,-15873.55 2244,-15829.55 2413,-15829.55 2413,-15873.55"/>
<text text-anchor="middle" x="2328.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 12 L2</text>
<text text-anchor="middle" x="2328.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_12_s1_l2 -->
<g id="edge171" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_12_s1_l2</title>
<path fill="none" stroke="black" d="M2864.87,-15929.42C2753.34,-15918.87 2580.99,-15900.41 2422.98,-15873.73"/>
<polygon fill="black" stroke="black" points="2423.52,-15870.27 2413.07,-15872.04 2422.34,-15877.17 2423.52,-15870.27"/>
</g>
<!-- expert_13_s1_l2 -->
<g id="node111" class="node">
<title>expert_13_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="2600,-15873.55 2431,-15873.55 2431,-15829.55 2600,-15829.55 2600,-15873.55"/>
<text text-anchor="middle" x="2515.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 13 L2</text>
<text text-anchor="middle" x="2515.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_13_s1_l2 -->
<g id="edge172" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_13_s1_l2</title>
<path fill="none" stroke="black" d="M2879.07,-15922.73C2806.34,-15910.5 2706.53,-15893.09 2610.04,-15873.83"/>
<polygon fill="black" stroke="black" points="2610.6,-15870.37 2600.11,-15871.84 2609.23,-15877.23 2610.6,-15870.37"/>
</g>
<!-- expert_14_s1_l2 -->
<g id="node112" class="node">
<title>expert_14_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="2787,-15873.55 2618,-15873.55 2618,-15829.55 2787,-15829.55 2787,-15873.55"/>
<text text-anchor="middle" x="2702.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 14 L2</text>
<text text-anchor="middle" x="2702.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_14_s1_l2 -->
<g id="edge173" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_14_s1_l2</title>
<path fill="none" stroke="black" d="M2905.99,-15915.86C2866.88,-15903.69 2819.39,-15888.92 2780.12,-15876.7"/>
<polygon fill="black" stroke="black" points="2780.91,-15873.28 2770.32,-15873.65 2778.83,-15879.97 2780.91,-15873.28"/>
</g>
<!-- expert_15_s1_l2 -->
<g id="node113" class="node">
<title>expert_15_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="2974,-15873.55 2805,-15873.55 2805,-15829.55 2974,-15829.55 2974,-15873.55"/>
<text text-anchor="middle" x="2889.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 15 L2</text>
<text text-anchor="middle" x="2889.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_15_s1_l2 -->
<g id="edge174" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_15_s1_l2</title>
<path fill="none" stroke="black" d="M2951.27,-15910.42C2941.01,-15900.8 2929.64,-15890.15 2919.47,-15880.63"/>
<polygon fill="black" stroke="black" points="2921.66,-15877.89 2911.97,-15873.6 2916.88,-15882.99 2921.66,-15877.89"/>
</g>
<!-- expert_16_s1_l2 -->
<g id="node114" class="node">
<title>expert_16_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3161,-15873.55 2992,-15873.55 2992,-15829.55 3161,-15829.55 3161,-15873.55"/>
<text text-anchor="middle" x="3076.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 16 L2</text>
<text text-anchor="middle" x="3076.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_16_s1_l2 -->
<g id="edge175" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_16_s1_l2</title>
<path fill="none" stroke="black" d="M3014.06,-15910.42C3024.43,-15900.8 3035.93,-15890.15 3046.21,-15880.63"/>
<polygon fill="black" stroke="black" points="3048.83,-15882.97 3053.78,-15873.6 3044.07,-15877.83 3048.83,-15882.97"/>
</g>
<!-- expert_17_s1_l2 -->
<g id="node115" class="node">
<title>expert_17_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3348,-15873.55 3179,-15873.55 3179,-15829.55 3348,-15829.55 3348,-15873.55"/>
<text text-anchor="middle" x="3263.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 17 L2</text>
<text text-anchor="middle" x="3263.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_17_s1_l2 -->
<g id="edge176" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_17_s1_l2</title>
<path fill="none" stroke="black" d="M3059.28,-15915.86C3098.53,-15903.69 3146.2,-15888.92 3185.6,-15876.7"/>
<polygon fill="black" stroke="black" points="3186.92,-15879.96 3195.43,-15873.65 3184.84,-15873.27 3186.92,-15879.96"/>
</g>
<!-- expert_18_s1_l2 -->
<g id="node116" class="node">
<title>expert_18_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3535,-15873.55 3366,-15873.55 3366,-15829.55 3535,-15829.55 3535,-15873.55"/>
<text text-anchor="middle" x="3450.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 18 L2</text>
<text text-anchor="middle" x="3450.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_18_s1_l2 -->
<g id="edge177" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_18_s1_l2</title>
<path fill="none" stroke="black" d="M3085.81,-15922.81C3158.76,-15910.59 3259.03,-15893.15 3355.92,-15873.83"/>
<polygon fill="black" stroke="black" points="3356.77,-15877.23 3365.89,-15871.84 3355.4,-15870.37 3356.77,-15877.23"/>
</g>
<!-- expert_19_s1_l2 -->
<g id="node117" class="node">
<title>expert_19_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3722,-15873.55 3553,-15873.55 3553,-15829.55 3722,-15829.55 3722,-15873.55"/>
<text text-anchor="middle" x="3637.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 19 L2</text>
<text text-anchor="middle" x="3637.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_19_s1_l2 -->
<g id="edge178" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_19_s1_l2</title>
<path fill="none" stroke="black" d="M3100.07,-15929.46C3211.79,-15918.92 3384.6,-15900.47 3543,-15873.73"/>
<polygon fill="black" stroke="black" points="3543.66,-15877.17 3552.93,-15872.05 3542.48,-15870.27 3543.66,-15877.17"/>
</g>
<!-- expert_20_s1_l2 -->
<g id="node118" class="node">
<title>expert_20_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3909,-15873.55 3740,-15873.55 3740,-15829.55 3909,-15829.55 3909,-15873.55"/>
<text text-anchor="middle" x="3824.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 20 L2</text>
<text text-anchor="middle" x="3824.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_20_s1_l2 -->
<g id="edge179" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_20_s1_l2</title>
<path fill="none" stroke="black" d="M3105.39,-15933.88C3252.09,-15925.83 3504.87,-15908.32 3729.93,-15873.71"/>
<polygon fill="black" stroke="black" points="3730.6,-15877.14 3739.95,-15872.15 3729.53,-15870.23 3730.6,-15877.14"/>
</g>
<!-- expert_21_s1_l2 -->
<g id="node119" class="node">
<title>expert_21_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="4096,-15873.55 3927,-15873.55 3927,-15829.55 4096,-15829.55 4096,-15873.55"/>
<text text-anchor="middle" x="4011.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 21 L2</text>
<text text-anchor="middle" x="4011.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_21_s1_l2 -->
<g id="edge180" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_21_s1_l2</title>
<path fill="none" stroke="black" d="M3107.68,-15936.85C3285.8,-15931.49 3622.55,-15916.38 3916.94,-15873.68"/>
<polygon fill="black" stroke="black" points="3917.57,-15877.13 3926.96,-15872.21 3916.55,-15870.2 3917.57,-15877.13"/>
</g>
<!-- expert_22_s1_l2 -->
<g id="node120" class="node">
<title>expert_22_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="4283,-15873.55 4114,-15873.55 4114,-15829.55 4283,-15829.55 4283,-15873.55"/>
<text text-anchor="middle" x="4198.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 22 L2</text>
<text text-anchor="middle" x="4198.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_22_s1_l2 -->
<g id="edge181" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_22_s1_l2</title>
<path fill="none" stroke="black" d="M3108.22,-15938.94C3314.67,-15936.27 3738.31,-15924.58 4103.98,-15873.66"/>
<polygon fill="black" stroke="black" points="4104.55,-15877.11 4113.96,-15872.26 4103.57,-15870.18 4104.55,-15877.11"/>
</g>
<!-- expert_23_s1_l2 -->
<g id="node121" class="node">
<title>expert_23_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="4470,-15873.55 4301,-15873.55 4301,-15829.55 4470,-15829.55 4470,-15873.55"/>
<text text-anchor="middle" x="4385.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 23 L2</text>
<text text-anchor="middle" x="4385.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_23_s1_l2 -->
<g id="edge182" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_23_s1_l2</title>
<path fill="none" stroke="black" d="M3108.71,-15940.47C3341.33,-15940.38 3853.2,-15932.82 4290.96,-15873.65"/>
<polygon fill="black" stroke="black" points="4291.53,-15877.11 4300.97,-15872.29 4290.58,-15870.17 4291.53,-15877.11"/>
</g>
<!-- expert_24_s1_l2 -->
<g id="node122" class="node">
<title>expert_24_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="4657,-15873.55 4488,-15873.55 4488,-15829.55 4657,-15829.55 4657,-15873.55"/>
<text text-anchor="middle" x="4572.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 24 L2</text>
<text text-anchor="middle" x="4572.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_24_s1_l2 -->
<g id="edge183" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_24_s1_l2</title>
<path fill="none" stroke="black" d="M3107.58,-15937.01C3413.87,-15930.04 4196.36,-15909.38 4477.77,-15873.64"/>
<polygon fill="black" stroke="black" points="4478.51,-15877.08 4487.97,-15872.31 4477.6,-15870.13 4478.51,-15877.08"/>
</g>
<!-- expert_25_s1_l2 -->
<g id="node123" class="node">
<title>expert_25_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="4844,-15873.55 4675,-15873.55 4675,-15829.55 4844,-15829.55 4844,-15873.55"/>
<text text-anchor="middle" x="4759.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 25 L2</text>
<text text-anchor="middle" x="4759.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_25_s1_l2 -->
<g id="edge184" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_25_s1_l2</title>
<path fill="none" stroke="black" d="M3107.91,-15937.71C3441.37,-15932.06 4345.64,-15913.53 4664.78,-15873.64"/>
<polygon fill="black" stroke="black" points="4665.5,-15877.07 4674.97,-15872.33 4664.61,-15870.13 4665.5,-15877.07"/>
</g>
<!-- expert_26_s1_l2 -->
<g id="node124" class="node">
<title>expert_26_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="5031,-15873.55 4862,-15873.55 4862,-15829.55 5031,-15829.55 5031,-15873.55"/>
<text text-anchor="middle" x="4946.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 26 L2</text>
<text text-anchor="middle" x="4946.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_26_s1_l2 -->
<g id="edge185" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_26_s1_l2</title>
<path fill="none" stroke="black" d="M3108.26,-15938.28C3467.53,-15933.85 4494.93,-15917.71 4851.87,-15873.62"/>
<polygon fill="black" stroke="black" points="4852.49,-15877.07 4861.97,-15872.34 4851.61,-15870.13 4852.49,-15877.07"/>
</g>
<!-- expert_27_s1_l2 -->
<g id="node125" class="node">
<title>expert_27_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="5218,-15873.55 5049,-15873.55 5049,-15829.55 5218,-15829.55 5218,-15873.55"/>
<text text-anchor="middle" x="5133.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 27 L2</text>
<text text-anchor="middle" x="5133.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_27_s1_l2 -->
<g id="edge186" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_27_s1_l2</title>
<path fill="none" stroke="black" d="M3108.28,-15938.75C3491.82,-15935.49 4643.94,-15921.92 5038.93,-15873.61"/>
<polygon fill="black" stroke="black" points="5039.49,-15877.07 5048.97,-15872.35 5038.62,-15870.12 5039.49,-15877.07"/>
</g>
<!-- expert_28_s1_l2 -->
<g id="node126" class="node">
<title>expert_28_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="5405,-15873.55 5236,-15873.55 5236,-15829.55 5405,-15829.55 5405,-15873.55"/>
<text text-anchor="middle" x="5320.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 28 L2</text>
<text text-anchor="middle" x="5320.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_28_s1_l2 -->
<g id="edge187" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_28_s1_l2</title>
<path fill="none" stroke="black" d="M3108.37,-15939.15C3515.16,-15936.98 4792.68,-15926.15 5225.9,-15873.61"/>
<polygon fill="black" stroke="black" points="5226.48,-15877.07 5235.98,-15872.36 5225.62,-15870.12 5226.48,-15877.07"/>
</g>
<!-- expert_29_s1_l2 -->
<g id="node127" class="node">
<title>expert_29_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="5592,-15873.55 5423,-15873.55 5423,-15829.55 5592,-15829.55 5592,-15873.55"/>
<text text-anchor="middle" x="5507.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 29 L2</text>
<text text-anchor="middle" x="5507.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_29_s1_l2 -->
<g id="edge188" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_29_s1_l2</title>
<path fill="none" stroke="black" d="M3108.54,-15939.48C3537.8,-15938.35 4941.67,-15930.39 5413.04,-15873.59"/>
<polygon fill="black" stroke="black" points="5413.48,-15877.07 5422.98,-15872.37 5412.62,-15870.12 5413.48,-15877.07"/>
</g>
<!-- expert_30_s1_l2 -->
<g id="node128" class="node">
<title>expert_30_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="5779,-15873.55 5610,-15873.55 5610,-15829.55 5779,-15829.55 5779,-15873.55"/>
<text text-anchor="middle" x="5694.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 30 L2</text>
<text text-anchor="middle" x="5694.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_30_s1_l2 -->
<g id="edge189" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_30_s1_l2</title>
<path fill="none" stroke="black" d="M3108.69,-15939.77C3559.49,-15939.63 5090.14,-15934.65 5599.96,-15873.6"/>
<polygon fill="black" stroke="black" points="5600.48,-15877.07 5609.98,-15872.38 5599.63,-15870.12 5600.48,-15877.07"/>
</g>
<!-- expert_31_s1_l2 -->
<g id="node129" class="node">
<title>expert_31_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="5966,-15873.55 5797,-15873.55 5797,-15829.55 5966,-15829.55 5966,-15873.55"/>
<text text-anchor="middle" x="5881.5" y="-15863.15" font-family="Arial" font-size="8.00">Expert 31 L2</text>
<text text-anchor="middle" x="5881.5" y="-15854.15" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-15845.15" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-15836.15" font-family="Arial" font-size="8.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1_l2&#45;&gt;expert_31_s1_l2 -->
<g id="edge190" class="edge">
<title>expert_dispatch_s1_l2&#45;&gt;expert_31_s1_l2</title>
<path fill="none" stroke="black" d="M3108.62,-15940.02C3579.98,-15940.83 5238.67,-15938.93 5787,-15873.6"/>
<polygon fill="black" stroke="black" points="5787.47,-15877.06 5796.98,-15872.39 5786.63,-15870.12 5787.47,-15877.06"/>
</g>
<!-- expert_combine_s1_l2 -->
<g id="node130" class="node">
<title>expert_combine_s1_l2</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-15762.44" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-15774.04" font-family="Arial" font-size="8.00">Expert Combine L2 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-15765.04" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-15756.04" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15747.04" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge191" class="edge">
<title>expert_0_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M169.02,-15830.72C171.88,-15830.29 174.71,-15829.9 177.5,-15829.55 702.97,-15764.69 2358.67,-15762.31 2846.17,-15763.07"/>
<polygon fill="black" stroke="black" points="2846.42,-15766.57 2856.42,-15763.09 2846.43,-15759.57 2846.42,-15766.57"/>
</g>
<!-- expert_1_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge192" class="edge">
<title>expert_1_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M356.02,-15830.73C358.88,-15830.29 361.71,-15829.9 364.5,-15829.55 851.71,-15768.99 2380.13,-15763.56 2846.21,-15763.34"/>
<polygon fill="black" stroke="black" points="2846.36,-15766.84 2856.36,-15763.34 2846.36,-15759.84 2846.36,-15766.84"/>
</g>
<!-- expert_2_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge193" class="edge">
<title>expert_2_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M543.02,-15830.73C545.88,-15830.3 548.71,-15829.9 551.5,-15829.55 1000.54,-15773.29 2402.24,-15764.9 2846.2,-15763.65"/>
<polygon fill="black" stroke="black" points="2846.52,-15767.15 2856.51,-15763.62 2846.5,-15760.15 2846.52,-15767.15"/>
</g>
<!-- expert_3_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge194" class="edge">
<title>expert_3_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M730.02,-15830.74C732.88,-15830.3 735.71,-15829.91 738.5,-15829.55 1149.63,-15777.57 2426.08,-15766.33 2846.61,-15764.01"/>
<polygon fill="black" stroke="black" points="2846.7,-15767.51 2856.69,-15763.96 2846.67,-15760.51 2846.7,-15767.51"/>
</g>
<!-- expert_4_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge195" class="edge">
<title>expert_4_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M917.03,-15830.75C919.88,-15830.31 922.71,-15829.91 925.5,-15829.55 1298.74,-15781.85 2450.22,-15767.89 2846.7,-15764.44"/>
<polygon fill="black" stroke="black" points="2846.81,-15767.94 2856.78,-15764.35 2846.75,-15760.94 2846.81,-15767.94"/>
</g>
<!-- expert_5_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge196" class="edge">
<title>expert_5_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M1104.03,-15830.76C1106.88,-15830.32 1109.71,-15829.91 1112.5,-15829.55 1447.94,-15786.14 2474.98,-15769.61 2846.54,-15764.95"/>
<polygon fill="black" stroke="black" points="2846.85,-15768.45 2856.8,-15764.82 2846.76,-15761.45 2846.85,-15768.45"/>
</g>
<!-- expert_6_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge197" class="edge">
<title>expert_6_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M1291.03,-15830.78C1293.88,-15830.33 1296.71,-15829.92 1299.5,-15829.55 1597.53,-15790.38 2502.38,-15771.49 2847.13,-15765.56"/>
<polygon fill="black" stroke="black" points="2847.23,-15769.06 2857.17,-15765.39 2847.11,-15762.06 2847.23,-15769.06"/>
</g>
<!-- expert_7_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge198" class="edge">
<title>expert_7_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M1478.03,-15830.79C1480.88,-15830.34 1483.71,-15829.93 1486.5,-15829.55 1747.22,-15794.64 2530.56,-15773.61 2847.35,-15766.33"/>
<polygon fill="black" stroke="black" points="2847.58,-15769.83 2857.5,-15766.1 2847.42,-15762.83 2847.58,-15769.83"/>
</g>
<!-- expert_8_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge199" class="edge">
<title>expert_8_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M1665.03,-15830.82C1667.88,-15830.36 1670.71,-15829.93 1673.5,-15829.55 2098.54,-15771.27 2607.53,-15762.98 2846.26,-15762.65"/>
<polygon fill="black" stroke="black" points="2846.39,-15766.15 2856.38,-15762.64 2846.38,-15759.15 2846.39,-15766.15"/>
</g>
<!-- expert_9_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge200" class="edge">
<title>expert_9_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M1852.04,-15830.85C1854.89,-15830.38 1857.71,-15829.95 1860.5,-15829.55 2213.6,-15779.62 2634.37,-15767.29 2846.24,-15764.32"/>
<polygon fill="black" stroke="black" points="2846.52,-15767.81 2856.48,-15764.18 2846.43,-15760.81 2846.52,-15767.81"/>
</g>
<!-- expert_10_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge201" class="edge">
<title>expert_10_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M2039.05,-15830.89C2041.89,-15830.41 2044.72,-15829.96 2047.5,-15829.55 2330.13,-15787.9 2664.83,-15772.28 2847.27,-15766.58"/>
<polygon fill="black" stroke="black" points="2847.57,-15770.07 2857.46,-15766.27 2847.35,-15763.08 2847.57,-15770.07"/>
</g>
<!-- expert_11_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge202" class="edge">
<title>expert_11_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M2226.05,-15830.95C2228.9,-15830.46 2231.72,-15829.99 2234.5,-15829.55 2448.23,-15796.13 2699.16,-15778.26 2849.26,-15769.82"/>
<polygon fill="black" stroke="black" points="2849.66,-15773.3 2859.45,-15769.25 2849.27,-15766.31 2849.66,-15773.3"/>
</g>
<!-- expert_12_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge203" class="edge">
<title>expert_12_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M2413.07,-15831.06C2415.91,-15830.53 2418.73,-15830.03 2421.5,-15829.55 2569.28,-15804.23 2740.64,-15785.57 2854.7,-15774.65"/>
<polygon fill="black" stroke="black" points="2855.24,-15778.12 2864.87,-15773.69 2854.58,-15771.15 2855.24,-15778.12"/>
</g>
<!-- expert_13_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge204" class="edge">
<title>expert_13_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M2600.11,-15831.27C2602.94,-15830.68 2605.74,-15830.11 2608.5,-15829.55 2695.55,-15812.04 2794.51,-15794.66 2868.76,-15782.11"/>
<polygon fill="black" stroke="black" points="2869.79,-15785.49 2879.07,-15780.38 2868.63,-15778.59 2869.79,-15785.49"/>
</g>
<!-- expert_14_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge205" class="edge">
<title>expert_14_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M2770.28,-15829.46C2808.19,-15817.67 2855.83,-15802.85 2896.36,-15790.24"/>
<polygon fill="black" stroke="black" points="2897.45,-15793.57 2905.96,-15787.25 2895.37,-15786.88 2897.45,-15793.57"/>
</g>
<!-- expert_15_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge206" class="edge">
<title>expert_15_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M2912.01,-15829.46C2921.53,-15820.55 2932.9,-15809.9 2943.7,-15799.78"/>
<polygon fill="black" stroke="black" points="2946.15,-15802.28 2951.06,-15792.89 2941.37,-15797.17 2946.15,-15802.28"/>
</g>
<!-- expert_16_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge207" class="edge">
<title>expert_16_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M3053.75,-15829.46C3044.12,-15820.55 3032.63,-15809.9 3021.71,-15799.78"/>
<polygon fill="black" stroke="black" points="3023.99,-15797.12 3014.28,-15792.89 3019.23,-15802.25 3023.99,-15797.12"/>
</g>
<!-- expert_17_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge208" class="edge">
<title>expert_17_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M3195.48,-15829.46C3157.36,-15817.65 3109.44,-15802.79 3068.71,-15790.17"/>
<polygon fill="black" stroke="black" points="3069.65,-15786.79 3059.06,-15787.17 3067.58,-15793.48 3069.65,-15786.79"/>
</g>
<!-- expert_18_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge209" class="edge">
<title>expert_18_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M3365.89,-15831.27C3363.06,-15830.68 3360.26,-15830.11 3357.5,-15829.55 3269.89,-15811.95 3170.24,-15794.5 3095.69,-15781.95"/>
<polygon fill="black" stroke="black" points="3096.25,-15778.5 3085.81,-15780.29 3095.09,-15785.4 3096.25,-15778.5"/>
</g>
<!-- expert_19_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge210" class="edge">
<title>expert_19_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M3552.93,-15831.06C3550.09,-15830.53 3547.27,-15830.03 3544.5,-15829.55 3396.34,-15804.18 3224.52,-15785.52 3110.26,-15774.61"/>
<polygon fill="black" stroke="black" points="3110.36,-15771.11 3100.07,-15773.65 3109.69,-15778.08 3110.36,-15771.11"/>
</g>
<!-- expert_20_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge211" class="edge">
<title>expert_20_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M3739.95,-15830.95C3737.1,-15830.46 3734.28,-15829.99 3731.5,-15829.55 3517.33,-15796.07 3265.85,-15778.21 3115.58,-15769.79"/>
<polygon fill="black" stroke="black" points="3115.57,-15766.28 3105.39,-15769.22 3115.18,-15773.27 3115.57,-15766.28"/>
</g>
<!-- expert_21_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge212" class="edge">
<title>expert_21_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M3926.96,-15830.89C3924.11,-15830.41 3921.28,-15829.96 3918.5,-15829.55 3635.57,-15787.86 3300.51,-15772.26 3117.87,-15766.57"/>
<polygon fill="black" stroke="black" points="3117.78,-15763.07 3107.68,-15766.26 3117.57,-15770.06 3117.78,-15763.07"/>
</g>
<!-- expert_22_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge213" class="edge">
<title>expert_22_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M4113.96,-15830.85C4111.11,-15830.38 4108.29,-15829.95 4105.5,-15829.55 3751.85,-15779.56 3330.37,-15767.25 3118.46,-15764.3"/>
<polygon fill="black" stroke="black" points="3118.26,-15760.8 3108.22,-15764.17 3118.17,-15767.8 3118.26,-15760.8"/>
</g>
<!-- expert_23_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge214" class="edge">
<title>expert_23_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M4300.97,-15830.82C4298.12,-15830.36 4295.29,-15829.93 4292.5,-15829.55 3867.13,-15771.23 3357.75,-15762.96 3118.84,-15762.64"/>
<polygon fill="black" stroke="black" points="3118.72,-15759.14 3108.71,-15762.64 3118.71,-15766.14 3118.72,-15759.14"/>
</g>
<!-- expert_24_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge215" class="edge">
<title>expert_24_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M4487.97,-15830.79C4485.12,-15830.34 4482.29,-15829.93 4479.5,-15829.55 4218.6,-15794.62 3434.74,-15773.6 3117.74,-15766.33"/>
<polygon fill="black" stroke="black" points="3117.66,-15762.83 3107.58,-15766.1 3117.5,-15769.82 3117.66,-15762.83"/>
</g>
<!-- expert_25_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge216" class="edge">
<title>expert_25_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M4674.97,-15830.78C4672.12,-15830.33 4669.29,-15829.92 4666.5,-15829.55 4368.29,-15790.36 3462.9,-15771.48 3117.95,-15765.56"/>
<polygon fill="black" stroke="black" points="3117.97,-15762.06 3107.91,-15765.39 3117.85,-15769.06 3117.97,-15762.06"/>
</g>
<!-- expert_26_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge217" class="edge">
<title>expert_26_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M4861.97,-15830.76C4859.12,-15830.32 4856.29,-15829.91 4853.5,-15829.55 4517.88,-15786.12 3490.29,-15769.6 3118.53,-15764.95"/>
<polygon fill="black" stroke="black" points="3118.31,-15761.45 3108.26,-15764.82 3118.22,-15768.45 3118.31,-15761.45"/>
</g>
<!-- expert_27_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge218" class="edge">
<title>expert_27_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M5048.97,-15830.75C5046.12,-15830.31 5043.29,-15829.91 5040.5,-15829.55 4667.07,-15781.83 3515.04,-15767.88 3118.36,-15764.44"/>
<polygon fill="black" stroke="black" points="3118.31,-15760.94 3108.28,-15764.35 3118.25,-15767.94 3118.31,-15760.94"/>
</g>
<!-- expert_28_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge219" class="edge">
<title>expert_28_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M5235.98,-15830.74C5233.12,-15830.3 5230.29,-15829.91 5227.5,-15829.55 4816.19,-15777.55 3539.17,-15766.32 3118.45,-15764.01"/>
<polygon fill="black" stroke="black" points="3118.39,-15760.51 3108.37,-15763.96 3118.35,-15767.51 3118.39,-15760.51"/>
</g>
<!-- expert_29_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge220" class="edge">
<title>expert_29_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M5422.98,-15830.73C5420.12,-15830.3 5417.29,-15829.9 5414.5,-15829.55 4965.28,-15773.27 3563,-15764.89 3118.86,-15763.65"/>
<polygon fill="black" stroke="black" points="3118.55,-15760.15 3108.54,-15763.62 3118.53,-15767.15 3118.55,-15760.15"/>
</g>
<!-- expert_30_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge221" class="edge">
<title>expert_30_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M5609.98,-15830.73C5607.12,-15830.29 5604.29,-15829.9 5601.5,-15829.55 5114.1,-15768.97 3585.1,-15763.55 3118.84,-15763.34"/>
<polygon fill="black" stroke="black" points="3118.69,-15759.84 3108.69,-15763.34 3118.69,-15766.84 3118.69,-15759.84"/>
</g>
<!-- expert_31_s1_l2&#45;&gt;expert_combine_s1_l2 -->
<g id="edge222" class="edge">
<title>expert_31_s1_l2&#45;&gt;expert_combine_s1_l2</title>
<path fill="none" stroke="black" d="M5796.98,-15830.72C5794.12,-15830.29 5791.29,-15829.9 5788.5,-15829.55 5262.84,-15764.66 3606.55,-15762.31 3118.88,-15763.07"/>
<polygon fill="black" stroke="black" points="3118.62,-15759.57 3108.62,-15763.09 3118.63,-15766.57 3118.62,-15759.57"/>
</g>
<!-- moe_out_proj_s1_l2 -->
<g id="node131" class="node">
<title>moe_out_proj_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-15695.33 2893.5,-15695.33 2893.5,-15651.33 3071.5,-15651.33 3071.5,-15695.33"/>
<text text-anchor="middle" x="2982.5" y="-15684.93" font-family="Arial" font-size="8.00">MoE Output Proj L2 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-15675.93" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15666.93" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15657.93" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1_l2&#45;&gt;moe_out_proj_s1_l2 -->
<g id="edge223" class="edge">
<title>expert_combine_s1_l2&#45;&gt;moe_out_proj_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-15730.97C2982.5,-15722.69 2982.5,-15713.72 2982.5,-15705.4"/>
<polygon fill="black" stroke="black" points="2986,-15705.33 2982.5,-15695.33 2979,-15705.33 2986,-15705.33"/>
</g>
<!-- allreduce_moe_out_s1_l2 -->
<g id="node132" class="node">
<title>allreduce_moe_out_s1_l2</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-15584.21" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-15595.81" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L2</text>
<text text-anchor="middle" x="2982.5" y="-15586.81" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15577.81" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15568.81" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1_l2&#45;&gt;allreduce_moe_out_s1_l2 -->
<g id="edge224" class="edge">
<title>moe_out_proj_s1_l2&#45;&gt;allreduce_moe_out_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-15651.24C2982.5,-15643.57 2982.5,-15634.61 2982.5,-15625.82"/>
<polygon fill="black" stroke="black" points="2986,-15625.66 2982.5,-15615.66 2979,-15625.66 2986,-15625.66"/>
</g>
<!-- layernorm2_s1_l2 -->
<g id="node133" class="node">
<title>layernorm2_s1_l2</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-15517.1 2893.5,-15517.1 2893.5,-15473.1 3071.5,-15473.1 3071.5,-15517.1"/>
<text text-anchor="middle" x="2982.5" y="-15506.7" font-family="Arial" font-size="8.00">LayerNorm 2 (L2)</text>
<text text-anchor="middle" x="2982.5" y="-15497.7" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15488.7" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15479.7" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1_l2&#45;&gt;layernorm2_s1_l2 -->
<g id="edge225" class="edge">
<title>allreduce_moe_out_s1_l2&#45;&gt;layernorm2_s1_l2</title>
<path fill="none" stroke="black" d="M2982.5,-15552.75C2982.5,-15544.47 2982.5,-15535.49 2982.5,-15527.18"/>
<polygon fill="black" stroke="black" points="2986,-15527.11 2982.5,-15517.11 2979,-15527.11 2986,-15527.11"/>
</g>
<!-- layernorm1_s1_l3 -->
<g id="node134" class="node">
<title>layernorm1_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-15437.1 2893.5,-15437.1 2893.5,-15393.1 3071.5,-15393.1 3071.5,-15437.1"/>
<text text-anchor="middle" x="2982.5" y="-15426.7" font-family="Arial" font-size="8.00">LayerNorm 1 (L3)</text>
<text text-anchor="middle" x="2982.5" y="-15417.7" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15408.7" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15399.7" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm2_s1_l2&#45;&gt;layernorm1_s1_l3 -->
<g id="edge226" class="edge">
<title>layernorm2_s1_l2&#45;&gt;layernorm1_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-15472.79C2982.5,-15464.9 2982.5,-15455.79 2982.5,-15447.2"/>
<polygon fill="black" stroke="black" points="2986,-15447.12 2982.5,-15437.12 2979,-15447.12 2986,-15447.12"/>
</g>
<!-- qkv_proj_s1_l3 -->
<g id="node135" class="node">
<title>qkv_proj_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3081,-15357.1 2884,-15357.1 2884,-15313.1 3081,-15313.1 3081,-15357.1"/>
<text text-anchor="middle" x="2982.5" y="-15346.7" font-family="Arial" font-size="8.00">QKV Projection L3 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-15337.7" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15328.7" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-15319.7" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1_l3&#45;&gt;qkv_proj_s1_l3 -->
<g id="edge227" class="edge">
<title>layernorm1_s1_l3&#45;&gt;qkv_proj_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-15392.79C2982.5,-15384.9 2982.5,-15375.79 2982.5,-15367.2"/>
<polygon fill="black" stroke="black" points="2986,-15367.12 2982.5,-15357.12 2979,-15367.12 2986,-15367.12"/>
</g>
<!-- allreduce_qkv_s1_l3 -->
<g id="node136" class="node">
<title>allreduce_qkv_s1_l3</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-15245.99" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-15257.59" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L3</text>
<text text-anchor="middle" x="2982.5" y="-15248.59" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-15239.59" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-15230.59" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1_l3&#45;&gt;allreduce_qkv_s1_l3 -->
<g id="edge228" class="edge">
<title>qkv_proj_s1_l3&#45;&gt;allreduce_qkv_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-15313.01C2982.5,-15305.34 2982.5,-15296.39 2982.5,-15287.6"/>
<polygon fill="black" stroke="black" points="2986,-15287.43 2982.5,-15277.43 2979,-15287.43 2986,-15287.43"/>
</g>
<!-- attention_s1_l3 -->
<g id="node137" class="node">
<title>attention_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3081,-15178.88 2884,-15178.88 2884,-15134.88 3081,-15134.88 3081,-15178.88"/>
<text text-anchor="middle" x="2982.5" y="-15168.48" font-family="Arial" font-size="8.00">Self&#45;Attention L3</text>
<text text-anchor="middle" x="2982.5" y="-15159.48" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-15150.48" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-15141.48" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1_l3&#45;&gt;attention_s1_l3 -->
<g id="edge229" class="edge">
<title>allreduce_qkv_s1_l3&#45;&gt;attention_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-15214.52C2982.5,-15206.24 2982.5,-15197.27 2982.5,-15188.95"/>
<polygon fill="black" stroke="black" points="2986,-15188.88 2982.5,-15178.88 2979,-15188.88 2986,-15188.88"/>
</g>
<!-- attn_out_proj_s1_l3 -->
<g id="node138" class="node">
<title>attn_out_proj_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3078,-15098.88 2887,-15098.88 2887,-15054.88 3078,-15054.88 3078,-15098.88"/>
<text text-anchor="middle" x="2982.5" y="-15088.48" font-family="Arial" font-size="8.00">Attention Output Proj L3 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-15079.48" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-15070.48" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15061.48" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1_l3&#45;&gt;attn_out_proj_s1_l3 -->
<g id="edge230" class="edge">
<title>attention_s1_l3&#45;&gt;attn_out_proj_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-15134.56C2982.5,-15126.67 2982.5,-15117.56 2982.5,-15108.98"/>
<polygon fill="black" stroke="black" points="2986,-15108.89 2982.5,-15098.89 2979,-15108.89 2986,-15108.89"/>
</g>
<!-- allreduce_attn_out_s1_l3 -->
<g id="node139" class="node">
<title>allreduce_attn_out_s1_l3</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-14987.76" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-14999.36" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L3</text>
<text text-anchor="middle" x="2982.5" y="-14990.36" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14981.36" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14972.36" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1_l3&#45;&gt;allreduce_attn_out_s1_l3 -->
<g id="edge231" class="edge">
<title>attn_out_proj_s1_l3&#45;&gt;allreduce_attn_out_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-15054.79C2982.5,-15047.12 2982.5,-15038.16 2982.5,-15029.37"/>
<polygon fill="black" stroke="black" points="2986,-15029.21 2982.5,-15019.21 2979,-15029.21 2986,-15029.21"/>
</g>
<!-- moe_gate_s1_l3 -->
<g id="node140" class="node">
<title>moe_gate_s1_l3</title>
<polygon fill="orange" stroke="black" points="3167.08,-14920.65 2873.45,-14920.65 2797.92,-14832.65 3091.55,-14832.65 3167.08,-14920.65"/>
<text text-anchor="middle" x="2982.5" y="-14888.25" font-family="Arial" font-size="8.00">MoE Gate L3 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-14879.25" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14870.25" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14861.25" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1_l3&#45;&gt;moe_gate_s1_l3 -->
<g id="edge232" class="edge">
<title>allreduce_attn_out_s1_l3&#45;&gt;moe_gate_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-14956.37C2982.5,-14948.48 2982.5,-14939.75 2982.5,-14931.06"/>
<polygon fill="black" stroke="black" points="2986,-14930.93 2982.5,-14920.93 2979,-14930.93 2986,-14930.93"/>
</g>
<!-- expert_dispatch_s1_l3 -->
<g id="node141" class="node">
<title>expert_dispatch_s1_l3</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-14765.54" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-14777.14" font-family="Arial" font-size="8.00">Expert Dispatch L3 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-14768.14" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14759.14" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14750.14" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1_l3&#45;&gt;expert_dispatch_s1_l3 -->
<g id="edge233" class="edge">
<title>moe_gate_s1_l3&#45;&gt;expert_dispatch_s1_l3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-14832.53C2982.5,-14824.15 2982.5,-14815.4 2982.5,-14807.11"/>
<polygon fill="black" stroke="black" points="2986,-14806.91 2982.5,-14796.91 2979,-14806.91 2986,-14806.91"/>
</g>
<!-- expert_0_s1_l3 -->
<g id="node142" class="node">
<title>expert_0_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="169,-14698.43 0,-14698.43 0,-14654.43 169,-14654.43 169,-14698.43"/>
<text text-anchor="middle" x="84.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 0 L3</text>
<text text-anchor="middle" x="84.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_0_s1_l3 -->
<g id="edge234" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_0_s1_l3</title>
<path fill="none" stroke="black" d="M2856.42,-14764.89C2385.23,-14765.69 727.13,-14763.78 178.99,-14698.47"/>
<polygon fill="black" stroke="black" points="179.37,-14694.99 169.02,-14697.26 178.53,-14701.94 179.37,-14694.99"/>
</g>
<!-- expert_1_s1_l3 -->
<g id="node143" class="node">
<title>expert_1_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="356,-14698.43 187,-14698.43 187,-14654.43 356,-14654.43 356,-14698.43"/>
<text text-anchor="middle" x="271.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 1 L3</text>
<text text-anchor="middle" x="271.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_1_s1_l3 -->
<g id="edge235" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_1_s1_l3</title>
<path fill="none" stroke="black" d="M2856.36,-14764.64C2405.73,-14764.5 875.66,-14759.5 366.03,-14698.47"/>
<polygon fill="black" stroke="black" points="366.37,-14694.99 356.02,-14697.25 365.52,-14701.94 366.37,-14694.99"/>
</g>
<!-- expert_2_s1_l3 -->
<g id="node144" class="node">
<title>expert_2_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="543,-14698.43 374,-14698.43 374,-14654.43 543,-14654.43 543,-14698.43"/>
<text text-anchor="middle" x="458.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 2 L3</text>
<text text-anchor="middle" x="458.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_2_s1_l3 -->
<g id="edge236" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_2_s1_l3</title>
<path fill="none" stroke="black" d="M2856.51,-14764.35C2427.43,-14763.22 1024.14,-14755.24 552.96,-14698.47"/>
<polygon fill="black" stroke="black" points="553.38,-14694.99 543.02,-14697.25 552.52,-14701.94 553.38,-14694.99"/>
</g>
<!-- expert_3_s1_l3 -->
<g id="node145" class="node">
<title>expert_3_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="730,-14698.43 561,-14698.43 561,-14654.43 730,-14654.43 730,-14698.43"/>
<text text-anchor="middle" x="645.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 3 L3</text>
<text text-anchor="middle" x="645.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_3_s1_l3 -->
<g id="edge237" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_3_s1_l3</title>
<path fill="none" stroke="black" d="M2856.69,-14764.02C2450.07,-14761.84 1173.13,-14751 740.1,-14698.49"/>
<polygon fill="black" stroke="black" points="740.38,-14694.99 730.02,-14697.24 739.52,-14701.94 740.38,-14694.99"/>
</g>
<!-- expert_4_s1_l3 -->
<g id="node146" class="node">
<title>expert_4_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="917,-14698.43 748,-14698.43 748,-14654.43 917,-14654.43 917,-14698.43"/>
<text text-anchor="middle" x="832.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 4 L3</text>
<text text-anchor="middle" x="832.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_4_s1_l3 -->
<g id="edge238" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_4_s1_l3</title>
<path fill="none" stroke="black" d="M2856.78,-14763.63C2473.43,-14760.35 1321.87,-14746.77 927.06,-14698.48"/>
<polygon fill="black" stroke="black" points="927.38,-14695 917.03,-14697.23 926.51,-14701.94 927.38,-14695"/>
</g>
<!-- expert_5_s1_l3 -->
<g id="node147" class="node">
<title>expert_5_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="1104,-14698.43 935,-14698.43 935,-14654.43 1104,-14654.43 1104,-14698.43"/>
<text text-anchor="middle" x="1019.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 5 L3</text>
<text text-anchor="middle" x="1019.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_5_s1_l3 -->
<g id="edge239" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_5_s1_l3</title>
<path fill="none" stroke="black" d="M2856.8,-14763.15C2497.73,-14758.72 1470.88,-14742.56 1114.13,-14698.49"/>
<polygon fill="black" stroke="black" points="1114.39,-14695 1104.03,-14697.22 1113.51,-14701.94 1114.39,-14695"/>
</g>
<!-- expert_6_s1_l3 -->
<g id="node148" class="node">
<title>expert_6_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="1291,-14698.43 1122,-14698.43 1122,-14654.43 1291,-14654.43 1291,-14698.43"/>
<text text-anchor="middle" x="1206.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 6 L3</text>
<text text-anchor="middle" x="1206.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_6_s1_l3 -->
<g id="edge240" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_6_s1_l3</title>
<path fill="none" stroke="black" d="M2857.17,-14762.59C2523.91,-14756.92 1620.17,-14738.38 1301.21,-14698.51"/>
<polygon fill="black" stroke="black" points="1301.39,-14695 1291.03,-14697.2 1300.5,-14701.95 1301.39,-14695"/>
</g>
<!-- expert_7_s1_l3 -->
<g id="node149" class="node">
<title>expert_7_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="1478,-14698.43 1309,-14698.43 1309,-14654.43 1478,-14654.43 1478,-14698.43"/>
<text text-anchor="middle" x="1393.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 7 L3</text>
<text text-anchor="middle" x="1393.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_7_s1_l3 -->
<g id="edge241" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_7_s1_l3</title>
<path fill="none" stroke="black" d="M2857.5,-14761.88C2551.41,-14754.91 1769.45,-14734.23 1488.23,-14698.51"/>
<polygon fill="black" stroke="black" points="1488.4,-14695.01 1478.03,-14697.18 1487.49,-14701.95 1488.4,-14695.01"/>
</g>
<!-- expert_8_s1_l3 -->
<g id="node150" class="node">
<title>expert_8_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="1665,-14698.43 1496,-14698.43 1496,-14654.43 1665,-14654.43 1665,-14698.43"/>
<text text-anchor="middle" x="1580.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 8 L3</text>
<text text-anchor="middle" x="1580.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_8_s1_l3 -->
<g id="edge242" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_8_s1_l3</title>
<path fill="none" stroke="black" d="M2856.38,-14765.34C2623.94,-14765.23 2112.47,-14757.66 1675.03,-14698.52"/>
<polygon fill="black" stroke="black" points="1675.42,-14695.04 1665.03,-14697.16 1674.47,-14701.98 1675.42,-14695.04"/>
</g>
<!-- expert_9_s1_l3 -->
<g id="node151" class="node">
<title>expert_9_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="1852,-14698.43 1683,-14698.43 1683,-14654.43 1852,-14654.43 1852,-14698.43"/>
<text text-anchor="middle" x="1767.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 9 L3</text>
<text text-anchor="middle" x="1767.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_9_s1_l3 -->
<g id="edge243" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_9_s1_l3</title>
<path fill="none" stroke="black" d="M2856.48,-14763.8C2650.05,-14761.11 2227.11,-14749.39 1862.01,-14698.53"/>
<polygon fill="black" stroke="black" points="1862.43,-14695.05 1852.04,-14697.13 1861.45,-14701.99 1862.43,-14695.05"/>
</g>
<!-- expert_10_s1_l3 -->
<g id="node152" class="node">
<title>expert_10_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="2039,-14698.43 1870,-14698.43 1870,-14654.43 2039,-14654.43 2039,-14698.43"/>
<text text-anchor="middle" x="1954.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 10 L3</text>
<text text-anchor="middle" x="1954.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_10_s1_l3 -->
<g id="edge244" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_10_s1_l3</title>
<path fill="none" stroke="black" d="M2857.46,-14761.71C2679.53,-14756.34 2343.14,-14741.21 2049.05,-14698.55"/>
<polygon fill="black" stroke="black" points="2049.45,-14695.07 2039.05,-14697.09 2048.43,-14702 2049.45,-14695.07"/>
</g>
<!-- expert_11_s1_l3 -->
<g id="node153" class="node">
<title>expert_11_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="2226,-14698.43 2057,-14698.43 2057,-14654.43 2226,-14654.43 2226,-14698.43"/>
<text text-anchor="middle" x="2141.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 11 L3</text>
<text text-anchor="middle" x="2141.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_11_s1_l3 -->
<g id="edge245" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_11_s1_l3</title>
<path fill="none" stroke="black" d="M2859.45,-14758.72C2712.89,-14750.65 2460.66,-14733.14 2236.05,-14698.58"/>
<polygon fill="black" stroke="black" points="2236.47,-14695.1 2226.05,-14697.02 2235.4,-14702.02 2236.47,-14695.1"/>
</g>
<!-- expert_12_s1_l3 -->
<g id="node154" class="node">
<title>expert_12_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="2413,-14698.43 2244,-14698.43 2244,-14654.43 2413,-14654.43 2413,-14698.43"/>
<text text-anchor="middle" x="2328.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 12 L3</text>
<text text-anchor="middle" x="2328.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_12_s1_l3 -->
<g id="edge246" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_12_s1_l3</title>
<path fill="none" stroke="black" d="M2864.87,-14754.29C2753.34,-14743.74 2580.99,-14725.29 2422.98,-14698.6"/>
<polygon fill="black" stroke="black" points="2423.52,-14695.15 2413.07,-14696.92 2422.34,-14702.05 2423.52,-14695.15"/>
</g>
<!-- expert_13_s1_l3 -->
<g id="node155" class="node">
<title>expert_13_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="2600,-14698.43 2431,-14698.43 2431,-14654.43 2600,-14654.43 2600,-14698.43"/>
<text text-anchor="middle" x="2515.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 13 L3</text>
<text text-anchor="middle" x="2515.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_13_s1_l3 -->
<g id="edge247" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_13_s1_l3</title>
<path fill="none" stroke="black" d="M2879.07,-14747.6C2806.34,-14735.37 2706.53,-14717.96 2610.04,-14698.7"/>
<polygon fill="black" stroke="black" points="2610.6,-14695.24 2600.11,-14696.71 2609.23,-14702.11 2610.6,-14695.24"/>
</g>
<!-- expert_14_s1_l3 -->
<g id="node156" class="node">
<title>expert_14_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="2787,-14698.43 2618,-14698.43 2618,-14654.43 2787,-14654.43 2787,-14698.43"/>
<text text-anchor="middle" x="2702.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 14 L3</text>
<text text-anchor="middle" x="2702.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_14_s1_l3 -->
<g id="edge248" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_14_s1_l3</title>
<path fill="none" stroke="black" d="M2905.99,-14740.73C2866.88,-14728.57 2819.39,-14713.79 2780.12,-14701.57"/>
<polygon fill="black" stroke="black" points="2780.91,-14698.16 2770.32,-14698.53 2778.83,-14704.84 2780.91,-14698.16"/>
</g>
<!-- expert_15_s1_l3 -->
<g id="node157" class="node">
<title>expert_15_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="2974,-14698.43 2805,-14698.43 2805,-14654.43 2974,-14654.43 2974,-14698.43"/>
<text text-anchor="middle" x="2889.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 15 L3</text>
<text text-anchor="middle" x="2889.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_15_s1_l3 -->
<g id="edge249" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_15_s1_l3</title>
<path fill="none" stroke="black" d="M2951.27,-14735.29C2941.01,-14725.68 2929.64,-14715.02 2919.47,-14705.5"/>
<polygon fill="black" stroke="black" points="2921.66,-14702.76 2911.97,-14698.48 2916.88,-14707.87 2921.66,-14702.76"/>
</g>
<!-- expert_16_s1_l3 -->
<g id="node158" class="node">
<title>expert_16_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3161,-14698.43 2992,-14698.43 2992,-14654.43 3161,-14654.43 3161,-14698.43"/>
<text text-anchor="middle" x="3076.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 16 L3</text>
<text text-anchor="middle" x="3076.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_16_s1_l3 -->
<g id="edge250" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_16_s1_l3</title>
<path fill="none" stroke="black" d="M3014.06,-14735.29C3024.43,-14725.68 3035.93,-14715.02 3046.21,-14705.5"/>
<polygon fill="black" stroke="black" points="3048.83,-14707.84 3053.78,-14698.48 3044.07,-14702.71 3048.83,-14707.84"/>
</g>
<!-- expert_17_s1_l3 -->
<g id="node159" class="node">
<title>expert_17_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3348,-14698.43 3179,-14698.43 3179,-14654.43 3348,-14654.43 3348,-14698.43"/>
<text text-anchor="middle" x="3263.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 17 L3</text>
<text text-anchor="middle" x="3263.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_17_s1_l3 -->
<g id="edge251" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_17_s1_l3</title>
<path fill="none" stroke="black" d="M3059.28,-14740.73C3098.53,-14728.57 3146.2,-14713.79 3185.6,-14701.57"/>
<polygon fill="black" stroke="black" points="3186.92,-14704.83 3195.43,-14698.53 3184.84,-14698.14 3186.92,-14704.83"/>
</g>
<!-- expert_18_s1_l3 -->
<g id="node160" class="node">
<title>expert_18_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3535,-14698.43 3366,-14698.43 3366,-14654.43 3535,-14654.43 3535,-14698.43"/>
<text text-anchor="middle" x="3450.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 18 L3</text>
<text text-anchor="middle" x="3450.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_18_s1_l3 -->
<g id="edge252" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_18_s1_l3</title>
<path fill="none" stroke="black" d="M3085.81,-14747.68C3158.76,-14735.46 3259.03,-14718.02 3355.92,-14698.71"/>
<polygon fill="black" stroke="black" points="3356.77,-14702.11 3365.89,-14696.71 3355.4,-14695.24 3356.77,-14702.11"/>
</g>
<!-- expert_19_s1_l3 -->
<g id="node161" class="node">
<title>expert_19_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3722,-14698.43 3553,-14698.43 3553,-14654.43 3722,-14654.43 3722,-14698.43"/>
<text text-anchor="middle" x="3637.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 19 L3</text>
<text text-anchor="middle" x="3637.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_19_s1_l3 -->
<g id="edge253" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_19_s1_l3</title>
<path fill="none" stroke="black" d="M3100.07,-14754.33C3211.79,-14743.8 3384.6,-14725.34 3543,-14698.61"/>
<polygon fill="black" stroke="black" points="3543.66,-14702.05 3552.93,-14696.92 3542.48,-14695.15 3543.66,-14702.05"/>
</g>
<!-- expert_20_s1_l3 -->
<g id="node162" class="node">
<title>expert_20_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3909,-14698.43 3740,-14698.43 3740,-14654.43 3909,-14654.43 3909,-14698.43"/>
<text text-anchor="middle" x="3824.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 20 L3</text>
<text text-anchor="middle" x="3824.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_20_s1_l3 -->
<g id="edge254" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_20_s1_l3</title>
<path fill="none" stroke="black" d="M3105.39,-14758.75C3252.09,-14750.7 3504.87,-14733.2 3729.93,-14698.58"/>
<polygon fill="black" stroke="black" points="3730.6,-14702.02 3739.95,-14697.02 3729.53,-14695.1 3730.6,-14702.02"/>
</g>
<!-- expert_21_s1_l3 -->
<g id="node163" class="node">
<title>expert_21_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="4096,-14698.43 3927,-14698.43 3927,-14654.43 4096,-14654.43 4096,-14698.43"/>
<text text-anchor="middle" x="4011.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 21 L3</text>
<text text-anchor="middle" x="4011.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_21_s1_l3 -->
<g id="edge255" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_21_s1_l3</title>
<path fill="none" stroke="black" d="M3107.68,-14761.72C3285.8,-14756.36 3622.55,-14741.25 3916.94,-14698.55"/>
<polygon fill="black" stroke="black" points="3917.57,-14702 3926.96,-14697.09 3916.55,-14695.07 3917.57,-14702"/>
</g>
<!-- expert_22_s1_l3 -->
<g id="node164" class="node">
<title>expert_22_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="4283,-14698.43 4114,-14698.43 4114,-14654.43 4283,-14654.43 4283,-14698.43"/>
<text text-anchor="middle" x="4198.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 22 L3</text>
<text text-anchor="middle" x="4198.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_22_s1_l3 -->
<g id="edge256" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_22_s1_l3</title>
<path fill="none" stroke="black" d="M3108.22,-14763.81C3314.67,-14761.14 3738.31,-14749.46 4103.98,-14698.53"/>
<polygon fill="black" stroke="black" points="4104.55,-14701.99 4113.96,-14697.13 4103.57,-14695.05 4104.55,-14701.99"/>
</g>
<!-- expert_23_s1_l3 -->
<g id="node165" class="node">
<title>expert_23_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="4470,-14698.43 4301,-14698.43 4301,-14654.43 4470,-14654.43 4470,-14698.43"/>
<text text-anchor="middle" x="4385.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 23 L3</text>
<text text-anchor="middle" x="4385.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_23_s1_l3 -->
<g id="edge257" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_23_s1_l3</title>
<path fill="none" stroke="black" d="M3108.71,-14765.34C3341.33,-14765.25 3853.2,-14757.7 4290.96,-14698.52"/>
<polygon fill="black" stroke="black" points="4291.53,-14701.98 4300.97,-14697.16 4290.58,-14695.04 4291.53,-14701.98"/>
</g>
<!-- expert_24_s1_l3 -->
<g id="node166" class="node">
<title>expert_24_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="4657,-14698.43 4488,-14698.43 4488,-14654.43 4657,-14654.43 4657,-14698.43"/>
<text text-anchor="middle" x="4572.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 24 L3</text>
<text text-anchor="middle" x="4572.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_24_s1_l3 -->
<g id="edge258" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_24_s1_l3</title>
<path fill="none" stroke="black" d="M3107.58,-14761.88C3413.87,-14754.92 4196.36,-14734.25 4477.77,-14698.52"/>
<polygon fill="black" stroke="black" points="4478.51,-14701.95 4487.97,-14697.18 4477.6,-14695.01 4478.51,-14701.95"/>
</g>
<!-- expert_25_s1_l3 -->
<g id="node167" class="node">
<title>expert_25_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="4844,-14698.43 4675,-14698.43 4675,-14654.43 4844,-14654.43 4844,-14698.43"/>
<text text-anchor="middle" x="4759.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 25 L3</text>
<text text-anchor="middle" x="4759.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_25_s1_l3 -->
<g id="edge259" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_25_s1_l3</title>
<path fill="none" stroke="black" d="M3107.91,-14762.59C3441.37,-14756.93 4345.64,-14738.4 4664.78,-14698.51"/>
<polygon fill="black" stroke="black" points="4665.5,-14701.95 4674.97,-14697.2 4664.61,-14695 4665.5,-14701.95"/>
</g>
<!-- expert_26_s1_l3 -->
<g id="node168" class="node">
<title>expert_26_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="5031,-14698.43 4862,-14698.43 4862,-14654.43 5031,-14654.43 5031,-14698.43"/>
<text text-anchor="middle" x="4946.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 26 L3</text>
<text text-anchor="middle" x="4946.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_26_s1_l3 -->
<g id="edge260" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_26_s1_l3</title>
<path fill="none" stroke="black" d="M3108.26,-14763.16C3467.53,-14758.73 4494.93,-14742.58 4851.87,-14698.49"/>
<polygon fill="black" stroke="black" points="4852.49,-14701.94 4861.97,-14697.22 4851.61,-14695 4852.49,-14701.94"/>
</g>
<!-- expert_27_s1_l3 -->
<g id="node169" class="node">
<title>expert_27_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="5218,-14698.43 5049,-14698.43 5049,-14654.43 5218,-14654.43 5218,-14698.43"/>
<text text-anchor="middle" x="5133.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 27 L3</text>
<text text-anchor="middle" x="5133.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_27_s1_l3 -->
<g id="edge261" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_27_s1_l3</title>
<path fill="none" stroke="black" d="M3108.28,-14763.63C3491.82,-14760.36 4643.94,-14746.79 5038.93,-14698.48"/>
<polygon fill="black" stroke="black" points="5039.49,-14701.94 5048.97,-14697.23 5038.62,-14695 5039.49,-14701.94"/>
</g>
<!-- expert_28_s1_l3 -->
<g id="node170" class="node">
<title>expert_28_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="5405,-14698.43 5236,-14698.43 5236,-14654.43 5405,-14654.43 5405,-14698.43"/>
<text text-anchor="middle" x="5320.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 28 L3</text>
<text text-anchor="middle" x="5320.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_28_s1_l3 -->
<g id="edge262" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_28_s1_l3</title>
<path fill="none" stroke="black" d="M3108.37,-14764.02C3515.16,-14761.85 4792.68,-14751.02 5225.9,-14698.49"/>
<polygon fill="black" stroke="black" points="5226.48,-14701.94 5235.98,-14697.24 5225.62,-14694.99 5226.48,-14701.94"/>
</g>
<!-- expert_29_s1_l3 -->
<g id="node171" class="node">
<title>expert_29_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="5592,-14698.43 5423,-14698.43 5423,-14654.43 5592,-14654.43 5592,-14698.43"/>
<text text-anchor="middle" x="5507.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 29 L3</text>
<text text-anchor="middle" x="5507.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_29_s1_l3 -->
<g id="edge263" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_29_s1_l3</title>
<path fill="none" stroke="black" d="M3108.54,-14764.35C3537.8,-14763.23 4941.67,-14755.26 5413.04,-14698.47"/>
<polygon fill="black" stroke="black" points="5413.48,-14701.94 5422.98,-14697.25 5412.62,-14694.99 5413.48,-14701.94"/>
</g>
<!-- expert_30_s1_l3 -->
<g id="node172" class="node">
<title>expert_30_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="5779,-14698.43 5610,-14698.43 5610,-14654.43 5779,-14654.43 5779,-14698.43"/>
<text text-anchor="middle" x="5694.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 30 L3</text>
<text text-anchor="middle" x="5694.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_30_s1_l3 -->
<g id="edge264" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_30_s1_l3</title>
<path fill="none" stroke="black" d="M3108.69,-14764.64C3559.49,-14764.5 5090.14,-14759.52 5599.96,-14698.47"/>
<polygon fill="black" stroke="black" points="5600.48,-14701.94 5609.98,-14697.25 5599.63,-14694.99 5600.48,-14701.94"/>
</g>
<!-- expert_31_s1_l3 -->
<g id="node173" class="node">
<title>expert_31_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="5966,-14698.43 5797,-14698.43 5797,-14654.43 5966,-14654.43 5966,-14698.43"/>
<text text-anchor="middle" x="5881.5" y="-14688.03" font-family="Arial" font-size="8.00">Expert 31 L3</text>
<text text-anchor="middle" x="5881.5" y="-14679.03" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-14670.03" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-14661.03" font-family="Arial" font-size="8.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1_l3&#45;&gt;expert_31_s1_l3 -->
<g id="edge265" class="edge">
<title>expert_dispatch_s1_l3&#45;&gt;expert_31_s1_l3</title>
<path fill="none" stroke="black" d="M3108.62,-14764.89C3579.98,-14765.7 5238.67,-14763.8 5787,-14698.47"/>
<polygon fill="black" stroke="black" points="5787.47,-14701.94 5796.98,-14697.26 5786.63,-14694.99 5787.47,-14701.94"/>
</g>
<!-- expert_combine_s1_l3 -->
<g id="node174" class="node">
<title>expert_combine_s1_l3</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-14587.31" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-14598.91" font-family="Arial" font-size="8.00">Expert Combine L3 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-14589.91" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-14580.91" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14571.91" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge266" class="edge">
<title>expert_0_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M169.02,-14655.59C171.88,-14655.16 174.71,-14654.77 177.5,-14654.43 702.97,-14589.56 2358.67,-14587.18 2846.17,-14587.94"/>
<polygon fill="black" stroke="black" points="2846.42,-14591.44 2856.42,-14587.96 2846.43,-14584.44 2846.42,-14591.44"/>
</g>
<!-- expert_1_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge267" class="edge">
<title>expert_1_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M356.02,-14655.6C358.88,-14655.17 361.71,-14654.77 364.5,-14654.43 851.71,-14593.87 2380.13,-14588.43 2846.21,-14588.21"/>
<polygon fill="black" stroke="black" points="2846.36,-14591.71 2856.36,-14588.21 2846.36,-14584.71 2846.36,-14591.71"/>
</g>
<!-- expert_2_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge268" class="edge">
<title>expert_2_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M543.02,-14655.61C545.88,-14655.17 548.71,-14654.78 551.5,-14654.43 1000.54,-14598.17 2402.24,-14589.77 2846.2,-14588.53"/>
<polygon fill="black" stroke="black" points="2846.52,-14592.03 2856.51,-14588.5 2846.5,-14585.03 2846.52,-14592.03"/>
</g>
<!-- expert_3_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge269" class="edge">
<title>expert_3_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M730.02,-14655.61C732.88,-14655.18 735.71,-14654.78 738.5,-14654.43 1149.63,-14602.44 2426.08,-14591.2 2846.61,-14588.89"/>
<polygon fill="black" stroke="black" points="2846.7,-14592.39 2856.69,-14588.83 2846.67,-14585.39 2846.7,-14592.39"/>
</g>
<!-- expert_4_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge270" class="edge">
<title>expert_4_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M917.03,-14655.62C919.88,-14655.18 922.71,-14654.78 925.5,-14654.43 1298.74,-14606.73 2450.22,-14592.76 2846.7,-14589.31"/>
<polygon fill="black" stroke="black" points="2846.81,-14592.81 2856.78,-14589.23 2846.75,-14585.81 2846.81,-14592.81"/>
</g>
<!-- expert_5_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge271" class="edge">
<title>expert_5_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M1104.03,-14655.64C1106.88,-14655.19 1109.71,-14654.79 1112.5,-14654.43 1447.94,-14611.01 2474.98,-14594.48 2846.54,-14589.82"/>
<polygon fill="black" stroke="black" points="2846.85,-14593.32 2856.8,-14589.7 2846.76,-14586.32 2846.85,-14593.32"/>
</g>
<!-- expert_6_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge272" class="edge">
<title>expert_6_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M1291.03,-14655.65C1293.88,-14655.2 1296.71,-14654.79 1299.5,-14654.43 1597.53,-14615.26 2502.38,-14596.36 2847.13,-14590.44"/>
<polygon fill="black" stroke="black" points="2847.23,-14593.94 2857.17,-14590.27 2847.11,-14586.94 2847.23,-14593.94"/>
</g>
<!-- expert_7_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge273" class="edge">
<title>expert_7_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M1478.03,-14655.67C1480.88,-14655.22 1483.71,-14654.8 1486.5,-14654.43 1747.22,-14619.51 2530.56,-14598.48 2847.35,-14591.2"/>
<polygon fill="black" stroke="black" points="2847.58,-14594.7 2857.5,-14590.97 2847.42,-14587.7 2847.58,-14594.7"/>
</g>
<!-- expert_8_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge274" class="edge">
<title>expert_8_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M1665.03,-14655.69C1667.88,-14655.23 1670.71,-14654.81 1673.5,-14654.43 2098.54,-14596.14 2607.53,-14587.85 2846.26,-14587.52"/>
<polygon fill="black" stroke="black" points="2846.39,-14591.02 2856.38,-14587.52 2846.38,-14584.02 2846.39,-14591.02"/>
</g>
<!-- expert_9_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge275" class="edge">
<title>expert_9_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M1852.04,-14655.72C1854.89,-14655.25 1857.71,-14654.82 1860.5,-14654.43 2213.6,-14604.5 2634.37,-14592.16 2846.24,-14589.19"/>
<polygon fill="black" stroke="black" points="2846.52,-14592.69 2856.48,-14589.05 2846.43,-14585.69 2846.52,-14592.69"/>
</g>
<!-- expert_10_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge276" class="edge">
<title>expert_10_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M2039.05,-14655.76C2041.89,-14655.28 2044.72,-14654.84 2047.5,-14654.43 2330.13,-14612.77 2664.83,-14597.15 2847.27,-14591.45"/>
<polygon fill="black" stroke="black" points="2847.57,-14594.95 2857.46,-14591.14 2847.35,-14587.95 2847.57,-14594.95"/>
</g>
<!-- expert_11_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge277" class="edge">
<title>expert_11_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M2226.05,-14655.83C2228.9,-14655.33 2231.72,-14654.86 2234.5,-14654.43 2448.23,-14621 2699.16,-14603.13 2849.26,-14594.69"/>
<polygon fill="black" stroke="black" points="2849.66,-14598.18 2859.45,-14594.13 2849.27,-14591.19 2849.66,-14598.18"/>
</g>
<!-- expert_12_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge278" class="edge">
<title>expert_12_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M2413.07,-14655.93C2415.91,-14655.41 2418.73,-14654.9 2421.5,-14654.43 2569.28,-14629.1 2740.64,-14610.45 2854.7,-14599.53"/>
<polygon fill="black" stroke="black" points="2855.24,-14602.99 2864.87,-14598.56 2854.58,-14596.02 2855.24,-14602.99"/>
</g>
<!-- expert_13_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge279" class="edge">
<title>expert_13_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M2600.11,-14656.14C2602.94,-14655.55 2605.74,-14654.98 2608.5,-14654.43 2695.55,-14636.91 2794.51,-14619.53 2868.76,-14606.99"/>
<polygon fill="black" stroke="black" points="2869.79,-14610.36 2879.07,-14605.25 2868.63,-14603.46 2869.79,-14610.36"/>
</g>
<!-- expert_14_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge280" class="edge">
<title>expert_14_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M2770.28,-14654.34C2808.19,-14642.54 2855.83,-14627.72 2896.36,-14615.11"/>
<polygon fill="black" stroke="black" points="2897.45,-14618.44 2905.96,-14612.13 2895.37,-14611.75 2897.45,-14618.44"/>
</g>
<!-- expert_15_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge281" class="edge">
<title>expert_15_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M2912.01,-14654.34C2921.53,-14645.42 2932.9,-14634.77 2943.7,-14624.65"/>
<polygon fill="black" stroke="black" points="2946.15,-14627.15 2951.06,-14617.76 2941.37,-14622.05 2946.15,-14627.15"/>
</g>
<!-- expert_16_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge282" class="edge">
<title>expert_16_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M3053.75,-14654.34C3044.12,-14645.42 3032.63,-14634.77 3021.71,-14624.65"/>
<polygon fill="black" stroke="black" points="3023.99,-14621.99 3014.28,-14617.76 3019.23,-14627.13 3023.99,-14621.99"/>
</g>
<!-- expert_17_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge283" class="edge">
<title>expert_17_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M3195.48,-14654.34C3157.36,-14642.52 3109.44,-14627.66 3068.71,-14615.04"/>
<polygon fill="black" stroke="black" points="3069.65,-14611.67 3059.06,-14612.05 3067.58,-14618.35 3069.65,-14611.67"/>
</g>
<!-- expert_18_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge284" class="edge">
<title>expert_18_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M3365.89,-14656.14C3363.06,-14655.55 3360.26,-14654.98 3357.5,-14654.43 3269.89,-14636.82 3170.24,-14619.37 3095.69,-14606.83"/>
<polygon fill="black" stroke="black" points="3096.25,-14603.37 3085.81,-14605.17 3095.09,-14610.27 3096.25,-14603.37"/>
</g>
<!-- expert_19_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge285" class="edge">
<title>expert_19_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M3552.93,-14655.93C3550.09,-14655.4 3547.27,-14654.9 3544.5,-14654.43 3396.34,-14629.05 3224.52,-14610.39 3110.26,-14599.49"/>
<polygon fill="black" stroke="black" points="3110.36,-14595.98 3100.07,-14598.52 3109.69,-14602.95 3110.36,-14595.98"/>
</g>
<!-- expert_20_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge286" class="edge">
<title>expert_20_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M3739.95,-14655.83C3737.1,-14655.33 3734.28,-14654.86 3731.5,-14654.43 3517.33,-14620.95 3265.85,-14603.08 3115.58,-14594.66"/>
<polygon fill="black" stroke="black" points="3115.57,-14591.16 3105.39,-14594.1 3115.18,-14598.15 3115.57,-14591.16"/>
</g>
<!-- expert_21_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge287" class="edge">
<title>expert_21_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M3926.96,-14655.76C3924.11,-14655.28 3921.28,-14654.84 3918.5,-14654.43 3635.57,-14612.73 3300.51,-14597.13 3117.87,-14591.44"/>
<polygon fill="black" stroke="black" points="3117.78,-14587.94 3107.68,-14591.13 3117.57,-14594.94 3117.78,-14587.94"/>
</g>
<!-- expert_22_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge288" class="edge">
<title>expert_22_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M4113.96,-14655.72C4111.11,-14655.25 4108.29,-14654.82 4105.5,-14654.43 3751.85,-14604.43 3330.37,-14592.13 3118.46,-14589.18"/>
<polygon fill="black" stroke="black" points="3118.26,-14585.67 3108.22,-14589.04 3118.17,-14592.67 3118.26,-14585.67"/>
</g>
<!-- expert_23_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge289" class="edge">
<title>expert_23_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M4300.97,-14655.69C4298.12,-14655.23 4295.29,-14654.81 4292.5,-14654.43 3867.13,-14596.11 3357.75,-14587.83 3118.84,-14587.52"/>
<polygon fill="black" stroke="black" points="3118.72,-14584.02 3108.71,-14587.51 3118.71,-14591.02 3118.72,-14584.02"/>
</g>
<!-- expert_24_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge290" class="edge">
<title>expert_24_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M4487.97,-14655.67C4485.12,-14655.22 4482.29,-14654.8 4479.5,-14654.43 4218.6,-14619.49 3434.74,-14598.48 3117.74,-14591.2"/>
<polygon fill="black" stroke="black" points="3117.66,-14587.7 3107.58,-14590.97 3117.5,-14594.7 3117.66,-14587.7"/>
</g>
<!-- expert_25_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge291" class="edge">
<title>expert_25_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M4674.97,-14655.65C4672.12,-14655.2 4669.29,-14654.79 4666.5,-14654.43 4368.29,-14615.24 3462.9,-14596.35 3117.95,-14590.43"/>
<polygon fill="black" stroke="black" points="3117.97,-14586.93 3107.91,-14590.26 3117.85,-14593.93 3117.97,-14586.93"/>
</g>
<!-- expert_26_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge292" class="edge">
<title>expert_26_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M4861.97,-14655.64C4859.12,-14655.19 4856.29,-14654.79 4853.5,-14654.43 4517.88,-14610.99 3490.29,-14594.47 3118.53,-14589.82"/>
<polygon fill="black" stroke="black" points="3118.31,-14586.32 3108.26,-14589.69 3118.22,-14593.32 3118.31,-14586.32"/>
</g>
<!-- expert_27_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge293" class="edge">
<title>expert_27_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M5048.97,-14655.62C5046.12,-14655.18 5043.29,-14654.78 5040.5,-14654.43 4667.07,-14606.71 3515.04,-14592.76 3118.36,-14589.31"/>
<polygon fill="black" stroke="black" points="3118.31,-14585.81 3108.28,-14589.22 3118.25,-14592.81 3118.31,-14585.81"/>
</g>
<!-- expert_28_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge294" class="edge">
<title>expert_28_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M5235.98,-14655.61C5233.12,-14655.18 5230.29,-14654.78 5227.5,-14654.43 4816.19,-14602.42 3539.17,-14591.2 3118.45,-14588.88"/>
<polygon fill="black" stroke="black" points="3118.39,-14585.38 3108.37,-14588.83 3118.35,-14592.38 3118.39,-14585.38"/>
</g>
<!-- expert_29_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge295" class="edge">
<title>expert_29_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M5422.98,-14655.61C5420.12,-14655.17 5417.29,-14654.78 5414.5,-14654.43 4965.28,-14598.15 3563,-14589.76 3118.86,-14588.52"/>
<polygon fill="black" stroke="black" points="3118.55,-14585.02 3108.54,-14588.5 3118.53,-14592.02 3118.55,-14585.02"/>
</g>
<!-- expert_30_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge296" class="edge">
<title>expert_30_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M5609.98,-14655.6C5607.12,-14655.17 5604.29,-14654.77 5601.5,-14654.43 5114.1,-14593.84 3585.1,-14588.43 3118.84,-14588.21"/>
<polygon fill="black" stroke="black" points="3118.69,-14584.71 3108.69,-14588.21 3118.69,-14591.71 3118.69,-14584.71"/>
</g>
<!-- expert_31_s1_l3&#45;&gt;expert_combine_s1_l3 -->
<g id="edge297" class="edge">
<title>expert_31_s1_l3&#45;&gt;expert_combine_s1_l3</title>
<path fill="none" stroke="black" d="M5796.98,-14655.59C5794.12,-14655.16 5791.29,-14654.77 5788.5,-14654.43 5262.84,-14589.54 3606.55,-14587.18 3118.88,-14587.94"/>
<polygon fill="black" stroke="black" points="3118.62,-14584.44 3108.62,-14587.96 3118.63,-14591.44 3118.62,-14584.44"/>
</g>
<!-- moe_out_proj_s1_l3 -->
<g id="node175" class="node">
<title>moe_out_proj_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-14520.2 2893.5,-14520.2 2893.5,-14476.2 3071.5,-14476.2 3071.5,-14520.2"/>
<text text-anchor="middle" x="2982.5" y="-14509.8" font-family="Arial" font-size="8.00">MoE Output Proj L3 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-14500.8" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14491.8" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14482.8" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1_l3&#45;&gt;moe_out_proj_s1_l3 -->
<g id="edge298" class="edge">
<title>expert_combine_s1_l3&#45;&gt;moe_out_proj_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-14555.84C2982.5,-14547.57 2982.5,-14538.59 2982.5,-14530.28"/>
<polygon fill="black" stroke="black" points="2986,-14530.2 2982.5,-14520.2 2979,-14530.2 2986,-14530.2"/>
</g>
<!-- allreduce_moe_out_s1_l3 -->
<g id="node176" class="node">
<title>allreduce_moe_out_s1_l3</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-14409.09" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-14420.69" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L3</text>
<text text-anchor="middle" x="2982.5" y="-14411.69" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14402.69" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14393.69" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1_l3&#45;&gt;allreduce_moe_out_s1_l3 -->
<g id="edge299" class="edge">
<title>moe_out_proj_s1_l3&#45;&gt;allreduce_moe_out_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-14476.11C2982.5,-14468.44 2982.5,-14459.49 2982.5,-14450.69"/>
<polygon fill="black" stroke="black" points="2986,-14450.53 2982.5,-14440.53 2979,-14450.53 2986,-14450.53"/>
</g>
<!-- layernorm2_s1_l3 -->
<g id="node177" class="node">
<title>layernorm2_s1_l3</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-14341.97 2893.5,-14341.97 2893.5,-14297.97 3071.5,-14297.97 3071.5,-14341.97"/>
<text text-anchor="middle" x="2982.5" y="-14331.57" font-family="Arial" font-size="8.00">LayerNorm 2 (L3)</text>
<text text-anchor="middle" x="2982.5" y="-14322.57" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14313.57" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14304.57" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1_l3&#45;&gt;layernorm2_s1_l3 -->
<g id="edge300" class="edge">
<title>allreduce_moe_out_s1_l3&#45;&gt;layernorm2_s1_l3</title>
<path fill="none" stroke="black" d="M2982.5,-14377.62C2982.5,-14369.34 2982.5,-14360.36 2982.5,-14352.05"/>
<polygon fill="black" stroke="black" points="2986,-14351.98 2982.5,-14341.98 2979,-14351.98 2986,-14351.98"/>
</g>
<!-- layernorm1_s1_l4 -->
<g id="node178" class="node">
<title>layernorm1_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-14261.97 2893.5,-14261.97 2893.5,-14217.97 3071.5,-14217.97 3071.5,-14261.97"/>
<text text-anchor="middle" x="2982.5" y="-14251.57" font-family="Arial" font-size="8.00">LayerNorm 1 (L4)</text>
<text text-anchor="middle" x="2982.5" y="-14242.57" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14233.57" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14224.57" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm2_s1_l3&#45;&gt;layernorm1_s1_l4 -->
<g id="edge301" class="edge">
<title>layernorm2_s1_l3&#45;&gt;layernorm1_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-14297.66C2982.5,-14289.77 2982.5,-14280.66 2982.5,-14272.08"/>
<polygon fill="black" stroke="black" points="2986,-14271.99 2982.5,-14261.99 2979,-14271.99 2986,-14271.99"/>
</g>
<!-- qkv_proj_s1_l4 -->
<g id="node179" class="node">
<title>qkv_proj_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3081,-14181.97 2884,-14181.97 2884,-14137.97 3081,-14137.97 3081,-14181.97"/>
<text text-anchor="middle" x="2982.5" y="-14171.57" font-family="Arial" font-size="8.00">QKV Projection L4 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-14162.57" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-14153.57" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-14144.57" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1_l4&#45;&gt;qkv_proj_s1_l4 -->
<g id="edge302" class="edge">
<title>layernorm1_s1_l4&#45;&gt;qkv_proj_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-14217.66C2982.5,-14209.77 2982.5,-14200.66 2982.5,-14192.08"/>
<polygon fill="black" stroke="black" points="2986,-14191.99 2982.5,-14181.99 2979,-14191.99 2986,-14191.99"/>
</g>
<!-- allreduce_qkv_s1_l4 -->
<g id="node180" class="node">
<title>allreduce_qkv_s1_l4</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-14070.86" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-14082.46" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L4</text>
<text text-anchor="middle" x="2982.5" y="-14073.46" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-14064.46" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-14055.46" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1_l4&#45;&gt;allreduce_qkv_s1_l4 -->
<g id="edge303" class="edge">
<title>qkv_proj_s1_l4&#45;&gt;allreduce_qkv_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-14137.89C2982.5,-14130.21 2982.5,-14121.26 2982.5,-14112.47"/>
<polygon fill="black" stroke="black" points="2986,-14112.31 2982.5,-14102.31 2979,-14112.31 2986,-14112.31"/>
</g>
<!-- attention_s1_l4 -->
<g id="node181" class="node">
<title>attention_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3081,-14003.75 2884,-14003.75 2884,-13959.75 3081,-13959.75 3081,-14003.75"/>
<text text-anchor="middle" x="2982.5" y="-13993.35" font-family="Arial" font-size="8.00">Self&#45;Attention L4</text>
<text text-anchor="middle" x="2982.5" y="-13984.35" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-13975.35" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-13966.35" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1_l4&#45;&gt;attention_s1_l4 -->
<g id="edge304" class="edge">
<title>allreduce_qkv_s1_l4&#45;&gt;attention_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-14039.39C2982.5,-14031.11 2982.5,-14022.14 2982.5,-14013.83"/>
<polygon fill="black" stroke="black" points="2986,-14013.75 2982.5,-14003.75 2979,-14013.75 2986,-14013.75"/>
</g>
<!-- attn_out_proj_s1_l4 -->
<g id="node182" class="node">
<title>attn_out_proj_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3078,-13923.75 2887,-13923.75 2887,-13879.75 3078,-13879.75 3078,-13923.75"/>
<text text-anchor="middle" x="2982.5" y="-13913.35" font-family="Arial" font-size="8.00">Attention Output Proj L4 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-13904.35" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-13895.35" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13886.35" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1_l4&#45;&gt;attn_out_proj_s1_l4 -->
<g id="edge305" class="edge">
<title>attention_s1_l4&#45;&gt;attn_out_proj_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-13959.44C2982.5,-13951.55 2982.5,-13942.43 2982.5,-13933.85"/>
<polygon fill="black" stroke="black" points="2986,-13933.77 2982.5,-13923.77 2979,-13933.77 2986,-13933.77"/>
</g>
<!-- allreduce_attn_out_s1_l4 -->
<g id="node183" class="node">
<title>allreduce_attn_out_s1_l4</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-13812.64" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-13824.24" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L4</text>
<text text-anchor="middle" x="2982.5" y="-13815.24" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13806.24" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13797.24" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1_l4&#45;&gt;allreduce_attn_out_s1_l4 -->
<g id="edge306" class="edge">
<title>attn_out_proj_s1_l4&#45;&gt;allreduce_attn_out_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-13879.66C2982.5,-13871.99 2982.5,-13863.04 2982.5,-13854.24"/>
<polygon fill="black" stroke="black" points="2986,-13854.08 2982.5,-13844.08 2979,-13854.08 2986,-13854.08"/>
</g>
<!-- moe_gate_s1_l4 -->
<g id="node184" class="node">
<title>moe_gate_s1_l4</title>
<polygon fill="orange" stroke="black" points="3167.08,-13745.52 2873.45,-13745.52 2797.92,-13657.52 3091.55,-13657.52 3167.08,-13745.52"/>
<text text-anchor="middle" x="2982.5" y="-13713.12" font-family="Arial" font-size="8.00">MoE Gate L4 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-13704.12" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13695.12" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13686.12" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1_l4&#45;&gt;moe_gate_s1_l4 -->
<g id="edge307" class="edge">
<title>allreduce_attn_out_s1_l4&#45;&gt;moe_gate_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-13781.24C2982.5,-13773.36 2982.5,-13764.63 2982.5,-13755.93"/>
<polygon fill="black" stroke="black" points="2986,-13755.8 2982.5,-13745.8 2979,-13755.8 2986,-13755.8"/>
</g>
<!-- expert_dispatch_s1_l4 -->
<g id="node185" class="node">
<title>expert_dispatch_s1_l4</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-13590.41" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-13602.01" font-family="Arial" font-size="8.00">Expert Dispatch L4 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-13593.01" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13584.01" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13575.01" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1_l4&#45;&gt;expert_dispatch_s1_l4 -->
<g id="edge308" class="edge">
<title>moe_gate_s1_l4&#45;&gt;expert_dispatch_s1_l4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-13657.4C2982.5,-13649.02 2982.5,-13640.27 2982.5,-13631.98"/>
<polygon fill="black" stroke="black" points="2986,-13631.79 2982.5,-13621.79 2979,-13631.79 2986,-13631.79"/>
</g>
<!-- expert_0_s1_l4 -->
<g id="node186" class="node">
<title>expert_0_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="169,-13523.3 0,-13523.3 0,-13479.3 169,-13479.3 169,-13523.3"/>
<text text-anchor="middle" x="84.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 0 L4</text>
<text text-anchor="middle" x="84.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_0_s1_l4 -->
<g id="edge309" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_0_s1_l4</title>
<path fill="none" stroke="black" d="M2856.42,-13589.76C2385.23,-13590.57 727.13,-13588.65 178.99,-13523.34"/>
<polygon fill="black" stroke="black" points="179.37,-13519.86 169.02,-13522.13 178.53,-13526.81 179.37,-13519.86"/>
</g>
<!-- expert_1_s1_l4 -->
<g id="node187" class="node">
<title>expert_1_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="356,-13523.3 187,-13523.3 187,-13479.3 356,-13479.3 356,-13523.3"/>
<text text-anchor="middle" x="271.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 1 L4</text>
<text text-anchor="middle" x="271.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_1_s1_l4 -->
<g id="edge310" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_1_s1_l4</title>
<path fill="none" stroke="black" d="M2856.36,-13589.51C2405.73,-13589.37 875.66,-13584.37 366.03,-13523.35"/>
<polygon fill="black" stroke="black" points="366.37,-13519.86 356.02,-13522.13 365.52,-13526.81 366.37,-13519.86"/>
</g>
<!-- expert_2_s1_l4 -->
<g id="node188" class="node">
<title>expert_2_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="543,-13523.3 374,-13523.3 374,-13479.3 543,-13479.3 543,-13523.3"/>
<text text-anchor="middle" x="458.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 2 L4</text>
<text text-anchor="middle" x="458.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_2_s1_l4 -->
<g id="edge311" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_2_s1_l4</title>
<path fill="none" stroke="black" d="M2856.51,-13589.23C2427.43,-13588.09 1024.14,-13580.11 552.96,-13523.34"/>
<polygon fill="black" stroke="black" points="553.38,-13519.87 543.02,-13522.12 552.52,-13526.81 553.38,-13519.87"/>
</g>
<!-- expert_3_s1_l4 -->
<g id="node189" class="node">
<title>expert_3_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="730,-13523.3 561,-13523.3 561,-13479.3 730,-13479.3 730,-13523.3"/>
<text text-anchor="middle" x="645.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 3 L4</text>
<text text-anchor="middle" x="645.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_3_s1_l4 -->
<g id="edge312" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_3_s1_l4</title>
<path fill="none" stroke="black" d="M2856.69,-13588.89C2450.07,-13586.72 1173.13,-13575.87 740.1,-13523.36"/>
<polygon fill="black" stroke="black" points="740.38,-13519.87 730.02,-13522.11 739.52,-13526.81 740.38,-13519.87"/>
</g>
<!-- expert_4_s1_l4 -->
<g id="node190" class="node">
<title>expert_4_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="917,-13523.3 748,-13523.3 748,-13479.3 917,-13479.3 917,-13523.3"/>
<text text-anchor="middle" x="832.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 4 L4</text>
<text text-anchor="middle" x="832.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_4_s1_l4 -->
<g id="edge313" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_4_s1_l4</title>
<path fill="none" stroke="black" d="M2856.78,-13588.5C2473.43,-13585.23 1321.87,-13571.64 927.06,-13523.36"/>
<polygon fill="black" stroke="black" points="927.38,-13519.87 917.03,-13522.1 926.51,-13526.81 927.38,-13519.87"/>
</g>
<!-- expert_5_s1_l4 -->
<g id="node191" class="node">
<title>expert_5_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="1104,-13523.3 935,-13523.3 935,-13479.3 1104,-13479.3 1104,-13523.3"/>
<text text-anchor="middle" x="1019.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 5 L4</text>
<text text-anchor="middle" x="1019.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_5_s1_l4 -->
<g id="edge314" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_5_s1_l4</title>
<path fill="none" stroke="black" d="M2856.8,-13588.03C2497.73,-13583.59 1470.88,-13567.43 1114.13,-13523.37"/>
<polygon fill="black" stroke="black" points="1114.39,-13519.87 1104.03,-13522.09 1113.51,-13526.82 1114.39,-13519.87"/>
</g>
<!-- expert_6_s1_l4 -->
<g id="node192" class="node">
<title>expert_6_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="1291,-13523.3 1122,-13523.3 1122,-13479.3 1291,-13479.3 1291,-13523.3"/>
<text text-anchor="middle" x="1206.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 6 L4</text>
<text text-anchor="middle" x="1206.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_6_s1_l4 -->
<g id="edge315" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_6_s1_l4</title>
<path fill="none" stroke="black" d="M2857.17,-13587.46C2523.91,-13581.8 1620.17,-13563.26 1301.21,-13523.38"/>
<polygon fill="black" stroke="black" points="1301.39,-13519.88 1291.03,-13522.07 1300.5,-13526.82 1301.39,-13519.88"/>
</g>
<!-- expert_7_s1_l4 -->
<g id="node193" class="node">
<title>expert_7_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="1478,-13523.3 1309,-13523.3 1309,-13479.3 1478,-13479.3 1478,-13523.3"/>
<text text-anchor="middle" x="1393.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 7 L4</text>
<text text-anchor="middle" x="1393.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_7_s1_l4 -->
<g id="edge316" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_7_s1_l4</title>
<path fill="none" stroke="black" d="M2857.5,-13586.75C2551.41,-13579.78 1769.45,-13559.11 1488.23,-13523.39"/>
<polygon fill="black" stroke="black" points="1488.4,-13519.88 1478.03,-13522.06 1487.49,-13526.82 1488.4,-13519.88"/>
</g>
<!-- expert_8_s1_l4 -->
<g id="node194" class="node">
<title>expert_8_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="1665,-13523.3 1496,-13523.3 1496,-13479.3 1665,-13479.3 1665,-13523.3"/>
<text text-anchor="middle" x="1580.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 8 L4</text>
<text text-anchor="middle" x="1580.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_8_s1_l4 -->
<g id="edge317" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_8_s1_l4</title>
<path fill="none" stroke="black" d="M2856.38,-13590.21C2623.94,-13590.1 2112.47,-13582.53 1675.03,-13523.4"/>
<polygon fill="black" stroke="black" points="1675.42,-13519.92 1665.03,-13522.03 1674.47,-13526.85 1675.42,-13519.92"/>
</g>
<!-- expert_9_s1_l4 -->
<g id="node195" class="node">
<title>expert_9_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="1852,-13523.3 1683,-13523.3 1683,-13479.3 1852,-13479.3 1852,-13523.3"/>
<text text-anchor="middle" x="1767.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 9 L4</text>
<text text-anchor="middle" x="1767.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_9_s1_l4 -->
<g id="edge318" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_9_s1_l4</title>
<path fill="none" stroke="black" d="M2856.48,-13588.67C2650.05,-13585.98 2227.11,-13574.26 1862.01,-13523.4"/>
<polygon fill="black" stroke="black" points="1862.43,-13519.93 1852.04,-13522 1861.45,-13526.86 1862.43,-13519.93"/>
</g>
<!-- expert_10_s1_l4 -->
<g id="node196" class="node">
<title>expert_10_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="2039,-13523.3 1870,-13523.3 1870,-13479.3 2039,-13479.3 2039,-13523.3"/>
<text text-anchor="middle" x="1954.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 10 L4</text>
<text text-anchor="middle" x="1954.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_10_s1_l4 -->
<g id="edge319" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_10_s1_l4</title>
<path fill="none" stroke="black" d="M2857.46,-13586.58C2679.53,-13581.21 2343.14,-13566.09 2049.05,-13523.42"/>
<polygon fill="black" stroke="black" points="2049.45,-13519.95 2039.05,-13521.96 2048.43,-13526.87 2049.45,-13519.95"/>
</g>
<!-- expert_11_s1_l4 -->
<g id="node197" class="node">
<title>expert_11_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="2226,-13523.3 2057,-13523.3 2057,-13479.3 2226,-13479.3 2226,-13523.3"/>
<text text-anchor="middle" x="2141.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 11 L4</text>
<text text-anchor="middle" x="2141.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_11_s1_l4 -->
<g id="edge320" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_11_s1_l4</title>
<path fill="none" stroke="black" d="M2859.45,-13583.6C2712.89,-13575.53 2460.66,-13558.01 2236.05,-13523.45"/>
<polygon fill="black" stroke="black" points="2236.47,-13519.97 2226.05,-13521.9 2235.4,-13526.89 2236.47,-13519.97"/>
</g>
<!-- expert_12_s1_l4 -->
<g id="node198" class="node">
<title>expert_12_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="2413,-13523.3 2244,-13523.3 2244,-13479.3 2413,-13479.3 2413,-13523.3"/>
<text text-anchor="middle" x="2328.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 12 L4</text>
<text text-anchor="middle" x="2328.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_12_s1_l4 -->
<g id="edge321" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_12_s1_l4</title>
<path fill="none" stroke="black" d="M2864.87,-13579.17C2753.34,-13568.62 2580.99,-13550.16 2422.98,-13523.48"/>
<polygon fill="black" stroke="black" points="2423.52,-13520.02 2413.07,-13521.79 2422.34,-13526.92 2423.52,-13520.02"/>
</g>
<!-- expert_13_s1_l4 -->
<g id="node199" class="node">
<title>expert_13_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="2600,-13523.3 2431,-13523.3 2431,-13479.3 2600,-13479.3 2600,-13523.3"/>
<text text-anchor="middle" x="2515.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 13 L4</text>
<text text-anchor="middle" x="2515.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_13_s1_l4 -->
<g id="edge322" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_13_s1_l4</title>
<path fill="none" stroke="black" d="M2879.07,-13572.47C2806.34,-13560.25 2706.53,-13542.84 2610.04,-13523.57"/>
<polygon fill="black" stroke="black" points="2610.6,-13520.12 2600.11,-13521.58 2609.23,-13526.98 2610.6,-13520.12"/>
</g>
<!-- expert_14_s1_l4 -->
<g id="node200" class="node">
<title>expert_14_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="2787,-13523.3 2618,-13523.3 2618,-13479.3 2787,-13479.3 2787,-13523.3"/>
<text text-anchor="middle" x="2702.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 14 L4</text>
<text text-anchor="middle" x="2702.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_14_s1_l4 -->
<g id="edge323" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_14_s1_l4</title>
<path fill="none" stroke="black" d="M2905.99,-13565.61C2866.88,-13553.44 2819.39,-13538.66 2780.12,-13526.45"/>
<polygon fill="black" stroke="black" points="2780.91,-13523.03 2770.32,-13523.4 2778.83,-13529.71 2780.91,-13523.03"/>
</g>
<!-- expert_15_s1_l4 -->
<g id="node201" class="node">
<title>expert_15_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="2974,-13523.3 2805,-13523.3 2805,-13479.3 2974,-13479.3 2974,-13523.3"/>
<text text-anchor="middle" x="2889.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 15 L4</text>
<text text-anchor="middle" x="2889.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_15_s1_l4 -->
<g id="edge324" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_15_s1_l4</title>
<path fill="none" stroke="black" d="M2951.27,-13560.16C2941.01,-13550.55 2929.64,-13539.89 2919.47,-13530.37"/>
<polygon fill="black" stroke="black" points="2921.66,-13527.63 2911.97,-13523.35 2916.88,-13532.74 2921.66,-13527.63"/>
</g>
<!-- expert_16_s1_l4 -->
<g id="node202" class="node">
<title>expert_16_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3161,-13523.3 2992,-13523.3 2992,-13479.3 3161,-13479.3 3161,-13523.3"/>
<text text-anchor="middle" x="3076.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 16 L4</text>
<text text-anchor="middle" x="3076.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_16_s1_l4 -->
<g id="edge325" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_16_s1_l4</title>
<path fill="none" stroke="black" d="M3014.06,-13560.16C3024.43,-13550.55 3035.93,-13539.89 3046.21,-13530.37"/>
<polygon fill="black" stroke="black" points="3048.83,-13532.71 3053.78,-13523.35 3044.07,-13527.58 3048.83,-13532.71"/>
</g>
<!-- expert_17_s1_l4 -->
<g id="node203" class="node">
<title>expert_17_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3348,-13523.3 3179,-13523.3 3179,-13479.3 3348,-13479.3 3348,-13523.3"/>
<text text-anchor="middle" x="3263.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 17 L4</text>
<text text-anchor="middle" x="3263.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_17_s1_l4 -->
<g id="edge326" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_17_s1_l4</title>
<path fill="none" stroke="black" d="M3059.28,-13565.61C3098.53,-13553.44 3146.2,-13538.66 3185.6,-13526.45"/>
<polygon fill="black" stroke="black" points="3186.92,-13529.7 3195.43,-13523.4 3184.84,-13523.02 3186.92,-13529.7"/>
</g>
<!-- expert_18_s1_l4 -->
<g id="node204" class="node">
<title>expert_18_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3535,-13523.3 3366,-13523.3 3366,-13479.3 3535,-13479.3 3535,-13523.3"/>
<text text-anchor="middle" x="3450.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 18 L4</text>
<text text-anchor="middle" x="3450.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_18_s1_l4 -->
<g id="edge327" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_18_s1_l4</title>
<path fill="none" stroke="black" d="M3085.81,-13572.56C3158.76,-13560.34 3259.03,-13542.9 3355.92,-13523.58"/>
<polygon fill="black" stroke="black" points="3356.77,-13526.98 3365.89,-13521.58 3355.4,-13520.12 3356.77,-13526.98"/>
</g>
<!-- expert_19_s1_l4 -->
<g id="node205" class="node">
<title>expert_19_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3722,-13523.3 3553,-13523.3 3553,-13479.3 3722,-13479.3 3722,-13523.3"/>
<text text-anchor="middle" x="3637.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 19 L4</text>
<text text-anchor="middle" x="3637.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_19_s1_l4 -->
<g id="edge328" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_19_s1_l4</title>
<path fill="none" stroke="black" d="M3100.07,-13579.2C3211.79,-13568.67 3384.6,-13550.21 3543,-13523.48"/>
<polygon fill="black" stroke="black" points="3543.66,-13526.92 3552.93,-13521.79 3542.48,-13520.02 3543.66,-13526.92"/>
</g>
<!-- expert_20_s1_l4 -->
<g id="node206" class="node">
<title>expert_20_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3909,-13523.3 3740,-13523.3 3740,-13479.3 3909,-13479.3 3909,-13523.3"/>
<text text-anchor="middle" x="3824.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 20 L4</text>
<text text-anchor="middle" x="3824.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_20_s1_l4 -->
<g id="edge329" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_20_s1_l4</title>
<path fill="none" stroke="black" d="M3105.39,-13583.63C3252.09,-13575.57 3504.87,-13558.07 3729.93,-13523.45"/>
<polygon fill="black" stroke="black" points="3730.6,-13526.89 3739.95,-13521.9 3729.53,-13519.97 3730.6,-13526.89"/>
</g>
<!-- expert_21_s1_l4 -->
<g id="node207" class="node">
<title>expert_21_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="4096,-13523.3 3927,-13523.3 3927,-13479.3 4096,-13479.3 4096,-13523.3"/>
<text text-anchor="middle" x="4011.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 21 L4</text>
<text text-anchor="middle" x="4011.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_21_s1_l4 -->
<g id="edge330" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_21_s1_l4</title>
<path fill="none" stroke="black" d="M3107.68,-13586.59C3285.8,-13581.23 3622.55,-13566.12 3916.94,-13523.43"/>
<polygon fill="black" stroke="black" points="3917.57,-13526.87 3926.96,-13521.96 3916.55,-13519.95 3917.57,-13526.87"/>
</g>
<!-- expert_22_s1_l4 -->
<g id="node208" class="node">
<title>expert_22_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="4283,-13523.3 4114,-13523.3 4114,-13479.3 4283,-13479.3 4283,-13523.3"/>
<text text-anchor="middle" x="4198.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 22 L4</text>
<text text-anchor="middle" x="4198.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_22_s1_l4 -->
<g id="edge331" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_22_s1_l4</title>
<path fill="none" stroke="black" d="M3108.22,-13588.69C3314.67,-13586.02 3738.31,-13574.33 4103.98,-13523.41"/>
<polygon fill="black" stroke="black" points="4104.55,-13526.86 4113.96,-13522 4103.57,-13519.93 4104.55,-13526.86"/>
</g>
<!-- expert_23_s1_l4 -->
<g id="node209" class="node">
<title>expert_23_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="4470,-13523.3 4301,-13523.3 4301,-13479.3 4470,-13479.3 4470,-13523.3"/>
<text text-anchor="middle" x="4385.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 23 L4</text>
<text text-anchor="middle" x="4385.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_23_s1_l4 -->
<g id="edge332" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_23_s1_l4</title>
<path fill="none" stroke="black" d="M3108.71,-13590.22C3341.33,-13590.12 3853.2,-13582.57 4290.96,-13523.4"/>
<polygon fill="black" stroke="black" points="4291.53,-13526.85 4300.97,-13522.03 4290.58,-13519.92 4291.53,-13526.85"/>
</g>
<!-- expert_24_s1_l4 -->
<g id="node210" class="node">
<title>expert_24_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="4657,-13523.3 4488,-13523.3 4488,-13479.3 4657,-13479.3 4657,-13523.3"/>
<text text-anchor="middle" x="4572.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 24 L4</text>
<text text-anchor="middle" x="4572.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_24_s1_l4 -->
<g id="edge333" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_24_s1_l4</title>
<path fill="none" stroke="black" d="M3107.58,-13586.75C3413.87,-13579.79 4196.36,-13559.12 4477.77,-13523.39"/>
<polygon fill="black" stroke="black" points="4478.51,-13526.82 4487.97,-13522.06 4477.6,-13519.88 4478.51,-13526.82"/>
</g>
<!-- expert_25_s1_l4 -->
<g id="node211" class="node">
<title>expert_25_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="4844,-13523.3 4675,-13523.3 4675,-13479.3 4844,-13479.3 4844,-13523.3"/>
<text text-anchor="middle" x="4759.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 25 L4</text>
<text text-anchor="middle" x="4759.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_25_s1_l4 -->
<g id="edge334" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_25_s1_l4</title>
<path fill="none" stroke="black" d="M3107.91,-13587.46C3441.37,-13581.8 4345.64,-13563.28 4664.78,-13523.38"/>
<polygon fill="black" stroke="black" points="4665.5,-13526.82 4674.97,-13522.07 4664.61,-13519.88 4665.5,-13526.82"/>
</g>
<!-- expert_26_s1_l4 -->
<g id="node212" class="node">
<title>expert_26_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="5031,-13523.3 4862,-13523.3 4862,-13479.3 5031,-13479.3 5031,-13523.3"/>
<text text-anchor="middle" x="4946.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 26 L4</text>
<text text-anchor="middle" x="4946.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_26_s1_l4 -->
<g id="edge335" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_26_s1_l4</title>
<path fill="none" stroke="black" d="M3108.26,-13588.03C3467.53,-13583.6 4494.93,-13567.45 4851.87,-13523.37"/>
<polygon fill="black" stroke="black" points="4852.49,-13526.82 4861.97,-13522.09 4851.61,-13519.87 4852.49,-13526.82"/>
</g>
<!-- expert_27_s1_l4 -->
<g id="node213" class="node">
<title>expert_27_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="5218,-13523.3 5049,-13523.3 5049,-13479.3 5218,-13479.3 5218,-13523.3"/>
<text text-anchor="middle" x="5133.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 27 L4</text>
<text text-anchor="middle" x="5133.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_27_s1_l4 -->
<g id="edge336" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_27_s1_l4</title>
<path fill="none" stroke="black" d="M3108.28,-13588.5C3491.82,-13585.23 4643.94,-13571.66 5038.93,-13523.36"/>
<polygon fill="black" stroke="black" points="5039.49,-13526.81 5048.97,-13522.1 5038.62,-13519.87 5039.49,-13526.81"/>
</g>
<!-- expert_28_s1_l4 -->
<g id="node214" class="node">
<title>expert_28_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="5405,-13523.3 5236,-13523.3 5236,-13479.3 5405,-13479.3 5405,-13523.3"/>
<text text-anchor="middle" x="5320.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 28 L4</text>
<text text-anchor="middle" x="5320.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_28_s1_l4 -->
<g id="edge337" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_28_s1_l4</title>
<path fill="none" stroke="black" d="M3108.37,-13588.89C3515.16,-13586.72 4792.68,-13575.89 5225.9,-13523.36"/>
<polygon fill="black" stroke="black" points="5226.48,-13526.81 5235.98,-13522.11 5225.62,-13519.87 5226.48,-13526.81"/>
</g>
<!-- expert_29_s1_l4 -->
<g id="node215" class="node">
<title>expert_29_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="5592,-13523.3 5423,-13523.3 5423,-13479.3 5592,-13479.3 5592,-13523.3"/>
<text text-anchor="middle" x="5507.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 29 L4</text>
<text text-anchor="middle" x="5507.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_29_s1_l4 -->
<g id="edge338" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_29_s1_l4</title>
<path fill="none" stroke="black" d="M3108.54,-13589.23C3537.8,-13588.1 4941.67,-13580.13 5413.04,-13523.34"/>
<polygon fill="black" stroke="black" points="5413.48,-13526.81 5422.98,-13522.12 5412.62,-13519.87 5413.48,-13526.81"/>
</g>
<!-- expert_30_s1_l4 -->
<g id="node216" class="node">
<title>expert_30_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="5779,-13523.3 5610,-13523.3 5610,-13479.3 5779,-13479.3 5779,-13523.3"/>
<text text-anchor="middle" x="5694.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 30 L4</text>
<text text-anchor="middle" x="5694.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_30_s1_l4 -->
<g id="edge339" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_30_s1_l4</title>
<path fill="none" stroke="black" d="M3108.69,-13589.51C3559.49,-13589.38 5090.14,-13584.39 5599.96,-13523.35"/>
<polygon fill="black" stroke="black" points="5600.48,-13526.81 5609.98,-13522.13 5599.63,-13519.86 5600.48,-13526.81"/>
</g>
<!-- expert_31_s1_l4 -->
<g id="node217" class="node">
<title>expert_31_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="5966,-13523.3 5797,-13523.3 5797,-13479.3 5966,-13479.3 5966,-13523.3"/>
<text text-anchor="middle" x="5881.5" y="-13512.9" font-family="Arial" font-size="8.00">Expert 31 L4</text>
<text text-anchor="middle" x="5881.5" y="-13503.9" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-13494.9" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-13485.9" font-family="Arial" font-size="8.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1_l4&#45;&gt;expert_31_s1_l4 -->
<g id="edge340" class="edge">
<title>expert_dispatch_s1_l4&#45;&gt;expert_31_s1_l4</title>
<path fill="none" stroke="black" d="M3108.62,-13589.76C3579.98,-13590.57 5238.67,-13588.67 5787,-13523.34"/>
<polygon fill="black" stroke="black" points="5787.47,-13526.81 5796.98,-13522.13 5786.63,-13519.86 5787.47,-13526.81"/>
</g>
<!-- expert_combine_s1_l4 -->
<g id="node218" class="node">
<title>expert_combine_s1_l4</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-13412.19" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-13423.79" font-family="Arial" font-size="8.00">Expert Combine L4 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-13414.79" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-13405.79" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13396.79" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge341" class="edge">
<title>expert_0_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M169.02,-13480.47C171.88,-13480.03 174.71,-13479.64 177.5,-13479.3 702.97,-13414.43 2358.67,-13412.06 2846.17,-13412.82"/>
<polygon fill="black" stroke="black" points="2846.42,-13416.32 2856.42,-13412.83 2846.43,-13409.32 2846.42,-13416.32"/>
</g>
<!-- expert_1_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge342" class="edge">
<title>expert_1_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M356.02,-13480.47C358.88,-13480.04 361.71,-13479.65 364.5,-13479.3 851.71,-13418.74 2380.13,-13413.31 2846.21,-13413.09"/>
<polygon fill="black" stroke="black" points="2846.36,-13416.59 2856.36,-13413.08 2846.36,-13409.59 2846.36,-13416.59"/>
</g>
<!-- expert_2_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge343" class="edge">
<title>expert_2_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M543.02,-13480.48C545.88,-13480.04 548.71,-13479.65 551.5,-13479.3 1000.54,-13423.04 2402.24,-13414.64 2846.2,-13413.4"/>
<polygon fill="black" stroke="black" points="2846.52,-13416.9 2856.51,-13413.37 2846.5,-13409.9 2846.52,-13416.9"/>
</g>
<!-- expert_3_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge344" class="edge">
<title>expert_3_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M730.02,-13480.49C732.88,-13480.05 735.71,-13479.65 738.5,-13479.3 1149.63,-13427.32 2426.08,-13416.08 2846.61,-13413.76"/>
<polygon fill="black" stroke="black" points="2846.7,-13417.26 2856.69,-13413.7 2846.67,-13410.26 2846.7,-13417.26"/>
</g>
<!-- expert_4_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge345" class="edge">
<title>expert_4_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M917.03,-13480.5C919.88,-13480.06 922.71,-13479.66 925.5,-13479.3 1298.74,-13431.6 2450.22,-13417.64 2846.7,-13414.19"/>
<polygon fill="black" stroke="black" points="2846.81,-13417.68 2856.78,-13414.1 2846.75,-13410.68 2846.81,-13417.68"/>
</g>
<!-- expert_5_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge346" class="edge">
<title>expert_5_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M1104.03,-13480.51C1106.88,-13480.07 1109.71,-13479.66 1112.5,-13479.3 1447.94,-13435.88 2474.98,-13419.35 2846.54,-13414.7"/>
<polygon fill="black" stroke="black" points="2846.85,-13418.19 2856.8,-13414.57 2846.76,-13411.19 2846.85,-13418.19"/>
</g>
<!-- expert_6_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge347" class="edge">
<title>expert_6_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M1291.03,-13480.52C1293.88,-13480.08 1296.71,-13479.67 1299.5,-13479.3 1597.53,-13440.13 2502.38,-13421.23 2847.13,-13415.31"/>
<polygon fill="black" stroke="black" points="2847.23,-13418.81 2857.17,-13415.14 2847.11,-13411.81 2847.23,-13418.81"/>
</g>
<!-- expert_7_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge348" class="edge">
<title>expert_7_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M1478.03,-13480.54C1480.88,-13480.09 1483.71,-13479.67 1486.5,-13479.3 1747.22,-13444.38 2530.56,-13423.36 2847.35,-13416.08"/>
<polygon fill="black" stroke="black" points="2847.58,-13419.57 2857.5,-13415.85 2847.42,-13412.58 2847.58,-13419.57"/>
</g>
<!-- expert_8_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge349" class="edge">
<title>expert_8_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M1665.03,-13480.56C1667.88,-13480.1 1670.71,-13479.68 1673.5,-13479.3 2098.54,-13421.02 2607.53,-13412.72 2846.26,-13412.4"/>
<polygon fill="black" stroke="black" points="2846.39,-13415.9 2856.38,-13412.39 2846.38,-13408.9 2846.39,-13415.9"/>
</g>
<!-- expert_9_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge350" class="edge">
<title>expert_9_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M1852.04,-13480.59C1854.89,-13480.13 1857.71,-13479.69 1860.5,-13479.3 2213.6,-13429.37 2634.37,-13417.03 2846.24,-13414.06"/>
<polygon fill="black" stroke="black" points="2846.52,-13417.56 2856.48,-13413.92 2846.43,-13410.56 2846.52,-13417.56"/>
</g>
<!-- expert_10_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge351" class="edge">
<title>expert_10_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M2039.05,-13480.64C2041.89,-13480.16 2044.72,-13479.71 2047.5,-13479.3 2330.13,-13437.64 2664.83,-13422.03 2847.27,-13416.33"/>
<polygon fill="black" stroke="black" points="2847.57,-13419.82 2857.46,-13416.01 2847.35,-13412.82 2847.57,-13419.82"/>
</g>
<!-- expert_11_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge352" class="edge">
<title>expert_11_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M2226.05,-13480.7C2228.9,-13480.2 2231.72,-13479.73 2234.5,-13479.3 2448.23,-13445.88 2699.16,-13428 2849.26,-13419.57"/>
<polygon fill="black" stroke="black" points="2849.66,-13423.05 2859.45,-13419 2849.27,-13416.06 2849.66,-13423.05"/>
</g>
<!-- expert_12_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge353" class="edge">
<title>expert_12_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M2413.07,-13480.81C2415.91,-13480.28 2418.73,-13479.77 2421.5,-13479.3 2569.28,-13453.98 2740.64,-13435.32 2854.7,-13424.4"/>
<polygon fill="black" stroke="black" points="2855.24,-13427.86 2864.87,-13423.43 2854.58,-13420.89 2855.24,-13427.86"/>
</g>
<!-- expert_13_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge354" class="edge">
<title>expert_13_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M2600.11,-13481.02C2602.94,-13480.43 2605.74,-13479.85 2608.5,-13479.3 2695.55,-13461.79 2794.51,-13444.4 2868.76,-13431.86"/>
<polygon fill="black" stroke="black" points="2869.79,-13435.24 2879.07,-13430.12 2868.63,-13428.33 2869.79,-13435.24"/>
</g>
<!-- expert_14_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge355" class="edge">
<title>expert_14_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M2770.28,-13479.21C2808.19,-13467.42 2855.83,-13452.6 2896.36,-13439.99"/>
<polygon fill="black" stroke="black" points="2897.45,-13443.31 2905.96,-13437 2895.37,-13436.63 2897.45,-13443.31"/>
</g>
<!-- expert_15_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge356" class="edge">
<title>expert_15_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M2912.01,-13479.21C2921.53,-13470.29 2932.9,-13459.64 2943.7,-13449.53"/>
<polygon fill="black" stroke="black" points="2946.15,-13452.03 2951.06,-13442.64 2941.37,-13446.92 2946.15,-13452.03"/>
</g>
<!-- expert_16_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge357" class="edge">
<title>expert_16_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M3053.75,-13479.21C3044.12,-13470.29 3032.63,-13459.64 3021.71,-13449.53"/>
<polygon fill="black" stroke="black" points="3023.99,-13446.87 3014.28,-13442.64 3019.23,-13452 3023.99,-13446.87"/>
</g>
<!-- expert_17_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge358" class="edge">
<title>expert_17_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M3195.48,-13479.21C3157.36,-13467.39 3109.44,-13452.54 3068.71,-13439.91"/>
<polygon fill="black" stroke="black" points="3069.65,-13436.54 3059.06,-13436.92 3067.58,-13443.22 3069.65,-13436.54"/>
</g>
<!-- expert_18_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge359" class="edge">
<title>expert_18_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M3365.89,-13481.01C3363.06,-13480.43 3360.26,-13479.85 3357.5,-13479.3 3269.89,-13461.69 3170.24,-13444.25 3095.69,-13431.7"/>
<polygon fill="black" stroke="black" points="3096.25,-13428.24 3085.81,-13430.04 3095.09,-13435.15 3096.25,-13428.24"/>
</g>
<!-- expert_19_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge360" class="edge">
<title>expert_19_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M3552.93,-13480.81C3550.09,-13480.28 3547.27,-13479.77 3544.5,-13479.3 3396.34,-13453.93 3224.52,-13435.27 3110.26,-13424.36"/>
<polygon fill="black" stroke="black" points="3110.36,-13420.85 3100.07,-13423.39 3109.69,-13427.82 3110.36,-13420.85"/>
</g>
<!-- expert_20_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge361" class="edge">
<title>expert_20_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M3739.95,-13480.7C3737.1,-13480.2 3734.28,-13479.73 3731.5,-13479.3 3517.33,-13445.82 3265.85,-13427.96 3115.58,-13419.54"/>
<polygon fill="black" stroke="black" points="3115.57,-13416.03 3105.39,-13418.97 3115.18,-13423.02 3115.57,-13416.03"/>
</g>
<!-- expert_21_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge362" class="edge">
<title>expert_21_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M3926.96,-13480.64C3924.11,-13480.16 3921.28,-13479.71 3918.5,-13479.3 3635.57,-13437.61 3300.51,-13422.01 3117.87,-13416.32"/>
<polygon fill="black" stroke="black" points="3117.78,-13412.81 3107.68,-13416.01 3117.57,-13419.81 3117.78,-13412.81"/>
</g>
<!-- expert_22_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge363" class="edge">
<title>expert_22_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M4113.96,-13480.59C4111.11,-13480.13 4108.29,-13479.69 4105.5,-13479.3 3751.85,-13429.3 3330.37,-13417 3118.46,-13414.05"/>
<polygon fill="black" stroke="black" points="3118.26,-13410.55 3108.22,-13413.91 3118.17,-13417.55 3118.26,-13410.55"/>
</g>
<!-- expert_23_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge364" class="edge">
<title>expert_23_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M4300.97,-13480.56C4298.12,-13480.1 4295.29,-13479.68 4292.5,-13479.3 3867.13,-13420.98 3357.75,-13412.7 3118.84,-13412.39"/>
<polygon fill="black" stroke="black" points="3118.72,-13408.89 3108.71,-13412.38 3118.71,-13415.89 3118.72,-13408.89"/>
</g>
<!-- expert_24_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge365" class="edge">
<title>expert_24_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M4487.97,-13480.54C4485.12,-13480.09 4482.29,-13479.67 4479.5,-13479.3 4218.6,-13444.36 3434.74,-13423.35 3117.74,-13416.08"/>
<polygon fill="black" stroke="black" points="3117.66,-13412.57 3107.58,-13415.84 3117.5,-13419.57 3117.66,-13412.57"/>
</g>
<!-- expert_25_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge366" class="edge">
<title>expert_25_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M4674.97,-13480.52C4672.12,-13480.08 4669.29,-13479.67 4666.5,-13479.3 4368.29,-13440.11 3462.9,-13421.23 3117.95,-13415.31"/>
<polygon fill="black" stroke="black" points="3117.97,-13411.81 3107.91,-13415.14 3117.85,-13418.81 3117.97,-13411.81"/>
</g>
<!-- expert_26_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge367" class="edge">
<title>expert_26_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M4861.97,-13480.51C4859.12,-13480.07 4856.29,-13479.66 4853.5,-13479.3 4517.88,-13435.86 3490.29,-13419.35 3118.53,-13414.7"/>
<polygon fill="black" stroke="black" points="3118.31,-13411.19 3108.26,-13414.57 3118.22,-13418.19 3118.31,-13411.19"/>
</g>
<!-- expert_27_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge368" class="edge">
<title>expert_27_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M5048.97,-13480.5C5046.12,-13480.06 5043.29,-13479.66 5040.5,-13479.3 4667.07,-13431.58 3515.04,-13417.63 3118.36,-13414.18"/>
<polygon fill="black" stroke="black" points="3118.31,-13410.68 3108.28,-13414.1 3118.25,-13417.68 3118.31,-13410.68"/>
</g>
<!-- expert_28_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge369" class="edge">
<title>expert_28_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M5235.98,-13480.49C5233.12,-13480.05 5230.29,-13479.65 5227.5,-13479.3 4816.19,-13427.3 3539.17,-13416.07 3118.45,-13413.76"/>
<polygon fill="black" stroke="black" points="3118.39,-13410.26 3108.37,-13413.7 3118.35,-13417.26 3118.39,-13410.26"/>
</g>
<!-- expert_29_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge370" class="edge">
<title>expert_29_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M5422.98,-13480.48C5420.12,-13480.04 5417.29,-13479.65 5414.5,-13479.3 4965.28,-13423.02 3563,-13414.64 3118.86,-13413.4"/>
<polygon fill="black" stroke="black" points="3118.55,-13409.9 3108.54,-13413.37 3118.53,-13416.9 3118.55,-13409.9"/>
</g>
<!-- expert_30_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge371" class="edge">
<title>expert_30_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M5609.98,-13480.47C5607.12,-13480.04 5604.29,-13479.65 5601.5,-13479.3 5114.1,-13418.72 3585.1,-13413.3 3118.84,-13413.09"/>
<polygon fill="black" stroke="black" points="3118.69,-13409.59 3108.69,-13413.08 3118.69,-13416.59 3118.69,-13409.59"/>
</g>
<!-- expert_31_s1_l4&#45;&gt;expert_combine_s1_l4 -->
<g id="edge372" class="edge">
<title>expert_31_s1_l4&#45;&gt;expert_combine_s1_l4</title>
<path fill="none" stroke="black" d="M5796.98,-13480.47C5794.12,-13480.03 5791.29,-13479.64 5788.5,-13479.3 5262.84,-13414.41 3606.55,-13412.05 3118.88,-13412.82"/>
<polygon fill="black" stroke="black" points="3118.62,-13409.32 3108.62,-13412.83 3118.63,-13416.32 3118.62,-13409.32"/>
</g>
<!-- moe_out_proj_s1_l4 -->
<g id="node219" class="node">
<title>moe_out_proj_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-13345.07 2893.5,-13345.07 2893.5,-13301.07 3071.5,-13301.07 3071.5,-13345.07"/>
<text text-anchor="middle" x="2982.5" y="-13334.67" font-family="Arial" font-size="8.00">MoE Output Proj L4 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-13325.67" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13316.67" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13307.67" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1_l4&#45;&gt;moe_out_proj_s1_l4 -->
<g id="edge373" class="edge">
<title>expert_combine_s1_l4&#45;&gt;moe_out_proj_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-13380.72C2982.5,-13372.44 2982.5,-13363.46 2982.5,-13355.15"/>
<polygon fill="black" stroke="black" points="2986,-13355.08 2982.5,-13345.08 2979,-13355.08 2986,-13355.08"/>
</g>
<!-- allreduce_moe_out_s1_l4 -->
<g id="node220" class="node">
<title>allreduce_moe_out_s1_l4</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-13233.96" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-13245.56" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L4</text>
<text text-anchor="middle" x="2982.5" y="-13236.56" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13227.56" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13218.56" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1_l4&#45;&gt;allreduce_moe_out_s1_l4 -->
<g id="edge374" class="edge">
<title>moe_out_proj_s1_l4&#45;&gt;allreduce_moe_out_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-13300.99C2982.5,-13293.31 2982.5,-13284.36 2982.5,-13275.57"/>
<polygon fill="black" stroke="black" points="2986,-13275.41 2982.5,-13265.41 2979,-13275.41 2986,-13275.41"/>
</g>
<!-- layernorm2_s1_l4 -->
<g id="node221" class="node">
<title>layernorm2_s1_l4</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-13166.85 2893.5,-13166.85 2893.5,-13122.85 3071.5,-13122.85 3071.5,-13166.85"/>
<text text-anchor="middle" x="2982.5" y="-13156.45" font-family="Arial" font-size="8.00">LayerNorm 2 (L4)</text>
<text text-anchor="middle" x="2982.5" y="-13147.45" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13138.45" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13129.45" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1_l4&#45;&gt;layernorm2_s1_l4 -->
<g id="edge375" class="edge">
<title>allreduce_moe_out_s1_l4&#45;&gt;layernorm2_s1_l4</title>
<path fill="none" stroke="black" d="M2982.5,-13202.49C2982.5,-13194.21 2982.5,-13185.24 2982.5,-13176.93"/>
<polygon fill="black" stroke="black" points="2986,-13176.85 2982.5,-13166.85 2979,-13176.85 2986,-13176.85"/>
</g>
<!-- layernorm1_s1_l5 -->
<g id="node222" class="node">
<title>layernorm1_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-13086.85 2893.5,-13086.85 2893.5,-13042.85 3071.5,-13042.85 3071.5,-13086.85"/>
<text text-anchor="middle" x="2982.5" y="-13076.45" font-family="Arial" font-size="8.00">LayerNorm 1 (L5)</text>
<text text-anchor="middle" x="2982.5" y="-13067.45" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13058.45" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-13049.45" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm2_s1_l4&#45;&gt;layernorm1_s1_l5 -->
<g id="edge376" class="edge">
<title>layernorm2_s1_l4&#45;&gt;layernorm1_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-13122.53C2982.5,-13114.65 2982.5,-13105.53 2982.5,-13096.95"/>
<polygon fill="black" stroke="black" points="2986,-13096.87 2982.5,-13086.87 2979,-13096.87 2986,-13096.87"/>
</g>
<!-- qkv_proj_s1_l5 -->
<g id="node223" class="node">
<title>qkv_proj_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3081,-13006.85 2884,-13006.85 2884,-12962.85 3081,-12962.85 3081,-13006.85"/>
<text text-anchor="middle" x="2982.5" y="-12996.45" font-family="Arial" font-size="8.00">QKV Projection L5 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-12987.45" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12978.45" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-12969.45" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1_l5&#45;&gt;qkv_proj_s1_l5 -->
<g id="edge377" class="edge">
<title>layernorm1_s1_l5&#45;&gt;qkv_proj_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-13042.53C2982.5,-13034.65 2982.5,-13025.53 2982.5,-13016.95"/>
<polygon fill="black" stroke="black" points="2986,-13016.87 2982.5,-13006.87 2979,-13016.87 2986,-13016.87"/>
</g>
<!-- allreduce_qkv_s1_l5 -->
<g id="node224" class="node">
<title>allreduce_qkv_s1_l5</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-12895.73" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-12907.33" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L5</text>
<text text-anchor="middle" x="2982.5" y="-12898.33" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-12889.33" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-12880.33" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1_l5&#45;&gt;allreduce_qkv_s1_l5 -->
<g id="edge378" class="edge">
<title>qkv_proj_s1_l5&#45;&gt;allreduce_qkv_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-12962.76C2982.5,-12955.09 2982.5,-12946.13 2982.5,-12937.34"/>
<polygon fill="black" stroke="black" points="2986,-12937.18 2982.5,-12927.18 2979,-12937.18 2986,-12937.18"/>
</g>
<!-- attention_s1_l5 -->
<g id="node225" class="node">
<title>attention_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3081,-12828.62 2884,-12828.62 2884,-12784.62 3081,-12784.62 3081,-12828.62"/>
<text text-anchor="middle" x="2982.5" y="-12818.22" font-family="Arial" font-size="8.00">Self&#45;Attention L5</text>
<text text-anchor="middle" x="2982.5" y="-12809.22" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-12800.22" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-12791.22" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1_l5&#45;&gt;attention_s1_l5 -->
<g id="edge379" class="edge">
<title>allreduce_qkv_s1_l5&#45;&gt;attention_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-12864.27C2982.5,-12855.99 2982.5,-12847.01 2982.5,-12838.7"/>
<polygon fill="black" stroke="black" points="2986,-12838.63 2982.5,-12828.63 2979,-12838.63 2986,-12838.63"/>
</g>
<!-- attn_out_proj_s1_l5 -->
<g id="node226" class="node">
<title>attn_out_proj_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3078,-12748.62 2887,-12748.62 2887,-12704.62 3078,-12704.62 3078,-12748.62"/>
<text text-anchor="middle" x="2982.5" y="-12738.22" font-family="Arial" font-size="8.00">Attention Output Proj L5 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-12729.22" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-12720.22" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12711.22" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1_l5&#45;&gt;attn_out_proj_s1_l5 -->
<g id="edge380" class="edge">
<title>attention_s1_l5&#45;&gt;attn_out_proj_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-12784.31C2982.5,-12776.42 2982.5,-12767.31 2982.5,-12758.73"/>
<polygon fill="black" stroke="black" points="2986,-12758.64 2982.5,-12748.64 2979,-12758.64 2986,-12758.64"/>
</g>
<!-- allreduce_attn_out_s1_l5 -->
<g id="node227" class="node">
<title>allreduce_attn_out_s1_l5</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-12637.51" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-12649.11" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L5</text>
<text text-anchor="middle" x="2982.5" y="-12640.11" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12631.11" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12622.11" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1_l5&#45;&gt;allreduce_attn_out_s1_l5 -->
<g id="edge381" class="edge">
<title>attn_out_proj_s1_l5&#45;&gt;allreduce_attn_out_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-12704.53C2982.5,-12696.86 2982.5,-12687.91 2982.5,-12679.12"/>
<polygon fill="black" stroke="black" points="2986,-12678.95 2982.5,-12668.95 2979,-12678.95 2986,-12678.95"/>
</g>
<!-- moe_gate_s1_l5 -->
<g id="node228" class="node">
<title>moe_gate_s1_l5</title>
<polygon fill="orange" stroke="black" points="3167.08,-12570.4 2873.45,-12570.4 2797.92,-12482.4 3091.55,-12482.4 3167.08,-12570.4"/>
<text text-anchor="middle" x="2982.5" y="-12538" font-family="Arial" font-size="8.00">MoE Gate L5 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-12529" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12520" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12511" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1_l5&#45;&gt;moe_gate_s1_l5 -->
<g id="edge382" class="edge">
<title>allreduce_attn_out_s1_l5&#45;&gt;moe_gate_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-12606.12C2982.5,-12598.23 2982.5,-12589.5 2982.5,-12580.81"/>
<polygon fill="black" stroke="black" points="2986,-12580.68 2982.5,-12570.68 2979,-12580.68 2986,-12580.68"/>
</g>
<!-- expert_dispatch_s1_l5 -->
<g id="node229" class="node">
<title>expert_dispatch_s1_l5</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-12415.28" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-12426.88" font-family="Arial" font-size="8.00">Expert Dispatch L5 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-12417.88" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12408.88" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12399.88" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1_l5&#45;&gt;expert_dispatch_s1_l5 -->
<g id="edge383" class="edge">
<title>moe_gate_s1_l5&#45;&gt;expert_dispatch_s1_l5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-12482.27C2982.5,-12473.9 2982.5,-12465.14 2982.5,-12456.85"/>
<polygon fill="black" stroke="black" points="2986,-12456.66 2982.5,-12446.66 2979,-12456.66 2986,-12456.66"/>
</g>
<!-- expert_0_s1_l5 -->
<g id="node230" class="node">
<title>expert_0_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="169,-12348.17 0,-12348.17 0,-12304.17 169,-12304.17 169,-12348.17"/>
<text text-anchor="middle" x="84.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 0 L5</text>
<text text-anchor="middle" x="84.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_0_s1_l5 -->
<g id="edge384" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_0_s1_l5</title>
<path fill="none" stroke="black" d="M2856.42,-12414.64C2385.23,-12415.44 727.13,-12413.52 178.99,-12348.21"/>
<polygon fill="black" stroke="black" points="179.37,-12344.73 169.02,-12347 178.53,-12351.68 179.37,-12344.73"/>
</g>
<!-- expert_1_s1_l5 -->
<g id="node231" class="node">
<title>expert_1_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="356,-12348.17 187,-12348.17 187,-12304.17 356,-12304.17 356,-12348.17"/>
<text text-anchor="middle" x="271.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 1 L5</text>
<text text-anchor="middle" x="271.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_1_s1_l5 -->
<g id="edge385" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_1_s1_l5</title>
<path fill="none" stroke="black" d="M2856.36,-12414.39C2405.73,-12414.24 875.66,-12409.24 366.03,-12348.22"/>
<polygon fill="black" stroke="black" points="366.37,-12344.74 356.02,-12347 365.52,-12351.68 366.37,-12344.74"/>
</g>
<!-- expert_2_s1_l5 -->
<g id="node232" class="node">
<title>expert_2_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="543,-12348.17 374,-12348.17 374,-12304.17 543,-12304.17 543,-12348.17"/>
<text text-anchor="middle" x="458.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 2 L5</text>
<text text-anchor="middle" x="458.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_2_s1_l5 -->
<g id="edge386" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_2_s1_l5</title>
<path fill="none" stroke="black" d="M2856.51,-12414.1C2427.43,-12412.96 1024.14,-12404.99 552.96,-12348.21"/>
<polygon fill="black" stroke="black" points="553.38,-12344.74 543.02,-12346.99 552.52,-12351.69 553.38,-12344.74"/>
</g>
<!-- expert_3_s1_l5 -->
<g id="node233" class="node">
<title>expert_3_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="730,-12348.17 561,-12348.17 561,-12304.17 730,-12304.17 730,-12348.17"/>
<text text-anchor="middle" x="645.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 3 L5</text>
<text text-anchor="middle" x="645.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_3_s1_l5 -->
<g id="edge387" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_3_s1_l5</title>
<path fill="none" stroke="black" d="M2856.69,-12413.77C2450.07,-12411.59 1173.13,-12400.75 740.1,-12348.23"/>
<polygon fill="black" stroke="black" points="740.38,-12344.74 730.02,-12346.98 739.52,-12351.69 740.38,-12344.74"/>
</g>
<!-- expert_4_s1_l5 -->
<g id="node234" class="node">
<title>expert_4_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="917,-12348.17 748,-12348.17 748,-12304.17 917,-12304.17 917,-12348.17"/>
<text text-anchor="middle" x="832.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 4 L5</text>
<text text-anchor="middle" x="832.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_4_s1_l5 -->
<g id="edge388" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_4_s1_l5</title>
<path fill="none" stroke="black" d="M2856.78,-12413.37C2473.43,-12410.1 1321.87,-12396.52 927.06,-12348.23"/>
<polygon fill="black" stroke="black" points="927.38,-12344.74 917.03,-12346.97 926.51,-12351.69 927.38,-12344.74"/>
</g>
<!-- expert_5_s1_l5 -->
<g id="node235" class="node">
<title>expert_5_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="1104,-12348.17 935,-12348.17 935,-12304.17 1104,-12304.17 1104,-12348.17"/>
<text text-anchor="middle" x="1019.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 5 L5</text>
<text text-anchor="middle" x="1019.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_5_s1_l5 -->
<g id="edge389" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_5_s1_l5</title>
<path fill="none" stroke="black" d="M2856.8,-12412.9C2497.73,-12408.47 1470.88,-12392.3 1114.13,-12348.24"/>
<polygon fill="black" stroke="black" points="1114.39,-12344.74 1104.03,-12346.96 1113.51,-12351.69 1114.39,-12344.74"/>
</g>
<!-- expert_6_s1_l5 -->
<g id="node236" class="node">
<title>expert_6_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="1291,-12348.17 1122,-12348.17 1122,-12304.17 1291,-12304.17 1291,-12348.17"/>
<text text-anchor="middle" x="1206.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 6 L5</text>
<text text-anchor="middle" x="1206.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_6_s1_l5 -->
<g id="edge390" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_6_s1_l5</title>
<path fill="none" stroke="black" d="M2857.17,-12412.33C2523.91,-12406.67 1620.17,-12388.13 1301.21,-12348.25"/>
<polygon fill="black" stroke="black" points="1301.39,-12344.75 1291.03,-12346.95 1300.5,-12351.69 1301.39,-12344.75"/>
</g>
<!-- expert_7_s1_l5 -->
<g id="node237" class="node">
<title>expert_7_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="1478,-12348.17 1309,-12348.17 1309,-12304.17 1478,-12304.17 1478,-12348.17"/>
<text text-anchor="middle" x="1393.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 7 L5</text>
<text text-anchor="middle" x="1393.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_7_s1_l5 -->
<g id="edge391" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_7_s1_l5</title>
<path fill="none" stroke="black" d="M2857.5,-12411.62C2551.41,-12404.65 1769.45,-12383.98 1488.23,-12348.26"/>
<polygon fill="black" stroke="black" points="1488.4,-12344.75 1478.03,-12346.93 1487.49,-12351.69 1488.4,-12344.75"/>
</g>
<!-- expert_8_s1_l5 -->
<g id="node238" class="node">
<title>expert_8_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="1665,-12348.17 1496,-12348.17 1496,-12304.17 1665,-12304.17 1665,-12348.17"/>
<text text-anchor="middle" x="1580.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 8 L5</text>
<text text-anchor="middle" x="1580.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_8_s1_l5 -->
<g id="edge392" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_8_s1_l5</title>
<path fill="none" stroke="black" d="M2856.38,-12415.08C2623.94,-12414.98 2112.47,-12407.41 1675.03,-12348.27"/>
<polygon fill="black" stroke="black" points="1675.42,-12344.79 1665.03,-12346.91 1674.47,-12351.72 1675.42,-12344.79"/>
</g>
<!-- expert_9_s1_l5 -->
<g id="node239" class="node">
<title>expert_9_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="1852,-12348.17 1683,-12348.17 1683,-12304.17 1852,-12304.17 1852,-12348.17"/>
<text text-anchor="middle" x="1767.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 9 L5</text>
<text text-anchor="middle" x="1767.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_9_s1_l5 -->
<g id="edge393" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_9_s1_l5</title>
<path fill="none" stroke="black" d="M2856.48,-12413.55C2650.05,-12410.85 2227.11,-12399.13 1862.01,-12348.28"/>
<polygon fill="black" stroke="black" points="1862.43,-12344.8 1852.04,-12346.88 1861.45,-12351.73 1862.43,-12344.8"/>
</g>
<!-- expert_10_s1_l5 -->
<g id="node240" class="node">
<title>expert_10_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="2039,-12348.17 1870,-12348.17 1870,-12304.17 2039,-12304.17 2039,-12348.17"/>
<text text-anchor="middle" x="1954.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 10 L5</text>
<text text-anchor="middle" x="1954.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_10_s1_l5 -->
<g id="edge394" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_10_s1_l5</title>
<path fill="none" stroke="black" d="M2857.46,-12411.46C2679.53,-12406.08 2343.14,-12390.96 2049.05,-12348.3"/>
<polygon fill="black" stroke="black" points="2049.45,-12344.82 2039.05,-12346.83 2048.43,-12351.74 2049.45,-12344.82"/>
</g>
<!-- expert_11_s1_l5 -->
<g id="node241" class="node">
<title>expert_11_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="2226,-12348.17 2057,-12348.17 2057,-12304.17 2226,-12304.17 2226,-12348.17"/>
<text text-anchor="middle" x="2141.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 11 L5</text>
<text text-anchor="middle" x="2141.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_11_s1_l5 -->
<g id="edge395" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_11_s1_l5</title>
<path fill="none" stroke="black" d="M2859.45,-12408.47C2712.89,-12400.4 2460.66,-12382.88 2236.05,-12348.32"/>
<polygon fill="black" stroke="black" points="2236.47,-12344.85 2226.05,-12346.77 2235.4,-12351.76 2236.47,-12344.85"/>
</g>
<!-- expert_12_s1_l5 -->
<g id="node242" class="node">
<title>expert_12_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="2413,-12348.17 2244,-12348.17 2244,-12304.17 2413,-12304.17 2413,-12348.17"/>
<text text-anchor="middle" x="2328.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 12 L5</text>
<text text-anchor="middle" x="2328.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_12_s1_l5 -->
<g id="edge396" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_12_s1_l5</title>
<path fill="none" stroke="black" d="M2864.87,-12404.04C2753.34,-12393.49 2580.99,-12375.03 2422.98,-12348.35"/>
<polygon fill="black" stroke="black" points="2423.52,-12344.89 2413.07,-12346.66 2422.34,-12351.79 2423.52,-12344.89"/>
</g>
<!-- expert_13_s1_l5 -->
<g id="node243" class="node">
<title>expert_13_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="2600,-12348.17 2431,-12348.17 2431,-12304.17 2600,-12304.17 2600,-12348.17"/>
<text text-anchor="middle" x="2515.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 13 L5</text>
<text text-anchor="middle" x="2515.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_13_s1_l5 -->
<g id="edge397" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_13_s1_l5</title>
<path fill="none" stroke="black" d="M2879.07,-12397.35C2806.34,-12385.12 2706.53,-12367.71 2610.04,-12348.45"/>
<polygon fill="black" stroke="black" points="2610.6,-12344.99 2600.11,-12346.45 2609.23,-12351.85 2610.6,-12344.99"/>
</g>
<!-- expert_14_s1_l5 -->
<g id="node244" class="node">
<title>expert_14_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="2787,-12348.17 2618,-12348.17 2618,-12304.17 2787,-12304.17 2787,-12348.17"/>
<text text-anchor="middle" x="2702.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 14 L5</text>
<text text-anchor="middle" x="2702.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_14_s1_l5 -->
<g id="edge398" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_14_s1_l5</title>
<path fill="none" stroke="black" d="M2905.99,-12390.48C2866.88,-12378.31 2819.39,-12363.54 2780.12,-12351.32"/>
<polygon fill="black" stroke="black" points="2780.91,-12347.9 2770.32,-12348.27 2778.83,-12354.59 2780.91,-12347.9"/>
</g>
<!-- expert_15_s1_l5 -->
<g id="node245" class="node">
<title>expert_15_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="2974,-12348.17 2805,-12348.17 2805,-12304.17 2974,-12304.17 2974,-12348.17"/>
<text text-anchor="middle" x="2889.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 15 L5</text>
<text text-anchor="middle" x="2889.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_15_s1_l5 -->
<g id="edge399" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_15_s1_l5</title>
<path fill="none" stroke="black" d="M2951.27,-12385.03C2941.01,-12375.42 2929.64,-12364.77 2919.47,-12355.25"/>
<polygon fill="black" stroke="black" points="2921.66,-12352.5 2911.97,-12348.22 2916.88,-12357.61 2921.66,-12352.5"/>
</g>
<!-- expert_16_s1_l5 -->
<g id="node246" class="node">
<title>expert_16_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3161,-12348.17 2992,-12348.17 2992,-12304.17 3161,-12304.17 3161,-12348.17"/>
<text text-anchor="middle" x="3076.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 16 L5</text>
<text text-anchor="middle" x="3076.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_16_s1_l5 -->
<g id="edge400" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_16_s1_l5</title>
<path fill="none" stroke="black" d="M3014.06,-12385.03C3024.43,-12375.42 3035.93,-12364.77 3046.21,-12355.25"/>
<polygon fill="black" stroke="black" points="3048.83,-12357.59 3053.78,-12348.22 3044.07,-12352.45 3048.83,-12357.59"/>
</g>
<!-- expert_17_s1_l5 -->
<g id="node247" class="node">
<title>expert_17_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3348,-12348.17 3179,-12348.17 3179,-12304.17 3348,-12304.17 3348,-12348.17"/>
<text text-anchor="middle" x="3263.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 17 L5</text>
<text text-anchor="middle" x="3263.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_17_s1_l5 -->
<g id="edge401" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_17_s1_l5</title>
<path fill="none" stroke="black" d="M3059.28,-12390.48C3098.53,-12378.31 3146.2,-12363.54 3185.6,-12351.32"/>
<polygon fill="black" stroke="black" points="3186.92,-12354.58 3195.43,-12348.27 3184.84,-12347.89 3186.92,-12354.58"/>
</g>
<!-- expert_18_s1_l5 -->
<g id="node248" class="node">
<title>expert_18_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3535,-12348.17 3366,-12348.17 3366,-12304.17 3535,-12304.17 3535,-12348.17"/>
<text text-anchor="middle" x="3450.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 18 L5</text>
<text text-anchor="middle" x="3450.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_18_s1_l5 -->
<g id="edge402" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_18_s1_l5</title>
<path fill="none" stroke="black" d="M3085.81,-12397.43C3158.76,-12385.21 3259.03,-12367.77 3355.92,-12348.45"/>
<polygon fill="black" stroke="black" points="3356.77,-12351.85 3365.89,-12346.46 3355.4,-12344.99 3356.77,-12351.85"/>
</g>
<!-- expert_19_s1_l5 -->
<g id="node249" class="node">
<title>expert_19_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3722,-12348.17 3553,-12348.17 3553,-12304.17 3722,-12304.17 3722,-12348.17"/>
<text text-anchor="middle" x="3637.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 19 L5</text>
<text text-anchor="middle" x="3637.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_19_s1_l5 -->
<g id="edge403" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_19_s1_l5</title>
<path fill="none" stroke="black" d="M3100.07,-12404.08C3211.79,-12393.54 3384.6,-12375.08 3543,-12348.35"/>
<polygon fill="black" stroke="black" points="3543.66,-12351.79 3552.93,-12346.66 3542.48,-12344.89 3543.66,-12351.79"/>
</g>
<!-- expert_20_s1_l5 -->
<g id="node250" class="node">
<title>expert_20_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3909,-12348.17 3740,-12348.17 3740,-12304.17 3909,-12304.17 3909,-12348.17"/>
<text text-anchor="middle" x="3824.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 20 L5</text>
<text text-anchor="middle" x="3824.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_20_s1_l5 -->
<g id="edge404" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_20_s1_l5</title>
<path fill="none" stroke="black" d="M3105.39,-12408.5C3252.09,-12400.45 3504.87,-12382.94 3729.93,-12348.32"/>
<polygon fill="black" stroke="black" points="3730.6,-12351.76 3739.95,-12346.77 3729.53,-12344.85 3730.6,-12351.76"/>
</g>
<!-- expert_21_s1_l5 -->
<g id="node251" class="node">
<title>expert_21_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="4096,-12348.17 3927,-12348.17 3927,-12304.17 4096,-12304.17 4096,-12348.17"/>
<text text-anchor="middle" x="4011.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 21 L5</text>
<text text-anchor="middle" x="4011.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_21_s1_l5 -->
<g id="edge405" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_21_s1_l5</title>
<path fill="none" stroke="black" d="M3107.68,-12411.46C3285.8,-12406.11 3622.55,-12390.99 3916.94,-12348.3"/>
<polygon fill="black" stroke="black" points="3917.57,-12351.74 3926.96,-12346.83 3916.55,-12344.82 3917.57,-12351.74"/>
</g>
<!-- expert_22_s1_l5 -->
<g id="node252" class="node">
<title>expert_22_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="4283,-12348.17 4114,-12348.17 4114,-12304.17 4283,-12304.17 4283,-12348.17"/>
<text text-anchor="middle" x="4198.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 22 L5</text>
<text text-anchor="middle" x="4198.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_22_s1_l5 -->
<g id="edge406" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_22_s1_l5</title>
<path fill="none" stroke="black" d="M3108.22,-12413.56C3314.67,-12410.89 3738.31,-12399.2 4103.98,-12348.28"/>
<polygon fill="black" stroke="black" points="4104.55,-12351.73 4113.96,-12346.88 4103.57,-12344.8 4104.55,-12351.73"/>
</g>
<!-- expert_23_s1_l5 -->
<g id="node253" class="node">
<title>expert_23_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="4470,-12348.17 4301,-12348.17 4301,-12304.17 4470,-12304.17 4470,-12348.17"/>
<text text-anchor="middle" x="4385.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 23 L5</text>
<text text-anchor="middle" x="4385.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_23_s1_l5 -->
<g id="edge407" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_23_s1_l5</title>
<path fill="none" stroke="black" d="M3108.71,-12415.09C3341.33,-12415 3853.2,-12407.44 4290.96,-12348.27"/>
<polygon fill="black" stroke="black" points="4291.53,-12351.72 4300.97,-12346.91 4290.58,-12344.79 4291.53,-12351.72"/>
</g>
<!-- expert_24_s1_l5 -->
<g id="node254" class="node">
<title>expert_24_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="4657,-12348.17 4488,-12348.17 4488,-12304.17 4657,-12304.17 4657,-12348.17"/>
<text text-anchor="middle" x="4572.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 24 L5</text>
<text text-anchor="middle" x="4572.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_24_s1_l5 -->
<g id="edge408" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_24_s1_l5</title>
<path fill="none" stroke="black" d="M3107.58,-12411.63C3413.87,-12404.66 4196.36,-12384 4477.77,-12348.26"/>
<polygon fill="black" stroke="black" points="4478.51,-12351.69 4487.97,-12346.93 4477.6,-12344.75 4478.51,-12351.69"/>
</g>
<!-- expert_25_s1_l5 -->
<g id="node255" class="node">
<title>expert_25_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="4844,-12348.17 4675,-12348.17 4675,-12304.17 4844,-12304.17 4844,-12348.17"/>
<text text-anchor="middle" x="4759.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 25 L5</text>
<text text-anchor="middle" x="4759.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_25_s1_l5 -->
<g id="edge409" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_25_s1_l5</title>
<path fill="none" stroke="black" d="M3107.91,-12412.33C3441.37,-12406.68 4345.64,-12388.15 4664.78,-12348.25"/>
<polygon fill="black" stroke="black" points="4665.5,-12351.69 4674.97,-12346.95 4664.61,-12344.75 4665.5,-12351.69"/>
</g>
<!-- expert_26_s1_l5 -->
<g id="node256" class="node">
<title>expert_26_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="5031,-12348.17 4862,-12348.17 4862,-12304.17 5031,-12304.17 5031,-12348.17"/>
<text text-anchor="middle" x="4946.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 26 L5</text>
<text text-anchor="middle" x="4946.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_26_s1_l5 -->
<g id="edge410" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_26_s1_l5</title>
<path fill="none" stroke="black" d="M3108.26,-12412.9C3467.53,-12408.47 4494.93,-12392.32 4851.87,-12348.24"/>
<polygon fill="black" stroke="black" points="4852.49,-12351.69 4861.97,-12346.96 4851.61,-12344.74 4852.49,-12351.69"/>
</g>
<!-- expert_27_s1_l5 -->
<g id="node257" class="node">
<title>expert_27_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="5218,-12348.17 5049,-12348.17 5049,-12304.17 5218,-12304.17 5218,-12348.17"/>
<text text-anchor="middle" x="5133.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 27 L5</text>
<text text-anchor="middle" x="5133.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_27_s1_l5 -->
<g id="edge411" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_27_s1_l5</title>
<path fill="none" stroke="black" d="M3108.28,-12413.37C3491.82,-12410.11 4643.94,-12396.54 5038.93,-12348.23"/>
<polygon fill="black" stroke="black" points="5039.49,-12351.69 5048.97,-12346.97 5038.62,-12344.74 5039.49,-12351.69"/>
</g>
<!-- expert_28_s1_l5 -->
<g id="node258" class="node">
<title>expert_28_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="5405,-12348.17 5236,-12348.17 5236,-12304.17 5405,-12304.17 5405,-12348.17"/>
<text text-anchor="middle" x="5320.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 28 L5</text>
<text text-anchor="middle" x="5320.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_28_s1_l5 -->
<g id="edge412" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_28_s1_l5</title>
<path fill="none" stroke="black" d="M3108.37,-12413.77C3515.16,-12411.6 4792.68,-12400.77 5225.9,-12348.23"/>
<polygon fill="black" stroke="black" points="5226.48,-12351.69 5235.98,-12346.98 5225.62,-12344.74 5226.48,-12351.69"/>
</g>
<!-- expert_29_s1_l5 -->
<g id="node259" class="node">
<title>expert_29_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="5592,-12348.17 5423,-12348.17 5423,-12304.17 5592,-12304.17 5592,-12348.17"/>
<text text-anchor="middle" x="5507.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 29 L5</text>
<text text-anchor="middle" x="5507.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_29_s1_l5 -->
<g id="edge413" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_29_s1_l5</title>
<path fill="none" stroke="black" d="M3108.54,-12414.1C3537.8,-12412.97 4941.67,-12405.01 5413.04,-12348.21"/>
<polygon fill="black" stroke="black" points="5413.48,-12351.69 5422.98,-12346.99 5412.62,-12344.74 5413.48,-12351.69"/>
</g>
<!-- expert_30_s1_l5 -->
<g id="node260" class="node">
<title>expert_30_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="5779,-12348.17 5610,-12348.17 5610,-12304.17 5779,-12304.17 5779,-12348.17"/>
<text text-anchor="middle" x="5694.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 30 L5</text>
<text text-anchor="middle" x="5694.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_30_s1_l5 -->
<g id="edge414" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_30_s1_l5</title>
<path fill="none" stroke="black" d="M3108.69,-12414.39C3559.49,-12414.25 5090.14,-12409.27 5599.96,-12348.22"/>
<polygon fill="black" stroke="black" points="5600.48,-12351.68 5609.98,-12347 5599.63,-12344.74 5600.48,-12351.68"/>
</g>
<!-- expert_31_s1_l5 -->
<g id="node261" class="node">
<title>expert_31_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="5966,-12348.17 5797,-12348.17 5797,-12304.17 5966,-12304.17 5966,-12348.17"/>
<text text-anchor="middle" x="5881.5" y="-12337.77" font-family="Arial" font-size="8.00">Expert 31 L5</text>
<text text-anchor="middle" x="5881.5" y="-12328.77" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-12319.77" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-12310.77" font-family="Arial" font-size="8.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1_l5&#45;&gt;expert_31_s1_l5 -->
<g id="edge415" class="edge">
<title>expert_dispatch_s1_l5&#45;&gt;expert_31_s1_l5</title>
<path fill="none" stroke="black" d="M3108.62,-12414.64C3579.98,-12415.44 5238.67,-12413.55 5787,-12348.22"/>
<polygon fill="black" stroke="black" points="5787.47,-12351.68 5796.98,-12347 5786.63,-12344.73 5787.47,-12351.68"/>
</g>
<!-- expert_combine_s1_l5 -->
<g id="node262" class="node">
<title>expert_combine_s1_l5</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-12237.06" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-12248.66" font-family="Arial" font-size="8.00">Expert Combine L5 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-12239.66" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-12230.66" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12221.66" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge416" class="edge">
<title>expert_0_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M169.02,-12305.34C171.88,-12304.91 174.71,-12304.52 177.5,-12304.17 702.97,-12239.3 2358.67,-12236.93 2846.17,-12237.69"/>
<polygon fill="black" stroke="black" points="2846.42,-12241.19 2856.42,-12237.71 2846.43,-12234.19 2846.42,-12241.19"/>
</g>
<!-- expert_1_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge417" class="edge">
<title>expert_1_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M356.02,-12305.34C358.88,-12304.91 361.71,-12304.52 364.5,-12304.17 851.71,-12243.61 2380.13,-12238.18 2846.21,-12237.96"/>
<polygon fill="black" stroke="black" points="2846.36,-12241.46 2856.36,-12237.96 2846.36,-12234.46 2846.36,-12241.46"/>
</g>
<!-- expert_2_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge418" class="edge">
<title>expert_2_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M543.02,-12305.35C545.88,-12304.92 548.71,-12304.52 551.5,-12304.17 1000.54,-12247.91 2402.24,-12239.52 2846.2,-12238.27"/>
<polygon fill="black" stroke="black" points="2846.52,-12241.77 2856.51,-12238.24 2846.5,-12234.77 2846.52,-12241.77"/>
</g>
<!-- expert_3_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge419" class="edge">
<title>expert_3_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M730.02,-12305.36C732.88,-12304.92 735.71,-12304.52 738.5,-12304.17 1149.63,-12252.19 2426.08,-12240.95 2846.61,-12238.63"/>
<polygon fill="black" stroke="black" points="2846.7,-12242.13 2856.69,-12238.58 2846.67,-12235.13 2846.7,-12242.13"/>
</g>
<!-- expert_4_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge420" class="edge">
<title>expert_4_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M917.03,-12305.37C919.88,-12304.93 922.71,-12304.53 925.5,-12304.17 1298.74,-12256.47 2450.22,-12242.51 2846.7,-12239.06"/>
<polygon fill="black" stroke="black" points="2846.81,-12242.56 2856.78,-12238.97 2846.75,-12235.56 2846.81,-12242.56"/>
</g>
<!-- expert_5_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge421" class="edge">
<title>expert_5_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M1104.03,-12305.38C1106.88,-12304.94 1109.71,-12304.53 1112.5,-12304.17 1447.94,-12260.76 2474.98,-12244.23 2846.54,-12239.57"/>
<polygon fill="black" stroke="black" points="2846.85,-12243.07 2856.8,-12239.44 2846.76,-12236.07 2846.85,-12243.07"/>
</g>
<!-- expert_6_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge422" class="edge">
<title>expert_6_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M1291.03,-12305.4C1293.88,-12304.95 1296.71,-12304.54 1299.5,-12304.17 1597.53,-12265 2502.38,-12246.11 2847.13,-12240.18"/>
<polygon fill="black" stroke="black" points="2847.23,-12243.68 2857.17,-12240.01 2847.11,-12236.68 2847.23,-12243.68"/>
</g>
<!-- expert_7_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge423" class="edge">
<title>expert_7_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M1478.03,-12305.41C1480.88,-12304.96 1483.71,-12304.54 1486.5,-12304.17 1747.22,-12269.26 2530.56,-12248.23 2847.35,-12240.95"/>
<polygon fill="black" stroke="black" points="2847.58,-12244.45 2857.5,-12240.72 2847.42,-12237.45 2847.58,-12244.45"/>
</g>
<!-- expert_8_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge424" class="edge">
<title>expert_8_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M1665.03,-12305.44C1667.88,-12304.98 1670.71,-12304.55 1673.5,-12304.17 2098.54,-12245.89 2607.53,-12237.59 2846.26,-12237.27"/>
<polygon fill="black" stroke="black" points="2846.39,-12240.77 2856.38,-12237.26 2846.38,-12233.77 2846.39,-12240.77"/>
</g>
<!-- expert_9_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge425" class="edge">
<title>expert_9_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M1852.04,-12305.47C1854.89,-12305 1857.71,-12304.57 1860.5,-12304.17 2213.6,-12254.24 2634.37,-12241.91 2846.24,-12238.94"/>
<polygon fill="black" stroke="black" points="2846.52,-12242.43 2856.48,-12238.8 2846.43,-12235.43 2846.52,-12242.43"/>
</g>
<!-- expert_10_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge426" class="edge">
<title>expert_10_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M2039.05,-12305.51C2041.89,-12305.03 2044.72,-12304.58 2047.5,-12304.17 2330.13,-12262.51 2664.83,-12246.9 2847.27,-12241.2"/>
<polygon fill="black" stroke="black" points="2847.57,-12244.69 2857.46,-12240.89 2847.35,-12237.7 2847.57,-12244.69"/>
</g>
<!-- expert_11_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge427" class="edge">
<title>expert_11_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M2226.05,-12305.57C2228.9,-12305.08 2231.72,-12304.61 2234.5,-12304.17 2448.23,-12270.75 2699.16,-12252.88 2849.26,-12244.44"/>
<polygon fill="black" stroke="black" points="2849.66,-12247.92 2859.45,-12243.87 2849.27,-12240.93 2849.66,-12247.92"/>
</g>
<!-- expert_12_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge428" class="edge">
<title>expert_12_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M2413.07,-12305.68C2415.91,-12305.15 2418.73,-12304.65 2421.5,-12304.17 2569.28,-12278.85 2740.64,-12260.19 2854.7,-12249.27"/>
<polygon fill="black" stroke="black" points="2855.24,-12252.74 2864.87,-12248.3 2854.58,-12245.77 2855.24,-12252.74"/>
</g>
<!-- expert_13_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge429" class="edge">
<title>expert_13_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M2600.11,-12305.89C2602.94,-12305.3 2605.74,-12304.73 2608.5,-12304.17 2695.55,-12286.66 2794.51,-12269.28 2868.76,-12256.73"/>
<polygon fill="black" stroke="black" points="2869.79,-12260.11 2879.07,-12255 2868.63,-12253.21 2869.79,-12260.11"/>
</g>
<!-- expert_14_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge430" class="edge">
<title>expert_14_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M2770.28,-12304.08C2808.19,-12292.29 2855.83,-12277.47 2896.36,-12264.86"/>
<polygon fill="black" stroke="black" points="2897.45,-12268.18 2905.96,-12261.87 2895.37,-12261.5 2897.45,-12268.18"/>
</g>
<!-- expert_15_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge431" class="edge">
<title>expert_15_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M2912.01,-12304.08C2921.53,-12295.16 2932.9,-12284.52 2943.7,-12274.4"/>
<polygon fill="black" stroke="black" points="2946.15,-12276.9 2951.06,-12267.51 2941.37,-12271.79 2946.15,-12276.9"/>
</g>
<!-- expert_16_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge432" class="edge">
<title>expert_16_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M3053.75,-12304.08C3044.12,-12295.16 3032.63,-12284.52 3021.71,-12274.4"/>
<polygon fill="black" stroke="black" points="3023.99,-12271.74 3014.28,-12267.51 3019.23,-12276.87 3023.99,-12271.74"/>
</g>
<!-- expert_17_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge433" class="edge">
<title>expert_17_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M3195.48,-12304.08C3157.36,-12292.27 3109.44,-12277.41 3068.71,-12264.78"/>
<polygon fill="black" stroke="black" points="3069.65,-12261.41 3059.06,-12261.79 3067.58,-12268.1 3069.65,-12261.41"/>
</g>
<!-- expert_18_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge434" class="edge">
<title>expert_18_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M3365.89,-12305.89C3363.06,-12305.3 3360.26,-12304.73 3357.5,-12304.17 3269.89,-12286.57 3170.24,-12269.12 3095.69,-12256.57"/>
<polygon fill="black" stroke="black" points="3096.25,-12253.12 3085.81,-12254.91 3095.09,-12260.02 3096.25,-12253.12"/>
</g>
<!-- expert_19_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge435" class="edge">
<title>expert_19_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M3552.93,-12305.68C3550.09,-12305.15 3547.27,-12304.65 3544.5,-12304.17 3396.34,-12278.8 3224.52,-12260.14 3110.26,-12249.23"/>
<polygon fill="black" stroke="black" points="3110.36,-12245.73 3100.07,-12248.27 3109.69,-12252.69 3110.36,-12245.73"/>
</g>
<!-- expert_20_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge436" class="edge">
<title>expert_20_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M3739.95,-12305.57C3737.1,-12305.08 3734.28,-12304.61 3731.5,-12304.17 3517.33,-12270.69 3265.85,-12252.83 3115.58,-12244.41"/>
<polygon fill="black" stroke="black" points="3115.57,-12240.9 3105.39,-12243.84 3115.18,-12247.89 3115.57,-12240.9"/>
</g>
<!-- expert_21_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge437" class="edge">
<title>expert_21_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M3926.96,-12305.51C3924.11,-12305.03 3921.28,-12304.58 3918.5,-12304.17 3635.57,-12262.48 3300.51,-12246.88 3117.87,-12241.19"/>
<polygon fill="black" stroke="black" points="3117.78,-12237.69 3107.68,-12240.88 3117.57,-12244.68 3117.78,-12237.69"/>
</g>
<!-- expert_22_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge438" class="edge">
<title>expert_22_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M4113.96,-12305.47C4111.11,-12305 4108.29,-12304.57 4105.5,-12304.17 3751.85,-12254.17 3330.37,-12241.87 3118.46,-12238.92"/>
<polygon fill="black" stroke="black" points="3118.26,-12235.42 3108.22,-12238.78 3118.17,-12242.42 3118.26,-12235.42"/>
</g>
<!-- expert_23_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge439" class="edge">
<title>expert_23_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M4300.97,-12305.44C4298.12,-12304.98 4295.29,-12304.55 4292.5,-12304.17 3867.13,-12245.85 3357.75,-12237.58 3118.84,-12237.26"/>
<polygon fill="black" stroke="black" points="3118.72,-12233.76 3108.71,-12237.25 3118.71,-12240.76 3118.72,-12233.76"/>
</g>
<!-- expert_24_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge440" class="edge">
<title>expert_24_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M4487.97,-12305.41C4485.12,-12304.96 4482.29,-12304.54 4479.5,-12304.17 4218.6,-12269.24 3434.74,-12248.22 3117.74,-12240.95"/>
<polygon fill="black" stroke="black" points="3117.66,-12237.45 3107.58,-12240.72 3117.5,-12244.44 3117.66,-12237.45"/>
</g>
<!-- expert_25_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge441" class="edge">
<title>expert_25_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M4674.97,-12305.4C4672.12,-12304.95 4669.29,-12304.54 4666.5,-12304.17 4368.29,-12264.98 3462.9,-12246.1 3117.95,-12240.18"/>
<polygon fill="black" stroke="black" points="3117.97,-12236.68 3107.91,-12240.01 3117.85,-12243.68 3117.97,-12236.68"/>
</g>
<!-- expert_26_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge442" class="edge">
<title>expert_26_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M4861.97,-12305.38C4859.12,-12304.94 4856.29,-12304.53 4853.5,-12304.17 4517.88,-12260.74 3490.29,-12244.22 3118.53,-12239.57"/>
<polygon fill="black" stroke="black" points="3118.31,-12236.07 3108.26,-12239.44 3118.22,-12243.06 3118.31,-12236.07"/>
</g>
<!-- expert_27_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge443" class="edge">
<title>expert_27_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M5048.97,-12305.37C5046.12,-12304.93 5043.29,-12304.53 5040.5,-12304.17 4667.07,-12256.45 3515.04,-12242.5 3118.36,-12239.06"/>
<polygon fill="black" stroke="black" points="3118.31,-12235.56 3108.28,-12238.97 3118.25,-12242.56 3118.31,-12235.56"/>
</g>
<!-- expert_28_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge444" class="edge">
<title>expert_28_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M5235.98,-12305.36C5233.12,-12304.92 5230.29,-12304.52 5227.5,-12304.17 4816.19,-12252.17 3539.17,-12240.94 3118.45,-12238.63"/>
<polygon fill="black" stroke="black" points="3118.39,-12235.13 3108.37,-12238.58 3118.35,-12242.13 3118.39,-12235.13"/>
</g>
<!-- expert_29_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge445" class="edge">
<title>expert_29_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M5422.98,-12305.35C5420.12,-12304.92 5417.29,-12304.52 5414.5,-12304.17 4965.28,-12247.89 3563,-12239.51 3118.86,-12238.27"/>
<polygon fill="black" stroke="black" points="3118.55,-12234.77 3108.54,-12238.24 3118.53,-12241.77 3118.55,-12234.77"/>
</g>
<!-- expert_30_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge446" class="edge">
<title>expert_30_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M5609.98,-12305.34C5607.12,-12304.91 5604.29,-12304.52 5601.5,-12304.17 5114.1,-12243.59 3585.1,-12238.17 3118.84,-12237.96"/>
<polygon fill="black" stroke="black" points="3118.69,-12234.46 3108.69,-12237.96 3118.69,-12241.46 3118.69,-12234.46"/>
</g>
<!-- expert_31_s1_l5&#45;&gt;expert_combine_s1_l5 -->
<g id="edge447" class="edge">
<title>expert_31_s1_l5&#45;&gt;expert_combine_s1_l5</title>
<path fill="none" stroke="black" d="M5796.98,-12305.34C5794.12,-12304.91 5791.29,-12304.52 5788.5,-12304.17 5262.84,-12239.28 3606.55,-12236.92 3118.88,-12237.69"/>
<polygon fill="black" stroke="black" points="3118.62,-12234.19 3108.62,-12237.71 3118.63,-12241.19 3118.62,-12234.19"/>
</g>
<!-- moe_out_proj_s1_l5 -->
<g id="node263" class="node">
<title>moe_out_proj_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-12169.95 2893.5,-12169.95 2893.5,-12125.95 3071.5,-12125.95 3071.5,-12169.95"/>
<text text-anchor="middle" x="2982.5" y="-12159.55" font-family="Arial" font-size="8.00">MoE Output Proj L5 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-12150.55" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12141.55" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12132.55" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1_l5&#45;&gt;moe_out_proj_s1_l5 -->
<g id="edge448" class="edge">
<title>expert_combine_s1_l5&#45;&gt;moe_out_proj_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-12205.59C2982.5,-12197.31 2982.5,-12188.34 2982.5,-12180.02"/>
<polygon fill="black" stroke="black" points="2986,-12179.95 2982.5,-12169.95 2979,-12179.95 2986,-12179.95"/>
</g>
<!-- allreduce_moe_out_s1_l5 -->
<g id="node264" class="node">
<title>allreduce_moe_out_s1_l5</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-12058.83" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-12070.43" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L5</text>
<text text-anchor="middle" x="2982.5" y="-12061.43" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12052.43" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-12043.43" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1_l5&#45;&gt;allreduce_moe_out_s1_l5 -->
<g id="edge449" class="edge">
<title>moe_out_proj_s1_l5&#45;&gt;allreduce_moe_out_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-12125.86C2982.5,-12118.19 2982.5,-12109.23 2982.5,-12100.44"/>
<polygon fill="black" stroke="black" points="2986,-12100.28 2982.5,-12090.28 2979,-12100.28 2986,-12100.28"/>
</g>
<!-- layernorm2_s1_l5 -->
<g id="node265" class="node">
<title>layernorm2_s1_l5</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-11991.72 2893.5,-11991.72 2893.5,-11947.72 3071.5,-11947.72 3071.5,-11991.72"/>
<text text-anchor="middle" x="2982.5" y="-11981.32" font-family="Arial" font-size="8.00">LayerNorm 2 (L5)</text>
<text text-anchor="middle" x="2982.5" y="-11972.32" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11963.32" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11954.32" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1_l5&#45;&gt;layernorm2_s1_l5 -->
<g id="edge450" class="edge">
<title>allreduce_moe_out_s1_l5&#45;&gt;layernorm2_s1_l5</title>
<path fill="none" stroke="black" d="M2982.5,-12027.37C2982.5,-12019.09 2982.5,-12010.11 2982.5,-12001.8"/>
<polygon fill="black" stroke="black" points="2986,-12001.72 2982.5,-11991.72 2979,-12001.72 2986,-12001.72"/>
</g>
<!-- layernorm1_s1_l6 -->
<g id="node266" class="node">
<title>layernorm1_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-11911.72 2893.5,-11911.72 2893.5,-11867.72 3071.5,-11867.72 3071.5,-11911.72"/>
<text text-anchor="middle" x="2982.5" y="-11901.32" font-family="Arial" font-size="8.00">LayerNorm 1 (L6)</text>
<text text-anchor="middle" x="2982.5" y="-11892.32" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11883.32" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11874.32" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm2_s1_l5&#45;&gt;layernorm1_s1_l6 -->
<g id="edge451" class="edge">
<title>layernorm2_s1_l5&#45;&gt;layernorm1_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-11947.41C2982.5,-11939.52 2982.5,-11930.4 2982.5,-11921.82"/>
<polygon fill="black" stroke="black" points="2986,-11921.74 2982.5,-11911.74 2979,-11921.74 2986,-11921.74"/>
</g>
<!-- qkv_proj_s1_l6 -->
<g id="node267" class="node">
<title>qkv_proj_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3081,-11831.72 2884,-11831.72 2884,-11787.72 3081,-11787.72 3081,-11831.72"/>
<text text-anchor="middle" x="2982.5" y="-11821.32" font-family="Arial" font-size="8.00">QKV Projection L6 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-11812.32" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11803.32" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-11794.32" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1_l6&#45;&gt;qkv_proj_s1_l6 -->
<g id="edge452" class="edge">
<title>layernorm1_s1_l6&#45;&gt;qkv_proj_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-11867.41C2982.5,-11859.52 2982.5,-11850.4 2982.5,-11841.82"/>
<polygon fill="black" stroke="black" points="2986,-11841.74 2982.5,-11831.74 2979,-11841.74 2986,-11841.74"/>
</g>
<!-- allreduce_qkv_s1_l6 -->
<g id="node268" class="node">
<title>allreduce_qkv_s1_l6</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-11720.61" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-11732.21" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L6</text>
<text text-anchor="middle" x="2982.5" y="-11723.21" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-11714.21" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-11705.21" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1_l6&#45;&gt;allreduce_qkv_s1_l6 -->
<g id="edge453" class="edge">
<title>qkv_proj_s1_l6&#45;&gt;allreduce_qkv_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-11787.63C2982.5,-11779.96 2982.5,-11771.01 2982.5,-11762.21"/>
<polygon fill="black" stroke="black" points="2986,-11762.05 2982.5,-11752.05 2979,-11762.05 2986,-11762.05"/>
</g>
<!-- attention_s1_l6 -->
<g id="node269" class="node">
<title>attention_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3081,-11653.5 2884,-11653.5 2884,-11609.5 3081,-11609.5 3081,-11653.5"/>
<text text-anchor="middle" x="2982.5" y="-11643.1" font-family="Arial" font-size="8.00">Self&#45;Attention L6</text>
<text text-anchor="middle" x="2982.5" y="-11634.1" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-11625.1" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-11616.1" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1_l6&#45;&gt;attention_s1_l6 -->
<g id="edge454" class="edge">
<title>allreduce_qkv_s1_l6&#45;&gt;attention_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-11689.14C2982.5,-11680.86 2982.5,-11671.89 2982.5,-11663.57"/>
<polygon fill="black" stroke="black" points="2986,-11663.5 2982.5,-11653.5 2979,-11663.5 2986,-11663.5"/>
</g>
<!-- attn_out_proj_s1_l6 -->
<g id="node270" class="node">
<title>attn_out_proj_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3078,-11573.5 2887,-11573.5 2887,-11529.5 3078,-11529.5 3078,-11573.5"/>
<text text-anchor="middle" x="2982.5" y="-11563.1" font-family="Arial" font-size="8.00">Attention Output Proj L6 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-11554.1" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-11545.1" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11536.1" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1_l6&#45;&gt;attn_out_proj_s1_l6 -->
<g id="edge455" class="edge">
<title>attention_s1_l6&#45;&gt;attn_out_proj_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-11609.18C2982.5,-11601.29 2982.5,-11592.18 2982.5,-11583.6"/>
<polygon fill="black" stroke="black" points="2986,-11583.51 2982.5,-11573.51 2979,-11583.51 2986,-11583.51"/>
</g>
<!-- allreduce_attn_out_s1_l6 -->
<g id="node271" class="node">
<title>allreduce_attn_out_s1_l6</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-11462.38" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-11473.98" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L6</text>
<text text-anchor="middle" x="2982.5" y="-11464.98" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11455.98" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11446.98" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1_l6&#45;&gt;allreduce_attn_out_s1_l6 -->
<g id="edge456" class="edge">
<title>attn_out_proj_s1_l6&#45;&gt;allreduce_attn_out_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-11529.41C2982.5,-11521.73 2982.5,-11512.78 2982.5,-11503.99"/>
<polygon fill="black" stroke="black" points="2986,-11503.83 2982.5,-11493.83 2979,-11503.83 2986,-11503.83"/>
</g>
<!-- moe_gate_s1_l6 -->
<g id="node272" class="node">
<title>moe_gate_s1_l6</title>
<polygon fill="orange" stroke="black" points="3167.08,-11395.27 2873.45,-11395.27 2797.92,-11307.27 3091.55,-11307.27 3167.08,-11395.27"/>
<text text-anchor="middle" x="2982.5" y="-11362.87" font-family="Arial" font-size="8.00">MoE Gate L6 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-11353.87" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11344.87" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11335.87" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1_l6&#45;&gt;moe_gate_s1_l6 -->
<g id="edge457" class="edge">
<title>allreduce_attn_out_s1_l6&#45;&gt;moe_gate_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-11430.99C2982.5,-11423.1 2982.5,-11414.37 2982.5,-11405.68"/>
<polygon fill="black" stroke="black" points="2986,-11405.55 2982.5,-11395.55 2979,-11405.55 2986,-11405.55"/>
</g>
<!-- expert_dispatch_s1_l6 -->
<g id="node273" class="node">
<title>expert_dispatch_s1_l6</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-11240.16" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-11251.76" font-family="Arial" font-size="8.00">Expert Dispatch L6 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-11242.76" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11233.76" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11224.76" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1_l6&#45;&gt;expert_dispatch_s1_l6 -->
<g id="edge458" class="edge">
<title>moe_gate_s1_l6&#45;&gt;expert_dispatch_s1_l6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-11307.15C2982.5,-11298.77 2982.5,-11290.02 2982.5,-11281.72"/>
<polygon fill="black" stroke="black" points="2986,-11281.53 2982.5,-11271.53 2979,-11281.53 2986,-11281.53"/>
</g>
<!-- expert_0_s1_l6 -->
<g id="node274" class="node">
<title>expert_0_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="169,-11173.04 0,-11173.04 0,-11129.04 169,-11129.04 169,-11173.04"/>
<text text-anchor="middle" x="84.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 0 L6</text>
<text text-anchor="middle" x="84.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_0_s1_l6 -->
<g id="edge459" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_0_s1_l6</title>
<path fill="none" stroke="black" d="M2856.42,-11239.51C2385.23,-11240.31 727.13,-11238.4 178.99,-11173.09"/>
<polygon fill="black" stroke="black" points="179.37,-11169.61 169.02,-11171.88 178.53,-11176.56 179.37,-11169.61"/>
</g>
<!-- expert_1_s1_l6 -->
<g id="node275" class="node">
<title>expert_1_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="356,-11173.04 187,-11173.04 187,-11129.04 356,-11129.04 356,-11173.04"/>
<text text-anchor="middle" x="271.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 1 L6</text>
<text text-anchor="middle" x="271.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_1_s1_l6 -->
<g id="edge460" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_1_s1_l6</title>
<path fill="none" stroke="black" d="M2856.36,-11239.26C2405.73,-11239.12 875.66,-11234.12 366.03,-11173.09"/>
<polygon fill="black" stroke="black" points="366.37,-11169.61 356.02,-11171.87 365.52,-11176.56 366.37,-11169.61"/>
</g>
<!-- expert_2_s1_l6 -->
<g id="node276" class="node">
<title>expert_2_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="543,-11173.04 374,-11173.04 374,-11129.04 543,-11129.04 543,-11173.04"/>
<text text-anchor="middle" x="458.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 2 L6</text>
<text text-anchor="middle" x="458.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_2_s1_l6 -->
<g id="edge461" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_2_s1_l6</title>
<path fill="none" stroke="black" d="M2856.51,-11238.97C2427.43,-11237.84 1024.14,-11229.86 552.96,-11173.09"/>
<polygon fill="black" stroke="black" points="553.38,-11169.61 543.02,-11171.86 552.52,-11176.56 553.38,-11169.61"/>
</g>
<!-- expert_3_s1_l6 -->
<g id="node277" class="node">
<title>expert_3_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="730,-11173.04 561,-11173.04 561,-11129.04 730,-11129.04 730,-11173.04"/>
<text text-anchor="middle" x="645.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 3 L6</text>
<text text-anchor="middle" x="645.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_3_s1_l6 -->
<g id="edge462" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_3_s1_l6</title>
<path fill="none" stroke="black" d="M2856.69,-11238.64C2450.07,-11236.46 1173.13,-11225.62 740.1,-11173.1"/>
<polygon fill="black" stroke="black" points="740.38,-11169.61 730.02,-11171.86 739.52,-11176.56 740.38,-11169.61"/>
</g>
<!-- expert_4_s1_l6 -->
<g id="node278" class="node">
<title>expert_4_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="917,-11173.04 748,-11173.04 748,-11129.04 917,-11129.04 917,-11173.04"/>
<text text-anchor="middle" x="832.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 4 L6</text>
<text text-anchor="middle" x="832.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_4_s1_l6 -->
<g id="edge463" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_4_s1_l6</title>
<path fill="none" stroke="black" d="M2856.78,-11238.24C2473.43,-11234.97 1321.87,-11221.39 927.06,-11173.1"/>
<polygon fill="black" stroke="black" points="927.38,-11169.62 917.03,-11171.85 926.51,-11176.56 927.38,-11169.62"/>
</g>
<!-- expert_5_s1_l6 -->
<g id="node279" class="node">
<title>expert_5_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="1104,-11173.04 935,-11173.04 935,-11129.04 1104,-11129.04 1104,-11173.04"/>
<text text-anchor="middle" x="1019.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 5 L6</text>
<text text-anchor="middle" x="1019.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_5_s1_l6 -->
<g id="edge464" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_5_s1_l6</title>
<path fill="none" stroke="black" d="M2856.8,-11237.77C2497.73,-11233.34 1470.88,-11217.18 1114.13,-11173.11"/>
<polygon fill="black" stroke="black" points="1114.39,-11169.62 1104.03,-11171.83 1113.51,-11176.56 1114.39,-11169.62"/>
</g>
<!-- expert_6_s1_l6 -->
<g id="node280" class="node">
<title>expert_6_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="1291,-11173.04 1122,-11173.04 1122,-11129.04 1291,-11129.04 1291,-11173.04"/>
<text text-anchor="middle" x="1206.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 6 L6</text>
<text text-anchor="middle" x="1206.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_6_s1_l6 -->
<g id="edge465" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_6_s1_l6</title>
<path fill="none" stroke="black" d="M2857.17,-11237.2C2523.91,-11231.54 1620.17,-11213 1301.21,-11173.13"/>
<polygon fill="black" stroke="black" points="1301.39,-11169.62 1291.03,-11171.82 1300.5,-11176.56 1301.39,-11169.62"/>
</g>
<!-- expert_7_s1_l6 -->
<g id="node281" class="node">
<title>expert_7_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="1478,-11173.04 1309,-11173.04 1309,-11129.04 1478,-11129.04 1478,-11173.04"/>
<text text-anchor="middle" x="1393.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 7 L6</text>
<text text-anchor="middle" x="1393.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_7_s1_l6 -->
<g id="edge466" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_7_s1_l6</title>
<path fill="none" stroke="black" d="M2857.5,-11236.5C2551.41,-11229.53 1769.45,-11208.85 1488.23,-11173.13"/>
<polygon fill="black" stroke="black" points="1488.4,-11169.63 1478.03,-11171.8 1487.49,-11176.57 1488.4,-11169.63"/>
</g>
<!-- expert_8_s1_l6 -->
<g id="node282" class="node">
<title>expert_8_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="1665,-11173.04 1496,-11173.04 1496,-11129.04 1665,-11129.04 1665,-11173.04"/>
<text text-anchor="middle" x="1580.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 8 L6</text>
<text text-anchor="middle" x="1580.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_8_s1_l6 -->
<g id="edge467" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_8_s1_l6</title>
<path fill="none" stroke="black" d="M2856.38,-11239.95C2623.94,-11239.85 2112.47,-11232.28 1675.03,-11173.14"/>
<polygon fill="black" stroke="black" points="1675.42,-11169.66 1665.03,-11171.78 1674.47,-11176.6 1675.42,-11169.66"/>
</g>
<!-- expert_9_s1_l6 -->
<g id="node283" class="node">
<title>expert_9_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="1852,-11173.04 1683,-11173.04 1683,-11129.04 1852,-11129.04 1852,-11173.04"/>
<text text-anchor="middle" x="1767.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 9 L6</text>
<text text-anchor="middle" x="1767.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_9_s1_l6 -->
<g id="edge468" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_9_s1_l6</title>
<path fill="none" stroke="black" d="M2856.48,-11238.42C2650.05,-11235.73 2227.11,-11224.01 1862.01,-11173.15"/>
<polygon fill="black" stroke="black" points="1862.43,-11169.67 1852.04,-11171.75 1861.45,-11176.61 1862.43,-11169.67"/>
</g>
<!-- expert_10_s1_l6 -->
<g id="node284" class="node">
<title>expert_10_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="2039,-11173.04 1870,-11173.04 1870,-11129.04 2039,-11129.04 2039,-11173.04"/>
<text text-anchor="middle" x="1954.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 10 L6</text>
<text text-anchor="middle" x="1954.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_10_s1_l6 -->
<g id="edge469" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_10_s1_l6</title>
<path fill="none" stroke="black" d="M2857.46,-11236.33C2679.53,-11230.96 2343.14,-11215.83 2049.05,-11173.17"/>
<polygon fill="black" stroke="black" points="2049.45,-11169.69 2039.05,-11171.71 2048.43,-11176.62 2049.45,-11169.69"/>
</g>
<!-- expert_11_s1_l6 -->
<g id="node285" class="node">
<title>expert_11_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="2226,-11173.04 2057,-11173.04 2057,-11129.04 2226,-11129.04 2226,-11173.04"/>
<text text-anchor="middle" x="2141.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 11 L6</text>
<text text-anchor="middle" x="2141.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_11_s1_l6 -->
<g id="edge470" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_11_s1_l6</title>
<path fill="none" stroke="black" d="M2859.45,-11233.34C2712.89,-11225.27 2460.66,-11207.76 2236.05,-11173.19"/>
<polygon fill="black" stroke="black" points="2236.47,-11169.72 2226.05,-11171.64 2235.4,-11176.64 2236.47,-11169.72"/>
</g>
<!-- expert_12_s1_l6 -->
<g id="node286" class="node">
<title>expert_12_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="2413,-11173.04 2244,-11173.04 2244,-11129.04 2413,-11129.04 2413,-11173.04"/>
<text text-anchor="middle" x="2328.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 12 L6</text>
<text text-anchor="middle" x="2328.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_12_s1_l6 -->
<g id="edge471" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_12_s1_l6</title>
<path fill="none" stroke="black" d="M2864.87,-11228.91C2753.34,-11218.36 2580.99,-11199.91 2422.98,-11173.22"/>
<polygon fill="black" stroke="black" points="2423.52,-11169.76 2413.07,-11171.54 2422.34,-11176.67 2423.52,-11169.76"/>
</g>
<!-- expert_13_s1_l6 -->
<g id="node287" class="node">
<title>expert_13_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="2600,-11173.04 2431,-11173.04 2431,-11129.04 2600,-11129.04 2600,-11173.04"/>
<text text-anchor="middle" x="2515.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 13 L6</text>
<text text-anchor="middle" x="2515.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_13_s1_l6 -->
<g id="edge472" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_13_s1_l6</title>
<path fill="none" stroke="black" d="M2879.07,-11222.22C2806.34,-11209.99 2706.53,-11192.58 2610.04,-11173.32"/>
<polygon fill="black" stroke="black" points="2610.6,-11169.86 2600.11,-11171.33 2609.23,-11176.73 2610.6,-11169.86"/>
</g>
<!-- expert_14_s1_l6 -->
<g id="node288" class="node">
<title>expert_14_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="2787,-11173.04 2618,-11173.04 2618,-11129.04 2787,-11129.04 2787,-11173.04"/>
<text text-anchor="middle" x="2702.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 14 L6</text>
<text text-anchor="middle" x="2702.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_14_s1_l6 -->
<g id="edge473" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_14_s1_l6</title>
<path fill="none" stroke="black" d="M2905.99,-11215.35C2866.88,-11203.19 2819.39,-11188.41 2780.12,-11176.19"/>
<polygon fill="black" stroke="black" points="2780.91,-11172.77 2770.32,-11173.15 2778.83,-11179.46 2780.91,-11172.77"/>
</g>
<!-- expert_15_s1_l6 -->
<g id="node289" class="node">
<title>expert_15_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="2974,-11173.04 2805,-11173.04 2805,-11129.04 2974,-11129.04 2974,-11173.04"/>
<text text-anchor="middle" x="2889.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 15 L6</text>
<text text-anchor="middle" x="2889.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_15_s1_l6 -->
<g id="edge474" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_15_s1_l6</title>
<path fill="none" stroke="black" d="M2951.27,-11209.91C2941.01,-11200.3 2929.64,-11189.64 2919.47,-11180.12"/>
<polygon fill="black" stroke="black" points="2921.66,-11177.38 2911.97,-11173.1 2916.88,-11182.49 2921.66,-11177.38"/>
</g>
<!-- expert_16_s1_l6 -->
<g id="node290" class="node">
<title>expert_16_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3161,-11173.04 2992,-11173.04 2992,-11129.04 3161,-11129.04 3161,-11173.04"/>
<text text-anchor="middle" x="3076.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 16 L6</text>
<text text-anchor="middle" x="3076.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_16_s1_l6 -->
<g id="edge475" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_16_s1_l6</title>
<path fill="none" stroke="black" d="M3014.06,-11209.91C3024.43,-11200.3 3035.93,-11189.64 3046.21,-11180.12"/>
<polygon fill="black" stroke="black" points="3048.83,-11182.46 3053.78,-11173.1 3044.07,-11177.33 3048.83,-11182.46"/>
</g>
<!-- expert_17_s1_l6 -->
<g id="node291" class="node">
<title>expert_17_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3348,-11173.04 3179,-11173.04 3179,-11129.04 3348,-11129.04 3348,-11173.04"/>
<text text-anchor="middle" x="3263.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 17 L6</text>
<text text-anchor="middle" x="3263.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_17_s1_l6 -->
<g id="edge476" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_17_s1_l6</title>
<path fill="none" stroke="black" d="M3059.28,-11215.35C3098.53,-11203.19 3146.2,-11188.41 3185.6,-11176.19"/>
<polygon fill="black" stroke="black" points="3186.92,-11179.45 3195.43,-11173.15 3184.84,-11172.76 3186.92,-11179.45"/>
</g>
<!-- expert_18_s1_l6 -->
<g id="node292" class="node">
<title>expert_18_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3535,-11173.04 3366,-11173.04 3366,-11129.04 3535,-11129.04 3535,-11173.04"/>
<text text-anchor="middle" x="3450.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 18 L6</text>
<text text-anchor="middle" x="3450.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_18_s1_l6 -->
<g id="edge477" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_18_s1_l6</title>
<path fill="none" stroke="black" d="M3085.81,-11222.3C3158.76,-11210.08 3259.03,-11192.64 3355.92,-11173.33"/>
<polygon fill="black" stroke="black" points="3356.77,-11176.73 3365.89,-11171.33 3355.4,-11169.86 3356.77,-11176.73"/>
</g>
<!-- expert_19_s1_l6 -->
<g id="node293" class="node">
<title>expert_19_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3722,-11173.04 3553,-11173.04 3553,-11129.04 3722,-11129.04 3722,-11173.04"/>
<text text-anchor="middle" x="3637.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 19 L6</text>
<text text-anchor="middle" x="3637.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_19_s1_l6 -->
<g id="edge478" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_19_s1_l6</title>
<path fill="none" stroke="black" d="M3100.07,-11228.95C3211.79,-11218.42 3384.6,-11199.96 3543,-11173.23"/>
<polygon fill="black" stroke="black" points="3543.66,-11176.67 3552.93,-11171.54 3542.48,-11169.76 3543.66,-11176.67"/>
</g>
<!-- expert_20_s1_l6 -->
<g id="node294" class="node">
<title>expert_20_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3909,-11173.04 3740,-11173.04 3740,-11129.04 3909,-11129.04 3909,-11173.04"/>
<text text-anchor="middle" x="3824.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 20 L6</text>
<text text-anchor="middle" x="3824.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_20_s1_l6 -->
<g id="edge479" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_20_s1_l6</title>
<path fill="none" stroke="black" d="M3105.39,-11233.37C3252.09,-11225.32 3504.87,-11207.81 3729.93,-11173.2"/>
<polygon fill="black" stroke="black" points="3730.6,-11176.64 3739.95,-11171.64 3729.53,-11169.72 3730.6,-11176.64"/>
</g>
<!-- expert_21_s1_l6 -->
<g id="node295" class="node">
<title>expert_21_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="4096,-11173.04 3927,-11173.04 3927,-11129.04 4096,-11129.04 4096,-11173.04"/>
<text text-anchor="middle" x="4011.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 21 L6</text>
<text text-anchor="middle" x="4011.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_21_s1_l6 -->
<g id="edge480" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_21_s1_l6</title>
<path fill="none" stroke="black" d="M3107.68,-11236.34C3285.8,-11230.98 3622.55,-11215.87 3916.94,-11173.17"/>
<polygon fill="black" stroke="black" points="3917.57,-11176.62 3926.96,-11171.71 3916.55,-11169.69 3917.57,-11176.62"/>
</g>
<!-- expert_22_s1_l6 -->
<g id="node296" class="node">
<title>expert_22_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="4283,-11173.04 4114,-11173.04 4114,-11129.04 4283,-11129.04 4283,-11173.04"/>
<text text-anchor="middle" x="4198.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 22 L6</text>
<text text-anchor="middle" x="4198.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_22_s1_l6 -->
<g id="edge481" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_22_s1_l6</title>
<path fill="none" stroke="black" d="M3108.22,-11238.43C3314.67,-11235.76 3738.31,-11224.07 4103.98,-11173.15"/>
<polygon fill="black" stroke="black" points="4104.55,-11176.61 4113.96,-11171.75 4103.57,-11169.67 4104.55,-11176.61"/>
</g>
<!-- expert_23_s1_l6 -->
<g id="node297" class="node">
<title>expert_23_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="4470,-11173.04 4301,-11173.04 4301,-11129.04 4470,-11129.04 4470,-11173.04"/>
<text text-anchor="middle" x="4385.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 23 L6</text>
<text text-anchor="middle" x="4385.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_23_s1_l6 -->
<g id="edge482" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_23_s1_l6</title>
<path fill="none" stroke="black" d="M3108.71,-11239.96C3341.33,-11239.87 3853.2,-11232.32 4290.96,-11173.14"/>
<polygon fill="black" stroke="black" points="4291.53,-11176.6 4300.97,-11171.78 4290.58,-11169.66 4291.53,-11176.6"/>
</g>
<!-- expert_24_s1_l6 -->
<g id="node298" class="node">
<title>expert_24_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="4657,-11173.04 4488,-11173.04 4488,-11129.04 4657,-11129.04 4657,-11173.04"/>
<text text-anchor="middle" x="4572.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 24 L6</text>
<text text-anchor="middle" x="4572.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_24_s1_l6 -->
<g id="edge483" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_24_s1_l6</title>
<path fill="none" stroke="black" d="M3107.58,-11236.5C3413.87,-11229.54 4196.36,-11208.87 4477.77,-11173.13"/>
<polygon fill="black" stroke="black" points="4478.51,-11176.57 4487.97,-11171.8 4477.6,-11169.63 4478.51,-11176.57"/>
</g>
<!-- expert_25_s1_l6 -->
<g id="node299" class="node">
<title>expert_25_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="4844,-11173.04 4675,-11173.04 4675,-11129.04 4844,-11129.04 4844,-11173.04"/>
<text text-anchor="middle" x="4759.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 25 L6</text>
<text text-anchor="middle" x="4759.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_25_s1_l6 -->
<g id="edge484" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_25_s1_l6</title>
<path fill="none" stroke="black" d="M3107.91,-11237.21C3441.37,-11231.55 4345.64,-11213.02 4664.78,-11173.13"/>
<polygon fill="black" stroke="black" points="4665.5,-11176.56 4674.97,-11171.82 4664.61,-11169.62 4665.5,-11176.56"/>
</g>
<!-- expert_26_s1_l6 -->
<g id="node300" class="node">
<title>expert_26_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="5031,-11173.04 4862,-11173.04 4862,-11129.04 5031,-11129.04 5031,-11173.04"/>
<text text-anchor="middle" x="4946.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 26 L6</text>
<text text-anchor="middle" x="4946.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_26_s1_l6 -->
<g id="edge485" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_26_s1_l6</title>
<path fill="none" stroke="black" d="M3108.26,-11237.78C3467.53,-11233.35 4494.93,-11217.2 4851.87,-11173.11"/>
<polygon fill="black" stroke="black" points="4852.49,-11176.56 4861.97,-11171.83 4851.61,-11169.62 4852.49,-11176.56"/>
</g>
<!-- expert_27_s1_l6 -->
<g id="node301" class="node">
<title>expert_27_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="5218,-11173.04 5049,-11173.04 5049,-11129.04 5218,-11129.04 5218,-11173.04"/>
<text text-anchor="middle" x="5133.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 27 L6</text>
<text text-anchor="middle" x="5133.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_27_s1_l6 -->
<g id="edge486" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_27_s1_l6</title>
<path fill="none" stroke="black" d="M3108.28,-11238.25C3491.82,-11234.98 4643.94,-11221.41 5038.93,-11173.1"/>
<polygon fill="black" stroke="black" points="5039.49,-11176.56 5048.97,-11171.85 5038.62,-11169.62 5039.49,-11176.56"/>
</g>
<!-- expert_28_s1_l6 -->
<g id="node302" class="node">
<title>expert_28_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="5405,-11173.04 5236,-11173.04 5236,-11129.04 5405,-11129.04 5405,-11173.04"/>
<text text-anchor="middle" x="5320.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 28 L6</text>
<text text-anchor="middle" x="5320.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_28_s1_l6 -->
<g id="edge487" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_28_s1_l6</title>
<path fill="none" stroke="black" d="M3108.37,-11238.64C3515.16,-11236.47 4792.68,-11225.64 5225.9,-11173.1"/>
<polygon fill="black" stroke="black" points="5226.48,-11176.56 5235.98,-11171.86 5225.62,-11169.61 5226.48,-11176.56"/>
</g>
<!-- expert_29_s1_l6 -->
<g id="node303" class="node">
<title>expert_29_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="5592,-11173.04 5423,-11173.04 5423,-11129.04 5592,-11129.04 5592,-11173.04"/>
<text text-anchor="middle" x="5507.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 29 L6</text>
<text text-anchor="middle" x="5507.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_29_s1_l6 -->
<g id="edge488" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_29_s1_l6</title>
<path fill="none" stroke="black" d="M3108.54,-11238.97C3537.8,-11237.84 4941.67,-11229.88 5413.04,-11173.09"/>
<polygon fill="black" stroke="black" points="5413.48,-11176.56 5422.98,-11171.86 5412.62,-11169.61 5413.48,-11176.56"/>
</g>
<!-- expert_30_s1_l6 -->
<g id="node304" class="node">
<title>expert_30_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="5779,-11173.04 5610,-11173.04 5610,-11129.04 5779,-11129.04 5779,-11173.04"/>
<text text-anchor="middle" x="5694.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 30 L6</text>
<text text-anchor="middle" x="5694.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_30_s1_l6 -->
<g id="edge489" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_30_s1_l6</title>
<path fill="none" stroke="black" d="M3108.69,-11239.26C3559.49,-11239.12 5090.14,-11234.14 5599.96,-11173.09"/>
<polygon fill="black" stroke="black" points="5600.48,-11176.56 5609.98,-11171.87 5599.63,-11169.61 5600.48,-11176.56"/>
</g>
<!-- expert_31_s1_l6 -->
<g id="node305" class="node">
<title>expert_31_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="5966,-11173.04 5797,-11173.04 5797,-11129.04 5966,-11129.04 5966,-11173.04"/>
<text text-anchor="middle" x="5881.5" y="-11162.64" font-family="Arial" font-size="8.00">Expert 31 L6</text>
<text text-anchor="middle" x="5881.5" y="-11153.64" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-11144.64" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-11135.64" font-family="Arial" font-size="8.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1_l6&#45;&gt;expert_31_s1_l6 -->
<g id="edge490" class="edge">
<title>expert_dispatch_s1_l6&#45;&gt;expert_31_s1_l6</title>
<path fill="none" stroke="black" d="M3108.62,-11239.51C3579.98,-11240.32 5238.67,-11238.42 5787,-11173.09"/>
<polygon fill="black" stroke="black" points="5787.47,-11176.56 5796.98,-11171.88 5786.63,-11169.61 5787.47,-11176.56"/>
</g>
<!-- expert_combine_s1_l6 -->
<g id="node306" class="node">
<title>expert_combine_s1_l6</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-11061.93" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-11073.53" font-family="Arial" font-size="8.00">Expert Combine L6 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-11064.53" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-11055.53" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-11046.53" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge491" class="edge">
<title>expert_0_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M169.02,-11130.21C171.88,-11129.78 174.71,-11129.39 177.5,-11129.04 702.97,-11064.18 2358.67,-11061.8 2846.17,-11062.56"/>
<polygon fill="black" stroke="black" points="2846.42,-11066.06 2856.42,-11062.58 2846.43,-11059.06 2846.42,-11066.06"/>
</g>
<!-- expert_1_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge492" class="edge">
<title>expert_1_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M356.02,-11130.22C358.88,-11129.79 361.71,-11129.39 364.5,-11129.04 851.71,-11068.48 2380.13,-11063.05 2846.21,-11062.83"/>
<polygon fill="black" stroke="black" points="2846.36,-11066.33 2856.36,-11062.83 2846.36,-11059.33 2846.36,-11066.33"/>
</g>
<!-- expert_2_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge493" class="edge">
<title>expert_2_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M543.02,-11130.22C545.88,-11129.79 548.71,-11129.39 551.5,-11129.04 1000.54,-11072.79 2402.24,-11064.39 2846.2,-11063.14"/>
<polygon fill="black" stroke="black" points="2846.52,-11066.64 2856.51,-11063.12 2846.5,-11059.64 2846.52,-11066.64"/>
</g>
<!-- expert_3_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge494" class="edge">
<title>expert_3_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M730.02,-11130.23C732.88,-11129.8 735.71,-11129.4 738.5,-11129.04 1149.63,-11077.06 2426.08,-11065.82 2846.61,-11063.51"/>
<polygon fill="black" stroke="black" points="2846.7,-11067.01 2856.69,-11063.45 2846.67,-11060.01 2846.7,-11067.01"/>
</g>
<!-- expert_4_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge495" class="edge">
<title>expert_4_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M917.03,-11130.24C919.88,-11129.8 922.71,-11129.4 925.5,-11129.04 1298.74,-11081.35 2450.22,-11067.38 2846.7,-11063.93"/>
<polygon fill="black" stroke="black" points="2846.81,-11067.43 2856.78,-11063.84 2846.75,-11060.43 2846.81,-11067.43"/>
</g>
<!-- expert_5_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge496" class="edge">
<title>expert_5_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M1104.03,-11130.25C1106.88,-11129.81 1109.71,-11129.41 1112.5,-11129.04 1447.94,-11085.63 2474.98,-11069.1 2846.54,-11064.44"/>
<polygon fill="black" stroke="black" points="2846.85,-11067.94 2856.8,-11064.32 2846.76,-11060.94 2846.85,-11067.94"/>
</g>
<!-- expert_6_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge497" class="edge">
<title>expert_6_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M1291.03,-11130.27C1293.88,-11129.82 1296.71,-11129.41 1299.5,-11129.04 1597.53,-11089.88 2502.38,-11070.98 2847.13,-11065.06"/>
<polygon fill="black" stroke="black" points="2847.23,-11068.55 2857.17,-11064.88 2847.11,-11061.56 2847.23,-11068.55"/>
</g>
<!-- expert_7_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge498" class="edge">
<title>expert_7_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M1478.03,-11130.29C1480.88,-11129.83 1483.71,-11129.42 1486.5,-11129.04 1747.22,-11094.13 2530.56,-11073.1 2847.35,-11065.82"/>
<polygon fill="black" stroke="black" points="2847.58,-11069.32 2857.5,-11065.59 2847.42,-11062.32 2847.58,-11069.32"/>
</g>
<!-- expert_8_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge499" class="edge">
<title>expert_8_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M1665.03,-11130.31C1667.88,-11129.85 1670.71,-11129.43 1673.5,-11129.04 2098.54,-11070.76 2607.53,-11062.47 2846.26,-11062.14"/>
<polygon fill="black" stroke="black" points="2846.39,-11065.64 2856.38,-11062.13 2846.38,-11058.64 2846.39,-11065.64"/>
</g>
<!-- expert_9_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge500" class="edge">
<title>expert_9_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M1852.04,-11130.34C1854.89,-11129.87 1857.71,-11129.44 1860.5,-11129.04 2213.6,-11079.12 2634.37,-11066.78 2846.24,-11063.81"/>
<polygon fill="black" stroke="black" points="2846.52,-11067.31 2856.48,-11063.67 2846.43,-11060.31 2846.52,-11067.31"/>
</g>
<!-- expert_10_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge501" class="edge">
<title>expert_10_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M2039.05,-11130.38C2041.89,-11129.9 2044.72,-11129.45 2047.5,-11129.04 2330.13,-11087.39 2664.83,-11071.77 2847.27,-11066.07"/>
<polygon fill="black" stroke="black" points="2847.57,-11069.57 2857.46,-11065.76 2847.35,-11062.57 2847.57,-11069.57"/>
</g>
<!-- expert_11_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge502" class="edge">
<title>expert_11_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M2226.05,-11130.45C2228.9,-11129.95 2231.72,-11129.48 2234.5,-11129.04 2448.23,-11095.62 2699.16,-11077.75 2849.26,-11069.31"/>
<polygon fill="black" stroke="black" points="2849.66,-11072.8 2859.45,-11068.75 2849.27,-11065.81 2849.66,-11072.8"/>
</g>
<!-- expert_12_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge503" class="edge">
<title>expert_12_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M2413.07,-11130.55C2415.91,-11130.02 2418.73,-11129.52 2421.5,-11129.04 2569.28,-11103.72 2740.64,-11085.07 2854.7,-11074.15"/>
<polygon fill="black" stroke="black" points="2855.24,-11077.61 2864.87,-11073.18 2854.58,-11070.64 2855.24,-11077.61"/>
</g>
<!-- expert_13_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge504" class="edge">
<title>expert_13_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M2600.11,-11130.76C2602.94,-11130.17 2605.74,-11129.6 2608.5,-11129.04 2695.55,-11111.53 2794.51,-11094.15 2868.76,-11081.61"/>
<polygon fill="black" stroke="black" points="2869.79,-11084.98 2879.07,-11079.87 2868.63,-11078.08 2869.79,-11084.98"/>
</g>
<!-- expert_14_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge505" class="edge">
<title>expert_14_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M2770.28,-11128.96C2808.19,-11117.16 2855.83,-11102.34 2896.36,-11089.73"/>
<polygon fill="black" stroke="black" points="2897.45,-11093.06 2905.96,-11086.74 2895.37,-11086.37 2897.45,-11093.06"/>
</g>
<!-- expert_15_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge506" class="edge">
<title>expert_15_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M2912.01,-11128.96C2921.53,-11120.04 2932.9,-11109.39 2943.7,-11099.27"/>
<polygon fill="black" stroke="black" points="2946.15,-11101.77 2951.06,-11092.38 2941.37,-11096.66 2946.15,-11101.77"/>
</g>
<!-- expert_16_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge507" class="edge">
<title>expert_16_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M3053.75,-11128.96C3044.12,-11120.04 3032.63,-11109.39 3021.71,-11099.27"/>
<polygon fill="black" stroke="black" points="3023.99,-11096.61 3014.28,-11092.38 3019.23,-11101.75 3023.99,-11096.61"/>
</g>
<!-- expert_17_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge508" class="edge">
<title>expert_17_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M3195.48,-11128.96C3157.36,-11117.14 3109.44,-11102.28 3068.71,-11089.66"/>
<polygon fill="black" stroke="black" points="3069.65,-11086.28 3059.06,-11086.67 3067.58,-11092.97 3069.65,-11086.28"/>
</g>
<!-- expert_18_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge509" class="edge">
<title>expert_18_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M3365.89,-11130.76C3363.06,-11130.17 3360.26,-11129.6 3357.5,-11129.04 3269.89,-11111.44 3170.24,-11093.99 3095.69,-11081.45"/>
<polygon fill="black" stroke="black" points="3096.25,-11077.99 3085.81,-11079.79 3095.09,-11084.89 3096.25,-11077.99"/>
</g>
<!-- expert_19_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge510" class="edge">
<title>expert_19_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M3552.93,-11130.55C3550.09,-11130.02 3547.27,-11129.52 3544.5,-11129.04 3396.34,-11103.67 3224.52,-11085.01 3110.26,-11074.1"/>
<polygon fill="black" stroke="black" points="3110.36,-11070.6 3100.07,-11073.14 3109.69,-11077.57 3110.36,-11070.6"/>
</g>
<!-- expert_20_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge511" class="edge">
<title>expert_20_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M3739.95,-11130.45C3737.1,-11129.95 3734.28,-11129.48 3731.5,-11129.04 3517.33,-11095.57 3265.85,-11077.7 3115.58,-11069.28"/>
<polygon fill="black" stroke="black" points="3115.57,-11065.78 3105.39,-11068.72 3115.18,-11072.77 3115.57,-11065.78"/>
</g>
<!-- expert_21_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge512" class="edge">
<title>expert_21_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M3926.96,-11130.38C3924.11,-11129.9 3921.28,-11129.45 3918.5,-11129.04 3635.57,-11087.35 3300.51,-11071.75 3117.87,-11066.06"/>
<polygon fill="black" stroke="black" points="3117.78,-11062.56 3107.68,-11065.75 3117.57,-11069.56 3117.78,-11062.56"/>
</g>
<!-- expert_22_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge513" class="edge">
<title>expert_22_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M4113.96,-11130.34C4111.11,-11129.87 4108.29,-11129.44 4105.5,-11129.04 3751.85,-11079.05 3330.37,-11066.74 3118.46,-11063.79"/>
<polygon fill="black" stroke="black" points="3118.26,-11060.29 3108.22,-11063.66 3118.17,-11067.29 3118.26,-11060.29"/>
</g>
<!-- expert_23_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge514" class="edge">
<title>expert_23_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M4300.97,-11130.31C4298.12,-11129.85 4295.29,-11129.43 4292.5,-11129.04 3867.13,-11070.73 3357.75,-11062.45 3118.84,-11062.14"/>
<polygon fill="black" stroke="black" points="3118.72,-11058.64 3108.71,-11062.13 3118.71,-11065.64 3118.72,-11058.64"/>
</g>
<!-- expert_24_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge515" class="edge">
<title>expert_24_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M4487.97,-11130.29C4485.12,-11129.83 4482.29,-11129.42 4479.5,-11129.04 4218.6,-11094.11 3434.74,-11073.09 3117.74,-11065.82"/>
<polygon fill="black" stroke="black" points="3117.66,-11062.32 3107.58,-11065.59 3117.5,-11069.32 3117.66,-11062.32"/>
</g>
<!-- expert_25_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge516" class="edge">
<title>expert_25_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M4674.97,-11130.27C4672.12,-11129.82 4669.29,-11129.41 4666.5,-11129.04 4368.29,-11089.86 3462.9,-11070.97 3117.95,-11065.05"/>
<polygon fill="black" stroke="black" points="3117.97,-11061.55 3107.91,-11064.88 3117.85,-11068.55 3117.97,-11061.55"/>
</g>
<!-- expert_26_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge517" class="edge">
<title>expert_26_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M4861.97,-11130.25C4859.12,-11129.81 4856.29,-11129.41 4853.5,-11129.04 4517.88,-11085.61 3490.29,-11069.09 3118.53,-11064.44"/>
<polygon fill="black" stroke="black" points="3118.31,-11060.94 3108.26,-11064.31 3118.22,-11067.94 3118.31,-11060.94"/>
</g>
<!-- expert_27_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge518" class="edge">
<title>expert_27_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M5048.97,-11130.24C5046.12,-11129.8 5043.29,-11129.4 5040.5,-11129.04 4667.07,-11081.33 3515.04,-11067.38 3118.36,-11063.93"/>
<polygon fill="black" stroke="black" points="3118.31,-11060.43 3108.28,-11063.84 3118.25,-11067.43 3118.31,-11060.43"/>
</g>
<!-- expert_28_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge519" class="edge">
<title>expert_28_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M5235.98,-11130.23C5233.12,-11129.8 5230.29,-11129.4 5227.5,-11129.04 4816.19,-11077.04 3539.17,-11065.82 3118.45,-11063.5"/>
<polygon fill="black" stroke="black" points="3118.39,-11060 3108.37,-11063.45 3118.35,-11067 3118.39,-11060"/>
</g>
<!-- expert_29_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge520" class="edge">
<title>expert_29_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M5422.98,-11130.22C5420.12,-11129.79 5417.29,-11129.39 5414.5,-11129.04 4965.28,-11072.77 3563,-11064.38 3118.86,-11063.14"/>
<polygon fill="black" stroke="black" points="3118.55,-11059.64 3108.54,-11063.12 3118.53,-11066.64 3118.55,-11059.64"/>
</g>
<!-- expert_30_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge521" class="edge">
<title>expert_30_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M5609.98,-11130.22C5607.12,-11129.79 5604.29,-11129.39 5601.5,-11129.04 5114.1,-11068.46 3585.1,-11063.05 3118.84,-11062.83"/>
<polygon fill="black" stroke="black" points="3118.69,-11059.33 3108.69,-11062.83 3118.69,-11066.33 3118.69,-11059.33"/>
</g>
<!-- expert_31_s1_l6&#45;&gt;expert_combine_s1_l6 -->
<g id="edge522" class="edge">
<title>expert_31_s1_l6&#45;&gt;expert_combine_s1_l6</title>
<path fill="none" stroke="black" d="M5796.98,-11130.21C5794.12,-11129.78 5791.29,-11129.39 5788.5,-11129.04 5262.84,-11064.16 3606.55,-11061.8 3118.88,-11062.56"/>
<polygon fill="black" stroke="black" points="3118.62,-11059.06 3108.62,-11062.58 3118.63,-11066.06 3118.62,-11059.06"/>
</g>
<!-- moe_out_proj_s1_l6 -->
<g id="node307" class="node">
<title>moe_out_proj_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-10994.82 2893.5,-10994.82 2893.5,-10950.82 3071.5,-10950.82 3071.5,-10994.82"/>
<text text-anchor="middle" x="2982.5" y="-10984.42" font-family="Arial" font-size="8.00">MoE Output Proj L6 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-10975.42" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10966.42" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10957.42" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1_l6&#45;&gt;moe_out_proj_s1_l6 -->
<g id="edge523" class="edge">
<title>expert_combine_s1_l6&#45;&gt;moe_out_proj_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-11030.46C2982.5,-11022.18 2982.5,-11013.21 2982.5,-11004.9"/>
<polygon fill="black" stroke="black" points="2986,-11004.82 2982.5,-10994.82 2979,-11004.82 2986,-11004.82"/>
</g>
<!-- allreduce_moe_out_s1_l6 -->
<g id="node308" class="node">
<title>allreduce_moe_out_s1_l6</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-10883.71" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-10895.31" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L6</text>
<text text-anchor="middle" x="2982.5" y="-10886.31" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10877.31" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10868.31" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1_l6&#45;&gt;allreduce_moe_out_s1_l6 -->
<g id="edge524" class="edge">
<title>moe_out_proj_s1_l6&#45;&gt;allreduce_moe_out_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-10950.73C2982.5,-10943.06 2982.5,-10934.11 2982.5,-10925.31"/>
<polygon fill="black" stroke="black" points="2986,-10925.15 2982.5,-10915.15 2979,-10925.15 2986,-10925.15"/>
</g>
<!-- layernorm2_s1_l6 -->
<g id="node309" class="node">
<title>layernorm2_s1_l6</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-10816.59 2893.5,-10816.59 2893.5,-10772.59 3071.5,-10772.59 3071.5,-10816.59"/>
<text text-anchor="middle" x="2982.5" y="-10806.19" font-family="Arial" font-size="8.00">LayerNorm 2 (L6)</text>
<text text-anchor="middle" x="2982.5" y="-10797.19" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10788.19" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10779.19" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1_l6&#45;&gt;layernorm2_s1_l6 -->
<g id="edge525" class="edge">
<title>allreduce_moe_out_s1_l6&#45;&gt;layernorm2_s1_l6</title>
<path fill="none" stroke="black" d="M2982.5,-10852.24C2982.5,-10843.96 2982.5,-10834.98 2982.5,-10826.67"/>
<polygon fill="black" stroke="black" points="2986,-10826.6 2982.5,-10816.6 2979,-10826.6 2986,-10826.6"/>
</g>
<!-- layernorm1_s1_l7 -->
<g id="node310" class="node">
<title>layernorm1_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-10736.59 2893.5,-10736.59 2893.5,-10692.59 3071.5,-10692.59 3071.5,-10736.59"/>
<text text-anchor="middle" x="2982.5" y="-10726.19" font-family="Arial" font-size="8.00">LayerNorm 1 (L7)</text>
<text text-anchor="middle" x="2982.5" y="-10717.19" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10708.19" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10699.19" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm2_s1_l6&#45;&gt;layernorm1_s1_l7 -->
<g id="edge526" class="edge">
<title>layernorm2_s1_l6&#45;&gt;layernorm1_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-10772.28C2982.5,-10764.39 2982.5,-10755.28 2982.5,-10746.7"/>
<polygon fill="black" stroke="black" points="2986,-10746.61 2982.5,-10736.61 2979,-10746.61 2986,-10746.61"/>
</g>
<!-- qkv_proj_s1_l7 -->
<g id="node311" class="node">
<title>qkv_proj_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3081,-10656.59 2884,-10656.59 2884,-10612.59 3081,-10612.59 3081,-10656.59"/>
<text text-anchor="middle" x="2982.5" y="-10646.19" font-family="Arial" font-size="8.00">QKV Projection L7 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-10637.19" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10628.19" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-10619.19" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- layernorm1_s1_l7&#45;&gt;qkv_proj_s1_l7 -->
<g id="edge527" class="edge">
<title>layernorm1_s1_l7&#45;&gt;qkv_proj_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-10692.28C2982.5,-10684.39 2982.5,-10675.28 2982.5,-10666.7"/>
<polygon fill="black" stroke="black" points="2986,-10666.61 2982.5,-10656.61 2979,-10666.61 2986,-10666.61"/>
</g>
<!-- allreduce_qkv_s1_l7 -->
<g id="node312" class="node">
<title>allreduce_qkv_s1_l7</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-10545.48" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-10557.08" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L7</text>
<text text-anchor="middle" x="2982.5" y="-10548.08" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-10539.08" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-10530.08" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- qkv_proj_s1_l7&#45;&gt;allreduce_qkv_s1_l7 -->
<g id="edge528" class="edge">
<title>qkv_proj_s1_l7&#45;&gt;allreduce_qkv_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-10612.51C2982.5,-10604.83 2982.5,-10595.88 2982.5,-10587.09"/>
<polygon fill="black" stroke="black" points="2986,-10586.93 2982.5,-10576.93 2979,-10586.93 2986,-10586.93"/>
</g>
<!-- attention_s1_l7 -->
<g id="node313" class="node">
<title>attention_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3081,-10478.37 2884,-10478.37 2884,-10434.37 3081,-10434.37 3081,-10478.37"/>
<text text-anchor="middle" x="2982.5" y="-10467.97" font-family="Arial" font-size="8.00">Self&#45;Attention L7</text>
<text text-anchor="middle" x="2982.5" y="-10458.97" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-10449.97" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-10440.97" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_qkv_s1_l7&#45;&gt;attention_s1_l7 -->
<g id="edge529" class="edge">
<title>allreduce_qkv_s1_l7&#45;&gt;attention_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-10514.01C2982.5,-10505.73 2982.5,-10496.76 2982.5,-10488.45"/>
<polygon fill="black" stroke="black" points="2986,-10488.37 2982.5,-10478.37 2979,-10488.37 2986,-10488.37"/>
</g>
<!-- attn_out_proj_s1_l7 -->
<g id="node314" class="node">
<title>attn_out_proj_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3078,-10398.37 2887,-10398.37 2887,-10354.37 3078,-10354.37 3078,-10398.37"/>
<text text-anchor="middle" x="2982.5" y="-10387.97" font-family="Arial" font-size="8.00">Attention Output Proj L7 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-10378.97" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-10369.97" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10360.97" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attention_s1_l7&#45;&gt;attn_out_proj_s1_l7 -->
<g id="edge530" class="edge">
<title>attention_s1_l7&#45;&gt;attn_out_proj_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-10434.05C2982.5,-10426.17 2982.5,-10417.05 2982.5,-10408.47"/>
<polygon fill="black" stroke="black" points="2986,-10408.39 2982.5,-10398.39 2979,-10408.39 2986,-10408.39"/>
</g>
<!-- allreduce_attn_out_s1_l7 -->
<g id="node315" class="node">
<title>allreduce_attn_out_s1_l7</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-10287.26" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-10298.86" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L7</text>
<text text-anchor="middle" x="2982.5" y="-10289.86" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10280.86" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10271.86" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- attn_out_proj_s1_l7&#45;&gt;allreduce_attn_out_s1_l7 -->
<g id="edge531" class="edge">
<title>attn_out_proj_s1_l7&#45;&gt;allreduce_attn_out_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-10354.28C2982.5,-10346.61 2982.5,-10337.65 2982.5,-10328.86"/>
<polygon fill="black" stroke="black" points="2986,-10328.7 2982.5,-10318.7 2979,-10328.7 2986,-10328.7"/>
</g>
<!-- moe_gate_s1_l7 -->
<g id="node316" class="node">
<title>moe_gate_s1_l7</title>
<polygon fill="orange" stroke="black" points="3167.08,-10220.14 2873.45,-10220.14 2797.92,-10132.14 3091.55,-10132.14 3167.08,-10220.14"/>
<text text-anchor="middle" x="2982.5" y="-10187.74" font-family="Arial" font-size="8.00">MoE Gate L7 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-10178.74" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10169.74" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10160.74" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_attn_out_s1_l7&#45;&gt;moe_gate_s1_l7 -->
<g id="edge532" class="edge">
<title>allreduce_attn_out_s1_l7&#45;&gt;moe_gate_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-10255.86C2982.5,-10247.98 2982.5,-10239.25 2982.5,-10230.55"/>
<polygon fill="black" stroke="black" points="2986,-10230.42 2982.5,-10220.42 2979,-10230.42 2986,-10230.42"/>
</g>
<!-- expert_dispatch_s1_l7 -->
<g id="node317" class="node">
<title>expert_dispatch_s1_l7</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-10065.03" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-10076.63" font-family="Arial" font-size="8.00">Expert Dispatch L7 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-10067.63" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10058.63" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-10049.63" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_gate_s1_l7&#45;&gt;expert_dispatch_s1_l7 -->
<g id="edge533" class="edge">
<title>moe_gate_s1_l7&#45;&gt;expert_dispatch_s1_l7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-10132.02C2982.5,-10123.64 2982.5,-10114.89 2982.5,-10106.6"/>
<polygon fill="black" stroke="black" points="2986,-10106.41 2982.5,-10096.41 2979,-10106.41 2986,-10106.41"/>
</g>
<!-- expert_0_s1_l7 -->
<g id="node318" class="node">
<title>expert_0_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="169,-9997.92 0,-9997.92 0,-9953.92 169,-9953.92 169,-9997.92"/>
<text text-anchor="middle" x="84.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 0 L7</text>
<text text-anchor="middle" x="84.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 0&#45;31</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_0_s1_l7 -->
<g id="edge534" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_0_s1_l7</title>
<path fill="none" stroke="black" d="M2856.42,-10064.38C2385.23,-10065.18 727.13,-10063.27 178.99,-9997.96"/>
<polygon fill="black" stroke="black" points="179.37,-9994.48 169.02,-9996.75 178.53,-10001.43 179.37,-9994.48"/>
</g>
<!-- expert_1_s1_l7 -->
<g id="node319" class="node">
<title>expert_1_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="356,-9997.92 187,-9997.92 187,-9953.92 356,-9953.92 356,-9997.92"/>
<text text-anchor="middle" x="271.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 1 L7</text>
<text text-anchor="middle" x="271.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 32&#45;63</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_1_s1_l7 -->
<g id="edge535" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_1_s1_l7</title>
<path fill="none" stroke="black" d="M2856.36,-10064.13C2405.73,-10063.99 875.66,-10058.99 366.03,-9997.97"/>
<polygon fill="black" stroke="black" points="366.37,-9994.48 356.02,-9996.74 365.52,-10001.43 366.37,-9994.48"/>
</g>
<!-- expert_2_s1_l7 -->
<g id="node320" class="node">
<title>expert_2_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="543,-9997.92 374,-9997.92 374,-9953.92 543,-9953.92 543,-9997.92"/>
<text text-anchor="middle" x="458.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 2 L7</text>
<text text-anchor="middle" x="458.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 64&#45;95</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_2_s1_l7 -->
<g id="edge536" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_2_s1_l7</title>
<path fill="none" stroke="black" d="M2856.51,-10063.84C2427.43,-10062.71 1024.14,-10054.73 552.96,-9997.96"/>
<polygon fill="black" stroke="black" points="553.38,-9994.48 543.02,-9996.74 552.52,-10001.43 553.38,-9994.48"/>
</g>
<!-- expert_3_s1_l7 -->
<g id="node321" class="node">
<title>expert_3_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="730,-9997.92 561,-9997.92 561,-9953.92 730,-9953.92 730,-9997.92"/>
<text text-anchor="middle" x="645.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 3 L7</text>
<text text-anchor="middle" x="645.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 96&#45;127</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_3_s1_l7 -->
<g id="edge537" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_3_s1_l7</title>
<path fill="none" stroke="black" d="M2856.69,-10063.51C2450.07,-10061.34 1173.13,-10050.49 740.1,-9997.98"/>
<polygon fill="black" stroke="black" points="740.38,-9994.49 730.02,-9996.73 739.52,-10001.43 740.38,-9994.49"/>
</g>
<!-- expert_4_s1_l7 -->
<g id="node322" class="node">
<title>expert_4_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="917,-9997.92 748,-9997.92 748,-9953.92 917,-9953.92 917,-9997.92"/>
<text text-anchor="middle" x="832.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 4 L7</text>
<text text-anchor="middle" x="832.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 128&#45;159</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_4_s1_l7 -->
<g id="edge538" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_4_s1_l7</title>
<path fill="none" stroke="black" d="M2856.78,-10063.12C2473.43,-10059.85 1321.87,-10046.26 927.06,-9997.98"/>
<polygon fill="black" stroke="black" points="927.38,-9994.49 917.03,-9996.72 926.51,-10001.43 927.38,-9994.49"/>
</g>
<!-- expert_5_s1_l7 -->
<g id="node323" class="node">
<title>expert_5_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="1104,-9997.92 935,-9997.92 935,-9953.92 1104,-9953.92 1104,-9997.92"/>
<text text-anchor="middle" x="1019.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 5 L7</text>
<text text-anchor="middle" x="1019.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 160&#45;191</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_5_s1_l7 -->
<g id="edge539" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_5_s1_l7</title>
<path fill="none" stroke="black" d="M2856.8,-10062.65C2497.73,-10058.21 1470.88,-10042.05 1114.13,-9997.99"/>
<polygon fill="black" stroke="black" points="1114.39,-9994.49 1104.03,-9996.71 1113.51,-10001.44 1114.39,-9994.49"/>
</g>
<!-- expert_6_s1_l7 -->
<g id="node324" class="node">
<title>expert_6_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="1291,-9997.92 1122,-9997.92 1122,-9953.92 1291,-9953.92 1291,-9997.92"/>
<text text-anchor="middle" x="1206.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 6 L7</text>
<text text-anchor="middle" x="1206.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 192&#45;223</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_6_s1_l7 -->
<g id="edge540" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_6_s1_l7</title>
<path fill="none" stroke="black" d="M2857.17,-10062.08C2523.91,-10056.42 1620.17,-10037.88 1301.21,-9998"/>
<polygon fill="black" stroke="black" points="1301.39,-9994.49 1291.03,-9996.69 1300.5,-10001.44 1301.39,-9994.49"/>
</g>
<!-- expert_7_s1_l7 -->
<g id="node325" class="node">
<title>expert_7_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="1478,-9997.92 1309,-9997.92 1309,-9953.92 1478,-9953.92 1478,-9997.92"/>
<text text-anchor="middle" x="1393.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 7 L7</text>
<text text-anchor="middle" x="1393.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 224&#45;255</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_7_s1_l7 -->
<g id="edge541" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_7_s1_l7</title>
<path fill="none" stroke="black" d="M2857.5,-10061.37C2551.41,-10054.4 1769.45,-10033.72 1488.23,-9998.01"/>
<polygon fill="black" stroke="black" points="1488.4,-9994.5 1478.03,-9996.68 1487.49,-10001.44 1488.4,-9994.5"/>
</g>
<!-- expert_8_s1_l7 -->
<g id="node326" class="node">
<title>expert_8_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="1665,-9997.92 1496,-9997.92 1496,-9953.92 1665,-9953.92 1665,-9997.92"/>
<text text-anchor="middle" x="1580.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 8 L7</text>
<text text-anchor="middle" x="1580.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 256&#45;287</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_8_s1_l7 -->
<g id="edge542" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_8_s1_l7</title>
<path fill="none" stroke="black" d="M2856.38,-10064.83C2623.94,-10064.72 2112.47,-10057.15 1675.03,-9998.01"/>
<polygon fill="black" stroke="black" points="1675.42,-9994.53 1665.03,-9996.65 1674.47,-10001.47 1675.42,-9994.53"/>
</g>
<!-- expert_9_s1_l7 -->
<g id="node327" class="node">
<title>expert_9_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="1852,-9997.92 1683,-9997.92 1683,-9953.92 1852,-9953.92 1852,-9997.92"/>
<text text-anchor="middle" x="1767.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 9 L7</text>
<text text-anchor="middle" x="1767.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 288&#45;319</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_9_s1_l7 -->
<g id="edge543" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_9_s1_l7</title>
<path fill="none" stroke="black" d="M2856.48,-10063.29C2650.05,-10060.6 2227.11,-10048.88 1862.01,-9998.02"/>
<polygon fill="black" stroke="black" points="1862.43,-9994.55 1852.04,-9996.62 1861.45,-10001.48 1862.43,-9994.55"/>
</g>
<!-- expert_10_s1_l7 -->
<g id="node328" class="node">
<title>expert_10_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="2039,-9997.92 1870,-9997.92 1870,-9953.92 2039,-9953.92 2039,-9997.92"/>
<text text-anchor="middle" x="1954.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 10 L7</text>
<text text-anchor="middle" x="1954.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 320&#45;351</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_10_s1_l7 -->
<g id="edge544" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_10_s1_l7</title>
<path fill="none" stroke="black" d="M2857.46,-10061.2C2679.53,-10055.83 2343.14,-10040.71 2049.05,-9998.04"/>
<polygon fill="black" stroke="black" points="2049.45,-9994.56 2039.05,-9996.58 2048.43,-10001.49 2049.45,-9994.56"/>
</g>
<!-- expert_11_s1_l7 -->
<g id="node329" class="node">
<title>expert_11_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="2226,-9997.92 2057,-9997.92 2057,-9953.92 2226,-9953.92 2226,-9997.92"/>
<text text-anchor="middle" x="2141.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 11 L7</text>
<text text-anchor="middle" x="2141.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 352&#45;383</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_11_s1_l7 -->
<g id="edge545" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_11_s1_l7</title>
<path fill="none" stroke="black" d="M2859.45,-10058.22C2712.89,-10050.14 2460.66,-10032.63 2236.05,-9998.07"/>
<polygon fill="black" stroke="black" points="2236.47,-9994.59 2226.05,-9996.52 2235.4,-10001.51 2236.47,-9994.59"/>
</g>
<!-- expert_12_s1_l7 -->
<g id="node330" class="node">
<title>expert_12_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="2413,-9997.92 2244,-9997.92 2244,-9953.92 2413,-9953.92 2413,-9997.92"/>
<text text-anchor="middle" x="2328.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 12 L7</text>
<text text-anchor="middle" x="2328.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 384&#45;415</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_12_s1_l7 -->
<g id="edge546" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_12_s1_l7</title>
<path fill="none" stroke="black" d="M2864.87,-10053.78C2753.34,-10043.24 2580.99,-10024.78 2422.98,-9998.1"/>
<polygon fill="black" stroke="black" points="2423.52,-9994.64 2413.07,-9996.41 2422.34,-10001.54 2423.52,-9994.64"/>
</g>
<!-- expert_13_s1_l7 -->
<g id="node331" class="node">
<title>expert_13_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="2600,-9997.92 2431,-9997.92 2431,-9953.92 2600,-9953.92 2600,-9997.92"/>
<text text-anchor="middle" x="2515.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 13 L7</text>
<text text-anchor="middle" x="2515.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 416&#45;447</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_13_s1_l7 -->
<g id="edge547" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_13_s1_l7</title>
<path fill="none" stroke="black" d="M2879.07,-10047.09C2806.34,-10034.87 2706.53,-10017.46 2610.04,-9998.19"/>
<polygon fill="black" stroke="black" points="2610.6,-9994.74 2600.11,-9996.2 2609.23,-10001.6 2610.6,-9994.74"/>
</g>
<!-- expert_14_s1_l7 -->
<g id="node332" class="node">
<title>expert_14_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="2787,-9997.92 2618,-9997.92 2618,-9953.92 2787,-9953.92 2787,-9997.92"/>
<text text-anchor="middle" x="2702.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 14 L7</text>
<text text-anchor="middle" x="2702.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 448&#45;479</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_14_s1_l7 -->
<g id="edge548" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_14_s1_l7</title>
<path fill="none" stroke="black" d="M2905.99,-10040.23C2866.88,-10028.06 2819.39,-10013.28 2780.12,-10001.07"/>
<polygon fill="black" stroke="black" points="2780.91,-9997.65 2770.32,-9998.02 2778.83,-10004.33 2780.91,-9997.65"/>
</g>
<!-- expert_15_s1_l7 -->
<g id="node333" class="node">
<title>expert_15_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="2974,-9997.92 2805,-9997.92 2805,-9953.92 2974,-9953.92 2974,-9997.92"/>
<text text-anchor="middle" x="2889.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 15 L7</text>
<text text-anchor="middle" x="2889.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 480&#45;511</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_15_s1_l7 -->
<g id="edge549" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_15_s1_l7</title>
<path fill="none" stroke="black" d="M2951.27,-10034.78C2941.01,-10025.17 2929.64,-10014.51 2919.47,-10004.99"/>
<polygon fill="black" stroke="black" points="2921.66,-10002.25 2911.97,-9997.97 2916.88,-10007.36 2921.66,-10002.25"/>
</g>
<!-- expert_16_s1_l7 -->
<g id="node334" class="node">
<title>expert_16_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3161,-9997.92 2992,-9997.92 2992,-9953.92 3161,-9953.92 3161,-9997.92"/>
<text text-anchor="middle" x="3076.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 16 L7</text>
<text text-anchor="middle" x="3076.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 512&#45;543</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_16_s1_l7 -->
<g id="edge550" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_16_s1_l7</title>
<path fill="none" stroke="black" d="M3014.06,-10034.78C3024.43,-10025.17 3035.93,-10014.51 3046.21,-10004.99"/>
<polygon fill="black" stroke="black" points="3048.83,-10007.33 3053.78,-9997.97 3044.07,-10002.2 3048.83,-10007.33"/>
</g>
<!-- expert_17_s1_l7 -->
<g id="node335" class="node">
<title>expert_17_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3348,-9997.92 3179,-9997.92 3179,-9953.92 3348,-9953.92 3348,-9997.92"/>
<text text-anchor="middle" x="3263.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 17 L7</text>
<text text-anchor="middle" x="3263.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 544&#45;575</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_17_s1_l7 -->
<g id="edge551" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_17_s1_l7</title>
<path fill="none" stroke="black" d="M3059.28,-10040.23C3098.53,-10028.06 3146.2,-10013.28 3185.6,-10001.07"/>
<polygon fill="black" stroke="black" points="3186.92,-10004.32 3195.43,-9998.02 3184.84,-9997.64 3186.92,-10004.32"/>
</g>
<!-- expert_18_s1_l7 -->
<g id="node336" class="node">
<title>expert_18_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3535,-9997.92 3366,-9997.92 3366,-9953.92 3535,-9953.92 3535,-9997.92"/>
<text text-anchor="middle" x="3450.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 18 L7</text>
<text text-anchor="middle" x="3450.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 576&#45;607</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_18_s1_l7 -->
<g id="edge552" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_18_s1_l7</title>
<path fill="none" stroke="black" d="M3085.81,-10047.18C3158.76,-10034.96 3259.03,-10017.52 3355.92,-9998.2"/>
<polygon fill="black" stroke="black" points="3356.77,-10001.6 3365.89,-9996.2 3355.4,-9994.73 3356.77,-10001.6"/>
</g>
<!-- expert_19_s1_l7 -->
<g id="node337" class="node">
<title>expert_19_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3722,-9997.92 3553,-9997.92 3553,-9953.92 3722,-9953.92 3722,-9997.92"/>
<text text-anchor="middle" x="3637.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 19 L7</text>
<text text-anchor="middle" x="3637.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 608&#45;639</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_19_s1_l7 -->
<g id="edge553" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_19_s1_l7</title>
<path fill="none" stroke="black" d="M3100.07,-10053.82C3211.79,-10043.29 3384.6,-10024.83 3543,-9998.1"/>
<polygon fill="black" stroke="black" points="3543.66,-10001.54 3552.93,-9996.41 3542.48,-9994.64 3543.66,-10001.54"/>
</g>
<!-- expert_20_s1_l7 -->
<g id="node338" class="node">
<title>expert_20_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3909,-9997.92 3740,-9997.92 3740,-9953.92 3909,-9953.92 3909,-9997.92"/>
<text text-anchor="middle" x="3824.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 20 L7</text>
<text text-anchor="middle" x="3824.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 640&#45;671</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_20_s1_l7 -->
<g id="edge554" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_20_s1_l7</title>
<path fill="none" stroke="black" d="M3105.39,-10058.25C3252.09,-10050.19 3504.87,-10032.69 3729.93,-9998.07"/>
<polygon fill="black" stroke="black" points="3730.6,-10001.51 3739.95,-9996.52 3729.53,-9994.59 3730.6,-10001.51"/>
</g>
<!-- expert_21_s1_l7 -->
<g id="node339" class="node">
<title>expert_21_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="4096,-9997.92 3927,-9997.92 3927,-9953.92 4096,-9953.92 4096,-9997.92"/>
<text text-anchor="middle" x="4011.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 21 L7</text>
<text text-anchor="middle" x="4011.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 672&#45;703</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_21_s1_l7 -->
<g id="edge555" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_21_s1_l7</title>
<path fill="none" stroke="black" d="M3107.68,-10061.21C3285.8,-10055.85 3622.55,-10040.74 3916.94,-9998.04"/>
<polygon fill="black" stroke="black" points="3917.57,-10001.49 3926.96,-9996.58 3916.55,-9994.56 3917.57,-10001.49"/>
</g>
<!-- expert_22_s1_l7 -->
<g id="node340" class="node">
<title>expert_22_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="4283,-9997.92 4114,-9997.92 4114,-9953.92 4283,-9953.92 4283,-9997.92"/>
<text text-anchor="middle" x="4198.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 22 L7</text>
<text text-anchor="middle" x="4198.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 704&#45;735</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_22_s1_l7 -->
<g id="edge556" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_22_s1_l7</title>
<path fill="none" stroke="black" d="M3108.22,-10063.3C3314.67,-10060.63 3738.31,-10048.95 4103.98,-9998.02"/>
<polygon fill="black" stroke="black" points="4104.55,-10001.48 4113.96,-9996.62 4103.57,-9994.55 4104.55,-10001.48"/>
</g>
<!-- expert_23_s1_l7 -->
<g id="node341" class="node">
<title>expert_23_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="4470,-9997.92 4301,-9997.92 4301,-9953.92 4470,-9953.92 4470,-9997.92"/>
<text text-anchor="middle" x="4385.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 23 L7</text>
<text text-anchor="middle" x="4385.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 736&#45;767</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_23_s1_l7 -->
<g id="edge557" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_23_s1_l7</title>
<path fill="none" stroke="black" d="M3108.71,-10064.83C3341.33,-10064.74 3853.2,-10057.19 4290.96,-9998.02"/>
<polygon fill="black" stroke="black" points="4291.53,-10001.47 4300.97,-9996.65 4290.58,-9994.53 4291.53,-10001.47"/>
</g>
<!-- expert_24_s1_l7 -->
<g id="node342" class="node">
<title>expert_24_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="4657,-9997.92 4488,-9997.92 4488,-9953.92 4657,-9953.92 4657,-9997.92"/>
<text text-anchor="middle" x="4572.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 24 L7</text>
<text text-anchor="middle" x="4572.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 768&#45;799</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_24_s1_l7 -->
<g id="edge558" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_24_s1_l7</title>
<path fill="none" stroke="black" d="M3107.58,-10061.37C3413.87,-10054.41 4196.36,-10033.74 4477.77,-9998.01"/>
<polygon fill="black" stroke="black" points="4478.51,-10001.44 4487.97,-9996.68 4477.6,-9994.5 4478.51,-10001.44"/>
</g>
<!-- expert_25_s1_l7 -->
<g id="node343" class="node">
<title>expert_25_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="4844,-9997.92 4675,-9997.92 4675,-9953.92 4844,-9953.92 4844,-9997.92"/>
<text text-anchor="middle" x="4759.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 25 L7</text>
<text text-anchor="middle" x="4759.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 800&#45;831</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_25_s1_l7 -->
<g id="edge559" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_25_s1_l7</title>
<path fill="none" stroke="black" d="M3107.91,-10062.08C3441.37,-10056.42 4345.64,-10037.9 4664.78,-9998"/>
<polygon fill="black" stroke="black" points="4665.5,-10001.44 4674.97,-9996.69 4664.61,-9994.49 4665.5,-10001.44"/>
</g>
<!-- expert_26_s1_l7 -->
<g id="node344" class="node">
<title>expert_26_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="5031,-9997.92 4862,-9997.92 4862,-9953.92 5031,-9953.92 5031,-9997.92"/>
<text text-anchor="middle" x="4946.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 26 L7</text>
<text text-anchor="middle" x="4946.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 832&#45;863</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_26_s1_l7 -->
<g id="edge560" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_26_s1_l7</title>
<path fill="none" stroke="black" d="M3108.26,-10062.65C3467.53,-10058.22 4494.93,-10042.07 4851.87,-9997.99"/>
<polygon fill="black" stroke="black" points="4852.49,-10001.44 4861.97,-9996.71 4851.61,-9994.49 4852.49,-10001.44"/>
</g>
<!-- expert_27_s1_l7 -->
<g id="node345" class="node">
<title>expert_27_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="5218,-9997.92 5049,-9997.92 5049,-9953.92 5218,-9953.92 5218,-9997.92"/>
<text text-anchor="middle" x="5133.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 27 L7</text>
<text text-anchor="middle" x="5133.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 864&#45;895</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_27_s1_l7 -->
<g id="edge561" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_27_s1_l7</title>
<path fill="none" stroke="black" d="M3108.28,-10063.12C3491.82,-10059.85 4643.94,-10046.28 5038.93,-9997.98"/>
<polygon fill="black" stroke="black" points="5039.49,-10001.43 5048.97,-9996.72 5038.62,-9994.49 5039.49,-10001.43"/>
</g>
<!-- expert_28_s1_l7 -->
<g id="node346" class="node">
<title>expert_28_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="5405,-9997.92 5236,-9997.92 5236,-9953.92 5405,-9953.92 5405,-9997.92"/>
<text text-anchor="middle" x="5320.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 28 L7</text>
<text text-anchor="middle" x="5320.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 896&#45;927</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_28_s1_l7 -->
<g id="edge562" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_28_s1_l7</title>
<path fill="none" stroke="black" d="M3108.37,-10063.51C3515.16,-10061.34 4792.68,-10050.51 5225.9,-9997.98"/>
<polygon fill="black" stroke="black" points="5226.48,-10001.43 5235.98,-9996.73 5225.62,-9994.49 5226.48,-10001.43"/>
</g>
<!-- expert_29_s1_l7 -->
<g id="node347" class="node">
<title>expert_29_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="5592,-9997.92 5423,-9997.92 5423,-9953.92 5592,-9953.92 5592,-9997.92"/>
<text text-anchor="middle" x="5507.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 29 L7</text>
<text text-anchor="middle" x="5507.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 928&#45;959</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_29_s1_l7 -->
<g id="edge563" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_29_s1_l7</title>
<path fill="none" stroke="black" d="M3108.54,-10063.85C3537.8,-10062.72 4941.67,-10054.75 5413.04,-9997.96"/>
<polygon fill="black" stroke="black" points="5413.48,-10001.43 5422.98,-9996.74 5412.62,-9994.48 5413.48,-10001.43"/>
</g>
<!-- expert_30_s1_l7 -->
<g id="node348" class="node">
<title>expert_30_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="5779,-9997.92 5610,-9997.92 5610,-9953.92 5779,-9953.92 5779,-9997.92"/>
<text text-anchor="middle" x="5694.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 30 L7</text>
<text text-anchor="middle" x="5694.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 960&#45;991</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_30_s1_l7 -->
<g id="edge564" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_30_s1_l7</title>
<path fill="none" stroke="black" d="M3108.69,-10064.13C3559.49,-10063.99 5090.14,-10059.01 5599.96,-9997.97"/>
<polygon fill="black" stroke="black" points="5600.48,-10001.43 5609.98,-9996.74 5599.63,-9994.48 5600.48,-10001.43"/>
</g>
<!-- expert_31_s1_l7 -->
<g id="node349" class="node">
<title>expert_31_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="5966,-9997.92 5797,-9997.92 5797,-9953.92 5966,-9953.92 5966,-9997.92"/>
<text text-anchor="middle" x="5881.5" y="-9987.52" font-family="Arial" font-size="8.00">Expert 31 L7</text>
<text text-anchor="middle" x="5881.5" y="-9978.52" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-9969.52" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-9960.52" font-family="Arial" font-size="8.00">GPUs: 992&#45;1023</text>
</g>
<!-- expert_dispatch_s1_l7&#45;&gt;expert_31_s1_l7 -->
<g id="edge565" class="edge">
<title>expert_dispatch_s1_l7&#45;&gt;expert_31_s1_l7</title>
<path fill="none" stroke="black" d="M3108.62,-10064.38C3579.98,-10065.19 5238.67,-10063.29 5787,-9997.96"/>
<polygon fill="black" stroke="black" points="5787.47,-10001.43 5796.98,-9996.75 5786.63,-9994.48 5787.47,-10001.43"/>
</g>
<!-- expert_combine_s1_l7 -->
<g id="node350" class="node">
<title>expert_combine_s1_l7</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-9886.8" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-9898.4" font-family="Arial" font-size="8.00">Expert Combine L7 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-9889.4" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-9880.4" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9871.4" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_0_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge566" class="edge">
<title>expert_0_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M169.02,-9955.08C171.88,-9954.65 174.71,-9954.26 177.5,-9953.92 702.97,-9889.05 2358.67,-9886.68 2846.17,-9887.44"/>
<polygon fill="black" stroke="black" points="2846.42,-9890.94 2856.42,-9887.45 2846.43,-9883.94 2846.42,-9890.94"/>
</g>
<!-- expert_1_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge567" class="edge">
<title>expert_1_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M356.02,-9955.09C358.88,-9954.66 361.71,-9954.26 364.5,-9953.92 851.71,-9893.36 2380.13,-9887.92 2846.21,-9887.71"/>
<polygon fill="black" stroke="black" points="2846.36,-9891.21 2856.36,-9887.7 2846.36,-9884.21 2846.36,-9891.21"/>
</g>
<!-- expert_2_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge568" class="edge">
<title>expert_2_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M543.02,-9955.1C545.88,-9954.66 548.71,-9954.27 551.5,-9953.92 1000.54,-9897.66 2402.24,-9889.26 2846.2,-9888.02"/>
<polygon fill="black" stroke="black" points="2846.52,-9891.52 2856.51,-9887.99 2846.5,-9884.52 2846.52,-9891.52"/>
</g>
<!-- expert_3_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge569" class="edge">
<title>expert_3_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M730.02,-9955.11C732.88,-9954.67 735.71,-9954.27 738.5,-9953.92 1149.63,-9901.94 2426.08,-9890.7 2846.61,-9888.38"/>
<polygon fill="black" stroke="black" points="2846.7,-9891.88 2856.69,-9888.32 2846.67,-9884.88 2846.7,-9891.88"/>
</g>
<!-- expert_4_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge570" class="edge">
<title>expert_4_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M917.03,-9955.12C919.88,-9954.68 922.71,-9954.27 925.5,-9953.92 1298.74,-9906.22 2450.22,-9892.26 2846.7,-9888.8"/>
<polygon fill="black" stroke="black" points="2846.81,-9892.3 2856.78,-9888.72 2846.75,-9885.3 2846.81,-9892.3"/>
</g>
<!-- expert_5_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge571" class="edge">
<title>expert_5_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M1104.03,-9955.13C1106.88,-9954.68 1109.71,-9954.28 1112.5,-9953.92 1447.94,-9910.5 2474.98,-9893.97 2846.54,-9889.32"/>
<polygon fill="black" stroke="black" points="2846.85,-9892.81 2856.8,-9889.19 2846.76,-9885.81 2846.85,-9892.81"/>
</g>
<!-- expert_6_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge572" class="edge">
<title>expert_6_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M1291.03,-9955.14C1293.88,-9954.69 1296.71,-9954.28 1299.5,-9953.92 1597.53,-9914.75 2502.38,-9895.85 2847.13,-9889.93"/>
<polygon fill="black" stroke="black" points="2847.23,-9893.43 2857.17,-9889.76 2847.11,-9886.43 2847.23,-9893.43"/>
</g>
<!-- expert_7_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge573" class="edge">
<title>expert_7_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M1478.03,-9955.16C1480.88,-9954.71 1483.71,-9954.29 1486.5,-9953.92 1747.22,-9919 2530.56,-9897.98 2847.35,-9890.7"/>
<polygon fill="black" stroke="black" points="2847.58,-9894.19 2857.5,-9890.46 2847.42,-9887.19 2847.58,-9894.19"/>
</g>
<!-- expert_8_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge574" class="edge">
<title>expert_8_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M1665.03,-9955.18C1667.88,-9954.72 1670.71,-9954.3 1673.5,-9953.92 2098.54,-9895.63 2607.53,-9887.34 2846.26,-9887.02"/>
<polygon fill="black" stroke="black" points="2846.39,-9890.52 2856.38,-9887.01 2846.38,-9883.52 2846.39,-9890.52"/>
</g>
<!-- expert_9_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge575" class="edge">
<title>expert_9_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M1852.04,-9955.21C1854.89,-9954.75 1857.71,-9954.31 1860.5,-9953.92 2213.6,-9903.99 2634.37,-9891.65 2846.24,-9888.68"/>
<polygon fill="black" stroke="black" points="2846.52,-9892.18 2856.48,-9888.54 2846.43,-9885.18 2846.52,-9892.18"/>
</g>
<!-- expert_10_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge576" class="edge">
<title>expert_10_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M2039.05,-9955.26C2041.89,-9954.78 2044.72,-9954.33 2047.5,-9953.92 2330.13,-9912.26 2664.83,-9896.65 2847.27,-9890.95"/>
<polygon fill="black" stroke="black" points="2847.57,-9894.44 2857.46,-9890.63 2847.35,-9887.44 2847.57,-9894.44"/>
</g>
<!-- expert_11_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge577" class="edge">
<title>expert_11_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M2226.05,-9955.32C2228.9,-9954.82 2231.72,-9954.35 2234.5,-9953.92 2448.23,-9920.5 2699.16,-9902.62 2849.26,-9894.19"/>
<polygon fill="black" stroke="black" points="2849.66,-9897.67 2859.45,-9893.62 2849.27,-9890.68 2849.66,-9897.67"/>
</g>
<!-- expert_12_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge578" class="edge">
<title>expert_12_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M2413.07,-9955.43C2415.91,-9954.9 2418.73,-9954.39 2421.5,-9953.92 2569.28,-9928.6 2740.64,-9909.94 2854.7,-9899.02"/>
<polygon fill="black" stroke="black" points="2855.24,-9902.48 2864.87,-9898.05 2854.58,-9895.51 2855.24,-9902.48"/>
</g>
<!-- expert_13_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge579" class="edge">
<title>expert_13_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M2600.11,-9955.63C2602.94,-9955.05 2605.74,-9954.47 2608.5,-9953.92 2695.55,-9936.41 2794.51,-9919.02 2868.76,-9906.48"/>
<polygon fill="black" stroke="black" points="2869.79,-9909.86 2879.07,-9904.74 2868.63,-9902.95 2869.79,-9909.86"/>
</g>
<!-- expert_14_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge580" class="edge">
<title>expert_14_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M2770.28,-9953.83C2808.19,-9942.04 2855.83,-9927.22 2896.36,-9914.61"/>
<polygon fill="black" stroke="black" points="2897.45,-9917.93 2905.96,-9911.62 2895.37,-9911.25 2897.45,-9917.93"/>
</g>
<!-- expert_15_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge581" class="edge">
<title>expert_15_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M2912.01,-9953.83C2921.53,-9944.91 2932.9,-9934.26 2943.7,-9924.15"/>
<polygon fill="black" stroke="black" points="2946.15,-9926.65 2951.06,-9917.26 2941.37,-9921.54 2946.15,-9926.65"/>
</g>
<!-- expert_16_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge582" class="edge">
<title>expert_16_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M3053.75,-9953.83C3044.12,-9944.91 3032.63,-9934.26 3021.71,-9924.15"/>
<polygon fill="black" stroke="black" points="3023.99,-9921.49 3014.28,-9917.26 3019.23,-9926.62 3023.99,-9921.49"/>
</g>
<!-- expert_17_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge583" class="edge">
<title>expert_17_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M3195.48,-9953.83C3157.36,-9942.01 3109.44,-9927.16 3068.71,-9914.53"/>
<polygon fill="black" stroke="black" points="3069.65,-9911.16 3059.06,-9911.54 3067.58,-9917.84 3069.65,-9911.16"/>
</g>
<!-- expert_18_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge584" class="edge">
<title>expert_18_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M3365.89,-9955.63C3363.06,-9955.05 3360.26,-9954.47 3357.5,-9953.92 3269.89,-9936.31 3170.24,-9918.87 3095.69,-9906.32"/>
<polygon fill="black" stroke="black" points="3096.25,-9902.86 3085.81,-9904.66 3095.09,-9909.77 3096.25,-9902.86"/>
</g>
<!-- expert_19_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge585" class="edge">
<title>expert_19_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M3552.93,-9955.42C3550.09,-9954.9 3547.27,-9954.39 3544.5,-9953.92 3396.34,-9928.55 3224.52,-9909.89 3110.26,-9898.98"/>
<polygon fill="black" stroke="black" points="3110.36,-9895.47 3100.07,-9898.01 3109.69,-9902.44 3110.36,-9895.47"/>
</g>
<!-- expert_20_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge586" class="edge">
<title>expert_20_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M3739.95,-9955.32C3737.1,-9954.82 3734.28,-9954.35 3731.5,-9953.92 3517.33,-9920.44 3265.85,-9902.57 3115.58,-9894.16"/>
<polygon fill="black" stroke="black" points="3115.57,-9890.65 3105.39,-9893.59 3115.18,-9897.64 3115.57,-9890.65"/>
</g>
<!-- expert_21_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge587" class="edge">
<title>expert_21_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M3926.96,-9955.26C3924.11,-9954.78 3921.28,-9954.33 3918.5,-9953.92 3635.57,-9912.23 3300.51,-9896.62 3117.87,-9890.94"/>
<polygon fill="black" stroke="black" points="3117.78,-9887.43 3107.68,-9890.62 3117.57,-9894.43 3117.78,-9887.43"/>
</g>
<!-- expert_22_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge588" class="edge">
<title>expert_22_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M4113.96,-9955.21C4111.11,-9954.75 4108.29,-9954.31 4105.5,-9953.92 3751.85,-9903.92 3330.37,-9891.62 3118.46,-9888.67"/>
<polygon fill="black" stroke="black" points="3118.26,-9885.17 3108.22,-9888.53 3118.17,-9892.16 3118.26,-9885.17"/>
</g>
<!-- expert_23_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge589" class="edge">
<title>expert_23_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M4300.97,-9955.18C4298.12,-9954.72 4295.29,-9954.3 4292.5,-9953.92 3867.13,-9895.6 3357.75,-9887.32 3118.84,-9887.01"/>
<polygon fill="black" stroke="black" points="3118.72,-9883.51 3108.71,-9887 3118.71,-9890.51 3118.72,-9883.51"/>
</g>
<!-- expert_24_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge590" class="edge">
<title>expert_24_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M4487.97,-9955.16C4485.12,-9954.71 4482.29,-9954.29 4479.5,-9953.92 4218.6,-9918.98 3434.74,-9897.97 3117.74,-9890.69"/>
<polygon fill="black" stroke="black" points="3117.66,-9887.19 3107.58,-9890.46 3117.5,-9894.19 3117.66,-9887.19"/>
</g>
<!-- expert_25_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge591" class="edge">
<title>expert_25_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M4674.97,-9955.14C4672.12,-9954.69 4669.29,-9954.28 4666.5,-9953.92 4368.29,-9914.73 3462.9,-9895.84 3117.95,-9889.93"/>
<polygon fill="black" stroke="black" points="3117.97,-9886.43 3107.91,-9889.76 3117.85,-9893.43 3117.97,-9886.43"/>
</g>
<!-- expert_26_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge592" class="edge">
<title>expert_26_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M4861.97,-9955.13C4859.12,-9954.68 4856.29,-9954.28 4853.5,-9953.92 4517.88,-9910.48 3490.29,-9893.97 3118.53,-9889.31"/>
<polygon fill="black" stroke="black" points="3118.31,-9885.81 3108.26,-9889.19 3118.22,-9892.81 3118.31,-9885.81"/>
</g>
<!-- expert_27_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge593" class="edge">
<title>expert_27_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M5048.97,-9955.12C5046.12,-9954.68 5043.29,-9954.27 5040.5,-9953.92 4667.07,-9906.2 3515.04,-9892.25 3118.36,-9888.8"/>
<polygon fill="black" stroke="black" points="3118.31,-9885.3 3108.28,-9888.72 3118.25,-9892.3 3118.31,-9885.3"/>
</g>
<!-- expert_28_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge594" class="edge">
<title>expert_28_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M5235.98,-9955.11C5233.12,-9954.67 5230.29,-9954.27 5227.5,-9953.92 4816.19,-9901.92 3539.17,-9890.69 3118.45,-9888.38"/>
<polygon fill="black" stroke="black" points="3118.39,-9884.88 3108.37,-9888.32 3118.35,-9891.88 3118.39,-9884.88"/>
</g>
<!-- expert_29_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge595" class="edge">
<title>expert_29_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M5422.98,-9955.1C5420.12,-9954.66 5417.29,-9954.27 5414.5,-9953.92 4965.28,-9897.64 3563,-9889.25 3118.86,-9888.02"/>
<polygon fill="black" stroke="black" points="3118.55,-9884.52 3108.54,-9887.99 3118.53,-9891.52 3118.55,-9884.52"/>
</g>
<!-- expert_30_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge596" class="edge">
<title>expert_30_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M5609.98,-9955.09C5607.12,-9954.66 5604.29,-9954.26 5601.5,-9953.92 5114.1,-9893.34 3585.1,-9887.92 3118.84,-9887.7"/>
<polygon fill="black" stroke="black" points="3118.69,-9884.21 3108.69,-9887.7 3118.69,-9891.21 3118.69,-9884.21"/>
</g>
<!-- expert_31_s1_l7&#45;&gt;expert_combine_s1_l7 -->
<g id="edge597" class="edge">
<title>expert_31_s1_l7&#45;&gt;expert_combine_s1_l7</title>
<path fill="none" stroke="black" d="M5796.98,-9955.08C5794.12,-9954.65 5791.29,-9954.26 5788.5,-9953.92 5262.84,-9889.03 3606.55,-9886.67 3118.88,-9887.43"/>
<polygon fill="black" stroke="black" points="3118.62,-9883.93 3108.62,-9887.45 3118.63,-9890.93 3118.62,-9883.93"/>
</g>
<!-- moe_out_proj_s1_l7 -->
<g id="node351" class="node">
<title>moe_out_proj_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-9819.69 2893.5,-9819.69 2893.5,-9775.69 3071.5,-9775.69 3071.5,-9819.69"/>
<text text-anchor="middle" x="2982.5" y="-9809.29" font-family="Arial" font-size="8.00">MoE Output Proj L7 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-9800.29" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9791.29" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9782.29" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- expert_combine_s1_l7&#45;&gt;moe_out_proj_s1_l7 -->
<g id="edge598" class="edge">
<title>expert_combine_s1_l7&#45;&gt;moe_out_proj_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-9855.34C2982.5,-9847.06 2982.5,-9838.08 2982.5,-9829.77"/>
<polygon fill="black" stroke="black" points="2986,-9829.7 2982.5,-9819.7 2979,-9829.7 2986,-9829.7"/>
</g>
<!-- allreduce_moe_out_s1_l7 -->
<g id="node352" class="node">
<title>allreduce_moe_out_s1_l7</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-9708.58" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-9720.18" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L7</text>
<text text-anchor="middle" x="2982.5" y="-9711.18" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9702.18" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9693.18" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- moe_out_proj_s1_l7&#45;&gt;allreduce_moe_out_s1_l7 -->
<g id="edge599" class="edge">
<title>moe_out_proj_s1_l7&#45;&gt;allreduce_moe_out_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-9775.6C2982.5,-9767.93 2982.5,-9758.98 2982.5,-9750.19"/>
<polygon fill="black" stroke="black" points="2986,-9750.02 2982.5,-9740.02 2979,-9750.02 2986,-9750.02"/>
</g>
<!-- layernorm2_s1_l7 -->
<g id="node353" class="node">
<title>layernorm2_s1_l7</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-9641.47 2893.5,-9641.47 2893.5,-9597.47 3071.5,-9597.47 3071.5,-9641.47"/>
<text text-anchor="middle" x="2982.5" y="-9631.07" font-family="Arial" font-size="8.00">LayerNorm 2 (L7)</text>
<text text-anchor="middle" x="2982.5" y="-9622.07" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9613.07" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9604.07" font-family="Arial" font-size="8.00">GPUs: 0&#45;1023</text>
</g>
<!-- allreduce_moe_out_s1_l7&#45;&gt;layernorm2_s1_l7 -->
<g id="edge600" class="edge">
<title>allreduce_moe_out_s1_l7&#45;&gt;layernorm2_s1_l7</title>
<path fill="none" stroke="black" d="M2982.5,-9677.11C2982.5,-9668.83 2982.5,-9659.86 2982.5,-9651.54"/>
<polygon fill="black" stroke="black" points="2986,-9651.47 2982.5,-9641.47 2979,-9651.47 2986,-9651.47"/>
</g>
<!-- pp_transfer_s1_s2 -->
<g id="node354" class="node">
<title>pp_transfer_s1_s2</title>
<ellipse fill="red" stroke="black" cx="2982.5" cy="-9530.35" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-9541.95" font-family="Arial" font-size="8.00">Pipeline Transfer S1S2</text>
<text text-anchor="middle" x="2982.5" y="-9532.95" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9523.95" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9514.95" font-family="Arial" font-size="8.00">GPUs: 1023  1024</text>
</g>
<!-- layernorm2_s1_l7&#45;&gt;pp_transfer_s1_s2 -->
<g id="edge601" class="edge">
<title>layernorm2_s1_l7&#45;&gt;pp_transfer_s1_s2</title>
<path fill="none" stroke="black" d="M2982.5,-9597.38C2982.5,-9589.71 2982.5,-9580.75 2982.5,-9571.96"/>
<polygon fill="black" stroke="black" points="2986,-9571.8 2982.5,-9561.8 2979,-9571.8 2986,-9571.8"/>
</g>
<!-- layernorm1_s2_l8 -->
<g id="node355" class="node">
<title>layernorm1_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-9463.24 2893.5,-9463.24 2893.5,-9419.24 3071.5,-9419.24 3071.5,-9463.24"/>
<text text-anchor="middle" x="2982.5" y="-9452.84" font-family="Arial" font-size="8.00">LayerNorm 1 (L8)</text>
<text text-anchor="middle" x="2982.5" y="-9443.84" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9434.84" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9425.84" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- pp_transfer_s1_s2&#45;&gt;layernorm1_s2_l8 -->
<g id="edge602" class="edge">
<title>pp_transfer_s1_s2&#45;&gt;layernorm1_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-9498.89C2982.5,-9490.61 2982.5,-9481.63 2982.5,-9473.32"/>
<polygon fill="black" stroke="black" points="2986,-9473.25 2982.5,-9463.25 2979,-9473.25 2986,-9473.25"/>
</g>
<!-- qkv_proj_s2_l8 -->
<g id="node356" class="node">
<title>qkv_proj_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3081,-9383.24 2884,-9383.24 2884,-9339.24 3081,-9339.24 3081,-9383.24"/>
<text text-anchor="middle" x="2982.5" y="-9372.84" font-family="Arial" font-size="8.00">QKV Projection L8 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-9363.84" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9354.84" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-9345.84" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2_l8&#45;&gt;qkv_proj_s2_l8 -->
<g id="edge603" class="edge">
<title>layernorm1_s2_l8&#45;&gt;qkv_proj_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-9418.93C2982.5,-9411.04 2982.5,-9401.93 2982.5,-9393.34"/>
<polygon fill="black" stroke="black" points="2986,-9393.26 2982.5,-9383.26 2979,-9393.26 2986,-9393.26"/>
</g>
<!-- allreduce_qkv_s2_l8 -->
<g id="node357" class="node">
<title>allreduce_qkv_s2_l8</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-9272.13" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-9283.73" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L8</text>
<text text-anchor="middle" x="2982.5" y="-9274.73" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-9265.73" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-9256.73" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2_l8&#45;&gt;allreduce_qkv_s2_l8 -->
<g id="edge604" class="edge">
<title>qkv_proj_s2_l8&#45;&gt;allreduce_qkv_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-9339.15C2982.5,-9331.48 2982.5,-9322.53 2982.5,-9313.73"/>
<polygon fill="black" stroke="black" points="2986,-9313.57 2982.5,-9303.57 2979,-9313.57 2986,-9313.57"/>
</g>
<!-- attention_s2_l8 -->
<g id="node358" class="node">
<title>attention_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3081,-9205.02 2884,-9205.02 2884,-9161.02 3081,-9161.02 3081,-9205.02"/>
<text text-anchor="middle" x="2982.5" y="-9194.62" font-family="Arial" font-size="8.00">Self&#45;Attention L8</text>
<text text-anchor="middle" x="2982.5" y="-9185.62" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-9176.62" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-9167.62" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2_l8&#45;&gt;attention_s2_l8 -->
<g id="edge605" class="edge">
<title>allreduce_qkv_s2_l8&#45;&gt;attention_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-9240.66C2982.5,-9232.38 2982.5,-9223.41 2982.5,-9215.09"/>
<polygon fill="black" stroke="black" points="2986,-9215.02 2982.5,-9205.02 2979,-9215.02 2986,-9215.02"/>
</g>
<!-- attn_out_proj_s2_l8 -->
<g id="node359" class="node">
<title>attn_out_proj_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3078,-9125.02 2887,-9125.02 2887,-9081.02 3078,-9081.02 3078,-9125.02"/>
<text text-anchor="middle" x="2982.5" y="-9114.62" font-family="Arial" font-size="8.00">Attention Output Proj L8 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-9105.62" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-9096.62" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9087.62" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2_l8&#45;&gt;attn_out_proj_s2_l8 -->
<g id="edge606" class="edge">
<title>attention_s2_l8&#45;&gt;attn_out_proj_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-9160.7C2982.5,-9152.81 2982.5,-9143.7 2982.5,-9135.12"/>
<polygon fill="black" stroke="black" points="2986,-9135.03 2982.5,-9125.03 2979,-9135.03 2986,-9135.03"/>
</g>
<!-- allreduce_attn_out_s2_l8 -->
<g id="node360" class="node">
<title>allreduce_attn_out_s2_l8</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-9013.9" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-9025.5" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L8</text>
<text text-anchor="middle" x="2982.5" y="-9016.5" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-9007.5" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8998.5" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2_l8&#45;&gt;allreduce_attn_out_s2_l8 -->
<g id="edge607" class="edge">
<title>attn_out_proj_s2_l8&#45;&gt;allreduce_attn_out_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-9080.93C2982.5,-9073.26 2982.5,-9064.3 2982.5,-9055.51"/>
<polygon fill="black" stroke="black" points="2986,-9055.35 2982.5,-9045.35 2979,-9055.35 2986,-9055.35"/>
</g>
<!-- moe_gate_s2_l8 -->
<g id="node361" class="node">
<title>moe_gate_s2_l8</title>
<polygon fill="orange" stroke="black" points="3167.08,-8946.79 2873.45,-8946.79 2797.92,-8858.79 3091.55,-8858.79 3167.08,-8946.79"/>
<text text-anchor="middle" x="2982.5" y="-8914.39" font-family="Arial" font-size="8.00">MoE Gate L8 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-8905.39" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8896.39" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8887.39" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2_l8&#45;&gt;moe_gate_s2_l8 -->
<g id="edge608" class="edge">
<title>allreduce_attn_out_s2_l8&#45;&gt;moe_gate_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-8982.51C2982.5,-8974.62 2982.5,-8965.89 2982.5,-8957.2"/>
<polygon fill="black" stroke="black" points="2986,-8957.07 2982.5,-8947.07 2979,-8957.07 2986,-8957.07"/>
</g>
<!-- expert_dispatch_s2_l8 -->
<g id="node362" class="node">
<title>expert_dispatch_s2_l8</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-8791.68" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-8803.28" font-family="Arial" font-size="8.00">Expert Dispatch L8 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-8794.28" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8785.28" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8776.28" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2_l8&#45;&gt;expert_dispatch_s2_l8 -->
<g id="edge609" class="edge">
<title>moe_gate_s2_l8&#45;&gt;expert_dispatch_s2_l8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-8858.67C2982.5,-8850.29 2982.5,-8841.54 2982.5,-8833.25"/>
<polygon fill="black" stroke="black" points="2986,-8833.05 2982.5,-8823.05 2979,-8833.05 2986,-8833.05"/>
</g>
<!-- expert_32_s2_l8 -->
<g id="node363" class="node">
<title>expert_32_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="169,-8724.57 0,-8724.57 0,-8680.57 169,-8680.57 169,-8724.57"/>
<text text-anchor="middle" x="84.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 32 L8</text>
<text text-anchor="middle" x="84.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_32_s2_l8 -->
<g id="edge610" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_32_s2_l8</title>
<path fill="none" stroke="black" d="M2856.42,-8791.03C2385.23,-8791.83 727.13,-8789.92 178.99,-8724.61"/>
<polygon fill="black" stroke="black" points="179.37,-8721.13 169.02,-8723.4 178.53,-8728.08 179.37,-8721.13"/>
</g>
<!-- expert_33_s2_l8 -->
<g id="node364" class="node">
<title>expert_33_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="356,-8724.57 187,-8724.57 187,-8680.57 356,-8680.57 356,-8724.57"/>
<text text-anchor="middle" x="271.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 33 L8</text>
<text text-anchor="middle" x="271.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_33_s2_l8 -->
<g id="edge611" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_33_s2_l8</title>
<path fill="none" stroke="black" d="M2856.36,-8790.78C2405.73,-8790.64 875.66,-8785.64 366.03,-8724.61"/>
<polygon fill="black" stroke="black" points="366.37,-8721.13 356.02,-8723.39 365.52,-8728.08 366.37,-8721.13"/>
</g>
<!-- expert_34_s2_l8 -->
<g id="node365" class="node">
<title>expert_34_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="543,-8724.57 374,-8724.57 374,-8680.57 543,-8680.57 543,-8724.57"/>
<text text-anchor="middle" x="458.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 34 L8</text>
<text text-anchor="middle" x="458.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_34_s2_l8 -->
<g id="edge612" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_34_s2_l8</title>
<path fill="none" stroke="black" d="M2856.51,-8790.49C2427.43,-8789.36 1024.14,-8781.38 552.96,-8724.61"/>
<polygon fill="black" stroke="black" points="553.38,-8721.13 543.02,-8723.38 552.52,-8728.08 553.38,-8721.13"/>
</g>
<!-- expert_35_s2_l8 -->
<g id="node366" class="node">
<title>expert_35_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="730,-8724.57 561,-8724.57 561,-8680.57 730,-8680.57 730,-8724.57"/>
<text text-anchor="middle" x="645.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 35 L8</text>
<text text-anchor="middle" x="645.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_35_s2_l8 -->
<g id="edge613" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_35_s2_l8</title>
<path fill="none" stroke="black" d="M2856.69,-8790.16C2450.07,-8787.98 1173.13,-8777.14 740.1,-8724.62"/>
<polygon fill="black" stroke="black" points="740.38,-8721.13 730.02,-8723.38 739.52,-8728.08 740.38,-8721.13"/>
</g>
<!-- expert_36_s2_l8 -->
<g id="node367" class="node">
<title>expert_36_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="917,-8724.57 748,-8724.57 748,-8680.57 917,-8680.57 917,-8724.57"/>
<text text-anchor="middle" x="832.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 36 L8</text>
<text text-anchor="middle" x="832.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_36_s2_l8 -->
<g id="edge614" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_36_s2_l8</title>
<path fill="none" stroke="black" d="M2856.78,-8789.77C2473.43,-8786.49 1321.87,-8772.91 927.06,-8724.62"/>
<polygon fill="black" stroke="black" points="927.38,-8721.14 917.03,-8723.37 926.51,-8728.08 927.38,-8721.14"/>
</g>
<!-- expert_37_s2_l8 -->
<g id="node368" class="node">
<title>expert_37_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="1104,-8724.57 935,-8724.57 935,-8680.57 1104,-8680.57 1104,-8724.57"/>
<text text-anchor="middle" x="1019.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 37 L8</text>
<text text-anchor="middle" x="1019.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_37_s2_l8 -->
<g id="edge615" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_37_s2_l8</title>
<path fill="none" stroke="black" d="M2856.8,-8789.29C2497.73,-8784.86 1470.88,-8768.7 1114.13,-8724.63"/>
<polygon fill="black" stroke="black" points="1114.39,-8721.14 1104.03,-8723.36 1113.51,-8728.08 1114.39,-8721.14"/>
</g>
<!-- expert_38_s2_l8 -->
<g id="node369" class="node">
<title>expert_38_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="1291,-8724.57 1122,-8724.57 1122,-8680.57 1291,-8680.57 1291,-8724.57"/>
<text text-anchor="middle" x="1206.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 38 L8</text>
<text text-anchor="middle" x="1206.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_38_s2_l8 -->
<g id="edge616" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_38_s2_l8</title>
<path fill="none" stroke="black" d="M2857.17,-8788.72C2523.91,-8783.06 1620.17,-8764.52 1301.21,-8724.65"/>
<polygon fill="black" stroke="black" points="1301.39,-8721.14 1291.03,-8723.34 1300.5,-8728.09 1301.39,-8721.14"/>
</g>
<!-- expert_39_s2_l8 -->
<g id="node370" class="node">
<title>expert_39_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="1478,-8724.57 1309,-8724.57 1309,-8680.57 1478,-8680.57 1478,-8724.57"/>
<text text-anchor="middle" x="1393.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 39 L8</text>
<text text-anchor="middle" x="1393.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_39_s2_l8 -->
<g id="edge617" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_39_s2_l8</title>
<path fill="none" stroke="black" d="M2857.5,-8788.02C2551.41,-8781.05 1769.45,-8760.37 1488.23,-8724.65"/>
<polygon fill="black" stroke="black" points="1488.4,-8721.15 1478.03,-8723.32 1487.49,-8728.09 1488.4,-8721.15"/>
</g>
<!-- expert_40_s2_l8 -->
<g id="node371" class="node">
<title>expert_40_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="1665,-8724.57 1496,-8724.57 1496,-8680.57 1665,-8680.57 1665,-8724.57"/>
<text text-anchor="middle" x="1580.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 40 L8</text>
<text text-anchor="middle" x="1580.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_40_s2_l8 -->
<g id="edge618" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_40_s2_l8</title>
<path fill="none" stroke="black" d="M2856.38,-8791.48C2623.94,-8791.37 2112.47,-8783.8 1675.03,-8724.66"/>
<polygon fill="black" stroke="black" points="1675.42,-8721.18 1665.03,-8723.3 1674.47,-8728.12 1675.42,-8721.18"/>
</g>
<!-- expert_41_s2_l8 -->
<g id="node372" class="node">
<title>expert_41_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="1852,-8724.57 1683,-8724.57 1683,-8680.57 1852,-8680.57 1852,-8724.57"/>
<text text-anchor="middle" x="1767.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 41 L8</text>
<text text-anchor="middle" x="1767.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_41_s2_l8 -->
<g id="edge619" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_41_s2_l8</title>
<path fill="none" stroke="black" d="M2856.48,-8789.94C2650.05,-8787.25 2227.11,-8775.53 1862.01,-8724.67"/>
<polygon fill="black" stroke="black" points="1862.43,-8721.19 1852.04,-8723.27 1861.45,-8728.13 1862.43,-8721.19"/>
</g>
<!-- expert_42_s2_l8 -->
<g id="node373" class="node">
<title>expert_42_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="2039,-8724.57 1870,-8724.57 1870,-8680.57 2039,-8680.57 2039,-8724.57"/>
<text text-anchor="middle" x="1954.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 42 L8</text>
<text text-anchor="middle" x="1954.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_42_s2_l8 -->
<g id="edge620" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_42_s2_l8</title>
<path fill="none" stroke="black" d="M2857.46,-8787.85C2679.53,-8782.48 2343.14,-8767.35 2049.05,-8724.69"/>
<polygon fill="black" stroke="black" points="2049.45,-8721.21 2039.05,-8723.23 2048.43,-8728.14 2049.45,-8721.21"/>
</g>
<!-- expert_43_s2_l8 -->
<g id="node374" class="node">
<title>expert_43_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="2226,-8724.57 2057,-8724.57 2057,-8680.57 2226,-8680.57 2226,-8724.57"/>
<text text-anchor="middle" x="2141.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 43 L8</text>
<text text-anchor="middle" x="2141.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_43_s2_l8 -->
<g id="edge621" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_43_s2_l8</title>
<path fill="none" stroke="black" d="M2859.45,-8784.86C2712.89,-8776.79 2460.66,-8759.28 2236.05,-8724.72"/>
<polygon fill="black" stroke="black" points="2236.47,-8721.24 2226.05,-8723.16 2235.4,-8728.16 2236.47,-8721.24"/>
</g>
<!-- expert_44_s2_l8 -->
<g id="node375" class="node">
<title>expert_44_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="2413,-8724.57 2244,-8724.57 2244,-8680.57 2413,-8680.57 2413,-8724.57"/>
<text text-anchor="middle" x="2328.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 44 L8</text>
<text text-anchor="middle" x="2328.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_44_s2_l8 -->
<g id="edge622" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_44_s2_l8</title>
<path fill="none" stroke="black" d="M2864.87,-8780.43C2753.34,-8769.88 2580.99,-8751.43 2422.98,-8724.74"/>
<polygon fill="black" stroke="black" points="2423.52,-8721.29 2413.07,-8723.06 2422.34,-8728.19 2423.52,-8721.29"/>
</g>
<!-- expert_45_s2_l8 -->
<g id="node376" class="node">
<title>expert_45_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="2600,-8724.57 2431,-8724.57 2431,-8680.57 2600,-8680.57 2600,-8724.57"/>
<text text-anchor="middle" x="2515.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 45 L8</text>
<text text-anchor="middle" x="2515.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_45_s2_l8 -->
<g id="edge623" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_45_s2_l8</title>
<path fill="none" stroke="black" d="M2879.07,-8773.74C2806.34,-8761.51 2706.53,-8744.1 2610.04,-8724.84"/>
<polygon fill="black" stroke="black" points="2610.6,-8721.38 2600.11,-8722.85 2609.23,-8728.25 2610.6,-8721.38"/>
</g>
<!-- expert_46_s2_l8 -->
<g id="node377" class="node">
<title>expert_46_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="2787,-8724.57 2618,-8724.57 2618,-8680.57 2787,-8680.57 2787,-8724.57"/>
<text text-anchor="middle" x="2702.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 46 L8</text>
<text text-anchor="middle" x="2702.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_46_s2_l8 -->
<g id="edge624" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_46_s2_l8</title>
<path fill="none" stroke="black" d="M2905.99,-8766.87C2866.88,-8754.71 2819.39,-8739.93 2780.12,-8727.71"/>
<polygon fill="black" stroke="black" points="2780.91,-8724.3 2770.32,-8724.67 2778.83,-8730.98 2780.91,-8724.3"/>
</g>
<!-- expert_47_s2_l8 -->
<g id="node378" class="node">
<title>expert_47_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="2974,-8724.57 2805,-8724.57 2805,-8680.57 2974,-8680.57 2974,-8724.57"/>
<text text-anchor="middle" x="2889.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 47 L8</text>
<text text-anchor="middle" x="2889.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_47_s2_l8 -->
<g id="edge625" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_47_s2_l8</title>
<path fill="none" stroke="black" d="M2951.27,-8761.43C2941.01,-8751.82 2929.64,-8741.16 2919.47,-8731.64"/>
<polygon fill="black" stroke="black" points="2921.66,-8728.9 2911.97,-8724.62 2916.88,-8734.01 2921.66,-8728.9"/>
</g>
<!-- expert_48_s2_l8 -->
<g id="node379" class="node">
<title>expert_48_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3161,-8724.57 2992,-8724.57 2992,-8680.57 3161,-8680.57 3161,-8724.57"/>
<text text-anchor="middle" x="3076.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 48 L8</text>
<text text-anchor="middle" x="3076.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_48_s2_l8 -->
<g id="edge626" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_48_s2_l8</title>
<path fill="none" stroke="black" d="M3014.06,-8761.43C3024.43,-8751.82 3035.93,-8741.16 3046.21,-8731.64"/>
<polygon fill="black" stroke="black" points="3048.83,-8733.98 3053.78,-8724.62 3044.07,-8728.85 3048.83,-8733.98"/>
</g>
<!-- expert_49_s2_l8 -->
<g id="node380" class="node">
<title>expert_49_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3348,-8724.57 3179,-8724.57 3179,-8680.57 3348,-8680.57 3348,-8724.57"/>
<text text-anchor="middle" x="3263.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 49 L8</text>
<text text-anchor="middle" x="3263.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_49_s2_l8 -->
<g id="edge627" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_49_s2_l8</title>
<path fill="none" stroke="black" d="M3059.28,-8766.87C3098.53,-8754.71 3146.2,-8739.93 3185.6,-8727.71"/>
<polygon fill="black" stroke="black" points="3186.92,-8730.97 3195.43,-8724.67 3184.84,-8724.28 3186.92,-8730.97"/>
</g>
<!-- expert_50_s2_l8 -->
<g id="node381" class="node">
<title>expert_50_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3535,-8724.57 3366,-8724.57 3366,-8680.57 3535,-8680.57 3535,-8724.57"/>
<text text-anchor="middle" x="3450.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 50 L8</text>
<text text-anchor="middle" x="3450.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_50_s2_l8 -->
<g id="edge628" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_50_s2_l8</title>
<path fill="none" stroke="black" d="M3085.81,-8773.82C3158.76,-8761.6 3259.03,-8744.16 3355.92,-8724.85"/>
<polygon fill="black" stroke="black" points="3356.77,-8728.25 3365.89,-8722.85 3355.4,-8721.38 3356.77,-8728.25"/>
</g>
<!-- expert_51_s2_l8 -->
<g id="node382" class="node">
<title>expert_51_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3722,-8724.57 3553,-8724.57 3553,-8680.57 3722,-8680.57 3722,-8724.57"/>
<text text-anchor="middle" x="3637.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 51 L8</text>
<text text-anchor="middle" x="3637.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_51_s2_l8 -->
<g id="edge629" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_51_s2_l8</title>
<path fill="none" stroke="black" d="M3100.07,-8780.47C3211.79,-8769.94 3384.6,-8751.48 3543,-8724.75"/>
<polygon fill="black" stroke="black" points="3543.66,-8728.19 3552.93,-8723.06 3542.48,-8721.29 3543.66,-8728.19"/>
</g>
<!-- expert_52_s2_l8 -->
<g id="node383" class="node">
<title>expert_52_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3909,-8724.57 3740,-8724.57 3740,-8680.57 3909,-8680.57 3909,-8724.57"/>
<text text-anchor="middle" x="3824.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 52 L8</text>
<text text-anchor="middle" x="3824.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_52_s2_l8 -->
<g id="edge630" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_52_s2_l8</title>
<path fill="none" stroke="black" d="M3105.39,-8784.89C3252.09,-8776.84 3504.87,-8759.34 3729.93,-8724.72"/>
<polygon fill="black" stroke="black" points="3730.6,-8728.16 3739.95,-8723.16 3729.53,-8721.24 3730.6,-8728.16"/>
</g>
<!-- expert_53_s2_l8 -->
<g id="node384" class="node">
<title>expert_53_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="4096,-8724.57 3927,-8724.57 3927,-8680.57 4096,-8680.57 4096,-8724.57"/>
<text text-anchor="middle" x="4011.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 53 L8</text>
<text text-anchor="middle" x="4011.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_53_s2_l8 -->
<g id="edge631" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_53_s2_l8</title>
<path fill="none" stroke="black" d="M3107.68,-8787.86C3285.8,-8782.5 3622.55,-8767.39 3916.94,-8724.69"/>
<polygon fill="black" stroke="black" points="3917.57,-8728.14 3926.96,-8723.23 3916.55,-8721.21 3917.57,-8728.14"/>
</g>
<!-- expert_54_s2_l8 -->
<g id="node385" class="node">
<title>expert_54_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="4283,-8724.57 4114,-8724.57 4114,-8680.57 4283,-8680.57 4283,-8724.57"/>
<text text-anchor="middle" x="4198.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 54 L8</text>
<text text-anchor="middle" x="4198.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_54_s2_l8 -->
<g id="edge632" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_54_s2_l8</title>
<path fill="none" stroke="black" d="M3108.22,-8789.95C3314.67,-8787.28 3738.31,-8775.59 4103.98,-8724.67"/>
<polygon fill="black" stroke="black" points="4104.55,-8728.13 4113.96,-8723.27 4103.57,-8721.19 4104.55,-8728.13"/>
</g>
<!-- expert_55_s2_l8 -->
<g id="node386" class="node">
<title>expert_55_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="4470,-8724.57 4301,-8724.57 4301,-8680.57 4470,-8680.57 4470,-8724.57"/>
<text text-anchor="middle" x="4385.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 55 L8</text>
<text text-anchor="middle" x="4385.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_55_s2_l8 -->
<g id="edge633" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_55_s2_l8</title>
<path fill="none" stroke="black" d="M3108.71,-8791.48C3341.33,-8791.39 3853.2,-8783.84 4290.96,-8724.66"/>
<polygon fill="black" stroke="black" points="4291.53,-8728.12 4300.97,-8723.3 4290.58,-8721.18 4291.53,-8728.12"/>
</g>
<!-- expert_56_s2_l8 -->
<g id="node387" class="node">
<title>expert_56_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="4657,-8724.57 4488,-8724.57 4488,-8680.57 4657,-8680.57 4657,-8724.57"/>
<text text-anchor="middle" x="4572.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 56 L8</text>
<text text-anchor="middle" x="4572.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_56_s2_l8 -->
<g id="edge634" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_56_s2_l8</title>
<path fill="none" stroke="black" d="M3107.58,-8788.02C3413.87,-8781.06 4196.36,-8760.39 4477.77,-8724.65"/>
<polygon fill="black" stroke="black" points="4478.51,-8728.09 4487.97,-8723.32 4477.6,-8721.15 4478.51,-8728.09"/>
</g>
<!-- expert_57_s2_l8 -->
<g id="node388" class="node">
<title>expert_57_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="4844,-8724.57 4675,-8724.57 4675,-8680.57 4844,-8680.57 4844,-8724.57"/>
<text text-anchor="middle" x="4759.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 57 L8</text>
<text text-anchor="middle" x="4759.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_57_s2_l8 -->
<g id="edge635" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_57_s2_l8</title>
<path fill="none" stroke="black" d="M3107.91,-8788.73C3441.37,-8783.07 4345.64,-8764.54 4664.78,-8724.65"/>
<polygon fill="black" stroke="black" points="4665.5,-8728.09 4674.97,-8723.34 4664.61,-8721.14 4665.5,-8728.09"/>
</g>
<!-- expert_58_s2_l8 -->
<g id="node389" class="node">
<title>expert_58_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="5031,-8724.57 4862,-8724.57 4862,-8680.57 5031,-8680.57 5031,-8724.57"/>
<text text-anchor="middle" x="4946.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 58 L8</text>
<text text-anchor="middle" x="4946.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_58_s2_l8 -->
<g id="edge636" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_58_s2_l8</title>
<path fill="none" stroke="black" d="M3108.26,-8789.3C3467.53,-8784.87 4494.93,-8768.72 4851.87,-8724.63"/>
<polygon fill="black" stroke="black" points="4852.49,-8728.08 4861.97,-8723.36 4851.61,-8721.14 4852.49,-8728.08"/>
</g>
<!-- expert_59_s2_l8 -->
<g id="node390" class="node">
<title>expert_59_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="5218,-8724.57 5049,-8724.57 5049,-8680.57 5218,-8680.57 5218,-8724.57"/>
<text text-anchor="middle" x="5133.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 59 L8</text>
<text text-anchor="middle" x="5133.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_59_s2_l8 -->
<g id="edge637" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_59_s2_l8</title>
<path fill="none" stroke="black" d="M3108.28,-8789.77C3491.82,-8786.5 4643.94,-8772.93 5038.93,-8724.62"/>
<polygon fill="black" stroke="black" points="5039.49,-8728.08 5048.97,-8723.37 5038.62,-8721.14 5039.49,-8728.08"/>
</g>
<!-- expert_60_s2_l8 -->
<g id="node391" class="node">
<title>expert_60_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="5405,-8724.57 5236,-8724.57 5236,-8680.57 5405,-8680.57 5405,-8724.57"/>
<text text-anchor="middle" x="5320.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 60 L8</text>
<text text-anchor="middle" x="5320.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_60_s2_l8 -->
<g id="edge638" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_60_s2_l8</title>
<path fill="none" stroke="black" d="M3108.37,-8790.16C3515.16,-8787.99 4792.68,-8777.16 5225.9,-8724.63"/>
<polygon fill="black" stroke="black" points="5226.48,-8728.08 5235.98,-8723.38 5225.62,-8721.13 5226.48,-8728.08"/>
</g>
<!-- expert_61_s2_l8 -->
<g id="node392" class="node">
<title>expert_61_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="5592,-8724.57 5423,-8724.57 5423,-8680.57 5592,-8680.57 5592,-8724.57"/>
<text text-anchor="middle" x="5507.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 61 L8</text>
<text text-anchor="middle" x="5507.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_61_s2_l8 -->
<g id="edge639" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_61_s2_l8</title>
<path fill="none" stroke="black" d="M3108.54,-8790.49C3537.8,-8789.36 4941.67,-8781.4 5413.04,-8724.61"/>
<polygon fill="black" stroke="black" points="5413.48,-8728.08 5422.98,-8723.38 5412.62,-8721.13 5413.48,-8728.08"/>
</g>
<!-- expert_62_s2_l8 -->
<g id="node393" class="node">
<title>expert_62_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="5779,-8724.57 5610,-8724.57 5610,-8680.57 5779,-8680.57 5779,-8724.57"/>
<text text-anchor="middle" x="5694.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 62 L8</text>
<text text-anchor="middle" x="5694.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_62_s2_l8 -->
<g id="edge640" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_62_s2_l8</title>
<path fill="none" stroke="black" d="M3108.69,-8790.78C3559.49,-8790.64 5090.14,-8785.66 5599.96,-8724.61"/>
<polygon fill="black" stroke="black" points="5600.48,-8728.08 5609.98,-8723.39 5599.63,-8721.13 5600.48,-8728.08"/>
</g>
<!-- expert_63_s2_l8 -->
<g id="node394" class="node">
<title>expert_63_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="5966,-8724.57 5797,-8724.57 5797,-8680.57 5966,-8680.57 5966,-8724.57"/>
<text text-anchor="middle" x="5881.5" y="-8714.17" font-family="Arial" font-size="8.00">Expert 63 L8</text>
<text text-anchor="middle" x="5881.5" y="-8705.17" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-8696.17" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-8687.17" font-family="Arial" font-size="8.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2_l8&#45;&gt;expert_63_s2_l8 -->
<g id="edge641" class="edge">
<title>expert_dispatch_s2_l8&#45;&gt;expert_63_s2_l8</title>
<path fill="none" stroke="black" d="M3108.62,-8791.03C3579.98,-8791.84 5238.67,-8789.94 5787,-8724.61"/>
<polygon fill="black" stroke="black" points="5787.47,-8728.08 5796.98,-8723.4 5786.63,-8721.13 5787.47,-8728.08"/>
</g>
<!-- expert_combine_s2_l8 -->
<g id="node395" class="node">
<title>expert_combine_s2_l8</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-8613.45" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-8625.05" font-family="Arial" font-size="8.00">Expert Combine L8 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-8616.05" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-8607.05" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8598.05" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge642" class="edge">
<title>expert_32_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M169.02,-8681.73C171.88,-8681.3 174.71,-8680.91 177.5,-8680.57 702.97,-8615.7 2358.67,-8613.32 2846.17,-8614.08"/>
<polygon fill="black" stroke="black" points="2846.42,-8617.58 2856.42,-8614.1 2846.43,-8610.58 2846.42,-8617.58"/>
</g>
<!-- expert_33_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge643" class="edge">
<title>expert_33_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M356.02,-8681.74C358.88,-8681.31 361.71,-8680.91 364.5,-8680.57 851.71,-8620.01 2380.13,-8614.57 2846.21,-8614.35"/>
<polygon fill="black" stroke="black" points="2846.36,-8617.85 2856.36,-8614.35 2846.36,-8610.85 2846.36,-8617.85"/>
</g>
<!-- expert_34_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge644" class="edge">
<title>expert_34_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M543.02,-8681.75C545.88,-8681.31 548.71,-8680.91 551.5,-8680.57 1000.54,-8624.31 2402.24,-8615.91 2846.2,-8614.67"/>
<polygon fill="black" stroke="black" points="2846.52,-8618.16 2856.51,-8614.64 2846.5,-8611.16 2846.52,-8618.16"/>
</g>
<!-- expert_35_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge645" class="edge">
<title>expert_35_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M730.02,-8681.75C732.88,-8681.32 735.71,-8680.92 738.5,-8680.57 1149.63,-8628.58 2426.08,-8617.34 2846.61,-8615.03"/>
<polygon fill="black" stroke="black" points="2846.7,-8618.53 2856.69,-8614.97 2846.67,-8611.53 2846.7,-8618.53"/>
</g>
<!-- expert_36_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge646" class="edge">
<title>expert_36_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M917.03,-8681.76C919.88,-8681.32 922.71,-8680.92 925.5,-8680.57 1298.74,-8632.87 2450.22,-8618.9 2846.7,-8615.45"/>
<polygon fill="black" stroke="black" points="2846.81,-8618.95 2856.78,-8615.36 2846.75,-8611.95 2846.81,-8618.95"/>
</g>
<!-- expert_37_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge647" class="edge">
<title>expert_37_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M1104.03,-8681.78C1106.88,-8681.33 1109.71,-8680.93 1112.5,-8680.57 1447.94,-8637.15 2474.98,-8620.62 2846.54,-8615.96"/>
<polygon fill="black" stroke="black" points="2846.85,-8619.46 2856.8,-8615.84 2846.76,-8612.46 2846.85,-8619.46"/>
</g>
<!-- expert_38_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge648" class="edge">
<title>expert_38_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M1291.03,-8681.79C1293.88,-8681.34 1296.71,-8680.93 1299.5,-8680.57 1597.53,-8641.4 2502.38,-8622.5 2847.13,-8616.58"/>
<polygon fill="black" stroke="black" points="2847.23,-8620.08 2857.17,-8616.41 2847.11,-8613.08 2847.23,-8620.08"/>
</g>
<!-- expert_39_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge649" class="edge">
<title>expert_39_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M1478.03,-8681.81C1480.88,-8681.36 1483.71,-8680.94 1486.5,-8680.57 1747.22,-8645.65 2530.56,-8624.62 2847.35,-8617.34"/>
<polygon fill="black" stroke="black" points="2847.58,-8620.84 2857.5,-8617.11 2847.42,-8613.84 2847.58,-8620.84"/>
</g>
<!-- expert_40_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge650" class="edge">
<title>expert_40_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M1665.03,-8681.83C1667.88,-8681.37 1670.71,-8680.95 1673.5,-8680.57 2098.54,-8622.28 2607.53,-8613.99 2846.26,-8613.66"/>
<polygon fill="black" stroke="black" points="2846.39,-8617.16 2856.38,-8613.65 2846.38,-8610.16 2846.39,-8617.16"/>
</g>
<!-- expert_41_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge651" class="edge">
<title>expert_41_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M1852.04,-8681.86C1854.89,-8681.39 1857.71,-8680.96 1860.5,-8680.57 2213.6,-8630.64 2634.37,-8618.3 2846.24,-8615.33"/>
<polygon fill="black" stroke="black" points="2846.52,-8618.83 2856.48,-8615.19 2846.43,-8611.83 2846.52,-8618.83"/>
</g>
<!-- expert_42_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge652" class="edge">
<title>expert_42_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M2039.05,-8681.9C2041.89,-8681.42 2044.72,-8680.98 2047.5,-8680.57 2330.13,-8638.91 2664.83,-8623.29 2847.27,-8617.59"/>
<polygon fill="black" stroke="black" points="2847.57,-8621.09 2857.46,-8617.28 2847.35,-8614.09 2847.57,-8621.09"/>
</g>
<!-- expert_43_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge653" class="edge">
<title>expert_43_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M2226.05,-8681.97C2228.9,-8681.47 2231.72,-8681 2234.5,-8680.57 2448.23,-8647.14 2699.16,-8629.27 2849.26,-8620.83"/>
<polygon fill="black" stroke="black" points="2849.66,-8624.32 2859.45,-8620.27 2849.27,-8617.33 2849.66,-8624.32"/>
</g>
<!-- expert_44_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge654" class="edge">
<title>expert_44_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M2413.07,-8682.07C2415.91,-8681.54 2418.73,-8681.04 2421.5,-8680.57 2569.28,-8655.24 2740.64,-8636.59 2854.7,-8625.67"/>
<polygon fill="black" stroke="black" points="2855.24,-8629.13 2864.87,-8624.7 2854.58,-8622.16 2855.24,-8629.13"/>
</g>
<!-- expert_45_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge655" class="edge">
<title>expert_45_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M2600.11,-8682.28C2602.94,-8681.69 2605.74,-8681.12 2608.5,-8680.57 2695.55,-8663.05 2794.51,-8645.67 2868.76,-8633.13"/>
<polygon fill="black" stroke="black" points="2869.79,-8636.5 2879.07,-8631.39 2868.63,-8629.6 2869.79,-8636.5"/>
</g>
<!-- expert_46_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge656" class="edge">
<title>expert_46_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M2770.28,-8680.48C2808.19,-8668.68 2855.83,-8653.86 2896.36,-8641.25"/>
<polygon fill="black" stroke="black" points="2897.45,-8644.58 2905.96,-8638.27 2895.37,-8637.89 2897.45,-8644.58"/>
</g>
<!-- expert_47_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge657" class="edge">
<title>expert_47_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M2912.01,-8680.48C2921.53,-8671.56 2932.9,-8660.91 2943.7,-8650.79"/>
<polygon fill="black" stroke="black" points="2946.15,-8653.29 2951.06,-8643.9 2941.37,-8648.18 2946.15,-8653.29"/>
</g>
<!-- expert_48_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge658" class="edge">
<title>expert_48_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M3053.75,-8680.48C3044.12,-8671.56 3032.63,-8660.91 3021.71,-8650.79"/>
<polygon fill="black" stroke="black" points="3023.99,-8648.13 3014.28,-8643.9 3019.23,-8653.27 3023.99,-8648.13"/>
</g>
<!-- expert_49_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge659" class="edge">
<title>expert_49_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M3195.48,-8680.48C3157.36,-8668.66 3109.44,-8653.8 3068.71,-8641.18"/>
<polygon fill="black" stroke="black" points="3069.65,-8637.81 3059.06,-8638.19 3067.58,-8644.49 3069.65,-8637.81"/>
</g>
<!-- expert_50_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge660" class="edge">
<title>expert_50_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M3365.89,-8682.28C3363.06,-8681.69 3360.26,-8681.12 3357.5,-8680.57 3269.89,-8662.96 3170.24,-8645.51 3095.69,-8632.97"/>
<polygon fill="black" stroke="black" points="3096.25,-8629.51 3085.81,-8631.31 3095.09,-8636.41 3096.25,-8629.51"/>
</g>
<!-- expert_51_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge661" class="edge">
<title>expert_51_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M3552.93,-8682.07C3550.09,-8681.54 3547.27,-8681.04 3544.5,-8680.57 3396.34,-8655.19 3224.52,-8636.53 3110.26,-8625.63"/>
<polygon fill="black" stroke="black" points="3110.36,-8622.12 3100.07,-8624.66 3109.69,-8629.09 3110.36,-8622.12"/>
</g>
<!-- expert_52_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge662" class="edge">
<title>expert_52_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M3739.95,-8681.97C3737.1,-8681.47 3734.28,-8681 3731.5,-8680.57 3517.33,-8647.09 3265.85,-8629.22 3115.58,-8620.8"/>
<polygon fill="black" stroke="black" points="3115.57,-8617.3 3105.39,-8620.24 3115.18,-8624.29 3115.57,-8617.3"/>
</g>
<!-- expert_53_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge663" class="edge">
<title>expert_53_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M3926.96,-8681.9C3924.11,-8681.42 3921.28,-8680.98 3918.5,-8680.57 3635.57,-8638.87 3300.51,-8623.27 3117.87,-8617.58"/>
<polygon fill="black" stroke="black" points="3117.78,-8614.08 3107.68,-8617.27 3117.57,-8621.08 3117.78,-8614.08"/>
</g>
<!-- expert_54_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge664" class="edge">
<title>expert_54_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M4113.96,-8681.86C4111.11,-8681.39 4108.29,-8680.96 4105.5,-8680.57 3751.85,-8630.57 3330.37,-8618.26 3118.46,-8615.32"/>
<polygon fill="black" stroke="black" points="3118.26,-8611.81 3108.22,-8615.18 3118.17,-8618.81 3118.26,-8611.81"/>
</g>
<!-- expert_55_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge665" class="edge">
<title>expert_55_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M4300.97,-8681.83C4298.12,-8681.37 4295.29,-8680.95 4292.5,-8680.57 3867.13,-8622.25 3357.75,-8613.97 3118.84,-8613.66"/>
<polygon fill="black" stroke="black" points="3118.72,-8610.16 3108.71,-8613.65 3118.71,-8617.16 3118.72,-8610.16"/>
</g>
<!-- expert_56_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge666" class="edge">
<title>expert_56_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M4487.97,-8681.81C4485.12,-8681.35 4482.29,-8680.94 4479.5,-8680.57 4218.6,-8645.63 3434.74,-8624.61 3117.74,-8617.34"/>
<polygon fill="black" stroke="black" points="3117.66,-8613.84 3107.58,-8617.11 3117.5,-8620.84 3117.66,-8613.84"/>
</g>
<!-- expert_57_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge667" class="edge">
<title>expert_57_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M4674.97,-8681.79C4672.12,-8681.34 4669.29,-8680.93 4666.5,-8680.57 4368.29,-8641.38 3462.9,-8622.49 3117.95,-8616.57"/>
<polygon fill="black" stroke="black" points="3117.97,-8613.07 3107.91,-8616.4 3117.85,-8620.07 3117.97,-8613.07"/>
</g>
<!-- expert_58_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge668" class="edge">
<title>expert_58_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M4861.97,-8681.77C4859.12,-8681.33 4856.29,-8680.93 4853.5,-8680.57 4517.88,-8637.13 3490.29,-8620.61 3118.53,-8615.96"/>
<polygon fill="black" stroke="black" points="3118.31,-8612.46 3108.26,-8615.83 3118.22,-8619.46 3118.31,-8612.46"/>
</g>
<!-- expert_59_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge669" class="edge">
<title>expert_59_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M5048.97,-8681.76C5046.12,-8681.32 5043.29,-8680.92 5040.5,-8680.57 4667.07,-8632.85 3515.04,-8618.9 3118.36,-8615.45"/>
<polygon fill="black" stroke="black" points="3118.31,-8611.95 3108.28,-8615.36 3118.25,-8618.95 3118.31,-8611.95"/>
</g>
<!-- expert_60_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge670" class="edge">
<title>expert_60_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M5235.98,-8681.75C5233.12,-8681.32 5230.29,-8680.92 5227.5,-8680.57 4816.19,-8628.56 3539.17,-8617.34 3118.45,-8615.02"/>
<polygon fill="black" stroke="black" points="3118.39,-8611.52 3108.37,-8614.97 3118.35,-8618.52 3118.39,-8611.52"/>
</g>
<!-- expert_61_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge671" class="edge">
<title>expert_61_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M5422.98,-8681.75C5420.12,-8681.31 5417.29,-8680.91 5414.5,-8680.57 4965.28,-8624.29 3563,-8615.9 3118.86,-8614.66"/>
<polygon fill="black" stroke="black" points="3118.55,-8611.16 3108.54,-8614.64 3118.53,-8618.16 3118.55,-8611.16"/>
</g>
<!-- expert_62_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge672" class="edge">
<title>expert_62_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M5609.98,-8681.74C5607.12,-8681.31 5604.29,-8680.91 5601.5,-8680.57 5114.1,-8619.98 3585.1,-8614.57 3118.84,-8614.35"/>
<polygon fill="black" stroke="black" points="3118.69,-8610.85 3108.69,-8614.35 3118.69,-8617.85 3118.69,-8610.85"/>
</g>
<!-- expert_63_s2_l8&#45;&gt;expert_combine_s2_l8 -->
<g id="edge673" class="edge">
<title>expert_63_s2_l8&#45;&gt;expert_combine_s2_l8</title>
<path fill="none" stroke="black" d="M5796.98,-8681.73C5794.12,-8681.3 5791.29,-8680.91 5788.5,-8680.57 5262.84,-8615.68 3606.55,-8613.32 3118.88,-8614.08"/>
<polygon fill="black" stroke="black" points="3118.62,-8610.58 3108.62,-8614.1 3118.63,-8617.58 3118.62,-8610.58"/>
</g>
<!-- moe_out_proj_s2_l8 -->
<g id="node396" class="node">
<title>moe_out_proj_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-8546.34 2893.5,-8546.34 2893.5,-8502.34 3071.5,-8502.34 3071.5,-8546.34"/>
<text text-anchor="middle" x="2982.5" y="-8535.94" font-family="Arial" font-size="8.00">MoE Output Proj L8 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-8526.94" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8517.94" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8508.94" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2_l8&#45;&gt;moe_out_proj_s2_l8 -->
<g id="edge674" class="edge">
<title>expert_combine_s2_l8&#45;&gt;moe_out_proj_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-8581.98C2982.5,-8573.71 2982.5,-8564.73 2982.5,-8556.42"/>
<polygon fill="black" stroke="black" points="2986,-8556.34 2982.5,-8546.34 2979,-8556.34 2986,-8556.34"/>
</g>
<!-- allreduce_moe_out_s2_l8 -->
<g id="node397" class="node">
<title>allreduce_moe_out_s2_l8</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-8435.23" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-8446.83" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L8</text>
<text text-anchor="middle" x="2982.5" y="-8437.83" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8428.83" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8419.83" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2_l8&#45;&gt;allreduce_moe_out_s2_l8 -->
<g id="edge675" class="edge">
<title>moe_out_proj_s2_l8&#45;&gt;allreduce_moe_out_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-8502.25C2982.5,-8494.58 2982.5,-8485.63 2982.5,-8476.83"/>
<polygon fill="black" stroke="black" points="2986,-8476.67 2982.5,-8466.67 2979,-8476.67 2986,-8476.67"/>
</g>
<!-- layernorm2_s2_l8 -->
<g id="node398" class="node">
<title>layernorm2_s2_l8</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-8368.11 2893.5,-8368.11 2893.5,-8324.11 3071.5,-8324.11 3071.5,-8368.11"/>
<text text-anchor="middle" x="2982.5" y="-8357.71" font-family="Arial" font-size="8.00">LayerNorm 2 (L8)</text>
<text text-anchor="middle" x="2982.5" y="-8348.71" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8339.71" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8330.71" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2_l8&#45;&gt;layernorm2_s2_l8 -->
<g id="edge676" class="edge">
<title>allreduce_moe_out_s2_l8&#45;&gt;layernorm2_s2_l8</title>
<path fill="none" stroke="black" d="M2982.5,-8403.76C2982.5,-8395.48 2982.5,-8386.5 2982.5,-8378.19"/>
<polygon fill="black" stroke="black" points="2986,-8378.12 2982.5,-8368.12 2979,-8378.12 2986,-8378.12"/>
</g>
<!-- layernorm1_s2_l9 -->
<g id="node399" class="node">
<title>layernorm1_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-8288.11 2893.5,-8288.11 2893.5,-8244.11 3071.5,-8244.11 3071.5,-8288.11"/>
<text text-anchor="middle" x="2982.5" y="-8277.71" font-family="Arial" font-size="8.00">LayerNorm 1 (L9)</text>
<text text-anchor="middle" x="2982.5" y="-8268.71" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8259.71" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8250.71" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm2_s2_l8&#45;&gt;layernorm1_s2_l9 -->
<g id="edge677" class="edge">
<title>layernorm2_s2_l8&#45;&gt;layernorm1_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-8323.8C2982.5,-8315.91 2982.5,-8306.8 2982.5,-8298.22"/>
<polygon fill="black" stroke="black" points="2986,-8298.13 2982.5,-8288.13 2979,-8298.13 2986,-8298.13"/>
</g>
<!-- qkv_proj_s2_l9 -->
<g id="node400" class="node">
<title>qkv_proj_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3081,-8208.11 2884,-8208.11 2884,-8164.11 3081,-8164.11 3081,-8208.11"/>
<text text-anchor="middle" x="2982.5" y="-8197.71" font-family="Arial" font-size="8.00">QKV Projection L9 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-8188.71" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-8179.71" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-8170.71" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2_l9&#45;&gt;qkv_proj_s2_l9 -->
<g id="edge678" class="edge">
<title>layernorm1_s2_l9&#45;&gt;qkv_proj_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-8243.8C2982.5,-8235.91 2982.5,-8226.8 2982.5,-8218.22"/>
<polygon fill="black" stroke="black" points="2986,-8218.13 2982.5,-8208.13 2979,-8218.13 2986,-8218.13"/>
</g>
<!-- allreduce_qkv_s2_l9 -->
<g id="node401" class="node">
<title>allreduce_qkv_s2_l9</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-8097" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-8108.6" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L9</text>
<text text-anchor="middle" x="2982.5" y="-8099.6" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-8090.6" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-8081.6" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2_l9&#45;&gt;allreduce_qkv_s2_l9 -->
<g id="edge679" class="edge">
<title>qkv_proj_s2_l9&#45;&gt;allreduce_qkv_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-8164.03C2982.5,-8156.35 2982.5,-8147.4 2982.5,-8138.61"/>
<polygon fill="black" stroke="black" points="2986,-8138.45 2982.5,-8128.45 2979,-8138.45 2986,-8138.45"/>
</g>
<!-- attention_s2_l9 -->
<g id="node402" class="node">
<title>attention_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3081,-8029.89 2884,-8029.89 2884,-7985.89 3081,-7985.89 3081,-8029.89"/>
<text text-anchor="middle" x="2982.5" y="-8019.49" font-family="Arial" font-size="8.00">Self&#45;Attention L9</text>
<text text-anchor="middle" x="2982.5" y="-8010.49" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-8001.49" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-7992.49" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2_l9&#45;&gt;attention_s2_l9 -->
<g id="edge680" class="edge">
<title>allreduce_qkv_s2_l9&#45;&gt;attention_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-8065.53C2982.5,-8057.25 2982.5,-8048.28 2982.5,-8039.97"/>
<polygon fill="black" stroke="black" points="2986,-8039.89 2982.5,-8029.89 2979,-8039.89 2986,-8039.89"/>
</g>
<!-- attn_out_proj_s2_l9 -->
<g id="node403" class="node">
<title>attn_out_proj_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3078,-7949.89 2887,-7949.89 2887,-7905.89 3078,-7905.89 3078,-7949.89"/>
<text text-anchor="middle" x="2982.5" y="-7939.49" font-family="Arial" font-size="8.00">Attention Output Proj L9 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-7930.49" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-7921.49" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7912.49" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2_l9&#45;&gt;attn_out_proj_s2_l9 -->
<g id="edge681" class="edge">
<title>attention_s2_l9&#45;&gt;attn_out_proj_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-7985.58C2982.5,-7977.69 2982.5,-7968.57 2982.5,-7959.99"/>
<polygon fill="black" stroke="black" points="2986,-7959.91 2982.5,-7949.91 2979,-7959.91 2986,-7959.91"/>
</g>
<!-- allreduce_attn_out_s2_l9 -->
<g id="node404" class="node">
<title>allreduce_attn_out_s2_l9</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-7838.78" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-7850.38" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L9</text>
<text text-anchor="middle" x="2982.5" y="-7841.38" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7832.38" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7823.38" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2_l9&#45;&gt;allreduce_attn_out_s2_l9 -->
<g id="edge682" class="edge">
<title>attn_out_proj_s2_l9&#45;&gt;allreduce_attn_out_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-7905.8C2982.5,-7898.13 2982.5,-7889.17 2982.5,-7880.38"/>
<polygon fill="black" stroke="black" points="2986,-7880.22 2982.5,-7870.22 2979,-7880.22 2986,-7880.22"/>
</g>
<!-- moe_gate_s2_l9 -->
<g id="node405" class="node">
<title>moe_gate_s2_l9</title>
<polygon fill="orange" stroke="black" points="3167.08,-7771.66 2873.45,-7771.66 2797.92,-7683.66 3091.55,-7683.66 3167.08,-7771.66"/>
<text text-anchor="middle" x="2982.5" y="-7739.26" font-family="Arial" font-size="8.00">MoE Gate L9 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-7730.26" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7721.26" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7712.26" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2_l9&#45;&gt;moe_gate_s2_l9 -->
<g id="edge683" class="edge">
<title>allreduce_attn_out_s2_l9&#45;&gt;moe_gate_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-7807.38C2982.5,-7799.5 2982.5,-7790.77 2982.5,-7782.07"/>
<polygon fill="black" stroke="black" points="2986,-7781.94 2982.5,-7771.94 2979,-7781.94 2986,-7781.94"/>
</g>
<!-- expert_dispatch_s2_l9 -->
<g id="node406" class="node">
<title>expert_dispatch_s2_l9</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-7616.55" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-7628.15" font-family="Arial" font-size="8.00">Expert Dispatch L9 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-7619.15" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7610.15" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7601.15" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2_l9&#45;&gt;expert_dispatch_s2_l9 -->
<g id="edge684" class="edge">
<title>moe_gate_s2_l9&#45;&gt;expert_dispatch_s2_l9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-7683.54C2982.5,-7675.16 2982.5,-7666.41 2982.5,-7658.12"/>
<polygon fill="black" stroke="black" points="2986,-7657.93 2982.5,-7647.93 2979,-7657.93 2986,-7657.93"/>
</g>
<!-- expert_32_s2_l9 -->
<g id="node407" class="node">
<title>expert_32_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="169,-7549.44 0,-7549.44 0,-7505.44 169,-7505.44 169,-7549.44"/>
<text text-anchor="middle" x="84.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 32 L9</text>
<text text-anchor="middle" x="84.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_32_s2_l9 -->
<g id="edge685" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_32_s2_l9</title>
<path fill="none" stroke="black" d="M2856.42,-7615.9C2385.23,-7616.7 727.13,-7614.79 178.99,-7549.48"/>
<polygon fill="black" stroke="black" points="179.37,-7546 169.02,-7548.27 178.53,-7552.95 179.37,-7546"/>
</g>
<!-- expert_33_s2_l9 -->
<g id="node408" class="node">
<title>expert_33_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="356,-7549.44 187,-7549.44 187,-7505.44 356,-7505.44 356,-7549.44"/>
<text text-anchor="middle" x="271.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 33 L9</text>
<text text-anchor="middle" x="271.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_33_s2_l9 -->
<g id="edge686" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_33_s2_l9</title>
<path fill="none" stroke="black" d="M2856.36,-7615.65C2405.73,-7615.51 875.66,-7610.51 366.03,-7549.49"/>
<polygon fill="black" stroke="black" points="366.37,-7546 356.02,-7548.26 365.52,-7552.95 366.37,-7546"/>
</g>
<!-- expert_34_s2_l9 -->
<g id="node409" class="node">
<title>expert_34_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="543,-7549.44 374,-7549.44 374,-7505.44 543,-7505.44 543,-7549.44"/>
<text text-anchor="middle" x="458.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 34 L9</text>
<text text-anchor="middle" x="458.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_34_s2_l9 -->
<g id="edge687" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_34_s2_l9</title>
<path fill="none" stroke="black" d="M2856.51,-7615.37C2427.43,-7614.23 1024.14,-7606.25 552.96,-7549.48"/>
<polygon fill="black" stroke="black" points="553.38,-7546 543.02,-7548.26 552.52,-7552.95 553.38,-7546"/>
</g>
<!-- expert_35_s2_l9 -->
<g id="node410" class="node">
<title>expert_35_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="730,-7549.44 561,-7549.44 561,-7505.44 730,-7505.44 730,-7549.44"/>
<text text-anchor="middle" x="645.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 35 L9</text>
<text text-anchor="middle" x="645.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_35_s2_l9 -->
<g id="edge688" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_35_s2_l9</title>
<path fill="none" stroke="black" d="M2856.69,-7615.03C2450.07,-7612.86 1173.13,-7602.01 740.1,-7549.5"/>
<polygon fill="black" stroke="black" points="740.38,-7546.01 730.02,-7548.25 739.52,-7552.95 740.38,-7546.01"/>
</g>
<!-- expert_36_s2_l9 -->
<g id="node411" class="node">
<title>expert_36_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="917,-7549.44 748,-7549.44 748,-7505.44 917,-7505.44 917,-7549.44"/>
<text text-anchor="middle" x="832.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 36 L9</text>
<text text-anchor="middle" x="832.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_36_s2_l9 -->
<g id="edge689" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_36_s2_l9</title>
<path fill="none" stroke="black" d="M2856.78,-7614.64C2473.43,-7611.37 1321.87,-7597.78 927.06,-7549.5"/>
<polygon fill="black" stroke="black" points="927.38,-7546.01 917.03,-7548.24 926.51,-7552.95 927.38,-7546.01"/>
</g>
<!-- expert_37_s2_l9 -->
<g id="node412" class="node">
<title>expert_37_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="1104,-7549.44 935,-7549.44 935,-7505.44 1104,-7505.44 1104,-7549.44"/>
<text text-anchor="middle" x="1019.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 37 L9</text>
<text text-anchor="middle" x="1019.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_37_s2_l9 -->
<g id="edge690" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_37_s2_l9</title>
<path fill="none" stroke="black" d="M2856.8,-7614.17C2497.73,-7609.73 1470.88,-7593.57 1114.13,-7549.51"/>
<polygon fill="black" stroke="black" points="1114.39,-7546.01 1104.03,-7548.23 1113.51,-7552.96 1114.39,-7546.01"/>
</g>
<!-- expert_38_s2_l9 -->
<g id="node413" class="node">
<title>expert_38_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="1291,-7549.44 1122,-7549.44 1122,-7505.44 1291,-7505.44 1291,-7549.44"/>
<text text-anchor="middle" x="1206.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 38 L9</text>
<text text-anchor="middle" x="1206.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_38_s2_l9 -->
<g id="edge691" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_38_s2_l9</title>
<path fill="none" stroke="black" d="M2857.17,-7613.6C2523.91,-7607.94 1620.17,-7589.4 1301.21,-7549.52"/>
<polygon fill="black" stroke="black" points="1301.39,-7546.02 1291.03,-7548.21 1300.5,-7552.96 1301.39,-7546.02"/>
</g>
<!-- expert_39_s2_l9 -->
<g id="node414" class="node">
<title>expert_39_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="1478,-7549.44 1309,-7549.44 1309,-7505.44 1478,-7505.44 1478,-7549.44"/>
<text text-anchor="middle" x="1393.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 39 L9</text>
<text text-anchor="middle" x="1393.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_39_s2_l9 -->
<g id="edge692" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_39_s2_l9</title>
<path fill="none" stroke="black" d="M2857.5,-7612.89C2551.41,-7605.92 1769.45,-7585.25 1488.23,-7549.53"/>
<polygon fill="black" stroke="black" points="1488.4,-7546.02 1478.03,-7548.2 1487.49,-7552.96 1488.4,-7546.02"/>
</g>
<!-- expert_40_s2_l9 -->
<g id="node415" class="node">
<title>expert_40_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="1665,-7549.44 1496,-7549.44 1496,-7505.44 1665,-7505.44 1665,-7549.44"/>
<text text-anchor="middle" x="1580.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 40 L9</text>
<text text-anchor="middle" x="1580.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_40_s2_l9 -->
<g id="edge693" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_40_s2_l9</title>
<path fill="none" stroke="black" d="M2856.38,-7616.35C2623.94,-7616.24 2112.47,-7608.67 1675.03,-7549.54"/>
<polygon fill="black" stroke="black" points="1675.42,-7546.06 1665.03,-7548.17 1674.47,-7552.99 1675.42,-7546.06"/>
</g>
<!-- expert_41_s2_l9 -->
<g id="node416" class="node">
<title>expert_41_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="1852,-7549.44 1683,-7549.44 1683,-7505.44 1852,-7505.44 1852,-7549.44"/>
<text text-anchor="middle" x="1767.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 41 L9</text>
<text text-anchor="middle" x="1767.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_41_s2_l9 -->
<g id="edge694" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_41_s2_l9</title>
<path fill="none" stroke="black" d="M2856.48,-7614.81C2650.05,-7612.12 2227.11,-7600.4 1862.01,-7549.54"/>
<polygon fill="black" stroke="black" points="1862.43,-7546.07 1852.04,-7548.14 1861.45,-7553 1862.43,-7546.07"/>
</g>
<!-- expert_42_s2_l9 -->
<g id="node417" class="node">
<title>expert_42_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="2039,-7549.44 1870,-7549.44 1870,-7505.44 2039,-7505.44 2039,-7549.44"/>
<text text-anchor="middle" x="1954.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 42 L9</text>
<text text-anchor="middle" x="1954.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_42_s2_l9 -->
<g id="edge695" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_42_s2_l9</title>
<path fill="none" stroke="black" d="M2857.46,-7612.72C2679.53,-7607.35 2343.14,-7592.23 2049.05,-7549.56"/>
<polygon fill="black" stroke="black" points="2049.45,-7546.09 2039.05,-7548.1 2048.43,-7553.01 2049.45,-7546.09"/>
</g>
<!-- expert_43_s2_l9 -->
<g id="node418" class="node">
<title>expert_43_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="2226,-7549.44 2057,-7549.44 2057,-7505.44 2226,-7505.44 2226,-7549.44"/>
<text text-anchor="middle" x="2141.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 43 L9</text>
<text text-anchor="middle" x="2141.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_43_s2_l9 -->
<g id="edge696" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_43_s2_l9</title>
<path fill="none" stroke="black" d="M2859.45,-7609.74C2712.89,-7601.67 2460.66,-7584.15 2236.05,-7549.59"/>
<polygon fill="black" stroke="black" points="2236.47,-7546.11 2226.05,-7548.04 2235.4,-7553.03 2236.47,-7546.11"/>
</g>
<!-- expert_44_s2_l9 -->
<g id="node419" class="node">
<title>expert_44_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="2413,-7549.44 2244,-7549.44 2244,-7505.44 2413,-7505.44 2413,-7549.44"/>
<text text-anchor="middle" x="2328.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 44 L9</text>
<text text-anchor="middle" x="2328.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_44_s2_l9 -->
<g id="edge697" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_44_s2_l9</title>
<path fill="none" stroke="black" d="M2864.87,-7605.31C2753.34,-7594.76 2580.99,-7576.3 2422.98,-7549.62"/>
<polygon fill="black" stroke="black" points="2423.52,-7546.16 2413.07,-7547.93 2422.34,-7553.06 2423.52,-7546.16"/>
</g>
<!-- expert_45_s2_l9 -->
<g id="node420" class="node">
<title>expert_45_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="2600,-7549.44 2431,-7549.44 2431,-7505.44 2600,-7505.44 2600,-7549.44"/>
<text text-anchor="middle" x="2515.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 45 L9</text>
<text text-anchor="middle" x="2515.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_45_s2_l9 -->
<g id="edge698" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_45_s2_l9</title>
<path fill="none" stroke="black" d="M2879.07,-7598.61C2806.34,-7586.39 2706.53,-7568.98 2610.04,-7549.71"/>
<polygon fill="black" stroke="black" points="2610.6,-7546.26 2600.11,-7547.72 2609.23,-7553.12 2610.6,-7546.26"/>
</g>
<!-- expert_46_s2_l9 -->
<g id="node421" class="node">
<title>expert_46_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="2787,-7549.44 2618,-7549.44 2618,-7505.44 2787,-7505.44 2787,-7549.44"/>
<text text-anchor="middle" x="2702.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 46 L9</text>
<text text-anchor="middle" x="2702.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_46_s2_l9 -->
<g id="edge699" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_46_s2_l9</title>
<path fill="none" stroke="black" d="M2905.99,-7591.75C2866.88,-7579.58 2819.39,-7564.8 2780.12,-7552.59"/>
<polygon fill="black" stroke="black" points="2780.91,-7549.17 2770.32,-7549.54 2778.83,-7555.85 2780.91,-7549.17"/>
</g>
<!-- expert_47_s2_l9 -->
<g id="node422" class="node">
<title>expert_47_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="2974,-7549.44 2805,-7549.44 2805,-7505.44 2974,-7505.44 2974,-7549.44"/>
<text text-anchor="middle" x="2889.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 47 L9</text>
<text text-anchor="middle" x="2889.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_47_s2_l9 -->
<g id="edge700" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_47_s2_l9</title>
<path fill="none" stroke="black" d="M2951.27,-7586.3C2941.01,-7576.69 2929.64,-7566.03 2919.47,-7556.51"/>
<polygon fill="black" stroke="black" points="2921.66,-7553.77 2911.97,-7549.49 2916.88,-7558.88 2921.66,-7553.77"/>
</g>
<!-- expert_48_s2_l9 -->
<g id="node423" class="node">
<title>expert_48_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3161,-7549.44 2992,-7549.44 2992,-7505.44 3161,-7505.44 3161,-7549.44"/>
<text text-anchor="middle" x="3076.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 48 L9</text>
<text text-anchor="middle" x="3076.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_48_s2_l9 -->
<g id="edge701" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_48_s2_l9</title>
<path fill="none" stroke="black" d="M3014.06,-7586.3C3024.43,-7576.69 3035.93,-7566.03 3046.21,-7556.51"/>
<polygon fill="black" stroke="black" points="3048.83,-7558.85 3053.78,-7549.49 3044.07,-7553.72 3048.83,-7558.85"/>
</g>
<!-- expert_49_s2_l9 -->
<g id="node424" class="node">
<title>expert_49_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3348,-7549.44 3179,-7549.44 3179,-7505.44 3348,-7505.44 3348,-7549.44"/>
<text text-anchor="middle" x="3263.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 49 L9</text>
<text text-anchor="middle" x="3263.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_49_s2_l9 -->
<g id="edge702" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_49_s2_l9</title>
<path fill="none" stroke="black" d="M3059.28,-7591.75C3098.53,-7579.58 3146.2,-7564.8 3185.6,-7552.59"/>
<polygon fill="black" stroke="black" points="3186.92,-7555.84 3195.43,-7549.54 3184.84,-7549.16 3186.92,-7555.84"/>
</g>
<!-- expert_50_s2_l9 -->
<g id="node425" class="node">
<title>expert_50_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3535,-7549.44 3366,-7549.44 3366,-7505.44 3535,-7505.44 3535,-7549.44"/>
<text text-anchor="middle" x="3450.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 50 L9</text>
<text text-anchor="middle" x="3450.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_50_s2_l9 -->
<g id="edge703" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_50_s2_l9</title>
<path fill="none" stroke="black" d="M3085.81,-7598.7C3158.76,-7586.48 3259.03,-7569.04 3355.92,-7549.72"/>
<polygon fill="black" stroke="black" points="3356.77,-7553.12 3365.89,-7547.72 3355.4,-7546.26 3356.77,-7553.12"/>
</g>
<!-- expert_51_s2_l9 -->
<g id="node426" class="node">
<title>expert_51_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3722,-7549.44 3553,-7549.44 3553,-7505.44 3722,-7505.44 3722,-7549.44"/>
<text text-anchor="middle" x="3637.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 51 L9</text>
<text text-anchor="middle" x="3637.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_51_s2_l9 -->
<g id="edge704" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_51_s2_l9</title>
<path fill="none" stroke="black" d="M3100.07,-7605.34C3211.79,-7594.81 3384.6,-7576.35 3543,-7549.62"/>
<polygon fill="black" stroke="black" points="3543.66,-7553.06 3552.93,-7547.93 3542.48,-7546.16 3543.66,-7553.06"/>
</g>
<!-- expert_52_s2_l9 -->
<g id="node427" class="node">
<title>expert_52_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3909,-7549.44 3740,-7549.44 3740,-7505.44 3909,-7505.44 3909,-7549.44"/>
<text text-anchor="middle" x="3824.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 52 L9</text>
<text text-anchor="middle" x="3824.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_52_s2_l9 -->
<g id="edge705" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_52_s2_l9</title>
<path fill="none" stroke="black" d="M3105.39,-7609.77C3252.09,-7601.71 3504.87,-7584.21 3729.93,-7549.59"/>
<polygon fill="black" stroke="black" points="3730.6,-7553.03 3739.95,-7548.04 3729.53,-7546.11 3730.6,-7553.03"/>
</g>
<!-- expert_53_s2_l9 -->
<g id="node428" class="node">
<title>expert_53_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="4096,-7549.44 3927,-7549.44 3927,-7505.44 4096,-7505.44 4096,-7549.44"/>
<text text-anchor="middle" x="4011.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 53 L9</text>
<text text-anchor="middle" x="4011.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_53_s2_l9 -->
<g id="edge706" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_53_s2_l9</title>
<path fill="none" stroke="black" d="M3107.68,-7612.73C3285.8,-7607.37 3622.55,-7592.26 3916.94,-7549.57"/>
<polygon fill="black" stroke="black" points="3917.57,-7553.01 3926.96,-7548.1 3916.55,-7546.08 3917.57,-7553.01"/>
</g>
<!-- expert_54_s2_l9 -->
<g id="node429" class="node">
<title>expert_54_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="4283,-7549.44 4114,-7549.44 4114,-7505.44 4283,-7505.44 4283,-7549.44"/>
<text text-anchor="middle" x="4198.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 54 L9</text>
<text text-anchor="middle" x="4198.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_54_s2_l9 -->
<g id="edge707" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_54_s2_l9</title>
<path fill="none" stroke="black" d="M3108.22,-7614.83C3314.67,-7612.16 3738.31,-7600.47 4103.98,-7549.54"/>
<polygon fill="black" stroke="black" points="4104.55,-7553 4113.96,-7548.14 4103.57,-7546.07 4104.55,-7553"/>
</g>
<!-- expert_55_s2_l9 -->
<g id="node430" class="node">
<title>expert_55_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="4470,-7549.44 4301,-7549.44 4301,-7505.44 4470,-7505.44 4470,-7549.44"/>
<text text-anchor="middle" x="4385.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 55 L9</text>
<text text-anchor="middle" x="4385.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_55_s2_l9 -->
<g id="edge708" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_55_s2_l9</title>
<path fill="none" stroke="black" d="M3108.71,-7616.36C3341.33,-7616.26 3853.2,-7608.71 4290.96,-7549.54"/>
<polygon fill="black" stroke="black" points="4291.53,-7552.99 4300.97,-7548.17 4290.58,-7546.06 4291.53,-7552.99"/>
</g>
<!-- expert_56_s2_l9 -->
<g id="node431" class="node">
<title>expert_56_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="4657,-7549.44 4488,-7549.44 4488,-7505.44 4657,-7505.44 4657,-7549.44"/>
<text text-anchor="middle" x="4572.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 56 L9</text>
<text text-anchor="middle" x="4572.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_56_s2_l9 -->
<g id="edge709" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_56_s2_l9</title>
<path fill="none" stroke="black" d="M3107.58,-7612.89C3413.87,-7605.93 4196.36,-7585.26 4477.77,-7549.53"/>
<polygon fill="black" stroke="black" points="4478.51,-7552.96 4487.97,-7548.2 4477.6,-7546.02 4478.51,-7552.96"/>
</g>
<!-- expert_57_s2_l9 -->
<g id="node432" class="node">
<title>expert_57_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="4844,-7549.44 4675,-7549.44 4675,-7505.44 4844,-7505.44 4844,-7549.44"/>
<text text-anchor="middle" x="4759.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 57 L9</text>
<text text-anchor="middle" x="4759.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_57_s2_l9 -->
<g id="edge710" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_57_s2_l9</title>
<path fill="none" stroke="black" d="M3107.91,-7613.6C3441.37,-7607.94 4345.64,-7589.42 4664.78,-7549.52"/>
<polygon fill="black" stroke="black" points="4665.5,-7552.96 4674.97,-7548.21 4664.61,-7546.02 4665.5,-7552.96"/>
</g>
<!-- expert_58_s2_l9 -->
<g id="node433" class="node">
<title>expert_58_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="5031,-7549.44 4862,-7549.44 4862,-7505.44 5031,-7505.44 5031,-7549.44"/>
<text text-anchor="middle" x="4946.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 58 L9</text>
<text text-anchor="middle" x="4946.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_58_s2_l9 -->
<g id="edge711" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_58_s2_l9</title>
<path fill="none" stroke="black" d="M3108.26,-7614.17C3467.53,-7609.74 4494.93,-7593.59 4851.87,-7549.51"/>
<polygon fill="black" stroke="black" points="4852.49,-7552.96 4861.97,-7548.23 4851.61,-7546.01 4852.49,-7552.96"/>
</g>
<!-- expert_59_s2_l9 -->
<g id="node434" class="node">
<title>expert_59_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="5218,-7549.44 5049,-7549.44 5049,-7505.44 5218,-7505.44 5218,-7549.44"/>
<text text-anchor="middle" x="5133.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 59 L9</text>
<text text-anchor="middle" x="5133.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_59_s2_l9 -->
<g id="edge712" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_59_s2_l9</title>
<path fill="none" stroke="black" d="M3108.28,-7614.64C3491.82,-7611.37 4643.94,-7597.8 5038.93,-7549.5"/>
<polygon fill="black" stroke="black" points="5039.49,-7552.95 5048.97,-7548.24 5038.62,-7546.01 5039.49,-7552.95"/>
</g>
<!-- expert_60_s2_l9 -->
<g id="node435" class="node">
<title>expert_60_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="5405,-7549.44 5236,-7549.44 5236,-7505.44 5405,-7505.44 5405,-7549.44"/>
<text text-anchor="middle" x="5320.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 60 L9</text>
<text text-anchor="middle" x="5320.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_60_s2_l9 -->
<g id="edge713" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_60_s2_l9</title>
<path fill="none" stroke="black" d="M3108.37,-7615.03C3515.16,-7612.86 4792.68,-7602.03 5225.9,-7549.5"/>
<polygon fill="black" stroke="black" points="5226.48,-7552.95 5235.98,-7548.25 5225.62,-7546.01 5226.48,-7552.95"/>
</g>
<!-- expert_61_s2_l9 -->
<g id="node436" class="node">
<title>expert_61_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="5592,-7549.44 5423,-7549.44 5423,-7505.44 5592,-7505.44 5592,-7549.44"/>
<text text-anchor="middle" x="5507.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 61 L9</text>
<text text-anchor="middle" x="5507.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_61_s2_l9 -->
<g id="edge714" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_61_s2_l9</title>
<path fill="none" stroke="black" d="M3108.54,-7615.37C3537.8,-7614.24 4941.67,-7606.27 5413.04,-7549.48"/>
<polygon fill="black" stroke="black" points="5413.48,-7552.95 5422.98,-7548.26 5412.62,-7546 5413.48,-7552.95"/>
</g>
<!-- expert_62_s2_l9 -->
<g id="node437" class="node">
<title>expert_62_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="5779,-7549.44 5610,-7549.44 5610,-7505.44 5779,-7505.44 5779,-7549.44"/>
<text text-anchor="middle" x="5694.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 62 L9</text>
<text text-anchor="middle" x="5694.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_62_s2_l9 -->
<g id="edge715" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_62_s2_l9</title>
<path fill="none" stroke="black" d="M3108.69,-7615.65C3559.49,-7615.52 5090.14,-7610.53 5599.96,-7549.49"/>
<polygon fill="black" stroke="black" points="5600.48,-7552.95 5609.98,-7548.27 5599.63,-7546 5600.48,-7552.95"/>
</g>
<!-- expert_63_s2_l9 -->
<g id="node438" class="node">
<title>expert_63_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="5966,-7549.44 5797,-7549.44 5797,-7505.44 5966,-7505.44 5966,-7549.44"/>
<text text-anchor="middle" x="5881.5" y="-7539.04" font-family="Arial" font-size="8.00">Expert 63 L9</text>
<text text-anchor="middle" x="5881.5" y="-7530.04" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-7521.04" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-7512.04" font-family="Arial" font-size="8.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2_l9&#45;&gt;expert_63_s2_l9 -->
<g id="edge716" class="edge">
<title>expert_dispatch_s2_l9&#45;&gt;expert_63_s2_l9</title>
<path fill="none" stroke="black" d="M3108.62,-7615.9C3579.98,-7616.71 5238.67,-7614.81 5787,-7549.48"/>
<polygon fill="black" stroke="black" points="5787.47,-7552.95 5796.98,-7548.27 5786.63,-7546 5787.47,-7552.95"/>
</g>
<!-- expert_combine_s2_l9 -->
<g id="node439" class="node">
<title>expert_combine_s2_l9</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-7438.33" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-7449.93" font-family="Arial" font-size="8.00">Expert Combine L9 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-7440.93" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-7431.93" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7422.93" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge717" class="edge">
<title>expert_32_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M169.02,-7506.61C171.88,-7506.17 174.71,-7505.78 177.5,-7505.44 702.97,-7440.57 2358.67,-7438.2 2846.17,-7438.96"/>
<polygon fill="black" stroke="black" points="2846.42,-7442.46 2856.42,-7438.97 2846.43,-7435.46 2846.42,-7442.46"/>
</g>
<!-- expert_33_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge718" class="edge">
<title>expert_33_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M356.02,-7506.61C358.88,-7506.18 361.71,-7505.79 364.5,-7505.44 851.71,-7444.88 2380.13,-7439.45 2846.21,-7439.23"/>
<polygon fill="black" stroke="black" points="2846.36,-7442.73 2856.36,-7439.22 2846.36,-7435.73 2846.36,-7442.73"/>
</g>
<!-- expert_34_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge719" class="edge">
<title>expert_34_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M543.02,-7506.62C545.88,-7506.18 548.71,-7505.79 551.5,-7505.44 1000.54,-7449.18 2402.24,-7440.78 2846.2,-7439.54"/>
<polygon fill="black" stroke="black" points="2846.52,-7443.04 2856.51,-7439.51 2846.5,-7436.04 2846.52,-7443.04"/>
</g>
<!-- expert_35_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge720" class="edge">
<title>expert_35_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M730.02,-7506.63C732.88,-7506.19 735.71,-7505.79 738.5,-7505.44 1149.63,-7453.46 2426.08,-7442.22 2846.61,-7439.9"/>
<polygon fill="black" stroke="black" points="2846.7,-7443.4 2856.69,-7439.84 2846.67,-7436.4 2846.7,-7443.4"/>
</g>
<!-- expert_36_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge721" class="edge">
<title>expert_36_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M917.03,-7506.64C919.88,-7506.2 922.71,-7505.79 925.5,-7505.44 1298.74,-7457.74 2450.22,-7443.78 2846.7,-7440.32"/>
<polygon fill="black" stroke="black" points="2846.81,-7443.82 2856.78,-7440.24 2846.75,-7436.82 2846.81,-7443.82"/>
</g>
<!-- expert_37_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge722" class="edge">
<title>expert_37_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M1104.03,-7506.65C1106.88,-7506.21 1109.71,-7505.8 1112.5,-7505.44 1447.94,-7462.02 2474.98,-7445.49 2846.54,-7440.84"/>
<polygon fill="black" stroke="black" points="2846.85,-7444.33 2856.8,-7440.71 2846.76,-7437.33 2846.85,-7444.33"/>
</g>
<!-- expert_38_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge723" class="edge">
<title>expert_38_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M1291.03,-7506.66C1293.88,-7506.22 1296.71,-7505.8 1299.5,-7505.44 1597.53,-7466.27 2502.38,-7447.37 2847.13,-7441.45"/>
<polygon fill="black" stroke="black" points="2847.23,-7444.95 2857.17,-7441.28 2847.11,-7437.95 2847.23,-7444.95"/>
</g>
<!-- expert_39_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge724" class="edge">
<title>expert_39_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M1478.03,-7506.68C1480.88,-7506.23 1483.71,-7505.81 1486.5,-7505.44 1747.22,-7470.52 2530.56,-7449.5 2847.35,-7442.22"/>
<polygon fill="black" stroke="black" points="2847.58,-7445.71 2857.5,-7441.99 2847.42,-7438.72 2847.58,-7445.71"/>
</g>
<!-- expert_40_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge725" class="edge">
<title>expert_40_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M1665.03,-7506.7C1667.88,-7506.24 1670.71,-7505.82 1673.5,-7505.44 2098.54,-7447.16 2607.53,-7438.86 2846.26,-7438.54"/>
<polygon fill="black" stroke="black" points="2846.39,-7442.04 2856.38,-7438.53 2846.38,-7435.04 2846.39,-7442.04"/>
</g>
<!-- expert_41_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge726" class="edge">
<title>expert_41_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M1852.04,-7506.73C1854.89,-7506.27 1857.71,-7505.83 1860.5,-7505.44 2213.6,-7455.51 2634.37,-7443.17 2846.24,-7440.2"/>
<polygon fill="black" stroke="black" points="2846.52,-7443.7 2856.48,-7440.06 2846.43,-7436.7 2846.52,-7443.7"/>
</g>
<!-- expert_42_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge727" class="edge">
<title>expert_42_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M2039.05,-7506.78C2041.89,-7506.3 2044.72,-7505.85 2047.5,-7505.44 2330.13,-7463.78 2664.83,-7448.17 2847.27,-7442.47"/>
<polygon fill="black" stroke="black" points="2847.57,-7445.96 2857.46,-7442.15 2847.35,-7438.96 2847.57,-7445.96"/>
</g>
<!-- expert_43_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge728" class="edge">
<title>expert_43_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M2226.05,-7506.84C2228.9,-7506.34 2231.72,-7505.87 2234.5,-7505.44 2448.23,-7472.02 2699.16,-7454.14 2849.26,-7445.71"/>
<polygon fill="black" stroke="black" points="2849.66,-7449.19 2859.45,-7445.14 2849.27,-7442.2 2849.66,-7449.19"/>
</g>
<!-- expert_44_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge729" class="edge">
<title>expert_44_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M2413.07,-7506.95C2415.91,-7506.42 2418.73,-7505.91 2421.5,-7505.44 2569.28,-7480.12 2740.64,-7461.46 2854.7,-7450.54"/>
<polygon fill="black" stroke="black" points="2855.24,-7454 2864.87,-7449.57 2854.58,-7447.03 2855.24,-7454"/>
</g>
<!-- expert_45_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge730" class="edge">
<title>expert_45_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M2600.11,-7507.15C2602.94,-7506.57 2605.74,-7505.99 2608.5,-7505.44 2695.55,-7487.93 2794.51,-7470.54 2868.76,-7458"/>
<polygon fill="black" stroke="black" points="2869.79,-7461.38 2879.07,-7456.26 2868.63,-7454.47 2869.79,-7461.38"/>
</g>
<!-- expert_46_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge731" class="edge">
<title>expert_46_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M2770.28,-7505.35C2808.19,-7493.56 2855.83,-7478.74 2896.36,-7466.13"/>
<polygon fill="black" stroke="black" points="2897.45,-7469.45 2905.96,-7463.14 2895.37,-7462.77 2897.45,-7469.45"/>
</g>
<!-- expert_47_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge732" class="edge">
<title>expert_47_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M2912.01,-7505.35C2921.53,-7496.43 2932.9,-7485.78 2943.7,-7475.67"/>
<polygon fill="black" stroke="black" points="2946.15,-7478.17 2951.06,-7468.78 2941.37,-7473.06 2946.15,-7478.17"/>
</g>
<!-- expert_48_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge733" class="edge">
<title>expert_48_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M3053.75,-7505.35C3044.12,-7496.43 3032.63,-7485.78 3021.71,-7475.67"/>
<polygon fill="black" stroke="black" points="3023.99,-7473.01 3014.28,-7468.78 3019.23,-7478.14 3023.99,-7473.01"/>
</g>
<!-- expert_49_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge734" class="edge">
<title>expert_49_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M3195.48,-7505.35C3157.36,-7493.53 3109.44,-7478.68 3068.71,-7466.05"/>
<polygon fill="black" stroke="black" points="3069.65,-7462.68 3059.06,-7463.06 3067.58,-7469.36 3069.65,-7462.68"/>
</g>
<!-- expert_50_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge735" class="edge">
<title>expert_50_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M3365.89,-7507.15C3363.06,-7506.57 3360.26,-7505.99 3357.5,-7505.44 3269.89,-7487.83 3170.24,-7470.39 3095.69,-7457.84"/>
<polygon fill="black" stroke="black" points="3096.25,-7454.38 3085.81,-7456.18 3095.09,-7461.29 3096.25,-7454.38"/>
</g>
<!-- expert_51_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge736" class="edge">
<title>expert_51_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M3552.93,-7506.95C3550.09,-7506.42 3547.27,-7505.91 3544.5,-7505.44 3396.34,-7480.07 3224.52,-7461.41 3110.26,-7450.5"/>
<polygon fill="black" stroke="black" points="3110.36,-7446.99 3100.07,-7449.53 3109.69,-7453.96 3110.36,-7446.99"/>
</g>
<!-- expert_52_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge737" class="edge">
<title>expert_52_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M3739.95,-7506.84C3737.1,-7506.34 3734.28,-7505.87 3731.5,-7505.44 3517.33,-7471.96 3265.85,-7454.1 3115.58,-7445.68"/>
<polygon fill="black" stroke="black" points="3115.57,-7442.17 3105.39,-7445.11 3115.18,-7449.16 3115.57,-7442.17"/>
</g>
<!-- expert_53_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge738" class="edge">
<title>expert_53_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M3926.96,-7506.78C3924.11,-7506.3 3921.28,-7505.85 3918.5,-7505.44 3635.57,-7463.75 3300.51,-7448.15 3117.87,-7442.46"/>
<polygon fill="black" stroke="black" points="3117.78,-7438.95 3107.68,-7442.15 3117.57,-7445.95 3117.78,-7438.95"/>
</g>
<!-- expert_54_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge739" class="edge">
<title>expert_54_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M4113.96,-7506.73C4111.11,-7506.27 4108.29,-7505.83 4105.5,-7505.44 3751.85,-7455.44 3330.37,-7443.14 3118.46,-7440.19"/>
<polygon fill="black" stroke="black" points="3118.26,-7436.69 3108.22,-7440.05 3118.17,-7443.69 3118.26,-7436.69"/>
</g>
<!-- expert_55_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge740" class="edge">
<title>expert_55_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M4300.97,-7506.7C4298.12,-7506.24 4295.29,-7505.82 4292.5,-7505.44 3867.13,-7447.12 3357.75,-7438.84 3118.84,-7438.53"/>
<polygon fill="black" stroke="black" points="3118.72,-7435.03 3108.71,-7438.52 3118.71,-7442.03 3118.72,-7435.03"/>
</g>
<!-- expert_56_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge741" class="edge">
<title>expert_56_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M4487.97,-7506.68C4485.12,-7506.23 4482.29,-7505.81 4479.5,-7505.44 4218.6,-7470.5 3434.74,-7449.49 3117.74,-7442.22"/>
<polygon fill="black" stroke="black" points="3117.66,-7438.71 3107.58,-7441.98 3117.5,-7445.71 3117.66,-7438.71"/>
</g>
<!-- expert_57_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge742" class="edge">
<title>expert_57_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M4674.97,-7506.66C4672.12,-7506.22 4669.29,-7505.8 4666.5,-7505.44 4368.29,-7466.25 3462.9,-7447.36 3117.95,-7441.45"/>
<polygon fill="black" stroke="black" points="3117.97,-7437.95 3107.91,-7441.28 3117.85,-7444.95 3117.97,-7437.95"/>
</g>
<!-- expert_58_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge743" class="edge">
<title>expert_58_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M4861.97,-7506.65C4859.12,-7506.21 4856.29,-7505.8 4853.5,-7505.44 4517.88,-7462 3490.29,-7445.49 3118.53,-7440.83"/>
<polygon fill="black" stroke="black" points="3118.31,-7437.33 3108.26,-7440.71 3118.22,-7444.33 3118.31,-7437.33"/>
</g>
<!-- expert_59_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge744" class="edge">
<title>expert_59_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M5048.97,-7506.64C5046.12,-7506.2 5043.29,-7505.79 5040.5,-7505.44 4667.07,-7457.72 3515.04,-7443.77 3118.36,-7440.32"/>
<polygon fill="black" stroke="black" points="3118.31,-7436.82 3108.28,-7440.24 3118.25,-7443.82 3118.31,-7436.82"/>
</g>
<!-- expert_60_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge745" class="edge">
<title>expert_60_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M5235.98,-7506.63C5233.12,-7506.19 5230.29,-7505.79 5227.5,-7505.44 4816.19,-7453.44 3539.17,-7442.21 3118.45,-7439.9"/>
<polygon fill="black" stroke="black" points="3118.39,-7436.4 3108.37,-7439.84 3118.35,-7443.4 3118.39,-7436.4"/>
</g>
<!-- expert_61_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge746" class="edge">
<title>expert_61_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M5422.98,-7506.62C5420.12,-7506.18 5417.29,-7505.79 5414.5,-7505.44 4965.28,-7449.16 3563,-7440.78 3118.86,-7439.54"/>
<polygon fill="black" stroke="black" points="3118.55,-7436.04 3108.54,-7439.51 3118.53,-7443.04 3118.55,-7436.04"/>
</g>
<!-- expert_62_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge747" class="edge">
<title>expert_62_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M5609.98,-7506.61C5607.12,-7506.18 5604.29,-7505.79 5601.5,-7505.44 5114.1,-7444.86 3585.1,-7439.44 3118.84,-7439.23"/>
<polygon fill="black" stroke="black" points="3118.69,-7435.73 3108.69,-7439.22 3118.69,-7442.73 3118.69,-7435.73"/>
</g>
<!-- expert_63_s2_l9&#45;&gt;expert_combine_s2_l9 -->
<g id="edge748" class="edge">
<title>expert_63_s2_l9&#45;&gt;expert_combine_s2_l9</title>
<path fill="none" stroke="black" d="M5796.98,-7506.61C5794.12,-7506.17 5791.29,-7505.78 5788.5,-7505.44 5262.84,-7440.55 3606.55,-7438.19 3118.88,-7438.96"/>
<polygon fill="black" stroke="black" points="3118.62,-7435.46 3108.62,-7438.97 3118.63,-7442.46 3118.62,-7435.46"/>
</g>
<!-- moe_out_proj_s2_l9 -->
<g id="node440" class="node">
<title>moe_out_proj_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-7371.21 2893.5,-7371.21 2893.5,-7327.21 3071.5,-7327.21 3071.5,-7371.21"/>
<text text-anchor="middle" x="2982.5" y="-7360.81" font-family="Arial" font-size="8.00">MoE Output Proj L9 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-7351.81" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7342.81" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7333.81" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2_l9&#45;&gt;moe_out_proj_s2_l9 -->
<g id="edge749" class="edge">
<title>expert_combine_s2_l9&#45;&gt;moe_out_proj_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-7406.86C2982.5,-7398.58 2982.5,-7389.6 2982.5,-7381.29"/>
<polygon fill="black" stroke="black" points="2986,-7381.22 2982.5,-7371.22 2979,-7381.22 2986,-7381.22"/>
</g>
<!-- allreduce_moe_out_s2_l9 -->
<g id="node441" class="node">
<title>allreduce_moe_out_s2_l9</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-7260.1" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-7271.7" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L9</text>
<text text-anchor="middle" x="2982.5" y="-7262.7" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7253.7" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7244.7" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2_l9&#45;&gt;allreduce_moe_out_s2_l9 -->
<g id="edge750" class="edge">
<title>moe_out_proj_s2_l9&#45;&gt;allreduce_moe_out_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-7327.13C2982.5,-7319.45 2982.5,-7310.5 2982.5,-7301.71"/>
<polygon fill="black" stroke="black" points="2986,-7301.54 2982.5,-7291.54 2979,-7301.54 2986,-7301.54"/>
</g>
<!-- layernorm2_s2_l9 -->
<g id="node442" class="node">
<title>layernorm2_s2_l9</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-7192.99 2893.5,-7192.99 2893.5,-7148.99 3071.5,-7148.99 3071.5,-7192.99"/>
<text text-anchor="middle" x="2982.5" y="-7182.59" font-family="Arial" font-size="8.00">LayerNorm 2 (L9)</text>
<text text-anchor="middle" x="2982.5" y="-7173.59" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7164.59" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7155.59" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2_l9&#45;&gt;layernorm2_s2_l9 -->
<g id="edge751" class="edge">
<title>allreduce_moe_out_s2_l9&#45;&gt;layernorm2_s2_l9</title>
<path fill="none" stroke="black" d="M2982.5,-7228.63C2982.5,-7220.35 2982.5,-7211.38 2982.5,-7203.06"/>
<polygon fill="black" stroke="black" points="2986,-7202.99 2982.5,-7192.99 2979,-7202.99 2986,-7202.99"/>
</g>
<!-- layernorm1_s2_l10 -->
<g id="node443" class="node">
<title>layernorm1_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-7112.99 2893.5,-7112.99 2893.5,-7068.99 3071.5,-7068.99 3071.5,-7112.99"/>
<text text-anchor="middle" x="2982.5" y="-7102.59" font-family="Arial" font-size="8.00">LayerNorm 1 (L10)</text>
<text text-anchor="middle" x="2982.5" y="-7093.59" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7084.59" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7075.59" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm2_s2_l9&#45;&gt;layernorm1_s2_l10 -->
<g id="edge752" class="edge">
<title>layernorm2_s2_l9&#45;&gt;layernorm1_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-7148.67C2982.5,-7140.78 2982.5,-7131.67 2982.5,-7123.09"/>
<polygon fill="black" stroke="black" points="2986,-7123.01 2982.5,-7113.01 2979,-7123.01 2986,-7123.01"/>
</g>
<!-- qkv_proj_s2_l10 -->
<g id="node444" class="node">
<title>qkv_proj_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3081,-7032.99 2884,-7032.99 2884,-6988.99 3081,-6988.99 3081,-7032.99"/>
<text text-anchor="middle" x="2982.5" y="-7022.59" font-family="Arial" font-size="8.00">QKV Projection L10 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-7013.59" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-7004.59" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-6995.59" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2_l10&#45;&gt;qkv_proj_s2_l10 -->
<g id="edge753" class="edge">
<title>layernorm1_s2_l10&#45;&gt;qkv_proj_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-7068.67C2982.5,-7060.78 2982.5,-7051.67 2982.5,-7043.09"/>
<polygon fill="black" stroke="black" points="2986,-7043.01 2982.5,-7033.01 2979,-7043.01 2986,-7043.01"/>
</g>
<!-- allreduce_qkv_s2_l10 -->
<g id="node445" class="node">
<title>allreduce_qkv_s2_l10</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-6921.87" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-6933.47" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L10</text>
<text text-anchor="middle" x="2982.5" y="-6924.47" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-6915.47" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-6906.47" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2_l10&#45;&gt;allreduce_qkv_s2_l10 -->
<g id="edge754" class="edge">
<title>qkv_proj_s2_l10&#45;&gt;allreduce_qkv_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-6988.9C2982.5,-6981.23 2982.5,-6972.27 2982.5,-6963.48"/>
<polygon fill="black" stroke="black" points="2986,-6963.32 2982.5,-6953.32 2979,-6963.32 2986,-6963.32"/>
</g>
<!-- attention_s2_l10 -->
<g id="node446" class="node">
<title>attention_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3081,-6854.76 2884,-6854.76 2884,-6810.76 3081,-6810.76 3081,-6854.76"/>
<text text-anchor="middle" x="2982.5" y="-6844.36" font-family="Arial" font-size="8.00">Self&#45;Attention L10</text>
<text text-anchor="middle" x="2982.5" y="-6835.36" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-6826.36" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-6817.36" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2_l10&#45;&gt;attention_s2_l10 -->
<g id="edge755" class="edge">
<title>allreduce_qkv_s2_l10&#45;&gt;attention_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-6890.41C2982.5,-6882.13 2982.5,-6873.15 2982.5,-6864.84"/>
<polygon fill="black" stroke="black" points="2986,-6864.77 2982.5,-6854.77 2979,-6864.77 2986,-6864.77"/>
</g>
<!-- attn_out_proj_s2_l10 -->
<g id="node447" class="node">
<title>attn_out_proj_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3078,-6774.76 2887,-6774.76 2887,-6730.76 3078,-6730.76 3078,-6774.76"/>
<text text-anchor="middle" x="2982.5" y="-6764.36" font-family="Arial" font-size="8.00">Attention Output Proj L10 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-6755.36" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-6746.36" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6737.36" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2_l10&#45;&gt;attn_out_proj_s2_l10 -->
<g id="edge756" class="edge">
<title>attention_s2_l10&#45;&gt;attn_out_proj_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-6810.45C2982.5,-6802.56 2982.5,-6793.45 2982.5,-6784.86"/>
<polygon fill="black" stroke="black" points="2986,-6784.78 2982.5,-6774.78 2979,-6784.78 2986,-6784.78"/>
</g>
<!-- allreduce_attn_out_s2_l10 -->
<g id="node448" class="node">
<title>allreduce_attn_out_s2_l10</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-6663.65" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-6675.25" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L10</text>
<text text-anchor="middle" x="2982.5" y="-6666.25" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6657.25" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6648.25" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2_l10&#45;&gt;allreduce_attn_out_s2_l10 -->
<g id="edge757" class="edge">
<title>attn_out_proj_s2_l10&#45;&gt;allreduce_attn_out_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-6730.67C2982.5,-6723 2982.5,-6714.05 2982.5,-6705.26"/>
<polygon fill="black" stroke="black" points="2986,-6705.09 2982.5,-6695.09 2979,-6705.09 2986,-6705.09"/>
</g>
<!-- moe_gate_s2_l10 -->
<g id="node449" class="node">
<title>moe_gate_s2_l10</title>
<polygon fill="orange" stroke="black" points="3167.08,-6596.54 2873.45,-6596.54 2797.92,-6508.54 3091.55,-6508.54 3167.08,-6596.54"/>
<text text-anchor="middle" x="2982.5" y="-6564.14" font-family="Arial" font-size="8.00">MoE Gate L10 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-6555.14" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6546.14" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6537.14" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2_l10&#45;&gt;moe_gate_s2_l10 -->
<g id="edge758" class="edge">
<title>allreduce_attn_out_s2_l10&#45;&gt;moe_gate_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-6632.26C2982.5,-6624.37 2982.5,-6615.64 2982.5,-6606.95"/>
<polygon fill="black" stroke="black" points="2986,-6606.81 2982.5,-6596.81 2979,-6606.82 2986,-6606.81"/>
</g>
<!-- expert_dispatch_s2_l10 -->
<g id="node450" class="node">
<title>expert_dispatch_s2_l10</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-6441.42" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-6453.02" font-family="Arial" font-size="8.00">Expert Dispatch L10 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-6444.02" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6435.02" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6426.02" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2_l10&#45;&gt;expert_dispatch_s2_l10 -->
<g id="edge759" class="edge">
<title>moe_gate_s2_l10&#45;&gt;expert_dispatch_s2_l10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-6508.41C2982.5,-6500.04 2982.5,-6491.28 2982.5,-6482.99"/>
<polygon fill="black" stroke="black" points="2986,-6482.8 2982.5,-6472.8 2979,-6482.8 2986,-6482.8"/>
</g>
<!-- expert_32_s2_l10 -->
<g id="node451" class="node">
<title>expert_32_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="169,-6374.31 0,-6374.31 0,-6330.31 169,-6330.31 169,-6374.31"/>
<text text-anchor="middle" x="84.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 32 L10</text>
<text text-anchor="middle" x="84.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_32_s2_l10 -->
<g id="edge760" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_32_s2_l10</title>
<path fill="none" stroke="black" d="M2856.42,-6440.78C2385.23,-6441.58 727.13,-6439.66 178.99,-6374.35"/>
<polygon fill="black" stroke="black" points="179.37,-6370.87 169.02,-6373.14 178.53,-6377.82 179.37,-6370.87"/>
</g>
<!-- expert_33_s2_l10 -->
<g id="node452" class="node">
<title>expert_33_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="356,-6374.31 187,-6374.31 187,-6330.31 356,-6330.31 356,-6374.31"/>
<text text-anchor="middle" x="271.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 33 L10</text>
<text text-anchor="middle" x="271.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_33_s2_l10 -->
<g id="edge761" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_33_s2_l10</title>
<path fill="none" stroke="black" d="M2856.36,-6440.53C2405.73,-6440.38 875.66,-6435.38 366.03,-6374.36"/>
<polygon fill="black" stroke="black" points="366.37,-6370.88 356.02,-6373.14 365.52,-6377.82 366.37,-6370.88"/>
</g>
<!-- expert_34_s2_l10 -->
<g id="node453" class="node">
<title>expert_34_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="543,-6374.31 374,-6374.31 374,-6330.31 543,-6330.31 543,-6374.31"/>
<text text-anchor="middle" x="458.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 34 L10</text>
<text text-anchor="middle" x="458.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_34_s2_l10 -->
<g id="edge762" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_34_s2_l10</title>
<path fill="none" stroke="black" d="M2856.51,-6440.24C2427.43,-6439.1 1024.14,-6431.13 552.96,-6374.35"/>
<polygon fill="black" stroke="black" points="553.38,-6370.88 543.02,-6373.13 552.52,-6377.83 553.38,-6370.88"/>
</g>
<!-- expert_35_s2_l10 -->
<g id="node454" class="node">
<title>expert_35_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="730,-6374.31 561,-6374.31 561,-6330.31 730,-6330.31 730,-6374.31"/>
<text text-anchor="middle" x="645.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 35 L10</text>
<text text-anchor="middle" x="645.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_35_s2_l10 -->
<g id="edge763" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_35_s2_l10</title>
<path fill="none" stroke="black" d="M2856.69,-6439.9C2450.07,-6437.73 1173.13,-6426.89 740.1,-6374.37"/>
<polygon fill="black" stroke="black" points="740.38,-6370.88 730.02,-6373.12 739.52,-6377.83 740.38,-6370.88"/>
</g>
<!-- expert_36_s2_l10 -->
<g id="node455" class="node">
<title>expert_36_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="917,-6374.31 748,-6374.31 748,-6330.31 917,-6330.31 917,-6374.31"/>
<text text-anchor="middle" x="832.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 36 L10</text>
<text text-anchor="middle" x="832.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_36_s2_l10 -->
<g id="edge764" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_36_s2_l10</title>
<path fill="none" stroke="black" d="M2856.78,-6439.51C2473.43,-6436.24 1321.87,-6422.66 927.06,-6374.37"/>
<polygon fill="black" stroke="black" points="927.38,-6370.88 917.03,-6373.11 926.51,-6377.83 927.38,-6370.88"/>
</g>
<!-- expert_37_s2_l10 -->
<g id="node456" class="node">
<title>expert_37_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="1104,-6374.31 935,-6374.31 935,-6330.31 1104,-6330.31 1104,-6374.31"/>
<text text-anchor="middle" x="1019.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 37 L10</text>
<text text-anchor="middle" x="1019.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_37_s2_l10 -->
<g id="edge765" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_37_s2_l10</title>
<path fill="none" stroke="black" d="M2856.8,-6439.04C2497.73,-6434.61 1470.88,-6418.44 1114.13,-6374.38"/>
<polygon fill="black" stroke="black" points="1114.39,-6370.88 1104.03,-6373.1 1113.51,-6377.83 1114.39,-6370.88"/>
</g>
<!-- expert_38_s2_l10 -->
<g id="node457" class="node">
<title>expert_38_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="1291,-6374.31 1122,-6374.31 1122,-6330.31 1291,-6330.31 1291,-6374.31"/>
<text text-anchor="middle" x="1206.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 38 L10</text>
<text text-anchor="middle" x="1206.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_38_s2_l10 -->
<g id="edge766" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_38_s2_l10</title>
<path fill="none" stroke="black" d="M2857.17,-6438.47C2523.91,-6432.81 1620.17,-6414.27 1301.21,-6374.39"/>
<polygon fill="black" stroke="black" points="1301.39,-6370.89 1291.03,-6373.09 1300.5,-6377.83 1301.39,-6370.89"/>
</g>
<!-- expert_39_s2_l10 -->
<g id="node458" class="node">
<title>expert_39_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="1478,-6374.31 1309,-6374.31 1309,-6330.31 1478,-6330.31 1478,-6374.31"/>
<text text-anchor="middle" x="1393.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 39 L10</text>
<text text-anchor="middle" x="1393.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_39_s2_l10 -->
<g id="edge767" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_39_s2_l10</title>
<path fill="none" stroke="black" d="M2857.5,-6437.76C2551.41,-6430.79 1769.45,-6410.12 1488.23,-6374.4"/>
<polygon fill="black" stroke="black" points="1488.4,-6370.89 1478.03,-6373.07 1487.49,-6377.83 1488.4,-6370.89"/>
</g>
<!-- expert_40_s2_l10 -->
<g id="node459" class="node">
<title>expert_40_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="1665,-6374.31 1496,-6374.31 1496,-6330.31 1665,-6330.31 1665,-6374.31"/>
<text text-anchor="middle" x="1580.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 40 L10</text>
<text text-anchor="middle" x="1580.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_40_s2_l10 -->
<g id="edge768" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_40_s2_l10</title>
<path fill="none" stroke="black" d="M2856.38,-6441.22C2623.94,-6441.12 2112.47,-6433.55 1675.03,-6374.41"/>
<polygon fill="black" stroke="black" points="1675.42,-6370.93 1665.03,-6373.05 1674.47,-6377.86 1675.42,-6370.93"/>
</g>
<!-- expert_41_s2_l10 -->
<g id="node460" class="node">
<title>expert_41_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="1852,-6374.31 1683,-6374.31 1683,-6330.31 1852,-6330.31 1852,-6374.31"/>
<text text-anchor="middle" x="1767.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 41 L10</text>
<text text-anchor="middle" x="1767.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_41_s2_l10 -->
<g id="edge769" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_41_s2_l10</title>
<path fill="none" stroke="black" d="M2856.48,-6439.68C2650.05,-6436.99 2227.11,-6425.27 1862.01,-6374.42"/>
<polygon fill="black" stroke="black" points="1862.43,-6370.94 1852.04,-6373.02 1861.45,-6377.87 1862.43,-6370.94"/>
</g>
<!-- expert_42_s2_l10 -->
<g id="node461" class="node">
<title>expert_42_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="2039,-6374.31 1870,-6374.31 1870,-6330.31 2039,-6330.31 2039,-6374.31"/>
<text text-anchor="middle" x="1954.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 42 L10</text>
<text text-anchor="middle" x="1954.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_42_s2_l10 -->
<g id="edge770" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_42_s2_l10</title>
<path fill="none" stroke="black" d="M2857.46,-6437.59C2679.53,-6432.22 2343.14,-6417.1 2049.05,-6374.44"/>
<polygon fill="black" stroke="black" points="2049.45,-6370.96 2039.05,-6372.97 2048.43,-6377.88 2049.45,-6370.96"/>
</g>
<!-- expert_43_s2_l10 -->
<g id="node462" class="node">
<title>expert_43_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="2226,-6374.31 2057,-6374.31 2057,-6330.31 2226,-6330.31 2226,-6374.31"/>
<text text-anchor="middle" x="2141.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 43 L10</text>
<text text-anchor="middle" x="2141.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_43_s2_l10 -->
<g id="edge771" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_43_s2_l10</title>
<path fill="none" stroke="black" d="M2859.45,-6434.61C2712.89,-6426.54 2460.66,-6409.02 2236.05,-6374.46"/>
<polygon fill="black" stroke="black" points="2236.47,-6370.98 2226.05,-6372.91 2235.4,-6377.9 2236.47,-6370.98"/>
</g>
<!-- expert_44_s2_l10 -->
<g id="node463" class="node">
<title>expert_44_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="2413,-6374.31 2244,-6374.31 2244,-6330.31 2413,-6330.31 2413,-6374.31"/>
<text text-anchor="middle" x="2328.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 44 L10</text>
<text text-anchor="middle" x="2328.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_44_s2_l10 -->
<g id="edge772" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_44_s2_l10</title>
<path fill="none" stroke="black" d="M2864.87,-6430.18C2753.34,-6419.63 2580.99,-6401.17 2422.98,-6374.49"/>
<polygon fill="black" stroke="black" points="2423.52,-6371.03 2413.07,-6372.8 2422.34,-6377.93 2423.52,-6371.03"/>
</g>
<!-- expert_45_s2_l10 -->
<g id="node464" class="node">
<title>expert_45_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="2600,-6374.31 2431,-6374.31 2431,-6330.31 2600,-6330.31 2600,-6374.31"/>
<text text-anchor="middle" x="2515.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 45 L10</text>
<text text-anchor="middle" x="2515.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_45_s2_l10 -->
<g id="edge773" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_45_s2_l10</title>
<path fill="none" stroke="black" d="M2879.07,-6423.49C2806.34,-6411.26 2706.53,-6393.85 2610.04,-6374.59"/>
<polygon fill="black" stroke="black" points="2610.6,-6371.13 2600.11,-6372.59 2609.23,-6377.99 2610.6,-6371.13"/>
</g>
<!-- expert_46_s2_l10 -->
<g id="node465" class="node">
<title>expert_46_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="2787,-6374.31 2618,-6374.31 2618,-6330.31 2787,-6330.31 2787,-6374.31"/>
<text text-anchor="middle" x="2702.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 46 L10</text>
<text text-anchor="middle" x="2702.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_46_s2_l10 -->
<g id="edge774" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_46_s2_l10</title>
<path fill="none" stroke="black" d="M2905.99,-6416.62C2866.88,-6404.45 2819.39,-6389.68 2780.12,-6377.46"/>
<polygon fill="black" stroke="black" points="2780.91,-6374.04 2770.32,-6374.41 2778.83,-6380.73 2780.91,-6374.04"/>
</g>
<!-- expert_47_s2_l10 -->
<g id="node466" class="node">
<title>expert_47_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="2974,-6374.31 2805,-6374.31 2805,-6330.31 2974,-6330.31 2974,-6374.31"/>
<text text-anchor="middle" x="2889.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 47 L10</text>
<text text-anchor="middle" x="2889.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_47_s2_l10 -->
<g id="edge775" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_47_s2_l10</title>
<path fill="none" stroke="black" d="M2951.27,-6411.17C2941.01,-6401.56 2929.64,-6390.91 2919.47,-6381.39"/>
<polygon fill="black" stroke="black" points="2921.66,-6378.64 2911.97,-6374.36 2916.88,-6383.75 2921.66,-6378.64"/>
</g>
<!-- expert_48_s2_l10 -->
<g id="node467" class="node">
<title>expert_48_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3161,-6374.31 2992,-6374.31 2992,-6330.31 3161,-6330.31 3161,-6374.31"/>
<text text-anchor="middle" x="3076.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 48 L10</text>
<text text-anchor="middle" x="3076.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_48_s2_l10 -->
<g id="edge776" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_48_s2_l10</title>
<path fill="none" stroke="black" d="M3014.06,-6411.17C3024.43,-6401.56 3035.93,-6390.91 3046.21,-6381.39"/>
<polygon fill="black" stroke="black" points="3048.83,-6383.73 3053.78,-6374.36 3044.07,-6378.59 3048.83,-6383.73"/>
</g>
<!-- expert_49_s2_l10 -->
<g id="node468" class="node">
<title>expert_49_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3348,-6374.31 3179,-6374.31 3179,-6330.31 3348,-6330.31 3348,-6374.31"/>
<text text-anchor="middle" x="3263.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 49 L10</text>
<text text-anchor="middle" x="3263.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_49_s2_l10 -->
<g id="edge777" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_49_s2_l10</title>
<path fill="none" stroke="black" d="M3059.28,-6416.62C3098.53,-6404.45 3146.2,-6389.68 3185.6,-6377.46"/>
<polygon fill="black" stroke="black" points="3186.92,-6380.72 3195.43,-6374.41 3184.84,-6374.03 3186.92,-6380.72"/>
</g>
<!-- expert_50_s2_l10 -->
<g id="node469" class="node">
<title>expert_50_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3535,-6374.31 3366,-6374.31 3366,-6330.31 3535,-6330.31 3535,-6374.31"/>
<text text-anchor="middle" x="3450.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 50 L10</text>
<text text-anchor="middle" x="3450.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_50_s2_l10 -->
<g id="edge778" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_50_s2_l10</title>
<path fill="none" stroke="black" d="M3085.81,-6423.57C3158.76,-6411.35 3259.03,-6393.91 3355.92,-6374.59"/>
<polygon fill="black" stroke="black" points="3356.77,-6377.99 3365.89,-6372.6 3355.4,-6371.13 3356.77,-6377.99"/>
</g>
<!-- expert_51_s2_l10 -->
<g id="node470" class="node">
<title>expert_51_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3722,-6374.31 3553,-6374.31 3553,-6330.31 3722,-6330.31 3722,-6374.31"/>
<text text-anchor="middle" x="3637.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 51 L10</text>
<text text-anchor="middle" x="3637.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_51_s2_l10 -->
<g id="edge779" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_51_s2_l10</title>
<path fill="none" stroke="black" d="M3100.07,-6430.22C3211.79,-6419.68 3384.6,-6401.22 3543,-6374.49"/>
<polygon fill="black" stroke="black" points="3543.66,-6377.93 3552.93,-6372.8 3542.48,-6371.03 3543.66,-6377.93"/>
</g>
<!-- expert_52_s2_l10 -->
<g id="node471" class="node">
<title>expert_52_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3909,-6374.31 3740,-6374.31 3740,-6330.31 3909,-6330.31 3909,-6374.31"/>
<text text-anchor="middle" x="3824.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 52 L10</text>
<text text-anchor="middle" x="3824.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_52_s2_l10 -->
<g id="edge780" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_52_s2_l10</title>
<path fill="none" stroke="black" d="M3105.39,-6434.64C3252.09,-6426.59 3504.87,-6409.08 3729.93,-6374.46"/>
<polygon fill="black" stroke="black" points="3730.6,-6377.9 3739.95,-6372.91 3729.53,-6370.98 3730.6,-6377.9"/>
</g>
<!-- expert_53_s2_l10 -->
<g id="node472" class="node">
<title>expert_53_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="4096,-6374.31 3927,-6374.31 3927,-6330.31 4096,-6330.31 4096,-6374.31"/>
<text text-anchor="middle" x="4011.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 53 L10</text>
<text text-anchor="middle" x="4011.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_53_s2_l10 -->
<g id="edge781" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_53_s2_l10</title>
<path fill="none" stroke="black" d="M3107.68,-6437.6C3285.8,-6432.25 3622.55,-6417.13 3916.94,-6374.44"/>
<polygon fill="black" stroke="black" points="3917.57,-6377.88 3926.96,-6372.97 3916.55,-6370.96 3917.57,-6377.88"/>
</g>
<!-- expert_54_s2_l10 -->
<g id="node473" class="node">
<title>expert_54_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="4283,-6374.31 4114,-6374.31 4114,-6330.31 4283,-6330.31 4283,-6374.31"/>
<text text-anchor="middle" x="4198.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 54 L10</text>
<text text-anchor="middle" x="4198.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_54_s2_l10 -->
<g id="edge782" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_54_s2_l10</title>
<path fill="none" stroke="black" d="M3108.22,-6439.7C3314.67,-6437.03 3738.31,-6425.34 4103.98,-6374.42"/>
<polygon fill="black" stroke="black" points="4104.55,-6377.87 4113.96,-6373.02 4103.57,-6370.94 4104.55,-6377.87"/>
</g>
<!-- expert_55_s2_l10 -->
<g id="node474" class="node">
<title>expert_55_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="4470,-6374.31 4301,-6374.31 4301,-6330.31 4470,-6330.31 4470,-6374.31"/>
<text text-anchor="middle" x="4385.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 55 L10</text>
<text text-anchor="middle" x="4385.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_55_s2_l10 -->
<g id="edge783" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_55_s2_l10</title>
<path fill="none" stroke="black" d="M3108.71,-6441.23C3341.33,-6441.14 3853.2,-6433.58 4290.96,-6374.41"/>
<polygon fill="black" stroke="black" points="4291.53,-6377.86 4300.97,-6373.05 4290.58,-6370.93 4291.53,-6377.86"/>
</g>
<!-- expert_56_s2_l10 -->
<g id="node475" class="node">
<title>expert_56_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="4657,-6374.31 4488,-6374.31 4488,-6330.31 4657,-6330.31 4657,-6374.31"/>
<text text-anchor="middle" x="4572.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 56 L10</text>
<text text-anchor="middle" x="4572.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_56_s2_l10 -->
<g id="edge784" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_56_s2_l10</title>
<path fill="none" stroke="black" d="M3107.58,-6437.77C3413.87,-6430.8 4196.36,-6410.14 4477.77,-6374.4"/>
<polygon fill="black" stroke="black" points="4478.51,-6377.83 4487.97,-6373.07 4477.6,-6370.89 4478.51,-6377.83"/>
</g>
<!-- expert_57_s2_l10 -->
<g id="node476" class="node">
<title>expert_57_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="4844,-6374.31 4675,-6374.31 4675,-6330.31 4844,-6330.31 4844,-6374.31"/>
<text text-anchor="middle" x="4759.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 57 L10</text>
<text text-anchor="middle" x="4759.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_57_s2_l10 -->
<g id="edge785" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_57_s2_l10</title>
<path fill="none" stroke="black" d="M3107.91,-6438.47C3441.37,-6432.82 4345.64,-6414.29 4664.78,-6374.39"/>
<polygon fill="black" stroke="black" points="4665.5,-6377.83 4674.97,-6373.09 4664.61,-6370.89 4665.5,-6377.83"/>
</g>
<!-- expert_58_s2_l10 -->
<g id="node477" class="node">
<title>expert_58_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="5031,-6374.31 4862,-6374.31 4862,-6330.31 5031,-6330.31 5031,-6374.31"/>
<text text-anchor="middle" x="4946.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 58 L10</text>
<text text-anchor="middle" x="4946.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_58_s2_l10 -->
<g id="edge786" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_58_s2_l10</title>
<path fill="none" stroke="black" d="M3108.26,-6439.04C3467.53,-6434.61 4494.93,-6418.46 4851.87,-6374.38"/>
<polygon fill="black" stroke="black" points="4852.49,-6377.83 4861.97,-6373.1 4851.61,-6370.88 4852.49,-6377.83"/>
</g>
<!-- expert_59_s2_l10 -->
<g id="node478" class="node">
<title>expert_59_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="5218,-6374.31 5049,-6374.31 5049,-6330.31 5218,-6330.31 5218,-6374.31"/>
<text text-anchor="middle" x="5133.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 59 L10</text>
<text text-anchor="middle" x="5133.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_59_s2_l10 -->
<g id="edge787" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_59_s2_l10</title>
<path fill="none" stroke="black" d="M3108.28,-6439.51C3491.82,-6436.25 4643.94,-6422.68 5038.93,-6374.37"/>
<polygon fill="black" stroke="black" points="5039.49,-6377.83 5048.97,-6373.11 5038.62,-6370.88 5039.49,-6377.83"/>
</g>
<!-- expert_60_s2_l10 -->
<g id="node479" class="node">
<title>expert_60_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="5405,-6374.31 5236,-6374.31 5236,-6330.31 5405,-6330.31 5405,-6374.31"/>
<text text-anchor="middle" x="5320.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 60 L10</text>
<text text-anchor="middle" x="5320.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_60_s2_l10 -->
<g id="edge788" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_60_s2_l10</title>
<path fill="none" stroke="black" d="M3108.37,-6439.91C3515.16,-6437.74 4792.68,-6426.91 5225.9,-6374.37"/>
<polygon fill="black" stroke="black" points="5226.48,-6377.83 5235.98,-6373.12 5225.62,-6370.88 5226.48,-6377.83"/>
</g>
<!-- expert_61_s2_l10 -->
<g id="node480" class="node">
<title>expert_61_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="5592,-6374.31 5423,-6374.31 5423,-6330.31 5592,-6330.31 5592,-6374.31"/>
<text text-anchor="middle" x="5507.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 61 L10</text>
<text text-anchor="middle" x="5507.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_61_s2_l10 -->
<g id="edge789" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_61_s2_l10</title>
<path fill="none" stroke="black" d="M3108.54,-6440.24C3537.8,-6439.11 4941.67,-6431.15 5413.04,-6374.35"/>
<polygon fill="black" stroke="black" points="5413.48,-6377.83 5422.98,-6373.13 5412.62,-6370.88 5413.48,-6377.83"/>
</g>
<!-- expert_62_s2_l10 -->
<g id="node481" class="node">
<title>expert_62_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="5779,-6374.31 5610,-6374.31 5610,-6330.31 5779,-6330.31 5779,-6374.31"/>
<text text-anchor="middle" x="5694.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 62 L10</text>
<text text-anchor="middle" x="5694.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_62_s2_l10 -->
<g id="edge790" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_62_s2_l10</title>
<path fill="none" stroke="black" d="M3108.69,-6440.53C3559.49,-6440.39 5090.14,-6435.41 5599.96,-6374.36"/>
<polygon fill="black" stroke="black" points="5600.48,-6377.82 5609.98,-6373.14 5599.63,-6370.88 5600.48,-6377.82"/>
</g>
<!-- expert_63_s2_l10 -->
<g id="node482" class="node">
<title>expert_63_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="5966,-6374.31 5797,-6374.31 5797,-6330.31 5966,-6330.31 5966,-6374.31"/>
<text text-anchor="middle" x="5881.5" y="-6363.91" font-family="Arial" font-size="8.00">Expert 63 L10</text>
<text text-anchor="middle" x="5881.5" y="-6354.91" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-6345.91" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-6336.91" font-family="Arial" font-size="8.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2_l10&#45;&gt;expert_63_s2_l10 -->
<g id="edge791" class="edge">
<title>expert_dispatch_s2_l10&#45;&gt;expert_63_s2_l10</title>
<path fill="none" stroke="black" d="M3108.62,-6440.78C3579.98,-6441.58 5238.67,-6439.69 5787,-6374.35"/>
<polygon fill="black" stroke="black" points="5787.47,-6377.82 5796.98,-6373.14 5786.63,-6370.87 5787.47,-6377.82"/>
</g>
<!-- expert_combine_s2_l10 -->
<g id="node483" class="node">
<title>expert_combine_s2_l10</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-6263.2" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-6274.8" font-family="Arial" font-size="8.00">Expert Combine L10 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-6265.8" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-6256.8" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6247.8" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge792" class="edge">
<title>expert_32_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M169.02,-6331.48C171.88,-6331.05 174.71,-6330.66 177.5,-6330.31 702.97,-6265.44 2358.67,-6263.07 2846.17,-6263.83"/>
<polygon fill="black" stroke="black" points="2846.42,-6267.33 2856.42,-6263.85 2846.43,-6260.33 2846.42,-6267.33"/>
</g>
<!-- expert_33_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge793" class="edge">
<title>expert_33_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M356.02,-6331.48C358.88,-6331.05 361.71,-6330.66 364.5,-6330.31 851.71,-6269.75 2380.13,-6264.32 2846.21,-6264.1"/>
<polygon fill="black" stroke="black" points="2846.36,-6267.6 2856.36,-6264.1 2846.36,-6260.6 2846.36,-6267.6"/>
</g>
<!-- expert_34_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge794" class="edge">
<title>expert_34_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M543.02,-6331.49C545.88,-6331.06 548.71,-6330.66 551.5,-6330.31 1000.54,-6274.05 2402.24,-6265.66 2846.2,-6264.41"/>
<polygon fill="black" stroke="black" points="2846.52,-6267.91 2856.51,-6264.38 2846.5,-6260.91 2846.52,-6267.91"/>
</g>
<!-- expert_35_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge795" class="edge">
<title>expert_35_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M730.02,-6331.5C732.88,-6331.06 735.71,-6330.66 738.5,-6330.31 1149.63,-6278.33 2426.08,-6267.09 2846.61,-6264.77"/>
<polygon fill="black" stroke="black" points="2846.7,-6268.27 2856.69,-6264.72 2846.67,-6261.27 2846.7,-6268.27"/>
</g>
<!-- expert_36_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge796" class="edge">
<title>expert_36_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M917.03,-6331.51C919.88,-6331.07 922.71,-6330.67 925.5,-6330.31 1298.74,-6282.61 2450.22,-6268.65 2846.7,-6265.2"/>
<polygon fill="black" stroke="black" points="2846.81,-6268.7 2856.78,-6265.11 2846.75,-6261.7 2846.81,-6268.7"/>
</g>
<!-- expert_37_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge797" class="edge">
<title>expert_37_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M1104.03,-6331.52C1106.88,-6331.08 1109.71,-6330.67 1112.5,-6330.31 1447.94,-6286.9 2474.98,-6270.37 2846.54,-6265.71"/>
<polygon fill="black" stroke="black" points="2846.85,-6269.21 2856.8,-6265.58 2846.76,-6262.21 2846.85,-6269.21"/>
</g>
<!-- expert_38_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge798" class="edge">
<title>expert_38_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M1291.03,-6331.54C1293.88,-6331.09 1296.71,-6330.68 1299.5,-6330.31 1597.53,-6291.14 2502.38,-6272.25 2847.13,-6266.32"/>
<polygon fill="black" stroke="black" points="2847.23,-6269.82 2857.17,-6266.15 2847.11,-6262.82 2847.23,-6269.82"/>
</g>
<!-- expert_39_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge799" class="edge">
<title>expert_39_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M1478.03,-6331.55C1480.88,-6331.1 1483.71,-6330.68 1486.5,-6330.31 1747.22,-6295.4 2530.56,-6274.37 2847.35,-6267.09"/>
<polygon fill="black" stroke="black" points="2847.58,-6270.59 2857.5,-6266.86 2847.42,-6263.59 2847.58,-6270.59"/>
</g>
<!-- expert_40_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge800" class="edge">
<title>expert_40_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M1665.03,-6331.58C1667.88,-6331.12 1670.71,-6330.69 1673.5,-6330.31 2098.54,-6272.03 2607.53,-6263.73 2846.26,-6263.41"/>
<polygon fill="black" stroke="black" points="2846.39,-6266.91 2856.38,-6263.4 2846.38,-6259.91 2846.39,-6266.91"/>
</g>
<!-- expert_41_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge801" class="edge">
<title>expert_41_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M1852.04,-6331.61C1854.89,-6331.14 1857.71,-6330.71 1860.5,-6330.31 2213.6,-6280.38 2634.37,-6268.05 2846.24,-6265.08"/>
<polygon fill="black" stroke="black" points="2846.52,-6268.57 2856.48,-6264.94 2846.43,-6261.57 2846.52,-6268.57"/>
</g>
<!-- expert_42_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge802" class="edge">
<title>expert_42_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M2039.05,-6331.65C2041.89,-6331.17 2044.72,-6330.72 2047.5,-6330.31 2330.13,-6288.65 2664.83,-6273.04 2847.27,-6267.34"/>
<polygon fill="black" stroke="black" points="2847.57,-6270.83 2857.46,-6267.03 2847.35,-6263.84 2847.57,-6270.83"/>
</g>
<!-- expert_43_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge803" class="edge">
<title>expert_43_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M2226.05,-6331.71C2228.9,-6331.22 2231.72,-6330.75 2234.5,-6330.31 2448.23,-6296.89 2699.16,-6279.02 2849.26,-6270.58"/>
<polygon fill="black" stroke="black" points="2849.66,-6274.06 2859.45,-6270.01 2849.27,-6267.07 2849.66,-6274.06"/>
</g>
<!-- expert_44_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge804" class="edge">
<title>expert_44_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M2413.07,-6331.82C2415.91,-6331.29 2418.73,-6330.79 2421.5,-6330.31 2569.28,-6304.99 2740.64,-6286.33 2854.7,-6275.41"/>
<polygon fill="black" stroke="black" points="2855.24,-6278.88 2864.87,-6274.44 2854.58,-6271.91 2855.24,-6278.88"/>
</g>
<!-- expert_45_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge805" class="edge">
<title>expert_45_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M2600.11,-6332.03C2602.94,-6331.44 2605.74,-6330.87 2608.5,-6330.31 2695.55,-6312.8 2794.51,-6295.42 2868.76,-6282.87"/>
<polygon fill="black" stroke="black" points="2869.79,-6286.25 2879.07,-6281.14 2868.63,-6279.35 2869.79,-6286.25"/>
</g>
<!-- expert_46_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge806" class="edge">
<title>expert_46_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M2770.28,-6330.22C2808.19,-6318.43 2855.83,-6303.61 2896.36,-6291"/>
<polygon fill="black" stroke="black" points="2897.45,-6294.32 2905.96,-6288.01 2895.37,-6287.64 2897.45,-6294.32"/>
</g>
<!-- expert_47_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge807" class="edge">
<title>expert_47_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M2912.01,-6330.22C2921.53,-6321.3 2932.9,-6310.65 2943.7,-6300.54"/>
<polygon fill="black" stroke="black" points="2946.15,-6303.04 2951.06,-6293.65 2941.37,-6297.93 2946.15,-6303.04"/>
</g>
<!-- expert_48_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge808" class="edge">
<title>expert_48_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M3053.75,-6330.22C3044.12,-6321.3 3032.63,-6310.65 3021.71,-6300.54"/>
<polygon fill="black" stroke="black" points="3023.99,-6297.88 3014.28,-6293.65 3019.23,-6303.01 3023.99,-6297.88"/>
</g>
<!-- expert_49_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge809" class="edge">
<title>expert_49_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M3195.48,-6330.22C3157.36,-6318.41 3109.44,-6303.55 3068.71,-6290.92"/>
<polygon fill="black" stroke="black" points="3069.65,-6287.55 3059.06,-6287.93 3067.58,-6294.24 3069.65,-6287.55"/>
</g>
<!-- expert_50_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge810" class="edge">
<title>expert_50_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M3365.89,-6332.03C3363.06,-6331.44 3360.26,-6330.87 3357.5,-6330.31 3269.89,-6312.71 3170.24,-6295.26 3095.69,-6282.71"/>
<polygon fill="black" stroke="black" points="3096.25,-6279.26 3085.81,-6281.05 3095.09,-6286.16 3096.25,-6279.26"/>
</g>
<!-- expert_51_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge811" class="edge">
<title>expert_51_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M3552.93,-6331.82C3550.09,-6331.29 3547.27,-6330.79 3544.5,-6330.31 3396.34,-6304.94 3224.52,-6286.28 3110.26,-6275.37"/>
<polygon fill="black" stroke="black" points="3110.36,-6271.87 3100.07,-6274.41 3109.69,-6278.83 3110.36,-6271.87"/>
</g>
<!-- expert_52_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge812" class="edge">
<title>expert_52_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M3739.95,-6331.71C3737.1,-6331.22 3734.28,-6330.75 3731.5,-6330.31 3517.33,-6296.83 3265.85,-6278.97 3115.58,-6270.55"/>
<polygon fill="black" stroke="black" points="3115.57,-6267.04 3105.39,-6269.98 3115.18,-6274.03 3115.57,-6267.04"/>
</g>
<!-- expert_53_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge813" class="edge">
<title>expert_53_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M3926.96,-6331.65C3924.11,-6331.17 3921.28,-6330.72 3918.5,-6330.31 3635.57,-6288.62 3300.51,-6273.02 3117.87,-6267.33"/>
<polygon fill="black" stroke="black" points="3117.78,-6263.83 3107.68,-6267.02 3117.57,-6270.82 3117.78,-6263.83"/>
</g>
<!-- expert_54_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge814" class="edge">
<title>expert_54_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M4113.96,-6331.61C4111.11,-6331.14 4108.29,-6330.71 4105.5,-6330.31 3751.85,-6280.31 3330.37,-6268.01 3118.46,-6265.06"/>
<polygon fill="black" stroke="black" points="3118.26,-6261.56 3108.22,-6264.92 3118.17,-6268.56 3118.26,-6261.56"/>
</g>
<!-- expert_55_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge815" class="edge">
<title>expert_55_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M4300.97,-6331.58C4298.12,-6331.12 4295.29,-6330.69 4292.5,-6330.31 3867.13,-6271.99 3357.75,-6263.72 3118.84,-6263.4"/>
<polygon fill="black" stroke="black" points="3118.72,-6259.9 3108.71,-6263.39 3118.71,-6266.9 3118.72,-6259.9"/>
</g>
<!-- expert_56_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge816" class="edge">
<title>expert_56_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M4487.97,-6331.55C4485.12,-6331.1 4482.29,-6330.68 4479.5,-6330.31 4218.6,-6295.38 3434.74,-6274.36 3117.74,-6267.09"/>
<polygon fill="black" stroke="black" points="3117.66,-6263.59 3107.58,-6266.86 3117.5,-6270.58 3117.66,-6263.59"/>
</g>
<!-- expert_57_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge817" class="edge">
<title>expert_57_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M4674.97,-6331.54C4672.12,-6331.09 4669.29,-6330.68 4666.5,-6330.31 4368.29,-6291.12 3462.9,-6272.24 3117.95,-6266.32"/>
<polygon fill="black" stroke="black" points="3117.97,-6262.82 3107.91,-6266.15 3117.85,-6269.82 3117.97,-6262.82"/>
</g>
<!-- expert_58_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge818" class="edge">
<title>expert_58_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M4861.97,-6331.52C4859.12,-6331.08 4856.29,-6330.67 4853.5,-6330.31 4517.88,-6286.88 3490.29,-6270.36 3118.53,-6265.71"/>
<polygon fill="black" stroke="black" points="3118.31,-6262.2 3108.26,-6265.58 3118.22,-6269.2 3118.31,-6262.2"/>
</g>
<!-- expert_59_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge819" class="edge">
<title>expert_59_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M5048.97,-6331.51C5046.12,-6331.07 5043.29,-6330.67 5040.5,-6330.31 4667.07,-6282.59 3515.04,-6268.64 3118.36,-6265.2"/>
<polygon fill="black" stroke="black" points="3118.31,-6261.7 3108.28,-6265.11 3118.25,-6268.7 3118.31,-6261.7"/>
</g>
<!-- expert_60_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge820" class="edge">
<title>expert_60_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M5235.98,-6331.5C5233.12,-6331.06 5230.29,-6330.66 5227.5,-6330.31 4816.19,-6278.31 3539.17,-6267.08 3118.45,-6264.77"/>
<polygon fill="black" stroke="black" points="3118.39,-6261.27 3108.37,-6264.72 3118.35,-6268.27 3118.39,-6261.27"/>
</g>
<!-- expert_61_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge821" class="edge">
<title>expert_61_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M5422.98,-6331.49C5420.12,-6331.06 5417.29,-6330.66 5414.5,-6330.31 4965.28,-6274.03 3563,-6265.65 3118.86,-6264.41"/>
<polygon fill="black" stroke="black" points="3118.55,-6260.91 3108.54,-6264.38 3118.53,-6267.91 3118.55,-6260.91"/>
</g>
<!-- expert_62_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge822" class="edge">
<title>expert_62_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M5609.98,-6331.48C5607.12,-6331.05 5604.29,-6330.66 5601.5,-6330.31 5114.1,-6269.73 3585.1,-6264.31 3118.84,-6264.1"/>
<polygon fill="black" stroke="black" points="3118.69,-6260.6 3108.69,-6264.09 3118.69,-6267.6 3118.69,-6260.6"/>
</g>
<!-- expert_63_s2_l10&#45;&gt;expert_combine_s2_l10 -->
<g id="edge823" class="edge">
<title>expert_63_s2_l10&#45;&gt;expert_combine_s2_l10</title>
<path fill="none" stroke="black" d="M5796.98,-6331.48C5794.12,-6331.05 5791.29,-6330.66 5788.5,-6330.31 5262.84,-6265.42 3606.55,-6263.06 3118.88,-6263.83"/>
<polygon fill="black" stroke="black" points="3118.62,-6260.33 3108.62,-6263.85 3118.63,-6267.33 3118.62,-6260.33"/>
</g>
<!-- moe_out_proj_s2_l10 -->
<g id="node484" class="node">
<title>moe_out_proj_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-6196.09 2893.5,-6196.09 2893.5,-6152.09 3071.5,-6152.09 3071.5,-6196.09"/>
<text text-anchor="middle" x="2982.5" y="-6185.69" font-family="Arial" font-size="8.00">MoE Output Proj L10 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-6176.69" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6167.69" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6158.69" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2_l10&#45;&gt;moe_out_proj_s2_l10 -->
<g id="edge824" class="edge">
<title>expert_combine_s2_l10&#45;&gt;moe_out_proj_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-6231.73C2982.5,-6223.45 2982.5,-6214.48 2982.5,-6206.16"/>
<polygon fill="black" stroke="black" points="2986,-6206.09 2982.5,-6196.09 2979,-6206.09 2986,-6206.09"/>
</g>
<!-- allreduce_moe_out_s2_l10 -->
<g id="node485" class="node">
<title>allreduce_moe_out_s2_l10</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-6084.97" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-6096.57" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L10</text>
<text text-anchor="middle" x="2982.5" y="-6087.57" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6078.57" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-6069.57" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2_l10&#45;&gt;allreduce_moe_out_s2_l10 -->
<g id="edge825" class="edge">
<title>moe_out_proj_s2_l10&#45;&gt;allreduce_moe_out_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-6152C2982.5,-6144.33 2982.5,-6135.37 2982.5,-6126.58"/>
<polygon fill="black" stroke="black" points="2986,-6126.42 2982.5,-6116.42 2979,-6126.42 2986,-6126.42"/>
</g>
<!-- layernorm2_s2_l10 -->
<g id="node486" class="node">
<title>layernorm2_s2_l10</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-6017.86 2893.5,-6017.86 2893.5,-5973.86 3071.5,-5973.86 3071.5,-6017.86"/>
<text text-anchor="middle" x="2982.5" y="-6007.46" font-family="Arial" font-size="8.00">LayerNorm 2 (L10)</text>
<text text-anchor="middle" x="2982.5" y="-5998.46" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5989.46" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5980.46" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2_l10&#45;&gt;layernorm2_s2_l10 -->
<g id="edge826" class="edge">
<title>allreduce_moe_out_s2_l10&#45;&gt;layernorm2_s2_l10</title>
<path fill="none" stroke="black" d="M2982.5,-6053.51C2982.5,-6045.23 2982.5,-6036.25 2982.5,-6027.94"/>
<polygon fill="black" stroke="black" points="2986,-6027.86 2982.5,-6017.86 2979,-6027.86 2986,-6027.86"/>
</g>
<!-- layernorm1_s2_l11 -->
<g id="node487" class="node">
<title>layernorm1_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-5937.86 2893.5,-5937.86 2893.5,-5893.86 3071.5,-5893.86 3071.5,-5937.86"/>
<text text-anchor="middle" x="2982.5" y="-5927.46" font-family="Arial" font-size="8.00">LayerNorm 1 (L11)</text>
<text text-anchor="middle" x="2982.5" y="-5918.46" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5909.46" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5900.46" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm2_s2_l10&#45;&gt;layernorm1_s2_l11 -->
<g id="edge827" class="edge">
<title>layernorm2_s2_l10&#45;&gt;layernorm1_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-5973.55C2982.5,-5965.66 2982.5,-5956.54 2982.5,-5947.96"/>
<polygon fill="black" stroke="black" points="2986,-5947.88 2982.5,-5937.88 2979,-5947.88 2986,-5947.88"/>
</g>
<!-- qkv_proj_s2_l11 -->
<g id="node488" class="node">
<title>qkv_proj_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3081,-5857.86 2884,-5857.86 2884,-5813.86 3081,-5813.86 3081,-5857.86"/>
<text text-anchor="middle" x="2982.5" y="-5847.46" font-family="Arial" font-size="8.00">QKV Projection L11 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-5838.46" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5829.46" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-5820.46" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2_l11&#45;&gt;qkv_proj_s2_l11 -->
<g id="edge828" class="edge">
<title>layernorm1_s2_l11&#45;&gt;qkv_proj_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-5893.55C2982.5,-5885.66 2982.5,-5876.54 2982.5,-5867.96"/>
<polygon fill="black" stroke="black" points="2986,-5867.88 2982.5,-5857.88 2979,-5867.88 2986,-5867.88"/>
</g>
<!-- allreduce_qkv_s2_l11 -->
<g id="node489" class="node">
<title>allreduce_qkv_s2_l11</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-5746.75" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-5758.35" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L11</text>
<text text-anchor="middle" x="2982.5" y="-5749.35" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-5740.35" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-5731.35" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2_l11&#45;&gt;allreduce_qkv_s2_l11 -->
<g id="edge829" class="edge">
<title>qkv_proj_s2_l11&#45;&gt;allreduce_qkv_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-5813.77C2982.5,-5806.1 2982.5,-5797.15 2982.5,-5788.35"/>
<polygon fill="black" stroke="black" points="2986,-5788.19 2982.5,-5778.19 2979,-5788.19 2986,-5788.19"/>
</g>
<!-- attention_s2_l11 -->
<g id="node490" class="node">
<title>attention_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3081,-5679.63 2884,-5679.63 2884,-5635.63 3081,-5635.63 3081,-5679.63"/>
<text text-anchor="middle" x="2982.5" y="-5669.23" font-family="Arial" font-size="8.00">Self&#45;Attention L11</text>
<text text-anchor="middle" x="2982.5" y="-5660.23" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-5651.23" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-5642.23" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2_l11&#45;&gt;attention_s2_l11 -->
<g id="edge830" class="edge">
<title>allreduce_qkv_s2_l11&#45;&gt;attention_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-5715.28C2982.5,-5707 2982.5,-5698.03 2982.5,-5689.71"/>
<polygon fill="black" stroke="black" points="2986,-5689.64 2982.5,-5679.64 2979,-5689.64 2986,-5689.64"/>
</g>
<!-- attn_out_proj_s2_l11 -->
<g id="node491" class="node">
<title>attn_out_proj_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3078,-5599.63 2887,-5599.63 2887,-5555.63 3078,-5555.63 3078,-5599.63"/>
<text text-anchor="middle" x="2982.5" y="-5589.23" font-family="Arial" font-size="8.00">Attention Output Proj L11 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-5580.23" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-5571.23" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5562.23" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2_l11&#45;&gt;attn_out_proj_s2_l11 -->
<g id="edge831" class="edge">
<title>attention_s2_l11&#45;&gt;attn_out_proj_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-5635.32C2982.5,-5627.43 2982.5,-5618.32 2982.5,-5609.74"/>
<polygon fill="black" stroke="black" points="2986,-5609.65 2982.5,-5599.65 2979,-5609.65 2986,-5609.65"/>
</g>
<!-- allreduce_attn_out_s2_l11 -->
<g id="node492" class="node">
<title>allreduce_attn_out_s2_l11</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-5488.52" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-5500.12" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L11</text>
<text text-anchor="middle" x="2982.5" y="-5491.12" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5482.12" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5473.12" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2_l11&#45;&gt;allreduce_attn_out_s2_l11 -->
<g id="edge832" class="edge">
<title>attn_out_proj_s2_l11&#45;&gt;allreduce_attn_out_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-5555.55C2982.5,-5547.87 2982.5,-5538.92 2982.5,-5530.13"/>
<polygon fill="black" stroke="black" points="2986,-5529.97 2982.5,-5519.97 2979,-5529.97 2986,-5529.97"/>
</g>
<!-- moe_gate_s2_l11 -->
<g id="node493" class="node">
<title>moe_gate_s2_l11</title>
<polygon fill="orange" stroke="black" points="3167.08,-5421.41 2873.45,-5421.41 2797.92,-5333.41 3091.55,-5333.41 3167.08,-5421.41"/>
<text text-anchor="middle" x="2982.5" y="-5389.01" font-family="Arial" font-size="8.00">MoE Gate L11 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-5380.01" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5371.01" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5362.01" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2_l11&#45;&gt;moe_gate_s2_l11 -->
<g id="edge833" class="edge">
<title>allreduce_attn_out_s2_l11&#45;&gt;moe_gate_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-5457.13C2982.5,-5449.24 2982.5,-5440.51 2982.5,-5431.82"/>
<polygon fill="black" stroke="black" points="2986,-5431.69 2982.5,-5421.69 2979,-5431.69 2986,-5431.69"/>
</g>
<!-- expert_dispatch_s2_l11 -->
<g id="node494" class="node">
<title>expert_dispatch_s2_l11</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-5266.3" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-5277.9" font-family="Arial" font-size="8.00">Expert Dispatch L11 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-5268.9" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5259.9" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5250.9" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2_l11&#45;&gt;expert_dispatch_s2_l11 -->
<g id="edge834" class="edge">
<title>moe_gate_s2_l11&#45;&gt;expert_dispatch_s2_l11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-5333.29C2982.5,-5324.91 2982.5,-5316.16 2982.5,-5307.86"/>
<polygon fill="black" stroke="black" points="2986,-5307.67 2982.5,-5297.67 2979,-5307.67 2986,-5307.67"/>
</g>
<!-- expert_32_s2_l11 -->
<g id="node495" class="node">
<title>expert_32_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="169,-5199.18 0,-5199.18 0,-5155.18 169,-5155.18 169,-5199.18"/>
<text text-anchor="middle" x="84.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 32 L11</text>
<text text-anchor="middle" x="84.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_32_s2_l11 -->
<g id="edge835" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_32_s2_l11</title>
<path fill="none" stroke="black" d="M2856.42,-5265.65C2385.23,-5266.45 727.13,-5264.54 178.99,-5199.23"/>
<polygon fill="black" stroke="black" points="179.37,-5195.75 169.02,-5198.02 178.53,-5202.7 179.37,-5195.75"/>
</g>
<!-- expert_33_s2_l11 -->
<g id="node496" class="node">
<title>expert_33_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="356,-5199.18 187,-5199.18 187,-5155.18 356,-5155.18 356,-5199.18"/>
<text text-anchor="middle" x="271.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 33 L11</text>
<text text-anchor="middle" x="271.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_33_s2_l11 -->
<g id="edge836" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_33_s2_l11</title>
<path fill="none" stroke="black" d="M2856.36,-5265.4C2405.73,-5265.25 875.66,-5260.26 366.03,-5199.23"/>
<polygon fill="black" stroke="black" points="366.37,-5195.75 356.02,-5198.01 365.52,-5202.7 366.37,-5195.75"/>
</g>
<!-- expert_34_s2_l11 -->
<g id="node497" class="node">
<title>expert_34_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="543,-5199.18 374,-5199.18 374,-5155.18 543,-5155.18 543,-5199.18"/>
<text text-anchor="middle" x="458.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 34 L11</text>
<text text-anchor="middle" x="458.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_34_s2_l11 -->
<g id="edge837" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_34_s2_l11</title>
<path fill="none" stroke="black" d="M2856.51,-5265.11C2427.43,-5263.98 1024.14,-5256 552.96,-5199.23"/>
<polygon fill="black" stroke="black" points="553.38,-5195.75 543.02,-5198 552.52,-5202.7 553.38,-5195.75"/>
</g>
<!-- expert_35_s2_l11 -->
<g id="node498" class="node">
<title>expert_35_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="730,-5199.18 561,-5199.18 561,-5155.18 730,-5155.18 730,-5199.18"/>
<text text-anchor="middle" x="645.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 35 L11</text>
<text text-anchor="middle" x="645.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_35_s2_l11 -->
<g id="edge838" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_35_s2_l11</title>
<path fill="none" stroke="black" d="M2856.69,-5264.78C2450.07,-5262.6 1173.13,-5251.76 740.1,-5199.24"/>
<polygon fill="black" stroke="black" points="740.38,-5195.75 730.02,-5198 739.52,-5202.7 740.38,-5195.75"/>
</g>
<!-- expert_36_s2_l11 -->
<g id="node499" class="node">
<title>expert_36_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="917,-5199.18 748,-5199.18 748,-5155.18 917,-5155.18 917,-5199.18"/>
<text text-anchor="middle" x="832.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 36 L11</text>
<text text-anchor="middle" x="832.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_36_s2_l11 -->
<g id="edge839" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_36_s2_l11</title>
<path fill="none" stroke="black" d="M2856.78,-5264.38C2473.43,-5261.11 1321.87,-5247.53 927.06,-5199.24"/>
<polygon fill="black" stroke="black" points="927.38,-5195.75 917.03,-5197.99 926.51,-5202.7 927.38,-5195.75"/>
</g>
<!-- expert_37_s2_l11 -->
<g id="node500" class="node">
<title>expert_37_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="1104,-5199.18 935,-5199.18 935,-5155.18 1104,-5155.18 1104,-5199.18"/>
<text text-anchor="middle" x="1019.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 37 L11</text>
<text text-anchor="middle" x="1019.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_37_s2_l11 -->
<g id="edge840" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_37_s2_l11</title>
<path fill="none" stroke="black" d="M2856.8,-5263.91C2497.73,-5259.48 1470.88,-5243.32 1114.13,-5199.25"/>
<polygon fill="black" stroke="black" points="1114.39,-5195.76 1104.03,-5197.97 1113.51,-5202.7 1114.39,-5195.76"/>
</g>
<!-- expert_38_s2_l11 -->
<g id="node501" class="node">
<title>expert_38_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="1291,-5199.18 1122,-5199.18 1122,-5155.18 1291,-5155.18 1291,-5199.18"/>
<text text-anchor="middle" x="1206.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 38 L11</text>
<text text-anchor="middle" x="1206.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_38_s2_l11 -->
<g id="edge841" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_38_s2_l11</title>
<path fill="none" stroke="black" d="M2857.17,-5263.34C2523.91,-5257.68 1620.17,-5239.14 1301.21,-5199.27"/>
<polygon fill="black" stroke="black" points="1301.39,-5195.76 1291.03,-5197.96 1300.5,-5202.7 1301.39,-5195.76"/>
</g>
<!-- expert_39_s2_l11 -->
<g id="node502" class="node">
<title>expert_39_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="1478,-5199.18 1309,-5199.18 1309,-5155.18 1478,-5155.18 1478,-5199.18"/>
<text text-anchor="middle" x="1393.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 39 L11</text>
<text text-anchor="middle" x="1393.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_39_s2_l11 -->
<g id="edge842" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_39_s2_l11</title>
<path fill="none" stroke="black" d="M2857.5,-5262.64C2551.41,-5255.67 1769.45,-5234.99 1488.23,-5199.27"/>
<polygon fill="black" stroke="black" points="1488.4,-5195.77 1478.03,-5197.94 1487.49,-5202.71 1488.4,-5195.77"/>
</g>
<!-- expert_40_s2_l11 -->
<g id="node503" class="node">
<title>expert_40_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="1665,-5199.18 1496,-5199.18 1496,-5155.18 1665,-5155.18 1665,-5199.18"/>
<text text-anchor="middle" x="1580.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 40 L11</text>
<text text-anchor="middle" x="1580.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_40_s2_l11 -->
<g id="edge843" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_40_s2_l11</title>
<path fill="none" stroke="black" d="M2856.38,-5266.09C2623.94,-5265.99 2112.47,-5258.42 1675.03,-5199.28"/>
<polygon fill="black" stroke="black" points="1675.42,-5195.8 1665.03,-5197.92 1674.47,-5202.74 1675.42,-5195.8"/>
</g>
<!-- expert_41_s2_l11 -->
<g id="node504" class="node">
<title>expert_41_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="1852,-5199.18 1683,-5199.18 1683,-5155.18 1852,-5155.18 1852,-5199.18"/>
<text text-anchor="middle" x="1767.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 41 L11</text>
<text text-anchor="middle" x="1767.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_41_s2_l11 -->
<g id="edge844" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_41_s2_l11</title>
<path fill="none" stroke="black" d="M2856.48,-5264.56C2650.05,-5261.87 2227.11,-5250.14 1862.01,-5199.29"/>
<polygon fill="black" stroke="black" points="1862.43,-5195.81 1852.04,-5197.89 1861.45,-5202.75 1862.43,-5195.81"/>
</g>
<!-- expert_42_s2_l11 -->
<g id="node505" class="node">
<title>expert_42_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="2039,-5199.18 1870,-5199.18 1870,-5155.18 2039,-5155.18 2039,-5199.18"/>
<text text-anchor="middle" x="1954.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 42 L11</text>
<text text-anchor="middle" x="1954.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_42_s2_l11 -->
<g id="edge845" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_42_s2_l11</title>
<path fill="none" stroke="black" d="M2857.46,-5262.47C2679.53,-5257.1 2343.14,-5241.97 2049.05,-5199.31"/>
<polygon fill="black" stroke="black" points="2049.45,-5195.83 2039.05,-5197.85 2048.43,-5202.76 2049.45,-5195.83"/>
</g>
<!-- expert_43_s2_l11 -->
<g id="node506" class="node">
<title>expert_43_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="2226,-5199.18 2057,-5199.18 2057,-5155.18 2226,-5155.18 2226,-5199.18"/>
<text text-anchor="middle" x="2141.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 43 L11</text>
<text text-anchor="middle" x="2141.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_43_s2_l11 -->
<g id="edge846" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_43_s2_l11</title>
<path fill="none" stroke="black" d="M2859.45,-5259.48C2712.89,-5251.41 2460.66,-5233.9 2236.05,-5199.33"/>
<polygon fill="black" stroke="black" points="2236.47,-5195.86 2226.05,-5197.78 2235.4,-5202.78 2236.47,-5195.86"/>
</g>
<!-- expert_44_s2_l11 -->
<g id="node507" class="node">
<title>expert_44_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="2413,-5199.18 2244,-5199.18 2244,-5155.18 2413,-5155.18 2413,-5199.18"/>
<text text-anchor="middle" x="2328.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 44 L11</text>
<text text-anchor="middle" x="2328.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_44_s2_l11 -->
<g id="edge847" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_44_s2_l11</title>
<path fill="none" stroke="black" d="M2864.87,-5255.05C2753.34,-5244.5 2580.99,-5226.05 2422.98,-5199.36"/>
<polygon fill="black" stroke="black" points="2423.52,-5195.9 2413.07,-5197.68 2422.34,-5202.81 2423.52,-5195.9"/>
</g>
<!-- expert_45_s2_l11 -->
<g id="node508" class="node">
<title>expert_45_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="2600,-5199.18 2431,-5199.18 2431,-5155.18 2600,-5155.18 2600,-5199.18"/>
<text text-anchor="middle" x="2515.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 45 L11</text>
<text text-anchor="middle" x="2515.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_45_s2_l11 -->
<g id="edge848" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_45_s2_l11</title>
<path fill="none" stroke="black" d="M2879.07,-5248.36C2806.34,-5236.13 2706.53,-5218.72 2610.04,-5199.46"/>
<polygon fill="black" stroke="black" points="2610.6,-5196 2600.11,-5197.47 2609.23,-5202.87 2610.6,-5196"/>
</g>
<!-- expert_46_s2_l11 -->
<g id="node509" class="node">
<title>expert_46_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="2787,-5199.18 2618,-5199.18 2618,-5155.18 2787,-5155.18 2787,-5199.18"/>
<text text-anchor="middle" x="2702.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 46 L11</text>
<text text-anchor="middle" x="2702.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_46_s2_l11 -->
<g id="edge849" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_46_s2_l11</title>
<path fill="none" stroke="black" d="M2905.99,-5241.49C2866.88,-5229.33 2819.39,-5214.55 2780.12,-5202.33"/>
<polygon fill="black" stroke="black" points="2780.91,-5198.91 2770.32,-5199.29 2778.83,-5205.6 2780.91,-5198.91"/>
</g>
<!-- expert_47_s2_l11 -->
<g id="node510" class="node">
<title>expert_47_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="2974,-5199.18 2805,-5199.18 2805,-5155.18 2974,-5155.18 2974,-5199.18"/>
<text text-anchor="middle" x="2889.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 47 L11</text>
<text text-anchor="middle" x="2889.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_47_s2_l11 -->
<g id="edge850" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_47_s2_l11</title>
<path fill="none" stroke="black" d="M2951.27,-5236.05C2941.01,-5226.44 2929.64,-5215.78 2919.47,-5206.26"/>
<polygon fill="black" stroke="black" points="2921.66,-5203.52 2911.97,-5199.24 2916.88,-5208.63 2921.66,-5203.52"/>
</g>
<!-- expert_48_s2_l11 -->
<g id="node511" class="node">
<title>expert_48_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3161,-5199.18 2992,-5199.18 2992,-5155.18 3161,-5155.18 3161,-5199.18"/>
<text text-anchor="middle" x="3076.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 48 L11</text>
<text text-anchor="middle" x="3076.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_48_s2_l11 -->
<g id="edge851" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_48_s2_l11</title>
<path fill="none" stroke="black" d="M3014.06,-5236.05C3024.43,-5226.44 3035.93,-5215.78 3046.21,-5206.26"/>
<polygon fill="black" stroke="black" points="3048.83,-5208.6 3053.78,-5199.24 3044.07,-5203.47 3048.83,-5208.6"/>
</g>
<!-- expert_49_s2_l11 -->
<g id="node512" class="node">
<title>expert_49_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3348,-5199.18 3179,-5199.18 3179,-5155.18 3348,-5155.18 3348,-5199.18"/>
<text text-anchor="middle" x="3263.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 49 L11</text>
<text text-anchor="middle" x="3263.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_49_s2_l11 -->
<g id="edge852" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_49_s2_l11</title>
<path fill="none" stroke="black" d="M3059.28,-5241.49C3098.53,-5229.33 3146.2,-5214.55 3185.6,-5202.33"/>
<polygon fill="black" stroke="black" points="3186.92,-5205.59 3195.43,-5199.29 3184.84,-5198.9 3186.92,-5205.59"/>
</g>
<!-- expert_50_s2_l11 -->
<g id="node513" class="node">
<title>expert_50_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3535,-5199.18 3366,-5199.18 3366,-5155.18 3535,-5155.18 3535,-5199.18"/>
<text text-anchor="middle" x="3450.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 50 L11</text>
<text text-anchor="middle" x="3450.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_50_s2_l11 -->
<g id="edge853" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_50_s2_l11</title>
<path fill="none" stroke="black" d="M3085.81,-5248.44C3158.76,-5236.22 3259.03,-5218.78 3355.92,-5199.47"/>
<polygon fill="black" stroke="black" points="3356.77,-5202.87 3365.89,-5197.47 3355.4,-5196 3356.77,-5202.87"/>
</g>
<!-- expert_51_s2_l11 -->
<g id="node514" class="node">
<title>expert_51_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3722,-5199.18 3553,-5199.18 3553,-5155.18 3722,-5155.18 3722,-5199.18"/>
<text text-anchor="middle" x="3637.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 51 L11</text>
<text text-anchor="middle" x="3637.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_51_s2_l11 -->
<g id="edge854" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_51_s2_l11</title>
<path fill="none" stroke="black" d="M3100.07,-5255.09C3211.79,-5244.56 3384.6,-5226.1 3543,-5199.37"/>
<polygon fill="black" stroke="black" points="3543.66,-5202.8 3552.93,-5197.68 3542.48,-5195.9 3543.66,-5202.8"/>
</g>
<!-- expert_52_s2_l11 -->
<g id="node515" class="node">
<title>expert_52_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3909,-5199.18 3740,-5199.18 3740,-5155.18 3909,-5155.18 3909,-5199.18"/>
<text text-anchor="middle" x="3824.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 52 L11</text>
<text text-anchor="middle" x="3824.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_52_s2_l11 -->
<g id="edge855" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_52_s2_l11</title>
<path fill="none" stroke="black" d="M3105.39,-5259.51C3252.09,-5251.46 3504.87,-5233.95 3729.93,-5199.34"/>
<polygon fill="black" stroke="black" points="3730.6,-5202.77 3739.95,-5197.78 3729.53,-5195.86 3730.6,-5202.77"/>
</g>
<!-- expert_53_s2_l11 -->
<g id="node516" class="node">
<title>expert_53_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="4096,-5199.18 3927,-5199.18 3927,-5155.18 4096,-5155.18 4096,-5199.18"/>
<text text-anchor="middle" x="4011.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 53 L11</text>
<text text-anchor="middle" x="4011.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_53_s2_l11 -->
<g id="edge856" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_53_s2_l11</title>
<path fill="none" stroke="black" d="M3107.68,-5262.48C3285.8,-5257.12 3622.55,-5242.01 3916.94,-5199.31"/>
<polygon fill="black" stroke="black" points="3917.57,-5202.76 3926.96,-5197.85 3916.55,-5195.83 3917.57,-5202.76"/>
</g>
<!-- expert_54_s2_l11 -->
<g id="node517" class="node">
<title>expert_54_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="4283,-5199.18 4114,-5199.18 4114,-5155.18 4283,-5155.18 4283,-5199.18"/>
<text text-anchor="middle" x="4198.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 54 L11</text>
<text text-anchor="middle" x="4198.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_54_s2_l11 -->
<g id="edge857" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_54_s2_l11</title>
<path fill="none" stroke="black" d="M3108.22,-5264.57C3314.67,-5261.9 3738.31,-5250.21 4103.98,-5199.29"/>
<polygon fill="black" stroke="black" points="4104.55,-5202.75 4113.96,-5197.89 4103.57,-5195.81 4104.55,-5202.75"/>
</g>
<!-- expert_55_s2_l11 -->
<g id="node518" class="node">
<title>expert_55_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="4470,-5199.18 4301,-5199.18 4301,-5155.18 4470,-5155.18 4470,-5199.18"/>
<text text-anchor="middle" x="4385.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 55 L11</text>
<text text-anchor="middle" x="4385.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_55_s2_l11 -->
<g id="edge858" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_55_s2_l11</title>
<path fill="none" stroke="black" d="M3108.71,-5266.1C3341.33,-5266.01 3853.2,-5258.46 4290.96,-5199.28"/>
<polygon fill="black" stroke="black" points="4291.53,-5202.74 4300.97,-5197.92 4290.58,-5195.8 4291.53,-5202.74"/>
</g>
<!-- expert_56_s2_l11 -->
<g id="node519" class="node">
<title>expert_56_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="4657,-5199.18 4488,-5199.18 4488,-5155.18 4657,-5155.18 4657,-5199.18"/>
<text text-anchor="middle" x="4572.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 56 L11</text>
<text text-anchor="middle" x="4572.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_56_s2_l11 -->
<g id="edge859" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_56_s2_l11</title>
<path fill="none" stroke="black" d="M3107.58,-5262.64C3413.87,-5255.68 4196.36,-5235.01 4477.77,-5199.27"/>
<polygon fill="black" stroke="black" points="4478.51,-5202.71 4487.97,-5197.94 4477.6,-5195.77 4478.51,-5202.71"/>
</g>
<!-- expert_57_s2_l11 -->
<g id="node520" class="node">
<title>expert_57_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="4844,-5199.18 4675,-5199.18 4675,-5155.18 4844,-5155.18 4844,-5199.18"/>
<text text-anchor="middle" x="4759.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 57 L11</text>
<text text-anchor="middle" x="4759.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_57_s2_l11 -->
<g id="edge860" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_57_s2_l11</title>
<path fill="none" stroke="black" d="M3107.91,-5263.35C3441.37,-5257.69 4345.64,-5239.16 4664.78,-5199.27"/>
<polygon fill="black" stroke="black" points="4665.5,-5202.7 4674.97,-5197.96 4664.61,-5195.76 4665.5,-5202.7"/>
</g>
<!-- expert_58_s2_l11 -->
<g id="node521" class="node">
<title>expert_58_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="5031,-5199.18 4862,-5199.18 4862,-5155.18 5031,-5155.18 5031,-5199.18"/>
<text text-anchor="middle" x="4946.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 58 L11</text>
<text text-anchor="middle" x="4946.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_58_s2_l11 -->
<g id="edge861" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_58_s2_l11</title>
<path fill="none" stroke="black" d="M3108.26,-5263.91C3467.53,-5259.49 4494.93,-5243.34 4851.87,-5199.25"/>
<polygon fill="black" stroke="black" points="4852.49,-5202.7 4861.97,-5197.97 4851.61,-5195.76 4852.49,-5202.7"/>
</g>
<!-- expert_59_s2_l11 -->
<g id="node522" class="node">
<title>expert_59_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="5218,-5199.18 5049,-5199.18 5049,-5155.18 5218,-5155.18 5218,-5199.18"/>
<text text-anchor="middle" x="5133.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 59 L11</text>
<text text-anchor="middle" x="5133.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_59_s2_l11 -->
<g id="edge862" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_59_s2_l11</title>
<path fill="none" stroke="black" d="M3108.28,-5264.39C3491.82,-5261.12 4643.94,-5247.55 5038.93,-5199.24"/>
<polygon fill="black" stroke="black" points="5039.49,-5202.7 5048.97,-5197.99 5038.62,-5195.75 5039.49,-5202.7"/>
</g>
<!-- expert_60_s2_l11 -->
<g id="node523" class="node">
<title>expert_60_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="5405,-5199.18 5236,-5199.18 5236,-5155.18 5405,-5155.18 5405,-5199.18"/>
<text text-anchor="middle" x="5320.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 60 L11</text>
<text text-anchor="middle" x="5320.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_60_s2_l11 -->
<g id="edge863" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_60_s2_l11</title>
<path fill="none" stroke="black" d="M3108.37,-5264.78C3515.16,-5262.61 4792.68,-5251.78 5225.9,-5199.24"/>
<polygon fill="black" stroke="black" points="5226.48,-5202.7 5235.98,-5198 5225.62,-5195.75 5226.48,-5202.7"/>
</g>
<!-- expert_61_s2_l11 -->
<g id="node524" class="node">
<title>expert_61_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="5592,-5199.18 5423,-5199.18 5423,-5155.18 5592,-5155.18 5592,-5199.18"/>
<text text-anchor="middle" x="5507.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 61 L11</text>
<text text-anchor="middle" x="5507.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_61_s2_l11 -->
<g id="edge864" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_61_s2_l11</title>
<path fill="none" stroke="black" d="M3108.54,-5265.11C3537.8,-5263.98 4941.67,-5256.02 5413.04,-5199.23"/>
<polygon fill="black" stroke="black" points="5413.48,-5202.7 5422.98,-5198 5412.62,-5195.75 5413.48,-5202.7"/>
</g>
<!-- expert_62_s2_l11 -->
<g id="node525" class="node">
<title>expert_62_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="5779,-5199.18 5610,-5199.18 5610,-5155.18 5779,-5155.18 5779,-5199.18"/>
<text text-anchor="middle" x="5694.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 62 L11</text>
<text text-anchor="middle" x="5694.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_62_s2_l11 -->
<g id="edge865" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_62_s2_l11</title>
<path fill="none" stroke="black" d="M3108.69,-5265.4C3559.49,-5265.26 5090.14,-5260.28 5599.96,-5199.23"/>
<polygon fill="black" stroke="black" points="5600.48,-5202.7 5609.98,-5198.01 5599.63,-5195.75 5600.48,-5202.7"/>
</g>
<!-- expert_63_s2_l11 -->
<g id="node526" class="node">
<title>expert_63_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="5966,-5199.18 5797,-5199.18 5797,-5155.18 5966,-5155.18 5966,-5199.18"/>
<text text-anchor="middle" x="5881.5" y="-5188.78" font-family="Arial" font-size="8.00">Expert 63 L11</text>
<text text-anchor="middle" x="5881.5" y="-5179.78" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-5170.78" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-5161.78" font-family="Arial" font-size="8.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2_l11&#45;&gt;expert_63_s2_l11 -->
<g id="edge866" class="edge">
<title>expert_dispatch_s2_l11&#45;&gt;expert_63_s2_l11</title>
<path fill="none" stroke="black" d="M3108.62,-5265.65C3579.98,-5266.46 5238.67,-5264.56 5787,-5199.23"/>
<polygon fill="black" stroke="black" points="5787.47,-5202.7 5796.98,-5198.02 5786.63,-5195.75 5787.47,-5202.7"/>
</g>
<!-- expert_combine_s2_l11 -->
<g id="node527" class="node">
<title>expert_combine_s2_l11</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-5088.07" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-5099.67" font-family="Arial" font-size="8.00">Expert Combine L11 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-5090.67" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-5081.67" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-5072.67" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge867" class="edge">
<title>expert_32_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M169.02,-5156.35C171.88,-5155.92 174.71,-5155.53 177.5,-5155.18 702.97,-5090.32 2358.67,-5087.94 2846.17,-5088.7"/>
<polygon fill="black" stroke="black" points="2846.42,-5092.2 2856.42,-5088.72 2846.43,-5085.2 2846.42,-5092.2"/>
</g>
<!-- expert_33_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge868" class="edge">
<title>expert_33_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M356.02,-5156.36C358.88,-5155.92 361.71,-5155.53 364.5,-5155.18 851.71,-5094.62 2380.13,-5089.19 2846.21,-5088.97"/>
<polygon fill="black" stroke="black" points="2846.36,-5092.47 2856.36,-5088.97 2846.36,-5085.47 2846.36,-5092.47"/>
</g>
<!-- expert_34_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge869" class="edge">
<title>expert_34_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M543.02,-5156.36C545.88,-5155.93 548.71,-5155.53 551.5,-5155.18 1000.54,-5098.93 2402.24,-5090.53 2846.2,-5089.28"/>
<polygon fill="black" stroke="black" points="2846.52,-5092.78 2856.51,-5089.26 2846.5,-5085.78 2846.52,-5092.78"/>
</g>
<!-- expert_35_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge870" class="edge">
<title>expert_35_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M730.02,-5156.37C732.88,-5155.94 735.71,-5155.54 738.5,-5155.18 1149.63,-5103.2 2426.08,-5091.96 2846.61,-5089.65"/>
<polygon fill="black" stroke="black" points="2846.7,-5093.14 2856.69,-5089.59 2846.67,-5086.14 2846.7,-5093.14"/>
</g>
<!-- expert_36_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge871" class="edge">
<title>expert_36_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M917.03,-5156.38C919.88,-5155.94 922.71,-5155.54 925.5,-5155.18 1298.74,-5107.49 2450.22,-5093.52 2846.7,-5090.07"/>
<polygon fill="black" stroke="black" points="2846.81,-5093.57 2856.78,-5089.98 2846.75,-5086.57 2846.81,-5093.57"/>
</g>
<!-- expert_37_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge872" class="edge">
<title>expert_37_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M1104.03,-5156.39C1106.88,-5155.95 1109.71,-5155.55 1112.5,-5155.18 1447.94,-5111.77 2474.98,-5095.24 2846.54,-5090.58"/>
<polygon fill="black" stroke="black" points="2846.85,-5094.08 2856.8,-5090.46 2846.76,-5087.08 2846.85,-5094.08"/>
</g>
<!-- expert_38_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge873" class="edge">
<title>expert_38_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M1291.03,-5156.41C1293.88,-5155.96 1296.71,-5155.55 1299.5,-5155.18 1597.53,-5116.02 2502.38,-5097.12 2847.13,-5091.2"/>
<polygon fill="black" stroke="black" points="2847.23,-5094.69 2857.17,-5091.02 2847.11,-5087.7 2847.23,-5094.69"/>
</g>
<!-- expert_39_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge874" class="edge">
<title>expert_39_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M1478.03,-5156.43C1480.88,-5155.97 1483.71,-5155.56 1486.5,-5155.18 1747.22,-5120.27 2530.56,-5099.24 2847.35,-5091.96"/>
<polygon fill="black" stroke="black" points="2847.58,-5095.46 2857.5,-5091.73 2847.42,-5088.46 2847.58,-5095.46"/>
</g>
<!-- expert_40_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge875" class="edge">
<title>expert_40_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M1665.03,-5156.45C1667.88,-5155.99 1670.71,-5155.57 1673.5,-5155.18 2098.54,-5096.9 2607.53,-5088.61 2846.26,-5088.28"/>
<polygon fill="black" stroke="black" points="2846.39,-5091.78 2856.38,-5088.27 2846.38,-5084.78 2846.39,-5091.78"/>
</g>
<!-- expert_41_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge876" class="edge">
<title>expert_41_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M1852.04,-5156.48C1854.89,-5156.01 1857.71,-5155.58 1860.5,-5155.18 2213.6,-5105.26 2634.37,-5092.92 2846.24,-5089.95"/>
<polygon fill="black" stroke="black" points="2846.52,-5093.45 2856.48,-5089.81 2846.43,-5086.45 2846.52,-5093.45"/>
</g>
<!-- expert_42_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge877" class="edge">
<title>expert_42_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M2039.05,-5156.52C2041.89,-5156.04 2044.72,-5155.59 2047.5,-5155.18 2330.13,-5113.53 2664.83,-5097.91 2847.27,-5092.21"/>
<polygon fill="black" stroke="black" points="2847.57,-5095.71 2857.46,-5091.9 2847.35,-5088.71 2847.57,-5095.71"/>
</g>
<!-- expert_43_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge878" class="edge">
<title>expert_43_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M2226.05,-5156.59C2228.9,-5156.09 2231.72,-5155.62 2234.5,-5155.18 2448.23,-5121.76 2699.16,-5103.89 2849.26,-5095.45"/>
<polygon fill="black" stroke="black" points="2849.66,-5098.94 2859.45,-5094.89 2849.27,-5091.95 2849.66,-5098.94"/>
</g>
<!-- expert_44_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge879" class="edge">
<title>expert_44_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M2413.07,-5156.69C2415.91,-5156.16 2418.73,-5155.66 2421.5,-5155.18 2569.28,-5129.86 2740.64,-5111.21 2854.7,-5100.28"/>
<polygon fill="black" stroke="black" points="2855.24,-5103.75 2864.87,-5099.32 2854.58,-5096.78 2855.24,-5103.75"/>
</g>
<!-- expert_45_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge880" class="edge">
<title>expert_45_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M2600.11,-5156.9C2602.94,-5156.31 2605.74,-5155.74 2608.5,-5155.18 2695.55,-5137.67 2794.51,-5120.29 2868.76,-5107.75"/>
<polygon fill="black" stroke="black" points="2869.79,-5111.12 2879.07,-5106.01 2868.63,-5104.22 2869.79,-5111.12"/>
</g>
<!-- expert_46_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge881" class="edge">
<title>expert_46_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M2770.28,-5155.1C2808.19,-5143.3 2855.83,-5128.48 2896.36,-5115.87"/>
<polygon fill="black" stroke="black" points="2897.45,-5119.2 2905.96,-5112.88 2895.37,-5112.51 2897.45,-5119.2"/>
</g>
<!-- expert_47_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge882" class="edge">
<title>expert_47_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M2912.01,-5155.1C2921.53,-5146.18 2932.9,-5135.53 2943.7,-5125.41"/>
<polygon fill="black" stroke="black" points="2946.15,-5127.91 2951.06,-5118.52 2941.37,-5122.8 2946.15,-5127.91"/>
</g>
<!-- expert_48_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge883" class="edge">
<title>expert_48_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M3053.75,-5155.1C3044.12,-5146.18 3032.63,-5135.53 3021.71,-5125.41"/>
<polygon fill="black" stroke="black" points="3023.99,-5122.75 3014.28,-5118.52 3019.23,-5127.89 3023.99,-5122.75"/>
</g>
<!-- expert_49_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge884" class="edge">
<title>expert_49_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M3195.48,-5155.1C3157.36,-5143.28 3109.44,-5128.42 3068.71,-5115.8"/>
<polygon fill="black" stroke="black" points="3069.65,-5112.42 3059.06,-5112.81 3067.58,-5119.11 3069.65,-5112.42"/>
</g>
<!-- expert_50_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge885" class="edge">
<title>expert_50_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M3365.89,-5156.9C3363.06,-5156.31 3360.26,-5155.74 3357.5,-5155.18 3269.89,-5137.58 3170.24,-5120.13 3095.69,-5107.59"/>
<polygon fill="black" stroke="black" points="3096.25,-5104.13 3085.81,-5105.93 3095.09,-5111.03 3096.25,-5104.13"/>
</g>
<!-- expert_51_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge886" class="edge">
<title>expert_51_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M3552.93,-5156.69C3550.09,-5156.16 3547.27,-5155.66 3544.5,-5155.18 3396.34,-5129.81 3224.52,-5111.15 3110.26,-5100.24"/>
<polygon fill="black" stroke="black" points="3110.36,-5096.74 3100.07,-5099.28 3109.69,-5103.71 3110.36,-5096.74"/>
</g>
<!-- expert_52_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge887" class="edge">
<title>expert_52_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M3739.95,-5156.59C3737.1,-5156.09 3734.28,-5155.62 3731.5,-5155.18 3517.33,-5121.71 3265.85,-5103.84 3115.58,-5095.42"/>
<polygon fill="black" stroke="black" points="3115.57,-5091.92 3105.39,-5094.86 3115.18,-5098.9 3115.57,-5091.92"/>
</g>
<!-- expert_53_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge888" class="edge">
<title>expert_53_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M3926.96,-5156.52C3924.11,-5156.04 3921.28,-5155.59 3918.5,-5155.18 3635.57,-5113.49 3300.51,-5097.89 3117.87,-5092.2"/>
<polygon fill="black" stroke="black" points="3117.78,-5088.7 3107.68,-5091.89 3117.57,-5095.7 3117.78,-5088.7"/>
</g>
<!-- expert_54_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge889" class="edge">
<title>expert_54_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M4113.96,-5156.48C4111.11,-5156.01 4108.29,-5155.58 4105.5,-5155.18 3751.85,-5105.19 3330.37,-5092.88 3118.46,-5089.93"/>
<polygon fill="black" stroke="black" points="3118.26,-5086.43 3108.22,-5089.8 3118.17,-5093.43 3118.26,-5086.43"/>
</g>
<!-- expert_55_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge890" class="edge">
<title>expert_55_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M4300.97,-5156.45C4298.12,-5155.99 4295.29,-5155.57 4292.5,-5155.18 3867.13,-5096.86 3357.75,-5088.59 3118.84,-5088.28"/>
<polygon fill="black" stroke="black" points="3118.72,-5084.78 3108.71,-5088.27 3118.71,-5091.78 3118.72,-5084.78"/>
</g>
<!-- expert_56_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge891" class="edge">
<title>expert_56_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M4487.97,-5156.43C4485.12,-5155.97 4482.29,-5155.56 4479.5,-5155.18 4218.6,-5120.25 3434.74,-5099.23 3117.74,-5091.96"/>
<polygon fill="black" stroke="black" points="3117.66,-5088.46 3107.58,-5091.73 3117.5,-5095.46 3117.66,-5088.46"/>
</g>
<!-- expert_57_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge892" class="edge">
<title>expert_57_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M4674.97,-5156.41C4672.12,-5155.96 4669.29,-5155.55 4666.5,-5155.18 4368.29,-5116 3462.9,-5097.11 3117.95,-5091.19"/>
<polygon fill="black" stroke="black" points="3117.97,-5087.69 3107.91,-5091.02 3117.85,-5094.69 3117.97,-5087.69"/>
</g>
<!-- expert_58_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge893" class="edge">
<title>expert_58_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M4861.97,-5156.39C4859.12,-5155.95 4856.29,-5155.55 4853.5,-5155.18 4517.88,-5111.75 3490.29,-5095.23 3118.53,-5090.58"/>
<polygon fill="black" stroke="black" points="3118.31,-5087.08 3108.26,-5090.45 3118.22,-5094.08 3118.31,-5087.08"/>
</g>
<!-- expert_59_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge894" class="edge">
<title>expert_59_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M5048.97,-5156.38C5046.12,-5155.94 5043.29,-5155.54 5040.5,-5155.18 4667.07,-5107.47 3515.04,-5093.52 3118.36,-5090.07"/>
<polygon fill="black" stroke="black" points="3118.31,-5086.57 3108.28,-5089.98 3118.25,-5093.57 3118.31,-5086.57"/>
</g>
<!-- expert_60_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge895" class="edge">
<title>expert_60_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M5235.98,-5156.37C5233.12,-5155.94 5230.29,-5155.54 5227.5,-5155.18 4816.19,-5103.18 3539.17,-5091.95 3118.45,-5089.64"/>
<polygon fill="black" stroke="black" points="3118.39,-5086.14 3108.37,-5089.59 3118.35,-5093.14 3118.39,-5086.14"/>
</g>
<!-- expert_61_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge896" class="edge">
<title>expert_61_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M5422.98,-5156.36C5420.12,-5155.93 5417.29,-5155.53 5414.5,-5155.18 4965.28,-5098.91 3563,-5090.52 3118.86,-5089.28"/>
<polygon fill="black" stroke="black" points="3118.55,-5085.78 3108.54,-5089.26 3118.53,-5092.78 3118.55,-5085.78"/>
</g>
<!-- expert_62_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge897" class="edge">
<title>expert_62_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M5609.98,-5156.36C5607.12,-5155.92 5604.29,-5155.53 5601.5,-5155.18 5114.1,-5094.6 3585.1,-5089.18 3118.84,-5088.97"/>
<polygon fill="black" stroke="black" points="3118.69,-5085.47 3108.69,-5088.97 3118.69,-5092.47 3118.69,-5085.47"/>
</g>
<!-- expert_63_s2_l11&#45;&gt;expert_combine_s2_l11 -->
<g id="edge898" class="edge">
<title>expert_63_s2_l11&#45;&gt;expert_combine_s2_l11</title>
<path fill="none" stroke="black" d="M5796.98,-5156.35C5794.12,-5155.92 5791.29,-5155.53 5788.5,-5155.18 5262.84,-5090.3 3606.55,-5087.94 3118.88,-5088.7"/>
<polygon fill="black" stroke="black" points="3118.62,-5085.2 3108.62,-5088.72 3118.63,-5092.2 3118.62,-5085.2"/>
</g>
<!-- moe_out_proj_s2_l11 -->
<g id="node528" class="node">
<title>moe_out_proj_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-5020.96 2893.5,-5020.96 2893.5,-4976.96 3071.5,-4976.96 3071.5,-5020.96"/>
<text text-anchor="middle" x="2982.5" y="-5010.56" font-family="Arial" font-size="8.00">MoE Output Proj L11 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-5001.56" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4992.56" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4983.56" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2_l11&#45;&gt;moe_out_proj_s2_l11 -->
<g id="edge899" class="edge">
<title>expert_combine_s2_l11&#45;&gt;moe_out_proj_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-5056.6C2982.5,-5048.32 2982.5,-5039.35 2982.5,-5031.04"/>
<polygon fill="black" stroke="black" points="2986,-5030.96 2982.5,-5020.96 2979,-5030.96 2986,-5030.96"/>
</g>
<!-- allreduce_moe_out_s2_l11 -->
<g id="node529" class="node">
<title>allreduce_moe_out_s2_l11</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-4909.85" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-4921.45" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L11</text>
<text text-anchor="middle" x="2982.5" y="-4912.45" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4903.45" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4894.45" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2_l11&#45;&gt;allreduce_moe_out_s2_l11 -->
<g id="edge900" class="edge">
<title>moe_out_proj_s2_l11&#45;&gt;allreduce_moe_out_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-4976.87C2982.5,-4969.2 2982.5,-4960.24 2982.5,-4951.45"/>
<polygon fill="black" stroke="black" points="2986,-4951.29 2982.5,-4941.29 2979,-4951.29 2986,-4951.29"/>
</g>
<!-- layernorm2_s2_l11 -->
<g id="node530" class="node">
<title>layernorm2_s2_l11</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-4842.73 2893.5,-4842.73 2893.5,-4798.73 3071.5,-4798.73 3071.5,-4842.73"/>
<text text-anchor="middle" x="2982.5" y="-4832.33" font-family="Arial" font-size="8.00">LayerNorm 2 (L11)</text>
<text text-anchor="middle" x="2982.5" y="-4823.33" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4814.33" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4805.33" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2_l11&#45;&gt;layernorm2_s2_l11 -->
<g id="edge901" class="edge">
<title>allreduce_moe_out_s2_l11&#45;&gt;layernorm2_s2_l11</title>
<path fill="none" stroke="black" d="M2982.5,-4878.38C2982.5,-4870.1 2982.5,-4861.12 2982.5,-4852.81"/>
<polygon fill="black" stroke="black" points="2986,-4852.74 2982.5,-4842.74 2979,-4852.74 2986,-4852.74"/>
</g>
<!-- layernorm1_s2_l12 -->
<g id="node531" class="node">
<title>layernorm1_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-4762.73 2893.5,-4762.73 2893.5,-4718.73 3071.5,-4718.73 3071.5,-4762.73"/>
<text text-anchor="middle" x="2982.5" y="-4752.33" font-family="Arial" font-size="8.00">LayerNorm 1 (L12)</text>
<text text-anchor="middle" x="2982.5" y="-4743.33" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4734.33" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4725.33" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm2_s2_l11&#45;&gt;layernorm1_s2_l12 -->
<g id="edge902" class="edge">
<title>layernorm2_s2_l11&#45;&gt;layernorm1_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-4798.42C2982.5,-4790.53 2982.5,-4781.42 2982.5,-4772.84"/>
<polygon fill="black" stroke="black" points="2986,-4772.75 2982.5,-4762.75 2979,-4772.75 2986,-4772.75"/>
</g>
<!-- qkv_proj_s2_l12 -->
<g id="node532" class="node">
<title>qkv_proj_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3081,-4682.73 2884,-4682.73 2884,-4638.73 3081,-4638.73 3081,-4682.73"/>
<text text-anchor="middle" x="2982.5" y="-4672.33" font-family="Arial" font-size="8.00">QKV Projection L12 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-4663.33" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4654.33" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-4645.33" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2_l12&#45;&gt;qkv_proj_s2_l12 -->
<g id="edge903" class="edge">
<title>layernorm1_s2_l12&#45;&gt;qkv_proj_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-4718.42C2982.5,-4710.53 2982.5,-4701.42 2982.5,-4692.84"/>
<polygon fill="black" stroke="black" points="2986,-4692.75 2982.5,-4682.75 2979,-4692.75 2986,-4692.75"/>
</g>
<!-- allreduce_qkv_s2_l12 -->
<g id="node533" class="node">
<title>allreduce_qkv_s2_l12</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-4571.62" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-4583.22" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L12</text>
<text text-anchor="middle" x="2982.5" y="-4574.22" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-4565.22" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-4556.22" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2_l12&#45;&gt;allreduce_qkv_s2_l12 -->
<g id="edge904" class="edge">
<title>qkv_proj_s2_l12&#45;&gt;allreduce_qkv_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-4638.65C2982.5,-4630.97 2982.5,-4622.02 2982.5,-4613.23"/>
<polygon fill="black" stroke="black" points="2986,-4613.07 2982.5,-4603.07 2979,-4613.07 2986,-4613.07"/>
</g>
<!-- attention_s2_l12 -->
<g id="node534" class="node">
<title>attention_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3081,-4504.51 2884,-4504.51 2884,-4460.51 3081,-4460.51 3081,-4504.51"/>
<text text-anchor="middle" x="2982.5" y="-4494.11" font-family="Arial" font-size="8.00">Self&#45;Attention L12</text>
<text text-anchor="middle" x="2982.5" y="-4485.11" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-4476.11" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-4467.11" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2_l12&#45;&gt;attention_s2_l12 -->
<g id="edge905" class="edge">
<title>allreduce_qkv_s2_l12&#45;&gt;attention_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-4540.15C2982.5,-4531.87 2982.5,-4522.9 2982.5,-4514.59"/>
<polygon fill="black" stroke="black" points="2986,-4514.51 2982.5,-4504.51 2979,-4514.51 2986,-4514.51"/>
</g>
<!-- attn_out_proj_s2_l12 -->
<g id="node535" class="node">
<title>attn_out_proj_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3078,-4424.51 2887,-4424.51 2887,-4380.51 3078,-4380.51 3078,-4424.51"/>
<text text-anchor="middle" x="2982.5" y="-4414.11" font-family="Arial" font-size="8.00">Attention Output Proj L12 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-4405.11" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-4396.11" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4387.11" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2_l12&#45;&gt;attn_out_proj_s2_l12 -->
<g id="edge906" class="edge">
<title>attention_s2_l12&#45;&gt;attn_out_proj_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-4460.19C2982.5,-4452.31 2982.5,-4443.19 2982.5,-4434.61"/>
<polygon fill="black" stroke="black" points="2986,-4434.53 2982.5,-4424.53 2979,-4434.53 2986,-4434.53"/>
</g>
<!-- allreduce_attn_out_s2_l12 -->
<g id="node536" class="node">
<title>allreduce_attn_out_s2_l12</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-4313.4" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-4325" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L12</text>
<text text-anchor="middle" x="2982.5" y="-4316" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4307" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4298" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2_l12&#45;&gt;allreduce_attn_out_s2_l12 -->
<g id="edge907" class="edge">
<title>attn_out_proj_s2_l12&#45;&gt;allreduce_attn_out_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-4380.42C2982.5,-4372.75 2982.5,-4363.79 2982.5,-4355"/>
<polygon fill="black" stroke="black" points="2986,-4354.84 2982.5,-4344.84 2979,-4354.84 2986,-4354.84"/>
</g>
<!-- moe_gate_s2_l12 -->
<g id="node537" class="node">
<title>moe_gate_s2_l12</title>
<polygon fill="orange" stroke="black" points="3167.08,-4246.28 2873.45,-4246.28 2797.92,-4158.28 3091.55,-4158.28 3167.08,-4246.28"/>
<text text-anchor="middle" x="2982.5" y="-4213.88" font-family="Arial" font-size="8.00">MoE Gate L12 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-4204.88" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4195.88" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4186.88" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2_l12&#45;&gt;moe_gate_s2_l12 -->
<g id="edge908" class="edge">
<title>allreduce_attn_out_s2_l12&#45;&gt;moe_gate_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-4282C2982.5,-4274.12 2982.5,-4265.38 2982.5,-4256.69"/>
<polygon fill="black" stroke="black" points="2986,-4256.56 2982.5,-4246.56 2979,-4256.56 2986,-4256.56"/>
</g>
<!-- expert_dispatch_s2_l12 -->
<g id="node538" class="node">
<title>expert_dispatch_s2_l12</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-4091.17" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-4102.77" font-family="Arial" font-size="8.00">Expert Dispatch L12 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-4093.77" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4084.77" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-4075.77" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2_l12&#45;&gt;expert_dispatch_s2_l12 -->
<g id="edge909" class="edge">
<title>moe_gate_s2_l12&#45;&gt;expert_dispatch_s2_l12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-4158.16C2982.5,-4149.78 2982.5,-4141.03 2982.5,-4132.74"/>
<polygon fill="black" stroke="black" points="2986,-4132.55 2982.5,-4122.55 2979,-4132.55 2986,-4132.55"/>
</g>
<!-- expert_32_s2_l12 -->
<g id="node539" class="node">
<title>expert_32_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="169,-4024.06 0,-4024.06 0,-3980.06 169,-3980.06 169,-4024.06"/>
<text text-anchor="middle" x="84.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 32 L12</text>
<text text-anchor="middle" x="84.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_32_s2_l12 -->
<g id="edge910" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_32_s2_l12</title>
<path fill="none" stroke="black" d="M2856.42,-4090.52C2385.23,-4091.32 727.13,-4089.41 178.99,-4024.1"/>
<polygon fill="black" stroke="black" points="179.37,-4020.62 169.02,-4022.89 178.53,-4027.57 179.37,-4020.62"/>
</g>
<!-- expert_33_s2_l12 -->
<g id="node540" class="node">
<title>expert_33_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="356,-4024.06 187,-4024.06 187,-3980.06 356,-3980.06 356,-4024.06"/>
<text text-anchor="middle" x="271.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 33 L12</text>
<text text-anchor="middle" x="271.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_33_s2_l12 -->
<g id="edge911" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_33_s2_l12</title>
<path fill="none" stroke="black" d="M2856.36,-4090.27C2405.73,-4090.13 875.66,-4085.13 366.03,-4024.11"/>
<polygon fill="black" stroke="black" points="366.37,-4020.62 356.02,-4022.88 365.52,-4027.57 366.37,-4020.62"/>
</g>
<!-- expert_34_s2_l12 -->
<g id="node541" class="node">
<title>expert_34_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="543,-4024.06 374,-4024.06 374,-3980.06 543,-3980.06 543,-4024.06"/>
<text text-anchor="middle" x="458.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 34 L12</text>
<text text-anchor="middle" x="458.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_34_s2_l12 -->
<g id="edge912" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_34_s2_l12</title>
<path fill="none" stroke="black" d="M2856.51,-4089.98C2427.43,-4088.85 1024.14,-4080.87 552.96,-4024.1"/>
<polygon fill="black" stroke="black" points="553.38,-4020.62 543.02,-4022.88 552.52,-4027.57 553.38,-4020.62"/>
</g>
<!-- expert_35_s2_l12 -->
<g id="node542" class="node">
<title>expert_35_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="730,-4024.06 561,-4024.06 561,-3980.06 730,-3980.06 730,-4024.06"/>
<text text-anchor="middle" x="645.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 35 L12</text>
<text text-anchor="middle" x="645.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_35_s2_l12 -->
<g id="edge913" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_35_s2_l12</title>
<path fill="none" stroke="black" d="M2856.69,-4089.65C2450.07,-4087.48 1173.13,-4076.63 740.1,-4024.12"/>
<polygon fill="black" stroke="black" points="740.38,-4020.63 730.02,-4022.87 739.52,-4027.57 740.38,-4020.63"/>
</g>
<!-- expert_36_s2_l12 -->
<g id="node543" class="node">
<title>expert_36_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="917,-4024.06 748,-4024.06 748,-3980.06 917,-3980.06 917,-4024.06"/>
<text text-anchor="middle" x="832.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 36 L12</text>
<text text-anchor="middle" x="832.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_36_s2_l12 -->
<g id="edge914" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_36_s2_l12</title>
<path fill="none" stroke="black" d="M2856.78,-4089.26C2473.43,-4085.99 1321.87,-4072.4 927.06,-4024.12"/>
<polygon fill="black" stroke="black" points="927.38,-4020.63 917.03,-4022.86 926.51,-4027.57 927.38,-4020.63"/>
</g>
<!-- expert_37_s2_l12 -->
<g id="node544" class="node">
<title>expert_37_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="1104,-4024.06 935,-4024.06 935,-3980.06 1104,-3980.06 1104,-4024.06"/>
<text text-anchor="middle" x="1019.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 37 L12</text>
<text text-anchor="middle" x="1019.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_37_s2_l12 -->
<g id="edge915" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_37_s2_l12</title>
<path fill="none" stroke="black" d="M2856.8,-4088.79C2497.73,-4084.35 1470.88,-4068.19 1114.13,-4024.13"/>
<polygon fill="black" stroke="black" points="1114.39,-4020.63 1104.03,-4022.85 1113.51,-4027.58 1114.39,-4020.63"/>
</g>
<!-- expert_38_s2_l12 -->
<g id="node545" class="node">
<title>expert_38_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="1291,-4024.06 1122,-4024.06 1122,-3980.06 1291,-3980.06 1291,-4024.06"/>
<text text-anchor="middle" x="1206.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 38 L12</text>
<text text-anchor="middle" x="1206.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_38_s2_l12 -->
<g id="edge916" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_38_s2_l12</title>
<path fill="none" stroke="black" d="M2857.17,-4088.22C2523.91,-4082.55 1620.17,-4064.02 1301.21,-4024.14"/>
<polygon fill="black" stroke="black" points="1301.39,-4020.63 1291.03,-4022.83 1300.5,-4027.58 1301.39,-4020.63"/>
</g>
<!-- expert_39_s2_l12 -->
<g id="node546" class="node">
<title>expert_39_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="1478,-4024.06 1309,-4024.06 1309,-3980.06 1478,-3980.06 1478,-4024.06"/>
<text text-anchor="middle" x="1393.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 39 L12</text>
<text text-anchor="middle" x="1393.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_39_s2_l12 -->
<g id="edge917" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_39_s2_l12</title>
<path fill="none" stroke="black" d="M2857.5,-4087.51C2551.41,-4080.54 1769.45,-4059.86 1488.23,-4024.15"/>
<polygon fill="black" stroke="black" points="1488.4,-4020.64 1478.03,-4022.82 1487.49,-4027.58 1488.4,-4020.64"/>
</g>
<!-- expert_40_s2_l12 -->
<g id="node547" class="node">
<title>expert_40_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="1665,-4024.06 1496,-4024.06 1496,-3980.06 1665,-3980.06 1665,-4024.06"/>
<text text-anchor="middle" x="1580.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 40 L12</text>
<text text-anchor="middle" x="1580.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_40_s2_l12 -->
<g id="edge918" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_40_s2_l12</title>
<path fill="none" stroke="black" d="M2856.38,-4090.97C2623.94,-4090.86 2112.47,-4083.29 1675.03,-4024.15"/>
<polygon fill="black" stroke="black" points="1675.42,-4020.67 1665.03,-4022.79 1674.47,-4027.61 1675.42,-4020.67"/>
</g>
<!-- expert_41_s2_l12 -->
<g id="node548" class="node">
<title>expert_41_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="1852,-4024.06 1683,-4024.06 1683,-3980.06 1852,-3980.06 1852,-4024.06"/>
<text text-anchor="middle" x="1767.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 41 L12</text>
<text text-anchor="middle" x="1767.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_41_s2_l12 -->
<g id="edge919" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_41_s2_l12</title>
<path fill="none" stroke="black" d="M2856.48,-4089.43C2650.05,-4086.74 2227.11,-4075.02 1862.01,-4024.16"/>
<polygon fill="black" stroke="black" points="1862.43,-4020.69 1852.04,-4022.76 1861.45,-4027.62 1862.43,-4020.69"/>
</g>
<!-- expert_42_s2_l12 -->
<g id="node549" class="node">
<title>expert_42_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="2039,-4024.06 1870,-4024.06 1870,-3980.06 2039,-3980.06 2039,-4024.06"/>
<text text-anchor="middle" x="1954.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 42 L12</text>
<text text-anchor="middle" x="1954.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_42_s2_l12 -->
<g id="edge920" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_42_s2_l12</title>
<path fill="none" stroke="black" d="M2857.46,-4087.34C2679.53,-4081.97 2343.14,-4066.85 2049.05,-4024.18"/>
<polygon fill="black" stroke="black" points="2049.45,-4020.7 2039.05,-4022.72 2048.43,-4027.63 2049.45,-4020.7"/>
</g>
<!-- expert_43_s2_l12 -->
<g id="node550" class="node">
<title>expert_43_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="2226,-4024.06 2057,-4024.06 2057,-3980.06 2226,-3980.06 2226,-4024.06"/>
<text text-anchor="middle" x="2141.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 43 L12</text>
<text text-anchor="middle" x="2141.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_43_s2_l12 -->
<g id="edge921" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_43_s2_l12</title>
<path fill="none" stroke="black" d="M2859.45,-4084.36C2712.89,-4076.28 2460.66,-4058.77 2236.05,-4024.21"/>
<polygon fill="black" stroke="black" points="2236.47,-4020.73 2226.05,-4022.65 2235.4,-4027.65 2236.47,-4020.73"/>
</g>
<!-- expert_44_s2_l12 -->
<g id="node551" class="node">
<title>expert_44_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="2413,-4024.06 2244,-4024.06 2244,-3980.06 2413,-3980.06 2413,-4024.06"/>
<text text-anchor="middle" x="2328.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 44 L12</text>
<text text-anchor="middle" x="2328.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_44_s2_l12 -->
<g id="edge922" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_44_s2_l12</title>
<path fill="none" stroke="black" d="M2864.87,-4079.92C2753.34,-4069.38 2580.99,-4050.92 2422.98,-4024.24"/>
<polygon fill="black" stroke="black" points="2423.52,-4020.78 2413.07,-4022.55 2422.34,-4027.68 2423.52,-4020.78"/>
</g>
<!-- expert_45_s2_l12 -->
<g id="node552" class="node">
<title>expert_45_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="2600,-4024.06 2431,-4024.06 2431,-3980.06 2600,-3980.06 2600,-4024.06"/>
<text text-anchor="middle" x="2515.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 45 L12</text>
<text text-anchor="middle" x="2515.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_45_s2_l12 -->
<g id="edge923" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_45_s2_l12</title>
<path fill="none" stroke="black" d="M2879.07,-4073.23C2806.34,-4061.01 2706.53,-4043.6 2610.04,-4024.33"/>
<polygon fill="black" stroke="black" points="2610.6,-4020.88 2600.11,-4022.34 2609.23,-4027.74 2610.6,-4020.88"/>
</g>
<!-- expert_46_s2_l12 -->
<g id="node553" class="node">
<title>expert_46_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="2787,-4024.06 2618,-4024.06 2618,-3980.06 2787,-3980.06 2787,-4024.06"/>
<text text-anchor="middle" x="2702.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 46 L12</text>
<text text-anchor="middle" x="2702.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_46_s2_l12 -->
<g id="edge924" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_46_s2_l12</title>
<path fill="none" stroke="black" d="M2905.99,-4066.37C2866.88,-4054.2 2819.39,-4039.42 2780.12,-4027.21"/>
<polygon fill="black" stroke="black" points="2780.91,-4023.79 2770.32,-4024.16 2778.83,-4030.47 2780.91,-4023.79"/>
</g>
<!-- expert_47_s2_l12 -->
<g id="node554" class="node">
<title>expert_47_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="2974,-4024.06 2805,-4024.06 2805,-3980.06 2974,-3980.06 2974,-4024.06"/>
<text text-anchor="middle" x="2889.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 47 L12</text>
<text text-anchor="middle" x="2889.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_47_s2_l12 -->
<g id="edge925" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_47_s2_l12</title>
<path fill="none" stroke="black" d="M2951.27,-4060.92C2941.01,-4051.31 2929.64,-4040.65 2919.47,-4031.13"/>
<polygon fill="black" stroke="black" points="2921.66,-4028.39 2911.97,-4024.11 2916.88,-4033.5 2921.66,-4028.39"/>
</g>
<!-- expert_48_s2_l12 -->
<g id="node555" class="node">
<title>expert_48_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3161,-4024.06 2992,-4024.06 2992,-3980.06 3161,-3980.06 3161,-4024.06"/>
<text text-anchor="middle" x="3076.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 48 L12</text>
<text text-anchor="middle" x="3076.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_48_s2_l12 -->
<g id="edge926" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_48_s2_l12</title>
<path fill="none" stroke="black" d="M3014.06,-4060.92C3024.43,-4051.31 3035.93,-4040.65 3046.21,-4031.13"/>
<polygon fill="black" stroke="black" points="3048.83,-4033.47 3053.78,-4024.11 3044.07,-4028.34 3048.83,-4033.47"/>
</g>
<!-- expert_49_s2_l12 -->
<g id="node556" class="node">
<title>expert_49_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3348,-4024.06 3179,-4024.06 3179,-3980.06 3348,-3980.06 3348,-4024.06"/>
<text text-anchor="middle" x="3263.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 49 L12</text>
<text text-anchor="middle" x="3263.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_49_s2_l12 -->
<g id="edge927" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_49_s2_l12</title>
<path fill="none" stroke="black" d="M3059.28,-4066.37C3098.53,-4054.2 3146.2,-4039.42 3185.6,-4027.21"/>
<polygon fill="black" stroke="black" points="3186.92,-4030.46 3195.43,-4024.16 3184.84,-4023.78 3186.92,-4030.46"/>
</g>
<!-- expert_50_s2_l12 -->
<g id="node557" class="node">
<title>expert_50_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3535,-4024.06 3366,-4024.06 3366,-3980.06 3535,-3980.06 3535,-4024.06"/>
<text text-anchor="middle" x="3450.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 50 L12</text>
<text text-anchor="middle" x="3450.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_50_s2_l12 -->
<g id="edge928" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_50_s2_l12</title>
<path fill="none" stroke="black" d="M3085.81,-4073.32C3158.76,-4061.09 3259.03,-4043.66 3355.92,-4024.34"/>
<polygon fill="black" stroke="black" points="3356.77,-4027.74 3365.89,-4022.34 3355.4,-4020.87 3356.77,-4027.74"/>
</g>
<!-- expert_51_s2_l12 -->
<g id="node558" class="node">
<title>expert_51_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3722,-4024.06 3553,-4024.06 3553,-3980.06 3722,-3980.06 3722,-4024.06"/>
<text text-anchor="middle" x="3637.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 51 L12</text>
<text text-anchor="middle" x="3637.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_51_s2_l12 -->
<g id="edge929" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_51_s2_l12</title>
<path fill="none" stroke="black" d="M3100.07,-4079.96C3211.79,-4069.43 3384.6,-4050.97 3543,-4024.24"/>
<polygon fill="black" stroke="black" points="3543.66,-4027.68 3552.93,-4022.55 3542.48,-4020.78 3543.66,-4027.68"/>
</g>
<!-- expert_52_s2_l12 -->
<g id="node559" class="node">
<title>expert_52_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3909,-4024.06 3740,-4024.06 3740,-3980.06 3909,-3980.06 3909,-4024.06"/>
<text text-anchor="middle" x="3824.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 52 L12</text>
<text text-anchor="middle" x="3824.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_52_s2_l12 -->
<g id="edge930" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_52_s2_l12</title>
<path fill="none" stroke="black" d="M3105.39,-4084.39C3252.09,-4076.33 3504.87,-4058.83 3729.93,-4024.21"/>
<polygon fill="black" stroke="black" points="3730.6,-4027.65 3739.95,-4022.66 3729.53,-4020.73 3730.6,-4027.65"/>
</g>
<!-- expert_53_s2_l12 -->
<g id="node560" class="node">
<title>expert_53_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="4096,-4024.06 3927,-4024.06 3927,-3980.06 4096,-3980.06 4096,-4024.06"/>
<text text-anchor="middle" x="4011.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 53 L12</text>
<text text-anchor="middle" x="4011.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_53_s2_l12 -->
<g id="edge931" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_53_s2_l12</title>
<path fill="none" stroke="black" d="M3107.68,-4087.35C3285.8,-4081.99 3622.55,-4066.88 3916.94,-4024.18"/>
<polygon fill="black" stroke="black" points="3917.57,-4027.63 3926.96,-4022.72 3916.55,-4020.7 3917.57,-4027.63"/>
</g>
<!-- expert_54_s2_l12 -->
<g id="node561" class="node">
<title>expert_54_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="4283,-4024.06 4114,-4024.06 4114,-3980.06 4283,-3980.06 4283,-4024.06"/>
<text text-anchor="middle" x="4198.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 54 L12</text>
<text text-anchor="middle" x="4198.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_54_s2_l12 -->
<g id="edge932" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_54_s2_l12</title>
<path fill="none" stroke="black" d="M3108.22,-4089.44C3314.67,-4086.77 3738.31,-4075.09 4103.98,-4024.16"/>
<polygon fill="black" stroke="black" points="4104.55,-4027.62 4113.96,-4022.76 4103.57,-4020.69 4104.55,-4027.62"/>
</g>
<!-- expert_55_s2_l12 -->
<g id="node562" class="node">
<title>expert_55_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="4470,-4024.06 4301,-4024.06 4301,-3980.06 4470,-3980.06 4470,-4024.06"/>
<text text-anchor="middle" x="4385.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 55 L12</text>
<text text-anchor="middle" x="4385.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_55_s2_l12 -->
<g id="edge933" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_55_s2_l12</title>
<path fill="none" stroke="black" d="M3108.71,-4090.97C3341.33,-4090.88 3853.2,-4083.33 4290.96,-4024.16"/>
<polygon fill="black" stroke="black" points="4291.53,-4027.61 4300.97,-4022.79 4290.58,-4020.67 4291.53,-4027.61"/>
</g>
<!-- expert_56_s2_l12 -->
<g id="node563" class="node">
<title>expert_56_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="4657,-4024.06 4488,-4024.06 4488,-3980.06 4657,-3980.06 4657,-4024.06"/>
<text text-anchor="middle" x="4572.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 56 L12</text>
<text text-anchor="middle" x="4572.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_56_s2_l12 -->
<g id="edge934" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_56_s2_l12</title>
<path fill="none" stroke="black" d="M3107.58,-4087.51C3413.87,-4080.55 4196.36,-4059.88 4477.77,-4024.15"/>
<polygon fill="black" stroke="black" points="4478.51,-4027.58 4487.97,-4022.82 4477.6,-4020.64 4478.51,-4027.58"/>
</g>
<!-- expert_57_s2_l12 -->
<g id="node564" class="node">
<title>expert_57_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="4844,-4024.06 4675,-4024.06 4675,-3980.06 4844,-3980.06 4844,-4024.06"/>
<text text-anchor="middle" x="4759.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 57 L12</text>
<text text-anchor="middle" x="4759.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_57_s2_l12 -->
<g id="edge935" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_57_s2_l12</title>
<path fill="none" stroke="black" d="M3107.91,-4088.22C3441.37,-4082.56 4345.64,-4064.04 4664.78,-4024.14"/>
<polygon fill="black" stroke="black" points="4665.5,-4027.58 4674.97,-4022.83 4664.61,-4020.63 4665.5,-4027.58"/>
</g>
<!-- expert_58_s2_l12 -->
<g id="node565" class="node">
<title>expert_58_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="5031,-4024.06 4862,-4024.06 4862,-3980.06 5031,-3980.06 5031,-4024.06"/>
<text text-anchor="middle" x="4946.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 58 L12</text>
<text text-anchor="middle" x="4946.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_58_s2_l12 -->
<g id="edge936" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_58_s2_l12</title>
<path fill="none" stroke="black" d="M3108.26,-4088.79C3467.53,-4084.36 4494.93,-4068.21 4851.87,-4024.13"/>
<polygon fill="black" stroke="black" points="4852.49,-4027.58 4861.97,-4022.85 4851.61,-4020.63 4852.49,-4027.58"/>
</g>
<!-- expert_59_s2_l12 -->
<g id="node566" class="node">
<title>expert_59_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="5218,-4024.06 5049,-4024.06 5049,-3980.06 5218,-3980.06 5218,-4024.06"/>
<text text-anchor="middle" x="5133.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 59 L12</text>
<text text-anchor="middle" x="5133.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_59_s2_l12 -->
<g id="edge937" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_59_s2_l12</title>
<path fill="none" stroke="black" d="M3108.28,-4089.26C3491.82,-4085.99 4643.94,-4072.42 5038.93,-4024.12"/>
<polygon fill="black" stroke="black" points="5039.49,-4027.57 5048.97,-4022.86 5038.62,-4020.63 5039.49,-4027.57"/>
</g>
<!-- expert_60_s2_l12 -->
<g id="node567" class="node">
<title>expert_60_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="5405,-4024.06 5236,-4024.06 5236,-3980.06 5405,-3980.06 5405,-4024.06"/>
<text text-anchor="middle" x="5320.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 60 L12</text>
<text text-anchor="middle" x="5320.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_60_s2_l12 -->
<g id="edge938" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_60_s2_l12</title>
<path fill="none" stroke="black" d="M3108.37,-4089.65C3515.16,-4087.48 4792.68,-4076.65 5225.9,-4024.12"/>
<polygon fill="black" stroke="black" points="5226.48,-4027.57 5235.98,-4022.87 5225.62,-4020.63 5226.48,-4027.57"/>
</g>
<!-- expert_61_s2_l12 -->
<g id="node568" class="node">
<title>expert_61_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="5592,-4024.06 5423,-4024.06 5423,-3980.06 5592,-3980.06 5592,-4024.06"/>
<text text-anchor="middle" x="5507.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 61 L12</text>
<text text-anchor="middle" x="5507.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_61_s2_l12 -->
<g id="edge939" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_61_s2_l12</title>
<path fill="none" stroke="black" d="M3108.54,-4089.99C3537.8,-4088.86 4941.67,-4080.89 5413.04,-4024.1"/>
<polygon fill="black" stroke="black" points="5413.48,-4027.57 5422.98,-4022.88 5412.62,-4020.62 5413.48,-4027.57"/>
</g>
<!-- expert_62_s2_l12 -->
<g id="node569" class="node">
<title>expert_62_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="5779,-4024.06 5610,-4024.06 5610,-3980.06 5779,-3980.06 5779,-4024.06"/>
<text text-anchor="middle" x="5694.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 62 L12</text>
<text text-anchor="middle" x="5694.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_62_s2_l12 -->
<g id="edge940" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_62_s2_l12</title>
<path fill="none" stroke="black" d="M3108.69,-4090.27C3559.49,-4090.13 5090.14,-4085.15 5599.96,-4024.11"/>
<polygon fill="black" stroke="black" points="5600.48,-4027.57 5609.98,-4022.88 5599.63,-4020.62 5600.48,-4027.57"/>
</g>
<!-- expert_63_s2_l12 -->
<g id="node570" class="node">
<title>expert_63_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="5966,-4024.06 5797,-4024.06 5797,-3980.06 5966,-3980.06 5966,-4024.06"/>
<text text-anchor="middle" x="5881.5" y="-4013.66" font-family="Arial" font-size="8.00">Expert 63 L12</text>
<text text-anchor="middle" x="5881.5" y="-4004.66" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-3995.66" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-3986.66" font-family="Arial" font-size="8.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2_l12&#45;&gt;expert_63_s2_l12 -->
<g id="edge941" class="edge">
<title>expert_dispatch_s2_l12&#45;&gt;expert_63_s2_l12</title>
<path fill="none" stroke="black" d="M3108.62,-4090.52C3579.98,-4091.33 5238.67,-4089.43 5787,-4024.1"/>
<polygon fill="black" stroke="black" points="5787.47,-4027.57 5796.98,-4022.89 5786.63,-4020.62 5787.47,-4027.57"/>
</g>
<!-- expert_combine_s2_l12 -->
<g id="node571" class="node">
<title>expert_combine_s2_l12</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-3912.94" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-3924.54" font-family="Arial" font-size="8.00">Expert Combine L12 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-3915.54" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-3906.54" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3897.54" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge942" class="edge">
<title>expert_32_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M169.02,-3981.22C171.88,-3980.79 174.71,-3980.4 177.5,-3980.06 702.97,-3915.19 2358.67,-3912.82 2846.17,-3913.58"/>
<polygon fill="black" stroke="black" points="2846.42,-3917.08 2856.42,-3913.59 2846.43,-3910.08 2846.42,-3917.08"/>
</g>
<!-- expert_33_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge943" class="edge">
<title>expert_33_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M356.02,-3981.23C358.88,-3980.8 361.71,-3980.4 364.5,-3980.06 851.71,-3919.5 2380.13,-3914.06 2846.21,-3913.85"/>
<polygon fill="black" stroke="black" points="2846.36,-3917.35 2856.36,-3913.84 2846.36,-3910.35 2846.36,-3917.35"/>
</g>
<!-- expert_34_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge944" class="edge">
<title>expert_34_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M543.02,-3981.24C545.88,-3980.8 548.71,-3980.41 551.5,-3980.06 1000.54,-3923.8 2402.24,-3915.4 2846.2,-3914.16"/>
<polygon fill="black" stroke="black" points="2846.52,-3917.66 2856.51,-3914.13 2846.5,-3910.66 2846.52,-3917.66"/>
</g>
<!-- expert_35_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge945" class="edge">
<title>expert_35_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M730.02,-3981.25C732.88,-3980.81 735.71,-3980.41 738.5,-3980.06 1149.63,-3928.08 2426.08,-3916.83 2846.61,-3914.52"/>
<polygon fill="black" stroke="black" points="2846.7,-3918.02 2856.69,-3914.46 2846.67,-3911.02 2846.7,-3918.02"/>
</g>
<!-- expert_36_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge946" class="edge">
<title>expert_36_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M917.03,-3981.26C919.88,-3980.82 922.71,-3980.41 925.5,-3980.06 1298.74,-3932.36 2450.22,-3918.4 2846.7,-3914.94"/>
<polygon fill="black" stroke="black" points="2846.81,-3918.44 2856.78,-3914.86 2846.75,-3911.44 2846.81,-3918.44"/>
</g>
<!-- expert_37_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge947" class="edge">
<title>expert_37_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M1104.03,-3981.27C1106.88,-3980.82 1109.71,-3980.42 1112.5,-3980.06 1447.94,-3936.64 2474.98,-3920.11 2846.54,-3915.46"/>
<polygon fill="black" stroke="black" points="2846.85,-3918.95 2856.8,-3915.33 2846.76,-3911.95 2846.85,-3918.95"/>
</g>
<!-- expert_38_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge948" class="edge">
<title>expert_38_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M1291.03,-3981.28C1293.88,-3980.83 1296.71,-3980.42 1299.5,-3980.06 1597.53,-3940.89 2502.38,-3921.99 2847.13,-3916.07"/>
<polygon fill="black" stroke="black" points="2847.23,-3919.57 2857.17,-3915.9 2847.11,-3912.57 2847.23,-3919.57"/>
</g>
<!-- expert_39_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge949" class="edge">
<title>expert_39_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M1478.03,-3981.3C1480.88,-3980.85 1483.71,-3980.43 1486.5,-3980.06 1747.22,-3945.14 2530.56,-3924.12 2847.35,-3916.84"/>
<polygon fill="black" stroke="black" points="2847.58,-3920.33 2857.5,-3916.6 2847.42,-3913.33 2847.58,-3920.33"/>
</g>
<!-- expert_40_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge950" class="edge">
<title>expert_40_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M1665.03,-3981.32C1667.88,-3980.86 1670.71,-3980.44 1673.5,-3980.06 2098.54,-3921.77 2607.53,-3913.48 2846.26,-3913.16"/>
<polygon fill="black" stroke="black" points="2846.39,-3916.66 2856.38,-3913.15 2846.38,-3909.66 2846.39,-3916.66"/>
</g>
<!-- expert_41_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge951" class="edge">
<title>expert_41_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M1852.04,-3981.35C1854.89,-3980.89 1857.71,-3980.45 1860.5,-3980.06 2213.6,-3930.13 2634.37,-3917.79 2846.24,-3914.82"/>
<polygon fill="black" stroke="black" points="2846.52,-3918.32 2856.48,-3914.68 2846.43,-3911.32 2846.52,-3918.32"/>
</g>
<!-- expert_42_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge952" class="edge">
<title>expert_42_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M2039.05,-3981.4C2041.89,-3980.92 2044.72,-3980.47 2047.5,-3980.06 2330.13,-3938.4 2664.83,-3922.79 2847.27,-3917.09"/>
<polygon fill="black" stroke="black" points="2847.57,-3920.58 2857.46,-3916.77 2847.35,-3913.58 2847.57,-3920.58"/>
</g>
<!-- expert_43_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge953" class="edge">
<title>expert_43_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M2226.05,-3981.46C2228.9,-3980.96 2231.72,-3980.49 2234.5,-3980.06 2448.23,-3946.63 2699.16,-3928.76 2849.26,-3920.33"/>
<polygon fill="black" stroke="black" points="2849.66,-3923.81 2859.45,-3919.76 2849.27,-3916.82 2849.66,-3923.81"/>
</g>
<!-- expert_44_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge954" class="edge">
<title>expert_44_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M2413.07,-3981.57C2415.91,-3981.04 2418.73,-3980.53 2421.5,-3980.06 2569.28,-3954.74 2740.64,-3936.08 2854.7,-3925.16"/>
<polygon fill="black" stroke="black" points="2855.24,-3928.62 2864.87,-3924.19 2854.58,-3921.65 2855.24,-3928.62"/>
</g>
<!-- expert_45_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge955" class="edge">
<title>expert_45_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M2600.11,-3981.77C2602.94,-3981.19 2605.74,-3980.61 2608.5,-3980.06 2695.55,-3962.54 2794.51,-3945.16 2868.76,-3932.62"/>
<polygon fill="black" stroke="black" points="2869.79,-3935.99 2879.07,-3930.88 2868.63,-3929.09 2869.79,-3935.99"/>
</g>
<!-- expert_46_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge956" class="edge">
<title>expert_46_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M2770.28,-3979.97C2808.19,-3968.18 2855.83,-3953.35 2896.36,-3940.74"/>
<polygon fill="black" stroke="black" points="2897.45,-3944.07 2905.96,-3937.76 2895.37,-3937.39 2897.45,-3944.07"/>
</g>
<!-- expert_47_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge957" class="edge">
<title>expert_47_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M2912.01,-3979.97C2921.53,-3971.05 2932.9,-3960.4 2943.7,-3950.29"/>
<polygon fill="black" stroke="black" points="2946.15,-3952.79 2951.06,-3943.4 2941.37,-3947.68 2946.15,-3952.79"/>
</g>
<!-- expert_48_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge958" class="edge">
<title>expert_48_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M3053.75,-3979.97C3044.12,-3971.05 3032.63,-3960.4 3021.71,-3950.29"/>
<polygon fill="black" stroke="black" points="3023.99,-3947.63 3014.28,-3943.4 3019.23,-3952.76 3023.99,-3947.63"/>
</g>
<!-- expert_49_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge959" class="edge">
<title>expert_49_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M3195.48,-3979.97C3157.36,-3968.15 3109.44,-3953.3 3068.71,-3940.67"/>
<polygon fill="black" stroke="black" points="3069.65,-3937.3 3059.06,-3937.68 3067.58,-3943.98 3069.65,-3937.3"/>
</g>
<!-- expert_50_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge960" class="edge">
<title>expert_50_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M3365.89,-3981.77C3363.06,-3981.18 3360.26,-3980.61 3357.5,-3980.06 3269.89,-3962.45 3170.24,-3945.01 3095.69,-3932.46"/>
<polygon fill="black" stroke="black" points="3096.25,-3929 3085.81,-3930.8 3095.09,-3935.91 3096.25,-3929"/>
</g>
<!-- expert_51_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge961" class="edge">
<title>expert_51_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M3552.93,-3981.56C3550.09,-3981.04 3547.27,-3980.53 3544.5,-3980.06 3396.34,-3954.69 3224.52,-3936.03 3110.26,-3925.12"/>
<polygon fill="black" stroke="black" points="3110.36,-3921.61 3100.07,-3924.15 3109.69,-3928.58 3110.36,-3921.61"/>
</g>
<!-- expert_52_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge962" class="edge">
<title>expert_52_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M3739.95,-3981.46C3737.1,-3980.96 3734.28,-3980.49 3731.5,-3980.06 3517.33,-3946.58 3265.85,-3928.71 3115.58,-3920.29"/>
<polygon fill="black" stroke="black" points="3115.57,-3916.79 3105.39,-3919.73 3115.18,-3923.78 3115.57,-3916.79"/>
</g>
<!-- expert_53_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge963" class="edge">
<title>expert_53_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M3926.96,-3981.4C3924.11,-3980.92 3921.28,-3980.47 3918.5,-3980.06 3635.57,-3938.37 3300.51,-3922.76 3117.87,-3917.08"/>
<polygon fill="black" stroke="black" points="3117.78,-3913.57 3107.68,-3916.76 3117.57,-3920.57 3117.78,-3913.57"/>
</g>
<!-- expert_54_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge964" class="edge">
<title>expert_54_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M4113.96,-3981.35C4111.11,-3980.89 4108.29,-3980.45 4105.5,-3980.06 3751.85,-3930.06 3330.37,-3917.76 3118.46,-3914.81"/>
<polygon fill="black" stroke="black" points="3118.26,-3911.3 3108.22,-3914.67 3118.17,-3918.3 3118.26,-3911.3"/>
</g>
<!-- expert_55_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge965" class="edge">
<title>expert_55_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M4300.97,-3981.32C4298.12,-3980.86 4295.29,-3980.44 4292.5,-3980.06 3867.13,-3921.74 3357.75,-3913.46 3118.84,-3913.15"/>
<polygon fill="black" stroke="black" points="3118.72,-3909.65 3108.71,-3913.14 3118.71,-3916.65 3118.72,-3909.65"/>
</g>
<!-- expert_56_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge966" class="edge">
<title>expert_56_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M4487.97,-3981.3C4485.12,-3980.85 4482.29,-3980.43 4479.5,-3980.06 4218.6,-3945.12 3434.74,-3924.11 3117.74,-3916.83"/>
<polygon fill="black" stroke="black" points="3117.66,-3913.33 3107.58,-3916.6 3117.5,-3920.33 3117.66,-3913.33"/>
</g>
<!-- expert_57_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge967" class="edge">
<title>expert_57_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M4674.97,-3981.28C4672.12,-3980.83 4669.29,-3980.42 4666.5,-3980.06 4368.29,-3940.87 3462.9,-3921.98 3117.95,-3916.07"/>
<polygon fill="black" stroke="black" points="3117.97,-3912.57 3107.91,-3915.9 3117.85,-3919.57 3117.97,-3912.57"/>
</g>
<!-- expert_58_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge968" class="edge">
<title>expert_58_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M4861.97,-3981.27C4859.12,-3980.82 4856.29,-3980.42 4853.5,-3980.06 4517.88,-3936.62 3490.29,-3920.11 3118.53,-3915.45"/>
<polygon fill="black" stroke="black" points="3118.31,-3911.95 3108.26,-3915.33 3118.22,-3918.95 3118.31,-3911.95"/>
</g>
<!-- expert_59_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge969" class="edge">
<title>expert_59_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M5048.97,-3981.26C5046.12,-3980.82 5043.29,-3980.41 5040.5,-3980.06 4667.07,-3932.34 3515.04,-3918.39 3118.36,-3914.94"/>
<polygon fill="black" stroke="black" points="3118.31,-3911.44 3108.28,-3914.86 3118.25,-3918.44 3118.31,-3911.44"/>
</g>
<!-- expert_60_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge970" class="edge">
<title>expert_60_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M5235.98,-3981.25C5233.12,-3980.81 5230.29,-3980.41 5227.5,-3980.06 4816.19,-3928.06 3539.17,-3916.83 3118.45,-3914.52"/>
<polygon fill="black" stroke="black" points="3118.39,-3911.02 3108.37,-3914.46 3118.35,-3918.02 3118.39,-3911.02"/>
</g>
<!-- expert_61_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge971" class="edge">
<title>expert_61_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M5422.98,-3981.24C5420.12,-3980.8 5417.29,-3980.41 5414.5,-3980.06 4965.28,-3923.78 3563,-3915.39 3118.86,-3914.16"/>
<polygon fill="black" stroke="black" points="3118.55,-3910.66 3108.54,-3914.13 3118.53,-3917.66 3118.55,-3910.66"/>
</g>
<!-- expert_62_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge972" class="edge">
<title>expert_62_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M5609.98,-3981.23C5607.12,-3980.8 5604.29,-3980.4 5601.5,-3980.06 5114.1,-3919.48 3585.1,-3914.06 3118.84,-3913.84"/>
<polygon fill="black" stroke="black" points="3118.69,-3910.34 3108.69,-3913.84 3118.69,-3917.34 3118.69,-3910.34"/>
</g>
<!-- expert_63_s2_l12&#45;&gt;expert_combine_s2_l12 -->
<g id="edge973" class="edge">
<title>expert_63_s2_l12&#45;&gt;expert_combine_s2_l12</title>
<path fill="none" stroke="black" d="M5796.98,-3981.22C5794.12,-3980.79 5791.29,-3980.4 5788.5,-3980.06 5262.84,-3915.17 3606.55,-3912.81 3118.88,-3913.57"/>
<polygon fill="black" stroke="black" points="3118.62,-3910.07 3108.62,-3913.59 3118.63,-3917.07 3118.62,-3910.07"/>
</g>
<!-- moe_out_proj_s2_l12 -->
<g id="node572" class="node">
<title>moe_out_proj_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-3845.83 2893.5,-3845.83 2893.5,-3801.83 3071.5,-3801.83 3071.5,-3845.83"/>
<text text-anchor="middle" x="2982.5" y="-3835.43" font-family="Arial" font-size="8.00">MoE Output Proj L12 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-3826.43" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3817.43" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3808.43" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2_l12&#45;&gt;moe_out_proj_s2_l12 -->
<g id="edge974" class="edge">
<title>expert_combine_s2_l12&#45;&gt;moe_out_proj_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-3881.48C2982.5,-3873.2 2982.5,-3864.22 2982.5,-3855.91"/>
<polygon fill="black" stroke="black" points="2986,-3855.84 2982.5,-3845.84 2979,-3855.84 2986,-3855.84"/>
</g>
<!-- allreduce_moe_out_s2_l12 -->
<g id="node573" class="node">
<title>allreduce_moe_out_s2_l12</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-3734.72" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-3746.32" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L12</text>
<text text-anchor="middle" x="2982.5" y="-3737.32" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3728.32" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3719.32" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2_l12&#45;&gt;allreduce_moe_out_s2_l12 -->
<g id="edge975" class="edge">
<title>moe_out_proj_s2_l12&#45;&gt;allreduce_moe_out_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-3801.74C2982.5,-3794.07 2982.5,-3785.12 2982.5,-3776.33"/>
<polygon fill="black" stroke="black" points="2986,-3776.16 2982.5,-3766.16 2979,-3776.16 2986,-3776.16"/>
</g>
<!-- layernorm2_s2_l12 -->
<g id="node574" class="node">
<title>layernorm2_s2_l12</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-3667.61 2893.5,-3667.61 2893.5,-3623.61 3071.5,-3623.61 3071.5,-3667.61"/>
<text text-anchor="middle" x="2982.5" y="-3657.21" font-family="Arial" font-size="8.00">LayerNorm 2 (L12)</text>
<text text-anchor="middle" x="2982.5" y="-3648.21" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3639.21" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3630.21" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2_l12&#45;&gt;layernorm2_s2_l12 -->
<g id="edge976" class="edge">
<title>allreduce_moe_out_s2_l12&#45;&gt;layernorm2_s2_l12</title>
<path fill="none" stroke="black" d="M2982.5,-3703.25C2982.5,-3694.97 2982.5,-3686 2982.5,-3677.68"/>
<polygon fill="black" stroke="black" points="2986,-3677.61 2982.5,-3667.61 2979,-3677.61 2986,-3677.61"/>
</g>
<!-- layernorm1_s2_l13 -->
<g id="node575" class="node">
<title>layernorm1_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-3587.61 2893.5,-3587.61 2893.5,-3543.61 3071.5,-3543.61 3071.5,-3587.61"/>
<text text-anchor="middle" x="2982.5" y="-3577.21" font-family="Arial" font-size="8.00">LayerNorm 1 (L13)</text>
<text text-anchor="middle" x="2982.5" y="-3568.21" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3559.21" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3550.21" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm2_s2_l12&#45;&gt;layernorm1_s2_l13 -->
<g id="edge977" class="edge">
<title>layernorm2_s2_l12&#45;&gt;layernorm1_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-3623.29C2982.5,-3615.4 2982.5,-3606.29 2982.5,-3597.71"/>
<polygon fill="black" stroke="black" points="2986,-3597.62 2982.5,-3587.62 2979,-3597.62 2986,-3597.62"/>
</g>
<!-- qkv_proj_s2_l13 -->
<g id="node576" class="node">
<title>qkv_proj_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3081,-3507.61 2884,-3507.61 2884,-3463.61 3081,-3463.61 3081,-3507.61"/>
<text text-anchor="middle" x="2982.5" y="-3497.21" font-family="Arial" font-size="8.00">QKV Projection L13 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-3488.21" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3479.21" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-3470.21" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2_l13&#45;&gt;qkv_proj_s2_l13 -->
<g id="edge978" class="edge">
<title>layernorm1_s2_l13&#45;&gt;qkv_proj_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-3543.29C2982.5,-3535.4 2982.5,-3526.29 2982.5,-3517.71"/>
<polygon fill="black" stroke="black" points="2986,-3517.62 2982.5,-3507.62 2979,-3517.62 2986,-3517.62"/>
</g>
<!-- allreduce_qkv_s2_l13 -->
<g id="node577" class="node">
<title>allreduce_qkv_s2_l13</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-3396.49" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-3408.09" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L13</text>
<text text-anchor="middle" x="2982.5" y="-3399.09" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-3390.09" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-3381.09" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2_l13&#45;&gt;allreduce_qkv_s2_l13 -->
<g id="edge979" class="edge">
<title>qkv_proj_s2_l13&#45;&gt;allreduce_qkv_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-3463.52C2982.5,-3455.85 2982.5,-3446.89 2982.5,-3438.1"/>
<polygon fill="black" stroke="black" points="2986,-3437.94 2982.5,-3427.94 2979,-3437.94 2986,-3437.94"/>
</g>
<!-- attention_s2_l13 -->
<g id="node578" class="node">
<title>attention_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3081,-3329.38 2884,-3329.38 2884,-3285.38 3081,-3285.38 3081,-3329.38"/>
<text text-anchor="middle" x="2982.5" y="-3318.98" font-family="Arial" font-size="8.00">Self&#45;Attention L13</text>
<text text-anchor="middle" x="2982.5" y="-3309.98" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-3300.98" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-3291.98" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2_l13&#45;&gt;attention_s2_l13 -->
<g id="edge980" class="edge">
<title>allreduce_qkv_s2_l13&#45;&gt;attention_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-3365.03C2982.5,-3356.75 2982.5,-3347.77 2982.5,-3339.46"/>
<polygon fill="black" stroke="black" points="2986,-3339.39 2982.5,-3329.39 2979,-3339.39 2986,-3339.39"/>
</g>
<!-- attn_out_proj_s2_l13 -->
<g id="node579" class="node">
<title>attn_out_proj_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3078,-3249.38 2887,-3249.38 2887,-3205.38 3078,-3205.38 3078,-3249.38"/>
<text text-anchor="middle" x="2982.5" y="-3238.98" font-family="Arial" font-size="8.00">Attention Output Proj L13 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-3229.98" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-3220.98" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3211.98" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2_l13&#45;&gt;attn_out_proj_s2_l13 -->
<g id="edge981" class="edge">
<title>attention_s2_l13&#45;&gt;attn_out_proj_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-3285.07C2982.5,-3277.18 2982.5,-3268.06 2982.5,-3259.48"/>
<polygon fill="black" stroke="black" points="2986,-3259.4 2982.5,-3249.4 2979,-3259.4 2986,-3259.4"/>
</g>
<!-- allreduce_attn_out_s2_l13 -->
<g id="node580" class="node">
<title>allreduce_attn_out_s2_l13</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-3138.27" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-3149.87" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L13</text>
<text text-anchor="middle" x="2982.5" y="-3140.87" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3131.87" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3122.87" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2_l13&#45;&gt;allreduce_attn_out_s2_l13 -->
<g id="edge982" class="edge">
<title>attn_out_proj_s2_l13&#45;&gt;allreduce_attn_out_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-3205.29C2982.5,-3197.62 2982.5,-3188.67 2982.5,-3179.87"/>
<polygon fill="black" stroke="black" points="2986,-3179.71 2982.5,-3169.71 2979,-3179.71 2986,-3179.71"/>
</g>
<!-- moe_gate_s2_l13 -->
<g id="node581" class="node">
<title>moe_gate_s2_l13</title>
<polygon fill="orange" stroke="black" points="3167.08,-3071.16 2873.45,-3071.16 2797.92,-2983.16 3091.55,-2983.16 3167.08,-3071.16"/>
<text text-anchor="middle" x="2982.5" y="-3038.76" font-family="Arial" font-size="8.00">MoE Gate L13 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-3029.76" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3020.76" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-3011.76" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2_l13&#45;&gt;moe_gate_s2_l13 -->
<g id="edge983" class="edge">
<title>allreduce_attn_out_s2_l13&#45;&gt;moe_gate_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-3106.87C2982.5,-3098.99 2982.5,-3090.26 2982.5,-3081.57"/>
<polygon fill="black" stroke="black" points="2986,-3081.43 2982.5,-3071.43 2979,-3081.43 2986,-3081.43"/>
</g>
<!-- expert_dispatch_s2_l13 -->
<g id="node582" class="node">
<title>expert_dispatch_s2_l13</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-2916.04" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-2927.64" font-family="Arial" font-size="8.00">Expert Dispatch L13 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-2918.64" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2909.64" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2900.64" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2_l13&#45;&gt;expert_dispatch_s2_l13 -->
<g id="edge984" class="edge">
<title>moe_gate_s2_l13&#45;&gt;expert_dispatch_s2_l13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-2983.03C2982.5,-2974.65 2982.5,-2965.9 2982.5,-2957.61"/>
<polygon fill="black" stroke="black" points="2986,-2957.42 2982.5,-2947.42 2979,-2957.42 2986,-2957.42"/>
</g>
<!-- expert_32_s2_l13 -->
<g id="node583" class="node">
<title>expert_32_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="169,-2848.93 0,-2848.93 0,-2804.93 169,-2804.93 169,-2848.93"/>
<text text-anchor="middle" x="84.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 32 L13</text>
<text text-anchor="middle" x="84.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_32_s2_l13 -->
<g id="edge985" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_32_s2_l13</title>
<path fill="none" stroke="black" d="M2856.42,-2915.39C2385.23,-2916.2 727.13,-2914.28 178.99,-2848.97"/>
<polygon fill="black" stroke="black" points="179.37,-2845.49 169.02,-2847.76 178.53,-2852.44 179.37,-2845.49"/>
</g>
<!-- expert_33_s2_l13 -->
<g id="node584" class="node">
<title>expert_33_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="356,-2848.93 187,-2848.93 187,-2804.93 356,-2804.93 356,-2848.93"/>
<text text-anchor="middle" x="271.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 33 L13</text>
<text text-anchor="middle" x="271.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_33_s2_l13 -->
<g id="edge986" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_33_s2_l13</title>
<path fill="none" stroke="black" d="M2856.36,-2915.15C2405.73,-2915 875.66,-2910 366.03,-2848.98"/>
<polygon fill="black" stroke="black" points="366.37,-2845.49 356.02,-2847.76 365.52,-2852.44 366.37,-2845.49"/>
</g>
<!-- expert_34_s2_l13 -->
<g id="node585" class="node">
<title>expert_34_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="543,-2848.93 374,-2848.93 374,-2804.93 543,-2804.93 543,-2848.93"/>
<text text-anchor="middle" x="458.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 34 L13</text>
<text text-anchor="middle" x="458.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_34_s2_l13 -->
<g id="edge987" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_34_s2_l13</title>
<path fill="none" stroke="black" d="M2856.51,-2914.86C2427.43,-2913.72 1024.14,-2905.75 552.96,-2848.97"/>
<polygon fill="black" stroke="black" points="553.38,-2845.5 543.02,-2847.75 552.52,-2852.44 553.38,-2845.5"/>
</g>
<!-- expert_35_s2_l13 -->
<g id="node586" class="node">
<title>expert_35_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="730,-2848.93 561,-2848.93 561,-2804.93 730,-2804.93 730,-2848.93"/>
<text text-anchor="middle" x="645.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 35 L13</text>
<text text-anchor="middle" x="645.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_35_s2_l13 -->
<g id="edge988" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_35_s2_l13</title>
<path fill="none" stroke="black" d="M2856.69,-2914.52C2450.07,-2912.35 1173.13,-2901.5 740.1,-2848.99"/>
<polygon fill="black" stroke="black" points="740.38,-2845.5 730.02,-2847.74 739.52,-2852.45 740.38,-2845.5"/>
</g>
<!-- expert_36_s2_l13 -->
<g id="node587" class="node">
<title>expert_36_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="917,-2848.93 748,-2848.93 748,-2804.93 917,-2804.93 917,-2848.93"/>
<text text-anchor="middle" x="832.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 36 L13</text>
<text text-anchor="middle" x="832.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_36_s2_l13 -->
<g id="edge989" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_36_s2_l13</title>
<path fill="none" stroke="black" d="M2856.78,-2914.13C2473.43,-2910.86 1321.87,-2897.27 927.06,-2848.99"/>
<polygon fill="black" stroke="black" points="927.38,-2845.5 917.03,-2847.73 926.51,-2852.45 927.38,-2845.5"/>
</g>
<!-- expert_37_s2_l13 -->
<g id="node588" class="node">
<title>expert_37_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="1104,-2848.93 935,-2848.93 935,-2804.93 1104,-2804.93 1104,-2848.93"/>
<text text-anchor="middle" x="1019.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 37 L13</text>
<text text-anchor="middle" x="1019.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_37_s2_l13 -->
<g id="edge990" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_37_s2_l13</title>
<path fill="none" stroke="black" d="M2856.8,-2913.66C2497.73,-2909.22 1470.88,-2893.06 1114.13,-2849"/>
<polygon fill="black" stroke="black" points="1114.39,-2845.5 1104.03,-2847.72 1113.51,-2852.45 1114.39,-2845.5"/>
</g>
<!-- expert_38_s2_l13 -->
<g id="node589" class="node">
<title>expert_38_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="1291,-2848.93 1122,-2848.93 1122,-2804.93 1291,-2804.93 1291,-2848.93"/>
<text text-anchor="middle" x="1206.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 38 L13</text>
<text text-anchor="middle" x="1206.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_38_s2_l13 -->
<g id="edge991" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_38_s2_l13</title>
<path fill="none" stroke="black" d="M2857.17,-2913.09C2523.91,-2907.43 1620.17,-2888.89 1301.21,-2849.01"/>
<polygon fill="black" stroke="black" points="1301.39,-2845.51 1291.03,-2847.71 1300.5,-2852.45 1301.39,-2845.51"/>
</g>
<!-- expert_39_s2_l13 -->
<g id="node590" class="node">
<title>expert_39_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="1478,-2848.93 1309,-2848.93 1309,-2804.93 1478,-2804.93 1478,-2848.93"/>
<text text-anchor="middle" x="1393.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 39 L13</text>
<text text-anchor="middle" x="1393.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_39_s2_l13 -->
<g id="edge992" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_39_s2_l13</title>
<path fill="none" stroke="black" d="M2857.5,-2912.38C2551.41,-2905.41 1769.45,-2884.74 1488.23,-2849.02"/>
<polygon fill="black" stroke="black" points="1488.4,-2845.51 1478.03,-2847.69 1487.49,-2852.45 1488.4,-2845.51"/>
</g>
<!-- expert_40_s2_l13 -->
<g id="node591" class="node">
<title>expert_40_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="1665,-2848.93 1496,-2848.93 1496,-2804.93 1665,-2804.93 1665,-2848.93"/>
<text text-anchor="middle" x="1580.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 40 L13</text>
<text text-anchor="middle" x="1580.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_40_s2_l13 -->
<g id="edge993" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_40_s2_l13</title>
<path fill="none" stroke="black" d="M2856.38,-2915.84C2623.94,-2915.74 2112.47,-2908.17 1675.03,-2849.03"/>
<polygon fill="black" stroke="black" points="1675.42,-2845.55 1665.03,-2847.67 1674.47,-2852.48 1675.42,-2845.55"/>
</g>
<!-- expert_41_s2_l13 -->
<g id="node592" class="node">
<title>expert_41_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="1852,-2848.93 1683,-2848.93 1683,-2804.93 1852,-2804.93 1852,-2848.93"/>
<text text-anchor="middle" x="1767.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 41 L13</text>
<text text-anchor="middle" x="1767.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_41_s2_l13 -->
<g id="edge994" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_41_s2_l13</title>
<path fill="none" stroke="black" d="M2856.48,-2914.3C2650.05,-2911.61 2227.11,-2899.89 1862.01,-2849.04"/>
<polygon fill="black" stroke="black" points="1862.43,-2845.56 1852.04,-2847.63 1861.45,-2852.49 1862.43,-2845.56"/>
</g>
<!-- expert_42_s2_l13 -->
<g id="node593" class="node">
<title>expert_42_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="2039,-2848.93 1870,-2848.93 1870,-2804.93 2039,-2804.93 2039,-2848.93"/>
<text text-anchor="middle" x="1954.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 42 L13</text>
<text text-anchor="middle" x="1954.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_42_s2_l13 -->
<g id="edge995" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_42_s2_l13</title>
<path fill="none" stroke="black" d="M2857.46,-2912.21C2679.53,-2906.84 2343.14,-2891.72 2049.05,-2849.06"/>
<polygon fill="black" stroke="black" points="2049.45,-2845.58 2039.05,-2847.59 2048.43,-2852.5 2049.45,-2845.58"/>
</g>
<!-- expert_43_s2_l13 -->
<g id="node594" class="node">
<title>expert_43_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="2226,-2848.93 2057,-2848.93 2057,-2804.93 2226,-2804.93 2226,-2848.93"/>
<text text-anchor="middle" x="2141.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 43 L13</text>
<text text-anchor="middle" x="2141.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_43_s2_l13 -->
<g id="edge996" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_43_s2_l13</title>
<path fill="none" stroke="black" d="M2859.45,-2909.23C2712.89,-2901.16 2460.66,-2883.64 2236.05,-2849.08"/>
<polygon fill="black" stroke="black" points="2236.47,-2845.6 2226.05,-2847.53 2235.4,-2852.52 2236.47,-2845.6"/>
</g>
<!-- expert_44_s2_l13 -->
<g id="node595" class="node">
<title>expert_44_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="2413,-2848.93 2244,-2848.93 2244,-2804.93 2413,-2804.93 2413,-2848.93"/>
<text text-anchor="middle" x="2328.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 44 L13</text>
<text text-anchor="middle" x="2328.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_44_s2_l13 -->
<g id="edge997" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_44_s2_l13</title>
<path fill="none" stroke="black" d="M2864.87,-2904.8C2753.34,-2894.25 2580.99,-2875.79 2422.98,-2849.11"/>
<polygon fill="black" stroke="black" points="2423.52,-2845.65 2413.07,-2847.42 2422.34,-2852.55 2423.52,-2845.65"/>
</g>
<!-- expert_45_s2_l13 -->
<g id="node596" class="node">
<title>expert_45_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="2600,-2848.93 2431,-2848.93 2431,-2804.93 2600,-2804.93 2600,-2848.93"/>
<text text-anchor="middle" x="2515.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 45 L13</text>
<text text-anchor="middle" x="2515.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_45_s2_l13 -->
<g id="edge998" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_45_s2_l13</title>
<path fill="none" stroke="black" d="M2879.07,-2898.11C2806.34,-2885.88 2706.53,-2868.47 2610.04,-2849.2"/>
<polygon fill="black" stroke="black" points="2610.6,-2845.75 2600.11,-2847.21 2609.23,-2852.61 2610.6,-2845.75"/>
</g>
<!-- expert_46_s2_l13 -->
<g id="node597" class="node">
<title>expert_46_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="2787,-2848.93 2618,-2848.93 2618,-2804.93 2787,-2804.93 2787,-2848.93"/>
<text text-anchor="middle" x="2702.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 46 L13</text>
<text text-anchor="middle" x="2702.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_46_s2_l13 -->
<g id="edge999" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_46_s2_l13</title>
<path fill="none" stroke="black" d="M2905.99,-2891.24C2866.88,-2879.07 2819.39,-2864.3 2780.12,-2852.08"/>
<polygon fill="black" stroke="black" points="2780.91,-2848.66 2770.32,-2849.03 2778.83,-2855.34 2780.91,-2848.66"/>
</g>
<!-- expert_47_s2_l13 -->
<g id="node598" class="node">
<title>expert_47_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="2974,-2848.93 2805,-2848.93 2805,-2804.93 2974,-2804.93 2974,-2848.93"/>
<text text-anchor="middle" x="2889.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 47 L13</text>
<text text-anchor="middle" x="2889.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_47_s2_l13 -->
<g id="edge1000" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_47_s2_l13</title>
<path fill="none" stroke="black" d="M2951.27,-2885.79C2941.01,-2876.18 2929.64,-2865.53 2919.47,-2856.01"/>
<polygon fill="black" stroke="black" points="2921.66,-2853.26 2911.97,-2848.98 2916.88,-2858.37 2921.66,-2853.26"/>
</g>
<!-- expert_48_s2_l13 -->
<g id="node599" class="node">
<title>expert_48_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3161,-2848.93 2992,-2848.93 2992,-2804.93 3161,-2804.93 3161,-2848.93"/>
<text text-anchor="middle" x="3076.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 48 L13</text>
<text text-anchor="middle" x="3076.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_48_s2_l13 -->
<g id="edge1001" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_48_s2_l13</title>
<path fill="none" stroke="black" d="M3014.06,-2885.79C3024.43,-2876.18 3035.93,-2865.53 3046.21,-2856.01"/>
<polygon fill="black" stroke="black" points="3048.83,-2858.35 3053.78,-2848.98 3044.07,-2853.21 3048.83,-2858.35"/>
</g>
<!-- expert_49_s2_l13 -->
<g id="node600" class="node">
<title>expert_49_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3348,-2848.93 3179,-2848.93 3179,-2804.93 3348,-2804.93 3348,-2848.93"/>
<text text-anchor="middle" x="3263.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 49 L13</text>
<text text-anchor="middle" x="3263.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_49_s2_l13 -->
<g id="edge1002" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_49_s2_l13</title>
<path fill="none" stroke="black" d="M3059.28,-2891.24C3098.53,-2879.07 3146.2,-2864.3 3185.6,-2852.08"/>
<polygon fill="black" stroke="black" points="3186.92,-2855.34 3195.43,-2849.03 3184.84,-2848.65 3186.92,-2855.34"/>
</g>
<!-- expert_50_s2_l13 -->
<g id="node601" class="node">
<title>expert_50_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3535,-2848.93 3366,-2848.93 3366,-2804.93 3535,-2804.93 3535,-2848.93"/>
<text text-anchor="middle" x="3450.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 50 L13</text>
<text text-anchor="middle" x="3450.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_50_s2_l13 -->
<g id="edge1003" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_50_s2_l13</title>
<path fill="none" stroke="black" d="M3085.81,-2898.19C3158.76,-2885.97 3259.03,-2868.53 3355.92,-2849.21"/>
<polygon fill="black" stroke="black" points="3356.77,-2852.61 3365.89,-2847.22 3355.4,-2845.75 3356.77,-2852.61"/>
</g>
<!-- expert_51_s2_l13 -->
<g id="node602" class="node">
<title>expert_51_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3722,-2848.93 3553,-2848.93 3553,-2804.93 3722,-2804.93 3722,-2848.93"/>
<text text-anchor="middle" x="3637.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 51 L13</text>
<text text-anchor="middle" x="3637.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_51_s2_l13 -->
<g id="edge1004" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_51_s2_l13</title>
<path fill="none" stroke="black" d="M3100.07,-2904.84C3211.79,-2894.3 3384.6,-2875.84 3543,-2849.11"/>
<polygon fill="black" stroke="black" points="3543.66,-2852.55 3552.93,-2847.42 3542.48,-2845.65 3543.66,-2852.55"/>
</g>
<!-- expert_52_s2_l13 -->
<g id="node603" class="node">
<title>expert_52_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3909,-2848.93 3740,-2848.93 3740,-2804.93 3909,-2804.93 3909,-2848.93"/>
<text text-anchor="middle" x="3824.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 52 L13</text>
<text text-anchor="middle" x="3824.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_52_s2_l13 -->
<g id="edge1005" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_52_s2_l13</title>
<path fill="none" stroke="black" d="M3105.39,-2909.26C3252.09,-2901.21 3504.87,-2883.7 3729.93,-2849.08"/>
<polygon fill="black" stroke="black" points="3730.6,-2852.52 3739.95,-2847.53 3729.53,-2845.6 3730.6,-2852.52"/>
</g>
<!-- expert_53_s2_l13 -->
<g id="node604" class="node">
<title>expert_53_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="4096,-2848.93 3927,-2848.93 3927,-2804.93 4096,-2804.93 4096,-2848.93"/>
<text text-anchor="middle" x="4011.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 53 L13</text>
<text text-anchor="middle" x="4011.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_53_s2_l13 -->
<g id="edge1006" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_53_s2_l13</title>
<path fill="none" stroke="black" d="M3107.68,-2912.22C3285.8,-2906.86 3622.55,-2891.75 3916.94,-2849.06"/>
<polygon fill="black" stroke="black" points="3917.57,-2852.5 3926.96,-2847.59 3916.55,-2845.58 3917.57,-2852.5"/>
</g>
<!-- expert_54_s2_l13 -->
<g id="node605" class="node">
<title>expert_54_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="4283,-2848.93 4114,-2848.93 4114,-2804.93 4283,-2804.93 4283,-2848.93"/>
<text text-anchor="middle" x="4198.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 54 L13</text>
<text text-anchor="middle" x="4198.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_54_s2_l13 -->
<g id="edge1007" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_54_s2_l13</title>
<path fill="none" stroke="black" d="M3108.22,-2914.32C3314.67,-2911.65 3738.31,-2899.96 4103.98,-2849.04"/>
<polygon fill="black" stroke="black" points="4104.55,-2852.49 4113.96,-2847.63 4103.57,-2845.56 4104.55,-2852.49"/>
</g>
<!-- expert_55_s2_l13 -->
<g id="node606" class="node">
<title>expert_55_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="4470,-2848.93 4301,-2848.93 4301,-2804.93 4470,-2804.93 4470,-2848.93"/>
<text text-anchor="middle" x="4385.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 55 L13</text>
<text text-anchor="middle" x="4385.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_55_s2_l13 -->
<g id="edge1008" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_55_s2_l13</title>
<path fill="none" stroke="black" d="M3108.71,-2915.85C3341.33,-2915.75 3853.2,-2908.2 4290.96,-2849.03"/>
<polygon fill="black" stroke="black" points="4291.53,-2852.48 4300.97,-2847.67 4290.58,-2845.55 4291.53,-2852.48"/>
</g>
<!-- expert_56_s2_l13 -->
<g id="node607" class="node">
<title>expert_56_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="4657,-2848.93 4488,-2848.93 4488,-2804.93 4657,-2804.93 4657,-2848.93"/>
<text text-anchor="middle" x="4572.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 56 L13</text>
<text text-anchor="middle" x="4572.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_56_s2_l13 -->
<g id="edge1009" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_56_s2_l13</title>
<path fill="none" stroke="black" d="M3107.58,-2912.39C3413.87,-2905.42 4196.36,-2884.76 4477.77,-2849.02"/>
<polygon fill="black" stroke="black" points="4478.51,-2852.45 4487.97,-2847.69 4477.6,-2845.51 4478.51,-2852.45"/>
</g>
<!-- expert_57_s2_l13 -->
<g id="node608" class="node">
<title>expert_57_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="4844,-2848.93 4675,-2848.93 4675,-2804.93 4844,-2804.93 4844,-2848.93"/>
<text text-anchor="middle" x="4759.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 57 L13</text>
<text text-anchor="middle" x="4759.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_57_s2_l13 -->
<g id="edge1010" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_57_s2_l13</title>
<path fill="none" stroke="black" d="M3107.91,-2913.09C3441.37,-2907.44 4345.64,-2888.91 4664.78,-2849.01"/>
<polygon fill="black" stroke="black" points="4665.5,-2852.45 4674.97,-2847.71 4664.61,-2845.51 4665.5,-2852.45"/>
</g>
<!-- expert_58_s2_l13 -->
<g id="node609" class="node">
<title>expert_58_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="5031,-2848.93 4862,-2848.93 4862,-2804.93 5031,-2804.93 5031,-2848.93"/>
<text text-anchor="middle" x="4946.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 58 L13</text>
<text text-anchor="middle" x="4946.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_58_s2_l13 -->
<g id="edge1011" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_58_s2_l13</title>
<path fill="none" stroke="black" d="M3108.26,-2913.66C3467.53,-2909.23 4494.93,-2893.08 4851.87,-2849"/>
<polygon fill="black" stroke="black" points="4852.49,-2852.45 4861.97,-2847.72 4851.61,-2845.5 4852.49,-2852.45"/>
</g>
<!-- expert_59_s2_l13 -->
<g id="node610" class="node">
<title>expert_59_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="5218,-2848.93 5049,-2848.93 5049,-2804.93 5218,-2804.93 5218,-2848.93"/>
<text text-anchor="middle" x="5133.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 59 L13</text>
<text text-anchor="middle" x="5133.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_59_s2_l13 -->
<g id="edge1012" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_59_s2_l13</title>
<path fill="none" stroke="black" d="M3108.28,-2914.13C3491.82,-2910.87 4643.94,-2897.29 5038.93,-2848.99"/>
<polygon fill="black" stroke="black" points="5039.49,-2852.45 5048.97,-2847.73 5038.62,-2845.5 5039.49,-2852.45"/>
</g>
<!-- expert_60_s2_l13 -->
<g id="node611" class="node">
<title>expert_60_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="5405,-2848.93 5236,-2848.93 5236,-2804.93 5405,-2804.93 5405,-2848.93"/>
<text text-anchor="middle" x="5320.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 60 L13</text>
<text text-anchor="middle" x="5320.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_60_s2_l13 -->
<g id="edge1013" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_60_s2_l13</title>
<path fill="none" stroke="black" d="M3108.37,-2914.53C3515.16,-2912.36 4792.68,-2901.52 5225.9,-2848.99"/>
<polygon fill="black" stroke="black" points="5226.48,-2852.45 5235.98,-2847.74 5225.62,-2845.5 5226.48,-2852.45"/>
</g>
<!-- expert_61_s2_l13 -->
<g id="node612" class="node">
<title>expert_61_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="5592,-2848.93 5423,-2848.93 5423,-2804.93 5592,-2804.93 5592,-2848.93"/>
<text text-anchor="middle" x="5507.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 61 L13</text>
<text text-anchor="middle" x="5507.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_61_s2_l13 -->
<g id="edge1014" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_61_s2_l13</title>
<path fill="none" stroke="black" d="M3108.54,-2914.86C3537.8,-2913.73 4941.67,-2905.77 5413.04,-2848.97"/>
<polygon fill="black" stroke="black" points="5413.48,-2852.44 5422.98,-2847.75 5412.62,-2845.5 5413.48,-2852.44"/>
</g>
<!-- expert_62_s2_l13 -->
<g id="node613" class="node">
<title>expert_62_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="5779,-2848.93 5610,-2848.93 5610,-2804.93 5779,-2804.93 5779,-2848.93"/>
<text text-anchor="middle" x="5694.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 62 L13</text>
<text text-anchor="middle" x="5694.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_62_s2_l13 -->
<g id="edge1015" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_62_s2_l13</title>
<path fill="none" stroke="black" d="M3108.69,-2915.15C3559.49,-2915.01 5090.14,-2910.02 5599.96,-2848.98"/>
<polygon fill="black" stroke="black" points="5600.48,-2852.44 5609.98,-2847.76 5599.63,-2845.49 5600.48,-2852.44"/>
</g>
<!-- expert_63_s2_l13 -->
<g id="node614" class="node">
<title>expert_63_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="5966,-2848.93 5797,-2848.93 5797,-2804.93 5966,-2804.93 5966,-2848.93"/>
<text text-anchor="middle" x="5881.5" y="-2838.53" font-family="Arial" font-size="8.00">Expert 63 L13</text>
<text text-anchor="middle" x="5881.5" y="-2829.53" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-2820.53" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-2811.53" font-family="Arial" font-size="8.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2_l13&#45;&gt;expert_63_s2_l13 -->
<g id="edge1016" class="edge">
<title>expert_dispatch_s2_l13&#45;&gt;expert_63_s2_l13</title>
<path fill="none" stroke="black" d="M3108.62,-2915.4C3579.98,-2916.2 5238.67,-2914.3 5787,-2848.97"/>
<polygon fill="black" stroke="black" points="5787.47,-2852.44 5796.98,-2847.76 5786.63,-2845.49 5787.47,-2852.44"/>
</g>
<!-- expert_combine_s2_l13 -->
<g id="node615" class="node">
<title>expert_combine_s2_l13</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-2737.82" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-2749.42" font-family="Arial" font-size="8.00">Expert Combine L13 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-2740.42" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-2731.42" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2722.42" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1017" class="edge">
<title>expert_32_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M169.02,-2806.1C171.88,-2805.67 174.71,-2805.27 177.5,-2804.93 702.97,-2740.06 2358.67,-2737.69 2846.17,-2738.45"/>
<polygon fill="black" stroke="black" points="2846.42,-2741.95 2856.42,-2738.47 2846.43,-2734.95 2846.42,-2741.95"/>
</g>
<!-- expert_33_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1018" class="edge">
<title>expert_33_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M356.02,-2806.1C358.88,-2805.67 361.71,-2805.28 364.5,-2804.93 851.71,-2744.37 2380.13,-2738.94 2846.21,-2738.72"/>
<polygon fill="black" stroke="black" points="2846.36,-2742.22 2856.36,-2738.72 2846.36,-2735.22 2846.36,-2742.22"/>
</g>
<!-- expert_34_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1019" class="edge">
<title>expert_34_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M543.02,-2806.11C545.88,-2805.68 548.71,-2805.28 551.5,-2804.93 1000.54,-2748.67 2402.24,-2740.27 2846.2,-2739.03"/>
<polygon fill="black" stroke="black" points="2846.52,-2742.53 2856.51,-2739 2846.5,-2735.53 2846.52,-2742.53"/>
</g>
<!-- expert_35_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1020" class="edge">
<title>expert_35_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M730.02,-2806.12C732.88,-2805.68 735.71,-2805.28 738.5,-2804.93 1149.63,-2752.95 2426.08,-2741.71 2846.61,-2739.39"/>
<polygon fill="black" stroke="black" points="2846.7,-2742.89 2856.69,-2739.34 2846.67,-2735.89 2846.7,-2742.89"/>
</g>
<!-- expert_36_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1021" class="edge">
<title>expert_36_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M917.03,-2806.13C919.88,-2805.69 922.71,-2805.29 925.5,-2804.93 1298.74,-2757.23 2450.22,-2743.27 2846.7,-2739.82"/>
<polygon fill="black" stroke="black" points="2846.81,-2743.32 2856.78,-2739.73 2846.75,-2736.32 2846.81,-2743.32"/>
</g>
<!-- expert_37_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1022" class="edge">
<title>expert_37_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M1104.03,-2806.14C1106.88,-2805.7 1109.71,-2805.29 1112.5,-2804.93 1447.94,-2761.52 2474.98,-2744.99 2846.54,-2740.33"/>
<polygon fill="black" stroke="black" points="2846.85,-2743.83 2856.8,-2740.2 2846.76,-2736.83 2846.85,-2743.83"/>
</g>
<!-- expert_38_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1023" class="edge">
<title>expert_38_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M1291.03,-2806.15C1293.88,-2805.71 1296.71,-2805.3 1299.5,-2804.93 1597.53,-2765.76 2502.38,-2746.86 2847.13,-2740.94"/>
<polygon fill="black" stroke="black" points="2847.23,-2744.44 2857.17,-2740.77 2847.11,-2737.44 2847.23,-2744.44"/>
</g>
<!-- expert_39_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1024" class="edge">
<title>expert_39_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M1478.03,-2806.17C1480.88,-2805.72 1483.71,-2805.3 1486.5,-2804.93 1747.22,-2770.02 2530.56,-2748.99 2847.35,-2741.71"/>
<polygon fill="black" stroke="black" points="2847.58,-2745.21 2857.5,-2741.48 2847.42,-2738.21 2847.58,-2745.21"/>
</g>
<!-- expert_40_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1025" class="edge">
<title>expert_40_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M1665.03,-2806.2C1667.88,-2805.74 1670.71,-2805.31 1673.5,-2804.93 2098.54,-2746.65 2607.53,-2738.35 2846.26,-2738.03"/>
<polygon fill="black" stroke="black" points="2846.39,-2741.53 2856.38,-2738.02 2846.38,-2734.53 2846.39,-2741.53"/>
</g>
<!-- expert_41_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1026" class="edge">
<title>expert_41_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M1852.04,-2806.23C1854.89,-2805.76 1857.71,-2805.32 1860.5,-2804.93 2213.6,-2755 2634.37,-2742.67 2846.24,-2739.7"/>
<polygon fill="black" stroke="black" points="2846.52,-2743.19 2856.48,-2739.56 2846.43,-2736.19 2846.52,-2743.19"/>
</g>
<!-- expert_42_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1027" class="edge">
<title>expert_42_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M2039.05,-2806.27C2041.89,-2805.79 2044.72,-2805.34 2047.5,-2804.93 2330.13,-2763.27 2664.83,-2747.66 2847.27,-2741.96"/>
<polygon fill="black" stroke="black" points="2847.57,-2745.45 2857.46,-2741.65 2847.35,-2738.46 2847.57,-2745.45"/>
</g>
<!-- expert_43_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1028" class="edge">
<title>expert_43_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M2226.05,-2806.33C2228.9,-2805.83 2231.72,-2805.36 2234.5,-2804.93 2448.23,-2771.51 2699.16,-2753.64 2849.26,-2745.2"/>
<polygon fill="black" stroke="black" points="2849.66,-2748.68 2859.45,-2744.63 2849.27,-2741.69 2849.66,-2748.68"/>
</g>
<!-- expert_44_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1029" class="edge">
<title>expert_44_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M2413.07,-2806.44C2415.91,-2805.91 2418.73,-2805.41 2421.5,-2804.93 2569.28,-2779.61 2740.64,-2760.95 2854.7,-2750.03"/>
<polygon fill="black" stroke="black" points="2855.24,-2753.49 2864.87,-2749.06 2854.58,-2746.53 2855.24,-2753.49"/>
</g>
<!-- expert_45_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1030" class="edge">
<title>expert_45_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M2600.11,-2806.65C2602.94,-2806.06 2605.74,-2805.49 2608.5,-2804.93 2695.55,-2787.42 2794.51,-2770.04 2868.76,-2757.49"/>
<polygon fill="black" stroke="black" points="2869.79,-2760.87 2879.07,-2755.75 2868.63,-2753.97 2869.79,-2760.87"/>
</g>
<!-- expert_46_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1031" class="edge">
<title>expert_46_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M2770.28,-2804.84C2808.19,-2793.05 2855.83,-2778.23 2896.36,-2765.62"/>
<polygon fill="black" stroke="black" points="2897.45,-2768.94 2905.96,-2762.63 2895.37,-2762.26 2897.45,-2768.94"/>
</g>
<!-- expert_47_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1032" class="edge">
<title>expert_47_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M2912.01,-2804.84C2921.53,-2795.92 2932.9,-2785.27 2943.7,-2775.16"/>
<polygon fill="black" stroke="black" points="2946.15,-2777.66 2951.06,-2768.27 2941.37,-2772.55 2946.15,-2777.66"/>
</g>
<!-- expert_48_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1033" class="edge">
<title>expert_48_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M3053.75,-2804.84C3044.12,-2795.92 3032.63,-2785.27 3021.71,-2775.16"/>
<polygon fill="black" stroke="black" points="3023.99,-2772.5 3014.28,-2768.27 3019.23,-2777.63 3023.99,-2772.5"/>
</g>
<!-- expert_49_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1034" class="edge">
<title>expert_49_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M3195.48,-2804.84C3157.36,-2793.03 3109.44,-2778.17 3068.71,-2765.54"/>
<polygon fill="black" stroke="black" points="3069.65,-2762.17 3059.06,-2762.55 3067.58,-2768.86 3069.65,-2762.17"/>
</g>
<!-- expert_50_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1035" class="edge">
<title>expert_50_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M3365.89,-2806.65C3363.06,-2806.06 3360.26,-2805.48 3357.5,-2804.93 3269.89,-2787.33 3170.24,-2769.88 3095.69,-2757.33"/>
<polygon fill="black" stroke="black" points="3096.25,-2753.88 3085.81,-2755.67 3095.09,-2760.78 3096.25,-2753.88"/>
</g>
<!-- expert_51_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1036" class="edge">
<title>expert_51_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M3552.93,-2806.44C3550.09,-2805.91 3547.27,-2805.41 3544.5,-2804.93 3396.34,-2779.56 3224.52,-2760.9 3110.26,-2749.99"/>
<polygon fill="black" stroke="black" points="3110.36,-2746.48 3100.07,-2749.02 3109.69,-2753.45 3110.36,-2746.48"/>
</g>
<!-- expert_52_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1037" class="edge">
<title>expert_52_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M3739.95,-2806.33C3737.1,-2805.83 3734.28,-2805.36 3731.5,-2804.93 3517.33,-2771.45 3265.85,-2753.59 3115.58,-2745.17"/>
<polygon fill="black" stroke="black" points="3115.57,-2741.66 3105.39,-2744.6 3115.18,-2748.65 3115.57,-2741.66"/>
</g>
<!-- expert_53_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1038" class="edge">
<title>expert_53_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M3926.96,-2806.27C3924.11,-2805.79 3921.28,-2805.34 3918.5,-2804.93 3635.57,-2763.24 3300.51,-2747.64 3117.87,-2741.95"/>
<polygon fill="black" stroke="black" points="3117.78,-2738.44 3107.68,-2741.64 3117.57,-2745.44 3117.78,-2738.44"/>
</g>
<!-- expert_54_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1039" class="edge">
<title>expert_54_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M4113.96,-2806.23C4111.11,-2805.76 4108.29,-2805.32 4105.5,-2804.93 3751.85,-2754.93 3330.37,-2742.63 3118.46,-2739.68"/>
<polygon fill="black" stroke="black" points="3118.26,-2736.18 3108.22,-2739.54 3118.17,-2743.18 3118.26,-2736.18"/>
</g>
<!-- expert_55_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1040" class="edge">
<title>expert_55_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M4300.97,-2806.2C4298.12,-2805.74 4295.29,-2805.31 4292.5,-2804.93 3867.13,-2746.61 3357.75,-2738.33 3118.84,-2738.02"/>
<polygon fill="black" stroke="black" points="3118.72,-2734.52 3108.71,-2738.01 3118.71,-2741.52 3118.72,-2734.52"/>
</g>
<!-- expert_56_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1041" class="edge">
<title>expert_56_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M4487.97,-2806.17C4485.12,-2805.72 4482.29,-2805.3 4479.5,-2804.93 4218.6,-2770 3434.74,-2748.98 3117.74,-2741.71"/>
<polygon fill="black" stroke="black" points="3117.66,-2738.2 3107.58,-2741.48 3117.5,-2745.2 3117.66,-2738.2"/>
</g>
<!-- expert_57_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1042" class="edge">
<title>expert_57_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M4674.97,-2806.15C4672.12,-2805.71 4669.29,-2805.3 4666.5,-2804.93 4368.29,-2765.74 3462.9,-2746.86 3117.95,-2740.94"/>
<polygon fill="black" stroke="black" points="3117.97,-2737.44 3107.91,-2740.77 3117.85,-2744.44 3117.97,-2737.44"/>
</g>
<!-- expert_58_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1043" class="edge">
<title>expert_58_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M4861.97,-2806.14C4859.12,-2805.7 4856.29,-2805.29 4853.5,-2804.93 4517.88,-2761.5 3490.29,-2744.98 3118.53,-2740.33"/>
<polygon fill="black" stroke="black" points="3118.31,-2736.82 3108.26,-2740.2 3118.22,-2743.82 3118.31,-2736.82"/>
</g>
<!-- expert_59_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1044" class="edge">
<title>expert_59_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M5048.97,-2806.13C5046.12,-2805.69 5043.29,-2805.29 5040.5,-2804.93 4667.07,-2757.21 3515.04,-2743.26 3118.36,-2739.81"/>
<polygon fill="black" stroke="black" points="3118.31,-2736.31 3108.28,-2739.73 3118.25,-2743.31 3118.31,-2736.31"/>
</g>
<!-- expert_60_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1045" class="edge">
<title>expert_60_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M5235.98,-2806.12C5233.12,-2805.68 5230.29,-2805.28 5227.5,-2804.93 4816.19,-2752.93 3539.17,-2741.7 3118.45,-2739.39"/>
<polygon fill="black" stroke="black" points="3118.39,-2735.89 3108.37,-2739.33 3118.35,-2742.89 3118.39,-2735.89"/>
</g>
<!-- expert_61_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1046" class="edge">
<title>expert_61_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M5422.98,-2806.11C5420.12,-2805.68 5417.29,-2805.28 5414.5,-2804.93 4965.28,-2748.65 3563,-2740.27 3118.86,-2739.03"/>
<polygon fill="black" stroke="black" points="3118.55,-2735.53 3108.54,-2739 3118.53,-2742.53 3118.55,-2735.53"/>
</g>
<!-- expert_62_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1047" class="edge">
<title>expert_62_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M5609.98,-2806.1C5607.12,-2805.67 5604.29,-2805.28 5601.5,-2804.93 5114.1,-2744.35 3585.1,-2738.93 3118.84,-2738.72"/>
<polygon fill="black" stroke="black" points="3118.69,-2735.22 3108.69,-2738.71 3118.69,-2742.22 3118.69,-2735.22"/>
</g>
<!-- expert_63_s2_l13&#45;&gt;expert_combine_s2_l13 -->
<g id="edge1048" class="edge">
<title>expert_63_s2_l13&#45;&gt;expert_combine_s2_l13</title>
<path fill="none" stroke="black" d="M5796.98,-2806.1C5794.12,-2805.67 5791.29,-2805.27 5788.5,-2804.93 5262.84,-2740.04 3606.55,-2737.68 3118.88,-2738.45"/>
<polygon fill="black" stroke="black" points="3118.62,-2734.95 3108.62,-2738.46 3118.63,-2741.95 3118.62,-2734.95"/>
</g>
<!-- moe_out_proj_s2_l13 -->
<g id="node616" class="node">
<title>moe_out_proj_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-2670.7 2893.5,-2670.7 2893.5,-2626.7 3071.5,-2626.7 3071.5,-2670.7"/>
<text text-anchor="middle" x="2982.5" y="-2660.3" font-family="Arial" font-size="8.00">MoE Output Proj L13 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-2651.3" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2642.3" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2633.3" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2_l13&#45;&gt;moe_out_proj_s2_l13 -->
<g id="edge1049" class="edge">
<title>expert_combine_s2_l13&#45;&gt;moe_out_proj_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-2706.35C2982.5,-2698.07 2982.5,-2689.09 2982.5,-2680.78"/>
<polygon fill="black" stroke="black" points="2986,-2680.71 2982.5,-2670.71 2979,-2680.71 2986,-2680.71"/>
</g>
<!-- allreduce_moe_out_s2_l13 -->
<g id="node617" class="node">
<title>allreduce_moe_out_s2_l13</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-2559.59" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-2571.19" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L13</text>
<text text-anchor="middle" x="2982.5" y="-2562.19" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2553.19" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2544.19" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2_l13&#45;&gt;allreduce_moe_out_s2_l13 -->
<g id="edge1050" class="edge">
<title>moe_out_proj_s2_l13&#45;&gt;allreduce_moe_out_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-2626.62C2982.5,-2618.94 2982.5,-2609.99 2982.5,-2601.2"/>
<polygon fill="black" stroke="black" points="2986,-2601.04 2982.5,-2591.04 2979,-2601.04 2986,-2601.04"/>
</g>
<!-- layernorm2_s2_l13 -->
<g id="node618" class="node">
<title>layernorm2_s2_l13</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-2492.48 2893.5,-2492.48 2893.5,-2448.48 3071.5,-2448.48 3071.5,-2492.48"/>
<text text-anchor="middle" x="2982.5" y="-2482.08" font-family="Arial" font-size="8.00">LayerNorm 2 (L13)</text>
<text text-anchor="middle" x="2982.5" y="-2473.08" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2464.08" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2455.08" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2_l13&#45;&gt;layernorm2_s2_l13 -->
<g id="edge1051" class="edge">
<title>allreduce_moe_out_s2_l13&#45;&gt;layernorm2_s2_l13</title>
<path fill="none" stroke="black" d="M2982.5,-2528.12C2982.5,-2519.84 2982.5,-2510.87 2982.5,-2502.56"/>
<polygon fill="black" stroke="black" points="2986,-2502.48 2982.5,-2492.48 2979,-2502.48 2986,-2502.48"/>
</g>
<!-- layernorm1_s2_l14 -->
<g id="node619" class="node">
<title>layernorm1_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-2412.48 2893.5,-2412.48 2893.5,-2368.48 3071.5,-2368.48 3071.5,-2412.48"/>
<text text-anchor="middle" x="2982.5" y="-2402.08" font-family="Arial" font-size="8.00">LayerNorm 1 (L14)</text>
<text text-anchor="middle" x="2982.5" y="-2393.08" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2384.08" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2375.08" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm2_s2_l13&#45;&gt;layernorm1_s2_l14 -->
<g id="edge1052" class="edge">
<title>layernorm2_s2_l13&#45;&gt;layernorm1_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-2448.17C2982.5,-2440.28 2982.5,-2431.16 2982.5,-2422.58"/>
<polygon fill="black" stroke="black" points="2986,-2422.5 2982.5,-2412.5 2979,-2422.5 2986,-2422.5"/>
</g>
<!-- qkv_proj_s2_l14 -->
<g id="node620" class="node">
<title>qkv_proj_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3081,-2332.48 2884,-2332.48 2884,-2288.48 3081,-2288.48 3081,-2332.48"/>
<text text-anchor="middle" x="2982.5" y="-2322.08" font-family="Arial" font-size="8.00">QKV Projection L14 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-2313.08" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2304.08" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-2295.08" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2_l14&#45;&gt;qkv_proj_s2_l14 -->
<g id="edge1053" class="edge">
<title>layernorm1_s2_l14&#45;&gt;qkv_proj_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-2368.17C2982.5,-2360.28 2982.5,-2351.16 2982.5,-2342.58"/>
<polygon fill="black" stroke="black" points="2986,-2342.5 2982.5,-2332.5 2979,-2342.5 2986,-2342.5"/>
</g>
<!-- allreduce_qkv_s2_l14 -->
<g id="node621" class="node">
<title>allreduce_qkv_s2_l14</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-2221.37" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-2232.97" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L14</text>
<text text-anchor="middle" x="2982.5" y="-2223.97" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-2214.97" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-2205.97" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2_l14&#45;&gt;allreduce_qkv_s2_l14 -->
<g id="edge1054" class="edge">
<title>qkv_proj_s2_l14&#45;&gt;allreduce_qkv_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-2288.39C2982.5,-2280.72 2982.5,-2271.77 2982.5,-2262.97"/>
<polygon fill="black" stroke="black" points="2986,-2262.81 2982.5,-2252.81 2979,-2262.81 2986,-2262.81"/>
</g>
<!-- attention_s2_l14 -->
<g id="node622" class="node">
<title>attention_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3081,-2154.25 2884,-2154.25 2884,-2110.25 3081,-2110.25 3081,-2154.25"/>
<text text-anchor="middle" x="2982.5" y="-2143.85" font-family="Arial" font-size="8.00">Self&#45;Attention L14</text>
<text text-anchor="middle" x="2982.5" y="-2134.85" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-2125.85" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-2116.85" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2_l14&#45;&gt;attention_s2_l14 -->
<g id="edge1055" class="edge">
<title>allreduce_qkv_s2_l14&#45;&gt;attention_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-2189.9C2982.5,-2181.62 2982.5,-2172.64 2982.5,-2164.33"/>
<polygon fill="black" stroke="black" points="2986,-2164.26 2982.5,-2154.26 2979,-2164.26 2986,-2164.26"/>
</g>
<!-- attn_out_proj_s2_l14 -->
<g id="node623" class="node">
<title>attn_out_proj_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3078,-2074.25 2887,-2074.25 2887,-2030.25 3078,-2030.25 3078,-2074.25"/>
<text text-anchor="middle" x="2982.5" y="-2063.85" font-family="Arial" font-size="8.00">Attention Output Proj L14 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-2054.85" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-2045.85" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-2036.85" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2_l14&#45;&gt;attn_out_proj_s2_l14 -->
<g id="edge1056" class="edge">
<title>attention_s2_l14&#45;&gt;attn_out_proj_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-2109.94C2982.5,-2102.05 2982.5,-2092.94 2982.5,-2084.36"/>
<polygon fill="black" stroke="black" points="2986,-2084.27 2982.5,-2074.27 2979,-2084.27 2986,-2084.27"/>
</g>
<!-- allreduce_attn_out_s2_l14 -->
<g id="node624" class="node">
<title>allreduce_attn_out_s2_l14</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-1963.14" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-1974.74" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L14</text>
<text text-anchor="middle" x="2982.5" y="-1965.74" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1956.74" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1947.74" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2_l14&#45;&gt;allreduce_attn_out_s2_l14 -->
<g id="edge1057" class="edge">
<title>attn_out_proj_s2_l14&#45;&gt;allreduce_attn_out_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-2030.17C2982.5,-2022.49 2982.5,-2013.54 2982.5,-2004.75"/>
<polygon fill="black" stroke="black" points="2986,-2004.59 2982.5,-1994.59 2979,-2004.59 2986,-2004.59"/>
</g>
<!-- moe_gate_s2_l14 -->
<g id="node625" class="node">
<title>moe_gate_s2_l14</title>
<polygon fill="orange" stroke="black" points="3167.08,-1896.03 2873.45,-1896.03 2797.92,-1808.03 3091.55,-1808.03 3167.08,-1896.03"/>
<text text-anchor="middle" x="2982.5" y="-1863.63" font-family="Arial" font-size="8.00">MoE Gate L14 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-1854.63" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1845.63" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1836.63" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2_l14&#45;&gt;moe_gate_s2_l14 -->
<g id="edge1058" class="edge">
<title>allreduce_attn_out_s2_l14&#45;&gt;moe_gate_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-1931.75C2982.5,-1923.86 2982.5,-1915.13 2982.5,-1906.44"/>
<polygon fill="black" stroke="black" points="2986,-1906.31 2982.5,-1896.31 2979,-1906.31 2986,-1906.31"/>
</g>
<!-- expert_dispatch_s2_l14 -->
<g id="node626" class="node">
<title>expert_dispatch_s2_l14</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-1740.92" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-1752.52" font-family="Arial" font-size="8.00">Expert Dispatch L14 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-1743.52" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1734.52" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1725.52" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2_l14&#45;&gt;expert_dispatch_s2_l14 -->
<g id="edge1059" class="edge">
<title>moe_gate_s2_l14&#45;&gt;expert_dispatch_s2_l14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-1807.9C2982.5,-1799.53 2982.5,-1790.77 2982.5,-1782.48"/>
<polygon fill="black" stroke="black" points="2986,-1782.29 2982.5,-1772.29 2979,-1782.29 2986,-1782.29"/>
</g>
<!-- expert_32_s2_l14 -->
<g id="node627" class="node">
<title>expert_32_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="169,-1673.8 0,-1673.8 0,-1629.8 169,-1629.8 169,-1673.8"/>
<text text-anchor="middle" x="84.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 32 L14</text>
<text text-anchor="middle" x="84.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_32_s2_l14 -->
<g id="edge1060" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_32_s2_l14</title>
<path fill="none" stroke="black" d="M2856.42,-1740.27C2385.23,-1741.07 727.13,-1739.16 178.99,-1673.85"/>
<polygon fill="black" stroke="black" points="179.37,-1670.37 169.02,-1672.64 178.53,-1677.32 179.37,-1670.37"/>
</g>
<!-- expert_33_s2_l14 -->
<g id="node628" class="node">
<title>expert_33_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="356,-1673.8 187,-1673.8 187,-1629.8 356,-1629.8 356,-1673.8"/>
<text text-anchor="middle" x="271.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 33 L14</text>
<text text-anchor="middle" x="271.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_33_s2_l14 -->
<g id="edge1061" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_33_s2_l14</title>
<path fill="none" stroke="black" d="M2856.36,-1740.02C2405.73,-1739.87 875.66,-1734.88 366.03,-1673.85"/>
<polygon fill="black" stroke="black" points="366.37,-1670.37 356.02,-1672.63 365.52,-1677.32 366.37,-1670.37"/>
</g>
<!-- expert_34_s2_l14 -->
<g id="node629" class="node">
<title>expert_34_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="543,-1673.8 374,-1673.8 374,-1629.8 543,-1629.8 543,-1673.8"/>
<text text-anchor="middle" x="458.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 34 L14</text>
<text text-anchor="middle" x="458.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_34_s2_l14 -->
<g id="edge1062" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_34_s2_l14</title>
<path fill="none" stroke="black" d="M2856.51,-1739.73C2427.43,-1738.6 1024.14,-1730.62 552.96,-1673.84"/>
<polygon fill="black" stroke="black" points="553.38,-1670.37 543.02,-1672.62 552.52,-1677.32 553.38,-1670.37"/>
</g>
<!-- expert_35_s2_l14 -->
<g id="node630" class="node">
<title>expert_35_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="730,-1673.8 561,-1673.8 561,-1629.8 730,-1629.8 730,-1673.8"/>
<text text-anchor="middle" x="645.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 35 L14</text>
<text text-anchor="middle" x="645.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_35_s2_l14 -->
<g id="edge1063" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_35_s2_l14</title>
<path fill="none" stroke="black" d="M2856.69,-1739.4C2450.07,-1737.22 1173.13,-1726.38 740.1,-1673.86"/>
<polygon fill="black" stroke="black" points="740.38,-1670.37 730.02,-1672.61 739.52,-1677.32 740.38,-1670.37"/>
</g>
<!-- expert_36_s2_l14 -->
<g id="node631" class="node">
<title>expert_36_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="917,-1673.8 748,-1673.8 748,-1629.8 917,-1629.8 917,-1673.8"/>
<text text-anchor="middle" x="832.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 36 L14</text>
<text text-anchor="middle" x="832.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_36_s2_l14 -->
<g id="edge1064" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_36_s2_l14</title>
<path fill="none" stroke="black" d="M2856.78,-1739C2473.43,-1735.73 1321.87,-1722.15 927.06,-1673.86"/>
<polygon fill="black" stroke="black" points="927.38,-1670.37 917.03,-1672.6 926.51,-1677.32 927.38,-1670.37"/>
</g>
<!-- expert_37_s2_l14 -->
<g id="node632" class="node">
<title>expert_37_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="1104,-1673.8 935,-1673.8 935,-1629.8 1104,-1629.8 1104,-1673.8"/>
<text text-anchor="middle" x="1019.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 37 L14</text>
<text text-anchor="middle" x="1019.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_37_s2_l14 -->
<g id="edge1065" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_37_s2_l14</title>
<path fill="none" stroke="black" d="M2856.8,-1738.53C2497.73,-1734.1 1470.88,-1717.94 1114.13,-1673.87"/>
<polygon fill="black" stroke="black" points="1114.39,-1670.38 1104.03,-1672.59 1113.51,-1677.32 1114.39,-1670.38"/>
</g>
<!-- expert_38_s2_l14 -->
<g id="node633" class="node">
<title>expert_38_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="1291,-1673.8 1122,-1673.8 1122,-1629.8 1291,-1629.8 1291,-1673.8"/>
<text text-anchor="middle" x="1206.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 38 L14</text>
<text text-anchor="middle" x="1206.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_38_s2_l14 -->
<g id="edge1066" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_38_s2_l14</title>
<path fill="none" stroke="black" d="M2857.17,-1737.96C2523.91,-1732.3 1620.17,-1713.76 1301.21,-1673.89"/>
<polygon fill="black" stroke="black" points="1301.39,-1670.38 1291.03,-1672.58 1300.5,-1677.32 1301.39,-1670.38"/>
</g>
<!-- expert_39_s2_l14 -->
<g id="node634" class="node">
<title>expert_39_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="1478,-1673.8 1309,-1673.8 1309,-1629.8 1478,-1629.8 1478,-1673.8"/>
<text text-anchor="middle" x="1393.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 39 L14</text>
<text text-anchor="middle" x="1393.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_39_s2_l14 -->
<g id="edge1067" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_39_s2_l14</title>
<path fill="none" stroke="black" d="M2857.5,-1737.26C2551.41,-1730.29 1769.45,-1709.61 1488.23,-1673.89"/>
<polygon fill="black" stroke="black" points="1488.4,-1670.39 1478.03,-1672.56 1487.49,-1677.33 1488.4,-1670.39"/>
</g>
<!-- expert_40_s2_l14 -->
<g id="node635" class="node">
<title>expert_40_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="1665,-1673.8 1496,-1673.8 1496,-1629.8 1665,-1629.8 1665,-1673.8"/>
<text text-anchor="middle" x="1580.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 40 L14</text>
<text text-anchor="middle" x="1580.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_40_s2_l14 -->
<g id="edge1068" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_40_s2_l14</title>
<path fill="none" stroke="black" d="M2856.38,-1740.71C2623.94,-1740.61 2112.47,-1733.04 1675.03,-1673.9"/>
<polygon fill="black" stroke="black" points="1675.42,-1670.42 1665.03,-1672.54 1674.47,-1677.36 1675.42,-1670.42"/>
</g>
<!-- expert_41_s2_l14 -->
<g id="node636" class="node">
<title>expert_41_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="1852,-1673.8 1683,-1673.8 1683,-1629.8 1852,-1629.8 1852,-1673.8"/>
<text text-anchor="middle" x="1767.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 41 L14</text>
<text text-anchor="middle" x="1767.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_41_s2_l14 -->
<g id="edge1069" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_41_s2_l14</title>
<path fill="none" stroke="black" d="M2856.48,-1739.18C2650.05,-1736.49 2227.11,-1724.76 1862.01,-1673.91"/>
<polygon fill="black" stroke="black" points="1862.43,-1670.43 1852.04,-1672.51 1861.45,-1677.36 1862.43,-1670.43"/>
</g>
<!-- expert_42_s2_l14 -->
<g id="node637" class="node">
<title>expert_42_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="2039,-1673.8 1870,-1673.8 1870,-1629.8 2039,-1629.8 2039,-1673.8"/>
<text text-anchor="middle" x="1954.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 42 L14</text>
<text text-anchor="middle" x="1954.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_42_s2_l14 -->
<g id="edge1070" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_42_s2_l14</title>
<path fill="none" stroke="black" d="M2857.46,-1737.09C2679.53,-1731.72 2343.14,-1716.59 2049.05,-1673.93"/>
<polygon fill="black" stroke="black" points="2049.45,-1670.45 2039.05,-1672.46 2048.43,-1677.38 2049.45,-1670.45"/>
</g>
<!-- expert_43_s2_l14 -->
<g id="node638" class="node">
<title>expert_43_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="2226,-1673.8 2057,-1673.8 2057,-1629.8 2226,-1629.8 2226,-1673.8"/>
<text text-anchor="middle" x="2141.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 43 L14</text>
<text text-anchor="middle" x="2141.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_43_s2_l14 -->
<g id="edge1071" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_43_s2_l14</title>
<path fill="none" stroke="black" d="M2859.45,-1734.1C2712.89,-1726.03 2460.66,-1708.52 2236.05,-1673.95"/>
<polygon fill="black" stroke="black" points="2236.47,-1670.48 2226.05,-1672.4 2235.4,-1677.39 2236.47,-1670.48"/>
</g>
<!-- expert_44_s2_l14 -->
<g id="node639" class="node">
<title>expert_44_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="2413,-1673.8 2244,-1673.8 2244,-1629.8 2413,-1629.8 2413,-1673.8"/>
<text text-anchor="middle" x="2328.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 44 L14</text>
<text text-anchor="middle" x="2328.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_44_s2_l14 -->
<g id="edge1072" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_44_s2_l14</title>
<path fill="none" stroke="black" d="M2864.87,-1729.67C2753.34,-1719.12 2580.99,-1700.66 2422.98,-1673.98"/>
<polygon fill="black" stroke="black" points="2423.52,-1670.52 2413.07,-1672.3 2422.34,-1677.42 2423.52,-1670.52"/>
</g>
<!-- expert_45_s2_l14 -->
<g id="node640" class="node">
<title>expert_45_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="2600,-1673.8 2431,-1673.8 2431,-1629.8 2600,-1629.8 2600,-1673.8"/>
<text text-anchor="middle" x="2515.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 45 L14</text>
<text text-anchor="middle" x="2515.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_45_s2_l14 -->
<g id="edge1073" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_45_s2_l14</title>
<path fill="none" stroke="black" d="M2879.07,-1722.98C2806.34,-1710.75 2706.53,-1693.34 2610.04,-1674.08"/>
<polygon fill="black" stroke="black" points="2610.6,-1670.62 2600.11,-1672.09 2609.23,-1677.48 2610.6,-1670.62"/>
</g>
<!-- expert_46_s2_l14 -->
<g id="node641" class="node">
<title>expert_46_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="2787,-1673.8 2618,-1673.8 2618,-1629.8 2787,-1629.8 2787,-1673.8"/>
<text text-anchor="middle" x="2702.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 46 L14</text>
<text text-anchor="middle" x="2702.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_46_s2_l14 -->
<g id="edge1074" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_46_s2_l14</title>
<path fill="none" stroke="black" d="M2905.99,-1716.11C2866.88,-1703.94 2819.39,-1689.17 2780.12,-1676.95"/>
<polygon fill="black" stroke="black" points="2780.91,-1673.53 2770.32,-1673.9 2778.83,-1680.22 2780.91,-1673.53"/>
</g>
<!-- expert_47_s2_l14 -->
<g id="node642" class="node">
<title>expert_47_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="2974,-1673.8 2805,-1673.8 2805,-1629.8 2974,-1629.8 2974,-1673.8"/>
<text text-anchor="middle" x="2889.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 47 L14</text>
<text text-anchor="middle" x="2889.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_47_s2_l14 -->
<g id="edge1075" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_47_s2_l14</title>
<path fill="none" stroke="black" d="M2951.27,-1710.67C2941.01,-1701.06 2929.64,-1690.4 2919.47,-1680.88"/>
<polygon fill="black" stroke="black" points="2921.66,-1678.14 2911.97,-1673.85 2916.88,-1683.25 2921.66,-1678.14"/>
</g>
<!-- expert_48_s2_l14 -->
<g id="node643" class="node">
<title>expert_48_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3161,-1673.8 2992,-1673.8 2992,-1629.8 3161,-1629.8 3161,-1673.8"/>
<text text-anchor="middle" x="3076.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 48 L14</text>
<text text-anchor="middle" x="3076.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_48_s2_l14 -->
<g id="edge1076" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_48_s2_l14</title>
<path fill="none" stroke="black" d="M3014.06,-1710.67C3024.43,-1701.06 3035.93,-1690.4 3046.21,-1680.88"/>
<polygon fill="black" stroke="black" points="3048.83,-1683.22 3053.78,-1673.85 3044.07,-1678.08 3048.83,-1683.22"/>
</g>
<!-- expert_49_s2_l14 -->
<g id="node644" class="node">
<title>expert_49_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3348,-1673.8 3179,-1673.8 3179,-1629.8 3348,-1629.8 3348,-1673.8"/>
<text text-anchor="middle" x="3263.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 49 L14</text>
<text text-anchor="middle" x="3263.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_49_s2_l14 -->
<g id="edge1077" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_49_s2_l14</title>
<path fill="none" stroke="black" d="M3059.28,-1716.11C3098.53,-1703.94 3146.2,-1689.17 3185.6,-1676.95"/>
<polygon fill="black" stroke="black" points="3186.92,-1680.21 3195.43,-1673.9 3184.84,-1673.52 3186.92,-1680.21"/>
</g>
<!-- expert_50_s2_l14 -->
<g id="node645" class="node">
<title>expert_50_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3535,-1673.8 3366,-1673.8 3366,-1629.8 3535,-1629.8 3535,-1673.8"/>
<text text-anchor="middle" x="3450.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 50 L14</text>
<text text-anchor="middle" x="3450.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_50_s2_l14 -->
<g id="edge1078" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_50_s2_l14</title>
<path fill="none" stroke="black" d="M3085.81,-1723.06C3158.76,-1710.84 3259.03,-1693.4 3355.92,-1674.08"/>
<polygon fill="black" stroke="black" points="3356.77,-1677.48 3365.89,-1672.09 3355.4,-1670.62 3356.77,-1677.48"/>
</g>
<!-- expert_51_s2_l14 -->
<g id="node646" class="node">
<title>expert_51_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3722,-1673.8 3553,-1673.8 3553,-1629.8 3722,-1629.8 3722,-1673.8"/>
<text text-anchor="middle" x="3637.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 51 L14</text>
<text text-anchor="middle" x="3637.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_51_s2_l14 -->
<g id="edge1079" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_51_s2_l14</title>
<path fill="none" stroke="black" d="M3100.07,-1729.71C3211.79,-1719.18 3384.6,-1700.72 3543,-1673.99"/>
<polygon fill="black" stroke="black" points="3543.66,-1677.42 3552.93,-1672.3 3542.48,-1670.52 3543.66,-1677.42"/>
</g>
<!-- expert_52_s2_l14 -->
<g id="node647" class="node">
<title>expert_52_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3909,-1673.8 3740,-1673.8 3740,-1629.8 3909,-1629.8 3909,-1673.8"/>
<text text-anchor="middle" x="3824.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 52 L14</text>
<text text-anchor="middle" x="3824.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_52_s2_l14 -->
<g id="edge1080" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_52_s2_l14</title>
<path fill="none" stroke="black" d="M3105.39,-1734.13C3252.09,-1726.08 3504.87,-1708.57 3729.93,-1673.96"/>
<polygon fill="black" stroke="black" points="3730.6,-1677.39 3739.95,-1672.4 3729.53,-1670.48 3730.6,-1677.39"/>
</g>
<!-- expert_53_s2_l14 -->
<g id="node648" class="node">
<title>expert_53_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="4096,-1673.8 3927,-1673.8 3927,-1629.8 4096,-1629.8 4096,-1673.8"/>
<text text-anchor="middle" x="4011.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 53 L14</text>
<text text-anchor="middle" x="4011.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_53_s2_l14 -->
<g id="edge1081" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_53_s2_l14</title>
<path fill="none" stroke="black" d="M3107.68,-1737.1C3285.8,-1731.74 3622.55,-1716.63 3916.94,-1673.93"/>
<polygon fill="black" stroke="black" points="3917.57,-1677.38 3926.96,-1672.47 3916.55,-1670.45 3917.57,-1677.38"/>
</g>
<!-- expert_54_s2_l14 -->
<g id="node649" class="node">
<title>expert_54_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="4283,-1673.8 4114,-1673.8 4114,-1629.8 4283,-1629.8 4283,-1673.8"/>
<text text-anchor="middle" x="4198.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 54 L14</text>
<text text-anchor="middle" x="4198.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_54_s2_l14 -->
<g id="edge1082" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_54_s2_l14</title>
<path fill="none" stroke="black" d="M3108.22,-1739.19C3314.67,-1736.52 3738.31,-1724.83 4103.98,-1673.91"/>
<polygon fill="black" stroke="black" points="4104.55,-1677.36 4113.96,-1672.51 4103.57,-1670.43 4104.55,-1677.36"/>
</g>
<!-- expert_55_s2_l14 -->
<g id="node650" class="node">
<title>expert_55_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="4470,-1673.8 4301,-1673.8 4301,-1629.8 4470,-1629.8 4470,-1673.8"/>
<text text-anchor="middle" x="4385.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 55 L14</text>
<text text-anchor="middle" x="4385.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_55_s2_l14 -->
<g id="edge1083" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_55_s2_l14</title>
<path fill="none" stroke="black" d="M3108.71,-1740.72C3341.33,-1740.63 3853.2,-1733.08 4290.96,-1673.9"/>
<polygon fill="black" stroke="black" points="4291.53,-1677.36 4300.97,-1672.54 4290.58,-1670.42 4291.53,-1677.36"/>
</g>
<!-- expert_56_s2_l14 -->
<g id="node651" class="node">
<title>expert_56_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="4657,-1673.8 4488,-1673.8 4488,-1629.8 4657,-1629.8 4657,-1673.8"/>
<text text-anchor="middle" x="4572.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 56 L14</text>
<text text-anchor="middle" x="4572.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_56_s2_l14 -->
<g id="edge1084" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_56_s2_l14</title>
<path fill="none" stroke="black" d="M3107.58,-1737.26C3413.87,-1730.29 4196.36,-1709.63 4477.77,-1673.89"/>
<polygon fill="black" stroke="black" points="4478.51,-1677.33 4487.97,-1672.56 4477.6,-1670.39 4478.51,-1677.33"/>
</g>
<!-- expert_57_s2_l14 -->
<g id="node652" class="node">
<title>expert_57_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="4844,-1673.8 4675,-1673.8 4675,-1629.8 4844,-1629.8 4844,-1673.8"/>
<text text-anchor="middle" x="4759.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 57 L14</text>
<text text-anchor="middle" x="4759.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_57_s2_l14 -->
<g id="edge1085" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_57_s2_l14</title>
<path fill="none" stroke="black" d="M3107.91,-1737.97C3441.37,-1732.31 4345.64,-1713.78 4664.78,-1673.89"/>
<polygon fill="black" stroke="black" points="4665.5,-1677.32 4674.97,-1672.58 4664.61,-1670.38 4665.5,-1677.32"/>
</g>
<!-- expert_58_s2_l14 -->
<g id="node653" class="node">
<title>expert_58_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="5031,-1673.8 4862,-1673.8 4862,-1629.8 5031,-1629.8 5031,-1673.8"/>
<text text-anchor="middle" x="4946.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 58 L14</text>
<text text-anchor="middle" x="4946.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_58_s2_l14 -->
<g id="edge1086" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_58_s2_l14</title>
<path fill="none" stroke="black" d="M3108.26,-1738.53C3467.53,-1734.1 4494.93,-1717.96 4851.87,-1673.87"/>
<polygon fill="black" stroke="black" points="4852.49,-1677.32 4861.97,-1672.59 4851.61,-1670.38 4852.49,-1677.32"/>
</g>
<!-- expert_59_s2_l14 -->
<g id="node654" class="node">
<title>expert_59_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="5218,-1673.8 5049,-1673.8 5049,-1629.8 5218,-1629.8 5218,-1673.8"/>
<text text-anchor="middle" x="5133.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 59 L14</text>
<text text-anchor="middle" x="5133.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_59_s2_l14 -->
<g id="edge1087" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_59_s2_l14</title>
<path fill="none" stroke="black" d="M3108.28,-1739.01C3491.82,-1735.74 4643.94,-1722.17 5038.93,-1673.86"/>
<polygon fill="black" stroke="black" points="5039.49,-1677.32 5048.97,-1672.61 5038.62,-1670.37 5039.49,-1677.32"/>
</g>
<!-- expert_60_s2_l14 -->
<g id="node655" class="node">
<title>expert_60_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="5405,-1673.8 5236,-1673.8 5236,-1629.8 5405,-1629.8 5405,-1673.8"/>
<text text-anchor="middle" x="5320.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 60 L14</text>
<text text-anchor="middle" x="5320.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_60_s2_l14 -->
<g id="edge1088" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_60_s2_l14</title>
<path fill="none" stroke="black" d="M3108.37,-1739.4C3515.16,-1737.23 4792.68,-1726.4 5225.9,-1673.86"/>
<polygon fill="black" stroke="black" points="5226.48,-1677.32 5235.98,-1672.61 5225.62,-1670.37 5226.48,-1677.32"/>
</g>
<!-- expert_61_s2_l14 -->
<g id="node656" class="node">
<title>expert_61_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="5592,-1673.8 5423,-1673.8 5423,-1629.8 5592,-1629.8 5592,-1673.8"/>
<text text-anchor="middle" x="5507.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 61 L14</text>
<text text-anchor="middle" x="5507.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_61_s2_l14 -->
<g id="edge1089" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_61_s2_l14</title>
<path fill="none" stroke="black" d="M3108.54,-1739.73C3537.8,-1738.6 4941.67,-1730.64 5413.04,-1673.85"/>
<polygon fill="black" stroke="black" points="5413.48,-1677.32 5422.98,-1672.62 5412.62,-1670.37 5413.48,-1677.32"/>
</g>
<!-- expert_62_s2_l14 -->
<g id="node657" class="node">
<title>expert_62_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="5779,-1673.8 5610,-1673.8 5610,-1629.8 5779,-1629.8 5779,-1673.8"/>
<text text-anchor="middle" x="5694.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 62 L14</text>
<text text-anchor="middle" x="5694.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_62_s2_l14 -->
<g id="edge1090" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_62_s2_l14</title>
<path fill="none" stroke="black" d="M3108.69,-1740.02C3559.49,-1739.88 5090.14,-1734.9 5599.96,-1673.85"/>
<polygon fill="black" stroke="black" points="5600.48,-1677.32 5609.98,-1672.63 5599.63,-1670.37 5600.48,-1677.32"/>
</g>
<!-- expert_63_s2_l14 -->
<g id="node658" class="node">
<title>expert_63_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="5966,-1673.8 5797,-1673.8 5797,-1629.8 5966,-1629.8 5966,-1673.8"/>
<text text-anchor="middle" x="5881.5" y="-1663.4" font-family="Arial" font-size="8.00">Expert 63 L14</text>
<text text-anchor="middle" x="5881.5" y="-1654.4" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-1645.4" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-1636.4" font-family="Arial" font-size="8.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2_l14&#45;&gt;expert_63_s2_l14 -->
<g id="edge1091" class="edge">
<title>expert_dispatch_s2_l14&#45;&gt;expert_63_s2_l14</title>
<path fill="none" stroke="black" d="M3108.62,-1740.27C3579.98,-1741.08 5238.67,-1739.18 5787,-1673.85"/>
<polygon fill="black" stroke="black" points="5787.47,-1677.32 5796.98,-1672.64 5786.63,-1670.37 5787.47,-1677.32"/>
</g>
<!-- expert_combine_s2_l14 -->
<g id="node659" class="node">
<title>expert_combine_s2_l14</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-1562.69" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-1574.29" font-family="Arial" font-size="8.00">Expert Combine L14 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-1565.29" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-1556.29" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1547.29" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1092" class="edge">
<title>expert_32_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M169.02,-1630.97C171.88,-1630.54 174.71,-1630.15 177.5,-1629.8 702.97,-1564.94 2358.67,-1562.56 2846.17,-1563.32"/>
<polygon fill="black" stroke="black" points="2846.42,-1566.82 2856.42,-1563.34 2846.43,-1559.82 2846.42,-1566.82"/>
</g>
<!-- expert_33_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1093" class="edge">
<title>expert_33_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M356.02,-1630.98C358.88,-1630.54 361.71,-1630.15 364.5,-1629.8 851.71,-1569.24 2380.13,-1563.81 2846.21,-1563.59"/>
<polygon fill="black" stroke="black" points="2846.36,-1567.09 2856.36,-1563.59 2846.36,-1560.09 2846.36,-1567.09"/>
</g>
<!-- expert_34_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1094" class="edge">
<title>expert_34_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M543.02,-1630.98C545.88,-1630.55 548.71,-1630.15 551.5,-1629.8 1000.54,-1573.55 2402.24,-1565.15 2846.2,-1563.9"/>
<polygon fill="black" stroke="black" points="2846.52,-1567.4 2856.51,-1563.88 2846.5,-1560.4 2846.52,-1567.4"/>
</g>
<!-- expert_35_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1095" class="edge">
<title>expert_35_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M730.02,-1630.99C732.88,-1630.55 735.71,-1630.16 738.5,-1629.8 1149.63,-1577.82 2426.08,-1566.58 2846.61,-1564.26"/>
<polygon fill="black" stroke="black" points="2846.7,-1567.76 2856.69,-1564.21 2846.67,-1560.76 2846.7,-1567.76"/>
</g>
<!-- expert_36_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1096" class="edge">
<title>expert_36_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M917.03,-1631C919.88,-1630.56 922.71,-1630.16 925.5,-1629.8 1298.74,-1582.1 2450.22,-1568.14 2846.7,-1564.69"/>
<polygon fill="black" stroke="black" points="2846.81,-1568.19 2856.78,-1564.6 2846.75,-1561.19 2846.81,-1568.19"/>
</g>
<!-- expert_37_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1097" class="edge">
<title>expert_37_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M1104.03,-1631.01C1106.88,-1630.57 1109.71,-1630.16 1112.5,-1629.8 1447.94,-1586.39 2474.98,-1569.86 2846.54,-1565.2"/>
<polygon fill="black" stroke="black" points="2846.85,-1568.7 2856.8,-1565.07 2846.76,-1561.7 2846.85,-1568.7"/>
</g>
<!-- expert_38_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1098" class="edge">
<title>expert_38_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M1291.03,-1631.03C1293.88,-1630.58 1296.71,-1630.17 1299.5,-1629.8 1597.53,-1590.64 2502.38,-1571.74 2847.13,-1565.81"/>
<polygon fill="black" stroke="black" points="2847.23,-1569.31 2857.17,-1565.64 2847.11,-1562.31 2847.23,-1569.31"/>
</g>
<!-- expert_39_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1099" class="edge">
<title>expert_39_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M1478.03,-1631.05C1480.88,-1630.59 1483.71,-1630.18 1486.5,-1629.8 1747.22,-1594.89 2530.56,-1573.86 2847.35,-1566.58"/>
<polygon fill="black" stroke="black" points="2847.58,-1570.08 2857.5,-1566.35 2847.42,-1563.08 2847.58,-1570.08"/>
</g>
<!-- expert_40_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1100" class="edge">
<title>expert_40_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M1665.03,-1631.07C1667.88,-1630.61 1670.71,-1630.19 1673.5,-1629.8 2098.54,-1571.52 2607.53,-1563.23 2846.26,-1562.9"/>
<polygon fill="black" stroke="black" points="2846.39,-1566.4 2856.38,-1562.89 2846.38,-1559.4 2846.39,-1566.4"/>
</g>
<!-- expert_41_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1101" class="edge">
<title>expert_41_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M1852.04,-1631.1C1854.89,-1630.63 1857.71,-1630.2 1860.5,-1629.8 2213.6,-1579.87 2634.37,-1567.54 2846.24,-1564.57"/>
<polygon fill="black" stroke="black" points="2846.52,-1568.06 2856.48,-1564.43 2846.43,-1561.07 2846.52,-1568.06"/>
</g>
<!-- expert_42_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1102" class="edge">
<title>expert_42_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M2039.05,-1631.14C2041.89,-1630.66 2044.72,-1630.21 2047.5,-1629.8 2330.13,-1588.15 2664.83,-1572.53 2847.27,-1566.83"/>
<polygon fill="black" stroke="black" points="2847.57,-1570.32 2857.46,-1566.52 2847.35,-1563.33 2847.57,-1570.32"/>
</g>
<!-- expert_43_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1103" class="edge">
<title>expert_43_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M2226.05,-1631.21C2228.9,-1630.71 2231.72,-1630.24 2234.5,-1629.8 2448.23,-1596.38 2699.16,-1578.51 2849.26,-1570.07"/>
<polygon fill="black" stroke="black" points="2849.66,-1573.55 2859.45,-1569.5 2849.27,-1566.57 2849.66,-1573.55"/>
</g>
<!-- expert_44_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1104" class="edge">
<title>expert_44_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M2413.07,-1631.31C2415.91,-1630.78 2418.73,-1630.28 2421.5,-1629.8 2569.28,-1604.48 2740.64,-1585.83 2854.7,-1574.9"/>
<polygon fill="black" stroke="black" points="2855.24,-1578.37 2864.87,-1573.94 2854.58,-1571.4 2855.24,-1578.37"/>
</g>
<!-- expert_45_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1105" class="edge">
<title>expert_45_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M2600.11,-1631.52C2602.94,-1630.93 2605.74,-1630.36 2608.5,-1629.8 2695.55,-1612.29 2794.51,-1594.91 2868.76,-1582.37"/>
<polygon fill="black" stroke="black" points="2869.79,-1585.74 2879.07,-1580.63 2868.63,-1578.84 2869.79,-1585.74"/>
</g>
<!-- expert_46_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1106" class="edge">
<title>expert_46_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M2770.28,-1629.72C2808.19,-1617.92 2855.83,-1603.1 2896.36,-1590.49"/>
<polygon fill="black" stroke="black" points="2897.45,-1593.82 2905.96,-1587.5 2895.37,-1587.13 2897.45,-1593.82"/>
</g>
<!-- expert_47_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1107" class="edge">
<title>expert_47_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M2912.01,-1629.72C2921.53,-1620.8 2932.9,-1610.15 2943.7,-1600.03"/>
<polygon fill="black" stroke="black" points="2946.15,-1602.53 2951.06,-1593.14 2941.37,-1597.42 2946.15,-1602.53"/>
</g>
<!-- expert_48_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1108" class="edge">
<title>expert_48_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M3053.75,-1629.72C3044.12,-1620.8 3032.63,-1610.15 3021.71,-1600.03"/>
<polygon fill="black" stroke="black" points="3023.99,-1597.37 3014.28,-1593.14 3019.23,-1602.51 3023.99,-1597.37"/>
</g>
<!-- expert_49_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1109" class="edge">
<title>expert_49_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M3195.48,-1629.72C3157.36,-1617.9 3109.44,-1603.04 3068.71,-1590.42"/>
<polygon fill="black" stroke="black" points="3069.65,-1587.04 3059.06,-1587.43 3067.58,-1593.73 3069.65,-1587.04"/>
</g>
<!-- expert_50_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1110" class="edge">
<title>expert_50_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M3365.89,-1631.52C3363.06,-1630.93 3360.26,-1630.36 3357.5,-1629.8 3269.89,-1612.2 3170.24,-1594.75 3095.69,-1582.2"/>
<polygon fill="black" stroke="black" points="3096.25,-1578.75 3085.81,-1580.54 3095.09,-1585.65 3096.25,-1578.75"/>
</g>
<!-- expert_51_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1111" class="edge">
<title>expert_51_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M3552.93,-1631.31C3550.09,-1630.78 3547.27,-1630.28 3544.5,-1629.8 3396.34,-1604.43 3224.52,-1585.77 3110.26,-1574.86"/>
<polygon fill="black" stroke="black" points="3110.36,-1571.36 3100.07,-1573.9 3109.69,-1578.33 3110.36,-1571.36"/>
</g>
<!-- expert_52_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1112" class="edge">
<title>expert_52_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M3739.95,-1631.21C3737.1,-1630.71 3734.28,-1630.24 3731.5,-1629.8 3517.33,-1596.32 3265.85,-1578.46 3115.58,-1570.04"/>
<polygon fill="black" stroke="black" points="3115.57,-1566.53 3105.39,-1569.48 3115.18,-1573.52 3115.57,-1566.53"/>
</g>
<!-- expert_53_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1113" class="edge">
<title>expert_53_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M3926.96,-1631.14C3924.11,-1630.66 3921.28,-1630.21 3918.5,-1629.8 3635.57,-1588.11 3300.51,-1572.51 3117.87,-1566.82"/>
<polygon fill="black" stroke="black" points="3117.78,-1563.32 3107.68,-1566.51 3117.57,-1570.31 3117.78,-1563.32"/>
</g>
<!-- expert_54_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1114" class="edge">
<title>expert_54_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M4113.96,-1631.1C4111.11,-1630.63 4108.29,-1630.2 4105.5,-1629.8 3751.85,-1579.81 3330.37,-1567.5 3118.46,-1564.55"/>
<polygon fill="black" stroke="black" points="3118.26,-1561.05 3108.22,-1564.42 3118.17,-1568.05 3118.26,-1561.05"/>
</g>
<!-- expert_55_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1115" class="edge">
<title>expert_55_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M4300.97,-1631.07C4298.12,-1630.61 4295.29,-1630.19 4292.5,-1629.8 3867.13,-1571.48 3357.75,-1563.21 3118.84,-1562.89"/>
<polygon fill="black" stroke="black" points="3118.72,-1559.39 3108.71,-1562.89 3118.71,-1566.39 3118.72,-1559.39"/>
</g>
<!-- expert_56_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1116" class="edge">
<title>expert_56_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M4487.97,-1631.05C4485.12,-1630.59 4482.29,-1630.18 4479.5,-1629.8 4218.6,-1594.87 3434.74,-1573.85 3117.74,-1566.58"/>
<polygon fill="black" stroke="black" points="3117.66,-1563.08 3107.58,-1566.35 3117.5,-1570.08 3117.66,-1563.08"/>
</g>
<!-- expert_57_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1117" class="edge">
<title>expert_57_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M4674.97,-1631.03C4672.12,-1630.58 4669.29,-1630.17 4666.5,-1629.8 4368.29,-1590.62 3462.9,-1571.73 3117.95,-1565.81"/>
<polygon fill="black" stroke="black" points="3117.97,-1562.31 3107.91,-1565.64 3117.85,-1569.31 3117.97,-1562.31"/>
</g>
<!-- expert_58_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1118" class="edge">
<title>expert_58_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M4861.97,-1631.01C4859.12,-1630.57 4856.29,-1630.16 4853.5,-1629.8 4517.88,-1586.37 3490.29,-1569.85 3118.53,-1565.2"/>
<polygon fill="black" stroke="black" points="3118.31,-1561.7 3108.26,-1565.07 3118.22,-1568.7 3118.31,-1561.7"/>
</g>
<!-- expert_59_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1119" class="edge">
<title>expert_59_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M5048.97,-1631C5046.12,-1630.56 5043.29,-1630.16 5040.5,-1629.8 4667.07,-1582.08 3515.04,-1568.13 3118.36,-1564.69"/>
<polygon fill="black" stroke="black" points="3118.31,-1561.19 3108.28,-1564.6 3118.25,-1568.19 3118.31,-1561.19"/>
</g>
<!-- expert_60_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1120" class="edge">
<title>expert_60_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M5235.98,-1630.99C5233.12,-1630.55 5230.29,-1630.16 5227.5,-1629.8 4816.19,-1577.8 3539.17,-1566.57 3118.45,-1564.26"/>
<polygon fill="black" stroke="black" points="3118.39,-1560.76 3108.37,-1564.21 3118.35,-1567.76 3118.39,-1560.76"/>
</g>
<!-- expert_61_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1121" class="edge">
<title>expert_61_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M5422.98,-1630.98C5420.12,-1630.55 5417.29,-1630.15 5414.5,-1629.8 4965.28,-1573.52 3563,-1565.14 3118.86,-1563.9"/>
<polygon fill="black" stroke="black" points="3118.55,-1560.4 3108.54,-1563.87 3118.53,-1567.4 3118.55,-1560.4"/>
</g>
<!-- expert_62_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1122" class="edge">
<title>expert_62_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M5609.98,-1630.98C5607.12,-1630.54 5604.29,-1630.15 5601.5,-1629.8 5114.1,-1569.22 3585.1,-1563.8 3118.84,-1563.59"/>
<polygon fill="black" stroke="black" points="3118.69,-1560.09 3108.69,-1563.59 3118.69,-1567.09 3118.69,-1560.09"/>
</g>
<!-- expert_63_s2_l14&#45;&gt;expert_combine_s2_l14 -->
<g id="edge1123" class="edge">
<title>expert_63_s2_l14&#45;&gt;expert_combine_s2_l14</title>
<path fill="none" stroke="black" d="M5796.98,-1630.97C5794.12,-1630.54 5791.29,-1630.15 5788.5,-1629.8 5262.84,-1564.92 3606.55,-1562.56 3118.88,-1563.32"/>
<polygon fill="black" stroke="black" points="3118.62,-1559.82 3108.62,-1563.34 3118.63,-1566.82 3118.62,-1559.82"/>
</g>
<!-- moe_out_proj_s2_l14 -->
<g id="node660" class="node">
<title>moe_out_proj_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-1495.58 2893.5,-1495.58 2893.5,-1451.58 3071.5,-1451.58 3071.5,-1495.58"/>
<text text-anchor="middle" x="2982.5" y="-1485.18" font-family="Arial" font-size="8.00">MoE Output Proj L14 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-1476.18" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1467.18" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1458.18" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2_l14&#45;&gt;moe_out_proj_s2_l14 -->
<g id="edge1124" class="edge">
<title>expert_combine_s2_l14&#45;&gt;moe_out_proj_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-1531.22C2982.5,-1522.94 2982.5,-1513.97 2982.5,-1505.66"/>
<polygon fill="black" stroke="black" points="2986,-1505.58 2982.5,-1495.58 2979,-1505.58 2986,-1505.58"/>
</g>
<!-- allreduce_moe_out_s2_l14 -->
<g id="node661" class="node">
<title>allreduce_moe_out_s2_l14</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-1384.47" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-1396.07" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L14</text>
<text text-anchor="middle" x="2982.5" y="-1387.07" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1378.07" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1369.07" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2_l14&#45;&gt;allreduce_moe_out_s2_l14 -->
<g id="edge1125" class="edge">
<title>moe_out_proj_s2_l14&#45;&gt;allreduce_moe_out_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-1451.49C2982.5,-1443.82 2982.5,-1434.86 2982.5,-1426.07"/>
<polygon fill="black" stroke="black" points="2986,-1425.91 2982.5,-1415.91 2979,-1425.91 2986,-1425.91"/>
</g>
<!-- layernorm2_s2_l14 -->
<g id="node662" class="node">
<title>layernorm2_s2_l14</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-1317.35 2893.5,-1317.35 2893.5,-1273.35 3071.5,-1273.35 3071.5,-1317.35"/>
<text text-anchor="middle" x="2982.5" y="-1306.95" font-family="Arial" font-size="8.00">LayerNorm 2 (L14)</text>
<text text-anchor="middle" x="2982.5" y="-1297.95" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1288.95" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1279.95" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2_l14&#45;&gt;layernorm2_s2_l14 -->
<g id="edge1126" class="edge">
<title>allreduce_moe_out_s2_l14&#45;&gt;layernorm2_s2_l14</title>
<path fill="none" stroke="black" d="M2982.5,-1353C2982.5,-1344.72 2982.5,-1335.74 2982.5,-1327.43"/>
<polygon fill="black" stroke="black" points="2986,-1327.36 2982.5,-1317.36 2979,-1327.36 2986,-1327.36"/>
</g>
<!-- layernorm1_s2_l15 -->
<g id="node663" class="node">
<title>layernorm1_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-1237.35 2893.5,-1237.35 2893.5,-1193.35 3071.5,-1193.35 3071.5,-1237.35"/>
<text text-anchor="middle" x="2982.5" y="-1226.95" font-family="Arial" font-size="8.00">LayerNorm 1 (L15)</text>
<text text-anchor="middle" x="2982.5" y="-1217.95" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1208.95" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1199.95" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm2_s2_l14&#45;&gt;layernorm1_s2_l15 -->
<g id="edge1127" class="edge">
<title>layernorm2_s2_l14&#45;&gt;layernorm1_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-1273.04C2982.5,-1265.15 2982.5,-1256.04 2982.5,-1247.46"/>
<polygon fill="black" stroke="black" points="2986,-1247.37 2982.5,-1237.37 2979,-1247.37 2986,-1247.37"/>
</g>
<!-- qkv_proj_s2_l15 -->
<g id="node664" class="node">
<title>qkv_proj_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3081,-1157.35 2884,-1157.35 2884,-1113.35 3081,-1113.35 3081,-1157.35"/>
<text text-anchor="middle" x="2982.5" y="-1146.95" font-family="Arial" font-size="8.00">QKV Projection L15 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-1137.95" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-1128.95" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-1119.95" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- layernorm1_s2_l15&#45;&gt;qkv_proj_s2_l15 -->
<g id="edge1128" class="edge">
<title>layernorm1_s2_l15&#45;&gt;qkv_proj_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-1193.04C2982.5,-1185.15 2982.5,-1176.04 2982.5,-1167.46"/>
<polygon fill="black" stroke="black" points="2986,-1167.37 2982.5,-1157.37 2979,-1167.37 2986,-1167.37"/>
</g>
<!-- allreduce_qkv_s2_l15 -->
<g id="node665" class="node">
<title>allreduce_qkv_s2_l15</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-1046.24" rx="139.1" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-1057.84" font-family="Arial" font-size="8.00">All&#45;Reduce QKV L15</text>
<text text-anchor="middle" x="2982.5" y="-1048.84" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-1039.84" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-1030.84" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- qkv_proj_s2_l15&#45;&gt;allreduce_qkv_s2_l15 -->
<g id="edge1129" class="edge">
<title>qkv_proj_s2_l15&#45;&gt;allreduce_qkv_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-1113.26C2982.5,-1105.59 2982.5,-1096.64 2982.5,-1087.85"/>
<polygon fill="black" stroke="black" points="2986,-1087.68 2982.5,-1077.68 2979,-1087.68 2986,-1087.68"/>
</g>
<!-- attention_s2_l15 -->
<g id="node666" class="node">
<title>attention_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3081,-979.13 2884,-979.13 2884,-935.13 3081,-935.13 3081,-979.13"/>
<text text-anchor="middle" x="2982.5" y="-968.73" font-family="Arial" font-size="8.00">Self&#45;Attention L15</text>
<text text-anchor="middle" x="2982.5" y="-959.73" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-950.73" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-941.73" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_qkv_s2_l15&#45;&gt;attention_s2_l15 -->
<g id="edge1130" class="edge">
<title>allreduce_qkv_s2_l15&#45;&gt;attention_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-1014.77C2982.5,-1006.49 2982.5,-997.52 2982.5,-989.2"/>
<polygon fill="black" stroke="black" points="2986,-989.13 2982.5,-979.13 2979,-989.13 2986,-989.13"/>
</g>
<!-- attn_out_proj_s2_l15 -->
<g id="node667" class="node">
<title>attn_out_proj_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3078,-899.13 2887,-899.13 2887,-855.13 3078,-855.13 3078,-899.13"/>
<text text-anchor="middle" x="2982.5" y="-888.73" font-family="Arial" font-size="8.00">Attention Output Proj L15 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-879.73" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2982.5" y="-870.73" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-861.73" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attention_s2_l15&#45;&gt;attn_out_proj_s2_l15 -->
<g id="edge1131" class="edge">
<title>attention_s2_l15&#45;&gt;attn_out_proj_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-934.81C2982.5,-926.92 2982.5,-917.81 2982.5,-909.23"/>
<polygon fill="black" stroke="black" points="2986,-909.14 2982.5,-899.14 2979,-909.15 2986,-909.14"/>
</g>
<!-- allreduce_attn_out_s2_l15 -->
<g id="node668" class="node">
<title>allreduce_attn_out_s2_l15</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-788.01" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-799.61" font-family="Arial" font-size="8.00">All&#45;Reduce Attention Output L15</text>
<text text-anchor="middle" x="2982.5" y="-790.61" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-781.61" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-772.61" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- attn_out_proj_s2_l15&#45;&gt;allreduce_attn_out_s2_l15 -->
<g id="edge1132" class="edge">
<title>attn_out_proj_s2_l15&#45;&gt;allreduce_attn_out_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-855.04C2982.5,-847.37 2982.5,-838.41 2982.5,-829.62"/>
<polygon fill="black" stroke="black" points="2986,-829.46 2982.5,-819.46 2979,-829.46 2986,-829.46"/>
</g>
<!-- moe_gate_s2_l15 -->
<g id="node669" class="node">
<title>moe_gate_s2_l15</title>
<polygon fill="orange" stroke="black" points="3167.08,-720.9 2873.45,-720.9 2797.92,-632.9 3091.55,-632.9 3167.08,-720.9"/>
<text text-anchor="middle" x="2982.5" y="-688.5" font-family="Arial" font-size="8.00">MoE Gate L15 (Router)</text>
<text text-anchor="middle" x="2982.5" y="-679.5" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-670.5" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-661.5" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_attn_out_s2_l15&#45;&gt;moe_gate_s2_l15 -->
<g id="edge1133" class="edge">
<title>allreduce_attn_out_s2_l15&#45;&gt;moe_gate_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-756.62C2982.5,-748.73 2982.5,-740 2982.5,-731.31"/>
<polygon fill="black" stroke="black" points="2986,-731.18 2982.5,-721.18 2979,-731.18 2986,-731.18"/>
</g>
<!-- expert_dispatch_s2_l15 -->
<g id="node670" class="node">
<title>expert_dispatch_s2_l15</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-565.79" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-577.39" font-family="Arial" font-size="8.00">Expert Dispatch L15 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-568.39" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-559.39" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-550.39" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_gate_s2_l15&#45;&gt;expert_dispatch_s2_l15 -->
<g id="edge1134" class="edge">
<title>moe_gate_s2_l15&#45;&gt;expert_dispatch_s2_l15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2982.5,-632.78C2982.5,-624.4 2982.5,-615.65 2982.5,-607.36"/>
<polygon fill="black" stroke="black" points="2986,-607.16 2982.5,-597.16 2979,-607.16 2986,-607.16"/>
</g>
<!-- expert_32_s2_l15 -->
<g id="node671" class="node">
<title>expert_32_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="169,-498.68 0,-498.68 0,-454.68 169,-454.68 169,-498.68"/>
<text text-anchor="middle" x="84.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 32 L15</text>
<text text-anchor="middle" x="84.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="84.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="84.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1024&#45;1055</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_32_s2_l15 -->
<g id="edge1135" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_32_s2_l15</title>
<path fill="none" stroke="black" d="M2856.42,-565.14C2385.23,-565.94 727.13,-564.03 178.99,-498.72"/>
<polygon fill="black" stroke="black" points="179.37,-495.24 169.02,-497.51 178.53,-502.19 179.37,-495.24"/>
</g>
<!-- expert_33_s2_l15 -->
<g id="node672" class="node">
<title>expert_33_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="356,-498.68 187,-498.68 187,-454.68 356,-454.68 356,-498.68"/>
<text text-anchor="middle" x="271.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 33 L15</text>
<text text-anchor="middle" x="271.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="271.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="271.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1056&#45;1087</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_33_s2_l15 -->
<g id="edge1136" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_33_s2_l15</title>
<path fill="none" stroke="black" d="M2856.36,-564.89C2405.73,-564.75 875.66,-559.75 366.03,-498.73"/>
<polygon fill="black" stroke="black" points="366.37,-495.24 356.02,-497.5 365.52,-502.19 366.37,-495.24"/>
</g>
<!-- expert_34_s2_l15 -->
<g id="node673" class="node">
<title>expert_34_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="543,-498.68 374,-498.68 374,-454.68 543,-454.68 543,-498.68"/>
<text text-anchor="middle" x="458.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 34 L15</text>
<text text-anchor="middle" x="458.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="458.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="458.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1088&#45;1119</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_34_s2_l15 -->
<g id="edge1137" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_34_s2_l15</title>
<path fill="none" stroke="black" d="M2856.51,-564.6C2427.43,-563.47 1024.14,-555.49 552.96,-498.72"/>
<polygon fill="black" stroke="black" points="553.38,-495.24 543.02,-497.5 552.52,-502.19 553.38,-495.24"/>
</g>
<!-- expert_35_s2_l15 -->
<g id="node674" class="node">
<title>expert_35_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="730,-498.68 561,-498.68 561,-454.68 730,-454.68 730,-498.68"/>
<text text-anchor="middle" x="645.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 35 L15</text>
<text text-anchor="middle" x="645.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="645.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="645.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1120&#45;1151</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_35_s2_l15 -->
<g id="edge1138" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_35_s2_l15</title>
<path fill="none" stroke="black" d="M2856.69,-564.27C2450.07,-562.1 1173.13,-551.25 740.1,-498.74"/>
<polygon fill="black" stroke="black" points="740.38,-495.24 730.02,-497.49 739.52,-502.19 740.38,-495.24"/>
</g>
<!-- expert_36_s2_l15 -->
<g id="node675" class="node">
<title>expert_36_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="917,-498.68 748,-498.68 748,-454.68 917,-454.68 917,-498.68"/>
<text text-anchor="middle" x="832.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 36 L15</text>
<text text-anchor="middle" x="832.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="832.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="832.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1152&#45;1183</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_36_s2_l15 -->
<g id="edge1139" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_36_s2_l15</title>
<path fill="none" stroke="black" d="M2856.78,-563.88C2473.43,-560.6 1321.87,-547.02 927.06,-498.73"/>
<polygon fill="black" stroke="black" points="927.38,-495.25 917.03,-497.48 926.51,-502.19 927.38,-495.25"/>
</g>
<!-- expert_37_s2_l15 -->
<g id="node676" class="node">
<title>expert_37_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="1104,-498.68 935,-498.68 935,-454.68 1104,-454.68 1104,-498.68"/>
<text text-anchor="middle" x="1019.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 37 L15</text>
<text text-anchor="middle" x="1019.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1019.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1019.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1184&#45;1215</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_37_s2_l15 -->
<g id="edge1140" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_37_s2_l15</title>
<path fill="none" stroke="black" d="M2856.8,-563.41C2497.73,-558.97 1470.88,-542.81 1114.13,-498.74"/>
<polygon fill="black" stroke="black" points="1114.39,-495.25 1104.03,-497.47 1113.51,-502.19 1114.39,-495.25"/>
</g>
<!-- expert_38_s2_l15 -->
<g id="node677" class="node">
<title>expert_38_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="1291,-498.68 1122,-498.68 1122,-454.68 1291,-454.68 1291,-498.68"/>
<text text-anchor="middle" x="1206.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 38 L15</text>
<text text-anchor="middle" x="1206.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1206.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1206.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1216&#45;1247</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_38_s2_l15 -->
<g id="edge1141" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_38_s2_l15</title>
<path fill="none" stroke="black" d="M2857.17,-562.84C2523.91,-557.17 1620.17,-538.63 1301.21,-498.76"/>
<polygon fill="black" stroke="black" points="1301.39,-495.25 1291.03,-497.45 1300.5,-502.2 1301.39,-495.25"/>
</g>
<!-- expert_39_s2_l15 -->
<g id="node678" class="node">
<title>expert_39_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="1478,-498.68 1309,-498.68 1309,-454.68 1478,-454.68 1478,-498.68"/>
<text text-anchor="middle" x="1393.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 39 L15</text>
<text text-anchor="middle" x="1393.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1393.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1393.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1248&#45;1279</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_39_s2_l15 -->
<g id="edge1142" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_39_s2_l15</title>
<path fill="none" stroke="black" d="M2857.5,-562.13C2551.41,-555.16 1769.45,-534.48 1488.23,-498.77"/>
<polygon fill="black" stroke="black" points="1488.4,-495.26 1478.03,-497.43 1487.49,-502.2 1488.4,-495.26"/>
</g>
<!-- expert_40_s2_l15 -->
<g id="node679" class="node">
<title>expert_40_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="1665,-498.68 1496,-498.68 1496,-454.68 1665,-454.68 1665,-498.68"/>
<text text-anchor="middle" x="1580.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 40 L15</text>
<text text-anchor="middle" x="1580.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1580.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1580.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1280&#45;1311</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_40_s2_l15 -->
<g id="edge1143" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_40_s2_l15</title>
<path fill="none" stroke="black" d="M2856.38,-565.59C2623.94,-565.48 2112.47,-557.91 1675.03,-498.77"/>
<polygon fill="black" stroke="black" points="1675.42,-495.29 1665.03,-497.41 1674.47,-502.23 1675.42,-495.29"/>
</g>
<!-- expert_41_s2_l15 -->
<g id="node680" class="node">
<title>expert_41_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="1852,-498.68 1683,-498.68 1683,-454.68 1852,-454.68 1852,-498.68"/>
<text text-anchor="middle" x="1767.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 41 L15</text>
<text text-anchor="middle" x="1767.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1767.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1767.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1312&#45;1343</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_41_s2_l15 -->
<g id="edge1144" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_41_s2_l15</title>
<path fill="none" stroke="black" d="M2856.48,-564.05C2650.05,-561.36 2227.11,-549.64 1862.01,-498.78"/>
<polygon fill="black" stroke="black" points="1862.43,-495.31 1852.04,-497.38 1861.45,-502.24 1862.43,-495.31"/>
</g>
<!-- expert_42_s2_l15 -->
<g id="node681" class="node">
<title>expert_42_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="2039,-498.68 1870,-498.68 1870,-454.68 2039,-454.68 2039,-498.68"/>
<text text-anchor="middle" x="1954.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 42 L15</text>
<text text-anchor="middle" x="1954.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="1954.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="1954.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1344&#45;1375</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_42_s2_l15 -->
<g id="edge1145" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_42_s2_l15</title>
<path fill="none" stroke="black" d="M2857.46,-561.96C2679.53,-556.59 2343.14,-541.47 2049.05,-498.8"/>
<polygon fill="black" stroke="black" points="2049.45,-495.32 2039.05,-497.34 2048.43,-502.25 2049.45,-495.32"/>
</g>
<!-- expert_43_s2_l15 -->
<g id="node682" class="node">
<title>expert_43_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="2226,-498.68 2057,-498.68 2057,-454.68 2226,-454.68 2226,-498.68"/>
<text text-anchor="middle" x="2141.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 43 L15</text>
<text text-anchor="middle" x="2141.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2141.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2141.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1376&#45;1407</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_43_s2_l15 -->
<g id="edge1146" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_43_s2_l15</title>
<path fill="none" stroke="black" d="M2859.45,-558.97C2712.89,-550.9 2460.66,-533.39 2236.05,-498.83"/>
<polygon fill="black" stroke="black" points="2236.47,-495.35 2226.05,-497.27 2235.4,-502.27 2236.47,-495.35"/>
</g>
<!-- expert_44_s2_l15 -->
<g id="node683" class="node">
<title>expert_44_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="2413,-498.68 2244,-498.68 2244,-454.68 2413,-454.68 2413,-498.68"/>
<text text-anchor="middle" x="2328.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 44 L15</text>
<text text-anchor="middle" x="2328.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2328.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2328.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1408&#45;1439</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_44_s2_l15 -->
<g id="edge1147" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_44_s2_l15</title>
<path fill="none" stroke="black" d="M2864.87,-554.54C2753.34,-544 2580.99,-525.54 2422.98,-498.85"/>
<polygon fill="black" stroke="black" points="2423.52,-495.4 2413.07,-497.17 2422.34,-502.3 2423.52,-495.4"/>
</g>
<!-- expert_45_s2_l15 -->
<g id="node684" class="node">
<title>expert_45_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="2600,-498.68 2431,-498.68 2431,-454.68 2600,-454.68 2600,-498.68"/>
<text text-anchor="middle" x="2515.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 45 L15</text>
<text text-anchor="middle" x="2515.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2515.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2515.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1440&#45;1471</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_45_s2_l15 -->
<g id="edge1148" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_45_s2_l15</title>
<path fill="none" stroke="black" d="M2879.07,-547.85C2806.34,-535.63 2706.53,-518.21 2610.04,-498.95"/>
<polygon fill="black" stroke="black" points="2610.6,-495.49 2600.11,-496.96 2609.23,-502.36 2610.6,-495.49"/>
</g>
<!-- expert_46_s2_l15 -->
<g id="node685" class="node">
<title>expert_46_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="2787,-498.68 2618,-498.68 2618,-454.68 2787,-454.68 2787,-498.68"/>
<text text-anchor="middle" x="2702.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 46 L15</text>
<text text-anchor="middle" x="2702.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2702.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2702.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1472&#45;1503</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_46_s2_l15 -->
<g id="edge1149" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_46_s2_l15</title>
<path fill="none" stroke="black" d="M2905.99,-540.98C2866.88,-528.82 2819.39,-514.04 2780.12,-501.83"/>
<polygon fill="black" stroke="black" points="2780.91,-498.41 2770.32,-498.78 2778.83,-505.09 2780.91,-498.41"/>
</g>
<!-- expert_47_s2_l15 -->
<g id="node686" class="node">
<title>expert_47_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="2974,-498.68 2805,-498.68 2805,-454.68 2974,-454.68 2974,-498.68"/>
<text text-anchor="middle" x="2889.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 47 L15</text>
<text text-anchor="middle" x="2889.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2889.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2889.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1504&#45;1535</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_47_s2_l15 -->
<g id="edge1150" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_47_s2_l15</title>
<path fill="none" stroke="black" d="M2951.27,-535.54C2941.01,-525.93 2929.64,-515.27 2919.47,-505.75"/>
<polygon fill="black" stroke="black" points="2921.66,-503.01 2911.97,-498.73 2916.88,-508.12 2921.66,-503.01"/>
</g>
<!-- expert_48_s2_l15 -->
<g id="node687" class="node">
<title>expert_48_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3161,-498.68 2992,-498.68 2992,-454.68 3161,-454.68 3161,-498.68"/>
<text text-anchor="middle" x="3076.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 48 L15</text>
<text text-anchor="middle" x="3076.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3076.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3076.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1536&#45;1567</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_48_s2_l15 -->
<g id="edge1151" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_48_s2_l15</title>
<path fill="none" stroke="black" d="M3014.06,-535.54C3024.43,-525.93 3035.93,-515.27 3046.21,-505.75"/>
<polygon fill="black" stroke="black" points="3048.83,-508.09 3053.78,-498.73 3044.07,-502.96 3048.83,-508.09"/>
</g>
<!-- expert_49_s2_l15 -->
<g id="node688" class="node">
<title>expert_49_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3348,-498.68 3179,-498.68 3179,-454.68 3348,-454.68 3348,-498.68"/>
<text text-anchor="middle" x="3263.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 49 L15</text>
<text text-anchor="middle" x="3263.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3263.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3263.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1568&#45;1599</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_49_s2_l15 -->
<g id="edge1152" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_49_s2_l15</title>
<path fill="none" stroke="black" d="M3059.28,-540.98C3098.53,-528.82 3146.2,-514.04 3185.6,-501.83"/>
<polygon fill="black" stroke="black" points="3186.92,-505.08 3195.43,-498.78 3184.84,-498.4 3186.92,-505.08"/>
</g>
<!-- expert_50_s2_l15 -->
<g id="node689" class="node">
<title>expert_50_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3535,-498.68 3366,-498.68 3366,-454.68 3535,-454.68 3535,-498.68"/>
<text text-anchor="middle" x="3450.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 50 L15</text>
<text text-anchor="middle" x="3450.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3450.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3450.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1600&#45;1631</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_50_s2_l15 -->
<g id="edge1153" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_50_s2_l15</title>
<path fill="none" stroke="black" d="M3085.81,-547.93C3158.76,-535.71 3259.03,-518.28 3355.92,-498.96"/>
<polygon fill="black" stroke="black" points="3356.77,-502.36 3365.89,-496.96 3355.4,-495.49 3356.77,-502.36"/>
</g>
<!-- expert_51_s2_l15 -->
<g id="node690" class="node">
<title>expert_51_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3722,-498.68 3553,-498.68 3553,-454.68 3722,-454.68 3722,-498.68"/>
<text text-anchor="middle" x="3637.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 51 L15</text>
<text text-anchor="middle" x="3637.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3637.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3637.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1632&#45;1663</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_51_s2_l15 -->
<g id="edge1154" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_51_s2_l15</title>
<path fill="none" stroke="black" d="M3100.07,-554.58C3211.79,-544.05 3384.6,-525.59 3543,-498.86"/>
<polygon fill="black" stroke="black" points="3543.66,-502.3 3552.93,-497.17 3542.48,-495.4 3543.66,-502.3"/>
</g>
<!-- expert_52_s2_l15 -->
<g id="node691" class="node">
<title>expert_52_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3909,-498.68 3740,-498.68 3740,-454.68 3909,-454.68 3909,-498.68"/>
<text text-anchor="middle" x="3824.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 52 L15</text>
<text text-anchor="middle" x="3824.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="3824.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="3824.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1664&#45;1695</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_52_s2_l15 -->
<g id="edge1155" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_52_s2_l15</title>
<path fill="none" stroke="black" d="M3105.39,-559C3252.09,-550.95 3504.87,-533.45 3729.93,-498.83"/>
<polygon fill="black" stroke="black" points="3730.6,-502.27 3739.95,-497.27 3729.53,-495.35 3730.6,-502.27"/>
</g>
<!-- expert_53_s2_l15 -->
<g id="node692" class="node">
<title>expert_53_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="4096,-498.68 3927,-498.68 3927,-454.68 4096,-454.68 4096,-498.68"/>
<text text-anchor="middle" x="4011.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 53 L15</text>
<text text-anchor="middle" x="4011.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4011.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4011.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1696&#45;1727</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_53_s2_l15 -->
<g id="edge1156" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_53_s2_l15</title>
<path fill="none" stroke="black" d="M3107.68,-561.97C3285.8,-556.61 3622.55,-541.5 3916.94,-498.8"/>
<polygon fill="black" stroke="black" points="3917.57,-502.25 3926.96,-497.34 3916.55,-495.32 3917.57,-502.25"/>
</g>
<!-- expert_54_s2_l15 -->
<g id="node693" class="node">
<title>expert_54_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="4283,-498.68 4114,-498.68 4114,-454.68 4283,-454.68 4283,-498.68"/>
<text text-anchor="middle" x="4198.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 54 L15</text>
<text text-anchor="middle" x="4198.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4198.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4198.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1728&#45;1759</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_54_s2_l15 -->
<g id="edge1157" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_54_s2_l15</title>
<path fill="none" stroke="black" d="M3108.22,-564.06C3314.67,-561.39 3738.31,-549.71 4103.98,-498.78"/>
<polygon fill="black" stroke="black" points="4104.55,-502.24 4113.96,-497.38 4103.57,-495.31 4104.55,-502.24"/>
</g>
<!-- expert_55_s2_l15 -->
<g id="node694" class="node">
<title>expert_55_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="4470,-498.68 4301,-498.68 4301,-454.68 4470,-454.68 4470,-498.68"/>
<text text-anchor="middle" x="4385.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 55 L15</text>
<text text-anchor="middle" x="4385.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4385.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4385.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1760&#45;1791</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_55_s2_l15 -->
<g id="edge1158" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_55_s2_l15</title>
<path fill="none" stroke="black" d="M3108.71,-565.59C3341.33,-565.5 3853.2,-557.95 4290.96,-498.77"/>
<polygon fill="black" stroke="black" points="4291.53,-502.23 4300.97,-497.41 4290.58,-495.29 4291.53,-502.23"/>
</g>
<!-- expert_56_s2_l15 -->
<g id="node695" class="node">
<title>expert_56_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="4657,-498.68 4488,-498.68 4488,-454.68 4657,-454.68 4657,-498.68"/>
<text text-anchor="middle" x="4572.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 56 L15</text>
<text text-anchor="middle" x="4572.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4572.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4572.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1792&#45;1823</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_56_s2_l15 -->
<g id="edge1159" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_56_s2_l15</title>
<path fill="none" stroke="black" d="M3107.58,-562.13C3413.87,-555.17 4196.36,-534.5 4477.77,-498.77"/>
<polygon fill="black" stroke="black" points="4478.51,-502.2 4487.97,-497.43 4477.6,-495.26 4478.51,-502.2"/>
</g>
<!-- expert_57_s2_l15 -->
<g id="node696" class="node">
<title>expert_57_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="4844,-498.68 4675,-498.68 4675,-454.68 4844,-454.68 4844,-498.68"/>
<text text-anchor="middle" x="4759.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 57 L15</text>
<text text-anchor="middle" x="4759.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4759.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4759.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1824&#45;1855</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_57_s2_l15 -->
<g id="edge1160" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_57_s2_l15</title>
<path fill="none" stroke="black" d="M3107.91,-562.84C3441.37,-557.18 4345.64,-538.65 4664.78,-498.76"/>
<polygon fill="black" stroke="black" points="4665.5,-502.2 4674.97,-497.45 4664.61,-495.25 4665.5,-502.2"/>
</g>
<!-- expert_58_s2_l15 -->
<g id="node697" class="node">
<title>expert_58_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="5031,-498.68 4862,-498.68 4862,-454.68 5031,-454.68 5031,-498.68"/>
<text text-anchor="middle" x="4946.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 58 L15</text>
<text text-anchor="middle" x="4946.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="4946.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="4946.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1856&#45;1887</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_58_s2_l15 -->
<g id="edge1161" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_58_s2_l15</title>
<path fill="none" stroke="black" d="M3108.26,-563.41C3467.53,-558.98 4494.93,-542.83 4851.87,-498.75"/>
<polygon fill="black" stroke="black" points="4852.49,-502.19 4861.97,-497.47 4851.61,-495.25 4852.49,-502.19"/>
</g>
<!-- expert_59_s2_l15 -->
<g id="node698" class="node">
<title>expert_59_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="5218,-498.68 5049,-498.68 5049,-454.68 5218,-454.68 5218,-498.68"/>
<text text-anchor="middle" x="5133.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 59 L15</text>
<text text-anchor="middle" x="5133.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5133.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5133.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1888&#45;1919</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_59_s2_l15 -->
<g id="edge1162" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_59_s2_l15</title>
<path fill="none" stroke="black" d="M3108.28,-563.88C3491.82,-560.61 4643.94,-547.04 5038.93,-498.73"/>
<polygon fill="black" stroke="black" points="5039.49,-502.19 5048.97,-497.48 5038.62,-495.25 5039.49,-502.19"/>
</g>
<!-- expert_60_s2_l15 -->
<g id="node699" class="node">
<title>expert_60_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="5405,-498.68 5236,-498.68 5236,-454.68 5405,-454.68 5405,-498.68"/>
<text text-anchor="middle" x="5320.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 60 L15</text>
<text text-anchor="middle" x="5320.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5320.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5320.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1920&#45;1951</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_60_s2_l15 -->
<g id="edge1163" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_60_s2_l15</title>
<path fill="none" stroke="black" d="M3108.37,-564.27C3515.16,-562.1 4792.68,-551.27 5225.9,-498.74"/>
<polygon fill="black" stroke="black" points="5226.48,-502.19 5235.98,-497.49 5225.62,-495.24 5226.48,-502.19"/>
</g>
<!-- expert_61_s2_l15 -->
<g id="node700" class="node">
<title>expert_61_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="5592,-498.68 5423,-498.68 5423,-454.68 5592,-454.68 5592,-498.68"/>
<text text-anchor="middle" x="5507.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 61 L15</text>
<text text-anchor="middle" x="5507.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5507.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5507.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1952&#45;1983</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_61_s2_l15 -->
<g id="edge1164" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_61_s2_l15</title>
<path fill="none" stroke="black" d="M3108.54,-564.61C3537.8,-563.48 4941.67,-555.51 5413.04,-498.72"/>
<polygon fill="black" stroke="black" points="5413.48,-502.19 5422.98,-497.5 5412.62,-495.24 5413.48,-502.19"/>
</g>
<!-- expert_62_s2_l15 -->
<g id="node701" class="node">
<title>expert_62_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="5779,-498.68 5610,-498.68 5610,-454.68 5779,-454.68 5779,-498.68"/>
<text text-anchor="middle" x="5694.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 62 L15</text>
<text text-anchor="middle" x="5694.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5694.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5694.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 1984&#45;2015</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_62_s2_l15 -->
<g id="edge1165" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_62_s2_l15</title>
<path fill="none" stroke="black" d="M3108.69,-564.89C3559.49,-564.75 5090.14,-559.77 5599.96,-498.73"/>
<polygon fill="black" stroke="black" points="5600.48,-502.19 5609.98,-497.5 5599.63,-495.24 5600.48,-502.19"/>
</g>
<!-- expert_63_s2_l15 -->
<g id="node702" class="node">
<title>expert_63_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="5966,-498.68 5797,-498.68 5797,-454.68 5966,-454.68 5966,-498.68"/>
<text text-anchor="middle" x="5881.5" y="-488.28" font-family="Arial" font-size="8.00">Expert 63 L15</text>
<text text-anchor="middle" x="5881.5" y="-479.28" font-family="Arial" font-size="8.00">Input: [batch=2, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="5881.5" y="-470.28" font-family="Arial" font-size="8.00">Output: [batch=2, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="5881.5" y="-461.28" font-family="Arial" font-size="8.00">GPUs: 2016&#45;2047</text>
</g>
<!-- expert_dispatch_s2_l15&#45;&gt;expert_63_s2_l15 -->
<g id="edge1166" class="edge">
<title>expert_dispatch_s2_l15&#45;&gt;expert_63_s2_l15</title>
<path fill="none" stroke="black" d="M3108.62,-565.14C3579.98,-565.95 5238.67,-564.05 5787,-498.72"/>
<polygon fill="black" stroke="black" points="5787.47,-502.19 5796.98,-497.51 5786.63,-495.24 5787.47,-502.19"/>
</g>
<!-- expert_combine_s2_l15 -->
<g id="node703" class="node">
<title>expert_combine_s2_l15</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-387.56" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-399.16" font-family="Arial" font-size="8.00">Expert Combine L15 (All&#45;to&#45;All)</text>
<text text-anchor="middle" x="2982.5" y="-390.16" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=2048]</text>
<text text-anchor="middle" x="2982.5" y="-381.16" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-372.16" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_32_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1167" class="edge">
<title>expert_32_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M169.02,-455.84C171.88,-455.41 174.71,-455.02 177.5,-454.68 702.97,-389.81 2358.67,-387.44 2846.17,-388.19"/>
<polygon fill="black" stroke="black" points="2846.42,-391.7 2856.42,-388.21 2846.43,-384.7 2846.42,-391.7"/>
</g>
<!-- expert_33_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1168" class="edge">
<title>expert_33_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M356.02,-455.85C358.88,-455.42 361.71,-455.02 364.5,-454.68 851.71,-394.12 2380.13,-388.68 2846.21,-388.47"/>
<polygon fill="black" stroke="black" points="2846.36,-391.97 2856.36,-388.46 2846.36,-384.97 2846.36,-391.97"/>
</g>
<!-- expert_34_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1169" class="edge">
<title>expert_34_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M543.02,-455.86C545.88,-455.42 548.71,-455.03 551.5,-454.68 1000.54,-398.42 2402.24,-390.02 2846.2,-388.78"/>
<polygon fill="black" stroke="black" points="2846.52,-392.28 2856.51,-388.75 2846.5,-385.28 2846.52,-392.28"/>
</g>
<!-- expert_35_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1170" class="edge">
<title>expert_35_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M730.02,-455.86C732.88,-455.43 735.71,-455.03 738.5,-454.68 1149.63,-402.7 2426.08,-391.45 2846.61,-389.14"/>
<polygon fill="black" stroke="black" points="2846.7,-392.64 2856.69,-389.08 2846.67,-385.64 2846.7,-392.64"/>
</g>
<!-- expert_36_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1171" class="edge">
<title>expert_36_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M917.03,-455.87C919.88,-455.43 922.71,-455.03 925.5,-454.68 1298.74,-406.98 2450.22,-393.01 2846.7,-389.56"/>
<polygon fill="black" stroke="black" points="2846.81,-393.06 2856.78,-389.48 2846.75,-386.06 2846.81,-393.06"/>
</g>
<!-- expert_37_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1172" class="edge">
<title>expert_37_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M1104.03,-455.89C1106.88,-455.44 1109.71,-455.04 1112.5,-454.68 1447.94,-411.26 2474.98,-394.73 2846.54,-390.08"/>
<polygon fill="black" stroke="black" points="2846.85,-393.57 2856.8,-389.95 2846.76,-386.57 2846.85,-393.57"/>
</g>
<!-- expert_38_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1173" class="edge">
<title>expert_38_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M1291.03,-455.9C1293.88,-455.45 1296.71,-455.04 1299.5,-454.68 1597.53,-415.51 2502.38,-396.61 2847.13,-390.69"/>
<polygon fill="black" stroke="black" points="2847.23,-394.19 2857.17,-390.52 2847.11,-387.19 2847.23,-394.19"/>
</g>
<!-- expert_39_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1174" class="edge">
<title>expert_39_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M1478.03,-455.92C1480.88,-455.47 1483.71,-455.05 1486.5,-454.68 1747.22,-419.76 2530.56,-398.73 2847.35,-391.46"/>
<polygon fill="black" stroke="black" points="2847.58,-394.95 2857.5,-391.22 2847.42,-387.95 2847.58,-394.95"/>
</g>
<!-- expert_40_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1175" class="edge">
<title>expert_40_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M1665.03,-455.94C1667.88,-455.48 1670.71,-455.06 1673.5,-454.68 2098.54,-396.39 2607.53,-388.1 2846.26,-387.78"/>
<polygon fill="black" stroke="black" points="2846.39,-391.28 2856.38,-387.77 2846.38,-384.28 2846.39,-391.28"/>
</g>
<!-- expert_41_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1176" class="edge">
<title>expert_41_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M1852.04,-455.97C1854.89,-455.5 1857.71,-455.07 1860.5,-454.68 2213.6,-404.75 2634.37,-392.41 2846.24,-389.44"/>
<polygon fill="black" stroke="black" points="2846.52,-392.94 2856.48,-389.3 2846.43,-385.94 2846.52,-392.94"/>
</g>
<!-- expert_42_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1177" class="edge">
<title>expert_42_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M2039.05,-456.01C2041.89,-455.53 2044.72,-455.09 2047.5,-454.68 2330.13,-413.02 2664.83,-397.4 2847.27,-391.71"/>
<polygon fill="black" stroke="black" points="2847.57,-395.2 2857.46,-391.39 2847.35,-388.2 2847.57,-395.2"/>
</g>
<!-- expert_43_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1178" class="edge">
<title>expert_43_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M2226.05,-456.08C2228.9,-455.58 2231.72,-455.11 2234.5,-454.68 2448.23,-421.25 2699.16,-403.38 2849.26,-394.94"/>
<polygon fill="black" stroke="black" points="2849.66,-398.43 2859.45,-394.38 2849.27,-391.44 2849.66,-398.43"/>
</g>
<!-- expert_44_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1179" class="edge">
<title>expert_44_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M2413.07,-456.18C2415.91,-455.66 2418.73,-455.15 2421.5,-454.68 2569.28,-429.36 2740.64,-410.7 2854.7,-399.78"/>
<polygon fill="black" stroke="black" points="2855.24,-403.24 2864.87,-398.81 2854.58,-396.27 2855.24,-403.24"/>
</g>
<!-- expert_45_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1180" class="edge">
<title>expert_45_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M2600.11,-456.39C2602.94,-455.81 2605.74,-455.23 2608.5,-454.68 2695.55,-437.16 2794.51,-419.78 2868.76,-407.24"/>
<polygon fill="black" stroke="black" points="2869.79,-410.61 2879.07,-405.5 2868.63,-403.71 2869.79,-410.61"/>
</g>
<!-- expert_46_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1181" class="edge">
<title>expert_46_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M2770.28,-454.59C2808.19,-442.79 2855.83,-427.97 2896.36,-415.36"/>
<polygon fill="black" stroke="black" points="2897.45,-418.69 2905.96,-412.38 2895.37,-412.01 2897.45,-418.69"/>
</g>
<!-- expert_47_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1182" class="edge">
<title>expert_47_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M2912.01,-454.59C2921.53,-445.67 2932.9,-435.02 2943.7,-424.9"/>
<polygon fill="black" stroke="black" points="2946.15,-427.4 2951.06,-418.01 2941.37,-422.3 2946.15,-427.4"/>
</g>
<!-- expert_48_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1183" class="edge">
<title>expert_48_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M3053.75,-454.59C3044.12,-445.67 3032.63,-435.02 3021.71,-424.9"/>
<polygon fill="black" stroke="black" points="3023.99,-422.24 3014.28,-418.01 3019.23,-427.38 3023.99,-422.24"/>
</g>
<!-- expert_49_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1184" class="edge">
<title>expert_49_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M3195.48,-454.59C3157.36,-442.77 3109.44,-427.92 3068.71,-415.29"/>
<polygon fill="black" stroke="black" points="3069.65,-411.92 3059.06,-412.3 3067.58,-418.6 3069.65,-411.92"/>
</g>
<!-- expert_50_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1185" class="edge">
<title>expert_50_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M3365.89,-456.39C3363.06,-455.8 3360.26,-455.23 3357.5,-454.68 3269.89,-437.07 3170.24,-419.62 3095.69,-407.08"/>
<polygon fill="black" stroke="black" points="3096.25,-403.62 3085.81,-405.42 3095.09,-410.53 3096.25,-403.62"/>
</g>
<!-- expert_51_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1186" class="edge">
<title>expert_51_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M3552.93,-456.18C3550.09,-455.66 3547.27,-455.15 3544.5,-454.68 3396.34,-429.31 3224.52,-410.65 3110.26,-399.74"/>
<polygon fill="black" stroke="black" points="3110.36,-396.23 3100.07,-398.77 3109.69,-403.2 3110.36,-396.23"/>
</g>
<!-- expert_52_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1187" class="edge">
<title>expert_52_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M3739.95,-456.08C3737.1,-455.58 3734.28,-455.11 3731.5,-454.68 3517.33,-421.2 3265.85,-403.33 3115.58,-394.91"/>
<polygon fill="black" stroke="black" points="3115.57,-391.41 3105.39,-394.35 3115.18,-398.4 3115.57,-391.41"/>
</g>
<!-- expert_53_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1188" class="edge">
<title>expert_53_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M3926.96,-456.01C3924.11,-455.53 3921.28,-455.09 3918.5,-454.68 3635.57,-412.99 3300.51,-397.38 3117.87,-391.7"/>
<polygon fill="black" stroke="black" points="3117.78,-388.19 3107.68,-391.38 3117.57,-395.19 3117.78,-388.19"/>
</g>
<!-- expert_54_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1189" class="edge">
<title>expert_54_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M4113.96,-455.97C4111.11,-455.5 4108.29,-455.07 4105.5,-454.68 3751.85,-404.68 3330.37,-392.38 3118.46,-389.43"/>
<polygon fill="black" stroke="black" points="3118.26,-385.92 3108.22,-389.29 3118.17,-392.92 3118.26,-385.92"/>
</g>
<!-- expert_55_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1190" class="edge">
<title>expert_55_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M4300.97,-455.94C4298.12,-455.48 4295.29,-455.06 4292.5,-454.68 3867.13,-396.36 3357.75,-388.08 3118.84,-387.77"/>
<polygon fill="black" stroke="black" points="3118.72,-384.27 3108.71,-387.76 3118.71,-391.27 3118.72,-384.27"/>
</g>
<!-- expert_56_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1191" class="edge">
<title>expert_56_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M4487.97,-455.92C4485.12,-455.47 4482.29,-455.05 4479.5,-454.68 4218.6,-419.74 3434.74,-398.73 3117.74,-391.45"/>
<polygon fill="black" stroke="black" points="3117.66,-387.95 3107.58,-391.22 3117.5,-394.95 3117.66,-387.95"/>
</g>
<!-- expert_57_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1192" class="edge">
<title>expert_57_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M4674.97,-455.9C4672.12,-455.45 4669.29,-455.04 4666.5,-454.68 4368.29,-415.49 3462.9,-396.6 3117.95,-390.69"/>
<polygon fill="black" stroke="black" points="3117.97,-387.19 3107.91,-390.51 3117.85,-394.18 3117.97,-387.19"/>
</g>
<!-- expert_58_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1193" class="edge">
<title>expert_58_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M4861.97,-455.89C4859.12,-455.44 4856.29,-455.04 4853.5,-454.68 4517.88,-411.24 3490.29,-394.72 3118.53,-390.07"/>
<polygon fill="black" stroke="black" points="3118.31,-386.57 3108.26,-389.95 3118.22,-393.57 3118.31,-386.57"/>
</g>
<!-- expert_59_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1194" class="edge">
<title>expert_59_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M5048.97,-455.87C5046.12,-455.43 5043.29,-455.03 5040.5,-454.68 4667.07,-406.96 3515.04,-393.01 3118.36,-389.56"/>
<polygon fill="black" stroke="black" points="3118.31,-386.06 3108.28,-389.47 3118.25,-393.06 3118.31,-386.06"/>
</g>
<!-- expert_60_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1195" class="edge">
<title>expert_60_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M5235.98,-455.86C5233.12,-455.43 5230.29,-455.03 5227.5,-454.68 4816.19,-402.67 3539.17,-391.45 3118.45,-389.14"/>
<polygon fill="black" stroke="black" points="3118.39,-385.64 3108.37,-389.08 3118.35,-392.64 3118.39,-385.64"/>
</g>
<!-- expert_61_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1196" class="edge">
<title>expert_61_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M5422.98,-455.86C5420.12,-455.42 5417.29,-455.03 5414.5,-454.68 4965.28,-398.4 3563,-390.01 3118.86,-388.78"/>
<polygon fill="black" stroke="black" points="3118.55,-385.27 3108.54,-388.75 3118.53,-392.27 3118.55,-385.27"/>
</g>
<!-- expert_62_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1197" class="edge">
<title>expert_62_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M5609.98,-455.85C5607.12,-455.42 5604.29,-455.02 5601.5,-454.68 5114.1,-394.1 3585.1,-388.68 3118.84,-388.46"/>
<polygon fill="black" stroke="black" points="3118.69,-384.96 3108.69,-388.46 3118.69,-391.96 3118.69,-384.96"/>
</g>
<!-- expert_63_s2_l15&#45;&gt;expert_combine_s2_l15 -->
<g id="edge1198" class="edge">
<title>expert_63_s2_l15&#45;&gt;expert_combine_s2_l15</title>
<path fill="none" stroke="black" d="M5796.98,-455.84C5794.12,-455.41 5791.29,-455.02 5788.5,-454.68 5262.84,-389.79 3606.55,-387.43 3118.88,-388.19"/>
<polygon fill="black" stroke="black" points="3118.62,-384.69 3108.62,-388.21 3118.63,-391.69 3118.62,-384.69"/>
</g>
<!-- moe_out_proj_s2_l15 -->
<g id="node704" class="node">
<title>moe_out_proj_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-320.45 2893.5,-320.45 2893.5,-276.45 3071.5,-276.45 3071.5,-320.45"/>
<text text-anchor="middle" x="2982.5" y="-310.05" font-family="Arial" font-size="8.00">MoE Output Proj L15 (TP8)</text>
<text text-anchor="middle" x="2982.5" y="-301.05" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-292.05" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-283.05" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- expert_combine_s2_l15&#45;&gt;moe_out_proj_s2_l15 -->
<g id="edge1199" class="edge">
<title>expert_combine_s2_l15&#45;&gt;moe_out_proj_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-356.1C2982.5,-347.82 2982.5,-338.84 2982.5,-330.53"/>
<polygon fill="black" stroke="black" points="2986,-330.46 2982.5,-320.46 2979,-330.46 2986,-330.46"/>
</g>
<!-- allreduce_moe_out_s2_l15 -->
<g id="node705" class="node">
<title>allreduce_moe_out_s2_l15</title>
<ellipse fill="yellow" stroke="black" cx="2982.5" cy="-209.34" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-220.94" font-family="Arial" font-size="8.00">All&#45;Reduce MoE Output L15</text>
<text text-anchor="middle" x="2982.5" y="-211.94" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-202.94" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-193.94" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- moe_out_proj_s2_l15&#45;&gt;allreduce_moe_out_s2_l15 -->
<g id="edge1200" class="edge">
<title>moe_out_proj_s2_l15&#45;&gt;allreduce_moe_out_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-276.36C2982.5,-268.69 2982.5,-259.74 2982.5,-250.94"/>
<polygon fill="black" stroke="black" points="2986,-250.78 2982.5,-240.78 2979,-250.78 2986,-250.78"/>
</g>
<!-- layernorm2_s2_l15 -->
<g id="node706" class="node">
<title>layernorm2_s2_l15</title>
<polygon fill="lightblue" stroke="black" points="3071.5,-142.23 2893.5,-142.23 2893.5,-98.23 3071.5,-98.23 3071.5,-142.23"/>
<text text-anchor="middle" x="2982.5" y="-131.83" font-family="Arial" font-size="8.00">LayerNorm 2 (L15)</text>
<text text-anchor="middle" x="2982.5" y="-122.83" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-113.83" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-104.83" font-family="Arial" font-size="8.00">GPUs: 1024&#45;2047</text>
</g>
<!-- allreduce_moe_out_s2_l15&#45;&gt;layernorm2_s2_l15 -->
<g id="edge1201" class="edge">
<title>allreduce_moe_out_s2_l15&#45;&gt;layernorm2_s2_l15</title>
<path fill="none" stroke="black" d="M2982.5,-177.87C2982.5,-169.59 2982.5,-160.62 2982.5,-152.3"/>
<polygon fill="black" stroke="black" points="2986,-152.23 2982.5,-142.23 2979,-152.23 2986,-152.23"/>
</g>
<!-- output -->
<g id="node707" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="2982.5" cy="-31.11" rx="125.73" ry="31.23"/>
<text text-anchor="middle" x="2982.5" y="-42.71" font-family="Arial" font-size="8.00">Output</text>
<text text-anchor="middle" x="2982.5" y="-33.71" font-family="Arial" font-size="8.00">Input: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-24.71" font-family="Arial" font-size="8.00">Output: [batch=128, seq=1024, hidden=1024]</text>
<text text-anchor="middle" x="2982.5" y="-15.71" font-family="Arial" font-size="8.00">GPUs: All</text>
</g>
<!-- layernorm2_s2_l15&#45;&gt;output -->
<g id="edge1202" class="edge">
<title>layernorm2_s2_l15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2982.5,-98.14C2982.5,-90.47 2982.5,-81.51 2982.5,-72.72"/>
<polygon fill="black" stroke="black" points="2986,-72.56 2982.5,-62.56 2979,-72.56 2986,-72.56"/>
</g>
</g>
</svg>
