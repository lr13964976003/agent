<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="168707pt" height="1309pt"
 viewBox="0.00 0.00 168706.95 1309.04" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1305.04)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1305.04 168702.95,-1305.04 168702.95,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage1</title>
<path fill="white" stroke="black" d="M20.97,-8C20.97,-8 84218.97,-8 84218.97,-8 84224.97,-8 84230.97,-14 84230.97,-20 84230.97,-20 84230.97,-1188.5 84230.97,-1188.5 84230.97,-1194.5 84224.97,-1200.5 84218.97,-1200.5 84218.97,-1200.5 20.97,-1200.5 20.97,-1200.5 14.97,-1200.5 8.97,-1194.5 8.97,-1188.5 8.97,-1188.5 8.97,-20 8.97,-20 8.97,-14 14.97,-8 20.97,-8"/>
<text text-anchor="middle" x="42119.97" y="-1185.3" font-family="Arial" font-size="14.00">Pipeline Stage 1 (Layers 1&#45;8)</text>
<text text-anchor="middle" x="42119.97" y="-1170.3" font-family="Arial" font-size="14.00">TP8&#45;EP64&#45;PP1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage2</title>
<path fill="white" stroke="black" d="M84250.97,-8C84250.97,-8 168504.97,-8 168504.97,-8 168510.97,-8 168516.97,-14 168516.97,-20 168516.97,-20 168516.97,-1019.5 168516.97,-1019.5 168516.97,-1025.5 168510.97,-1031.5 168504.97,-1031.5 168504.97,-1031.5 84250.97,-1031.5 84250.97,-1031.5 84244.97,-1031.5 84238.97,-1025.5 84238.97,-1019.5 84238.97,-1019.5 84238.97,-20 84238.97,-20 84238.97,-14 84244.97,-8 84250.97,-8"/>
<text text-anchor="middle" x="126377.97" y="-1016.3" font-family="Arial" font-size="14.00">Pipeline Stage 2 (Layers 9&#45;16)</text>
<text text-anchor="middle" x="126377.97" y="-1001.3" font-family="Arial" font-size="14.00">TP8&#45;EP64&#45;PP2</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" stroke-width="2" cx="86.97" cy="-1264.27" rx="86.95" ry="36.54"/>
<text text-anchor="middle" x="86.97" y="-1278.27" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="86.97" y="-1267.27" font-family="Arial" font-size="10.00">Batch Size: 128</text>
<text text-anchor="middle" x="86.97" y="-1256.27" font-family="Arial" font-size="10.00">Seq Length: [128&#45;10240]</text>
<text text-anchor="middle" x="86.97" y="-1245.27" font-family="Arial" font-size="10.00">Token Dim: 1024</text>
</g>
<!-- embed_stage1 -->
<g id="node2" class="node">
<title>embed_stage1</title>
<polygon fill="lightblue" stroke="black" points="156.97,-1134 16.97,-1134 16.97,-1093 156.97,-1093 156.97,-1134"/>
<text text-anchor="middle" x="86.97" y="-1122" font-family="Arial" font-size="10.00">Token Embedding (TP8)</text>
<text text-anchor="middle" x="86.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="86.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- input&#45;&gt;embed_stage1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_stage1</title>
<path fill="none" stroke="black" d="M86.97,-1227.26C86.97,-1201.91 86.97,-1168.36 86.97,-1144.47"/>
<polygon fill="black" stroke="black" points="90.47,-1144.23 86.97,-1134.23 83.47,-1144.23 90.47,-1144.23"/>
</g>
<!-- ln1_1_stage1 -->
<g id="node3" class="node">
<title>ln1_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="166.97,-965 26.97,-965 26.97,-924 166.97,-924 166.97,-965"/>
<text text-anchor="middle" x="96.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L1</text>
<text text-anchor="middle" x="96.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="96.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- embed_stage1&#45;&gt;ln1_1_stage1 -->
<g id="edge2" class="edge">
<title>embed_stage1&#45;&gt;ln1_1_stage1</title>
<path fill="none" stroke="black" d="M88.16,-1092.69C89.9,-1063.61 93.16,-1009.16 95.19,-975.26"/>
<polygon fill="black" stroke="black" points="98.7,-975.22 95.8,-965.03 91.71,-974.81 98.7,-975.22"/>
</g>
<!-- qkv_1_stage1 -->
<g id="node4" class="node">
<title>qkv_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="198.97,-866.5 52.97,-866.5 52.97,-825.5 198.97,-825.5 198.97,-866.5"/>
<text text-anchor="middle" x="125.97" y="-854.5" font-family="Arial" font-size="10.00">QKV Projection (TP8) L1</text>
<text text-anchor="middle" x="125.97" y="-843.5" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="125.97" y="-832.5" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- ln1_1_stage1&#45;&gt;qkv_1_stage1 -->
<g id="edge3" class="edge">
<title>ln1_1_stage1&#45;&gt;qkv_1_stage1</title>
<path fill="none" stroke="black" d="M102.84,-923.98C106.94,-910.33 112.49,-891.87 117.13,-876.45"/>
<polygon fill="black" stroke="black" points="120.49,-877.42 120.01,-866.84 113.78,-875.4 120.49,-877.42"/>
</g>
<!-- attn_1_stage1 -->
<g id="node5" class="node">
<title>attn_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="370.97,-788.5 224.97,-788.5 224.97,-747.5 370.97,-747.5 370.97,-788.5"/>
<text text-anchor="middle" x="297.97" y="-776.5" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L1</text>
<text text-anchor="middle" x="297.97" y="-765.5" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="297.97" y="-754.5" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- qkv_1_stage1&#45;&gt;attn_1_stage1 -->
<g id="edge4" class="edge">
<title>qkv_1_stage1&#45;&gt;attn_1_stage1</title>
<path fill="none" stroke="black" d="M170.27,-825.43C192.94,-815.42 220.71,-803.14 244.56,-792.61"/>
<polygon fill="black" stroke="black" points="246.1,-795.75 253.83,-788.51 243.27,-789.35 246.1,-795.75"/>
</g>
<!-- attn_out_1_stage1 -->
<g id="node6" class="node">
<title>attn_out_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="684.97,-694.24 544.97,-694.24 544.97,-653.24 684.97,-653.24 684.97,-694.24"/>
<text text-anchor="middle" x="614.97" y="-682.24" font-family="Arial" font-size="10.00">Attention Output (TP8) L1</text>
<text text-anchor="middle" x="614.97" y="-671.24" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="614.97" y="-660.24" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- attn_1_stage1&#45;&gt;attn_out_1_stage1 -->
<g id="edge5" class="edge">
<title>attn_1_stage1&#45;&gt;attn_out_1_stage1</title>
<path fill="none" stroke="black" d="M365.2,-747.44C415.85,-732.7 485.35,-712.47 538.18,-697.09"/>
<polygon fill="black" stroke="black" points="539.22,-700.43 547.84,-694.27 537.26,-693.71 539.22,-700.43"/>
</g>
<!-- ln2_1_stage1 -->
<g id="node75" class="node">
<title>ln2_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="1304.97,-599.97 1164.97,-599.97 1164.97,-558.97 1304.97,-558.97 1304.97,-599.97"/>
<text text-anchor="middle" x="1234.97" y="-587.97" font-family="Arial" font-size="10.00">LayerNorm (TP8) L1</text>
<text text-anchor="middle" x="1234.97" y="-576.97" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="1234.97" y="-565.97" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- attn_out_1_stage1&#45;&gt;ln2_1_stage1 -->
<g id="edge6" class="edge">
<title>attn_out_1_stage1&#45;&gt;ln2_1_stage1</title>
<path fill="none" stroke="black" d="M685.19,-662.29C801.29,-645.01 1032.57,-610.59 1154.87,-592.39"/>
<polygon fill="black" stroke="black" points="1155.54,-595.83 1164.92,-590.89 1154.51,-588.9 1155.54,-595.83"/>
</g>
<!-- route_1_stage1 -->
<g id="node7" class="node">
<title>route_1_stage1</title>
<polygon fill="lightcoral" stroke="black" points="2766.27,-521.97 2535.14,-521.97 2475.68,-439.97 2706.81,-439.97 2766.27,-521.97"/>
<text text-anchor="middle" x="2620.97" y="-489.47" font-family="Arial" font-size="10.00">MoE Routing (EP64) L1</text>
<text text-anchor="middle" x="2620.97" y="-478.47" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="2620.97" y="-467.47" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_1_stage1 -->
<g id="node8" class="node">
<title>dispatch_1_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="5079.97" cy="-373.97" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="5079.97" y="-382.47" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L1</text>
<text text-anchor="middle" x="5079.97" y="-371.47" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="5079.97" y="-360.47" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- route_1_stage1&#45;&gt;dispatch_1_stage1 -->
<g id="edge8" class="edge">
<title>route_1_stage1&#45;&gt;dispatch_1_stage1</title>
<path fill="none" stroke="black" d="M2732.62,-475.2C3140.18,-457.8 4545.68,-397.79 4962.54,-379.99"/>
<polygon fill="black" stroke="black" points="4962.96,-383.47 4972.8,-379.55 4962.66,-376.48 4962.96,-383.47"/>
</g>
<!-- expert_1_0_stage1 -->
<g id="node9" class="node">
<title>expert_1_0_stage1</title>
<polygon fill="lightblue" stroke="black" points="160.47,-307.98 17.47,-307.98 17.47,-266.98 160.47,-266.98 160.47,-307.98"/>
<text text-anchor="middle" x="88.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 0 (TP8) L1</text>
<text text-anchor="middle" x="88.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_0_stage1 -->
<g id="edge9" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.04,-372.5C4368.39,-369.75 1437.44,-355.15 532.97,-326.98 374.38,-322.04 331.02,-331.1 171.01,-308.15"/>
<polygon fill="black" stroke="black" points="171.21,-304.64 160.81,-306.66 170.2,-311.57 171.21,-304.64"/>
</g>
<!-- expert_1_1_stage1 -->
<g id="node10" class="node">
<title>expert_1_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="321.47,-307.98 178.47,-307.98 178.47,-266.98 321.47,-266.98 321.47,-307.98"/>
<text text-anchor="middle" x="249.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 1 (TP8) L1</text>
<text text-anchor="middle" x="249.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="249.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_1_stage1 -->
<g id="edge10" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.08,-372.95C4485.19,-372.62 2466.39,-368.68 809.97,-326.98 599.88,-321.69 543.17,-337.14 331.98,-308.12"/>
<polygon fill="black" stroke="black" points="332.19,-304.62 321.8,-306.71 331.22,-311.55 332.19,-304.62"/>
</g>
<!-- expert_1_2_stage1 -->
<g id="node11" class="node">
<title>expert_1_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="482.47,-307.98 339.47,-307.98 339.47,-266.98 482.47,-266.98 482.47,-307.98"/>
<text text-anchor="middle" x="410.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 2 (TP8) L1</text>
<text text-anchor="middle" x="410.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="410.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_2_stage1 -->
<g id="edge11" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.17,-372.41C4394.24,-369.33 1687.7,-353.69 849.97,-326.98 693.55,-322 650.79,-330.85 492.88,-308.13"/>
<polygon fill="black" stroke="black" points="493.21,-304.64 482.81,-306.66 492.2,-311.57 493.21,-304.64"/>
</g>
<!-- expert_1_3_stage1 -->
<g id="node12" class="node">
<title>expert_1_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="643.47,-307.98 500.47,-307.98 500.47,-266.98 643.47,-266.98 643.47,-307.98"/>
<text text-anchor="middle" x="571.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 3 (TP8) L1</text>
<text text-anchor="middle" x="571.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="571.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_3_stage1 -->
<g id="edge12" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.03,-372.79C4508.11,-371.8 2658.37,-365.48 1138.97,-326.98 925.71,-321.58 868.22,-337.51 653.8,-308.1"/>
<polygon fill="black" stroke="black" points="654.19,-304.62 643.8,-306.71 653.22,-311.55 654.19,-304.62"/>
</g>
<!-- expert_1_4_stage1 -->
<g id="node13" class="node">
<title>expert_1_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="804.47,-307.98 661.47,-307.98 661.47,-266.98 804.47,-266.98 804.47,-307.98"/>
<text text-anchor="middle" x="732.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 4 (TP8) L1</text>
<text text-anchor="middle" x="732.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="732.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_4_stage1 -->
<g id="edge13" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4970.96,-373.29C4510.75,-374.28 2681.4,-374.82 1178.97,-326.98 1019.51,-321.91 975.91,-331.2 815.07,-308.15"/>
<polygon fill="black" stroke="black" points="815.21,-304.64 804.81,-306.66 814.2,-311.57 815.21,-304.64"/>
</g>
<!-- expert_1_5_stage1 -->
<g id="node14" class="node">
<title>expert_1_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="965.47,-307.98 822.47,-307.98 822.47,-266.98 965.47,-266.98 965.47,-307.98"/>
<text text-anchor="middle" x="893.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 5 (TP8) L1</text>
<text text-anchor="middle" x="893.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="893.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_5_stage1 -->
<g id="edge14" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.03,-372.65C4531.3,-371.12 2844.33,-363.07 1456.97,-326.98 1245.46,-321.48 1188.44,-337.3 975.72,-308.09"/>
<polygon fill="black" stroke="black" points="976.19,-304.62 965.8,-306.71 975.22,-311.55 976.19,-304.62"/>
</g>
<!-- expert_1_6_stage1 -->
<g id="node15" class="node">
<title>expert_1_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="1126.47,-307.98 983.47,-307.98 983.47,-266.98 1126.47,-266.98 1126.47,-307.98"/>
<text text-anchor="middle" x="1054.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 6 (TP8) L1</text>
<text text-anchor="middle" x="1054.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1054.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_6_stage1 -->
<g id="edge15" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.1,-373.15C4534.45,-373.52 2867.59,-371.73 1496.97,-326.98 1339.25,-321.83 1296.13,-330.99 1136.96,-308.14"/>
<polygon fill="black" stroke="black" points="1137.21,-304.64 1126.81,-306.66 1136.2,-311.57 1137.21,-304.64"/>
</g>
<!-- expert_1_7_stage1 -->
<g id="node16" class="node">
<title>expert_1_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="1287.47,-307.98 1144.47,-307.98 1144.47,-266.98 1287.47,-266.98 1287.47,-307.98"/>
<text text-anchor="middle" x="1215.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 7 (TP8) L1</text>
<text text-anchor="middle" x="1215.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1215.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_7_stage1 -->
<g id="edge16" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4970.94,-372.42C4556.42,-370.12 3038.86,-359.8 1788.97,-326.98 1573.09,-321.32 1514.89,-337.81 1297.92,-308.11"/>
<polygon fill="black" stroke="black" points="1298.19,-304.62 1287.8,-306.71 1297.23,-311.55 1298.19,-304.62"/>
</g>
<!-- expert_1_8_stage1 -->
<g id="node17" class="node">
<title>expert_1_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="1448.47,-307.98 1305.47,-307.98 1305.47,-266.98 1448.47,-266.98 1448.47,-307.98"/>
<text text-anchor="middle" x="1376.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 8 (TP8) L1</text>
<text text-anchor="middle" x="1376.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1376.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_8_stage1 -->
<g id="edge17" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_8_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4970.89,-372.95C4558.7,-372.52 3056.77,-368.06 1819.97,-326.98 1661.82,-321.73 1618.58,-331.04 1458.99,-308.14"/>
<polygon fill="black" stroke="black" points="1459.21,-304.64 1448.81,-306.66 1458.2,-311.57 1459.21,-304.64"/>
</g>
<!-- expert_1_9_stage1 -->
<g id="node18" class="node">
<title>expert_1_9_stage1</title>
<polygon fill="lightblue" stroke="black" points="1609.47,-307.98 1466.47,-307.98 1466.47,-266.98 1609.47,-266.98 1609.47,-307.98"/>
<text text-anchor="middle" x="1537.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 9 (TP8) L1</text>
<text text-anchor="middle" x="1537.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1537.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_9_stage1 -->
<g id="edge18" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_9_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.18,-372.19C4582.97,-369.18 3229.51,-357.06 2112.97,-326.98 1896.22,-321.14 1837.78,-337.91 1619.96,-308.12"/>
<polygon fill="black" stroke="black" points="1620.19,-304.62 1609.8,-306.71 1619.23,-311.55 1620.19,-304.62"/>
</g>
<!-- expert_1_10_stage1 -->
<g id="node19" class="node">
<title>expert_1_10_stage1</title>
<polygon fill="lightblue" stroke="black" points="1770.47,-307.98 1627.47,-307.98 1627.47,-266.98 1770.47,-266.98 1770.47,-307.98"/>
<text text-anchor="middle" x="1698.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 10 (TP8) L1</text>
<text text-anchor="middle" x="1698.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1698.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_10_stage1 -->
<g id="edge19" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_10_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4970.97,-372.7C4585.01,-371.4 3247.34,-364.33 2143.97,-326.98 1984.95,-321.6 1941.47,-331.14 1781.04,-308.15"/>
<polygon fill="black" stroke="black" points="1781.21,-304.64 1770.81,-306.66 1780.2,-311.57 1781.21,-304.64"/>
</g>
<!-- expert_1_11_stage1 -->
<g id="node20" class="node">
<title>expert_1_11_stage1</title>
<polygon fill="lightblue" stroke="black" points="1931.47,-307.98 1788.47,-307.98 1788.47,-266.98 1931.47,-266.98 1931.47,-307.98"/>
<text text-anchor="middle" x="1859.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 11 (TP8) L1</text>
<text text-anchor="middle" x="1859.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1859.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_11_stage1 -->
<g id="edge20" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_11_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.28,-371.87C4611.06,-368.06 3423.56,-354.11 2441.97,-326.98 2222.06,-320.9 2162.83,-338.28 1941.77,-308.09"/>
<polygon fill="black" stroke="black" points="1942.19,-304.62 1931.8,-306.71 1941.23,-311.55 1942.19,-304.62"/>
</g>
<!-- expert_1_12_stage1 -->
<g id="node21" class="node">
<title>expert_1_12_stage1</title>
<polygon fill="lightblue" stroke="black" points="2092.47,-307.98 1949.47,-307.98 1949.47,-266.98 2092.47,-266.98 2092.47,-307.98"/>
<text text-anchor="middle" x="2020.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 12 (TP8) L1</text>
<text text-anchor="middle" x="2020.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2020.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_12_stage1 -->
<g id="edge21" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_12_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.02,-372.35C4613.26,-370.01 3442.04,-360.17 2473.97,-326.98 2311.32,-321.41 2266.95,-331.56 2102.76,-308.11"/>
<polygon fill="black" stroke="black" points="2103.21,-304.64 2092.81,-306.67 2102.2,-311.56 2103.21,-304.64"/>
</g>
<!-- expert_1_13_stage1 -->
<g id="node22" class="node">
<title>expert_1_13_stage1</title>
<polygon fill="lightblue" stroke="black" points="2253.47,-307.98 2110.47,-307.98 2110.47,-266.98 2253.47,-266.98 2253.47,-307.98"/>
<text text-anchor="middle" x="2181.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 13 (TP8) L1</text>
<text text-anchor="middle" x="2181.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2181.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_13_stage1 -->
<g id="edge22" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_13_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.29,-371.6C4638.02,-367.24 3601.01,-352.43 2741.97,-326.98 2531.9,-320.76 2475.17,-337.11 2263.98,-308.12"/>
<polygon fill="black" stroke="black" points="2264.19,-304.62 2253.8,-306.71 2263.22,-311.55 2264.19,-304.62"/>
</g>
<!-- expert_1_14_stage1 -->
<g id="node23" class="node">
<title>expert_1_14_stage1</title>
<polygon fill="lightblue" stroke="black" points="2414.47,-307.98 2271.47,-307.98 2271.47,-266.98 2414.47,-266.98 2414.47,-307.98"/>
<text text-anchor="middle" x="2342.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 14 (TP8) L1</text>
<text text-anchor="middle" x="2342.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2342.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_14_stage1 -->
<g id="edge23" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_14_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.2,-372.14C4640.6,-369.31 3618.53,-358.45 2771.97,-326.98 2620.08,-321.34 2578.42,-330.29 2425.07,-308.16"/>
<polygon fill="black" stroke="black" points="2425.21,-304.64 2414.81,-306.66 2424.2,-311.57 2425.21,-304.64"/>
</g>
<!-- expert_1_15_stage1 -->
<g id="node24" class="node">
<title>expert_1_15_stage1</title>
<polygon fill="lightblue" stroke="black" points="2575.47,-307.98 2432.47,-307.98 2432.47,-266.98 2575.47,-266.98 2575.47,-307.98"/>
<text text-anchor="middle" x="2503.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 15 (TP8) L1</text>
<text text-anchor="middle" x="2503.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2503.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_15_stage1 -->
<g id="edge24" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_15_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4970.98,-373.22C4556.29,-373.69 3075.97,-370.9 2585.78,-308.06"/>
<polygon fill="black" stroke="black" points="2586.16,-304.58 2575.79,-306.75 2585.26,-311.52 2586.16,-304.58"/>
</g>
<!-- expert_1_16_stage1 -->
<g id="node25" class="node">
<title>expert_1_16_stage1</title>
<polygon fill="lightblue" stroke="black" points="2736.47,-307.98 2593.47,-307.98 2593.47,-266.98 2736.47,-266.98 2736.47,-307.98"/>
<text text-anchor="middle" x="2664.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 16 (TP8) L1</text>
<text text-anchor="middle" x="2664.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2664.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_16_stage1 -->
<g id="edge25" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_16_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.92,-370.12C4532.18,-358.48 2893.9,-314.95 2746.81,-307.42"/>
<polygon fill="black" stroke="black" points="2747.01,-303.93 2736.8,-306.75 2746.54,-310.91 2747.01,-303.93"/>
</g>
<!-- expert_1_17_stage1 -->
<g id="node26" class="node">
<title>expert_1_17_stage1</title>
<polygon fill="lightblue" stroke="black" points="2897.47,-307.98 2754.47,-307.98 2754.47,-266.98 2897.47,-266.98 2897.47,-307.98"/>
<text text-anchor="middle" x="2825.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 17 (TP8) L1</text>
<text text-anchor="middle" x="2825.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2825.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_17_stage1 -->
<g id="edge26" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_17_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4972.6,-368.8C4743.09,-359.98 4187.7,-339.18 3721.97,-325.98 3543.86,-320.94 3101.71,-331.23 2907.95,-308.04"/>
<polygon fill="black" stroke="black" points="2908.15,-304.54 2897.79,-306.77 2907.28,-311.49 2908.15,-304.54"/>
</g>
<!-- expert_1_18_stage1 -->
<g id="node27" class="node">
<title>expert_1_18_stage1</title>
<polygon fill="lightblue" stroke="black" points="3058.47,-307.98 2915.47,-307.98 2915.47,-266.98 3058.47,-266.98 3058.47,-307.98"/>
<text text-anchor="middle" x="2986.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 18 (TP8) L1</text>
<text text-anchor="middle" x="2986.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2986.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_18_stage1 -->
<g id="edge27" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_18_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4973.22,-367.83C4771.57,-358.29 4320.78,-337.73 3940.97,-325.98 3749.93,-320.08 3275.23,-332.72 3068.72,-308.02"/>
<polygon fill="black" stroke="black" points="3069.15,-304.54 3058.79,-306.77 3068.28,-311.49 3069.15,-304.54"/>
</g>
<!-- expert_1_19_stage1 -->
<g id="node28" class="node">
<title>expert_1_19_stage1</title>
<polygon fill="lightblue" stroke="black" points="3219.47,-307.98 3076.47,-307.98 3076.47,-266.98 3219.47,-266.98 3219.47,-307.98"/>
<text text-anchor="middle" x="3147.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 19 (TP8) L1</text>
<text text-anchor="middle" x="3147.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3147.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_19_stage1 -->
<g id="edge28" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_19_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4973.66,-367.26C4787.4,-357.45 4389.9,-337.33 4053.97,-325.98 3873.62,-319.89 3425.67,-331.46 3229.78,-308.02"/>
<polygon fill="black" stroke="black" points="3230.15,-304.54 3219.79,-306.77 3229.28,-311.49 3230.15,-304.54"/>
</g>
<!-- expert_1_20_stage1 -->
<g id="node29" class="node">
<title>expert_1_20_stage1</title>
<polygon fill="lightblue" stroke="black" points="3380.47,-307.98 3237.47,-307.98 3237.47,-266.98 3380.47,-266.98 3380.47,-307.98"/>
<text text-anchor="middle" x="3308.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 20 (TP8) L1</text>
<text text-anchor="middle" x="3308.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3308.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_20_stage1 -->
<g id="edge29" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_20_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4974.23,-367.01C4796.58,-357.16 4426.91,-337.48 4113.97,-325.98 3956.07,-320.18 3564.43,-328.84 3390.9,-308.04"/>
<polygon fill="black" stroke="black" points="3391.15,-304.54 3380.79,-306.76 3390.28,-311.48 3391.15,-304.54"/>
</g>
<!-- expert_1_21_stage1 -->
<g id="node30" class="node">
<title>expert_1_21_stage1</title>
<polygon fill="lightblue" stroke="black" points="3541.47,-307.98 3398.47,-307.98 3398.47,-266.98 3541.47,-266.98 3541.47,-307.98"/>
<text text-anchor="middle" x="3469.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 21 (TP8) L1</text>
<text text-anchor="middle" x="3469.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3469.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_21_stage1 -->
<g id="edge30" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_21_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4973.29,-367.6C4728.96,-355.28 4149.53,-326.09 4146.97,-325.98 4017.46,-320.77 3696.99,-325.56 3551.93,-308.04"/>
<polygon fill="black" stroke="black" points="3552.16,-304.54 3541.8,-306.74 3551.27,-311.48 3552.16,-304.54"/>
</g>
<!-- expert_1_22_stage1 -->
<g id="node31" class="node">
<title>expert_1_22_stage1</title>
<polygon fill="lightblue" stroke="black" points="3702.47,-307.98 3559.47,-307.98 3559.47,-266.98 3702.47,-266.98 3702.47,-307.98"/>
<text text-anchor="middle" x="3630.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 22 (TP8) L1</text>
<text text-anchor="middle" x="3630.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3630.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_22_stage1 -->
<g id="edge31" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_22_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4973.86,-367.1C4803.67,-357.77 4459.11,-339.27 4166.97,-325.98 3967.62,-316.92 3913.57,-335.52 3712.79,-308.09"/>
<polygon fill="black" stroke="black" points="3713.19,-304.61 3702.8,-306.71 3712.23,-311.55 3713.19,-304.61"/>
</g>
<!-- expert_1_23_stage1 -->
<g id="node32" class="node">
<title>expert_1_23_stage1</title>
<polygon fill="lightblue" stroke="black" points="3863.47,-307.98 3720.47,-307.98 3720.47,-266.98 3863.47,-266.98 3863.47,-307.98"/>
<text text-anchor="middle" x="3791.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 23 (TP8) L1</text>
<text text-anchor="middle" x="3791.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3791.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_23_stage1 -->
<g id="edge32" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_23_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4973.88,-367.4C4697.33,-352.84 3969.61,-314.42 3873.81,-307.52"/>
<polygon fill="black" stroke="black" points="3874.07,-304.03 3863.81,-306.66 3873.47,-311 3874.07,-304.03"/>
</g>
<!-- expert_1_24_stage1 -->
<g id="node33" class="node">
<title>expert_1_24_stage1</title>
<polygon fill="lightblue" stroke="black" points="4024.47,-307.98 3881.47,-307.98 3881.47,-266.98 4024.47,-266.98 4024.47,-307.98"/>
<text text-anchor="middle" x="3952.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 24 (TP8) L1</text>
<text text-anchor="middle" x="3952.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3952.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_24_stage1 -->
<g id="edge33" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_24_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4974.51,-366.74C4828.07,-358.05 4554.86,-341.7 4321.97,-326.98 4196.77,-319.07 4161.96,-327.09 4034.93,-308.15"/>
<polygon fill="black" stroke="black" points="4035.23,-304.66 4024.81,-306.62 4034.18,-311.58 4035.23,-304.66"/>
</g>
<!-- expert_1_25_stage1 -->
<g id="node34" class="node">
<title>expert_1_25_stage1</title>
<polygon fill="lightblue" stroke="black" points="4185.47,-307.98 4042.47,-307.98 4042.47,-266.98 4185.47,-266.98 4185.47,-307.98"/>
<text text-anchor="middle" x="4113.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 25 (TP8) L1</text>
<text text-anchor="middle" x="4113.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4113.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_25_stage1 -->
<g id="edge34" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_25_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4971.57,-370.8C4805.88,-366.2 4479.78,-352.09 4195.9,-308.17"/>
<polygon fill="black" stroke="black" points="4196.24,-304.68 4185.82,-306.59 4195.16,-311.59 4196.24,-304.68"/>
</g>
<!-- expert_1_26_stage1 -->
<g id="node35" class="node">
<title>expert_1_26_stage1</title>
<polygon fill="lightblue" stroke="black" points="4346.47,-307.98 4203.47,-307.98 4203.47,-266.98 4346.47,-266.98 4346.47,-307.98"/>
<text text-anchor="middle" x="4274.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 26 (TP8) L1</text>
<text text-anchor="middle" x="4274.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4274.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_26_stage1 -->
<g id="edge35" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_26_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4973.08,-368.4C4833.17,-361.29 4580.38,-344.59 4356.78,-308.17"/>
<polygon fill="black" stroke="black" points="4357.26,-304.7 4346.83,-306.53 4356.13,-311.61 4357.26,-304.7"/>
</g>
<!-- expert_1_27_stage1 -->
<g id="node36" class="node">
<title>expert_1_27_stage1</title>
<polygon fill="lightblue" stroke="black" points="4507.47,-307.98 4364.47,-307.98 4364.47,-266.98 4507.47,-266.98 4507.47,-307.98"/>
<text text-anchor="middle" x="4435.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 27 (TP8) L1</text>
<text text-anchor="middle" x="4435.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4435.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_27_stage1 -->
<g id="edge36" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_27_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4976.5,-364.94C4865.17,-355.41 4682.87,-337.24 4517.69,-308.2"/>
<polygon fill="black" stroke="black" points="4518.3,-304.75 4507.84,-306.45 4517.08,-311.64 4518.3,-304.75"/>
</g>
<!-- expert_1_28_stage1 -->
<g id="node37" class="node">
<title>expert_1_28_stage1</title>
<polygon fill="lightblue" stroke="black" points="4668.47,-307.98 4525.47,-307.98 4525.47,-266.98 4668.47,-266.98 4668.47,-307.98"/>
<text text-anchor="middle" x="4596.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 28 (TP8) L1</text>
<text text-anchor="middle" x="4596.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4596.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_28_stage1 -->
<g id="edge37" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_28_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4984.73,-359.79C4905.22,-348.28 4788.75,-330.25 4678.81,-308.29"/>
<polygon fill="black" stroke="black" points="4679.37,-304.83 4668.87,-306.29 4677.99,-311.7 4679.37,-304.83"/>
</g>
<!-- expert_1_29_stage1 -->
<g id="node38" class="node">
<title>expert_1_29_stage1</title>
<polygon fill="lightblue" stroke="black" points="4829.47,-307.98 4686.47,-307.98 4686.47,-266.98 4829.47,-266.98 4829.47,-307.98"/>
<text text-anchor="middle" x="4757.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 29 (TP8) L1</text>
<text text-anchor="middle" x="4757.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4757.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_29_stage1 -->
<g id="edge38" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_29_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5004.07,-353.06C4954.57,-340.07 4890,-323.13 4839.42,-309.85"/>
<polygon fill="black" stroke="black" points="4840.06,-306.4 4829.5,-307.25 4838.29,-313.17 4840.06,-306.4"/>
</g>
<!-- expert_1_30_stage1 -->
<g id="node39" class="node">
<title>expert_1_30_stage1</title>
<polygon fill="lightblue" stroke="black" points="4990.47,-307.98 4847.47,-307.98 4847.47,-266.98 4990.47,-266.98 4990.47,-307.98"/>
<text text-anchor="middle" x="4918.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 30 (TP8) L1</text>
<text text-anchor="middle" x="4918.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4918.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_30_stage1 -->
<g id="edge39" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_30_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5037.07,-347.15C5024.88,-340.07 5011.51,-332.54 4998.97,-325.98 4990.21,-321.4 4980.78,-316.74 4971.58,-312.34"/>
<polygon fill="black" stroke="black" points="4973.03,-309.15 4962.49,-308.04 4970.03,-315.48 4973.03,-309.15"/>
</g>
<!-- expert_1_31_stage1 -->
<g id="node40" class="node">
<title>expert_1_31_stage1</title>
<polygon fill="lightblue" stroke="black" points="5151.47,-307.98 5008.47,-307.98 5008.47,-266.98 5151.47,-266.98 5151.47,-307.98"/>
<text text-anchor="middle" x="5079.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 31 (TP8) L1</text>
<text text-anchor="middle" x="5079.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5079.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_31_stage1 -->
<g id="edge40" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_31_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5079.97,-344.84C5079.97,-336.31 5079.97,-326.91 5079.97,-318.27"/>
<polygon fill="black" stroke="black" points="5083.47,-318.22 5079.97,-308.22 5076.47,-318.22 5083.47,-318.22"/>
</g>
<!-- expert_1_32_stage1 -->
<g id="node41" class="node">
<title>expert_1_32_stage1</title>
<polygon fill="lightblue" stroke="black" points="5312.47,-307.98 5169.47,-307.98 5169.47,-266.98 5312.47,-266.98 5312.47,-307.98"/>
<text text-anchor="middle" x="5240.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 32 (TP8) L1</text>
<text text-anchor="middle" x="5240.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5240.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_32_stage1 -->
<g id="edge41" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_32_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5127.84,-347.85C5149,-336.75 5173.77,-323.75 5194.74,-312.75"/>
<polygon fill="black" stroke="black" points="5196.54,-315.75 5203.77,-308.01 5193.29,-309.56 5196.54,-315.75"/>
</g>
<!-- expert_1_33_stage1 -->
<g id="node42" class="node">
<title>expert_1_33_stage1</title>
<polygon fill="lightblue" stroke="black" points="5473.47,-307.98 5330.47,-307.98 5330.47,-266.98 5473.47,-266.98 5473.47,-307.98"/>
<text text-anchor="middle" x="5401.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 33 (TP8) L1</text>
<text text-anchor="middle" x="5401.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5401.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_33_stage1 -->
<g id="edge42" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_33_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5155.88,-353.06C5205.38,-340.07 5269.95,-323.13 5320.53,-309.85"/>
<polygon fill="black" stroke="black" points="5321.66,-313.17 5330.45,-307.25 5319.89,-306.4 5321.66,-313.17"/>
</g>
<!-- expert_1_34_stage1 -->
<g id="node43" class="node">
<title>expert_1_34_stage1</title>
<polygon fill="lightblue" stroke="black" points="5634.47,-307.98 5491.47,-307.98 5491.47,-266.98 5634.47,-266.98 5634.47,-307.98"/>
<text text-anchor="middle" x="5562.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 34 (TP8) L1</text>
<text text-anchor="middle" x="5562.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5562.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_34_stage1 -->
<g id="edge43" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_34_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5174.97,-359.7C5254.26,-348.13 5370.44,-330.07 5481.05,-308.1"/>
<polygon fill="black" stroke="black" points="5481.93,-311.49 5491.05,-306.1 5480.56,-304.63 5481.93,-311.49"/>
</g>
<!-- expert_1_35_stage1 -->
<g id="node44" class="node">
<title>expert_1_35_stage1</title>
<polygon fill="lightblue" stroke="black" points="5795.47,-307.98 5652.47,-307.98 5652.47,-266.98 5795.47,-266.98 5795.47,-307.98"/>
<text text-anchor="middle" x="5723.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 35 (TP8) L1</text>
<text text-anchor="middle" x="5723.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5723.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_35_stage1 -->
<g id="edge44" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_35_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5183.51,-364.81C5294.66,-355.19 5476.46,-336.96 5642.2,-308.01"/>
<polygon fill="black" stroke="black" points="5642.84,-311.45 5652.08,-306.27 5641.62,-304.56 5642.84,-311.45"/>
</g>
<!-- expert_1_36_stage1 -->
<g id="node45" class="node">
<title>expert_1_36_stage1</title>
<polygon fill="lightblue" stroke="black" points="5956.47,-307.98 5813.47,-307.98 5813.47,-266.98 5956.47,-266.98 5956.47,-307.98"/>
<text text-anchor="middle" x="5884.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 36 (TP8) L1</text>
<text text-anchor="middle" x="5884.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5884.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_36_stage1 -->
<g id="edge45" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_36_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5187.01,-368.28C5326.77,-361.05 5578.99,-344.22 5803.12,-307.99"/>
<polygon fill="black" stroke="black" points="5803.79,-311.43 5813.1,-306.37 5802.66,-304.52 5803.79,-311.43"/>
</g>
<!-- expert_1_37_stage1 -->
<g id="node46" class="node">
<title>expert_1_37_stage1</title>
<polygon fill="lightblue" stroke="black" points="6117.47,-307.98 5974.47,-307.98 5974.47,-266.98 6117.47,-266.98 6117.47,-307.98"/>
<text text-anchor="middle" x="6045.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 37 (TP8) L1</text>
<text text-anchor="middle" x="6045.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6045.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_37_stage1 -->
<g id="edge46" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_37_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.24,-370.7C5353.73,-365.96 5679.43,-351.67 5964,-307.99"/>
<polygon fill="black" stroke="black" points="5964.76,-311.42 5974.11,-306.43 5963.69,-304.5 5964.76,-311.42"/>
</g>
<!-- expert_1_38_stage1 -->
<g id="node47" class="node">
<title>expert_1_38_stage1</title>
<polygon fill="lightblue" stroke="black" points="6278.47,-307.98 6135.47,-307.98 6135.47,-266.98 6278.47,-266.98 6278.47,-307.98"/>
<text text-anchor="middle" x="6206.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 38 (TP8) L1</text>
<text text-anchor="middle" x="6206.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6206.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_38_stage1 -->
<g id="edge47" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_38_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5185.58,-366.76C5332.22,-358.09 5605.78,-341.77 5838.97,-326.98 5963.31,-319.1 5997.86,-326.82 6124.98,-307.98"/>
<polygon fill="black" stroke="black" points="6125.74,-311.41 6135.11,-306.45 6124.7,-304.48 6125.74,-311.41"/>
</g>
<!-- expert_1_39_stage1 -->
<g id="node48" class="node">
<title>expert_1_39_stage1</title>
<polygon fill="lightblue" stroke="black" points="6439.47,-307.98 6296.47,-307.98 6296.47,-266.98 6439.47,-266.98 6439.47,-307.98"/>
<text text-anchor="middle" x="6367.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 39 (TP8) L1</text>
<text text-anchor="middle" x="6367.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6367.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_39_stage1 -->
<g id="edge48" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_39_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5189.24,-373.74C5400.11,-373.76 5877.66,-366.74 6286.18,-307.94"/>
<polygon fill="black" stroke="black" points="6286.72,-311.4 6296.12,-306.5 6285.72,-304.47 6286.72,-311.4"/>
</g>
<!-- expert_1_40_stage1 -->
<g id="node49" class="node">
<title>expert_1_40_stage1</title>
<polygon fill="lightblue" stroke="black" points="6600.47,-307.98 6457.47,-307.98 6457.47,-266.98 6600.47,-266.98 6600.47,-307.98"/>
<text text-anchor="middle" x="6528.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 40 (TP8) L1</text>
<text text-anchor="middle" x="6528.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6528.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_40_stage1 -->
<g id="edge49" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_40_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5187.44,-369.04C5379.75,-361.84 5795.43,-345.57 6145.97,-326.98 6276.99,-320.04 6313.23,-327.63 6446.89,-307.99"/>
<polygon fill="black" stroke="black" points="6447.74,-311.41 6457.11,-306.47 6446.71,-304.48 6447.74,-311.41"/>
</g>
<!-- expert_1_41_stage1 -->
<g id="node50" class="node">
<title>expert_1_41_stage1</title>
<polygon fill="lightblue" stroke="black" points="6761.47,-307.98 6618.47,-307.98 6618.47,-266.98 6761.47,-266.98 6761.47,-307.98"/>
<text text-anchor="middle" x="6689.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 41 (TP8) L1</text>
<text text-anchor="middle" x="6689.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6689.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_41_stage1 -->
<g id="edge50" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_41_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.4,-371.1C5486.38,-365.51 6314.47,-346.97 6607.91,-307.94"/>
<polygon fill="black" stroke="black" points="6608.69,-311.37 6618.12,-306.54 6607.74,-304.43 6608.69,-311.37"/>
</g>
<!-- expert_1_42_stage1 -->
<g id="node51" class="node">
<title>expert_1_42_stage1</title>
<polygon fill="lightblue" stroke="black" points="6922.47,-307.98 6779.47,-307.98 6779.47,-266.98 6922.47,-266.98 6922.47,-307.98"/>
<text text-anchor="middle" x="6850.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 42 (TP8) L1</text>
<text text-anchor="middle" x="6850.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6850.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_42_stage1 -->
<g id="edge51" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_42_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5187.9,-370.08C5416.6,-363.76 5966.84,-347.66 6427.97,-326.98 6576.79,-320.31 6617.62,-329.69 6768.98,-307.97"/>
<polygon fill="black" stroke="black" points="6769.73,-311.4 6779.12,-306.49 6768.72,-304.47 6769.73,-311.4"/>
</g>
<!-- expert_1_43_stage1 -->
<g id="node52" class="node">
<title>expert_1_43_stage1</title>
<polygon fill="lightblue" stroke="black" points="7083.47,-307.98 6940.47,-307.98 6940.47,-266.98 7083.47,-266.98 7083.47,-307.98"/>
<text text-anchor="middle" x="7011.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 43 (TP8) L1</text>
<text text-anchor="middle" x="7011.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7011.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_43_stage1 -->
<g id="edge52" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_43_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5187.68,-369.52C5417.91,-362.11 5975.01,-343.94 6441.97,-326.98 6656.04,-319.21 6713.79,-337.24 6930.04,-307.94"/>
<polygon fill="black" stroke="black" points="6930.7,-311.39 6940.13,-306.56 6929.74,-304.45 6930.7,-311.39"/>
</g>
<!-- expert_1_44_stage1 -->
<g id="node53" class="node">
<title>expert_1_44_stage1</title>
<polygon fill="lightblue" stroke="black" points="7244.47,-307.98 7101.47,-307.98 7101.47,-266.98 7244.47,-266.98 7244.47,-307.98"/>
<text text-anchor="middle" x="7172.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 44 (TP8) L1</text>
<text text-anchor="middle" x="7172.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7172.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_44_stage1 -->
<g id="edge53" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_44_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.98,-372.38C5549.12,-369.97 6699.55,-358.5 7091.17,-307.9"/>
<polygon fill="black" stroke="black" points="7091.68,-311.36 7101.13,-306.58 7090.76,-304.42 7091.68,-311.36"/>
</g>
<!-- expert_1_45_stage1 -->
<g id="node54" class="node">
<title>expert_1_45_stage1</title>
<polygon fill="lightblue" stroke="black" points="7405.47,-307.98 7262.47,-307.98 7262.47,-266.98 7405.47,-266.98 7405.47,-307.98"/>
<text text-anchor="middle" x="7333.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 45 (TP8) L1</text>
<text text-anchor="middle" x="7333.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7333.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_45_stage1 -->
<g id="edge54" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_45_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.46,-371.34C5471.05,-366.85 6253.14,-352.9 6903.97,-326.98 7055.86,-320.93 7097.5,-330.07 7251.79,-308"/>
<polygon fill="black" stroke="black" points="7252.72,-311.4 7262.12,-306.5 7251.72,-304.47 7252.72,-311.4"/>
</g>
<!-- expert_1_46_stage1 -->
<g id="node55" class="node">
<title>expert_1_46_stage1</title>
<polygon fill="lightblue" stroke="black" points="7566.47,-307.98 7423.47,-307.98 7423.47,-266.98 7566.47,-266.98 7566.47,-307.98"/>
<text text-anchor="middle" x="7494.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 46 (TP8) L1</text>
<text text-anchor="middle" x="7494.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7494.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_46_stage1 -->
<g id="edge55" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_46_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.27,-370.79C5472.65,-364.95 6264.17,-347.95 6922.97,-326.98 7137.95,-320.14 7195.9,-337.37 7413,-307.95"/>
<polygon fill="black" stroke="black" points="7413.7,-311.39 7423.13,-306.56 7412.74,-304.45 7413.7,-311.39"/>
</g>
<!-- expert_1_47_stage1 -->
<g id="node56" class="node">
<title>expert_1_47_stage1</title>
<polygon fill="lightblue" stroke="black" points="7727.47,-307.98 7584.47,-307.98 7584.47,-266.98 7727.47,-266.98 7727.47,-307.98"/>
<text text-anchor="middle" x="7655.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 47 (TP8) L1</text>
<text text-anchor="middle" x="7655.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7655.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_47_stage1 -->
<g id="edge56" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_47_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.38,-370.98C5486.86,-365.36 6345.96,-348.45 7059.97,-326.98 7285.67,-320.2 7346.35,-338.63 7574.2,-307.92"/>
<polygon fill="black" stroke="black" points="7574.69,-311.39 7584.13,-306.57 7573.75,-304.45 7574.69,-311.39"/>
</g>
<!-- expert_1_48_stage1 -->
<g id="node57" class="node">
<title>expert_1_48_stage1</title>
<polygon fill="lightblue" stroke="black" points="7888.47,-307.98 7745.47,-307.98 7745.47,-266.98 7888.47,-266.98 7888.47,-307.98"/>
<text text-anchor="middle" x="7816.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 48 (TP8) L1</text>
<text text-anchor="middle" x="7816.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7816.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_48_stage1 -->
<g id="edge57" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_48_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.63,-371.21C5502.73,-365.99 6438.99,-349.54 7215.97,-326.98 7443.87,-320.37 7505.13,-338.89 7735.11,-307.93"/>
<polygon fill="black" stroke="black" points="7735.69,-311.38 7745.13,-306.57 7734.75,-304.45 7735.69,-311.38"/>
</g>
<!-- expert_1_49_stage1 -->
<g id="node58" class="node">
<title>expert_1_49_stage1</title>
<polygon fill="lightblue" stroke="black" points="8049.47,-307.98 7906.47,-307.98 7906.47,-266.98 8049.47,-266.98 8049.47,-307.98"/>
<text text-anchor="middle" x="7977.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 49 (TP8) L1</text>
<text text-anchor="middle" x="7977.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7977.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_49_stage1 -->
<g id="edge58" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_49_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.55,-371.44C5517.96,-366.65 6535.09,-350.84 7377.97,-326.98 7605.44,-320.54 7666.58,-338.84 7896.13,-307.93"/>
<polygon fill="black" stroke="black" points="7896.69,-311.39 7906.13,-306.57 7895.75,-304.45 7896.69,-311.39"/>
</g>
<!-- expert_1_50_stage1 -->
<g id="node59" class="node">
<title>expert_1_50_stage1</title>
<polygon fill="lightblue" stroke="black" points="8210.47,-307.98 8067.47,-307.98 8067.47,-266.98 8210.47,-266.98 8210.47,-307.98"/>
<text text-anchor="middle" x="8138.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 50 (TP8) L1</text>
<text text-anchor="middle" x="8138.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8138.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_50_stage1 -->
<g id="edge59" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_50_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.8,-371.64C5533.38,-367.25 6631.28,-352.14 7539.97,-326.98 7767,-320.7 7828.02,-338.8 8057.15,-307.93"/>
<polygon fill="black" stroke="black" points="8057.69,-311.39 8067.13,-306.57 8056.75,-304.45 8057.69,-311.39"/>
</g>
<!-- expert_1_51_stage1 -->
<g id="node60" class="node">
<title>expert_1_51_stage1</title>
<polygon fill="lightblue" stroke="black" points="8371.47,-307.98 8228.47,-307.98 8228.47,-266.98 8371.47,-266.98 8371.47,-307.98"/>
<text text-anchor="middle" x="8299.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 51 (TP8) L1</text>
<text text-anchor="middle" x="8299.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8299.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_51_stage1 -->
<g id="edge60" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_51_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.64,-371.82C5547.42,-367.83 6726.9,-353.45 7701.97,-326.98 7928.57,-320.83 7989.46,-338.75 8218.17,-307.92"/>
<polygon fill="black" stroke="black" points="8218.69,-311.39 8228.13,-306.57 8217.75,-304.45 8218.69,-311.39"/>
</g>
<!-- expert_1_52_stage1 -->
<g id="node61" class="node">
<title>expert_1_52_stage1</title>
<polygon fill="lightblue" stroke="black" points="8532.47,-307.98 8389.47,-307.98 8389.47,-266.98 8532.47,-266.98 8532.47,-307.98"/>
<text text-anchor="middle" x="8460.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 52 (TP8) L1</text>
<text text-anchor="middle" x="8460.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8460.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_52_stage1 -->
<g id="edge61" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_52_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.73,-371.97C5561.51,-368.35 6821.99,-354.71 7862.97,-326.98 8089.57,-320.95 8150.46,-338.75 8379.17,-307.92"/>
<polygon fill="black" stroke="black" points="8379.69,-311.39 8389.13,-306.57 8378.75,-304.45 8379.69,-311.39"/>
</g>
<!-- expert_1_53_stage1 -->
<g id="node62" class="node">
<title>expert_1_53_stage1</title>
<polygon fill="lightblue" stroke="black" points="8693.47,-307.98 8550.47,-307.98 8550.47,-266.98 8693.47,-266.98 8693.47,-307.98"/>
<text text-anchor="middle" x="8621.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 53 (TP8) L1</text>
<text text-anchor="middle" x="8621.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8621.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_53_stage1 -->
<g id="edge62" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_53_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.93,-372.1C5575.44,-368.83 6917.02,-355.97 8023.97,-326.98 8250.57,-321.05 8311.46,-338.76 8540.17,-307.92"/>
<polygon fill="black" stroke="black" points="8540.69,-311.39 8550.13,-306.57 8539.75,-304.45 8540.69,-311.39"/>
</g>
<!-- expert_1_54_stage1 -->
<g id="node63" class="node">
<title>expert_1_54_stage1</title>
<polygon fill="lightblue" stroke="black" points="8854.47,-307.98 8711.47,-307.98 8711.47,-266.98 8854.47,-266.98 8854.47,-307.98"/>
<text text-anchor="middle" x="8782.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 54 (TP8) L1</text>
<text text-anchor="middle" x="8782.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8782.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_54_stage1 -->
<g id="edge63" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_54_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.96,-372.22C5588.65,-369.29 7011.76,-357.23 8184.97,-326.98 8411.58,-321.14 8472.46,-338.76 8701.17,-307.92"/>
<polygon fill="black" stroke="black" points="8701.69,-311.39 8711.13,-306.57 8700.75,-304.45 8701.69,-311.39"/>
</g>
<!-- expert_1_55_stage1 -->
<g id="node64" class="node">
<title>expert_1_55_stage1</title>
<polygon fill="lightblue" stroke="black" points="9015.47,-307.98 8872.47,-307.98 8872.47,-266.98 9015.47,-266.98 9015.47,-307.98"/>
<text text-anchor="middle" x="8943.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 55 (TP8) L1</text>
<text text-anchor="middle" x="8943.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8943.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_55_stage1 -->
<g id="edge64" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_55_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.89,-372.34C5601.26,-369.73 7106.26,-358.49 8345.97,-326.98 8572.58,-321.22 8633.46,-338.76 8862.17,-307.92"/>
<polygon fill="black" stroke="black" points="8862.69,-311.39 8872.13,-306.57 8861.75,-304.45 8862.69,-311.39"/>
</g>
<!-- expert_1_56_stage1 -->
<g id="node65" class="node">
<title>expert_1_56_stage1</title>
<polygon fill="lightblue" stroke="black" points="9176.47,-307.98 9033.47,-307.98 9033.47,-266.98 9176.47,-266.98 9176.47,-307.98"/>
<text text-anchor="middle" x="9104.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 56 (TP8) L1</text>
<text text-anchor="middle" x="9104.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9104.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_56_stage1 -->
<g id="edge65" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_56_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.91,-372.45C5614.2,-370.22 7203.67,-360.02 8511.97,-326.98 8736.28,-321.32 8796.63,-338.49 9022.92,-307.96"/>
<polygon fill="black" stroke="black" points="9023.69,-311.39 9033.13,-306.56 9022.75,-304.45 9023.69,-311.39"/>
</g>
<!-- expert_1_57_stage1 -->
<g id="node66" class="node">
<title>expert_1_57_stage1</title>
<polygon fill="lightblue" stroke="black" points="9337.47,-307.98 9194.47,-307.98 9194.47,-266.98 9337.47,-266.98 9337.47,-307.98"/>
<text text-anchor="middle" x="9265.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 57 (TP8) L1</text>
<text text-anchor="middle" x="9265.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9265.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_57_stage1 -->
<g id="edge66" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_57_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5189.1,-372.54C5626.79,-370.6 7297.62,-361.23 8671.97,-326.98 8896.72,-321.38 8957.18,-338.54 9183.9,-307.96"/>
<polygon fill="black" stroke="black" points="9184.69,-311.39 9194.13,-306.56 9183.75,-304.45 9184.69,-311.39"/>
</g>
<!-- expert_1_58_stage1 -->
<g id="node67" class="node">
<title>expert_1_58_stage1</title>
<polygon fill="lightblue" stroke="black" points="9498.47,-307.98 9355.47,-307.98 9355.47,-266.98 9498.47,-266.98 9498.47,-307.98"/>
<text text-anchor="middle" x="9426.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 58 (TP8) L1</text>
<text text-anchor="middle" x="9426.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9426.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_58_stage1 -->
<g id="edge67" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_58_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.96,-372.62C5638.28,-370.96 7391.1,-362.44 8831.97,-326.98 9057.16,-321.44 9117.74,-338.6 9344.89,-307.96"/>
<polygon fill="black" stroke="black" points="9345.69,-311.39 9355.13,-306.56 9344.75,-304.45 9345.69,-311.39"/>
</g>
<!-- expert_1_59_stage1 -->
<g id="node68" class="node">
<title>expert_1_59_stage1</title>
<polygon fill="lightblue" stroke="black" points="9659.47,-307.98 9516.47,-307.98 9516.47,-266.98 9659.47,-266.98 9659.47,-307.98"/>
<text text-anchor="middle" x="9587.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 59 (TP8) L1</text>
<text text-anchor="middle" x="9587.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9587.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_59_stage1 -->
<g id="edge68" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_59_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.89,-372.7C5649.69,-371.31 7484.57,-363.64 8991.97,-326.98 9217.71,-321.49 9278.35,-338.67 9506.2,-307.92"/>
<polygon fill="black" stroke="black" points="9506.69,-311.39 9516.13,-306.57 9505.75,-304.45 9506.69,-311.39"/>
</g>
<!-- expert_1_60_stage1 -->
<g id="node69" class="node">
<title>expert_1_60_stage1</title>
<polygon fill="lightblue" stroke="black" points="9820.47,-307.98 9677.47,-307.98 9677.47,-266.98 9820.47,-266.98 9820.47,-307.98"/>
<text text-anchor="middle" x="9748.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 60 (TP8) L1</text>
<text text-anchor="middle" x="9748.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9748.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_60_stage1 -->
<g id="edge69" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_60_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5189.06,-372.78C5661.87,-371.72 7581.13,-365.16 9156.97,-326.98 9380.85,-321.56 9441.07,-338.45 9666.94,-307.96"/>
<polygon fill="black" stroke="black" points="9667.69,-311.39 9677.13,-306.56 9666.75,-304.45 9667.69,-311.39"/>
</g>
<!-- expert_1_61_stage1 -->
<g id="node70" class="node">
<title>expert_1_61_stage1</title>
<polygon fill="lightblue" stroke="black" points="9981.47,-307.98 9838.47,-307.98 9838.47,-266.98 9981.47,-266.98 9981.47,-307.98"/>
<text text-anchor="middle" x="9909.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 61 (TP8) L1</text>
<text text-anchor="middle" x="9909.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9909.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_61_stage1 -->
<g id="edge70" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_61_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5188.84,-372.84C5672.39,-372.04 7674.22,-366.37 9316.97,-326.98 9541.29,-321.6 9601.63,-338.5 9827.92,-307.96"/>
<polygon fill="black" stroke="black" points="9828.69,-311.39 9838.13,-306.56 9827.75,-304.45 9828.69,-311.39"/>
</g>
<!-- expert_1_62_stage1 -->
<g id="node71" class="node">
<title>expert_1_62_stage1</title>
<polygon fill="lightblue" stroke="black" points="10142.47,-307.98 9999.47,-307.98 9999.47,-266.98 10142.47,-266.98 10142.47,-307.98"/>
<text text-anchor="middle" x="10070.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 62 (TP8) L1</text>
<text text-anchor="middle" x="10070.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="10070.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_62_stage1 -->
<g id="edge71" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_62_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5189.19,-372.9C5684.3,-372.34 7767.89,-367.56 9476.97,-326.98 9701.72,-321.65 9762.18,-338.55 9988.9,-307.96"/>
<polygon fill="black" stroke="black" points="9989.69,-311.39 9999.13,-306.56 9988.75,-304.45 9989.69,-311.39"/>
</g>
<!-- expert_1_63_stage1 -->
<g id="node72" class="node">
<title>expert_1_63_stage1</title>
<polygon fill="lightblue" stroke="black" points="10303.47,-307.98 10160.47,-307.98 10160.47,-266.98 10303.47,-266.98 10303.47,-307.98"/>
<text text-anchor="middle" x="10231.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 63 (TP8) L1</text>
<text text-anchor="middle" x="10231.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="10231.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_1_stage1&#45;&gt;expert_1_63_stage1 -->
<g id="edge72" class="edge">
<title>dispatch_1_stage1&#45;&gt;expert_1_63_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5189.02,-372.97C5694.9,-372.72 7863.82,-369.13 9641.97,-326.98 9864.98,-321.7 9924.96,-338.35 10149.98,-307.95"/>
<polygon fill="black" stroke="black" points="10150.69,-311.39 10160.13,-306.56 10149.74,-304.45 10150.69,-311.39"/>
</g>
<!-- combine_1_stage1 -->
<g id="node73" class="node">
<title>combine_1_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="5159.97" cy="-200.99" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="5159.97" y="-209.49" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L1</text>
<text text-anchor="middle" x="5159.97" y="-198.49" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5159.97" y="-187.49" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- expert_1_0_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge73" class="edge">
<title>expert_1_0_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M160.81,-268.31C163.56,-267.82 166.29,-267.38 168.97,-266.98 326.61,-243.79 367.72,-253 526.97,-247.98 1447.11,-219.01 4425.68,-205.08 5046.1,-202.45"/>
<polygon fill="black" stroke="black" points="5046.4,-205.95 5056.39,-202.41 5046.37,-198.95 5046.4,-205.95"/>
</g>
<!-- expert_1_1_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge74" class="edge">
<title>expert_1_1_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M321.8,-268.26C324.55,-267.79 327.28,-267.36 329.97,-266.98 543.61,-237.07 599.32,-253.35 814.97,-247.98 2497.4,-206.13 4547.2,-202.3 5046.43,-202"/>
<polygon fill="black" stroke="black" points="5046.52,-205.5 5056.51,-202 5046.51,-198.5 5046.52,-205.5"/>
</g>
<!-- expert_1_2_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge75" class="edge">
<title>expert_1_2_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M482.81,-268.3C485.56,-267.82 488.29,-267.38 490.97,-266.98 651.26,-243.48 693.06,-253.07 854.97,-247.98 1706.29,-221.23 4453.81,-205.66 5046.58,-202.56"/>
<polygon fill="black" stroke="black" points="5046.85,-206.06 5056.83,-202.51 5046.82,-199.06 5046.85,-206.06"/>
</g>
<!-- expert_1_3_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge76" class="edge">
<title>expert_1_3_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M643.8,-268.26C646.55,-267.79 649.28,-267.36 651.97,-266.98 862.96,-237.39 917.99,-253.42 1130.97,-247.98 2681.59,-208.39 4568.76,-202.88 5046.12,-202.11"/>
<polygon fill="black" stroke="black" points="5046.46,-205.61 5056.45,-202.1 5046.45,-198.61 5046.46,-205.61"/>
</g>
<!-- expert_1_4_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge77" class="edge">
<title>expert_1_4_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M804.81,-268.31C807.56,-267.82 810.29,-267.38 812.97,-266.98 970.61,-243.79 1011.72,-253.12 1170.97,-247.98 2705.04,-198.45 4572.46,-200.21 5046.44,-201.58"/>
<polygon fill="black" stroke="black" points="5046.69,-205.08 5056.7,-201.61 5046.71,-198.08 5046.69,-205.08"/>
</g>
<!-- expert_1_5_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge78" class="edge">
<title>expert_1_5_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M965.8,-268.25C968.55,-267.78 971.28,-267.36 973.97,-266.98 1195.99,-236.06 1253.89,-253.61 1477.97,-247.98 2885.21,-212.67 4595.7,-204.08 5046.63,-202.37"/>
<polygon fill="black" stroke="black" points="5046.74,-205.87 5056.73,-202.33 5046.71,-198.87 5046.74,-205.87"/>
</g>
<!-- expert_1_6_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge79" class="edge">
<title>expert_1_6_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M1126.81,-268.29C1129.56,-267.81 1132.29,-267.37 1134.97,-266.98 1304.52,-242.36 1348.74,-253.29 1519.97,-247.98 2909.37,-204.94 4598.26,-201.91 5046.4,-201.91"/>
<polygon fill="black" stroke="black" points="5046.43,-205.41 5056.43,-201.91 5046.43,-198.41 5046.43,-205.41"/>
</g>
<!-- expert_1_7_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge80" class="edge">
<title>expert_1_7_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M1287.8,-268.27C1290.55,-267.79 1293.28,-267.36 1295.97,-266.98 1497.26,-238.55 1549.76,-253.58 1752.97,-247.98 3046.34,-212.37 4616.67,-204.04 5046.57,-202.37"/>
<polygon fill="black" stroke="black" points="5046.83,-205.87 5056.82,-202.33 5046.8,-198.87 5046.83,-205.87"/>
</g>
<!-- expert_1_8_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge81" class="edge">
<title>expert_1_8_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M1448.81,-268.32C1451.56,-267.84 1454.29,-267.39 1456.97,-266.98 1599.63,-245.59 1636.82,-253.19 1780.97,-247.98 3062.27,-201.72 4618.39,-200.93 5046.39,-201.69"/>
<polygon fill="black" stroke="black" points="5046.59,-205.19 5056.59,-201.7 5046.6,-198.19 5046.59,-205.19"/>
</g>
<!-- expert_1_9_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge82" class="edge">
<title>expert_1_9_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M1609.79,-268.19C1612.55,-267.74 1615.28,-267.33 1617.97,-266.98 2056.6,-210.04 2170.75,-256.2 2612.97,-247.98 3553.8,-230.51 4690.12,-210.31 5047.08,-203.99"/>
<polygon fill="black" stroke="black" points="5047.23,-207.49 5057.16,-203.81 5047.1,-200.49 5047.23,-207.49"/>
</g>
<!-- expert_1_10_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge83" class="edge">
<title>expert_1_10_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M1770.79,-268.19C1773.55,-267.74 1776.28,-267.33 1778.97,-266.98 1820.4,-261.6 4463.41,-214.37 5046.83,-204"/>
<polygon fill="black" stroke="black" points="5046.99,-207.5 5056.93,-203.82 5046.87,-200.5 5046.99,-207.5"/>
</g>
<!-- expert_1_11_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge84" class="edge">
<title>expert_1_11_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M1931.79,-268.18C1934.55,-267.73 1937.28,-267.33 1939.97,-266.98 2062.32,-251.28 2926.65,-251.36 3049.97,-248.98 3813.29,-234.29 4731.85,-212.39 5047.27,-204.74"/>
<polygon fill="black" stroke="black" points="5047.42,-208.24 5057.33,-204.5 5047.25,-201.24 5047.42,-208.24"/>
</g>
<!-- expert_1_12_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge85" class="edge">
<title>expert_1_12_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M2092.79,-268.17C2095.54,-267.73 2098.28,-267.33 2100.97,-266.98 2233.91,-250.01 3172.99,-251.68 3306.97,-248.98 3966.76,-235.69 4758.54,-213.54 5047.47,-205.25"/>
<polygon fill="black" stroke="black" points="5047.64,-208.75 5057.53,-204.96 5047.44,-201.75 5047.64,-208.75"/>
</g>
<!-- expert_1_13_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge86" class="edge">
<title>expert_1_13_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M2253.79,-268.17C2256.54,-267.73 2259.28,-267.33 2261.97,-266.98 2391.71,-250.39 3308.21,-251.77 3438.97,-248.98 4045.64,-236.06 4772.42,-214.08 5047.28,-205.54"/>
<polygon fill="black" stroke="black" points="5047.77,-209.02 5057.66,-205.21 5047.56,-202.03 5047.77,-209.02"/>
</g>
<!-- expert_1_14_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge87" class="edge">
<title>expert_1_14_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M2414.79,-268.18C2417.55,-267.73 2420.28,-267.33 2422.97,-266.98 2542.67,-251.6 3388.32,-251.7 3508.97,-248.98 3547.43,-248.12 4681.76,-215.68 5047.5,-205.21"/>
<polygon fill="black" stroke="black" points="5047.67,-208.71 5057.57,-204.92 5047.47,-201.71 5047.67,-208.71"/>
</g>
<!-- expert_1_15_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge88" class="edge">
<title>expert_1_15_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M2575.79,-268.19C2578.55,-267.74 2581.28,-267.33 2583.97,-266.98 2796.24,-239.47 3333.04,-255.63 3546.97,-248.98 3557.2,-248.66 3559.75,-248.35 3569.97,-247.98 4123.84,-227.93 4786.49,-211.05 5046.96,-204.7"/>
<polygon fill="black" stroke="black" points="5047.27,-208.19 5057.18,-204.45 5047.1,-201.19 5047.27,-208.19"/>
</g>
<!-- expert_1_16_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge89" class="edge">
<title>expert_1_16_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M2736.79,-268.2C2739.55,-267.74 2742.28,-267.34 2744.97,-266.98 2926.79,-243.13 3386.78,-257.08 3569.97,-248.98 3576.65,-248.69 3578.3,-248.3 3584.97,-247.98 4132.34,-221.75 4787.48,-208.41 5046.56,-203.85"/>
<polygon fill="black" stroke="black" points="5046.79,-207.35 5056.73,-203.67 5046.67,-200.35 5046.79,-207.35"/>
</g>
<!-- expert_1_17_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge90" class="edge">
<title>expert_1_17_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M2897.8,-268.21C2900.55,-267.76 2903.28,-267.34 2905.97,-266.98 3055.59,-247 3434.12,-254 3584.97,-248.98 3596.09,-248.61 3598.86,-248.37 3609.97,-247.98 4148.29,-229.23 4791.94,-211.7 5047.46,-204.93"/>
<polygon fill="black" stroke="black" points="5047.58,-208.43 5057.49,-204.67 5047.4,-201.43 5047.58,-208.43"/>
</g>
<!-- expert_1_18_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge91" class="edge">
<title>expert_1_18_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M3058.8,-268.23C3061.55,-267.77 3064.28,-267.35 3066.97,-266.98 3091.71,-263.62 4615.72,-218.16 5047.24,-205.34"/>
<polygon fill="black" stroke="black" points="5047.65,-208.83 5057.54,-205.03 5047.44,-201.83 5047.65,-208.83"/>
</g>
<!-- expert_1_19_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge92" class="edge">
<title>expert_1_19_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M3219.8,-268.26C3222.55,-267.79 3225.28,-267.36 3227.97,-266.98 3444.7,-236.7 3501.28,-255.7 3719.97,-247.98 4214.38,-230.54 4804.37,-212.6 5047.14,-205.34"/>
<polygon fill="black" stroke="black" points="5047.5,-208.83 5057.39,-205.03 5047.29,-201.83 5047.5,-208.83"/>
</g>
<!-- expert_1_20_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge93" class="edge">
<title>expert_1_20_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M3380.81,-268.31C3383.56,-267.82 3386.29,-267.38 3388.97,-266.98 3544.41,-244.06 3585,-254.75 3741.97,-247.98 4227.47,-227.05 4806.85,-211.06 5047.05,-204.84"/>
<polygon fill="black" stroke="black" points="5047.28,-208.33 5057.19,-204.57 5047.1,-201.33 5047.28,-208.33"/>
</g>
<!-- expert_1_21_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge94" class="edge">
<title>expert_1_21_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M3541.8,-268.26C3544.55,-267.79 3547.28,-267.36 3549.97,-266.98 3839.6,-226.25 4730.25,-208.7 5046.84,-203.63"/>
<polygon fill="black" stroke="black" points="5047.01,-207.13 5056.95,-203.47 5046.9,-200.13 5047.01,-207.13"/>
</g>
<!-- expert_1_22_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge95" class="edge">
<title>expert_1_22_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M3702.81,-268.31C3705.56,-267.83 3708.29,-267.38 3710.97,-266.98 3861.56,-244.64 3900.92,-255.36 4052.97,-247.98 4416.73,-230.32 4847.94,-213.63 5047.86,-206.13"/>
<polygon fill="black" stroke="black" points="5048.22,-209.62 5058.08,-205.75 5047.95,-202.63 5048.22,-209.62"/>
</g>
<!-- expert_1_23_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge96" class="edge">
<title>expert_1_23_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M3863.81,-268.3C3866.56,-267.82 3869.29,-267.37 3871.97,-266.98 4097.14,-234.16 4776.73,-212.49 5047.18,-204.95"/>
<polygon fill="black" stroke="black" points="5047.5,-208.44 5057.4,-204.67 5047.31,-201.45 5047.5,-208.44"/>
</g>
<!-- expert_1_24_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge97" class="edge">
<title>expert_1_24_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M4024.81,-268.34C4027.56,-267.85 4030.29,-267.39 4032.97,-266.98 4162.85,-247.13 4196.83,-255.83 4327.97,-247.98 4586.03,-232.54 4889.23,-216.25 5048.8,-207.81"/>
<polygon fill="black" stroke="black" points="5049.3,-211.29 5059.1,-207.27 5048.93,-204.3 5049.3,-211.29"/>
</g>
<!-- expert_1_25_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge98" class="edge">
<title>expert_1_25_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M4185.82,-268.35C4188.56,-267.86 4191.29,-267.4 4193.97,-266.98 4499.87,-219.77 4865.52,-206.85 5046.68,-203.32"/>
<polygon fill="black" stroke="black" points="5046.82,-206.82 5056.75,-203.13 5046.69,-199.82 5046.82,-206.82"/>
</g>
<!-- expert_1_26_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge99" class="edge">
<title>expert_1_26_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M4346.82,-268.4C4349.57,-267.89 4352.29,-267.42 4354.97,-266.98 4600.14,-227.46 4891.38,-211.52 5047.6,-205.44"/>
<polygon fill="black" stroke="black" points="5047.83,-208.94 5057.69,-205.06 5047.57,-201.94 5047.83,-208.94"/>
</g>
<!-- expert_1_27_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge100" class="edge">
<title>expert_1_27_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M4507.83,-268.47C4510.58,-267.94 4513.3,-267.44 4515.97,-266.98 4701.72,-235.13 4920.48,-217.12 5049.29,-208.48"/>
<polygon fill="black" stroke="black" points="5049.81,-211.96 5059.55,-207.8 5049.34,-204.97 5049.81,-211.96"/>
</g>
<!-- expert_1_28_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge101" class="edge">
<title>expert_1_28_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M4668.85,-268.58C4671.59,-268.02 4674.31,-267.49 4676.97,-266.98 4805.86,-242.67 4955.75,-223.97 5053.96,-213"/>
<polygon fill="black" stroke="black" points="5054.64,-216.45 5064.19,-211.87 5053.86,-209.49 5054.64,-216.45"/>
</g>
<!-- expert_1_29_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge102" class="edge">
<title>expert_1_29_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M4829.9,-268.81C4832.62,-268.18 4835.32,-267.57 4837.97,-266.98 4914.46,-249.95 5001.6,-232.48 5065.92,-219.95"/>
<polygon fill="black" stroke="black" points="5066.9,-223.32 5076.05,-217.98 5065.56,-216.45 5066.9,-223.32"/>
</g>
<!-- expert_1_30_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge103" class="edge">
<title>expert_1_30_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M4974.87,-266.89C5008.44,-255.12 5051.51,-240.02 5087.65,-227.35"/>
<polygon fill="black" stroke="black" points="5088.89,-230.62 5097.17,-224.01 5086.57,-224.02 5088.89,-230.62"/>
</g>
<!-- expert_1_31_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge104" class="edge">
<title>expert_1_31_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M5098.53,-266.89C5107.07,-257.86 5117.47,-246.88 5127.26,-236.54"/>
<polygon fill="black" stroke="black" points="5129.91,-238.83 5134.25,-229.16 5124.83,-234.02 5129.91,-238.83"/>
</g>
<!-- expert_1_32_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge105" class="edge">
<title>expert_1_32_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M5222.19,-266.89C5213.54,-257.86 5203.01,-246.88 5193.1,-236.54"/>
<polygon fill="black" stroke="black" points="5195.47,-233.96 5186.02,-229.16 5190.41,-238.8 5195.47,-233.96"/>
</g>
<!-- expert_1_33_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge106" class="edge">
<title>expert_1_33_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M5345.85,-266.89C5312.14,-255.12 5268.89,-240.02 5232.6,-227.35"/>
<polygon fill="black" stroke="black" points="5233.64,-224 5223.04,-224.01 5231.33,-230.61 5233.64,-224"/>
</g>
<!-- expert_1_34_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge107" class="edge">
<title>expert_1_34_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M5491.45,-269.11C5488.25,-268.38 5485.08,-267.67 5481.97,-266.98 5405.46,-250.06 5318.33,-232.58 5254.01,-220.02"/>
<polygon fill="black" stroke="black" points="5254.37,-216.52 5243.89,-218.04 5253.03,-223.39 5254.37,-216.52"/>
</g>
<!-- expert_1_35_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge108" class="edge">
<title>expert_1_35_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M5652.07,-268.77C5649,-268.14 5645.96,-267.54 5642.97,-266.98 5514.05,-242.86 5364.17,-224.12 5265.97,-213.09"/>
<polygon fill="black" stroke="black" points="5266.07,-209.58 5255.75,-211.95 5265.3,-216.54 5266.07,-209.58"/>
</g>
<!-- expert_1_36_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge109" class="edge">
<title>expert_1_36_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M5813.09,-268.64C5810.02,-268.05 5806.97,-267.49 5803.97,-266.98 5618.18,-235.39 5399.43,-217.3 5270.64,-208.58"/>
<polygon fill="black" stroke="black" points="5270.59,-205.07 5260.38,-207.89 5270.12,-212.05 5270.59,-205.07"/>
</g>
<!-- expert_1_37_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge110" class="edge">
<title>expert_1_37_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M5974.1,-268.57C5971.03,-267.99 5967.97,-267.46 5964.97,-266.98 5719.75,-227.81 5428.53,-211.73 5272.33,-205.54"/>
<polygon fill="black" stroke="black" points="5272.37,-202.04 5262.24,-205.15 5272.1,-209.04 5272.37,-202.04"/>
</g>
<!-- expert_1_38_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge111" class="edge">
<title>expert_1_38_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M6135.11,-268.52C6132.03,-267.96 6128.98,-267.44 6125.97,-266.98 5820.01,-220.2 5454.39,-207.1 5273.25,-203.42"/>
<polygon fill="black" stroke="black" points="5273.25,-199.92 5263.18,-203.22 5273.11,-206.92 5273.25,-199.92"/>
</g>
<!-- expert_1_39_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge112" class="edge">
<title>expert_1_39_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M6296.11,-268.51C6293.03,-267.95 6289.98,-267.44 6286.97,-266.98 6157.95,-247.42 6124.24,-255.8 5993.97,-247.98 5735.3,-232.46 5431.37,-216.2 5271.42,-207.79"/>
<polygon fill="black" stroke="black" points="5271.26,-204.28 5261.09,-207.25 5270.89,-211.27 5271.26,-204.28"/>
</g>
<!-- expert_1_40_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge113" class="edge">
<title>expert_1_40_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M6457.12,-268.45C6454.04,-267.91 6450.98,-267.42 6447.97,-266.98 6222.76,-234.48 5543.2,-212.62 5272.77,-204.99"/>
<polygon fill="black" stroke="black" points="5272.63,-201.49 5262.54,-204.7 5272.44,-208.48 5272.63,-201.49"/>
</g>
<!-- expert_1_41_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge114" class="edge">
<title>expert_1_41_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M6618.12,-268.47C6615.04,-267.93 6611.98,-267.42 6608.97,-266.98 6459.24,-244.96 6420.14,-255.34 6268.97,-247.98 5904.56,-230.25 5472.57,-213.59 5272.29,-206.12"/>
<polygon fill="black" stroke="black" points="5272.18,-202.61 5262.05,-205.73 5271.92,-209.6 5272.18,-202.61"/>
</g>
<!-- expert_1_42_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge115" class="edge">
<title>expert_1_42_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M6779.13,-268.41C6776.04,-267.88 6772.98,-267.4 6769.97,-266.98 6480.29,-226.66 5589.67,-208.85 5273.1,-203.68"/>
<polygon fill="black" stroke="black" points="5273.05,-200.17 5262.99,-203.51 5272.93,-207.17 5273.05,-200.17"/>
</g>
<!-- expert_1_43_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge116" class="edge">
<title>expert_1_43_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M6940.12,-268.47C6937.04,-267.92 6933.98,-267.42 6930.97,-266.98 6776.39,-244.38 6736.06,-254.73 6579.97,-247.98 6093.49,-226.94 5512.88,-211 5272.61,-204.81"/>
<polygon fill="black" stroke="black" points="5272.55,-201.31 5262.47,-204.55 5272.37,-208.3 5272.55,-201.31"/>
</g>
<!-- expert_1_44_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge117" class="edge">
<title>expert_1_44_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M7101.13,-268.41C7098.04,-267.88 7094.98,-267.4 7091.97,-266.98 6873,-236.74 6815.89,-255.75 6594.97,-247.98 6102.28,-230.67 5514.34,-212.66 5272.41,-205.36"/>
<polygon fill="black" stroke="black" points="5272.3,-201.85 5262.2,-205.05 5272.09,-208.85 5272.3,-201.85"/>
</g>
<!-- expert_1_45_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge118" class="edge">
<title>expert_1_45_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M7262.13,-268.38C7259.05,-267.86 7255.98,-267.39 7252.97,-266.98 6865.47,-214.88 5651.49,-204.45 5273.49,-202.45"/>
<polygon fill="black" stroke="black" points="5273.38,-198.95 5263.37,-202.4 5273.35,-205.95 5273.38,-198.95"/>
</g>
<!-- expert_1_46_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge119" class="edge">
<title>expert_1_46_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M7423.12,-268.47C7420.04,-267.92 7416.98,-267.42 7413.97,-266.98 7261.59,-244.65 7221.86,-254.06 7067.97,-247.98 6386.97,-221.08 5568.58,-207.72 5273.19,-203.51"/>
<polygon fill="black" stroke="black" points="5272.95,-200 5262.91,-203.36 5272.85,-207 5272.95,-200"/>
</g>
<!-- expert_1_47_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge120" class="edge">
<title>expert_1_47_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M7584.13,-268.41C7581.04,-267.88 7577.98,-267.4 7574.97,-266.98 7359.97,-237.21 7303.92,-254.79 7086.97,-247.98 6398.17,-226.36 5570.59,-209.76 5273.22,-204.1"/>
<polygon fill="black" stroke="black" points="5272.94,-200.59 5262.87,-203.9 5272.8,-207.59 5272.94,-200.59"/>
</g>
<!-- expert_1_48_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge121" class="edge">
<title>expert_1_48_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M7745.13,-268.4C7742.04,-267.87 7738.98,-267.4 7735.97,-266.98 7509.94,-235.91 7451.03,-254.75 7222.97,-247.98 6479.21,-225.92 5584.32,-209.38 5273.13,-203.93"/>
<polygon fill="black" stroke="black" points="5272.82,-200.42 5262.76,-203.75 5272.69,-207.42 5272.82,-200.42"/>
</g>
<!-- expert_1_49_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge122" class="edge">
<title>expert_1_49_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M7906.13,-268.4C7903.04,-267.87 7899.98,-267.4 7896.97,-266.98 7668.74,-235.64 7609.26,-254.59 7378.97,-247.98 6572.14,-224.83 5599.97,-208.77 5273.26,-203.7"/>
<polygon fill="black" stroke="black" points="5272.9,-200.2 5262.85,-203.54 5272.79,-207.2 5272.9,-200.2"/>
</g>
<!-- expert_1_50_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge123" class="edge">
<title>expert_1_50_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M8067.13,-268.4C8064.04,-267.87 8060.98,-267.4 8057.97,-266.98 7830.18,-235.7 7770.82,-254.43 7540.97,-247.98 6668.21,-223.52 5615.13,-208.12 5273.12,-203.48"/>
<polygon fill="black" stroke="black" points="5273.02,-199.98 5262.97,-203.34 5272.92,-206.98 5273.02,-199.98"/>
</g>
<!-- expert_1_51_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge124" class="edge">
<title>expert_1_51_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M8228.13,-268.4C8225.04,-267.87 8221.98,-267.4 8218.97,-266.98 7991.18,-235.7 7931.82,-254.28 7701.97,-247.98 6763.74,-222.26 5630.29,-207.54 5273.28,-203.29"/>
<polygon fill="black" stroke="black" points="5273.24,-199.79 5263.2,-203.17 5273.16,-206.79 5273.24,-199.79"/>
</g>
<!-- expert_1_52_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge125" class="edge">
<title>expert_1_52_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M8389.13,-268.4C8386.04,-267.87 8382.98,-267.4 8379.97,-266.98 8152.18,-235.7 8092.82,-254.16 7862.97,-247.98 6858.97,-221 5644.74,-206.99 5273.31,-203.12"/>
<polygon fill="black" stroke="black" points="5273.14,-199.62 5263.1,-203.01 5273.06,-206.62 5273.14,-199.62"/>
</g>
<!-- expert_1_53_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge126" class="edge">
<title>expert_1_53_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M8550.13,-268.4C8547.04,-267.87 8543.98,-267.4 8540.97,-266.98 8313.18,-235.7 8253.83,-254.05 8023.97,-247.98 6953.8,-219.73 5658.19,-206.47 5273.08,-202.97"/>
<polygon fill="black" stroke="black" points="5273.09,-199.47 5263.06,-202.88 5273.02,-206.47 5273.09,-199.47"/>
</g>
<!-- expert_1_54_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge127" class="edge">
<title>expert_1_54_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M8711.13,-268.4C8708.04,-267.87 8704.98,-267.4 8701.97,-266.98 8474.18,-235.7 8414.83,-253.95 8184.97,-247.98 7048.83,-218.47 5672.12,-205.99 5273.25,-202.83"/>
<polygon fill="black" stroke="black" points="5273.18,-199.33 5263.15,-202.75 5273.13,-206.33 5273.18,-199.33"/>
</g>
<!-- expert_1_55_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge128" class="edge">
<title>expert_1_55_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M8872.13,-268.4C8869.04,-267.87 8865.98,-267.4 8862.97,-266.98 8635.18,-235.7 8575.83,-253.86 8345.97,-247.98 7143.58,-217.21 5685.37,-205.53 5273.26,-202.71"/>
<polygon fill="black" stroke="black" points="5273.16,-199.21 5263.14,-202.64 5273.11,-206.21 5273.16,-199.21"/>
</g>
<!-- expert_1_56_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge129" class="edge">
<title>expert_1_56_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M9033.13,-268.4C9030.04,-267.87 9026.98,-267.4 9023.97,-266.98 8796.18,-235.7 8736.83,-253.78 8506.97,-247.98 7238.47,-215.96 5698.93,-205.11 5273.54,-202.61"/>
<polygon fill="black" stroke="black" points="5273.42,-199.1 5263.4,-202.55 5273.38,-206.1 5273.42,-199.1"/>
</g>
<!-- expert_1_57_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge130" class="edge">
<title>expert_1_57_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M9194.13,-268.4C9191.04,-267.87 9187.98,-267.4 9184.97,-266.98 8959.39,-235.96 8900.61,-253.7 8672.97,-247.98 7335.56,-214.42 5711.09,-204.61 5273.21,-202.49"/>
<polygon fill="black" stroke="black" points="5273.11,-198.99 5263.09,-202.44 5273.07,-205.99 5273.11,-198.99"/>
</g>
<!-- expert_1_58_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge131" class="edge">
<title>expert_1_58_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M9355.13,-268.4C9352.04,-267.87 9348.98,-267.4 9345.97,-266.98 9119.94,-235.91 9061.06,-253.63 8832.97,-247.98 7429.56,-213.21 5723.83,-204.23 5273.42,-202.4"/>
<polygon fill="black" stroke="black" points="5273.35,-198.9 5263.33,-202.36 5273.32,-205.9 5273.35,-198.9"/>
</g>
<!-- expert_1_59_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge132" class="edge">
<title>expert_1_59_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M9516.13,-268.4C9513.04,-267.87 9509.98,-267.4 9506.97,-266.98 9280.5,-235.85 9221.51,-253.58 8992.97,-247.98 7523.11,-212 5735.47,-203.87 5273.3,-202.32"/>
<polygon fill="black" stroke="black" points="5273.3,-198.82 5263.28,-202.29 5273.27,-205.82 5273.3,-198.82"/>
</g>
<!-- expert_1_60_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge133" class="edge">
<title>expert_1_60_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M9677.13,-268.4C9674.04,-267.87 9670.98,-267.4 9667.97,-266.98 9441.06,-235.8 9381.95,-253.52 9152.97,-247.98 7617.02,-210.81 5747.98,-203.53 5273.61,-202.25"/>
<polygon fill="black" stroke="black" points="5273.34,-198.75 5263.33,-202.22 5273.32,-205.75 5273.34,-198.75"/>
</g>
<!-- expert_1_61_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge134" class="edge">
<title>expert_1_61_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M9838.13,-268.4C9835.04,-267.87 9831.98,-267.4 9828.97,-266.98 9603.83,-236.01 9545.18,-253.46 9317.97,-247.98 7713.24,-209.28 5759.33,-203.11 5273.42,-202.16"/>
<polygon fill="black" stroke="black" points="5273.26,-198.66 5263.25,-202.14 5273.24,-205.66 5273.26,-198.66"/>
</g>
<!-- expert_1_62_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge135" class="edge">
<title>expert_1_62_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M9999.13,-268.4C9996.04,-267.87 9992.98,-267.4 9989.97,-266.98 9764.39,-235.96 9705.62,-253.42 9477.97,-247.98 7806.42,-208.07 5770.06,-202.79 5273.23,-202.1"/>
<polygon fill="black" stroke="black" points="5273.19,-198.6 5263.19,-202.08 5273.19,-205.6 5273.19,-198.6"/>
</g>
<!-- expert_1_63_stage1&#45;&gt;combine_1_stage1 -->
<g id="edge136" class="edge">
<title>expert_1_63_stage1&#45;&gt;combine_1_stage1</title>
<path fill="none" stroke="black" d="M10160.13,-268.4C10157.04,-267.87 10153.98,-267.4 10150.97,-266.98 9924.94,-235.91 9866.07,-253.38 9637.97,-247.98 7900.14,-206.88 5782.09,-202.49 5273.58,-202.04"/>
<polygon fill="black" stroke="black" points="5273.32,-198.54 5263.31,-202.03 5273.31,-205.54 5273.32,-198.54"/>
</g>
<!-- moe_out_1_stage1 -->
<g id="node74" class="node">
<title>moe_out_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="5229.97,-135 5089.97,-135 5089.97,-94 5229.97,-94 5229.97,-135"/>
<text text-anchor="middle" x="5159.97" y="-123" font-family="Arial" font-size="10.00">MoE Output (TP8) L1</text>
<text text-anchor="middle" x="5159.97" y="-112" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="5159.97" y="-101" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- combine_1_stage1&#45;&gt;moe_out_1_stage1 -->
<g id="edge137" class="edge">
<title>combine_1_stage1&#45;&gt;moe_out_1_stage1</title>
<path fill="none" stroke="black" d="M5159.97,-171.86C5159.97,-163.32 5159.97,-153.93 5159.97,-145.29"/>
<polygon fill="black" stroke="black" points="5163.47,-145.24 5159.97,-135.24 5156.47,-145.24 5163.47,-145.24"/>
</g>
<!-- ln1_2_stage1 -->
<g id="node76" class="node">
<title>ln1_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="5229.97,-57 5089.97,-57 5089.97,-16 5229.97,-16 5229.97,-57"/>
<text text-anchor="middle" x="5159.97" y="-45" font-family="Arial" font-size="10.00">LayerNorm (TP8) L2</text>
<text text-anchor="middle" x="5159.97" y="-34" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="5159.97" y="-23" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- moe_out_1_stage1&#45;&gt;ln1_2_stage1 -->
<g id="edge138" class="edge">
<title>moe_out_1_stage1&#45;&gt;ln1_2_stage1</title>
<path fill="none" stroke="black" d="M5159.97,-93.93C5159.97,-85.77 5159.97,-76.12 5159.97,-67.13"/>
<polygon fill="black" stroke="black" points="5163.47,-67.01 5159.97,-57.01 5156.47,-67.01 5163.47,-67.01"/>
</g>
<!-- ln2_1_stage1&#45;&gt;route_1_stage1 -->
<g id="edge7" class="edge">
<title>ln2_1_stage1&#45;&gt;route_1_stage1</title>
<path fill="none" stroke="black" d="M1305.13,-573.58C1527.86,-558.07 2220.75,-509.83 2501.27,-490.3"/>
<polygon fill="black" stroke="black" points="2501.74,-493.78 2511.48,-489.59 2501.26,-486.79 2501.74,-493.78"/>
</g>
<!-- qkv_2_stage1 -->
<g id="node77" class="node">
<title>qkv_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="84064.97,-1134 83918.97,-1134 83918.97,-1093 84064.97,-1093 84064.97,-1134"/>
<text text-anchor="middle" x="83991.97" y="-1122" font-family="Arial" font-size="10.00">QKV Projection (TP8) L2</text>
<text text-anchor="middle" x="83991.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="83991.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_2_stage1 -->
<g id="node78" class="node">
<title>attn_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="83900.97,-1134 83754.97,-1134 83754.97,-1093 83900.97,-1093 83900.97,-1134"/>
<text text-anchor="middle" x="83827.97" y="-1122" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L2</text>
<text text-anchor="middle" x="83827.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="83827.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_2_stage1 -->
<g id="node79" class="node">
<title>attn_out_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="83736.97,-1134 83596.97,-1134 83596.97,-1093 83736.97,-1093 83736.97,-1134"/>
<text text-anchor="middle" x="83666.97" y="-1122" font-family="Arial" font-size="10.00">Attention Output (TP8) L2</text>
<text text-anchor="middle" x="83666.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="83666.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_2_stage1 -->
<g id="node80" class="node">
<title>route_2_stage1</title>
<polygon fill="lightcoral" stroke="black" points="83579.27,-1154.5 83348.14,-1154.5 83288.68,-1072.5 83519.81,-1072.5 83579.27,-1154.5"/>
<text text-anchor="middle" x="83433.97" y="-1122" font-family="Arial" font-size="10.00">MoE Routing (EP64) L2</text>
<text text-anchor="middle" x="83433.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="83433.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_2_stage1 -->
<g id="node81" class="node">
<title>dispatch_2_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="83161.97" cy="-1113.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="83161.97" y="-1122" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L2</text>
<text text-anchor="middle" x="83161.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="83161.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_2_0_stage1 -->
<g id="node82" class="node">
<title>expert_2_0_stage1</title>
<polygon fill="lightblue" stroke="black" points="83035.47,-1134 82892.47,-1134 82892.47,-1093 83035.47,-1093 83035.47,-1134"/>
<text text-anchor="middle" x="82963.97" y="-1122" font-family="Arial" font-size="10.00">Expert 0 (TP8) L2</text>
<text text-anchor="middle" x="82963.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="82963.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_1_stage1 -->
<g id="node83" class="node">
<title>expert_2_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="82874.47,-1134 82731.47,-1134 82731.47,-1093 82874.47,-1093 82874.47,-1134"/>
<text text-anchor="middle" x="82802.97" y="-1122" font-family="Arial" font-size="10.00">Expert 1 (TP8) L2</text>
<text text-anchor="middle" x="82802.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="82802.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_2_stage1 -->
<g id="node84" class="node">
<title>expert_2_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="82713.47,-1134 82570.47,-1134 82570.47,-1093 82713.47,-1093 82713.47,-1134"/>
<text text-anchor="middle" x="82641.97" y="-1122" font-family="Arial" font-size="10.00">Expert 2 (TP8) L2</text>
<text text-anchor="middle" x="82641.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="82641.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_3_stage1 -->
<g id="node85" class="node">
<title>expert_2_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="82552.47,-1134 82409.47,-1134 82409.47,-1093 82552.47,-1093 82552.47,-1134"/>
<text text-anchor="middle" x="82480.97" y="-1122" font-family="Arial" font-size="10.00">Expert 3 (TP8) L2</text>
<text text-anchor="middle" x="82480.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="82480.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_4_stage1 -->
<g id="node86" class="node">
<title>expert_2_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="82391.47,-1134 82248.47,-1134 82248.47,-1093 82391.47,-1093 82391.47,-1134"/>
<text text-anchor="middle" x="82319.97" y="-1122" font-family="Arial" font-size="10.00">Expert 4 (TP8) L2</text>
<text text-anchor="middle" x="82319.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="82319.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_5_stage1 -->
<g id="node87" class="node">
<title>expert_2_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="82230.47,-1134 82087.47,-1134 82087.47,-1093 82230.47,-1093 82230.47,-1134"/>
<text text-anchor="middle" x="82158.97" y="-1122" font-family="Arial" font-size="10.00">Expert 5 (TP8) L2</text>
<text text-anchor="middle" x="82158.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="82158.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_6_stage1 -->
<g id="node88" class="node">
<title>expert_2_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="82069.47,-1134 81926.47,-1134 81926.47,-1093 82069.47,-1093 82069.47,-1134"/>
<text text-anchor="middle" x="81997.97" y="-1122" font-family="Arial" font-size="10.00">Expert 6 (TP8) L2</text>
<text text-anchor="middle" x="81997.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="81997.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_7_stage1 -->
<g id="node89" class="node">
<title>expert_2_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="81908.47,-1134 81765.47,-1134 81765.47,-1093 81908.47,-1093 81908.47,-1134"/>
<text text-anchor="middle" x="81836.97" y="-1122" font-family="Arial" font-size="10.00">Expert 7 (TP8) L2</text>
<text text-anchor="middle" x="81836.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="81836.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_8_stage1 -->
<g id="node90" class="node">
<title>expert_2_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="81747.47,-1134 81604.47,-1134 81604.47,-1093 81747.47,-1093 81747.47,-1134"/>
<text text-anchor="middle" x="81675.97" y="-1122" font-family="Arial" font-size="10.00">Expert 8 (TP8) L2</text>
<text text-anchor="middle" x="81675.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="81675.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_9_stage1 -->
<g id="node91" class="node">
<title>expert_2_9_stage1</title>
<polygon fill="lightblue" stroke="black" points="81586.47,-1134 81443.47,-1134 81443.47,-1093 81586.47,-1093 81586.47,-1134"/>
<text text-anchor="middle" x="81514.97" y="-1122" font-family="Arial" font-size="10.00">Expert 9 (TP8) L2</text>
<text text-anchor="middle" x="81514.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="81514.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_10_stage1 -->
<g id="node92" class="node">
<title>expert_2_10_stage1</title>
<polygon fill="lightblue" stroke="black" points="81425.47,-1134 81282.47,-1134 81282.47,-1093 81425.47,-1093 81425.47,-1134"/>
<text text-anchor="middle" x="81353.97" y="-1122" font-family="Arial" font-size="10.00">Expert 10 (TP8) L2</text>
<text text-anchor="middle" x="81353.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="81353.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_11_stage1 -->
<g id="node93" class="node">
<title>expert_2_11_stage1</title>
<polygon fill="lightblue" stroke="black" points="81264.47,-1134 81121.47,-1134 81121.47,-1093 81264.47,-1093 81264.47,-1134"/>
<text text-anchor="middle" x="81192.97" y="-1122" font-family="Arial" font-size="10.00">Expert 11 (TP8) L2</text>
<text text-anchor="middle" x="81192.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="81192.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_12_stage1 -->
<g id="node94" class="node">
<title>expert_2_12_stage1</title>
<polygon fill="lightblue" stroke="black" points="81103.47,-1134 80960.47,-1134 80960.47,-1093 81103.47,-1093 81103.47,-1134"/>
<text text-anchor="middle" x="81031.97" y="-1122" font-family="Arial" font-size="10.00">Expert 12 (TP8) L2</text>
<text text-anchor="middle" x="81031.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="81031.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_13_stage1 -->
<g id="node95" class="node">
<title>expert_2_13_stage1</title>
<polygon fill="lightblue" stroke="black" points="80942.47,-1134 80799.47,-1134 80799.47,-1093 80942.47,-1093 80942.47,-1134"/>
<text text-anchor="middle" x="80870.97" y="-1122" font-family="Arial" font-size="10.00">Expert 13 (TP8) L2</text>
<text text-anchor="middle" x="80870.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="80870.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_14_stage1 -->
<g id="node96" class="node">
<title>expert_2_14_stage1</title>
<polygon fill="lightblue" stroke="black" points="80781.47,-1134 80638.47,-1134 80638.47,-1093 80781.47,-1093 80781.47,-1134"/>
<text text-anchor="middle" x="80709.97" y="-1122" font-family="Arial" font-size="10.00">Expert 14 (TP8) L2</text>
<text text-anchor="middle" x="80709.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="80709.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_15_stage1 -->
<g id="node97" class="node">
<title>expert_2_15_stage1</title>
<polygon fill="lightblue" stroke="black" points="80620.47,-1134 80477.47,-1134 80477.47,-1093 80620.47,-1093 80620.47,-1134"/>
<text text-anchor="middle" x="80548.97" y="-1122" font-family="Arial" font-size="10.00">Expert 15 (TP8) L2</text>
<text text-anchor="middle" x="80548.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="80548.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_16_stage1 -->
<g id="node98" class="node">
<title>expert_2_16_stage1</title>
<polygon fill="lightblue" stroke="black" points="80459.47,-1134 80316.47,-1134 80316.47,-1093 80459.47,-1093 80459.47,-1134"/>
<text text-anchor="middle" x="80387.97" y="-1122" font-family="Arial" font-size="10.00">Expert 16 (TP8) L2</text>
<text text-anchor="middle" x="80387.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="80387.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_17_stage1 -->
<g id="node99" class="node">
<title>expert_2_17_stage1</title>
<polygon fill="lightblue" stroke="black" points="80298.47,-1134 80155.47,-1134 80155.47,-1093 80298.47,-1093 80298.47,-1134"/>
<text text-anchor="middle" x="80226.97" y="-1122" font-family="Arial" font-size="10.00">Expert 17 (TP8) L2</text>
<text text-anchor="middle" x="80226.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="80226.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_18_stage1 -->
<g id="node100" class="node">
<title>expert_2_18_stage1</title>
<polygon fill="lightblue" stroke="black" points="80137.47,-1134 79994.47,-1134 79994.47,-1093 80137.47,-1093 80137.47,-1134"/>
<text text-anchor="middle" x="80065.97" y="-1122" font-family="Arial" font-size="10.00">Expert 18 (TP8) L2</text>
<text text-anchor="middle" x="80065.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="80065.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_19_stage1 -->
<g id="node101" class="node">
<title>expert_2_19_stage1</title>
<polygon fill="lightblue" stroke="black" points="79976.47,-1134 79833.47,-1134 79833.47,-1093 79976.47,-1093 79976.47,-1134"/>
<text text-anchor="middle" x="79904.97" y="-1122" font-family="Arial" font-size="10.00">Expert 19 (TP8) L2</text>
<text text-anchor="middle" x="79904.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="79904.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_20_stage1 -->
<g id="node102" class="node">
<title>expert_2_20_stage1</title>
<polygon fill="lightblue" stroke="black" points="79815.47,-1134 79672.47,-1134 79672.47,-1093 79815.47,-1093 79815.47,-1134"/>
<text text-anchor="middle" x="79743.97" y="-1122" font-family="Arial" font-size="10.00">Expert 20 (TP8) L2</text>
<text text-anchor="middle" x="79743.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="79743.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_21_stage1 -->
<g id="node103" class="node">
<title>expert_2_21_stage1</title>
<polygon fill="lightblue" stroke="black" points="79654.47,-1134 79511.47,-1134 79511.47,-1093 79654.47,-1093 79654.47,-1134"/>
<text text-anchor="middle" x="79582.97" y="-1122" font-family="Arial" font-size="10.00">Expert 21 (TP8) L2</text>
<text text-anchor="middle" x="79582.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="79582.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_22_stage1 -->
<g id="node104" class="node">
<title>expert_2_22_stage1</title>
<polygon fill="lightblue" stroke="black" points="79493.47,-1134 79350.47,-1134 79350.47,-1093 79493.47,-1093 79493.47,-1134"/>
<text text-anchor="middle" x="79421.97" y="-1122" font-family="Arial" font-size="10.00">Expert 22 (TP8) L2</text>
<text text-anchor="middle" x="79421.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="79421.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_23_stage1 -->
<g id="node105" class="node">
<title>expert_2_23_stage1</title>
<polygon fill="lightblue" stroke="black" points="79332.47,-1134 79189.47,-1134 79189.47,-1093 79332.47,-1093 79332.47,-1134"/>
<text text-anchor="middle" x="79260.97" y="-1122" font-family="Arial" font-size="10.00">Expert 23 (TP8) L2</text>
<text text-anchor="middle" x="79260.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="79260.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_24_stage1 -->
<g id="node106" class="node">
<title>expert_2_24_stage1</title>
<polygon fill="lightblue" stroke="black" points="79171.47,-1134 79028.47,-1134 79028.47,-1093 79171.47,-1093 79171.47,-1134"/>
<text text-anchor="middle" x="79099.97" y="-1122" font-family="Arial" font-size="10.00">Expert 24 (TP8) L2</text>
<text text-anchor="middle" x="79099.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="79099.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_25_stage1 -->
<g id="node107" class="node">
<title>expert_2_25_stage1</title>
<polygon fill="lightblue" stroke="black" points="79010.47,-1134 78867.47,-1134 78867.47,-1093 79010.47,-1093 79010.47,-1134"/>
<text text-anchor="middle" x="78938.97" y="-1122" font-family="Arial" font-size="10.00">Expert 25 (TP8) L2</text>
<text text-anchor="middle" x="78938.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="78938.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_26_stage1 -->
<g id="node108" class="node">
<title>expert_2_26_stage1</title>
<polygon fill="lightblue" stroke="black" points="78849.47,-1134 78706.47,-1134 78706.47,-1093 78849.47,-1093 78849.47,-1134"/>
<text text-anchor="middle" x="78777.97" y="-1122" font-family="Arial" font-size="10.00">Expert 26 (TP8) L2</text>
<text text-anchor="middle" x="78777.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="78777.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_27_stage1 -->
<g id="node109" class="node">
<title>expert_2_27_stage1</title>
<polygon fill="lightblue" stroke="black" points="78688.47,-1134 78545.47,-1134 78545.47,-1093 78688.47,-1093 78688.47,-1134"/>
<text text-anchor="middle" x="78616.97" y="-1122" font-family="Arial" font-size="10.00">Expert 27 (TP8) L2</text>
<text text-anchor="middle" x="78616.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="78616.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_28_stage1 -->
<g id="node110" class="node">
<title>expert_2_28_stage1</title>
<polygon fill="lightblue" stroke="black" points="78527.47,-1134 78384.47,-1134 78384.47,-1093 78527.47,-1093 78527.47,-1134"/>
<text text-anchor="middle" x="78455.97" y="-1122" font-family="Arial" font-size="10.00">Expert 28 (TP8) L2</text>
<text text-anchor="middle" x="78455.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="78455.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_29_stage1 -->
<g id="node111" class="node">
<title>expert_2_29_stage1</title>
<polygon fill="lightblue" stroke="black" points="78366.47,-1134 78223.47,-1134 78223.47,-1093 78366.47,-1093 78366.47,-1134"/>
<text text-anchor="middle" x="78294.97" y="-1122" font-family="Arial" font-size="10.00">Expert 29 (TP8) L2</text>
<text text-anchor="middle" x="78294.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="78294.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_30_stage1 -->
<g id="node112" class="node">
<title>expert_2_30_stage1</title>
<polygon fill="lightblue" stroke="black" points="78205.47,-1134 78062.47,-1134 78062.47,-1093 78205.47,-1093 78205.47,-1134"/>
<text text-anchor="middle" x="78133.97" y="-1122" font-family="Arial" font-size="10.00">Expert 30 (TP8) L2</text>
<text text-anchor="middle" x="78133.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="78133.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_31_stage1 -->
<g id="node113" class="node">
<title>expert_2_31_stage1</title>
<polygon fill="lightblue" stroke="black" points="78044.47,-1134 77901.47,-1134 77901.47,-1093 78044.47,-1093 78044.47,-1134"/>
<text text-anchor="middle" x="77972.97" y="-1122" font-family="Arial" font-size="10.00">Expert 31 (TP8) L2</text>
<text text-anchor="middle" x="77972.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="77972.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_32_stage1 -->
<g id="node114" class="node">
<title>expert_2_32_stage1</title>
<polygon fill="lightblue" stroke="black" points="77883.47,-1134 77740.47,-1134 77740.47,-1093 77883.47,-1093 77883.47,-1134"/>
<text text-anchor="middle" x="77811.97" y="-1122" font-family="Arial" font-size="10.00">Expert 32 (TP8) L2</text>
<text text-anchor="middle" x="77811.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="77811.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_33_stage1 -->
<g id="node115" class="node">
<title>expert_2_33_stage1</title>
<polygon fill="lightblue" stroke="black" points="77722.47,-1134 77579.47,-1134 77579.47,-1093 77722.47,-1093 77722.47,-1134"/>
<text text-anchor="middle" x="77650.97" y="-1122" font-family="Arial" font-size="10.00">Expert 33 (TP8) L2</text>
<text text-anchor="middle" x="77650.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="77650.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_34_stage1 -->
<g id="node116" class="node">
<title>expert_2_34_stage1</title>
<polygon fill="lightblue" stroke="black" points="77561.47,-1134 77418.47,-1134 77418.47,-1093 77561.47,-1093 77561.47,-1134"/>
<text text-anchor="middle" x="77489.97" y="-1122" font-family="Arial" font-size="10.00">Expert 34 (TP8) L2</text>
<text text-anchor="middle" x="77489.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="77489.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_35_stage1 -->
<g id="node117" class="node">
<title>expert_2_35_stage1</title>
<polygon fill="lightblue" stroke="black" points="77400.47,-1134 77257.47,-1134 77257.47,-1093 77400.47,-1093 77400.47,-1134"/>
<text text-anchor="middle" x="77328.97" y="-1122" font-family="Arial" font-size="10.00">Expert 35 (TP8) L2</text>
<text text-anchor="middle" x="77328.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="77328.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_36_stage1 -->
<g id="node118" class="node">
<title>expert_2_36_stage1</title>
<polygon fill="lightblue" stroke="black" points="77239.47,-1134 77096.47,-1134 77096.47,-1093 77239.47,-1093 77239.47,-1134"/>
<text text-anchor="middle" x="77167.97" y="-1122" font-family="Arial" font-size="10.00">Expert 36 (TP8) L2</text>
<text text-anchor="middle" x="77167.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="77167.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_37_stage1 -->
<g id="node119" class="node">
<title>expert_2_37_stage1</title>
<polygon fill="lightblue" stroke="black" points="77078.47,-1134 76935.47,-1134 76935.47,-1093 77078.47,-1093 77078.47,-1134"/>
<text text-anchor="middle" x="77006.97" y="-1122" font-family="Arial" font-size="10.00">Expert 37 (TP8) L2</text>
<text text-anchor="middle" x="77006.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="77006.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_38_stage1 -->
<g id="node120" class="node">
<title>expert_2_38_stage1</title>
<polygon fill="lightblue" stroke="black" points="76917.47,-1134 76774.47,-1134 76774.47,-1093 76917.47,-1093 76917.47,-1134"/>
<text text-anchor="middle" x="76845.97" y="-1122" font-family="Arial" font-size="10.00">Expert 38 (TP8) L2</text>
<text text-anchor="middle" x="76845.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="76845.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_39_stage1 -->
<g id="node121" class="node">
<title>expert_2_39_stage1</title>
<polygon fill="lightblue" stroke="black" points="76756.47,-1134 76613.47,-1134 76613.47,-1093 76756.47,-1093 76756.47,-1134"/>
<text text-anchor="middle" x="76684.97" y="-1122" font-family="Arial" font-size="10.00">Expert 39 (TP8) L2</text>
<text text-anchor="middle" x="76684.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="76684.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_40_stage1 -->
<g id="node122" class="node">
<title>expert_2_40_stage1</title>
<polygon fill="lightblue" stroke="black" points="76595.47,-1134 76452.47,-1134 76452.47,-1093 76595.47,-1093 76595.47,-1134"/>
<text text-anchor="middle" x="76523.97" y="-1122" font-family="Arial" font-size="10.00">Expert 40 (TP8) L2</text>
<text text-anchor="middle" x="76523.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="76523.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_41_stage1 -->
<g id="node123" class="node">
<title>expert_2_41_stage1</title>
<polygon fill="lightblue" stroke="black" points="76434.47,-1134 76291.47,-1134 76291.47,-1093 76434.47,-1093 76434.47,-1134"/>
<text text-anchor="middle" x="76362.97" y="-1122" font-family="Arial" font-size="10.00">Expert 41 (TP8) L2</text>
<text text-anchor="middle" x="76362.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="76362.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_42_stage1 -->
<g id="node124" class="node">
<title>expert_2_42_stage1</title>
<polygon fill="lightblue" stroke="black" points="76273.47,-1134 76130.47,-1134 76130.47,-1093 76273.47,-1093 76273.47,-1134"/>
<text text-anchor="middle" x="76201.97" y="-1122" font-family="Arial" font-size="10.00">Expert 42 (TP8) L2</text>
<text text-anchor="middle" x="76201.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="76201.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_43_stage1 -->
<g id="node125" class="node">
<title>expert_2_43_stage1</title>
<polygon fill="lightblue" stroke="black" points="76112.47,-1134 75969.47,-1134 75969.47,-1093 76112.47,-1093 76112.47,-1134"/>
<text text-anchor="middle" x="76040.97" y="-1122" font-family="Arial" font-size="10.00">Expert 43 (TP8) L2</text>
<text text-anchor="middle" x="76040.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="76040.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_44_stage1 -->
<g id="node126" class="node">
<title>expert_2_44_stage1</title>
<polygon fill="lightblue" stroke="black" points="75951.47,-1134 75808.47,-1134 75808.47,-1093 75951.47,-1093 75951.47,-1134"/>
<text text-anchor="middle" x="75879.97" y="-1122" font-family="Arial" font-size="10.00">Expert 44 (TP8) L2</text>
<text text-anchor="middle" x="75879.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="75879.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_45_stage1 -->
<g id="node127" class="node">
<title>expert_2_45_stage1</title>
<polygon fill="lightblue" stroke="black" points="75790.47,-1134 75647.47,-1134 75647.47,-1093 75790.47,-1093 75790.47,-1134"/>
<text text-anchor="middle" x="75718.97" y="-1122" font-family="Arial" font-size="10.00">Expert 45 (TP8) L2</text>
<text text-anchor="middle" x="75718.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="75718.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_46_stage1 -->
<g id="node128" class="node">
<title>expert_2_46_stage1</title>
<polygon fill="lightblue" stroke="black" points="75629.47,-1134 75486.47,-1134 75486.47,-1093 75629.47,-1093 75629.47,-1134"/>
<text text-anchor="middle" x="75557.97" y="-1122" font-family="Arial" font-size="10.00">Expert 46 (TP8) L2</text>
<text text-anchor="middle" x="75557.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="75557.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_47_stage1 -->
<g id="node129" class="node">
<title>expert_2_47_stage1</title>
<polygon fill="lightblue" stroke="black" points="75468.47,-1134 75325.47,-1134 75325.47,-1093 75468.47,-1093 75468.47,-1134"/>
<text text-anchor="middle" x="75396.97" y="-1122" font-family="Arial" font-size="10.00">Expert 47 (TP8) L2</text>
<text text-anchor="middle" x="75396.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="75396.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_48_stage1 -->
<g id="node130" class="node">
<title>expert_2_48_stage1</title>
<polygon fill="lightblue" stroke="black" points="75307.47,-1134 75164.47,-1134 75164.47,-1093 75307.47,-1093 75307.47,-1134"/>
<text text-anchor="middle" x="75235.97" y="-1122" font-family="Arial" font-size="10.00">Expert 48 (TP8) L2</text>
<text text-anchor="middle" x="75235.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="75235.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_49_stage1 -->
<g id="node131" class="node">
<title>expert_2_49_stage1</title>
<polygon fill="lightblue" stroke="black" points="75146.47,-1134 75003.47,-1134 75003.47,-1093 75146.47,-1093 75146.47,-1134"/>
<text text-anchor="middle" x="75074.97" y="-1122" font-family="Arial" font-size="10.00">Expert 49 (TP8) L2</text>
<text text-anchor="middle" x="75074.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="75074.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_50_stage1 -->
<g id="node132" class="node">
<title>expert_2_50_stage1</title>
<polygon fill="lightblue" stroke="black" points="74985.47,-1134 74842.47,-1134 74842.47,-1093 74985.47,-1093 74985.47,-1134"/>
<text text-anchor="middle" x="74913.97" y="-1122" font-family="Arial" font-size="10.00">Expert 50 (TP8) L2</text>
<text text-anchor="middle" x="74913.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="74913.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_51_stage1 -->
<g id="node133" class="node">
<title>expert_2_51_stage1</title>
<polygon fill="lightblue" stroke="black" points="74824.47,-1134 74681.47,-1134 74681.47,-1093 74824.47,-1093 74824.47,-1134"/>
<text text-anchor="middle" x="74752.97" y="-1122" font-family="Arial" font-size="10.00">Expert 51 (TP8) L2</text>
<text text-anchor="middle" x="74752.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="74752.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_52_stage1 -->
<g id="node134" class="node">
<title>expert_2_52_stage1</title>
<polygon fill="lightblue" stroke="black" points="74663.47,-1134 74520.47,-1134 74520.47,-1093 74663.47,-1093 74663.47,-1134"/>
<text text-anchor="middle" x="74591.97" y="-1122" font-family="Arial" font-size="10.00">Expert 52 (TP8) L2</text>
<text text-anchor="middle" x="74591.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="74591.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_53_stage1 -->
<g id="node135" class="node">
<title>expert_2_53_stage1</title>
<polygon fill="lightblue" stroke="black" points="74502.47,-1134 74359.47,-1134 74359.47,-1093 74502.47,-1093 74502.47,-1134"/>
<text text-anchor="middle" x="74430.97" y="-1122" font-family="Arial" font-size="10.00">Expert 53 (TP8) L2</text>
<text text-anchor="middle" x="74430.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="74430.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_54_stage1 -->
<g id="node136" class="node">
<title>expert_2_54_stage1</title>
<polygon fill="lightblue" stroke="black" points="74341.47,-1134 74198.47,-1134 74198.47,-1093 74341.47,-1093 74341.47,-1134"/>
<text text-anchor="middle" x="74269.97" y="-1122" font-family="Arial" font-size="10.00">Expert 54 (TP8) L2</text>
<text text-anchor="middle" x="74269.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="74269.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_55_stage1 -->
<g id="node137" class="node">
<title>expert_2_55_stage1</title>
<polygon fill="lightblue" stroke="black" points="74180.47,-1134 74037.47,-1134 74037.47,-1093 74180.47,-1093 74180.47,-1134"/>
<text text-anchor="middle" x="74108.97" y="-1122" font-family="Arial" font-size="10.00">Expert 55 (TP8) L2</text>
<text text-anchor="middle" x="74108.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="74108.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_56_stage1 -->
<g id="node138" class="node">
<title>expert_2_56_stage1</title>
<polygon fill="lightblue" stroke="black" points="74019.47,-1134 73876.47,-1134 73876.47,-1093 74019.47,-1093 74019.47,-1134"/>
<text text-anchor="middle" x="73947.97" y="-1122" font-family="Arial" font-size="10.00">Expert 56 (TP8) L2</text>
<text text-anchor="middle" x="73947.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="73947.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_57_stage1 -->
<g id="node139" class="node">
<title>expert_2_57_stage1</title>
<polygon fill="lightblue" stroke="black" points="73858.47,-1134 73715.47,-1134 73715.47,-1093 73858.47,-1093 73858.47,-1134"/>
<text text-anchor="middle" x="73786.97" y="-1122" font-family="Arial" font-size="10.00">Expert 57 (TP8) L2</text>
<text text-anchor="middle" x="73786.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="73786.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_58_stage1 -->
<g id="node140" class="node">
<title>expert_2_58_stage1</title>
<polygon fill="lightblue" stroke="black" points="73697.47,-1134 73554.47,-1134 73554.47,-1093 73697.47,-1093 73697.47,-1134"/>
<text text-anchor="middle" x="73625.97" y="-1122" font-family="Arial" font-size="10.00">Expert 58 (TP8) L2</text>
<text text-anchor="middle" x="73625.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="73625.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_59_stage1 -->
<g id="node141" class="node">
<title>expert_2_59_stage1</title>
<polygon fill="lightblue" stroke="black" points="73536.47,-1134 73393.47,-1134 73393.47,-1093 73536.47,-1093 73536.47,-1134"/>
<text text-anchor="middle" x="73464.97" y="-1122" font-family="Arial" font-size="10.00">Expert 59 (TP8) L2</text>
<text text-anchor="middle" x="73464.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="73464.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_60_stage1 -->
<g id="node142" class="node">
<title>expert_2_60_stage1</title>
<polygon fill="lightblue" stroke="black" points="73375.47,-1134 73232.47,-1134 73232.47,-1093 73375.47,-1093 73375.47,-1134"/>
<text text-anchor="middle" x="73303.97" y="-1122" font-family="Arial" font-size="10.00">Expert 60 (TP8) L2</text>
<text text-anchor="middle" x="73303.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="73303.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_61_stage1 -->
<g id="node143" class="node">
<title>expert_2_61_stage1</title>
<polygon fill="lightblue" stroke="black" points="73214.47,-1134 73071.47,-1134 73071.47,-1093 73214.47,-1093 73214.47,-1134"/>
<text text-anchor="middle" x="73142.97" y="-1122" font-family="Arial" font-size="10.00">Expert 61 (TP8) L2</text>
<text text-anchor="middle" x="73142.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="73142.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_62_stage1 -->
<g id="node144" class="node">
<title>expert_2_62_stage1</title>
<polygon fill="lightblue" stroke="black" points="73053.47,-1134 72910.47,-1134 72910.47,-1093 73053.47,-1093 73053.47,-1134"/>
<text text-anchor="middle" x="72981.97" y="-1122" font-family="Arial" font-size="10.00">Expert 62 (TP8) L2</text>
<text text-anchor="middle" x="72981.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="72981.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_2_63_stage1 -->
<g id="node145" class="node">
<title>expert_2_63_stage1</title>
<polygon fill="lightblue" stroke="black" points="72892.47,-1134 72749.47,-1134 72749.47,-1093 72892.47,-1093 72892.47,-1134"/>
<text text-anchor="middle" x="72820.97" y="-1122" font-family="Arial" font-size="10.00">Expert 63 (TP8) L2</text>
<text text-anchor="middle" x="72820.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="72820.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_2_stage1 -->
<g id="node146" class="node">
<title>combine_2_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="72627.97" cy="-1113.5" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="72627.97" y="-1122" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L2</text>
<text text-anchor="middle" x="72627.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="72627.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_2_stage1 -->
<g id="node147" class="node">
<title>moe_out_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="72506.97,-1134 72366.97,-1134 72366.97,-1093 72506.97,-1093 72506.97,-1134"/>
<text text-anchor="middle" x="72436.97" y="-1122" font-family="Arial" font-size="10.00">MoE Output (TP8) L2</text>
<text text-anchor="middle" x="72436.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="72436.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_2_stage1 -->
<g id="node148" class="node">
<title>ln2_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="72348.97,-1134 72208.97,-1134 72208.97,-1093 72348.97,-1093 72348.97,-1134"/>
<text text-anchor="middle" x="72278.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L2</text>
<text text-anchor="middle" x="72278.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="72278.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_3_stage1 -->
<g id="node149" class="node">
<title>ln1_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="72190.97,-1134 72050.97,-1134 72050.97,-1093 72190.97,-1093 72190.97,-1134"/>
<text text-anchor="middle" x="72120.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L3</text>
<text text-anchor="middle" x="72120.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="72120.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_3_stage1 -->
<g id="node150" class="node">
<title>qkv_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="72032.97,-1134 71886.97,-1134 71886.97,-1093 72032.97,-1093 72032.97,-1134"/>
<text text-anchor="middle" x="71959.97" y="-1122" font-family="Arial" font-size="10.00">QKV Projection (TP8) L3</text>
<text text-anchor="middle" x="71959.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="71959.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_3_stage1 -->
<g id="node151" class="node">
<title>attn_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="71868.97,-1134 71722.97,-1134 71722.97,-1093 71868.97,-1093 71868.97,-1134"/>
<text text-anchor="middle" x="71795.97" y="-1122" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L3</text>
<text text-anchor="middle" x="71795.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="71795.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_3_stage1 -->
<g id="node152" class="node">
<title>attn_out_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="71704.97,-1134 71564.97,-1134 71564.97,-1093 71704.97,-1093 71704.97,-1134"/>
<text text-anchor="middle" x="71634.97" y="-1122" font-family="Arial" font-size="10.00">Attention Output (TP8) L3</text>
<text text-anchor="middle" x="71634.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="71634.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_3_stage1 -->
<g id="node153" class="node">
<title>route_3_stage1</title>
<polygon fill="lightcoral" stroke="black" points="71547.27,-1154.5 71316.14,-1154.5 71256.68,-1072.5 71487.81,-1072.5 71547.27,-1154.5"/>
<text text-anchor="middle" x="71401.97" y="-1122" font-family="Arial" font-size="10.00">MoE Routing (EP64) L3</text>
<text text-anchor="middle" x="71401.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="71401.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_3_stage1 -->
<g id="node154" class="node">
<title>dispatch_3_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="71129.97" cy="-1113.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="71129.97" y="-1122" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L3</text>
<text text-anchor="middle" x="71129.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="71129.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_3_0_stage1 -->
<g id="node155" class="node">
<title>expert_3_0_stage1</title>
<polygon fill="lightblue" stroke="black" points="71003.47,-1134 70860.47,-1134 70860.47,-1093 71003.47,-1093 71003.47,-1134"/>
<text text-anchor="middle" x="70931.97" y="-1122" font-family="Arial" font-size="10.00">Expert 0 (TP8) L3</text>
<text text-anchor="middle" x="70931.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="70931.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_1_stage1 -->
<g id="node156" class="node">
<title>expert_3_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="70842.47,-1134 70699.47,-1134 70699.47,-1093 70842.47,-1093 70842.47,-1134"/>
<text text-anchor="middle" x="70770.97" y="-1122" font-family="Arial" font-size="10.00">Expert 1 (TP8) L3</text>
<text text-anchor="middle" x="70770.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="70770.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_2_stage1 -->
<g id="node157" class="node">
<title>expert_3_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="70681.47,-1134 70538.47,-1134 70538.47,-1093 70681.47,-1093 70681.47,-1134"/>
<text text-anchor="middle" x="70609.97" y="-1122" font-family="Arial" font-size="10.00">Expert 2 (TP8) L3</text>
<text text-anchor="middle" x="70609.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="70609.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_3_stage1 -->
<g id="node158" class="node">
<title>expert_3_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="70520.47,-1134 70377.47,-1134 70377.47,-1093 70520.47,-1093 70520.47,-1134"/>
<text text-anchor="middle" x="70448.97" y="-1122" font-family="Arial" font-size="10.00">Expert 3 (TP8) L3</text>
<text text-anchor="middle" x="70448.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="70448.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_4_stage1 -->
<g id="node159" class="node">
<title>expert_3_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="70359.47,-1134 70216.47,-1134 70216.47,-1093 70359.47,-1093 70359.47,-1134"/>
<text text-anchor="middle" x="70287.97" y="-1122" font-family="Arial" font-size="10.00">Expert 4 (TP8) L3</text>
<text text-anchor="middle" x="70287.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="70287.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_5_stage1 -->
<g id="node160" class="node">
<title>expert_3_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="70198.47,-1134 70055.47,-1134 70055.47,-1093 70198.47,-1093 70198.47,-1134"/>
<text text-anchor="middle" x="70126.97" y="-1122" font-family="Arial" font-size="10.00">Expert 5 (TP8) L3</text>
<text text-anchor="middle" x="70126.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="70126.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_6_stage1 -->
<g id="node161" class="node">
<title>expert_3_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="70037.47,-1134 69894.47,-1134 69894.47,-1093 70037.47,-1093 70037.47,-1134"/>
<text text-anchor="middle" x="69965.97" y="-1122" font-family="Arial" font-size="10.00">Expert 6 (TP8) L3</text>
<text text-anchor="middle" x="69965.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="69965.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_7_stage1 -->
<g id="node162" class="node">
<title>expert_3_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="69876.47,-1134 69733.47,-1134 69733.47,-1093 69876.47,-1093 69876.47,-1134"/>
<text text-anchor="middle" x="69804.97" y="-1122" font-family="Arial" font-size="10.00">Expert 7 (TP8) L3</text>
<text text-anchor="middle" x="69804.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="69804.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_8_stage1 -->
<g id="node163" class="node">
<title>expert_3_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="69715.47,-1134 69572.47,-1134 69572.47,-1093 69715.47,-1093 69715.47,-1134"/>
<text text-anchor="middle" x="69643.97" y="-1122" font-family="Arial" font-size="10.00">Expert 8 (TP8) L3</text>
<text text-anchor="middle" x="69643.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="69643.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_9_stage1 -->
<g id="node164" class="node">
<title>expert_3_9_stage1</title>
<polygon fill="lightblue" stroke="black" points="69554.47,-1134 69411.47,-1134 69411.47,-1093 69554.47,-1093 69554.47,-1134"/>
<text text-anchor="middle" x="69482.97" y="-1122" font-family="Arial" font-size="10.00">Expert 9 (TP8) L3</text>
<text text-anchor="middle" x="69482.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="69482.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_10_stage1 -->
<g id="node165" class="node">
<title>expert_3_10_stage1</title>
<polygon fill="lightblue" stroke="black" points="69393.47,-1134 69250.47,-1134 69250.47,-1093 69393.47,-1093 69393.47,-1134"/>
<text text-anchor="middle" x="69321.97" y="-1122" font-family="Arial" font-size="10.00">Expert 10 (TP8) L3</text>
<text text-anchor="middle" x="69321.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="69321.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_11_stage1 -->
<g id="node166" class="node">
<title>expert_3_11_stage1</title>
<polygon fill="lightblue" stroke="black" points="69232.47,-1134 69089.47,-1134 69089.47,-1093 69232.47,-1093 69232.47,-1134"/>
<text text-anchor="middle" x="69160.97" y="-1122" font-family="Arial" font-size="10.00">Expert 11 (TP8) L3</text>
<text text-anchor="middle" x="69160.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="69160.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_12_stage1 -->
<g id="node167" class="node">
<title>expert_3_12_stage1</title>
<polygon fill="lightblue" stroke="black" points="69071.47,-1134 68928.47,-1134 68928.47,-1093 69071.47,-1093 69071.47,-1134"/>
<text text-anchor="middle" x="68999.97" y="-1122" font-family="Arial" font-size="10.00">Expert 12 (TP8) L3</text>
<text text-anchor="middle" x="68999.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="68999.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_13_stage1 -->
<g id="node168" class="node">
<title>expert_3_13_stage1</title>
<polygon fill="lightblue" stroke="black" points="68910.47,-1134 68767.47,-1134 68767.47,-1093 68910.47,-1093 68910.47,-1134"/>
<text text-anchor="middle" x="68838.97" y="-1122" font-family="Arial" font-size="10.00">Expert 13 (TP8) L3</text>
<text text-anchor="middle" x="68838.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="68838.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_14_stage1 -->
<g id="node169" class="node">
<title>expert_3_14_stage1</title>
<polygon fill="lightblue" stroke="black" points="68749.47,-1134 68606.47,-1134 68606.47,-1093 68749.47,-1093 68749.47,-1134"/>
<text text-anchor="middle" x="68677.97" y="-1122" font-family="Arial" font-size="10.00">Expert 14 (TP8) L3</text>
<text text-anchor="middle" x="68677.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="68677.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_15_stage1 -->
<g id="node170" class="node">
<title>expert_3_15_stage1</title>
<polygon fill="lightblue" stroke="black" points="68588.47,-1134 68445.47,-1134 68445.47,-1093 68588.47,-1093 68588.47,-1134"/>
<text text-anchor="middle" x="68516.97" y="-1122" font-family="Arial" font-size="10.00">Expert 15 (TP8) L3</text>
<text text-anchor="middle" x="68516.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="68516.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_16_stage1 -->
<g id="node171" class="node">
<title>expert_3_16_stage1</title>
<polygon fill="lightblue" stroke="black" points="68427.47,-1134 68284.47,-1134 68284.47,-1093 68427.47,-1093 68427.47,-1134"/>
<text text-anchor="middle" x="68355.97" y="-1122" font-family="Arial" font-size="10.00">Expert 16 (TP8) L3</text>
<text text-anchor="middle" x="68355.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="68355.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_17_stage1 -->
<g id="node172" class="node">
<title>expert_3_17_stage1</title>
<polygon fill="lightblue" stroke="black" points="68266.47,-1134 68123.47,-1134 68123.47,-1093 68266.47,-1093 68266.47,-1134"/>
<text text-anchor="middle" x="68194.97" y="-1122" font-family="Arial" font-size="10.00">Expert 17 (TP8) L3</text>
<text text-anchor="middle" x="68194.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="68194.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_18_stage1 -->
<g id="node173" class="node">
<title>expert_3_18_stage1</title>
<polygon fill="lightblue" stroke="black" points="68105.47,-1134 67962.47,-1134 67962.47,-1093 68105.47,-1093 68105.47,-1134"/>
<text text-anchor="middle" x="68033.97" y="-1122" font-family="Arial" font-size="10.00">Expert 18 (TP8) L3</text>
<text text-anchor="middle" x="68033.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="68033.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_19_stage1 -->
<g id="node174" class="node">
<title>expert_3_19_stage1</title>
<polygon fill="lightblue" stroke="black" points="67944.47,-1134 67801.47,-1134 67801.47,-1093 67944.47,-1093 67944.47,-1134"/>
<text text-anchor="middle" x="67872.97" y="-1122" font-family="Arial" font-size="10.00">Expert 19 (TP8) L3</text>
<text text-anchor="middle" x="67872.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="67872.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_20_stage1 -->
<g id="node175" class="node">
<title>expert_3_20_stage1</title>
<polygon fill="lightblue" stroke="black" points="67783.47,-1134 67640.47,-1134 67640.47,-1093 67783.47,-1093 67783.47,-1134"/>
<text text-anchor="middle" x="67711.97" y="-1122" font-family="Arial" font-size="10.00">Expert 20 (TP8) L3</text>
<text text-anchor="middle" x="67711.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="67711.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_21_stage1 -->
<g id="node176" class="node">
<title>expert_3_21_stage1</title>
<polygon fill="lightblue" stroke="black" points="67622.47,-1134 67479.47,-1134 67479.47,-1093 67622.47,-1093 67622.47,-1134"/>
<text text-anchor="middle" x="67550.97" y="-1122" font-family="Arial" font-size="10.00">Expert 21 (TP8) L3</text>
<text text-anchor="middle" x="67550.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="67550.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_22_stage1 -->
<g id="node177" class="node">
<title>expert_3_22_stage1</title>
<polygon fill="lightblue" stroke="black" points="67461.47,-1134 67318.47,-1134 67318.47,-1093 67461.47,-1093 67461.47,-1134"/>
<text text-anchor="middle" x="67389.97" y="-1122" font-family="Arial" font-size="10.00">Expert 22 (TP8) L3</text>
<text text-anchor="middle" x="67389.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="67389.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_23_stage1 -->
<g id="node178" class="node">
<title>expert_3_23_stage1</title>
<polygon fill="lightblue" stroke="black" points="67300.47,-1134 67157.47,-1134 67157.47,-1093 67300.47,-1093 67300.47,-1134"/>
<text text-anchor="middle" x="67228.97" y="-1122" font-family="Arial" font-size="10.00">Expert 23 (TP8) L3</text>
<text text-anchor="middle" x="67228.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="67228.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_24_stage1 -->
<g id="node179" class="node">
<title>expert_3_24_stage1</title>
<polygon fill="lightblue" stroke="black" points="67139.47,-1134 66996.47,-1134 66996.47,-1093 67139.47,-1093 67139.47,-1134"/>
<text text-anchor="middle" x="67067.97" y="-1122" font-family="Arial" font-size="10.00">Expert 24 (TP8) L3</text>
<text text-anchor="middle" x="67067.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="67067.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_25_stage1 -->
<g id="node180" class="node">
<title>expert_3_25_stage1</title>
<polygon fill="lightblue" stroke="black" points="66978.47,-1134 66835.47,-1134 66835.47,-1093 66978.47,-1093 66978.47,-1134"/>
<text text-anchor="middle" x="66906.97" y="-1122" font-family="Arial" font-size="10.00">Expert 25 (TP8) L3</text>
<text text-anchor="middle" x="66906.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="66906.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_26_stage1 -->
<g id="node181" class="node">
<title>expert_3_26_stage1</title>
<polygon fill="lightblue" stroke="black" points="66817.47,-1134 66674.47,-1134 66674.47,-1093 66817.47,-1093 66817.47,-1134"/>
<text text-anchor="middle" x="66745.97" y="-1122" font-family="Arial" font-size="10.00">Expert 26 (TP8) L3</text>
<text text-anchor="middle" x="66745.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="66745.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_27_stage1 -->
<g id="node182" class="node">
<title>expert_3_27_stage1</title>
<polygon fill="lightblue" stroke="black" points="66656.47,-1134 66513.47,-1134 66513.47,-1093 66656.47,-1093 66656.47,-1134"/>
<text text-anchor="middle" x="66584.97" y="-1122" font-family="Arial" font-size="10.00">Expert 27 (TP8) L3</text>
<text text-anchor="middle" x="66584.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="66584.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_28_stage1 -->
<g id="node183" class="node">
<title>expert_3_28_stage1</title>
<polygon fill="lightblue" stroke="black" points="66495.47,-1134 66352.47,-1134 66352.47,-1093 66495.47,-1093 66495.47,-1134"/>
<text text-anchor="middle" x="66423.97" y="-1122" font-family="Arial" font-size="10.00">Expert 28 (TP8) L3</text>
<text text-anchor="middle" x="66423.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="66423.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_29_stage1 -->
<g id="node184" class="node">
<title>expert_3_29_stage1</title>
<polygon fill="lightblue" stroke="black" points="66334.47,-1134 66191.47,-1134 66191.47,-1093 66334.47,-1093 66334.47,-1134"/>
<text text-anchor="middle" x="66262.97" y="-1122" font-family="Arial" font-size="10.00">Expert 29 (TP8) L3</text>
<text text-anchor="middle" x="66262.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="66262.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_30_stage1 -->
<g id="node185" class="node">
<title>expert_3_30_stage1</title>
<polygon fill="lightblue" stroke="black" points="66173.47,-1134 66030.47,-1134 66030.47,-1093 66173.47,-1093 66173.47,-1134"/>
<text text-anchor="middle" x="66101.97" y="-1122" font-family="Arial" font-size="10.00">Expert 30 (TP8) L3</text>
<text text-anchor="middle" x="66101.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="66101.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_31_stage1 -->
<g id="node186" class="node">
<title>expert_3_31_stage1</title>
<polygon fill="lightblue" stroke="black" points="66012.47,-1134 65869.47,-1134 65869.47,-1093 66012.47,-1093 66012.47,-1134"/>
<text text-anchor="middle" x="65940.97" y="-1122" font-family="Arial" font-size="10.00">Expert 31 (TP8) L3</text>
<text text-anchor="middle" x="65940.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="65940.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_32_stage1 -->
<g id="node187" class="node">
<title>expert_3_32_stage1</title>
<polygon fill="lightblue" stroke="black" points="65851.47,-1134 65708.47,-1134 65708.47,-1093 65851.47,-1093 65851.47,-1134"/>
<text text-anchor="middle" x="65779.97" y="-1122" font-family="Arial" font-size="10.00">Expert 32 (TP8) L3</text>
<text text-anchor="middle" x="65779.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="65779.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_33_stage1 -->
<g id="node188" class="node">
<title>expert_3_33_stage1</title>
<polygon fill="lightblue" stroke="black" points="65690.47,-1134 65547.47,-1134 65547.47,-1093 65690.47,-1093 65690.47,-1134"/>
<text text-anchor="middle" x="65618.97" y="-1122" font-family="Arial" font-size="10.00">Expert 33 (TP8) L3</text>
<text text-anchor="middle" x="65618.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="65618.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_34_stage1 -->
<g id="node189" class="node">
<title>expert_3_34_stage1</title>
<polygon fill="lightblue" stroke="black" points="65529.47,-1134 65386.47,-1134 65386.47,-1093 65529.47,-1093 65529.47,-1134"/>
<text text-anchor="middle" x="65457.97" y="-1122" font-family="Arial" font-size="10.00">Expert 34 (TP8) L3</text>
<text text-anchor="middle" x="65457.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="65457.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_35_stage1 -->
<g id="node190" class="node">
<title>expert_3_35_stage1</title>
<polygon fill="lightblue" stroke="black" points="65368.47,-1134 65225.47,-1134 65225.47,-1093 65368.47,-1093 65368.47,-1134"/>
<text text-anchor="middle" x="65296.97" y="-1122" font-family="Arial" font-size="10.00">Expert 35 (TP8) L3</text>
<text text-anchor="middle" x="65296.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="65296.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_36_stage1 -->
<g id="node191" class="node">
<title>expert_3_36_stage1</title>
<polygon fill="lightblue" stroke="black" points="65207.47,-1134 65064.47,-1134 65064.47,-1093 65207.47,-1093 65207.47,-1134"/>
<text text-anchor="middle" x="65135.97" y="-1122" font-family="Arial" font-size="10.00">Expert 36 (TP8) L3</text>
<text text-anchor="middle" x="65135.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="65135.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_37_stage1 -->
<g id="node192" class="node">
<title>expert_3_37_stage1</title>
<polygon fill="lightblue" stroke="black" points="65046.47,-1134 64903.47,-1134 64903.47,-1093 65046.47,-1093 65046.47,-1134"/>
<text text-anchor="middle" x="64974.97" y="-1122" font-family="Arial" font-size="10.00">Expert 37 (TP8) L3</text>
<text text-anchor="middle" x="64974.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="64974.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_38_stage1 -->
<g id="node193" class="node">
<title>expert_3_38_stage1</title>
<polygon fill="lightblue" stroke="black" points="64885.47,-1134 64742.47,-1134 64742.47,-1093 64885.47,-1093 64885.47,-1134"/>
<text text-anchor="middle" x="64813.97" y="-1122" font-family="Arial" font-size="10.00">Expert 38 (TP8) L3</text>
<text text-anchor="middle" x="64813.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="64813.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_39_stage1 -->
<g id="node194" class="node">
<title>expert_3_39_stage1</title>
<polygon fill="lightblue" stroke="black" points="64724.47,-1134 64581.47,-1134 64581.47,-1093 64724.47,-1093 64724.47,-1134"/>
<text text-anchor="middle" x="64652.97" y="-1122" font-family="Arial" font-size="10.00">Expert 39 (TP8) L3</text>
<text text-anchor="middle" x="64652.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="64652.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_40_stage1 -->
<g id="node195" class="node">
<title>expert_3_40_stage1</title>
<polygon fill="lightblue" stroke="black" points="64563.47,-1134 64420.47,-1134 64420.47,-1093 64563.47,-1093 64563.47,-1134"/>
<text text-anchor="middle" x="64491.97" y="-1122" font-family="Arial" font-size="10.00">Expert 40 (TP8) L3</text>
<text text-anchor="middle" x="64491.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="64491.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_41_stage1 -->
<g id="node196" class="node">
<title>expert_3_41_stage1</title>
<polygon fill="lightblue" stroke="black" points="64402.47,-1134 64259.47,-1134 64259.47,-1093 64402.47,-1093 64402.47,-1134"/>
<text text-anchor="middle" x="64330.97" y="-1122" font-family="Arial" font-size="10.00">Expert 41 (TP8) L3</text>
<text text-anchor="middle" x="64330.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="64330.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_42_stage1 -->
<g id="node197" class="node">
<title>expert_3_42_stage1</title>
<polygon fill="lightblue" stroke="black" points="64241.47,-1134 64098.47,-1134 64098.47,-1093 64241.47,-1093 64241.47,-1134"/>
<text text-anchor="middle" x="64169.97" y="-1122" font-family="Arial" font-size="10.00">Expert 42 (TP8) L3</text>
<text text-anchor="middle" x="64169.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="64169.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_43_stage1 -->
<g id="node198" class="node">
<title>expert_3_43_stage1</title>
<polygon fill="lightblue" stroke="black" points="64080.47,-1134 63937.47,-1134 63937.47,-1093 64080.47,-1093 64080.47,-1134"/>
<text text-anchor="middle" x="64008.97" y="-1122" font-family="Arial" font-size="10.00">Expert 43 (TP8) L3</text>
<text text-anchor="middle" x="64008.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="64008.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_44_stage1 -->
<g id="node199" class="node">
<title>expert_3_44_stage1</title>
<polygon fill="lightblue" stroke="black" points="63919.47,-1134 63776.47,-1134 63776.47,-1093 63919.47,-1093 63919.47,-1134"/>
<text text-anchor="middle" x="63847.97" y="-1122" font-family="Arial" font-size="10.00">Expert 44 (TP8) L3</text>
<text text-anchor="middle" x="63847.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="63847.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_45_stage1 -->
<g id="node200" class="node">
<title>expert_3_45_stage1</title>
<polygon fill="lightblue" stroke="black" points="63758.47,-1134 63615.47,-1134 63615.47,-1093 63758.47,-1093 63758.47,-1134"/>
<text text-anchor="middle" x="63686.97" y="-1122" font-family="Arial" font-size="10.00">Expert 45 (TP8) L3</text>
<text text-anchor="middle" x="63686.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="63686.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_46_stage1 -->
<g id="node201" class="node">
<title>expert_3_46_stage1</title>
<polygon fill="lightblue" stroke="black" points="63597.47,-1134 63454.47,-1134 63454.47,-1093 63597.47,-1093 63597.47,-1134"/>
<text text-anchor="middle" x="63525.97" y="-1122" font-family="Arial" font-size="10.00">Expert 46 (TP8) L3</text>
<text text-anchor="middle" x="63525.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="63525.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_47_stage1 -->
<g id="node202" class="node">
<title>expert_3_47_stage1</title>
<polygon fill="lightblue" stroke="black" points="63436.47,-1134 63293.47,-1134 63293.47,-1093 63436.47,-1093 63436.47,-1134"/>
<text text-anchor="middle" x="63364.97" y="-1122" font-family="Arial" font-size="10.00">Expert 47 (TP8) L3</text>
<text text-anchor="middle" x="63364.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="63364.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_48_stage1 -->
<g id="node203" class="node">
<title>expert_3_48_stage1</title>
<polygon fill="lightblue" stroke="black" points="63275.47,-1134 63132.47,-1134 63132.47,-1093 63275.47,-1093 63275.47,-1134"/>
<text text-anchor="middle" x="63203.97" y="-1122" font-family="Arial" font-size="10.00">Expert 48 (TP8) L3</text>
<text text-anchor="middle" x="63203.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="63203.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_49_stage1 -->
<g id="node204" class="node">
<title>expert_3_49_stage1</title>
<polygon fill="lightblue" stroke="black" points="63114.47,-1134 62971.47,-1134 62971.47,-1093 63114.47,-1093 63114.47,-1134"/>
<text text-anchor="middle" x="63042.97" y="-1122" font-family="Arial" font-size="10.00">Expert 49 (TP8) L3</text>
<text text-anchor="middle" x="63042.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="63042.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_50_stage1 -->
<g id="node205" class="node">
<title>expert_3_50_stage1</title>
<polygon fill="lightblue" stroke="black" points="62953.47,-1134 62810.47,-1134 62810.47,-1093 62953.47,-1093 62953.47,-1134"/>
<text text-anchor="middle" x="62881.97" y="-1122" font-family="Arial" font-size="10.00">Expert 50 (TP8) L3</text>
<text text-anchor="middle" x="62881.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="62881.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_51_stage1 -->
<g id="node206" class="node">
<title>expert_3_51_stage1</title>
<polygon fill="lightblue" stroke="black" points="62792.47,-1134 62649.47,-1134 62649.47,-1093 62792.47,-1093 62792.47,-1134"/>
<text text-anchor="middle" x="62720.97" y="-1122" font-family="Arial" font-size="10.00">Expert 51 (TP8) L3</text>
<text text-anchor="middle" x="62720.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="62720.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_52_stage1 -->
<g id="node207" class="node">
<title>expert_3_52_stage1</title>
<polygon fill="lightblue" stroke="black" points="62631.47,-1134 62488.47,-1134 62488.47,-1093 62631.47,-1093 62631.47,-1134"/>
<text text-anchor="middle" x="62559.97" y="-1122" font-family="Arial" font-size="10.00">Expert 52 (TP8) L3</text>
<text text-anchor="middle" x="62559.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="62559.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_53_stage1 -->
<g id="node208" class="node">
<title>expert_3_53_stage1</title>
<polygon fill="lightblue" stroke="black" points="62470.47,-1134 62327.47,-1134 62327.47,-1093 62470.47,-1093 62470.47,-1134"/>
<text text-anchor="middle" x="62398.97" y="-1122" font-family="Arial" font-size="10.00">Expert 53 (TP8) L3</text>
<text text-anchor="middle" x="62398.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="62398.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_54_stage1 -->
<g id="node209" class="node">
<title>expert_3_54_stage1</title>
<polygon fill="lightblue" stroke="black" points="62309.47,-1134 62166.47,-1134 62166.47,-1093 62309.47,-1093 62309.47,-1134"/>
<text text-anchor="middle" x="62237.97" y="-1122" font-family="Arial" font-size="10.00">Expert 54 (TP8) L3</text>
<text text-anchor="middle" x="62237.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="62237.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_55_stage1 -->
<g id="node210" class="node">
<title>expert_3_55_stage1</title>
<polygon fill="lightblue" stroke="black" points="62148.47,-1134 62005.47,-1134 62005.47,-1093 62148.47,-1093 62148.47,-1134"/>
<text text-anchor="middle" x="62076.97" y="-1122" font-family="Arial" font-size="10.00">Expert 55 (TP8) L3</text>
<text text-anchor="middle" x="62076.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="62076.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_56_stage1 -->
<g id="node211" class="node">
<title>expert_3_56_stage1</title>
<polygon fill="lightblue" stroke="black" points="61987.47,-1134 61844.47,-1134 61844.47,-1093 61987.47,-1093 61987.47,-1134"/>
<text text-anchor="middle" x="61915.97" y="-1122" font-family="Arial" font-size="10.00">Expert 56 (TP8) L3</text>
<text text-anchor="middle" x="61915.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="61915.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_57_stage1 -->
<g id="node212" class="node">
<title>expert_3_57_stage1</title>
<polygon fill="lightblue" stroke="black" points="61826.47,-1134 61683.47,-1134 61683.47,-1093 61826.47,-1093 61826.47,-1134"/>
<text text-anchor="middle" x="61754.97" y="-1122" font-family="Arial" font-size="10.00">Expert 57 (TP8) L3</text>
<text text-anchor="middle" x="61754.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="61754.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_58_stage1 -->
<g id="node213" class="node">
<title>expert_3_58_stage1</title>
<polygon fill="lightblue" stroke="black" points="61665.47,-1134 61522.47,-1134 61522.47,-1093 61665.47,-1093 61665.47,-1134"/>
<text text-anchor="middle" x="61593.97" y="-1122" font-family="Arial" font-size="10.00">Expert 58 (TP8) L3</text>
<text text-anchor="middle" x="61593.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="61593.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_59_stage1 -->
<g id="node214" class="node">
<title>expert_3_59_stage1</title>
<polygon fill="lightblue" stroke="black" points="61504.47,-1134 61361.47,-1134 61361.47,-1093 61504.47,-1093 61504.47,-1134"/>
<text text-anchor="middle" x="61432.97" y="-1122" font-family="Arial" font-size="10.00">Expert 59 (TP8) L3</text>
<text text-anchor="middle" x="61432.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="61432.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_60_stage1 -->
<g id="node215" class="node">
<title>expert_3_60_stage1</title>
<polygon fill="lightblue" stroke="black" points="61343.47,-1134 61200.47,-1134 61200.47,-1093 61343.47,-1093 61343.47,-1134"/>
<text text-anchor="middle" x="61271.97" y="-1122" font-family="Arial" font-size="10.00">Expert 60 (TP8) L3</text>
<text text-anchor="middle" x="61271.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="61271.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_61_stage1 -->
<g id="node216" class="node">
<title>expert_3_61_stage1</title>
<polygon fill="lightblue" stroke="black" points="61182.47,-1134 61039.47,-1134 61039.47,-1093 61182.47,-1093 61182.47,-1134"/>
<text text-anchor="middle" x="61110.97" y="-1122" font-family="Arial" font-size="10.00">Expert 61 (TP8) L3</text>
<text text-anchor="middle" x="61110.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="61110.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_62_stage1 -->
<g id="node217" class="node">
<title>expert_3_62_stage1</title>
<polygon fill="lightblue" stroke="black" points="61021.47,-1134 60878.47,-1134 60878.47,-1093 61021.47,-1093 61021.47,-1134"/>
<text text-anchor="middle" x="60949.97" y="-1122" font-family="Arial" font-size="10.00">Expert 62 (TP8) L3</text>
<text text-anchor="middle" x="60949.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="60949.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_3_63_stage1 -->
<g id="node218" class="node">
<title>expert_3_63_stage1</title>
<polygon fill="lightblue" stroke="black" points="60860.47,-1134 60717.47,-1134 60717.47,-1093 60860.47,-1093 60860.47,-1134"/>
<text text-anchor="middle" x="60788.97" y="-1122" font-family="Arial" font-size="10.00">Expert 63 (TP8) L3</text>
<text text-anchor="middle" x="60788.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="60788.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_3_stage1 -->
<g id="node219" class="node">
<title>combine_3_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="60595.97" cy="-1113.5" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="60595.97" y="-1122" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L3</text>
<text text-anchor="middle" x="60595.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="60595.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_3_stage1 -->
<g id="node220" class="node">
<title>moe_out_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="60474.97,-1134 60334.97,-1134 60334.97,-1093 60474.97,-1093 60474.97,-1134"/>
<text text-anchor="middle" x="60404.97" y="-1122" font-family="Arial" font-size="10.00">MoE Output (TP8) L3</text>
<text text-anchor="middle" x="60404.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="60404.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_3_stage1 -->
<g id="node221" class="node">
<title>ln2_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="60316.97,-1134 60176.97,-1134 60176.97,-1093 60316.97,-1093 60316.97,-1134"/>
<text text-anchor="middle" x="60246.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L3</text>
<text text-anchor="middle" x="60246.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="60246.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_4_stage1 -->
<g id="node222" class="node">
<title>ln1_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="60158.97,-1134 60018.97,-1134 60018.97,-1093 60158.97,-1093 60158.97,-1134"/>
<text text-anchor="middle" x="60088.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L4</text>
<text text-anchor="middle" x="60088.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="60088.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_4_stage1 -->
<g id="node223" class="node">
<title>qkv_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="60000.97,-1134 59854.97,-1134 59854.97,-1093 60000.97,-1093 60000.97,-1134"/>
<text text-anchor="middle" x="59927.97" y="-1122" font-family="Arial" font-size="10.00">QKV Projection (TP8) L4</text>
<text text-anchor="middle" x="59927.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="59927.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_4_stage1 -->
<g id="node224" class="node">
<title>attn_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="59836.97,-1134 59690.97,-1134 59690.97,-1093 59836.97,-1093 59836.97,-1134"/>
<text text-anchor="middle" x="59763.97" y="-1122" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L4</text>
<text text-anchor="middle" x="59763.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="59763.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_4_stage1 -->
<g id="node225" class="node">
<title>attn_out_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="59672.97,-1134 59532.97,-1134 59532.97,-1093 59672.97,-1093 59672.97,-1134"/>
<text text-anchor="middle" x="59602.97" y="-1122" font-family="Arial" font-size="10.00">Attention Output (TP8) L4</text>
<text text-anchor="middle" x="59602.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="59602.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_4_stage1 -->
<g id="node226" class="node">
<title>route_4_stage1</title>
<polygon fill="lightcoral" stroke="black" points="59515.27,-1154.5 59284.14,-1154.5 59224.68,-1072.5 59455.81,-1072.5 59515.27,-1154.5"/>
<text text-anchor="middle" x="59369.97" y="-1122" font-family="Arial" font-size="10.00">MoE Routing (EP64) L4</text>
<text text-anchor="middle" x="59369.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="59369.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_4_stage1 -->
<g id="node227" class="node">
<title>dispatch_4_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="59097.97" cy="-1113.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="59097.97" y="-1122" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L4</text>
<text text-anchor="middle" x="59097.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="59097.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_4_0_stage1 -->
<g id="node228" class="node">
<title>expert_4_0_stage1</title>
<polygon fill="lightblue" stroke="black" points="58971.47,-1134 58828.47,-1134 58828.47,-1093 58971.47,-1093 58971.47,-1134"/>
<text text-anchor="middle" x="58899.97" y="-1122" font-family="Arial" font-size="10.00">Expert 0 (TP8) L4</text>
<text text-anchor="middle" x="58899.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="58899.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_1_stage1 -->
<g id="node229" class="node">
<title>expert_4_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="58810.47,-1134 58667.47,-1134 58667.47,-1093 58810.47,-1093 58810.47,-1134"/>
<text text-anchor="middle" x="58738.97" y="-1122" font-family="Arial" font-size="10.00">Expert 1 (TP8) L4</text>
<text text-anchor="middle" x="58738.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="58738.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_2_stage1 -->
<g id="node230" class="node">
<title>expert_4_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="58649.47,-1134 58506.47,-1134 58506.47,-1093 58649.47,-1093 58649.47,-1134"/>
<text text-anchor="middle" x="58577.97" y="-1122" font-family="Arial" font-size="10.00">Expert 2 (TP8) L4</text>
<text text-anchor="middle" x="58577.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="58577.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_3_stage1 -->
<g id="node231" class="node">
<title>expert_4_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="58488.47,-1134 58345.47,-1134 58345.47,-1093 58488.47,-1093 58488.47,-1134"/>
<text text-anchor="middle" x="58416.97" y="-1122" font-family="Arial" font-size="10.00">Expert 3 (TP8) L4</text>
<text text-anchor="middle" x="58416.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="58416.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_4_stage1 -->
<g id="node232" class="node">
<title>expert_4_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="58327.47,-1134 58184.47,-1134 58184.47,-1093 58327.47,-1093 58327.47,-1134"/>
<text text-anchor="middle" x="58255.97" y="-1122" font-family="Arial" font-size="10.00">Expert 4 (TP8) L4</text>
<text text-anchor="middle" x="58255.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="58255.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_5_stage1 -->
<g id="node233" class="node">
<title>expert_4_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="58166.47,-1134 58023.47,-1134 58023.47,-1093 58166.47,-1093 58166.47,-1134"/>
<text text-anchor="middle" x="58094.97" y="-1122" font-family="Arial" font-size="10.00">Expert 5 (TP8) L4</text>
<text text-anchor="middle" x="58094.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="58094.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_6_stage1 -->
<g id="node234" class="node">
<title>expert_4_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="58005.47,-1134 57862.47,-1134 57862.47,-1093 58005.47,-1093 58005.47,-1134"/>
<text text-anchor="middle" x="57933.97" y="-1122" font-family="Arial" font-size="10.00">Expert 6 (TP8) L4</text>
<text text-anchor="middle" x="57933.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="57933.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_7_stage1 -->
<g id="node235" class="node">
<title>expert_4_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="57844.47,-1134 57701.47,-1134 57701.47,-1093 57844.47,-1093 57844.47,-1134"/>
<text text-anchor="middle" x="57772.97" y="-1122" font-family="Arial" font-size="10.00">Expert 7 (TP8) L4</text>
<text text-anchor="middle" x="57772.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="57772.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_8_stage1 -->
<g id="node236" class="node">
<title>expert_4_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="57683.47,-1134 57540.47,-1134 57540.47,-1093 57683.47,-1093 57683.47,-1134"/>
<text text-anchor="middle" x="57611.97" y="-1122" font-family="Arial" font-size="10.00">Expert 8 (TP8) L4</text>
<text text-anchor="middle" x="57611.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="57611.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_9_stage1 -->
<g id="node237" class="node">
<title>expert_4_9_stage1</title>
<polygon fill="lightblue" stroke="black" points="57522.47,-1134 57379.47,-1134 57379.47,-1093 57522.47,-1093 57522.47,-1134"/>
<text text-anchor="middle" x="57450.97" y="-1122" font-family="Arial" font-size="10.00">Expert 9 (TP8) L4</text>
<text text-anchor="middle" x="57450.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="57450.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_10_stage1 -->
<g id="node238" class="node">
<title>expert_4_10_stage1</title>
<polygon fill="lightblue" stroke="black" points="57361.47,-1134 57218.47,-1134 57218.47,-1093 57361.47,-1093 57361.47,-1134"/>
<text text-anchor="middle" x="57289.97" y="-1122" font-family="Arial" font-size="10.00">Expert 10 (TP8) L4</text>
<text text-anchor="middle" x="57289.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="57289.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_11_stage1 -->
<g id="node239" class="node">
<title>expert_4_11_stage1</title>
<polygon fill="lightblue" stroke="black" points="57200.47,-1134 57057.47,-1134 57057.47,-1093 57200.47,-1093 57200.47,-1134"/>
<text text-anchor="middle" x="57128.97" y="-1122" font-family="Arial" font-size="10.00">Expert 11 (TP8) L4</text>
<text text-anchor="middle" x="57128.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="57128.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_12_stage1 -->
<g id="node240" class="node">
<title>expert_4_12_stage1</title>
<polygon fill="lightblue" stroke="black" points="57039.47,-1134 56896.47,-1134 56896.47,-1093 57039.47,-1093 57039.47,-1134"/>
<text text-anchor="middle" x="56967.97" y="-1122" font-family="Arial" font-size="10.00">Expert 12 (TP8) L4</text>
<text text-anchor="middle" x="56967.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="56967.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_13_stage1 -->
<g id="node241" class="node">
<title>expert_4_13_stage1</title>
<polygon fill="lightblue" stroke="black" points="56878.47,-1134 56735.47,-1134 56735.47,-1093 56878.47,-1093 56878.47,-1134"/>
<text text-anchor="middle" x="56806.97" y="-1122" font-family="Arial" font-size="10.00">Expert 13 (TP8) L4</text>
<text text-anchor="middle" x="56806.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="56806.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_14_stage1 -->
<g id="node242" class="node">
<title>expert_4_14_stage1</title>
<polygon fill="lightblue" stroke="black" points="56717.47,-1134 56574.47,-1134 56574.47,-1093 56717.47,-1093 56717.47,-1134"/>
<text text-anchor="middle" x="56645.97" y="-1122" font-family="Arial" font-size="10.00">Expert 14 (TP8) L4</text>
<text text-anchor="middle" x="56645.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="56645.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_15_stage1 -->
<g id="node243" class="node">
<title>expert_4_15_stage1</title>
<polygon fill="lightblue" stroke="black" points="56556.47,-1134 56413.47,-1134 56413.47,-1093 56556.47,-1093 56556.47,-1134"/>
<text text-anchor="middle" x="56484.97" y="-1122" font-family="Arial" font-size="10.00">Expert 15 (TP8) L4</text>
<text text-anchor="middle" x="56484.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="56484.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_16_stage1 -->
<g id="node244" class="node">
<title>expert_4_16_stage1</title>
<polygon fill="lightblue" stroke="black" points="56395.47,-1134 56252.47,-1134 56252.47,-1093 56395.47,-1093 56395.47,-1134"/>
<text text-anchor="middle" x="56323.97" y="-1122" font-family="Arial" font-size="10.00">Expert 16 (TP8) L4</text>
<text text-anchor="middle" x="56323.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="56323.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_17_stage1 -->
<g id="node245" class="node">
<title>expert_4_17_stage1</title>
<polygon fill="lightblue" stroke="black" points="56234.47,-1134 56091.47,-1134 56091.47,-1093 56234.47,-1093 56234.47,-1134"/>
<text text-anchor="middle" x="56162.97" y="-1122" font-family="Arial" font-size="10.00">Expert 17 (TP8) L4</text>
<text text-anchor="middle" x="56162.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="56162.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_18_stage1 -->
<g id="node246" class="node">
<title>expert_4_18_stage1</title>
<polygon fill="lightblue" stroke="black" points="56073.47,-1134 55930.47,-1134 55930.47,-1093 56073.47,-1093 56073.47,-1134"/>
<text text-anchor="middle" x="56001.97" y="-1122" font-family="Arial" font-size="10.00">Expert 18 (TP8) L4</text>
<text text-anchor="middle" x="56001.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="56001.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_19_stage1 -->
<g id="node247" class="node">
<title>expert_4_19_stage1</title>
<polygon fill="lightblue" stroke="black" points="55912.47,-1134 55769.47,-1134 55769.47,-1093 55912.47,-1093 55912.47,-1134"/>
<text text-anchor="middle" x="55840.97" y="-1122" font-family="Arial" font-size="10.00">Expert 19 (TP8) L4</text>
<text text-anchor="middle" x="55840.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="55840.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_20_stage1 -->
<g id="node248" class="node">
<title>expert_4_20_stage1</title>
<polygon fill="lightblue" stroke="black" points="55751.47,-1134 55608.47,-1134 55608.47,-1093 55751.47,-1093 55751.47,-1134"/>
<text text-anchor="middle" x="55679.97" y="-1122" font-family="Arial" font-size="10.00">Expert 20 (TP8) L4</text>
<text text-anchor="middle" x="55679.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="55679.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_21_stage1 -->
<g id="node249" class="node">
<title>expert_4_21_stage1</title>
<polygon fill="lightblue" stroke="black" points="55590.47,-1134 55447.47,-1134 55447.47,-1093 55590.47,-1093 55590.47,-1134"/>
<text text-anchor="middle" x="55518.97" y="-1122" font-family="Arial" font-size="10.00">Expert 21 (TP8) L4</text>
<text text-anchor="middle" x="55518.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="55518.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_22_stage1 -->
<g id="node250" class="node">
<title>expert_4_22_stage1</title>
<polygon fill="lightblue" stroke="black" points="55429.47,-1134 55286.47,-1134 55286.47,-1093 55429.47,-1093 55429.47,-1134"/>
<text text-anchor="middle" x="55357.97" y="-1122" font-family="Arial" font-size="10.00">Expert 22 (TP8) L4</text>
<text text-anchor="middle" x="55357.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="55357.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_23_stage1 -->
<g id="node251" class="node">
<title>expert_4_23_stage1</title>
<polygon fill="lightblue" stroke="black" points="55268.47,-1134 55125.47,-1134 55125.47,-1093 55268.47,-1093 55268.47,-1134"/>
<text text-anchor="middle" x="55196.97" y="-1122" font-family="Arial" font-size="10.00">Expert 23 (TP8) L4</text>
<text text-anchor="middle" x="55196.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="55196.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_24_stage1 -->
<g id="node252" class="node">
<title>expert_4_24_stage1</title>
<polygon fill="lightblue" stroke="black" points="55107.47,-1134 54964.47,-1134 54964.47,-1093 55107.47,-1093 55107.47,-1134"/>
<text text-anchor="middle" x="55035.97" y="-1122" font-family="Arial" font-size="10.00">Expert 24 (TP8) L4</text>
<text text-anchor="middle" x="55035.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="55035.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_25_stage1 -->
<g id="node253" class="node">
<title>expert_4_25_stage1</title>
<polygon fill="lightblue" stroke="black" points="54946.47,-1134 54803.47,-1134 54803.47,-1093 54946.47,-1093 54946.47,-1134"/>
<text text-anchor="middle" x="54874.97" y="-1122" font-family="Arial" font-size="10.00">Expert 25 (TP8) L4</text>
<text text-anchor="middle" x="54874.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="54874.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_26_stage1 -->
<g id="node254" class="node">
<title>expert_4_26_stage1</title>
<polygon fill="lightblue" stroke="black" points="54785.47,-1134 54642.47,-1134 54642.47,-1093 54785.47,-1093 54785.47,-1134"/>
<text text-anchor="middle" x="54713.97" y="-1122" font-family="Arial" font-size="10.00">Expert 26 (TP8) L4</text>
<text text-anchor="middle" x="54713.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="54713.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_27_stage1 -->
<g id="node255" class="node">
<title>expert_4_27_stage1</title>
<polygon fill="lightblue" stroke="black" points="54624.47,-1134 54481.47,-1134 54481.47,-1093 54624.47,-1093 54624.47,-1134"/>
<text text-anchor="middle" x="54552.97" y="-1122" font-family="Arial" font-size="10.00">Expert 27 (TP8) L4</text>
<text text-anchor="middle" x="54552.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="54552.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_28_stage1 -->
<g id="node256" class="node">
<title>expert_4_28_stage1</title>
<polygon fill="lightblue" stroke="black" points="54463.47,-1134 54320.47,-1134 54320.47,-1093 54463.47,-1093 54463.47,-1134"/>
<text text-anchor="middle" x="54391.97" y="-1122" font-family="Arial" font-size="10.00">Expert 28 (TP8) L4</text>
<text text-anchor="middle" x="54391.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="54391.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_29_stage1 -->
<g id="node257" class="node">
<title>expert_4_29_stage1</title>
<polygon fill="lightblue" stroke="black" points="54302.47,-1134 54159.47,-1134 54159.47,-1093 54302.47,-1093 54302.47,-1134"/>
<text text-anchor="middle" x="54230.97" y="-1122" font-family="Arial" font-size="10.00">Expert 29 (TP8) L4</text>
<text text-anchor="middle" x="54230.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="54230.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_30_stage1 -->
<g id="node258" class="node">
<title>expert_4_30_stage1</title>
<polygon fill="lightblue" stroke="black" points="54141.47,-1134 53998.47,-1134 53998.47,-1093 54141.47,-1093 54141.47,-1134"/>
<text text-anchor="middle" x="54069.97" y="-1122" font-family="Arial" font-size="10.00">Expert 30 (TP8) L4</text>
<text text-anchor="middle" x="54069.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="54069.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_31_stage1 -->
<g id="node259" class="node">
<title>expert_4_31_stage1</title>
<polygon fill="lightblue" stroke="black" points="53980.47,-1134 53837.47,-1134 53837.47,-1093 53980.47,-1093 53980.47,-1134"/>
<text text-anchor="middle" x="53908.97" y="-1122" font-family="Arial" font-size="10.00">Expert 31 (TP8) L4</text>
<text text-anchor="middle" x="53908.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="53908.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_32_stage1 -->
<g id="node260" class="node">
<title>expert_4_32_stage1</title>
<polygon fill="lightblue" stroke="black" points="53819.47,-1134 53676.47,-1134 53676.47,-1093 53819.47,-1093 53819.47,-1134"/>
<text text-anchor="middle" x="53747.97" y="-1122" font-family="Arial" font-size="10.00">Expert 32 (TP8) L4</text>
<text text-anchor="middle" x="53747.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="53747.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_33_stage1 -->
<g id="node261" class="node">
<title>expert_4_33_stage1</title>
<polygon fill="lightblue" stroke="black" points="53658.47,-1134 53515.47,-1134 53515.47,-1093 53658.47,-1093 53658.47,-1134"/>
<text text-anchor="middle" x="53586.97" y="-1122" font-family="Arial" font-size="10.00">Expert 33 (TP8) L4</text>
<text text-anchor="middle" x="53586.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="53586.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_34_stage1 -->
<g id="node262" class="node">
<title>expert_4_34_stage1</title>
<polygon fill="lightblue" stroke="black" points="53497.47,-1134 53354.47,-1134 53354.47,-1093 53497.47,-1093 53497.47,-1134"/>
<text text-anchor="middle" x="53425.97" y="-1122" font-family="Arial" font-size="10.00">Expert 34 (TP8) L4</text>
<text text-anchor="middle" x="53425.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="53425.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_35_stage1 -->
<g id="node263" class="node">
<title>expert_4_35_stage1</title>
<polygon fill="lightblue" stroke="black" points="53336.47,-1134 53193.47,-1134 53193.47,-1093 53336.47,-1093 53336.47,-1134"/>
<text text-anchor="middle" x="53264.97" y="-1122" font-family="Arial" font-size="10.00">Expert 35 (TP8) L4</text>
<text text-anchor="middle" x="53264.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="53264.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_36_stage1 -->
<g id="node264" class="node">
<title>expert_4_36_stage1</title>
<polygon fill="lightblue" stroke="black" points="53175.47,-1134 53032.47,-1134 53032.47,-1093 53175.47,-1093 53175.47,-1134"/>
<text text-anchor="middle" x="53103.97" y="-1122" font-family="Arial" font-size="10.00">Expert 36 (TP8) L4</text>
<text text-anchor="middle" x="53103.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="53103.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_37_stage1 -->
<g id="node265" class="node">
<title>expert_4_37_stage1</title>
<polygon fill="lightblue" stroke="black" points="53014.47,-1134 52871.47,-1134 52871.47,-1093 53014.47,-1093 53014.47,-1134"/>
<text text-anchor="middle" x="52942.97" y="-1122" font-family="Arial" font-size="10.00">Expert 37 (TP8) L4</text>
<text text-anchor="middle" x="52942.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="52942.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_38_stage1 -->
<g id="node266" class="node">
<title>expert_4_38_stage1</title>
<polygon fill="lightblue" stroke="black" points="52853.47,-1134 52710.47,-1134 52710.47,-1093 52853.47,-1093 52853.47,-1134"/>
<text text-anchor="middle" x="52781.97" y="-1122" font-family="Arial" font-size="10.00">Expert 38 (TP8) L4</text>
<text text-anchor="middle" x="52781.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="52781.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_39_stage1 -->
<g id="node267" class="node">
<title>expert_4_39_stage1</title>
<polygon fill="lightblue" stroke="black" points="52692.47,-1134 52549.47,-1134 52549.47,-1093 52692.47,-1093 52692.47,-1134"/>
<text text-anchor="middle" x="52620.97" y="-1122" font-family="Arial" font-size="10.00">Expert 39 (TP8) L4</text>
<text text-anchor="middle" x="52620.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="52620.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_40_stage1 -->
<g id="node268" class="node">
<title>expert_4_40_stage1</title>
<polygon fill="lightblue" stroke="black" points="52531.47,-1134 52388.47,-1134 52388.47,-1093 52531.47,-1093 52531.47,-1134"/>
<text text-anchor="middle" x="52459.97" y="-1122" font-family="Arial" font-size="10.00">Expert 40 (TP8) L4</text>
<text text-anchor="middle" x="52459.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="52459.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_41_stage1 -->
<g id="node269" class="node">
<title>expert_4_41_stage1</title>
<polygon fill="lightblue" stroke="black" points="52370.47,-1134 52227.47,-1134 52227.47,-1093 52370.47,-1093 52370.47,-1134"/>
<text text-anchor="middle" x="52298.97" y="-1122" font-family="Arial" font-size="10.00">Expert 41 (TP8) L4</text>
<text text-anchor="middle" x="52298.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="52298.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_42_stage1 -->
<g id="node270" class="node">
<title>expert_4_42_stage1</title>
<polygon fill="lightblue" stroke="black" points="52209.47,-1134 52066.47,-1134 52066.47,-1093 52209.47,-1093 52209.47,-1134"/>
<text text-anchor="middle" x="52137.97" y="-1122" font-family="Arial" font-size="10.00">Expert 42 (TP8) L4</text>
<text text-anchor="middle" x="52137.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="52137.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_43_stage1 -->
<g id="node271" class="node">
<title>expert_4_43_stage1</title>
<polygon fill="lightblue" stroke="black" points="52048.47,-1134 51905.47,-1134 51905.47,-1093 52048.47,-1093 52048.47,-1134"/>
<text text-anchor="middle" x="51976.97" y="-1122" font-family="Arial" font-size="10.00">Expert 43 (TP8) L4</text>
<text text-anchor="middle" x="51976.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="51976.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_44_stage1 -->
<g id="node272" class="node">
<title>expert_4_44_stage1</title>
<polygon fill="lightblue" stroke="black" points="51887.47,-1134 51744.47,-1134 51744.47,-1093 51887.47,-1093 51887.47,-1134"/>
<text text-anchor="middle" x="51815.97" y="-1122" font-family="Arial" font-size="10.00">Expert 44 (TP8) L4</text>
<text text-anchor="middle" x="51815.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="51815.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_45_stage1 -->
<g id="node273" class="node">
<title>expert_4_45_stage1</title>
<polygon fill="lightblue" stroke="black" points="51726.47,-1134 51583.47,-1134 51583.47,-1093 51726.47,-1093 51726.47,-1134"/>
<text text-anchor="middle" x="51654.97" y="-1122" font-family="Arial" font-size="10.00">Expert 45 (TP8) L4</text>
<text text-anchor="middle" x="51654.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="51654.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_46_stage1 -->
<g id="node274" class="node">
<title>expert_4_46_stage1</title>
<polygon fill="lightblue" stroke="black" points="51565.47,-1134 51422.47,-1134 51422.47,-1093 51565.47,-1093 51565.47,-1134"/>
<text text-anchor="middle" x="51493.97" y="-1122" font-family="Arial" font-size="10.00">Expert 46 (TP8) L4</text>
<text text-anchor="middle" x="51493.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="51493.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_47_stage1 -->
<g id="node275" class="node">
<title>expert_4_47_stage1</title>
<polygon fill="lightblue" stroke="black" points="51404.47,-1134 51261.47,-1134 51261.47,-1093 51404.47,-1093 51404.47,-1134"/>
<text text-anchor="middle" x="51332.97" y="-1122" font-family="Arial" font-size="10.00">Expert 47 (TP8) L4</text>
<text text-anchor="middle" x="51332.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="51332.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_48_stage1 -->
<g id="node276" class="node">
<title>expert_4_48_stage1</title>
<polygon fill="lightblue" stroke="black" points="51243.47,-1134 51100.47,-1134 51100.47,-1093 51243.47,-1093 51243.47,-1134"/>
<text text-anchor="middle" x="51171.97" y="-1122" font-family="Arial" font-size="10.00">Expert 48 (TP8) L4</text>
<text text-anchor="middle" x="51171.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="51171.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_49_stage1 -->
<g id="node277" class="node">
<title>expert_4_49_stage1</title>
<polygon fill="lightblue" stroke="black" points="51082.47,-1134 50939.47,-1134 50939.47,-1093 51082.47,-1093 51082.47,-1134"/>
<text text-anchor="middle" x="51010.97" y="-1122" font-family="Arial" font-size="10.00">Expert 49 (TP8) L4</text>
<text text-anchor="middle" x="51010.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="51010.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_50_stage1 -->
<g id="node278" class="node">
<title>expert_4_50_stage1</title>
<polygon fill="lightblue" stroke="black" points="50921.47,-1134 50778.47,-1134 50778.47,-1093 50921.47,-1093 50921.47,-1134"/>
<text text-anchor="middle" x="50849.97" y="-1122" font-family="Arial" font-size="10.00">Expert 50 (TP8) L4</text>
<text text-anchor="middle" x="50849.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="50849.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_51_stage1 -->
<g id="node279" class="node">
<title>expert_4_51_stage1</title>
<polygon fill="lightblue" stroke="black" points="50760.47,-1134 50617.47,-1134 50617.47,-1093 50760.47,-1093 50760.47,-1134"/>
<text text-anchor="middle" x="50688.97" y="-1122" font-family="Arial" font-size="10.00">Expert 51 (TP8) L4</text>
<text text-anchor="middle" x="50688.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="50688.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_52_stage1 -->
<g id="node280" class="node">
<title>expert_4_52_stage1</title>
<polygon fill="lightblue" stroke="black" points="50599.47,-1134 50456.47,-1134 50456.47,-1093 50599.47,-1093 50599.47,-1134"/>
<text text-anchor="middle" x="50527.97" y="-1122" font-family="Arial" font-size="10.00">Expert 52 (TP8) L4</text>
<text text-anchor="middle" x="50527.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="50527.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_53_stage1 -->
<g id="node281" class="node">
<title>expert_4_53_stage1</title>
<polygon fill="lightblue" stroke="black" points="50438.47,-1134 50295.47,-1134 50295.47,-1093 50438.47,-1093 50438.47,-1134"/>
<text text-anchor="middle" x="50366.97" y="-1122" font-family="Arial" font-size="10.00">Expert 53 (TP8) L4</text>
<text text-anchor="middle" x="50366.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="50366.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_54_stage1 -->
<g id="node282" class="node">
<title>expert_4_54_stage1</title>
<polygon fill="lightblue" stroke="black" points="50277.47,-1134 50134.47,-1134 50134.47,-1093 50277.47,-1093 50277.47,-1134"/>
<text text-anchor="middle" x="50205.97" y="-1122" font-family="Arial" font-size="10.00">Expert 54 (TP8) L4</text>
<text text-anchor="middle" x="50205.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="50205.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_55_stage1 -->
<g id="node283" class="node">
<title>expert_4_55_stage1</title>
<polygon fill="lightblue" stroke="black" points="50116.47,-1134 49973.47,-1134 49973.47,-1093 50116.47,-1093 50116.47,-1134"/>
<text text-anchor="middle" x="50044.97" y="-1122" font-family="Arial" font-size="10.00">Expert 55 (TP8) L4</text>
<text text-anchor="middle" x="50044.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="50044.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_56_stage1 -->
<g id="node284" class="node">
<title>expert_4_56_stage1</title>
<polygon fill="lightblue" stroke="black" points="49955.47,-1134 49812.47,-1134 49812.47,-1093 49955.47,-1093 49955.47,-1134"/>
<text text-anchor="middle" x="49883.97" y="-1122" font-family="Arial" font-size="10.00">Expert 56 (TP8) L4</text>
<text text-anchor="middle" x="49883.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="49883.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_57_stage1 -->
<g id="node285" class="node">
<title>expert_4_57_stage1</title>
<polygon fill="lightblue" stroke="black" points="49794.47,-1134 49651.47,-1134 49651.47,-1093 49794.47,-1093 49794.47,-1134"/>
<text text-anchor="middle" x="49722.97" y="-1122" font-family="Arial" font-size="10.00">Expert 57 (TP8) L4</text>
<text text-anchor="middle" x="49722.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="49722.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_58_stage1 -->
<g id="node286" class="node">
<title>expert_4_58_stage1</title>
<polygon fill="lightblue" stroke="black" points="49633.47,-1134 49490.47,-1134 49490.47,-1093 49633.47,-1093 49633.47,-1134"/>
<text text-anchor="middle" x="49561.97" y="-1122" font-family="Arial" font-size="10.00">Expert 58 (TP8) L4</text>
<text text-anchor="middle" x="49561.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="49561.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_59_stage1 -->
<g id="node287" class="node">
<title>expert_4_59_stage1</title>
<polygon fill="lightblue" stroke="black" points="49472.47,-1134 49329.47,-1134 49329.47,-1093 49472.47,-1093 49472.47,-1134"/>
<text text-anchor="middle" x="49400.97" y="-1122" font-family="Arial" font-size="10.00">Expert 59 (TP8) L4</text>
<text text-anchor="middle" x="49400.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="49400.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_60_stage1 -->
<g id="node288" class="node">
<title>expert_4_60_stage1</title>
<polygon fill="lightblue" stroke="black" points="49311.47,-1134 49168.47,-1134 49168.47,-1093 49311.47,-1093 49311.47,-1134"/>
<text text-anchor="middle" x="49239.97" y="-1122" font-family="Arial" font-size="10.00">Expert 60 (TP8) L4</text>
<text text-anchor="middle" x="49239.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="49239.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_61_stage1 -->
<g id="node289" class="node">
<title>expert_4_61_stage1</title>
<polygon fill="lightblue" stroke="black" points="49150.47,-1134 49007.47,-1134 49007.47,-1093 49150.47,-1093 49150.47,-1134"/>
<text text-anchor="middle" x="49078.97" y="-1122" font-family="Arial" font-size="10.00">Expert 61 (TP8) L4</text>
<text text-anchor="middle" x="49078.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="49078.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_62_stage1 -->
<g id="node290" class="node">
<title>expert_4_62_stage1</title>
<polygon fill="lightblue" stroke="black" points="48989.47,-1134 48846.47,-1134 48846.47,-1093 48989.47,-1093 48989.47,-1134"/>
<text text-anchor="middle" x="48917.97" y="-1122" font-family="Arial" font-size="10.00">Expert 62 (TP8) L4</text>
<text text-anchor="middle" x="48917.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="48917.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_4_63_stage1 -->
<g id="node291" class="node">
<title>expert_4_63_stage1</title>
<polygon fill="lightblue" stroke="black" points="48828.47,-1134 48685.47,-1134 48685.47,-1093 48828.47,-1093 48828.47,-1134"/>
<text text-anchor="middle" x="48756.97" y="-1122" font-family="Arial" font-size="10.00">Expert 63 (TP8) L4</text>
<text text-anchor="middle" x="48756.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="48756.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_4_stage1 -->
<g id="node292" class="node">
<title>combine_4_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="48563.97" cy="-1113.5" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="48563.97" y="-1122" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L4</text>
<text text-anchor="middle" x="48563.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="48563.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_4_stage1 -->
<g id="node293" class="node">
<title>moe_out_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="48442.97,-1134 48302.97,-1134 48302.97,-1093 48442.97,-1093 48442.97,-1134"/>
<text text-anchor="middle" x="48372.97" y="-1122" font-family="Arial" font-size="10.00">MoE Output (TP8) L4</text>
<text text-anchor="middle" x="48372.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="48372.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_4_stage1 -->
<g id="node294" class="node">
<title>ln2_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="48284.97,-1134 48144.97,-1134 48144.97,-1093 48284.97,-1093 48284.97,-1134"/>
<text text-anchor="middle" x="48214.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L4</text>
<text text-anchor="middle" x="48214.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="48214.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_5_stage1 -->
<g id="node295" class="node">
<title>ln1_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="48126.97,-1134 47986.97,-1134 47986.97,-1093 48126.97,-1093 48126.97,-1134"/>
<text text-anchor="middle" x="48056.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L5</text>
<text text-anchor="middle" x="48056.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="48056.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_5_stage1 -->
<g id="node296" class="node">
<title>qkv_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="47968.97,-1134 47822.97,-1134 47822.97,-1093 47968.97,-1093 47968.97,-1134"/>
<text text-anchor="middle" x="47895.97" y="-1122" font-family="Arial" font-size="10.00">QKV Projection (TP8) L5</text>
<text text-anchor="middle" x="47895.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="47895.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_5_stage1 -->
<g id="node297" class="node">
<title>attn_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="47804.97,-1134 47658.97,-1134 47658.97,-1093 47804.97,-1093 47804.97,-1134"/>
<text text-anchor="middle" x="47731.97" y="-1122" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L5</text>
<text text-anchor="middle" x="47731.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="47731.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_5_stage1 -->
<g id="node298" class="node">
<title>attn_out_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="47640.97,-1134 47500.97,-1134 47500.97,-1093 47640.97,-1093 47640.97,-1134"/>
<text text-anchor="middle" x="47570.97" y="-1122" font-family="Arial" font-size="10.00">Attention Output (TP8) L5</text>
<text text-anchor="middle" x="47570.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="47570.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_5_stage1 -->
<g id="node299" class="node">
<title>route_5_stage1</title>
<polygon fill="lightcoral" stroke="black" points="47483.27,-1154.5 47252.14,-1154.5 47192.68,-1072.5 47423.81,-1072.5 47483.27,-1154.5"/>
<text text-anchor="middle" x="47337.97" y="-1122" font-family="Arial" font-size="10.00">MoE Routing (EP64) L5</text>
<text text-anchor="middle" x="47337.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="47337.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_5_stage1 -->
<g id="node300" class="node">
<title>dispatch_5_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="47065.97" cy="-1113.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="47065.97" y="-1122" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L5</text>
<text text-anchor="middle" x="47065.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="47065.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_5_0_stage1 -->
<g id="node301" class="node">
<title>expert_5_0_stage1</title>
<polygon fill="lightblue" stroke="black" points="46939.47,-1134 46796.47,-1134 46796.47,-1093 46939.47,-1093 46939.47,-1134"/>
<text text-anchor="middle" x="46867.97" y="-1122" font-family="Arial" font-size="10.00">Expert 0 (TP8) L5</text>
<text text-anchor="middle" x="46867.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="46867.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_1_stage1 -->
<g id="node302" class="node">
<title>expert_5_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="46778.47,-1134 46635.47,-1134 46635.47,-1093 46778.47,-1093 46778.47,-1134"/>
<text text-anchor="middle" x="46706.97" y="-1122" font-family="Arial" font-size="10.00">Expert 1 (TP8) L5</text>
<text text-anchor="middle" x="46706.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="46706.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_2_stage1 -->
<g id="node303" class="node">
<title>expert_5_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="46617.47,-1134 46474.47,-1134 46474.47,-1093 46617.47,-1093 46617.47,-1134"/>
<text text-anchor="middle" x="46545.97" y="-1122" font-family="Arial" font-size="10.00">Expert 2 (TP8) L5</text>
<text text-anchor="middle" x="46545.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="46545.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_3_stage1 -->
<g id="node304" class="node">
<title>expert_5_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="46456.47,-1134 46313.47,-1134 46313.47,-1093 46456.47,-1093 46456.47,-1134"/>
<text text-anchor="middle" x="46384.97" y="-1122" font-family="Arial" font-size="10.00">Expert 3 (TP8) L5</text>
<text text-anchor="middle" x="46384.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="46384.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_4_stage1 -->
<g id="node305" class="node">
<title>expert_5_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="46295.47,-1134 46152.47,-1134 46152.47,-1093 46295.47,-1093 46295.47,-1134"/>
<text text-anchor="middle" x="46223.97" y="-1122" font-family="Arial" font-size="10.00">Expert 4 (TP8) L5</text>
<text text-anchor="middle" x="46223.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="46223.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_5_stage1 -->
<g id="node306" class="node">
<title>expert_5_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="46134.47,-1134 45991.47,-1134 45991.47,-1093 46134.47,-1093 46134.47,-1134"/>
<text text-anchor="middle" x="46062.97" y="-1122" font-family="Arial" font-size="10.00">Expert 5 (TP8) L5</text>
<text text-anchor="middle" x="46062.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="46062.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_6_stage1 -->
<g id="node307" class="node">
<title>expert_5_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="45973.47,-1134 45830.47,-1134 45830.47,-1093 45973.47,-1093 45973.47,-1134"/>
<text text-anchor="middle" x="45901.97" y="-1122" font-family="Arial" font-size="10.00">Expert 6 (TP8) L5</text>
<text text-anchor="middle" x="45901.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="45901.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_7_stage1 -->
<g id="node308" class="node">
<title>expert_5_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="45812.47,-1134 45669.47,-1134 45669.47,-1093 45812.47,-1093 45812.47,-1134"/>
<text text-anchor="middle" x="45740.97" y="-1122" font-family="Arial" font-size="10.00">Expert 7 (TP8) L5</text>
<text text-anchor="middle" x="45740.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="45740.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_8_stage1 -->
<g id="node309" class="node">
<title>expert_5_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="45651.47,-1134 45508.47,-1134 45508.47,-1093 45651.47,-1093 45651.47,-1134"/>
<text text-anchor="middle" x="45579.97" y="-1122" font-family="Arial" font-size="10.00">Expert 8 (TP8) L5</text>
<text text-anchor="middle" x="45579.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="45579.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_9_stage1 -->
<g id="node310" class="node">
<title>expert_5_9_stage1</title>
<polygon fill="lightblue" stroke="black" points="45490.47,-1134 45347.47,-1134 45347.47,-1093 45490.47,-1093 45490.47,-1134"/>
<text text-anchor="middle" x="45418.97" y="-1122" font-family="Arial" font-size="10.00">Expert 9 (TP8) L5</text>
<text text-anchor="middle" x="45418.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="45418.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_10_stage1 -->
<g id="node311" class="node">
<title>expert_5_10_stage1</title>
<polygon fill="lightblue" stroke="black" points="45329.47,-1134 45186.47,-1134 45186.47,-1093 45329.47,-1093 45329.47,-1134"/>
<text text-anchor="middle" x="45257.97" y="-1122" font-family="Arial" font-size="10.00">Expert 10 (TP8) L5</text>
<text text-anchor="middle" x="45257.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="45257.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_11_stage1 -->
<g id="node312" class="node">
<title>expert_5_11_stage1</title>
<polygon fill="lightblue" stroke="black" points="45168.47,-1134 45025.47,-1134 45025.47,-1093 45168.47,-1093 45168.47,-1134"/>
<text text-anchor="middle" x="45096.97" y="-1122" font-family="Arial" font-size="10.00">Expert 11 (TP8) L5</text>
<text text-anchor="middle" x="45096.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="45096.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_12_stage1 -->
<g id="node313" class="node">
<title>expert_5_12_stage1</title>
<polygon fill="lightblue" stroke="black" points="45007.47,-1134 44864.47,-1134 44864.47,-1093 45007.47,-1093 45007.47,-1134"/>
<text text-anchor="middle" x="44935.97" y="-1122" font-family="Arial" font-size="10.00">Expert 12 (TP8) L5</text>
<text text-anchor="middle" x="44935.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="44935.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_13_stage1 -->
<g id="node314" class="node">
<title>expert_5_13_stage1</title>
<polygon fill="lightblue" stroke="black" points="44846.47,-1134 44703.47,-1134 44703.47,-1093 44846.47,-1093 44846.47,-1134"/>
<text text-anchor="middle" x="44774.97" y="-1122" font-family="Arial" font-size="10.00">Expert 13 (TP8) L5</text>
<text text-anchor="middle" x="44774.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="44774.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_14_stage1 -->
<g id="node315" class="node">
<title>expert_5_14_stage1</title>
<polygon fill="lightblue" stroke="black" points="44685.47,-1134 44542.47,-1134 44542.47,-1093 44685.47,-1093 44685.47,-1134"/>
<text text-anchor="middle" x="44613.97" y="-1122" font-family="Arial" font-size="10.00">Expert 14 (TP8) L5</text>
<text text-anchor="middle" x="44613.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="44613.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_15_stage1 -->
<g id="node316" class="node">
<title>expert_5_15_stage1</title>
<polygon fill="lightblue" stroke="black" points="44524.47,-1134 44381.47,-1134 44381.47,-1093 44524.47,-1093 44524.47,-1134"/>
<text text-anchor="middle" x="44452.97" y="-1122" font-family="Arial" font-size="10.00">Expert 15 (TP8) L5</text>
<text text-anchor="middle" x="44452.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="44452.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_16_stage1 -->
<g id="node317" class="node">
<title>expert_5_16_stage1</title>
<polygon fill="lightblue" stroke="black" points="44363.47,-1134 44220.47,-1134 44220.47,-1093 44363.47,-1093 44363.47,-1134"/>
<text text-anchor="middle" x="44291.97" y="-1122" font-family="Arial" font-size="10.00">Expert 16 (TP8) L5</text>
<text text-anchor="middle" x="44291.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="44291.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_17_stage1 -->
<g id="node318" class="node">
<title>expert_5_17_stage1</title>
<polygon fill="lightblue" stroke="black" points="44202.47,-1134 44059.47,-1134 44059.47,-1093 44202.47,-1093 44202.47,-1134"/>
<text text-anchor="middle" x="44130.97" y="-1122" font-family="Arial" font-size="10.00">Expert 17 (TP8) L5</text>
<text text-anchor="middle" x="44130.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="44130.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_18_stage1 -->
<g id="node319" class="node">
<title>expert_5_18_stage1</title>
<polygon fill="lightblue" stroke="black" points="44041.47,-1134 43898.47,-1134 43898.47,-1093 44041.47,-1093 44041.47,-1134"/>
<text text-anchor="middle" x="43969.97" y="-1122" font-family="Arial" font-size="10.00">Expert 18 (TP8) L5</text>
<text text-anchor="middle" x="43969.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="43969.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_19_stage1 -->
<g id="node320" class="node">
<title>expert_5_19_stage1</title>
<polygon fill="lightblue" stroke="black" points="43880.47,-1134 43737.47,-1134 43737.47,-1093 43880.47,-1093 43880.47,-1134"/>
<text text-anchor="middle" x="43808.97" y="-1122" font-family="Arial" font-size="10.00">Expert 19 (TP8) L5</text>
<text text-anchor="middle" x="43808.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="43808.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_20_stage1 -->
<g id="node321" class="node">
<title>expert_5_20_stage1</title>
<polygon fill="lightblue" stroke="black" points="43719.47,-1134 43576.47,-1134 43576.47,-1093 43719.47,-1093 43719.47,-1134"/>
<text text-anchor="middle" x="43647.97" y="-1122" font-family="Arial" font-size="10.00">Expert 20 (TP8) L5</text>
<text text-anchor="middle" x="43647.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="43647.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_21_stage1 -->
<g id="node322" class="node">
<title>expert_5_21_stage1</title>
<polygon fill="lightblue" stroke="black" points="43558.47,-1134 43415.47,-1134 43415.47,-1093 43558.47,-1093 43558.47,-1134"/>
<text text-anchor="middle" x="43486.97" y="-1122" font-family="Arial" font-size="10.00">Expert 21 (TP8) L5</text>
<text text-anchor="middle" x="43486.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="43486.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_22_stage1 -->
<g id="node323" class="node">
<title>expert_5_22_stage1</title>
<polygon fill="lightblue" stroke="black" points="43397.47,-1134 43254.47,-1134 43254.47,-1093 43397.47,-1093 43397.47,-1134"/>
<text text-anchor="middle" x="43325.97" y="-1122" font-family="Arial" font-size="10.00">Expert 22 (TP8) L5</text>
<text text-anchor="middle" x="43325.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="43325.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_23_stage1 -->
<g id="node324" class="node">
<title>expert_5_23_stage1</title>
<polygon fill="lightblue" stroke="black" points="43236.47,-1134 43093.47,-1134 43093.47,-1093 43236.47,-1093 43236.47,-1134"/>
<text text-anchor="middle" x="43164.97" y="-1122" font-family="Arial" font-size="10.00">Expert 23 (TP8) L5</text>
<text text-anchor="middle" x="43164.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="43164.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_24_stage1 -->
<g id="node325" class="node">
<title>expert_5_24_stage1</title>
<polygon fill="lightblue" stroke="black" points="43075.47,-1134 42932.47,-1134 42932.47,-1093 43075.47,-1093 43075.47,-1134"/>
<text text-anchor="middle" x="43003.97" y="-1122" font-family="Arial" font-size="10.00">Expert 24 (TP8) L5</text>
<text text-anchor="middle" x="43003.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="43003.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_25_stage1 -->
<g id="node326" class="node">
<title>expert_5_25_stage1</title>
<polygon fill="lightblue" stroke="black" points="42914.47,-1134 42771.47,-1134 42771.47,-1093 42914.47,-1093 42914.47,-1134"/>
<text text-anchor="middle" x="42842.97" y="-1122" font-family="Arial" font-size="10.00">Expert 25 (TP8) L5</text>
<text text-anchor="middle" x="42842.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="42842.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_26_stage1 -->
<g id="node327" class="node">
<title>expert_5_26_stage1</title>
<polygon fill="lightblue" stroke="black" points="42753.47,-1134 42610.47,-1134 42610.47,-1093 42753.47,-1093 42753.47,-1134"/>
<text text-anchor="middle" x="42681.97" y="-1122" font-family="Arial" font-size="10.00">Expert 26 (TP8) L5</text>
<text text-anchor="middle" x="42681.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="42681.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_27_stage1 -->
<g id="node328" class="node">
<title>expert_5_27_stage1</title>
<polygon fill="lightblue" stroke="black" points="42592.47,-1134 42449.47,-1134 42449.47,-1093 42592.47,-1093 42592.47,-1134"/>
<text text-anchor="middle" x="42520.97" y="-1122" font-family="Arial" font-size="10.00">Expert 27 (TP8) L5</text>
<text text-anchor="middle" x="42520.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="42520.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_28_stage1 -->
<g id="node329" class="node">
<title>expert_5_28_stage1</title>
<polygon fill="lightblue" stroke="black" points="42431.47,-1134 42288.47,-1134 42288.47,-1093 42431.47,-1093 42431.47,-1134"/>
<text text-anchor="middle" x="42359.97" y="-1122" font-family="Arial" font-size="10.00">Expert 28 (TP8) L5</text>
<text text-anchor="middle" x="42359.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="42359.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_29_stage1 -->
<g id="node330" class="node">
<title>expert_5_29_stage1</title>
<polygon fill="lightblue" stroke="black" points="42270.47,-1134 42127.47,-1134 42127.47,-1093 42270.47,-1093 42270.47,-1134"/>
<text text-anchor="middle" x="42198.97" y="-1122" font-family="Arial" font-size="10.00">Expert 29 (TP8) L5</text>
<text text-anchor="middle" x="42198.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="42198.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_30_stage1 -->
<g id="node331" class="node">
<title>expert_5_30_stage1</title>
<polygon fill="lightblue" stroke="black" points="42109.47,-1134 41966.47,-1134 41966.47,-1093 42109.47,-1093 42109.47,-1134"/>
<text text-anchor="middle" x="42037.97" y="-1122" font-family="Arial" font-size="10.00">Expert 30 (TP8) L5</text>
<text text-anchor="middle" x="42037.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="42037.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_31_stage1 -->
<g id="node332" class="node">
<title>expert_5_31_stage1</title>
<polygon fill="lightblue" stroke="black" points="41948.47,-1134 41805.47,-1134 41805.47,-1093 41948.47,-1093 41948.47,-1134"/>
<text text-anchor="middle" x="41876.97" y="-1122" font-family="Arial" font-size="10.00">Expert 31 (TP8) L5</text>
<text text-anchor="middle" x="41876.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="41876.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_32_stage1 -->
<g id="node333" class="node">
<title>expert_5_32_stage1</title>
<polygon fill="lightblue" stroke="black" points="41787.47,-1134 41644.47,-1134 41644.47,-1093 41787.47,-1093 41787.47,-1134"/>
<text text-anchor="middle" x="41715.97" y="-1122" font-family="Arial" font-size="10.00">Expert 32 (TP8) L5</text>
<text text-anchor="middle" x="41715.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="41715.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_33_stage1 -->
<g id="node334" class="node">
<title>expert_5_33_stage1</title>
<polygon fill="lightblue" stroke="black" points="41626.47,-1134 41483.47,-1134 41483.47,-1093 41626.47,-1093 41626.47,-1134"/>
<text text-anchor="middle" x="41554.97" y="-1122" font-family="Arial" font-size="10.00">Expert 33 (TP8) L5</text>
<text text-anchor="middle" x="41554.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="41554.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_34_stage1 -->
<g id="node335" class="node">
<title>expert_5_34_stage1</title>
<polygon fill="lightblue" stroke="black" points="41465.47,-1134 41322.47,-1134 41322.47,-1093 41465.47,-1093 41465.47,-1134"/>
<text text-anchor="middle" x="41393.97" y="-1122" font-family="Arial" font-size="10.00">Expert 34 (TP8) L5</text>
<text text-anchor="middle" x="41393.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="41393.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_35_stage1 -->
<g id="node336" class="node">
<title>expert_5_35_stage1</title>
<polygon fill="lightblue" stroke="black" points="41304.47,-1134 41161.47,-1134 41161.47,-1093 41304.47,-1093 41304.47,-1134"/>
<text text-anchor="middle" x="41232.97" y="-1122" font-family="Arial" font-size="10.00">Expert 35 (TP8) L5</text>
<text text-anchor="middle" x="41232.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="41232.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_36_stage1 -->
<g id="node337" class="node">
<title>expert_5_36_stage1</title>
<polygon fill="lightblue" stroke="black" points="41143.47,-1134 41000.47,-1134 41000.47,-1093 41143.47,-1093 41143.47,-1134"/>
<text text-anchor="middle" x="41071.97" y="-1122" font-family="Arial" font-size="10.00">Expert 36 (TP8) L5</text>
<text text-anchor="middle" x="41071.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="41071.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_37_stage1 -->
<g id="node338" class="node">
<title>expert_5_37_stage1</title>
<polygon fill="lightblue" stroke="black" points="40982.47,-1134 40839.47,-1134 40839.47,-1093 40982.47,-1093 40982.47,-1134"/>
<text text-anchor="middle" x="40910.97" y="-1122" font-family="Arial" font-size="10.00">Expert 37 (TP8) L5</text>
<text text-anchor="middle" x="40910.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="40910.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_38_stage1 -->
<g id="node339" class="node">
<title>expert_5_38_stage1</title>
<polygon fill="lightblue" stroke="black" points="40821.47,-1134 40678.47,-1134 40678.47,-1093 40821.47,-1093 40821.47,-1134"/>
<text text-anchor="middle" x="40749.97" y="-1122" font-family="Arial" font-size="10.00">Expert 38 (TP8) L5</text>
<text text-anchor="middle" x="40749.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="40749.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_39_stage1 -->
<g id="node340" class="node">
<title>expert_5_39_stage1</title>
<polygon fill="lightblue" stroke="black" points="40660.47,-1134 40517.47,-1134 40517.47,-1093 40660.47,-1093 40660.47,-1134"/>
<text text-anchor="middle" x="40588.97" y="-1122" font-family="Arial" font-size="10.00">Expert 39 (TP8) L5</text>
<text text-anchor="middle" x="40588.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="40588.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_40_stage1 -->
<g id="node341" class="node">
<title>expert_5_40_stage1</title>
<polygon fill="lightblue" stroke="black" points="40499.47,-1134 40356.47,-1134 40356.47,-1093 40499.47,-1093 40499.47,-1134"/>
<text text-anchor="middle" x="40427.97" y="-1122" font-family="Arial" font-size="10.00">Expert 40 (TP8) L5</text>
<text text-anchor="middle" x="40427.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="40427.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_41_stage1 -->
<g id="node342" class="node">
<title>expert_5_41_stage1</title>
<polygon fill="lightblue" stroke="black" points="40338.47,-1134 40195.47,-1134 40195.47,-1093 40338.47,-1093 40338.47,-1134"/>
<text text-anchor="middle" x="40266.97" y="-1122" font-family="Arial" font-size="10.00">Expert 41 (TP8) L5</text>
<text text-anchor="middle" x="40266.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="40266.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_42_stage1 -->
<g id="node343" class="node">
<title>expert_5_42_stage1</title>
<polygon fill="lightblue" stroke="black" points="40177.47,-1134 40034.47,-1134 40034.47,-1093 40177.47,-1093 40177.47,-1134"/>
<text text-anchor="middle" x="40105.97" y="-1122" font-family="Arial" font-size="10.00">Expert 42 (TP8) L5</text>
<text text-anchor="middle" x="40105.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="40105.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_43_stage1 -->
<g id="node344" class="node">
<title>expert_5_43_stage1</title>
<polygon fill="lightblue" stroke="black" points="40016.47,-1134 39873.47,-1134 39873.47,-1093 40016.47,-1093 40016.47,-1134"/>
<text text-anchor="middle" x="39944.97" y="-1122" font-family="Arial" font-size="10.00">Expert 43 (TP8) L5</text>
<text text-anchor="middle" x="39944.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="39944.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_44_stage1 -->
<g id="node345" class="node">
<title>expert_5_44_stage1</title>
<polygon fill="lightblue" stroke="black" points="39855.47,-1134 39712.47,-1134 39712.47,-1093 39855.47,-1093 39855.47,-1134"/>
<text text-anchor="middle" x="39783.97" y="-1122" font-family="Arial" font-size="10.00">Expert 44 (TP8) L5</text>
<text text-anchor="middle" x="39783.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="39783.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_45_stage1 -->
<g id="node346" class="node">
<title>expert_5_45_stage1</title>
<polygon fill="lightblue" stroke="black" points="39694.47,-1134 39551.47,-1134 39551.47,-1093 39694.47,-1093 39694.47,-1134"/>
<text text-anchor="middle" x="39622.97" y="-1122" font-family="Arial" font-size="10.00">Expert 45 (TP8) L5</text>
<text text-anchor="middle" x="39622.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="39622.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_46_stage1 -->
<g id="node347" class="node">
<title>expert_5_46_stage1</title>
<polygon fill="lightblue" stroke="black" points="39533.47,-1134 39390.47,-1134 39390.47,-1093 39533.47,-1093 39533.47,-1134"/>
<text text-anchor="middle" x="39461.97" y="-1122" font-family="Arial" font-size="10.00">Expert 46 (TP8) L5</text>
<text text-anchor="middle" x="39461.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="39461.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_47_stage1 -->
<g id="node348" class="node">
<title>expert_5_47_stage1</title>
<polygon fill="lightblue" stroke="black" points="39372.47,-1134 39229.47,-1134 39229.47,-1093 39372.47,-1093 39372.47,-1134"/>
<text text-anchor="middle" x="39300.97" y="-1122" font-family="Arial" font-size="10.00">Expert 47 (TP8) L5</text>
<text text-anchor="middle" x="39300.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="39300.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_48_stage1 -->
<g id="node349" class="node">
<title>expert_5_48_stage1</title>
<polygon fill="lightblue" stroke="black" points="39211.47,-1134 39068.47,-1134 39068.47,-1093 39211.47,-1093 39211.47,-1134"/>
<text text-anchor="middle" x="39139.97" y="-1122" font-family="Arial" font-size="10.00">Expert 48 (TP8) L5</text>
<text text-anchor="middle" x="39139.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="39139.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_49_stage1 -->
<g id="node350" class="node">
<title>expert_5_49_stage1</title>
<polygon fill="lightblue" stroke="black" points="39050.47,-1134 38907.47,-1134 38907.47,-1093 39050.47,-1093 39050.47,-1134"/>
<text text-anchor="middle" x="38978.97" y="-1122" font-family="Arial" font-size="10.00">Expert 49 (TP8) L5</text>
<text text-anchor="middle" x="38978.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="38978.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_50_stage1 -->
<g id="node351" class="node">
<title>expert_5_50_stage1</title>
<polygon fill="lightblue" stroke="black" points="38889.47,-1134 38746.47,-1134 38746.47,-1093 38889.47,-1093 38889.47,-1134"/>
<text text-anchor="middle" x="38817.97" y="-1122" font-family="Arial" font-size="10.00">Expert 50 (TP8) L5</text>
<text text-anchor="middle" x="38817.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="38817.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_51_stage1 -->
<g id="node352" class="node">
<title>expert_5_51_stage1</title>
<polygon fill="lightblue" stroke="black" points="38728.47,-1134 38585.47,-1134 38585.47,-1093 38728.47,-1093 38728.47,-1134"/>
<text text-anchor="middle" x="38656.97" y="-1122" font-family="Arial" font-size="10.00">Expert 51 (TP8) L5</text>
<text text-anchor="middle" x="38656.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="38656.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_52_stage1 -->
<g id="node353" class="node">
<title>expert_5_52_stage1</title>
<polygon fill="lightblue" stroke="black" points="38567.47,-1134 38424.47,-1134 38424.47,-1093 38567.47,-1093 38567.47,-1134"/>
<text text-anchor="middle" x="38495.97" y="-1122" font-family="Arial" font-size="10.00">Expert 52 (TP8) L5</text>
<text text-anchor="middle" x="38495.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="38495.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_53_stage1 -->
<g id="node354" class="node">
<title>expert_5_53_stage1</title>
<polygon fill="lightblue" stroke="black" points="38406.47,-1134 38263.47,-1134 38263.47,-1093 38406.47,-1093 38406.47,-1134"/>
<text text-anchor="middle" x="38334.97" y="-1122" font-family="Arial" font-size="10.00">Expert 53 (TP8) L5</text>
<text text-anchor="middle" x="38334.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="38334.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_54_stage1 -->
<g id="node355" class="node">
<title>expert_5_54_stage1</title>
<polygon fill="lightblue" stroke="black" points="38245.47,-1134 38102.47,-1134 38102.47,-1093 38245.47,-1093 38245.47,-1134"/>
<text text-anchor="middle" x="38173.97" y="-1122" font-family="Arial" font-size="10.00">Expert 54 (TP8) L5</text>
<text text-anchor="middle" x="38173.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="38173.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_55_stage1 -->
<g id="node356" class="node">
<title>expert_5_55_stage1</title>
<polygon fill="lightblue" stroke="black" points="38084.47,-1134 37941.47,-1134 37941.47,-1093 38084.47,-1093 38084.47,-1134"/>
<text text-anchor="middle" x="38012.97" y="-1122" font-family="Arial" font-size="10.00">Expert 55 (TP8) L5</text>
<text text-anchor="middle" x="38012.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="38012.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_56_stage1 -->
<g id="node357" class="node">
<title>expert_5_56_stage1</title>
<polygon fill="lightblue" stroke="black" points="37923.47,-1134 37780.47,-1134 37780.47,-1093 37923.47,-1093 37923.47,-1134"/>
<text text-anchor="middle" x="37851.97" y="-1122" font-family="Arial" font-size="10.00">Expert 56 (TP8) L5</text>
<text text-anchor="middle" x="37851.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="37851.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_57_stage1 -->
<g id="node358" class="node">
<title>expert_5_57_stage1</title>
<polygon fill="lightblue" stroke="black" points="37762.47,-1134 37619.47,-1134 37619.47,-1093 37762.47,-1093 37762.47,-1134"/>
<text text-anchor="middle" x="37690.97" y="-1122" font-family="Arial" font-size="10.00">Expert 57 (TP8) L5</text>
<text text-anchor="middle" x="37690.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="37690.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_58_stage1 -->
<g id="node359" class="node">
<title>expert_5_58_stage1</title>
<polygon fill="lightblue" stroke="black" points="37601.47,-1134 37458.47,-1134 37458.47,-1093 37601.47,-1093 37601.47,-1134"/>
<text text-anchor="middle" x="37529.97" y="-1122" font-family="Arial" font-size="10.00">Expert 58 (TP8) L5</text>
<text text-anchor="middle" x="37529.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="37529.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_59_stage1 -->
<g id="node360" class="node">
<title>expert_5_59_stage1</title>
<polygon fill="lightblue" stroke="black" points="37440.47,-1134 37297.47,-1134 37297.47,-1093 37440.47,-1093 37440.47,-1134"/>
<text text-anchor="middle" x="37368.97" y="-1122" font-family="Arial" font-size="10.00">Expert 59 (TP8) L5</text>
<text text-anchor="middle" x="37368.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="37368.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_60_stage1 -->
<g id="node361" class="node">
<title>expert_5_60_stage1</title>
<polygon fill="lightblue" stroke="black" points="37279.47,-1134 37136.47,-1134 37136.47,-1093 37279.47,-1093 37279.47,-1134"/>
<text text-anchor="middle" x="37207.97" y="-1122" font-family="Arial" font-size="10.00">Expert 60 (TP8) L5</text>
<text text-anchor="middle" x="37207.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="37207.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_61_stage1 -->
<g id="node362" class="node">
<title>expert_5_61_stage1</title>
<polygon fill="lightblue" stroke="black" points="37118.47,-1134 36975.47,-1134 36975.47,-1093 37118.47,-1093 37118.47,-1134"/>
<text text-anchor="middle" x="37046.97" y="-1122" font-family="Arial" font-size="10.00">Expert 61 (TP8) L5</text>
<text text-anchor="middle" x="37046.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="37046.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_62_stage1 -->
<g id="node363" class="node">
<title>expert_5_62_stage1</title>
<polygon fill="lightblue" stroke="black" points="36957.47,-1134 36814.47,-1134 36814.47,-1093 36957.47,-1093 36957.47,-1134"/>
<text text-anchor="middle" x="36885.97" y="-1122" font-family="Arial" font-size="10.00">Expert 62 (TP8) L5</text>
<text text-anchor="middle" x="36885.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="36885.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_5_63_stage1 -->
<g id="node364" class="node">
<title>expert_5_63_stage1</title>
<polygon fill="lightblue" stroke="black" points="36796.47,-1134 36653.47,-1134 36653.47,-1093 36796.47,-1093 36796.47,-1134"/>
<text text-anchor="middle" x="36724.97" y="-1122" font-family="Arial" font-size="10.00">Expert 63 (TP8) L5</text>
<text text-anchor="middle" x="36724.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="36724.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_5_stage1 -->
<g id="node365" class="node">
<title>combine_5_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="36531.97" cy="-1113.5" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="36531.97" y="-1122" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L5</text>
<text text-anchor="middle" x="36531.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="36531.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_5_stage1 -->
<g id="node366" class="node">
<title>moe_out_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="36410.97,-1134 36270.97,-1134 36270.97,-1093 36410.97,-1093 36410.97,-1134"/>
<text text-anchor="middle" x="36340.97" y="-1122" font-family="Arial" font-size="10.00">MoE Output (TP8) L5</text>
<text text-anchor="middle" x="36340.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="36340.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_5_stage1 -->
<g id="node367" class="node">
<title>ln2_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="36252.97,-1134 36112.97,-1134 36112.97,-1093 36252.97,-1093 36252.97,-1134"/>
<text text-anchor="middle" x="36182.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L5</text>
<text text-anchor="middle" x="36182.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="36182.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_6_stage1 -->
<g id="node368" class="node">
<title>ln1_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="36094.97,-1134 35954.97,-1134 35954.97,-1093 36094.97,-1093 36094.97,-1134"/>
<text text-anchor="middle" x="36024.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L6</text>
<text text-anchor="middle" x="36024.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="36024.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_6_stage1 -->
<g id="node369" class="node">
<title>qkv_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="35936.97,-1134 35790.97,-1134 35790.97,-1093 35936.97,-1093 35936.97,-1134"/>
<text text-anchor="middle" x="35863.97" y="-1122" font-family="Arial" font-size="10.00">QKV Projection (TP8) L6</text>
<text text-anchor="middle" x="35863.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="35863.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_6_stage1 -->
<g id="node370" class="node">
<title>attn_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="35772.97,-1134 35626.97,-1134 35626.97,-1093 35772.97,-1093 35772.97,-1134"/>
<text text-anchor="middle" x="35699.97" y="-1122" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L6</text>
<text text-anchor="middle" x="35699.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="35699.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_6_stage1 -->
<g id="node371" class="node">
<title>attn_out_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="35608.97,-1134 35468.97,-1134 35468.97,-1093 35608.97,-1093 35608.97,-1134"/>
<text text-anchor="middle" x="35538.97" y="-1122" font-family="Arial" font-size="10.00">Attention Output (TP8) L6</text>
<text text-anchor="middle" x="35538.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="35538.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_6_stage1 -->
<g id="node372" class="node">
<title>route_6_stage1</title>
<polygon fill="lightcoral" stroke="black" points="35451.27,-1154.5 35220.14,-1154.5 35160.68,-1072.5 35391.81,-1072.5 35451.27,-1154.5"/>
<text text-anchor="middle" x="35305.97" y="-1122" font-family="Arial" font-size="10.00">MoE Routing (EP64) L6</text>
<text text-anchor="middle" x="35305.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="35305.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_6_stage1 -->
<g id="node373" class="node">
<title>dispatch_6_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="35033.97" cy="-1113.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="35033.97" y="-1122" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L6</text>
<text text-anchor="middle" x="35033.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="35033.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_6_0_stage1 -->
<g id="node374" class="node">
<title>expert_6_0_stage1</title>
<polygon fill="lightblue" stroke="black" points="34907.47,-1134 34764.47,-1134 34764.47,-1093 34907.47,-1093 34907.47,-1134"/>
<text text-anchor="middle" x="34835.97" y="-1122" font-family="Arial" font-size="10.00">Expert 0 (TP8) L6</text>
<text text-anchor="middle" x="34835.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="34835.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_1_stage1 -->
<g id="node375" class="node">
<title>expert_6_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="34746.47,-1134 34603.47,-1134 34603.47,-1093 34746.47,-1093 34746.47,-1134"/>
<text text-anchor="middle" x="34674.97" y="-1122" font-family="Arial" font-size="10.00">Expert 1 (TP8) L6</text>
<text text-anchor="middle" x="34674.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="34674.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_2_stage1 -->
<g id="node376" class="node">
<title>expert_6_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="34585.47,-1134 34442.47,-1134 34442.47,-1093 34585.47,-1093 34585.47,-1134"/>
<text text-anchor="middle" x="34513.97" y="-1122" font-family="Arial" font-size="10.00">Expert 2 (TP8) L6</text>
<text text-anchor="middle" x="34513.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="34513.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_3_stage1 -->
<g id="node377" class="node">
<title>expert_6_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="34424.47,-1134 34281.47,-1134 34281.47,-1093 34424.47,-1093 34424.47,-1134"/>
<text text-anchor="middle" x="34352.97" y="-1122" font-family="Arial" font-size="10.00">Expert 3 (TP8) L6</text>
<text text-anchor="middle" x="34352.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="34352.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_4_stage1 -->
<g id="node378" class="node">
<title>expert_6_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="34263.47,-1134 34120.47,-1134 34120.47,-1093 34263.47,-1093 34263.47,-1134"/>
<text text-anchor="middle" x="34191.97" y="-1122" font-family="Arial" font-size="10.00">Expert 4 (TP8) L6</text>
<text text-anchor="middle" x="34191.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="34191.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_5_stage1 -->
<g id="node379" class="node">
<title>expert_6_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="34102.47,-1134 33959.47,-1134 33959.47,-1093 34102.47,-1093 34102.47,-1134"/>
<text text-anchor="middle" x="34030.97" y="-1122" font-family="Arial" font-size="10.00">Expert 5 (TP8) L6</text>
<text text-anchor="middle" x="34030.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="34030.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_6_stage1 -->
<g id="node380" class="node">
<title>expert_6_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="33941.47,-1134 33798.47,-1134 33798.47,-1093 33941.47,-1093 33941.47,-1134"/>
<text text-anchor="middle" x="33869.97" y="-1122" font-family="Arial" font-size="10.00">Expert 6 (TP8) L6</text>
<text text-anchor="middle" x="33869.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="33869.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_7_stage1 -->
<g id="node381" class="node">
<title>expert_6_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="33780.47,-1134 33637.47,-1134 33637.47,-1093 33780.47,-1093 33780.47,-1134"/>
<text text-anchor="middle" x="33708.97" y="-1122" font-family="Arial" font-size="10.00">Expert 7 (TP8) L6</text>
<text text-anchor="middle" x="33708.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="33708.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_8_stage1 -->
<g id="node382" class="node">
<title>expert_6_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="33619.47,-1134 33476.47,-1134 33476.47,-1093 33619.47,-1093 33619.47,-1134"/>
<text text-anchor="middle" x="33547.97" y="-1122" font-family="Arial" font-size="10.00">Expert 8 (TP8) L6</text>
<text text-anchor="middle" x="33547.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="33547.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_9_stage1 -->
<g id="node383" class="node">
<title>expert_6_9_stage1</title>
<polygon fill="lightblue" stroke="black" points="33458.47,-1134 33315.47,-1134 33315.47,-1093 33458.47,-1093 33458.47,-1134"/>
<text text-anchor="middle" x="33386.97" y="-1122" font-family="Arial" font-size="10.00">Expert 9 (TP8) L6</text>
<text text-anchor="middle" x="33386.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="33386.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_10_stage1 -->
<g id="node384" class="node">
<title>expert_6_10_stage1</title>
<polygon fill="lightblue" stroke="black" points="33297.47,-1134 33154.47,-1134 33154.47,-1093 33297.47,-1093 33297.47,-1134"/>
<text text-anchor="middle" x="33225.97" y="-1122" font-family="Arial" font-size="10.00">Expert 10 (TP8) L6</text>
<text text-anchor="middle" x="33225.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="33225.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_11_stage1 -->
<g id="node385" class="node">
<title>expert_6_11_stage1</title>
<polygon fill="lightblue" stroke="black" points="33136.47,-1134 32993.47,-1134 32993.47,-1093 33136.47,-1093 33136.47,-1134"/>
<text text-anchor="middle" x="33064.97" y="-1122" font-family="Arial" font-size="10.00">Expert 11 (TP8) L6</text>
<text text-anchor="middle" x="33064.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="33064.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_12_stage1 -->
<g id="node386" class="node">
<title>expert_6_12_stage1</title>
<polygon fill="lightblue" stroke="black" points="32975.47,-1134 32832.47,-1134 32832.47,-1093 32975.47,-1093 32975.47,-1134"/>
<text text-anchor="middle" x="32903.97" y="-1122" font-family="Arial" font-size="10.00">Expert 12 (TP8) L6</text>
<text text-anchor="middle" x="32903.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="32903.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_13_stage1 -->
<g id="node387" class="node">
<title>expert_6_13_stage1</title>
<polygon fill="lightblue" stroke="black" points="32814.47,-1134 32671.47,-1134 32671.47,-1093 32814.47,-1093 32814.47,-1134"/>
<text text-anchor="middle" x="32742.97" y="-1122" font-family="Arial" font-size="10.00">Expert 13 (TP8) L6</text>
<text text-anchor="middle" x="32742.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="32742.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_14_stage1 -->
<g id="node388" class="node">
<title>expert_6_14_stage1</title>
<polygon fill="lightblue" stroke="black" points="32653.47,-1134 32510.47,-1134 32510.47,-1093 32653.47,-1093 32653.47,-1134"/>
<text text-anchor="middle" x="32581.97" y="-1122" font-family="Arial" font-size="10.00">Expert 14 (TP8) L6</text>
<text text-anchor="middle" x="32581.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="32581.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_15_stage1 -->
<g id="node389" class="node">
<title>expert_6_15_stage1</title>
<polygon fill="lightblue" stroke="black" points="32492.47,-1134 32349.47,-1134 32349.47,-1093 32492.47,-1093 32492.47,-1134"/>
<text text-anchor="middle" x="32420.97" y="-1122" font-family="Arial" font-size="10.00">Expert 15 (TP8) L6</text>
<text text-anchor="middle" x="32420.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="32420.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_16_stage1 -->
<g id="node390" class="node">
<title>expert_6_16_stage1</title>
<polygon fill="lightblue" stroke="black" points="32331.47,-1134 32188.47,-1134 32188.47,-1093 32331.47,-1093 32331.47,-1134"/>
<text text-anchor="middle" x="32259.97" y="-1122" font-family="Arial" font-size="10.00">Expert 16 (TP8) L6</text>
<text text-anchor="middle" x="32259.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="32259.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_17_stage1 -->
<g id="node391" class="node">
<title>expert_6_17_stage1</title>
<polygon fill="lightblue" stroke="black" points="32170.47,-1134 32027.47,-1134 32027.47,-1093 32170.47,-1093 32170.47,-1134"/>
<text text-anchor="middle" x="32098.97" y="-1122" font-family="Arial" font-size="10.00">Expert 17 (TP8) L6</text>
<text text-anchor="middle" x="32098.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="32098.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_18_stage1 -->
<g id="node392" class="node">
<title>expert_6_18_stage1</title>
<polygon fill="lightblue" stroke="black" points="32009.47,-1134 31866.47,-1134 31866.47,-1093 32009.47,-1093 32009.47,-1134"/>
<text text-anchor="middle" x="31937.97" y="-1122" font-family="Arial" font-size="10.00">Expert 18 (TP8) L6</text>
<text text-anchor="middle" x="31937.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="31937.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_19_stage1 -->
<g id="node393" class="node">
<title>expert_6_19_stage1</title>
<polygon fill="lightblue" stroke="black" points="31848.47,-1134 31705.47,-1134 31705.47,-1093 31848.47,-1093 31848.47,-1134"/>
<text text-anchor="middle" x="31776.97" y="-1122" font-family="Arial" font-size="10.00">Expert 19 (TP8) L6</text>
<text text-anchor="middle" x="31776.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="31776.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_20_stage1 -->
<g id="node394" class="node">
<title>expert_6_20_stage1</title>
<polygon fill="lightblue" stroke="black" points="31687.47,-1134 31544.47,-1134 31544.47,-1093 31687.47,-1093 31687.47,-1134"/>
<text text-anchor="middle" x="31615.97" y="-1122" font-family="Arial" font-size="10.00">Expert 20 (TP8) L6</text>
<text text-anchor="middle" x="31615.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="31615.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_21_stage1 -->
<g id="node395" class="node">
<title>expert_6_21_stage1</title>
<polygon fill="lightblue" stroke="black" points="31526.47,-1134 31383.47,-1134 31383.47,-1093 31526.47,-1093 31526.47,-1134"/>
<text text-anchor="middle" x="31454.97" y="-1122" font-family="Arial" font-size="10.00">Expert 21 (TP8) L6</text>
<text text-anchor="middle" x="31454.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="31454.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_22_stage1 -->
<g id="node396" class="node">
<title>expert_6_22_stage1</title>
<polygon fill="lightblue" stroke="black" points="31365.47,-1134 31222.47,-1134 31222.47,-1093 31365.47,-1093 31365.47,-1134"/>
<text text-anchor="middle" x="31293.97" y="-1122" font-family="Arial" font-size="10.00">Expert 22 (TP8) L6</text>
<text text-anchor="middle" x="31293.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="31293.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_23_stage1 -->
<g id="node397" class="node">
<title>expert_6_23_stage1</title>
<polygon fill="lightblue" stroke="black" points="31204.47,-1134 31061.47,-1134 31061.47,-1093 31204.47,-1093 31204.47,-1134"/>
<text text-anchor="middle" x="31132.97" y="-1122" font-family="Arial" font-size="10.00">Expert 23 (TP8) L6</text>
<text text-anchor="middle" x="31132.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="31132.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_24_stage1 -->
<g id="node398" class="node">
<title>expert_6_24_stage1</title>
<polygon fill="lightblue" stroke="black" points="31043.47,-1134 30900.47,-1134 30900.47,-1093 31043.47,-1093 31043.47,-1134"/>
<text text-anchor="middle" x="30971.97" y="-1122" font-family="Arial" font-size="10.00">Expert 24 (TP8) L6</text>
<text text-anchor="middle" x="30971.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="30971.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_25_stage1 -->
<g id="node399" class="node">
<title>expert_6_25_stage1</title>
<polygon fill="lightblue" stroke="black" points="30882.47,-1134 30739.47,-1134 30739.47,-1093 30882.47,-1093 30882.47,-1134"/>
<text text-anchor="middle" x="30810.97" y="-1122" font-family="Arial" font-size="10.00">Expert 25 (TP8) L6</text>
<text text-anchor="middle" x="30810.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="30810.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_26_stage1 -->
<g id="node400" class="node">
<title>expert_6_26_stage1</title>
<polygon fill="lightblue" stroke="black" points="30721.47,-1134 30578.47,-1134 30578.47,-1093 30721.47,-1093 30721.47,-1134"/>
<text text-anchor="middle" x="30649.97" y="-1122" font-family="Arial" font-size="10.00">Expert 26 (TP8) L6</text>
<text text-anchor="middle" x="30649.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="30649.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_27_stage1 -->
<g id="node401" class="node">
<title>expert_6_27_stage1</title>
<polygon fill="lightblue" stroke="black" points="30560.47,-1134 30417.47,-1134 30417.47,-1093 30560.47,-1093 30560.47,-1134"/>
<text text-anchor="middle" x="30488.97" y="-1122" font-family="Arial" font-size="10.00">Expert 27 (TP8) L6</text>
<text text-anchor="middle" x="30488.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="30488.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_28_stage1 -->
<g id="node402" class="node">
<title>expert_6_28_stage1</title>
<polygon fill="lightblue" stroke="black" points="30399.47,-1134 30256.47,-1134 30256.47,-1093 30399.47,-1093 30399.47,-1134"/>
<text text-anchor="middle" x="30327.97" y="-1122" font-family="Arial" font-size="10.00">Expert 28 (TP8) L6</text>
<text text-anchor="middle" x="30327.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="30327.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_29_stage1 -->
<g id="node403" class="node">
<title>expert_6_29_stage1</title>
<polygon fill="lightblue" stroke="black" points="30238.47,-1134 30095.47,-1134 30095.47,-1093 30238.47,-1093 30238.47,-1134"/>
<text text-anchor="middle" x="30166.97" y="-1122" font-family="Arial" font-size="10.00">Expert 29 (TP8) L6</text>
<text text-anchor="middle" x="30166.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="30166.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_30_stage1 -->
<g id="node404" class="node">
<title>expert_6_30_stage1</title>
<polygon fill="lightblue" stroke="black" points="30077.47,-1134 29934.47,-1134 29934.47,-1093 30077.47,-1093 30077.47,-1134"/>
<text text-anchor="middle" x="30005.97" y="-1122" font-family="Arial" font-size="10.00">Expert 30 (TP8) L6</text>
<text text-anchor="middle" x="30005.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="30005.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_31_stage1 -->
<g id="node405" class="node">
<title>expert_6_31_stage1</title>
<polygon fill="lightblue" stroke="black" points="29916.47,-1134 29773.47,-1134 29773.47,-1093 29916.47,-1093 29916.47,-1134"/>
<text text-anchor="middle" x="29844.97" y="-1122" font-family="Arial" font-size="10.00">Expert 31 (TP8) L6</text>
<text text-anchor="middle" x="29844.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="29844.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_32_stage1 -->
<g id="node406" class="node">
<title>expert_6_32_stage1</title>
<polygon fill="lightblue" stroke="black" points="29755.47,-1134 29612.47,-1134 29612.47,-1093 29755.47,-1093 29755.47,-1134"/>
<text text-anchor="middle" x="29683.97" y="-1122" font-family="Arial" font-size="10.00">Expert 32 (TP8) L6</text>
<text text-anchor="middle" x="29683.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="29683.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_33_stage1 -->
<g id="node407" class="node">
<title>expert_6_33_stage1</title>
<polygon fill="lightblue" stroke="black" points="29594.47,-1134 29451.47,-1134 29451.47,-1093 29594.47,-1093 29594.47,-1134"/>
<text text-anchor="middle" x="29522.97" y="-1122" font-family="Arial" font-size="10.00">Expert 33 (TP8) L6</text>
<text text-anchor="middle" x="29522.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="29522.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_34_stage1 -->
<g id="node408" class="node">
<title>expert_6_34_stage1</title>
<polygon fill="lightblue" stroke="black" points="29433.47,-1134 29290.47,-1134 29290.47,-1093 29433.47,-1093 29433.47,-1134"/>
<text text-anchor="middle" x="29361.97" y="-1122" font-family="Arial" font-size="10.00">Expert 34 (TP8) L6</text>
<text text-anchor="middle" x="29361.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="29361.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_35_stage1 -->
<g id="node409" class="node">
<title>expert_6_35_stage1</title>
<polygon fill="lightblue" stroke="black" points="29272.47,-1134 29129.47,-1134 29129.47,-1093 29272.47,-1093 29272.47,-1134"/>
<text text-anchor="middle" x="29200.97" y="-1122" font-family="Arial" font-size="10.00">Expert 35 (TP8) L6</text>
<text text-anchor="middle" x="29200.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="29200.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_36_stage1 -->
<g id="node410" class="node">
<title>expert_6_36_stage1</title>
<polygon fill="lightblue" stroke="black" points="29111.47,-1134 28968.47,-1134 28968.47,-1093 29111.47,-1093 29111.47,-1134"/>
<text text-anchor="middle" x="29039.97" y="-1122" font-family="Arial" font-size="10.00">Expert 36 (TP8) L6</text>
<text text-anchor="middle" x="29039.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="29039.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_37_stage1 -->
<g id="node411" class="node">
<title>expert_6_37_stage1</title>
<polygon fill="lightblue" stroke="black" points="28950.47,-1134 28807.47,-1134 28807.47,-1093 28950.47,-1093 28950.47,-1134"/>
<text text-anchor="middle" x="28878.97" y="-1122" font-family="Arial" font-size="10.00">Expert 37 (TP8) L6</text>
<text text-anchor="middle" x="28878.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="28878.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_38_stage1 -->
<g id="node412" class="node">
<title>expert_6_38_stage1</title>
<polygon fill="lightblue" stroke="black" points="28789.47,-1134 28646.47,-1134 28646.47,-1093 28789.47,-1093 28789.47,-1134"/>
<text text-anchor="middle" x="28717.97" y="-1122" font-family="Arial" font-size="10.00">Expert 38 (TP8) L6</text>
<text text-anchor="middle" x="28717.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="28717.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_39_stage1 -->
<g id="node413" class="node">
<title>expert_6_39_stage1</title>
<polygon fill="lightblue" stroke="black" points="28628.47,-1134 28485.47,-1134 28485.47,-1093 28628.47,-1093 28628.47,-1134"/>
<text text-anchor="middle" x="28556.97" y="-1122" font-family="Arial" font-size="10.00">Expert 39 (TP8) L6</text>
<text text-anchor="middle" x="28556.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="28556.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_40_stage1 -->
<g id="node414" class="node">
<title>expert_6_40_stage1</title>
<polygon fill="lightblue" stroke="black" points="28467.47,-1134 28324.47,-1134 28324.47,-1093 28467.47,-1093 28467.47,-1134"/>
<text text-anchor="middle" x="28395.97" y="-1122" font-family="Arial" font-size="10.00">Expert 40 (TP8) L6</text>
<text text-anchor="middle" x="28395.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="28395.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_41_stage1 -->
<g id="node415" class="node">
<title>expert_6_41_stage1</title>
<polygon fill="lightblue" stroke="black" points="28306.47,-1134 28163.47,-1134 28163.47,-1093 28306.47,-1093 28306.47,-1134"/>
<text text-anchor="middle" x="28234.97" y="-1122" font-family="Arial" font-size="10.00">Expert 41 (TP8) L6</text>
<text text-anchor="middle" x="28234.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="28234.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_42_stage1 -->
<g id="node416" class="node">
<title>expert_6_42_stage1</title>
<polygon fill="lightblue" stroke="black" points="28145.47,-1134 28002.47,-1134 28002.47,-1093 28145.47,-1093 28145.47,-1134"/>
<text text-anchor="middle" x="28073.97" y="-1122" font-family="Arial" font-size="10.00">Expert 42 (TP8) L6</text>
<text text-anchor="middle" x="28073.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="28073.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_43_stage1 -->
<g id="node417" class="node">
<title>expert_6_43_stage1</title>
<polygon fill="lightblue" stroke="black" points="27984.47,-1134 27841.47,-1134 27841.47,-1093 27984.47,-1093 27984.47,-1134"/>
<text text-anchor="middle" x="27912.97" y="-1122" font-family="Arial" font-size="10.00">Expert 43 (TP8) L6</text>
<text text-anchor="middle" x="27912.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="27912.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_44_stage1 -->
<g id="node418" class="node">
<title>expert_6_44_stage1</title>
<polygon fill="lightblue" stroke="black" points="27823.47,-1134 27680.47,-1134 27680.47,-1093 27823.47,-1093 27823.47,-1134"/>
<text text-anchor="middle" x="27751.97" y="-1122" font-family="Arial" font-size="10.00">Expert 44 (TP8) L6</text>
<text text-anchor="middle" x="27751.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="27751.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_45_stage1 -->
<g id="node419" class="node">
<title>expert_6_45_stage1</title>
<polygon fill="lightblue" stroke="black" points="27662.47,-1134 27519.47,-1134 27519.47,-1093 27662.47,-1093 27662.47,-1134"/>
<text text-anchor="middle" x="27590.97" y="-1122" font-family="Arial" font-size="10.00">Expert 45 (TP8) L6</text>
<text text-anchor="middle" x="27590.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="27590.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_46_stage1 -->
<g id="node420" class="node">
<title>expert_6_46_stage1</title>
<polygon fill="lightblue" stroke="black" points="27501.47,-1134 27358.47,-1134 27358.47,-1093 27501.47,-1093 27501.47,-1134"/>
<text text-anchor="middle" x="27429.97" y="-1122" font-family="Arial" font-size="10.00">Expert 46 (TP8) L6</text>
<text text-anchor="middle" x="27429.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="27429.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_47_stage1 -->
<g id="node421" class="node">
<title>expert_6_47_stage1</title>
<polygon fill="lightblue" stroke="black" points="27340.47,-1134 27197.47,-1134 27197.47,-1093 27340.47,-1093 27340.47,-1134"/>
<text text-anchor="middle" x="27268.97" y="-1122" font-family="Arial" font-size="10.00">Expert 47 (TP8) L6</text>
<text text-anchor="middle" x="27268.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="27268.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_48_stage1 -->
<g id="node422" class="node">
<title>expert_6_48_stage1</title>
<polygon fill="lightblue" stroke="black" points="27179.47,-1134 27036.47,-1134 27036.47,-1093 27179.47,-1093 27179.47,-1134"/>
<text text-anchor="middle" x="27107.97" y="-1122" font-family="Arial" font-size="10.00">Expert 48 (TP8) L6</text>
<text text-anchor="middle" x="27107.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="27107.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_49_stage1 -->
<g id="node423" class="node">
<title>expert_6_49_stage1</title>
<polygon fill="lightblue" stroke="black" points="27018.47,-1134 26875.47,-1134 26875.47,-1093 27018.47,-1093 27018.47,-1134"/>
<text text-anchor="middle" x="26946.97" y="-1122" font-family="Arial" font-size="10.00">Expert 49 (TP8) L6</text>
<text text-anchor="middle" x="26946.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="26946.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_50_stage1 -->
<g id="node424" class="node">
<title>expert_6_50_stage1</title>
<polygon fill="lightblue" stroke="black" points="26857.47,-1134 26714.47,-1134 26714.47,-1093 26857.47,-1093 26857.47,-1134"/>
<text text-anchor="middle" x="26785.97" y="-1122" font-family="Arial" font-size="10.00">Expert 50 (TP8) L6</text>
<text text-anchor="middle" x="26785.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="26785.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_51_stage1 -->
<g id="node425" class="node">
<title>expert_6_51_stage1</title>
<polygon fill="lightblue" stroke="black" points="26696.47,-1134 26553.47,-1134 26553.47,-1093 26696.47,-1093 26696.47,-1134"/>
<text text-anchor="middle" x="26624.97" y="-1122" font-family="Arial" font-size="10.00">Expert 51 (TP8) L6</text>
<text text-anchor="middle" x="26624.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="26624.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_52_stage1 -->
<g id="node426" class="node">
<title>expert_6_52_stage1</title>
<polygon fill="lightblue" stroke="black" points="26535.47,-1134 26392.47,-1134 26392.47,-1093 26535.47,-1093 26535.47,-1134"/>
<text text-anchor="middle" x="26463.97" y="-1122" font-family="Arial" font-size="10.00">Expert 52 (TP8) L6</text>
<text text-anchor="middle" x="26463.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="26463.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_53_stage1 -->
<g id="node427" class="node">
<title>expert_6_53_stage1</title>
<polygon fill="lightblue" stroke="black" points="26374.47,-1134 26231.47,-1134 26231.47,-1093 26374.47,-1093 26374.47,-1134"/>
<text text-anchor="middle" x="26302.97" y="-1122" font-family="Arial" font-size="10.00">Expert 53 (TP8) L6</text>
<text text-anchor="middle" x="26302.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="26302.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_54_stage1 -->
<g id="node428" class="node">
<title>expert_6_54_stage1</title>
<polygon fill="lightblue" stroke="black" points="26213.47,-1134 26070.47,-1134 26070.47,-1093 26213.47,-1093 26213.47,-1134"/>
<text text-anchor="middle" x="26141.97" y="-1122" font-family="Arial" font-size="10.00">Expert 54 (TP8) L6</text>
<text text-anchor="middle" x="26141.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="26141.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_55_stage1 -->
<g id="node429" class="node">
<title>expert_6_55_stage1</title>
<polygon fill="lightblue" stroke="black" points="26052.47,-1134 25909.47,-1134 25909.47,-1093 26052.47,-1093 26052.47,-1134"/>
<text text-anchor="middle" x="25980.97" y="-1122" font-family="Arial" font-size="10.00">Expert 55 (TP8) L6</text>
<text text-anchor="middle" x="25980.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="25980.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_56_stage1 -->
<g id="node430" class="node">
<title>expert_6_56_stage1</title>
<polygon fill="lightblue" stroke="black" points="25891.47,-1134 25748.47,-1134 25748.47,-1093 25891.47,-1093 25891.47,-1134"/>
<text text-anchor="middle" x="25819.97" y="-1122" font-family="Arial" font-size="10.00">Expert 56 (TP8) L6</text>
<text text-anchor="middle" x="25819.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="25819.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_57_stage1 -->
<g id="node431" class="node">
<title>expert_6_57_stage1</title>
<polygon fill="lightblue" stroke="black" points="25730.47,-1134 25587.47,-1134 25587.47,-1093 25730.47,-1093 25730.47,-1134"/>
<text text-anchor="middle" x="25658.97" y="-1122" font-family="Arial" font-size="10.00">Expert 57 (TP8) L6</text>
<text text-anchor="middle" x="25658.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="25658.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_58_stage1 -->
<g id="node432" class="node">
<title>expert_6_58_stage1</title>
<polygon fill="lightblue" stroke="black" points="25569.47,-1134 25426.47,-1134 25426.47,-1093 25569.47,-1093 25569.47,-1134"/>
<text text-anchor="middle" x="25497.97" y="-1122" font-family="Arial" font-size="10.00">Expert 58 (TP8) L6</text>
<text text-anchor="middle" x="25497.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="25497.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_59_stage1 -->
<g id="node433" class="node">
<title>expert_6_59_stage1</title>
<polygon fill="lightblue" stroke="black" points="25408.47,-1134 25265.47,-1134 25265.47,-1093 25408.47,-1093 25408.47,-1134"/>
<text text-anchor="middle" x="25336.97" y="-1122" font-family="Arial" font-size="10.00">Expert 59 (TP8) L6</text>
<text text-anchor="middle" x="25336.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="25336.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_60_stage1 -->
<g id="node434" class="node">
<title>expert_6_60_stage1</title>
<polygon fill="lightblue" stroke="black" points="25247.47,-1134 25104.47,-1134 25104.47,-1093 25247.47,-1093 25247.47,-1134"/>
<text text-anchor="middle" x="25175.97" y="-1122" font-family="Arial" font-size="10.00">Expert 60 (TP8) L6</text>
<text text-anchor="middle" x="25175.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="25175.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_61_stage1 -->
<g id="node435" class="node">
<title>expert_6_61_stage1</title>
<polygon fill="lightblue" stroke="black" points="25086.47,-1134 24943.47,-1134 24943.47,-1093 25086.47,-1093 25086.47,-1134"/>
<text text-anchor="middle" x="25014.97" y="-1122" font-family="Arial" font-size="10.00">Expert 61 (TP8) L6</text>
<text text-anchor="middle" x="25014.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="25014.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_62_stage1 -->
<g id="node436" class="node">
<title>expert_6_62_stage1</title>
<polygon fill="lightblue" stroke="black" points="24925.47,-1134 24782.47,-1134 24782.47,-1093 24925.47,-1093 24925.47,-1134"/>
<text text-anchor="middle" x="24853.97" y="-1122" font-family="Arial" font-size="10.00">Expert 62 (TP8) L6</text>
<text text-anchor="middle" x="24853.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="24853.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_6_63_stage1 -->
<g id="node437" class="node">
<title>expert_6_63_stage1</title>
<polygon fill="lightblue" stroke="black" points="24764.47,-1134 24621.47,-1134 24621.47,-1093 24764.47,-1093 24764.47,-1134"/>
<text text-anchor="middle" x="24692.97" y="-1122" font-family="Arial" font-size="10.00">Expert 63 (TP8) L6</text>
<text text-anchor="middle" x="24692.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="24692.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_6_stage1 -->
<g id="node438" class="node">
<title>combine_6_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="24499.97" cy="-1113.5" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="24499.97" y="-1122" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L6</text>
<text text-anchor="middle" x="24499.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="24499.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_6_stage1 -->
<g id="node439" class="node">
<title>moe_out_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="24378.97,-1134 24238.97,-1134 24238.97,-1093 24378.97,-1093 24378.97,-1134"/>
<text text-anchor="middle" x="24308.97" y="-1122" font-family="Arial" font-size="10.00">MoE Output (TP8) L6</text>
<text text-anchor="middle" x="24308.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="24308.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_6_stage1 -->
<g id="node440" class="node">
<title>ln2_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="24220.97,-1134 24080.97,-1134 24080.97,-1093 24220.97,-1093 24220.97,-1134"/>
<text text-anchor="middle" x="24150.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L6</text>
<text text-anchor="middle" x="24150.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="24150.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_7_stage1 -->
<g id="node441" class="node">
<title>ln1_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="24062.97,-1134 23922.97,-1134 23922.97,-1093 24062.97,-1093 24062.97,-1134"/>
<text text-anchor="middle" x="23992.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L7</text>
<text text-anchor="middle" x="23992.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="23992.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_7_stage1 -->
<g id="node442" class="node">
<title>qkv_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="23904.97,-1134 23758.97,-1134 23758.97,-1093 23904.97,-1093 23904.97,-1134"/>
<text text-anchor="middle" x="23831.97" y="-1122" font-family="Arial" font-size="10.00">QKV Projection (TP8) L7</text>
<text text-anchor="middle" x="23831.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="23831.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_7_stage1 -->
<g id="node443" class="node">
<title>attn_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="23740.97,-1134 23594.97,-1134 23594.97,-1093 23740.97,-1093 23740.97,-1134"/>
<text text-anchor="middle" x="23667.97" y="-1122" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L7</text>
<text text-anchor="middle" x="23667.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="23667.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_7_stage1 -->
<g id="node444" class="node">
<title>attn_out_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="23576.97,-1134 23436.97,-1134 23436.97,-1093 23576.97,-1093 23576.97,-1134"/>
<text text-anchor="middle" x="23506.97" y="-1122" font-family="Arial" font-size="10.00">Attention Output (TP8) L7</text>
<text text-anchor="middle" x="23506.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="23506.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_7_stage1 -->
<g id="node445" class="node">
<title>route_7_stage1</title>
<polygon fill="lightcoral" stroke="black" points="23419.27,-1154.5 23188.14,-1154.5 23128.68,-1072.5 23359.81,-1072.5 23419.27,-1154.5"/>
<text text-anchor="middle" x="23273.97" y="-1122" font-family="Arial" font-size="10.00">MoE Routing (EP64) L7</text>
<text text-anchor="middle" x="23273.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="23273.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_7_stage1 -->
<g id="node446" class="node">
<title>dispatch_7_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="23001.97" cy="-1113.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="23001.97" y="-1122" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L7</text>
<text text-anchor="middle" x="23001.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="23001.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_7_0_stage1 -->
<g id="node447" class="node">
<title>expert_7_0_stage1</title>
<polygon fill="lightblue" stroke="black" points="22875.47,-1134 22732.47,-1134 22732.47,-1093 22875.47,-1093 22875.47,-1134"/>
<text text-anchor="middle" x="22803.97" y="-1122" font-family="Arial" font-size="10.00">Expert 0 (TP8) L7</text>
<text text-anchor="middle" x="22803.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="22803.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_1_stage1 -->
<g id="node448" class="node">
<title>expert_7_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="22714.47,-1134 22571.47,-1134 22571.47,-1093 22714.47,-1093 22714.47,-1134"/>
<text text-anchor="middle" x="22642.97" y="-1122" font-family="Arial" font-size="10.00">Expert 1 (TP8) L7</text>
<text text-anchor="middle" x="22642.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="22642.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_2_stage1 -->
<g id="node449" class="node">
<title>expert_7_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="22553.47,-1134 22410.47,-1134 22410.47,-1093 22553.47,-1093 22553.47,-1134"/>
<text text-anchor="middle" x="22481.97" y="-1122" font-family="Arial" font-size="10.00">Expert 2 (TP8) L7</text>
<text text-anchor="middle" x="22481.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="22481.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_3_stage1 -->
<g id="node450" class="node">
<title>expert_7_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="22392.47,-1134 22249.47,-1134 22249.47,-1093 22392.47,-1093 22392.47,-1134"/>
<text text-anchor="middle" x="22320.97" y="-1122" font-family="Arial" font-size="10.00">Expert 3 (TP8) L7</text>
<text text-anchor="middle" x="22320.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="22320.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_4_stage1 -->
<g id="node451" class="node">
<title>expert_7_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="22231.47,-1134 22088.47,-1134 22088.47,-1093 22231.47,-1093 22231.47,-1134"/>
<text text-anchor="middle" x="22159.97" y="-1122" font-family="Arial" font-size="10.00">Expert 4 (TP8) L7</text>
<text text-anchor="middle" x="22159.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="22159.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_5_stage1 -->
<g id="node452" class="node">
<title>expert_7_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="22070.47,-1134 21927.47,-1134 21927.47,-1093 22070.47,-1093 22070.47,-1134"/>
<text text-anchor="middle" x="21998.97" y="-1122" font-family="Arial" font-size="10.00">Expert 5 (TP8) L7</text>
<text text-anchor="middle" x="21998.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="21998.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_6_stage1 -->
<g id="node453" class="node">
<title>expert_7_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="21909.47,-1134 21766.47,-1134 21766.47,-1093 21909.47,-1093 21909.47,-1134"/>
<text text-anchor="middle" x="21837.97" y="-1122" font-family="Arial" font-size="10.00">Expert 6 (TP8) L7</text>
<text text-anchor="middle" x="21837.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="21837.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_7_stage1 -->
<g id="node454" class="node">
<title>expert_7_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="21748.47,-1134 21605.47,-1134 21605.47,-1093 21748.47,-1093 21748.47,-1134"/>
<text text-anchor="middle" x="21676.97" y="-1122" font-family="Arial" font-size="10.00">Expert 7 (TP8) L7</text>
<text text-anchor="middle" x="21676.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="21676.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_8_stage1 -->
<g id="node455" class="node">
<title>expert_7_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="21587.47,-1134 21444.47,-1134 21444.47,-1093 21587.47,-1093 21587.47,-1134"/>
<text text-anchor="middle" x="21515.97" y="-1122" font-family="Arial" font-size="10.00">Expert 8 (TP8) L7</text>
<text text-anchor="middle" x="21515.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="21515.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_9_stage1 -->
<g id="node456" class="node">
<title>expert_7_9_stage1</title>
<polygon fill="lightblue" stroke="black" points="21426.47,-1134 21283.47,-1134 21283.47,-1093 21426.47,-1093 21426.47,-1134"/>
<text text-anchor="middle" x="21354.97" y="-1122" font-family="Arial" font-size="10.00">Expert 9 (TP8) L7</text>
<text text-anchor="middle" x="21354.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="21354.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_10_stage1 -->
<g id="node457" class="node">
<title>expert_7_10_stage1</title>
<polygon fill="lightblue" stroke="black" points="21265.47,-1134 21122.47,-1134 21122.47,-1093 21265.47,-1093 21265.47,-1134"/>
<text text-anchor="middle" x="21193.97" y="-1122" font-family="Arial" font-size="10.00">Expert 10 (TP8) L7</text>
<text text-anchor="middle" x="21193.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="21193.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_11_stage1 -->
<g id="node458" class="node">
<title>expert_7_11_stage1</title>
<polygon fill="lightblue" stroke="black" points="21104.47,-1134 20961.47,-1134 20961.47,-1093 21104.47,-1093 21104.47,-1134"/>
<text text-anchor="middle" x="21032.97" y="-1122" font-family="Arial" font-size="10.00">Expert 11 (TP8) L7</text>
<text text-anchor="middle" x="21032.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="21032.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_12_stage1 -->
<g id="node459" class="node">
<title>expert_7_12_stage1</title>
<polygon fill="lightblue" stroke="black" points="20943.47,-1134 20800.47,-1134 20800.47,-1093 20943.47,-1093 20943.47,-1134"/>
<text text-anchor="middle" x="20871.97" y="-1122" font-family="Arial" font-size="10.00">Expert 12 (TP8) L7</text>
<text text-anchor="middle" x="20871.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="20871.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_13_stage1 -->
<g id="node460" class="node">
<title>expert_7_13_stage1</title>
<polygon fill="lightblue" stroke="black" points="20782.47,-1134 20639.47,-1134 20639.47,-1093 20782.47,-1093 20782.47,-1134"/>
<text text-anchor="middle" x="20710.97" y="-1122" font-family="Arial" font-size="10.00">Expert 13 (TP8) L7</text>
<text text-anchor="middle" x="20710.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="20710.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_14_stage1 -->
<g id="node461" class="node">
<title>expert_7_14_stage1</title>
<polygon fill="lightblue" stroke="black" points="20621.47,-1134 20478.47,-1134 20478.47,-1093 20621.47,-1093 20621.47,-1134"/>
<text text-anchor="middle" x="20549.97" y="-1122" font-family="Arial" font-size="10.00">Expert 14 (TP8) L7</text>
<text text-anchor="middle" x="20549.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="20549.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_15_stage1 -->
<g id="node462" class="node">
<title>expert_7_15_stage1</title>
<polygon fill="lightblue" stroke="black" points="20460.47,-1134 20317.47,-1134 20317.47,-1093 20460.47,-1093 20460.47,-1134"/>
<text text-anchor="middle" x="20388.97" y="-1122" font-family="Arial" font-size="10.00">Expert 15 (TP8) L7</text>
<text text-anchor="middle" x="20388.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="20388.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_16_stage1 -->
<g id="node463" class="node">
<title>expert_7_16_stage1</title>
<polygon fill="lightblue" stroke="black" points="20299.47,-1134 20156.47,-1134 20156.47,-1093 20299.47,-1093 20299.47,-1134"/>
<text text-anchor="middle" x="20227.97" y="-1122" font-family="Arial" font-size="10.00">Expert 16 (TP8) L7</text>
<text text-anchor="middle" x="20227.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="20227.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_17_stage1 -->
<g id="node464" class="node">
<title>expert_7_17_stage1</title>
<polygon fill="lightblue" stroke="black" points="20138.47,-1134 19995.47,-1134 19995.47,-1093 20138.47,-1093 20138.47,-1134"/>
<text text-anchor="middle" x="20066.97" y="-1122" font-family="Arial" font-size="10.00">Expert 17 (TP8) L7</text>
<text text-anchor="middle" x="20066.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="20066.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_18_stage1 -->
<g id="node465" class="node">
<title>expert_7_18_stage1</title>
<polygon fill="lightblue" stroke="black" points="19977.47,-1134 19834.47,-1134 19834.47,-1093 19977.47,-1093 19977.47,-1134"/>
<text text-anchor="middle" x="19905.97" y="-1122" font-family="Arial" font-size="10.00">Expert 18 (TP8) L7</text>
<text text-anchor="middle" x="19905.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="19905.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_19_stage1 -->
<g id="node466" class="node">
<title>expert_7_19_stage1</title>
<polygon fill="lightblue" stroke="black" points="19816.47,-1134 19673.47,-1134 19673.47,-1093 19816.47,-1093 19816.47,-1134"/>
<text text-anchor="middle" x="19744.97" y="-1122" font-family="Arial" font-size="10.00">Expert 19 (TP8) L7</text>
<text text-anchor="middle" x="19744.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="19744.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_20_stage1 -->
<g id="node467" class="node">
<title>expert_7_20_stage1</title>
<polygon fill="lightblue" stroke="black" points="19655.47,-1134 19512.47,-1134 19512.47,-1093 19655.47,-1093 19655.47,-1134"/>
<text text-anchor="middle" x="19583.97" y="-1122" font-family="Arial" font-size="10.00">Expert 20 (TP8) L7</text>
<text text-anchor="middle" x="19583.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="19583.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_21_stage1 -->
<g id="node468" class="node">
<title>expert_7_21_stage1</title>
<polygon fill="lightblue" stroke="black" points="19494.47,-1134 19351.47,-1134 19351.47,-1093 19494.47,-1093 19494.47,-1134"/>
<text text-anchor="middle" x="19422.97" y="-1122" font-family="Arial" font-size="10.00">Expert 21 (TP8) L7</text>
<text text-anchor="middle" x="19422.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="19422.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_22_stage1 -->
<g id="node469" class="node">
<title>expert_7_22_stage1</title>
<polygon fill="lightblue" stroke="black" points="19333.47,-1134 19190.47,-1134 19190.47,-1093 19333.47,-1093 19333.47,-1134"/>
<text text-anchor="middle" x="19261.97" y="-1122" font-family="Arial" font-size="10.00">Expert 22 (TP8) L7</text>
<text text-anchor="middle" x="19261.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="19261.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_23_stage1 -->
<g id="node470" class="node">
<title>expert_7_23_stage1</title>
<polygon fill="lightblue" stroke="black" points="19172.47,-1134 19029.47,-1134 19029.47,-1093 19172.47,-1093 19172.47,-1134"/>
<text text-anchor="middle" x="19100.97" y="-1122" font-family="Arial" font-size="10.00">Expert 23 (TP8) L7</text>
<text text-anchor="middle" x="19100.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="19100.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_24_stage1 -->
<g id="node471" class="node">
<title>expert_7_24_stage1</title>
<polygon fill="lightblue" stroke="black" points="19011.47,-1134 18868.47,-1134 18868.47,-1093 19011.47,-1093 19011.47,-1134"/>
<text text-anchor="middle" x="18939.97" y="-1122" font-family="Arial" font-size="10.00">Expert 24 (TP8) L7</text>
<text text-anchor="middle" x="18939.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="18939.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_25_stage1 -->
<g id="node472" class="node">
<title>expert_7_25_stage1</title>
<polygon fill="lightblue" stroke="black" points="18850.47,-1134 18707.47,-1134 18707.47,-1093 18850.47,-1093 18850.47,-1134"/>
<text text-anchor="middle" x="18778.97" y="-1122" font-family="Arial" font-size="10.00">Expert 25 (TP8) L7</text>
<text text-anchor="middle" x="18778.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="18778.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_26_stage1 -->
<g id="node473" class="node">
<title>expert_7_26_stage1</title>
<polygon fill="lightblue" stroke="black" points="18689.47,-1134 18546.47,-1134 18546.47,-1093 18689.47,-1093 18689.47,-1134"/>
<text text-anchor="middle" x="18617.97" y="-1122" font-family="Arial" font-size="10.00">Expert 26 (TP8) L7</text>
<text text-anchor="middle" x="18617.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="18617.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_27_stage1 -->
<g id="node474" class="node">
<title>expert_7_27_stage1</title>
<polygon fill="lightblue" stroke="black" points="18528.47,-1134 18385.47,-1134 18385.47,-1093 18528.47,-1093 18528.47,-1134"/>
<text text-anchor="middle" x="18456.97" y="-1122" font-family="Arial" font-size="10.00">Expert 27 (TP8) L7</text>
<text text-anchor="middle" x="18456.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="18456.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_28_stage1 -->
<g id="node475" class="node">
<title>expert_7_28_stage1</title>
<polygon fill="lightblue" stroke="black" points="18367.47,-1134 18224.47,-1134 18224.47,-1093 18367.47,-1093 18367.47,-1134"/>
<text text-anchor="middle" x="18295.97" y="-1122" font-family="Arial" font-size="10.00">Expert 28 (TP8) L7</text>
<text text-anchor="middle" x="18295.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="18295.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_29_stage1 -->
<g id="node476" class="node">
<title>expert_7_29_stage1</title>
<polygon fill="lightblue" stroke="black" points="18206.47,-1134 18063.47,-1134 18063.47,-1093 18206.47,-1093 18206.47,-1134"/>
<text text-anchor="middle" x="18134.97" y="-1122" font-family="Arial" font-size="10.00">Expert 29 (TP8) L7</text>
<text text-anchor="middle" x="18134.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="18134.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_30_stage1 -->
<g id="node477" class="node">
<title>expert_7_30_stage1</title>
<polygon fill="lightblue" stroke="black" points="18045.47,-1134 17902.47,-1134 17902.47,-1093 18045.47,-1093 18045.47,-1134"/>
<text text-anchor="middle" x="17973.97" y="-1122" font-family="Arial" font-size="10.00">Expert 30 (TP8) L7</text>
<text text-anchor="middle" x="17973.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="17973.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_31_stage1 -->
<g id="node478" class="node">
<title>expert_7_31_stage1</title>
<polygon fill="lightblue" stroke="black" points="17884.47,-1134 17741.47,-1134 17741.47,-1093 17884.47,-1093 17884.47,-1134"/>
<text text-anchor="middle" x="17812.97" y="-1122" font-family="Arial" font-size="10.00">Expert 31 (TP8) L7</text>
<text text-anchor="middle" x="17812.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="17812.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_32_stage1 -->
<g id="node479" class="node">
<title>expert_7_32_stage1</title>
<polygon fill="lightblue" stroke="black" points="17723.47,-1134 17580.47,-1134 17580.47,-1093 17723.47,-1093 17723.47,-1134"/>
<text text-anchor="middle" x="17651.97" y="-1122" font-family="Arial" font-size="10.00">Expert 32 (TP8) L7</text>
<text text-anchor="middle" x="17651.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="17651.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_33_stage1 -->
<g id="node480" class="node">
<title>expert_7_33_stage1</title>
<polygon fill="lightblue" stroke="black" points="17562.47,-1134 17419.47,-1134 17419.47,-1093 17562.47,-1093 17562.47,-1134"/>
<text text-anchor="middle" x="17490.97" y="-1122" font-family="Arial" font-size="10.00">Expert 33 (TP8) L7</text>
<text text-anchor="middle" x="17490.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="17490.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_34_stage1 -->
<g id="node481" class="node">
<title>expert_7_34_stage1</title>
<polygon fill="lightblue" stroke="black" points="17401.47,-1134 17258.47,-1134 17258.47,-1093 17401.47,-1093 17401.47,-1134"/>
<text text-anchor="middle" x="17329.97" y="-1122" font-family="Arial" font-size="10.00">Expert 34 (TP8) L7</text>
<text text-anchor="middle" x="17329.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="17329.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_35_stage1 -->
<g id="node482" class="node">
<title>expert_7_35_stage1</title>
<polygon fill="lightblue" stroke="black" points="17240.47,-1134 17097.47,-1134 17097.47,-1093 17240.47,-1093 17240.47,-1134"/>
<text text-anchor="middle" x="17168.97" y="-1122" font-family="Arial" font-size="10.00">Expert 35 (TP8) L7</text>
<text text-anchor="middle" x="17168.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="17168.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_36_stage1 -->
<g id="node483" class="node">
<title>expert_7_36_stage1</title>
<polygon fill="lightblue" stroke="black" points="17079.47,-1134 16936.47,-1134 16936.47,-1093 17079.47,-1093 17079.47,-1134"/>
<text text-anchor="middle" x="17007.97" y="-1122" font-family="Arial" font-size="10.00">Expert 36 (TP8) L7</text>
<text text-anchor="middle" x="17007.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="17007.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_37_stage1 -->
<g id="node484" class="node">
<title>expert_7_37_stage1</title>
<polygon fill="lightblue" stroke="black" points="16918.47,-1134 16775.47,-1134 16775.47,-1093 16918.47,-1093 16918.47,-1134"/>
<text text-anchor="middle" x="16846.97" y="-1122" font-family="Arial" font-size="10.00">Expert 37 (TP8) L7</text>
<text text-anchor="middle" x="16846.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="16846.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_38_stage1 -->
<g id="node485" class="node">
<title>expert_7_38_stage1</title>
<polygon fill="lightblue" stroke="black" points="16757.47,-1134 16614.47,-1134 16614.47,-1093 16757.47,-1093 16757.47,-1134"/>
<text text-anchor="middle" x="16685.97" y="-1122" font-family="Arial" font-size="10.00">Expert 38 (TP8) L7</text>
<text text-anchor="middle" x="16685.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="16685.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_39_stage1 -->
<g id="node486" class="node">
<title>expert_7_39_stage1</title>
<polygon fill="lightblue" stroke="black" points="16596.47,-1134 16453.47,-1134 16453.47,-1093 16596.47,-1093 16596.47,-1134"/>
<text text-anchor="middle" x="16524.97" y="-1122" font-family="Arial" font-size="10.00">Expert 39 (TP8) L7</text>
<text text-anchor="middle" x="16524.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="16524.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_40_stage1 -->
<g id="node487" class="node">
<title>expert_7_40_stage1</title>
<polygon fill="lightblue" stroke="black" points="16435.47,-1134 16292.47,-1134 16292.47,-1093 16435.47,-1093 16435.47,-1134"/>
<text text-anchor="middle" x="16363.97" y="-1122" font-family="Arial" font-size="10.00">Expert 40 (TP8) L7</text>
<text text-anchor="middle" x="16363.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="16363.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_41_stage1 -->
<g id="node488" class="node">
<title>expert_7_41_stage1</title>
<polygon fill="lightblue" stroke="black" points="16274.47,-1134 16131.47,-1134 16131.47,-1093 16274.47,-1093 16274.47,-1134"/>
<text text-anchor="middle" x="16202.97" y="-1122" font-family="Arial" font-size="10.00">Expert 41 (TP8) L7</text>
<text text-anchor="middle" x="16202.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="16202.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_42_stage1 -->
<g id="node489" class="node">
<title>expert_7_42_stage1</title>
<polygon fill="lightblue" stroke="black" points="16113.47,-1134 15970.47,-1134 15970.47,-1093 16113.47,-1093 16113.47,-1134"/>
<text text-anchor="middle" x="16041.97" y="-1122" font-family="Arial" font-size="10.00">Expert 42 (TP8) L7</text>
<text text-anchor="middle" x="16041.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="16041.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_43_stage1 -->
<g id="node490" class="node">
<title>expert_7_43_stage1</title>
<polygon fill="lightblue" stroke="black" points="15952.47,-1134 15809.47,-1134 15809.47,-1093 15952.47,-1093 15952.47,-1134"/>
<text text-anchor="middle" x="15880.97" y="-1122" font-family="Arial" font-size="10.00">Expert 43 (TP8) L7</text>
<text text-anchor="middle" x="15880.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="15880.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_44_stage1 -->
<g id="node491" class="node">
<title>expert_7_44_stage1</title>
<polygon fill="lightblue" stroke="black" points="15791.47,-1134 15648.47,-1134 15648.47,-1093 15791.47,-1093 15791.47,-1134"/>
<text text-anchor="middle" x="15719.97" y="-1122" font-family="Arial" font-size="10.00">Expert 44 (TP8) L7</text>
<text text-anchor="middle" x="15719.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="15719.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_45_stage1 -->
<g id="node492" class="node">
<title>expert_7_45_stage1</title>
<polygon fill="lightblue" stroke="black" points="15630.47,-1134 15487.47,-1134 15487.47,-1093 15630.47,-1093 15630.47,-1134"/>
<text text-anchor="middle" x="15558.97" y="-1122" font-family="Arial" font-size="10.00">Expert 45 (TP8) L7</text>
<text text-anchor="middle" x="15558.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="15558.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_46_stage1 -->
<g id="node493" class="node">
<title>expert_7_46_stage1</title>
<polygon fill="lightblue" stroke="black" points="15469.47,-1134 15326.47,-1134 15326.47,-1093 15469.47,-1093 15469.47,-1134"/>
<text text-anchor="middle" x="15397.97" y="-1122" font-family="Arial" font-size="10.00">Expert 46 (TP8) L7</text>
<text text-anchor="middle" x="15397.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="15397.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_47_stage1 -->
<g id="node494" class="node">
<title>expert_7_47_stage1</title>
<polygon fill="lightblue" stroke="black" points="15308.47,-1134 15165.47,-1134 15165.47,-1093 15308.47,-1093 15308.47,-1134"/>
<text text-anchor="middle" x="15236.97" y="-1122" font-family="Arial" font-size="10.00">Expert 47 (TP8) L7</text>
<text text-anchor="middle" x="15236.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="15236.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_48_stage1 -->
<g id="node495" class="node">
<title>expert_7_48_stage1</title>
<polygon fill="lightblue" stroke="black" points="15147.47,-1134 15004.47,-1134 15004.47,-1093 15147.47,-1093 15147.47,-1134"/>
<text text-anchor="middle" x="15075.97" y="-1122" font-family="Arial" font-size="10.00">Expert 48 (TP8) L7</text>
<text text-anchor="middle" x="15075.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="15075.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_49_stage1 -->
<g id="node496" class="node">
<title>expert_7_49_stage1</title>
<polygon fill="lightblue" stroke="black" points="14986.47,-1134 14843.47,-1134 14843.47,-1093 14986.47,-1093 14986.47,-1134"/>
<text text-anchor="middle" x="14914.97" y="-1122" font-family="Arial" font-size="10.00">Expert 49 (TP8) L7</text>
<text text-anchor="middle" x="14914.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="14914.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_50_stage1 -->
<g id="node497" class="node">
<title>expert_7_50_stage1</title>
<polygon fill="lightblue" stroke="black" points="14825.47,-1134 14682.47,-1134 14682.47,-1093 14825.47,-1093 14825.47,-1134"/>
<text text-anchor="middle" x="14753.97" y="-1122" font-family="Arial" font-size="10.00">Expert 50 (TP8) L7</text>
<text text-anchor="middle" x="14753.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="14753.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_51_stage1 -->
<g id="node498" class="node">
<title>expert_7_51_stage1</title>
<polygon fill="lightblue" stroke="black" points="14664.47,-1134 14521.47,-1134 14521.47,-1093 14664.47,-1093 14664.47,-1134"/>
<text text-anchor="middle" x="14592.97" y="-1122" font-family="Arial" font-size="10.00">Expert 51 (TP8) L7</text>
<text text-anchor="middle" x="14592.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="14592.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_52_stage1 -->
<g id="node499" class="node">
<title>expert_7_52_stage1</title>
<polygon fill="lightblue" stroke="black" points="14503.47,-1134 14360.47,-1134 14360.47,-1093 14503.47,-1093 14503.47,-1134"/>
<text text-anchor="middle" x="14431.97" y="-1122" font-family="Arial" font-size="10.00">Expert 52 (TP8) L7</text>
<text text-anchor="middle" x="14431.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="14431.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_53_stage1 -->
<g id="node500" class="node">
<title>expert_7_53_stage1</title>
<polygon fill="lightblue" stroke="black" points="14342.47,-1134 14199.47,-1134 14199.47,-1093 14342.47,-1093 14342.47,-1134"/>
<text text-anchor="middle" x="14270.97" y="-1122" font-family="Arial" font-size="10.00">Expert 53 (TP8) L7</text>
<text text-anchor="middle" x="14270.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="14270.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_54_stage1 -->
<g id="node501" class="node">
<title>expert_7_54_stage1</title>
<polygon fill="lightblue" stroke="black" points="14181.47,-1134 14038.47,-1134 14038.47,-1093 14181.47,-1093 14181.47,-1134"/>
<text text-anchor="middle" x="14109.97" y="-1122" font-family="Arial" font-size="10.00">Expert 54 (TP8) L7</text>
<text text-anchor="middle" x="14109.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="14109.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_55_stage1 -->
<g id="node502" class="node">
<title>expert_7_55_stage1</title>
<polygon fill="lightblue" stroke="black" points="14020.47,-1134 13877.47,-1134 13877.47,-1093 14020.47,-1093 14020.47,-1134"/>
<text text-anchor="middle" x="13948.97" y="-1122" font-family="Arial" font-size="10.00">Expert 55 (TP8) L7</text>
<text text-anchor="middle" x="13948.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="13948.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_56_stage1 -->
<g id="node503" class="node">
<title>expert_7_56_stage1</title>
<polygon fill="lightblue" stroke="black" points="13859.47,-1134 13716.47,-1134 13716.47,-1093 13859.47,-1093 13859.47,-1134"/>
<text text-anchor="middle" x="13787.97" y="-1122" font-family="Arial" font-size="10.00">Expert 56 (TP8) L7</text>
<text text-anchor="middle" x="13787.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="13787.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_57_stage1 -->
<g id="node504" class="node">
<title>expert_7_57_stage1</title>
<polygon fill="lightblue" stroke="black" points="13698.47,-1134 13555.47,-1134 13555.47,-1093 13698.47,-1093 13698.47,-1134"/>
<text text-anchor="middle" x="13626.97" y="-1122" font-family="Arial" font-size="10.00">Expert 57 (TP8) L7</text>
<text text-anchor="middle" x="13626.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="13626.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_58_stage1 -->
<g id="node505" class="node">
<title>expert_7_58_stage1</title>
<polygon fill="lightblue" stroke="black" points="13537.47,-1134 13394.47,-1134 13394.47,-1093 13537.47,-1093 13537.47,-1134"/>
<text text-anchor="middle" x="13465.97" y="-1122" font-family="Arial" font-size="10.00">Expert 58 (TP8) L7</text>
<text text-anchor="middle" x="13465.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="13465.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_59_stage1 -->
<g id="node506" class="node">
<title>expert_7_59_stage1</title>
<polygon fill="lightblue" stroke="black" points="13376.47,-1134 13233.47,-1134 13233.47,-1093 13376.47,-1093 13376.47,-1134"/>
<text text-anchor="middle" x="13304.97" y="-1122" font-family="Arial" font-size="10.00">Expert 59 (TP8) L7</text>
<text text-anchor="middle" x="13304.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="13304.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_60_stage1 -->
<g id="node507" class="node">
<title>expert_7_60_stage1</title>
<polygon fill="lightblue" stroke="black" points="13215.47,-1134 13072.47,-1134 13072.47,-1093 13215.47,-1093 13215.47,-1134"/>
<text text-anchor="middle" x="13143.97" y="-1122" font-family="Arial" font-size="10.00">Expert 60 (TP8) L7</text>
<text text-anchor="middle" x="13143.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="13143.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_61_stage1 -->
<g id="node508" class="node">
<title>expert_7_61_stage1</title>
<polygon fill="lightblue" stroke="black" points="13054.47,-1134 12911.47,-1134 12911.47,-1093 13054.47,-1093 13054.47,-1134"/>
<text text-anchor="middle" x="12982.97" y="-1122" font-family="Arial" font-size="10.00">Expert 61 (TP8) L7</text>
<text text-anchor="middle" x="12982.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="12982.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_62_stage1 -->
<g id="node509" class="node">
<title>expert_7_62_stage1</title>
<polygon fill="lightblue" stroke="black" points="12893.47,-1134 12750.47,-1134 12750.47,-1093 12893.47,-1093 12893.47,-1134"/>
<text text-anchor="middle" x="12821.97" y="-1122" font-family="Arial" font-size="10.00">Expert 62 (TP8) L7</text>
<text text-anchor="middle" x="12821.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="12821.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_7_63_stage1 -->
<g id="node510" class="node">
<title>expert_7_63_stage1</title>
<polygon fill="lightblue" stroke="black" points="12732.47,-1134 12589.47,-1134 12589.47,-1093 12732.47,-1093 12732.47,-1134"/>
<text text-anchor="middle" x="12660.97" y="-1122" font-family="Arial" font-size="10.00">Expert 63 (TP8) L7</text>
<text text-anchor="middle" x="12660.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="12660.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_7_stage1 -->
<g id="node511" class="node">
<title>combine_7_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="12467.97" cy="-1113.5" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="12467.97" y="-1122" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L7</text>
<text text-anchor="middle" x="12467.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="12467.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_7_stage1 -->
<g id="node512" class="node">
<title>moe_out_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="12346.97,-1134 12206.97,-1134 12206.97,-1093 12346.97,-1093 12346.97,-1134"/>
<text text-anchor="middle" x="12276.97" y="-1122" font-family="Arial" font-size="10.00">MoE Output (TP8) L7</text>
<text text-anchor="middle" x="12276.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="12276.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_7_stage1 -->
<g id="node513" class="node">
<title>ln2_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="12188.97,-1134 12048.97,-1134 12048.97,-1093 12188.97,-1093 12188.97,-1134"/>
<text text-anchor="middle" x="12118.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L7</text>
<text text-anchor="middle" x="12118.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="12118.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_8_stage1 -->
<g id="node514" class="node">
<title>ln1_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="12030.97,-1134 11890.97,-1134 11890.97,-1093 12030.97,-1093 12030.97,-1134"/>
<text text-anchor="middle" x="11960.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L8</text>
<text text-anchor="middle" x="11960.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="11960.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_8_stage1 -->
<g id="node515" class="node">
<title>qkv_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="11872.97,-1134 11726.97,-1134 11726.97,-1093 11872.97,-1093 11872.97,-1134"/>
<text text-anchor="middle" x="11799.97" y="-1122" font-family="Arial" font-size="10.00">QKV Projection (TP8) L8</text>
<text text-anchor="middle" x="11799.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="11799.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_8_stage1 -->
<g id="node516" class="node">
<title>attn_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="11708.97,-1134 11562.97,-1134 11562.97,-1093 11708.97,-1093 11708.97,-1134"/>
<text text-anchor="middle" x="11635.97" y="-1122" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L8</text>
<text text-anchor="middle" x="11635.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="11635.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_8_stage1 -->
<g id="node517" class="node">
<title>attn_out_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="11544.97,-1134 11404.97,-1134 11404.97,-1093 11544.97,-1093 11544.97,-1134"/>
<text text-anchor="middle" x="11474.97" y="-1122" font-family="Arial" font-size="10.00">Attention Output (TP8) L8</text>
<text text-anchor="middle" x="11474.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="11474.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_8_stage1 -->
<g id="node518" class="node">
<title>route_8_stage1</title>
<polygon fill="lightcoral" stroke="black" points="11387.27,-1154.5 11156.14,-1154.5 11096.68,-1072.5 11327.81,-1072.5 11387.27,-1154.5"/>
<text text-anchor="middle" x="11241.97" y="-1122" font-family="Arial" font-size="10.00">MoE Routing (EP64) L8</text>
<text text-anchor="middle" x="11241.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="11241.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_8_stage1 -->
<g id="node519" class="node">
<title>dispatch_8_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="10969.97" cy="-1113.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="10969.97" y="-1122" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L8</text>
<text text-anchor="middle" x="10969.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="10969.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_8_0_stage1 -->
<g id="node520" class="node">
<title>expert_8_0_stage1</title>
<polygon fill="lightblue" stroke="black" points="10843.47,-1134 10700.47,-1134 10700.47,-1093 10843.47,-1093 10843.47,-1134"/>
<text text-anchor="middle" x="10771.97" y="-1122" font-family="Arial" font-size="10.00">Expert 0 (TP8) L8</text>
<text text-anchor="middle" x="10771.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="10771.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_1_stage1 -->
<g id="node521" class="node">
<title>expert_8_1_stage1</title>
<polygon fill="lightblue" stroke="black" points="10682.47,-1134 10539.47,-1134 10539.47,-1093 10682.47,-1093 10682.47,-1134"/>
<text text-anchor="middle" x="10610.97" y="-1122" font-family="Arial" font-size="10.00">Expert 1 (TP8) L8</text>
<text text-anchor="middle" x="10610.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="10610.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_2_stage1 -->
<g id="node522" class="node">
<title>expert_8_2_stage1</title>
<polygon fill="lightblue" stroke="black" points="10521.47,-1134 10378.47,-1134 10378.47,-1093 10521.47,-1093 10521.47,-1134"/>
<text text-anchor="middle" x="10449.97" y="-1122" font-family="Arial" font-size="10.00">Expert 2 (TP8) L8</text>
<text text-anchor="middle" x="10449.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="10449.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_3_stage1 -->
<g id="node523" class="node">
<title>expert_8_3_stage1</title>
<polygon fill="lightblue" stroke="black" points="10360.47,-1134 10217.47,-1134 10217.47,-1093 10360.47,-1093 10360.47,-1134"/>
<text text-anchor="middle" x="10288.97" y="-1122" font-family="Arial" font-size="10.00">Expert 3 (TP8) L8</text>
<text text-anchor="middle" x="10288.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="10288.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_4_stage1 -->
<g id="node524" class="node">
<title>expert_8_4_stage1</title>
<polygon fill="lightblue" stroke="black" points="10199.47,-1134 10056.47,-1134 10056.47,-1093 10199.47,-1093 10199.47,-1134"/>
<text text-anchor="middle" x="10127.97" y="-1122" font-family="Arial" font-size="10.00">Expert 4 (TP8) L8</text>
<text text-anchor="middle" x="10127.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="10127.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_5_stage1 -->
<g id="node525" class="node">
<title>expert_8_5_stage1</title>
<polygon fill="lightblue" stroke="black" points="10038.47,-1134 9895.47,-1134 9895.47,-1093 10038.47,-1093 10038.47,-1134"/>
<text text-anchor="middle" x="9966.97" y="-1122" font-family="Arial" font-size="10.00">Expert 5 (TP8) L8</text>
<text text-anchor="middle" x="9966.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9966.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_6_stage1 -->
<g id="node526" class="node">
<title>expert_8_6_stage1</title>
<polygon fill="lightblue" stroke="black" points="9877.47,-1134 9734.47,-1134 9734.47,-1093 9877.47,-1093 9877.47,-1134"/>
<text text-anchor="middle" x="9805.97" y="-1122" font-family="Arial" font-size="10.00">Expert 6 (TP8) L8</text>
<text text-anchor="middle" x="9805.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9805.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_7_stage1 -->
<g id="node527" class="node">
<title>expert_8_7_stage1</title>
<polygon fill="lightblue" stroke="black" points="9716.47,-1134 9573.47,-1134 9573.47,-1093 9716.47,-1093 9716.47,-1134"/>
<text text-anchor="middle" x="9644.97" y="-1122" font-family="Arial" font-size="10.00">Expert 7 (TP8) L8</text>
<text text-anchor="middle" x="9644.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9644.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_8_stage1 -->
<g id="node528" class="node">
<title>expert_8_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="9555.47,-1134 9412.47,-1134 9412.47,-1093 9555.47,-1093 9555.47,-1134"/>
<text text-anchor="middle" x="9483.97" y="-1122" font-family="Arial" font-size="10.00">Expert 8 (TP8) L8</text>
<text text-anchor="middle" x="9483.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9483.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_9_stage1 -->
<g id="node529" class="node">
<title>expert_8_9_stage1</title>
<polygon fill="lightblue" stroke="black" points="9394.47,-1134 9251.47,-1134 9251.47,-1093 9394.47,-1093 9394.47,-1134"/>
<text text-anchor="middle" x="9322.97" y="-1122" font-family="Arial" font-size="10.00">Expert 9 (TP8) L8</text>
<text text-anchor="middle" x="9322.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9322.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_10_stage1 -->
<g id="node530" class="node">
<title>expert_8_10_stage1</title>
<polygon fill="lightblue" stroke="black" points="9233.47,-1134 9090.47,-1134 9090.47,-1093 9233.47,-1093 9233.47,-1134"/>
<text text-anchor="middle" x="9161.97" y="-1122" font-family="Arial" font-size="10.00">Expert 10 (TP8) L8</text>
<text text-anchor="middle" x="9161.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9161.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_11_stage1 -->
<g id="node531" class="node">
<title>expert_8_11_stage1</title>
<polygon fill="lightblue" stroke="black" points="9072.47,-1134 8929.47,-1134 8929.47,-1093 9072.47,-1093 9072.47,-1134"/>
<text text-anchor="middle" x="9000.97" y="-1122" font-family="Arial" font-size="10.00">Expert 11 (TP8) L8</text>
<text text-anchor="middle" x="9000.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="9000.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_12_stage1 -->
<g id="node532" class="node">
<title>expert_8_12_stage1</title>
<polygon fill="lightblue" stroke="black" points="8911.47,-1134 8768.47,-1134 8768.47,-1093 8911.47,-1093 8911.47,-1134"/>
<text text-anchor="middle" x="8839.97" y="-1122" font-family="Arial" font-size="10.00">Expert 12 (TP8) L8</text>
<text text-anchor="middle" x="8839.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8839.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_13_stage1 -->
<g id="node533" class="node">
<title>expert_8_13_stage1</title>
<polygon fill="lightblue" stroke="black" points="8750.47,-1134 8607.47,-1134 8607.47,-1093 8750.47,-1093 8750.47,-1134"/>
<text text-anchor="middle" x="8678.97" y="-1122" font-family="Arial" font-size="10.00">Expert 13 (TP8) L8</text>
<text text-anchor="middle" x="8678.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8678.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_14_stage1 -->
<g id="node534" class="node">
<title>expert_8_14_stage1</title>
<polygon fill="lightblue" stroke="black" points="8589.47,-1134 8446.47,-1134 8446.47,-1093 8589.47,-1093 8589.47,-1134"/>
<text text-anchor="middle" x="8517.97" y="-1122" font-family="Arial" font-size="10.00">Expert 14 (TP8) L8</text>
<text text-anchor="middle" x="8517.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8517.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_15_stage1 -->
<g id="node535" class="node">
<title>expert_8_15_stage1</title>
<polygon fill="lightblue" stroke="black" points="8428.47,-1134 8285.47,-1134 8285.47,-1093 8428.47,-1093 8428.47,-1134"/>
<text text-anchor="middle" x="8356.97" y="-1122" font-family="Arial" font-size="10.00">Expert 15 (TP8) L8</text>
<text text-anchor="middle" x="8356.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8356.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_16_stage1 -->
<g id="node536" class="node">
<title>expert_8_16_stage1</title>
<polygon fill="lightblue" stroke="black" points="8267.47,-1134 8124.47,-1134 8124.47,-1093 8267.47,-1093 8267.47,-1134"/>
<text text-anchor="middle" x="8195.97" y="-1122" font-family="Arial" font-size="10.00">Expert 16 (TP8) L8</text>
<text text-anchor="middle" x="8195.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8195.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_17_stage1 -->
<g id="node537" class="node">
<title>expert_8_17_stage1</title>
<polygon fill="lightblue" stroke="black" points="8106.47,-1134 7963.47,-1134 7963.47,-1093 8106.47,-1093 8106.47,-1134"/>
<text text-anchor="middle" x="8034.97" y="-1122" font-family="Arial" font-size="10.00">Expert 17 (TP8) L8</text>
<text text-anchor="middle" x="8034.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="8034.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_18_stage1 -->
<g id="node538" class="node">
<title>expert_8_18_stage1</title>
<polygon fill="lightblue" stroke="black" points="7945.47,-1134 7802.47,-1134 7802.47,-1093 7945.47,-1093 7945.47,-1134"/>
<text text-anchor="middle" x="7873.97" y="-1122" font-family="Arial" font-size="10.00">Expert 18 (TP8) L8</text>
<text text-anchor="middle" x="7873.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7873.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_19_stage1 -->
<g id="node539" class="node">
<title>expert_8_19_stage1</title>
<polygon fill="lightblue" stroke="black" points="7784.47,-1134 7641.47,-1134 7641.47,-1093 7784.47,-1093 7784.47,-1134"/>
<text text-anchor="middle" x="7712.97" y="-1122" font-family="Arial" font-size="10.00">Expert 19 (TP8) L8</text>
<text text-anchor="middle" x="7712.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7712.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_20_stage1 -->
<g id="node540" class="node">
<title>expert_8_20_stage1</title>
<polygon fill="lightblue" stroke="black" points="7623.47,-1134 7480.47,-1134 7480.47,-1093 7623.47,-1093 7623.47,-1134"/>
<text text-anchor="middle" x="7551.97" y="-1122" font-family="Arial" font-size="10.00">Expert 20 (TP8) L8</text>
<text text-anchor="middle" x="7551.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7551.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_21_stage1 -->
<g id="node541" class="node">
<title>expert_8_21_stage1</title>
<polygon fill="lightblue" stroke="black" points="7462.47,-1134 7319.47,-1134 7319.47,-1093 7462.47,-1093 7462.47,-1134"/>
<text text-anchor="middle" x="7390.97" y="-1122" font-family="Arial" font-size="10.00">Expert 21 (TP8) L8</text>
<text text-anchor="middle" x="7390.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7390.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_22_stage1 -->
<g id="node542" class="node">
<title>expert_8_22_stage1</title>
<polygon fill="lightblue" stroke="black" points="7301.47,-1134 7158.47,-1134 7158.47,-1093 7301.47,-1093 7301.47,-1134"/>
<text text-anchor="middle" x="7229.97" y="-1122" font-family="Arial" font-size="10.00">Expert 22 (TP8) L8</text>
<text text-anchor="middle" x="7229.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7229.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_23_stage1 -->
<g id="node543" class="node">
<title>expert_8_23_stage1</title>
<polygon fill="lightblue" stroke="black" points="7140.47,-1134 6997.47,-1134 6997.47,-1093 7140.47,-1093 7140.47,-1134"/>
<text text-anchor="middle" x="7068.97" y="-1122" font-family="Arial" font-size="10.00">Expert 23 (TP8) L8</text>
<text text-anchor="middle" x="7068.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="7068.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_24_stage1 -->
<g id="node544" class="node">
<title>expert_8_24_stage1</title>
<polygon fill="lightblue" stroke="black" points="6979.47,-1134 6836.47,-1134 6836.47,-1093 6979.47,-1093 6979.47,-1134"/>
<text text-anchor="middle" x="6907.97" y="-1122" font-family="Arial" font-size="10.00">Expert 24 (TP8) L8</text>
<text text-anchor="middle" x="6907.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6907.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_25_stage1 -->
<g id="node545" class="node">
<title>expert_8_25_stage1</title>
<polygon fill="lightblue" stroke="black" points="6818.47,-1134 6675.47,-1134 6675.47,-1093 6818.47,-1093 6818.47,-1134"/>
<text text-anchor="middle" x="6746.97" y="-1122" font-family="Arial" font-size="10.00">Expert 25 (TP8) L8</text>
<text text-anchor="middle" x="6746.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6746.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_26_stage1 -->
<g id="node546" class="node">
<title>expert_8_26_stage1</title>
<polygon fill="lightblue" stroke="black" points="6657.47,-1134 6514.47,-1134 6514.47,-1093 6657.47,-1093 6657.47,-1134"/>
<text text-anchor="middle" x="6585.97" y="-1122" font-family="Arial" font-size="10.00">Expert 26 (TP8) L8</text>
<text text-anchor="middle" x="6585.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6585.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_27_stage1 -->
<g id="node547" class="node">
<title>expert_8_27_stage1</title>
<polygon fill="lightblue" stroke="black" points="6496.47,-1134 6353.47,-1134 6353.47,-1093 6496.47,-1093 6496.47,-1134"/>
<text text-anchor="middle" x="6424.97" y="-1122" font-family="Arial" font-size="10.00">Expert 27 (TP8) L8</text>
<text text-anchor="middle" x="6424.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6424.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_28_stage1 -->
<g id="node548" class="node">
<title>expert_8_28_stage1</title>
<polygon fill="lightblue" stroke="black" points="6335.47,-1134 6192.47,-1134 6192.47,-1093 6335.47,-1093 6335.47,-1134"/>
<text text-anchor="middle" x="6263.97" y="-1122" font-family="Arial" font-size="10.00">Expert 28 (TP8) L8</text>
<text text-anchor="middle" x="6263.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6263.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_29_stage1 -->
<g id="node549" class="node">
<title>expert_8_29_stage1</title>
<polygon fill="lightblue" stroke="black" points="6174.47,-1134 6031.47,-1134 6031.47,-1093 6174.47,-1093 6174.47,-1134"/>
<text text-anchor="middle" x="6102.97" y="-1122" font-family="Arial" font-size="10.00">Expert 29 (TP8) L8</text>
<text text-anchor="middle" x="6102.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="6102.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_30_stage1 -->
<g id="node550" class="node">
<title>expert_8_30_stage1</title>
<polygon fill="lightblue" stroke="black" points="6013.47,-1134 5870.47,-1134 5870.47,-1093 6013.47,-1093 6013.47,-1134"/>
<text text-anchor="middle" x="5941.97" y="-1122" font-family="Arial" font-size="10.00">Expert 30 (TP8) L8</text>
<text text-anchor="middle" x="5941.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5941.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_31_stage1 -->
<g id="node551" class="node">
<title>expert_8_31_stage1</title>
<polygon fill="lightblue" stroke="black" points="5852.47,-1134 5709.47,-1134 5709.47,-1093 5852.47,-1093 5852.47,-1134"/>
<text text-anchor="middle" x="5780.97" y="-1122" font-family="Arial" font-size="10.00">Expert 31 (TP8) L8</text>
<text text-anchor="middle" x="5780.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5780.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_32_stage1 -->
<g id="node552" class="node">
<title>expert_8_32_stage1</title>
<polygon fill="lightblue" stroke="black" points="5691.47,-1134 5548.47,-1134 5548.47,-1093 5691.47,-1093 5691.47,-1134"/>
<text text-anchor="middle" x="5619.97" y="-1122" font-family="Arial" font-size="10.00">Expert 32 (TP8) L8</text>
<text text-anchor="middle" x="5619.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5619.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_33_stage1 -->
<g id="node553" class="node">
<title>expert_8_33_stage1</title>
<polygon fill="lightblue" stroke="black" points="5530.47,-1134 5387.47,-1134 5387.47,-1093 5530.47,-1093 5530.47,-1134"/>
<text text-anchor="middle" x="5458.97" y="-1122" font-family="Arial" font-size="10.00">Expert 33 (TP8) L8</text>
<text text-anchor="middle" x="5458.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5458.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_34_stage1 -->
<g id="node554" class="node">
<title>expert_8_34_stage1</title>
<polygon fill="lightblue" stroke="black" points="5369.47,-1134 5226.47,-1134 5226.47,-1093 5369.47,-1093 5369.47,-1134"/>
<text text-anchor="middle" x="5297.97" y="-1122" font-family="Arial" font-size="10.00">Expert 34 (TP8) L8</text>
<text text-anchor="middle" x="5297.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5297.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_35_stage1 -->
<g id="node555" class="node">
<title>expert_8_35_stage1</title>
<polygon fill="lightblue" stroke="black" points="5208.47,-1134 5065.47,-1134 5065.47,-1093 5208.47,-1093 5208.47,-1134"/>
<text text-anchor="middle" x="5136.97" y="-1122" font-family="Arial" font-size="10.00">Expert 35 (TP8) L8</text>
<text text-anchor="middle" x="5136.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="5136.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_36_stage1 -->
<g id="node556" class="node">
<title>expert_8_36_stage1</title>
<polygon fill="lightblue" stroke="black" points="5047.47,-1134 4904.47,-1134 4904.47,-1093 5047.47,-1093 5047.47,-1134"/>
<text text-anchor="middle" x="4975.97" y="-1122" font-family="Arial" font-size="10.00">Expert 36 (TP8) L8</text>
<text text-anchor="middle" x="4975.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4975.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_37_stage1 -->
<g id="node557" class="node">
<title>expert_8_37_stage1</title>
<polygon fill="lightblue" stroke="black" points="4886.47,-1134 4743.47,-1134 4743.47,-1093 4886.47,-1093 4886.47,-1134"/>
<text text-anchor="middle" x="4814.97" y="-1122" font-family="Arial" font-size="10.00">Expert 37 (TP8) L8</text>
<text text-anchor="middle" x="4814.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4814.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_38_stage1 -->
<g id="node558" class="node">
<title>expert_8_38_stage1</title>
<polygon fill="lightblue" stroke="black" points="4725.47,-1134 4582.47,-1134 4582.47,-1093 4725.47,-1093 4725.47,-1134"/>
<text text-anchor="middle" x="4653.97" y="-1122" font-family="Arial" font-size="10.00">Expert 38 (TP8) L8</text>
<text text-anchor="middle" x="4653.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4653.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_39_stage1 -->
<g id="node559" class="node">
<title>expert_8_39_stage1</title>
<polygon fill="lightblue" stroke="black" points="4564.47,-1134 4421.47,-1134 4421.47,-1093 4564.47,-1093 4564.47,-1134"/>
<text text-anchor="middle" x="4492.97" y="-1122" font-family="Arial" font-size="10.00">Expert 39 (TP8) L8</text>
<text text-anchor="middle" x="4492.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4492.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_40_stage1 -->
<g id="node560" class="node">
<title>expert_8_40_stage1</title>
<polygon fill="lightblue" stroke="black" points="4403.47,-1134 4260.47,-1134 4260.47,-1093 4403.47,-1093 4403.47,-1134"/>
<text text-anchor="middle" x="4331.97" y="-1122" font-family="Arial" font-size="10.00">Expert 40 (TP8) L8</text>
<text text-anchor="middle" x="4331.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4331.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_41_stage1 -->
<g id="node561" class="node">
<title>expert_8_41_stage1</title>
<polygon fill="lightblue" stroke="black" points="4242.47,-1134 4099.47,-1134 4099.47,-1093 4242.47,-1093 4242.47,-1134"/>
<text text-anchor="middle" x="4170.97" y="-1122" font-family="Arial" font-size="10.00">Expert 41 (TP8) L8</text>
<text text-anchor="middle" x="4170.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4170.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_42_stage1 -->
<g id="node562" class="node">
<title>expert_8_42_stage1</title>
<polygon fill="lightblue" stroke="black" points="4081.47,-1134 3938.47,-1134 3938.47,-1093 4081.47,-1093 4081.47,-1134"/>
<text text-anchor="middle" x="4009.97" y="-1122" font-family="Arial" font-size="10.00">Expert 42 (TP8) L8</text>
<text text-anchor="middle" x="4009.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="4009.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_43_stage1 -->
<g id="node563" class="node">
<title>expert_8_43_stage1</title>
<polygon fill="lightblue" stroke="black" points="3920.47,-1134 3777.47,-1134 3777.47,-1093 3920.47,-1093 3920.47,-1134"/>
<text text-anchor="middle" x="3848.97" y="-1122" font-family="Arial" font-size="10.00">Expert 43 (TP8) L8</text>
<text text-anchor="middle" x="3848.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3848.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_44_stage1 -->
<g id="node564" class="node">
<title>expert_8_44_stage1</title>
<polygon fill="lightblue" stroke="black" points="3759.47,-1134 3616.47,-1134 3616.47,-1093 3759.47,-1093 3759.47,-1134"/>
<text text-anchor="middle" x="3687.97" y="-1122" font-family="Arial" font-size="10.00">Expert 44 (TP8) L8</text>
<text text-anchor="middle" x="3687.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3687.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_45_stage1 -->
<g id="node565" class="node">
<title>expert_8_45_stage1</title>
<polygon fill="lightblue" stroke="black" points="3598.47,-1134 3455.47,-1134 3455.47,-1093 3598.47,-1093 3598.47,-1134"/>
<text text-anchor="middle" x="3526.97" y="-1122" font-family="Arial" font-size="10.00">Expert 45 (TP8) L8</text>
<text text-anchor="middle" x="3526.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3526.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_46_stage1 -->
<g id="node566" class="node">
<title>expert_8_46_stage1</title>
<polygon fill="lightblue" stroke="black" points="3437.47,-1134 3294.47,-1134 3294.47,-1093 3437.47,-1093 3437.47,-1134"/>
<text text-anchor="middle" x="3365.97" y="-1122" font-family="Arial" font-size="10.00">Expert 46 (TP8) L8</text>
<text text-anchor="middle" x="3365.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3365.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_47_stage1 -->
<g id="node567" class="node">
<title>expert_8_47_stage1</title>
<polygon fill="lightblue" stroke="black" points="3276.47,-1134 3133.47,-1134 3133.47,-1093 3276.47,-1093 3276.47,-1134"/>
<text text-anchor="middle" x="3204.97" y="-1122" font-family="Arial" font-size="10.00">Expert 47 (TP8) L8</text>
<text text-anchor="middle" x="3204.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3204.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_48_stage1 -->
<g id="node568" class="node">
<title>expert_8_48_stage1</title>
<polygon fill="lightblue" stroke="black" points="3115.47,-1134 2972.47,-1134 2972.47,-1093 3115.47,-1093 3115.47,-1134"/>
<text text-anchor="middle" x="3043.97" y="-1122" font-family="Arial" font-size="10.00">Expert 48 (TP8) L8</text>
<text text-anchor="middle" x="3043.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="3043.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_49_stage1 -->
<g id="node569" class="node">
<title>expert_8_49_stage1</title>
<polygon fill="lightblue" stroke="black" points="2954.47,-1134 2811.47,-1134 2811.47,-1093 2954.47,-1093 2954.47,-1134"/>
<text text-anchor="middle" x="2882.97" y="-1122" font-family="Arial" font-size="10.00">Expert 49 (TP8) L8</text>
<text text-anchor="middle" x="2882.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2882.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_50_stage1 -->
<g id="node570" class="node">
<title>expert_8_50_stage1</title>
<polygon fill="lightblue" stroke="black" points="2793.47,-1134 2650.47,-1134 2650.47,-1093 2793.47,-1093 2793.47,-1134"/>
<text text-anchor="middle" x="2721.97" y="-1122" font-family="Arial" font-size="10.00">Expert 50 (TP8) L8</text>
<text text-anchor="middle" x="2721.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2721.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_51_stage1 -->
<g id="node571" class="node">
<title>expert_8_51_stage1</title>
<polygon fill="lightblue" stroke="black" points="2632.47,-1134 2489.47,-1134 2489.47,-1093 2632.47,-1093 2632.47,-1134"/>
<text text-anchor="middle" x="2560.97" y="-1122" font-family="Arial" font-size="10.00">Expert 51 (TP8) L8</text>
<text text-anchor="middle" x="2560.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2560.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_52_stage1 -->
<g id="node572" class="node">
<title>expert_8_52_stage1</title>
<polygon fill="lightblue" stroke="black" points="2471.47,-1134 2328.47,-1134 2328.47,-1093 2471.47,-1093 2471.47,-1134"/>
<text text-anchor="middle" x="2399.97" y="-1122" font-family="Arial" font-size="10.00">Expert 52 (TP8) L8</text>
<text text-anchor="middle" x="2399.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2399.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_53_stage1 -->
<g id="node573" class="node">
<title>expert_8_53_stage1</title>
<polygon fill="lightblue" stroke="black" points="2310.47,-1134 2167.47,-1134 2167.47,-1093 2310.47,-1093 2310.47,-1134"/>
<text text-anchor="middle" x="2238.97" y="-1122" font-family="Arial" font-size="10.00">Expert 53 (TP8) L8</text>
<text text-anchor="middle" x="2238.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2238.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_54_stage1 -->
<g id="node574" class="node">
<title>expert_8_54_stage1</title>
<polygon fill="lightblue" stroke="black" points="2149.47,-1134 2006.47,-1134 2006.47,-1093 2149.47,-1093 2149.47,-1134"/>
<text text-anchor="middle" x="2077.97" y="-1122" font-family="Arial" font-size="10.00">Expert 54 (TP8) L8</text>
<text text-anchor="middle" x="2077.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="2077.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_55_stage1 -->
<g id="node575" class="node">
<title>expert_8_55_stage1</title>
<polygon fill="lightblue" stroke="black" points="1988.47,-1134 1845.47,-1134 1845.47,-1093 1988.47,-1093 1988.47,-1134"/>
<text text-anchor="middle" x="1916.97" y="-1122" font-family="Arial" font-size="10.00">Expert 55 (TP8) L8</text>
<text text-anchor="middle" x="1916.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1916.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_56_stage1 -->
<g id="node576" class="node">
<title>expert_8_56_stage1</title>
<polygon fill="lightblue" stroke="black" points="1827.47,-1134 1684.47,-1134 1684.47,-1093 1827.47,-1093 1827.47,-1134"/>
<text text-anchor="middle" x="1755.97" y="-1122" font-family="Arial" font-size="10.00">Expert 56 (TP8) L8</text>
<text text-anchor="middle" x="1755.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1755.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_57_stage1 -->
<g id="node577" class="node">
<title>expert_8_57_stage1</title>
<polygon fill="lightblue" stroke="black" points="1666.47,-1134 1523.47,-1134 1523.47,-1093 1666.47,-1093 1666.47,-1134"/>
<text text-anchor="middle" x="1594.97" y="-1122" font-family="Arial" font-size="10.00">Expert 57 (TP8) L8</text>
<text text-anchor="middle" x="1594.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1594.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_58_stage1 -->
<g id="node578" class="node">
<title>expert_8_58_stage1</title>
<polygon fill="lightblue" stroke="black" points="1505.47,-1134 1362.47,-1134 1362.47,-1093 1505.47,-1093 1505.47,-1134"/>
<text text-anchor="middle" x="1433.97" y="-1122" font-family="Arial" font-size="10.00">Expert 58 (TP8) L8</text>
<text text-anchor="middle" x="1433.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1433.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_59_stage1 -->
<g id="node579" class="node">
<title>expert_8_59_stage1</title>
<polygon fill="lightblue" stroke="black" points="1344.47,-1134 1201.47,-1134 1201.47,-1093 1344.47,-1093 1344.47,-1134"/>
<text text-anchor="middle" x="1272.97" y="-1122" font-family="Arial" font-size="10.00">Expert 59 (TP8) L8</text>
<text text-anchor="middle" x="1272.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1272.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_60_stage1 -->
<g id="node580" class="node">
<title>expert_8_60_stage1</title>
<polygon fill="lightblue" stroke="black" points="1183.47,-1134 1040.47,-1134 1040.47,-1093 1183.47,-1093 1183.47,-1134"/>
<text text-anchor="middle" x="1111.97" y="-1122" font-family="Arial" font-size="10.00">Expert 60 (TP8) L8</text>
<text text-anchor="middle" x="1111.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="1111.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_61_stage1 -->
<g id="node581" class="node">
<title>expert_8_61_stage1</title>
<polygon fill="lightblue" stroke="black" points="1022.47,-1134 879.47,-1134 879.47,-1093 1022.47,-1093 1022.47,-1134"/>
<text text-anchor="middle" x="950.97" y="-1122" font-family="Arial" font-size="10.00">Expert 61 (TP8) L8</text>
<text text-anchor="middle" x="950.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="950.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_62_stage1 -->
<g id="node582" class="node">
<title>expert_8_62_stage1</title>
<polygon fill="lightblue" stroke="black" points="861.47,-1134 718.47,-1134 718.47,-1093 861.47,-1093 861.47,-1134"/>
<text text-anchor="middle" x="789.97" y="-1122" font-family="Arial" font-size="10.00">Expert 62 (TP8) L8</text>
<text text-anchor="middle" x="789.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="789.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_8_63_stage1 -->
<g id="node583" class="node">
<title>expert_8_63_stage1</title>
<polygon fill="lightblue" stroke="black" points="700.47,-1134 557.47,-1134 557.47,-1093 700.47,-1093 700.47,-1134"/>
<text text-anchor="middle" x="628.97" y="-1122" font-family="Arial" font-size="10.00">Expert 63 (TP8) L8</text>
<text text-anchor="middle" x="628.97" y="-1111" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="628.97" y="-1100" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_8_stage1 -->
<g id="node584" class="node">
<title>combine_8_stage1</title>
<ellipse fill="lightyellow" stroke="black" cx="435.97" cy="-1113.5" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="435.97" y="-1122" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L8</text>
<text text-anchor="middle" x="435.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="435.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_8_stage1 -->
<g id="node585" class="node">
<title>moe_out_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="314.97,-1134 174.97,-1134 174.97,-1093 314.97,-1093 314.97,-1134"/>
<text text-anchor="middle" x="244.97" y="-1122" font-family="Arial" font-size="10.00">MoE Output (TP8) L8</text>
<text text-anchor="middle" x="244.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="244.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_8_stage1 -->
<g id="node586" class="node">
<title>ln2_8_stage1</title>
<polygon fill="lightblue" stroke="black" points="84222.97,-1134 84082.97,-1134 84082.97,-1093 84222.97,-1093 84222.97,-1134"/>
<text text-anchor="middle" x="84152.97" y="-1122" font-family="Arial" font-size="10.00">LayerNorm (TP8) L8</text>
<text text-anchor="middle" x="84152.97" y="-1111" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="84152.97" y="-1100" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_9_stage2 -->
<g id="node587" class="node">
<title>ln1_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84386.97,-965 84246.97,-965 84246.97,-924 84386.97,-924 84386.97,-965"/>
<text text-anchor="middle" x="84316.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L9</text>
<text text-anchor="middle" x="84316.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="84316.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_8_stage1&#45;&gt;ln1_9_stage2 -->
<g id="edge139" class="edge">
<title>ln2_8_stage1&#45;&gt;ln1_9_stage2</title>
<path fill="none" stroke="black" stroke-width="2" d="M84173.36,-1092.7C84190.05,-1076.4 84214.22,-1052.63 84234.97,-1031.5 84254.16,-1011.98 84275.48,-989.59 84291.58,-972.56"/>
<polygon fill="black" stroke="black" stroke-width="2" points="84294.26,-974.81 84298.58,-965.13 84289.17,-970.01 84294.26,-974.81"/>
<text text-anchor="middle" x="84269.47" y="-1043.3" font-family="Times,serif" font-size="14.00">PP Transfer</text>
</g>
<!-- qkv_9_stage2 -->
<g id="node588" class="node">
<title>qkv_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84428.97,-866.5 84282.97,-866.5 84282.97,-825.5 84428.97,-825.5 84428.97,-866.5"/>
<text text-anchor="middle" x="84355.97" y="-854.5" font-family="Arial" font-size="10.00">QKV Projection (TP8) L9</text>
<text text-anchor="middle" x="84355.97" y="-843.5" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="84355.97" y="-832.5" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- ln1_9_stage2&#45;&gt;qkv_9_stage2 -->
<g id="edge140" class="edge">
<title>ln1_9_stage2&#45;&gt;qkv_9_stage2</title>
<path fill="none" stroke="black" d="M84324.87,-923.98C84330.38,-910.33 84337.84,-891.87 84344.07,-876.45"/>
<polygon fill="black" stroke="black" points="84347.46,-877.42 84347.96,-866.84 84340.97,-874.79 84347.46,-877.42"/>
</g>
<!-- attn_9_stage2 -->
<g id="node589" class="node">
<title>attn_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84600.97,-788.5 84454.97,-788.5 84454.97,-747.5 84600.97,-747.5 84600.97,-788.5"/>
<text text-anchor="middle" x="84527.97" y="-776.5" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L9</text>
<text text-anchor="middle" x="84527.97" y="-765.5" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="84527.97" y="-754.5" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- qkv_9_stage2&#45;&gt;attn_9_stage2 -->
<g id="edge141" class="edge">
<title>qkv_9_stage2&#45;&gt;attn_9_stage2</title>
<path fill="none" stroke="black" d="M84400.27,-825.43C84422.94,-815.42 84450.71,-803.14 84474.56,-792.61"/>
<polygon fill="black" stroke="black" points="84476.1,-795.75 84483.83,-788.51 84473.27,-789.35 84476.1,-795.75"/>
</g>
<!-- attn_out_9_stage2 -->
<g id="node590" class="node">
<title>attn_out_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84914.97,-694.24 84774.97,-694.24 84774.97,-653.24 84914.97,-653.24 84914.97,-694.24"/>
<text text-anchor="middle" x="84844.97" y="-682.24" font-family="Arial" font-size="10.00">Attention Output (TP8) L9</text>
<text text-anchor="middle" x="84844.97" y="-671.24" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="84844.97" y="-660.24" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- attn_9_stage2&#45;&gt;attn_out_9_stage2 -->
<g id="edge142" class="edge">
<title>attn_9_stage2&#45;&gt;attn_out_9_stage2</title>
<path fill="none" stroke="black" d="M84595.2,-747.44C84645.85,-732.7 84715.35,-712.47 84768.18,-697.09"/>
<polygon fill="black" stroke="black" points="84769.22,-700.43 84777.84,-694.27 84767.26,-693.71 84769.22,-700.43"/>
</g>
<!-- ln2_9_stage2 -->
<g id="node659" class="node">
<title>ln2_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85534.97,-599.97 85394.97,-599.97 85394.97,-558.97 85534.97,-558.97 85534.97,-599.97"/>
<text text-anchor="middle" x="85464.97" y="-587.97" font-family="Arial" font-size="10.00">LayerNorm (TP8) L9</text>
<text text-anchor="middle" x="85464.97" y="-576.97" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="85464.97" y="-565.97" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- attn_out_9_stage2&#45;&gt;ln2_9_stage2 -->
<g id="edge143" class="edge">
<title>attn_out_9_stage2&#45;&gt;ln2_9_stage2</title>
<path fill="none" stroke="black" d="M84915.19,-662.29C85031.29,-645.01 85262.57,-610.59 85384.87,-592.39"/>
<polygon fill="black" stroke="black" points="85385.54,-595.83 85394.92,-590.89 85384.51,-588.9 85385.54,-595.83"/>
</g>
<!-- route_9_stage2 -->
<g id="node591" class="node">
<title>route_9_stage2</title>
<polygon fill="lightcoral" stroke="black" points="86996.27,-521.97 86765.14,-521.97 86705.68,-439.97 86936.81,-439.97 86996.27,-521.97"/>
<text text-anchor="middle" x="86850.97" y="-489.47" font-family="Arial" font-size="10.00">MoE Routing (EP64) L9</text>
<text text-anchor="middle" x="86850.97" y="-478.47" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="86850.97" y="-467.47" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_9_stage2 -->
<g id="node592" class="node">
<title>dispatch_9_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="89309.97" cy="-373.97" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="89309.97" y="-382.47" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L9</text>
<text text-anchor="middle" x="89309.97" y="-371.47" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="89309.97" y="-360.47" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- route_9_stage2&#45;&gt;dispatch_9_stage2 -->
<g id="edge145" class="edge">
<title>route_9_stage2&#45;&gt;dispatch_9_stage2</title>
<path fill="none" stroke="black" d="M86962.62,-475.2C87370.18,-457.8 88775.68,-397.79 89192.54,-379.99"/>
<polygon fill="black" stroke="black" points="89192.96,-383.47 89202.8,-379.55 89192.66,-376.48 89192.96,-383.47"/>
</g>
<!-- expert_9_0_stage2 -->
<g id="node593" class="node">
<title>expert_9_0_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84390.47,-307.98 84247.47,-307.98 84247.47,-266.98 84390.47,-266.98 84390.47,-307.98"/>
<text text-anchor="middle" x="84318.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 0 (TP8) L9</text>
<text text-anchor="middle" x="84318.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="84318.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_0_stage2 -->
<g id="edge146" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_0_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89200.72,-373.02C88703.17,-372.97 86601.56,-370.1 84877.97,-326.98 84668.31,-321.74 84611.72,-337.09 84400.96,-308.12"/>
<polygon fill="black" stroke="black" points="84401.19,-304.62 84390.8,-306.71 84400.22,-311.55 84401.19,-304.62"/>
</g>
<!-- expert_9_1_stage2 -->
<g id="node594" class="node">
<title>expert_9_1_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84551.47,-307.98 84408.47,-307.98 84408.47,-266.98 84551.47,-266.98 84551.47,-307.98"/>
<text text-anchor="middle" x="84479.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 1 (TP8) L9</text>
<text text-anchor="middle" x="84479.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="84479.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_1_stage2 -->
<g id="edge147" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_1_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89200.91,-372.46C88610.3,-369.6 85789.69,-354.67 84917.97,-326.98 84761.99,-322.03 84719.35,-330.8 84561.85,-308.13"/>
<polygon fill="black" stroke="black" points="84562.21,-304.64 84551.81,-306.66 84561.2,-311.57 84562.21,-304.64"/>
</g>
<!-- expert_9_2_stage2 -->
<g id="node595" class="node">
<title>expert_9_2_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84712.47,-307.98 84569.47,-307.98 84569.47,-266.98 84712.47,-266.98 84712.47,-307.98"/>
<text text-anchor="middle" x="84640.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 2 (TP8) L9</text>
<text text-anchor="middle" x="84640.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="84640.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_2_stage2 -->
<g id="edge148" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_2_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89200.93,-372.87C88726.24,-372.21 86792.49,-367.03 85204.97,-326.98 84993.02,-321.64 84935.89,-337.36 84722.74,-308.09"/>
<polygon fill="black" stroke="black" points="84723.19,-304.62 84712.8,-306.71 84722.22,-311.55 84723.19,-304.62"/>
</g>
<!-- expert_9_3_stage2 -->
<g id="node596" class="node">
<title>expert_9_3_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84873.47,-307.98 84730.47,-307.98 84730.47,-266.98 84873.47,-266.98 84873.47,-307.98"/>
<text text-anchor="middle" x="84801.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 3 (TP8) L9</text>
<text text-anchor="middle" x="84801.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="84801.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_3_stage2 -->
<g id="edge149" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_3_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89200.79,-373.38C88728.63,-374.79 86815.41,-376.95 85244.97,-326.98 85086.81,-321.95 85043.58,-331.05 84883.99,-308.14"/>
<polygon fill="black" stroke="black" points="84884.21,-304.64 84873.81,-306.66 84883.2,-311.57 84884.21,-304.64"/>
</g>
<!-- expert_9_4_stage2 -->
<g id="node597" class="node">
<title>expert_9_4_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85034.47,-307.98 84891.47,-307.98 84891.47,-266.98 85034.47,-266.98 85034.47,-307.98"/>
<text text-anchor="middle" x="84962.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 4 (TP8) L9</text>
<text text-anchor="middle" x="84962.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="84962.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_4_stage2 -->
<g id="edge150" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_4_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89201.03,-372.75C88749.01,-371.61 86976.62,-364.82 85519.97,-326.98 85311.19,-321.56 85254.83,-336.98 85044.91,-308.11"/>
<polygon fill="black" stroke="black" points="85045.19,-304.62 85034.8,-306.71 85044.22,-311.55 85045.19,-304.62"/>
</g>
<!-- expert_9_5_stage2 -->
<g id="node598" class="node">
<title>expert_9_5_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85195.47,-307.98 85052.47,-307.98 85052.47,-266.98 85195.47,-266.98 85195.47,-307.98"/>
<text text-anchor="middle" x="85123.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 5 (TP8) L9</text>
<text text-anchor="middle" x="85123.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85123.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_5_stage2 -->
<g id="edge151" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_5_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89201,-373.28C88751.73,-374.19 86999.12,-374.33 85558.97,-326.98 85404.29,-321.9 85362.01,-330.64 85205.77,-308.11"/>
<polygon fill="black" stroke="black" points="85206.21,-304.64 85195.81,-306.66 85205.2,-311.57 85206.21,-304.64"/>
</g>
<!-- expert_9_6_stage2 -->
<g id="node599" class="node">
<title>expert_9_6_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85356.47,-307.98 85213.47,-307.98 85213.47,-266.98 85356.47,-266.98 85356.47,-307.98"/>
<text text-anchor="middle" x="85284.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 6 (TP8) L9</text>
<text text-anchor="middle" x="85284.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85284.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_6_stage2 -->
<g id="edge152" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_6_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89200.89,-372.51C88774.17,-370.47 87176.73,-360.88 85861.97,-326.98 85644.34,-321.37 85585.67,-338.02 85367,-308.12"/>
<polygon fill="black" stroke="black" points="85367.19,-304.62 85356.8,-306.71 85366.23,-311.55 85367.19,-304.62"/>
</g>
<!-- expert_9_7_stage2 -->
<g id="node600" class="node">
<title>expert_9_7_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85517.47,-307.98 85374.47,-307.98 85374.47,-266.98 85517.47,-266.98 85517.47,-307.98"/>
<text text-anchor="middle" x="85445.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 7 (TP8) L9</text>
<text text-anchor="middle" x="85445.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85445.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_7_stage2 -->
<g id="edge153" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_7_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89200.8,-373.02C88776.36,-372.87 87195.16,-369.32 85893.97,-326.98 85733.64,-321.77 85689.81,-331.3 85528.12,-308.16"/>
<polygon fill="black" stroke="black" points="85528.21,-304.64 85517.81,-306.67 85527.2,-311.56 85528.21,-304.64"/>
</g>
<!-- expert_9_8_stage2 -->
<g id="node601" class="node">
<title>expert_9_8_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85678.47,-307.98 85535.47,-307.98 85535.47,-266.98 85678.47,-266.98 85678.47,-307.98"/>
<text text-anchor="middle" x="85606.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 8 (TP8) L9</text>
<text text-anchor="middle" x="85606.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85606.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_8_stage2 -->
<g id="edge154" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89200.94,-372.34C88798.69,-369.77 87359.88,-358.81 86173.97,-326.98 85960.72,-321.26 85903.22,-337.5 85688.8,-308.1"/>
<polygon fill="black" stroke="black" points="85689.19,-304.62 85678.8,-306.71 85688.22,-311.55 85689.19,-304.62"/>
</g>
<!-- expert_9_9_stage2 -->
<g id="node602" class="node">
<title>expert_9_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85839.47,-307.98 85696.47,-307.98 85696.47,-266.98 85839.47,-266.98 85839.47,-307.98"/>
<text text-anchor="middle" x="85767.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 9 (TP8) L9</text>
<text text-anchor="middle" x="85767.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85767.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_9_stage2 -->
<g id="edge155" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89200.97,-372.87C88801.22,-372.18 87377.9,-366.87 86204.97,-326.98 86049.43,-321.69 86006.9,-330.73 85849.83,-308.12"/>
<polygon fill="black" stroke="black" points="85850.21,-304.64 85839.81,-306.66 85849.2,-311.57 85850.21,-304.64"/>
</g>
<!-- expert_9_10_stage2 -->
<g id="node603" class="node">
<title>expert_9_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86000.47,-307.98 85857.47,-307.98 85857.47,-266.98 86000.47,-266.98 86000.47,-307.98"/>
<text text-anchor="middle" x="85928.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 10 (TP8) L9</text>
<text text-anchor="middle" x="85928.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85928.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_10_stage2 -->
<g id="edge156" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89201.24,-372.02C88827.14,-368.58 87558.53,-355.41 86510.97,-326.98 86291.05,-321.01 86231.83,-338.28 86010.77,-308.09"/>
<polygon fill="black" stroke="black" points="86011.19,-304.62 86000.8,-306.71 86010.23,-311.55 86011.19,-304.62"/>
</g>
<!-- expert_9_11_stage2 -->
<g id="node604" class="node">
<title>expert_9_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86161.47,-307.98 86018.47,-307.98 86018.47,-266.98 86161.47,-266.98 86161.47,-307.98"/>
<text text-anchor="middle" x="86089.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 11 (TP8) L9</text>
<text text-anchor="middle" x="86089.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86089.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_11_stage2 -->
<g id="edge157" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89201.18,-372.51C88829.69,-370.62 87577.15,-361.91 86542.97,-326.98 86380.32,-321.49 86335.95,-331.56 86171.76,-308.11"/>
<polygon fill="black" stroke="black" points="86172.21,-304.64 86161.81,-306.67 86171.2,-311.56 86172.21,-304.64"/>
</g>
<!-- expert_9_12_stage2 -->
<g id="node605" class="node">
<title>expert_9_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86322.47,-307.98 86179.47,-307.98 86179.47,-266.98 86322.47,-266.98 86322.47,-307.98"/>
<text text-anchor="middle" x="86250.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 12 (TP8) L9</text>
<text text-anchor="middle" x="86250.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86250.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_12_stage2 -->
<g id="edge158" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89201.26,-371.79C88853.3,-367.84 87735.67,-353.79 86810.97,-326.98 86600.9,-320.89 86544.17,-337.11 86332.98,-308.12"/>
<polygon fill="black" stroke="black" points="86333.19,-304.62 86322.8,-306.71 86332.22,-311.55 86333.19,-304.62"/>
</g>
<!-- expert_9_13_stage2 -->
<g id="node606" class="node">
<title>expert_9_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86483.47,-307.98 86340.47,-307.98 86340.47,-266.98 86483.47,-266.98 86483.47,-307.98"/>
<text text-anchor="middle" x="86411.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 13 (TP8) L9</text>
<text text-anchor="middle" x="86411.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86411.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_13_stage2 -->
<g id="edge159" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89201.03,-372.33C88855.47,-370.01 87753,-360.29 86840.97,-326.98 86689.07,-321.43 86647.42,-330.3 86494.07,-308.16"/>
<polygon fill="black" stroke="black" points="86494.21,-304.64 86483.81,-306.66 86493.2,-311.57 86494.21,-304.64"/>
</g>
<!-- expert_9_14_stage2 -->
<g id="node607" class="node">
<title>expert_9_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86644.47,-307.98 86501.47,-307.98 86501.47,-266.98 86644.47,-266.98 86644.47,-307.98"/>
<text text-anchor="middle" x="86572.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 14 (TP8) L9</text>
<text text-anchor="middle" x="86572.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86572.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_14_stage2 -->
<g id="edge160" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89201.07,-373.42C88769.63,-374.73 87178.87,-374.88 86655.08,-308.1"/>
<polygon fill="black" stroke="black" points="86655.16,-304.58 86644.79,-306.76 86654.26,-311.52 86655.16,-304.58"/>
</g>
<!-- expert_9_15_stage2 -->
<g id="node608" class="node">
<title>expert_9_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86805.47,-307.98 86662.47,-307.98 86662.47,-266.98 86805.47,-266.98 86805.47,-307.98"/>
<text text-anchor="middle" x="86733.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 15 (TP8) L9</text>
<text text-anchor="middle" x="86733.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86733.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_15_stage2 -->
<g id="edge161" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89202.29,-369.11C88955.98,-360.37 88332.53,-338.87 87810.97,-325.98 87592.7,-320.59 87049.95,-335.93 86816.02,-308.05"/>
<polygon fill="black" stroke="black" points="86816.15,-304.54 86805.79,-306.78 86815.28,-311.49 86816.15,-304.54"/>
</g>
<!-- expert_9_16_stage2 -->
<g id="node609" class="node">
<title>expert_9_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86966.47,-307.98 86823.47,-307.98 86823.47,-266.98 86966.47,-266.98 86966.47,-307.98"/>
<text text-anchor="middle" x="86894.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 16 (TP8) L9</text>
<text text-anchor="middle" x="86894.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86894.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_16_stage2 -->
<g id="edge162" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_16_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89205.98,-365.29C89053.59,-354.39 88760.59,-334.78 88510.97,-325.98 88343.32,-320.07 87184.89,-329.01 86976.77,-307.93"/>
<polygon fill="black" stroke="black" points="86977.12,-304.45 86966.79,-306.8 86976.33,-311.4 86977.12,-304.45"/>
</g>
<!-- expert_9_17_stage2 -->
<g id="node610" class="node">
<title>expert_9_17_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87127.47,-307.98 86984.47,-307.98 86984.47,-266.98 87127.47,-266.98 87127.47,-307.98"/>
<text text-anchor="middle" x="87055.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 17 (TP8) L9</text>
<text text-anchor="middle" x="87055.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87055.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_17_stage2 -->
<g id="edge163" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_17_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89214.05,-360.22C89123.88,-348.85 88985.04,-332.98 88863.97,-325.98 88675.28,-315.08 87368.27,-331.35 87137.93,-307.95"/>
<polygon fill="black" stroke="black" points="87138.12,-304.45 87127.79,-306.81 87137.33,-311.41 87138.12,-304.45"/>
</g>
<!-- expert_9_18_stage2 -->
<g id="node611" class="node">
<title>expert_9_18_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87288.47,-307.98 87145.47,-307.98 87145.47,-266.98 87288.47,-266.98 87288.47,-307.98"/>
<text text-anchor="middle" x="87216.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 18 (TP8) L9</text>
<text text-anchor="middle" x="87216.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87216.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_18_stage2 -->
<g id="edge164" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_18_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89227.77,-354.85C89175.45,-344.21 89106.08,-331.75 89043.97,-325.98 88853.7,-308.32 87531.84,-331.38 87299.04,-307.96"/>
<polygon fill="black" stroke="black" points="87299.12,-304.45 87288.79,-306.81 87298.34,-311.4 87299.12,-304.45"/>
</g>
<!-- expert_9_19_stage2 -->
<g id="node612" class="node">
<title>expert_9_19_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87449.47,-307.98 87306.47,-307.98 87306.47,-266.98 87449.47,-266.98 87449.47,-307.98"/>
<text text-anchor="middle" x="87377.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 19 (TP8) L9</text>
<text text-anchor="middle" x="87377.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87377.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_19_stage2 -->
<g id="edge165" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_19_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89244.23,-350.76C89212.52,-341.15 89173.69,-330.97 89137.97,-325.98 88956.07,-300.59 87685.12,-330.25 87460,-307.94"/>
<polygon fill="black" stroke="black" points="87460.11,-304.44 87449.79,-306.81 87459.34,-311.39 87460.11,-304.44"/>
</g>
<!-- expert_9_20_stage2 -->
<g id="node613" class="node">
<title>expert_9_20_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87610.47,-307.98 87467.47,-307.98 87467.47,-266.98 87610.47,-266.98 87610.47,-307.98"/>
<text text-anchor="middle" x="87538.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 20 (TP8) L9</text>
<text text-anchor="middle" x="87538.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87538.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_20_stage2 -->
<g id="edge166" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_20_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89258.34,-348.4C89237.05,-339.52 89211.83,-330.56 89187.97,-325.98 89019.68,-293.69 87833.51,-328.54 87620.98,-307.93"/>
<polygon fill="black" stroke="black" points="87621.11,-304.42 87610.79,-306.8 87620.34,-311.38 87621.11,-304.42"/>
</g>
<!-- expert_9_21_stage2 -->
<g id="node614" class="node">
<title>expert_9_21_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87771.47,-307.98 87628.47,-307.98 87628.47,-266.98 87771.47,-266.98 87771.47,-307.98"/>
<text text-anchor="middle" x="87699.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 21 (TP8) L9</text>
<text text-anchor="middle" x="87699.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87699.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_21_stage2 -->
<g id="edge167" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_21_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89268.5,-346.93C89252.94,-338.56 89234.72,-330.33 89216.97,-325.98 89064.68,-288.68 87978.67,-326.6 87781.74,-307.89"/>
<polygon fill="black" stroke="black" points="87782.11,-304.41 87771.79,-306.8 87781.35,-311.37 87782.11,-304.41"/>
</g>
<!-- expert_9_22_stage2 -->
<g id="node615" class="node">
<title>expert_9_22_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87932.47,-307.98 87789.47,-307.98 87789.47,-266.98 87932.47,-266.98 87932.47,-307.98"/>
<text text-anchor="middle" x="87860.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 22 (TP8) L9</text>
<text text-anchor="middle" x="87860.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87860.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_22_stage2 -->
<g id="edge168" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_22_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89276.04,-346.24C89263.79,-338.13 89249.42,-330.24 89234.97,-325.98 89168.1,-306.26 88081.16,-316.39 87942.9,-307.67"/>
<polygon fill="black" stroke="black" points="87943.05,-304.17 87932.79,-306.8 87942.45,-311.14 87943.05,-304.17"/>
</g>
<!-- expert_9_23_stage2 -->
<g id="node616" class="node">
<title>expert_9_23_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88093.47,-307.98 87950.47,-307.98 87950.47,-266.98 88093.47,-266.98 88093.47,-307.98"/>
<text text-anchor="middle" x="88021.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 23 (TP8) L9</text>
<text text-anchor="middle" x="88021.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88021.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_23_stage2 -->
<g id="edge169" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_23_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89281.44,-345.8C89271.33,-337.87 89259.37,-330.21 89246.97,-325.98 89188.75,-306.15 88231.86,-315.4 88103.96,-307.65"/>
<polygon fill="black" stroke="black" points="88104.05,-304.14 88093.79,-306.79 88103.46,-311.12 88104.05,-304.14"/>
</g>
<!-- expert_9_24_stage2 -->
<g id="node617" class="node">
<title>expert_9_24_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88254.47,-307.98 88111.47,-307.98 88111.47,-266.98 88254.47,-266.98 88254.47,-307.98"/>
<text text-anchor="middle" x="88182.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 24 (TP8) L9</text>
<text text-anchor="middle" x="88182.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88182.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_24_stage2 -->
<g id="edge170" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_24_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89285.31,-345.62C89276.58,-337.78 89266.13,-330.21 89254.97,-325.98 89205.35,-307.16 88382.23,-314.45 88265.1,-307.63"/>
<polygon fill="black" stroke="black" points="88265.05,-304.12 88254.79,-306.78 88264.47,-311.09 88265.05,-304.12"/>
</g>
<!-- expert_9_25_stage2 -->
<g id="node618" class="node">
<title>expert_9_25_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88415.47,-307.98 88272.47,-307.98 88272.47,-266.98 88415.47,-266.98 88415.47,-307.98"/>
<text text-anchor="middle" x="88343.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 25 (TP8) L9</text>
<text text-anchor="middle" x="88343.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88343.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_25_stage2 -->
<g id="edge171" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_25_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89289.32,-345.45C89281.94,-337.71 89272.95,-330.24 89262.97,-325.98 89221.85,-308.43 88530.53,-313.56 88425.9,-307.6"/>
<polygon fill="black" stroke="black" points="88426.05,-304.1 88415.79,-306.77 88425.47,-311.07 88426.05,-304.1"/>
</g>
<!-- expert_9_26_stage2 -->
<g id="node619" class="node">
<title>expert_9_26_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88576.47,-307.98 88433.47,-307.98 88433.47,-266.98 88576.47,-266.98 88576.47,-307.98"/>
<text text-anchor="middle" x="88504.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 26 (TP8) L9</text>
<text text-anchor="middle" x="88504.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88504.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_26_stage2 -->
<g id="edge172" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_26_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89292.71,-345.06C89286.53,-337.5 89278.87,-330.23 89269.97,-325.98 89203.63,-294.27 88696.86,-316.42 88586.94,-307.79"/>
<polygon fill="black" stroke="black" points="88587.1,-304.29 88576.8,-306.75 88586.39,-311.25 88587.1,-304.29"/>
</g>
<!-- expert_9_27_stage2 -->
<g id="node620" class="node">
<title>expert_9_27_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88737.47,-307.98 88594.47,-307.98 88594.47,-266.98 88737.47,-266.98 88737.47,-307.98"/>
<text text-anchor="middle" x="88665.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 27 (TP8) L9</text>
<text text-anchor="middle" x="88665.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88665.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_27_stage2 -->
<g id="edge173" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_27_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89296.29,-344.71C89291.29,-337.33 89284.86,-330.25 89276.97,-325.98 89227.24,-299.06 88839.13,-314.57 88748.02,-307.76"/>
<polygon fill="black" stroke="black" points="88748.1,-304.25 88737.8,-306.73 88747.4,-311.21 88748.1,-304.25"/>
</g>
<!-- expert_9_28_stage2 -->
<g id="node621" class="node">
<title>expert_9_28_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88898.47,-307.98 88755.47,-307.98 88755.47,-266.98 88898.47,-266.98 88898.47,-307.98"/>
<text text-anchor="middle" x="88826.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 28 (TP8) L9</text>
<text text-anchor="middle" x="88826.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88826.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_28_stage2 -->
<g id="edge174" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_28_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89300.34,-344.91C89296.43,-337.54 89291.1,-330.42 89283.97,-325.98 89250.31,-305.04 88980.49,-312.96 88909.12,-307.73"/>
<polygon fill="black" stroke="black" points="88909.11,-304.21 88898.81,-306.68 88908.4,-311.17 88909.11,-304.21"/>
</g>
<!-- expert_9_29_stage2 -->
<g id="node622" class="node">
<title>expert_9_29_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89059.47,-307.98 88916.47,-307.98 88916.47,-266.98 89059.47,-266.98 89059.47,-307.98"/>
<text text-anchor="middle" x="88987.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 29 (TP8) L9</text>
<text text-anchor="middle" x="88987.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88987.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_29_stage2 -->
<g id="edge175" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_29_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89304.23,-344.75C89301.41,-337.55 89297.22,-330.57 89290.97,-325.98 89253.1,-298.16 89131.42,-313.92 89069.87,-307.85"/>
<polygon fill="black" stroke="black" points="89070.19,-304.36 89059.82,-306.57 89069.3,-311.31 89070.19,-304.36"/>
</g>
<!-- expert_9_30_stage2 -->
<g id="node623" class="node">
<title>expert_9_30_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89220.47,-307.98 89077.47,-307.98 89077.47,-266.98 89220.47,-266.98 89220.47,-307.98"/>
<text text-anchor="middle" x="89148.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 30 (TP8) L9</text>
<text text-anchor="middle" x="89148.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89148.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_30_stage2 -->
<g id="edge176" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_30_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89307.79,-344.6C89306,-337.75 89302.98,-330.98 89297.97,-325.98 89297.27,-325.28 89264.87,-317.09 89230.47,-308.54"/>
<polygon fill="black" stroke="black" points="89231.28,-305.14 89220.74,-306.13 89229.6,-311.93 89231.28,-305.14"/>
</g>
<!-- expert_9_31_stage2 -->
<g id="node624" class="node">
<title>expert_9_31_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89381.47,-307.98 89238.47,-307.98 89238.47,-266.98 89381.47,-266.98 89381.47,-307.98"/>
<text text-anchor="middle" x="89309.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 31 (TP8) L9</text>
<text text-anchor="middle" x="89309.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89309.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_31_stage2 -->
<g id="edge177" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_31_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89309.97,-344.84C89309.97,-336.31 89309.97,-326.91 89309.97,-318.27"/>
<polygon fill="black" stroke="black" points="89313.47,-318.22 89309.97,-308.22 89306.47,-318.22 89313.47,-318.22"/>
</g>
<!-- expert_9_32_stage2 -->
<g id="node625" class="node">
<title>expert_9_32_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89542.47,-307.98 89399.47,-307.98 89399.47,-266.98 89542.47,-266.98 89542.47,-307.98"/>
<text text-anchor="middle" x="89470.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 32 (TP8) L9</text>
<text text-anchor="middle" x="89470.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89470.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_32_stage2 -->
<g id="edge178" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_32_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89357.84,-347.85C89379,-336.75 89403.77,-323.75 89424.74,-312.75"/>
<polygon fill="black" stroke="black" points="89426.54,-315.75 89433.77,-308.01 89423.29,-309.56 89426.54,-315.75"/>
</g>
<!-- expert_9_33_stage2 -->
<g id="node626" class="node">
<title>expert_9_33_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89703.47,-307.98 89560.47,-307.98 89560.47,-266.98 89703.47,-266.98 89703.47,-307.98"/>
<text text-anchor="middle" x="89631.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 33 (TP8) L9</text>
<text text-anchor="middle" x="89631.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89631.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_33_stage2 -->
<g id="edge179" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_33_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89385.88,-353.06C89435.38,-340.07 89499.95,-323.13 89550.53,-309.85"/>
<polygon fill="black" stroke="black" points="89551.66,-313.17 89560.45,-307.25 89549.89,-306.4 89551.66,-313.17"/>
</g>
<!-- expert_9_34_stage2 -->
<g id="node627" class="node">
<title>expert_9_34_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89864.47,-307.98 89721.47,-307.98 89721.47,-266.98 89864.47,-266.98 89864.47,-307.98"/>
<text text-anchor="middle" x="89792.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 34 (TP8) L9</text>
<text text-anchor="middle" x="89792.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89792.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_34_stage2 -->
<g id="edge180" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_34_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89404.97,-359.7C89484.26,-348.13 89600.44,-330.07 89711.05,-308.1"/>
<polygon fill="black" stroke="black" points="89711.93,-311.49 89721.05,-306.1 89710.56,-304.63 89711.93,-311.49"/>
</g>
<!-- expert_9_35_stage2 -->
<g id="node628" class="node">
<title>expert_9_35_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90025.47,-307.98 89882.47,-307.98 89882.47,-266.98 90025.47,-266.98 90025.47,-307.98"/>
<text text-anchor="middle" x="89953.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 35 (TP8) L9</text>
<text text-anchor="middle" x="89953.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89953.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_35_stage2 -->
<g id="edge181" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_35_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89413.51,-364.81C89524.66,-355.19 89706.46,-336.96 89872.2,-308.01"/>
<polygon fill="black" stroke="black" points="89872.84,-311.45 89882.08,-306.27 89871.62,-304.56 89872.84,-311.45"/>
</g>
<!-- expert_9_36_stage2 -->
<g id="node629" class="node">
<title>expert_9_36_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90186.47,-307.98 90043.47,-307.98 90043.47,-266.98 90186.47,-266.98 90186.47,-307.98"/>
<text text-anchor="middle" x="90114.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 36 (TP8) L9</text>
<text text-anchor="middle" x="90114.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90114.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_36_stage2 -->
<g id="edge182" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_36_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89417.01,-368.28C89556.77,-361.05 89808.99,-344.22 90033.12,-307.99"/>
<polygon fill="black" stroke="black" points="90033.79,-311.43 90043.1,-306.37 90032.66,-304.52 90033.79,-311.43"/>
</g>
<!-- expert_9_37_stage2 -->
<g id="node630" class="node">
<title>expert_9_37_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90347.47,-307.98 90204.47,-307.98 90204.47,-266.98 90347.47,-266.98 90347.47,-307.98"/>
<text text-anchor="middle" x="90275.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 37 (TP8) L9</text>
<text text-anchor="middle" x="90275.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90275.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_37_stage2 -->
<g id="edge183" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_37_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.24,-370.7C89583.73,-365.96 89909.43,-351.67 90194,-307.99"/>
<polygon fill="black" stroke="black" points="90194.76,-311.42 90204.11,-306.43 90193.69,-304.5 90194.76,-311.42"/>
</g>
<!-- expert_9_38_stage2 -->
<g id="node631" class="node">
<title>expert_9_38_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90508.47,-307.98 90365.47,-307.98 90365.47,-266.98 90508.47,-266.98 90508.47,-307.98"/>
<text text-anchor="middle" x="90436.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 38 (TP8) L9</text>
<text text-anchor="middle" x="90436.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90436.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_38_stage2 -->
<g id="edge184" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_38_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89415.58,-366.76C89562.22,-358.09 89835.78,-341.77 90068.97,-326.98 90193.31,-319.1 90227.86,-326.82 90354.98,-307.98"/>
<polygon fill="black" stroke="black" points="90355.74,-311.41 90365.11,-306.45 90354.7,-304.48 90355.74,-311.41"/>
</g>
<!-- expert_9_39_stage2 -->
<g id="node632" class="node">
<title>expert_9_39_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90669.47,-307.98 90526.47,-307.98 90526.47,-266.98 90669.47,-266.98 90669.47,-307.98"/>
<text text-anchor="middle" x="90597.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 39 (TP8) L9</text>
<text text-anchor="middle" x="90597.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90597.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_39_stage2 -->
<g id="edge185" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_39_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89419.24,-373.74C89630.11,-373.76 90107.66,-366.74 90516.18,-307.94"/>
<polygon fill="black" stroke="black" points="90516.72,-311.4 90526.12,-306.5 90515.72,-304.47 90516.72,-311.4"/>
</g>
<!-- expert_9_40_stage2 -->
<g id="node633" class="node">
<title>expert_9_40_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90830.47,-307.98 90687.47,-307.98 90687.47,-266.98 90830.47,-266.98 90830.47,-307.98"/>
<text text-anchor="middle" x="90758.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 40 (TP8) L9</text>
<text text-anchor="middle" x="90758.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90758.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_40_stage2 -->
<g id="edge186" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_40_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89417.44,-369.04C89609.75,-361.84 90025.43,-345.57 90375.97,-326.98 90506.99,-320.04 90543.23,-327.63 90676.89,-307.99"/>
<polygon fill="black" stroke="black" points="90677.74,-311.41 90687.11,-306.47 90676.71,-304.48 90677.74,-311.41"/>
</g>
<!-- expert_9_41_stage2 -->
<g id="node634" class="node">
<title>expert_9_41_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90991.47,-307.98 90848.47,-307.98 90848.47,-266.98 90991.47,-266.98 90991.47,-307.98"/>
<text text-anchor="middle" x="90919.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 41 (TP8) L9</text>
<text text-anchor="middle" x="90919.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90919.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_41_stage2 -->
<g id="edge187" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_41_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.4,-371.1C89716.38,-365.51 90544.47,-346.97 90837.91,-307.94"/>
<polygon fill="black" stroke="black" points="90838.69,-311.37 90848.12,-306.54 90837.74,-304.43 90838.69,-311.37"/>
</g>
<!-- expert_9_42_stage2 -->
<g id="node635" class="node">
<title>expert_9_42_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91152.47,-307.98 91009.47,-307.98 91009.47,-266.98 91152.47,-266.98 91152.47,-307.98"/>
<text text-anchor="middle" x="91080.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 42 (TP8) L9</text>
<text text-anchor="middle" x="91080.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91080.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_42_stage2 -->
<g id="edge188" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_42_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89417.9,-370.08C89646.6,-363.76 90196.84,-347.66 90657.97,-326.98 90806.79,-320.31 90847.62,-329.69 90998.98,-307.97"/>
<polygon fill="black" stroke="black" points="90999.73,-311.4 91009.12,-306.49 90998.72,-304.47 90999.73,-311.4"/>
</g>
<!-- expert_9_43_stage2 -->
<g id="node636" class="node">
<title>expert_9_43_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91313.47,-307.98 91170.47,-307.98 91170.47,-266.98 91313.47,-266.98 91313.47,-307.98"/>
<text text-anchor="middle" x="91241.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 43 (TP8) L9</text>
<text text-anchor="middle" x="91241.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91241.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_43_stage2 -->
<g id="edge189" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_43_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89417.68,-369.52C89647.91,-362.11 90205.01,-343.94 90671.97,-326.98 90886.04,-319.21 90943.79,-337.24 91160.04,-307.94"/>
<polygon fill="black" stroke="black" points="91160.7,-311.39 91170.13,-306.56 91159.74,-304.45 91160.7,-311.39"/>
</g>
<!-- expert_9_44_stage2 -->
<g id="node637" class="node">
<title>expert_9_44_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91474.47,-307.98 91331.47,-307.98 91331.47,-266.98 91474.47,-266.98 91474.47,-307.98"/>
<text text-anchor="middle" x="91402.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 44 (TP8) L9</text>
<text text-anchor="middle" x="91402.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91402.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_44_stage2 -->
<g id="edge190" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_44_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.98,-372.38C89779.12,-369.97 90929.55,-358.5 91321.17,-307.9"/>
<polygon fill="black" stroke="black" points="91321.68,-311.36 91331.13,-306.58 91320.76,-304.42 91321.68,-311.36"/>
</g>
<!-- expert_9_45_stage2 -->
<g id="node638" class="node">
<title>expert_9_45_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91635.47,-307.98 91492.47,-307.98 91492.47,-266.98 91635.47,-266.98 91635.47,-307.98"/>
<text text-anchor="middle" x="91563.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 45 (TP8) L9</text>
<text text-anchor="middle" x="91563.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91563.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_45_stage2 -->
<g id="edge191" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_45_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.46,-371.34C89701.05,-366.85 90483.14,-352.9 91133.97,-326.98 91285.86,-320.93 91327.5,-330.07 91481.79,-308"/>
<polygon fill="black" stroke="black" points="91482.72,-311.4 91492.12,-306.5 91481.72,-304.47 91482.72,-311.4"/>
</g>
<!-- expert_9_46_stage2 -->
<g id="node639" class="node">
<title>expert_9_46_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91796.47,-307.98 91653.47,-307.98 91653.47,-266.98 91796.47,-266.98 91796.47,-307.98"/>
<text text-anchor="middle" x="91724.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 46 (TP8) L9</text>
<text text-anchor="middle" x="91724.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91724.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_46_stage2 -->
<g id="edge192" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_46_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.27,-370.79C89702.65,-364.95 90494.17,-347.95 91152.97,-326.98 91367.95,-320.14 91425.9,-337.37 91643,-307.95"/>
<polygon fill="black" stroke="black" points="91643.7,-311.39 91653.13,-306.56 91642.74,-304.45 91643.7,-311.39"/>
</g>
<!-- expert_9_47_stage2 -->
<g id="node640" class="node">
<title>expert_9_47_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91957.47,-307.98 91814.47,-307.98 91814.47,-266.98 91957.47,-266.98 91957.47,-307.98"/>
<text text-anchor="middle" x="91885.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 47 (TP8) L9</text>
<text text-anchor="middle" x="91885.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91885.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_47_stage2 -->
<g id="edge193" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_47_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.38,-370.98C89716.86,-365.36 90575.96,-348.45 91289.97,-326.98 91515.67,-320.2 91576.35,-338.63 91804.2,-307.92"/>
<polygon fill="black" stroke="black" points="91804.69,-311.39 91814.13,-306.57 91803.75,-304.45 91804.69,-311.39"/>
</g>
<!-- expert_9_48_stage2 -->
<g id="node641" class="node">
<title>expert_9_48_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92118.47,-307.98 91975.47,-307.98 91975.47,-266.98 92118.47,-266.98 92118.47,-307.98"/>
<text text-anchor="middle" x="92046.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 48 (TP8) L9</text>
<text text-anchor="middle" x="92046.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92046.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_48_stage2 -->
<g id="edge194" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_48_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.63,-371.21C89732.73,-365.99 90668.99,-349.54 91445.97,-326.98 91673.87,-320.37 91735.13,-338.89 91965.11,-307.93"/>
<polygon fill="black" stroke="black" points="91965.69,-311.38 91975.13,-306.57 91964.75,-304.45 91965.69,-311.38"/>
</g>
<!-- expert_9_49_stage2 -->
<g id="node642" class="node">
<title>expert_9_49_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92279.47,-307.98 92136.47,-307.98 92136.47,-266.98 92279.47,-266.98 92279.47,-307.98"/>
<text text-anchor="middle" x="92207.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 49 (TP8) L9</text>
<text text-anchor="middle" x="92207.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92207.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_49_stage2 -->
<g id="edge195" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_49_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.55,-371.44C89747.96,-366.65 90765.09,-350.84 91607.97,-326.98 91835.44,-320.54 91896.58,-338.84 92126.13,-307.93"/>
<polygon fill="black" stroke="black" points="92126.69,-311.39 92136.13,-306.57 92125.75,-304.45 92126.69,-311.39"/>
</g>
<!-- expert_9_50_stage2 -->
<g id="node643" class="node">
<title>expert_9_50_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92440.47,-307.98 92297.47,-307.98 92297.47,-266.98 92440.47,-266.98 92440.47,-307.98"/>
<text text-anchor="middle" x="92368.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 50 (TP8) L9</text>
<text text-anchor="middle" x="92368.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92368.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_50_stage2 -->
<g id="edge196" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_50_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.8,-371.64C89763.38,-367.25 90861.28,-352.14 91769.97,-326.98 91997,-320.7 92058.02,-338.8 92287.15,-307.93"/>
<polygon fill="black" stroke="black" points="92287.69,-311.39 92297.13,-306.57 92286.75,-304.45 92287.69,-311.39"/>
</g>
<!-- expert_9_51_stage2 -->
<g id="node644" class="node">
<title>expert_9_51_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92601.47,-307.98 92458.47,-307.98 92458.47,-266.98 92601.47,-266.98 92601.47,-307.98"/>
<text text-anchor="middle" x="92529.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 51 (TP8) L9</text>
<text text-anchor="middle" x="92529.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92529.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_51_stage2 -->
<g id="edge197" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_51_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.64,-371.82C89777.42,-367.83 90956.9,-353.45 91931.97,-326.98 92158.57,-320.83 92219.46,-338.75 92448.17,-307.92"/>
<polygon fill="black" stroke="black" points="92448.69,-311.39 92458.13,-306.57 92447.75,-304.45 92448.69,-311.39"/>
</g>
<!-- expert_9_52_stage2 -->
<g id="node645" class="node">
<title>expert_9_52_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92762.47,-307.98 92619.47,-307.98 92619.47,-266.98 92762.47,-266.98 92762.47,-307.98"/>
<text text-anchor="middle" x="92690.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 52 (TP8) L9</text>
<text text-anchor="middle" x="92690.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92690.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_52_stage2 -->
<g id="edge198" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_52_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.73,-371.97C89791.51,-368.35 91051.99,-354.71 92092.97,-326.98 92319.57,-320.95 92380.46,-338.75 92609.17,-307.92"/>
<polygon fill="black" stroke="black" points="92609.69,-311.39 92619.13,-306.57 92608.75,-304.45 92609.69,-311.39"/>
</g>
<!-- expert_9_53_stage2 -->
<g id="node646" class="node">
<title>expert_9_53_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92923.47,-307.98 92780.47,-307.98 92780.47,-266.98 92923.47,-266.98 92923.47,-307.98"/>
<text text-anchor="middle" x="92851.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 53 (TP8) L9</text>
<text text-anchor="middle" x="92851.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92851.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_53_stage2 -->
<g id="edge199" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_53_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.93,-372.1C89805.44,-368.83 91147.02,-355.97 92253.97,-326.98 92480.57,-321.05 92541.46,-338.76 92770.17,-307.92"/>
<polygon fill="black" stroke="black" points="92770.69,-311.39 92780.13,-306.57 92769.75,-304.45 92770.69,-311.39"/>
</g>
<!-- expert_9_54_stage2 -->
<g id="node647" class="node">
<title>expert_9_54_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93084.47,-307.98 92941.47,-307.98 92941.47,-266.98 93084.47,-266.98 93084.47,-307.98"/>
<text text-anchor="middle" x="93012.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 54 (TP8) L9</text>
<text text-anchor="middle" x="93012.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93012.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_54_stage2 -->
<g id="edge200" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_54_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.96,-372.22C89818.65,-369.29 91241.76,-357.23 92414.97,-326.98 92641.58,-321.14 92702.46,-338.76 92931.17,-307.92"/>
<polygon fill="black" stroke="black" points="92931.69,-311.39 92941.13,-306.57 92930.75,-304.45 92931.69,-311.39"/>
</g>
<!-- expert_9_55_stage2 -->
<g id="node648" class="node">
<title>expert_9_55_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93245.47,-307.98 93102.47,-307.98 93102.47,-266.98 93245.47,-266.98 93245.47,-307.98"/>
<text text-anchor="middle" x="93173.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 55 (TP8) L9</text>
<text text-anchor="middle" x="93173.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93173.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_55_stage2 -->
<g id="edge201" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_55_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.89,-372.34C89831.26,-369.73 91336.26,-358.49 92575.97,-326.98 92802.58,-321.22 92863.46,-338.76 93092.17,-307.92"/>
<polygon fill="black" stroke="black" points="93092.69,-311.39 93102.13,-306.57 93091.75,-304.45 93092.69,-311.39"/>
</g>
<!-- expert_9_56_stage2 -->
<g id="node649" class="node">
<title>expert_9_56_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93406.47,-307.98 93263.47,-307.98 93263.47,-266.98 93406.47,-266.98 93406.47,-307.98"/>
<text text-anchor="middle" x="93334.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 56 (TP8) L9</text>
<text text-anchor="middle" x="93334.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93334.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_56_stage2 -->
<g id="edge202" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_56_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.91,-372.45C89844.2,-370.22 91433.67,-360.02 92741.97,-326.98 92966.28,-321.32 93026.63,-338.49 93252.92,-307.96"/>
<polygon fill="black" stroke="black" points="93253.69,-311.39 93263.13,-306.56 93252.75,-304.45 93253.69,-311.39"/>
</g>
<!-- expert_9_57_stage2 -->
<g id="node650" class="node">
<title>expert_9_57_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93567.47,-307.98 93424.47,-307.98 93424.47,-266.98 93567.47,-266.98 93567.47,-307.98"/>
<text text-anchor="middle" x="93495.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 57 (TP8) L9</text>
<text text-anchor="middle" x="93495.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93495.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_57_stage2 -->
<g id="edge203" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_57_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89419.1,-372.54C89856.79,-370.6 91527.62,-361.23 92901.97,-326.98 93126.72,-321.38 93187.18,-338.54 93413.9,-307.96"/>
<polygon fill="black" stroke="black" points="93414.69,-311.39 93424.13,-306.56 93413.75,-304.45 93414.69,-311.39"/>
</g>
<!-- expert_9_58_stage2 -->
<g id="node651" class="node">
<title>expert_9_58_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93728.47,-307.98 93585.47,-307.98 93585.47,-266.98 93728.47,-266.98 93728.47,-307.98"/>
<text text-anchor="middle" x="93656.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 58 (TP8) L9</text>
<text text-anchor="middle" x="93656.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93656.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_58_stage2 -->
<g id="edge204" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_58_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.96,-372.62C89868.28,-370.96 91621.1,-362.44 93061.97,-326.98 93287.16,-321.44 93347.74,-338.6 93574.89,-307.96"/>
<polygon fill="black" stroke="black" points="93575.69,-311.39 93585.13,-306.56 93574.75,-304.45 93575.69,-311.39"/>
</g>
<!-- expert_9_59_stage2 -->
<g id="node652" class="node">
<title>expert_9_59_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93889.47,-307.98 93746.47,-307.98 93746.47,-266.98 93889.47,-266.98 93889.47,-307.98"/>
<text text-anchor="middle" x="93817.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 59 (TP8) L9</text>
<text text-anchor="middle" x="93817.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93817.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_59_stage2 -->
<g id="edge205" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_59_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.89,-372.7C89879.69,-371.31 91714.57,-363.64 93221.97,-326.98 93447.71,-321.49 93508.35,-338.67 93736.2,-307.92"/>
<polygon fill="black" stroke="black" points="93736.69,-311.39 93746.13,-306.57 93735.75,-304.45 93736.69,-311.39"/>
</g>
<!-- expert_9_60_stage2 -->
<g id="node653" class="node">
<title>expert_9_60_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94050.47,-307.98 93907.47,-307.98 93907.47,-266.98 94050.47,-266.98 94050.47,-307.98"/>
<text text-anchor="middle" x="93978.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 60 (TP8) L9</text>
<text text-anchor="middle" x="93978.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93978.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_60_stage2 -->
<g id="edge206" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_60_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89419.06,-372.78C89891.87,-371.72 91811.13,-365.16 93386.97,-326.98 93610.85,-321.56 93671.07,-338.45 93896.94,-307.96"/>
<polygon fill="black" stroke="black" points="93897.69,-311.39 93907.13,-306.56 93896.75,-304.45 93897.69,-311.39"/>
</g>
<!-- expert_9_61_stage2 -->
<g id="node654" class="node">
<title>expert_9_61_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94211.47,-307.98 94068.47,-307.98 94068.47,-266.98 94211.47,-266.98 94211.47,-307.98"/>
<text text-anchor="middle" x="94139.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 61 (TP8) L9</text>
<text text-anchor="middle" x="94139.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94139.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_61_stage2 -->
<g id="edge207" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_61_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89418.84,-372.84C89902.39,-372.04 91904.22,-366.37 93546.97,-326.98 93771.29,-321.6 93831.63,-338.5 94057.92,-307.96"/>
<polygon fill="black" stroke="black" points="94058.69,-311.39 94068.13,-306.56 94057.75,-304.45 94058.69,-311.39"/>
</g>
<!-- expert_9_62_stage2 -->
<g id="node655" class="node">
<title>expert_9_62_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94372.47,-307.98 94229.47,-307.98 94229.47,-266.98 94372.47,-266.98 94372.47,-307.98"/>
<text text-anchor="middle" x="94300.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 62 (TP8) L9</text>
<text text-anchor="middle" x="94300.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94300.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_62_stage2 -->
<g id="edge208" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_62_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89419.19,-372.9C89914.3,-372.34 91997.89,-367.56 93706.97,-326.98 93931.72,-321.65 93992.18,-338.55 94218.9,-307.96"/>
<polygon fill="black" stroke="black" points="94219.69,-311.39 94229.13,-306.56 94218.75,-304.45 94219.69,-311.39"/>
</g>
<!-- expert_9_63_stage2 -->
<g id="node656" class="node">
<title>expert_9_63_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94533.47,-307.98 94390.47,-307.98 94390.47,-266.98 94533.47,-266.98 94533.47,-307.98"/>
<text text-anchor="middle" x="94461.97" y="-295.98" font-family="Arial" font-size="10.00">Expert 63 (TP8) L9</text>
<text text-anchor="middle" x="94461.97" y="-284.98" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94461.97" y="-273.98" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- dispatch_9_stage2&#45;&gt;expert_9_63_stage2 -->
<g id="edge209" class="edge">
<title>dispatch_9_stage2&#45;&gt;expert_9_63_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89419.02,-372.97C89924.9,-372.72 92093.82,-369.13 93871.97,-326.98 94094.98,-321.7 94154.96,-338.35 94379.98,-307.95"/>
<polygon fill="black" stroke="black" points="94380.69,-311.39 94390.13,-306.56 94379.74,-304.45 94380.69,-311.39"/>
</g>
<!-- combine_9_stage2 -->
<g id="node657" class="node">
<title>combine_9_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="89389.97" cy="-200.99" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="89389.97" y="-209.49" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L9</text>
<text text-anchor="middle" x="89389.97" y="-198.49" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89389.97" y="-187.49" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- expert_9_0_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge210" class="edge">
<title>expert_9_0_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M84390.8,-268.26C84393.55,-267.79 84396.28,-267.36 84398.97,-266.98 84610.41,-237.33 84665.54,-253.29 84878.97,-247.98 86630.53,-204.4 88765.63,-201.87 89276.38,-201.92"/>
<polygon fill="black" stroke="black" points="89276.69,-205.42 89286.69,-201.92 89276.69,-198.42 89276.69,-205.42"/>
</g>
<!-- expert_9_1_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge211" class="edge">
<title>expert_9_1_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M84551.81,-268.3C84554.56,-267.82 84557.29,-267.38 84559.97,-266.98 84718.05,-243.74 84759.27,-253.03 84918.97,-247.98 85805.25,-219.98 88670.44,-205.33 89276.65,-202.5"/>
<polygon fill="black" stroke="black" points="89276.72,-206 89286.7,-202.45 89276.68,-199 89276.72,-206"/>
</g>
<!-- expert_9_2_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge212" class="edge">
<title>expert_9_2_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M84712.8,-268.26C84715.55,-267.79 84718.28,-267.36 84720.97,-266.98 84935.05,-237.02 84990.88,-253.39 85206.97,-247.98 86821.77,-207.55 88788.1,-202.66 89276.25,-202.07"/>
<polygon fill="black" stroke="black" points="89276.47,-205.57 89286.47,-202.06 89276.47,-198.57 89276.47,-205.57"/>
</g>
<!-- expert_9_3_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge213" class="edge">
<title>expert_9_3_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M84873.81,-268.3C84876.56,-267.82 84879.29,-267.38 84881.97,-266.98 85042.7,-243.42 85084.61,-253.11 85246.97,-247.98 86064.24,-222.19 88697.42,-205.94 89276.61,-202.62"/>
<polygon fill="black" stroke="black" points="89276.65,-206.12 89286.63,-202.56 89276.61,-199.12 89276.65,-206.12"/>
</g>
<!-- expert_9_4_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge214" class="edge">
<title>expert_9_4_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M85034.8,-268.26C85037.55,-267.79 85040.28,-267.36 85042.97,-266.98 85255.29,-237.23 85310.66,-253.48 85524.97,-247.98 87007.9,-209.94 88811.69,-203.3 89276.49,-202.2"/>
<polygon fill="black" stroke="black" points="89276.56,-205.7 89286.56,-202.18 89276.55,-198.7 89276.56,-205.7"/>
</g>
<!-- expert_9_5_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge215" class="edge">
<title>expert_9_5_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M85195.81,-268.3C85198.56,-267.82 85201.29,-267.38 85203.97,-266.98 85362.94,-243.63 85404.39,-253.17 85564.97,-247.98 87031.03,-200.61 88814.59,-200.75 89276.48,-201.68"/>
<polygon fill="black" stroke="black" points="89276.48,-205.18 89286.49,-201.7 89276.49,-198.18 89276.48,-205.18"/>
</g>
<!-- expert_9_6_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge216" class="edge">
<title>expert_9_6_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M85356.8,-268.26C85359.55,-267.79 85362.28,-267.36 85364.97,-266.98 85581.7,-236.7 85638.22,-253.63 85856.97,-247.98 87202.35,-213.25 88836.63,-204.27 89276.46,-202.41"/>
<polygon fill="black" stroke="black" points="89276.65,-205.91 89286.63,-202.37 89276.62,-198.91 89276.65,-205.91"/>
</g>
<!-- expert_9_7_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge217" class="edge">
<title>expert_9_7_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M85517.81,-268.3C85520.56,-267.82 85523.29,-267.38 85525.97,-266.98 85685.38,-243.58 85726.95,-253.26 85887.97,-247.98 87220.15,-204.29 88838.66,-201.7 89276.33,-201.86"/>
<polygon fill="black" stroke="black" points="89276.45,-205.36 89286.45,-201.87 89276.45,-198.36 89276.45,-205.36"/>
</g>
<!-- expert_9_8_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge218" class="edge">
<title>expert_9_8_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M85678.8,-268.26C85681.55,-267.79 85684.28,-267.36 85686.97,-266.98 85904.58,-236.59 85961.33,-253.78 86180.97,-247.98 87392.71,-216 88862.45,-205.16 89276.57,-202.63"/>
<polygon fill="black" stroke="black" points="89276.77,-206.13 89286.75,-202.57 89276.73,-199.13 89276.77,-206.13"/>
</g>
<!-- expert_9_9_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge219" class="edge">
<title>expert_9_9_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M85839.81,-268.3C85842.56,-267.82 85845.29,-267.38 85847.97,-266.98 86008.26,-243.48 86050.07,-253.38 86211.97,-247.98 87410.73,-208.04 88864.99,-202.77 89276.6,-202.09"/>
<polygon fill="black" stroke="black" points="89276.72,-205.59 89286.72,-202.07 89276.71,-198.59 89276.72,-205.59"/>
</g>
<!-- expert_9_10_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge220" class="edge">
<title>expert_9_10_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M86000.8,-268.25C86003.55,-267.78 86006.28,-267.36 86008.97,-266.98 86228.79,-236.33 86286.12,-253.98 86507.97,-247.98 87585.48,-218.88 88890.13,-206.19 89276.82,-202.9"/>
<polygon fill="black" stroke="black" points="89276.92,-206.4 89286.89,-202.81 89276.86,-199.4 89276.92,-206.4"/>
</g>
<!-- expert_9_11_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge221" class="edge">
<title>expert_9_11_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M86161.81,-268.3C86164.56,-267.82 86167.29,-267.38 86169.97,-266.98 86332.9,-243.16 86375.41,-253.53 86539.97,-247.98 87604.08,-212.09 88892.64,-204.04 89276.74,-202.39"/>
<polygon fill="black" stroke="black" points="89276.75,-205.89 89286.74,-202.35 89276.72,-198.89 89276.75,-205.89"/>
</g>
<!-- expert_9_12_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge222" class="edge">
<title>expert_9_12_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M86322.8,-268.26C86325.55,-267.79 86328.28,-267.36 86330.97,-266.98 86547.7,-236.7 86604.23,-254.17 86822.97,-247.98 87771.52,-221.17 88917.69,-207.15 89276.81,-203.18"/>
<polygon fill="black" stroke="black" points="89276.98,-206.68 89286.94,-203.07 89276.91,-199.68 89276.98,-206.68"/>
</g>
<!-- expert_9_13_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge223" class="edge">
<title>expert_9_13_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M86483.81,-268.3C86486.56,-267.82 86489.29,-267.38 86491.97,-266.98 86651.38,-243.58 86692.96,-253.67 86853.97,-247.98 87789.49,-214.96 88920.03,-205.07 89276.6,-202.66"/>
<polygon fill="black" stroke="black" points="89276.7,-206.16 89286.67,-202.59 89276.65,-199.16 89276.7,-206.16"/>
</g>
<!-- expert_9_14_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge224" class="edge">
<title>expert_9_14_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M86644.8,-268.25C86647.55,-267.78 86650.28,-267.36 86652.97,-266.98 86880.28,-235.43 86939.58,-254.58 87168.97,-247.98 87976.53,-224.76 88949.58,-208.75 89276.59,-203.69"/>
<polygon fill="black" stroke="black" points="89277.06,-207.19 89287.01,-203.53 89276.96,-200.19 89277.06,-207.19"/>
</g>
<!-- expert_9_15_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge225" class="edge">
<title>expert_9_15_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M86805.81,-268.29C86808.56,-267.81 86811.29,-267.37 86813.97,-266.98 86984.84,-242.21 87029.43,-254.02 87201.97,-247.98 87995.97,-220.2 88952.67,-207.12 89276.54,-203.26"/>
<polygon fill="black" stroke="black" points="89276.91,-206.76 89286.86,-203.14 89276.82,-199.76 89276.91,-206.76"/>
</g>
<!-- expert_9_16_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge226" class="edge">
<title>expert_9_16_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M86966.8,-268.26C86969.55,-267.79 86972.28,-267.36 86974.97,-266.98 87185.96,-237.39 87241.02,-254.74 87453.97,-247.98 88146.4,-226.03 88978.44,-209.62 89276.73,-204.05"/>
<polygon fill="black" stroke="black" points="89277.18,-207.55 89287.12,-203.86 89277.05,-200.55 89277.18,-207.55"/>
</g>
<!-- expert_9_17_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge227" class="edge">
<title>expert_9_17_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M87127.81,-268.31C87130.56,-267.83 87133.29,-267.38 87135.97,-266.98 87289.2,-244.32 87329.2,-254.07 87483.97,-247.98 88164.06,-221.22 88981.31,-207.78 89276.61,-203.52"/>
<polygon fill="black" stroke="black" points="89276.94,-207.02 89286.89,-203.38 89276.84,-200.02 89276.94,-207.02"/>
</g>
<!-- expert_9_18_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge228" class="edge">
<title>expert_9_18_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M87288.8,-268.23C87291.55,-267.77 87294.28,-267.35 87296.97,-266.98 87684.41,-214.33 88898.43,-204.28 89276.45,-202.41"/>
<polygon fill="black" stroke="black" points="89276.59,-205.91 89286.58,-202.36 89276.56,-198.91 89276.59,-205.91"/>
</g>
<!-- expert_9_19_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge229" class="edge">
<title>expert_9_19_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M87449.8,-268.26C87452.55,-267.79 87455.28,-267.36 87457.97,-266.98 87674.7,-236.7 87731.28,-255.7 87949.97,-247.98 88444.38,-230.54 89034.37,-212.6 89277.14,-205.34"/>
<polygon fill="black" stroke="black" points="89277.5,-208.83 89287.39,-205.03 89277.29,-201.83 89277.5,-208.83"/>
</g>
<!-- expert_9_20_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge230" class="edge">
<title>expert_9_20_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M87610.81,-268.31C87613.56,-267.82 87616.29,-267.38 87618.97,-266.98 87774.41,-244.06 87815,-254.75 87971.97,-247.98 88457.47,-227.05 89036.85,-211.06 89277.05,-204.84"/>
<polygon fill="black" stroke="black" points="89277.28,-208.33 89287.19,-204.57 89277.1,-201.33 89277.28,-208.33"/>
</g>
<!-- expert_9_21_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge231" class="edge">
<title>expert_9_21_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M87771.8,-268.26C87774.55,-267.79 87777.28,-267.36 87779.97,-266.98 88069.6,-226.25 88960.25,-208.7 89276.84,-203.63"/>
<polygon fill="black" stroke="black" points="89277.01,-207.13 89286.95,-203.47 89276.9,-200.13 89277.01,-207.13"/>
</g>
<!-- expert_9_22_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge232" class="edge">
<title>expert_9_22_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M87932.81,-268.31C87935.56,-267.83 87938.29,-267.38 87940.97,-266.98 88091.56,-244.64 88130.92,-255.36 88282.97,-247.98 88646.73,-230.32 89077.94,-213.63 89277.86,-206.13"/>
<polygon fill="black" stroke="black" points="89278.22,-209.62 89288.08,-205.75 89277.95,-202.63 89278.22,-209.62"/>
</g>
<!-- expert_9_23_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge233" class="edge">
<title>expert_9_23_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M88093.81,-268.3C88096.56,-267.82 88099.29,-267.37 88101.97,-266.98 88327.14,-234.16 89006.73,-212.49 89277.18,-204.95"/>
<polygon fill="black" stroke="black" points="89277.5,-208.44 89287.4,-204.67 89277.31,-201.45 89277.5,-208.44"/>
</g>
<!-- expert_9_24_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge234" class="edge">
<title>expert_9_24_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M88254.81,-268.34C88257.56,-267.85 88260.29,-267.39 88262.97,-266.98 88392.85,-247.13 88426.83,-255.83 88557.97,-247.98 88816.03,-232.54 89119.23,-216.25 89278.8,-207.81"/>
<polygon fill="black" stroke="black" points="89279.3,-211.29 89289.1,-207.27 89278.93,-204.3 89279.3,-211.29"/>
</g>
<!-- expert_9_25_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge235" class="edge">
<title>expert_9_25_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M88415.82,-268.35C88418.56,-267.86 88421.29,-267.4 88423.97,-266.98 88729.87,-219.77 89095.52,-206.85 89276.68,-203.32"/>
<polygon fill="black" stroke="black" points="89276.82,-206.82 89286.75,-203.13 89276.69,-199.82 89276.82,-206.82"/>
</g>
<!-- expert_9_26_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge236" class="edge">
<title>expert_9_26_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M88576.82,-268.4C88579.57,-267.89 88582.29,-267.42 88584.97,-266.98 88830.14,-227.46 89121.38,-211.52 89277.6,-205.44"/>
<polygon fill="black" stroke="black" points="89277.83,-208.94 89287.69,-205.06 89277.57,-201.94 89277.83,-208.94"/>
</g>
<!-- expert_9_27_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge237" class="edge">
<title>expert_9_27_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M88737.83,-268.47C88740.58,-267.94 88743.3,-267.44 88745.97,-266.98 88931.72,-235.13 89150.48,-217.12 89279.29,-208.48"/>
<polygon fill="black" stroke="black" points="89279.81,-211.96 89289.55,-207.8 89279.34,-204.97 89279.81,-211.96"/>
</g>
<!-- expert_9_28_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge238" class="edge">
<title>expert_9_28_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M88898.85,-268.58C88901.59,-268.02 88904.31,-267.49 88906.97,-266.98 89035.86,-242.67 89185.75,-223.97 89283.96,-213"/>
<polygon fill="black" stroke="black" points="89284.64,-216.45 89294.19,-211.87 89283.86,-209.49 89284.64,-216.45"/>
</g>
<!-- expert_9_29_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge239" class="edge">
<title>expert_9_29_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M89059.9,-268.81C89062.62,-268.18 89065.32,-267.57 89067.97,-266.98 89144.46,-249.95 89231.6,-232.48 89295.92,-219.95"/>
<polygon fill="black" stroke="black" points="89296.9,-223.32 89306.05,-217.98 89295.56,-216.45 89296.9,-223.32"/>
</g>
<!-- expert_9_30_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge240" class="edge">
<title>expert_9_30_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M89204.87,-266.89C89238.44,-255.12 89281.51,-240.02 89317.65,-227.35"/>
<polygon fill="black" stroke="black" points="89318.89,-230.62 89327.17,-224.01 89316.57,-224.02 89318.89,-230.62"/>
</g>
<!-- expert_9_31_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge241" class="edge">
<title>expert_9_31_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M89328.53,-266.89C89337.07,-257.86 89347.47,-246.88 89357.26,-236.54"/>
<polygon fill="black" stroke="black" points="89359.91,-238.83 89364.25,-229.16 89354.83,-234.02 89359.91,-238.83"/>
</g>
<!-- expert_9_32_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge242" class="edge">
<title>expert_9_32_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M89452.19,-266.89C89443.54,-257.86 89433.01,-246.88 89423.1,-236.54"/>
<polygon fill="black" stroke="black" points="89425.47,-233.96 89416.02,-229.16 89420.41,-238.8 89425.47,-233.96"/>
</g>
<!-- expert_9_33_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge243" class="edge">
<title>expert_9_33_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M89575.85,-266.89C89542.14,-255.12 89498.89,-240.02 89462.6,-227.35"/>
<polygon fill="black" stroke="black" points="89463.64,-224 89453.04,-224.01 89461.33,-230.61 89463.64,-224"/>
</g>
<!-- expert_9_34_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge244" class="edge">
<title>expert_9_34_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M89721.45,-269.11C89718.25,-268.38 89715.08,-267.67 89711.97,-266.98 89635.46,-250.06 89548.33,-232.58 89484.01,-220.02"/>
<polygon fill="black" stroke="black" points="89484.37,-216.52 89473.89,-218.04 89483.03,-223.39 89484.37,-216.52"/>
</g>
<!-- expert_9_35_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge245" class="edge">
<title>expert_9_35_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M89882.07,-268.77C89879,-268.14 89875.96,-267.54 89872.97,-266.98 89744.05,-242.86 89594.17,-224.12 89495.97,-213.09"/>
<polygon fill="black" stroke="black" points="89496.07,-209.58 89485.75,-211.95 89495.3,-216.54 89496.07,-209.58"/>
</g>
<!-- expert_9_36_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge246" class="edge">
<title>expert_9_36_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M90043.09,-268.64C90040.02,-268.05 90036.97,-267.49 90033.97,-266.98 89848.18,-235.39 89629.43,-217.3 89500.64,-208.58"/>
<polygon fill="black" stroke="black" points="89500.59,-205.07 89490.38,-207.89 89500.12,-212.05 89500.59,-205.07"/>
</g>
<!-- expert_9_37_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge247" class="edge">
<title>expert_9_37_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M90204.1,-268.57C90201.03,-267.99 90197.97,-267.46 90194.97,-266.98 89949.75,-227.81 89658.53,-211.73 89502.33,-205.54"/>
<polygon fill="black" stroke="black" points="89502.37,-202.04 89492.24,-205.15 89502.1,-209.04 89502.37,-202.04"/>
</g>
<!-- expert_9_38_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge248" class="edge">
<title>expert_9_38_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M90365.11,-268.52C90362.03,-267.96 90358.98,-267.44 90355.97,-266.98 90050.01,-220.2 89684.39,-207.1 89503.25,-203.42"/>
<polygon fill="black" stroke="black" points="89503.25,-199.92 89493.18,-203.22 89503.11,-206.92 89503.25,-199.92"/>
</g>
<!-- expert_9_39_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge249" class="edge">
<title>expert_9_39_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M90526.11,-268.51C90523.03,-267.95 90519.98,-267.44 90516.97,-266.98 90387.95,-247.42 90354.24,-255.8 90223.97,-247.98 89965.3,-232.46 89661.37,-216.2 89501.42,-207.79"/>
<polygon fill="black" stroke="black" points="89501.26,-204.28 89491.09,-207.25 89500.89,-211.27 89501.26,-204.28"/>
</g>
<!-- expert_9_40_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge250" class="edge">
<title>expert_9_40_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M90687.12,-268.45C90684.04,-267.91 90680.98,-267.42 90677.97,-266.98 90452.76,-234.48 89773.2,-212.62 89502.77,-204.99"/>
<polygon fill="black" stroke="black" points="89502.63,-201.49 89492.54,-204.7 89502.44,-208.48 89502.63,-201.49"/>
</g>
<!-- expert_9_41_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge251" class="edge">
<title>expert_9_41_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M90848.12,-268.47C90845.04,-267.93 90841.98,-267.42 90838.97,-266.98 90689.24,-244.96 90650.14,-255.34 90498.97,-247.98 90134.56,-230.25 89702.57,-213.59 89502.29,-206.12"/>
<polygon fill="black" stroke="black" points="89502.18,-202.61 89492.05,-205.73 89501.92,-209.6 89502.18,-202.61"/>
</g>
<!-- expert_9_42_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge252" class="edge">
<title>expert_9_42_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M91009.13,-268.41C91006.04,-267.88 91002.98,-267.4 90999.97,-266.98 90710.29,-226.66 89819.67,-208.85 89503.1,-203.68"/>
<polygon fill="black" stroke="black" points="89503.05,-200.17 89492.99,-203.51 89502.93,-207.17 89503.05,-200.17"/>
</g>
<!-- expert_9_43_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge253" class="edge">
<title>expert_9_43_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M91170.12,-268.47C91167.04,-267.92 91163.98,-267.42 91160.97,-266.98 91006.39,-244.38 90966.06,-254.73 90809.97,-247.98 90323.49,-226.94 89742.88,-211 89502.61,-204.81"/>
<polygon fill="black" stroke="black" points="89502.55,-201.31 89492.47,-204.55 89502.37,-208.3 89502.55,-201.31"/>
</g>
<!-- expert_9_44_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge254" class="edge">
<title>expert_9_44_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M91331.13,-268.41C91328.04,-267.88 91324.98,-267.4 91321.97,-266.98 91103,-236.74 91045.89,-255.75 90824.97,-247.98 90332.28,-230.67 89744.34,-212.66 89502.41,-205.36"/>
<polygon fill="black" stroke="black" points="89502.3,-201.85 89492.2,-205.05 89502.09,-208.85 89502.3,-201.85"/>
</g>
<!-- expert_9_45_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge255" class="edge">
<title>expert_9_45_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M91492.13,-268.38C91489.05,-267.86 91485.98,-267.39 91482.97,-266.98 91095.47,-214.88 89881.49,-204.45 89503.49,-202.45"/>
<polygon fill="black" stroke="black" points="89503.38,-198.95 89493.37,-202.4 89503.35,-205.95 89503.38,-198.95"/>
</g>
<!-- expert_9_46_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge256" class="edge">
<title>expert_9_46_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M91653.12,-268.47C91650.04,-267.92 91646.98,-267.42 91643.97,-266.98 91491.59,-244.65 91451.86,-254.06 91297.97,-247.98 90616.97,-221.08 89798.58,-207.72 89503.19,-203.51"/>
<polygon fill="black" stroke="black" points="89502.95,-200 89492.91,-203.36 89502.85,-207 89502.95,-200"/>
</g>
<!-- expert_9_47_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge257" class="edge">
<title>expert_9_47_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M91814.13,-268.41C91811.04,-267.88 91807.98,-267.4 91804.97,-266.98 91589.97,-237.21 91533.92,-254.79 91316.97,-247.98 90628.17,-226.36 89800.59,-209.76 89503.22,-204.1"/>
<polygon fill="black" stroke="black" points="89502.94,-200.59 89492.87,-203.9 89502.8,-207.59 89502.94,-200.59"/>
</g>
<!-- expert_9_48_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge258" class="edge">
<title>expert_9_48_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M91975.13,-268.4C91972.04,-267.87 91968.98,-267.4 91965.97,-266.98 91739.94,-235.91 91681.03,-254.75 91452.97,-247.98 90709.21,-225.92 89814.32,-209.38 89503.13,-203.93"/>
<polygon fill="black" stroke="black" points="89502.82,-200.42 89492.76,-203.75 89502.69,-207.42 89502.82,-200.42"/>
</g>
<!-- expert_9_49_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge259" class="edge">
<title>expert_9_49_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M92136.13,-268.4C92133.04,-267.87 92129.98,-267.4 92126.97,-266.98 91898.74,-235.64 91839.26,-254.59 91608.97,-247.98 90802.14,-224.83 89829.97,-208.77 89503.26,-203.7"/>
<polygon fill="black" stroke="black" points="89502.9,-200.2 89492.85,-203.54 89502.79,-207.2 89502.9,-200.2"/>
</g>
<!-- expert_9_50_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge260" class="edge">
<title>expert_9_50_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M92297.13,-268.4C92294.04,-267.87 92290.98,-267.4 92287.97,-266.98 92060.18,-235.7 92000.82,-254.43 91770.97,-247.98 90898.21,-223.52 89845.13,-208.12 89503.12,-203.48"/>
<polygon fill="black" stroke="black" points="89503.02,-199.98 89492.97,-203.34 89502.92,-206.98 89503.02,-199.98"/>
</g>
<!-- expert_9_51_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge261" class="edge">
<title>expert_9_51_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M92458.13,-268.4C92455.04,-267.87 92451.98,-267.4 92448.97,-266.98 92221.18,-235.7 92161.82,-254.28 91931.97,-247.98 90993.74,-222.26 89860.29,-207.54 89503.28,-203.29"/>
<polygon fill="black" stroke="black" points="89503.24,-199.79 89493.2,-203.17 89503.16,-206.79 89503.24,-199.79"/>
</g>
<!-- expert_9_52_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge262" class="edge">
<title>expert_9_52_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M92619.13,-268.4C92616.04,-267.87 92612.98,-267.4 92609.97,-266.98 92382.18,-235.7 92322.82,-254.16 92092.97,-247.98 91088.97,-221 89874.74,-206.99 89503.31,-203.12"/>
<polygon fill="black" stroke="black" points="89503.14,-199.62 89493.1,-203.01 89503.06,-206.62 89503.14,-199.62"/>
</g>
<!-- expert_9_53_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge263" class="edge">
<title>expert_9_53_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M92780.13,-268.4C92777.04,-267.87 92773.98,-267.4 92770.97,-266.98 92543.18,-235.7 92483.83,-254.05 92253.97,-247.98 91183.8,-219.73 89888.19,-206.47 89503.08,-202.97"/>
<polygon fill="black" stroke="black" points="89503.09,-199.47 89493.06,-202.88 89503.02,-206.47 89503.09,-199.47"/>
</g>
<!-- expert_9_54_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge264" class="edge">
<title>expert_9_54_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M92941.13,-268.4C92938.04,-267.87 92934.98,-267.4 92931.97,-266.98 92704.18,-235.7 92644.83,-253.95 92414.97,-247.98 91278.83,-218.47 89902.12,-205.99 89503.25,-202.83"/>
<polygon fill="black" stroke="black" points="89503.18,-199.33 89493.15,-202.75 89503.13,-206.33 89503.18,-199.33"/>
</g>
<!-- expert_9_55_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge265" class="edge">
<title>expert_9_55_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M93102.13,-268.4C93099.04,-267.87 93095.98,-267.4 93092.97,-266.98 92865.18,-235.7 92805.83,-253.86 92575.97,-247.98 91373.58,-217.21 89915.37,-205.53 89503.26,-202.71"/>
<polygon fill="black" stroke="black" points="89503.16,-199.21 89493.14,-202.64 89503.11,-206.21 89503.16,-199.21"/>
</g>
<!-- expert_9_56_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge266" class="edge">
<title>expert_9_56_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M93263.13,-268.4C93260.04,-267.87 93256.98,-267.4 93253.97,-266.98 93026.18,-235.7 92966.83,-253.78 92736.97,-247.98 91468.47,-215.96 89928.93,-205.11 89503.54,-202.61"/>
<polygon fill="black" stroke="black" points="89503.42,-199.1 89493.4,-202.55 89503.38,-206.1 89503.42,-199.1"/>
</g>
<!-- expert_9_57_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge267" class="edge">
<title>expert_9_57_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M93424.13,-268.4C93421.04,-267.87 93417.98,-267.4 93414.97,-266.98 93189.39,-235.96 93130.61,-253.7 92902.97,-247.98 91565.56,-214.42 89941.09,-204.61 89503.21,-202.49"/>
<polygon fill="black" stroke="black" points="89503.11,-198.99 89493.09,-202.44 89503.07,-205.99 89503.11,-198.99"/>
</g>
<!-- expert_9_58_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge268" class="edge">
<title>expert_9_58_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M93585.13,-268.4C93582.04,-267.87 93578.98,-267.4 93575.97,-266.98 93349.94,-235.91 93291.06,-253.63 93062.97,-247.98 91659.56,-213.21 89953.83,-204.23 89503.42,-202.4"/>
<polygon fill="black" stroke="black" points="89503.35,-198.9 89493.33,-202.36 89503.32,-205.9 89503.35,-198.9"/>
</g>
<!-- expert_9_59_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge269" class="edge">
<title>expert_9_59_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M93746.13,-268.4C93743.04,-267.87 93739.98,-267.4 93736.97,-266.98 93510.5,-235.85 93451.51,-253.58 93222.97,-247.98 91753.11,-212 89965.47,-203.87 89503.3,-202.32"/>
<polygon fill="black" stroke="black" points="89503.3,-198.82 89493.28,-202.29 89503.27,-205.82 89503.3,-198.82"/>
</g>
<!-- expert_9_60_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge270" class="edge">
<title>expert_9_60_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M93907.13,-268.4C93904.04,-267.87 93900.98,-267.4 93897.97,-266.98 93671.06,-235.8 93611.95,-253.52 93382.97,-247.98 91847.02,-210.81 89977.98,-203.53 89503.61,-202.25"/>
<polygon fill="black" stroke="black" points="89503.34,-198.75 89493.33,-202.22 89503.32,-205.75 89503.34,-198.75"/>
</g>
<!-- expert_9_61_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge271" class="edge">
<title>expert_9_61_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M94068.13,-268.4C94065.04,-267.87 94061.98,-267.4 94058.97,-266.98 93833.83,-236.01 93775.18,-253.46 93547.97,-247.98 91943.24,-209.28 89989.33,-203.11 89503.42,-202.16"/>
<polygon fill="black" stroke="black" points="89503.26,-198.66 89493.25,-202.14 89503.24,-205.66 89503.26,-198.66"/>
</g>
<!-- expert_9_62_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge272" class="edge">
<title>expert_9_62_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M94229.13,-268.4C94226.04,-267.87 94222.98,-267.4 94219.97,-266.98 93994.39,-235.96 93935.62,-253.42 93707.97,-247.98 92036.42,-208.07 90000.06,-202.79 89503.23,-202.1"/>
<polygon fill="black" stroke="black" points="89503.19,-198.6 89493.19,-202.08 89503.19,-205.6 89503.19,-198.6"/>
</g>
<!-- expert_9_63_stage2&#45;&gt;combine_9_stage2 -->
<g id="edge273" class="edge">
<title>expert_9_63_stage2&#45;&gt;combine_9_stage2</title>
<path fill="none" stroke="black" d="M94390.13,-268.4C94387.04,-267.87 94383.98,-267.4 94380.97,-266.98 94154.94,-235.91 94096.07,-253.38 93867.97,-247.98 92130.14,-206.88 90012.09,-202.49 89503.58,-202.04"/>
<polygon fill="black" stroke="black" points="89503.32,-198.54 89493.31,-202.03 89503.31,-205.54 89503.32,-198.54"/>
</g>
<!-- moe_out_9_stage2 -->
<g id="node658" class="node">
<title>moe_out_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89459.97,-135 89319.97,-135 89319.97,-94 89459.97,-94 89459.97,-135"/>
<text text-anchor="middle" x="89389.97" y="-123" font-family="Arial" font-size="10.00">MoE Output (TP8) L9</text>
<text text-anchor="middle" x="89389.97" y="-112" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="89389.97" y="-101" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- combine_9_stage2&#45;&gt;moe_out_9_stage2 -->
<g id="edge274" class="edge">
<title>combine_9_stage2&#45;&gt;moe_out_9_stage2</title>
<path fill="none" stroke="black" d="M89389.97,-171.86C89389.97,-163.32 89389.97,-153.93 89389.97,-145.29"/>
<polygon fill="black" stroke="black" points="89393.47,-145.24 89389.97,-135.24 89386.47,-145.24 89393.47,-145.24"/>
</g>
<!-- ln1_10_stage2 -->
<g id="node660" class="node">
<title>ln1_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89459.97,-57 89319.97,-57 89319.97,-16 89459.97,-16 89459.97,-57"/>
<text text-anchor="middle" x="89389.97" y="-45" font-family="Arial" font-size="10.00">LayerNorm (TP8) L10</text>
<text text-anchor="middle" x="89389.97" y="-34" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="89389.97" y="-23" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- moe_out_9_stage2&#45;&gt;ln1_10_stage2 -->
<g id="edge275" class="edge">
<title>moe_out_9_stage2&#45;&gt;ln1_10_stage2</title>
<path fill="none" stroke="black" d="M89389.97,-93.93C89389.97,-85.77 89389.97,-76.12 89389.97,-67.13"/>
<polygon fill="black" stroke="black" points="89393.47,-67.01 89389.97,-57.01 89386.47,-67.01 89393.47,-67.01"/>
</g>
<!-- ln2_9_stage2&#45;&gt;route_9_stage2 -->
<g id="edge144" class="edge">
<title>ln2_9_stage2&#45;&gt;route_9_stage2</title>
<path fill="none" stroke="black" d="M85535.13,-573.58C85757.86,-558.07 86450.75,-509.83 86731.27,-490.3"/>
<polygon fill="black" stroke="black" points="86731.74,-493.78 86741.48,-489.59 86731.26,-486.79 86731.74,-493.78"/>
</g>
<!-- qkv_10_stage2 -->
<g id="node661" class="node">
<title>qkv_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="168350.97,-965 168204.97,-965 168204.97,-924 168350.97,-924 168350.97,-965"/>
<text text-anchor="middle" x="168277.97" y="-953" font-family="Arial" font-size="10.00">QKV Projection (TP8) L10</text>
<text text-anchor="middle" x="168277.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="168277.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_10_stage2 -->
<g id="node662" class="node">
<title>attn_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="168186.97,-965 168040.97,-965 168040.97,-924 168186.97,-924 168186.97,-965"/>
<text text-anchor="middle" x="168113.97" y="-953" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L10</text>
<text text-anchor="middle" x="168113.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="168113.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_10_stage2 -->
<g id="node663" class="node">
<title>attn_out_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="168022.97,-965 167882.97,-965 167882.97,-924 168022.97,-924 168022.97,-965"/>
<text text-anchor="middle" x="167952.97" y="-953" font-family="Arial" font-size="10.00">Attention Output (TP8) L10</text>
<text text-anchor="middle" x="167952.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="167952.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_10_stage2 -->
<g id="node664" class="node">
<title>route_10_stage2</title>
<polygon fill="lightcoral" stroke="black" points="167865.27,-985.5 167634.14,-985.5 167574.68,-903.5 167805.81,-903.5 167865.27,-985.5"/>
<text text-anchor="middle" x="167719.97" y="-953" font-family="Arial" font-size="10.00">MoE Routing (EP64) L10</text>
<text text-anchor="middle" x="167719.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="167719.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_10_stage2 -->
<g id="node665" class="node">
<title>dispatch_10_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="167447.97" cy="-944.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="167447.97" y="-953" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L10</text>
<text text-anchor="middle" x="167447.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="167447.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_10_0_stage2 -->
<g id="node666" class="node">
<title>expert_10_0_stage2</title>
<polygon fill="lightgreen" stroke="black" points="167321.47,-965 167178.47,-965 167178.47,-924 167321.47,-924 167321.47,-965"/>
<text text-anchor="middle" x="167249.97" y="-953" font-family="Arial" font-size="10.00">Expert 0 (TP8) L10</text>
<text text-anchor="middle" x="167249.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="167249.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_1_stage2 -->
<g id="node667" class="node">
<title>expert_10_1_stage2</title>
<polygon fill="lightgreen" stroke="black" points="167160.47,-965 167017.47,-965 167017.47,-924 167160.47,-924 167160.47,-965"/>
<text text-anchor="middle" x="167088.97" y="-953" font-family="Arial" font-size="10.00">Expert 1 (TP8) L10</text>
<text text-anchor="middle" x="167088.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="167088.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_2_stage2 -->
<g id="node668" class="node">
<title>expert_10_2_stage2</title>
<polygon fill="lightgreen" stroke="black" points="166999.47,-965 166856.47,-965 166856.47,-924 166999.47,-924 166999.47,-965"/>
<text text-anchor="middle" x="166927.97" y="-953" font-family="Arial" font-size="10.00">Expert 2 (TP8) L10</text>
<text text-anchor="middle" x="166927.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="166927.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_3_stage2 -->
<g id="node669" class="node">
<title>expert_10_3_stage2</title>
<polygon fill="lightgreen" stroke="black" points="166838.47,-965 166695.47,-965 166695.47,-924 166838.47,-924 166838.47,-965"/>
<text text-anchor="middle" x="166766.97" y="-953" font-family="Arial" font-size="10.00">Expert 3 (TP8) L10</text>
<text text-anchor="middle" x="166766.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="166766.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_4_stage2 -->
<g id="node670" class="node">
<title>expert_10_4_stage2</title>
<polygon fill="lightgreen" stroke="black" points="166677.47,-965 166534.47,-965 166534.47,-924 166677.47,-924 166677.47,-965"/>
<text text-anchor="middle" x="166605.97" y="-953" font-family="Arial" font-size="10.00">Expert 4 (TP8) L10</text>
<text text-anchor="middle" x="166605.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="166605.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_5_stage2 -->
<g id="node671" class="node">
<title>expert_10_5_stage2</title>
<polygon fill="lightgreen" stroke="black" points="166516.47,-965 166373.47,-965 166373.47,-924 166516.47,-924 166516.47,-965"/>
<text text-anchor="middle" x="166444.97" y="-953" font-family="Arial" font-size="10.00">Expert 5 (TP8) L10</text>
<text text-anchor="middle" x="166444.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="166444.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_6_stage2 -->
<g id="node672" class="node">
<title>expert_10_6_stage2</title>
<polygon fill="lightgreen" stroke="black" points="166355.47,-965 166212.47,-965 166212.47,-924 166355.47,-924 166355.47,-965"/>
<text text-anchor="middle" x="166283.97" y="-953" font-family="Arial" font-size="10.00">Expert 6 (TP8) L10</text>
<text text-anchor="middle" x="166283.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="166283.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_7_stage2 -->
<g id="node673" class="node">
<title>expert_10_7_stage2</title>
<polygon fill="lightgreen" stroke="black" points="166194.47,-965 166051.47,-965 166051.47,-924 166194.47,-924 166194.47,-965"/>
<text text-anchor="middle" x="166122.97" y="-953" font-family="Arial" font-size="10.00">Expert 7 (TP8) L10</text>
<text text-anchor="middle" x="166122.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="166122.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_8_stage2 -->
<g id="node674" class="node">
<title>expert_10_8_stage2</title>
<polygon fill="lightgreen" stroke="black" points="166033.47,-965 165890.47,-965 165890.47,-924 166033.47,-924 166033.47,-965"/>
<text text-anchor="middle" x="165961.97" y="-953" font-family="Arial" font-size="10.00">Expert 8 (TP8) L10</text>
<text text-anchor="middle" x="165961.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="165961.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_9_stage2 -->
<g id="node675" class="node">
<title>expert_10_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="165872.47,-965 165729.47,-965 165729.47,-924 165872.47,-924 165872.47,-965"/>
<text text-anchor="middle" x="165800.97" y="-953" font-family="Arial" font-size="10.00">Expert 9 (TP8) L10</text>
<text text-anchor="middle" x="165800.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="165800.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_10_stage2 -->
<g id="node676" class="node">
<title>expert_10_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="165711.47,-965 165568.47,-965 165568.47,-924 165711.47,-924 165711.47,-965"/>
<text text-anchor="middle" x="165639.97" y="-953" font-family="Arial" font-size="10.00">Expert 10 (TP8) L10</text>
<text text-anchor="middle" x="165639.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="165639.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_11_stage2 -->
<g id="node677" class="node">
<title>expert_10_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="165550.47,-965 165407.47,-965 165407.47,-924 165550.47,-924 165550.47,-965"/>
<text text-anchor="middle" x="165478.97" y="-953" font-family="Arial" font-size="10.00">Expert 11 (TP8) L10</text>
<text text-anchor="middle" x="165478.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="165478.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_12_stage2 -->
<g id="node678" class="node">
<title>expert_10_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="165389.47,-965 165246.47,-965 165246.47,-924 165389.47,-924 165389.47,-965"/>
<text text-anchor="middle" x="165317.97" y="-953" font-family="Arial" font-size="10.00">Expert 12 (TP8) L10</text>
<text text-anchor="middle" x="165317.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="165317.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_13_stage2 -->
<g id="node679" class="node">
<title>expert_10_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="165228.47,-965 165085.47,-965 165085.47,-924 165228.47,-924 165228.47,-965"/>
<text text-anchor="middle" x="165156.97" y="-953" font-family="Arial" font-size="10.00">Expert 13 (TP8) L10</text>
<text text-anchor="middle" x="165156.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="165156.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_14_stage2 -->
<g id="node680" class="node">
<title>expert_10_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="165067.47,-965 164924.47,-965 164924.47,-924 165067.47,-924 165067.47,-965"/>
<text text-anchor="middle" x="164995.97" y="-953" font-family="Arial" font-size="10.00">Expert 14 (TP8) L10</text>
<text text-anchor="middle" x="164995.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="164995.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_15_stage2 -->
<g id="node681" class="node">
<title>expert_10_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="164906.47,-965 164763.47,-965 164763.47,-924 164906.47,-924 164906.47,-965"/>
<text text-anchor="middle" x="164834.97" y="-953" font-family="Arial" font-size="10.00">Expert 15 (TP8) L10</text>
<text text-anchor="middle" x="164834.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="164834.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_16_stage2 -->
<g id="node682" class="node">
<title>expert_10_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="164745.47,-965 164602.47,-965 164602.47,-924 164745.47,-924 164745.47,-965"/>
<text text-anchor="middle" x="164673.97" y="-953" font-family="Arial" font-size="10.00">Expert 16 (TP8) L10</text>
<text text-anchor="middle" x="164673.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="164673.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_17_stage2 -->
<g id="node683" class="node">
<title>expert_10_17_stage2</title>
<polygon fill="lightgreen" stroke="black" points="164584.47,-965 164441.47,-965 164441.47,-924 164584.47,-924 164584.47,-965"/>
<text text-anchor="middle" x="164512.97" y="-953" font-family="Arial" font-size="10.00">Expert 17 (TP8) L10</text>
<text text-anchor="middle" x="164512.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="164512.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_18_stage2 -->
<g id="node684" class="node">
<title>expert_10_18_stage2</title>
<polygon fill="lightgreen" stroke="black" points="164423.47,-965 164280.47,-965 164280.47,-924 164423.47,-924 164423.47,-965"/>
<text text-anchor="middle" x="164351.97" y="-953" font-family="Arial" font-size="10.00">Expert 18 (TP8) L10</text>
<text text-anchor="middle" x="164351.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="164351.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_19_stage2 -->
<g id="node685" class="node">
<title>expert_10_19_stage2</title>
<polygon fill="lightgreen" stroke="black" points="164262.47,-965 164119.47,-965 164119.47,-924 164262.47,-924 164262.47,-965"/>
<text text-anchor="middle" x="164190.97" y="-953" font-family="Arial" font-size="10.00">Expert 19 (TP8) L10</text>
<text text-anchor="middle" x="164190.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="164190.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_20_stage2 -->
<g id="node686" class="node">
<title>expert_10_20_stage2</title>
<polygon fill="lightgreen" stroke="black" points="164101.47,-965 163958.47,-965 163958.47,-924 164101.47,-924 164101.47,-965"/>
<text text-anchor="middle" x="164029.97" y="-953" font-family="Arial" font-size="10.00">Expert 20 (TP8) L10</text>
<text text-anchor="middle" x="164029.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="164029.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_21_stage2 -->
<g id="node687" class="node">
<title>expert_10_21_stage2</title>
<polygon fill="lightgreen" stroke="black" points="163940.47,-965 163797.47,-965 163797.47,-924 163940.47,-924 163940.47,-965"/>
<text text-anchor="middle" x="163868.97" y="-953" font-family="Arial" font-size="10.00">Expert 21 (TP8) L10</text>
<text text-anchor="middle" x="163868.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="163868.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_22_stage2 -->
<g id="node688" class="node">
<title>expert_10_22_stage2</title>
<polygon fill="lightgreen" stroke="black" points="163779.47,-965 163636.47,-965 163636.47,-924 163779.47,-924 163779.47,-965"/>
<text text-anchor="middle" x="163707.97" y="-953" font-family="Arial" font-size="10.00">Expert 22 (TP8) L10</text>
<text text-anchor="middle" x="163707.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="163707.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_23_stage2 -->
<g id="node689" class="node">
<title>expert_10_23_stage2</title>
<polygon fill="lightgreen" stroke="black" points="163618.47,-965 163475.47,-965 163475.47,-924 163618.47,-924 163618.47,-965"/>
<text text-anchor="middle" x="163546.97" y="-953" font-family="Arial" font-size="10.00">Expert 23 (TP8) L10</text>
<text text-anchor="middle" x="163546.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="163546.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_24_stage2 -->
<g id="node690" class="node">
<title>expert_10_24_stage2</title>
<polygon fill="lightgreen" stroke="black" points="163457.47,-965 163314.47,-965 163314.47,-924 163457.47,-924 163457.47,-965"/>
<text text-anchor="middle" x="163385.97" y="-953" font-family="Arial" font-size="10.00">Expert 24 (TP8) L10</text>
<text text-anchor="middle" x="163385.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="163385.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_25_stage2 -->
<g id="node691" class="node">
<title>expert_10_25_stage2</title>
<polygon fill="lightgreen" stroke="black" points="163296.47,-965 163153.47,-965 163153.47,-924 163296.47,-924 163296.47,-965"/>
<text text-anchor="middle" x="163224.97" y="-953" font-family="Arial" font-size="10.00">Expert 25 (TP8) L10</text>
<text text-anchor="middle" x="163224.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="163224.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_26_stage2 -->
<g id="node692" class="node">
<title>expert_10_26_stage2</title>
<polygon fill="lightgreen" stroke="black" points="163135.47,-965 162992.47,-965 162992.47,-924 163135.47,-924 163135.47,-965"/>
<text text-anchor="middle" x="163063.97" y="-953" font-family="Arial" font-size="10.00">Expert 26 (TP8) L10</text>
<text text-anchor="middle" x="163063.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="163063.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_27_stage2 -->
<g id="node693" class="node">
<title>expert_10_27_stage2</title>
<polygon fill="lightgreen" stroke="black" points="162974.47,-965 162831.47,-965 162831.47,-924 162974.47,-924 162974.47,-965"/>
<text text-anchor="middle" x="162902.97" y="-953" font-family="Arial" font-size="10.00">Expert 27 (TP8) L10</text>
<text text-anchor="middle" x="162902.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="162902.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_28_stage2 -->
<g id="node694" class="node">
<title>expert_10_28_stage2</title>
<polygon fill="lightgreen" stroke="black" points="162813.47,-965 162670.47,-965 162670.47,-924 162813.47,-924 162813.47,-965"/>
<text text-anchor="middle" x="162741.97" y="-953" font-family="Arial" font-size="10.00">Expert 28 (TP8) L10</text>
<text text-anchor="middle" x="162741.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="162741.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_29_stage2 -->
<g id="node695" class="node">
<title>expert_10_29_stage2</title>
<polygon fill="lightgreen" stroke="black" points="162652.47,-965 162509.47,-965 162509.47,-924 162652.47,-924 162652.47,-965"/>
<text text-anchor="middle" x="162580.97" y="-953" font-family="Arial" font-size="10.00">Expert 29 (TP8) L10</text>
<text text-anchor="middle" x="162580.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="162580.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_30_stage2 -->
<g id="node696" class="node">
<title>expert_10_30_stage2</title>
<polygon fill="lightgreen" stroke="black" points="162491.47,-965 162348.47,-965 162348.47,-924 162491.47,-924 162491.47,-965"/>
<text text-anchor="middle" x="162419.97" y="-953" font-family="Arial" font-size="10.00">Expert 30 (TP8) L10</text>
<text text-anchor="middle" x="162419.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="162419.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_31_stage2 -->
<g id="node697" class="node">
<title>expert_10_31_stage2</title>
<polygon fill="lightgreen" stroke="black" points="162330.47,-965 162187.47,-965 162187.47,-924 162330.47,-924 162330.47,-965"/>
<text text-anchor="middle" x="162258.97" y="-953" font-family="Arial" font-size="10.00">Expert 31 (TP8) L10</text>
<text text-anchor="middle" x="162258.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="162258.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_32_stage2 -->
<g id="node698" class="node">
<title>expert_10_32_stage2</title>
<polygon fill="lightgreen" stroke="black" points="162169.47,-965 162026.47,-965 162026.47,-924 162169.47,-924 162169.47,-965"/>
<text text-anchor="middle" x="162097.97" y="-953" font-family="Arial" font-size="10.00">Expert 32 (TP8) L10</text>
<text text-anchor="middle" x="162097.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="162097.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_33_stage2 -->
<g id="node699" class="node">
<title>expert_10_33_stage2</title>
<polygon fill="lightgreen" stroke="black" points="162008.47,-965 161865.47,-965 161865.47,-924 162008.47,-924 162008.47,-965"/>
<text text-anchor="middle" x="161936.97" y="-953" font-family="Arial" font-size="10.00">Expert 33 (TP8) L10</text>
<text text-anchor="middle" x="161936.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="161936.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_34_stage2 -->
<g id="node700" class="node">
<title>expert_10_34_stage2</title>
<polygon fill="lightgreen" stroke="black" points="161847.47,-965 161704.47,-965 161704.47,-924 161847.47,-924 161847.47,-965"/>
<text text-anchor="middle" x="161775.97" y="-953" font-family="Arial" font-size="10.00">Expert 34 (TP8) L10</text>
<text text-anchor="middle" x="161775.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="161775.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_35_stage2 -->
<g id="node701" class="node">
<title>expert_10_35_stage2</title>
<polygon fill="lightgreen" stroke="black" points="161686.47,-965 161543.47,-965 161543.47,-924 161686.47,-924 161686.47,-965"/>
<text text-anchor="middle" x="161614.97" y="-953" font-family="Arial" font-size="10.00">Expert 35 (TP8) L10</text>
<text text-anchor="middle" x="161614.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="161614.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_36_stage2 -->
<g id="node702" class="node">
<title>expert_10_36_stage2</title>
<polygon fill="lightgreen" stroke="black" points="161525.47,-965 161382.47,-965 161382.47,-924 161525.47,-924 161525.47,-965"/>
<text text-anchor="middle" x="161453.97" y="-953" font-family="Arial" font-size="10.00">Expert 36 (TP8) L10</text>
<text text-anchor="middle" x="161453.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="161453.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_37_stage2 -->
<g id="node703" class="node">
<title>expert_10_37_stage2</title>
<polygon fill="lightgreen" stroke="black" points="161364.47,-965 161221.47,-965 161221.47,-924 161364.47,-924 161364.47,-965"/>
<text text-anchor="middle" x="161292.97" y="-953" font-family="Arial" font-size="10.00">Expert 37 (TP8) L10</text>
<text text-anchor="middle" x="161292.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="161292.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_38_stage2 -->
<g id="node704" class="node">
<title>expert_10_38_stage2</title>
<polygon fill="lightgreen" stroke="black" points="161203.47,-965 161060.47,-965 161060.47,-924 161203.47,-924 161203.47,-965"/>
<text text-anchor="middle" x="161131.97" y="-953" font-family="Arial" font-size="10.00">Expert 38 (TP8) L10</text>
<text text-anchor="middle" x="161131.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="161131.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_39_stage2 -->
<g id="node705" class="node">
<title>expert_10_39_stage2</title>
<polygon fill="lightgreen" stroke="black" points="161042.47,-965 160899.47,-965 160899.47,-924 161042.47,-924 161042.47,-965"/>
<text text-anchor="middle" x="160970.97" y="-953" font-family="Arial" font-size="10.00">Expert 39 (TP8) L10</text>
<text text-anchor="middle" x="160970.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="160970.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_40_stage2 -->
<g id="node706" class="node">
<title>expert_10_40_stage2</title>
<polygon fill="lightgreen" stroke="black" points="160881.47,-965 160738.47,-965 160738.47,-924 160881.47,-924 160881.47,-965"/>
<text text-anchor="middle" x="160809.97" y="-953" font-family="Arial" font-size="10.00">Expert 40 (TP8) L10</text>
<text text-anchor="middle" x="160809.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="160809.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_41_stage2 -->
<g id="node707" class="node">
<title>expert_10_41_stage2</title>
<polygon fill="lightgreen" stroke="black" points="160720.47,-965 160577.47,-965 160577.47,-924 160720.47,-924 160720.47,-965"/>
<text text-anchor="middle" x="160648.97" y="-953" font-family="Arial" font-size="10.00">Expert 41 (TP8) L10</text>
<text text-anchor="middle" x="160648.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="160648.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_42_stage2 -->
<g id="node708" class="node">
<title>expert_10_42_stage2</title>
<polygon fill="lightgreen" stroke="black" points="160559.47,-965 160416.47,-965 160416.47,-924 160559.47,-924 160559.47,-965"/>
<text text-anchor="middle" x="160487.97" y="-953" font-family="Arial" font-size="10.00">Expert 42 (TP8) L10</text>
<text text-anchor="middle" x="160487.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="160487.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_43_stage2 -->
<g id="node709" class="node">
<title>expert_10_43_stage2</title>
<polygon fill="lightgreen" stroke="black" points="160398.47,-965 160255.47,-965 160255.47,-924 160398.47,-924 160398.47,-965"/>
<text text-anchor="middle" x="160326.97" y="-953" font-family="Arial" font-size="10.00">Expert 43 (TP8) L10</text>
<text text-anchor="middle" x="160326.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="160326.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_44_stage2 -->
<g id="node710" class="node">
<title>expert_10_44_stage2</title>
<polygon fill="lightgreen" stroke="black" points="160237.47,-965 160094.47,-965 160094.47,-924 160237.47,-924 160237.47,-965"/>
<text text-anchor="middle" x="160165.97" y="-953" font-family="Arial" font-size="10.00">Expert 44 (TP8) L10</text>
<text text-anchor="middle" x="160165.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="160165.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_45_stage2 -->
<g id="node711" class="node">
<title>expert_10_45_stage2</title>
<polygon fill="lightgreen" stroke="black" points="160076.47,-965 159933.47,-965 159933.47,-924 160076.47,-924 160076.47,-965"/>
<text text-anchor="middle" x="160004.97" y="-953" font-family="Arial" font-size="10.00">Expert 45 (TP8) L10</text>
<text text-anchor="middle" x="160004.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="160004.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_46_stage2 -->
<g id="node712" class="node">
<title>expert_10_46_stage2</title>
<polygon fill="lightgreen" stroke="black" points="159915.47,-965 159772.47,-965 159772.47,-924 159915.47,-924 159915.47,-965"/>
<text text-anchor="middle" x="159843.97" y="-953" font-family="Arial" font-size="10.00">Expert 46 (TP8) L10</text>
<text text-anchor="middle" x="159843.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="159843.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_47_stage2 -->
<g id="node713" class="node">
<title>expert_10_47_stage2</title>
<polygon fill="lightgreen" stroke="black" points="159754.47,-965 159611.47,-965 159611.47,-924 159754.47,-924 159754.47,-965"/>
<text text-anchor="middle" x="159682.97" y="-953" font-family="Arial" font-size="10.00">Expert 47 (TP8) L10</text>
<text text-anchor="middle" x="159682.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="159682.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_48_stage2 -->
<g id="node714" class="node">
<title>expert_10_48_stage2</title>
<polygon fill="lightgreen" stroke="black" points="159593.47,-965 159450.47,-965 159450.47,-924 159593.47,-924 159593.47,-965"/>
<text text-anchor="middle" x="159521.97" y="-953" font-family="Arial" font-size="10.00">Expert 48 (TP8) L10</text>
<text text-anchor="middle" x="159521.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="159521.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_49_stage2 -->
<g id="node715" class="node">
<title>expert_10_49_stage2</title>
<polygon fill="lightgreen" stroke="black" points="159432.47,-965 159289.47,-965 159289.47,-924 159432.47,-924 159432.47,-965"/>
<text text-anchor="middle" x="159360.97" y="-953" font-family="Arial" font-size="10.00">Expert 49 (TP8) L10</text>
<text text-anchor="middle" x="159360.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="159360.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_50_stage2 -->
<g id="node716" class="node">
<title>expert_10_50_stage2</title>
<polygon fill="lightgreen" stroke="black" points="159271.47,-965 159128.47,-965 159128.47,-924 159271.47,-924 159271.47,-965"/>
<text text-anchor="middle" x="159199.97" y="-953" font-family="Arial" font-size="10.00">Expert 50 (TP8) L10</text>
<text text-anchor="middle" x="159199.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="159199.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_51_stage2 -->
<g id="node717" class="node">
<title>expert_10_51_stage2</title>
<polygon fill="lightgreen" stroke="black" points="159110.47,-965 158967.47,-965 158967.47,-924 159110.47,-924 159110.47,-965"/>
<text text-anchor="middle" x="159038.97" y="-953" font-family="Arial" font-size="10.00">Expert 51 (TP8) L10</text>
<text text-anchor="middle" x="159038.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="159038.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_52_stage2 -->
<g id="node718" class="node">
<title>expert_10_52_stage2</title>
<polygon fill="lightgreen" stroke="black" points="158949.47,-965 158806.47,-965 158806.47,-924 158949.47,-924 158949.47,-965"/>
<text text-anchor="middle" x="158877.97" y="-953" font-family="Arial" font-size="10.00">Expert 52 (TP8) L10</text>
<text text-anchor="middle" x="158877.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="158877.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_53_stage2 -->
<g id="node719" class="node">
<title>expert_10_53_stage2</title>
<polygon fill="lightgreen" stroke="black" points="158788.47,-965 158645.47,-965 158645.47,-924 158788.47,-924 158788.47,-965"/>
<text text-anchor="middle" x="158716.97" y="-953" font-family="Arial" font-size="10.00">Expert 53 (TP8) L10</text>
<text text-anchor="middle" x="158716.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="158716.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_54_stage2 -->
<g id="node720" class="node">
<title>expert_10_54_stage2</title>
<polygon fill="lightgreen" stroke="black" points="158627.47,-965 158484.47,-965 158484.47,-924 158627.47,-924 158627.47,-965"/>
<text text-anchor="middle" x="158555.97" y="-953" font-family="Arial" font-size="10.00">Expert 54 (TP8) L10</text>
<text text-anchor="middle" x="158555.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="158555.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_55_stage2 -->
<g id="node721" class="node">
<title>expert_10_55_stage2</title>
<polygon fill="lightgreen" stroke="black" points="158466.47,-965 158323.47,-965 158323.47,-924 158466.47,-924 158466.47,-965"/>
<text text-anchor="middle" x="158394.97" y="-953" font-family="Arial" font-size="10.00">Expert 55 (TP8) L10</text>
<text text-anchor="middle" x="158394.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="158394.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_56_stage2 -->
<g id="node722" class="node">
<title>expert_10_56_stage2</title>
<polygon fill="lightgreen" stroke="black" points="158305.47,-965 158162.47,-965 158162.47,-924 158305.47,-924 158305.47,-965"/>
<text text-anchor="middle" x="158233.97" y="-953" font-family="Arial" font-size="10.00">Expert 56 (TP8) L10</text>
<text text-anchor="middle" x="158233.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="158233.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_57_stage2 -->
<g id="node723" class="node">
<title>expert_10_57_stage2</title>
<polygon fill="lightgreen" stroke="black" points="158144.47,-965 158001.47,-965 158001.47,-924 158144.47,-924 158144.47,-965"/>
<text text-anchor="middle" x="158072.97" y="-953" font-family="Arial" font-size="10.00">Expert 57 (TP8) L10</text>
<text text-anchor="middle" x="158072.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="158072.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_58_stage2 -->
<g id="node724" class="node">
<title>expert_10_58_stage2</title>
<polygon fill="lightgreen" stroke="black" points="157983.47,-965 157840.47,-965 157840.47,-924 157983.47,-924 157983.47,-965"/>
<text text-anchor="middle" x="157911.97" y="-953" font-family="Arial" font-size="10.00">Expert 58 (TP8) L10</text>
<text text-anchor="middle" x="157911.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="157911.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_59_stage2 -->
<g id="node725" class="node">
<title>expert_10_59_stage2</title>
<polygon fill="lightgreen" stroke="black" points="157822.47,-965 157679.47,-965 157679.47,-924 157822.47,-924 157822.47,-965"/>
<text text-anchor="middle" x="157750.97" y="-953" font-family="Arial" font-size="10.00">Expert 59 (TP8) L10</text>
<text text-anchor="middle" x="157750.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="157750.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_60_stage2 -->
<g id="node726" class="node">
<title>expert_10_60_stage2</title>
<polygon fill="lightgreen" stroke="black" points="157661.47,-965 157518.47,-965 157518.47,-924 157661.47,-924 157661.47,-965"/>
<text text-anchor="middle" x="157589.97" y="-953" font-family="Arial" font-size="10.00">Expert 60 (TP8) L10</text>
<text text-anchor="middle" x="157589.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="157589.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_61_stage2 -->
<g id="node727" class="node">
<title>expert_10_61_stage2</title>
<polygon fill="lightgreen" stroke="black" points="157500.47,-965 157357.47,-965 157357.47,-924 157500.47,-924 157500.47,-965"/>
<text text-anchor="middle" x="157428.97" y="-953" font-family="Arial" font-size="10.00">Expert 61 (TP8) L10</text>
<text text-anchor="middle" x="157428.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="157428.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_62_stage2 -->
<g id="node728" class="node">
<title>expert_10_62_stage2</title>
<polygon fill="lightgreen" stroke="black" points="157339.47,-965 157196.47,-965 157196.47,-924 157339.47,-924 157339.47,-965"/>
<text text-anchor="middle" x="157267.97" y="-953" font-family="Arial" font-size="10.00">Expert 62 (TP8) L10</text>
<text text-anchor="middle" x="157267.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="157267.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_10_63_stage2 -->
<g id="node729" class="node">
<title>expert_10_63_stage2</title>
<polygon fill="lightgreen" stroke="black" points="157178.47,-965 157035.47,-965 157035.47,-924 157178.47,-924 157178.47,-965"/>
<text text-anchor="middle" x="157106.97" y="-953" font-family="Arial" font-size="10.00">Expert 63 (TP8) L10</text>
<text text-anchor="middle" x="157106.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="157106.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_10_stage2 -->
<g id="node730" class="node">
<title>combine_10_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="156909.97" cy="-944.5" rx="107.46" ry="28.98"/>
<text text-anchor="middle" x="156909.97" y="-953" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L10</text>
<text text-anchor="middle" x="156909.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="156909.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_10_stage2 -->
<g id="node731" class="node">
<title>moe_out_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="156784.97,-965 156644.97,-965 156644.97,-924 156784.97,-924 156784.97,-965"/>
<text text-anchor="middle" x="156714.97" y="-953" font-family="Arial" font-size="10.00">MoE Output (TP8) L10</text>
<text text-anchor="middle" x="156714.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="156714.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_10_stage2 -->
<g id="node732" class="node">
<title>ln2_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="156626.97,-965 156486.97,-965 156486.97,-924 156626.97,-924 156626.97,-965"/>
<text text-anchor="middle" x="156556.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L10</text>
<text text-anchor="middle" x="156556.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="156556.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_11_stage2 -->
<g id="node733" class="node">
<title>ln1_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="156468.97,-965 156328.97,-965 156328.97,-924 156468.97,-924 156468.97,-965"/>
<text text-anchor="middle" x="156398.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L11</text>
<text text-anchor="middle" x="156398.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="156398.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_11_stage2 -->
<g id="node734" class="node">
<title>qkv_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="156310.97,-965 156164.97,-965 156164.97,-924 156310.97,-924 156310.97,-965"/>
<text text-anchor="middle" x="156237.97" y="-953" font-family="Arial" font-size="10.00">QKV Projection (TP8) L11</text>
<text text-anchor="middle" x="156237.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="156237.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_11_stage2 -->
<g id="node735" class="node">
<title>attn_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="156146.97,-965 156000.97,-965 156000.97,-924 156146.97,-924 156146.97,-965"/>
<text text-anchor="middle" x="156073.97" y="-953" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L11</text>
<text text-anchor="middle" x="156073.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="156073.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_11_stage2 -->
<g id="node736" class="node">
<title>attn_out_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="155982.97,-965 155842.97,-965 155842.97,-924 155982.97,-924 155982.97,-965"/>
<text text-anchor="middle" x="155912.97" y="-953" font-family="Arial" font-size="10.00">Attention Output (TP8) L11</text>
<text text-anchor="middle" x="155912.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="155912.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_11_stage2 -->
<g id="node737" class="node">
<title>route_11_stage2</title>
<polygon fill="lightcoral" stroke="black" points="155825.27,-985.5 155594.14,-985.5 155534.68,-903.5 155765.81,-903.5 155825.27,-985.5"/>
<text text-anchor="middle" x="155679.97" y="-953" font-family="Arial" font-size="10.00">MoE Routing (EP64) L11</text>
<text text-anchor="middle" x="155679.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="155679.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_11_stage2 -->
<g id="node738" class="node">
<title>dispatch_11_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="155407.97" cy="-944.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="155407.97" y="-953" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L11</text>
<text text-anchor="middle" x="155407.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="155407.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_11_0_stage2 -->
<g id="node739" class="node">
<title>expert_11_0_stage2</title>
<polygon fill="lightgreen" stroke="black" points="155281.47,-965 155138.47,-965 155138.47,-924 155281.47,-924 155281.47,-965"/>
<text text-anchor="middle" x="155209.97" y="-953" font-family="Arial" font-size="10.00">Expert 0 (TP8) L11</text>
<text text-anchor="middle" x="155209.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="155209.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_1_stage2 -->
<g id="node740" class="node">
<title>expert_11_1_stage2</title>
<polygon fill="lightgreen" stroke="black" points="155120.47,-965 154977.47,-965 154977.47,-924 155120.47,-924 155120.47,-965"/>
<text text-anchor="middle" x="155048.97" y="-953" font-family="Arial" font-size="10.00">Expert 1 (TP8) L11</text>
<text text-anchor="middle" x="155048.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="155048.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_2_stage2 -->
<g id="node741" class="node">
<title>expert_11_2_stage2</title>
<polygon fill="lightgreen" stroke="black" points="154959.47,-965 154816.47,-965 154816.47,-924 154959.47,-924 154959.47,-965"/>
<text text-anchor="middle" x="154887.97" y="-953" font-family="Arial" font-size="10.00">Expert 2 (TP8) L11</text>
<text text-anchor="middle" x="154887.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="154887.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_3_stage2 -->
<g id="node742" class="node">
<title>expert_11_3_stage2</title>
<polygon fill="lightgreen" stroke="black" points="154798.47,-965 154655.47,-965 154655.47,-924 154798.47,-924 154798.47,-965"/>
<text text-anchor="middle" x="154726.97" y="-953" font-family="Arial" font-size="10.00">Expert 3 (TP8) L11</text>
<text text-anchor="middle" x="154726.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="154726.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_4_stage2 -->
<g id="node743" class="node">
<title>expert_11_4_stage2</title>
<polygon fill="lightgreen" stroke="black" points="154637.47,-965 154494.47,-965 154494.47,-924 154637.47,-924 154637.47,-965"/>
<text text-anchor="middle" x="154565.97" y="-953" font-family="Arial" font-size="10.00">Expert 4 (TP8) L11</text>
<text text-anchor="middle" x="154565.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="154565.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_5_stage2 -->
<g id="node744" class="node">
<title>expert_11_5_stage2</title>
<polygon fill="lightgreen" stroke="black" points="154476.47,-965 154333.47,-965 154333.47,-924 154476.47,-924 154476.47,-965"/>
<text text-anchor="middle" x="154404.97" y="-953" font-family="Arial" font-size="10.00">Expert 5 (TP8) L11</text>
<text text-anchor="middle" x="154404.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="154404.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_6_stage2 -->
<g id="node745" class="node">
<title>expert_11_6_stage2</title>
<polygon fill="lightgreen" stroke="black" points="154315.47,-965 154172.47,-965 154172.47,-924 154315.47,-924 154315.47,-965"/>
<text text-anchor="middle" x="154243.97" y="-953" font-family="Arial" font-size="10.00">Expert 6 (TP8) L11</text>
<text text-anchor="middle" x="154243.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="154243.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_7_stage2 -->
<g id="node746" class="node">
<title>expert_11_7_stage2</title>
<polygon fill="lightgreen" stroke="black" points="154154.47,-965 154011.47,-965 154011.47,-924 154154.47,-924 154154.47,-965"/>
<text text-anchor="middle" x="154082.97" y="-953" font-family="Arial" font-size="10.00">Expert 7 (TP8) L11</text>
<text text-anchor="middle" x="154082.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="154082.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_8_stage2 -->
<g id="node747" class="node">
<title>expert_11_8_stage2</title>
<polygon fill="lightgreen" stroke="black" points="153993.47,-965 153850.47,-965 153850.47,-924 153993.47,-924 153993.47,-965"/>
<text text-anchor="middle" x="153921.97" y="-953" font-family="Arial" font-size="10.00">Expert 8 (TP8) L11</text>
<text text-anchor="middle" x="153921.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="153921.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_9_stage2 -->
<g id="node748" class="node">
<title>expert_11_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="153832.47,-965 153689.47,-965 153689.47,-924 153832.47,-924 153832.47,-965"/>
<text text-anchor="middle" x="153760.97" y="-953" font-family="Arial" font-size="10.00">Expert 9 (TP8) L11</text>
<text text-anchor="middle" x="153760.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="153760.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_10_stage2 -->
<g id="node749" class="node">
<title>expert_11_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="153671.47,-965 153528.47,-965 153528.47,-924 153671.47,-924 153671.47,-965"/>
<text text-anchor="middle" x="153599.97" y="-953" font-family="Arial" font-size="10.00">Expert 10 (TP8) L11</text>
<text text-anchor="middle" x="153599.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="153599.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_11_stage2 -->
<g id="node750" class="node">
<title>expert_11_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="153510.47,-965 153367.47,-965 153367.47,-924 153510.47,-924 153510.47,-965"/>
<text text-anchor="middle" x="153438.97" y="-953" font-family="Arial" font-size="10.00">Expert 11 (TP8) L11</text>
<text text-anchor="middle" x="153438.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="153438.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_12_stage2 -->
<g id="node751" class="node">
<title>expert_11_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="153349.47,-965 153206.47,-965 153206.47,-924 153349.47,-924 153349.47,-965"/>
<text text-anchor="middle" x="153277.97" y="-953" font-family="Arial" font-size="10.00">Expert 12 (TP8) L11</text>
<text text-anchor="middle" x="153277.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="153277.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_13_stage2 -->
<g id="node752" class="node">
<title>expert_11_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="153188.47,-965 153045.47,-965 153045.47,-924 153188.47,-924 153188.47,-965"/>
<text text-anchor="middle" x="153116.97" y="-953" font-family="Arial" font-size="10.00">Expert 13 (TP8) L11</text>
<text text-anchor="middle" x="153116.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="153116.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_14_stage2 -->
<g id="node753" class="node">
<title>expert_11_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="153027.47,-965 152884.47,-965 152884.47,-924 153027.47,-924 153027.47,-965"/>
<text text-anchor="middle" x="152955.97" y="-953" font-family="Arial" font-size="10.00">Expert 14 (TP8) L11</text>
<text text-anchor="middle" x="152955.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="152955.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_15_stage2 -->
<g id="node754" class="node">
<title>expert_11_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="152866.47,-965 152723.47,-965 152723.47,-924 152866.47,-924 152866.47,-965"/>
<text text-anchor="middle" x="152794.97" y="-953" font-family="Arial" font-size="10.00">Expert 15 (TP8) L11</text>
<text text-anchor="middle" x="152794.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="152794.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_16_stage2 -->
<g id="node755" class="node">
<title>expert_11_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="152705.47,-965 152562.47,-965 152562.47,-924 152705.47,-924 152705.47,-965"/>
<text text-anchor="middle" x="152633.97" y="-953" font-family="Arial" font-size="10.00">Expert 16 (TP8) L11</text>
<text text-anchor="middle" x="152633.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="152633.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_17_stage2 -->
<g id="node756" class="node">
<title>expert_11_17_stage2</title>
<polygon fill="lightgreen" stroke="black" points="152544.47,-965 152401.47,-965 152401.47,-924 152544.47,-924 152544.47,-965"/>
<text text-anchor="middle" x="152472.97" y="-953" font-family="Arial" font-size="10.00">Expert 17 (TP8) L11</text>
<text text-anchor="middle" x="152472.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="152472.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_18_stage2 -->
<g id="node757" class="node">
<title>expert_11_18_stage2</title>
<polygon fill="lightgreen" stroke="black" points="152383.47,-965 152240.47,-965 152240.47,-924 152383.47,-924 152383.47,-965"/>
<text text-anchor="middle" x="152311.97" y="-953" font-family="Arial" font-size="10.00">Expert 18 (TP8) L11</text>
<text text-anchor="middle" x="152311.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="152311.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_19_stage2 -->
<g id="node758" class="node">
<title>expert_11_19_stage2</title>
<polygon fill="lightgreen" stroke="black" points="152222.47,-965 152079.47,-965 152079.47,-924 152222.47,-924 152222.47,-965"/>
<text text-anchor="middle" x="152150.97" y="-953" font-family="Arial" font-size="10.00">Expert 19 (TP8) L11</text>
<text text-anchor="middle" x="152150.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="152150.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_20_stage2 -->
<g id="node759" class="node">
<title>expert_11_20_stage2</title>
<polygon fill="lightgreen" stroke="black" points="152061.47,-965 151918.47,-965 151918.47,-924 152061.47,-924 152061.47,-965"/>
<text text-anchor="middle" x="151989.97" y="-953" font-family="Arial" font-size="10.00">Expert 20 (TP8) L11</text>
<text text-anchor="middle" x="151989.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="151989.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_21_stage2 -->
<g id="node760" class="node">
<title>expert_11_21_stage2</title>
<polygon fill="lightgreen" stroke="black" points="151900.47,-965 151757.47,-965 151757.47,-924 151900.47,-924 151900.47,-965"/>
<text text-anchor="middle" x="151828.97" y="-953" font-family="Arial" font-size="10.00">Expert 21 (TP8) L11</text>
<text text-anchor="middle" x="151828.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="151828.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_22_stage2 -->
<g id="node761" class="node">
<title>expert_11_22_stage2</title>
<polygon fill="lightgreen" stroke="black" points="151739.47,-965 151596.47,-965 151596.47,-924 151739.47,-924 151739.47,-965"/>
<text text-anchor="middle" x="151667.97" y="-953" font-family="Arial" font-size="10.00">Expert 22 (TP8) L11</text>
<text text-anchor="middle" x="151667.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="151667.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_23_stage2 -->
<g id="node762" class="node">
<title>expert_11_23_stage2</title>
<polygon fill="lightgreen" stroke="black" points="151578.47,-965 151435.47,-965 151435.47,-924 151578.47,-924 151578.47,-965"/>
<text text-anchor="middle" x="151506.97" y="-953" font-family="Arial" font-size="10.00">Expert 23 (TP8) L11</text>
<text text-anchor="middle" x="151506.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="151506.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_24_stage2 -->
<g id="node763" class="node">
<title>expert_11_24_stage2</title>
<polygon fill="lightgreen" stroke="black" points="151417.47,-965 151274.47,-965 151274.47,-924 151417.47,-924 151417.47,-965"/>
<text text-anchor="middle" x="151345.97" y="-953" font-family="Arial" font-size="10.00">Expert 24 (TP8) L11</text>
<text text-anchor="middle" x="151345.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="151345.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_25_stage2 -->
<g id="node764" class="node">
<title>expert_11_25_stage2</title>
<polygon fill="lightgreen" stroke="black" points="151256.47,-965 151113.47,-965 151113.47,-924 151256.47,-924 151256.47,-965"/>
<text text-anchor="middle" x="151184.97" y="-953" font-family="Arial" font-size="10.00">Expert 25 (TP8) L11</text>
<text text-anchor="middle" x="151184.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="151184.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_26_stage2 -->
<g id="node765" class="node">
<title>expert_11_26_stage2</title>
<polygon fill="lightgreen" stroke="black" points="151095.47,-965 150952.47,-965 150952.47,-924 151095.47,-924 151095.47,-965"/>
<text text-anchor="middle" x="151023.97" y="-953" font-family="Arial" font-size="10.00">Expert 26 (TP8) L11</text>
<text text-anchor="middle" x="151023.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="151023.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_27_stage2 -->
<g id="node766" class="node">
<title>expert_11_27_stage2</title>
<polygon fill="lightgreen" stroke="black" points="150934.47,-965 150791.47,-965 150791.47,-924 150934.47,-924 150934.47,-965"/>
<text text-anchor="middle" x="150862.97" y="-953" font-family="Arial" font-size="10.00">Expert 27 (TP8) L11</text>
<text text-anchor="middle" x="150862.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="150862.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_28_stage2 -->
<g id="node767" class="node">
<title>expert_11_28_stage2</title>
<polygon fill="lightgreen" stroke="black" points="150773.47,-965 150630.47,-965 150630.47,-924 150773.47,-924 150773.47,-965"/>
<text text-anchor="middle" x="150701.97" y="-953" font-family="Arial" font-size="10.00">Expert 28 (TP8) L11</text>
<text text-anchor="middle" x="150701.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="150701.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_29_stage2 -->
<g id="node768" class="node">
<title>expert_11_29_stage2</title>
<polygon fill="lightgreen" stroke="black" points="150612.47,-965 150469.47,-965 150469.47,-924 150612.47,-924 150612.47,-965"/>
<text text-anchor="middle" x="150540.97" y="-953" font-family="Arial" font-size="10.00">Expert 29 (TP8) L11</text>
<text text-anchor="middle" x="150540.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="150540.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_30_stage2 -->
<g id="node769" class="node">
<title>expert_11_30_stage2</title>
<polygon fill="lightgreen" stroke="black" points="150451.47,-965 150308.47,-965 150308.47,-924 150451.47,-924 150451.47,-965"/>
<text text-anchor="middle" x="150379.97" y="-953" font-family="Arial" font-size="10.00">Expert 30 (TP8) L11</text>
<text text-anchor="middle" x="150379.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="150379.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_31_stage2 -->
<g id="node770" class="node">
<title>expert_11_31_stage2</title>
<polygon fill="lightgreen" stroke="black" points="150290.47,-965 150147.47,-965 150147.47,-924 150290.47,-924 150290.47,-965"/>
<text text-anchor="middle" x="150218.97" y="-953" font-family="Arial" font-size="10.00">Expert 31 (TP8) L11</text>
<text text-anchor="middle" x="150218.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="150218.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_32_stage2 -->
<g id="node771" class="node">
<title>expert_11_32_stage2</title>
<polygon fill="lightgreen" stroke="black" points="150129.47,-965 149986.47,-965 149986.47,-924 150129.47,-924 150129.47,-965"/>
<text text-anchor="middle" x="150057.97" y="-953" font-family="Arial" font-size="10.00">Expert 32 (TP8) L11</text>
<text text-anchor="middle" x="150057.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="150057.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_33_stage2 -->
<g id="node772" class="node">
<title>expert_11_33_stage2</title>
<polygon fill="lightgreen" stroke="black" points="149968.47,-965 149825.47,-965 149825.47,-924 149968.47,-924 149968.47,-965"/>
<text text-anchor="middle" x="149896.97" y="-953" font-family="Arial" font-size="10.00">Expert 33 (TP8) L11</text>
<text text-anchor="middle" x="149896.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="149896.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_34_stage2 -->
<g id="node773" class="node">
<title>expert_11_34_stage2</title>
<polygon fill="lightgreen" stroke="black" points="149807.47,-965 149664.47,-965 149664.47,-924 149807.47,-924 149807.47,-965"/>
<text text-anchor="middle" x="149735.97" y="-953" font-family="Arial" font-size="10.00">Expert 34 (TP8) L11</text>
<text text-anchor="middle" x="149735.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="149735.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_35_stage2 -->
<g id="node774" class="node">
<title>expert_11_35_stage2</title>
<polygon fill="lightgreen" stroke="black" points="149646.47,-965 149503.47,-965 149503.47,-924 149646.47,-924 149646.47,-965"/>
<text text-anchor="middle" x="149574.97" y="-953" font-family="Arial" font-size="10.00">Expert 35 (TP8) L11</text>
<text text-anchor="middle" x="149574.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="149574.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_36_stage2 -->
<g id="node775" class="node">
<title>expert_11_36_stage2</title>
<polygon fill="lightgreen" stroke="black" points="149485.47,-965 149342.47,-965 149342.47,-924 149485.47,-924 149485.47,-965"/>
<text text-anchor="middle" x="149413.97" y="-953" font-family="Arial" font-size="10.00">Expert 36 (TP8) L11</text>
<text text-anchor="middle" x="149413.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="149413.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_37_stage2 -->
<g id="node776" class="node">
<title>expert_11_37_stage2</title>
<polygon fill="lightgreen" stroke="black" points="149324.47,-965 149181.47,-965 149181.47,-924 149324.47,-924 149324.47,-965"/>
<text text-anchor="middle" x="149252.97" y="-953" font-family="Arial" font-size="10.00">Expert 37 (TP8) L11</text>
<text text-anchor="middle" x="149252.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="149252.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_38_stage2 -->
<g id="node777" class="node">
<title>expert_11_38_stage2</title>
<polygon fill="lightgreen" stroke="black" points="149163.47,-965 149020.47,-965 149020.47,-924 149163.47,-924 149163.47,-965"/>
<text text-anchor="middle" x="149091.97" y="-953" font-family="Arial" font-size="10.00">Expert 38 (TP8) L11</text>
<text text-anchor="middle" x="149091.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="149091.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_39_stage2 -->
<g id="node778" class="node">
<title>expert_11_39_stage2</title>
<polygon fill="lightgreen" stroke="black" points="149002.47,-965 148859.47,-965 148859.47,-924 149002.47,-924 149002.47,-965"/>
<text text-anchor="middle" x="148930.97" y="-953" font-family="Arial" font-size="10.00">Expert 39 (TP8) L11</text>
<text text-anchor="middle" x="148930.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="148930.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_40_stage2 -->
<g id="node779" class="node">
<title>expert_11_40_stage2</title>
<polygon fill="lightgreen" stroke="black" points="148841.47,-965 148698.47,-965 148698.47,-924 148841.47,-924 148841.47,-965"/>
<text text-anchor="middle" x="148769.97" y="-953" font-family="Arial" font-size="10.00">Expert 40 (TP8) L11</text>
<text text-anchor="middle" x="148769.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="148769.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_41_stage2 -->
<g id="node780" class="node">
<title>expert_11_41_stage2</title>
<polygon fill="lightgreen" stroke="black" points="148680.47,-965 148537.47,-965 148537.47,-924 148680.47,-924 148680.47,-965"/>
<text text-anchor="middle" x="148608.97" y="-953" font-family="Arial" font-size="10.00">Expert 41 (TP8) L11</text>
<text text-anchor="middle" x="148608.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="148608.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_42_stage2 -->
<g id="node781" class="node">
<title>expert_11_42_stage2</title>
<polygon fill="lightgreen" stroke="black" points="148519.47,-965 148376.47,-965 148376.47,-924 148519.47,-924 148519.47,-965"/>
<text text-anchor="middle" x="148447.97" y="-953" font-family="Arial" font-size="10.00">Expert 42 (TP8) L11</text>
<text text-anchor="middle" x="148447.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="148447.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_43_stage2 -->
<g id="node782" class="node">
<title>expert_11_43_stage2</title>
<polygon fill="lightgreen" stroke="black" points="148358.47,-965 148215.47,-965 148215.47,-924 148358.47,-924 148358.47,-965"/>
<text text-anchor="middle" x="148286.97" y="-953" font-family="Arial" font-size="10.00">Expert 43 (TP8) L11</text>
<text text-anchor="middle" x="148286.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="148286.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_44_stage2 -->
<g id="node783" class="node">
<title>expert_11_44_stage2</title>
<polygon fill="lightgreen" stroke="black" points="148197.47,-965 148054.47,-965 148054.47,-924 148197.47,-924 148197.47,-965"/>
<text text-anchor="middle" x="148125.97" y="-953" font-family="Arial" font-size="10.00">Expert 44 (TP8) L11</text>
<text text-anchor="middle" x="148125.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="148125.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_45_stage2 -->
<g id="node784" class="node">
<title>expert_11_45_stage2</title>
<polygon fill="lightgreen" stroke="black" points="148036.47,-965 147893.47,-965 147893.47,-924 148036.47,-924 148036.47,-965"/>
<text text-anchor="middle" x="147964.97" y="-953" font-family="Arial" font-size="10.00">Expert 45 (TP8) L11</text>
<text text-anchor="middle" x="147964.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="147964.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_46_stage2 -->
<g id="node785" class="node">
<title>expert_11_46_stage2</title>
<polygon fill="lightgreen" stroke="black" points="147875.47,-965 147732.47,-965 147732.47,-924 147875.47,-924 147875.47,-965"/>
<text text-anchor="middle" x="147803.97" y="-953" font-family="Arial" font-size="10.00">Expert 46 (TP8) L11</text>
<text text-anchor="middle" x="147803.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="147803.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_47_stage2 -->
<g id="node786" class="node">
<title>expert_11_47_stage2</title>
<polygon fill="lightgreen" stroke="black" points="147714.47,-965 147571.47,-965 147571.47,-924 147714.47,-924 147714.47,-965"/>
<text text-anchor="middle" x="147642.97" y="-953" font-family="Arial" font-size="10.00">Expert 47 (TP8) L11</text>
<text text-anchor="middle" x="147642.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="147642.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_48_stage2 -->
<g id="node787" class="node">
<title>expert_11_48_stage2</title>
<polygon fill="lightgreen" stroke="black" points="147553.47,-965 147410.47,-965 147410.47,-924 147553.47,-924 147553.47,-965"/>
<text text-anchor="middle" x="147481.97" y="-953" font-family="Arial" font-size="10.00">Expert 48 (TP8) L11</text>
<text text-anchor="middle" x="147481.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="147481.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_49_stage2 -->
<g id="node788" class="node">
<title>expert_11_49_stage2</title>
<polygon fill="lightgreen" stroke="black" points="147392.47,-965 147249.47,-965 147249.47,-924 147392.47,-924 147392.47,-965"/>
<text text-anchor="middle" x="147320.97" y="-953" font-family="Arial" font-size="10.00">Expert 49 (TP8) L11</text>
<text text-anchor="middle" x="147320.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="147320.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_50_stage2 -->
<g id="node789" class="node">
<title>expert_11_50_stage2</title>
<polygon fill="lightgreen" stroke="black" points="147231.47,-965 147088.47,-965 147088.47,-924 147231.47,-924 147231.47,-965"/>
<text text-anchor="middle" x="147159.97" y="-953" font-family="Arial" font-size="10.00">Expert 50 (TP8) L11</text>
<text text-anchor="middle" x="147159.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="147159.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_51_stage2 -->
<g id="node790" class="node">
<title>expert_11_51_stage2</title>
<polygon fill="lightgreen" stroke="black" points="147070.47,-965 146927.47,-965 146927.47,-924 147070.47,-924 147070.47,-965"/>
<text text-anchor="middle" x="146998.97" y="-953" font-family="Arial" font-size="10.00">Expert 51 (TP8) L11</text>
<text text-anchor="middle" x="146998.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="146998.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_52_stage2 -->
<g id="node791" class="node">
<title>expert_11_52_stage2</title>
<polygon fill="lightgreen" stroke="black" points="146909.47,-965 146766.47,-965 146766.47,-924 146909.47,-924 146909.47,-965"/>
<text text-anchor="middle" x="146837.97" y="-953" font-family="Arial" font-size="10.00">Expert 52 (TP8) L11</text>
<text text-anchor="middle" x="146837.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="146837.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_53_stage2 -->
<g id="node792" class="node">
<title>expert_11_53_stage2</title>
<polygon fill="lightgreen" stroke="black" points="146748.47,-965 146605.47,-965 146605.47,-924 146748.47,-924 146748.47,-965"/>
<text text-anchor="middle" x="146676.97" y="-953" font-family="Arial" font-size="10.00">Expert 53 (TP8) L11</text>
<text text-anchor="middle" x="146676.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="146676.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_54_stage2 -->
<g id="node793" class="node">
<title>expert_11_54_stage2</title>
<polygon fill="lightgreen" stroke="black" points="146587.47,-965 146444.47,-965 146444.47,-924 146587.47,-924 146587.47,-965"/>
<text text-anchor="middle" x="146515.97" y="-953" font-family="Arial" font-size="10.00">Expert 54 (TP8) L11</text>
<text text-anchor="middle" x="146515.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="146515.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_55_stage2 -->
<g id="node794" class="node">
<title>expert_11_55_stage2</title>
<polygon fill="lightgreen" stroke="black" points="146426.47,-965 146283.47,-965 146283.47,-924 146426.47,-924 146426.47,-965"/>
<text text-anchor="middle" x="146354.97" y="-953" font-family="Arial" font-size="10.00">Expert 55 (TP8) L11</text>
<text text-anchor="middle" x="146354.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="146354.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_56_stage2 -->
<g id="node795" class="node">
<title>expert_11_56_stage2</title>
<polygon fill="lightgreen" stroke="black" points="146265.47,-965 146122.47,-965 146122.47,-924 146265.47,-924 146265.47,-965"/>
<text text-anchor="middle" x="146193.97" y="-953" font-family="Arial" font-size="10.00">Expert 56 (TP8) L11</text>
<text text-anchor="middle" x="146193.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="146193.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_57_stage2 -->
<g id="node796" class="node">
<title>expert_11_57_stage2</title>
<polygon fill="lightgreen" stroke="black" points="146104.47,-965 145961.47,-965 145961.47,-924 146104.47,-924 146104.47,-965"/>
<text text-anchor="middle" x="146032.97" y="-953" font-family="Arial" font-size="10.00">Expert 57 (TP8) L11</text>
<text text-anchor="middle" x="146032.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="146032.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_58_stage2 -->
<g id="node797" class="node">
<title>expert_11_58_stage2</title>
<polygon fill="lightgreen" stroke="black" points="145943.47,-965 145800.47,-965 145800.47,-924 145943.47,-924 145943.47,-965"/>
<text text-anchor="middle" x="145871.97" y="-953" font-family="Arial" font-size="10.00">Expert 58 (TP8) L11</text>
<text text-anchor="middle" x="145871.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="145871.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_59_stage2 -->
<g id="node798" class="node">
<title>expert_11_59_stage2</title>
<polygon fill="lightgreen" stroke="black" points="145782.47,-965 145639.47,-965 145639.47,-924 145782.47,-924 145782.47,-965"/>
<text text-anchor="middle" x="145710.97" y="-953" font-family="Arial" font-size="10.00">Expert 59 (TP8) L11</text>
<text text-anchor="middle" x="145710.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="145710.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_60_stage2 -->
<g id="node799" class="node">
<title>expert_11_60_stage2</title>
<polygon fill="lightgreen" stroke="black" points="145621.47,-965 145478.47,-965 145478.47,-924 145621.47,-924 145621.47,-965"/>
<text text-anchor="middle" x="145549.97" y="-953" font-family="Arial" font-size="10.00">Expert 60 (TP8) L11</text>
<text text-anchor="middle" x="145549.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="145549.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_61_stage2 -->
<g id="node800" class="node">
<title>expert_11_61_stage2</title>
<polygon fill="lightgreen" stroke="black" points="145460.47,-965 145317.47,-965 145317.47,-924 145460.47,-924 145460.47,-965"/>
<text text-anchor="middle" x="145388.97" y="-953" font-family="Arial" font-size="10.00">Expert 61 (TP8) L11</text>
<text text-anchor="middle" x="145388.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="145388.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_62_stage2 -->
<g id="node801" class="node">
<title>expert_11_62_stage2</title>
<polygon fill="lightgreen" stroke="black" points="145299.47,-965 145156.47,-965 145156.47,-924 145299.47,-924 145299.47,-965"/>
<text text-anchor="middle" x="145227.97" y="-953" font-family="Arial" font-size="10.00">Expert 62 (TP8) L11</text>
<text text-anchor="middle" x="145227.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="145227.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_11_63_stage2 -->
<g id="node802" class="node">
<title>expert_11_63_stage2</title>
<polygon fill="lightgreen" stroke="black" points="145138.47,-965 144995.47,-965 144995.47,-924 145138.47,-924 145138.47,-965"/>
<text text-anchor="middle" x="145066.97" y="-953" font-family="Arial" font-size="10.00">Expert 63 (TP8) L11</text>
<text text-anchor="middle" x="145066.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="145066.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_11_stage2 -->
<g id="node803" class="node">
<title>combine_11_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="144869.97" cy="-944.5" rx="107.46" ry="28.98"/>
<text text-anchor="middle" x="144869.97" y="-953" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L11</text>
<text text-anchor="middle" x="144869.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="144869.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_11_stage2 -->
<g id="node804" class="node">
<title>moe_out_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="144744.97,-965 144604.97,-965 144604.97,-924 144744.97,-924 144744.97,-965"/>
<text text-anchor="middle" x="144674.97" y="-953" font-family="Arial" font-size="10.00">MoE Output (TP8) L11</text>
<text text-anchor="middle" x="144674.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="144674.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_11_stage2 -->
<g id="node805" class="node">
<title>ln2_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="144586.97,-965 144446.97,-965 144446.97,-924 144586.97,-924 144586.97,-965"/>
<text text-anchor="middle" x="144516.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L11</text>
<text text-anchor="middle" x="144516.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="144516.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_12_stage2 -->
<g id="node806" class="node">
<title>ln1_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="144428.97,-965 144288.97,-965 144288.97,-924 144428.97,-924 144428.97,-965"/>
<text text-anchor="middle" x="144358.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L12</text>
<text text-anchor="middle" x="144358.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="144358.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_12_stage2 -->
<g id="node807" class="node">
<title>qkv_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="144270.97,-965 144124.97,-965 144124.97,-924 144270.97,-924 144270.97,-965"/>
<text text-anchor="middle" x="144197.97" y="-953" font-family="Arial" font-size="10.00">QKV Projection (TP8) L12</text>
<text text-anchor="middle" x="144197.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="144197.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_12_stage2 -->
<g id="node808" class="node">
<title>attn_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="144106.97,-965 143960.97,-965 143960.97,-924 144106.97,-924 144106.97,-965"/>
<text text-anchor="middle" x="144033.97" y="-953" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L12</text>
<text text-anchor="middle" x="144033.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="144033.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_12_stage2 -->
<g id="node809" class="node">
<title>attn_out_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="143942.97,-965 143802.97,-965 143802.97,-924 143942.97,-924 143942.97,-965"/>
<text text-anchor="middle" x="143872.97" y="-953" font-family="Arial" font-size="10.00">Attention Output (TP8) L12</text>
<text text-anchor="middle" x="143872.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="143872.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_12_stage2 -->
<g id="node810" class="node">
<title>route_12_stage2</title>
<polygon fill="lightcoral" stroke="black" points="143785.27,-985.5 143554.14,-985.5 143494.68,-903.5 143725.81,-903.5 143785.27,-985.5"/>
<text text-anchor="middle" x="143639.97" y="-953" font-family="Arial" font-size="10.00">MoE Routing (EP64) L12</text>
<text text-anchor="middle" x="143639.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="143639.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_12_stage2 -->
<g id="node811" class="node">
<title>dispatch_12_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="143367.97" cy="-944.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="143367.97" y="-953" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L12</text>
<text text-anchor="middle" x="143367.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="143367.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_12_0_stage2 -->
<g id="node812" class="node">
<title>expert_12_0_stage2</title>
<polygon fill="lightgreen" stroke="black" points="143241.47,-965 143098.47,-965 143098.47,-924 143241.47,-924 143241.47,-965"/>
<text text-anchor="middle" x="143169.97" y="-953" font-family="Arial" font-size="10.00">Expert 0 (TP8) L12</text>
<text text-anchor="middle" x="143169.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="143169.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_1_stage2 -->
<g id="node813" class="node">
<title>expert_12_1_stage2</title>
<polygon fill="lightgreen" stroke="black" points="143080.47,-965 142937.47,-965 142937.47,-924 143080.47,-924 143080.47,-965"/>
<text text-anchor="middle" x="143008.97" y="-953" font-family="Arial" font-size="10.00">Expert 1 (TP8) L12</text>
<text text-anchor="middle" x="143008.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="143008.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_2_stage2 -->
<g id="node814" class="node">
<title>expert_12_2_stage2</title>
<polygon fill="lightgreen" stroke="black" points="142919.47,-965 142776.47,-965 142776.47,-924 142919.47,-924 142919.47,-965"/>
<text text-anchor="middle" x="142847.97" y="-953" font-family="Arial" font-size="10.00">Expert 2 (TP8) L12</text>
<text text-anchor="middle" x="142847.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="142847.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_3_stage2 -->
<g id="node815" class="node">
<title>expert_12_3_stage2</title>
<polygon fill="lightgreen" stroke="black" points="142758.47,-965 142615.47,-965 142615.47,-924 142758.47,-924 142758.47,-965"/>
<text text-anchor="middle" x="142686.97" y="-953" font-family="Arial" font-size="10.00">Expert 3 (TP8) L12</text>
<text text-anchor="middle" x="142686.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="142686.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_4_stage2 -->
<g id="node816" class="node">
<title>expert_12_4_stage2</title>
<polygon fill="lightgreen" stroke="black" points="142597.47,-965 142454.47,-965 142454.47,-924 142597.47,-924 142597.47,-965"/>
<text text-anchor="middle" x="142525.97" y="-953" font-family="Arial" font-size="10.00">Expert 4 (TP8) L12</text>
<text text-anchor="middle" x="142525.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="142525.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_5_stage2 -->
<g id="node817" class="node">
<title>expert_12_5_stage2</title>
<polygon fill="lightgreen" stroke="black" points="142436.47,-965 142293.47,-965 142293.47,-924 142436.47,-924 142436.47,-965"/>
<text text-anchor="middle" x="142364.97" y="-953" font-family="Arial" font-size="10.00">Expert 5 (TP8) L12</text>
<text text-anchor="middle" x="142364.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="142364.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_6_stage2 -->
<g id="node818" class="node">
<title>expert_12_6_stage2</title>
<polygon fill="lightgreen" stroke="black" points="142275.47,-965 142132.47,-965 142132.47,-924 142275.47,-924 142275.47,-965"/>
<text text-anchor="middle" x="142203.97" y="-953" font-family="Arial" font-size="10.00">Expert 6 (TP8) L12</text>
<text text-anchor="middle" x="142203.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="142203.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_7_stage2 -->
<g id="node819" class="node">
<title>expert_12_7_stage2</title>
<polygon fill="lightgreen" stroke="black" points="142114.47,-965 141971.47,-965 141971.47,-924 142114.47,-924 142114.47,-965"/>
<text text-anchor="middle" x="142042.97" y="-953" font-family="Arial" font-size="10.00">Expert 7 (TP8) L12</text>
<text text-anchor="middle" x="142042.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="142042.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_8_stage2 -->
<g id="node820" class="node">
<title>expert_12_8_stage2</title>
<polygon fill="lightgreen" stroke="black" points="141953.47,-965 141810.47,-965 141810.47,-924 141953.47,-924 141953.47,-965"/>
<text text-anchor="middle" x="141881.97" y="-953" font-family="Arial" font-size="10.00">Expert 8 (TP8) L12</text>
<text text-anchor="middle" x="141881.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="141881.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_9_stage2 -->
<g id="node821" class="node">
<title>expert_12_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="141792.47,-965 141649.47,-965 141649.47,-924 141792.47,-924 141792.47,-965"/>
<text text-anchor="middle" x="141720.97" y="-953" font-family="Arial" font-size="10.00">Expert 9 (TP8) L12</text>
<text text-anchor="middle" x="141720.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="141720.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_10_stage2 -->
<g id="node822" class="node">
<title>expert_12_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="141631.47,-965 141488.47,-965 141488.47,-924 141631.47,-924 141631.47,-965"/>
<text text-anchor="middle" x="141559.97" y="-953" font-family="Arial" font-size="10.00">Expert 10 (TP8) L12</text>
<text text-anchor="middle" x="141559.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="141559.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_11_stage2 -->
<g id="node823" class="node">
<title>expert_12_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="141470.47,-965 141327.47,-965 141327.47,-924 141470.47,-924 141470.47,-965"/>
<text text-anchor="middle" x="141398.97" y="-953" font-family="Arial" font-size="10.00">Expert 11 (TP8) L12</text>
<text text-anchor="middle" x="141398.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="141398.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_12_stage2 -->
<g id="node824" class="node">
<title>expert_12_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="141309.47,-965 141166.47,-965 141166.47,-924 141309.47,-924 141309.47,-965"/>
<text text-anchor="middle" x="141237.97" y="-953" font-family="Arial" font-size="10.00">Expert 12 (TP8) L12</text>
<text text-anchor="middle" x="141237.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="141237.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_13_stage2 -->
<g id="node825" class="node">
<title>expert_12_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="141148.47,-965 141005.47,-965 141005.47,-924 141148.47,-924 141148.47,-965"/>
<text text-anchor="middle" x="141076.97" y="-953" font-family="Arial" font-size="10.00">Expert 13 (TP8) L12</text>
<text text-anchor="middle" x="141076.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="141076.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_14_stage2 -->
<g id="node826" class="node">
<title>expert_12_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="140987.47,-965 140844.47,-965 140844.47,-924 140987.47,-924 140987.47,-965"/>
<text text-anchor="middle" x="140915.97" y="-953" font-family="Arial" font-size="10.00">Expert 14 (TP8) L12</text>
<text text-anchor="middle" x="140915.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="140915.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_15_stage2 -->
<g id="node827" class="node">
<title>expert_12_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="140826.47,-965 140683.47,-965 140683.47,-924 140826.47,-924 140826.47,-965"/>
<text text-anchor="middle" x="140754.97" y="-953" font-family="Arial" font-size="10.00">Expert 15 (TP8) L12</text>
<text text-anchor="middle" x="140754.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="140754.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_16_stage2 -->
<g id="node828" class="node">
<title>expert_12_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="140665.47,-965 140522.47,-965 140522.47,-924 140665.47,-924 140665.47,-965"/>
<text text-anchor="middle" x="140593.97" y="-953" font-family="Arial" font-size="10.00">Expert 16 (TP8) L12</text>
<text text-anchor="middle" x="140593.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="140593.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_17_stage2 -->
<g id="node829" class="node">
<title>expert_12_17_stage2</title>
<polygon fill="lightgreen" stroke="black" points="140504.47,-965 140361.47,-965 140361.47,-924 140504.47,-924 140504.47,-965"/>
<text text-anchor="middle" x="140432.97" y="-953" font-family="Arial" font-size="10.00">Expert 17 (TP8) L12</text>
<text text-anchor="middle" x="140432.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="140432.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_18_stage2 -->
<g id="node830" class="node">
<title>expert_12_18_stage2</title>
<polygon fill="lightgreen" stroke="black" points="140343.47,-965 140200.47,-965 140200.47,-924 140343.47,-924 140343.47,-965"/>
<text text-anchor="middle" x="140271.97" y="-953" font-family="Arial" font-size="10.00">Expert 18 (TP8) L12</text>
<text text-anchor="middle" x="140271.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="140271.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_19_stage2 -->
<g id="node831" class="node">
<title>expert_12_19_stage2</title>
<polygon fill="lightgreen" stroke="black" points="140182.47,-965 140039.47,-965 140039.47,-924 140182.47,-924 140182.47,-965"/>
<text text-anchor="middle" x="140110.97" y="-953" font-family="Arial" font-size="10.00">Expert 19 (TP8) L12</text>
<text text-anchor="middle" x="140110.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="140110.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_20_stage2 -->
<g id="node832" class="node">
<title>expert_12_20_stage2</title>
<polygon fill="lightgreen" stroke="black" points="140021.47,-965 139878.47,-965 139878.47,-924 140021.47,-924 140021.47,-965"/>
<text text-anchor="middle" x="139949.97" y="-953" font-family="Arial" font-size="10.00">Expert 20 (TP8) L12</text>
<text text-anchor="middle" x="139949.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="139949.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_21_stage2 -->
<g id="node833" class="node">
<title>expert_12_21_stage2</title>
<polygon fill="lightgreen" stroke="black" points="139860.47,-965 139717.47,-965 139717.47,-924 139860.47,-924 139860.47,-965"/>
<text text-anchor="middle" x="139788.97" y="-953" font-family="Arial" font-size="10.00">Expert 21 (TP8) L12</text>
<text text-anchor="middle" x="139788.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="139788.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_22_stage2 -->
<g id="node834" class="node">
<title>expert_12_22_stage2</title>
<polygon fill="lightgreen" stroke="black" points="139699.47,-965 139556.47,-965 139556.47,-924 139699.47,-924 139699.47,-965"/>
<text text-anchor="middle" x="139627.97" y="-953" font-family="Arial" font-size="10.00">Expert 22 (TP8) L12</text>
<text text-anchor="middle" x="139627.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="139627.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_23_stage2 -->
<g id="node835" class="node">
<title>expert_12_23_stage2</title>
<polygon fill="lightgreen" stroke="black" points="139538.47,-965 139395.47,-965 139395.47,-924 139538.47,-924 139538.47,-965"/>
<text text-anchor="middle" x="139466.97" y="-953" font-family="Arial" font-size="10.00">Expert 23 (TP8) L12</text>
<text text-anchor="middle" x="139466.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="139466.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_24_stage2 -->
<g id="node836" class="node">
<title>expert_12_24_stage2</title>
<polygon fill="lightgreen" stroke="black" points="139377.47,-965 139234.47,-965 139234.47,-924 139377.47,-924 139377.47,-965"/>
<text text-anchor="middle" x="139305.97" y="-953" font-family="Arial" font-size="10.00">Expert 24 (TP8) L12</text>
<text text-anchor="middle" x="139305.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="139305.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_25_stage2 -->
<g id="node837" class="node">
<title>expert_12_25_stage2</title>
<polygon fill="lightgreen" stroke="black" points="139216.47,-965 139073.47,-965 139073.47,-924 139216.47,-924 139216.47,-965"/>
<text text-anchor="middle" x="139144.97" y="-953" font-family="Arial" font-size="10.00">Expert 25 (TP8) L12</text>
<text text-anchor="middle" x="139144.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="139144.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_26_stage2 -->
<g id="node838" class="node">
<title>expert_12_26_stage2</title>
<polygon fill="lightgreen" stroke="black" points="139055.47,-965 138912.47,-965 138912.47,-924 139055.47,-924 139055.47,-965"/>
<text text-anchor="middle" x="138983.97" y="-953" font-family="Arial" font-size="10.00">Expert 26 (TP8) L12</text>
<text text-anchor="middle" x="138983.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="138983.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_27_stage2 -->
<g id="node839" class="node">
<title>expert_12_27_stage2</title>
<polygon fill="lightgreen" stroke="black" points="138894.47,-965 138751.47,-965 138751.47,-924 138894.47,-924 138894.47,-965"/>
<text text-anchor="middle" x="138822.97" y="-953" font-family="Arial" font-size="10.00">Expert 27 (TP8) L12</text>
<text text-anchor="middle" x="138822.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="138822.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_28_stage2 -->
<g id="node840" class="node">
<title>expert_12_28_stage2</title>
<polygon fill="lightgreen" stroke="black" points="138733.47,-965 138590.47,-965 138590.47,-924 138733.47,-924 138733.47,-965"/>
<text text-anchor="middle" x="138661.97" y="-953" font-family="Arial" font-size="10.00">Expert 28 (TP8) L12</text>
<text text-anchor="middle" x="138661.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="138661.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_29_stage2 -->
<g id="node841" class="node">
<title>expert_12_29_stage2</title>
<polygon fill="lightgreen" stroke="black" points="138572.47,-965 138429.47,-965 138429.47,-924 138572.47,-924 138572.47,-965"/>
<text text-anchor="middle" x="138500.97" y="-953" font-family="Arial" font-size="10.00">Expert 29 (TP8) L12</text>
<text text-anchor="middle" x="138500.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="138500.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_30_stage2 -->
<g id="node842" class="node">
<title>expert_12_30_stage2</title>
<polygon fill="lightgreen" stroke="black" points="138411.47,-965 138268.47,-965 138268.47,-924 138411.47,-924 138411.47,-965"/>
<text text-anchor="middle" x="138339.97" y="-953" font-family="Arial" font-size="10.00">Expert 30 (TP8) L12</text>
<text text-anchor="middle" x="138339.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="138339.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_31_stage2 -->
<g id="node843" class="node">
<title>expert_12_31_stage2</title>
<polygon fill="lightgreen" stroke="black" points="138250.47,-965 138107.47,-965 138107.47,-924 138250.47,-924 138250.47,-965"/>
<text text-anchor="middle" x="138178.97" y="-953" font-family="Arial" font-size="10.00">Expert 31 (TP8) L12</text>
<text text-anchor="middle" x="138178.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="138178.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_32_stage2 -->
<g id="node844" class="node">
<title>expert_12_32_stage2</title>
<polygon fill="lightgreen" stroke="black" points="138089.47,-965 137946.47,-965 137946.47,-924 138089.47,-924 138089.47,-965"/>
<text text-anchor="middle" x="138017.97" y="-953" font-family="Arial" font-size="10.00">Expert 32 (TP8) L12</text>
<text text-anchor="middle" x="138017.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="138017.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_33_stage2 -->
<g id="node845" class="node">
<title>expert_12_33_stage2</title>
<polygon fill="lightgreen" stroke="black" points="137928.47,-965 137785.47,-965 137785.47,-924 137928.47,-924 137928.47,-965"/>
<text text-anchor="middle" x="137856.97" y="-953" font-family="Arial" font-size="10.00">Expert 33 (TP8) L12</text>
<text text-anchor="middle" x="137856.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="137856.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_34_stage2 -->
<g id="node846" class="node">
<title>expert_12_34_stage2</title>
<polygon fill="lightgreen" stroke="black" points="137767.47,-965 137624.47,-965 137624.47,-924 137767.47,-924 137767.47,-965"/>
<text text-anchor="middle" x="137695.97" y="-953" font-family="Arial" font-size="10.00">Expert 34 (TP8) L12</text>
<text text-anchor="middle" x="137695.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="137695.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_35_stage2 -->
<g id="node847" class="node">
<title>expert_12_35_stage2</title>
<polygon fill="lightgreen" stroke="black" points="137606.47,-965 137463.47,-965 137463.47,-924 137606.47,-924 137606.47,-965"/>
<text text-anchor="middle" x="137534.97" y="-953" font-family="Arial" font-size="10.00">Expert 35 (TP8) L12</text>
<text text-anchor="middle" x="137534.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="137534.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_36_stage2 -->
<g id="node848" class="node">
<title>expert_12_36_stage2</title>
<polygon fill="lightgreen" stroke="black" points="137445.47,-965 137302.47,-965 137302.47,-924 137445.47,-924 137445.47,-965"/>
<text text-anchor="middle" x="137373.97" y="-953" font-family="Arial" font-size="10.00">Expert 36 (TP8) L12</text>
<text text-anchor="middle" x="137373.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="137373.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_37_stage2 -->
<g id="node849" class="node">
<title>expert_12_37_stage2</title>
<polygon fill="lightgreen" stroke="black" points="137284.47,-965 137141.47,-965 137141.47,-924 137284.47,-924 137284.47,-965"/>
<text text-anchor="middle" x="137212.97" y="-953" font-family="Arial" font-size="10.00">Expert 37 (TP8) L12</text>
<text text-anchor="middle" x="137212.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="137212.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_38_stage2 -->
<g id="node850" class="node">
<title>expert_12_38_stage2</title>
<polygon fill="lightgreen" stroke="black" points="137123.47,-965 136980.47,-965 136980.47,-924 137123.47,-924 137123.47,-965"/>
<text text-anchor="middle" x="137051.97" y="-953" font-family="Arial" font-size="10.00">Expert 38 (TP8) L12</text>
<text text-anchor="middle" x="137051.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="137051.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_39_stage2 -->
<g id="node851" class="node">
<title>expert_12_39_stage2</title>
<polygon fill="lightgreen" stroke="black" points="136962.47,-965 136819.47,-965 136819.47,-924 136962.47,-924 136962.47,-965"/>
<text text-anchor="middle" x="136890.97" y="-953" font-family="Arial" font-size="10.00">Expert 39 (TP8) L12</text>
<text text-anchor="middle" x="136890.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="136890.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_40_stage2 -->
<g id="node852" class="node">
<title>expert_12_40_stage2</title>
<polygon fill="lightgreen" stroke="black" points="136801.47,-965 136658.47,-965 136658.47,-924 136801.47,-924 136801.47,-965"/>
<text text-anchor="middle" x="136729.97" y="-953" font-family="Arial" font-size="10.00">Expert 40 (TP8) L12</text>
<text text-anchor="middle" x="136729.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="136729.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_41_stage2 -->
<g id="node853" class="node">
<title>expert_12_41_stage2</title>
<polygon fill="lightgreen" stroke="black" points="136640.47,-965 136497.47,-965 136497.47,-924 136640.47,-924 136640.47,-965"/>
<text text-anchor="middle" x="136568.97" y="-953" font-family="Arial" font-size="10.00">Expert 41 (TP8) L12</text>
<text text-anchor="middle" x="136568.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="136568.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_42_stage2 -->
<g id="node854" class="node">
<title>expert_12_42_stage2</title>
<polygon fill="lightgreen" stroke="black" points="136479.47,-965 136336.47,-965 136336.47,-924 136479.47,-924 136479.47,-965"/>
<text text-anchor="middle" x="136407.97" y="-953" font-family="Arial" font-size="10.00">Expert 42 (TP8) L12</text>
<text text-anchor="middle" x="136407.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="136407.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_43_stage2 -->
<g id="node855" class="node">
<title>expert_12_43_stage2</title>
<polygon fill="lightgreen" stroke="black" points="136318.47,-965 136175.47,-965 136175.47,-924 136318.47,-924 136318.47,-965"/>
<text text-anchor="middle" x="136246.97" y="-953" font-family="Arial" font-size="10.00">Expert 43 (TP8) L12</text>
<text text-anchor="middle" x="136246.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="136246.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_44_stage2 -->
<g id="node856" class="node">
<title>expert_12_44_stage2</title>
<polygon fill="lightgreen" stroke="black" points="136157.47,-965 136014.47,-965 136014.47,-924 136157.47,-924 136157.47,-965"/>
<text text-anchor="middle" x="136085.97" y="-953" font-family="Arial" font-size="10.00">Expert 44 (TP8) L12</text>
<text text-anchor="middle" x="136085.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="136085.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_45_stage2 -->
<g id="node857" class="node">
<title>expert_12_45_stage2</title>
<polygon fill="lightgreen" stroke="black" points="135996.47,-965 135853.47,-965 135853.47,-924 135996.47,-924 135996.47,-965"/>
<text text-anchor="middle" x="135924.97" y="-953" font-family="Arial" font-size="10.00">Expert 45 (TP8) L12</text>
<text text-anchor="middle" x="135924.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="135924.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_46_stage2 -->
<g id="node858" class="node">
<title>expert_12_46_stage2</title>
<polygon fill="lightgreen" stroke="black" points="135835.47,-965 135692.47,-965 135692.47,-924 135835.47,-924 135835.47,-965"/>
<text text-anchor="middle" x="135763.97" y="-953" font-family="Arial" font-size="10.00">Expert 46 (TP8) L12</text>
<text text-anchor="middle" x="135763.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="135763.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_47_stage2 -->
<g id="node859" class="node">
<title>expert_12_47_stage2</title>
<polygon fill="lightgreen" stroke="black" points="135674.47,-965 135531.47,-965 135531.47,-924 135674.47,-924 135674.47,-965"/>
<text text-anchor="middle" x="135602.97" y="-953" font-family="Arial" font-size="10.00">Expert 47 (TP8) L12</text>
<text text-anchor="middle" x="135602.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="135602.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_48_stage2 -->
<g id="node860" class="node">
<title>expert_12_48_stage2</title>
<polygon fill="lightgreen" stroke="black" points="135513.47,-965 135370.47,-965 135370.47,-924 135513.47,-924 135513.47,-965"/>
<text text-anchor="middle" x="135441.97" y="-953" font-family="Arial" font-size="10.00">Expert 48 (TP8) L12</text>
<text text-anchor="middle" x="135441.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="135441.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_49_stage2 -->
<g id="node861" class="node">
<title>expert_12_49_stage2</title>
<polygon fill="lightgreen" stroke="black" points="135352.47,-965 135209.47,-965 135209.47,-924 135352.47,-924 135352.47,-965"/>
<text text-anchor="middle" x="135280.97" y="-953" font-family="Arial" font-size="10.00">Expert 49 (TP8) L12</text>
<text text-anchor="middle" x="135280.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="135280.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_50_stage2 -->
<g id="node862" class="node">
<title>expert_12_50_stage2</title>
<polygon fill="lightgreen" stroke="black" points="135191.47,-965 135048.47,-965 135048.47,-924 135191.47,-924 135191.47,-965"/>
<text text-anchor="middle" x="135119.97" y="-953" font-family="Arial" font-size="10.00">Expert 50 (TP8) L12</text>
<text text-anchor="middle" x="135119.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="135119.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_51_stage2 -->
<g id="node863" class="node">
<title>expert_12_51_stage2</title>
<polygon fill="lightgreen" stroke="black" points="135030.47,-965 134887.47,-965 134887.47,-924 135030.47,-924 135030.47,-965"/>
<text text-anchor="middle" x="134958.97" y="-953" font-family="Arial" font-size="10.00">Expert 51 (TP8) L12</text>
<text text-anchor="middle" x="134958.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="134958.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_52_stage2 -->
<g id="node864" class="node">
<title>expert_12_52_stage2</title>
<polygon fill="lightgreen" stroke="black" points="134869.47,-965 134726.47,-965 134726.47,-924 134869.47,-924 134869.47,-965"/>
<text text-anchor="middle" x="134797.97" y="-953" font-family="Arial" font-size="10.00">Expert 52 (TP8) L12</text>
<text text-anchor="middle" x="134797.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="134797.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_53_stage2 -->
<g id="node865" class="node">
<title>expert_12_53_stage2</title>
<polygon fill="lightgreen" stroke="black" points="134708.47,-965 134565.47,-965 134565.47,-924 134708.47,-924 134708.47,-965"/>
<text text-anchor="middle" x="134636.97" y="-953" font-family="Arial" font-size="10.00">Expert 53 (TP8) L12</text>
<text text-anchor="middle" x="134636.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="134636.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_54_stage2 -->
<g id="node866" class="node">
<title>expert_12_54_stage2</title>
<polygon fill="lightgreen" stroke="black" points="134547.47,-965 134404.47,-965 134404.47,-924 134547.47,-924 134547.47,-965"/>
<text text-anchor="middle" x="134475.97" y="-953" font-family="Arial" font-size="10.00">Expert 54 (TP8) L12</text>
<text text-anchor="middle" x="134475.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="134475.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_55_stage2 -->
<g id="node867" class="node">
<title>expert_12_55_stage2</title>
<polygon fill="lightgreen" stroke="black" points="134386.47,-965 134243.47,-965 134243.47,-924 134386.47,-924 134386.47,-965"/>
<text text-anchor="middle" x="134314.97" y="-953" font-family="Arial" font-size="10.00">Expert 55 (TP8) L12</text>
<text text-anchor="middle" x="134314.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="134314.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_56_stage2 -->
<g id="node868" class="node">
<title>expert_12_56_stage2</title>
<polygon fill="lightgreen" stroke="black" points="134225.47,-965 134082.47,-965 134082.47,-924 134225.47,-924 134225.47,-965"/>
<text text-anchor="middle" x="134153.97" y="-953" font-family="Arial" font-size="10.00">Expert 56 (TP8) L12</text>
<text text-anchor="middle" x="134153.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="134153.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_57_stage2 -->
<g id="node869" class="node">
<title>expert_12_57_stage2</title>
<polygon fill="lightgreen" stroke="black" points="134064.47,-965 133921.47,-965 133921.47,-924 134064.47,-924 134064.47,-965"/>
<text text-anchor="middle" x="133992.97" y="-953" font-family="Arial" font-size="10.00">Expert 57 (TP8) L12</text>
<text text-anchor="middle" x="133992.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="133992.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_58_stage2 -->
<g id="node870" class="node">
<title>expert_12_58_stage2</title>
<polygon fill="lightgreen" stroke="black" points="133903.47,-965 133760.47,-965 133760.47,-924 133903.47,-924 133903.47,-965"/>
<text text-anchor="middle" x="133831.97" y="-953" font-family="Arial" font-size="10.00">Expert 58 (TP8) L12</text>
<text text-anchor="middle" x="133831.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="133831.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_59_stage2 -->
<g id="node871" class="node">
<title>expert_12_59_stage2</title>
<polygon fill="lightgreen" stroke="black" points="133742.47,-965 133599.47,-965 133599.47,-924 133742.47,-924 133742.47,-965"/>
<text text-anchor="middle" x="133670.97" y="-953" font-family="Arial" font-size="10.00">Expert 59 (TP8) L12</text>
<text text-anchor="middle" x="133670.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="133670.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_60_stage2 -->
<g id="node872" class="node">
<title>expert_12_60_stage2</title>
<polygon fill="lightgreen" stroke="black" points="133581.47,-965 133438.47,-965 133438.47,-924 133581.47,-924 133581.47,-965"/>
<text text-anchor="middle" x="133509.97" y="-953" font-family="Arial" font-size="10.00">Expert 60 (TP8) L12</text>
<text text-anchor="middle" x="133509.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="133509.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_61_stage2 -->
<g id="node873" class="node">
<title>expert_12_61_stage2</title>
<polygon fill="lightgreen" stroke="black" points="133420.47,-965 133277.47,-965 133277.47,-924 133420.47,-924 133420.47,-965"/>
<text text-anchor="middle" x="133348.97" y="-953" font-family="Arial" font-size="10.00">Expert 61 (TP8) L12</text>
<text text-anchor="middle" x="133348.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="133348.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_62_stage2 -->
<g id="node874" class="node">
<title>expert_12_62_stage2</title>
<polygon fill="lightgreen" stroke="black" points="133259.47,-965 133116.47,-965 133116.47,-924 133259.47,-924 133259.47,-965"/>
<text text-anchor="middle" x="133187.97" y="-953" font-family="Arial" font-size="10.00">Expert 62 (TP8) L12</text>
<text text-anchor="middle" x="133187.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="133187.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_12_63_stage2 -->
<g id="node875" class="node">
<title>expert_12_63_stage2</title>
<polygon fill="lightgreen" stroke="black" points="133098.47,-965 132955.47,-965 132955.47,-924 133098.47,-924 133098.47,-965"/>
<text text-anchor="middle" x="133026.97" y="-953" font-family="Arial" font-size="10.00">Expert 63 (TP8) L12</text>
<text text-anchor="middle" x="133026.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="133026.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_12_stage2 -->
<g id="node876" class="node">
<title>combine_12_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="132829.97" cy="-944.5" rx="107.46" ry="28.98"/>
<text text-anchor="middle" x="132829.97" y="-953" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L12</text>
<text text-anchor="middle" x="132829.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="132829.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_12_stage2 -->
<g id="node877" class="node">
<title>moe_out_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="132704.97,-965 132564.97,-965 132564.97,-924 132704.97,-924 132704.97,-965"/>
<text text-anchor="middle" x="132634.97" y="-953" font-family="Arial" font-size="10.00">MoE Output (TP8) L12</text>
<text text-anchor="middle" x="132634.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="132634.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_12_stage2 -->
<g id="node878" class="node">
<title>ln2_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="132546.97,-965 132406.97,-965 132406.97,-924 132546.97,-924 132546.97,-965"/>
<text text-anchor="middle" x="132476.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L12</text>
<text text-anchor="middle" x="132476.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="132476.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_13_stage2 -->
<g id="node879" class="node">
<title>ln1_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="132388.97,-965 132248.97,-965 132248.97,-924 132388.97,-924 132388.97,-965"/>
<text text-anchor="middle" x="132318.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L13</text>
<text text-anchor="middle" x="132318.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="132318.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_13_stage2 -->
<g id="node880" class="node">
<title>qkv_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="132230.97,-965 132084.97,-965 132084.97,-924 132230.97,-924 132230.97,-965"/>
<text text-anchor="middle" x="132157.97" y="-953" font-family="Arial" font-size="10.00">QKV Projection (TP8) L13</text>
<text text-anchor="middle" x="132157.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="132157.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_13_stage2 -->
<g id="node881" class="node">
<title>attn_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="132066.97,-965 131920.97,-965 131920.97,-924 132066.97,-924 132066.97,-965"/>
<text text-anchor="middle" x="131993.97" y="-953" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L13</text>
<text text-anchor="middle" x="131993.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="131993.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_13_stage2 -->
<g id="node882" class="node">
<title>attn_out_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="131902.97,-965 131762.97,-965 131762.97,-924 131902.97,-924 131902.97,-965"/>
<text text-anchor="middle" x="131832.97" y="-953" font-family="Arial" font-size="10.00">Attention Output (TP8) L13</text>
<text text-anchor="middle" x="131832.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="131832.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_13_stage2 -->
<g id="node883" class="node">
<title>route_13_stage2</title>
<polygon fill="lightcoral" stroke="black" points="131745.27,-985.5 131514.14,-985.5 131454.68,-903.5 131685.81,-903.5 131745.27,-985.5"/>
<text text-anchor="middle" x="131599.97" y="-953" font-family="Arial" font-size="10.00">MoE Routing (EP64) L13</text>
<text text-anchor="middle" x="131599.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="131599.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_13_stage2 -->
<g id="node884" class="node">
<title>dispatch_13_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="131327.97" cy="-944.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="131327.97" y="-953" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L13</text>
<text text-anchor="middle" x="131327.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="131327.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_13_0_stage2 -->
<g id="node885" class="node">
<title>expert_13_0_stage2</title>
<polygon fill="lightgreen" stroke="black" points="131201.47,-965 131058.47,-965 131058.47,-924 131201.47,-924 131201.47,-965"/>
<text text-anchor="middle" x="131129.97" y="-953" font-family="Arial" font-size="10.00">Expert 0 (TP8) L13</text>
<text text-anchor="middle" x="131129.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="131129.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_1_stage2 -->
<g id="node886" class="node">
<title>expert_13_1_stage2</title>
<polygon fill="lightgreen" stroke="black" points="131040.47,-965 130897.47,-965 130897.47,-924 131040.47,-924 131040.47,-965"/>
<text text-anchor="middle" x="130968.97" y="-953" font-family="Arial" font-size="10.00">Expert 1 (TP8) L13</text>
<text text-anchor="middle" x="130968.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="130968.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_2_stage2 -->
<g id="node887" class="node">
<title>expert_13_2_stage2</title>
<polygon fill="lightgreen" stroke="black" points="130879.47,-965 130736.47,-965 130736.47,-924 130879.47,-924 130879.47,-965"/>
<text text-anchor="middle" x="130807.97" y="-953" font-family="Arial" font-size="10.00">Expert 2 (TP8) L13</text>
<text text-anchor="middle" x="130807.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="130807.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_3_stage2 -->
<g id="node888" class="node">
<title>expert_13_3_stage2</title>
<polygon fill="lightgreen" stroke="black" points="130718.47,-965 130575.47,-965 130575.47,-924 130718.47,-924 130718.47,-965"/>
<text text-anchor="middle" x="130646.97" y="-953" font-family="Arial" font-size="10.00">Expert 3 (TP8) L13</text>
<text text-anchor="middle" x="130646.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="130646.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_4_stage2 -->
<g id="node889" class="node">
<title>expert_13_4_stage2</title>
<polygon fill="lightgreen" stroke="black" points="130557.47,-965 130414.47,-965 130414.47,-924 130557.47,-924 130557.47,-965"/>
<text text-anchor="middle" x="130485.97" y="-953" font-family="Arial" font-size="10.00">Expert 4 (TP8) L13</text>
<text text-anchor="middle" x="130485.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="130485.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_5_stage2 -->
<g id="node890" class="node">
<title>expert_13_5_stage2</title>
<polygon fill="lightgreen" stroke="black" points="130396.47,-965 130253.47,-965 130253.47,-924 130396.47,-924 130396.47,-965"/>
<text text-anchor="middle" x="130324.97" y="-953" font-family="Arial" font-size="10.00">Expert 5 (TP8) L13</text>
<text text-anchor="middle" x="130324.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="130324.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_6_stage2 -->
<g id="node891" class="node">
<title>expert_13_6_stage2</title>
<polygon fill="lightgreen" stroke="black" points="130235.47,-965 130092.47,-965 130092.47,-924 130235.47,-924 130235.47,-965"/>
<text text-anchor="middle" x="130163.97" y="-953" font-family="Arial" font-size="10.00">Expert 6 (TP8) L13</text>
<text text-anchor="middle" x="130163.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="130163.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_7_stage2 -->
<g id="node892" class="node">
<title>expert_13_7_stage2</title>
<polygon fill="lightgreen" stroke="black" points="130074.47,-965 129931.47,-965 129931.47,-924 130074.47,-924 130074.47,-965"/>
<text text-anchor="middle" x="130002.97" y="-953" font-family="Arial" font-size="10.00">Expert 7 (TP8) L13</text>
<text text-anchor="middle" x="130002.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="130002.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_8_stage2 -->
<g id="node893" class="node">
<title>expert_13_8_stage2</title>
<polygon fill="lightgreen" stroke="black" points="129913.47,-965 129770.47,-965 129770.47,-924 129913.47,-924 129913.47,-965"/>
<text text-anchor="middle" x="129841.97" y="-953" font-family="Arial" font-size="10.00">Expert 8 (TP8) L13</text>
<text text-anchor="middle" x="129841.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="129841.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_9_stage2 -->
<g id="node894" class="node">
<title>expert_13_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="129752.47,-965 129609.47,-965 129609.47,-924 129752.47,-924 129752.47,-965"/>
<text text-anchor="middle" x="129680.97" y="-953" font-family="Arial" font-size="10.00">Expert 9 (TP8) L13</text>
<text text-anchor="middle" x="129680.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="129680.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_10_stage2 -->
<g id="node895" class="node">
<title>expert_13_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="129591.47,-965 129448.47,-965 129448.47,-924 129591.47,-924 129591.47,-965"/>
<text text-anchor="middle" x="129519.97" y="-953" font-family="Arial" font-size="10.00">Expert 10 (TP8) L13</text>
<text text-anchor="middle" x="129519.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="129519.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_11_stage2 -->
<g id="node896" class="node">
<title>expert_13_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="129430.47,-965 129287.47,-965 129287.47,-924 129430.47,-924 129430.47,-965"/>
<text text-anchor="middle" x="129358.97" y="-953" font-family="Arial" font-size="10.00">Expert 11 (TP8) L13</text>
<text text-anchor="middle" x="129358.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="129358.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_12_stage2 -->
<g id="node897" class="node">
<title>expert_13_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="129269.47,-965 129126.47,-965 129126.47,-924 129269.47,-924 129269.47,-965"/>
<text text-anchor="middle" x="129197.97" y="-953" font-family="Arial" font-size="10.00">Expert 12 (TP8) L13</text>
<text text-anchor="middle" x="129197.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="129197.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_13_stage2 -->
<g id="node898" class="node">
<title>expert_13_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="129108.47,-965 128965.47,-965 128965.47,-924 129108.47,-924 129108.47,-965"/>
<text text-anchor="middle" x="129036.97" y="-953" font-family="Arial" font-size="10.00">Expert 13 (TP8) L13</text>
<text text-anchor="middle" x="129036.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="129036.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_14_stage2 -->
<g id="node899" class="node">
<title>expert_13_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="128947.47,-965 128804.47,-965 128804.47,-924 128947.47,-924 128947.47,-965"/>
<text text-anchor="middle" x="128875.97" y="-953" font-family="Arial" font-size="10.00">Expert 14 (TP8) L13</text>
<text text-anchor="middle" x="128875.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="128875.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_15_stage2 -->
<g id="node900" class="node">
<title>expert_13_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="128786.47,-965 128643.47,-965 128643.47,-924 128786.47,-924 128786.47,-965"/>
<text text-anchor="middle" x="128714.97" y="-953" font-family="Arial" font-size="10.00">Expert 15 (TP8) L13</text>
<text text-anchor="middle" x="128714.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="128714.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_16_stage2 -->
<g id="node901" class="node">
<title>expert_13_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="128625.47,-965 128482.47,-965 128482.47,-924 128625.47,-924 128625.47,-965"/>
<text text-anchor="middle" x="128553.97" y="-953" font-family="Arial" font-size="10.00">Expert 16 (TP8) L13</text>
<text text-anchor="middle" x="128553.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="128553.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_17_stage2 -->
<g id="node902" class="node">
<title>expert_13_17_stage2</title>
<polygon fill="lightgreen" stroke="black" points="128464.47,-965 128321.47,-965 128321.47,-924 128464.47,-924 128464.47,-965"/>
<text text-anchor="middle" x="128392.97" y="-953" font-family="Arial" font-size="10.00">Expert 17 (TP8) L13</text>
<text text-anchor="middle" x="128392.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="128392.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_18_stage2 -->
<g id="node903" class="node">
<title>expert_13_18_stage2</title>
<polygon fill="lightgreen" stroke="black" points="128303.47,-965 128160.47,-965 128160.47,-924 128303.47,-924 128303.47,-965"/>
<text text-anchor="middle" x="128231.97" y="-953" font-family="Arial" font-size="10.00">Expert 18 (TP8) L13</text>
<text text-anchor="middle" x="128231.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="128231.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_19_stage2 -->
<g id="node904" class="node">
<title>expert_13_19_stage2</title>
<polygon fill="lightgreen" stroke="black" points="128142.47,-965 127999.47,-965 127999.47,-924 128142.47,-924 128142.47,-965"/>
<text text-anchor="middle" x="128070.97" y="-953" font-family="Arial" font-size="10.00">Expert 19 (TP8) L13</text>
<text text-anchor="middle" x="128070.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="128070.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_20_stage2 -->
<g id="node905" class="node">
<title>expert_13_20_stage2</title>
<polygon fill="lightgreen" stroke="black" points="127981.47,-965 127838.47,-965 127838.47,-924 127981.47,-924 127981.47,-965"/>
<text text-anchor="middle" x="127909.97" y="-953" font-family="Arial" font-size="10.00">Expert 20 (TP8) L13</text>
<text text-anchor="middle" x="127909.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="127909.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_21_stage2 -->
<g id="node906" class="node">
<title>expert_13_21_stage2</title>
<polygon fill="lightgreen" stroke="black" points="127820.47,-965 127677.47,-965 127677.47,-924 127820.47,-924 127820.47,-965"/>
<text text-anchor="middle" x="127748.97" y="-953" font-family="Arial" font-size="10.00">Expert 21 (TP8) L13</text>
<text text-anchor="middle" x="127748.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="127748.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_22_stage2 -->
<g id="node907" class="node">
<title>expert_13_22_stage2</title>
<polygon fill="lightgreen" stroke="black" points="127659.47,-965 127516.47,-965 127516.47,-924 127659.47,-924 127659.47,-965"/>
<text text-anchor="middle" x="127587.97" y="-953" font-family="Arial" font-size="10.00">Expert 22 (TP8) L13</text>
<text text-anchor="middle" x="127587.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="127587.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_23_stage2 -->
<g id="node908" class="node">
<title>expert_13_23_stage2</title>
<polygon fill="lightgreen" stroke="black" points="127498.47,-965 127355.47,-965 127355.47,-924 127498.47,-924 127498.47,-965"/>
<text text-anchor="middle" x="127426.97" y="-953" font-family="Arial" font-size="10.00">Expert 23 (TP8) L13</text>
<text text-anchor="middle" x="127426.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="127426.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_24_stage2 -->
<g id="node909" class="node">
<title>expert_13_24_stage2</title>
<polygon fill="lightgreen" stroke="black" points="127337.47,-965 127194.47,-965 127194.47,-924 127337.47,-924 127337.47,-965"/>
<text text-anchor="middle" x="127265.97" y="-953" font-family="Arial" font-size="10.00">Expert 24 (TP8) L13</text>
<text text-anchor="middle" x="127265.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="127265.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_25_stage2 -->
<g id="node910" class="node">
<title>expert_13_25_stage2</title>
<polygon fill="lightgreen" stroke="black" points="127176.47,-965 127033.47,-965 127033.47,-924 127176.47,-924 127176.47,-965"/>
<text text-anchor="middle" x="127104.97" y="-953" font-family="Arial" font-size="10.00">Expert 25 (TP8) L13</text>
<text text-anchor="middle" x="127104.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="127104.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_26_stage2 -->
<g id="node911" class="node">
<title>expert_13_26_stage2</title>
<polygon fill="lightgreen" stroke="black" points="127015.47,-965 126872.47,-965 126872.47,-924 127015.47,-924 127015.47,-965"/>
<text text-anchor="middle" x="126943.97" y="-953" font-family="Arial" font-size="10.00">Expert 26 (TP8) L13</text>
<text text-anchor="middle" x="126943.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="126943.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_27_stage2 -->
<g id="node912" class="node">
<title>expert_13_27_stage2</title>
<polygon fill="lightgreen" stroke="black" points="126854.47,-965 126711.47,-965 126711.47,-924 126854.47,-924 126854.47,-965"/>
<text text-anchor="middle" x="126782.97" y="-953" font-family="Arial" font-size="10.00">Expert 27 (TP8) L13</text>
<text text-anchor="middle" x="126782.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="126782.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_28_stage2 -->
<g id="node913" class="node">
<title>expert_13_28_stage2</title>
<polygon fill="lightgreen" stroke="black" points="126693.47,-965 126550.47,-965 126550.47,-924 126693.47,-924 126693.47,-965"/>
<text text-anchor="middle" x="126621.97" y="-953" font-family="Arial" font-size="10.00">Expert 28 (TP8) L13</text>
<text text-anchor="middle" x="126621.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="126621.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_29_stage2 -->
<g id="node914" class="node">
<title>expert_13_29_stage2</title>
<polygon fill="lightgreen" stroke="black" points="126532.47,-965 126389.47,-965 126389.47,-924 126532.47,-924 126532.47,-965"/>
<text text-anchor="middle" x="126460.97" y="-953" font-family="Arial" font-size="10.00">Expert 29 (TP8) L13</text>
<text text-anchor="middle" x="126460.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="126460.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_30_stage2 -->
<g id="node915" class="node">
<title>expert_13_30_stage2</title>
<polygon fill="lightgreen" stroke="black" points="126371.47,-965 126228.47,-965 126228.47,-924 126371.47,-924 126371.47,-965"/>
<text text-anchor="middle" x="126299.97" y="-953" font-family="Arial" font-size="10.00">Expert 30 (TP8) L13</text>
<text text-anchor="middle" x="126299.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="126299.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_31_stage2 -->
<g id="node916" class="node">
<title>expert_13_31_stage2</title>
<polygon fill="lightgreen" stroke="black" points="126210.47,-965 126067.47,-965 126067.47,-924 126210.47,-924 126210.47,-965"/>
<text text-anchor="middle" x="126138.97" y="-953" font-family="Arial" font-size="10.00">Expert 31 (TP8) L13</text>
<text text-anchor="middle" x="126138.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="126138.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_32_stage2 -->
<g id="node917" class="node">
<title>expert_13_32_stage2</title>
<polygon fill="lightgreen" stroke="black" points="126049.47,-965 125906.47,-965 125906.47,-924 126049.47,-924 126049.47,-965"/>
<text text-anchor="middle" x="125977.97" y="-953" font-family="Arial" font-size="10.00">Expert 32 (TP8) L13</text>
<text text-anchor="middle" x="125977.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="125977.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_33_stage2 -->
<g id="node918" class="node">
<title>expert_13_33_stage2</title>
<polygon fill="lightgreen" stroke="black" points="125888.47,-965 125745.47,-965 125745.47,-924 125888.47,-924 125888.47,-965"/>
<text text-anchor="middle" x="125816.97" y="-953" font-family="Arial" font-size="10.00">Expert 33 (TP8) L13</text>
<text text-anchor="middle" x="125816.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="125816.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_34_stage2 -->
<g id="node919" class="node">
<title>expert_13_34_stage2</title>
<polygon fill="lightgreen" stroke="black" points="125727.47,-965 125584.47,-965 125584.47,-924 125727.47,-924 125727.47,-965"/>
<text text-anchor="middle" x="125655.97" y="-953" font-family="Arial" font-size="10.00">Expert 34 (TP8) L13</text>
<text text-anchor="middle" x="125655.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="125655.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_35_stage2 -->
<g id="node920" class="node">
<title>expert_13_35_stage2</title>
<polygon fill="lightgreen" stroke="black" points="125566.47,-965 125423.47,-965 125423.47,-924 125566.47,-924 125566.47,-965"/>
<text text-anchor="middle" x="125494.97" y="-953" font-family="Arial" font-size="10.00">Expert 35 (TP8) L13</text>
<text text-anchor="middle" x="125494.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="125494.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_36_stage2 -->
<g id="node921" class="node">
<title>expert_13_36_stage2</title>
<polygon fill="lightgreen" stroke="black" points="125405.47,-965 125262.47,-965 125262.47,-924 125405.47,-924 125405.47,-965"/>
<text text-anchor="middle" x="125333.97" y="-953" font-family="Arial" font-size="10.00">Expert 36 (TP8) L13</text>
<text text-anchor="middle" x="125333.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="125333.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_37_stage2 -->
<g id="node922" class="node">
<title>expert_13_37_stage2</title>
<polygon fill="lightgreen" stroke="black" points="125244.47,-965 125101.47,-965 125101.47,-924 125244.47,-924 125244.47,-965"/>
<text text-anchor="middle" x="125172.97" y="-953" font-family="Arial" font-size="10.00">Expert 37 (TP8) L13</text>
<text text-anchor="middle" x="125172.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="125172.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_38_stage2 -->
<g id="node923" class="node">
<title>expert_13_38_stage2</title>
<polygon fill="lightgreen" stroke="black" points="125083.47,-965 124940.47,-965 124940.47,-924 125083.47,-924 125083.47,-965"/>
<text text-anchor="middle" x="125011.97" y="-953" font-family="Arial" font-size="10.00">Expert 38 (TP8) L13</text>
<text text-anchor="middle" x="125011.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="125011.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_39_stage2 -->
<g id="node924" class="node">
<title>expert_13_39_stage2</title>
<polygon fill="lightgreen" stroke="black" points="124922.47,-965 124779.47,-965 124779.47,-924 124922.47,-924 124922.47,-965"/>
<text text-anchor="middle" x="124850.97" y="-953" font-family="Arial" font-size="10.00">Expert 39 (TP8) L13</text>
<text text-anchor="middle" x="124850.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="124850.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_40_stage2 -->
<g id="node925" class="node">
<title>expert_13_40_stage2</title>
<polygon fill="lightgreen" stroke="black" points="124761.47,-965 124618.47,-965 124618.47,-924 124761.47,-924 124761.47,-965"/>
<text text-anchor="middle" x="124689.97" y="-953" font-family="Arial" font-size="10.00">Expert 40 (TP8) L13</text>
<text text-anchor="middle" x="124689.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="124689.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_41_stage2 -->
<g id="node926" class="node">
<title>expert_13_41_stage2</title>
<polygon fill="lightgreen" stroke="black" points="124600.47,-965 124457.47,-965 124457.47,-924 124600.47,-924 124600.47,-965"/>
<text text-anchor="middle" x="124528.97" y="-953" font-family="Arial" font-size="10.00">Expert 41 (TP8) L13</text>
<text text-anchor="middle" x="124528.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="124528.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_42_stage2 -->
<g id="node927" class="node">
<title>expert_13_42_stage2</title>
<polygon fill="lightgreen" stroke="black" points="124439.47,-965 124296.47,-965 124296.47,-924 124439.47,-924 124439.47,-965"/>
<text text-anchor="middle" x="124367.97" y="-953" font-family="Arial" font-size="10.00">Expert 42 (TP8) L13</text>
<text text-anchor="middle" x="124367.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="124367.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_43_stage2 -->
<g id="node928" class="node">
<title>expert_13_43_stage2</title>
<polygon fill="lightgreen" stroke="black" points="124278.47,-965 124135.47,-965 124135.47,-924 124278.47,-924 124278.47,-965"/>
<text text-anchor="middle" x="124206.97" y="-953" font-family="Arial" font-size="10.00">Expert 43 (TP8) L13</text>
<text text-anchor="middle" x="124206.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="124206.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_44_stage2 -->
<g id="node929" class="node">
<title>expert_13_44_stage2</title>
<polygon fill="lightgreen" stroke="black" points="124117.47,-965 123974.47,-965 123974.47,-924 124117.47,-924 124117.47,-965"/>
<text text-anchor="middle" x="124045.97" y="-953" font-family="Arial" font-size="10.00">Expert 44 (TP8) L13</text>
<text text-anchor="middle" x="124045.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="124045.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_45_stage2 -->
<g id="node930" class="node">
<title>expert_13_45_stage2</title>
<polygon fill="lightgreen" stroke="black" points="123956.47,-965 123813.47,-965 123813.47,-924 123956.47,-924 123956.47,-965"/>
<text text-anchor="middle" x="123884.97" y="-953" font-family="Arial" font-size="10.00">Expert 45 (TP8) L13</text>
<text text-anchor="middle" x="123884.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="123884.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_46_stage2 -->
<g id="node931" class="node">
<title>expert_13_46_stage2</title>
<polygon fill="lightgreen" stroke="black" points="123795.47,-965 123652.47,-965 123652.47,-924 123795.47,-924 123795.47,-965"/>
<text text-anchor="middle" x="123723.97" y="-953" font-family="Arial" font-size="10.00">Expert 46 (TP8) L13</text>
<text text-anchor="middle" x="123723.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="123723.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_47_stage2 -->
<g id="node932" class="node">
<title>expert_13_47_stage2</title>
<polygon fill="lightgreen" stroke="black" points="123634.47,-965 123491.47,-965 123491.47,-924 123634.47,-924 123634.47,-965"/>
<text text-anchor="middle" x="123562.97" y="-953" font-family="Arial" font-size="10.00">Expert 47 (TP8) L13</text>
<text text-anchor="middle" x="123562.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="123562.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_48_stage2 -->
<g id="node933" class="node">
<title>expert_13_48_stage2</title>
<polygon fill="lightgreen" stroke="black" points="123473.47,-965 123330.47,-965 123330.47,-924 123473.47,-924 123473.47,-965"/>
<text text-anchor="middle" x="123401.97" y="-953" font-family="Arial" font-size="10.00">Expert 48 (TP8) L13</text>
<text text-anchor="middle" x="123401.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="123401.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_49_stage2 -->
<g id="node934" class="node">
<title>expert_13_49_stage2</title>
<polygon fill="lightgreen" stroke="black" points="123312.47,-965 123169.47,-965 123169.47,-924 123312.47,-924 123312.47,-965"/>
<text text-anchor="middle" x="123240.97" y="-953" font-family="Arial" font-size="10.00">Expert 49 (TP8) L13</text>
<text text-anchor="middle" x="123240.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="123240.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_50_stage2 -->
<g id="node935" class="node">
<title>expert_13_50_stage2</title>
<polygon fill="lightgreen" stroke="black" points="123151.47,-965 123008.47,-965 123008.47,-924 123151.47,-924 123151.47,-965"/>
<text text-anchor="middle" x="123079.97" y="-953" font-family="Arial" font-size="10.00">Expert 50 (TP8) L13</text>
<text text-anchor="middle" x="123079.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="123079.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_51_stage2 -->
<g id="node936" class="node">
<title>expert_13_51_stage2</title>
<polygon fill="lightgreen" stroke="black" points="122990.47,-965 122847.47,-965 122847.47,-924 122990.47,-924 122990.47,-965"/>
<text text-anchor="middle" x="122918.97" y="-953" font-family="Arial" font-size="10.00">Expert 51 (TP8) L13</text>
<text text-anchor="middle" x="122918.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="122918.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_52_stage2 -->
<g id="node937" class="node">
<title>expert_13_52_stage2</title>
<polygon fill="lightgreen" stroke="black" points="122829.47,-965 122686.47,-965 122686.47,-924 122829.47,-924 122829.47,-965"/>
<text text-anchor="middle" x="122757.97" y="-953" font-family="Arial" font-size="10.00">Expert 52 (TP8) L13</text>
<text text-anchor="middle" x="122757.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="122757.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_53_stage2 -->
<g id="node938" class="node">
<title>expert_13_53_stage2</title>
<polygon fill="lightgreen" stroke="black" points="122668.47,-965 122525.47,-965 122525.47,-924 122668.47,-924 122668.47,-965"/>
<text text-anchor="middle" x="122596.97" y="-953" font-family="Arial" font-size="10.00">Expert 53 (TP8) L13</text>
<text text-anchor="middle" x="122596.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="122596.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_54_stage2 -->
<g id="node939" class="node">
<title>expert_13_54_stage2</title>
<polygon fill="lightgreen" stroke="black" points="122507.47,-965 122364.47,-965 122364.47,-924 122507.47,-924 122507.47,-965"/>
<text text-anchor="middle" x="122435.97" y="-953" font-family="Arial" font-size="10.00">Expert 54 (TP8) L13</text>
<text text-anchor="middle" x="122435.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="122435.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_55_stage2 -->
<g id="node940" class="node">
<title>expert_13_55_stage2</title>
<polygon fill="lightgreen" stroke="black" points="122346.47,-965 122203.47,-965 122203.47,-924 122346.47,-924 122346.47,-965"/>
<text text-anchor="middle" x="122274.97" y="-953" font-family="Arial" font-size="10.00">Expert 55 (TP8) L13</text>
<text text-anchor="middle" x="122274.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="122274.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_56_stage2 -->
<g id="node941" class="node">
<title>expert_13_56_stage2</title>
<polygon fill="lightgreen" stroke="black" points="122185.47,-965 122042.47,-965 122042.47,-924 122185.47,-924 122185.47,-965"/>
<text text-anchor="middle" x="122113.97" y="-953" font-family="Arial" font-size="10.00">Expert 56 (TP8) L13</text>
<text text-anchor="middle" x="122113.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="122113.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_57_stage2 -->
<g id="node942" class="node">
<title>expert_13_57_stage2</title>
<polygon fill="lightgreen" stroke="black" points="122024.47,-965 121881.47,-965 121881.47,-924 122024.47,-924 122024.47,-965"/>
<text text-anchor="middle" x="121952.97" y="-953" font-family="Arial" font-size="10.00">Expert 57 (TP8) L13</text>
<text text-anchor="middle" x="121952.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="121952.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_58_stage2 -->
<g id="node943" class="node">
<title>expert_13_58_stage2</title>
<polygon fill="lightgreen" stroke="black" points="121863.47,-965 121720.47,-965 121720.47,-924 121863.47,-924 121863.47,-965"/>
<text text-anchor="middle" x="121791.97" y="-953" font-family="Arial" font-size="10.00">Expert 58 (TP8) L13</text>
<text text-anchor="middle" x="121791.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="121791.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_59_stage2 -->
<g id="node944" class="node">
<title>expert_13_59_stage2</title>
<polygon fill="lightgreen" stroke="black" points="121702.47,-965 121559.47,-965 121559.47,-924 121702.47,-924 121702.47,-965"/>
<text text-anchor="middle" x="121630.97" y="-953" font-family="Arial" font-size="10.00">Expert 59 (TP8) L13</text>
<text text-anchor="middle" x="121630.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="121630.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_60_stage2 -->
<g id="node945" class="node">
<title>expert_13_60_stage2</title>
<polygon fill="lightgreen" stroke="black" points="121541.47,-965 121398.47,-965 121398.47,-924 121541.47,-924 121541.47,-965"/>
<text text-anchor="middle" x="121469.97" y="-953" font-family="Arial" font-size="10.00">Expert 60 (TP8) L13</text>
<text text-anchor="middle" x="121469.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="121469.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_61_stage2 -->
<g id="node946" class="node">
<title>expert_13_61_stage2</title>
<polygon fill="lightgreen" stroke="black" points="121380.47,-965 121237.47,-965 121237.47,-924 121380.47,-924 121380.47,-965"/>
<text text-anchor="middle" x="121308.97" y="-953" font-family="Arial" font-size="10.00">Expert 61 (TP8) L13</text>
<text text-anchor="middle" x="121308.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="121308.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_62_stage2 -->
<g id="node947" class="node">
<title>expert_13_62_stage2</title>
<polygon fill="lightgreen" stroke="black" points="121219.47,-965 121076.47,-965 121076.47,-924 121219.47,-924 121219.47,-965"/>
<text text-anchor="middle" x="121147.97" y="-953" font-family="Arial" font-size="10.00">Expert 62 (TP8) L13</text>
<text text-anchor="middle" x="121147.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="121147.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_13_63_stage2 -->
<g id="node948" class="node">
<title>expert_13_63_stage2</title>
<polygon fill="lightgreen" stroke="black" points="121058.47,-965 120915.47,-965 120915.47,-924 121058.47,-924 121058.47,-965"/>
<text text-anchor="middle" x="120986.97" y="-953" font-family="Arial" font-size="10.00">Expert 63 (TP8) L13</text>
<text text-anchor="middle" x="120986.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="120986.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_13_stage2 -->
<g id="node949" class="node">
<title>combine_13_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="120789.97" cy="-944.5" rx="107.46" ry="28.98"/>
<text text-anchor="middle" x="120789.97" y="-953" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L13</text>
<text text-anchor="middle" x="120789.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="120789.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_13_stage2 -->
<g id="node950" class="node">
<title>moe_out_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="120664.97,-965 120524.97,-965 120524.97,-924 120664.97,-924 120664.97,-965"/>
<text text-anchor="middle" x="120594.97" y="-953" font-family="Arial" font-size="10.00">MoE Output (TP8) L13</text>
<text text-anchor="middle" x="120594.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="120594.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_13_stage2 -->
<g id="node951" class="node">
<title>ln2_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="120506.97,-965 120366.97,-965 120366.97,-924 120506.97,-924 120506.97,-965"/>
<text text-anchor="middle" x="120436.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L13</text>
<text text-anchor="middle" x="120436.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="120436.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_14_stage2 -->
<g id="node952" class="node">
<title>ln1_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="120348.97,-965 120208.97,-965 120208.97,-924 120348.97,-924 120348.97,-965"/>
<text text-anchor="middle" x="120278.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L14</text>
<text text-anchor="middle" x="120278.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="120278.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_14_stage2 -->
<g id="node953" class="node">
<title>qkv_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="120190.97,-965 120044.97,-965 120044.97,-924 120190.97,-924 120190.97,-965"/>
<text text-anchor="middle" x="120117.97" y="-953" font-family="Arial" font-size="10.00">QKV Projection (TP8) L14</text>
<text text-anchor="middle" x="120117.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="120117.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_14_stage2 -->
<g id="node954" class="node">
<title>attn_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="120026.97,-965 119880.97,-965 119880.97,-924 120026.97,-924 120026.97,-965"/>
<text text-anchor="middle" x="119953.97" y="-953" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L14</text>
<text text-anchor="middle" x="119953.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="119953.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_14_stage2 -->
<g id="node955" class="node">
<title>attn_out_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="119862.97,-965 119722.97,-965 119722.97,-924 119862.97,-924 119862.97,-965"/>
<text text-anchor="middle" x="119792.97" y="-953" font-family="Arial" font-size="10.00">Attention Output (TP8) L14</text>
<text text-anchor="middle" x="119792.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="119792.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_14_stage2 -->
<g id="node956" class="node">
<title>route_14_stage2</title>
<polygon fill="lightcoral" stroke="black" points="119705.27,-985.5 119474.14,-985.5 119414.68,-903.5 119645.81,-903.5 119705.27,-985.5"/>
<text text-anchor="middle" x="119559.97" y="-953" font-family="Arial" font-size="10.00">MoE Routing (EP64) L14</text>
<text text-anchor="middle" x="119559.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="119559.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_14_stage2 -->
<g id="node957" class="node">
<title>dispatch_14_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="119287.97" cy="-944.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="119287.97" y="-953" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L14</text>
<text text-anchor="middle" x="119287.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="119287.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_14_0_stage2 -->
<g id="node958" class="node">
<title>expert_14_0_stage2</title>
<polygon fill="lightgreen" stroke="black" points="119161.47,-965 119018.47,-965 119018.47,-924 119161.47,-924 119161.47,-965"/>
<text text-anchor="middle" x="119089.97" y="-953" font-family="Arial" font-size="10.00">Expert 0 (TP8) L14</text>
<text text-anchor="middle" x="119089.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="119089.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_1_stage2 -->
<g id="node959" class="node">
<title>expert_14_1_stage2</title>
<polygon fill="lightgreen" stroke="black" points="119000.47,-965 118857.47,-965 118857.47,-924 119000.47,-924 119000.47,-965"/>
<text text-anchor="middle" x="118928.97" y="-953" font-family="Arial" font-size="10.00">Expert 1 (TP8) L14</text>
<text text-anchor="middle" x="118928.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="118928.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_2_stage2 -->
<g id="node960" class="node">
<title>expert_14_2_stage2</title>
<polygon fill="lightgreen" stroke="black" points="118839.47,-965 118696.47,-965 118696.47,-924 118839.47,-924 118839.47,-965"/>
<text text-anchor="middle" x="118767.97" y="-953" font-family="Arial" font-size="10.00">Expert 2 (TP8) L14</text>
<text text-anchor="middle" x="118767.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="118767.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_3_stage2 -->
<g id="node961" class="node">
<title>expert_14_3_stage2</title>
<polygon fill="lightgreen" stroke="black" points="118678.47,-965 118535.47,-965 118535.47,-924 118678.47,-924 118678.47,-965"/>
<text text-anchor="middle" x="118606.97" y="-953" font-family="Arial" font-size="10.00">Expert 3 (TP8) L14</text>
<text text-anchor="middle" x="118606.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="118606.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_4_stage2 -->
<g id="node962" class="node">
<title>expert_14_4_stage2</title>
<polygon fill="lightgreen" stroke="black" points="118517.47,-965 118374.47,-965 118374.47,-924 118517.47,-924 118517.47,-965"/>
<text text-anchor="middle" x="118445.97" y="-953" font-family="Arial" font-size="10.00">Expert 4 (TP8) L14</text>
<text text-anchor="middle" x="118445.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="118445.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_5_stage2 -->
<g id="node963" class="node">
<title>expert_14_5_stage2</title>
<polygon fill="lightgreen" stroke="black" points="118356.47,-965 118213.47,-965 118213.47,-924 118356.47,-924 118356.47,-965"/>
<text text-anchor="middle" x="118284.97" y="-953" font-family="Arial" font-size="10.00">Expert 5 (TP8) L14</text>
<text text-anchor="middle" x="118284.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="118284.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_6_stage2 -->
<g id="node964" class="node">
<title>expert_14_6_stage2</title>
<polygon fill="lightgreen" stroke="black" points="118195.47,-965 118052.47,-965 118052.47,-924 118195.47,-924 118195.47,-965"/>
<text text-anchor="middle" x="118123.97" y="-953" font-family="Arial" font-size="10.00">Expert 6 (TP8) L14</text>
<text text-anchor="middle" x="118123.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="118123.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_7_stage2 -->
<g id="node965" class="node">
<title>expert_14_7_stage2</title>
<polygon fill="lightgreen" stroke="black" points="118034.47,-965 117891.47,-965 117891.47,-924 118034.47,-924 118034.47,-965"/>
<text text-anchor="middle" x="117962.97" y="-953" font-family="Arial" font-size="10.00">Expert 7 (TP8) L14</text>
<text text-anchor="middle" x="117962.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="117962.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_8_stage2 -->
<g id="node966" class="node">
<title>expert_14_8_stage2</title>
<polygon fill="lightgreen" stroke="black" points="117873.47,-965 117730.47,-965 117730.47,-924 117873.47,-924 117873.47,-965"/>
<text text-anchor="middle" x="117801.97" y="-953" font-family="Arial" font-size="10.00">Expert 8 (TP8) L14</text>
<text text-anchor="middle" x="117801.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="117801.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_9_stage2 -->
<g id="node967" class="node">
<title>expert_14_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="117712.47,-965 117569.47,-965 117569.47,-924 117712.47,-924 117712.47,-965"/>
<text text-anchor="middle" x="117640.97" y="-953" font-family="Arial" font-size="10.00">Expert 9 (TP8) L14</text>
<text text-anchor="middle" x="117640.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="117640.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_10_stage2 -->
<g id="node968" class="node">
<title>expert_14_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="117551.47,-965 117408.47,-965 117408.47,-924 117551.47,-924 117551.47,-965"/>
<text text-anchor="middle" x="117479.97" y="-953" font-family="Arial" font-size="10.00">Expert 10 (TP8) L14</text>
<text text-anchor="middle" x="117479.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="117479.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_11_stage2 -->
<g id="node969" class="node">
<title>expert_14_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="117390.47,-965 117247.47,-965 117247.47,-924 117390.47,-924 117390.47,-965"/>
<text text-anchor="middle" x="117318.97" y="-953" font-family="Arial" font-size="10.00">Expert 11 (TP8) L14</text>
<text text-anchor="middle" x="117318.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="117318.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_12_stage2 -->
<g id="node970" class="node">
<title>expert_14_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="117229.47,-965 117086.47,-965 117086.47,-924 117229.47,-924 117229.47,-965"/>
<text text-anchor="middle" x="117157.97" y="-953" font-family="Arial" font-size="10.00">Expert 12 (TP8) L14</text>
<text text-anchor="middle" x="117157.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="117157.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_13_stage2 -->
<g id="node971" class="node">
<title>expert_14_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="117068.47,-965 116925.47,-965 116925.47,-924 117068.47,-924 117068.47,-965"/>
<text text-anchor="middle" x="116996.97" y="-953" font-family="Arial" font-size="10.00">Expert 13 (TP8) L14</text>
<text text-anchor="middle" x="116996.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="116996.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_14_stage2 -->
<g id="node972" class="node">
<title>expert_14_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="116907.47,-965 116764.47,-965 116764.47,-924 116907.47,-924 116907.47,-965"/>
<text text-anchor="middle" x="116835.97" y="-953" font-family="Arial" font-size="10.00">Expert 14 (TP8) L14</text>
<text text-anchor="middle" x="116835.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="116835.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_15_stage2 -->
<g id="node973" class="node">
<title>expert_14_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="116746.47,-965 116603.47,-965 116603.47,-924 116746.47,-924 116746.47,-965"/>
<text text-anchor="middle" x="116674.97" y="-953" font-family="Arial" font-size="10.00">Expert 15 (TP8) L14</text>
<text text-anchor="middle" x="116674.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="116674.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_16_stage2 -->
<g id="node974" class="node">
<title>expert_14_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="116585.47,-965 116442.47,-965 116442.47,-924 116585.47,-924 116585.47,-965"/>
<text text-anchor="middle" x="116513.97" y="-953" font-family="Arial" font-size="10.00">Expert 16 (TP8) L14</text>
<text text-anchor="middle" x="116513.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="116513.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_17_stage2 -->
<g id="node975" class="node">
<title>expert_14_17_stage2</title>
<polygon fill="lightgreen" stroke="black" points="116424.47,-965 116281.47,-965 116281.47,-924 116424.47,-924 116424.47,-965"/>
<text text-anchor="middle" x="116352.97" y="-953" font-family="Arial" font-size="10.00">Expert 17 (TP8) L14</text>
<text text-anchor="middle" x="116352.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="116352.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_18_stage2 -->
<g id="node976" class="node">
<title>expert_14_18_stage2</title>
<polygon fill="lightgreen" stroke="black" points="116263.47,-965 116120.47,-965 116120.47,-924 116263.47,-924 116263.47,-965"/>
<text text-anchor="middle" x="116191.97" y="-953" font-family="Arial" font-size="10.00">Expert 18 (TP8) L14</text>
<text text-anchor="middle" x="116191.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="116191.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_19_stage2 -->
<g id="node977" class="node">
<title>expert_14_19_stage2</title>
<polygon fill="lightgreen" stroke="black" points="116102.47,-965 115959.47,-965 115959.47,-924 116102.47,-924 116102.47,-965"/>
<text text-anchor="middle" x="116030.97" y="-953" font-family="Arial" font-size="10.00">Expert 19 (TP8) L14</text>
<text text-anchor="middle" x="116030.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="116030.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_20_stage2 -->
<g id="node978" class="node">
<title>expert_14_20_stage2</title>
<polygon fill="lightgreen" stroke="black" points="115941.47,-965 115798.47,-965 115798.47,-924 115941.47,-924 115941.47,-965"/>
<text text-anchor="middle" x="115869.97" y="-953" font-family="Arial" font-size="10.00">Expert 20 (TP8) L14</text>
<text text-anchor="middle" x="115869.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="115869.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_21_stage2 -->
<g id="node979" class="node">
<title>expert_14_21_stage2</title>
<polygon fill="lightgreen" stroke="black" points="115780.47,-965 115637.47,-965 115637.47,-924 115780.47,-924 115780.47,-965"/>
<text text-anchor="middle" x="115708.97" y="-953" font-family="Arial" font-size="10.00">Expert 21 (TP8) L14</text>
<text text-anchor="middle" x="115708.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="115708.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_22_stage2 -->
<g id="node980" class="node">
<title>expert_14_22_stage2</title>
<polygon fill="lightgreen" stroke="black" points="115619.47,-965 115476.47,-965 115476.47,-924 115619.47,-924 115619.47,-965"/>
<text text-anchor="middle" x="115547.97" y="-953" font-family="Arial" font-size="10.00">Expert 22 (TP8) L14</text>
<text text-anchor="middle" x="115547.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="115547.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_23_stage2 -->
<g id="node981" class="node">
<title>expert_14_23_stage2</title>
<polygon fill="lightgreen" stroke="black" points="115458.47,-965 115315.47,-965 115315.47,-924 115458.47,-924 115458.47,-965"/>
<text text-anchor="middle" x="115386.97" y="-953" font-family="Arial" font-size="10.00">Expert 23 (TP8) L14</text>
<text text-anchor="middle" x="115386.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="115386.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_24_stage2 -->
<g id="node982" class="node">
<title>expert_14_24_stage2</title>
<polygon fill="lightgreen" stroke="black" points="115297.47,-965 115154.47,-965 115154.47,-924 115297.47,-924 115297.47,-965"/>
<text text-anchor="middle" x="115225.97" y="-953" font-family="Arial" font-size="10.00">Expert 24 (TP8) L14</text>
<text text-anchor="middle" x="115225.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="115225.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_25_stage2 -->
<g id="node983" class="node">
<title>expert_14_25_stage2</title>
<polygon fill="lightgreen" stroke="black" points="115136.47,-965 114993.47,-965 114993.47,-924 115136.47,-924 115136.47,-965"/>
<text text-anchor="middle" x="115064.97" y="-953" font-family="Arial" font-size="10.00">Expert 25 (TP8) L14</text>
<text text-anchor="middle" x="115064.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="115064.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_26_stage2 -->
<g id="node984" class="node">
<title>expert_14_26_stage2</title>
<polygon fill="lightgreen" stroke="black" points="114975.47,-965 114832.47,-965 114832.47,-924 114975.47,-924 114975.47,-965"/>
<text text-anchor="middle" x="114903.97" y="-953" font-family="Arial" font-size="10.00">Expert 26 (TP8) L14</text>
<text text-anchor="middle" x="114903.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="114903.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_27_stage2 -->
<g id="node985" class="node">
<title>expert_14_27_stage2</title>
<polygon fill="lightgreen" stroke="black" points="114814.47,-965 114671.47,-965 114671.47,-924 114814.47,-924 114814.47,-965"/>
<text text-anchor="middle" x="114742.97" y="-953" font-family="Arial" font-size="10.00">Expert 27 (TP8) L14</text>
<text text-anchor="middle" x="114742.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="114742.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_28_stage2 -->
<g id="node986" class="node">
<title>expert_14_28_stage2</title>
<polygon fill="lightgreen" stroke="black" points="114653.47,-965 114510.47,-965 114510.47,-924 114653.47,-924 114653.47,-965"/>
<text text-anchor="middle" x="114581.97" y="-953" font-family="Arial" font-size="10.00">Expert 28 (TP8) L14</text>
<text text-anchor="middle" x="114581.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="114581.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_29_stage2 -->
<g id="node987" class="node">
<title>expert_14_29_stage2</title>
<polygon fill="lightgreen" stroke="black" points="114492.47,-965 114349.47,-965 114349.47,-924 114492.47,-924 114492.47,-965"/>
<text text-anchor="middle" x="114420.97" y="-953" font-family="Arial" font-size="10.00">Expert 29 (TP8) L14</text>
<text text-anchor="middle" x="114420.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="114420.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_30_stage2 -->
<g id="node988" class="node">
<title>expert_14_30_stage2</title>
<polygon fill="lightgreen" stroke="black" points="114331.47,-965 114188.47,-965 114188.47,-924 114331.47,-924 114331.47,-965"/>
<text text-anchor="middle" x="114259.97" y="-953" font-family="Arial" font-size="10.00">Expert 30 (TP8) L14</text>
<text text-anchor="middle" x="114259.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="114259.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_31_stage2 -->
<g id="node989" class="node">
<title>expert_14_31_stage2</title>
<polygon fill="lightgreen" stroke="black" points="114170.47,-965 114027.47,-965 114027.47,-924 114170.47,-924 114170.47,-965"/>
<text text-anchor="middle" x="114098.97" y="-953" font-family="Arial" font-size="10.00">Expert 31 (TP8) L14</text>
<text text-anchor="middle" x="114098.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="114098.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_32_stage2 -->
<g id="node990" class="node">
<title>expert_14_32_stage2</title>
<polygon fill="lightgreen" stroke="black" points="114009.47,-965 113866.47,-965 113866.47,-924 114009.47,-924 114009.47,-965"/>
<text text-anchor="middle" x="113937.97" y="-953" font-family="Arial" font-size="10.00">Expert 32 (TP8) L14</text>
<text text-anchor="middle" x="113937.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="113937.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_33_stage2 -->
<g id="node991" class="node">
<title>expert_14_33_stage2</title>
<polygon fill="lightgreen" stroke="black" points="113848.47,-965 113705.47,-965 113705.47,-924 113848.47,-924 113848.47,-965"/>
<text text-anchor="middle" x="113776.97" y="-953" font-family="Arial" font-size="10.00">Expert 33 (TP8) L14</text>
<text text-anchor="middle" x="113776.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="113776.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_34_stage2 -->
<g id="node992" class="node">
<title>expert_14_34_stage2</title>
<polygon fill="lightgreen" stroke="black" points="113687.47,-965 113544.47,-965 113544.47,-924 113687.47,-924 113687.47,-965"/>
<text text-anchor="middle" x="113615.97" y="-953" font-family="Arial" font-size="10.00">Expert 34 (TP8) L14</text>
<text text-anchor="middle" x="113615.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="113615.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_35_stage2 -->
<g id="node993" class="node">
<title>expert_14_35_stage2</title>
<polygon fill="lightgreen" stroke="black" points="113526.47,-965 113383.47,-965 113383.47,-924 113526.47,-924 113526.47,-965"/>
<text text-anchor="middle" x="113454.97" y="-953" font-family="Arial" font-size="10.00">Expert 35 (TP8) L14</text>
<text text-anchor="middle" x="113454.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="113454.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_36_stage2 -->
<g id="node994" class="node">
<title>expert_14_36_stage2</title>
<polygon fill="lightgreen" stroke="black" points="113365.47,-965 113222.47,-965 113222.47,-924 113365.47,-924 113365.47,-965"/>
<text text-anchor="middle" x="113293.97" y="-953" font-family="Arial" font-size="10.00">Expert 36 (TP8) L14</text>
<text text-anchor="middle" x="113293.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="113293.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_37_stage2 -->
<g id="node995" class="node">
<title>expert_14_37_stage2</title>
<polygon fill="lightgreen" stroke="black" points="113204.47,-965 113061.47,-965 113061.47,-924 113204.47,-924 113204.47,-965"/>
<text text-anchor="middle" x="113132.97" y="-953" font-family="Arial" font-size="10.00">Expert 37 (TP8) L14</text>
<text text-anchor="middle" x="113132.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="113132.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_38_stage2 -->
<g id="node996" class="node">
<title>expert_14_38_stage2</title>
<polygon fill="lightgreen" stroke="black" points="113043.47,-965 112900.47,-965 112900.47,-924 113043.47,-924 113043.47,-965"/>
<text text-anchor="middle" x="112971.97" y="-953" font-family="Arial" font-size="10.00">Expert 38 (TP8) L14</text>
<text text-anchor="middle" x="112971.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="112971.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_39_stage2 -->
<g id="node997" class="node">
<title>expert_14_39_stage2</title>
<polygon fill="lightgreen" stroke="black" points="112882.47,-965 112739.47,-965 112739.47,-924 112882.47,-924 112882.47,-965"/>
<text text-anchor="middle" x="112810.97" y="-953" font-family="Arial" font-size="10.00">Expert 39 (TP8) L14</text>
<text text-anchor="middle" x="112810.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="112810.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_40_stage2 -->
<g id="node998" class="node">
<title>expert_14_40_stage2</title>
<polygon fill="lightgreen" stroke="black" points="112721.47,-965 112578.47,-965 112578.47,-924 112721.47,-924 112721.47,-965"/>
<text text-anchor="middle" x="112649.97" y="-953" font-family="Arial" font-size="10.00">Expert 40 (TP8) L14</text>
<text text-anchor="middle" x="112649.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="112649.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_41_stage2 -->
<g id="node999" class="node">
<title>expert_14_41_stage2</title>
<polygon fill="lightgreen" stroke="black" points="112560.47,-965 112417.47,-965 112417.47,-924 112560.47,-924 112560.47,-965"/>
<text text-anchor="middle" x="112488.97" y="-953" font-family="Arial" font-size="10.00">Expert 41 (TP8) L14</text>
<text text-anchor="middle" x="112488.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="112488.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_42_stage2 -->
<g id="node1000" class="node">
<title>expert_14_42_stage2</title>
<polygon fill="lightgreen" stroke="black" points="112399.47,-965 112256.47,-965 112256.47,-924 112399.47,-924 112399.47,-965"/>
<text text-anchor="middle" x="112327.97" y="-953" font-family="Arial" font-size="10.00">Expert 42 (TP8) L14</text>
<text text-anchor="middle" x="112327.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="112327.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_43_stage2 -->
<g id="node1001" class="node">
<title>expert_14_43_stage2</title>
<polygon fill="lightgreen" stroke="black" points="112238.47,-965 112095.47,-965 112095.47,-924 112238.47,-924 112238.47,-965"/>
<text text-anchor="middle" x="112166.97" y="-953" font-family="Arial" font-size="10.00">Expert 43 (TP8) L14</text>
<text text-anchor="middle" x="112166.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="112166.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_44_stage2 -->
<g id="node1002" class="node">
<title>expert_14_44_stage2</title>
<polygon fill="lightgreen" stroke="black" points="112077.47,-965 111934.47,-965 111934.47,-924 112077.47,-924 112077.47,-965"/>
<text text-anchor="middle" x="112005.97" y="-953" font-family="Arial" font-size="10.00">Expert 44 (TP8) L14</text>
<text text-anchor="middle" x="112005.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="112005.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_45_stage2 -->
<g id="node1003" class="node">
<title>expert_14_45_stage2</title>
<polygon fill="lightgreen" stroke="black" points="111916.47,-965 111773.47,-965 111773.47,-924 111916.47,-924 111916.47,-965"/>
<text text-anchor="middle" x="111844.97" y="-953" font-family="Arial" font-size="10.00">Expert 45 (TP8) L14</text>
<text text-anchor="middle" x="111844.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="111844.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_46_stage2 -->
<g id="node1004" class="node">
<title>expert_14_46_stage2</title>
<polygon fill="lightgreen" stroke="black" points="111755.47,-965 111612.47,-965 111612.47,-924 111755.47,-924 111755.47,-965"/>
<text text-anchor="middle" x="111683.97" y="-953" font-family="Arial" font-size="10.00">Expert 46 (TP8) L14</text>
<text text-anchor="middle" x="111683.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="111683.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_47_stage2 -->
<g id="node1005" class="node">
<title>expert_14_47_stage2</title>
<polygon fill="lightgreen" stroke="black" points="111594.47,-965 111451.47,-965 111451.47,-924 111594.47,-924 111594.47,-965"/>
<text text-anchor="middle" x="111522.97" y="-953" font-family="Arial" font-size="10.00">Expert 47 (TP8) L14</text>
<text text-anchor="middle" x="111522.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="111522.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_48_stage2 -->
<g id="node1006" class="node">
<title>expert_14_48_stage2</title>
<polygon fill="lightgreen" stroke="black" points="111433.47,-965 111290.47,-965 111290.47,-924 111433.47,-924 111433.47,-965"/>
<text text-anchor="middle" x="111361.97" y="-953" font-family="Arial" font-size="10.00">Expert 48 (TP8) L14</text>
<text text-anchor="middle" x="111361.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="111361.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_49_stage2 -->
<g id="node1007" class="node">
<title>expert_14_49_stage2</title>
<polygon fill="lightgreen" stroke="black" points="111272.47,-965 111129.47,-965 111129.47,-924 111272.47,-924 111272.47,-965"/>
<text text-anchor="middle" x="111200.97" y="-953" font-family="Arial" font-size="10.00">Expert 49 (TP8) L14</text>
<text text-anchor="middle" x="111200.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="111200.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_50_stage2 -->
<g id="node1008" class="node">
<title>expert_14_50_stage2</title>
<polygon fill="lightgreen" stroke="black" points="111111.47,-965 110968.47,-965 110968.47,-924 111111.47,-924 111111.47,-965"/>
<text text-anchor="middle" x="111039.97" y="-953" font-family="Arial" font-size="10.00">Expert 50 (TP8) L14</text>
<text text-anchor="middle" x="111039.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="111039.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_51_stage2 -->
<g id="node1009" class="node">
<title>expert_14_51_stage2</title>
<polygon fill="lightgreen" stroke="black" points="110950.47,-965 110807.47,-965 110807.47,-924 110950.47,-924 110950.47,-965"/>
<text text-anchor="middle" x="110878.97" y="-953" font-family="Arial" font-size="10.00">Expert 51 (TP8) L14</text>
<text text-anchor="middle" x="110878.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="110878.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_52_stage2 -->
<g id="node1010" class="node">
<title>expert_14_52_stage2</title>
<polygon fill="lightgreen" stroke="black" points="110789.47,-965 110646.47,-965 110646.47,-924 110789.47,-924 110789.47,-965"/>
<text text-anchor="middle" x="110717.97" y="-953" font-family="Arial" font-size="10.00">Expert 52 (TP8) L14</text>
<text text-anchor="middle" x="110717.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="110717.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_53_stage2 -->
<g id="node1011" class="node">
<title>expert_14_53_stage2</title>
<polygon fill="lightgreen" stroke="black" points="110628.47,-965 110485.47,-965 110485.47,-924 110628.47,-924 110628.47,-965"/>
<text text-anchor="middle" x="110556.97" y="-953" font-family="Arial" font-size="10.00">Expert 53 (TP8) L14</text>
<text text-anchor="middle" x="110556.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="110556.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_54_stage2 -->
<g id="node1012" class="node">
<title>expert_14_54_stage2</title>
<polygon fill="lightgreen" stroke="black" points="110467.47,-965 110324.47,-965 110324.47,-924 110467.47,-924 110467.47,-965"/>
<text text-anchor="middle" x="110395.97" y="-953" font-family="Arial" font-size="10.00">Expert 54 (TP8) L14</text>
<text text-anchor="middle" x="110395.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="110395.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_55_stage2 -->
<g id="node1013" class="node">
<title>expert_14_55_stage2</title>
<polygon fill="lightgreen" stroke="black" points="110306.47,-965 110163.47,-965 110163.47,-924 110306.47,-924 110306.47,-965"/>
<text text-anchor="middle" x="110234.97" y="-953" font-family="Arial" font-size="10.00">Expert 55 (TP8) L14</text>
<text text-anchor="middle" x="110234.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="110234.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_56_stage2 -->
<g id="node1014" class="node">
<title>expert_14_56_stage2</title>
<polygon fill="lightgreen" stroke="black" points="110145.47,-965 110002.47,-965 110002.47,-924 110145.47,-924 110145.47,-965"/>
<text text-anchor="middle" x="110073.97" y="-953" font-family="Arial" font-size="10.00">Expert 56 (TP8) L14</text>
<text text-anchor="middle" x="110073.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="110073.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_57_stage2 -->
<g id="node1015" class="node">
<title>expert_14_57_stage2</title>
<polygon fill="lightgreen" stroke="black" points="109984.47,-965 109841.47,-965 109841.47,-924 109984.47,-924 109984.47,-965"/>
<text text-anchor="middle" x="109912.97" y="-953" font-family="Arial" font-size="10.00">Expert 57 (TP8) L14</text>
<text text-anchor="middle" x="109912.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="109912.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_58_stage2 -->
<g id="node1016" class="node">
<title>expert_14_58_stage2</title>
<polygon fill="lightgreen" stroke="black" points="109823.47,-965 109680.47,-965 109680.47,-924 109823.47,-924 109823.47,-965"/>
<text text-anchor="middle" x="109751.97" y="-953" font-family="Arial" font-size="10.00">Expert 58 (TP8) L14</text>
<text text-anchor="middle" x="109751.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="109751.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_59_stage2 -->
<g id="node1017" class="node">
<title>expert_14_59_stage2</title>
<polygon fill="lightgreen" stroke="black" points="109662.47,-965 109519.47,-965 109519.47,-924 109662.47,-924 109662.47,-965"/>
<text text-anchor="middle" x="109590.97" y="-953" font-family="Arial" font-size="10.00">Expert 59 (TP8) L14</text>
<text text-anchor="middle" x="109590.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="109590.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_60_stage2 -->
<g id="node1018" class="node">
<title>expert_14_60_stage2</title>
<polygon fill="lightgreen" stroke="black" points="109501.47,-965 109358.47,-965 109358.47,-924 109501.47,-924 109501.47,-965"/>
<text text-anchor="middle" x="109429.97" y="-953" font-family="Arial" font-size="10.00">Expert 60 (TP8) L14</text>
<text text-anchor="middle" x="109429.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="109429.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_61_stage2 -->
<g id="node1019" class="node">
<title>expert_14_61_stage2</title>
<polygon fill="lightgreen" stroke="black" points="109340.47,-965 109197.47,-965 109197.47,-924 109340.47,-924 109340.47,-965"/>
<text text-anchor="middle" x="109268.97" y="-953" font-family="Arial" font-size="10.00">Expert 61 (TP8) L14</text>
<text text-anchor="middle" x="109268.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="109268.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_62_stage2 -->
<g id="node1020" class="node">
<title>expert_14_62_stage2</title>
<polygon fill="lightgreen" stroke="black" points="109179.47,-965 109036.47,-965 109036.47,-924 109179.47,-924 109179.47,-965"/>
<text text-anchor="middle" x="109107.97" y="-953" font-family="Arial" font-size="10.00">Expert 62 (TP8) L14</text>
<text text-anchor="middle" x="109107.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="109107.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_14_63_stage2 -->
<g id="node1021" class="node">
<title>expert_14_63_stage2</title>
<polygon fill="lightgreen" stroke="black" points="109018.47,-965 108875.47,-965 108875.47,-924 109018.47,-924 109018.47,-965"/>
<text text-anchor="middle" x="108946.97" y="-953" font-family="Arial" font-size="10.00">Expert 63 (TP8) L14</text>
<text text-anchor="middle" x="108946.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="108946.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_14_stage2 -->
<g id="node1022" class="node">
<title>combine_14_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="108749.97" cy="-944.5" rx="107.46" ry="28.98"/>
<text text-anchor="middle" x="108749.97" y="-953" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L14</text>
<text text-anchor="middle" x="108749.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="108749.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_14_stage2 -->
<g id="node1023" class="node">
<title>moe_out_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="108624.97,-965 108484.97,-965 108484.97,-924 108624.97,-924 108624.97,-965"/>
<text text-anchor="middle" x="108554.97" y="-953" font-family="Arial" font-size="10.00">MoE Output (TP8) L14</text>
<text text-anchor="middle" x="108554.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="108554.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_14_stage2 -->
<g id="node1024" class="node">
<title>ln2_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="108466.97,-965 108326.97,-965 108326.97,-924 108466.97,-924 108466.97,-965"/>
<text text-anchor="middle" x="108396.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L14</text>
<text text-anchor="middle" x="108396.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="108396.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_15_stage2 -->
<g id="node1025" class="node">
<title>ln1_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="108308.97,-965 108168.97,-965 108168.97,-924 108308.97,-924 108308.97,-965"/>
<text text-anchor="middle" x="108238.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L15</text>
<text text-anchor="middle" x="108238.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="108238.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_15_stage2 -->
<g id="node1026" class="node">
<title>qkv_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="108150.97,-965 108004.97,-965 108004.97,-924 108150.97,-924 108150.97,-965"/>
<text text-anchor="middle" x="108077.97" y="-953" font-family="Arial" font-size="10.00">QKV Projection (TP8) L15</text>
<text text-anchor="middle" x="108077.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="108077.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_15_stage2 -->
<g id="node1027" class="node">
<title>attn_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="107986.97,-965 107840.97,-965 107840.97,-924 107986.97,-924 107986.97,-965"/>
<text text-anchor="middle" x="107913.97" y="-953" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L15</text>
<text text-anchor="middle" x="107913.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="107913.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_15_stage2 -->
<g id="node1028" class="node">
<title>attn_out_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="107822.97,-965 107682.97,-965 107682.97,-924 107822.97,-924 107822.97,-965"/>
<text text-anchor="middle" x="107752.97" y="-953" font-family="Arial" font-size="10.00">Attention Output (TP8) L15</text>
<text text-anchor="middle" x="107752.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="107752.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_15_stage2 -->
<g id="node1029" class="node">
<title>route_15_stage2</title>
<polygon fill="lightcoral" stroke="black" points="107665.27,-985.5 107434.14,-985.5 107374.68,-903.5 107605.81,-903.5 107665.27,-985.5"/>
<text text-anchor="middle" x="107519.97" y="-953" font-family="Arial" font-size="10.00">MoE Routing (EP64) L15</text>
<text text-anchor="middle" x="107519.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="107519.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_15_stage2 -->
<g id="node1030" class="node">
<title>dispatch_15_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="107247.97" cy="-944.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="107247.97" y="-953" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L15</text>
<text text-anchor="middle" x="107247.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="107247.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_15_0_stage2 -->
<g id="node1031" class="node">
<title>expert_15_0_stage2</title>
<polygon fill="lightgreen" stroke="black" points="107121.47,-965 106978.47,-965 106978.47,-924 107121.47,-924 107121.47,-965"/>
<text text-anchor="middle" x="107049.97" y="-953" font-family="Arial" font-size="10.00">Expert 0 (TP8) L15</text>
<text text-anchor="middle" x="107049.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="107049.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_1_stage2 -->
<g id="node1032" class="node">
<title>expert_15_1_stage2</title>
<polygon fill="lightgreen" stroke="black" points="106960.47,-965 106817.47,-965 106817.47,-924 106960.47,-924 106960.47,-965"/>
<text text-anchor="middle" x="106888.97" y="-953" font-family="Arial" font-size="10.00">Expert 1 (TP8) L15</text>
<text text-anchor="middle" x="106888.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="106888.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_2_stage2 -->
<g id="node1033" class="node">
<title>expert_15_2_stage2</title>
<polygon fill="lightgreen" stroke="black" points="106799.47,-965 106656.47,-965 106656.47,-924 106799.47,-924 106799.47,-965"/>
<text text-anchor="middle" x="106727.97" y="-953" font-family="Arial" font-size="10.00">Expert 2 (TP8) L15</text>
<text text-anchor="middle" x="106727.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="106727.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_3_stage2 -->
<g id="node1034" class="node">
<title>expert_15_3_stage2</title>
<polygon fill="lightgreen" stroke="black" points="106638.47,-965 106495.47,-965 106495.47,-924 106638.47,-924 106638.47,-965"/>
<text text-anchor="middle" x="106566.97" y="-953" font-family="Arial" font-size="10.00">Expert 3 (TP8) L15</text>
<text text-anchor="middle" x="106566.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="106566.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_4_stage2 -->
<g id="node1035" class="node">
<title>expert_15_4_stage2</title>
<polygon fill="lightgreen" stroke="black" points="106477.47,-965 106334.47,-965 106334.47,-924 106477.47,-924 106477.47,-965"/>
<text text-anchor="middle" x="106405.97" y="-953" font-family="Arial" font-size="10.00">Expert 4 (TP8) L15</text>
<text text-anchor="middle" x="106405.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="106405.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_5_stage2 -->
<g id="node1036" class="node">
<title>expert_15_5_stage2</title>
<polygon fill="lightgreen" stroke="black" points="106316.47,-965 106173.47,-965 106173.47,-924 106316.47,-924 106316.47,-965"/>
<text text-anchor="middle" x="106244.97" y="-953" font-family="Arial" font-size="10.00">Expert 5 (TP8) L15</text>
<text text-anchor="middle" x="106244.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="106244.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_6_stage2 -->
<g id="node1037" class="node">
<title>expert_15_6_stage2</title>
<polygon fill="lightgreen" stroke="black" points="106155.47,-965 106012.47,-965 106012.47,-924 106155.47,-924 106155.47,-965"/>
<text text-anchor="middle" x="106083.97" y="-953" font-family="Arial" font-size="10.00">Expert 6 (TP8) L15</text>
<text text-anchor="middle" x="106083.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="106083.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_7_stage2 -->
<g id="node1038" class="node">
<title>expert_15_7_stage2</title>
<polygon fill="lightgreen" stroke="black" points="105994.47,-965 105851.47,-965 105851.47,-924 105994.47,-924 105994.47,-965"/>
<text text-anchor="middle" x="105922.97" y="-953" font-family="Arial" font-size="10.00">Expert 7 (TP8) L15</text>
<text text-anchor="middle" x="105922.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="105922.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_8_stage2 -->
<g id="node1039" class="node">
<title>expert_15_8_stage2</title>
<polygon fill="lightgreen" stroke="black" points="105833.47,-965 105690.47,-965 105690.47,-924 105833.47,-924 105833.47,-965"/>
<text text-anchor="middle" x="105761.97" y="-953" font-family="Arial" font-size="10.00">Expert 8 (TP8) L15</text>
<text text-anchor="middle" x="105761.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="105761.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_9_stage2 -->
<g id="node1040" class="node">
<title>expert_15_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="105672.47,-965 105529.47,-965 105529.47,-924 105672.47,-924 105672.47,-965"/>
<text text-anchor="middle" x="105600.97" y="-953" font-family="Arial" font-size="10.00">Expert 9 (TP8) L15</text>
<text text-anchor="middle" x="105600.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="105600.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_10_stage2 -->
<g id="node1041" class="node">
<title>expert_15_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="105511.47,-965 105368.47,-965 105368.47,-924 105511.47,-924 105511.47,-965"/>
<text text-anchor="middle" x="105439.97" y="-953" font-family="Arial" font-size="10.00">Expert 10 (TP8) L15</text>
<text text-anchor="middle" x="105439.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="105439.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_11_stage2 -->
<g id="node1042" class="node">
<title>expert_15_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="105350.47,-965 105207.47,-965 105207.47,-924 105350.47,-924 105350.47,-965"/>
<text text-anchor="middle" x="105278.97" y="-953" font-family="Arial" font-size="10.00">Expert 11 (TP8) L15</text>
<text text-anchor="middle" x="105278.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="105278.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_12_stage2 -->
<g id="node1043" class="node">
<title>expert_15_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="105189.47,-965 105046.47,-965 105046.47,-924 105189.47,-924 105189.47,-965"/>
<text text-anchor="middle" x="105117.97" y="-953" font-family="Arial" font-size="10.00">Expert 12 (TP8) L15</text>
<text text-anchor="middle" x="105117.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="105117.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_13_stage2 -->
<g id="node1044" class="node">
<title>expert_15_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="105028.47,-965 104885.47,-965 104885.47,-924 105028.47,-924 105028.47,-965"/>
<text text-anchor="middle" x="104956.97" y="-953" font-family="Arial" font-size="10.00">Expert 13 (TP8) L15</text>
<text text-anchor="middle" x="104956.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="104956.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_14_stage2 -->
<g id="node1045" class="node">
<title>expert_15_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="104867.47,-965 104724.47,-965 104724.47,-924 104867.47,-924 104867.47,-965"/>
<text text-anchor="middle" x="104795.97" y="-953" font-family="Arial" font-size="10.00">Expert 14 (TP8) L15</text>
<text text-anchor="middle" x="104795.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="104795.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_15_stage2 -->
<g id="node1046" class="node">
<title>expert_15_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="104706.47,-965 104563.47,-965 104563.47,-924 104706.47,-924 104706.47,-965"/>
<text text-anchor="middle" x="104634.97" y="-953" font-family="Arial" font-size="10.00">Expert 15 (TP8) L15</text>
<text text-anchor="middle" x="104634.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="104634.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_16_stage2 -->
<g id="node1047" class="node">
<title>expert_15_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="104545.47,-965 104402.47,-965 104402.47,-924 104545.47,-924 104545.47,-965"/>
<text text-anchor="middle" x="104473.97" y="-953" font-family="Arial" font-size="10.00">Expert 16 (TP8) L15</text>
<text text-anchor="middle" x="104473.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="104473.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_17_stage2 -->
<g id="node1048" class="node">
<title>expert_15_17_stage2</title>
<polygon fill="lightgreen" stroke="black" points="104384.47,-965 104241.47,-965 104241.47,-924 104384.47,-924 104384.47,-965"/>
<text text-anchor="middle" x="104312.97" y="-953" font-family="Arial" font-size="10.00">Expert 17 (TP8) L15</text>
<text text-anchor="middle" x="104312.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="104312.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_18_stage2 -->
<g id="node1049" class="node">
<title>expert_15_18_stage2</title>
<polygon fill="lightgreen" stroke="black" points="104223.47,-965 104080.47,-965 104080.47,-924 104223.47,-924 104223.47,-965"/>
<text text-anchor="middle" x="104151.97" y="-953" font-family="Arial" font-size="10.00">Expert 18 (TP8) L15</text>
<text text-anchor="middle" x="104151.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="104151.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_19_stage2 -->
<g id="node1050" class="node">
<title>expert_15_19_stage2</title>
<polygon fill="lightgreen" stroke="black" points="104062.47,-965 103919.47,-965 103919.47,-924 104062.47,-924 104062.47,-965"/>
<text text-anchor="middle" x="103990.97" y="-953" font-family="Arial" font-size="10.00">Expert 19 (TP8) L15</text>
<text text-anchor="middle" x="103990.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="103990.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_20_stage2 -->
<g id="node1051" class="node">
<title>expert_15_20_stage2</title>
<polygon fill="lightgreen" stroke="black" points="103901.47,-965 103758.47,-965 103758.47,-924 103901.47,-924 103901.47,-965"/>
<text text-anchor="middle" x="103829.97" y="-953" font-family="Arial" font-size="10.00">Expert 20 (TP8) L15</text>
<text text-anchor="middle" x="103829.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="103829.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_21_stage2 -->
<g id="node1052" class="node">
<title>expert_15_21_stage2</title>
<polygon fill="lightgreen" stroke="black" points="103740.47,-965 103597.47,-965 103597.47,-924 103740.47,-924 103740.47,-965"/>
<text text-anchor="middle" x="103668.97" y="-953" font-family="Arial" font-size="10.00">Expert 21 (TP8) L15</text>
<text text-anchor="middle" x="103668.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="103668.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_22_stage2 -->
<g id="node1053" class="node">
<title>expert_15_22_stage2</title>
<polygon fill="lightgreen" stroke="black" points="103579.47,-965 103436.47,-965 103436.47,-924 103579.47,-924 103579.47,-965"/>
<text text-anchor="middle" x="103507.97" y="-953" font-family="Arial" font-size="10.00">Expert 22 (TP8) L15</text>
<text text-anchor="middle" x="103507.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="103507.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_23_stage2 -->
<g id="node1054" class="node">
<title>expert_15_23_stage2</title>
<polygon fill="lightgreen" stroke="black" points="103418.47,-965 103275.47,-965 103275.47,-924 103418.47,-924 103418.47,-965"/>
<text text-anchor="middle" x="103346.97" y="-953" font-family="Arial" font-size="10.00">Expert 23 (TP8) L15</text>
<text text-anchor="middle" x="103346.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="103346.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_24_stage2 -->
<g id="node1055" class="node">
<title>expert_15_24_stage2</title>
<polygon fill="lightgreen" stroke="black" points="103257.47,-965 103114.47,-965 103114.47,-924 103257.47,-924 103257.47,-965"/>
<text text-anchor="middle" x="103185.97" y="-953" font-family="Arial" font-size="10.00">Expert 24 (TP8) L15</text>
<text text-anchor="middle" x="103185.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="103185.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_25_stage2 -->
<g id="node1056" class="node">
<title>expert_15_25_stage2</title>
<polygon fill="lightgreen" stroke="black" points="103096.47,-965 102953.47,-965 102953.47,-924 103096.47,-924 103096.47,-965"/>
<text text-anchor="middle" x="103024.97" y="-953" font-family="Arial" font-size="10.00">Expert 25 (TP8) L15</text>
<text text-anchor="middle" x="103024.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="103024.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_26_stage2 -->
<g id="node1057" class="node">
<title>expert_15_26_stage2</title>
<polygon fill="lightgreen" stroke="black" points="102935.47,-965 102792.47,-965 102792.47,-924 102935.47,-924 102935.47,-965"/>
<text text-anchor="middle" x="102863.97" y="-953" font-family="Arial" font-size="10.00">Expert 26 (TP8) L15</text>
<text text-anchor="middle" x="102863.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="102863.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_27_stage2 -->
<g id="node1058" class="node">
<title>expert_15_27_stage2</title>
<polygon fill="lightgreen" stroke="black" points="102774.47,-965 102631.47,-965 102631.47,-924 102774.47,-924 102774.47,-965"/>
<text text-anchor="middle" x="102702.97" y="-953" font-family="Arial" font-size="10.00">Expert 27 (TP8) L15</text>
<text text-anchor="middle" x="102702.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="102702.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_28_stage2 -->
<g id="node1059" class="node">
<title>expert_15_28_stage2</title>
<polygon fill="lightgreen" stroke="black" points="102613.47,-965 102470.47,-965 102470.47,-924 102613.47,-924 102613.47,-965"/>
<text text-anchor="middle" x="102541.97" y="-953" font-family="Arial" font-size="10.00">Expert 28 (TP8) L15</text>
<text text-anchor="middle" x="102541.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="102541.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_29_stage2 -->
<g id="node1060" class="node">
<title>expert_15_29_stage2</title>
<polygon fill="lightgreen" stroke="black" points="102452.47,-965 102309.47,-965 102309.47,-924 102452.47,-924 102452.47,-965"/>
<text text-anchor="middle" x="102380.97" y="-953" font-family="Arial" font-size="10.00">Expert 29 (TP8) L15</text>
<text text-anchor="middle" x="102380.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="102380.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_30_stage2 -->
<g id="node1061" class="node">
<title>expert_15_30_stage2</title>
<polygon fill="lightgreen" stroke="black" points="102291.47,-965 102148.47,-965 102148.47,-924 102291.47,-924 102291.47,-965"/>
<text text-anchor="middle" x="102219.97" y="-953" font-family="Arial" font-size="10.00">Expert 30 (TP8) L15</text>
<text text-anchor="middle" x="102219.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="102219.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_31_stage2 -->
<g id="node1062" class="node">
<title>expert_15_31_stage2</title>
<polygon fill="lightgreen" stroke="black" points="102130.47,-965 101987.47,-965 101987.47,-924 102130.47,-924 102130.47,-965"/>
<text text-anchor="middle" x="102058.97" y="-953" font-family="Arial" font-size="10.00">Expert 31 (TP8) L15</text>
<text text-anchor="middle" x="102058.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="102058.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_32_stage2 -->
<g id="node1063" class="node">
<title>expert_15_32_stage2</title>
<polygon fill="lightgreen" stroke="black" points="101969.47,-965 101826.47,-965 101826.47,-924 101969.47,-924 101969.47,-965"/>
<text text-anchor="middle" x="101897.97" y="-953" font-family="Arial" font-size="10.00">Expert 32 (TP8) L15</text>
<text text-anchor="middle" x="101897.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="101897.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_33_stage2 -->
<g id="node1064" class="node">
<title>expert_15_33_stage2</title>
<polygon fill="lightgreen" stroke="black" points="101808.47,-965 101665.47,-965 101665.47,-924 101808.47,-924 101808.47,-965"/>
<text text-anchor="middle" x="101736.97" y="-953" font-family="Arial" font-size="10.00">Expert 33 (TP8) L15</text>
<text text-anchor="middle" x="101736.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="101736.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_34_stage2 -->
<g id="node1065" class="node">
<title>expert_15_34_stage2</title>
<polygon fill="lightgreen" stroke="black" points="101647.47,-965 101504.47,-965 101504.47,-924 101647.47,-924 101647.47,-965"/>
<text text-anchor="middle" x="101575.97" y="-953" font-family="Arial" font-size="10.00">Expert 34 (TP8) L15</text>
<text text-anchor="middle" x="101575.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="101575.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_35_stage2 -->
<g id="node1066" class="node">
<title>expert_15_35_stage2</title>
<polygon fill="lightgreen" stroke="black" points="101486.47,-965 101343.47,-965 101343.47,-924 101486.47,-924 101486.47,-965"/>
<text text-anchor="middle" x="101414.97" y="-953" font-family="Arial" font-size="10.00">Expert 35 (TP8) L15</text>
<text text-anchor="middle" x="101414.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="101414.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_36_stage2 -->
<g id="node1067" class="node">
<title>expert_15_36_stage2</title>
<polygon fill="lightgreen" stroke="black" points="101325.47,-965 101182.47,-965 101182.47,-924 101325.47,-924 101325.47,-965"/>
<text text-anchor="middle" x="101253.97" y="-953" font-family="Arial" font-size="10.00">Expert 36 (TP8) L15</text>
<text text-anchor="middle" x="101253.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="101253.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_37_stage2 -->
<g id="node1068" class="node">
<title>expert_15_37_stage2</title>
<polygon fill="lightgreen" stroke="black" points="101164.47,-965 101021.47,-965 101021.47,-924 101164.47,-924 101164.47,-965"/>
<text text-anchor="middle" x="101092.97" y="-953" font-family="Arial" font-size="10.00">Expert 37 (TP8) L15</text>
<text text-anchor="middle" x="101092.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="101092.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_38_stage2 -->
<g id="node1069" class="node">
<title>expert_15_38_stage2</title>
<polygon fill="lightgreen" stroke="black" points="101003.47,-965 100860.47,-965 100860.47,-924 101003.47,-924 101003.47,-965"/>
<text text-anchor="middle" x="100931.97" y="-953" font-family="Arial" font-size="10.00">Expert 38 (TP8) L15</text>
<text text-anchor="middle" x="100931.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="100931.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_39_stage2 -->
<g id="node1070" class="node">
<title>expert_15_39_stage2</title>
<polygon fill="lightgreen" stroke="black" points="100842.47,-965 100699.47,-965 100699.47,-924 100842.47,-924 100842.47,-965"/>
<text text-anchor="middle" x="100770.97" y="-953" font-family="Arial" font-size="10.00">Expert 39 (TP8) L15</text>
<text text-anchor="middle" x="100770.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="100770.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_40_stage2 -->
<g id="node1071" class="node">
<title>expert_15_40_stage2</title>
<polygon fill="lightgreen" stroke="black" points="100681.47,-965 100538.47,-965 100538.47,-924 100681.47,-924 100681.47,-965"/>
<text text-anchor="middle" x="100609.97" y="-953" font-family="Arial" font-size="10.00">Expert 40 (TP8) L15</text>
<text text-anchor="middle" x="100609.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="100609.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_41_stage2 -->
<g id="node1072" class="node">
<title>expert_15_41_stage2</title>
<polygon fill="lightgreen" stroke="black" points="100520.47,-965 100377.47,-965 100377.47,-924 100520.47,-924 100520.47,-965"/>
<text text-anchor="middle" x="100448.97" y="-953" font-family="Arial" font-size="10.00">Expert 41 (TP8) L15</text>
<text text-anchor="middle" x="100448.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="100448.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_42_stage2 -->
<g id="node1073" class="node">
<title>expert_15_42_stage2</title>
<polygon fill="lightgreen" stroke="black" points="100359.47,-965 100216.47,-965 100216.47,-924 100359.47,-924 100359.47,-965"/>
<text text-anchor="middle" x="100287.97" y="-953" font-family="Arial" font-size="10.00">Expert 42 (TP8) L15</text>
<text text-anchor="middle" x="100287.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="100287.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_43_stage2 -->
<g id="node1074" class="node">
<title>expert_15_43_stage2</title>
<polygon fill="lightgreen" stroke="black" points="100198.47,-965 100055.47,-965 100055.47,-924 100198.47,-924 100198.47,-965"/>
<text text-anchor="middle" x="100126.97" y="-953" font-family="Arial" font-size="10.00">Expert 43 (TP8) L15</text>
<text text-anchor="middle" x="100126.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="100126.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_44_stage2 -->
<g id="node1075" class="node">
<title>expert_15_44_stage2</title>
<polygon fill="lightgreen" stroke="black" points="100037.47,-965 99894.47,-965 99894.47,-924 100037.47,-924 100037.47,-965"/>
<text text-anchor="middle" x="99965.97" y="-953" font-family="Arial" font-size="10.00">Expert 44 (TP8) L15</text>
<text text-anchor="middle" x="99965.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="99965.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_45_stage2 -->
<g id="node1076" class="node">
<title>expert_15_45_stage2</title>
<polygon fill="lightgreen" stroke="black" points="99876.47,-965 99733.47,-965 99733.47,-924 99876.47,-924 99876.47,-965"/>
<text text-anchor="middle" x="99804.97" y="-953" font-family="Arial" font-size="10.00">Expert 45 (TP8) L15</text>
<text text-anchor="middle" x="99804.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="99804.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_46_stage2 -->
<g id="node1077" class="node">
<title>expert_15_46_stage2</title>
<polygon fill="lightgreen" stroke="black" points="99715.47,-965 99572.47,-965 99572.47,-924 99715.47,-924 99715.47,-965"/>
<text text-anchor="middle" x="99643.97" y="-953" font-family="Arial" font-size="10.00">Expert 46 (TP8) L15</text>
<text text-anchor="middle" x="99643.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="99643.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_47_stage2 -->
<g id="node1078" class="node">
<title>expert_15_47_stage2</title>
<polygon fill="lightgreen" stroke="black" points="99554.47,-965 99411.47,-965 99411.47,-924 99554.47,-924 99554.47,-965"/>
<text text-anchor="middle" x="99482.97" y="-953" font-family="Arial" font-size="10.00">Expert 47 (TP8) L15</text>
<text text-anchor="middle" x="99482.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="99482.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_48_stage2 -->
<g id="node1079" class="node">
<title>expert_15_48_stage2</title>
<polygon fill="lightgreen" stroke="black" points="99393.47,-965 99250.47,-965 99250.47,-924 99393.47,-924 99393.47,-965"/>
<text text-anchor="middle" x="99321.97" y="-953" font-family="Arial" font-size="10.00">Expert 48 (TP8) L15</text>
<text text-anchor="middle" x="99321.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="99321.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_49_stage2 -->
<g id="node1080" class="node">
<title>expert_15_49_stage2</title>
<polygon fill="lightgreen" stroke="black" points="99232.47,-965 99089.47,-965 99089.47,-924 99232.47,-924 99232.47,-965"/>
<text text-anchor="middle" x="99160.97" y="-953" font-family="Arial" font-size="10.00">Expert 49 (TP8) L15</text>
<text text-anchor="middle" x="99160.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="99160.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_50_stage2 -->
<g id="node1081" class="node">
<title>expert_15_50_stage2</title>
<polygon fill="lightgreen" stroke="black" points="99071.47,-965 98928.47,-965 98928.47,-924 99071.47,-924 99071.47,-965"/>
<text text-anchor="middle" x="98999.97" y="-953" font-family="Arial" font-size="10.00">Expert 50 (TP8) L15</text>
<text text-anchor="middle" x="98999.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="98999.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_51_stage2 -->
<g id="node1082" class="node">
<title>expert_15_51_stage2</title>
<polygon fill="lightgreen" stroke="black" points="98910.47,-965 98767.47,-965 98767.47,-924 98910.47,-924 98910.47,-965"/>
<text text-anchor="middle" x="98838.97" y="-953" font-family="Arial" font-size="10.00">Expert 51 (TP8) L15</text>
<text text-anchor="middle" x="98838.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="98838.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_52_stage2 -->
<g id="node1083" class="node">
<title>expert_15_52_stage2</title>
<polygon fill="lightgreen" stroke="black" points="98749.47,-965 98606.47,-965 98606.47,-924 98749.47,-924 98749.47,-965"/>
<text text-anchor="middle" x="98677.97" y="-953" font-family="Arial" font-size="10.00">Expert 52 (TP8) L15</text>
<text text-anchor="middle" x="98677.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="98677.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_53_stage2 -->
<g id="node1084" class="node">
<title>expert_15_53_stage2</title>
<polygon fill="lightgreen" stroke="black" points="98588.47,-965 98445.47,-965 98445.47,-924 98588.47,-924 98588.47,-965"/>
<text text-anchor="middle" x="98516.97" y="-953" font-family="Arial" font-size="10.00">Expert 53 (TP8) L15</text>
<text text-anchor="middle" x="98516.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="98516.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_54_stage2 -->
<g id="node1085" class="node">
<title>expert_15_54_stage2</title>
<polygon fill="lightgreen" stroke="black" points="98427.47,-965 98284.47,-965 98284.47,-924 98427.47,-924 98427.47,-965"/>
<text text-anchor="middle" x="98355.97" y="-953" font-family="Arial" font-size="10.00">Expert 54 (TP8) L15</text>
<text text-anchor="middle" x="98355.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="98355.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_55_stage2 -->
<g id="node1086" class="node">
<title>expert_15_55_stage2</title>
<polygon fill="lightgreen" stroke="black" points="98266.47,-965 98123.47,-965 98123.47,-924 98266.47,-924 98266.47,-965"/>
<text text-anchor="middle" x="98194.97" y="-953" font-family="Arial" font-size="10.00">Expert 55 (TP8) L15</text>
<text text-anchor="middle" x="98194.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="98194.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_56_stage2 -->
<g id="node1087" class="node">
<title>expert_15_56_stage2</title>
<polygon fill="lightgreen" stroke="black" points="98105.47,-965 97962.47,-965 97962.47,-924 98105.47,-924 98105.47,-965"/>
<text text-anchor="middle" x="98033.97" y="-953" font-family="Arial" font-size="10.00">Expert 56 (TP8) L15</text>
<text text-anchor="middle" x="98033.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="98033.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_57_stage2 -->
<g id="node1088" class="node">
<title>expert_15_57_stage2</title>
<polygon fill="lightgreen" stroke="black" points="97944.47,-965 97801.47,-965 97801.47,-924 97944.47,-924 97944.47,-965"/>
<text text-anchor="middle" x="97872.97" y="-953" font-family="Arial" font-size="10.00">Expert 57 (TP8) L15</text>
<text text-anchor="middle" x="97872.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="97872.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_58_stage2 -->
<g id="node1089" class="node">
<title>expert_15_58_stage2</title>
<polygon fill="lightgreen" stroke="black" points="97783.47,-965 97640.47,-965 97640.47,-924 97783.47,-924 97783.47,-965"/>
<text text-anchor="middle" x="97711.97" y="-953" font-family="Arial" font-size="10.00">Expert 58 (TP8) L15</text>
<text text-anchor="middle" x="97711.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="97711.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_59_stage2 -->
<g id="node1090" class="node">
<title>expert_15_59_stage2</title>
<polygon fill="lightgreen" stroke="black" points="97622.47,-965 97479.47,-965 97479.47,-924 97622.47,-924 97622.47,-965"/>
<text text-anchor="middle" x="97550.97" y="-953" font-family="Arial" font-size="10.00">Expert 59 (TP8) L15</text>
<text text-anchor="middle" x="97550.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="97550.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_60_stage2 -->
<g id="node1091" class="node">
<title>expert_15_60_stage2</title>
<polygon fill="lightgreen" stroke="black" points="97461.47,-965 97318.47,-965 97318.47,-924 97461.47,-924 97461.47,-965"/>
<text text-anchor="middle" x="97389.97" y="-953" font-family="Arial" font-size="10.00">Expert 60 (TP8) L15</text>
<text text-anchor="middle" x="97389.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="97389.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_61_stage2 -->
<g id="node1092" class="node">
<title>expert_15_61_stage2</title>
<polygon fill="lightgreen" stroke="black" points="97300.47,-965 97157.47,-965 97157.47,-924 97300.47,-924 97300.47,-965"/>
<text text-anchor="middle" x="97228.97" y="-953" font-family="Arial" font-size="10.00">Expert 61 (TP8) L15</text>
<text text-anchor="middle" x="97228.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="97228.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_62_stage2 -->
<g id="node1093" class="node">
<title>expert_15_62_stage2</title>
<polygon fill="lightgreen" stroke="black" points="97139.47,-965 96996.47,-965 96996.47,-924 97139.47,-924 97139.47,-965"/>
<text text-anchor="middle" x="97067.97" y="-953" font-family="Arial" font-size="10.00">Expert 62 (TP8) L15</text>
<text text-anchor="middle" x="97067.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="97067.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_15_63_stage2 -->
<g id="node1094" class="node">
<title>expert_15_63_stage2</title>
<polygon fill="lightgreen" stroke="black" points="96978.47,-965 96835.47,-965 96835.47,-924 96978.47,-924 96978.47,-965"/>
<text text-anchor="middle" x="96906.97" y="-953" font-family="Arial" font-size="10.00">Expert 63 (TP8) L15</text>
<text text-anchor="middle" x="96906.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="96906.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_15_stage2 -->
<g id="node1095" class="node">
<title>combine_15_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="96709.97" cy="-944.5" rx="107.46" ry="28.98"/>
<text text-anchor="middle" x="96709.97" y="-953" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L15</text>
<text text-anchor="middle" x="96709.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="96709.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_15_stage2 -->
<g id="node1096" class="node">
<title>moe_out_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="96584.97,-965 96444.97,-965 96444.97,-924 96584.97,-924 96584.97,-965"/>
<text text-anchor="middle" x="96514.97" y="-953" font-family="Arial" font-size="10.00">MoE Output (TP8) L15</text>
<text text-anchor="middle" x="96514.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="96514.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_15_stage2 -->
<g id="node1097" class="node">
<title>ln2_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="96426.97,-965 96286.97,-965 96286.97,-924 96426.97,-924 96426.97,-965"/>
<text text-anchor="middle" x="96356.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L15</text>
<text text-anchor="middle" x="96356.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="96356.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln1_16_stage2 -->
<g id="node1098" class="node">
<title>ln1_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="96268.97,-965 96128.97,-965 96128.97,-924 96268.97,-924 96268.97,-965"/>
<text text-anchor="middle" x="96198.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L16</text>
<text text-anchor="middle" x="96198.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="96198.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- qkv_16_stage2 -->
<g id="node1099" class="node">
<title>qkv_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="96110.97,-965 95964.97,-965 95964.97,-924 96110.97,-924 96110.97,-965"/>
<text text-anchor="middle" x="96037.97" y="-953" font-family="Arial" font-size="10.00">QKV Projection (TP8) L16</text>
<text text-anchor="middle" x="96037.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="96037.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_16_stage2 -->
<g id="node1100" class="node">
<title>attn_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="95946.97,-965 95800.97,-965 95800.97,-924 95946.97,-924 95946.97,-965"/>
<text text-anchor="middle" x="95873.97" y="-953" font-family="Arial" font-size="10.00">Self&#45;Attention (TP8) L16</text>
<text text-anchor="middle" x="95873.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="95873.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 16, 64]</text>
</g>
<!-- attn_out_16_stage2 -->
<g id="node1101" class="node">
<title>attn_out_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="95782.97,-965 95642.97,-965 95642.97,-924 95782.97,-924 95782.97,-965"/>
<text text-anchor="middle" x="95712.97" y="-953" font-family="Arial" font-size="10.00">Attention Output (TP8) L16</text>
<text text-anchor="middle" x="95712.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 16, 64]</text>
<text text-anchor="middle" x="95712.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- route_16_stage2 -->
<g id="node1102" class="node">
<title>route_16_stage2</title>
<polygon fill="lightcoral" stroke="black" points="95625.27,-985.5 95394.14,-985.5 95334.68,-903.5 95565.81,-903.5 95625.27,-985.5"/>
<text text-anchor="middle" x="95479.97" y="-953" font-family="Arial" font-size="10.00">MoE Routing (EP64) L16</text>
<text text-anchor="middle" x="95479.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="95479.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- dispatch_16_stage2 -->
<g id="node1103" class="node">
<title>dispatch_16_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="95207.97" cy="-944.5" rx="108.79" ry="28.98"/>
<text text-anchor="middle" x="95207.97" y="-953" font-family="Arial" font-size="10.00">Expert Dispatch (All&#45;to&#45;All) L16</text>
<text text-anchor="middle" x="95207.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="95207.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len/64, 2048]</text>
</g>
<!-- expert_16_0_stage2 -->
<g id="node1104" class="node">
<title>expert_16_0_stage2</title>
<polygon fill="lightgreen" stroke="black" points="95081.47,-965 94938.47,-965 94938.47,-924 95081.47,-924 95081.47,-965"/>
<text text-anchor="middle" x="95009.97" y="-953" font-family="Arial" font-size="10.00">Expert 0 (TP8) L16</text>
<text text-anchor="middle" x="95009.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="95009.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_1_stage2 -->
<g id="node1105" class="node">
<title>expert_16_1_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94920.47,-965 94777.47,-965 94777.47,-924 94920.47,-924 94920.47,-965"/>
<text text-anchor="middle" x="94848.97" y="-953" font-family="Arial" font-size="10.00">Expert 1 (TP8) L16</text>
<text text-anchor="middle" x="94848.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94848.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_2_stage2 -->
<g id="node1106" class="node">
<title>expert_16_2_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94759.47,-965 94616.47,-965 94616.47,-924 94759.47,-924 94759.47,-965"/>
<text text-anchor="middle" x="94687.97" y="-953" font-family="Arial" font-size="10.00">Expert 2 (TP8) L16</text>
<text text-anchor="middle" x="94687.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94687.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_3_stage2 -->
<g id="node1107" class="node">
<title>expert_16_3_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94598.47,-965 94455.47,-965 94455.47,-924 94598.47,-924 94598.47,-965"/>
<text text-anchor="middle" x="94526.97" y="-953" font-family="Arial" font-size="10.00">Expert 3 (TP8) L16</text>
<text text-anchor="middle" x="94526.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94526.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_4_stage2 -->
<g id="node1108" class="node">
<title>expert_16_4_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94437.47,-965 94294.47,-965 94294.47,-924 94437.47,-924 94437.47,-965"/>
<text text-anchor="middle" x="94365.97" y="-953" font-family="Arial" font-size="10.00">Expert 4 (TP8) L16</text>
<text text-anchor="middle" x="94365.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94365.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_5_stage2 -->
<g id="node1109" class="node">
<title>expert_16_5_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94276.47,-965 94133.47,-965 94133.47,-924 94276.47,-924 94276.47,-965"/>
<text text-anchor="middle" x="94204.97" y="-953" font-family="Arial" font-size="10.00">Expert 5 (TP8) L16</text>
<text text-anchor="middle" x="94204.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94204.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_6_stage2 -->
<g id="node1110" class="node">
<title>expert_16_6_stage2</title>
<polygon fill="lightgreen" stroke="black" points="94115.47,-965 93972.47,-965 93972.47,-924 94115.47,-924 94115.47,-965"/>
<text text-anchor="middle" x="94043.97" y="-953" font-family="Arial" font-size="10.00">Expert 6 (TP8) L16</text>
<text text-anchor="middle" x="94043.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="94043.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_7_stage2 -->
<g id="node1111" class="node">
<title>expert_16_7_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93954.47,-965 93811.47,-965 93811.47,-924 93954.47,-924 93954.47,-965"/>
<text text-anchor="middle" x="93882.97" y="-953" font-family="Arial" font-size="10.00">Expert 7 (TP8) L16</text>
<text text-anchor="middle" x="93882.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93882.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_8_stage2 -->
<g id="node1112" class="node">
<title>expert_16_8_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93793.47,-965 93650.47,-965 93650.47,-924 93793.47,-924 93793.47,-965"/>
<text text-anchor="middle" x="93721.97" y="-953" font-family="Arial" font-size="10.00">Expert 8 (TP8) L16</text>
<text text-anchor="middle" x="93721.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93721.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_9_stage2 -->
<g id="node1113" class="node">
<title>expert_16_9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93632.47,-965 93489.47,-965 93489.47,-924 93632.47,-924 93632.47,-965"/>
<text text-anchor="middle" x="93560.97" y="-953" font-family="Arial" font-size="10.00">Expert 9 (TP8) L16</text>
<text text-anchor="middle" x="93560.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93560.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_10_stage2 -->
<g id="node1114" class="node">
<title>expert_16_10_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93471.47,-965 93328.47,-965 93328.47,-924 93471.47,-924 93471.47,-965"/>
<text text-anchor="middle" x="93399.97" y="-953" font-family="Arial" font-size="10.00">Expert 10 (TP8) L16</text>
<text text-anchor="middle" x="93399.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93399.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_11_stage2 -->
<g id="node1115" class="node">
<title>expert_16_11_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93310.47,-965 93167.47,-965 93167.47,-924 93310.47,-924 93310.47,-965"/>
<text text-anchor="middle" x="93238.97" y="-953" font-family="Arial" font-size="10.00">Expert 11 (TP8) L16</text>
<text text-anchor="middle" x="93238.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93238.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_12_stage2 -->
<g id="node1116" class="node">
<title>expert_16_12_stage2</title>
<polygon fill="lightgreen" stroke="black" points="93149.47,-965 93006.47,-965 93006.47,-924 93149.47,-924 93149.47,-965"/>
<text text-anchor="middle" x="93077.97" y="-953" font-family="Arial" font-size="10.00">Expert 12 (TP8) L16</text>
<text text-anchor="middle" x="93077.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="93077.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_13_stage2 -->
<g id="node1117" class="node">
<title>expert_16_13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92988.47,-965 92845.47,-965 92845.47,-924 92988.47,-924 92988.47,-965"/>
<text text-anchor="middle" x="92916.97" y="-953" font-family="Arial" font-size="10.00">Expert 13 (TP8) L16</text>
<text text-anchor="middle" x="92916.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92916.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_14_stage2 -->
<g id="node1118" class="node">
<title>expert_16_14_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92827.47,-965 92684.47,-965 92684.47,-924 92827.47,-924 92827.47,-965"/>
<text text-anchor="middle" x="92755.97" y="-953" font-family="Arial" font-size="10.00">Expert 14 (TP8) L16</text>
<text text-anchor="middle" x="92755.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92755.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_15_stage2 -->
<g id="node1119" class="node">
<title>expert_16_15_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92666.47,-965 92523.47,-965 92523.47,-924 92666.47,-924 92666.47,-965"/>
<text text-anchor="middle" x="92594.97" y="-953" font-family="Arial" font-size="10.00">Expert 15 (TP8) L16</text>
<text text-anchor="middle" x="92594.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92594.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_16_stage2 -->
<g id="node1120" class="node">
<title>expert_16_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92505.47,-965 92362.47,-965 92362.47,-924 92505.47,-924 92505.47,-965"/>
<text text-anchor="middle" x="92433.97" y="-953" font-family="Arial" font-size="10.00">Expert 16 (TP8) L16</text>
<text text-anchor="middle" x="92433.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92433.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_17_stage2 -->
<g id="node1121" class="node">
<title>expert_16_17_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92344.47,-965 92201.47,-965 92201.47,-924 92344.47,-924 92344.47,-965"/>
<text text-anchor="middle" x="92272.97" y="-953" font-family="Arial" font-size="10.00">Expert 17 (TP8) L16</text>
<text text-anchor="middle" x="92272.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92272.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_18_stage2 -->
<g id="node1122" class="node">
<title>expert_16_18_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92183.47,-965 92040.47,-965 92040.47,-924 92183.47,-924 92183.47,-965"/>
<text text-anchor="middle" x="92111.97" y="-953" font-family="Arial" font-size="10.00">Expert 18 (TP8) L16</text>
<text text-anchor="middle" x="92111.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="92111.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_19_stage2 -->
<g id="node1123" class="node">
<title>expert_16_19_stage2</title>
<polygon fill="lightgreen" stroke="black" points="92022.47,-965 91879.47,-965 91879.47,-924 92022.47,-924 92022.47,-965"/>
<text text-anchor="middle" x="91950.97" y="-953" font-family="Arial" font-size="10.00">Expert 19 (TP8) L16</text>
<text text-anchor="middle" x="91950.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91950.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_20_stage2 -->
<g id="node1124" class="node">
<title>expert_16_20_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91861.47,-965 91718.47,-965 91718.47,-924 91861.47,-924 91861.47,-965"/>
<text text-anchor="middle" x="91789.97" y="-953" font-family="Arial" font-size="10.00">Expert 20 (TP8) L16</text>
<text text-anchor="middle" x="91789.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91789.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_21_stage2 -->
<g id="node1125" class="node">
<title>expert_16_21_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91700.47,-965 91557.47,-965 91557.47,-924 91700.47,-924 91700.47,-965"/>
<text text-anchor="middle" x="91628.97" y="-953" font-family="Arial" font-size="10.00">Expert 21 (TP8) L16</text>
<text text-anchor="middle" x="91628.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91628.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_22_stage2 -->
<g id="node1126" class="node">
<title>expert_16_22_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91539.47,-965 91396.47,-965 91396.47,-924 91539.47,-924 91539.47,-965"/>
<text text-anchor="middle" x="91467.97" y="-953" font-family="Arial" font-size="10.00">Expert 22 (TP8) L16</text>
<text text-anchor="middle" x="91467.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91467.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_23_stage2 -->
<g id="node1127" class="node">
<title>expert_16_23_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91378.47,-965 91235.47,-965 91235.47,-924 91378.47,-924 91378.47,-965"/>
<text text-anchor="middle" x="91306.97" y="-953" font-family="Arial" font-size="10.00">Expert 23 (TP8) L16</text>
<text text-anchor="middle" x="91306.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91306.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_24_stage2 -->
<g id="node1128" class="node">
<title>expert_16_24_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91217.47,-965 91074.47,-965 91074.47,-924 91217.47,-924 91217.47,-965"/>
<text text-anchor="middle" x="91145.97" y="-953" font-family="Arial" font-size="10.00">Expert 24 (TP8) L16</text>
<text text-anchor="middle" x="91145.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="91145.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_25_stage2 -->
<g id="node1129" class="node">
<title>expert_16_25_stage2</title>
<polygon fill="lightgreen" stroke="black" points="91056.47,-965 90913.47,-965 90913.47,-924 91056.47,-924 91056.47,-965"/>
<text text-anchor="middle" x="90984.97" y="-953" font-family="Arial" font-size="10.00">Expert 25 (TP8) L16</text>
<text text-anchor="middle" x="90984.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90984.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_26_stage2 -->
<g id="node1130" class="node">
<title>expert_16_26_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90895.47,-965 90752.47,-965 90752.47,-924 90895.47,-924 90895.47,-965"/>
<text text-anchor="middle" x="90823.97" y="-953" font-family="Arial" font-size="10.00">Expert 26 (TP8) L16</text>
<text text-anchor="middle" x="90823.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90823.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_27_stage2 -->
<g id="node1131" class="node">
<title>expert_16_27_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90734.47,-965 90591.47,-965 90591.47,-924 90734.47,-924 90734.47,-965"/>
<text text-anchor="middle" x="90662.97" y="-953" font-family="Arial" font-size="10.00">Expert 27 (TP8) L16</text>
<text text-anchor="middle" x="90662.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90662.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_28_stage2 -->
<g id="node1132" class="node">
<title>expert_16_28_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90573.47,-965 90430.47,-965 90430.47,-924 90573.47,-924 90573.47,-965"/>
<text text-anchor="middle" x="90501.97" y="-953" font-family="Arial" font-size="10.00">Expert 28 (TP8) L16</text>
<text text-anchor="middle" x="90501.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90501.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_29_stage2 -->
<g id="node1133" class="node">
<title>expert_16_29_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90412.47,-965 90269.47,-965 90269.47,-924 90412.47,-924 90412.47,-965"/>
<text text-anchor="middle" x="90340.97" y="-953" font-family="Arial" font-size="10.00">Expert 29 (TP8) L16</text>
<text text-anchor="middle" x="90340.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90340.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_30_stage2 -->
<g id="node1134" class="node">
<title>expert_16_30_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90251.47,-965 90108.47,-965 90108.47,-924 90251.47,-924 90251.47,-965"/>
<text text-anchor="middle" x="90179.97" y="-953" font-family="Arial" font-size="10.00">Expert 30 (TP8) L16</text>
<text text-anchor="middle" x="90179.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90179.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_31_stage2 -->
<g id="node1135" class="node">
<title>expert_16_31_stage2</title>
<polygon fill="lightgreen" stroke="black" points="90090.47,-965 89947.47,-965 89947.47,-924 90090.47,-924 90090.47,-965"/>
<text text-anchor="middle" x="90018.97" y="-953" font-family="Arial" font-size="10.00">Expert 31 (TP8) L16</text>
<text text-anchor="middle" x="90018.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="90018.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_32_stage2 -->
<g id="node1136" class="node">
<title>expert_16_32_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89929.47,-965 89786.47,-965 89786.47,-924 89929.47,-924 89929.47,-965"/>
<text text-anchor="middle" x="89857.97" y="-953" font-family="Arial" font-size="10.00">Expert 32 (TP8) L16</text>
<text text-anchor="middle" x="89857.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89857.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_33_stage2 -->
<g id="node1137" class="node">
<title>expert_16_33_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89768.47,-965 89625.47,-965 89625.47,-924 89768.47,-924 89768.47,-965"/>
<text text-anchor="middle" x="89696.97" y="-953" font-family="Arial" font-size="10.00">Expert 33 (TP8) L16</text>
<text text-anchor="middle" x="89696.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89696.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_34_stage2 -->
<g id="node1138" class="node">
<title>expert_16_34_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89607.47,-965 89464.47,-965 89464.47,-924 89607.47,-924 89607.47,-965"/>
<text text-anchor="middle" x="89535.97" y="-953" font-family="Arial" font-size="10.00">Expert 34 (TP8) L16</text>
<text text-anchor="middle" x="89535.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89535.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_35_stage2 -->
<g id="node1139" class="node">
<title>expert_16_35_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89446.47,-965 89303.47,-965 89303.47,-924 89446.47,-924 89446.47,-965"/>
<text text-anchor="middle" x="89374.97" y="-953" font-family="Arial" font-size="10.00">Expert 35 (TP8) L16</text>
<text text-anchor="middle" x="89374.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89374.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_36_stage2 -->
<g id="node1140" class="node">
<title>expert_16_36_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89285.47,-965 89142.47,-965 89142.47,-924 89285.47,-924 89285.47,-965"/>
<text text-anchor="middle" x="89213.97" y="-953" font-family="Arial" font-size="10.00">Expert 36 (TP8) L16</text>
<text text-anchor="middle" x="89213.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89213.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_37_stage2 -->
<g id="node1141" class="node">
<title>expert_16_37_stage2</title>
<polygon fill="lightgreen" stroke="black" points="89124.47,-965 88981.47,-965 88981.47,-924 89124.47,-924 89124.47,-965"/>
<text text-anchor="middle" x="89052.97" y="-953" font-family="Arial" font-size="10.00">Expert 37 (TP8) L16</text>
<text text-anchor="middle" x="89052.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="89052.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_38_stage2 -->
<g id="node1142" class="node">
<title>expert_16_38_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88963.47,-965 88820.47,-965 88820.47,-924 88963.47,-924 88963.47,-965"/>
<text text-anchor="middle" x="88891.97" y="-953" font-family="Arial" font-size="10.00">Expert 38 (TP8) L16</text>
<text text-anchor="middle" x="88891.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88891.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_39_stage2 -->
<g id="node1143" class="node">
<title>expert_16_39_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88802.47,-965 88659.47,-965 88659.47,-924 88802.47,-924 88802.47,-965"/>
<text text-anchor="middle" x="88730.97" y="-953" font-family="Arial" font-size="10.00">Expert 39 (TP8) L16</text>
<text text-anchor="middle" x="88730.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88730.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_40_stage2 -->
<g id="node1144" class="node">
<title>expert_16_40_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88641.47,-965 88498.47,-965 88498.47,-924 88641.47,-924 88641.47,-965"/>
<text text-anchor="middle" x="88569.97" y="-953" font-family="Arial" font-size="10.00">Expert 40 (TP8) L16</text>
<text text-anchor="middle" x="88569.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88569.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_41_stage2 -->
<g id="node1145" class="node">
<title>expert_16_41_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88480.47,-965 88337.47,-965 88337.47,-924 88480.47,-924 88480.47,-965"/>
<text text-anchor="middle" x="88408.97" y="-953" font-family="Arial" font-size="10.00">Expert 41 (TP8) L16</text>
<text text-anchor="middle" x="88408.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88408.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_42_stage2 -->
<g id="node1146" class="node">
<title>expert_16_42_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88319.47,-965 88176.47,-965 88176.47,-924 88319.47,-924 88319.47,-965"/>
<text text-anchor="middle" x="88247.97" y="-953" font-family="Arial" font-size="10.00">Expert 42 (TP8) L16</text>
<text text-anchor="middle" x="88247.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88247.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_43_stage2 -->
<g id="node1147" class="node">
<title>expert_16_43_stage2</title>
<polygon fill="lightgreen" stroke="black" points="88158.47,-965 88015.47,-965 88015.47,-924 88158.47,-924 88158.47,-965"/>
<text text-anchor="middle" x="88086.97" y="-953" font-family="Arial" font-size="10.00">Expert 43 (TP8) L16</text>
<text text-anchor="middle" x="88086.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="88086.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_44_stage2 -->
<g id="node1148" class="node">
<title>expert_16_44_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87997.47,-965 87854.47,-965 87854.47,-924 87997.47,-924 87997.47,-965"/>
<text text-anchor="middle" x="87925.97" y="-953" font-family="Arial" font-size="10.00">Expert 44 (TP8) L16</text>
<text text-anchor="middle" x="87925.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87925.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_45_stage2 -->
<g id="node1149" class="node">
<title>expert_16_45_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87836.47,-965 87693.47,-965 87693.47,-924 87836.47,-924 87836.47,-965"/>
<text text-anchor="middle" x="87764.97" y="-953" font-family="Arial" font-size="10.00">Expert 45 (TP8) L16</text>
<text text-anchor="middle" x="87764.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87764.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_46_stage2 -->
<g id="node1150" class="node">
<title>expert_16_46_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87675.47,-965 87532.47,-965 87532.47,-924 87675.47,-924 87675.47,-965"/>
<text text-anchor="middle" x="87603.97" y="-953" font-family="Arial" font-size="10.00">Expert 46 (TP8) L16</text>
<text text-anchor="middle" x="87603.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87603.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_47_stage2 -->
<g id="node1151" class="node">
<title>expert_16_47_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87514.47,-965 87371.47,-965 87371.47,-924 87514.47,-924 87514.47,-965"/>
<text text-anchor="middle" x="87442.97" y="-953" font-family="Arial" font-size="10.00">Expert 47 (TP8) L16</text>
<text text-anchor="middle" x="87442.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87442.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_48_stage2 -->
<g id="node1152" class="node">
<title>expert_16_48_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87353.47,-965 87210.47,-965 87210.47,-924 87353.47,-924 87353.47,-965"/>
<text text-anchor="middle" x="87281.97" y="-953" font-family="Arial" font-size="10.00">Expert 48 (TP8) L16</text>
<text text-anchor="middle" x="87281.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87281.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_49_stage2 -->
<g id="node1153" class="node">
<title>expert_16_49_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87192.47,-965 87049.47,-965 87049.47,-924 87192.47,-924 87192.47,-965"/>
<text text-anchor="middle" x="87120.97" y="-953" font-family="Arial" font-size="10.00">Expert 49 (TP8) L16</text>
<text text-anchor="middle" x="87120.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="87120.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_50_stage2 -->
<g id="node1154" class="node">
<title>expert_16_50_stage2</title>
<polygon fill="lightgreen" stroke="black" points="87031.47,-965 86888.47,-965 86888.47,-924 87031.47,-924 87031.47,-965"/>
<text text-anchor="middle" x="86959.97" y="-953" font-family="Arial" font-size="10.00">Expert 50 (TP8) L16</text>
<text text-anchor="middle" x="86959.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86959.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_51_stage2 -->
<g id="node1155" class="node">
<title>expert_16_51_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86870.47,-965 86727.47,-965 86727.47,-924 86870.47,-924 86870.47,-965"/>
<text text-anchor="middle" x="86798.97" y="-953" font-family="Arial" font-size="10.00">Expert 51 (TP8) L16</text>
<text text-anchor="middle" x="86798.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86798.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_52_stage2 -->
<g id="node1156" class="node">
<title>expert_16_52_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86709.47,-965 86566.47,-965 86566.47,-924 86709.47,-924 86709.47,-965"/>
<text text-anchor="middle" x="86637.97" y="-953" font-family="Arial" font-size="10.00">Expert 52 (TP8) L16</text>
<text text-anchor="middle" x="86637.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86637.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_53_stage2 -->
<g id="node1157" class="node">
<title>expert_16_53_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86548.47,-965 86405.47,-965 86405.47,-924 86548.47,-924 86548.47,-965"/>
<text text-anchor="middle" x="86476.97" y="-953" font-family="Arial" font-size="10.00">Expert 53 (TP8) L16</text>
<text text-anchor="middle" x="86476.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86476.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_54_stage2 -->
<g id="node1158" class="node">
<title>expert_16_54_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86387.47,-965 86244.47,-965 86244.47,-924 86387.47,-924 86387.47,-965"/>
<text text-anchor="middle" x="86315.97" y="-953" font-family="Arial" font-size="10.00">Expert 54 (TP8) L16</text>
<text text-anchor="middle" x="86315.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86315.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_55_stage2 -->
<g id="node1159" class="node">
<title>expert_16_55_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86226.47,-965 86083.47,-965 86083.47,-924 86226.47,-924 86226.47,-965"/>
<text text-anchor="middle" x="86154.97" y="-953" font-family="Arial" font-size="10.00">Expert 55 (TP8) L16</text>
<text text-anchor="middle" x="86154.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="86154.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_56_stage2 -->
<g id="node1160" class="node">
<title>expert_16_56_stage2</title>
<polygon fill="lightgreen" stroke="black" points="86065.47,-965 85922.47,-965 85922.47,-924 86065.47,-924 86065.47,-965"/>
<text text-anchor="middle" x="85993.97" y="-953" font-family="Arial" font-size="10.00">Expert 56 (TP8) L16</text>
<text text-anchor="middle" x="85993.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85993.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_57_stage2 -->
<g id="node1161" class="node">
<title>expert_16_57_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85904.47,-965 85761.47,-965 85761.47,-924 85904.47,-924 85904.47,-965"/>
<text text-anchor="middle" x="85832.97" y="-953" font-family="Arial" font-size="10.00">Expert 57 (TP8) L16</text>
<text text-anchor="middle" x="85832.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85832.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_58_stage2 -->
<g id="node1162" class="node">
<title>expert_16_58_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85743.47,-965 85600.47,-965 85600.47,-924 85743.47,-924 85743.47,-965"/>
<text text-anchor="middle" x="85671.97" y="-953" font-family="Arial" font-size="10.00">Expert 58 (TP8) L16</text>
<text text-anchor="middle" x="85671.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85671.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_59_stage2 -->
<g id="node1163" class="node">
<title>expert_16_59_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85582.47,-965 85439.47,-965 85439.47,-924 85582.47,-924 85582.47,-965"/>
<text text-anchor="middle" x="85510.97" y="-953" font-family="Arial" font-size="10.00">Expert 59 (TP8) L16</text>
<text text-anchor="middle" x="85510.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85510.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_60_stage2 -->
<g id="node1164" class="node">
<title>expert_16_60_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85421.47,-965 85278.47,-965 85278.47,-924 85421.47,-924 85421.47,-965"/>
<text text-anchor="middle" x="85349.97" y="-953" font-family="Arial" font-size="10.00">Expert 60 (TP8) L16</text>
<text text-anchor="middle" x="85349.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85349.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_61_stage2 -->
<g id="node1165" class="node">
<title>expert_16_61_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85260.47,-965 85117.47,-965 85117.47,-924 85260.47,-924 85260.47,-965"/>
<text text-anchor="middle" x="85188.97" y="-953" font-family="Arial" font-size="10.00">Expert 61 (TP8) L16</text>
<text text-anchor="middle" x="85188.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85188.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_62_stage2 -->
<g id="node1166" class="node">
<title>expert_16_62_stage2</title>
<polygon fill="lightgreen" stroke="black" points="85099.47,-965 84956.47,-965 84956.47,-924 85099.47,-924 85099.47,-965"/>
<text text-anchor="middle" x="85027.97" y="-953" font-family="Arial" font-size="10.00">Expert 62 (TP8) L16</text>
<text text-anchor="middle" x="85027.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="85027.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- expert_16_63_stage2 -->
<g id="node1167" class="node">
<title>expert_16_63_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84938.47,-965 84795.47,-965 84795.47,-924 84938.47,-924 84938.47,-965"/>
<text text-anchor="middle" x="84866.97" y="-953" font-family="Arial" font-size="10.00">Expert 63 (TP8) L16</text>
<text text-anchor="middle" x="84866.97" y="-942" font-family="Arial" font-size="10.00">Input: [2, seq_len/64, 2048]</text>
<text text-anchor="middle" x="84866.97" y="-931" font-family="Arial" font-size="10.00">Output: [2, seq_len/64, 2048]</text>
</g>
<!-- combine_16_stage2 -->
<g id="node1168" class="node">
<title>combine_16_stage2</title>
<ellipse fill="lightyellow" stroke="black" cx="84669.97" cy="-944.5" rx="107.46" ry="28.98"/>
<text text-anchor="middle" x="84669.97" y="-953" font-family="Arial" font-size="10.00">Expert Combine (All&#45;to&#45;All) L16</text>
<text text-anchor="middle" x="84669.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len/64, 2048]</text>
<text text-anchor="middle" x="84669.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 2048]</text>
</g>
<!-- moe_out_16_stage2 -->
<g id="node1169" class="node">
<title>moe_out_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="84544.97,-965 84404.97,-965 84404.97,-924 84544.97,-924 84544.97,-965"/>
<text text-anchor="middle" x="84474.97" y="-953" font-family="Arial" font-size="10.00">MoE Output (TP8) L16</text>
<text text-anchor="middle" x="84474.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 2048]</text>
<text text-anchor="middle" x="84474.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_16_stage2 -->
<g id="node1170" class="node">
<title>ln2_16_stage2</title>
<polygon fill="lightgreen" stroke="black" points="168508.97,-965 168368.97,-965 168368.97,-924 168508.97,-924 168508.97,-965"/>
<text text-anchor="middle" x="168438.97" y="-953" font-family="Arial" font-size="10.00">LayerNorm (TP8) L16</text>
<text text-anchor="middle" x="168438.97" y="-942" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="168438.97" y="-931" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- final_ln -->
<g id="node1171" class="node">
<title>final_ln</title>
<polygon fill="lightgreen" stroke="black" points="168672.97,-866.5 168532.97,-866.5 168532.97,-825.5 168672.97,-825.5 168672.97,-866.5"/>
<text text-anchor="middle" x="168602.97" y="-854.5" font-family="Arial" font-size="10.00">Final LayerNorm (TP8)</text>
<text text-anchor="middle" x="168602.97" y="-843.5" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="168602.97" y="-832.5" font-family="Arial" font-size="10.00">Output: [128, seq_len, 1024]</text>
</g>
<!-- ln2_16_stage2&#45;&gt;final_ln -->
<g id="edge276" class="edge">
<title>ln2_16_stage2&#45;&gt;final_ln</title>
<path fill="none" stroke="black" d="M168472.16,-923.98C168497.75,-908.92 168533.31,-887.99 168560.9,-871.76"/>
<polygon fill="black" stroke="black" points="168562.71,-874.76 168569.55,-866.67 168559.16,-868.72 168562.71,-874.76"/>
</g>
<!-- lm_head -->
<g id="node1172" class="node">
<title>lm_head</title>
<polygon fill="lightgreen" stroke="black" points="168695.47,-788.5 168526.47,-788.5 168526.47,-747.5 168695.47,-747.5 168695.47,-788.5"/>
<text text-anchor="middle" x="168610.97" y="-776.5" font-family="Arial" font-size="10.00">LM Head (TP8)</text>
<text text-anchor="middle" x="168610.97" y="-765.5" font-family="Arial" font-size="10.00">Input: [128, seq_len, 1024]</text>
<text text-anchor="middle" x="168610.97" y="-754.5" font-family="Arial" font-size="10.00">Output: [128, seq_len, vocab_size]</text>
</g>
<!-- final_ln&#45;&gt;lm_head -->
<g id="edge277" class="edge">
<title>final_ln&#45;&gt;lm_head</title>
<path fill="none" stroke="black" d="M168605.03,-825.43C168605.89,-817.28 168606.91,-807.63 168607.86,-798.63"/>
<polygon fill="black" stroke="black" points="168611.35,-798.82 168608.92,-788.51 168604.39,-798.09 168611.35,-798.82"/>
</g>
<!-- output -->
<g id="node1173" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" stroke-width="2" cx="168611.97" cy="-673.74" rx="86.95" ry="36.54"/>
<text text-anchor="middle" x="168611.97" y="-687.74" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="168611.97" y="-676.74" font-family="Arial" font-size="10.00">Batch Size: 128</text>
<text text-anchor="middle" x="168611.97" y="-665.74" font-family="Arial" font-size="10.00">Seq Length: [128&#45;10240]</text>
<text text-anchor="middle" x="168611.97" y="-654.74" font-family="Arial" font-size="10.00">Vocab Size: vocab_size</text>
</g>
<!-- lm_head&#45;&gt;output -->
<g id="edge278" class="edge">
<title>lm_head&#45;&gt;output</title>
<path fill="none" stroke="black" d="M168611.19,-747.44C168611.27,-739.59 168611.37,-730.19 168611.48,-720.79"/>
<polygon fill="black" stroke="black" points="168614.98,-720.7 168611.58,-710.66 168607.98,-720.63 168614.98,-720.7"/>
</g>
</g>
</svg>
