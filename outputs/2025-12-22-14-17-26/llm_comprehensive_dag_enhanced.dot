// LLM EP64-TP8-PP2-DP2 Deployment DAG - Enhanced
digraph {
	rankdir=TB size="200,400"
	node [fontname=Arial fontsize=8]
	node [fillcolor=lightblue shape=rectangle style=filled]
	input [label="Input\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: All" fillcolor=lightgreen shape=ellipse]
	layernorm1_s1_l0 [label="LayerNorm 1 (L0)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	qkv_proj_s1_l0 [label="QKV Projection L0 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_qkv_s1_l0 [label="All-Reduce QKV L0\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	attention_s1_l0 [label="Self-Attention L0\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	attn_out_proj_s1_l0 [label="Attention Output Proj L0 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_attn_out_s1_l0 [label="All-Reduce Attention Output L0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_gate_s1_l0 [label="MoE Gate L0 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=orange shape=parallelogram]
	expert_dispatch_s1_l0 [label="Expert Dispatch L0 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	expert_0_s1_l0 [label="Expert 0 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 0-31" fillcolor=lightblue]
	expert_1_s1_l0 [label="Expert 1 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 32-63" fillcolor=lightblue]
	expert_2_s1_l0 [label="Expert 2 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 64-95" fillcolor=lightblue]
	expert_3_s1_l0 [label="Expert 3 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 96-127" fillcolor=lightblue]
	expert_4_s1_l0 [label="Expert 4 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 128-159" fillcolor=lightblue]
	expert_5_s1_l0 [label="Expert 5 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 160-191" fillcolor=lightblue]
	expert_6_s1_l0 [label="Expert 6 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 192-223" fillcolor=lightblue]
	expert_7_s1_l0 [label="Expert 7 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 224-255" fillcolor=lightblue]
	expert_8_s1_l0 [label="Expert 8 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 256-287" fillcolor=lightblue]
	expert_9_s1_l0 [label="Expert 9 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 288-319" fillcolor=lightblue]
	expert_10_s1_l0 [label="Expert 10 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 320-351" fillcolor=lightblue]
	expert_11_s1_l0 [label="Expert 11 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 352-383" fillcolor=lightblue]
	expert_12_s1_l0 [label="Expert 12 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 384-415" fillcolor=lightblue]
	expert_13_s1_l0 [label="Expert 13 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 416-447" fillcolor=lightblue]
	expert_14_s1_l0 [label="Expert 14 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 448-479" fillcolor=lightblue]
	expert_15_s1_l0 [label="Expert 15 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 480-511" fillcolor=lightblue]
	expert_16_s1_l0 [label="Expert 16 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 512-543" fillcolor=lightblue]
	expert_17_s1_l0 [label="Expert 17 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 544-575" fillcolor=lightblue]
	expert_18_s1_l0 [label="Expert 18 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 576-607" fillcolor=lightblue]
	expert_19_s1_l0 [label="Expert 19 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 608-639" fillcolor=lightblue]
	expert_20_s1_l0 [label="Expert 20 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 640-671" fillcolor=lightblue]
	expert_21_s1_l0 [label="Expert 21 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 672-703" fillcolor=lightblue]
	expert_22_s1_l0 [label="Expert 22 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 704-735" fillcolor=lightblue]
	expert_23_s1_l0 [label="Expert 23 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 736-767" fillcolor=lightblue]
	expert_24_s1_l0 [label="Expert 24 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 768-799" fillcolor=lightblue]
	expert_25_s1_l0 [label="Expert 25 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 800-831" fillcolor=lightblue]
	expert_26_s1_l0 [label="Expert 26 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 832-863" fillcolor=lightblue]
	expert_27_s1_l0 [label="Expert 27 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 864-895" fillcolor=lightblue]
	expert_28_s1_l0 [label="Expert 28 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 896-927" fillcolor=lightblue]
	expert_29_s1_l0 [label="Expert 29 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 928-959" fillcolor=lightblue]
	expert_30_s1_l0 [label="Expert 30 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 960-991" fillcolor=lightblue]
	expert_31_s1_l0 [label="Expert 31 L0\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 992-1023" fillcolor=lightblue]
	expert_combine_s1_l0 [label="Expert Combine L0 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_out_proj_s1_l0 [label="MoE Output Proj L0 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_moe_out_s1_l0 [label="All-Reduce MoE Output L0\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	layernorm2_s1_l0 [label="LayerNorm 2 (L0)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	layernorm1_s1_l1 [label="LayerNorm 1 (L1)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	qkv_proj_s1_l1 [label="QKV Projection L1 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_qkv_s1_l1 [label="All-Reduce QKV L1\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	attention_s1_l1 [label="Self-Attention L1\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	attn_out_proj_s1_l1 [label="Attention Output Proj L1 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_attn_out_s1_l1 [label="All-Reduce Attention Output L1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_gate_s1_l1 [label="MoE Gate L1 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=orange shape=parallelogram]
	expert_dispatch_s1_l1 [label="Expert Dispatch L1 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	expert_0_s1_l1 [label="Expert 0 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 0-31" fillcolor=lightblue]
	expert_1_s1_l1 [label="Expert 1 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 32-63" fillcolor=lightblue]
	expert_2_s1_l1 [label="Expert 2 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 64-95" fillcolor=lightblue]
	expert_3_s1_l1 [label="Expert 3 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 96-127" fillcolor=lightblue]
	expert_4_s1_l1 [label="Expert 4 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 128-159" fillcolor=lightblue]
	expert_5_s1_l1 [label="Expert 5 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 160-191" fillcolor=lightblue]
	expert_6_s1_l1 [label="Expert 6 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 192-223" fillcolor=lightblue]
	expert_7_s1_l1 [label="Expert 7 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 224-255" fillcolor=lightblue]
	expert_8_s1_l1 [label="Expert 8 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 256-287" fillcolor=lightblue]
	expert_9_s1_l1 [label="Expert 9 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 288-319" fillcolor=lightblue]
	expert_10_s1_l1 [label="Expert 10 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 320-351" fillcolor=lightblue]
	expert_11_s1_l1 [label="Expert 11 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 352-383" fillcolor=lightblue]
	expert_12_s1_l1 [label="Expert 12 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 384-415" fillcolor=lightblue]
	expert_13_s1_l1 [label="Expert 13 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 416-447" fillcolor=lightblue]
	expert_14_s1_l1 [label="Expert 14 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 448-479" fillcolor=lightblue]
	expert_15_s1_l1 [label="Expert 15 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 480-511" fillcolor=lightblue]
	expert_16_s1_l1 [label="Expert 16 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 512-543" fillcolor=lightblue]
	expert_17_s1_l1 [label="Expert 17 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 544-575" fillcolor=lightblue]
	expert_18_s1_l1 [label="Expert 18 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 576-607" fillcolor=lightblue]
	expert_19_s1_l1 [label="Expert 19 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 608-639" fillcolor=lightblue]
	expert_20_s1_l1 [label="Expert 20 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 640-671" fillcolor=lightblue]
	expert_21_s1_l1 [label="Expert 21 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 672-703" fillcolor=lightblue]
	expert_22_s1_l1 [label="Expert 22 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 704-735" fillcolor=lightblue]
	expert_23_s1_l1 [label="Expert 23 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 736-767" fillcolor=lightblue]
	expert_24_s1_l1 [label="Expert 24 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 768-799" fillcolor=lightblue]
	expert_25_s1_l1 [label="Expert 25 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 800-831" fillcolor=lightblue]
	expert_26_s1_l1 [label="Expert 26 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 832-863" fillcolor=lightblue]
	expert_27_s1_l1 [label="Expert 27 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 864-895" fillcolor=lightblue]
	expert_28_s1_l1 [label="Expert 28 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 896-927" fillcolor=lightblue]
	expert_29_s1_l1 [label="Expert 29 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 928-959" fillcolor=lightblue]
	expert_30_s1_l1 [label="Expert 30 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 960-991" fillcolor=lightblue]
	expert_31_s1_l1 [label="Expert 31 L1\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 992-1023" fillcolor=lightblue]
	expert_combine_s1_l1 [label="Expert Combine L1 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_out_proj_s1_l1 [label="MoE Output Proj L1 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_moe_out_s1_l1 [label="All-Reduce MoE Output L1\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	layernorm2_s1_l1 [label="LayerNorm 2 (L1)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	layernorm1_s1_l2 [label="LayerNorm 1 (L2)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	qkv_proj_s1_l2 [label="QKV Projection L2 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_qkv_s1_l2 [label="All-Reduce QKV L2\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	attention_s1_l2 [label="Self-Attention L2\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	attn_out_proj_s1_l2 [label="Attention Output Proj L2 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_attn_out_s1_l2 [label="All-Reduce Attention Output L2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_gate_s1_l2 [label="MoE Gate L2 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=orange shape=parallelogram]
	expert_dispatch_s1_l2 [label="Expert Dispatch L2 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	expert_0_s1_l2 [label="Expert 0 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 0-31" fillcolor=lightblue]
	expert_1_s1_l2 [label="Expert 1 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 32-63" fillcolor=lightblue]
	expert_2_s1_l2 [label="Expert 2 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 64-95" fillcolor=lightblue]
	expert_3_s1_l2 [label="Expert 3 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 96-127" fillcolor=lightblue]
	expert_4_s1_l2 [label="Expert 4 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 128-159" fillcolor=lightblue]
	expert_5_s1_l2 [label="Expert 5 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 160-191" fillcolor=lightblue]
	expert_6_s1_l2 [label="Expert 6 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 192-223" fillcolor=lightblue]
	expert_7_s1_l2 [label="Expert 7 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 224-255" fillcolor=lightblue]
	expert_8_s1_l2 [label="Expert 8 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 256-287" fillcolor=lightblue]
	expert_9_s1_l2 [label="Expert 9 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 288-319" fillcolor=lightblue]
	expert_10_s1_l2 [label="Expert 10 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 320-351" fillcolor=lightblue]
	expert_11_s1_l2 [label="Expert 11 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 352-383" fillcolor=lightblue]
	expert_12_s1_l2 [label="Expert 12 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 384-415" fillcolor=lightblue]
	expert_13_s1_l2 [label="Expert 13 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 416-447" fillcolor=lightblue]
	expert_14_s1_l2 [label="Expert 14 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 448-479" fillcolor=lightblue]
	expert_15_s1_l2 [label="Expert 15 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 480-511" fillcolor=lightblue]
	expert_16_s1_l2 [label="Expert 16 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 512-543" fillcolor=lightblue]
	expert_17_s1_l2 [label="Expert 17 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 544-575" fillcolor=lightblue]
	expert_18_s1_l2 [label="Expert 18 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 576-607" fillcolor=lightblue]
	expert_19_s1_l2 [label="Expert 19 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 608-639" fillcolor=lightblue]
	expert_20_s1_l2 [label="Expert 20 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 640-671" fillcolor=lightblue]
	expert_21_s1_l2 [label="Expert 21 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 672-703" fillcolor=lightblue]
	expert_22_s1_l2 [label="Expert 22 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 704-735" fillcolor=lightblue]
	expert_23_s1_l2 [label="Expert 23 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 736-767" fillcolor=lightblue]
	expert_24_s1_l2 [label="Expert 24 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 768-799" fillcolor=lightblue]
	expert_25_s1_l2 [label="Expert 25 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 800-831" fillcolor=lightblue]
	expert_26_s1_l2 [label="Expert 26 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 832-863" fillcolor=lightblue]
	expert_27_s1_l2 [label="Expert 27 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 864-895" fillcolor=lightblue]
	expert_28_s1_l2 [label="Expert 28 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 896-927" fillcolor=lightblue]
	expert_29_s1_l2 [label="Expert 29 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 928-959" fillcolor=lightblue]
	expert_30_s1_l2 [label="Expert 30 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 960-991" fillcolor=lightblue]
	expert_31_s1_l2 [label="Expert 31 L2\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 992-1023" fillcolor=lightblue]
	expert_combine_s1_l2 [label="Expert Combine L2 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_out_proj_s1_l2 [label="MoE Output Proj L2 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_moe_out_s1_l2 [label="All-Reduce MoE Output L2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	layernorm2_s1_l2 [label="LayerNorm 2 (L2)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	layernorm1_s1_l3 [label="LayerNorm 1 (L3)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	qkv_proj_s1_l3 [label="QKV Projection L3 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_qkv_s1_l3 [label="All-Reduce QKV L3\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	attention_s1_l3 [label="Self-Attention L3\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	attn_out_proj_s1_l3 [label="Attention Output Proj L3 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_attn_out_s1_l3 [label="All-Reduce Attention Output L3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_gate_s1_l3 [label="MoE Gate L3 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=orange shape=parallelogram]
	expert_dispatch_s1_l3 [label="Expert Dispatch L3 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	expert_0_s1_l3 [label="Expert 0 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 0-31" fillcolor=lightblue]
	expert_1_s1_l3 [label="Expert 1 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 32-63" fillcolor=lightblue]
	expert_2_s1_l3 [label="Expert 2 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 64-95" fillcolor=lightblue]
	expert_3_s1_l3 [label="Expert 3 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 96-127" fillcolor=lightblue]
	expert_4_s1_l3 [label="Expert 4 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 128-159" fillcolor=lightblue]
	expert_5_s1_l3 [label="Expert 5 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 160-191" fillcolor=lightblue]
	expert_6_s1_l3 [label="Expert 6 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 192-223" fillcolor=lightblue]
	expert_7_s1_l3 [label="Expert 7 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 224-255" fillcolor=lightblue]
	expert_8_s1_l3 [label="Expert 8 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 256-287" fillcolor=lightblue]
	expert_9_s1_l3 [label="Expert 9 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 288-319" fillcolor=lightblue]
	expert_10_s1_l3 [label="Expert 10 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 320-351" fillcolor=lightblue]
	expert_11_s1_l3 [label="Expert 11 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 352-383" fillcolor=lightblue]
	expert_12_s1_l3 [label="Expert 12 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 384-415" fillcolor=lightblue]
	expert_13_s1_l3 [label="Expert 13 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 416-447" fillcolor=lightblue]
	expert_14_s1_l3 [label="Expert 14 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 448-479" fillcolor=lightblue]
	expert_15_s1_l3 [label="Expert 15 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 480-511" fillcolor=lightblue]
	expert_16_s1_l3 [label="Expert 16 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 512-543" fillcolor=lightblue]
	expert_17_s1_l3 [label="Expert 17 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 544-575" fillcolor=lightblue]
	expert_18_s1_l3 [label="Expert 18 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 576-607" fillcolor=lightblue]
	expert_19_s1_l3 [label="Expert 19 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 608-639" fillcolor=lightblue]
	expert_20_s1_l3 [label="Expert 20 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 640-671" fillcolor=lightblue]
	expert_21_s1_l3 [label="Expert 21 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 672-703" fillcolor=lightblue]
	expert_22_s1_l3 [label="Expert 22 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 704-735" fillcolor=lightblue]
	expert_23_s1_l3 [label="Expert 23 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 736-767" fillcolor=lightblue]
	expert_24_s1_l3 [label="Expert 24 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 768-799" fillcolor=lightblue]
	expert_25_s1_l3 [label="Expert 25 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 800-831" fillcolor=lightblue]
	expert_26_s1_l3 [label="Expert 26 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 832-863" fillcolor=lightblue]
	expert_27_s1_l3 [label="Expert 27 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 864-895" fillcolor=lightblue]
	expert_28_s1_l3 [label="Expert 28 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 896-927" fillcolor=lightblue]
	expert_29_s1_l3 [label="Expert 29 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 928-959" fillcolor=lightblue]
	expert_30_s1_l3 [label="Expert 30 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 960-991" fillcolor=lightblue]
	expert_31_s1_l3 [label="Expert 31 L3\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 992-1023" fillcolor=lightblue]
	expert_combine_s1_l3 [label="Expert Combine L3 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_out_proj_s1_l3 [label="MoE Output Proj L3 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_moe_out_s1_l3 [label="All-Reduce MoE Output L3\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	layernorm2_s1_l3 [label="LayerNorm 2 (L3)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	layernorm1_s1_l4 [label="LayerNorm 1 (L4)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	qkv_proj_s1_l4 [label="QKV Projection L4 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_qkv_s1_l4 [label="All-Reduce QKV L4\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	attention_s1_l4 [label="Self-Attention L4\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	attn_out_proj_s1_l4 [label="Attention Output Proj L4 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_attn_out_s1_l4 [label="All-Reduce Attention Output L4\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_gate_s1_l4 [label="MoE Gate L4 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=orange shape=parallelogram]
	expert_dispatch_s1_l4 [label="Expert Dispatch L4 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	expert_0_s1_l4 [label="Expert 0 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 0-31" fillcolor=lightblue]
	expert_1_s1_l4 [label="Expert 1 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 32-63" fillcolor=lightblue]
	expert_2_s1_l4 [label="Expert 2 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 64-95" fillcolor=lightblue]
	expert_3_s1_l4 [label="Expert 3 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 96-127" fillcolor=lightblue]
	expert_4_s1_l4 [label="Expert 4 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 128-159" fillcolor=lightblue]
	expert_5_s1_l4 [label="Expert 5 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 160-191" fillcolor=lightblue]
	expert_6_s1_l4 [label="Expert 6 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 192-223" fillcolor=lightblue]
	expert_7_s1_l4 [label="Expert 7 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 224-255" fillcolor=lightblue]
	expert_8_s1_l4 [label="Expert 8 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 256-287" fillcolor=lightblue]
	expert_9_s1_l4 [label="Expert 9 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 288-319" fillcolor=lightblue]
	expert_10_s1_l4 [label="Expert 10 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 320-351" fillcolor=lightblue]
	expert_11_s1_l4 [label="Expert 11 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 352-383" fillcolor=lightblue]
	expert_12_s1_l4 [label="Expert 12 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 384-415" fillcolor=lightblue]
	expert_13_s1_l4 [label="Expert 13 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 416-447" fillcolor=lightblue]
	expert_14_s1_l4 [label="Expert 14 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 448-479" fillcolor=lightblue]
	expert_15_s1_l4 [label="Expert 15 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 480-511" fillcolor=lightblue]
	expert_16_s1_l4 [label="Expert 16 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 512-543" fillcolor=lightblue]
	expert_17_s1_l4 [label="Expert 17 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 544-575" fillcolor=lightblue]
	expert_18_s1_l4 [label="Expert 18 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 576-607" fillcolor=lightblue]
	expert_19_s1_l4 [label="Expert 19 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 608-639" fillcolor=lightblue]
	expert_20_s1_l4 [label="Expert 20 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 640-671" fillcolor=lightblue]
	expert_21_s1_l4 [label="Expert 21 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 672-703" fillcolor=lightblue]
	expert_22_s1_l4 [label="Expert 22 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 704-735" fillcolor=lightblue]
	expert_23_s1_l4 [label="Expert 23 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 736-767" fillcolor=lightblue]
	expert_24_s1_l4 [label="Expert 24 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 768-799" fillcolor=lightblue]
	expert_25_s1_l4 [label="Expert 25 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 800-831" fillcolor=lightblue]
	expert_26_s1_l4 [label="Expert 26 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 832-863" fillcolor=lightblue]
	expert_27_s1_l4 [label="Expert 27 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 864-895" fillcolor=lightblue]
	expert_28_s1_l4 [label="Expert 28 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 896-927" fillcolor=lightblue]
	expert_29_s1_l4 [label="Expert 29 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 928-959" fillcolor=lightblue]
	expert_30_s1_l4 [label="Expert 30 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 960-991" fillcolor=lightblue]
	expert_31_s1_l4 [label="Expert 31 L4\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 992-1023" fillcolor=lightblue]
	expert_combine_s1_l4 [label="Expert Combine L4 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_out_proj_s1_l4 [label="MoE Output Proj L4 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_moe_out_s1_l4 [label="All-Reduce MoE Output L4\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	layernorm2_s1_l4 [label="LayerNorm 2 (L4)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	layernorm1_s1_l5 [label="LayerNorm 1 (L5)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	qkv_proj_s1_l5 [label="QKV Projection L5 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_qkv_s1_l5 [label="All-Reduce QKV L5\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	attention_s1_l5 [label="Self-Attention L5\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	attn_out_proj_s1_l5 [label="Attention Output Proj L5 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_attn_out_s1_l5 [label="All-Reduce Attention Output L5\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_gate_s1_l5 [label="MoE Gate L5 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=orange shape=parallelogram]
	expert_dispatch_s1_l5 [label="Expert Dispatch L5 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	expert_0_s1_l5 [label="Expert 0 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 0-31" fillcolor=lightblue]
	expert_1_s1_l5 [label="Expert 1 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 32-63" fillcolor=lightblue]
	expert_2_s1_l5 [label="Expert 2 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 64-95" fillcolor=lightblue]
	expert_3_s1_l5 [label="Expert 3 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 96-127" fillcolor=lightblue]
	expert_4_s1_l5 [label="Expert 4 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 128-159" fillcolor=lightblue]
	expert_5_s1_l5 [label="Expert 5 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 160-191" fillcolor=lightblue]
	expert_6_s1_l5 [label="Expert 6 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 192-223" fillcolor=lightblue]
	expert_7_s1_l5 [label="Expert 7 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 224-255" fillcolor=lightblue]
	expert_8_s1_l5 [label="Expert 8 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 256-287" fillcolor=lightblue]
	expert_9_s1_l5 [label="Expert 9 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 288-319" fillcolor=lightblue]
	expert_10_s1_l5 [label="Expert 10 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 320-351" fillcolor=lightblue]
	expert_11_s1_l5 [label="Expert 11 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 352-383" fillcolor=lightblue]
	expert_12_s1_l5 [label="Expert 12 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 384-415" fillcolor=lightblue]
	expert_13_s1_l5 [label="Expert 13 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 416-447" fillcolor=lightblue]
	expert_14_s1_l5 [label="Expert 14 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 448-479" fillcolor=lightblue]
	expert_15_s1_l5 [label="Expert 15 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 480-511" fillcolor=lightblue]
	expert_16_s1_l5 [label="Expert 16 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 512-543" fillcolor=lightblue]
	expert_17_s1_l5 [label="Expert 17 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 544-575" fillcolor=lightblue]
	expert_18_s1_l5 [label="Expert 18 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 576-607" fillcolor=lightblue]
	expert_19_s1_l5 [label="Expert 19 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 608-639" fillcolor=lightblue]
	expert_20_s1_l5 [label="Expert 20 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 640-671" fillcolor=lightblue]
	expert_21_s1_l5 [label="Expert 21 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 672-703" fillcolor=lightblue]
	expert_22_s1_l5 [label="Expert 22 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 704-735" fillcolor=lightblue]
	expert_23_s1_l5 [label="Expert 23 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 736-767" fillcolor=lightblue]
	expert_24_s1_l5 [label="Expert 24 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 768-799" fillcolor=lightblue]
	expert_25_s1_l5 [label="Expert 25 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 800-831" fillcolor=lightblue]
	expert_26_s1_l5 [label="Expert 26 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 832-863" fillcolor=lightblue]
	expert_27_s1_l5 [label="Expert 27 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 864-895" fillcolor=lightblue]
	expert_28_s1_l5 [label="Expert 28 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 896-927" fillcolor=lightblue]
	expert_29_s1_l5 [label="Expert 29 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 928-959" fillcolor=lightblue]
	expert_30_s1_l5 [label="Expert 30 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 960-991" fillcolor=lightblue]
	expert_31_s1_l5 [label="Expert 31 L5\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 992-1023" fillcolor=lightblue]
	expert_combine_s1_l5 [label="Expert Combine L5 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_out_proj_s1_l5 [label="MoE Output Proj L5 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_moe_out_s1_l5 [label="All-Reduce MoE Output L5\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	layernorm2_s1_l5 [label="LayerNorm 2 (L5)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	layernorm1_s1_l6 [label="LayerNorm 1 (L6)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	qkv_proj_s1_l6 [label="QKV Projection L6 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_qkv_s1_l6 [label="All-Reduce QKV L6\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	attention_s1_l6 [label="Self-Attention L6\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	attn_out_proj_s1_l6 [label="Attention Output Proj L6 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_attn_out_s1_l6 [label="All-Reduce Attention Output L6\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_gate_s1_l6 [label="MoE Gate L6 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=orange shape=parallelogram]
	expert_dispatch_s1_l6 [label="Expert Dispatch L6 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	expert_0_s1_l6 [label="Expert 0 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 0-31" fillcolor=lightblue]
	expert_1_s1_l6 [label="Expert 1 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 32-63" fillcolor=lightblue]
	expert_2_s1_l6 [label="Expert 2 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 64-95" fillcolor=lightblue]
	expert_3_s1_l6 [label="Expert 3 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 96-127" fillcolor=lightblue]
	expert_4_s1_l6 [label="Expert 4 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 128-159" fillcolor=lightblue]
	expert_5_s1_l6 [label="Expert 5 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 160-191" fillcolor=lightblue]
	expert_6_s1_l6 [label="Expert 6 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 192-223" fillcolor=lightblue]
	expert_7_s1_l6 [label="Expert 7 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 224-255" fillcolor=lightblue]
	expert_8_s1_l6 [label="Expert 8 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 256-287" fillcolor=lightblue]
	expert_9_s1_l6 [label="Expert 9 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 288-319" fillcolor=lightblue]
	expert_10_s1_l6 [label="Expert 10 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 320-351" fillcolor=lightblue]
	expert_11_s1_l6 [label="Expert 11 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 352-383" fillcolor=lightblue]
	expert_12_s1_l6 [label="Expert 12 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 384-415" fillcolor=lightblue]
	expert_13_s1_l6 [label="Expert 13 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 416-447" fillcolor=lightblue]
	expert_14_s1_l6 [label="Expert 14 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 448-479" fillcolor=lightblue]
	expert_15_s1_l6 [label="Expert 15 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 480-511" fillcolor=lightblue]
	expert_16_s1_l6 [label="Expert 16 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 512-543" fillcolor=lightblue]
	expert_17_s1_l6 [label="Expert 17 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 544-575" fillcolor=lightblue]
	expert_18_s1_l6 [label="Expert 18 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 576-607" fillcolor=lightblue]
	expert_19_s1_l6 [label="Expert 19 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 608-639" fillcolor=lightblue]
	expert_20_s1_l6 [label="Expert 20 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 640-671" fillcolor=lightblue]
	expert_21_s1_l6 [label="Expert 21 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 672-703" fillcolor=lightblue]
	expert_22_s1_l6 [label="Expert 22 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 704-735" fillcolor=lightblue]
	expert_23_s1_l6 [label="Expert 23 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 736-767" fillcolor=lightblue]
	expert_24_s1_l6 [label="Expert 24 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 768-799" fillcolor=lightblue]
	expert_25_s1_l6 [label="Expert 25 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 800-831" fillcolor=lightblue]
	expert_26_s1_l6 [label="Expert 26 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 832-863" fillcolor=lightblue]
	expert_27_s1_l6 [label="Expert 27 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 864-895" fillcolor=lightblue]
	expert_28_s1_l6 [label="Expert 28 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 896-927" fillcolor=lightblue]
	expert_29_s1_l6 [label="Expert 29 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 928-959" fillcolor=lightblue]
	expert_30_s1_l6 [label="Expert 30 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 960-991" fillcolor=lightblue]
	expert_31_s1_l6 [label="Expert 31 L6\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 992-1023" fillcolor=lightblue]
	expert_combine_s1_l6 [label="Expert Combine L6 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_out_proj_s1_l6 [label="MoE Output Proj L6 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_moe_out_s1_l6 [label="All-Reduce MoE Output L6\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	layernorm2_s1_l6 [label="LayerNorm 2 (L6)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	layernorm1_s1_l7 [label="LayerNorm 1 (L7)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	qkv_proj_s1_l7 [label="QKV Projection L7 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_qkv_s1_l7 [label="All-Reduce QKV L7\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	attention_s1_l7 [label="Self-Attention L7\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 0-1023" fillcolor=lightblue]
	attn_out_proj_s1_l7 [label="Attention Output Proj L7 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_attn_out_s1_l7 [label="All-Reduce Attention Output L7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_gate_s1_l7 [label="MoE Gate L7 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=orange shape=parallelogram]
	expert_dispatch_s1_l7 [label="Expert Dispatch L7 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	expert_0_s1_l7 [label="Expert 0 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 0-31" fillcolor=lightblue]
	expert_1_s1_l7 [label="Expert 1 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 32-63" fillcolor=lightblue]
	expert_2_s1_l7 [label="Expert 2 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 64-95" fillcolor=lightblue]
	expert_3_s1_l7 [label="Expert 3 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 96-127" fillcolor=lightblue]
	expert_4_s1_l7 [label="Expert 4 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 128-159" fillcolor=lightblue]
	expert_5_s1_l7 [label="Expert 5 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 160-191" fillcolor=lightblue]
	expert_6_s1_l7 [label="Expert 6 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 192-223" fillcolor=lightblue]
	expert_7_s1_l7 [label="Expert 7 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 224-255" fillcolor=lightblue]
	expert_8_s1_l7 [label="Expert 8 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 256-287" fillcolor=lightblue]
	expert_9_s1_l7 [label="Expert 9 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 288-319" fillcolor=lightblue]
	expert_10_s1_l7 [label="Expert 10 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 320-351" fillcolor=lightblue]
	expert_11_s1_l7 [label="Expert 11 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 352-383" fillcolor=lightblue]
	expert_12_s1_l7 [label="Expert 12 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 384-415" fillcolor=lightblue]
	expert_13_s1_l7 [label="Expert 13 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 416-447" fillcolor=lightblue]
	expert_14_s1_l7 [label="Expert 14 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 448-479" fillcolor=lightblue]
	expert_15_s1_l7 [label="Expert 15 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 480-511" fillcolor=lightblue]
	expert_16_s1_l7 [label="Expert 16 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 512-543" fillcolor=lightblue]
	expert_17_s1_l7 [label="Expert 17 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 544-575" fillcolor=lightblue]
	expert_18_s1_l7 [label="Expert 18 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 576-607" fillcolor=lightblue]
	expert_19_s1_l7 [label="Expert 19 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 608-639" fillcolor=lightblue]
	expert_20_s1_l7 [label="Expert 20 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 640-671" fillcolor=lightblue]
	expert_21_s1_l7 [label="Expert 21 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 672-703" fillcolor=lightblue]
	expert_22_s1_l7 [label="Expert 22 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 704-735" fillcolor=lightblue]
	expert_23_s1_l7 [label="Expert 23 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 736-767" fillcolor=lightblue]
	expert_24_s1_l7 [label="Expert 24 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 768-799" fillcolor=lightblue]
	expert_25_s1_l7 [label="Expert 25 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 800-831" fillcolor=lightblue]
	expert_26_s1_l7 [label="Expert 26 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 832-863" fillcolor=lightblue]
	expert_27_s1_l7 [label="Expert 27 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 864-895" fillcolor=lightblue]
	expert_28_s1_l7 [label="Expert 28 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 896-927" fillcolor=lightblue]
	expert_29_s1_l7 [label="Expert 29 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 928-959" fillcolor=lightblue]
	expert_30_s1_l7 [label="Expert 30 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 960-991" fillcolor=lightblue]
	expert_31_s1_l7 [label="Expert 31 L7\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 992-1023" fillcolor=lightblue]
	expert_combine_s1_l7 [label="Expert Combine L7 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	moe_out_proj_s1_l7 [label="MoE Output Proj L7 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	allreduce_moe_out_s1_l7 [label="All-Reduce MoE Output L7\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=yellow shape=ellipse]
	layernorm2_s1_l7 [label="LayerNorm 2 (L7)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 0-1023" fillcolor=lightblue]
	pp_transfer_s1_s2 [label="Pipeline Transfer S1S2\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1023  1024" fillcolor=red shape=ellipse]
	layernorm1_s2_l8 [label="LayerNorm 1 (L8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	qkv_proj_s2_l8 [label="QKV Projection L8 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_qkv_s2_l8 [label="All-Reduce QKV L8\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	attention_s2_l8 [label="Self-Attention L8\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	attn_out_proj_s2_l8 [label="Attention Output Proj L8 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_attn_out_s2_l8 [label="All-Reduce Attention Output L8\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_gate_s2_l8 [label="MoE Gate L8 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=orange shape=parallelogram]
	expert_dispatch_s2_l8 [label="Expert Dispatch L8 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	expert_32_s2_l8 [label="Expert 32 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1024-1055" fillcolor=lightblue]
	expert_33_s2_l8 [label="Expert 33 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1056-1087" fillcolor=lightblue]
	expert_34_s2_l8 [label="Expert 34 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1088-1119" fillcolor=lightblue]
	expert_35_s2_l8 [label="Expert 35 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1120-1151" fillcolor=lightblue]
	expert_36_s2_l8 [label="Expert 36 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1152-1183" fillcolor=lightblue]
	expert_37_s2_l8 [label="Expert 37 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1184-1215" fillcolor=lightblue]
	expert_38_s2_l8 [label="Expert 38 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1216-1247" fillcolor=lightblue]
	expert_39_s2_l8 [label="Expert 39 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1248-1279" fillcolor=lightblue]
	expert_40_s2_l8 [label="Expert 40 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1280-1311" fillcolor=lightblue]
	expert_41_s2_l8 [label="Expert 41 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1312-1343" fillcolor=lightblue]
	expert_42_s2_l8 [label="Expert 42 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1344-1375" fillcolor=lightblue]
	expert_43_s2_l8 [label="Expert 43 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1376-1407" fillcolor=lightblue]
	expert_44_s2_l8 [label="Expert 44 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1408-1439" fillcolor=lightblue]
	expert_45_s2_l8 [label="Expert 45 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1440-1471" fillcolor=lightblue]
	expert_46_s2_l8 [label="Expert 46 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1472-1503" fillcolor=lightblue]
	expert_47_s2_l8 [label="Expert 47 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1504-1535" fillcolor=lightblue]
	expert_48_s2_l8 [label="Expert 48 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1536-1567" fillcolor=lightblue]
	expert_49_s2_l8 [label="Expert 49 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1568-1599" fillcolor=lightblue]
	expert_50_s2_l8 [label="Expert 50 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1600-1631" fillcolor=lightblue]
	expert_51_s2_l8 [label="Expert 51 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1632-1663" fillcolor=lightblue]
	expert_52_s2_l8 [label="Expert 52 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1664-1695" fillcolor=lightblue]
	expert_53_s2_l8 [label="Expert 53 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1696-1727" fillcolor=lightblue]
	expert_54_s2_l8 [label="Expert 54 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1728-1759" fillcolor=lightblue]
	expert_55_s2_l8 [label="Expert 55 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1760-1791" fillcolor=lightblue]
	expert_56_s2_l8 [label="Expert 56 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1792-1823" fillcolor=lightblue]
	expert_57_s2_l8 [label="Expert 57 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1824-1855" fillcolor=lightblue]
	expert_58_s2_l8 [label="Expert 58 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1856-1887" fillcolor=lightblue]
	expert_59_s2_l8 [label="Expert 59 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1888-1919" fillcolor=lightblue]
	expert_60_s2_l8 [label="Expert 60 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1920-1951" fillcolor=lightblue]
	expert_61_s2_l8 [label="Expert 61 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1952-1983" fillcolor=lightblue]
	expert_62_s2_l8 [label="Expert 62 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1984-2015" fillcolor=lightblue]
	expert_63_s2_l8 [label="Expert 63 L8\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 2016-2047" fillcolor=lightblue]
	expert_combine_s2_l8 [label="Expert Combine L8 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_out_proj_s2_l8 [label="MoE Output Proj L8 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_moe_out_s2_l8 [label="All-Reduce MoE Output L8\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	layernorm2_s2_l8 [label="LayerNorm 2 (L8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	layernorm1_s2_l9 [label="LayerNorm 1 (L9)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	qkv_proj_s2_l9 [label="QKV Projection L9 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_qkv_s2_l9 [label="All-Reduce QKV L9\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	attention_s2_l9 [label="Self-Attention L9\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	attn_out_proj_s2_l9 [label="Attention Output Proj L9 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_attn_out_s2_l9 [label="All-Reduce Attention Output L9\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_gate_s2_l9 [label="MoE Gate L9 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=orange shape=parallelogram]
	expert_dispatch_s2_l9 [label="Expert Dispatch L9 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	expert_32_s2_l9 [label="Expert 32 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1024-1055" fillcolor=lightblue]
	expert_33_s2_l9 [label="Expert 33 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1056-1087" fillcolor=lightblue]
	expert_34_s2_l9 [label="Expert 34 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1088-1119" fillcolor=lightblue]
	expert_35_s2_l9 [label="Expert 35 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1120-1151" fillcolor=lightblue]
	expert_36_s2_l9 [label="Expert 36 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1152-1183" fillcolor=lightblue]
	expert_37_s2_l9 [label="Expert 37 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1184-1215" fillcolor=lightblue]
	expert_38_s2_l9 [label="Expert 38 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1216-1247" fillcolor=lightblue]
	expert_39_s2_l9 [label="Expert 39 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1248-1279" fillcolor=lightblue]
	expert_40_s2_l9 [label="Expert 40 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1280-1311" fillcolor=lightblue]
	expert_41_s2_l9 [label="Expert 41 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1312-1343" fillcolor=lightblue]
	expert_42_s2_l9 [label="Expert 42 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1344-1375" fillcolor=lightblue]
	expert_43_s2_l9 [label="Expert 43 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1376-1407" fillcolor=lightblue]
	expert_44_s2_l9 [label="Expert 44 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1408-1439" fillcolor=lightblue]
	expert_45_s2_l9 [label="Expert 45 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1440-1471" fillcolor=lightblue]
	expert_46_s2_l9 [label="Expert 46 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1472-1503" fillcolor=lightblue]
	expert_47_s2_l9 [label="Expert 47 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1504-1535" fillcolor=lightblue]
	expert_48_s2_l9 [label="Expert 48 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1536-1567" fillcolor=lightblue]
	expert_49_s2_l9 [label="Expert 49 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1568-1599" fillcolor=lightblue]
	expert_50_s2_l9 [label="Expert 50 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1600-1631" fillcolor=lightblue]
	expert_51_s2_l9 [label="Expert 51 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1632-1663" fillcolor=lightblue]
	expert_52_s2_l9 [label="Expert 52 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1664-1695" fillcolor=lightblue]
	expert_53_s2_l9 [label="Expert 53 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1696-1727" fillcolor=lightblue]
	expert_54_s2_l9 [label="Expert 54 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1728-1759" fillcolor=lightblue]
	expert_55_s2_l9 [label="Expert 55 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1760-1791" fillcolor=lightblue]
	expert_56_s2_l9 [label="Expert 56 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1792-1823" fillcolor=lightblue]
	expert_57_s2_l9 [label="Expert 57 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1824-1855" fillcolor=lightblue]
	expert_58_s2_l9 [label="Expert 58 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1856-1887" fillcolor=lightblue]
	expert_59_s2_l9 [label="Expert 59 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1888-1919" fillcolor=lightblue]
	expert_60_s2_l9 [label="Expert 60 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1920-1951" fillcolor=lightblue]
	expert_61_s2_l9 [label="Expert 61 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1952-1983" fillcolor=lightblue]
	expert_62_s2_l9 [label="Expert 62 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1984-2015" fillcolor=lightblue]
	expert_63_s2_l9 [label="Expert 63 L9\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 2016-2047" fillcolor=lightblue]
	expert_combine_s2_l9 [label="Expert Combine L9 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_out_proj_s2_l9 [label="MoE Output Proj L9 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_moe_out_s2_l9 [label="All-Reduce MoE Output L9\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	layernorm2_s2_l9 [label="LayerNorm 2 (L9)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	layernorm1_s2_l10 [label="LayerNorm 1 (L10)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	qkv_proj_s2_l10 [label="QKV Projection L10 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_qkv_s2_l10 [label="All-Reduce QKV L10\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	attention_s2_l10 [label="Self-Attention L10\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	attn_out_proj_s2_l10 [label="Attention Output Proj L10 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_attn_out_s2_l10 [label="All-Reduce Attention Output L10\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_gate_s2_l10 [label="MoE Gate L10 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=orange shape=parallelogram]
	expert_dispatch_s2_l10 [label="Expert Dispatch L10 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	expert_32_s2_l10 [label="Expert 32 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1024-1055" fillcolor=lightblue]
	expert_33_s2_l10 [label="Expert 33 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1056-1087" fillcolor=lightblue]
	expert_34_s2_l10 [label="Expert 34 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1088-1119" fillcolor=lightblue]
	expert_35_s2_l10 [label="Expert 35 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1120-1151" fillcolor=lightblue]
	expert_36_s2_l10 [label="Expert 36 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1152-1183" fillcolor=lightblue]
	expert_37_s2_l10 [label="Expert 37 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1184-1215" fillcolor=lightblue]
	expert_38_s2_l10 [label="Expert 38 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1216-1247" fillcolor=lightblue]
	expert_39_s2_l10 [label="Expert 39 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1248-1279" fillcolor=lightblue]
	expert_40_s2_l10 [label="Expert 40 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1280-1311" fillcolor=lightblue]
	expert_41_s2_l10 [label="Expert 41 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1312-1343" fillcolor=lightblue]
	expert_42_s2_l10 [label="Expert 42 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1344-1375" fillcolor=lightblue]
	expert_43_s2_l10 [label="Expert 43 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1376-1407" fillcolor=lightblue]
	expert_44_s2_l10 [label="Expert 44 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1408-1439" fillcolor=lightblue]
	expert_45_s2_l10 [label="Expert 45 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1440-1471" fillcolor=lightblue]
	expert_46_s2_l10 [label="Expert 46 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1472-1503" fillcolor=lightblue]
	expert_47_s2_l10 [label="Expert 47 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1504-1535" fillcolor=lightblue]
	expert_48_s2_l10 [label="Expert 48 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1536-1567" fillcolor=lightblue]
	expert_49_s2_l10 [label="Expert 49 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1568-1599" fillcolor=lightblue]
	expert_50_s2_l10 [label="Expert 50 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1600-1631" fillcolor=lightblue]
	expert_51_s2_l10 [label="Expert 51 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1632-1663" fillcolor=lightblue]
	expert_52_s2_l10 [label="Expert 52 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1664-1695" fillcolor=lightblue]
	expert_53_s2_l10 [label="Expert 53 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1696-1727" fillcolor=lightblue]
	expert_54_s2_l10 [label="Expert 54 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1728-1759" fillcolor=lightblue]
	expert_55_s2_l10 [label="Expert 55 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1760-1791" fillcolor=lightblue]
	expert_56_s2_l10 [label="Expert 56 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1792-1823" fillcolor=lightblue]
	expert_57_s2_l10 [label="Expert 57 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1824-1855" fillcolor=lightblue]
	expert_58_s2_l10 [label="Expert 58 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1856-1887" fillcolor=lightblue]
	expert_59_s2_l10 [label="Expert 59 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1888-1919" fillcolor=lightblue]
	expert_60_s2_l10 [label="Expert 60 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1920-1951" fillcolor=lightblue]
	expert_61_s2_l10 [label="Expert 61 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1952-1983" fillcolor=lightblue]
	expert_62_s2_l10 [label="Expert 62 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1984-2015" fillcolor=lightblue]
	expert_63_s2_l10 [label="Expert 63 L10\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 2016-2047" fillcolor=lightblue]
	expert_combine_s2_l10 [label="Expert Combine L10 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_out_proj_s2_l10 [label="MoE Output Proj L10 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_moe_out_s2_l10 [label="All-Reduce MoE Output L10\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	layernorm2_s2_l10 [label="LayerNorm 2 (L10)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	layernorm1_s2_l11 [label="LayerNorm 1 (L11)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	qkv_proj_s2_l11 [label="QKV Projection L11 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_qkv_s2_l11 [label="All-Reduce QKV L11\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	attention_s2_l11 [label="Self-Attention L11\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	attn_out_proj_s2_l11 [label="Attention Output Proj L11 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_attn_out_s2_l11 [label="All-Reduce Attention Output L11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_gate_s2_l11 [label="MoE Gate L11 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=orange shape=parallelogram]
	expert_dispatch_s2_l11 [label="Expert Dispatch L11 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	expert_32_s2_l11 [label="Expert 32 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1024-1055" fillcolor=lightblue]
	expert_33_s2_l11 [label="Expert 33 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1056-1087" fillcolor=lightblue]
	expert_34_s2_l11 [label="Expert 34 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1088-1119" fillcolor=lightblue]
	expert_35_s2_l11 [label="Expert 35 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1120-1151" fillcolor=lightblue]
	expert_36_s2_l11 [label="Expert 36 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1152-1183" fillcolor=lightblue]
	expert_37_s2_l11 [label="Expert 37 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1184-1215" fillcolor=lightblue]
	expert_38_s2_l11 [label="Expert 38 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1216-1247" fillcolor=lightblue]
	expert_39_s2_l11 [label="Expert 39 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1248-1279" fillcolor=lightblue]
	expert_40_s2_l11 [label="Expert 40 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1280-1311" fillcolor=lightblue]
	expert_41_s2_l11 [label="Expert 41 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1312-1343" fillcolor=lightblue]
	expert_42_s2_l11 [label="Expert 42 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1344-1375" fillcolor=lightblue]
	expert_43_s2_l11 [label="Expert 43 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1376-1407" fillcolor=lightblue]
	expert_44_s2_l11 [label="Expert 44 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1408-1439" fillcolor=lightblue]
	expert_45_s2_l11 [label="Expert 45 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1440-1471" fillcolor=lightblue]
	expert_46_s2_l11 [label="Expert 46 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1472-1503" fillcolor=lightblue]
	expert_47_s2_l11 [label="Expert 47 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1504-1535" fillcolor=lightblue]
	expert_48_s2_l11 [label="Expert 48 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1536-1567" fillcolor=lightblue]
	expert_49_s2_l11 [label="Expert 49 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1568-1599" fillcolor=lightblue]
	expert_50_s2_l11 [label="Expert 50 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1600-1631" fillcolor=lightblue]
	expert_51_s2_l11 [label="Expert 51 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1632-1663" fillcolor=lightblue]
	expert_52_s2_l11 [label="Expert 52 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1664-1695" fillcolor=lightblue]
	expert_53_s2_l11 [label="Expert 53 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1696-1727" fillcolor=lightblue]
	expert_54_s2_l11 [label="Expert 54 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1728-1759" fillcolor=lightblue]
	expert_55_s2_l11 [label="Expert 55 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1760-1791" fillcolor=lightblue]
	expert_56_s2_l11 [label="Expert 56 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1792-1823" fillcolor=lightblue]
	expert_57_s2_l11 [label="Expert 57 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1824-1855" fillcolor=lightblue]
	expert_58_s2_l11 [label="Expert 58 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1856-1887" fillcolor=lightblue]
	expert_59_s2_l11 [label="Expert 59 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1888-1919" fillcolor=lightblue]
	expert_60_s2_l11 [label="Expert 60 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1920-1951" fillcolor=lightblue]
	expert_61_s2_l11 [label="Expert 61 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1952-1983" fillcolor=lightblue]
	expert_62_s2_l11 [label="Expert 62 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1984-2015" fillcolor=lightblue]
	expert_63_s2_l11 [label="Expert 63 L11\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 2016-2047" fillcolor=lightblue]
	expert_combine_s2_l11 [label="Expert Combine L11 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_out_proj_s2_l11 [label="MoE Output Proj L11 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_moe_out_s2_l11 [label="All-Reduce MoE Output L11\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	layernorm2_s2_l11 [label="LayerNorm 2 (L11)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	layernorm1_s2_l12 [label="LayerNorm 1 (L12)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	qkv_proj_s2_l12 [label="QKV Projection L12 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_qkv_s2_l12 [label="All-Reduce QKV L12\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	attention_s2_l12 [label="Self-Attention L12\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	attn_out_proj_s2_l12 [label="Attention Output Proj L12 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_attn_out_s2_l12 [label="All-Reduce Attention Output L12\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_gate_s2_l12 [label="MoE Gate L12 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=orange shape=parallelogram]
	expert_dispatch_s2_l12 [label="Expert Dispatch L12 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	expert_32_s2_l12 [label="Expert 32 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1024-1055" fillcolor=lightblue]
	expert_33_s2_l12 [label="Expert 33 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1056-1087" fillcolor=lightblue]
	expert_34_s2_l12 [label="Expert 34 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1088-1119" fillcolor=lightblue]
	expert_35_s2_l12 [label="Expert 35 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1120-1151" fillcolor=lightblue]
	expert_36_s2_l12 [label="Expert 36 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1152-1183" fillcolor=lightblue]
	expert_37_s2_l12 [label="Expert 37 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1184-1215" fillcolor=lightblue]
	expert_38_s2_l12 [label="Expert 38 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1216-1247" fillcolor=lightblue]
	expert_39_s2_l12 [label="Expert 39 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1248-1279" fillcolor=lightblue]
	expert_40_s2_l12 [label="Expert 40 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1280-1311" fillcolor=lightblue]
	expert_41_s2_l12 [label="Expert 41 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1312-1343" fillcolor=lightblue]
	expert_42_s2_l12 [label="Expert 42 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1344-1375" fillcolor=lightblue]
	expert_43_s2_l12 [label="Expert 43 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1376-1407" fillcolor=lightblue]
	expert_44_s2_l12 [label="Expert 44 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1408-1439" fillcolor=lightblue]
	expert_45_s2_l12 [label="Expert 45 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1440-1471" fillcolor=lightblue]
	expert_46_s2_l12 [label="Expert 46 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1472-1503" fillcolor=lightblue]
	expert_47_s2_l12 [label="Expert 47 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1504-1535" fillcolor=lightblue]
	expert_48_s2_l12 [label="Expert 48 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1536-1567" fillcolor=lightblue]
	expert_49_s2_l12 [label="Expert 49 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1568-1599" fillcolor=lightblue]
	expert_50_s2_l12 [label="Expert 50 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1600-1631" fillcolor=lightblue]
	expert_51_s2_l12 [label="Expert 51 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1632-1663" fillcolor=lightblue]
	expert_52_s2_l12 [label="Expert 52 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1664-1695" fillcolor=lightblue]
	expert_53_s2_l12 [label="Expert 53 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1696-1727" fillcolor=lightblue]
	expert_54_s2_l12 [label="Expert 54 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1728-1759" fillcolor=lightblue]
	expert_55_s2_l12 [label="Expert 55 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1760-1791" fillcolor=lightblue]
	expert_56_s2_l12 [label="Expert 56 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1792-1823" fillcolor=lightblue]
	expert_57_s2_l12 [label="Expert 57 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1824-1855" fillcolor=lightblue]
	expert_58_s2_l12 [label="Expert 58 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1856-1887" fillcolor=lightblue]
	expert_59_s2_l12 [label="Expert 59 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1888-1919" fillcolor=lightblue]
	expert_60_s2_l12 [label="Expert 60 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1920-1951" fillcolor=lightblue]
	expert_61_s2_l12 [label="Expert 61 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1952-1983" fillcolor=lightblue]
	expert_62_s2_l12 [label="Expert 62 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1984-2015" fillcolor=lightblue]
	expert_63_s2_l12 [label="Expert 63 L12\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 2016-2047" fillcolor=lightblue]
	expert_combine_s2_l12 [label="Expert Combine L12 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_out_proj_s2_l12 [label="MoE Output Proj L12 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_moe_out_s2_l12 [label="All-Reduce MoE Output L12\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	layernorm2_s2_l12 [label="LayerNorm 2 (L12)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	layernorm1_s2_l13 [label="LayerNorm 1 (L13)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	qkv_proj_s2_l13 [label="QKV Projection L13 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_qkv_s2_l13 [label="All-Reduce QKV L13\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	attention_s2_l13 [label="Self-Attention L13\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	attn_out_proj_s2_l13 [label="Attention Output Proj L13 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_attn_out_s2_l13 [label="All-Reduce Attention Output L13\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_gate_s2_l13 [label="MoE Gate L13 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=orange shape=parallelogram]
	expert_dispatch_s2_l13 [label="Expert Dispatch L13 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	expert_32_s2_l13 [label="Expert 32 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1024-1055" fillcolor=lightblue]
	expert_33_s2_l13 [label="Expert 33 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1056-1087" fillcolor=lightblue]
	expert_34_s2_l13 [label="Expert 34 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1088-1119" fillcolor=lightblue]
	expert_35_s2_l13 [label="Expert 35 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1120-1151" fillcolor=lightblue]
	expert_36_s2_l13 [label="Expert 36 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1152-1183" fillcolor=lightblue]
	expert_37_s2_l13 [label="Expert 37 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1184-1215" fillcolor=lightblue]
	expert_38_s2_l13 [label="Expert 38 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1216-1247" fillcolor=lightblue]
	expert_39_s2_l13 [label="Expert 39 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1248-1279" fillcolor=lightblue]
	expert_40_s2_l13 [label="Expert 40 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1280-1311" fillcolor=lightblue]
	expert_41_s2_l13 [label="Expert 41 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1312-1343" fillcolor=lightblue]
	expert_42_s2_l13 [label="Expert 42 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1344-1375" fillcolor=lightblue]
	expert_43_s2_l13 [label="Expert 43 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1376-1407" fillcolor=lightblue]
	expert_44_s2_l13 [label="Expert 44 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1408-1439" fillcolor=lightblue]
	expert_45_s2_l13 [label="Expert 45 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1440-1471" fillcolor=lightblue]
	expert_46_s2_l13 [label="Expert 46 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1472-1503" fillcolor=lightblue]
	expert_47_s2_l13 [label="Expert 47 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1504-1535" fillcolor=lightblue]
	expert_48_s2_l13 [label="Expert 48 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1536-1567" fillcolor=lightblue]
	expert_49_s2_l13 [label="Expert 49 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1568-1599" fillcolor=lightblue]
	expert_50_s2_l13 [label="Expert 50 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1600-1631" fillcolor=lightblue]
	expert_51_s2_l13 [label="Expert 51 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1632-1663" fillcolor=lightblue]
	expert_52_s2_l13 [label="Expert 52 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1664-1695" fillcolor=lightblue]
	expert_53_s2_l13 [label="Expert 53 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1696-1727" fillcolor=lightblue]
	expert_54_s2_l13 [label="Expert 54 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1728-1759" fillcolor=lightblue]
	expert_55_s2_l13 [label="Expert 55 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1760-1791" fillcolor=lightblue]
	expert_56_s2_l13 [label="Expert 56 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1792-1823" fillcolor=lightblue]
	expert_57_s2_l13 [label="Expert 57 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1824-1855" fillcolor=lightblue]
	expert_58_s2_l13 [label="Expert 58 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1856-1887" fillcolor=lightblue]
	expert_59_s2_l13 [label="Expert 59 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1888-1919" fillcolor=lightblue]
	expert_60_s2_l13 [label="Expert 60 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1920-1951" fillcolor=lightblue]
	expert_61_s2_l13 [label="Expert 61 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1952-1983" fillcolor=lightblue]
	expert_62_s2_l13 [label="Expert 62 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1984-2015" fillcolor=lightblue]
	expert_63_s2_l13 [label="Expert 63 L13\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 2016-2047" fillcolor=lightblue]
	expert_combine_s2_l13 [label="Expert Combine L13 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_out_proj_s2_l13 [label="MoE Output Proj L13 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_moe_out_s2_l13 [label="All-Reduce MoE Output L13\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	layernorm2_s2_l13 [label="LayerNorm 2 (L13)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	layernorm1_s2_l14 [label="LayerNorm 1 (L14)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	qkv_proj_s2_l14 [label="QKV Projection L14 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_qkv_s2_l14 [label="All-Reduce QKV L14\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	attention_s2_l14 [label="Self-Attention L14\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	attn_out_proj_s2_l14 [label="Attention Output Proj L14 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_attn_out_s2_l14 [label="All-Reduce Attention Output L14\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_gate_s2_l14 [label="MoE Gate L14 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=orange shape=parallelogram]
	expert_dispatch_s2_l14 [label="Expert Dispatch L14 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	expert_32_s2_l14 [label="Expert 32 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1024-1055" fillcolor=lightblue]
	expert_33_s2_l14 [label="Expert 33 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1056-1087" fillcolor=lightblue]
	expert_34_s2_l14 [label="Expert 34 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1088-1119" fillcolor=lightblue]
	expert_35_s2_l14 [label="Expert 35 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1120-1151" fillcolor=lightblue]
	expert_36_s2_l14 [label="Expert 36 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1152-1183" fillcolor=lightblue]
	expert_37_s2_l14 [label="Expert 37 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1184-1215" fillcolor=lightblue]
	expert_38_s2_l14 [label="Expert 38 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1216-1247" fillcolor=lightblue]
	expert_39_s2_l14 [label="Expert 39 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1248-1279" fillcolor=lightblue]
	expert_40_s2_l14 [label="Expert 40 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1280-1311" fillcolor=lightblue]
	expert_41_s2_l14 [label="Expert 41 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1312-1343" fillcolor=lightblue]
	expert_42_s2_l14 [label="Expert 42 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1344-1375" fillcolor=lightblue]
	expert_43_s2_l14 [label="Expert 43 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1376-1407" fillcolor=lightblue]
	expert_44_s2_l14 [label="Expert 44 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1408-1439" fillcolor=lightblue]
	expert_45_s2_l14 [label="Expert 45 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1440-1471" fillcolor=lightblue]
	expert_46_s2_l14 [label="Expert 46 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1472-1503" fillcolor=lightblue]
	expert_47_s2_l14 [label="Expert 47 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1504-1535" fillcolor=lightblue]
	expert_48_s2_l14 [label="Expert 48 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1536-1567" fillcolor=lightblue]
	expert_49_s2_l14 [label="Expert 49 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1568-1599" fillcolor=lightblue]
	expert_50_s2_l14 [label="Expert 50 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1600-1631" fillcolor=lightblue]
	expert_51_s2_l14 [label="Expert 51 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1632-1663" fillcolor=lightblue]
	expert_52_s2_l14 [label="Expert 52 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1664-1695" fillcolor=lightblue]
	expert_53_s2_l14 [label="Expert 53 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1696-1727" fillcolor=lightblue]
	expert_54_s2_l14 [label="Expert 54 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1728-1759" fillcolor=lightblue]
	expert_55_s2_l14 [label="Expert 55 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1760-1791" fillcolor=lightblue]
	expert_56_s2_l14 [label="Expert 56 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1792-1823" fillcolor=lightblue]
	expert_57_s2_l14 [label="Expert 57 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1824-1855" fillcolor=lightblue]
	expert_58_s2_l14 [label="Expert 58 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1856-1887" fillcolor=lightblue]
	expert_59_s2_l14 [label="Expert 59 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1888-1919" fillcolor=lightblue]
	expert_60_s2_l14 [label="Expert 60 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1920-1951" fillcolor=lightblue]
	expert_61_s2_l14 [label="Expert 61 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1952-1983" fillcolor=lightblue]
	expert_62_s2_l14 [label="Expert 62 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1984-2015" fillcolor=lightblue]
	expert_63_s2_l14 [label="Expert 63 L14\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 2016-2047" fillcolor=lightblue]
	expert_combine_s2_l14 [label="Expert Combine L14 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_out_proj_s2_l14 [label="MoE Output Proj L14 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_moe_out_s2_l14 [label="All-Reduce MoE Output L14\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	layernorm2_s2_l14 [label="LayerNorm 2 (L14)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	layernorm1_s2_l15 [label="LayerNorm 1 (L15)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	qkv_proj_s2_l15 [label="QKV Projection L15 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_qkv_s2_l15 [label="All-Reduce QKV L15\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	attention_s2_l15 [label="Self-Attention L15\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, heads=16, d_k=64]\nGPUs: 1024-2047" fillcolor=lightblue]
	attn_out_proj_s2_l15 [label="Attention Output Proj L15 (TP8)\nInput: [batch=128, seq=1024, heads=16, d_k=64]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_attn_out_s2_l15 [label="All-Reduce Attention Output L15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_gate_s2_l15 [label="MoE Gate L15 (Router)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=orange shape=parallelogram]
	expert_dispatch_s2_l15 [label="Expert Dispatch L15 (All-to-All)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	expert_32_s2_l15 [label="Expert 32 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1024-1055" fillcolor=lightblue]
	expert_33_s2_l15 [label="Expert 33 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1056-1087" fillcolor=lightblue]
	expert_34_s2_l15 [label="Expert 34 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1088-1119" fillcolor=lightblue]
	expert_35_s2_l15 [label="Expert 35 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1120-1151" fillcolor=lightblue]
	expert_36_s2_l15 [label="Expert 36 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1152-1183" fillcolor=lightblue]
	expert_37_s2_l15 [label="Expert 37 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1184-1215" fillcolor=lightblue]
	expert_38_s2_l15 [label="Expert 38 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1216-1247" fillcolor=lightblue]
	expert_39_s2_l15 [label="Expert 39 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1248-1279" fillcolor=lightblue]
	expert_40_s2_l15 [label="Expert 40 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1280-1311" fillcolor=lightblue]
	expert_41_s2_l15 [label="Expert 41 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1312-1343" fillcolor=lightblue]
	expert_42_s2_l15 [label="Expert 42 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1344-1375" fillcolor=lightblue]
	expert_43_s2_l15 [label="Expert 43 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1376-1407" fillcolor=lightblue]
	expert_44_s2_l15 [label="Expert 44 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1408-1439" fillcolor=lightblue]
	expert_45_s2_l15 [label="Expert 45 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1440-1471" fillcolor=lightblue]
	expert_46_s2_l15 [label="Expert 46 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1472-1503" fillcolor=lightblue]
	expert_47_s2_l15 [label="Expert 47 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1504-1535" fillcolor=lightblue]
	expert_48_s2_l15 [label="Expert 48 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1536-1567" fillcolor=lightblue]
	expert_49_s2_l15 [label="Expert 49 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1568-1599" fillcolor=lightblue]
	expert_50_s2_l15 [label="Expert 50 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1600-1631" fillcolor=lightblue]
	expert_51_s2_l15 [label="Expert 51 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1632-1663" fillcolor=lightblue]
	expert_52_s2_l15 [label="Expert 52 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1664-1695" fillcolor=lightblue]
	expert_53_s2_l15 [label="Expert 53 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1696-1727" fillcolor=lightblue]
	expert_54_s2_l15 [label="Expert 54 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1728-1759" fillcolor=lightblue]
	expert_55_s2_l15 [label="Expert 55 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1760-1791" fillcolor=lightblue]
	expert_56_s2_l15 [label="Expert 56 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1792-1823" fillcolor=lightblue]
	expert_57_s2_l15 [label="Expert 57 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1824-1855" fillcolor=lightblue]
	expert_58_s2_l15 [label="Expert 58 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1856-1887" fillcolor=lightblue]
	expert_59_s2_l15 [label="Expert 59 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1888-1919" fillcolor=lightblue]
	expert_60_s2_l15 [label="Expert 60 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1920-1951" fillcolor=lightblue]
	expert_61_s2_l15 [label="Expert 61 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1952-1983" fillcolor=lightblue]
	expert_62_s2_l15 [label="Expert 62 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 1984-2015" fillcolor=lightblue]
	expert_63_s2_l15 [label="Expert 63 L15\nInput: [batch=2, seq=1024, hidden=1024]\nOutput: [batch=2, seq=1024, hidden=2048]\nGPUs: 2016-2047" fillcolor=lightblue]
	expert_combine_s2_l15 [label="Expert Combine L15 (All-to-All)\nInput: [batch=128, seq=1024, hidden=2048]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	moe_out_proj_s2_l15 [label="MoE Output Proj L15 (TP8)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	allreduce_moe_out_s2_l15 [label="All-Reduce MoE Output L15\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=yellow shape=ellipse]
	layernorm2_s2_l15 [label="LayerNorm 2 (L15)\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: 1024-2047" fillcolor=lightblue]
	output [label="Output\nInput: [batch=128, seq=1024, hidden=1024]\nOutput: [batch=128, seq=1024, hidden=1024]\nGPUs: All" fillcolor=lightgreen shape=ellipse]
	input -> layernorm1_s1_l0
	layernorm1_s1_l0 -> qkv_proj_s1_l0
	qkv_proj_s1_l0 -> allreduce_qkv_s1_l0
	allreduce_qkv_s1_l0 -> attention_s1_l0
	attention_s1_l0 -> attn_out_proj_s1_l0
	attn_out_proj_s1_l0 -> allreduce_attn_out_s1_l0
	allreduce_attn_out_s1_l0 -> moe_gate_s1_l0
	moe_gate_s1_l0 -> expert_dispatch_s1_l0 [style=dashed]
	expert_dispatch_s1_l0 -> expert_0_s1_l0
	expert_dispatch_s1_l0 -> expert_1_s1_l0
	expert_dispatch_s1_l0 -> expert_2_s1_l0
	expert_dispatch_s1_l0 -> expert_3_s1_l0
	expert_dispatch_s1_l0 -> expert_4_s1_l0
	expert_dispatch_s1_l0 -> expert_5_s1_l0
	expert_dispatch_s1_l0 -> expert_6_s1_l0
	expert_dispatch_s1_l0 -> expert_7_s1_l0
	expert_dispatch_s1_l0 -> expert_8_s1_l0
	expert_dispatch_s1_l0 -> expert_9_s1_l0
	expert_dispatch_s1_l0 -> expert_10_s1_l0
	expert_dispatch_s1_l0 -> expert_11_s1_l0
	expert_dispatch_s1_l0 -> expert_12_s1_l0
	expert_dispatch_s1_l0 -> expert_13_s1_l0
	expert_dispatch_s1_l0 -> expert_14_s1_l0
	expert_dispatch_s1_l0 -> expert_15_s1_l0
	expert_dispatch_s1_l0 -> expert_16_s1_l0
	expert_dispatch_s1_l0 -> expert_17_s1_l0
	expert_dispatch_s1_l0 -> expert_18_s1_l0
	expert_dispatch_s1_l0 -> expert_19_s1_l0
	expert_dispatch_s1_l0 -> expert_20_s1_l0
	expert_dispatch_s1_l0 -> expert_21_s1_l0
	expert_dispatch_s1_l0 -> expert_22_s1_l0
	expert_dispatch_s1_l0 -> expert_23_s1_l0
	expert_dispatch_s1_l0 -> expert_24_s1_l0
	expert_dispatch_s1_l0 -> expert_25_s1_l0
	expert_dispatch_s1_l0 -> expert_26_s1_l0
	expert_dispatch_s1_l0 -> expert_27_s1_l0
	expert_dispatch_s1_l0 -> expert_28_s1_l0
	expert_dispatch_s1_l0 -> expert_29_s1_l0
	expert_dispatch_s1_l0 -> expert_30_s1_l0
	expert_dispatch_s1_l0 -> expert_31_s1_l0
	expert_0_s1_l0 -> expert_combine_s1_l0
	expert_1_s1_l0 -> expert_combine_s1_l0
	expert_2_s1_l0 -> expert_combine_s1_l0
	expert_3_s1_l0 -> expert_combine_s1_l0
	expert_4_s1_l0 -> expert_combine_s1_l0
	expert_5_s1_l0 -> expert_combine_s1_l0
	expert_6_s1_l0 -> expert_combine_s1_l0
	expert_7_s1_l0 -> expert_combine_s1_l0
	expert_8_s1_l0 -> expert_combine_s1_l0
	expert_9_s1_l0 -> expert_combine_s1_l0
	expert_10_s1_l0 -> expert_combine_s1_l0
	expert_11_s1_l0 -> expert_combine_s1_l0
	expert_12_s1_l0 -> expert_combine_s1_l0
	expert_13_s1_l0 -> expert_combine_s1_l0
	expert_14_s1_l0 -> expert_combine_s1_l0
	expert_15_s1_l0 -> expert_combine_s1_l0
	expert_16_s1_l0 -> expert_combine_s1_l0
	expert_17_s1_l0 -> expert_combine_s1_l0
	expert_18_s1_l0 -> expert_combine_s1_l0
	expert_19_s1_l0 -> expert_combine_s1_l0
	expert_20_s1_l0 -> expert_combine_s1_l0
	expert_21_s1_l0 -> expert_combine_s1_l0
	expert_22_s1_l0 -> expert_combine_s1_l0
	expert_23_s1_l0 -> expert_combine_s1_l0
	expert_24_s1_l0 -> expert_combine_s1_l0
	expert_25_s1_l0 -> expert_combine_s1_l0
	expert_26_s1_l0 -> expert_combine_s1_l0
	expert_27_s1_l0 -> expert_combine_s1_l0
	expert_28_s1_l0 -> expert_combine_s1_l0
	expert_29_s1_l0 -> expert_combine_s1_l0
	expert_30_s1_l0 -> expert_combine_s1_l0
	expert_31_s1_l0 -> expert_combine_s1_l0
	expert_combine_s1_l0 -> moe_out_proj_s1_l0
	moe_out_proj_s1_l0 -> allreduce_moe_out_s1_l0
	allreduce_moe_out_s1_l0 -> layernorm2_s1_l0
	layernorm2_s1_l0 -> layernorm1_s1_l1
	layernorm1_s1_l1 -> qkv_proj_s1_l1
	qkv_proj_s1_l1 -> allreduce_qkv_s1_l1
	allreduce_qkv_s1_l1 -> attention_s1_l1
	attention_s1_l1 -> attn_out_proj_s1_l1
	attn_out_proj_s1_l1 -> allreduce_attn_out_s1_l1
	allreduce_attn_out_s1_l1 -> moe_gate_s1_l1
	moe_gate_s1_l1 -> expert_dispatch_s1_l1 [style=dashed]
	expert_dispatch_s1_l1 -> expert_0_s1_l1
	expert_dispatch_s1_l1 -> expert_1_s1_l1
	expert_dispatch_s1_l1 -> expert_2_s1_l1
	expert_dispatch_s1_l1 -> expert_3_s1_l1
	expert_dispatch_s1_l1 -> expert_4_s1_l1
	expert_dispatch_s1_l1 -> expert_5_s1_l1
	expert_dispatch_s1_l1 -> expert_6_s1_l1
	expert_dispatch_s1_l1 -> expert_7_s1_l1
	expert_dispatch_s1_l1 -> expert_8_s1_l1
	expert_dispatch_s1_l1 -> expert_9_s1_l1
	expert_dispatch_s1_l1 -> expert_10_s1_l1
	expert_dispatch_s1_l1 -> expert_11_s1_l1
	expert_dispatch_s1_l1 -> expert_12_s1_l1
	expert_dispatch_s1_l1 -> expert_13_s1_l1
	expert_dispatch_s1_l1 -> expert_14_s1_l1
	expert_dispatch_s1_l1 -> expert_15_s1_l1
	expert_dispatch_s1_l1 -> expert_16_s1_l1
	expert_dispatch_s1_l1 -> expert_17_s1_l1
	expert_dispatch_s1_l1 -> expert_18_s1_l1
	expert_dispatch_s1_l1 -> expert_19_s1_l1
	expert_dispatch_s1_l1 -> expert_20_s1_l1
	expert_dispatch_s1_l1 -> expert_21_s1_l1
	expert_dispatch_s1_l1 -> expert_22_s1_l1
	expert_dispatch_s1_l1 -> expert_23_s1_l1
	expert_dispatch_s1_l1 -> expert_24_s1_l1
	expert_dispatch_s1_l1 -> expert_25_s1_l1
	expert_dispatch_s1_l1 -> expert_26_s1_l1
	expert_dispatch_s1_l1 -> expert_27_s1_l1
	expert_dispatch_s1_l1 -> expert_28_s1_l1
	expert_dispatch_s1_l1 -> expert_29_s1_l1
	expert_dispatch_s1_l1 -> expert_30_s1_l1
	expert_dispatch_s1_l1 -> expert_31_s1_l1
	expert_0_s1_l1 -> expert_combine_s1_l1
	expert_1_s1_l1 -> expert_combine_s1_l1
	expert_2_s1_l1 -> expert_combine_s1_l1
	expert_3_s1_l1 -> expert_combine_s1_l1
	expert_4_s1_l1 -> expert_combine_s1_l1
	expert_5_s1_l1 -> expert_combine_s1_l1
	expert_6_s1_l1 -> expert_combine_s1_l1
	expert_7_s1_l1 -> expert_combine_s1_l1
	expert_8_s1_l1 -> expert_combine_s1_l1
	expert_9_s1_l1 -> expert_combine_s1_l1
	expert_10_s1_l1 -> expert_combine_s1_l1
	expert_11_s1_l1 -> expert_combine_s1_l1
	expert_12_s1_l1 -> expert_combine_s1_l1
	expert_13_s1_l1 -> expert_combine_s1_l1
	expert_14_s1_l1 -> expert_combine_s1_l1
	expert_15_s1_l1 -> expert_combine_s1_l1
	expert_16_s1_l1 -> expert_combine_s1_l1
	expert_17_s1_l1 -> expert_combine_s1_l1
	expert_18_s1_l1 -> expert_combine_s1_l1
	expert_19_s1_l1 -> expert_combine_s1_l1
	expert_20_s1_l1 -> expert_combine_s1_l1
	expert_21_s1_l1 -> expert_combine_s1_l1
	expert_22_s1_l1 -> expert_combine_s1_l1
	expert_23_s1_l1 -> expert_combine_s1_l1
	expert_24_s1_l1 -> expert_combine_s1_l1
	expert_25_s1_l1 -> expert_combine_s1_l1
	expert_26_s1_l1 -> expert_combine_s1_l1
	expert_27_s1_l1 -> expert_combine_s1_l1
	expert_28_s1_l1 -> expert_combine_s1_l1
	expert_29_s1_l1 -> expert_combine_s1_l1
	expert_30_s1_l1 -> expert_combine_s1_l1
	expert_31_s1_l1 -> expert_combine_s1_l1
	expert_combine_s1_l1 -> moe_out_proj_s1_l1
	moe_out_proj_s1_l1 -> allreduce_moe_out_s1_l1
	allreduce_moe_out_s1_l1 -> layernorm2_s1_l1
	layernorm2_s1_l1 -> layernorm1_s1_l2
	layernorm1_s1_l2 -> qkv_proj_s1_l2
	qkv_proj_s1_l2 -> allreduce_qkv_s1_l2
	allreduce_qkv_s1_l2 -> attention_s1_l2
	attention_s1_l2 -> attn_out_proj_s1_l2
	attn_out_proj_s1_l2 -> allreduce_attn_out_s1_l2
	allreduce_attn_out_s1_l2 -> moe_gate_s1_l2
	moe_gate_s1_l2 -> expert_dispatch_s1_l2 [style=dashed]
	expert_dispatch_s1_l2 -> expert_0_s1_l2
	expert_dispatch_s1_l2 -> expert_1_s1_l2
	expert_dispatch_s1_l2 -> expert_2_s1_l2
	expert_dispatch_s1_l2 -> expert_3_s1_l2
	expert_dispatch_s1_l2 -> expert_4_s1_l2
	expert_dispatch_s1_l2 -> expert_5_s1_l2
	expert_dispatch_s1_l2 -> expert_6_s1_l2
	expert_dispatch_s1_l2 -> expert_7_s1_l2
	expert_dispatch_s1_l2 -> expert_8_s1_l2
	expert_dispatch_s1_l2 -> expert_9_s1_l2
	expert_dispatch_s1_l2 -> expert_10_s1_l2
	expert_dispatch_s1_l2 -> expert_11_s1_l2
	expert_dispatch_s1_l2 -> expert_12_s1_l2
	expert_dispatch_s1_l2 -> expert_13_s1_l2
	expert_dispatch_s1_l2 -> expert_14_s1_l2
	expert_dispatch_s1_l2 -> expert_15_s1_l2
	expert_dispatch_s1_l2 -> expert_16_s1_l2
	expert_dispatch_s1_l2 -> expert_17_s1_l2
	expert_dispatch_s1_l2 -> expert_18_s1_l2
	expert_dispatch_s1_l2 -> expert_19_s1_l2
	expert_dispatch_s1_l2 -> expert_20_s1_l2
	expert_dispatch_s1_l2 -> expert_21_s1_l2
	expert_dispatch_s1_l2 -> expert_22_s1_l2
	expert_dispatch_s1_l2 -> expert_23_s1_l2
	expert_dispatch_s1_l2 -> expert_24_s1_l2
	expert_dispatch_s1_l2 -> expert_25_s1_l2
	expert_dispatch_s1_l2 -> expert_26_s1_l2
	expert_dispatch_s1_l2 -> expert_27_s1_l2
	expert_dispatch_s1_l2 -> expert_28_s1_l2
	expert_dispatch_s1_l2 -> expert_29_s1_l2
	expert_dispatch_s1_l2 -> expert_30_s1_l2
	expert_dispatch_s1_l2 -> expert_31_s1_l2
	expert_0_s1_l2 -> expert_combine_s1_l2
	expert_1_s1_l2 -> expert_combine_s1_l2
	expert_2_s1_l2 -> expert_combine_s1_l2
	expert_3_s1_l2 -> expert_combine_s1_l2
	expert_4_s1_l2 -> expert_combine_s1_l2
	expert_5_s1_l2 -> expert_combine_s1_l2
	expert_6_s1_l2 -> expert_combine_s1_l2
	expert_7_s1_l2 -> expert_combine_s1_l2
	expert_8_s1_l2 -> expert_combine_s1_l2
	expert_9_s1_l2 -> expert_combine_s1_l2
	expert_10_s1_l2 -> expert_combine_s1_l2
	expert_11_s1_l2 -> expert_combine_s1_l2
	expert_12_s1_l2 -> expert_combine_s1_l2
	expert_13_s1_l2 -> expert_combine_s1_l2
	expert_14_s1_l2 -> expert_combine_s1_l2
	expert_15_s1_l2 -> expert_combine_s1_l2
	expert_16_s1_l2 -> expert_combine_s1_l2
	expert_17_s1_l2 -> expert_combine_s1_l2
	expert_18_s1_l2 -> expert_combine_s1_l2
	expert_19_s1_l2 -> expert_combine_s1_l2
	expert_20_s1_l2 -> expert_combine_s1_l2
	expert_21_s1_l2 -> expert_combine_s1_l2
	expert_22_s1_l2 -> expert_combine_s1_l2
	expert_23_s1_l2 -> expert_combine_s1_l2
	expert_24_s1_l2 -> expert_combine_s1_l2
	expert_25_s1_l2 -> expert_combine_s1_l2
	expert_26_s1_l2 -> expert_combine_s1_l2
	expert_27_s1_l2 -> expert_combine_s1_l2
	expert_28_s1_l2 -> expert_combine_s1_l2
	expert_29_s1_l2 -> expert_combine_s1_l2
	expert_30_s1_l2 -> expert_combine_s1_l2
	expert_31_s1_l2 -> expert_combine_s1_l2
	expert_combine_s1_l2 -> moe_out_proj_s1_l2
	moe_out_proj_s1_l2 -> allreduce_moe_out_s1_l2
	allreduce_moe_out_s1_l2 -> layernorm2_s1_l2
	layernorm2_s1_l2 -> layernorm1_s1_l3
	layernorm1_s1_l3 -> qkv_proj_s1_l3
	qkv_proj_s1_l3 -> allreduce_qkv_s1_l3
	allreduce_qkv_s1_l3 -> attention_s1_l3
	attention_s1_l3 -> attn_out_proj_s1_l3
	attn_out_proj_s1_l3 -> allreduce_attn_out_s1_l3
	allreduce_attn_out_s1_l3 -> moe_gate_s1_l3
	moe_gate_s1_l3 -> expert_dispatch_s1_l3 [style=dashed]
	expert_dispatch_s1_l3 -> expert_0_s1_l3
	expert_dispatch_s1_l3 -> expert_1_s1_l3
	expert_dispatch_s1_l3 -> expert_2_s1_l3
	expert_dispatch_s1_l3 -> expert_3_s1_l3
	expert_dispatch_s1_l3 -> expert_4_s1_l3
	expert_dispatch_s1_l3 -> expert_5_s1_l3
	expert_dispatch_s1_l3 -> expert_6_s1_l3
	expert_dispatch_s1_l3 -> expert_7_s1_l3
	expert_dispatch_s1_l3 -> expert_8_s1_l3
	expert_dispatch_s1_l3 -> expert_9_s1_l3
	expert_dispatch_s1_l3 -> expert_10_s1_l3
	expert_dispatch_s1_l3 -> expert_11_s1_l3
	expert_dispatch_s1_l3 -> expert_12_s1_l3
	expert_dispatch_s1_l3 -> expert_13_s1_l3
	expert_dispatch_s1_l3 -> expert_14_s1_l3
	expert_dispatch_s1_l3 -> expert_15_s1_l3
	expert_dispatch_s1_l3 -> expert_16_s1_l3
	expert_dispatch_s1_l3 -> expert_17_s1_l3
	expert_dispatch_s1_l3 -> expert_18_s1_l3
	expert_dispatch_s1_l3 -> expert_19_s1_l3
	expert_dispatch_s1_l3 -> expert_20_s1_l3
	expert_dispatch_s1_l3 -> expert_21_s1_l3
	expert_dispatch_s1_l3 -> expert_22_s1_l3
	expert_dispatch_s1_l3 -> expert_23_s1_l3
	expert_dispatch_s1_l3 -> expert_24_s1_l3
	expert_dispatch_s1_l3 -> expert_25_s1_l3
	expert_dispatch_s1_l3 -> expert_26_s1_l3
	expert_dispatch_s1_l3 -> expert_27_s1_l3
	expert_dispatch_s1_l3 -> expert_28_s1_l3
	expert_dispatch_s1_l3 -> expert_29_s1_l3
	expert_dispatch_s1_l3 -> expert_30_s1_l3
	expert_dispatch_s1_l3 -> expert_31_s1_l3
	expert_0_s1_l3 -> expert_combine_s1_l3
	expert_1_s1_l3 -> expert_combine_s1_l3
	expert_2_s1_l3 -> expert_combine_s1_l3
	expert_3_s1_l3 -> expert_combine_s1_l3
	expert_4_s1_l3 -> expert_combine_s1_l3
	expert_5_s1_l3 -> expert_combine_s1_l3
	expert_6_s1_l3 -> expert_combine_s1_l3
	expert_7_s1_l3 -> expert_combine_s1_l3
	expert_8_s1_l3 -> expert_combine_s1_l3
	expert_9_s1_l3 -> expert_combine_s1_l3
	expert_10_s1_l3 -> expert_combine_s1_l3
	expert_11_s1_l3 -> expert_combine_s1_l3
	expert_12_s1_l3 -> expert_combine_s1_l3
	expert_13_s1_l3 -> expert_combine_s1_l3
	expert_14_s1_l3 -> expert_combine_s1_l3
	expert_15_s1_l3 -> expert_combine_s1_l3
	expert_16_s1_l3 -> expert_combine_s1_l3
	expert_17_s1_l3 -> expert_combine_s1_l3
	expert_18_s1_l3 -> expert_combine_s1_l3
	expert_19_s1_l3 -> expert_combine_s1_l3
	expert_20_s1_l3 -> expert_combine_s1_l3
	expert_21_s1_l3 -> expert_combine_s1_l3
	expert_22_s1_l3 -> expert_combine_s1_l3
	expert_23_s1_l3 -> expert_combine_s1_l3
	expert_24_s1_l3 -> expert_combine_s1_l3
	expert_25_s1_l3 -> expert_combine_s1_l3
	expert_26_s1_l3 -> expert_combine_s1_l3
	expert_27_s1_l3 -> expert_combine_s1_l3
	expert_28_s1_l3 -> expert_combine_s1_l3
	expert_29_s1_l3 -> expert_combine_s1_l3
	expert_30_s1_l3 -> expert_combine_s1_l3
	expert_31_s1_l3 -> expert_combine_s1_l3
	expert_combine_s1_l3 -> moe_out_proj_s1_l3
	moe_out_proj_s1_l3 -> allreduce_moe_out_s1_l3
	allreduce_moe_out_s1_l3 -> layernorm2_s1_l3
	layernorm2_s1_l3 -> layernorm1_s1_l4
	layernorm1_s1_l4 -> qkv_proj_s1_l4
	qkv_proj_s1_l4 -> allreduce_qkv_s1_l4
	allreduce_qkv_s1_l4 -> attention_s1_l4
	attention_s1_l4 -> attn_out_proj_s1_l4
	attn_out_proj_s1_l4 -> allreduce_attn_out_s1_l4
	allreduce_attn_out_s1_l4 -> moe_gate_s1_l4
	moe_gate_s1_l4 -> expert_dispatch_s1_l4 [style=dashed]
	expert_dispatch_s1_l4 -> expert_0_s1_l4
	expert_dispatch_s1_l4 -> expert_1_s1_l4
	expert_dispatch_s1_l4 -> expert_2_s1_l4
	expert_dispatch_s1_l4 -> expert_3_s1_l4
	expert_dispatch_s1_l4 -> expert_4_s1_l4
	expert_dispatch_s1_l4 -> expert_5_s1_l4
	expert_dispatch_s1_l4 -> expert_6_s1_l4
	expert_dispatch_s1_l4 -> expert_7_s1_l4
	expert_dispatch_s1_l4 -> expert_8_s1_l4
	expert_dispatch_s1_l4 -> expert_9_s1_l4
	expert_dispatch_s1_l4 -> expert_10_s1_l4
	expert_dispatch_s1_l4 -> expert_11_s1_l4
	expert_dispatch_s1_l4 -> expert_12_s1_l4
	expert_dispatch_s1_l4 -> expert_13_s1_l4
	expert_dispatch_s1_l4 -> expert_14_s1_l4
	expert_dispatch_s1_l4 -> expert_15_s1_l4
	expert_dispatch_s1_l4 -> expert_16_s1_l4
	expert_dispatch_s1_l4 -> expert_17_s1_l4
	expert_dispatch_s1_l4 -> expert_18_s1_l4
	expert_dispatch_s1_l4 -> expert_19_s1_l4
	expert_dispatch_s1_l4 -> expert_20_s1_l4
	expert_dispatch_s1_l4 -> expert_21_s1_l4
	expert_dispatch_s1_l4 -> expert_22_s1_l4
	expert_dispatch_s1_l4 -> expert_23_s1_l4
	expert_dispatch_s1_l4 -> expert_24_s1_l4
	expert_dispatch_s1_l4 -> expert_25_s1_l4
	expert_dispatch_s1_l4 -> expert_26_s1_l4
	expert_dispatch_s1_l4 -> expert_27_s1_l4
	expert_dispatch_s1_l4 -> expert_28_s1_l4
	expert_dispatch_s1_l4 -> expert_29_s1_l4
	expert_dispatch_s1_l4 -> expert_30_s1_l4
	expert_dispatch_s1_l4 -> expert_31_s1_l4
	expert_0_s1_l4 -> expert_combine_s1_l4
	expert_1_s1_l4 -> expert_combine_s1_l4
	expert_2_s1_l4 -> expert_combine_s1_l4
	expert_3_s1_l4 -> expert_combine_s1_l4
	expert_4_s1_l4 -> expert_combine_s1_l4
	expert_5_s1_l4 -> expert_combine_s1_l4
	expert_6_s1_l4 -> expert_combine_s1_l4
	expert_7_s1_l4 -> expert_combine_s1_l4
	expert_8_s1_l4 -> expert_combine_s1_l4
	expert_9_s1_l4 -> expert_combine_s1_l4
	expert_10_s1_l4 -> expert_combine_s1_l4
	expert_11_s1_l4 -> expert_combine_s1_l4
	expert_12_s1_l4 -> expert_combine_s1_l4
	expert_13_s1_l4 -> expert_combine_s1_l4
	expert_14_s1_l4 -> expert_combine_s1_l4
	expert_15_s1_l4 -> expert_combine_s1_l4
	expert_16_s1_l4 -> expert_combine_s1_l4
	expert_17_s1_l4 -> expert_combine_s1_l4
	expert_18_s1_l4 -> expert_combine_s1_l4
	expert_19_s1_l4 -> expert_combine_s1_l4
	expert_20_s1_l4 -> expert_combine_s1_l4
	expert_21_s1_l4 -> expert_combine_s1_l4
	expert_22_s1_l4 -> expert_combine_s1_l4
	expert_23_s1_l4 -> expert_combine_s1_l4
	expert_24_s1_l4 -> expert_combine_s1_l4
	expert_25_s1_l4 -> expert_combine_s1_l4
	expert_26_s1_l4 -> expert_combine_s1_l4
	expert_27_s1_l4 -> expert_combine_s1_l4
	expert_28_s1_l4 -> expert_combine_s1_l4
	expert_29_s1_l4 -> expert_combine_s1_l4
	expert_30_s1_l4 -> expert_combine_s1_l4
	expert_31_s1_l4 -> expert_combine_s1_l4
	expert_combine_s1_l4 -> moe_out_proj_s1_l4
	moe_out_proj_s1_l4 -> allreduce_moe_out_s1_l4
	allreduce_moe_out_s1_l4 -> layernorm2_s1_l4
	layernorm2_s1_l4 -> layernorm1_s1_l5
	layernorm1_s1_l5 -> qkv_proj_s1_l5
	qkv_proj_s1_l5 -> allreduce_qkv_s1_l5
	allreduce_qkv_s1_l5 -> attention_s1_l5
	attention_s1_l5 -> attn_out_proj_s1_l5
	attn_out_proj_s1_l5 -> allreduce_attn_out_s1_l5
	allreduce_attn_out_s1_l5 -> moe_gate_s1_l5
	moe_gate_s1_l5 -> expert_dispatch_s1_l5 [style=dashed]
	expert_dispatch_s1_l5 -> expert_0_s1_l5
	expert_dispatch_s1_l5 -> expert_1_s1_l5
	expert_dispatch_s1_l5 -> expert_2_s1_l5
	expert_dispatch_s1_l5 -> expert_3_s1_l5
	expert_dispatch_s1_l5 -> expert_4_s1_l5
	expert_dispatch_s1_l5 -> expert_5_s1_l5
	expert_dispatch_s1_l5 -> expert_6_s1_l5
	expert_dispatch_s1_l5 -> expert_7_s1_l5
	expert_dispatch_s1_l5 -> expert_8_s1_l5
	expert_dispatch_s1_l5 -> expert_9_s1_l5
	expert_dispatch_s1_l5 -> expert_10_s1_l5
	expert_dispatch_s1_l5 -> expert_11_s1_l5
	expert_dispatch_s1_l5 -> expert_12_s1_l5
	expert_dispatch_s1_l5 -> expert_13_s1_l5
	expert_dispatch_s1_l5 -> expert_14_s1_l5
	expert_dispatch_s1_l5 -> expert_15_s1_l5
	expert_dispatch_s1_l5 -> expert_16_s1_l5
	expert_dispatch_s1_l5 -> expert_17_s1_l5
	expert_dispatch_s1_l5 -> expert_18_s1_l5
	expert_dispatch_s1_l5 -> expert_19_s1_l5
	expert_dispatch_s1_l5 -> expert_20_s1_l5
	expert_dispatch_s1_l5 -> expert_21_s1_l5
	expert_dispatch_s1_l5 -> expert_22_s1_l5
	expert_dispatch_s1_l5 -> expert_23_s1_l5
	expert_dispatch_s1_l5 -> expert_24_s1_l5
	expert_dispatch_s1_l5 -> expert_25_s1_l5
	expert_dispatch_s1_l5 -> expert_26_s1_l5
	expert_dispatch_s1_l5 -> expert_27_s1_l5
	expert_dispatch_s1_l5 -> expert_28_s1_l5
	expert_dispatch_s1_l5 -> expert_29_s1_l5
	expert_dispatch_s1_l5 -> expert_30_s1_l5
	expert_dispatch_s1_l5 -> expert_31_s1_l5
	expert_0_s1_l5 -> expert_combine_s1_l5
	expert_1_s1_l5 -> expert_combine_s1_l5
	expert_2_s1_l5 -> expert_combine_s1_l5
	expert_3_s1_l5 -> expert_combine_s1_l5
	expert_4_s1_l5 -> expert_combine_s1_l5
	expert_5_s1_l5 -> expert_combine_s1_l5
	expert_6_s1_l5 -> expert_combine_s1_l5
	expert_7_s1_l5 -> expert_combine_s1_l5
	expert_8_s1_l5 -> expert_combine_s1_l5
	expert_9_s1_l5 -> expert_combine_s1_l5
	expert_10_s1_l5 -> expert_combine_s1_l5
	expert_11_s1_l5 -> expert_combine_s1_l5
	expert_12_s1_l5 -> expert_combine_s1_l5
	expert_13_s1_l5 -> expert_combine_s1_l5
	expert_14_s1_l5 -> expert_combine_s1_l5
	expert_15_s1_l5 -> expert_combine_s1_l5
	expert_16_s1_l5 -> expert_combine_s1_l5
	expert_17_s1_l5 -> expert_combine_s1_l5
	expert_18_s1_l5 -> expert_combine_s1_l5
	expert_19_s1_l5 -> expert_combine_s1_l5
	expert_20_s1_l5 -> expert_combine_s1_l5
	expert_21_s1_l5 -> expert_combine_s1_l5
	expert_22_s1_l5 -> expert_combine_s1_l5
	expert_23_s1_l5 -> expert_combine_s1_l5
	expert_24_s1_l5 -> expert_combine_s1_l5
	expert_25_s1_l5 -> expert_combine_s1_l5
	expert_26_s1_l5 -> expert_combine_s1_l5
	expert_27_s1_l5 -> expert_combine_s1_l5
	expert_28_s1_l5 -> expert_combine_s1_l5
	expert_29_s1_l5 -> expert_combine_s1_l5
	expert_30_s1_l5 -> expert_combine_s1_l5
	expert_31_s1_l5 -> expert_combine_s1_l5
	expert_combine_s1_l5 -> moe_out_proj_s1_l5
	moe_out_proj_s1_l5 -> allreduce_moe_out_s1_l5
	allreduce_moe_out_s1_l5 -> layernorm2_s1_l5
	layernorm2_s1_l5 -> layernorm1_s1_l6
	layernorm1_s1_l6 -> qkv_proj_s1_l6
	qkv_proj_s1_l6 -> allreduce_qkv_s1_l6
	allreduce_qkv_s1_l6 -> attention_s1_l6
	attention_s1_l6 -> attn_out_proj_s1_l6
	attn_out_proj_s1_l6 -> allreduce_attn_out_s1_l6
	allreduce_attn_out_s1_l6 -> moe_gate_s1_l6
	moe_gate_s1_l6 -> expert_dispatch_s1_l6 [style=dashed]
	expert_dispatch_s1_l6 -> expert_0_s1_l6
	expert_dispatch_s1_l6 -> expert_1_s1_l6
	expert_dispatch_s1_l6 -> expert_2_s1_l6
	expert_dispatch_s1_l6 -> expert_3_s1_l6
	expert_dispatch_s1_l6 -> expert_4_s1_l6
	expert_dispatch_s1_l6 -> expert_5_s1_l6
	expert_dispatch_s1_l6 -> expert_6_s1_l6
	expert_dispatch_s1_l6 -> expert_7_s1_l6
	expert_dispatch_s1_l6 -> expert_8_s1_l6
	expert_dispatch_s1_l6 -> expert_9_s1_l6
	expert_dispatch_s1_l6 -> expert_10_s1_l6
	expert_dispatch_s1_l6 -> expert_11_s1_l6
	expert_dispatch_s1_l6 -> expert_12_s1_l6
	expert_dispatch_s1_l6 -> expert_13_s1_l6
	expert_dispatch_s1_l6 -> expert_14_s1_l6
	expert_dispatch_s1_l6 -> expert_15_s1_l6
	expert_dispatch_s1_l6 -> expert_16_s1_l6
	expert_dispatch_s1_l6 -> expert_17_s1_l6
	expert_dispatch_s1_l6 -> expert_18_s1_l6
	expert_dispatch_s1_l6 -> expert_19_s1_l6
	expert_dispatch_s1_l6 -> expert_20_s1_l6
	expert_dispatch_s1_l6 -> expert_21_s1_l6
	expert_dispatch_s1_l6 -> expert_22_s1_l6
	expert_dispatch_s1_l6 -> expert_23_s1_l6
	expert_dispatch_s1_l6 -> expert_24_s1_l6
	expert_dispatch_s1_l6 -> expert_25_s1_l6
	expert_dispatch_s1_l6 -> expert_26_s1_l6
	expert_dispatch_s1_l6 -> expert_27_s1_l6
	expert_dispatch_s1_l6 -> expert_28_s1_l6
	expert_dispatch_s1_l6 -> expert_29_s1_l6
	expert_dispatch_s1_l6 -> expert_30_s1_l6
	expert_dispatch_s1_l6 -> expert_31_s1_l6
	expert_0_s1_l6 -> expert_combine_s1_l6
	expert_1_s1_l6 -> expert_combine_s1_l6
	expert_2_s1_l6 -> expert_combine_s1_l6
	expert_3_s1_l6 -> expert_combine_s1_l6
	expert_4_s1_l6 -> expert_combine_s1_l6
	expert_5_s1_l6 -> expert_combine_s1_l6
	expert_6_s1_l6 -> expert_combine_s1_l6
	expert_7_s1_l6 -> expert_combine_s1_l6
	expert_8_s1_l6 -> expert_combine_s1_l6
	expert_9_s1_l6 -> expert_combine_s1_l6
	expert_10_s1_l6 -> expert_combine_s1_l6
	expert_11_s1_l6 -> expert_combine_s1_l6
	expert_12_s1_l6 -> expert_combine_s1_l6
	expert_13_s1_l6 -> expert_combine_s1_l6
	expert_14_s1_l6 -> expert_combine_s1_l6
	expert_15_s1_l6 -> expert_combine_s1_l6
	expert_16_s1_l6 -> expert_combine_s1_l6
	expert_17_s1_l6 -> expert_combine_s1_l6
	expert_18_s1_l6 -> expert_combine_s1_l6
	expert_19_s1_l6 -> expert_combine_s1_l6
	expert_20_s1_l6 -> expert_combine_s1_l6
	expert_21_s1_l6 -> expert_combine_s1_l6
	expert_22_s1_l6 -> expert_combine_s1_l6
	expert_23_s1_l6 -> expert_combine_s1_l6
	expert_24_s1_l6 -> expert_combine_s1_l6
	expert_25_s1_l6 -> expert_combine_s1_l6
	expert_26_s1_l6 -> expert_combine_s1_l6
	expert_27_s1_l6 -> expert_combine_s1_l6
	expert_28_s1_l6 -> expert_combine_s1_l6
	expert_29_s1_l6 -> expert_combine_s1_l6
	expert_30_s1_l6 -> expert_combine_s1_l6
	expert_31_s1_l6 -> expert_combine_s1_l6
	expert_combine_s1_l6 -> moe_out_proj_s1_l6
	moe_out_proj_s1_l6 -> allreduce_moe_out_s1_l6
	allreduce_moe_out_s1_l6 -> layernorm2_s1_l6
	layernorm2_s1_l6 -> layernorm1_s1_l7
	layernorm1_s1_l7 -> qkv_proj_s1_l7
	qkv_proj_s1_l7 -> allreduce_qkv_s1_l7
	allreduce_qkv_s1_l7 -> attention_s1_l7
	attention_s1_l7 -> attn_out_proj_s1_l7
	attn_out_proj_s1_l7 -> allreduce_attn_out_s1_l7
	allreduce_attn_out_s1_l7 -> moe_gate_s1_l7
	moe_gate_s1_l7 -> expert_dispatch_s1_l7 [style=dashed]
	expert_dispatch_s1_l7 -> expert_0_s1_l7
	expert_dispatch_s1_l7 -> expert_1_s1_l7
	expert_dispatch_s1_l7 -> expert_2_s1_l7
	expert_dispatch_s1_l7 -> expert_3_s1_l7
	expert_dispatch_s1_l7 -> expert_4_s1_l7
	expert_dispatch_s1_l7 -> expert_5_s1_l7
	expert_dispatch_s1_l7 -> expert_6_s1_l7
	expert_dispatch_s1_l7 -> expert_7_s1_l7
	expert_dispatch_s1_l7 -> expert_8_s1_l7
	expert_dispatch_s1_l7 -> expert_9_s1_l7
	expert_dispatch_s1_l7 -> expert_10_s1_l7
	expert_dispatch_s1_l7 -> expert_11_s1_l7
	expert_dispatch_s1_l7 -> expert_12_s1_l7
	expert_dispatch_s1_l7 -> expert_13_s1_l7
	expert_dispatch_s1_l7 -> expert_14_s1_l7
	expert_dispatch_s1_l7 -> expert_15_s1_l7
	expert_dispatch_s1_l7 -> expert_16_s1_l7
	expert_dispatch_s1_l7 -> expert_17_s1_l7
	expert_dispatch_s1_l7 -> expert_18_s1_l7
	expert_dispatch_s1_l7 -> expert_19_s1_l7
	expert_dispatch_s1_l7 -> expert_20_s1_l7
	expert_dispatch_s1_l7 -> expert_21_s1_l7
	expert_dispatch_s1_l7 -> expert_22_s1_l7
	expert_dispatch_s1_l7 -> expert_23_s1_l7
	expert_dispatch_s1_l7 -> expert_24_s1_l7
	expert_dispatch_s1_l7 -> expert_25_s1_l7
	expert_dispatch_s1_l7 -> expert_26_s1_l7
	expert_dispatch_s1_l7 -> expert_27_s1_l7
	expert_dispatch_s1_l7 -> expert_28_s1_l7
	expert_dispatch_s1_l7 -> expert_29_s1_l7
	expert_dispatch_s1_l7 -> expert_30_s1_l7
	expert_dispatch_s1_l7 -> expert_31_s1_l7
	expert_0_s1_l7 -> expert_combine_s1_l7
	expert_1_s1_l7 -> expert_combine_s1_l7
	expert_2_s1_l7 -> expert_combine_s1_l7
	expert_3_s1_l7 -> expert_combine_s1_l7
	expert_4_s1_l7 -> expert_combine_s1_l7
	expert_5_s1_l7 -> expert_combine_s1_l7
	expert_6_s1_l7 -> expert_combine_s1_l7
	expert_7_s1_l7 -> expert_combine_s1_l7
	expert_8_s1_l7 -> expert_combine_s1_l7
	expert_9_s1_l7 -> expert_combine_s1_l7
	expert_10_s1_l7 -> expert_combine_s1_l7
	expert_11_s1_l7 -> expert_combine_s1_l7
	expert_12_s1_l7 -> expert_combine_s1_l7
	expert_13_s1_l7 -> expert_combine_s1_l7
	expert_14_s1_l7 -> expert_combine_s1_l7
	expert_15_s1_l7 -> expert_combine_s1_l7
	expert_16_s1_l7 -> expert_combine_s1_l7
	expert_17_s1_l7 -> expert_combine_s1_l7
	expert_18_s1_l7 -> expert_combine_s1_l7
	expert_19_s1_l7 -> expert_combine_s1_l7
	expert_20_s1_l7 -> expert_combine_s1_l7
	expert_21_s1_l7 -> expert_combine_s1_l7
	expert_22_s1_l7 -> expert_combine_s1_l7
	expert_23_s1_l7 -> expert_combine_s1_l7
	expert_24_s1_l7 -> expert_combine_s1_l7
	expert_25_s1_l7 -> expert_combine_s1_l7
	expert_26_s1_l7 -> expert_combine_s1_l7
	expert_27_s1_l7 -> expert_combine_s1_l7
	expert_28_s1_l7 -> expert_combine_s1_l7
	expert_29_s1_l7 -> expert_combine_s1_l7
	expert_30_s1_l7 -> expert_combine_s1_l7
	expert_31_s1_l7 -> expert_combine_s1_l7
	expert_combine_s1_l7 -> moe_out_proj_s1_l7
	moe_out_proj_s1_l7 -> allreduce_moe_out_s1_l7
	allreduce_moe_out_s1_l7 -> layernorm2_s1_l7
	layernorm2_s1_l7 -> pp_transfer_s1_s2
	pp_transfer_s1_s2 -> layernorm1_s2_l8
	layernorm1_s2_l8 -> qkv_proj_s2_l8
	qkv_proj_s2_l8 -> allreduce_qkv_s2_l8
	allreduce_qkv_s2_l8 -> attention_s2_l8
	attention_s2_l8 -> attn_out_proj_s2_l8
	attn_out_proj_s2_l8 -> allreduce_attn_out_s2_l8
	allreduce_attn_out_s2_l8 -> moe_gate_s2_l8
	moe_gate_s2_l8 -> expert_dispatch_s2_l8 [style=dashed]
	expert_dispatch_s2_l8 -> expert_32_s2_l8
	expert_dispatch_s2_l8 -> expert_33_s2_l8
	expert_dispatch_s2_l8 -> expert_34_s2_l8
	expert_dispatch_s2_l8 -> expert_35_s2_l8
	expert_dispatch_s2_l8 -> expert_36_s2_l8
	expert_dispatch_s2_l8 -> expert_37_s2_l8
	expert_dispatch_s2_l8 -> expert_38_s2_l8
	expert_dispatch_s2_l8 -> expert_39_s2_l8
	expert_dispatch_s2_l8 -> expert_40_s2_l8
	expert_dispatch_s2_l8 -> expert_41_s2_l8
	expert_dispatch_s2_l8 -> expert_42_s2_l8
	expert_dispatch_s2_l8 -> expert_43_s2_l8
	expert_dispatch_s2_l8 -> expert_44_s2_l8
	expert_dispatch_s2_l8 -> expert_45_s2_l8
	expert_dispatch_s2_l8 -> expert_46_s2_l8
	expert_dispatch_s2_l8 -> expert_47_s2_l8
	expert_dispatch_s2_l8 -> expert_48_s2_l8
	expert_dispatch_s2_l8 -> expert_49_s2_l8
	expert_dispatch_s2_l8 -> expert_50_s2_l8
	expert_dispatch_s2_l8 -> expert_51_s2_l8
	expert_dispatch_s2_l8 -> expert_52_s2_l8
	expert_dispatch_s2_l8 -> expert_53_s2_l8
	expert_dispatch_s2_l8 -> expert_54_s2_l8
	expert_dispatch_s2_l8 -> expert_55_s2_l8
	expert_dispatch_s2_l8 -> expert_56_s2_l8
	expert_dispatch_s2_l8 -> expert_57_s2_l8
	expert_dispatch_s2_l8 -> expert_58_s2_l8
	expert_dispatch_s2_l8 -> expert_59_s2_l8
	expert_dispatch_s2_l8 -> expert_60_s2_l8
	expert_dispatch_s2_l8 -> expert_61_s2_l8
	expert_dispatch_s2_l8 -> expert_62_s2_l8
	expert_dispatch_s2_l8 -> expert_63_s2_l8
	expert_32_s2_l8 -> expert_combine_s2_l8
	expert_33_s2_l8 -> expert_combine_s2_l8
	expert_34_s2_l8 -> expert_combine_s2_l8
	expert_35_s2_l8 -> expert_combine_s2_l8
	expert_36_s2_l8 -> expert_combine_s2_l8
	expert_37_s2_l8 -> expert_combine_s2_l8
	expert_38_s2_l8 -> expert_combine_s2_l8
	expert_39_s2_l8 -> expert_combine_s2_l8
	expert_40_s2_l8 -> expert_combine_s2_l8
	expert_41_s2_l8 -> expert_combine_s2_l8
	expert_42_s2_l8 -> expert_combine_s2_l8
	expert_43_s2_l8 -> expert_combine_s2_l8
	expert_44_s2_l8 -> expert_combine_s2_l8
	expert_45_s2_l8 -> expert_combine_s2_l8
	expert_46_s2_l8 -> expert_combine_s2_l8
	expert_47_s2_l8 -> expert_combine_s2_l8
	expert_48_s2_l8 -> expert_combine_s2_l8
	expert_49_s2_l8 -> expert_combine_s2_l8
	expert_50_s2_l8 -> expert_combine_s2_l8
	expert_51_s2_l8 -> expert_combine_s2_l8
	expert_52_s2_l8 -> expert_combine_s2_l8
	expert_53_s2_l8 -> expert_combine_s2_l8
	expert_54_s2_l8 -> expert_combine_s2_l8
	expert_55_s2_l8 -> expert_combine_s2_l8
	expert_56_s2_l8 -> expert_combine_s2_l8
	expert_57_s2_l8 -> expert_combine_s2_l8
	expert_58_s2_l8 -> expert_combine_s2_l8
	expert_59_s2_l8 -> expert_combine_s2_l8
	expert_60_s2_l8 -> expert_combine_s2_l8
	expert_61_s2_l8 -> expert_combine_s2_l8
	expert_62_s2_l8 -> expert_combine_s2_l8
	expert_63_s2_l8 -> expert_combine_s2_l8
	expert_combine_s2_l8 -> moe_out_proj_s2_l8
	moe_out_proj_s2_l8 -> allreduce_moe_out_s2_l8
	allreduce_moe_out_s2_l8 -> layernorm2_s2_l8
	layernorm2_s2_l8 -> layernorm1_s2_l9
	layernorm1_s2_l9 -> qkv_proj_s2_l9
	qkv_proj_s2_l9 -> allreduce_qkv_s2_l9
	allreduce_qkv_s2_l9 -> attention_s2_l9
	attention_s2_l9 -> attn_out_proj_s2_l9
	attn_out_proj_s2_l9 -> allreduce_attn_out_s2_l9
	allreduce_attn_out_s2_l9 -> moe_gate_s2_l9
	moe_gate_s2_l9 -> expert_dispatch_s2_l9 [style=dashed]
	expert_dispatch_s2_l9 -> expert_32_s2_l9
	expert_dispatch_s2_l9 -> expert_33_s2_l9
	expert_dispatch_s2_l9 -> expert_34_s2_l9
	expert_dispatch_s2_l9 -> expert_35_s2_l9
	expert_dispatch_s2_l9 -> expert_36_s2_l9
	expert_dispatch_s2_l9 -> expert_37_s2_l9
	expert_dispatch_s2_l9 -> expert_38_s2_l9
	expert_dispatch_s2_l9 -> expert_39_s2_l9
	expert_dispatch_s2_l9 -> expert_40_s2_l9
	expert_dispatch_s2_l9 -> expert_41_s2_l9
	expert_dispatch_s2_l9 -> expert_42_s2_l9
	expert_dispatch_s2_l9 -> expert_43_s2_l9
	expert_dispatch_s2_l9 -> expert_44_s2_l9
	expert_dispatch_s2_l9 -> expert_45_s2_l9
	expert_dispatch_s2_l9 -> expert_46_s2_l9
	expert_dispatch_s2_l9 -> expert_47_s2_l9
	expert_dispatch_s2_l9 -> expert_48_s2_l9
	expert_dispatch_s2_l9 -> expert_49_s2_l9
	expert_dispatch_s2_l9 -> expert_50_s2_l9
	expert_dispatch_s2_l9 -> expert_51_s2_l9
	expert_dispatch_s2_l9 -> expert_52_s2_l9
	expert_dispatch_s2_l9 -> expert_53_s2_l9
	expert_dispatch_s2_l9 -> expert_54_s2_l9
	expert_dispatch_s2_l9 -> expert_55_s2_l9
	expert_dispatch_s2_l9 -> expert_56_s2_l9
	expert_dispatch_s2_l9 -> expert_57_s2_l9
	expert_dispatch_s2_l9 -> expert_58_s2_l9
	expert_dispatch_s2_l9 -> expert_59_s2_l9
	expert_dispatch_s2_l9 -> expert_60_s2_l9
	expert_dispatch_s2_l9 -> expert_61_s2_l9
	expert_dispatch_s2_l9 -> expert_62_s2_l9
	expert_dispatch_s2_l9 -> expert_63_s2_l9
	expert_32_s2_l9 -> expert_combine_s2_l9
	expert_33_s2_l9 -> expert_combine_s2_l9
	expert_34_s2_l9 -> expert_combine_s2_l9
	expert_35_s2_l9 -> expert_combine_s2_l9
	expert_36_s2_l9 -> expert_combine_s2_l9
	expert_37_s2_l9 -> expert_combine_s2_l9
	expert_38_s2_l9 -> expert_combine_s2_l9
	expert_39_s2_l9 -> expert_combine_s2_l9
	expert_40_s2_l9 -> expert_combine_s2_l9
	expert_41_s2_l9 -> expert_combine_s2_l9
	expert_42_s2_l9 -> expert_combine_s2_l9
	expert_43_s2_l9 -> expert_combine_s2_l9
	expert_44_s2_l9 -> expert_combine_s2_l9
	expert_45_s2_l9 -> expert_combine_s2_l9
	expert_46_s2_l9 -> expert_combine_s2_l9
	expert_47_s2_l9 -> expert_combine_s2_l9
	expert_48_s2_l9 -> expert_combine_s2_l9
	expert_49_s2_l9 -> expert_combine_s2_l9
	expert_50_s2_l9 -> expert_combine_s2_l9
	expert_51_s2_l9 -> expert_combine_s2_l9
	expert_52_s2_l9 -> expert_combine_s2_l9
	expert_53_s2_l9 -> expert_combine_s2_l9
	expert_54_s2_l9 -> expert_combine_s2_l9
	expert_55_s2_l9 -> expert_combine_s2_l9
	expert_56_s2_l9 -> expert_combine_s2_l9
	expert_57_s2_l9 -> expert_combine_s2_l9
	expert_58_s2_l9 -> expert_combine_s2_l9
	expert_59_s2_l9 -> expert_combine_s2_l9
	expert_60_s2_l9 -> expert_combine_s2_l9
	expert_61_s2_l9 -> expert_combine_s2_l9
	expert_62_s2_l9 -> expert_combine_s2_l9
	expert_63_s2_l9 -> expert_combine_s2_l9
	expert_combine_s2_l9 -> moe_out_proj_s2_l9
	moe_out_proj_s2_l9 -> allreduce_moe_out_s2_l9
	allreduce_moe_out_s2_l9 -> layernorm2_s2_l9
	layernorm2_s2_l9 -> layernorm1_s2_l10
	layernorm1_s2_l10 -> qkv_proj_s2_l10
	qkv_proj_s2_l10 -> allreduce_qkv_s2_l10
	allreduce_qkv_s2_l10 -> attention_s2_l10
	attention_s2_l10 -> attn_out_proj_s2_l10
	attn_out_proj_s2_l10 -> allreduce_attn_out_s2_l10
	allreduce_attn_out_s2_l10 -> moe_gate_s2_l10
	moe_gate_s2_l10 -> expert_dispatch_s2_l10 [style=dashed]
	expert_dispatch_s2_l10 -> expert_32_s2_l10
	expert_dispatch_s2_l10 -> expert_33_s2_l10
	expert_dispatch_s2_l10 -> expert_34_s2_l10
	expert_dispatch_s2_l10 -> expert_35_s2_l10
	expert_dispatch_s2_l10 -> expert_36_s2_l10
	expert_dispatch_s2_l10 -> expert_37_s2_l10
	expert_dispatch_s2_l10 -> expert_38_s2_l10
	expert_dispatch_s2_l10 -> expert_39_s2_l10
	expert_dispatch_s2_l10 -> expert_40_s2_l10
	expert_dispatch_s2_l10 -> expert_41_s2_l10
	expert_dispatch_s2_l10 -> expert_42_s2_l10
	expert_dispatch_s2_l10 -> expert_43_s2_l10
	expert_dispatch_s2_l10 -> expert_44_s2_l10
	expert_dispatch_s2_l10 -> expert_45_s2_l10
	expert_dispatch_s2_l10 -> expert_46_s2_l10
	expert_dispatch_s2_l10 -> expert_47_s2_l10
	expert_dispatch_s2_l10 -> expert_48_s2_l10
	expert_dispatch_s2_l10 -> expert_49_s2_l10
	expert_dispatch_s2_l10 -> expert_50_s2_l10
	expert_dispatch_s2_l10 -> expert_51_s2_l10
	expert_dispatch_s2_l10 -> expert_52_s2_l10
	expert_dispatch_s2_l10 -> expert_53_s2_l10
	expert_dispatch_s2_l10 -> expert_54_s2_l10
	expert_dispatch_s2_l10 -> expert_55_s2_l10
	expert_dispatch_s2_l10 -> expert_56_s2_l10
	expert_dispatch_s2_l10 -> expert_57_s2_l10
	expert_dispatch_s2_l10 -> expert_58_s2_l10
	expert_dispatch_s2_l10 -> expert_59_s2_l10
	expert_dispatch_s2_l10 -> expert_60_s2_l10
	expert_dispatch_s2_l10 -> expert_61_s2_l10
	expert_dispatch_s2_l10 -> expert_62_s2_l10
	expert_dispatch_s2_l10 -> expert_63_s2_l10
	expert_32_s2_l10 -> expert_combine_s2_l10
	expert_33_s2_l10 -> expert_combine_s2_l10
	expert_34_s2_l10 -> expert_combine_s2_l10
	expert_35_s2_l10 -> expert_combine_s2_l10
	expert_36_s2_l10 -> expert_combine_s2_l10
	expert_37_s2_l10 -> expert_combine_s2_l10
	expert_38_s2_l10 -> expert_combine_s2_l10
	expert_39_s2_l10 -> expert_combine_s2_l10
	expert_40_s2_l10 -> expert_combine_s2_l10
	expert_41_s2_l10 -> expert_combine_s2_l10
	expert_42_s2_l10 -> expert_combine_s2_l10
	expert_43_s2_l10 -> expert_combine_s2_l10
	expert_44_s2_l10 -> expert_combine_s2_l10
	expert_45_s2_l10 -> expert_combine_s2_l10
	expert_46_s2_l10 -> expert_combine_s2_l10
	expert_47_s2_l10 -> expert_combine_s2_l10
	expert_48_s2_l10 -> expert_combine_s2_l10
	expert_49_s2_l10 -> expert_combine_s2_l10
	expert_50_s2_l10 -> expert_combine_s2_l10
	expert_51_s2_l10 -> expert_combine_s2_l10
	expert_52_s2_l10 -> expert_combine_s2_l10
	expert_53_s2_l10 -> expert_combine_s2_l10
	expert_54_s2_l10 -> expert_combine_s2_l10
	expert_55_s2_l10 -> expert_combine_s2_l10
	expert_56_s2_l10 -> expert_combine_s2_l10
	expert_57_s2_l10 -> expert_combine_s2_l10
	expert_58_s2_l10 -> expert_combine_s2_l10
	expert_59_s2_l10 -> expert_combine_s2_l10
	expert_60_s2_l10 -> expert_combine_s2_l10
	expert_61_s2_l10 -> expert_combine_s2_l10
	expert_62_s2_l10 -> expert_combine_s2_l10
	expert_63_s2_l10 -> expert_combine_s2_l10
	expert_combine_s2_l10 -> moe_out_proj_s2_l10
	moe_out_proj_s2_l10 -> allreduce_moe_out_s2_l10
	allreduce_moe_out_s2_l10 -> layernorm2_s2_l10
	layernorm2_s2_l10 -> layernorm1_s2_l11
	layernorm1_s2_l11 -> qkv_proj_s2_l11
	qkv_proj_s2_l11 -> allreduce_qkv_s2_l11
	allreduce_qkv_s2_l11 -> attention_s2_l11
	attention_s2_l11 -> attn_out_proj_s2_l11
	attn_out_proj_s2_l11 -> allreduce_attn_out_s2_l11
	allreduce_attn_out_s2_l11 -> moe_gate_s2_l11
	moe_gate_s2_l11 -> expert_dispatch_s2_l11 [style=dashed]
	expert_dispatch_s2_l11 -> expert_32_s2_l11
	expert_dispatch_s2_l11 -> expert_33_s2_l11
	expert_dispatch_s2_l11 -> expert_34_s2_l11
	expert_dispatch_s2_l11 -> expert_35_s2_l11
	expert_dispatch_s2_l11 -> expert_36_s2_l11
	expert_dispatch_s2_l11 -> expert_37_s2_l11
	expert_dispatch_s2_l11 -> expert_38_s2_l11
	expert_dispatch_s2_l11 -> expert_39_s2_l11
	expert_dispatch_s2_l11 -> expert_40_s2_l11
	expert_dispatch_s2_l11 -> expert_41_s2_l11
	expert_dispatch_s2_l11 -> expert_42_s2_l11
	expert_dispatch_s2_l11 -> expert_43_s2_l11
	expert_dispatch_s2_l11 -> expert_44_s2_l11
	expert_dispatch_s2_l11 -> expert_45_s2_l11
	expert_dispatch_s2_l11 -> expert_46_s2_l11
	expert_dispatch_s2_l11 -> expert_47_s2_l11
	expert_dispatch_s2_l11 -> expert_48_s2_l11
	expert_dispatch_s2_l11 -> expert_49_s2_l11
	expert_dispatch_s2_l11 -> expert_50_s2_l11
	expert_dispatch_s2_l11 -> expert_51_s2_l11
	expert_dispatch_s2_l11 -> expert_52_s2_l11
	expert_dispatch_s2_l11 -> expert_53_s2_l11
	expert_dispatch_s2_l11 -> expert_54_s2_l11
	expert_dispatch_s2_l11 -> expert_55_s2_l11
	expert_dispatch_s2_l11 -> expert_56_s2_l11
	expert_dispatch_s2_l11 -> expert_57_s2_l11
	expert_dispatch_s2_l11 -> expert_58_s2_l11
	expert_dispatch_s2_l11 -> expert_59_s2_l11
	expert_dispatch_s2_l11 -> expert_60_s2_l11
	expert_dispatch_s2_l11 -> expert_61_s2_l11
	expert_dispatch_s2_l11 -> expert_62_s2_l11
	expert_dispatch_s2_l11 -> expert_63_s2_l11
	expert_32_s2_l11 -> expert_combine_s2_l11
	expert_33_s2_l11 -> expert_combine_s2_l11
	expert_34_s2_l11 -> expert_combine_s2_l11
	expert_35_s2_l11 -> expert_combine_s2_l11
	expert_36_s2_l11 -> expert_combine_s2_l11
	expert_37_s2_l11 -> expert_combine_s2_l11
	expert_38_s2_l11 -> expert_combine_s2_l11
	expert_39_s2_l11 -> expert_combine_s2_l11
	expert_40_s2_l11 -> expert_combine_s2_l11
	expert_41_s2_l11 -> expert_combine_s2_l11
	expert_42_s2_l11 -> expert_combine_s2_l11
	expert_43_s2_l11 -> expert_combine_s2_l11
	expert_44_s2_l11 -> expert_combine_s2_l11
	expert_45_s2_l11 -> expert_combine_s2_l11
	expert_46_s2_l11 -> expert_combine_s2_l11
	expert_47_s2_l11 -> expert_combine_s2_l11
	expert_48_s2_l11 -> expert_combine_s2_l11
	expert_49_s2_l11 -> expert_combine_s2_l11
	expert_50_s2_l11 -> expert_combine_s2_l11
	expert_51_s2_l11 -> expert_combine_s2_l11
	expert_52_s2_l11 -> expert_combine_s2_l11
	expert_53_s2_l11 -> expert_combine_s2_l11
	expert_54_s2_l11 -> expert_combine_s2_l11
	expert_55_s2_l11 -> expert_combine_s2_l11
	expert_56_s2_l11 -> expert_combine_s2_l11
	expert_57_s2_l11 -> expert_combine_s2_l11
	expert_58_s2_l11 -> expert_combine_s2_l11
	expert_59_s2_l11 -> expert_combine_s2_l11
	expert_60_s2_l11 -> expert_combine_s2_l11
	expert_61_s2_l11 -> expert_combine_s2_l11
	expert_62_s2_l11 -> expert_combine_s2_l11
	expert_63_s2_l11 -> expert_combine_s2_l11
	expert_combine_s2_l11 -> moe_out_proj_s2_l11
	moe_out_proj_s2_l11 -> allreduce_moe_out_s2_l11
	allreduce_moe_out_s2_l11 -> layernorm2_s2_l11
	layernorm2_s2_l11 -> layernorm1_s2_l12
	layernorm1_s2_l12 -> qkv_proj_s2_l12
	qkv_proj_s2_l12 -> allreduce_qkv_s2_l12
	allreduce_qkv_s2_l12 -> attention_s2_l12
	attention_s2_l12 -> attn_out_proj_s2_l12
	attn_out_proj_s2_l12 -> allreduce_attn_out_s2_l12
	allreduce_attn_out_s2_l12 -> moe_gate_s2_l12
	moe_gate_s2_l12 -> expert_dispatch_s2_l12 [style=dashed]
	expert_dispatch_s2_l12 -> expert_32_s2_l12
	expert_dispatch_s2_l12 -> expert_33_s2_l12
	expert_dispatch_s2_l12 -> expert_34_s2_l12
	expert_dispatch_s2_l12 -> expert_35_s2_l12
	expert_dispatch_s2_l12 -> expert_36_s2_l12
	expert_dispatch_s2_l12 -> expert_37_s2_l12
	expert_dispatch_s2_l12 -> expert_38_s2_l12
	expert_dispatch_s2_l12 -> expert_39_s2_l12
	expert_dispatch_s2_l12 -> expert_40_s2_l12
	expert_dispatch_s2_l12 -> expert_41_s2_l12
	expert_dispatch_s2_l12 -> expert_42_s2_l12
	expert_dispatch_s2_l12 -> expert_43_s2_l12
	expert_dispatch_s2_l12 -> expert_44_s2_l12
	expert_dispatch_s2_l12 -> expert_45_s2_l12
	expert_dispatch_s2_l12 -> expert_46_s2_l12
	expert_dispatch_s2_l12 -> expert_47_s2_l12
	expert_dispatch_s2_l12 -> expert_48_s2_l12
	expert_dispatch_s2_l12 -> expert_49_s2_l12
	expert_dispatch_s2_l12 -> expert_50_s2_l12
	expert_dispatch_s2_l12 -> expert_51_s2_l12
	expert_dispatch_s2_l12 -> expert_52_s2_l12
	expert_dispatch_s2_l12 -> expert_53_s2_l12
	expert_dispatch_s2_l12 -> expert_54_s2_l12
	expert_dispatch_s2_l12 -> expert_55_s2_l12
	expert_dispatch_s2_l12 -> expert_56_s2_l12
	expert_dispatch_s2_l12 -> expert_57_s2_l12
	expert_dispatch_s2_l12 -> expert_58_s2_l12
	expert_dispatch_s2_l12 -> expert_59_s2_l12
	expert_dispatch_s2_l12 -> expert_60_s2_l12
	expert_dispatch_s2_l12 -> expert_61_s2_l12
	expert_dispatch_s2_l12 -> expert_62_s2_l12
	expert_dispatch_s2_l12 -> expert_63_s2_l12
	expert_32_s2_l12 -> expert_combine_s2_l12
	expert_33_s2_l12 -> expert_combine_s2_l12
	expert_34_s2_l12 -> expert_combine_s2_l12
	expert_35_s2_l12 -> expert_combine_s2_l12
	expert_36_s2_l12 -> expert_combine_s2_l12
	expert_37_s2_l12 -> expert_combine_s2_l12
	expert_38_s2_l12 -> expert_combine_s2_l12
	expert_39_s2_l12 -> expert_combine_s2_l12
	expert_40_s2_l12 -> expert_combine_s2_l12
	expert_41_s2_l12 -> expert_combine_s2_l12
	expert_42_s2_l12 -> expert_combine_s2_l12
	expert_43_s2_l12 -> expert_combine_s2_l12
	expert_44_s2_l12 -> expert_combine_s2_l12
	expert_45_s2_l12 -> expert_combine_s2_l12
	expert_46_s2_l12 -> expert_combine_s2_l12
	expert_47_s2_l12 -> expert_combine_s2_l12
	expert_48_s2_l12 -> expert_combine_s2_l12
	expert_49_s2_l12 -> expert_combine_s2_l12
	expert_50_s2_l12 -> expert_combine_s2_l12
	expert_51_s2_l12 -> expert_combine_s2_l12
	expert_52_s2_l12 -> expert_combine_s2_l12
	expert_53_s2_l12 -> expert_combine_s2_l12
	expert_54_s2_l12 -> expert_combine_s2_l12
	expert_55_s2_l12 -> expert_combine_s2_l12
	expert_56_s2_l12 -> expert_combine_s2_l12
	expert_57_s2_l12 -> expert_combine_s2_l12
	expert_58_s2_l12 -> expert_combine_s2_l12
	expert_59_s2_l12 -> expert_combine_s2_l12
	expert_60_s2_l12 -> expert_combine_s2_l12
	expert_61_s2_l12 -> expert_combine_s2_l12
	expert_62_s2_l12 -> expert_combine_s2_l12
	expert_63_s2_l12 -> expert_combine_s2_l12
	expert_combine_s2_l12 -> moe_out_proj_s2_l12
	moe_out_proj_s2_l12 -> allreduce_moe_out_s2_l12
	allreduce_moe_out_s2_l12 -> layernorm2_s2_l12
	layernorm2_s2_l12 -> layernorm1_s2_l13
	layernorm1_s2_l13 -> qkv_proj_s2_l13
	qkv_proj_s2_l13 -> allreduce_qkv_s2_l13
	allreduce_qkv_s2_l13 -> attention_s2_l13
	attention_s2_l13 -> attn_out_proj_s2_l13
	attn_out_proj_s2_l13 -> allreduce_attn_out_s2_l13
	allreduce_attn_out_s2_l13 -> moe_gate_s2_l13
	moe_gate_s2_l13 -> expert_dispatch_s2_l13 [style=dashed]
	expert_dispatch_s2_l13 -> expert_32_s2_l13
	expert_dispatch_s2_l13 -> expert_33_s2_l13
	expert_dispatch_s2_l13 -> expert_34_s2_l13
	expert_dispatch_s2_l13 -> expert_35_s2_l13
	expert_dispatch_s2_l13 -> expert_36_s2_l13
	expert_dispatch_s2_l13 -> expert_37_s2_l13
	expert_dispatch_s2_l13 -> expert_38_s2_l13
	expert_dispatch_s2_l13 -> expert_39_s2_l13
	expert_dispatch_s2_l13 -> expert_40_s2_l13
	expert_dispatch_s2_l13 -> expert_41_s2_l13
	expert_dispatch_s2_l13 -> expert_42_s2_l13
	expert_dispatch_s2_l13 -> expert_43_s2_l13
	expert_dispatch_s2_l13 -> expert_44_s2_l13
	expert_dispatch_s2_l13 -> expert_45_s2_l13
	expert_dispatch_s2_l13 -> expert_46_s2_l13
	expert_dispatch_s2_l13 -> expert_47_s2_l13
	expert_dispatch_s2_l13 -> expert_48_s2_l13
	expert_dispatch_s2_l13 -> expert_49_s2_l13
	expert_dispatch_s2_l13 -> expert_50_s2_l13
	expert_dispatch_s2_l13 -> expert_51_s2_l13
	expert_dispatch_s2_l13 -> expert_52_s2_l13
	expert_dispatch_s2_l13 -> expert_53_s2_l13
	expert_dispatch_s2_l13 -> expert_54_s2_l13
	expert_dispatch_s2_l13 -> expert_55_s2_l13
	expert_dispatch_s2_l13 -> expert_56_s2_l13
	expert_dispatch_s2_l13 -> expert_57_s2_l13
	expert_dispatch_s2_l13 -> expert_58_s2_l13
	expert_dispatch_s2_l13 -> expert_59_s2_l13
	expert_dispatch_s2_l13 -> expert_60_s2_l13
	expert_dispatch_s2_l13 -> expert_61_s2_l13
	expert_dispatch_s2_l13 -> expert_62_s2_l13
	expert_dispatch_s2_l13 -> expert_63_s2_l13
	expert_32_s2_l13 -> expert_combine_s2_l13
	expert_33_s2_l13 -> expert_combine_s2_l13
	expert_34_s2_l13 -> expert_combine_s2_l13
	expert_35_s2_l13 -> expert_combine_s2_l13
	expert_36_s2_l13 -> expert_combine_s2_l13
	expert_37_s2_l13 -> expert_combine_s2_l13
	expert_38_s2_l13 -> expert_combine_s2_l13
	expert_39_s2_l13 -> expert_combine_s2_l13
	expert_40_s2_l13 -> expert_combine_s2_l13
	expert_41_s2_l13 -> expert_combine_s2_l13
	expert_42_s2_l13 -> expert_combine_s2_l13
	expert_43_s2_l13 -> expert_combine_s2_l13
	expert_44_s2_l13 -> expert_combine_s2_l13
	expert_45_s2_l13 -> expert_combine_s2_l13
	expert_46_s2_l13 -> expert_combine_s2_l13
	expert_47_s2_l13 -> expert_combine_s2_l13
	expert_48_s2_l13 -> expert_combine_s2_l13
	expert_49_s2_l13 -> expert_combine_s2_l13
	expert_50_s2_l13 -> expert_combine_s2_l13
	expert_51_s2_l13 -> expert_combine_s2_l13
	expert_52_s2_l13 -> expert_combine_s2_l13
	expert_53_s2_l13 -> expert_combine_s2_l13
	expert_54_s2_l13 -> expert_combine_s2_l13
	expert_55_s2_l13 -> expert_combine_s2_l13
	expert_56_s2_l13 -> expert_combine_s2_l13
	expert_57_s2_l13 -> expert_combine_s2_l13
	expert_58_s2_l13 -> expert_combine_s2_l13
	expert_59_s2_l13 -> expert_combine_s2_l13
	expert_60_s2_l13 -> expert_combine_s2_l13
	expert_61_s2_l13 -> expert_combine_s2_l13
	expert_62_s2_l13 -> expert_combine_s2_l13
	expert_63_s2_l13 -> expert_combine_s2_l13
	expert_combine_s2_l13 -> moe_out_proj_s2_l13
	moe_out_proj_s2_l13 -> allreduce_moe_out_s2_l13
	allreduce_moe_out_s2_l13 -> layernorm2_s2_l13
	layernorm2_s2_l13 -> layernorm1_s2_l14
	layernorm1_s2_l14 -> qkv_proj_s2_l14
	qkv_proj_s2_l14 -> allreduce_qkv_s2_l14
	allreduce_qkv_s2_l14 -> attention_s2_l14
	attention_s2_l14 -> attn_out_proj_s2_l14
	attn_out_proj_s2_l14 -> allreduce_attn_out_s2_l14
	allreduce_attn_out_s2_l14 -> moe_gate_s2_l14
	moe_gate_s2_l14 -> expert_dispatch_s2_l14 [style=dashed]
	expert_dispatch_s2_l14 -> expert_32_s2_l14
	expert_dispatch_s2_l14 -> expert_33_s2_l14
	expert_dispatch_s2_l14 -> expert_34_s2_l14
	expert_dispatch_s2_l14 -> expert_35_s2_l14
	expert_dispatch_s2_l14 -> expert_36_s2_l14
	expert_dispatch_s2_l14 -> expert_37_s2_l14
	expert_dispatch_s2_l14 -> expert_38_s2_l14
	expert_dispatch_s2_l14 -> expert_39_s2_l14
	expert_dispatch_s2_l14 -> expert_40_s2_l14
	expert_dispatch_s2_l14 -> expert_41_s2_l14
	expert_dispatch_s2_l14 -> expert_42_s2_l14
	expert_dispatch_s2_l14 -> expert_43_s2_l14
	expert_dispatch_s2_l14 -> expert_44_s2_l14
	expert_dispatch_s2_l14 -> expert_45_s2_l14
	expert_dispatch_s2_l14 -> expert_46_s2_l14
	expert_dispatch_s2_l14 -> expert_47_s2_l14
	expert_dispatch_s2_l14 -> expert_48_s2_l14
	expert_dispatch_s2_l14 -> expert_49_s2_l14
	expert_dispatch_s2_l14 -> expert_50_s2_l14
	expert_dispatch_s2_l14 -> expert_51_s2_l14
	expert_dispatch_s2_l14 -> expert_52_s2_l14
	expert_dispatch_s2_l14 -> expert_53_s2_l14
	expert_dispatch_s2_l14 -> expert_54_s2_l14
	expert_dispatch_s2_l14 -> expert_55_s2_l14
	expert_dispatch_s2_l14 -> expert_56_s2_l14
	expert_dispatch_s2_l14 -> expert_57_s2_l14
	expert_dispatch_s2_l14 -> expert_58_s2_l14
	expert_dispatch_s2_l14 -> expert_59_s2_l14
	expert_dispatch_s2_l14 -> expert_60_s2_l14
	expert_dispatch_s2_l14 -> expert_61_s2_l14
	expert_dispatch_s2_l14 -> expert_62_s2_l14
	expert_dispatch_s2_l14 -> expert_63_s2_l14
	expert_32_s2_l14 -> expert_combine_s2_l14
	expert_33_s2_l14 -> expert_combine_s2_l14
	expert_34_s2_l14 -> expert_combine_s2_l14
	expert_35_s2_l14 -> expert_combine_s2_l14
	expert_36_s2_l14 -> expert_combine_s2_l14
	expert_37_s2_l14 -> expert_combine_s2_l14
	expert_38_s2_l14 -> expert_combine_s2_l14
	expert_39_s2_l14 -> expert_combine_s2_l14
	expert_40_s2_l14 -> expert_combine_s2_l14
	expert_41_s2_l14 -> expert_combine_s2_l14
	expert_42_s2_l14 -> expert_combine_s2_l14
	expert_43_s2_l14 -> expert_combine_s2_l14
	expert_44_s2_l14 -> expert_combine_s2_l14
	expert_45_s2_l14 -> expert_combine_s2_l14
	expert_46_s2_l14 -> expert_combine_s2_l14
	expert_47_s2_l14 -> expert_combine_s2_l14
	expert_48_s2_l14 -> expert_combine_s2_l14
	expert_49_s2_l14 -> expert_combine_s2_l14
	expert_50_s2_l14 -> expert_combine_s2_l14
	expert_51_s2_l14 -> expert_combine_s2_l14
	expert_52_s2_l14 -> expert_combine_s2_l14
	expert_53_s2_l14 -> expert_combine_s2_l14
	expert_54_s2_l14 -> expert_combine_s2_l14
	expert_55_s2_l14 -> expert_combine_s2_l14
	expert_56_s2_l14 -> expert_combine_s2_l14
	expert_57_s2_l14 -> expert_combine_s2_l14
	expert_58_s2_l14 -> expert_combine_s2_l14
	expert_59_s2_l14 -> expert_combine_s2_l14
	expert_60_s2_l14 -> expert_combine_s2_l14
	expert_61_s2_l14 -> expert_combine_s2_l14
	expert_62_s2_l14 -> expert_combine_s2_l14
	expert_63_s2_l14 -> expert_combine_s2_l14
	expert_combine_s2_l14 -> moe_out_proj_s2_l14
	moe_out_proj_s2_l14 -> allreduce_moe_out_s2_l14
	allreduce_moe_out_s2_l14 -> layernorm2_s2_l14
	layernorm2_s2_l14 -> layernorm1_s2_l15
	layernorm1_s2_l15 -> qkv_proj_s2_l15
	qkv_proj_s2_l15 -> allreduce_qkv_s2_l15
	allreduce_qkv_s2_l15 -> attention_s2_l15
	attention_s2_l15 -> attn_out_proj_s2_l15
	attn_out_proj_s2_l15 -> allreduce_attn_out_s2_l15
	allreduce_attn_out_s2_l15 -> moe_gate_s2_l15
	moe_gate_s2_l15 -> expert_dispatch_s2_l15 [style=dashed]
	expert_dispatch_s2_l15 -> expert_32_s2_l15
	expert_dispatch_s2_l15 -> expert_33_s2_l15
	expert_dispatch_s2_l15 -> expert_34_s2_l15
	expert_dispatch_s2_l15 -> expert_35_s2_l15
	expert_dispatch_s2_l15 -> expert_36_s2_l15
	expert_dispatch_s2_l15 -> expert_37_s2_l15
	expert_dispatch_s2_l15 -> expert_38_s2_l15
	expert_dispatch_s2_l15 -> expert_39_s2_l15
	expert_dispatch_s2_l15 -> expert_40_s2_l15
	expert_dispatch_s2_l15 -> expert_41_s2_l15
	expert_dispatch_s2_l15 -> expert_42_s2_l15
	expert_dispatch_s2_l15 -> expert_43_s2_l15
	expert_dispatch_s2_l15 -> expert_44_s2_l15
	expert_dispatch_s2_l15 -> expert_45_s2_l15
	expert_dispatch_s2_l15 -> expert_46_s2_l15
	expert_dispatch_s2_l15 -> expert_47_s2_l15
	expert_dispatch_s2_l15 -> expert_48_s2_l15
	expert_dispatch_s2_l15 -> expert_49_s2_l15
	expert_dispatch_s2_l15 -> expert_50_s2_l15
	expert_dispatch_s2_l15 -> expert_51_s2_l15
	expert_dispatch_s2_l15 -> expert_52_s2_l15
	expert_dispatch_s2_l15 -> expert_53_s2_l15
	expert_dispatch_s2_l15 -> expert_54_s2_l15
	expert_dispatch_s2_l15 -> expert_55_s2_l15
	expert_dispatch_s2_l15 -> expert_56_s2_l15
	expert_dispatch_s2_l15 -> expert_57_s2_l15
	expert_dispatch_s2_l15 -> expert_58_s2_l15
	expert_dispatch_s2_l15 -> expert_59_s2_l15
	expert_dispatch_s2_l15 -> expert_60_s2_l15
	expert_dispatch_s2_l15 -> expert_61_s2_l15
	expert_dispatch_s2_l15 -> expert_62_s2_l15
	expert_dispatch_s2_l15 -> expert_63_s2_l15
	expert_32_s2_l15 -> expert_combine_s2_l15
	expert_33_s2_l15 -> expert_combine_s2_l15
	expert_34_s2_l15 -> expert_combine_s2_l15
	expert_35_s2_l15 -> expert_combine_s2_l15
	expert_36_s2_l15 -> expert_combine_s2_l15
	expert_37_s2_l15 -> expert_combine_s2_l15
	expert_38_s2_l15 -> expert_combine_s2_l15
	expert_39_s2_l15 -> expert_combine_s2_l15
	expert_40_s2_l15 -> expert_combine_s2_l15
	expert_41_s2_l15 -> expert_combine_s2_l15
	expert_42_s2_l15 -> expert_combine_s2_l15
	expert_43_s2_l15 -> expert_combine_s2_l15
	expert_44_s2_l15 -> expert_combine_s2_l15
	expert_45_s2_l15 -> expert_combine_s2_l15
	expert_46_s2_l15 -> expert_combine_s2_l15
	expert_47_s2_l15 -> expert_combine_s2_l15
	expert_48_s2_l15 -> expert_combine_s2_l15
	expert_49_s2_l15 -> expert_combine_s2_l15
	expert_50_s2_l15 -> expert_combine_s2_l15
	expert_51_s2_l15 -> expert_combine_s2_l15
	expert_52_s2_l15 -> expert_combine_s2_l15
	expert_53_s2_l15 -> expert_combine_s2_l15
	expert_54_s2_l15 -> expert_combine_s2_l15
	expert_55_s2_l15 -> expert_combine_s2_l15
	expert_56_s2_l15 -> expert_combine_s2_l15
	expert_57_s2_l15 -> expert_combine_s2_l15
	expert_58_s2_l15 -> expert_combine_s2_l15
	expert_59_s2_l15 -> expert_combine_s2_l15
	expert_60_s2_l15 -> expert_combine_s2_l15
	expert_61_s2_l15 -> expert_combine_s2_l15
	expert_62_s2_l15 -> expert_combine_s2_l15
	expert_63_s2_l15 -> expert_combine_s2_l15
	expert_combine_s2_l15 -> moe_out_proj_s2_l15
	moe_out_proj_s2_l15 -> allreduce_moe_out_s2_l15
	allreduce_moe_out_s2_l15 -> layernorm2_s2_l15
	layernorm2_s2_l15 -> output
}
