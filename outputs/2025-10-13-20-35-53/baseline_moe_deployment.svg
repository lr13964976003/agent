<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_deployment Pages: 1 -->
<svg width="15458pt" height="5070pt"
 viewBox="0.00 0.00 15457.90 5070.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5066.33)">
<title>baseline_moe_deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5066.33 15453.9,-5066.33 15453.9,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="7236.95" cy="-5014.25" rx="291.16" ry="48.17"/>
<text text-anchor="middle" x="7236.95" y="-5033.05" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="7236.95" y="-5018.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="7236.95" y="-5003.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="7236.95" y="-4988.05" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_qkv_l0_g0 -->
<g id="node2" class="node">
<title>mha_qkv_l0_g0</title>
<polygon fill="lightcoral" stroke="black" points="3421.95,-4930.17 2949.95,-4930.17 2949.95,-4847.17 3421.95,-4847.17 3421.95,-4930.17"/>
<text text-anchor="middle" x="3185.95" y="-4914.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 0</text>
<text text-anchor="middle" x="3185.95" y="-4899.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3185.95" y="-4884.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3185.95" y="-4869.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="3185.95" y="-4854.97" font-family="Times,serif" font-size="14.00">Type: Column&#45;parallel</text>
</g>
<!-- input&#45;&gt;mha_qkv_l0_g0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_qkv_l0_g0</title>
<path fill="none" stroke="black" d="M6971.15,-5034C6069.91,-5034 3185.95,-5034 3185.95,-5034 3185.95,-5034 3185.95,-4940.31 3185.95,-4940.31"/>
<polygon fill="black" stroke="black" points="3189.45,-4940.31 3185.95,-4930.31 3182.45,-4940.31 3189.45,-4940.31"/>
</g>
<!-- mha_qkv_l0_g1 -->
<g id="node5" class="node">
<title>mha_qkv_l0_g1</title>
<polygon fill="lightcoral" stroke="black" points="4294.95,-4930.17 3822.95,-4930.17 3822.95,-4847.17 4294.95,-4847.17 4294.95,-4930.17"/>
<text text-anchor="middle" x="4058.95" y="-4914.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 0</text>
<text text-anchor="middle" x="4058.95" y="-4899.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="4058.95" y="-4884.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4058.95" y="-4869.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="4058.95" y="-4854.97" font-family="Times,serif" font-size="14.00">Type: Column&#45;parallel</text>
</g>
<!-- input&#45;&gt;mha_qkv_l0_g1 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;mha_qkv_l0_g1</title>
<path fill="none" stroke="black" d="M6948.26,-5021C6165.13,-5021 4058.95,-5021 4058.95,-5021 4058.95,-5021 4058.95,-4940.17 4058.95,-4940.17"/>
<polygon fill="black" stroke="black" points="4062.45,-4940.17 4058.95,-4930.17 4055.45,-4940.17 4062.45,-4940.17"/>
</g>
<!-- mha_qkv_l0_g2 -->
<g id="node8" class="node">
<title>mha_qkv_l0_g2</title>
<polygon fill="lightcoral" stroke="black" points="6602.95,-4930.17 6130.95,-4930.17 6130.95,-4847.17 6602.95,-4847.17 6602.95,-4930.17"/>
<text text-anchor="middle" x="6366.95" y="-4914.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 0</text>
<text text-anchor="middle" x="6366.95" y="-4899.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6366.95" y="-4884.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6366.95" y="-4869.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6366.95" y="-4854.97" font-family="Times,serif" font-size="14.00">Type: Column&#45;parallel</text>
</g>
<!-- input&#45;&gt;mha_qkv_l0_g2 -->
<g id="edge13" class="edge">
<title>input&#45;&gt;mha_qkv_l0_g2</title>
<path fill="none" stroke="black" d="M7038.72,-4979C6781.97,-4979 6366.95,-4979 6366.95,-4979 6366.95,-4979 6366.95,-4940.4 6366.95,-4940.4"/>
<polygon fill="black" stroke="black" points="6370.45,-4940.4 6366.95,-4930.4 6363.45,-4940.4 6370.45,-4940.4"/>
</g>
<!-- mha_qkv_l0_g3 -->
<g id="node11" class="node">
<title>mha_qkv_l0_g3</title>
<polygon fill="lightcoral" stroke="black" points="7189.95,-4930.17 6717.95,-4930.17 6717.95,-4847.17 7189.95,-4847.17 7189.95,-4930.17"/>
<text text-anchor="middle" x="6953.95" y="-4914.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 0</text>
<text text-anchor="middle" x="6953.95" y="-4899.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6953.95" y="-4884.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6953.95" y="-4869.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6953.95" y="-4854.97" font-family="Times,serif" font-size="14.00">Type: Column&#45;parallel</text>
</g>
<!-- input&#45;&gt;mha_qkv_l0_g3 -->
<g id="edge19" class="edge">
<title>input&#45;&gt;mha_qkv_l0_g3</title>
<path fill="none" stroke="black" d="M7067.79,-4974.86C7067.79,-4974.86 7067.79,-4940.52 7067.79,-4940.52"/>
<polygon fill="black" stroke="black" points="7071.29,-4940.52 7067.79,-4930.52 7064.29,-4940.52 7071.29,-4940.52"/>
</g>
<!-- mha_qkv_l0_g4 -->
<g id="node14" class="node">
<title>mha_qkv_l0_g4</title>
<polygon fill="lightcoral" stroke="black" points="7850.95,-4930.17 7378.95,-4930.17 7378.95,-4847.17 7850.95,-4847.17 7850.95,-4930.17"/>
<text text-anchor="middle" x="7614.95" y="-4914.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 0</text>
<text text-anchor="middle" x="7614.95" y="-4899.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7614.95" y="-4884.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="7614.95" y="-4869.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="7614.95" y="-4854.97" font-family="Times,serif" font-size="14.00">Type: Column&#45;parallel</text>
</g>
<!-- input&#45;&gt;mha_qkv_l0_g4 -->
<g id="edge25" class="edge">
<title>input&#45;&gt;mha_qkv_l0_g4</title>
<path fill="none" stroke="black" d="M7453.61,-4981.91C7453.61,-4981.91 7453.61,-4940.39 7453.61,-4940.39"/>
<polygon fill="black" stroke="black" points="7457.11,-4940.39 7453.61,-4930.39 7450.11,-4940.39 7457.11,-4940.39"/>
</g>
<!-- mha_qkv_l0_g5 -->
<g id="node17" class="node">
<title>mha_qkv_l0_g5</title>
<polygon fill="lightcoral" stroke="black" points="8579.95,-4930.17 8107.95,-4930.17 8107.95,-4847.17 8579.95,-4847.17 8579.95,-4930.17"/>
<text text-anchor="middle" x="8343.95" y="-4914.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 0</text>
<text text-anchor="middle" x="8343.95" y="-4899.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="8343.95" y="-4884.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8343.95" y="-4869.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8343.95" y="-4854.97" font-family="Times,serif" font-size="14.00">Type: Column&#45;parallel</text>
</g>
<!-- input&#45;&gt;mha_qkv_l0_g5 -->
<g id="edge31" class="edge">
<title>input&#45;&gt;mha_qkv_l0_g5</title>
<path fill="none" stroke="black" d="M7435.18,-4979C7753.67,-4979 8343.95,-4979 8343.95,-4979 8343.95,-4979 8343.95,-4940.4 8343.95,-4940.4"/>
<polygon fill="black" stroke="black" points="8347.45,-4940.4 8343.95,-4930.4 8340.45,-4940.4 8347.45,-4940.4"/>
</g>
<!-- mha_qkv_l0_g6 -->
<g id="node20" class="node">
<title>mha_qkv_l0_g6</title>
<polygon fill="lightcoral" stroke="black" points="10292.95,-4930.17 9820.95,-4930.17 9820.95,-4847.17 10292.95,-4847.17 10292.95,-4930.17"/>
<text text-anchor="middle" x="10056.95" y="-4914.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 0</text>
<text text-anchor="middle" x="10056.95" y="-4899.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10056.95" y="-4884.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10056.95" y="-4869.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10056.95" y="-4854.97" font-family="Times,serif" font-size="14.00">Type: Column&#45;parallel</text>
</g>
<!-- input&#45;&gt;mha_qkv_l0_g6 -->
<g id="edge37" class="edge">
<title>input&#45;&gt;mha_qkv_l0_g6</title>
<path fill="none" stroke="black" d="M7525.16,-5007C8243.66,-5007 10056.95,-5007 10056.95,-5007 10056.95,-5007 10056.95,-4940.39 10056.95,-4940.39"/>
<polygon fill="black" stroke="black" points="10060.45,-4940.39 10056.95,-4930.39 10053.45,-4940.39 10060.45,-4940.39"/>
</g>
<!-- mha_qkv_l0_g7 -->
<g id="node23" class="node">
<title>mha_qkv_l0_g7</title>
<polygon fill="lightcoral" stroke="black" points="11176.95,-4930.17 10704.95,-4930.17 10704.95,-4847.17 11176.95,-4847.17 11176.95,-4930.17"/>
<text text-anchor="middle" x="10940.95" y="-4914.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 0</text>
<text text-anchor="middle" x="10940.95" y="-4899.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="10940.95" y="-4884.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10940.95" y="-4869.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10940.95" y="-4854.97" font-family="Times,serif" font-size="14.00">Type: Column&#45;parallel</text>
</g>
<!-- input&#45;&gt;mha_qkv_l0_g7 -->
<g id="edge43" class="edge">
<title>input&#45;&gt;mha_qkv_l0_g7</title>
<path fill="none" stroke="black" d="M7525.67,-5021C8397.04,-5021 10940.95,-5021 10940.95,-5021 10940.95,-5021 10940.95,-4940.17 10940.95,-4940.17"/>
<polygon fill="black" stroke="black" points="10944.45,-4940.17 10940.95,-4930.17 10937.45,-4940.17 10944.45,-4940.17"/>
</g>
<!-- residual_l0_g0 -->
<g id="node27" class="node">
<title>residual_l0_g0</title>
<polygon fill="lightyellow" stroke="black" points="1782.24,-4386.17 1102.52,-4386.17 927.67,-4190.17 1607.38,-4190.17 1782.24,-4386.17"/>
<text text-anchor="middle" x="1354.95" y="-4321.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1354.95" y="-4306.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="1354.95" y="-4291.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1354.95" y="-4276.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1354.95" y="-4261.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1354.95" y="-4246.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- input&#45;&gt;residual_l0_g0 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;residual_l0_g0</title>
<path fill="none" stroke="black" d="M7029.34,-5048C5984.89,-5048 1354.95,-5048 1354.95,-5048 1354.95,-5048 1354.95,-4396.33 1354.95,-4396.33"/>
<polygon fill="black" stroke="black" points="1358.45,-4396.33 1354.95,-4386.33 1351.45,-4396.33 1358.45,-4396.33"/>
</g>
<!-- residual_l0_g1 -->
<g id="node29" class="node">
<title>residual_l0_g1</title>
<polygon fill="lightyellow" stroke="black" points="3735.24,-4386.17 3055.52,-4386.17 2880.67,-4190.17 3560.38,-4190.17 3735.24,-4386.17"/>
<text text-anchor="middle" x="3307.95" y="-4321.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3307.95" y="-4306.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="3307.95" y="-4291.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3307.95" y="-4276.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3307.95" y="-4261.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3307.95" y="-4246.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- input&#45;&gt;residual_l0_g1 -->
<g id="edge11" class="edge">
<title>input&#45;&gt;residual_l0_g1</title>
<path fill="none" stroke="black" d="M6948.82,-5007C6239.94,-5007 4468.38,-5007 4468.38,-5007 4468.38,-5007 4468.38,-4320 4468.38,-4320 4468.38,-4320 3686.31,-4320 3686.31,-4320"/>
<polygon fill="black" stroke="black" points="3686.31,-4316.5 3676.31,-4320 3686.31,-4323.5 3686.31,-4316.5"/>
</g>
<!-- residual_l0_g2 -->
<g id="node31" class="node">
<title>residual_l0_g2</title>
<polygon fill="lightyellow" stroke="black" points="5496.24,-4386.17 4816.52,-4386.17 4641.67,-4190.17 5321.38,-4190.17 5496.24,-4386.17"/>
<text text-anchor="middle" x="5068.95" y="-4321.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5068.95" y="-4306.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="5068.95" y="-4291.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5068.95" y="-4276.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5068.95" y="-4261.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5068.95" y="-4246.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- input&#45;&gt;residual_l0_g2 -->
<g id="edge17" class="edge">
<title>input&#45;&gt;residual_l0_g2</title>
<path fill="none" stroke="black" d="M6975.59,-4993C6384.67,-4993 4996.81,-4993 4996.81,-4993 4996.81,-4993 4996.81,-4396.17 4996.81,-4396.17"/>
<polygon fill="black" stroke="black" points="5000.31,-4396.17 4996.81,-4386.17 4993.31,-4396.17 5000.31,-4396.17"/>
</g>
<!-- residual_l0_g3 -->
<g id="node33" class="node">
<title>residual_l0_g3</title>
<polygon fill="lightyellow" stroke="black" points="7150.24,-4386.17 6470.52,-4386.17 6295.67,-4190.17 6975.38,-4190.17 7150.24,-4386.17"/>
<text text-anchor="middle" x="6722.95" y="-4321.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6722.95" y="-4306.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="6722.95" y="-4291.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6722.95" y="-4276.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6722.95" y="-4261.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6722.95" y="-4246.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- input&#45;&gt;residual_l0_g3 -->
<g id="edge23" class="edge">
<title>input&#45;&gt;residual_l0_g3</title>
<path fill="none" stroke="black" d="M7221.24,-4965.98C7221.24,-4808.54 7221.24,-4320 7221.24,-4320 7221.24,-4320 7101.29,-4320 7101.29,-4320"/>
<polygon fill="black" stroke="black" points="7101.29,-4316.5 7091.29,-4320 7101.29,-4323.5 7101.29,-4316.5"/>
</g>
<!-- residual_l0_g4 -->
<g id="node35" class="node">
<title>residual_l0_g4</title>
<polygon fill="lightyellow" stroke="black" points="8138.24,-4386.17 7458.52,-4386.17 7283.67,-4190.17 7963.38,-4190.17 8138.24,-4386.17"/>
<text text-anchor="middle" x="7710.95" y="-4321.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7710.95" y="-4306.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="7710.95" y="-4291.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7710.95" y="-4276.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="7710.95" y="-4261.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="7710.95" y="-4246.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- input&#45;&gt;residual_l0_g4 -->
<g id="edge29" class="edge">
<title>input&#45;&gt;residual_l0_g4</title>
<path fill="none" stroke="black" d="M7252.52,-4966.18C7252.52,-4799.28 7252.52,-4255 7252.52,-4255 7252.52,-4255 7331.46,-4255 7331.46,-4255"/>
<polygon fill="black" stroke="black" points="7331.46,-4258.5 7341.46,-4255 7331.46,-4251.5 7331.46,-4258.5"/>
</g>
<!-- residual_l0_g5 -->
<g id="node37" class="node">
<title>residual_l0_g5</title>
<polygon fill="lightyellow" stroke="black" points="9954.24,-4386.17 9274.52,-4386.17 9099.67,-4190.17 9779.38,-4190.17 9954.24,-4386.17"/>
<text text-anchor="middle" x="9526.95" y="-4321.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9526.95" y="-4306.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="9526.95" y="-4291.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="9526.95" y="-4276.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="9526.95" y="-4261.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="9526.95" y="-4246.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- input&#45;&gt;residual_l0_g5 -->
<g id="edge35" class="edge">
<title>input&#45;&gt;residual_l0_g5</title>
<path fill="none" stroke="black" d="M7498.4,-4993C8102.33,-4993 9543.02,-4993 9543.02,-4993 9543.02,-4993 9543.02,-4396.17 9543.02,-4396.17"/>
<polygon fill="black" stroke="black" points="9546.52,-4396.17 9543.02,-4386.17 9539.52,-4396.17 9546.52,-4396.17"/>
</g>
<!-- residual_l0_g6 -->
<g id="node39" class="node">
<title>residual_l0_g6</title>
<polygon fill="lightyellow" stroke="black" points="11791.24,-4386.17 11111.52,-4386.17 10936.67,-4190.17 11616.38,-4190.17 11791.24,-4386.17"/>
<text text-anchor="middle" x="11363.95" y="-4321.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11363.95" y="-4306.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="11363.95" y="-4291.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11363.95" y="-4276.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="11363.95" y="-4261.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="11363.95" y="-4246.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- input&#45;&gt;residual_l0_g6 -->
<g id="edge41" class="edge">
<title>input&#45;&gt;residual_l0_g6</title>
<path fill="none" stroke="black" d="M7502.95,-5034C8397,-5034 11237.95,-5034 11237.95,-5034 11237.95,-5034 11237.95,-4396.44 11237.95,-4396.44"/>
<polygon fill="black" stroke="black" points="11241.45,-4396.44 11237.95,-4386.44 11234.45,-4396.44 11241.45,-4396.44"/>
</g>
<!-- residual_l0_g7 -->
<g id="node41" class="node">
<title>residual_l0_g7</title>
<polygon fill="lightyellow" stroke="black" points="13625.24,-4386.17 12945.52,-4386.17 12770.67,-4190.17 13450.38,-4190.17 13625.24,-4386.17"/>
<text text-anchor="middle" x="13197.95" y="-4321.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13197.95" y="-4306.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="13197.95" y="-4291.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13197.95" y="-4276.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="13197.95" y="-4261.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="13197.95" y="-4246.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- input&#45;&gt;residual_l0_g7 -->
<g id="edge47" class="edge">
<title>input&#45;&gt;residual_l0_g7</title>
<path fill="none" stroke="black" d="M7444.74,-5048C8498.08,-5048 13197.95,-5048 13197.95,-5048 13197.95,-5048 13197.95,-4396.33 13197.95,-4396.33"/>
<polygon fill="black" stroke="black" points="13201.45,-4396.33 13197.95,-4386.33 13194.45,-4396.33 13201.45,-4396.33"/>
</g>
<!-- mha_attn_l0_g0 -->
<g id="node3" class="node">
<title>mha_attn_l0_g0</title>
<polygon fill="lightcoral" stroke="black" points="3287.95,-4811.17 2815.95,-4811.17 2815.95,-4743.17 3287.95,-4743.17 3287.95,-4811.17"/>
<text text-anchor="middle" x="3051.95" y="-4795.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 0</text>
<text text-anchor="middle" x="3051.95" y="-4780.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3051.95" y="-4765.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="3051.95" y="-4750.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l0_g0&#45;&gt;mha_attn_l0_g0 -->
<g id="edge2" class="edge">
<title>mha_qkv_l0_g0&#45;&gt;mha_attn_l0_g0</title>
<path fill="none" stroke="black" d="M3118.95,-4847.15C3118.95,-4847.15 3118.95,-4821.43 3118.95,-4821.43"/>
<polygon fill="black" stroke="black" points="3122.45,-4821.43 3118.95,-4811.43 3115.45,-4821.43 3122.45,-4821.43"/>
</g>
<!-- mha_out_l0_g0 -->
<g id="node4" class="node">
<title>mha_out_l0_g0</title>
<polygon fill="lightcoral" stroke="black" points="2985.95,-4707.17 2525.95,-4707.17 2525.95,-4624.17 2985.95,-4624.17 2985.95,-4707.17"/>
<text text-anchor="middle" x="2755.95" y="-4691.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 0</text>
<text text-anchor="middle" x="2755.95" y="-4676.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2755.95" y="-4661.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="2755.95" y="-4646.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="2755.95" y="-4631.97" font-family="Times,serif" font-size="14.00">Type: Row&#45;parallel</text>
</g>
<!-- mha_attn_l0_g0&#45;&gt;mha_out_l0_g0 -->
<g id="edge3" class="edge">
<title>mha_attn_l0_g0&#45;&gt;mha_out_l0_g0</title>
<path fill="none" stroke="black" d="M2900.95,-4743.11C2900.95,-4743.11 2900.95,-4717.38 2900.95,-4717.38"/>
<polygon fill="black" stroke="black" points="2904.45,-4717.38 2900.95,-4707.38 2897.45,-4717.38 2904.45,-4717.38"/>
</g>
<!-- allreduce_l0_g0 -->
<g id="node26" class="node">
<title>allreduce_l0_g0</title>
<polygon fill="lightyellow" stroke="black" points="3055.24,-4588.17 2375.52,-4588.17 2200.67,-4422.17 2880.38,-4422.17 3055.24,-4588.17"/>
<text text-anchor="middle" x="2627.95" y="-4531.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="2627.95" y="-4516.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="2627.95" y="-4501.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2627.95" y="-4486.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="2627.95" y="-4471.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l0_g0&#45;&gt;allreduce_l0_g0 -->
<g id="edge4" class="edge">
<title>mha_out_l0_g0&#45;&gt;allreduce_l0_g0</title>
<path fill="none" stroke="black" d="M2755.95,-4623.92C2755.95,-4623.92 2755.95,-4598.43 2755.95,-4598.43"/>
<polygon fill="black" stroke="black" points="2759.45,-4598.43 2755.95,-4588.43 2752.45,-4598.43 2759.45,-4598.43"/>
</g>
<!-- mha_attn_l0_g1 -->
<g id="node6" class="node">
<title>mha_attn_l0_g1</title>
<polygon fill="lightcoral" stroke="black" points="4034.95,-4811.17 3562.95,-4811.17 3562.95,-4743.17 4034.95,-4743.17 4034.95,-4811.17"/>
<text text-anchor="middle" x="3798.95" y="-4795.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 0</text>
<text text-anchor="middle" x="3798.95" y="-4780.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3798.95" y="-4765.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="3798.95" y="-4750.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l0_g1&#45;&gt;mha_attn_l0_g1 -->
<g id="edge8" class="edge">
<title>mha_qkv_l0_g1&#45;&gt;mha_attn_l0_g1</title>
<path fill="none" stroke="black" d="M3928.95,-4847.15C3928.95,-4847.15 3928.95,-4821.43 3928.95,-4821.43"/>
<polygon fill="black" stroke="black" points="3932.45,-4821.43 3928.95,-4811.43 3925.45,-4821.43 3932.45,-4821.43"/>
</g>
<!-- mha_out_l0_g1 -->
<g id="node7" class="node">
<title>mha_out_l0_g1</title>
<polygon fill="lightcoral" stroke="black" points="3972.95,-4707.17 3512.95,-4707.17 3512.95,-4624.17 3972.95,-4624.17 3972.95,-4707.17"/>
<text text-anchor="middle" x="3742.95" y="-4691.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 0</text>
<text text-anchor="middle" x="3742.95" y="-4676.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3742.95" y="-4661.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="3742.95" y="-4646.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="3742.95" y="-4631.97" font-family="Times,serif" font-size="14.00">Type: Row&#45;parallel</text>
</g>
<!-- mha_attn_l0_g1&#45;&gt;mha_out_l0_g1 -->
<g id="edge9" class="edge">
<title>mha_attn_l0_g1&#45;&gt;mha_out_l0_g1</title>
<path fill="none" stroke="black" d="M3767.95,-4743.11C3767.95,-4743.11 3767.95,-4717.38 3767.95,-4717.38"/>
<polygon fill="black" stroke="black" points="3771.45,-4717.38 3767.95,-4707.38 3764.45,-4717.38 3771.45,-4717.38"/>
</g>
<!-- allreduce_l0_g1 -->
<g id="node28" class="node">
<title>allreduce_l0_g1</title>
<polygon fill="lightyellow" stroke="black" points="4059.24,-4588.17 3379.52,-4588.17 3204.67,-4422.17 3884.38,-4422.17 4059.24,-4588.17"/>
<text text-anchor="middle" x="3631.95" y="-4531.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="3631.95" y="-4516.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="3631.95" y="-4501.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3631.95" y="-4486.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="3631.95" y="-4471.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l0_g1&#45;&gt;allreduce_l0_g1 -->
<g id="edge10" class="edge">
<title>mha_out_l0_g1&#45;&gt;allreduce_l0_g1</title>
<path fill="none" stroke="black" d="M3742.95,-4623.92C3742.95,-4623.92 3742.95,-4598.43 3742.95,-4598.43"/>
<polygon fill="black" stroke="black" points="3746.45,-4598.43 3742.95,-4588.43 3739.45,-4598.43 3746.45,-4598.43"/>
</g>
<!-- mha_attn_l0_g2 -->
<g id="node9" class="node">
<title>mha_attn_l0_g2</title>
<polygon fill="lightcoral" stroke="black" points="6504.95,-4811.17 6032.95,-4811.17 6032.95,-4743.17 6504.95,-4743.17 6504.95,-4811.17"/>
<text text-anchor="middle" x="6268.95" y="-4795.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 0</text>
<text text-anchor="middle" x="6268.95" y="-4780.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6268.95" y="-4765.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6268.95" y="-4750.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l0_g2&#45;&gt;mha_attn_l0_g2 -->
<g id="edge14" class="edge">
<title>mha_qkv_l0_g2&#45;&gt;mha_attn_l0_g2</title>
<path fill="none" stroke="black" d="M6317.95,-4847.15C6317.95,-4847.15 6317.95,-4821.43 6317.95,-4821.43"/>
<polygon fill="black" stroke="black" points="6321.45,-4821.43 6317.95,-4811.43 6314.45,-4821.43 6321.45,-4821.43"/>
</g>
<!-- mha_out_l0_g2 -->
<g id="node10" class="node">
<title>mha_out_l0_g2</title>
<polygon fill="lightcoral" stroke="black" points="6156.95,-4707.17 5696.95,-4707.17 5696.95,-4624.17 6156.95,-4624.17 6156.95,-4707.17"/>
<text text-anchor="middle" x="5926.95" y="-4691.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 0</text>
<text text-anchor="middle" x="5926.95" y="-4676.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5926.95" y="-4661.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="5926.95" y="-4646.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="5926.95" y="-4631.97" font-family="Times,serif" font-size="14.00">Type: Row&#45;parallel</text>
</g>
<!-- mha_attn_l0_g2&#45;&gt;mha_out_l0_g2 -->
<g id="edge15" class="edge">
<title>mha_attn_l0_g2&#45;&gt;mha_out_l0_g2</title>
<path fill="none" stroke="black" d="M6094.95,-4743.11C6094.95,-4743.11 6094.95,-4717.38 6094.95,-4717.38"/>
<polygon fill="black" stroke="black" points="6098.45,-4717.38 6094.95,-4707.38 6091.45,-4717.38 6098.45,-4717.38"/>
</g>
<!-- allreduce_l0_g2 -->
<g id="node30" class="node">
<title>allreduce_l0_g2</title>
<polygon fill="lightyellow" stroke="black" points="6206.24,-4588.17 5526.52,-4588.17 5351.67,-4422.17 6031.38,-4422.17 6206.24,-4588.17"/>
<text text-anchor="middle" x="5778.95" y="-4531.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="5778.95" y="-4516.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="5778.95" y="-4501.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5778.95" y="-4486.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="5778.95" y="-4471.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l0_g2&#45;&gt;allreduce_l0_g2 -->
<g id="edge16" class="edge">
<title>mha_out_l0_g2&#45;&gt;allreduce_l0_g2</title>
<path fill="none" stroke="black" d="M5926.95,-4623.92C5926.95,-4623.92 5926.95,-4598.43 5926.95,-4598.43"/>
<polygon fill="black" stroke="black" points="5930.45,-4598.43 5926.95,-4588.43 5923.45,-4598.43 5930.45,-4598.43"/>
</g>
<!-- mha_attn_l0_g3 -->
<g id="node12" class="node">
<title>mha_attn_l0_g3</title>
<polygon fill="lightcoral" stroke="black" points="7141.95,-4811.17 6669.95,-4811.17 6669.95,-4743.17 7141.95,-4743.17 7141.95,-4811.17"/>
<text text-anchor="middle" x="6905.95" y="-4795.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 0</text>
<text text-anchor="middle" x="6905.95" y="-4780.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6905.95" y="-4765.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6905.95" y="-4750.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l0_g3&#45;&gt;mha_attn_l0_g3 -->
<g id="edge20" class="edge">
<title>mha_qkv_l0_g3&#45;&gt;mha_attn_l0_g3</title>
<path fill="none" stroke="black" d="M6929.95,-4847.15C6929.95,-4847.15 6929.95,-4821.43 6929.95,-4821.43"/>
<polygon fill="black" stroke="black" points="6933.45,-4821.43 6929.95,-4811.43 6926.45,-4821.43 6933.45,-4821.43"/>
</g>
<!-- mha_out_l0_g3 -->
<g id="node13" class="node">
<title>mha_out_l0_g3</title>
<polygon fill="lightcoral" stroke="black" points="7039.95,-4707.17 6579.95,-4707.17 6579.95,-4624.17 7039.95,-4624.17 7039.95,-4707.17"/>
<text text-anchor="middle" x="6809.95" y="-4691.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 0</text>
<text text-anchor="middle" x="6809.95" y="-4676.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6809.95" y="-4661.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6809.95" y="-4646.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="6809.95" y="-4631.97" font-family="Times,serif" font-size="14.00">Type: Row&#45;parallel</text>
</g>
<!-- mha_attn_l0_g3&#45;&gt;mha_out_l0_g3 -->
<g id="edge21" class="edge">
<title>mha_attn_l0_g3&#45;&gt;mha_out_l0_g3</title>
<path fill="none" stroke="black" d="M6854.95,-4743.11C6854.95,-4743.11 6854.95,-4717.38 6854.95,-4717.38"/>
<polygon fill="black" stroke="black" points="6858.45,-4717.38 6854.95,-4707.38 6851.45,-4717.38 6858.45,-4717.38"/>
</g>
<!-- allreduce_l0_g3 -->
<g id="node32" class="node">
<title>allreduce_l0_g3</title>
<polygon fill="lightyellow" stroke="black" points="7189.24,-4588.17 6509.52,-4588.17 6334.67,-4422.17 7014.38,-4422.17 7189.24,-4588.17"/>
<text text-anchor="middle" x="6761.95" y="-4531.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="6761.95" y="-4516.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="6761.95" y="-4501.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6761.95" y="-4486.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="6761.95" y="-4471.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l0_g3&#45;&gt;allreduce_l0_g3 -->
<g id="edge22" class="edge">
<title>mha_out_l0_g3&#45;&gt;allreduce_l0_g3</title>
<path fill="none" stroke="black" d="M6809.95,-4623.92C6809.95,-4623.92 6809.95,-4598.43 6809.95,-4598.43"/>
<polygon fill="black" stroke="black" points="6813.45,-4598.43 6809.95,-4588.43 6806.45,-4598.43 6813.45,-4598.43"/>
</g>
<!-- mha_attn_l0_g4 -->
<g id="node15" class="node">
<title>mha_attn_l0_g4</title>
<polygon fill="lightcoral" stroke="black" points="7874.95,-4811.17 7402.95,-4811.17 7402.95,-4743.17 7874.95,-4743.17 7874.95,-4811.17"/>
<text text-anchor="middle" x="7638.95" y="-4795.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 0</text>
<text text-anchor="middle" x="7638.95" y="-4780.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7638.95" y="-4765.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="7638.95" y="-4750.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l0_g4&#45;&gt;mha_attn_l0_g4 -->
<g id="edge26" class="edge">
<title>mha_qkv_l0_g4&#45;&gt;mha_attn_l0_g4</title>
<path fill="none" stroke="black" d="M7626.95,-4847.15C7626.95,-4847.15 7626.95,-4821.43 7626.95,-4821.43"/>
<polygon fill="black" stroke="black" points="7630.45,-4821.43 7626.95,-4811.43 7623.45,-4821.43 7630.45,-4821.43"/>
</g>
<!-- mha_out_l0_g4 -->
<g id="node16" class="node">
<title>mha_out_l0_g4</title>
<polygon fill="lightcoral" stroke="black" points="7892.95,-4707.17 7432.95,-4707.17 7432.95,-4624.17 7892.95,-4624.17 7892.95,-4707.17"/>
<text text-anchor="middle" x="7662.95" y="-4691.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 0</text>
<text text-anchor="middle" x="7662.95" y="-4676.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7662.95" y="-4661.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="7662.95" y="-4646.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="7662.95" y="-4631.97" font-family="Times,serif" font-size="14.00">Type: Row&#45;parallel</text>
</g>
<!-- mha_attn_l0_g4&#45;&gt;mha_out_l0_g4 -->
<g id="edge27" class="edge">
<title>mha_attn_l0_g4&#45;&gt;mha_out_l0_g4</title>
<path fill="none" stroke="black" d="M7653.95,-4743.11C7653.95,-4743.11 7653.95,-4717.38 7653.95,-4717.38"/>
<polygon fill="black" stroke="black" points="7657.45,-4717.38 7653.95,-4707.38 7650.45,-4717.38 7657.45,-4717.38"/>
</g>
<!-- allreduce_l0_g4 -->
<g id="node34" class="node">
<title>allreduce_l0_g4</title>
<polygon fill="lightyellow" stroke="black" points="8138.24,-4588.17 7458.52,-4588.17 7283.67,-4422.17 7963.38,-4422.17 8138.24,-4588.17"/>
<text text-anchor="middle" x="7710.95" y="-4531.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="7710.95" y="-4516.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="7710.95" y="-4501.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7710.95" y="-4486.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="7710.95" y="-4471.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l0_g4&#45;&gt;allreduce_l0_g4 -->
<g id="edge28" class="edge">
<title>mha_out_l0_g4&#45;&gt;allreduce_l0_g4</title>
<path fill="none" stroke="black" d="M7662.95,-4623.92C7662.95,-4623.92 7662.95,-4598.43 7662.95,-4598.43"/>
<polygon fill="black" stroke="black" points="7666.45,-4598.43 7662.95,-4588.43 7659.45,-4598.43 7666.45,-4598.43"/>
</g>
<!-- mha_attn_l0_g5 -->
<g id="node18" class="node">
<title>mha_attn_l0_g5</title>
<polygon fill="lightcoral" stroke="black" points="8703.95,-4811.17 8231.95,-4811.17 8231.95,-4743.17 8703.95,-4743.17 8703.95,-4811.17"/>
<text text-anchor="middle" x="8467.95" y="-4795.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 0</text>
<text text-anchor="middle" x="8467.95" y="-4780.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="8467.95" y="-4765.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8467.95" y="-4750.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l0_g5&#45;&gt;mha_attn_l0_g5 -->
<g id="edge32" class="edge">
<title>mha_qkv_l0_g5&#45;&gt;mha_attn_l0_g5</title>
<path fill="none" stroke="black" d="M8405.95,-4847.15C8405.95,-4847.15 8405.95,-4821.43 8405.95,-4821.43"/>
<polygon fill="black" stroke="black" points="8409.45,-4821.43 8405.95,-4811.43 8402.45,-4821.43 8409.45,-4821.43"/>
</g>
<!-- mha_out_l0_g5 -->
<g id="node19" class="node">
<title>mha_out_l0_g5</title>
<polygon fill="lightcoral" stroke="black" points="8820.95,-4707.17 8360.95,-4707.17 8360.95,-4624.17 8820.95,-4624.17 8820.95,-4707.17"/>
<text text-anchor="middle" x="8590.95" y="-4691.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 0</text>
<text text-anchor="middle" x="8590.95" y="-4676.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="8590.95" y="-4661.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8590.95" y="-4646.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="8590.95" y="-4631.97" font-family="Times,serif" font-size="14.00">Type: Row&#45;parallel</text>
</g>
<!-- mha_attn_l0_g5&#45;&gt;mha_out_l0_g5 -->
<g id="edge33" class="edge">
<title>mha_attn_l0_g5&#45;&gt;mha_out_l0_g5</title>
<path fill="none" stroke="black" d="M8532.45,-4743.11C8532.45,-4743.11 8532.45,-4717.38 8532.45,-4717.38"/>
<polygon fill="black" stroke="black" points="8535.95,-4717.38 8532.45,-4707.38 8528.95,-4717.38 8535.95,-4717.38"/>
</g>
<!-- allreduce_l0_g5 -->
<g id="node36" class="node">
<title>allreduce_l0_g5</title>
<polygon fill="lightyellow" stroke="black" points="9265.24,-4588.17 8585.52,-4588.17 8410.67,-4422.17 9090.38,-4422.17 9265.24,-4588.17"/>
<text text-anchor="middle" x="8837.95" y="-4531.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="8837.95" y="-4516.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="8837.95" y="-4501.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="8837.95" y="-4486.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="8837.95" y="-4471.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l0_g5&#45;&gt;allreduce_l0_g5 -->
<g id="edge34" class="edge">
<title>mha_out_l0_g5&#45;&gt;allreduce_l0_g5</title>
<path fill="none" stroke="black" d="M8615.88,-4623.92C8615.88,-4623.92 8615.88,-4598.43 8615.88,-4598.43"/>
<polygon fill="black" stroke="black" points="8619.38,-4598.43 8615.88,-4588.43 8612.38,-4598.43 8619.38,-4598.43"/>
</g>
<!-- mha_attn_l0_g6 -->
<g id="node21" class="node">
<title>mha_attn_l0_g6</title>
<polygon fill="lightcoral" stroke="black" points="10675.95,-4811.17 10203.95,-4811.17 10203.95,-4743.17 10675.95,-4743.17 10675.95,-4811.17"/>
<text text-anchor="middle" x="10439.95" y="-4795.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 0</text>
<text text-anchor="middle" x="10439.95" y="-4780.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10439.95" y="-4765.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10439.95" y="-4750.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l0_g6&#45;&gt;mha_attn_l0_g6 -->
<g id="edge38" class="edge">
<title>mha_qkv_l0_g6&#45;&gt;mha_attn_l0_g6</title>
<path fill="none" stroke="black" d="M10248.45,-4847.15C10248.45,-4847.15 10248.45,-4821.43 10248.45,-4821.43"/>
<polygon fill="black" stroke="black" points="10251.95,-4821.43 10248.45,-4811.43 10244.95,-4821.43 10251.95,-4821.43"/>
</g>
<!-- mha_out_l0_g6 -->
<g id="node22" class="node">
<title>mha_out_l0_g6</title>
<polygon fill="lightcoral" stroke="black" points="10861.95,-4707.17 10401.95,-4707.17 10401.95,-4624.17 10861.95,-4624.17 10861.95,-4707.17"/>
<text text-anchor="middle" x="10631.95" y="-4691.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 0</text>
<text text-anchor="middle" x="10631.95" y="-4676.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10631.95" y="-4661.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10631.95" y="-4646.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="10631.95" y="-4631.97" font-family="Times,serif" font-size="14.00">Type: Row&#45;parallel</text>
</g>
<!-- mha_attn_l0_g6&#45;&gt;mha_out_l0_g6 -->
<g id="edge39" class="edge">
<title>mha_attn_l0_g6&#45;&gt;mha_out_l0_g6</title>
<path fill="none" stroke="black" d="M10538.95,-4743.11C10538.95,-4743.11 10538.95,-4717.38 10538.95,-4717.38"/>
<polygon fill="black" stroke="black" points="10542.45,-4717.38 10538.95,-4707.38 10535.45,-4717.38 10542.45,-4717.38"/>
</g>
<!-- allreduce_l0_g6 -->
<g id="node38" class="node">
<title>allreduce_l0_g6</title>
<polygon fill="lightyellow" stroke="black" points="11154.24,-4588.17 10474.52,-4588.17 10299.67,-4422.17 10979.38,-4422.17 11154.24,-4588.17"/>
<text text-anchor="middle" x="10726.95" y="-4531.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="10726.95" y="-4516.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="10726.95" y="-4501.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="10726.95" y="-4486.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="10726.95" y="-4471.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l0_g6&#45;&gt;allreduce_l0_g6 -->
<g id="edge40" class="edge">
<title>mha_out_l0_g6&#45;&gt;allreduce_l0_g6</title>
<path fill="none" stroke="black" d="M10631.95,-4623.92C10631.95,-4623.92 10631.95,-4598.43 10631.95,-4598.43"/>
<polygon fill="black" stroke="black" points="10635.45,-4598.43 10631.95,-4588.43 10628.45,-4598.43 10635.45,-4598.43"/>
</g>
<!-- mha_attn_l0_g7 -->
<g id="node24" class="node">
<title>mha_attn_l0_g7</title>
<polygon fill="lightcoral" stroke="black" points="11770.95,-4811.17 11298.95,-4811.17 11298.95,-4743.17 11770.95,-4743.17 11770.95,-4811.17"/>
<text text-anchor="middle" x="11534.95" y="-4795.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 0</text>
<text text-anchor="middle" x="11534.95" y="-4780.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="11534.95" y="-4765.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="11534.95" y="-4750.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l0_g7&#45;&gt;mha_attn_l0_g7 -->
<g id="edge44" class="edge">
<title>mha_qkv_l0_g7&#45;&gt;mha_attn_l0_g7</title>
<path fill="none" stroke="black" d="M11165.52,-4847.09C11165.52,-4815.34 11165.52,-4777 11165.52,-4777 11165.52,-4777 11288.89,-4777 11288.89,-4777"/>
<polygon fill="black" stroke="black" points="11288.89,-4780.5 11298.89,-4777 11288.89,-4773.5 11288.89,-4780.5"/>
</g>
<!-- mha_out_l0_g7 -->
<g id="node25" class="node">
<title>mha_out_l0_g7</title>
<polygon fill="lightcoral" stroke="black" points="12157.95,-4707.17 11697.95,-4707.17 11697.95,-4624.17 12157.95,-4624.17 12157.95,-4707.17"/>
<text text-anchor="middle" x="11927.95" y="-4691.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 0</text>
<text text-anchor="middle" x="11927.95" y="-4676.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="11927.95" y="-4661.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="11927.95" y="-4646.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="11927.95" y="-4631.97" font-family="Times,serif" font-size="14.00">Type: Row&#45;parallel</text>
</g>
<!-- mha_attn_l0_g7&#45;&gt;mha_out_l0_g7 -->
<g id="edge45" class="edge">
<title>mha_attn_l0_g7&#45;&gt;mha_out_l0_g7</title>
<path fill="none" stroke="black" d="M11734.45,-4743.11C11734.45,-4743.11 11734.45,-4717.38 11734.45,-4717.38"/>
<polygon fill="black" stroke="black" points="11737.95,-4717.38 11734.45,-4707.38 11730.95,-4717.38 11737.95,-4717.38"/>
</g>
<!-- allreduce_l0_g7 -->
<g id="node40" class="node">
<title>allreduce_l0_g7</title>
<polygon fill="lightyellow" stroke="black" points="12593.24,-4588.17 11913.52,-4588.17 11738.67,-4422.17 12418.38,-4422.17 12593.24,-4588.17"/>
<text text-anchor="middle" x="12165.95" y="-4531.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="12165.95" y="-4516.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="12165.95" y="-4501.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="12165.95" y="-4486.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="12165.95" y="-4471.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l0_g7&#45;&gt;allreduce_l0_g7 -->
<g id="edge46" class="edge">
<title>mha_out_l0_g7&#45;&gt;allreduce_l0_g7</title>
<path fill="none" stroke="black" d="M11948.38,-4623.92C11948.38,-4623.92 11948.38,-4598.43 11948.38,-4598.43"/>
<polygon fill="black" stroke="black" points="11951.88,-4598.43 11948.38,-4588.43 11944.88,-4598.43 11951.88,-4598.43"/>
</g>
<!-- allreduce_l0_g0&#45;&gt;residual_l0_g0 -->
<g id="edge6" class="edge">
<title>allreduce_l0_g0&#45;&gt;residual_l0_g0</title>
<path fill="none" stroke="black" d="M2246.52,-4505.03C2246.52,-4499.43 2246.52,-4320 2246.52,-4320 2246.52,-4320 1733.38,-4320 1733.38,-4320"/>
<polygon fill="black" stroke="black" points="1733.38,-4316.5 1723.38,-4320 1733.38,-4323.5 1733.38,-4316.5"/>
</g>
<!-- gate_l0_g0 -->
<g id="node42" class="node">
<title>gate_l0_g0</title>
<polygon fill="lightgreen" stroke="black" points="1003.45,-4154.17 544.45,-4154.17 544.45,-4071.17 1003.45,-4071.17 1003.45,-4154.17"/>
<text text-anchor="middle" x="773.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="773.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="773.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="773.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="773.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g0&#45;&gt;gate_l0_g0 -->
<g id="edge49" class="edge">
<title>residual_l0_g0&#45;&gt;gate_l0_g0</title>
<path fill="none" stroke="black" d="M965.63,-4190.15C965.63,-4190.15 965.63,-4164.37 965.63,-4164.37"/>
<polygon fill="black" stroke="black" points="969.13,-4164.37 965.63,-4154.37 962.13,-4164.37 969.13,-4164.37"/>
</g>
<!-- gate_l0_g8 -->
<g id="node58" class="node">
<title>gate_l0_g8</title>
<polygon fill="lightgreen" stroke="black" points="1503.45,-4154.17 1044.45,-4154.17 1044.45,-4071.17 1503.45,-4071.17 1503.45,-4154.17"/>
<text text-anchor="middle" x="1273.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="1273.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="1273.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1273.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1273.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g0&#45;&gt;gate_l0_g8 -->
<g id="edge81" class="edge">
<title>residual_l0_g0&#45;&gt;gate_l0_g8</title>
<path fill="none" stroke="black" d="M1273.95,-4190.15C1273.95,-4190.15 1273.95,-4164.37 1273.95,-4164.37"/>
<polygon fill="black" stroke="black" points="1277.45,-4164.37 1273.95,-4154.37 1270.45,-4164.37 1277.45,-4164.37"/>
</g>
<!-- aggregate_l0_g0 -->
<g id="node74" class="node">
<title>aggregate_l0_g0</title>
<polygon fill="lightyellow" stroke="black" points="899.85,-3901.17 184.16,-3901.17 0.05,-3735.17 715.74,-3735.17 899.85,-3901.17"/>
<text text-anchor="middle" x="449.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="449.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="449.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="449.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="449.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g0&#45;&gt;aggregate_l0_g0 -->
<g id="edge52" class="edge">
<title>residual_l0_g0&#45;&gt;aggregate_l0_g0</title>
<path fill="none" stroke="black" d="M1014.94,-4288C690.38,-4288 250.48,-4288 250.48,-4288 250.48,-4288 250.48,-3911.35 250.48,-3911.35"/>
<polygon fill="black" stroke="black" points="253.98,-3911.35 250.48,-3901.35 246.98,-3911.35 253.98,-3911.35"/>
</g>
<!-- aggregate_l0_g8 -->
<g id="node82" class="node">
<title>aggregate_l0_g8</title>
<polygon fill="lightyellow" stroke="black" points="1817.85,-3901.17 1102.16,-3901.17 918.05,-3735.17 1633.74,-3735.17 1817.85,-3901.17"/>
<text text-anchor="middle" x="1367.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1367.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="1367.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1367.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1367.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g0&#45;&gt;aggregate_l0_g8 -->
<g id="edge84" class="edge">
<title>residual_l0_g0&#45;&gt;aggregate_l0_g8</title>
<path fill="none" stroke="black" d="M1642.77,-4229.59C1642.77,-4229.59 1642.77,-3911.28 1642.77,-3911.28"/>
<polygon fill="black" stroke="black" points="1646.27,-3911.28 1642.77,-3901.28 1639.27,-3911.28 1646.27,-3911.28"/>
</g>
<!-- allreduce_l0_g1&#45;&gt;residual_l0_g1 -->
<g id="edge12" class="edge">
<title>allreduce_l0_g1&#45;&gt;residual_l0_g1</title>
<path fill="none" stroke="black" d="M3469.95,-4421.89C3469.95,-4421.89 3469.95,-4396.46 3469.95,-4396.46"/>
<polygon fill="black" stroke="black" points="3473.45,-4396.46 3469.95,-4386.46 3466.45,-4396.46 3473.45,-4396.46"/>
</g>
<!-- gate_l0_g1 -->
<g id="node44" class="node">
<title>gate_l0_g1</title>
<polygon fill="lightgreen" stroke="black" points="2840.45,-4154.17 2381.45,-4154.17 2381.45,-4071.17 2840.45,-4071.17 2840.45,-4154.17"/>
<text text-anchor="middle" x="2610.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="2610.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="2610.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2610.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2610.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g1&#45;&gt;gate_l0_g1 -->
<g id="edge53" class="edge">
<title>residual_l0_g1&#45;&gt;gate_l0_g1</title>
<path fill="none" stroke="black" d="M2903.69,-4190.04C2903.69,-4149.59 2903.69,-4112 2903.69,-4112 2903.69,-4112 2850.53,-4112 2850.53,-4112"/>
<polygon fill="black" stroke="black" points="2850.53,-4108.5 2840.53,-4112 2850.53,-4115.5 2850.53,-4108.5"/>
</g>
<!-- gate_l0_g9 -->
<g id="node60" class="node">
<title>gate_l0_g9</title>
<polygon fill="lightgreen" stroke="black" points="3408.45,-4154.17 2949.45,-4154.17 2949.45,-4071.17 3408.45,-4071.17 3408.45,-4154.17"/>
<text text-anchor="middle" x="3178.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="3178.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="3178.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3178.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3178.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g1&#45;&gt;gate_l0_g9 -->
<g id="edge85" class="edge">
<title>residual_l0_g1&#45;&gt;gate_l0_g9</title>
<path fill="none" stroke="black" d="M3178.95,-4190.15C3178.95,-4190.15 3178.95,-4164.37 3178.95,-4164.37"/>
<polygon fill="black" stroke="black" points="3182.45,-4164.37 3178.95,-4154.37 3175.45,-4164.37 3182.45,-4164.37"/>
</g>
<!-- aggregate_l0_g1 -->
<g id="node75" class="node">
<title>aggregate_l0_g1</title>
<polygon fill="lightyellow" stroke="black" points="2735.85,-3901.17 2020.16,-3901.17 1836.05,-3735.17 2551.74,-3735.17 2735.85,-3901.17"/>
<text text-anchor="middle" x="2285.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2285.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="2285.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2285.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2285.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g1&#45;&gt;aggregate_l0_g1 -->
<g id="edge56" class="edge">
<title>residual_l0_g1&#45;&gt;aggregate_l0_g1</title>
<path fill="none" stroke="black" d="M2938.38,-4255C2647.96,-4255 2292.24,-4255 2292.24,-4255 2292.24,-4255 2292.24,-3911.36 2292.24,-3911.36"/>
<polygon fill="black" stroke="black" points="2295.74,-3911.36 2292.24,-3901.36 2288.74,-3911.36 2295.74,-3911.36"/>
</g>
<!-- aggregate_l0_g9 -->
<g id="node83" class="node">
<title>aggregate_l0_g9</title>
<polygon fill="lightyellow" stroke="black" points="3653.85,-3901.17 2938.16,-3901.17 2754.05,-3735.17 3469.74,-3735.17 3653.85,-3901.17"/>
<text text-anchor="middle" x="3203.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3203.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="3203.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3203.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3203.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g1&#45;&gt;aggregate_l0_g9 -->
<g id="edge88" class="edge">
<title>residual_l0_g1&#45;&gt;aggregate_l0_g9</title>
<path fill="none" stroke="black" d="M2926.57,-4189.93C2926.57,-4189.93 2926.57,-3900.94 2926.57,-3900.94"/>
<polygon fill="black" stroke="black" points="2930.07,-3900.94 2926.57,-3890.94 2923.07,-3900.94 2930.07,-3900.94"/>
</g>
<!-- allreduce_l0_g2&#45;&gt;residual_l0_g2 -->
<g id="edge18" class="edge">
<title>allreduce_l0_g2&#45;&gt;residual_l0_g2</title>
<path fill="none" stroke="black" d="M5423.95,-4421.89C5423.95,-4421.89 5423.95,-4396.46 5423.95,-4396.46"/>
<polygon fill="black" stroke="black" points="5427.45,-4396.46 5423.95,-4386.46 5420.45,-4396.46 5427.45,-4396.46"/>
</g>
<!-- gate_l0_g2 -->
<g id="node46" class="node">
<title>gate_l0_g2</title>
<polygon fill="lightgreen" stroke="black" points="4720.45,-4154.17 4261.45,-4154.17 4261.45,-4071.17 4720.45,-4071.17 4720.45,-4154.17"/>
<text text-anchor="middle" x="4490.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4490.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="4490.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4490.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4490.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g2&#45;&gt;gate_l0_g2 -->
<g id="edge57" class="edge">
<title>residual_l0_g2&#45;&gt;gate_l0_g2</title>
<path fill="none" stroke="black" d="M4681.13,-4190.15C4681.13,-4190.15 4681.13,-4164.37 4681.13,-4164.37"/>
<polygon fill="black" stroke="black" points="4684.63,-4164.37 4681.13,-4154.37 4677.63,-4164.37 4684.63,-4164.37"/>
</g>
<!-- gate_l0_g10 -->
<g id="node62" class="node">
<title>gate_l0_g10</title>
<polygon fill="lightgreen" stroke="black" points="5242.45,-4154.17 4783.45,-4154.17 4783.45,-4071.17 5242.45,-4071.17 5242.45,-4154.17"/>
<text text-anchor="middle" x="5012.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5012.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="5012.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5012.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5012.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g2&#45;&gt;gate_l0_g10 -->
<g id="edge89" class="edge">
<title>residual_l0_g2&#45;&gt;gate_l0_g10</title>
<path fill="none" stroke="black" d="M5012.95,-4190.15C5012.95,-4190.15 5012.95,-4164.37 5012.95,-4164.37"/>
<polygon fill="black" stroke="black" points="5016.45,-4164.37 5012.95,-4154.37 5009.45,-4164.37 5016.45,-4164.37"/>
</g>
<!-- aggregate_l0_g2 -->
<g id="node76" class="node">
<title>aggregate_l0_g2</title>
<polygon fill="lightyellow" stroke="black" points="4571.85,-3901.17 3856.16,-3901.17 3672.05,-3735.17 4387.74,-3735.17 4571.85,-3901.17"/>
<text text-anchor="middle" x="4121.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4121.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="4121.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4121.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4121.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g2&#45;&gt;aggregate_l0_g2 -->
<g id="edge60" class="edge">
<title>residual_l0_g2&#45;&gt;aggregate_l0_g2</title>
<path fill="none" stroke="black" d="M4699.36,-4255C4447.78,-4255 4160.27,-4255 4160.27,-4255 4160.27,-4255 4160.27,-3911.36 4160.27,-3911.36"/>
<polygon fill="black" stroke="black" points="4163.77,-3911.36 4160.27,-3901.36 4156.77,-3911.36 4163.77,-3911.36"/>
</g>
<!-- aggregate_l0_g10 -->
<g id="node84" class="node">
<title>aggregate_l0_g10</title>
<polygon fill="lightyellow" stroke="black" points="5489.85,-3901.17 4774.16,-3901.17 4590.05,-3735.17 5305.74,-3735.17 5489.85,-3901.17"/>
<text text-anchor="middle" x="5039.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5039.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="5039.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5039.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5039.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g2&#45;&gt;aggregate_l0_g10 -->
<g id="edge92" class="edge">
<title>residual_l0_g2&#45;&gt;aggregate_l0_g10</title>
<path fill="none" stroke="black" d="M4751.95,-4189.93C4751.95,-4189.93 4751.95,-3891.39 4751.95,-3891.39"/>
<polygon fill="black" stroke="black" points="4755.45,-3891.39 4751.95,-3881.39 4748.45,-3891.39 4755.45,-3891.39"/>
</g>
<!-- allreduce_l0_g3&#45;&gt;residual_l0_g3 -->
<g id="edge24" class="edge">
<title>allreduce_l0_g3&#45;&gt;residual_l0_g3</title>
<path fill="none" stroke="black" d="M6742.45,-4421.89C6742.45,-4421.89 6742.45,-4396.46 6742.45,-4396.46"/>
<polygon fill="black" stroke="black" points="6745.95,-4396.46 6742.45,-4386.46 6738.95,-4396.46 6745.95,-4396.46"/>
</g>
<!-- gate_l0_g3 -->
<g id="node48" class="node">
<title>gate_l0_g3</title>
<polygon fill="lightgreen" stroke="black" points="6465.45,-4154.17 6006.45,-4154.17 6006.45,-4071.17 6465.45,-4071.17 6465.45,-4154.17"/>
<text text-anchor="middle" x="6235.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6235.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="6235.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6235.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6235.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g3&#45;&gt;gate_l0_g3 -->
<g id="edge61" class="edge">
<title>residual_l0_g3&#45;&gt;gate_l0_g3</title>
<path fill="none" stroke="black" d="M6380.63,-4190.15C6380.63,-4190.15 6380.63,-4164.37 6380.63,-4164.37"/>
<polygon fill="black" stroke="black" points="6384.13,-4164.37 6380.63,-4154.37 6377.13,-4164.37 6384.13,-4164.37"/>
</g>
<!-- gate_l0_g11 -->
<g id="node64" class="node">
<title>gate_l0_g11</title>
<polygon fill="lightgreen" stroke="black" points="6952.45,-4154.17 6493.45,-4154.17 6493.45,-4071.17 6952.45,-4071.17 6952.45,-4154.17"/>
<text text-anchor="middle" x="6722.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6722.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="6722.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6722.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6722.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g3&#45;&gt;gate_l0_g11 -->
<g id="edge93" class="edge">
<title>residual_l0_g3&#45;&gt;gate_l0_g11</title>
<path fill="none" stroke="black" d="M6722.95,-4190.15C6722.95,-4190.15 6722.95,-4164.37 6722.95,-4164.37"/>
<polygon fill="black" stroke="black" points="6726.45,-4164.37 6722.95,-4154.37 6719.45,-4164.37 6726.45,-4164.37"/>
</g>
<!-- aggregate_l0_g3 -->
<g id="node77" class="node">
<title>aggregate_l0_g3</title>
<polygon fill="lightyellow" stroke="black" points="6407.85,-3901.17 5692.16,-3901.17 5508.05,-3735.17 6223.74,-3735.17 6407.85,-3901.17"/>
<text text-anchor="middle" x="5957.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5957.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="5957.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="5957.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5957.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g3&#45;&gt;aggregate_l0_g3 -->
<g id="edge64" class="edge">
<title>residual_l0_g3&#45;&gt;aggregate_l0_g3</title>
<path fill="none" stroke="black" d="M6382.64,-4288C6101.72,-4288 5748.98,-4288 5748.98,-4288 5748.98,-4288 5748.98,-3911.35 5748.98,-3911.35"/>
<polygon fill="black" stroke="black" points="5752.48,-3911.35 5748.98,-3901.35 5745.48,-3911.35 5752.48,-3911.35"/>
</g>
<!-- aggregate_l0_g11 -->
<g id="node85" class="node">
<title>aggregate_l0_g11</title>
<polygon fill="lightyellow" stroke="black" points="7325.85,-3901.17 6610.16,-3901.17 6426.05,-3735.17 7141.74,-3735.17 7325.85,-3901.17"/>
<text text-anchor="middle" x="6875.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6875.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="6875.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6875.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6875.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g3&#45;&gt;aggregate_l0_g11 -->
<g id="edge96" class="edge">
<title>residual_l0_g3&#45;&gt;aggregate_l0_g11</title>
<path fill="none" stroke="black" d="M6479.45,-4189.93C6479.45,-4189.93 6479.45,-3828.21 6479.45,-3828.21"/>
<polygon fill="black" stroke="black" points="6482.95,-3828.21 6479.45,-3818.21 6475.95,-3828.21 6482.95,-3828.21"/>
</g>
<!-- allreduce_l0_g4&#45;&gt;residual_l0_g4 -->
<g id="edge30" class="edge">
<title>allreduce_l0_g4&#45;&gt;residual_l0_g4</title>
<path fill="none" stroke="black" d="M7710.95,-4421.89C7710.95,-4421.89 7710.95,-4396.46 7710.95,-4396.46"/>
<polygon fill="black" stroke="black" points="7714.45,-4396.46 7710.95,-4386.46 7707.45,-4396.46 7714.45,-4396.46"/>
</g>
<!-- gate_l0_g4 -->
<g id="node50" class="node">
<title>gate_l0_g4</title>
<polygon fill="lightgreen" stroke="black" points="8113.45,-4154.17 7654.45,-4154.17 7654.45,-4071.17 8113.45,-4071.17 8113.45,-4154.17"/>
<text text-anchor="middle" x="7883.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7883.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="7883.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7883.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="7883.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g4&#45;&gt;gate_l0_g4 -->
<g id="edge65" class="edge">
<title>residual_l0_g4&#45;&gt;gate_l0_g4</title>
<path fill="none" stroke="black" d="M7883.95,-4190.15C7883.95,-4190.15 7883.95,-4164.37 7883.95,-4164.37"/>
<polygon fill="black" stroke="black" points="7887.45,-4164.37 7883.95,-4154.37 7880.45,-4164.37 7887.45,-4164.37"/>
</g>
<!-- gate_l0_g12 -->
<g id="node66" class="node">
<title>gate_l0_g12</title>
<polygon fill="lightgreen" stroke="black" points="8595.45,-4154.17 8136.45,-4154.17 8136.45,-4071.17 8595.45,-4071.17 8595.45,-4154.17"/>
<text text-anchor="middle" x="8365.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8365.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="8365.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8365.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8365.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g4&#45;&gt;gate_l0_g12 -->
<g id="edge97" class="edge">
<title>residual_l0_g4&#45;&gt;gate_l0_g12</title>
<path fill="none" stroke="black" d="M8128.78,-4288.04C8128.78,-4282.7 8128.78,-4112 8128.78,-4112 8128.78,-4112 8129.55,-4112 8129.55,-4112"/>
<polygon fill="black" stroke="black" points="8126.41,-4115.5 8136.41,-4112 8126.41,-4108.5 8126.41,-4115.5"/>
</g>
<!-- aggregate_l0_g4 -->
<g id="node78" class="node">
<title>aggregate_l0_g4</title>
<polygon fill="lightyellow" stroke="black" points="8243.85,-3901.17 7528.16,-3901.17 7344.05,-3735.17 8059.74,-3735.17 8243.85,-3901.17"/>
<text text-anchor="middle" x="7793.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7793.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="7793.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7793.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7793.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g4&#45;&gt;aggregate_l0_g4 -->
<g id="edge68" class="edge">
<title>residual_l0_g4&#45;&gt;aggregate_l0_g4</title>
<path fill="none" stroke="black" d="M7499.23,-4189.93C7499.23,-4189.93 7499.23,-3885.31 7499.23,-3885.31"/>
<polygon fill="black" stroke="black" points="7502.73,-3885.31 7499.23,-3875.31 7495.73,-3885.31 7502.73,-3885.31"/>
</g>
<!-- aggregate_l0_g12 -->
<g id="node86" class="node">
<title>aggregate_l0_g12</title>
<polygon fill="lightyellow" stroke="black" points="9161.85,-3901.17 8446.16,-3901.17 8262.05,-3735.17 8977.74,-3735.17 9161.85,-3901.17"/>
<text text-anchor="middle" x="8711.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8711.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="8711.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8711.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8711.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g4&#45;&gt;aggregate_l0_g12 -->
<g id="edge100" class="edge">
<title>residual_l0_g4&#45;&gt;aggregate_l0_g12</title>
<path fill="none" stroke="black" d="M8121.12,-4288.1C8121.12,-4282.33 8121.12,-3913 8121.12,-3913 8121.12,-3913 8372.32,-3913 8372.32,-3913 8372.32,-3913 8372.32,-3844.69 8372.32,-3844.69"/>
<polygon fill="black" stroke="black" points="8375.82,-3844.69 8372.32,-3834.69 8368.82,-3844.69 8375.82,-3844.69"/>
</g>
<!-- allreduce_l0_g5&#45;&gt;residual_l0_g5 -->
<g id="edge36" class="edge">
<title>allreduce_l0_g5&#45;&gt;residual_l0_g5</title>
<path fill="none" stroke="black" d="M9182.45,-4505.01C9182.45,-4505.01 9182.45,-4298.32 9182.45,-4298.32"/>
<polygon fill="black" stroke="black" points="9185.95,-4298.32 9182.45,-4288.32 9178.95,-4298.32 9185.95,-4298.32"/>
</g>
<!-- gate_l0_g5 -->
<g id="node52" class="node">
<title>gate_l0_g5</title>
<polygon fill="lightgreen" stroke="black" points="9885.45,-4154.17 9426.45,-4154.17 9426.45,-4071.17 9885.45,-4071.17 9885.45,-4154.17"/>
<text text-anchor="middle" x="9655.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9655.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="9655.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="9655.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="9655.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g5&#45;&gt;gate_l0_g5 -->
<g id="edge69" class="edge">
<title>residual_l0_g5&#45;&gt;gate_l0_g5</title>
<path fill="none" stroke="black" d="M9655.95,-4190.15C9655.95,-4190.15 9655.95,-4164.37 9655.95,-4164.37"/>
<polygon fill="black" stroke="black" points="9659.45,-4164.37 9655.95,-4154.37 9652.45,-4164.37 9659.45,-4164.37"/>
</g>
<!-- gate_l0_g13 -->
<g id="node68" class="node">
<title>gate_l0_g13</title>
<polygon fill="lightgreen" stroke="black" points="10452.45,-4154.17 9993.45,-4154.17 9993.45,-4071.17 10452.45,-4071.17 10452.45,-4154.17"/>
<text text-anchor="middle" x="10222.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10222.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="10222.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10222.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10222.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g5&#45;&gt;gate_l0_g13 -->
<g id="edge101" class="edge">
<title>residual_l0_g5&#45;&gt;gate_l0_g13</title>
<path fill="none" stroke="black" d="M9931.21,-4288.04C9931.21,-4282.7 9931.21,-4112 9931.21,-4112 9931.21,-4112 9983.44,-4112 9983.44,-4112"/>
<polygon fill="black" stroke="black" points="9983.44,-4115.5 9993.44,-4112 9983.44,-4108.5 9983.44,-4115.5"/>
</g>
<!-- aggregate_l0_g5 -->
<g id="node79" class="node">
<title>aggregate_l0_g5</title>
<polygon fill="lightyellow" stroke="black" points="10079.85,-3901.17 9364.16,-3901.17 9180.05,-3735.17 9895.74,-3735.17 10079.85,-3901.17"/>
<text text-anchor="middle" x="9629.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9629.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="9629.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="9629.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="9629.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g5&#45;&gt;aggregate_l0_g5 -->
<g id="edge72" class="edge">
<title>residual_l0_g5&#45;&gt;aggregate_l0_g5</title>
<path fill="none" stroke="black" d="M9908.33,-4288.08C9908.33,-4288.08 9908.33,-3911.29 9908.33,-3911.29"/>
<polygon fill="black" stroke="black" points="9911.83,-3911.29 9908.33,-3901.29 9904.83,-3911.29 9911.83,-3911.29"/>
</g>
<!-- aggregate_l0_g13 -->
<g id="node87" class="node">
<title>aggregate_l0_g13</title>
<polygon fill="lightyellow" stroke="black" points="10997.85,-3901.17 10282.16,-3901.17 10098.05,-3735.17 10813.74,-3735.17 10997.85,-3901.17"/>
<text text-anchor="middle" x="10547.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10547.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="10547.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10547.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10547.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g5&#45;&gt;aggregate_l0_g13 -->
<g id="edge104" class="edge">
<title>residual_l0_g5&#45;&gt;aggregate_l0_g13</title>
<path fill="none" stroke="black" d="M9866.72,-4288C10214.51,-4288 10704.38,-4288 10704.38,-4288 10704.38,-4288 10704.38,-3911.35 10704.38,-3911.35"/>
<polygon fill="black" stroke="black" points="10707.88,-3911.35 10704.38,-3901.35 10700.88,-3911.35 10707.88,-3911.35"/>
</g>
<!-- allreduce_l0_g6&#45;&gt;residual_l0_g6 -->
<g id="edge42" class="edge">
<title>allreduce_l0_g6&#45;&gt;residual_l0_g6</title>
<path fill="none" stroke="black" d="M11045.45,-4484.75C11045.45,-4484.75 11045.45,-4322.29 11045.45,-4322.29"/>
<polygon fill="black" stroke="black" points="11048.95,-4322.29 11045.45,-4312.29 11041.95,-4322.29 11048.95,-4322.29"/>
</g>
<!-- gate_l0_g6 -->
<g id="node54" class="node">
<title>gate_l0_g6</title>
<polygon fill="lightgreen" stroke="black" points="11722.45,-4154.17 11263.45,-4154.17 11263.45,-4071.17 11722.45,-4071.17 11722.45,-4154.17"/>
<text text-anchor="middle" x="11492.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11492.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="11492.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11492.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="11492.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g6&#45;&gt;gate_l0_g6 -->
<g id="edge73" class="edge">
<title>residual_l0_g6&#45;&gt;gate_l0_g6</title>
<path fill="none" stroke="black" d="M11492.95,-4190.15C11492.95,-4190.15 11492.95,-4164.37 11492.95,-4164.37"/>
<polygon fill="black" stroke="black" points="11496.45,-4164.37 11492.95,-4154.37 11489.45,-4164.37 11496.45,-4164.37"/>
</g>
<!-- gate_l0_g14 -->
<g id="node70" class="node">
<title>gate_l0_g14</title>
<polygon fill="lightgreen" stroke="black" points="12288.45,-4154.17 11829.45,-4154.17 11829.45,-4071.17 12288.45,-4071.17 12288.45,-4154.17"/>
<text text-anchor="middle" x="12058.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12058.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="12058.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12058.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12058.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g6&#45;&gt;gate_l0_g14 -->
<g id="edge105" class="edge">
<title>residual_l0_g6&#45;&gt;gate_l0_g14</title>
<path fill="none" stroke="black" d="M11768.21,-4288.04C11768.21,-4282.7 11768.21,-4112 11768.21,-4112 11768.21,-4112 11819.16,-4112 11819.16,-4112"/>
<polygon fill="black" stroke="black" points="11819.16,-4115.5 11829.16,-4112 11819.16,-4108.5 11819.16,-4115.5"/>
</g>
<!-- aggregate_l0_g6 -->
<g id="node80" class="node">
<title>aggregate_l0_g6</title>
<polygon fill="lightyellow" stroke="black" points="11915.85,-3901.17 11200.16,-3901.17 11016.05,-3735.17 11731.74,-3735.17 11915.85,-3901.17"/>
<text text-anchor="middle" x="11465.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11465.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="11465.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11465.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11465.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g6&#45;&gt;aggregate_l0_g6 -->
<g id="edge76" class="edge">
<title>residual_l0_g6&#45;&gt;aggregate_l0_g6</title>
<path fill="none" stroke="black" d="M11745.33,-4288.08C11745.33,-4288.08 11745.33,-3911.29 11745.33,-3911.29"/>
<polygon fill="black" stroke="black" points="11748.83,-3911.29 11745.33,-3901.29 11741.83,-3911.29 11748.83,-3911.29"/>
</g>
<!-- aggregate_l0_g14 -->
<g id="node88" class="node">
<title>aggregate_l0_g14</title>
<polygon fill="lightyellow" stroke="black" points="12833.85,-3901.17 12118.16,-3901.17 11934.05,-3735.17 12649.74,-3735.17 12833.85,-3901.17"/>
<text text-anchor="middle" x="12383.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12383.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="12383.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12383.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12383.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g6&#45;&gt;aggregate_l0_g14 -->
<g id="edge108" class="edge">
<title>residual_l0_g6&#45;&gt;aggregate_l0_g14</title>
<path fill="none" stroke="black" d="M11674.24,-4255C11985.28,-4255 12418.33,-4255 12418.33,-4255 12418.33,-4255 12418.33,-3911.36 12418.33,-3911.36"/>
<polygon fill="black" stroke="black" points="12421.83,-3911.36 12418.33,-3901.36 12414.83,-3911.36 12421.83,-3911.36"/>
</g>
<!-- allreduce_l0_g7&#45;&gt;residual_l0_g7 -->
<g id="edge48" class="edge">
<title>allreduce_l0_g7&#45;&gt;residual_l0_g7</title>
<path fill="none" stroke="black" d="M12505.71,-4505.03C12505.71,-4499.43 12505.71,-4320 12505.71,-4320 12505.71,-4320 12876.26,-4320 12876.26,-4320"/>
<polygon fill="black" stroke="black" points="12876.26,-4323.5 12886.26,-4320 12876.26,-4316.5 12876.26,-4323.5"/>
</g>
<!-- gate_l0_g7 -->
<g id="node56" class="node">
<title>gate_l0_g7</title>
<polygon fill="lightgreen" stroke="black" points="13556.45,-4154.17 13097.45,-4154.17 13097.45,-4071.17 13556.45,-4071.17 13556.45,-4154.17"/>
<text text-anchor="middle" x="13326.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="13326.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="13326.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13326.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="13326.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g7&#45;&gt;gate_l0_g7 -->
<g id="edge77" class="edge">
<title>residual_l0_g7&#45;&gt;gate_l0_g7</title>
<path fill="none" stroke="black" d="M13326.95,-4190.15C13326.95,-4190.15 13326.95,-4164.37 13326.95,-4164.37"/>
<polygon fill="black" stroke="black" points="13330.45,-4164.37 13326.95,-4154.37 13323.45,-4164.37 13330.45,-4164.37"/>
</g>
<!-- gate_l0_g15 -->
<g id="node72" class="node">
<title>gate_l0_g15</title>
<polygon fill="lightgreen" stroke="black" points="14123.45,-4154.17 13664.45,-4154.17 13664.45,-4071.17 14123.45,-4071.17 14123.45,-4154.17"/>
<text text-anchor="middle" x="13893.95" y="-4138.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="13893.95" y="-4123.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="13893.95" y="-4108.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="13893.95" y="-4093.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="13893.95" y="-4078.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l0_g7&#45;&gt;gate_l0_g15 -->
<g id="edge109" class="edge">
<title>residual_l0_g7&#45;&gt;gate_l0_g15</title>
<path fill="none" stroke="black" d="M13607.93,-4288.04C13607.93,-4282.7 13607.93,-4112 13607.93,-4112 13607.93,-4112 13654.44,-4112 13654.44,-4112"/>
<polygon fill="black" stroke="black" points="13654.44,-4115.5 13664.44,-4112 13654.44,-4108.5 13654.44,-4115.5"/>
</g>
<!-- aggregate_l0_g7 -->
<g id="node81" class="node">
<title>aggregate_l0_g7</title>
<polygon fill="lightyellow" stroke="black" points="13751.85,-3901.17 13036.16,-3901.17 12852.05,-3735.17 13567.74,-3735.17 13751.85,-3901.17"/>
<text text-anchor="middle" x="13301.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13301.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="13301.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13301.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13301.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g7&#45;&gt;aggregate_l0_g7 -->
<g id="edge80" class="edge">
<title>residual_l0_g7&#45;&gt;aggregate_l0_g7</title>
<path fill="none" stroke="black" d="M13573.61,-4288.08C13573.61,-4288.08 13573.61,-3911.29 13573.61,-3911.29"/>
<polygon fill="black" stroke="black" points="13577.11,-3911.29 13573.61,-3901.29 13570.11,-3911.29 13577.11,-3911.29"/>
</g>
<!-- aggregate_l0_g15 -->
<g id="node89" class="node">
<title>aggregate_l0_g15</title>
<polygon fill="lightyellow" stroke="black" points="14669.85,-3901.17 13954.16,-3901.17 13770.05,-3735.17 14485.74,-3735.17 14669.85,-3901.17"/>
<text text-anchor="middle" x="14219.95" y="-3844.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14219.95" y="-3829.47" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="14219.95" y="-3814.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14219.95" y="-3799.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14219.95" y="-3784.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l0_g7&#45;&gt;aggregate_l0_g15 -->
<g id="edge112" class="edge">
<title>residual_l0_g7&#45;&gt;aggregate_l0_g15</title>
<path fill="none" stroke="black" d="M13590.77,-4288.1C13590.77,-4282.51 13590.77,-3925 13590.77,-3925 13590.77,-3925 13894.32,-3925 13894.32,-3925 13894.32,-3925 13894.32,-3857.36 13894.32,-3857.36"/>
<polygon fill="black" stroke="black" points="13897.82,-3857.36 13894.32,-3847.36 13890.82,-3857.36 13897.82,-3857.36"/>
</g>
<!-- expert_l0_e0_g0 -->
<g id="node43" class="node">
<title>expert_l0_e0_g0</title>
<polygon fill="lightgreen" stroke="black" points="946.95,-4035.17 500.95,-4035.17 500.95,-3937.17 946.95,-3937.17 946.95,-4035.17"/>
<text text-anchor="middle" x="723.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="723.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="723.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="723.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="723.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="723.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g0&#45;&gt;expert_l0_e0_g0 -->
<g id="edge50" class="edge">
<title>gate_l0_g0&#45;&gt;expert_l0_e0_g0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M745.7,-4070.9C745.7,-4070.9 745.7,-4045.36 745.7,-4045.36"/>
<polygon fill="black" stroke="black" points="749.2,-4045.36 745.7,-4035.36 742.2,-4045.36 749.2,-4045.36"/>
</g>
<!-- expert_l0_e0_g0&#45;&gt;aggregate_l0_g0 -->
<g id="edge51" class="edge">
<title>expert_l0_e0_g0&#45;&gt;aggregate_l0_g0</title>
<path fill="none" stroke="black" d="M700.43,-3937.12C700.43,-3937.12 700.43,-3911.41 700.43,-3911.41"/>
<polygon fill="black" stroke="black" points="703.93,-3911.41 700.43,-3901.41 696.93,-3911.41 703.93,-3911.41"/>
</g>
<!-- expert_l0_e1_g1 -->
<g id="node45" class="node">
<title>expert_l0_e1_g1</title>
<polygon fill="lightgreen" stroke="black" points="2783.95,-4035.17 2337.95,-4035.17 2337.95,-3937.17 2783.95,-3937.17 2783.95,-4035.17"/>
<text text-anchor="middle" x="2560.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2560.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="2560.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2560.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2560.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2560.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g1&#45;&gt;expert_l0_e1_g1 -->
<g id="edge54" class="edge">
<title>gate_l0_g1&#45;&gt;expert_l0_e1_g1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2582.7,-4070.9C2582.7,-4070.9 2582.7,-4045.36 2582.7,-4045.36"/>
<polygon fill="black" stroke="black" points="2586.2,-4045.36 2582.7,-4035.36 2579.2,-4045.36 2586.2,-4045.36"/>
</g>
<!-- expert_l0_e1_g1&#45;&gt;aggregate_l0_g1 -->
<g id="edge55" class="edge">
<title>expert_l0_e1_g1&#45;&gt;aggregate_l0_g1</title>
<path fill="none" stroke="black" d="M2536.93,-3937.12C2536.93,-3937.12 2536.93,-3911.41 2536.93,-3911.41"/>
<polygon fill="black" stroke="black" points="2540.43,-3911.41 2536.93,-3901.41 2533.43,-3911.41 2540.43,-3911.41"/>
</g>
<!-- expert_l0_e2_g2 -->
<g id="node47" class="node">
<title>expert_l0_e2_g2</title>
<polygon fill="lightgreen" stroke="black" points="4710.95,-4035.17 4264.95,-4035.17 4264.95,-3937.17 4710.95,-3937.17 4710.95,-4035.17"/>
<text text-anchor="middle" x="4487.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4487.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="4487.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4487.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4487.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4487.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g2&#45;&gt;expert_l0_e2_g2 -->
<g id="edge58" class="edge">
<title>gate_l0_g2&#45;&gt;expert_l0_e2_g2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4487.95,-4070.9C4487.95,-4070.9 4487.95,-4045.36 4487.95,-4045.36"/>
<polygon fill="black" stroke="black" points="4491.45,-4045.36 4487.95,-4035.36 4484.45,-4045.36 4491.45,-4045.36"/>
</g>
<!-- expert_l0_e2_g2&#45;&gt;aggregate_l0_g2 -->
<g id="edge59" class="edge">
<title>expert_l0_e2_g2&#45;&gt;aggregate_l0_g2</title>
<path fill="none" stroke="black" d="M4418.43,-3937.12C4418.43,-3937.12 4418.43,-3911.41 4418.43,-3911.41"/>
<polygon fill="black" stroke="black" points="4421.93,-3911.41 4418.43,-3901.41 4414.93,-3911.41 4421.93,-3911.41"/>
</g>
<!-- expert_l0_e3_g3 -->
<g id="node49" class="node">
<title>expert_l0_e3_g3</title>
<polygon fill="lightgreen" stroke="black" points="6435.95,-4035.17 5989.95,-4035.17 5989.95,-3937.17 6435.95,-3937.17 6435.95,-4035.17"/>
<text text-anchor="middle" x="6212.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6212.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="6212.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6212.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6212.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6212.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g3&#45;&gt;expert_l0_e3_g3 -->
<g id="edge62" class="edge">
<title>gate_l0_g3&#45;&gt;expert_l0_e3_g3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6221.2,-4070.9C6221.2,-4070.9 6221.2,-4045.36 6221.2,-4045.36"/>
<polygon fill="black" stroke="black" points="6224.7,-4045.36 6221.2,-4035.36 6217.7,-4045.36 6224.7,-4045.36"/>
</g>
<!-- expert_l0_e3_g3&#45;&gt;aggregate_l0_g3 -->
<g id="edge63" class="edge">
<title>expert_l0_e3_g3&#45;&gt;aggregate_l0_g3</title>
<path fill="none" stroke="black" d="M6198.93,-3937.12C6198.93,-3937.12 6198.93,-3911.41 6198.93,-3911.41"/>
<polygon fill="black" stroke="black" points="6202.43,-3911.41 6198.93,-3901.41 6195.43,-3911.41 6202.43,-3911.41"/>
</g>
<!-- expert_l0_e4_g4 -->
<g id="node51" class="node">
<title>expert_l0_e4_g4</title>
<polygon fill="lightgreen" stroke="black" points="8102.95,-4035.17 7656.95,-4035.17 7656.95,-3937.17 8102.95,-3937.17 8102.95,-4035.17"/>
<text text-anchor="middle" x="7879.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7879.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="7879.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="7879.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7879.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7879.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g4&#45;&gt;expert_l0_e4_g4 -->
<g id="edge66" class="edge">
<title>gate_l0_g4&#45;&gt;expert_l0_e4_g4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7879.95,-4070.9C7879.95,-4070.9 7879.95,-4045.36 7879.95,-4045.36"/>
<polygon fill="black" stroke="black" points="7883.45,-4045.36 7879.95,-4035.36 7876.45,-4045.36 7883.45,-4045.36"/>
</g>
<!-- expert_l0_e4_g4&#45;&gt;aggregate_l0_g4 -->
<g id="edge67" class="edge">
<title>expert_l0_e4_g4&#45;&gt;aggregate_l0_g4</title>
<path fill="none" stroke="black" d="M7879.95,-3937.12C7879.95,-3937.12 7879.95,-3911.41 7879.95,-3911.41"/>
<polygon fill="black" stroke="black" points="7883.45,-3911.41 7879.95,-3901.41 7876.45,-3911.41 7883.45,-3911.41"/>
</g>
<!-- expert_l0_e5_g5 -->
<g id="node53" class="node">
<title>expert_l0_e5_g5</title>
<polygon fill="lightgreen" stroke="black" points="9875.95,-4035.17 9429.95,-4035.17 9429.95,-3937.17 9875.95,-3937.17 9875.95,-4035.17"/>
<text text-anchor="middle" x="9652.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="9652.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="9652.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="9652.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="9652.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="9652.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g5&#45;&gt;expert_l0_e5_g5 -->
<g id="edge70" class="edge">
<title>gate_l0_g5&#45;&gt;expert_l0_e5_g5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9652.95,-4070.9C9652.95,-4070.9 9652.95,-4045.36 9652.95,-4045.36"/>
<polygon fill="black" stroke="black" points="9656.45,-4045.36 9652.95,-4035.36 9649.45,-4045.36 9656.45,-4045.36"/>
</g>
<!-- expert_l0_e5_g5&#45;&gt;aggregate_l0_g5 -->
<g id="edge71" class="edge">
<title>expert_l0_e5_g5&#45;&gt;aggregate_l0_g5</title>
<path fill="none" stroke="black" d="M9652.95,-3937.12C9652.95,-3937.12 9652.95,-3911.41 9652.95,-3911.41"/>
<polygon fill="black" stroke="black" points="9656.45,-3911.41 9652.95,-3901.41 9649.45,-3911.41 9656.45,-3911.41"/>
</g>
<!-- expert_l0_e6_g6 -->
<g id="node55" class="node">
<title>expert_l0_e6_g6</title>
<polygon fill="lightgreen" stroke="black" points="11711.95,-4035.17 11265.95,-4035.17 11265.95,-3937.17 11711.95,-3937.17 11711.95,-4035.17"/>
<text text-anchor="middle" x="11488.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="11488.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="11488.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11488.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11488.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11488.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g6&#45;&gt;expert_l0_e6_g6 -->
<g id="edge74" class="edge">
<title>gate_l0_g6&#45;&gt;expert_l0_e6_g6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11488.95,-4070.9C11488.95,-4070.9 11488.95,-4045.36 11488.95,-4045.36"/>
<polygon fill="black" stroke="black" points="11492.45,-4045.36 11488.95,-4035.36 11485.45,-4045.36 11492.45,-4045.36"/>
</g>
<!-- expert_l0_e6_g6&#45;&gt;aggregate_l0_g6 -->
<g id="edge75" class="edge">
<title>expert_l0_e6_g6&#45;&gt;aggregate_l0_g6</title>
<path fill="none" stroke="black" d="M11488.95,-3937.12C11488.95,-3937.12 11488.95,-3911.41 11488.95,-3911.41"/>
<polygon fill="black" stroke="black" points="11492.45,-3911.41 11488.95,-3901.41 11485.45,-3911.41 11492.45,-3911.41"/>
</g>
<!-- expert_l0_e7_g7 -->
<g id="node57" class="node">
<title>expert_l0_e7_g7</title>
<polygon fill="lightgreen" stroke="black" points="13546.95,-4035.17 13100.95,-4035.17 13100.95,-3937.17 13546.95,-3937.17 13546.95,-4035.17"/>
<text text-anchor="middle" x="13323.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="13323.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="13323.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13323.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13323.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13323.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g7&#45;&gt;expert_l0_e7_g7 -->
<g id="edge78" class="edge">
<title>gate_l0_g7&#45;&gt;expert_l0_e7_g7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13323.95,-4070.9C13323.95,-4070.9 13323.95,-4045.36 13323.95,-4045.36"/>
<polygon fill="black" stroke="black" points="13327.45,-4045.36 13323.95,-4035.36 13320.45,-4045.36 13327.45,-4045.36"/>
</g>
<!-- expert_l0_e7_g7&#45;&gt;aggregate_l0_g7 -->
<g id="edge79" class="edge">
<title>expert_l0_e7_g7&#45;&gt;aggregate_l0_g7</title>
<path fill="none" stroke="black" d="M13323.95,-3937.12C13323.95,-3937.12 13323.95,-3911.41 13323.95,-3911.41"/>
<polygon fill="black" stroke="black" points="13327.45,-3911.41 13323.95,-3901.41 13320.45,-3911.41 13327.45,-3911.41"/>
</g>
<!-- expert_l0_e8_g8 -->
<g id="node59" class="node">
<title>expert_l0_e8_g8</title>
<polygon fill="lightgreen" stroke="black" points="1499.95,-4035.17 1053.95,-4035.17 1053.95,-3937.17 1499.95,-3937.17 1499.95,-4035.17"/>
<text text-anchor="middle" x="1276.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1276.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="1276.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1276.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1276.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1276.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g8&#45;&gt;expert_l0_e8_g8 -->
<g id="edge82" class="edge">
<title>gate_l0_g8&#45;&gt;expert_l0_e8_g8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1276.95,-4070.9C1276.95,-4070.9 1276.95,-4045.36 1276.95,-4045.36"/>
<polygon fill="black" stroke="black" points="1280.45,-4045.36 1276.95,-4035.36 1273.45,-4045.36 1280.45,-4045.36"/>
</g>
<!-- expert_l0_e8_g8&#45;&gt;aggregate_l0_g8 -->
<g id="edge83" class="edge">
<title>expert_l0_e8_g8&#45;&gt;aggregate_l0_g8</title>
<path fill="none" stroke="black" d="M1276.95,-3937.12C1276.95,-3937.12 1276.95,-3911.41 1276.95,-3911.41"/>
<polygon fill="black" stroke="black" points="1280.45,-3911.41 1276.95,-3901.41 1273.45,-3911.41 1280.45,-3911.41"/>
</g>
<!-- expert_l0_e9_g9 -->
<g id="node61" class="node">
<title>expert_l0_e9_g9</title>
<polygon fill="lightgreen" stroke="black" points="3404.95,-4035.17 2958.95,-4035.17 2958.95,-3937.17 3404.95,-3937.17 3404.95,-4035.17"/>
<text text-anchor="middle" x="3181.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3181.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="3181.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3181.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3181.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3181.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g9&#45;&gt;expert_l0_e9_g9 -->
<g id="edge86" class="edge">
<title>gate_l0_g9&#45;&gt;expert_l0_e9_g9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3181.95,-4070.9C3181.95,-4070.9 3181.95,-4045.36 3181.95,-4045.36"/>
<polygon fill="black" stroke="black" points="3185.45,-4045.36 3181.95,-4035.36 3178.45,-4045.36 3185.45,-4045.36"/>
</g>
<!-- expert_l0_e9_g9&#45;&gt;aggregate_l0_g9 -->
<g id="edge87" class="edge">
<title>expert_l0_e9_g9&#45;&gt;aggregate_l0_g9</title>
<path fill="none" stroke="black" d="M3181.95,-3937.12C3181.95,-3937.12 3181.95,-3911.41 3181.95,-3911.41"/>
<polygon fill="black" stroke="black" points="3185.45,-3911.41 3181.95,-3901.41 3178.45,-3911.41 3185.45,-3911.41"/>
</g>
<!-- expert_l0_e10_g10 -->
<g id="node63" class="node">
<title>expert_l0_e10_g10</title>
<polygon fill="lightgreen" stroke="black" points="5239.95,-4035.17 4793.95,-4035.17 4793.95,-3937.17 5239.95,-3937.17 5239.95,-4035.17"/>
<text text-anchor="middle" x="5016.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="5016.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="5016.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5016.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5016.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5016.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g10&#45;&gt;expert_l0_e10_g10 -->
<g id="edge90" class="edge">
<title>gate_l0_g10&#45;&gt;expert_l0_e10_g10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5016.95,-4070.9C5016.95,-4070.9 5016.95,-4045.36 5016.95,-4045.36"/>
<polygon fill="black" stroke="black" points="5020.45,-4045.36 5016.95,-4035.36 5013.45,-4045.36 5020.45,-4045.36"/>
</g>
<!-- expert_l0_e10_g10&#45;&gt;aggregate_l0_g10 -->
<g id="edge91" class="edge">
<title>expert_l0_e10_g10&#45;&gt;aggregate_l0_g10</title>
<path fill="none" stroke="black" d="M5016.95,-3937.12C5016.95,-3937.12 5016.95,-3911.41 5016.95,-3911.41"/>
<polygon fill="black" stroke="black" points="5020.45,-3911.41 5016.95,-3901.41 5013.45,-3911.41 5020.45,-3911.41"/>
</g>
<!-- expert_l0_e11_g11 -->
<g id="node65" class="node">
<title>expert_l0_e11_g11</title>
<polygon fill="lightgreen" stroke="black" points="6948.95,-4035.17 6502.95,-4035.17 6502.95,-3937.17 6948.95,-3937.17 6948.95,-4035.17"/>
<text text-anchor="middle" x="6725.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="6725.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="6725.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6725.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6725.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6725.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g11&#45;&gt;expert_l0_e11_g11 -->
<g id="edge94" class="edge">
<title>gate_l0_g11&#45;&gt;expert_l0_e11_g11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6725.95,-4070.9C6725.95,-4070.9 6725.95,-4045.36 6725.95,-4045.36"/>
<polygon fill="black" stroke="black" points="6729.45,-4045.36 6725.95,-4035.36 6722.45,-4045.36 6729.45,-4045.36"/>
</g>
<!-- expert_l0_e11_g11&#45;&gt;aggregate_l0_g11 -->
<g id="edge95" class="edge">
<title>expert_l0_e11_g11&#45;&gt;aggregate_l0_g11</title>
<path fill="none" stroke="black" d="M6725.95,-3937.12C6725.95,-3937.12 6725.95,-3911.41 6725.95,-3911.41"/>
<polygon fill="black" stroke="black" points="6729.45,-3911.41 6725.95,-3901.41 6722.45,-3911.41 6729.45,-3911.41"/>
</g>
<!-- expert_l0_e12_g12 -->
<g id="node67" class="node">
<title>expert_l0_e12_g12</title>
<polygon fill="lightgreen" stroke="black" points="8592.95,-4035.17 8146.95,-4035.17 8146.95,-3937.17 8592.95,-3937.17 8592.95,-4035.17"/>
<text text-anchor="middle" x="8369.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="8369.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="8369.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8369.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8369.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8369.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g12&#45;&gt;expert_l0_e12_g12 -->
<g id="edge98" class="edge">
<title>gate_l0_g12&#45;&gt;expert_l0_e12_g12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8369.95,-4070.9C8369.95,-4070.9 8369.95,-4045.36 8369.95,-4045.36"/>
<polygon fill="black" stroke="black" points="8373.45,-4045.36 8369.95,-4035.36 8366.45,-4045.36 8373.45,-4045.36"/>
</g>
<!-- expert_l0_e12_g12&#45;&gt;aggregate_l0_g12 -->
<g id="edge99" class="edge">
<title>expert_l0_e12_g12&#45;&gt;aggregate_l0_g12</title>
<path fill="none" stroke="black" d="M8482.63,-3937.12C8482.63,-3937.12 8482.63,-3911.41 8482.63,-3911.41"/>
<polygon fill="black" stroke="black" points="8486.13,-3911.41 8482.63,-3901.41 8479.13,-3911.41 8486.13,-3911.41"/>
</g>
<!-- expert_l0_e13_g13 -->
<g id="node69" class="node">
<title>expert_l0_e13_g13</title>
<polygon fill="lightgreen" stroke="black" points="10471.95,-4035.17 10025.95,-4035.17 10025.95,-3937.17 10471.95,-3937.17 10471.95,-4035.17"/>
<text text-anchor="middle" x="10248.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10248.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="10248.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10248.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10248.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10248.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g13&#45;&gt;expert_l0_e13_g13 -->
<g id="edge102" class="edge">
<title>gate_l0_g13&#45;&gt;expert_l0_e13_g13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10239.2,-4070.9C10239.2,-4070.9 10239.2,-4045.36 10239.2,-4045.36"/>
<polygon fill="black" stroke="black" points="10242.7,-4045.36 10239.2,-4035.36 10235.7,-4045.36 10242.7,-4045.36"/>
</g>
<!-- expert_l0_e13_g13&#45;&gt;aggregate_l0_g13 -->
<g id="edge103" class="edge">
<title>expert_l0_e13_g13&#45;&gt;aggregate_l0_g13</title>
<path fill="none" stroke="black" d="M10284.98,-3937.12C10284.98,-3937.12 10284.98,-3911.41 10284.98,-3911.41"/>
<polygon fill="black" stroke="black" points="10288.48,-3911.41 10284.98,-3901.41 10281.48,-3911.41 10288.48,-3911.41"/>
</g>
<!-- expert_l0_e14_g14 -->
<g id="node71" class="node">
<title>expert_l0_e14_g14</title>
<polygon fill="lightgreen" stroke="black" points="12330.95,-4035.17 11884.95,-4035.17 11884.95,-3937.17 12330.95,-3937.17 12330.95,-4035.17"/>
<text text-anchor="middle" x="12107.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12107.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="12107.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12107.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12107.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12107.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g14&#45;&gt;expert_l0_e14_g14 -->
<g id="edge106" class="edge">
<title>gate_l0_g14&#45;&gt;expert_l0_e14_g14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12086.7,-4070.9C12086.7,-4070.9 12086.7,-4045.36 12086.7,-4045.36"/>
<polygon fill="black" stroke="black" points="12090.2,-4045.36 12086.7,-4035.36 12083.2,-4045.36 12090.2,-4045.36"/>
</g>
<!-- expert_l0_e14_g14&#45;&gt;aggregate_l0_g14 -->
<g id="edge107" class="edge">
<title>expert_l0_e14_g14&#45;&gt;aggregate_l0_g14</title>
<path fill="none" stroke="black" d="M12132.48,-3937.12C12132.48,-3937.12 12132.48,-3911.41 12132.48,-3911.41"/>
<polygon fill="black" stroke="black" points="12135.98,-3911.41 12132.48,-3901.41 12128.98,-3911.41 12135.98,-3911.41"/>
</g>
<!-- expert_l0_e15_g15 -->
<g id="node73" class="node">
<title>expert_l0_e15_g15</title>
<polygon fill="lightgreen" stroke="black" points="14142.95,-4035.17 13696.95,-4035.17 13696.95,-3937.17 14142.95,-3937.17 14142.95,-4035.17"/>
<text text-anchor="middle" x="13919.95" y="-4019.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="13919.95" y="-4004.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="13919.95" y="-3989.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="13919.95" y="-3974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13919.95" y="-3959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13919.95" y="-3944.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l0_g15&#45;&gt;expert_l0_e15_g15 -->
<g id="edge110" class="edge">
<title>gate_l0_g15&#45;&gt;expert_l0_e15_g15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13910.2,-4070.9C13910.2,-4070.9 13910.2,-4045.36 13910.2,-4045.36"/>
<polygon fill="black" stroke="black" points="13913.7,-4045.36 13910.2,-4035.36 13906.7,-4045.36 13913.7,-4045.36"/>
</g>
<!-- expert_l0_e15_g15&#45;&gt;aggregate_l0_g15 -->
<g id="edge111" class="edge">
<title>expert_l0_e15_g15&#45;&gt;aggregate_l0_g15</title>
<path fill="none" stroke="black" d="M14018.63,-3937.12C14018.63,-3937.12 14018.63,-3911.41 14018.63,-3911.41"/>
<polygon fill="black" stroke="black" points="14022.13,-3911.41 14018.63,-3901.41 14015.13,-3911.41 14022.13,-3911.41"/>
</g>
<!-- mha_qkv_l1_g0 -->
<g id="node90" class="node">
<title>mha_qkv_l1_g0</title>
<polygon fill="lightcoral" stroke="black" points="1143.95,-3699.17 671.95,-3699.17 671.95,-3631.17 1143.95,-3631.17 1143.95,-3699.17"/>
<text text-anchor="middle" x="907.95" y="-3683.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 1</text>
<text text-anchor="middle" x="907.95" y="-3668.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="907.95" y="-3653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="907.95" y="-3638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l0_g0&#45;&gt;mha_qkv_l1_g0 -->
<g id="edge113" class="edge">
<title>aggregate_l0_g0&#45;&gt;mha_qkv_l1_g0</title>
<path fill="none" stroke="black" d="M785.93,-3798.16C785.93,-3798.16 785.93,-3709.21 785.93,-3709.21"/>
<polygon fill="black" stroke="black" points="789.43,-3709.21 785.93,-3699.21 782.43,-3709.21 789.43,-3709.21"/>
</g>
<!-- residual_l1_g0 -->
<g id="node115" class="node">
<title>residual_l1_g0</title>
<polygon fill="lightyellow" stroke="black" points="1335.24,-3185.17 655.52,-3185.17 480.67,-2989.17 1160.38,-2989.17 1335.24,-3185.17"/>
<text text-anchor="middle" x="907.95" y="-3120.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="907.95" y="-3105.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="907.95" y="-3090.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="907.95" y="-3075.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="907.95" y="-3060.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="907.95" y="-3045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l0_g0&#45;&gt;residual_l1_g0 -->
<g id="edge132" class="edge">
<title>aggregate_l0_g0&#45;&gt;residual_l1_g0</title>
<path fill="none" stroke="black" d="M352.9,-3735C352.9,-3543.37 352.9,-3087 352.9,-3087 352.9,-3087 557.9,-3087 557.9,-3087"/>
<polygon fill="black" stroke="black" points="557.9,-3090.5 567.9,-3087 557.9,-3083.5 557.9,-3090.5"/>
</g>
<!-- mha_qkv_l1_g1 -->
<g id="node93" class="node">
<title>mha_qkv_l1_g1</title>
<polygon fill="lightcoral" stroke="black" points="2981.95,-3699.17 2509.95,-3699.17 2509.95,-3631.17 2981.95,-3631.17 2981.95,-3699.17"/>
<text text-anchor="middle" x="2745.95" y="-3683.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 1</text>
<text text-anchor="middle" x="2745.95" y="-3668.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2745.95" y="-3653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2745.95" y="-3638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l0_g1&#45;&gt;mha_qkv_l1_g1 -->
<g id="edge115" class="edge">
<title>aggregate_l0_g1&#45;&gt;mha_qkv_l1_g1</title>
<path fill="none" stroke="black" d="M2622.93,-3799.1C2622.93,-3799.1 2622.93,-3709.37 2622.93,-3709.37"/>
<polygon fill="black" stroke="black" points="2626.43,-3709.37 2622.93,-3699.37 2619.43,-3709.37 2626.43,-3709.37"/>
</g>
<!-- residual_l1_g1 -->
<g id="node117" class="node">
<title>residual_l1_g1</title>
<polygon fill="lightyellow" stroke="black" points="3173.24,-3185.17 2493.52,-3185.17 2318.67,-2989.17 2998.38,-2989.17 3173.24,-3185.17"/>
<text text-anchor="middle" x="2745.95" y="-3120.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2745.95" y="-3105.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2745.95" y="-3090.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2745.95" y="-3075.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2745.95" y="-3060.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2745.95" y="-3045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l0_g1&#45;&gt;residual_l1_g1 -->
<g id="edge138" class="edge">
<title>aggregate_l0_g1&#45;&gt;residual_l1_g1</title>
<path fill="none" stroke="black" d="M2190.9,-3734.93C2190.9,-3536.88 2190.9,-3054 2190.9,-3054 2190.9,-3054 2366.5,-3054 2366.5,-3054"/>
<polygon fill="black" stroke="black" points="2366.5,-3057.5 2376.5,-3054 2366.5,-3050.5 2366.5,-3057.5"/>
</g>
<!-- mha_qkv_l1_g2 -->
<g id="node96" class="node">
<title>mha_qkv_l1_g2</title>
<polygon fill="lightcoral" stroke="black" points="4815.95,-3699.17 4343.95,-3699.17 4343.95,-3631.17 4815.95,-3631.17 4815.95,-3699.17"/>
<text text-anchor="middle" x="4579.95" y="-3683.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 1</text>
<text text-anchor="middle" x="4579.95" y="-3668.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4579.95" y="-3653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4579.95" y="-3638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l0_g2&#45;&gt;mha_qkv_l1_g2 -->
<g id="edge117" class="edge">
<title>aggregate_l0_g2&#45;&gt;mha_qkv_l1_g2</title>
<path fill="none" stroke="black" d="M4457.93,-3798.16C4457.93,-3798.16 4457.93,-3709.21 4457.93,-3709.21"/>
<polygon fill="black" stroke="black" points="4461.43,-3709.21 4457.93,-3699.21 4454.43,-3709.21 4461.43,-3709.21"/>
</g>
<!-- residual_l1_g2 -->
<g id="node119" class="node">
<title>residual_l1_g2</title>
<polygon fill="lightyellow" stroke="black" points="5007.24,-3185.17 4327.52,-3185.17 4152.67,-2989.17 4832.38,-2989.17 5007.24,-3185.17"/>
<text text-anchor="middle" x="4579.95" y="-3120.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4579.95" y="-3105.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4579.95" y="-3090.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4579.95" y="-3075.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4579.95" y="-3060.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4579.95" y="-3045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l0_g2&#45;&gt;residual_l1_g2 -->
<g id="edge144" class="edge">
<title>aggregate_l0_g2&#45;&gt;residual_l1_g2</title>
<path fill="none" stroke="black" d="M4026.4,-3735C4026.4,-3543.37 4026.4,-3087 4026.4,-3087 4026.4,-3087 4229.63,-3087 4229.63,-3087"/>
<polygon fill="black" stroke="black" points="4229.63,-3090.5 4239.63,-3087 4229.63,-3083.5 4229.63,-3090.5"/>
</g>
<!-- mha_qkv_l1_g3 -->
<g id="node99" class="node">
<title>mha_qkv_l1_g3</title>
<polygon fill="lightcoral" stroke="black" points="6651.95,-3699.17 6179.95,-3699.17 6179.95,-3631.17 6651.95,-3631.17 6651.95,-3699.17"/>
<text text-anchor="middle" x="6415.95" y="-3683.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 1</text>
<text text-anchor="middle" x="6415.95" y="-3668.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6415.95" y="-3653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6415.95" y="-3638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l0_g3&#45;&gt;mha_qkv_l1_g3 -->
<g id="edge119" class="edge">
<title>aggregate_l0_g3&#45;&gt;mha_qkv_l1_g3</title>
<path fill="none" stroke="black" d="M6293.93,-3798.16C6293.93,-3798.16 6293.93,-3709.21 6293.93,-3709.21"/>
<polygon fill="black" stroke="black" points="6297.43,-3709.21 6293.93,-3699.21 6290.43,-3709.21 6297.43,-3709.21"/>
</g>
<!-- residual_l1_g3 -->
<g id="node121" class="node">
<title>residual_l1_g3</title>
<polygon fill="lightyellow" stroke="black" points="6843.24,-3185.17 6163.52,-3185.17 5988.67,-2989.17 6668.38,-2989.17 6843.24,-3185.17"/>
<text text-anchor="middle" x="6415.95" y="-3120.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6415.95" y="-3105.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="6415.95" y="-3090.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6415.95" y="-3075.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6415.95" y="-3060.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6415.95" y="-3045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l0_g3&#45;&gt;residual_l1_g3 -->
<g id="edge150" class="edge">
<title>aggregate_l0_g3&#45;&gt;residual_l1_g3</title>
<path fill="none" stroke="black" d="M5875.9,-3735C5875.9,-3543.37 5875.9,-3087 5875.9,-3087 5875.9,-3087 6065.85,-3087 6065.85,-3087"/>
<polygon fill="black" stroke="black" points="6065.85,-3090.5 6075.85,-3087 6065.85,-3083.5 6065.85,-3090.5"/>
</g>
<!-- mha_qkv_l1_g4 -->
<g id="node102" class="node">
<title>mha_qkv_l1_g4</title>
<polygon fill="lightcoral" stroke="black" points="8489.95,-3699.17 8017.95,-3699.17 8017.95,-3631.17 8489.95,-3631.17 8489.95,-3699.17"/>
<text text-anchor="middle" x="8253.95" y="-3683.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 1</text>
<text text-anchor="middle" x="8253.95" y="-3668.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8253.95" y="-3653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8253.95" y="-3638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l0_g4&#45;&gt;mha_qkv_l1_g4 -->
<g id="edge121" class="edge">
<title>aggregate_l0_g4&#45;&gt;mha_qkv_l1_g4</title>
<path fill="none" stroke="black" d="M8130.93,-3799.1C8130.93,-3799.1 8130.93,-3709.37 8130.93,-3709.37"/>
<polygon fill="black" stroke="black" points="8134.43,-3709.37 8130.93,-3699.37 8127.43,-3709.37 8134.43,-3709.37"/>
</g>
<!-- residual_l1_g4 -->
<g id="node123" class="node">
<title>residual_l1_g4</title>
<polygon fill="lightyellow" stroke="black" points="8681.24,-3185.17 8001.52,-3185.17 7826.67,-2989.17 8506.38,-2989.17 8681.24,-3185.17"/>
<text text-anchor="middle" x="8253.95" y="-3120.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8253.95" y="-3105.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="8253.95" y="-3090.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8253.95" y="-3075.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8253.95" y="-3060.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8253.95" y="-3045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l0_g4&#45;&gt;residual_l1_g4 -->
<g id="edge156" class="edge">
<title>aggregate_l0_g4&#45;&gt;residual_l1_g4</title>
<path fill="none" stroke="black" d="M7714.9,-3735C7714.9,-3543.37 7714.9,-3087 7714.9,-3087 7714.9,-3087 7903.71,-3087 7903.71,-3087"/>
<polygon fill="black" stroke="black" points="7903.71,-3090.5 7913.71,-3087 7903.71,-3083.5 7903.71,-3090.5"/>
</g>
<!-- mha_qkv_l1_g5 -->
<g id="node105" class="node">
<title>mha_qkv_l1_g5</title>
<polygon fill="lightcoral" stroke="black" points="10323.95,-3699.17 9851.95,-3699.17 9851.95,-3631.17 10323.95,-3631.17 10323.95,-3699.17"/>
<text text-anchor="middle" x="10087.95" y="-3683.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 1</text>
<text text-anchor="middle" x="10087.95" y="-3668.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10087.95" y="-3653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10087.95" y="-3638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l0_g5&#45;&gt;mha_qkv_l1_g5 -->
<g id="edge123" class="edge">
<title>aggregate_l0_g5&#45;&gt;mha_qkv_l1_g5</title>
<path fill="none" stroke="black" d="M9965.93,-3798.16C9965.93,-3798.16 9965.93,-3709.21 9965.93,-3709.21"/>
<polygon fill="black" stroke="black" points="9969.43,-3709.21 9965.93,-3699.21 9962.43,-3709.21 9969.43,-3709.21"/>
</g>
<!-- residual_l1_g5 -->
<g id="node125" class="node">
<title>residual_l1_g5</title>
<polygon fill="lightyellow" stroke="black" points="10515.24,-3185.17 9835.52,-3185.17 9660.67,-2989.17 10340.38,-2989.17 10515.24,-3185.17"/>
<text text-anchor="middle" x="10087.95" y="-3120.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10087.95" y="-3105.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="10087.95" y="-3090.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10087.95" y="-3075.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10087.95" y="-3060.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10087.95" y="-3045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l0_g5&#45;&gt;residual_l1_g5 -->
<g id="edge162" class="edge">
<title>aggregate_l0_g5&#45;&gt;residual_l1_g5</title>
<path fill="none" stroke="black" d="M9554.9,-3735C9554.9,-3543.37 9554.9,-3087 9554.9,-3087 9554.9,-3087 9737.72,-3087 9737.72,-3087"/>
<polygon fill="black" stroke="black" points="9737.72,-3090.5 9747.72,-3087 9737.72,-3083.5 9737.72,-3090.5"/>
</g>
<!-- mha_qkv_l1_g6 -->
<g id="node108" class="node">
<title>mha_qkv_l1_g6</title>
<polygon fill="lightcoral" stroke="black" points="12156.95,-3699.17 11684.95,-3699.17 11684.95,-3631.17 12156.95,-3631.17 12156.95,-3699.17"/>
<text text-anchor="middle" x="11920.95" y="-3683.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 1</text>
<text text-anchor="middle" x="11920.95" y="-3668.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11920.95" y="-3653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="11920.95" y="-3638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l0_g6&#45;&gt;mha_qkv_l1_g6 -->
<g id="edge125" class="edge">
<title>aggregate_l0_g6&#45;&gt;mha_qkv_l1_g6</title>
<path fill="none" stroke="black" d="M11800.43,-3796.89C11800.43,-3796.89 11800.43,-3709.19 11800.43,-3709.19"/>
<polygon fill="black" stroke="black" points="11803.93,-3709.19 11800.43,-3699.19 11796.93,-3709.19 11803.93,-3709.19"/>
</g>
<!-- residual_l1_g6 -->
<g id="node127" class="node">
<title>residual_l1_g6</title>
<polygon fill="lightyellow" stroke="black" points="12348.24,-3185.17 11668.52,-3185.17 11493.67,-2989.17 12173.38,-2989.17 12348.24,-3185.17"/>
<text text-anchor="middle" x="11920.95" y="-3120.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11920.95" y="-3105.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="11920.95" y="-3090.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11920.95" y="-3075.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="11920.95" y="-3060.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="11920.95" y="-3045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l0_g6&#45;&gt;residual_l1_g6 -->
<g id="edge168" class="edge">
<title>aggregate_l0_g6&#45;&gt;residual_l1_g6</title>
<path fill="none" stroke="black" d="M11390.9,-3735.04C11390.9,-3534.02 11390.9,-3038 11390.9,-3038 11390.9,-3038 11527.14,-3038 11527.14,-3038"/>
<polygon fill="black" stroke="black" points="11527.14,-3041.5 11537.14,-3038 11527.14,-3034.5 11527.14,-3041.5"/>
</g>
<!-- mha_qkv_l1_g7 -->
<g id="node111" class="node">
<title>mha_qkv_l1_g7</title>
<polygon fill="lightcoral" stroke="black" points="13995.95,-3699.17 13523.95,-3699.17 13523.95,-3631.17 13995.95,-3631.17 13995.95,-3699.17"/>
<text text-anchor="middle" x="13759.95" y="-3683.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 1</text>
<text text-anchor="middle" x="13759.95" y="-3668.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13759.95" y="-3653.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="13759.95" y="-3638.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l0_g7&#45;&gt;mha_qkv_l1_g7 -->
<g id="edge127" class="edge">
<title>aggregate_l0_g7&#45;&gt;mha_qkv_l1_g7</title>
<path fill="none" stroke="black" d="M13637.93,-3798.16C13637.93,-3798.16 13637.93,-3709.21 13637.93,-3709.21"/>
<polygon fill="black" stroke="black" points="13641.43,-3709.21 13637.93,-3699.21 13634.43,-3709.21 13641.43,-3709.21"/>
</g>
<!-- residual_l1_g7 -->
<g id="node129" class="node">
<title>residual_l1_g7</title>
<polygon fill="lightyellow" stroke="black" points="14187.24,-3185.17 13507.52,-3185.17 13332.67,-2989.17 14012.38,-2989.17 14187.24,-3185.17"/>
<text text-anchor="middle" x="13759.95" y="-3120.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13759.95" y="-3105.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="13759.95" y="-3090.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13759.95" y="-3075.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="13759.95" y="-3060.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="13759.95" y="-3045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l0_g7&#45;&gt;residual_l1_g7 -->
<g id="edge174" class="edge">
<title>aggregate_l0_g7&#45;&gt;residual_l1_g7</title>
<path fill="none" stroke="black" d="M13229.4,-3735.04C13229.4,-3534.02 13229.4,-3038 13229.4,-3038 13229.4,-3038 13366.13,-3038 13366.13,-3038"/>
<polygon fill="black" stroke="black" points="13366.13,-3041.5 13376.13,-3038 13366.13,-3034.5 13366.13,-3041.5"/>
</g>
<!-- aggregate_l0_g8&#45;&gt;mha_qkv_l1_g0 -->
<g id="edge114" class="edge">
<title>aggregate_l0_g8&#45;&gt;mha_qkv_l1_g0</title>
<path fill="none" stroke="black" d="M1030.98,-3734.95C1030.98,-3734.95 1030.98,-3709.23 1030.98,-3709.23"/>
<polygon fill="black" stroke="black" points="1034.48,-3709.23 1030.98,-3699.23 1027.48,-3709.23 1034.48,-3709.23"/>
</g>
<!-- aggregate_l0_g8&#45;&gt;residual_l1_g0 -->
<g id="edge133" class="edge">
<title>aggregate_l0_g8&#45;&gt;residual_l1_g0</title>
<path fill="none" stroke="black" d="M1474.77,-3734.87C1474.77,-3549.48 1474.77,-3119 1474.77,-3119 1474.77,-3119 1286.53,-3119 1286.53,-3119"/>
<polygon fill="black" stroke="black" points="1286.53,-3115.5 1276.53,-3119 1286.53,-3122.5 1286.53,-3115.5"/>
</g>
<!-- aggregate_l0_g9&#45;&gt;mha_qkv_l1_g1 -->
<g id="edge116" class="edge">
<title>aggregate_l0_g9&#45;&gt;mha_qkv_l1_g1</title>
<path fill="none" stroke="black" d="M2867.98,-3734.95C2867.98,-3734.95 2867.98,-3709.23 2867.98,-3709.23"/>
<polygon fill="black" stroke="black" points="2871.48,-3709.23 2867.98,-3699.23 2864.48,-3709.23 2871.48,-3709.23"/>
</g>
<!-- aggregate_l0_g9&#45;&gt;residual_l1_g1 -->
<g id="edge139" class="edge">
<title>aggregate_l0_g9&#45;&gt;residual_l1_g1</title>
<path fill="none" stroke="black" d="M3300.27,-3734.86C3300.27,-3552.88 3300.27,-3136 3300.27,-3136 3300.27,-3136 3139.43,-3136 3139.43,-3136"/>
<polygon fill="black" stroke="black" points="3139.43,-3132.5 3129.43,-3136 3139.43,-3139.5 3139.43,-3132.5"/>
</g>
<!-- aggregate_l0_g10&#45;&gt;mha_qkv_l1_g2 -->
<g id="edge118" class="edge">
<title>aggregate_l0_g10&#45;&gt;mha_qkv_l1_g2</title>
<path fill="none" stroke="black" d="M4702.98,-3734.95C4702.98,-3734.95 4702.98,-3709.23 4702.98,-3709.23"/>
<polygon fill="black" stroke="black" points="4706.48,-3709.23 4702.98,-3699.23 4699.48,-3709.23 4706.48,-3709.23"/>
</g>
<!-- aggregate_l0_g10&#45;&gt;residual_l1_g2 -->
<g id="edge145" class="edge">
<title>aggregate_l0_g10&#45;&gt;residual_l1_g2</title>
<path fill="none" stroke="black" d="M5134.77,-3734.86C5134.77,-3552.88 5134.77,-3136 5134.77,-3136 5134.77,-3136 4973.4,-3136 4973.4,-3136"/>
<polygon fill="black" stroke="black" points="4973.4,-3132.5 4963.4,-3136 4973.4,-3139.5 4973.4,-3132.5"/>
</g>
<!-- aggregate_l0_g11&#45;&gt;mha_qkv_l1_g3 -->
<g id="edge120" class="edge">
<title>aggregate_l0_g11&#45;&gt;mha_qkv_l1_g3</title>
<path fill="none" stroke="black" d="M6538.98,-3734.95C6538.98,-3734.95 6538.98,-3709.23 6538.98,-3709.23"/>
<polygon fill="black" stroke="black" points="6542.48,-3709.23 6538.98,-3699.23 6535.48,-3709.23 6542.48,-3709.23"/>
</g>
<!-- aggregate_l0_g11&#45;&gt;residual_l1_g3 -->
<g id="edge151" class="edge">
<title>aggregate_l0_g11&#45;&gt;residual_l1_g3</title>
<path fill="none" stroke="black" d="M6976.27,-3734.86C6976.27,-3552.88 6976.27,-3136 6976.27,-3136 6976.27,-3136 6809.75,-3136 6809.75,-3136"/>
<polygon fill="black" stroke="black" points="6809.75,-3132.5 6799.75,-3136 6809.75,-3139.5 6809.75,-3132.5"/>
</g>
<!-- aggregate_l0_g12&#45;&gt;mha_qkv_l1_g4 -->
<g id="edge122" class="edge">
<title>aggregate_l0_g12&#45;&gt;mha_qkv_l1_g4</title>
<path fill="none" stroke="black" d="M8375.98,-3734.95C8375.98,-3734.95 8375.98,-3709.23 8375.98,-3709.23"/>
<polygon fill="black" stroke="black" points="8379.48,-3709.23 8375.98,-3699.23 8372.48,-3709.23 8379.48,-3709.23"/>
</g>
<!-- aggregate_l0_g12&#45;&gt;residual_l1_g4 -->
<g id="edge157" class="edge">
<title>aggregate_l0_g12&#45;&gt;residual_l1_g4</title>
<path fill="none" stroke="black" d="M8816.27,-3734.86C8816.27,-3552.88 8816.27,-3136 8816.27,-3136 8816.27,-3136 8647.58,-3136 8647.58,-3136"/>
<polygon fill="black" stroke="black" points="8647.58,-3132.5 8637.58,-3136 8647.58,-3139.5 8647.58,-3132.5"/>
</g>
<!-- aggregate_l0_g13&#45;&gt;mha_qkv_l1_g5 -->
<g id="edge124" class="edge">
<title>aggregate_l0_g13&#45;&gt;mha_qkv_l1_g5</title>
<path fill="none" stroke="black" d="M10210.98,-3734.95C10210.98,-3734.95 10210.98,-3709.23 10210.98,-3709.23"/>
<polygon fill="black" stroke="black" points="10214.48,-3709.23 10210.98,-3699.23 10207.48,-3709.23 10214.48,-3709.23"/>
</g>
<!-- aggregate_l0_g13&#45;&gt;residual_l1_g5 -->
<g id="edge163" class="edge">
<title>aggregate_l0_g13&#45;&gt;residual_l1_g5</title>
<path fill="none" stroke="black" d="M10652.27,-3734.86C10652.27,-3552.88 10652.27,-3136 10652.27,-3136 10652.27,-3136 10481.39,-3136 10481.39,-3136"/>
<polygon fill="black" stroke="black" points="10481.39,-3132.5 10471.39,-3136 10481.39,-3139.5 10481.39,-3132.5"/>
</g>
<!-- aggregate_l0_g14&#45;&gt;mha_qkv_l1_g6 -->
<g id="edge126" class="edge">
<title>aggregate_l0_g14&#45;&gt;mha_qkv_l1_g6</title>
<path fill="none" stroke="black" d="M12045.48,-3734.95C12045.48,-3734.95 12045.48,-3709.23 12045.48,-3709.23"/>
<polygon fill="black" stroke="black" points="12048.98,-3709.23 12045.48,-3699.23 12041.98,-3709.23 12048.98,-3709.23"/>
</g>
<!-- aggregate_l0_g14&#45;&gt;residual_l1_g6 -->
<g id="edge169" class="edge">
<title>aggregate_l0_g14&#45;&gt;residual_l1_g6</title>
<path fill="none" stroke="black" d="M12487.77,-3734.86C12487.77,-3552.88 12487.77,-3136 12487.77,-3136 12487.77,-3136 12314.52,-3136 12314.52,-3136"/>
<polygon fill="black" stroke="black" points="12314.52,-3132.5 12304.52,-3136 12314.52,-3139.5 12314.52,-3132.5"/>
</g>
<!-- aggregate_l0_g15&#45;&gt;mha_qkv_l1_g7 -->
<g id="edge128" class="edge">
<title>aggregate_l0_g15&#45;&gt;mha_qkv_l1_g7</title>
<path fill="none" stroke="black" d="M13882.98,-3734.95C13882.98,-3734.95 13882.98,-3709.23 13882.98,-3709.23"/>
<polygon fill="black" stroke="black" points="13886.48,-3709.23 13882.98,-3699.23 13879.48,-3709.23 13886.48,-3709.23"/>
</g>
<!-- aggregate_l0_g15&#45;&gt;residual_l1_g7 -->
<g id="edge175" class="edge">
<title>aggregate_l0_g15&#45;&gt;residual_l1_g7</title>
<path fill="none" stroke="black" d="M14326.77,-3734.87C14326.77,-3549.48 14326.77,-3119 14326.77,-3119 14326.77,-3119 14138.53,-3119 14138.53,-3119"/>
<polygon fill="black" stroke="black" points="14138.53,-3115.5 14128.53,-3119 14138.53,-3122.5 14138.53,-3115.5"/>
</g>
<!-- mha_attn_l1_g0 -->
<g id="node91" class="node">
<title>mha_attn_l1_g0</title>
<polygon fill="lightcoral" stroke="black" points="1143.95,-3595.17 671.95,-3595.17 671.95,-3527.17 1143.95,-3527.17 1143.95,-3595.17"/>
<text text-anchor="middle" x="907.95" y="-3579.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 1</text>
<text text-anchor="middle" x="907.95" y="-3564.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="907.95" y="-3549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="907.95" y="-3534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l1_g0&#45;&gt;mha_attn_l1_g0 -->
<g id="edge129" class="edge">
<title>mha_qkv_l1_g0&#45;&gt;mha_attn_l1_g0</title>
<path fill="none" stroke="black" d="M907.95,-3631.11C907.95,-3631.11 907.95,-3605.3 907.95,-3605.3"/>
<polygon fill="black" stroke="black" points="911.45,-3605.3 907.95,-3595.3 904.45,-3605.3 911.45,-3605.3"/>
</g>
<!-- mha_out_l1_g0 -->
<g id="node92" class="node">
<title>mha_out_l1_g0</title>
<polygon fill="lightcoral" stroke="black" points="1137.95,-3491.17 677.95,-3491.17 677.95,-3423.17 1137.95,-3423.17 1137.95,-3491.17"/>
<text text-anchor="middle" x="907.95" y="-3475.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 1</text>
<text text-anchor="middle" x="907.95" y="-3460.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="907.95" y="-3445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="907.95" y="-3430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l1_g0&#45;&gt;mha_out_l1_g0 -->
<g id="edge130" class="edge">
<title>mha_attn_l1_g0&#45;&gt;mha_out_l1_g0</title>
<path fill="none" stroke="black" d="M907.95,-3527.11C907.95,-3527.11 907.95,-3501.3 907.95,-3501.3"/>
<polygon fill="black" stroke="black" points="911.45,-3501.3 907.95,-3491.3 904.45,-3501.3 911.45,-3501.3"/>
</g>
<!-- allreduce_l1_g0 -->
<g id="node114" class="node">
<title>allreduce_l1_g0</title>
<polygon fill="lightyellow" stroke="black" points="1335.24,-3387.17 655.52,-3387.17 480.67,-3221.17 1160.38,-3221.17 1335.24,-3387.17"/>
<text text-anchor="middle" x="907.95" y="-3330.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="907.95" y="-3315.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="907.95" y="-3300.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="907.95" y="-3285.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="907.95" y="-3270.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l1_g0&#45;&gt;allreduce_l1_g0 -->
<g id="edge131" class="edge">
<title>mha_out_l1_g0&#45;&gt;allreduce_l1_g0</title>
<path fill="none" stroke="black" d="M907.95,-3422.83C907.95,-3422.83 907.95,-3397.43 907.95,-3397.43"/>
<polygon fill="black" stroke="black" points="911.45,-3397.43 907.95,-3387.43 904.45,-3397.43 911.45,-3397.43"/>
</g>
<!-- mha_attn_l1_g1 -->
<g id="node94" class="node">
<title>mha_attn_l1_g1</title>
<polygon fill="lightcoral" stroke="black" points="2981.95,-3595.17 2509.95,-3595.17 2509.95,-3527.17 2981.95,-3527.17 2981.95,-3595.17"/>
<text text-anchor="middle" x="2745.95" y="-3579.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 1</text>
<text text-anchor="middle" x="2745.95" y="-3564.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2745.95" y="-3549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="2745.95" y="-3534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l1_g1&#45;&gt;mha_attn_l1_g1 -->
<g id="edge135" class="edge">
<title>mha_qkv_l1_g1&#45;&gt;mha_attn_l1_g1</title>
<path fill="none" stroke="black" d="M2745.95,-3631.11C2745.95,-3631.11 2745.95,-3605.3 2745.95,-3605.3"/>
<polygon fill="black" stroke="black" points="2749.45,-3605.3 2745.95,-3595.3 2742.45,-3605.3 2749.45,-3605.3"/>
</g>
<!-- mha_out_l1_g1 -->
<g id="node95" class="node">
<title>mha_out_l1_g1</title>
<polygon fill="lightcoral" stroke="black" points="2975.95,-3491.17 2515.95,-3491.17 2515.95,-3423.17 2975.95,-3423.17 2975.95,-3491.17"/>
<text text-anchor="middle" x="2745.95" y="-3475.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 1</text>
<text text-anchor="middle" x="2745.95" y="-3460.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2745.95" y="-3445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="2745.95" y="-3430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l1_g1&#45;&gt;mha_out_l1_g1 -->
<g id="edge136" class="edge">
<title>mha_attn_l1_g1&#45;&gt;mha_out_l1_g1</title>
<path fill="none" stroke="black" d="M2745.95,-3527.11C2745.95,-3527.11 2745.95,-3501.3 2745.95,-3501.3"/>
<polygon fill="black" stroke="black" points="2749.45,-3501.3 2745.95,-3491.3 2742.45,-3501.3 2749.45,-3501.3"/>
</g>
<!-- allreduce_l1_g1 -->
<g id="node116" class="node">
<title>allreduce_l1_g1</title>
<polygon fill="lightyellow" stroke="black" points="3173.24,-3387.17 2493.52,-3387.17 2318.67,-3221.17 2998.38,-3221.17 3173.24,-3387.17"/>
<text text-anchor="middle" x="2745.95" y="-3330.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="2745.95" y="-3315.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2745.95" y="-3300.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2745.95" y="-3285.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="2745.95" y="-3270.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l1_g1&#45;&gt;allreduce_l1_g1 -->
<g id="edge137" class="edge">
<title>mha_out_l1_g1&#45;&gt;allreduce_l1_g1</title>
<path fill="none" stroke="black" d="M2745.95,-3422.83C2745.95,-3422.83 2745.95,-3397.43 2745.95,-3397.43"/>
<polygon fill="black" stroke="black" points="2749.45,-3397.43 2745.95,-3387.43 2742.45,-3397.43 2749.45,-3397.43"/>
</g>
<!-- mha_attn_l1_g2 -->
<g id="node97" class="node">
<title>mha_attn_l1_g2</title>
<polygon fill="lightcoral" stroke="black" points="4815.95,-3595.17 4343.95,-3595.17 4343.95,-3527.17 4815.95,-3527.17 4815.95,-3595.17"/>
<text text-anchor="middle" x="4579.95" y="-3579.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 1</text>
<text text-anchor="middle" x="4579.95" y="-3564.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4579.95" y="-3549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="4579.95" y="-3534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l1_g2&#45;&gt;mha_attn_l1_g2 -->
<g id="edge141" class="edge">
<title>mha_qkv_l1_g2&#45;&gt;mha_attn_l1_g2</title>
<path fill="none" stroke="black" d="M4579.95,-3631.11C4579.95,-3631.11 4579.95,-3605.3 4579.95,-3605.3"/>
<polygon fill="black" stroke="black" points="4583.45,-3605.3 4579.95,-3595.3 4576.45,-3605.3 4583.45,-3605.3"/>
</g>
<!-- mha_out_l1_g2 -->
<g id="node98" class="node">
<title>mha_out_l1_g2</title>
<polygon fill="lightcoral" stroke="black" points="4809.95,-3491.17 4349.95,-3491.17 4349.95,-3423.17 4809.95,-3423.17 4809.95,-3491.17"/>
<text text-anchor="middle" x="4579.95" y="-3475.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 1</text>
<text text-anchor="middle" x="4579.95" y="-3460.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4579.95" y="-3445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="4579.95" y="-3430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l1_g2&#45;&gt;mha_out_l1_g2 -->
<g id="edge142" class="edge">
<title>mha_attn_l1_g2&#45;&gt;mha_out_l1_g2</title>
<path fill="none" stroke="black" d="M4579.95,-3527.11C4579.95,-3527.11 4579.95,-3501.3 4579.95,-3501.3"/>
<polygon fill="black" stroke="black" points="4583.45,-3501.3 4579.95,-3491.3 4576.45,-3501.3 4583.45,-3501.3"/>
</g>
<!-- allreduce_l1_g2 -->
<g id="node118" class="node">
<title>allreduce_l1_g2</title>
<polygon fill="lightyellow" stroke="black" points="5007.24,-3387.17 4327.52,-3387.17 4152.67,-3221.17 4832.38,-3221.17 5007.24,-3387.17"/>
<text text-anchor="middle" x="4579.95" y="-3330.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="4579.95" y="-3315.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4579.95" y="-3300.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4579.95" y="-3285.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="4579.95" y="-3270.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l1_g2&#45;&gt;allreduce_l1_g2 -->
<g id="edge143" class="edge">
<title>mha_out_l1_g2&#45;&gt;allreduce_l1_g2</title>
<path fill="none" stroke="black" d="M4579.95,-3422.83C4579.95,-3422.83 4579.95,-3397.43 4579.95,-3397.43"/>
<polygon fill="black" stroke="black" points="4583.45,-3397.43 4579.95,-3387.43 4576.45,-3397.43 4583.45,-3397.43"/>
</g>
<!-- mha_attn_l1_g3 -->
<g id="node100" class="node">
<title>mha_attn_l1_g3</title>
<polygon fill="lightcoral" stroke="black" points="6651.95,-3595.17 6179.95,-3595.17 6179.95,-3527.17 6651.95,-3527.17 6651.95,-3595.17"/>
<text text-anchor="middle" x="6415.95" y="-3579.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 1</text>
<text text-anchor="middle" x="6415.95" y="-3564.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6415.95" y="-3549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6415.95" y="-3534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l1_g3&#45;&gt;mha_attn_l1_g3 -->
<g id="edge147" class="edge">
<title>mha_qkv_l1_g3&#45;&gt;mha_attn_l1_g3</title>
<path fill="none" stroke="black" d="M6415.95,-3631.11C6415.95,-3631.11 6415.95,-3605.3 6415.95,-3605.3"/>
<polygon fill="black" stroke="black" points="6419.45,-3605.3 6415.95,-3595.3 6412.45,-3605.3 6419.45,-3605.3"/>
</g>
<!-- mha_out_l1_g3 -->
<g id="node101" class="node">
<title>mha_out_l1_g3</title>
<polygon fill="lightcoral" stroke="black" points="6645.95,-3491.17 6185.95,-3491.17 6185.95,-3423.17 6645.95,-3423.17 6645.95,-3491.17"/>
<text text-anchor="middle" x="6415.95" y="-3475.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 1</text>
<text text-anchor="middle" x="6415.95" y="-3460.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6415.95" y="-3445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6415.95" y="-3430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l1_g3&#45;&gt;mha_out_l1_g3 -->
<g id="edge148" class="edge">
<title>mha_attn_l1_g3&#45;&gt;mha_out_l1_g3</title>
<path fill="none" stroke="black" d="M6415.95,-3527.11C6415.95,-3527.11 6415.95,-3501.3 6415.95,-3501.3"/>
<polygon fill="black" stroke="black" points="6419.45,-3501.3 6415.95,-3491.3 6412.45,-3501.3 6419.45,-3501.3"/>
</g>
<!-- allreduce_l1_g3 -->
<g id="node120" class="node">
<title>allreduce_l1_g3</title>
<polygon fill="lightyellow" stroke="black" points="6843.24,-3387.17 6163.52,-3387.17 5988.67,-3221.17 6668.38,-3221.17 6843.24,-3387.17"/>
<text text-anchor="middle" x="6415.95" y="-3330.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="6415.95" y="-3315.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="6415.95" y="-3300.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6415.95" y="-3285.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="6415.95" y="-3270.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l1_g3&#45;&gt;allreduce_l1_g3 -->
<g id="edge149" class="edge">
<title>mha_out_l1_g3&#45;&gt;allreduce_l1_g3</title>
<path fill="none" stroke="black" d="M6415.95,-3422.83C6415.95,-3422.83 6415.95,-3397.43 6415.95,-3397.43"/>
<polygon fill="black" stroke="black" points="6419.45,-3397.43 6415.95,-3387.43 6412.45,-3397.43 6419.45,-3397.43"/>
</g>
<!-- mha_attn_l1_g4 -->
<g id="node103" class="node">
<title>mha_attn_l1_g4</title>
<polygon fill="lightcoral" stroke="black" points="8489.95,-3595.17 8017.95,-3595.17 8017.95,-3527.17 8489.95,-3527.17 8489.95,-3595.17"/>
<text text-anchor="middle" x="8253.95" y="-3579.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 1</text>
<text text-anchor="middle" x="8253.95" y="-3564.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8253.95" y="-3549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8253.95" y="-3534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l1_g4&#45;&gt;mha_attn_l1_g4 -->
<g id="edge153" class="edge">
<title>mha_qkv_l1_g4&#45;&gt;mha_attn_l1_g4</title>
<path fill="none" stroke="black" d="M8253.95,-3631.11C8253.95,-3631.11 8253.95,-3605.3 8253.95,-3605.3"/>
<polygon fill="black" stroke="black" points="8257.45,-3605.3 8253.95,-3595.3 8250.45,-3605.3 8257.45,-3605.3"/>
</g>
<!-- mha_out_l1_g4 -->
<g id="node104" class="node">
<title>mha_out_l1_g4</title>
<polygon fill="lightcoral" stroke="black" points="8483.95,-3491.17 8023.95,-3491.17 8023.95,-3423.17 8483.95,-3423.17 8483.95,-3491.17"/>
<text text-anchor="middle" x="8253.95" y="-3475.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 1</text>
<text text-anchor="middle" x="8253.95" y="-3460.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8253.95" y="-3445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8253.95" y="-3430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l1_g4&#45;&gt;mha_out_l1_g4 -->
<g id="edge154" class="edge">
<title>mha_attn_l1_g4&#45;&gt;mha_out_l1_g4</title>
<path fill="none" stroke="black" d="M8253.95,-3527.11C8253.95,-3527.11 8253.95,-3501.3 8253.95,-3501.3"/>
<polygon fill="black" stroke="black" points="8257.45,-3501.3 8253.95,-3491.3 8250.45,-3501.3 8257.45,-3501.3"/>
</g>
<!-- allreduce_l1_g4 -->
<g id="node122" class="node">
<title>allreduce_l1_g4</title>
<polygon fill="lightyellow" stroke="black" points="8681.24,-3387.17 8001.52,-3387.17 7826.67,-3221.17 8506.38,-3221.17 8681.24,-3387.17"/>
<text text-anchor="middle" x="8253.95" y="-3330.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="8253.95" y="-3315.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="8253.95" y="-3300.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8253.95" y="-3285.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="8253.95" y="-3270.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l1_g4&#45;&gt;allreduce_l1_g4 -->
<g id="edge155" class="edge">
<title>mha_out_l1_g4&#45;&gt;allreduce_l1_g4</title>
<path fill="none" stroke="black" d="M8253.95,-3422.83C8253.95,-3422.83 8253.95,-3397.43 8253.95,-3397.43"/>
<polygon fill="black" stroke="black" points="8257.45,-3397.43 8253.95,-3387.43 8250.45,-3397.43 8257.45,-3397.43"/>
</g>
<!-- mha_attn_l1_g5 -->
<g id="node106" class="node">
<title>mha_attn_l1_g5</title>
<polygon fill="lightcoral" stroke="black" points="10323.95,-3595.17 9851.95,-3595.17 9851.95,-3527.17 10323.95,-3527.17 10323.95,-3595.17"/>
<text text-anchor="middle" x="10087.95" y="-3579.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 1</text>
<text text-anchor="middle" x="10087.95" y="-3564.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10087.95" y="-3549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10087.95" y="-3534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l1_g5&#45;&gt;mha_attn_l1_g5 -->
<g id="edge159" class="edge">
<title>mha_qkv_l1_g5&#45;&gt;mha_attn_l1_g5</title>
<path fill="none" stroke="black" d="M10087.95,-3631.11C10087.95,-3631.11 10087.95,-3605.3 10087.95,-3605.3"/>
<polygon fill="black" stroke="black" points="10091.45,-3605.3 10087.95,-3595.3 10084.45,-3605.3 10091.45,-3605.3"/>
</g>
<!-- mha_out_l1_g5 -->
<g id="node107" class="node">
<title>mha_out_l1_g5</title>
<polygon fill="lightcoral" stroke="black" points="10317.95,-3491.17 9857.95,-3491.17 9857.95,-3423.17 10317.95,-3423.17 10317.95,-3491.17"/>
<text text-anchor="middle" x="10087.95" y="-3475.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 1</text>
<text text-anchor="middle" x="10087.95" y="-3460.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10087.95" y="-3445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10087.95" y="-3430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l1_g5&#45;&gt;mha_out_l1_g5 -->
<g id="edge160" class="edge">
<title>mha_attn_l1_g5&#45;&gt;mha_out_l1_g5</title>
<path fill="none" stroke="black" d="M10087.95,-3527.11C10087.95,-3527.11 10087.95,-3501.3 10087.95,-3501.3"/>
<polygon fill="black" stroke="black" points="10091.45,-3501.3 10087.95,-3491.3 10084.45,-3501.3 10091.45,-3501.3"/>
</g>
<!-- allreduce_l1_g5 -->
<g id="node124" class="node">
<title>allreduce_l1_g5</title>
<polygon fill="lightyellow" stroke="black" points="10515.24,-3387.17 9835.52,-3387.17 9660.67,-3221.17 10340.38,-3221.17 10515.24,-3387.17"/>
<text text-anchor="middle" x="10087.95" y="-3330.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="10087.95" y="-3315.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="10087.95" y="-3300.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10087.95" y="-3285.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="10087.95" y="-3270.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l1_g5&#45;&gt;allreduce_l1_g5 -->
<g id="edge161" class="edge">
<title>mha_out_l1_g5&#45;&gt;allreduce_l1_g5</title>
<path fill="none" stroke="black" d="M10087.95,-3422.83C10087.95,-3422.83 10087.95,-3397.43 10087.95,-3397.43"/>
<polygon fill="black" stroke="black" points="10091.45,-3397.43 10087.95,-3387.43 10084.45,-3397.43 10091.45,-3397.43"/>
</g>
<!-- mha_attn_l1_g6 -->
<g id="node109" class="node">
<title>mha_attn_l1_g6</title>
<polygon fill="lightcoral" stroke="black" points="12156.95,-3595.17 11684.95,-3595.17 11684.95,-3527.17 12156.95,-3527.17 12156.95,-3595.17"/>
<text text-anchor="middle" x="11920.95" y="-3579.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 1</text>
<text text-anchor="middle" x="11920.95" y="-3564.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11920.95" y="-3549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="11920.95" y="-3534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l1_g6&#45;&gt;mha_attn_l1_g6 -->
<g id="edge165" class="edge">
<title>mha_qkv_l1_g6&#45;&gt;mha_attn_l1_g6</title>
<path fill="none" stroke="black" d="M11920.95,-3631.11C11920.95,-3631.11 11920.95,-3605.3 11920.95,-3605.3"/>
<polygon fill="black" stroke="black" points="11924.45,-3605.3 11920.95,-3595.3 11917.45,-3605.3 11924.45,-3605.3"/>
</g>
<!-- mha_out_l1_g6 -->
<g id="node110" class="node">
<title>mha_out_l1_g6</title>
<polygon fill="lightcoral" stroke="black" points="12150.95,-3491.17 11690.95,-3491.17 11690.95,-3423.17 12150.95,-3423.17 12150.95,-3491.17"/>
<text text-anchor="middle" x="11920.95" y="-3475.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 1</text>
<text text-anchor="middle" x="11920.95" y="-3460.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11920.95" y="-3445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="11920.95" y="-3430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l1_g6&#45;&gt;mha_out_l1_g6 -->
<g id="edge166" class="edge">
<title>mha_attn_l1_g6&#45;&gt;mha_out_l1_g6</title>
<path fill="none" stroke="black" d="M11920.95,-3527.11C11920.95,-3527.11 11920.95,-3501.3 11920.95,-3501.3"/>
<polygon fill="black" stroke="black" points="11924.45,-3501.3 11920.95,-3491.3 11917.45,-3501.3 11924.45,-3501.3"/>
</g>
<!-- allreduce_l1_g6 -->
<g id="node126" class="node">
<title>allreduce_l1_g6</title>
<polygon fill="lightyellow" stroke="black" points="12348.24,-3387.17 11668.52,-3387.17 11493.67,-3221.17 12173.38,-3221.17 12348.24,-3387.17"/>
<text text-anchor="middle" x="11920.95" y="-3330.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="11920.95" y="-3315.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="11920.95" y="-3300.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11920.95" y="-3285.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="11920.95" y="-3270.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l1_g6&#45;&gt;allreduce_l1_g6 -->
<g id="edge167" class="edge">
<title>mha_out_l1_g6&#45;&gt;allreduce_l1_g6</title>
<path fill="none" stroke="black" d="M11920.95,-3422.83C11920.95,-3422.83 11920.95,-3397.43 11920.95,-3397.43"/>
<polygon fill="black" stroke="black" points="11924.45,-3397.43 11920.95,-3387.43 11917.45,-3397.43 11924.45,-3397.43"/>
</g>
<!-- mha_attn_l1_g7 -->
<g id="node112" class="node">
<title>mha_attn_l1_g7</title>
<polygon fill="lightcoral" stroke="black" points="13995.95,-3595.17 13523.95,-3595.17 13523.95,-3527.17 13995.95,-3527.17 13995.95,-3595.17"/>
<text text-anchor="middle" x="13759.95" y="-3579.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 1</text>
<text text-anchor="middle" x="13759.95" y="-3564.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13759.95" y="-3549.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="13759.95" y="-3534.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l1_g7&#45;&gt;mha_attn_l1_g7 -->
<g id="edge171" class="edge">
<title>mha_qkv_l1_g7&#45;&gt;mha_attn_l1_g7</title>
<path fill="none" stroke="black" d="M13759.95,-3631.11C13759.95,-3631.11 13759.95,-3605.3 13759.95,-3605.3"/>
<polygon fill="black" stroke="black" points="13763.45,-3605.3 13759.95,-3595.3 13756.45,-3605.3 13763.45,-3605.3"/>
</g>
<!-- mha_out_l1_g7 -->
<g id="node113" class="node">
<title>mha_out_l1_g7</title>
<polygon fill="lightcoral" stroke="black" points="13989.95,-3491.17 13529.95,-3491.17 13529.95,-3423.17 13989.95,-3423.17 13989.95,-3491.17"/>
<text text-anchor="middle" x="13759.95" y="-3475.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 1</text>
<text text-anchor="middle" x="13759.95" y="-3460.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13759.95" y="-3445.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="13759.95" y="-3430.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l1_g7&#45;&gt;mha_out_l1_g7 -->
<g id="edge172" class="edge">
<title>mha_attn_l1_g7&#45;&gt;mha_out_l1_g7</title>
<path fill="none" stroke="black" d="M13759.95,-3527.11C13759.95,-3527.11 13759.95,-3501.3 13759.95,-3501.3"/>
<polygon fill="black" stroke="black" points="13763.45,-3501.3 13759.95,-3491.3 13756.45,-3501.3 13763.45,-3501.3"/>
</g>
<!-- allreduce_l1_g7 -->
<g id="node128" class="node">
<title>allreduce_l1_g7</title>
<polygon fill="lightyellow" stroke="black" points="14187.24,-3387.17 13507.52,-3387.17 13332.67,-3221.17 14012.38,-3221.17 14187.24,-3387.17"/>
<text text-anchor="middle" x="13759.95" y="-3330.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="13759.95" y="-3315.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="13759.95" y="-3300.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13759.95" y="-3285.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="13759.95" y="-3270.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l1_g7&#45;&gt;allreduce_l1_g7 -->
<g id="edge173" class="edge">
<title>mha_out_l1_g7&#45;&gt;allreduce_l1_g7</title>
<path fill="none" stroke="black" d="M13759.95,-3422.83C13759.95,-3422.83 13759.95,-3397.43 13759.95,-3397.43"/>
<polygon fill="black" stroke="black" points="13763.45,-3397.43 13759.95,-3387.43 13756.45,-3397.43 13763.45,-3397.43"/>
</g>
<!-- allreduce_l1_g0&#45;&gt;residual_l1_g0 -->
<g id="edge134" class="edge">
<title>allreduce_l1_g0&#45;&gt;residual_l1_g0</title>
<path fill="none" stroke="black" d="M907.95,-3220.89C907.95,-3220.89 907.95,-3195.46 907.95,-3195.46"/>
<polygon fill="black" stroke="black" points="911.45,-3195.46 907.95,-3185.46 904.45,-3195.46 911.45,-3195.46"/>
</g>
<!-- gate_l1_g0 -->
<g id="node130" class="node">
<title>gate_l1_g0</title>
<polygon fill="lightgreen" stroke="black" points="1137.45,-2953.17 678.45,-2953.17 678.45,-2870.17 1137.45,-2870.17 1137.45,-2953.17"/>
<text text-anchor="middle" x="907.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="907.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="907.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="907.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="907.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g0&#45;&gt;gate_l1_g0 -->
<g id="edge177" class="edge">
<title>residual_l1_g0&#45;&gt;gate_l1_g0</title>
<path fill="none" stroke="black" d="M907.95,-2989.15C907.95,-2989.15 907.95,-2963.37 907.95,-2963.37"/>
<polygon fill="black" stroke="black" points="911.45,-2963.37 907.95,-2953.37 904.45,-2963.37 911.45,-2963.37"/>
</g>
<!-- gate_l1_g8 -->
<g id="node146" class="node">
<title>gate_l1_g8</title>
<polygon fill="lightgreen" stroke="black" points="1614.45,-2953.17 1155.45,-2953.17 1155.45,-2870.17 1614.45,-2870.17 1614.45,-2953.17"/>
<text text-anchor="middle" x="1384.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="1384.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1384.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1384.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1384.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g0&#45;&gt;gate_l1_g8 -->
<g id="edge209" class="edge">
<title>residual_l1_g0&#45;&gt;gate_l1_g8</title>
<path fill="none" stroke="black" d="M1245.27,-3084.12C1245.27,-3084.12 1245.27,-2963.37 1245.27,-2963.37"/>
<polygon fill="black" stroke="black" points="1248.77,-2963.37 1245.27,-2953.37 1241.77,-2963.37 1248.77,-2963.37"/>
</g>
<!-- aggregate_l1_g0 -->
<g id="node162" class="node">
<title>aggregate_l1_g0</title>
<polygon fill="lightyellow" stroke="black" points="1124.85,-2700.17 409.16,-2700.17 225.05,-2534.17 940.74,-2534.17 1124.85,-2700.17"/>
<text text-anchor="middle" x="674.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="674.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="674.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="674.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="674.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g0&#45;&gt;aggregate_l1_g0 -->
<g id="edge180" class="edge">
<title>residual_l1_g0&#45;&gt;aggregate_l1_g0</title>
<path fill="none" stroke="black" d="M579.63,-2988.93C579.63,-2988.93 579.63,-2710.36 579.63,-2710.36"/>
<polygon fill="black" stroke="black" points="583.13,-2710.36 579.63,-2700.36 576.13,-2710.36 583.13,-2710.36"/>
</g>
<!-- aggregate_l1_g8 -->
<g id="node170" class="node">
<title>aggregate_l1_g8</title>
<polygon fill="lightyellow" stroke="black" points="2042.85,-2700.17 1327.16,-2700.17 1143.05,-2534.17 1858.74,-2534.17 2042.85,-2700.17"/>
<text text-anchor="middle" x="1592.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1592.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1592.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1592.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1592.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g0&#45;&gt;aggregate_l1_g8 -->
<g id="edge212" class="edge">
<title>residual_l1_g0&#45;&gt;aggregate_l1_g8</title>
<path fill="none" stroke="black" d="M1149.23,-2988.93C1149.23,-2988.93 1149.23,-2627.21 1149.23,-2627.21"/>
<polygon fill="black" stroke="black" points="1152.73,-2627.21 1149.23,-2617.21 1145.73,-2627.21 1152.73,-2627.21"/>
</g>
<!-- allreduce_l1_g1&#45;&gt;residual_l1_g1 -->
<g id="edge140" class="edge">
<title>allreduce_l1_g1&#45;&gt;residual_l1_g1</title>
<path fill="none" stroke="black" d="M2745.95,-3220.89C2745.95,-3220.89 2745.95,-3195.46 2745.95,-3195.46"/>
<polygon fill="black" stroke="black" points="2749.45,-3195.46 2745.95,-3185.46 2742.45,-3195.46 2749.45,-3195.46"/>
</g>
<!-- gate_l1_g1 -->
<g id="node132" class="node">
<title>gate_l1_g1</title>
<polygon fill="lightgreen" stroke="black" points="2950.45,-2953.17 2491.45,-2953.17 2491.45,-2870.17 2950.45,-2870.17 2950.45,-2953.17"/>
<text text-anchor="middle" x="2720.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="2720.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2720.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2720.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2720.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g1&#45;&gt;gate_l1_g1 -->
<g id="edge181" class="edge">
<title>residual_l1_g1&#45;&gt;gate_l1_g1</title>
<path fill="none" stroke="black" d="M2720.95,-2989.15C2720.95,-2989.15 2720.95,-2963.37 2720.95,-2963.37"/>
<polygon fill="black" stroke="black" points="2724.45,-2963.37 2720.95,-2953.37 2717.45,-2963.37 2724.45,-2963.37"/>
</g>
<!-- gate_l1_g9 -->
<g id="node148" class="node">
<title>gate_l1_g9</title>
<polygon fill="lightgreen" stroke="black" points="3427.45,-2953.17 2968.45,-2953.17 2968.45,-2870.17 3427.45,-2870.17 3427.45,-2953.17"/>
<text text-anchor="middle" x="3197.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="3197.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3197.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3197.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3197.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g1&#45;&gt;gate_l1_g9 -->
<g id="edge213" class="edge">
<title>residual_l1_g1&#45;&gt;gate_l1_g9</title>
<path fill="none" stroke="black" d="M3070.77,-3070.02C3070.77,-3070.02 3070.77,-2963.32 3070.77,-2963.32"/>
<polygon fill="black" stroke="black" points="3074.27,-2963.32 3070.77,-2953.32 3067.27,-2963.32 3074.27,-2963.32"/>
</g>
<!-- aggregate_l1_g1 -->
<g id="node163" class="node">
<title>aggregate_l1_g1</title>
<polygon fill="lightyellow" stroke="black" points="2962.85,-2700.17 2247.16,-2700.17 2063.05,-2534.17 2778.74,-2534.17 2962.85,-2700.17"/>
<text text-anchor="middle" x="2512.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2512.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2512.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2512.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2512.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g1&#45;&gt;aggregate_l1_g1 -->
<g id="edge184" class="edge">
<title>residual_l1_g1&#45;&gt;aggregate_l1_g1</title>
<path fill="none" stroke="black" d="M2956.68,-2988.93C2956.68,-2988.93 2956.68,-2627.21 2956.68,-2627.21"/>
<polygon fill="black" stroke="black" points="2960.18,-2627.21 2956.68,-2617.21 2953.18,-2627.21 2960.18,-2627.21"/>
</g>
<!-- aggregate_l1_g9 -->
<g id="node171" class="node">
<title>aggregate_l1_g9</title>
<polygon fill="lightyellow" stroke="black" points="3880.85,-2700.17 3165.16,-2700.17 2981.05,-2534.17 3696.74,-2534.17 3880.85,-2700.17"/>
<text text-anchor="middle" x="3430.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3430.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3430.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3430.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3430.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g1&#45;&gt;aggregate_l1_g9 -->
<g id="edge216" class="edge">
<title>residual_l1_g1&#45;&gt;aggregate_l1_g9</title>
<path fill="none" stroke="black" d="M3042.16,-3038C3268.06,-3038 3540.68,-3038 3540.68,-3038 3540.68,-3038 3540.68,-2710.31 3540.68,-2710.31"/>
<polygon fill="black" stroke="black" points="3544.18,-2710.31 3540.68,-2700.31 3537.18,-2710.31 3544.18,-2710.31"/>
</g>
<!-- allreduce_l1_g2&#45;&gt;residual_l1_g2 -->
<g id="edge146" class="edge">
<title>allreduce_l1_g2&#45;&gt;residual_l1_g2</title>
<path fill="none" stroke="black" d="M4579.95,-3220.89C4579.95,-3220.89 4579.95,-3195.46 4579.95,-3195.46"/>
<polygon fill="black" stroke="black" points="4583.45,-3195.46 4579.95,-3185.46 4576.45,-3195.46 4583.45,-3195.46"/>
</g>
<!-- gate_l1_g2 -->
<g id="node134" class="node">
<title>gate_l1_g2</title>
<polygon fill="lightgreen" stroke="black" points="4785.45,-2953.17 4326.45,-2953.17 4326.45,-2870.17 4785.45,-2870.17 4785.45,-2953.17"/>
<text text-anchor="middle" x="4555.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4555.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4555.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4555.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4555.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g2&#45;&gt;gate_l1_g2 -->
<g id="edge185" class="edge">
<title>residual_l1_g2&#45;&gt;gate_l1_g2</title>
<path fill="none" stroke="black" d="M4555.95,-2989.15C4555.95,-2989.15 4555.95,-2963.37 4555.95,-2963.37"/>
<polygon fill="black" stroke="black" points="4559.45,-2963.37 4555.95,-2953.37 4552.45,-2963.37 4559.45,-2963.37"/>
</g>
<!-- gate_l1_g10 -->
<g id="node150" class="node">
<title>gate_l1_g10</title>
<polygon fill="lightgreen" stroke="black" points="5262.45,-2953.17 4803.45,-2953.17 4803.45,-2870.17 5262.45,-2870.17 5262.45,-2953.17"/>
<text text-anchor="middle" x="5032.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5032.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="5032.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5032.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5032.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g2&#45;&gt;gate_l1_g10 -->
<g id="edge217" class="edge">
<title>residual_l1_g2&#45;&gt;gate_l1_g10</title>
<path fill="none" stroke="black" d="M4905.27,-3070.66C4905.27,-3070.66 4905.27,-2963.31 4905.27,-2963.31"/>
<polygon fill="black" stroke="black" points="4908.77,-2963.31 4905.27,-2953.31 4901.77,-2963.31 4908.77,-2963.31"/>
</g>
<!-- aggregate_l1_g2 -->
<g id="node164" class="node">
<title>aggregate_l1_g2</title>
<polygon fill="lightyellow" stroke="black" points="4799.85,-2700.17 4084.16,-2700.17 3900.05,-2534.17 4615.74,-2534.17 4799.85,-2700.17"/>
<text text-anchor="middle" x="4349.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4349.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4349.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4349.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4349.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g2&#45;&gt;aggregate_l1_g2 -->
<g id="edge188" class="edge">
<title>residual_l1_g2&#45;&gt;aggregate_l1_g2</title>
<path fill="none" stroke="black" d="M4792.68,-2988.93C4792.68,-2988.93 4792.68,-2627.21 4792.68,-2627.21"/>
<polygon fill="black" stroke="black" points="4796.18,-2627.21 4792.68,-2617.21 4789.18,-2627.21 4796.18,-2627.21"/>
</g>
<!-- aggregate_l1_g10 -->
<g id="node172" class="node">
<title>aggregate_l1_g10</title>
<polygon fill="lightyellow" stroke="black" points="5717.85,-2700.17 5002.16,-2700.17 4818.05,-2534.17 5533.74,-2534.17 5717.85,-2700.17"/>
<text text-anchor="middle" x="5267.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5267.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="5267.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5267.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5267.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g2&#45;&gt;aggregate_l1_g10 -->
<g id="edge220" class="edge">
<title>residual_l1_g2&#45;&gt;aggregate_l1_g10</title>
<path fill="none" stroke="black" d="M4876.15,-3038C5102.59,-3038 5376.18,-3038 5376.18,-3038 5376.18,-3038 5376.18,-2710.31 5376.18,-2710.31"/>
<polygon fill="black" stroke="black" points="5379.68,-2710.31 5376.18,-2700.31 5372.68,-2710.31 5379.68,-2710.31"/>
</g>
<!-- allreduce_l1_g3&#45;&gt;residual_l1_g3 -->
<g id="edge152" class="edge">
<title>allreduce_l1_g3&#45;&gt;residual_l1_g3</title>
<path fill="none" stroke="black" d="M6415.95,-3220.89C6415.95,-3220.89 6415.95,-3195.46 6415.95,-3195.46"/>
<polygon fill="black" stroke="black" points="6419.45,-3195.46 6415.95,-3185.46 6412.45,-3195.46 6419.45,-3195.46"/>
</g>
<!-- gate_l1_g3 -->
<g id="node136" class="node">
<title>gate_l1_g3</title>
<polygon fill="lightgreen" stroke="black" points="6632.45,-2953.17 6173.45,-2953.17 6173.45,-2870.17 6632.45,-2870.17 6632.45,-2953.17"/>
<text text-anchor="middle" x="6402.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6402.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="6402.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6402.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6402.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g3&#45;&gt;gate_l1_g3 -->
<g id="edge189" class="edge">
<title>residual_l1_g3&#45;&gt;gate_l1_g3</title>
<path fill="none" stroke="black" d="M6402.95,-2989.15C6402.95,-2989.15 6402.95,-2963.37 6402.95,-2963.37"/>
<polygon fill="black" stroke="black" points="6406.45,-2963.37 6402.95,-2953.37 6399.45,-2963.37 6406.45,-2963.37"/>
</g>
<!-- gate_l1_g11 -->
<g id="node152" class="node">
<title>gate_l1_g11</title>
<polygon fill="lightgreen" stroke="black" points="7109.45,-2953.17 6650.45,-2953.17 6650.45,-2870.17 7109.45,-2870.17 7109.45,-2953.17"/>
<text text-anchor="middle" x="6879.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6879.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="6879.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6879.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6879.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g3&#45;&gt;gate_l1_g11 -->
<g id="edge221" class="edge">
<title>residual_l1_g3&#45;&gt;gate_l1_g11</title>
<path fill="none" stroke="black" d="M6746.77,-3076.97C6746.77,-3076.97 6746.77,-2963.33 6746.77,-2963.33"/>
<polygon fill="black" stroke="black" points="6750.27,-2963.33 6746.77,-2953.33 6743.27,-2963.33 6750.27,-2963.33"/>
</g>
<!-- aggregate_l1_g3 -->
<g id="node165" class="node">
<title>aggregate_l1_g3</title>
<polygon fill="lightyellow" stroke="black" points="6662.85,-2700.17 5947.16,-2700.17 5763.05,-2534.17 6478.74,-2534.17 6662.85,-2700.17"/>
<text text-anchor="middle" x="6212.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6212.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="6212.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6212.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6212.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g3&#45;&gt;aggregate_l1_g3 -->
<g id="edge192" class="edge">
<title>residual_l1_g3&#45;&gt;aggregate_l1_g3</title>
<path fill="none" stroke="black" d="M6081.13,-2988.93C6081.13,-2988.93 6081.13,-2710.36 6081.13,-2710.36"/>
<polygon fill="black" stroke="black" points="6084.63,-2710.36 6081.13,-2700.36 6077.63,-2710.36 6084.63,-2710.36"/>
</g>
<!-- aggregate_l1_g11 -->
<g id="node173" class="node">
<title>aggregate_l1_g11</title>
<polygon fill="lightyellow" stroke="black" points="7580.85,-2700.17 6865.16,-2700.17 6681.05,-2534.17 7396.74,-2534.17 7580.85,-2700.17"/>
<text text-anchor="middle" x="7130.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7130.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="7130.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7130.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7130.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g3&#45;&gt;aggregate_l1_g11 -->
<g id="edge224" class="edge">
<title>residual_l1_g3&#45;&gt;aggregate_l1_g11</title>
<path fill="none" stroke="black" d="M6712.21,-3038C6940.59,-3038 7217.68,-3038 7217.68,-3038 7217.68,-3038 7217.68,-2710.31 7217.68,-2710.31"/>
<polygon fill="black" stroke="black" points="7221.18,-2710.31 7217.68,-2700.31 7214.18,-2710.31 7221.18,-2710.31"/>
</g>
<!-- allreduce_l1_g4&#45;&gt;residual_l1_g4 -->
<g id="edge158" class="edge">
<title>allreduce_l1_g4&#45;&gt;residual_l1_g4</title>
<path fill="none" stroke="black" d="M8253.95,-3220.89C8253.95,-3220.89 8253.95,-3195.46 8253.95,-3195.46"/>
<polygon fill="black" stroke="black" points="8257.45,-3195.46 8253.95,-3185.46 8250.45,-3195.46 8257.45,-3195.46"/>
</g>
<!-- gate_l1_g4 -->
<g id="node138" class="node">
<title>gate_l1_g4</title>
<polygon fill="lightgreen" stroke="black" points="8474.45,-2953.17 8015.45,-2953.17 8015.45,-2870.17 8474.45,-2870.17 8474.45,-2953.17"/>
<text text-anchor="middle" x="8244.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8244.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="8244.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8244.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8244.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g4&#45;&gt;gate_l1_g4 -->
<g id="edge193" class="edge">
<title>residual_l1_g4&#45;&gt;gate_l1_g4</title>
<path fill="none" stroke="black" d="M8244.95,-2989.15C8244.95,-2989.15 8244.95,-2963.37 8244.95,-2963.37"/>
<polygon fill="black" stroke="black" points="8248.45,-2963.37 8244.95,-2953.37 8241.45,-2963.37 8248.45,-2963.37"/>
</g>
<!-- gate_l1_g12 -->
<g id="node154" class="node">
<title>gate_l1_g12</title>
<polygon fill="lightgreen" stroke="black" points="8951.45,-2953.17 8492.45,-2953.17 8492.45,-2870.17 8951.45,-2870.17 8951.45,-2953.17"/>
<text text-anchor="middle" x="8721.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8721.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="8721.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8721.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8721.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g4&#45;&gt;gate_l1_g12 -->
<g id="edge225" class="edge">
<title>residual_l1_g4&#45;&gt;gate_l1_g12</title>
<path fill="none" stroke="black" d="M8586.77,-3079.17C8586.77,-3079.17 8586.77,-2963.27 8586.77,-2963.27"/>
<polygon fill="black" stroke="black" points="8590.27,-2963.27 8586.77,-2953.27 8583.27,-2963.27 8590.27,-2963.27"/>
</g>
<!-- aggregate_l1_g4 -->
<g id="node166" class="node">
<title>aggregate_l1_g4</title>
<polygon fill="lightyellow" stroke="black" points="8502.85,-2700.17 7787.16,-2700.17 7603.05,-2534.17 8318.74,-2534.17 8502.85,-2700.17"/>
<text text-anchor="middle" x="8052.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8052.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="8052.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8052.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8052.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g4&#45;&gt;aggregate_l1_g4 -->
<g id="edge196" class="edge">
<title>residual_l1_g4&#45;&gt;aggregate_l1_g4</title>
<path fill="none" stroke="black" d="M8483.45,-2988.93C8483.45,-2988.93 8483.45,-2627.21 8483.45,-2627.21"/>
<polygon fill="black" stroke="black" points="8486.95,-2627.21 8483.45,-2617.21 8479.95,-2627.21 8486.95,-2627.21"/>
</g>
<!-- aggregate_l1_g12 -->
<g id="node174" class="node">
<title>aggregate_l1_g12</title>
<polygon fill="lightyellow" stroke="black" points="9420.85,-2700.17 8705.16,-2700.17 8521.05,-2534.17 9236.74,-2534.17 9420.85,-2700.17"/>
<text text-anchor="middle" x="8970.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8970.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="8970.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8970.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8970.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g4&#45;&gt;aggregate_l1_g12 -->
<g id="edge228" class="edge">
<title>residual_l1_g4&#45;&gt;aggregate_l1_g12</title>
<path fill="none" stroke="black" d="M8550.01,-3038C8778.78,-3038 9056.68,-3038 9056.68,-3038 9056.68,-3038 9056.68,-2710.31 9056.68,-2710.31"/>
<polygon fill="black" stroke="black" points="9060.18,-2710.31 9056.68,-2700.31 9053.18,-2710.31 9060.18,-2710.31"/>
</g>
<!-- allreduce_l1_g5&#45;&gt;residual_l1_g5 -->
<g id="edge164" class="edge">
<title>allreduce_l1_g5&#45;&gt;residual_l1_g5</title>
<path fill="none" stroke="black" d="M10087.95,-3220.89C10087.95,-3220.89 10087.95,-3195.46 10087.95,-3195.46"/>
<polygon fill="black" stroke="black" points="10091.45,-3195.46 10087.95,-3185.46 10084.45,-3195.46 10091.45,-3195.46"/>
</g>
<!-- gate_l1_g5 -->
<g id="node140" class="node">
<title>gate_l1_g5</title>
<polygon fill="lightgreen" stroke="black" points="10312.45,-2953.17 9853.45,-2953.17 9853.45,-2870.17 10312.45,-2870.17 10312.45,-2953.17"/>
<text text-anchor="middle" x="10082.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10082.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="10082.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10082.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10082.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g5&#45;&gt;gate_l1_g5 -->
<g id="edge197" class="edge">
<title>residual_l1_g5&#45;&gt;gate_l1_g5</title>
<path fill="none" stroke="black" d="M10082.95,-2989.15C10082.95,-2989.15 10082.95,-2963.37 10082.95,-2963.37"/>
<polygon fill="black" stroke="black" points="10086.45,-2963.37 10082.95,-2953.37 10079.45,-2963.37 10086.45,-2963.37"/>
</g>
<!-- gate_l1_g13 -->
<g id="node156" class="node">
<title>gate_l1_g13</title>
<polygon fill="lightgreen" stroke="black" points="10789.45,-2953.17 10330.45,-2953.17 10330.45,-2870.17 10789.45,-2870.17 10789.45,-2953.17"/>
<text text-anchor="middle" x="10559.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10559.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="10559.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10559.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10559.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g5&#45;&gt;gate_l1_g13 -->
<g id="edge229" class="edge">
<title>residual_l1_g5&#45;&gt;gate_l1_g13</title>
<path fill="none" stroke="black" d="M10422.77,-3081.33C10422.77,-3081.33 10422.77,-2963.3 10422.77,-2963.3"/>
<polygon fill="black" stroke="black" points="10426.27,-2963.3 10422.77,-2953.3 10419.27,-2963.3 10426.27,-2963.3"/>
</g>
<!-- aggregate_l1_g5 -->
<g id="node167" class="node">
<title>aggregate_l1_g5</title>
<polygon fill="lightyellow" stroke="black" points="10348.85,-2700.17 9633.16,-2700.17 9449.05,-2534.17 10164.74,-2534.17 10348.85,-2700.17"/>
<text text-anchor="middle" x="9898.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9898.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="9898.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="9898.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="9898.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g5&#45;&gt;aggregate_l1_g5 -->
<g id="edge200" class="edge">
<title>residual_l1_g5&#45;&gt;aggregate_l1_g5</title>
<path fill="none" stroke="black" d="M9757.13,-2988.93C9757.13,-2988.93 9757.13,-2710.36 9757.13,-2710.36"/>
<polygon fill="black" stroke="black" points="9760.63,-2710.36 9757.13,-2700.36 9753.63,-2710.36 9760.63,-2710.36"/>
</g>
<!-- aggregate_l1_g13 -->
<g id="node175" class="node">
<title>aggregate_l1_g13</title>
<polygon fill="lightyellow" stroke="black" points="11266.85,-2700.17 10551.16,-2700.17 10367.05,-2534.17 11082.74,-2534.17 11266.85,-2700.17"/>
<text text-anchor="middle" x="10816.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10816.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="10816.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10816.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10816.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g5&#45;&gt;aggregate_l1_g13 -->
<g id="edge232" class="edge">
<title>residual_l1_g5&#45;&gt;aggregate_l1_g13</title>
<path fill="none" stroke="black" d="M10427.9,-3087C10647.95,-3087 10893.68,-3087 10893.68,-3087 10893.68,-3087 10893.68,-2710.35 10893.68,-2710.35"/>
<polygon fill="black" stroke="black" points="10897.18,-2710.35 10893.68,-2700.35 10890.18,-2710.35 10897.18,-2710.35"/>
</g>
<!-- allreduce_l1_g6&#45;&gt;residual_l1_g6 -->
<g id="edge170" class="edge">
<title>allreduce_l1_g6&#45;&gt;residual_l1_g6</title>
<path fill="none" stroke="black" d="M11920.95,-3220.89C11920.95,-3220.89 11920.95,-3195.46 11920.95,-3195.46"/>
<polygon fill="black" stroke="black" points="11924.45,-3195.46 11920.95,-3185.46 11917.45,-3195.46 11924.45,-3195.46"/>
</g>
<!-- gate_l1_g6 -->
<g id="node142" class="node">
<title>gate_l1_g6</title>
<polygon fill="lightgreen" stroke="black" points="12150.45,-2953.17 11691.45,-2953.17 11691.45,-2870.17 12150.45,-2870.17 12150.45,-2953.17"/>
<text text-anchor="middle" x="11920.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11920.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="11920.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11920.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="11920.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g6&#45;&gt;gate_l1_g6 -->
<g id="edge201" class="edge">
<title>residual_l1_g6&#45;&gt;gate_l1_g6</title>
<path fill="none" stroke="black" d="M11920.95,-2989.15C11920.95,-2989.15 11920.95,-2963.37 11920.95,-2963.37"/>
<polygon fill="black" stroke="black" points="11924.45,-2963.37 11920.95,-2953.37 11917.45,-2963.37 11924.45,-2963.37"/>
</g>
<!-- gate_l1_g14 -->
<g id="node158" class="node">
<title>gate_l1_g14</title>
<polygon fill="lightgreen" stroke="black" points="12627.45,-2953.17 12168.45,-2953.17 12168.45,-2870.17 12627.45,-2870.17 12627.45,-2953.17"/>
<text text-anchor="middle" x="12397.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12397.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="12397.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12397.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12397.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g6&#45;&gt;gate_l1_g14 -->
<g id="edge233" class="edge">
<title>residual_l1_g6&#45;&gt;gate_l1_g14</title>
<path fill="none" stroke="black" d="M12258.27,-3084.12C12258.27,-3084.12 12258.27,-2963.37 12258.27,-2963.37"/>
<polygon fill="black" stroke="black" points="12261.77,-2963.37 12258.27,-2953.37 12254.77,-2963.37 12261.77,-2963.37"/>
</g>
<!-- aggregate_l1_g6 -->
<g id="node168" class="node">
<title>aggregate_l1_g6</title>
<polygon fill="lightyellow" stroke="black" points="12187.85,-2700.17 11472.16,-2700.17 11288.05,-2534.17 12003.74,-2534.17 12187.85,-2700.17"/>
<text text-anchor="middle" x="11737.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11737.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="11737.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11737.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11737.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g6&#45;&gt;aggregate_l1_g6 -->
<g id="edge204" class="edge">
<title>residual_l1_g6&#45;&gt;aggregate_l1_g6</title>
<path fill="none" stroke="black" d="M11592.63,-2988.93C11592.63,-2988.93 11592.63,-2710.36 11592.63,-2710.36"/>
<polygon fill="black" stroke="black" points="11596.13,-2710.36 11592.63,-2700.36 11589.13,-2710.36 11596.13,-2710.36"/>
</g>
<!-- aggregate_l1_g14 -->
<g id="node176" class="node">
<title>aggregate_l1_g14</title>
<polygon fill="lightyellow" stroke="black" points="13105.85,-2700.17 12390.16,-2700.17 12206.05,-2534.17 12921.74,-2534.17 13105.85,-2700.17"/>
<text text-anchor="middle" x="12655.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12655.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="12655.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12655.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12655.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g6&#45;&gt;aggregate_l1_g14 -->
<g id="edge236" class="edge">
<title>residual_l1_g6&#45;&gt;aggregate_l1_g14</title>
<path fill="none" stroke="black" d="M12260.83,-3087C12482.42,-3087 12730.68,-3087 12730.68,-3087 12730.68,-3087 12730.68,-2710.35 12730.68,-2710.35"/>
<polygon fill="black" stroke="black" points="12734.18,-2710.35 12730.68,-2700.35 12727.18,-2710.35 12734.18,-2710.35"/>
</g>
<!-- allreduce_l1_g7&#45;&gt;residual_l1_g7 -->
<g id="edge176" class="edge">
<title>allreduce_l1_g7&#45;&gt;residual_l1_g7</title>
<path fill="none" stroke="black" d="M13759.95,-3220.89C13759.95,-3220.89 13759.95,-3195.46 13759.95,-3195.46"/>
<polygon fill="black" stroke="black" points="13763.45,-3195.46 13759.95,-3185.46 13756.45,-3195.46 13763.45,-3195.46"/>
</g>
<!-- gate_l1_g7 -->
<g id="node144" class="node">
<title>gate_l1_g7</title>
<polygon fill="lightgreen" stroke="black" points="13989.45,-2953.17 13530.45,-2953.17 13530.45,-2870.17 13989.45,-2870.17 13989.45,-2953.17"/>
<text text-anchor="middle" x="13759.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="13759.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="13759.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13759.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="13759.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g7&#45;&gt;gate_l1_g7 -->
<g id="edge205" class="edge">
<title>residual_l1_g7&#45;&gt;gate_l1_g7</title>
<path fill="none" stroke="black" d="M13759.95,-2989.15C13759.95,-2989.15 13759.95,-2963.37 13759.95,-2963.37"/>
<polygon fill="black" stroke="black" points="13763.45,-2963.37 13759.95,-2953.37 13756.45,-2963.37 13763.45,-2963.37"/>
</g>
<!-- gate_l1_g15 -->
<g id="node160" class="node">
<title>gate_l1_g15</title>
<polygon fill="lightgreen" stroke="black" points="14466.45,-2953.17 14007.45,-2953.17 14007.45,-2870.17 14466.45,-2870.17 14466.45,-2953.17"/>
<text text-anchor="middle" x="14236.95" y="-2937.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="14236.95" y="-2922.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="14236.95" y="-2907.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14236.95" y="-2892.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14236.95" y="-2877.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l1_g7&#45;&gt;gate_l1_g15 -->
<g id="edge237" class="edge">
<title>residual_l1_g7&#45;&gt;gate_l1_g15</title>
<path fill="none" stroke="black" d="M14097.27,-3084.12C14097.27,-3084.12 14097.27,-2963.37 14097.27,-2963.37"/>
<polygon fill="black" stroke="black" points="14100.77,-2963.37 14097.27,-2953.37 14093.77,-2963.37 14100.77,-2963.37"/>
</g>
<!-- aggregate_l1_g7 -->
<g id="node169" class="node">
<title>aggregate_l1_g7</title>
<polygon fill="lightyellow" stroke="black" points="14025.85,-2700.17 13310.16,-2700.17 13126.05,-2534.17 13841.74,-2534.17 14025.85,-2700.17"/>
<text text-anchor="middle" x="13575.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13575.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="13575.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13575.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13575.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g7&#45;&gt;aggregate_l1_g7 -->
<g id="edge208" class="edge">
<title>residual_l1_g7&#45;&gt;aggregate_l1_g7</title>
<path fill="none" stroke="black" d="M13431.63,-2988.93C13431.63,-2988.93 13431.63,-2710.36 13431.63,-2710.36"/>
<polygon fill="black" stroke="black" points="13435.13,-2710.36 13431.63,-2700.36 13428.13,-2710.36 13435.13,-2710.36"/>
</g>
<!-- aggregate_l1_g15 -->
<g id="node177" class="node">
<title>aggregate_l1_g15</title>
<polygon fill="lightyellow" stroke="black" points="14943.85,-2700.17 14228.16,-2700.17 14044.05,-2534.17 14759.74,-2534.17 14943.85,-2700.17"/>
<text text-anchor="middle" x="14493.95" y="-2643.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14493.95" y="-2628.47" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="14493.95" y="-2613.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14493.95" y="-2598.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14493.95" y="-2583.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l1_g7&#45;&gt;aggregate_l1_g15 -->
<g id="edge240" class="edge">
<title>residual_l1_g7&#45;&gt;aggregate_l1_g15</title>
<path fill="none" stroke="black" d="M14070.41,-3054C14298.27,-3054 14568.18,-3054 14568.18,-3054 14568.18,-3054 14568.18,-2710.36 14568.18,-2710.36"/>
<polygon fill="black" stroke="black" points="14571.68,-2710.36 14568.18,-2700.36 14564.68,-2710.36 14571.68,-2710.36"/>
</g>
<!-- expert_l1_e0_g0 -->
<g id="node131" class="node">
<title>expert_l1_e0_g0</title>
<polygon fill="lightgreen" stroke="black" points="1127.95,-2834.17 681.95,-2834.17 681.95,-2736.17 1127.95,-2736.17 1127.95,-2834.17"/>
<text text-anchor="middle" x="904.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="904.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="904.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="904.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="904.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="904.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g0&#45;&gt;expert_l1_e0_g0 -->
<g id="edge178" class="edge">
<title>gate_l1_g0&#45;&gt;expert_l1_e0_g0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M904.95,-2869.9C904.95,-2869.9 904.95,-2844.36 904.95,-2844.36"/>
<polygon fill="black" stroke="black" points="908.45,-2844.36 904.95,-2834.36 901.45,-2844.36 908.45,-2844.36"/>
</g>
<!-- expert_l1_e0_g0&#45;&gt;aggregate_l1_g0 -->
<g id="edge179" class="edge">
<title>expert_l1_e0_g0&#45;&gt;aggregate_l1_g0</title>
<path fill="none" stroke="black" d="M903.43,-2736.12C903.43,-2736.12 903.43,-2710.41 903.43,-2710.41"/>
<polygon fill="black" stroke="black" points="906.93,-2710.41 903.43,-2700.41 899.93,-2710.41 906.93,-2710.41"/>
</g>
<!-- expert_l1_e1_g1 -->
<g id="node133" class="node">
<title>expert_l1_e1_g1</title>
<polygon fill="lightgreen" stroke="black" points="2940.95,-2834.17 2494.95,-2834.17 2494.95,-2736.17 2940.95,-2736.17 2940.95,-2834.17"/>
<text text-anchor="middle" x="2717.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2717.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2717.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2717.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2717.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2717.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g1&#45;&gt;expert_l1_e1_g1 -->
<g id="edge182" class="edge">
<title>gate_l1_g1&#45;&gt;expert_l1_e1_g1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2717.95,-2869.9C2717.95,-2869.9 2717.95,-2844.36 2717.95,-2844.36"/>
<polygon fill="black" stroke="black" points="2721.45,-2844.36 2717.95,-2834.36 2714.45,-2844.36 2721.45,-2844.36"/>
</g>
<!-- expert_l1_e1_g1&#45;&gt;aggregate_l1_g1 -->
<g id="edge183" class="edge">
<title>expert_l1_e1_g1&#45;&gt;aggregate_l1_g1</title>
<path fill="none" stroke="black" d="M2717.95,-2736.12C2717.95,-2736.12 2717.95,-2710.41 2717.95,-2710.41"/>
<polygon fill="black" stroke="black" points="2721.45,-2710.41 2717.95,-2700.41 2714.45,-2710.41 2721.45,-2710.41"/>
</g>
<!-- expert_l1_e2_g2 -->
<g id="node135" class="node">
<title>expert_l1_e2_g2</title>
<polygon fill="lightgreen" stroke="black" points="4774.95,-2834.17 4328.95,-2834.17 4328.95,-2736.17 4774.95,-2736.17 4774.95,-2834.17"/>
<text text-anchor="middle" x="4551.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4551.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4551.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4551.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4551.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4551.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g2&#45;&gt;expert_l1_e2_g2 -->
<g id="edge186" class="edge">
<title>gate_l1_g2&#45;&gt;expert_l1_e2_g2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4551.95,-2869.9C4551.95,-2869.9 4551.95,-2844.36 4551.95,-2844.36"/>
<polygon fill="black" stroke="black" points="4555.45,-2844.36 4551.95,-2834.36 4548.45,-2844.36 4555.45,-2844.36"/>
</g>
<!-- expert_l1_e2_g2&#45;&gt;aggregate_l1_g2 -->
<g id="edge187" class="edge">
<title>expert_l1_e2_g2&#45;&gt;aggregate_l1_g2</title>
<path fill="none" stroke="black" d="M4551.95,-2736.12C4551.95,-2736.12 4551.95,-2710.41 4551.95,-2710.41"/>
<polygon fill="black" stroke="black" points="4555.45,-2710.41 4551.95,-2700.41 4548.45,-2710.41 4555.45,-2710.41"/>
</g>
<!-- expert_l1_e3_g3 -->
<g id="node137" class="node">
<title>expert_l1_e3_g3</title>
<polygon fill="lightgreen" stroke="black" points="6621.95,-2834.17 6175.95,-2834.17 6175.95,-2736.17 6621.95,-2736.17 6621.95,-2834.17"/>
<text text-anchor="middle" x="6398.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6398.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="6398.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6398.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6398.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6398.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g3&#45;&gt;expert_l1_e3_g3 -->
<g id="edge190" class="edge">
<title>gate_l1_g3&#45;&gt;expert_l1_e3_g3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6398.95,-2869.9C6398.95,-2869.9 6398.95,-2844.36 6398.95,-2844.36"/>
<polygon fill="black" stroke="black" points="6402.45,-2844.36 6398.95,-2834.36 6395.45,-2844.36 6402.45,-2844.36"/>
</g>
<!-- expert_l1_e3_g3&#45;&gt;aggregate_l1_g3 -->
<g id="edge191" class="edge">
<title>expert_l1_e3_g3&#45;&gt;aggregate_l1_g3</title>
<path fill="none" stroke="black" d="M6398.95,-2736.12C6398.95,-2736.12 6398.95,-2710.41 6398.95,-2710.41"/>
<polygon fill="black" stroke="black" points="6402.45,-2710.41 6398.95,-2700.41 6395.45,-2710.41 6402.45,-2710.41"/>
</g>
<!-- expert_l1_e4_g4 -->
<g id="node139" class="node">
<title>expert_l1_e4_g4</title>
<polygon fill="lightgreen" stroke="black" points="8463.95,-2834.17 8017.95,-2834.17 8017.95,-2736.17 8463.95,-2736.17 8463.95,-2834.17"/>
<text text-anchor="middle" x="8240.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8240.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="8240.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8240.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8240.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8240.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g4&#45;&gt;expert_l1_e4_g4 -->
<g id="edge194" class="edge">
<title>gate_l1_g4&#45;&gt;expert_l1_e4_g4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8240.95,-2869.9C8240.95,-2869.9 8240.95,-2844.36 8240.95,-2844.36"/>
<polygon fill="black" stroke="black" points="8244.45,-2844.36 8240.95,-2834.36 8237.45,-2844.36 8244.45,-2844.36"/>
</g>
<!-- expert_l1_e4_g4&#45;&gt;aggregate_l1_g4 -->
<g id="edge195" class="edge">
<title>expert_l1_e4_g4&#45;&gt;aggregate_l1_g4</title>
<path fill="none" stroke="black" d="M8240.95,-2736.12C8240.95,-2736.12 8240.95,-2710.41 8240.95,-2710.41"/>
<polygon fill="black" stroke="black" points="8244.45,-2710.41 8240.95,-2700.41 8237.45,-2710.41 8244.45,-2710.41"/>
</g>
<!-- expert_l1_e5_g5 -->
<g id="node141" class="node">
<title>expert_l1_e5_g5</title>
<polygon fill="lightgreen" stroke="black" points="10301.95,-2834.17 9855.95,-2834.17 9855.95,-2736.17 10301.95,-2736.17 10301.95,-2834.17"/>
<text text-anchor="middle" x="10078.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10078.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="10078.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10078.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10078.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10078.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g5&#45;&gt;expert_l1_e5_g5 -->
<g id="edge198" class="edge">
<title>gate_l1_g5&#45;&gt;expert_l1_e5_g5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10078.95,-2869.9C10078.95,-2869.9 10078.95,-2844.36 10078.95,-2844.36"/>
<polygon fill="black" stroke="black" points="10082.45,-2844.36 10078.95,-2834.36 10075.45,-2844.36 10082.45,-2844.36"/>
</g>
<!-- expert_l1_e5_g5&#45;&gt;aggregate_l1_g5 -->
<g id="edge199" class="edge">
<title>expert_l1_e5_g5&#45;&gt;aggregate_l1_g5</title>
<path fill="none" stroke="black" d="M10078.95,-2736.12C10078.95,-2736.12 10078.95,-2710.41 10078.95,-2710.41"/>
<polygon fill="black" stroke="black" points="10082.45,-2710.41 10078.95,-2700.41 10075.45,-2710.41 10082.45,-2710.41"/>
</g>
<!-- expert_l1_e6_g6 -->
<g id="node143" class="node">
<title>expert_l1_e6_g6</title>
<polygon fill="lightgreen" stroke="black" points="12139.95,-2834.17 11693.95,-2834.17 11693.95,-2736.17 12139.95,-2736.17 12139.95,-2834.17"/>
<text text-anchor="middle" x="11916.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="11916.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="11916.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11916.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11916.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11916.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g6&#45;&gt;expert_l1_e6_g6 -->
<g id="edge202" class="edge">
<title>gate_l1_g6&#45;&gt;expert_l1_e6_g6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11916.95,-2869.9C11916.95,-2869.9 11916.95,-2844.36 11916.95,-2844.36"/>
<polygon fill="black" stroke="black" points="11920.45,-2844.36 11916.95,-2834.36 11913.45,-2844.36 11920.45,-2844.36"/>
</g>
<!-- expert_l1_e6_g6&#45;&gt;aggregate_l1_g6 -->
<g id="edge203" class="edge">
<title>expert_l1_e6_g6&#45;&gt;aggregate_l1_g6</title>
<path fill="none" stroke="black" d="M11916.95,-2736.12C11916.95,-2736.12 11916.95,-2710.41 11916.95,-2710.41"/>
<polygon fill="black" stroke="black" points="11920.45,-2710.41 11916.95,-2700.41 11913.45,-2710.41 11920.45,-2710.41"/>
</g>
<!-- expert_l1_e7_g7 -->
<g id="node145" class="node">
<title>expert_l1_e7_g7</title>
<polygon fill="lightgreen" stroke="black" points="13978.95,-2834.17 13532.95,-2834.17 13532.95,-2736.17 13978.95,-2736.17 13978.95,-2834.17"/>
<text text-anchor="middle" x="13755.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="13755.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="13755.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13755.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13755.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13755.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g7&#45;&gt;expert_l1_e7_g7 -->
<g id="edge206" class="edge">
<title>gate_l1_g7&#45;&gt;expert_l1_e7_g7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13755.95,-2869.9C13755.95,-2869.9 13755.95,-2844.36 13755.95,-2844.36"/>
<polygon fill="black" stroke="black" points="13759.45,-2844.36 13755.95,-2834.36 13752.45,-2844.36 13759.45,-2844.36"/>
</g>
<!-- expert_l1_e7_g7&#45;&gt;aggregate_l1_g7 -->
<g id="edge207" class="edge">
<title>expert_l1_e7_g7&#45;&gt;aggregate_l1_g7</title>
<path fill="none" stroke="black" d="M13755.95,-2736.12C13755.95,-2736.12 13755.95,-2710.41 13755.95,-2710.41"/>
<polygon fill="black" stroke="black" points="13759.45,-2710.41 13755.95,-2700.41 13752.45,-2710.41 13759.45,-2710.41"/>
</g>
<!-- expert_l1_e8_g8 -->
<g id="node147" class="node">
<title>expert_l1_e8_g8</title>
<polygon fill="lightgreen" stroke="black" points="1611.95,-2834.17 1165.95,-2834.17 1165.95,-2736.17 1611.95,-2736.17 1611.95,-2834.17"/>
<text text-anchor="middle" x="1388.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1388.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1388.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1388.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1388.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1388.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g8&#45;&gt;expert_l1_e8_g8 -->
<g id="edge210" class="edge">
<title>gate_l1_g8&#45;&gt;expert_l1_e8_g8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1388.95,-2869.9C1388.95,-2869.9 1388.95,-2844.36 1388.95,-2844.36"/>
<polygon fill="black" stroke="black" points="1392.45,-2844.36 1388.95,-2834.36 1385.45,-2844.36 1392.45,-2844.36"/>
</g>
<!-- expert_l1_e8_g8&#45;&gt;aggregate_l1_g8 -->
<g id="edge211" class="edge">
<title>expert_l1_e8_g8&#45;&gt;aggregate_l1_g8</title>
<path fill="none" stroke="black" d="M1388.95,-2736.12C1388.95,-2736.12 1388.95,-2710.41 1388.95,-2710.41"/>
<polygon fill="black" stroke="black" points="1392.45,-2710.41 1388.95,-2700.41 1385.45,-2710.41 1392.45,-2710.41"/>
</g>
<!-- expert_l1_e9_g9 -->
<g id="node149" class="node">
<title>expert_l1_e9_g9</title>
<polygon fill="lightgreen" stroke="black" points="3424.95,-2834.17 2978.95,-2834.17 2978.95,-2736.17 3424.95,-2736.17 3424.95,-2834.17"/>
<text text-anchor="middle" x="3201.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3201.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3201.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3201.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3201.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3201.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g9&#45;&gt;expert_l1_e9_g9 -->
<g id="edge214" class="edge">
<title>gate_l1_g9&#45;&gt;expert_l1_e9_g9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3201.95,-2869.9C3201.95,-2869.9 3201.95,-2844.36 3201.95,-2844.36"/>
<polygon fill="black" stroke="black" points="3205.45,-2844.36 3201.95,-2834.36 3198.45,-2844.36 3205.45,-2844.36"/>
</g>
<!-- expert_l1_e9_g9&#45;&gt;aggregate_l1_g9 -->
<g id="edge215" class="edge">
<title>expert_l1_e9_g9&#45;&gt;aggregate_l1_g9</title>
<path fill="none" stroke="black" d="M3202.98,-2736.12C3202.98,-2736.12 3202.98,-2710.41 3202.98,-2710.41"/>
<polygon fill="black" stroke="black" points="3206.48,-2710.41 3202.98,-2700.41 3199.48,-2710.41 3206.48,-2710.41"/>
</g>
<!-- expert_l1_e10_g10 -->
<g id="node151" class="node">
<title>expert_l1_e10_g10</title>
<polygon fill="lightgreen" stroke="black" points="5259.95,-2834.17 4813.95,-2834.17 4813.95,-2736.17 5259.95,-2736.17 5259.95,-2834.17"/>
<text text-anchor="middle" x="5036.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="5036.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="5036.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5036.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5036.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5036.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g10&#45;&gt;expert_l1_e10_g10 -->
<g id="edge218" class="edge">
<title>gate_l1_g10&#45;&gt;expert_l1_e10_g10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5036.95,-2869.9C5036.95,-2869.9 5036.95,-2844.36 5036.95,-2844.36"/>
<polygon fill="black" stroke="black" points="5040.45,-2844.36 5036.95,-2834.36 5033.45,-2844.36 5040.45,-2844.36"/>
</g>
<!-- expert_l1_e10_g10&#45;&gt;aggregate_l1_g10 -->
<g id="edge219" class="edge">
<title>expert_l1_e10_g10&#45;&gt;aggregate_l1_g10</title>
<path fill="none" stroke="black" d="M5038.98,-2736.12C5038.98,-2736.12 5038.98,-2710.41 5038.98,-2710.41"/>
<polygon fill="black" stroke="black" points="5042.48,-2710.41 5038.98,-2700.41 5035.48,-2710.41 5042.48,-2710.41"/>
</g>
<!-- expert_l1_e11_g11 -->
<g id="node153" class="node">
<title>expert_l1_e11_g11</title>
<polygon fill="lightgreen" stroke="black" points="7105.95,-2834.17 6659.95,-2834.17 6659.95,-2736.17 7105.95,-2736.17 7105.95,-2834.17"/>
<text text-anchor="middle" x="6882.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="6882.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="6882.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6882.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6882.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6882.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g11&#45;&gt;expert_l1_e11_g11 -->
<g id="edge222" class="edge">
<title>gate_l1_g11&#45;&gt;expert_l1_e11_g11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6882.95,-2869.9C6882.95,-2869.9 6882.95,-2844.36 6882.95,-2844.36"/>
<polygon fill="black" stroke="black" points="6886.45,-2844.36 6882.95,-2834.36 6879.45,-2844.36 6886.45,-2844.36"/>
</g>
<!-- expert_l1_e11_g11&#45;&gt;aggregate_l1_g11 -->
<g id="edge223" class="edge">
<title>expert_l1_e11_g11&#45;&gt;aggregate_l1_g11</title>
<path fill="none" stroke="black" d="M6893.48,-2736.12C6893.48,-2736.12 6893.48,-2710.41 6893.48,-2710.41"/>
<polygon fill="black" stroke="black" points="6896.98,-2710.41 6893.48,-2700.41 6889.98,-2710.41 6896.98,-2710.41"/>
</g>
<!-- expert_l1_e12_g12 -->
<g id="node155" class="node">
<title>expert_l1_e12_g12</title>
<polygon fill="lightgreen" stroke="black" points="8948.95,-2834.17 8502.95,-2834.17 8502.95,-2736.17 8948.95,-2736.17 8948.95,-2834.17"/>
<text text-anchor="middle" x="8725.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="8725.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="8725.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8725.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8725.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8725.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g12&#45;&gt;expert_l1_e12_g12 -->
<g id="edge226" class="edge">
<title>gate_l1_g12&#45;&gt;expert_l1_e12_g12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8725.95,-2869.9C8725.95,-2869.9 8725.95,-2844.36 8725.95,-2844.36"/>
<polygon fill="black" stroke="black" points="8729.45,-2844.36 8725.95,-2834.36 8722.45,-2844.36 8729.45,-2844.36"/>
</g>
<!-- expert_l1_e12_g12&#45;&gt;aggregate_l1_g12 -->
<g id="edge227" class="edge">
<title>expert_l1_e12_g12&#45;&gt;aggregate_l1_g12</title>
<path fill="none" stroke="black" d="M8734.98,-2736.12C8734.98,-2736.12 8734.98,-2710.41 8734.98,-2710.41"/>
<polygon fill="black" stroke="black" points="8738.48,-2710.41 8734.98,-2700.41 8731.48,-2710.41 8738.48,-2710.41"/>
</g>
<!-- expert_l1_e13_g13 -->
<g id="node157" class="node">
<title>expert_l1_e13_g13</title>
<polygon fill="lightgreen" stroke="black" points="10785.95,-2834.17 10339.95,-2834.17 10339.95,-2736.17 10785.95,-2736.17 10785.95,-2834.17"/>
<text text-anchor="middle" x="10562.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10562.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="10562.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10562.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10562.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10562.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g13&#45;&gt;expert_l1_e13_g13 -->
<g id="edge230" class="edge">
<title>gate_l1_g13&#45;&gt;expert_l1_e13_g13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10562.95,-2869.9C10562.95,-2869.9 10562.95,-2844.36 10562.95,-2844.36"/>
<polygon fill="black" stroke="black" points="10566.45,-2844.36 10562.95,-2834.36 10559.45,-2844.36 10566.45,-2844.36"/>
</g>
<!-- expert_l1_e13_g13&#45;&gt;aggregate_l1_g13 -->
<g id="edge231" class="edge">
<title>expert_l1_e13_g13&#45;&gt;aggregate_l1_g13</title>
<path fill="none" stroke="black" d="M10576.48,-2736.12C10576.48,-2736.12 10576.48,-2710.41 10576.48,-2710.41"/>
<polygon fill="black" stroke="black" points="10579.98,-2710.41 10576.48,-2700.41 10572.98,-2710.41 10579.98,-2710.41"/>
</g>
<!-- expert_l1_e14_g14 -->
<g id="node159" class="node">
<title>expert_l1_e14_g14</title>
<polygon fill="lightgreen" stroke="black" points="12623.95,-2834.17 12177.95,-2834.17 12177.95,-2736.17 12623.95,-2736.17 12623.95,-2834.17"/>
<text text-anchor="middle" x="12400.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12400.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="12400.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12400.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12400.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12400.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g14&#45;&gt;expert_l1_e14_g14 -->
<g id="edge234" class="edge">
<title>gate_l1_g14&#45;&gt;expert_l1_e14_g14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12400.95,-2869.9C12400.95,-2869.9 12400.95,-2844.36 12400.95,-2844.36"/>
<polygon fill="black" stroke="black" points="12404.45,-2844.36 12400.95,-2834.36 12397.45,-2844.36 12404.45,-2844.36"/>
</g>
<!-- expert_l1_e14_g14&#45;&gt;aggregate_l1_g14 -->
<g id="edge235" class="edge">
<title>expert_l1_e14_g14&#45;&gt;aggregate_l1_g14</title>
<path fill="none" stroke="black" d="M12414.98,-2736.12C12414.98,-2736.12 12414.98,-2710.41 12414.98,-2710.41"/>
<polygon fill="black" stroke="black" points="12418.48,-2710.41 12414.98,-2700.41 12411.48,-2710.41 12418.48,-2710.41"/>
</g>
<!-- expert_l1_e15_g15 -->
<g id="node161" class="node">
<title>expert_l1_e15_g15</title>
<polygon fill="lightgreen" stroke="black" points="14463.95,-2834.17 14017.95,-2834.17 14017.95,-2736.17 14463.95,-2736.17 14463.95,-2834.17"/>
<text text-anchor="middle" x="14240.95" y="-2818.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="14240.95" y="-2803.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="14240.95" y="-2788.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14240.95" y="-2773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14240.95" y="-2758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14240.95" y="-2743.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l1_g15&#45;&gt;expert_l1_e15_g15 -->
<g id="edge238" class="edge">
<title>gate_l1_g15&#45;&gt;expert_l1_e15_g15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14240.95,-2869.9C14240.95,-2869.9 14240.95,-2844.36 14240.95,-2844.36"/>
<polygon fill="black" stroke="black" points="14244.45,-2844.36 14240.95,-2834.36 14237.45,-2844.36 14244.45,-2844.36"/>
</g>
<!-- expert_l1_e15_g15&#45;&gt;aggregate_l1_g15 -->
<g id="edge239" class="edge">
<title>expert_l1_e15_g15&#45;&gt;aggregate_l1_g15</title>
<path fill="none" stroke="black" d="M14253.98,-2736.12C14253.98,-2736.12 14253.98,-2710.41 14253.98,-2710.41"/>
<polygon fill="black" stroke="black" points="14257.48,-2710.41 14253.98,-2700.41 14250.48,-2710.41 14257.48,-2710.41"/>
</g>
<!-- mha_qkv_l2_g0 -->
<g id="node178" class="node">
<title>mha_qkv_l2_g0</title>
<polygon fill="lightcoral" stroke="black" points="1372.95,-2498.17 900.95,-2498.17 900.95,-2430.17 1372.95,-2430.17 1372.95,-2498.17"/>
<text text-anchor="middle" x="1136.95" y="-2482.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 2</text>
<text text-anchor="middle" x="1136.95" y="-2467.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1136.95" y="-2452.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1136.95" y="-2437.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l1_g0&#45;&gt;mha_qkv_l2_g0 -->
<g id="edge241" class="edge">
<title>aggregate_l1_g0&#45;&gt;mha_qkv_l2_g0</title>
<path fill="none" stroke="black" d="M1012.93,-2599.01C1012.93,-2599.01 1012.93,-2508.22 1012.93,-2508.22"/>
<polygon fill="black" stroke="black" points="1016.43,-2508.22 1012.93,-2498.22 1009.43,-2508.22 1016.43,-2508.22"/>
</g>
<!-- residual_l2_g0 -->
<g id="node203" class="node">
<title>residual_l2_g0</title>
<polygon fill="lightyellow" stroke="black" points="1564.24,-1984.17 884.52,-1984.17 709.67,-1788.17 1389.38,-1788.17 1564.24,-1984.17"/>
<text text-anchor="middle" x="1136.95" y="-1919.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1136.95" y="-1904.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1136.95" y="-1889.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1136.95" y="-1874.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1136.95" y="-1859.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1136.95" y="-1844.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l1_g0&#45;&gt;residual_l2_g0 -->
<g id="edge260" class="edge">
<title>aggregate_l1_g0&#45;&gt;residual_l2_g0</title>
<path fill="none" stroke="black" d="M604.9,-2534C604.9,-2342.37 604.9,-1886 604.9,-1886 604.9,-1886 786.61,-1886 786.61,-1886"/>
<polygon fill="black" stroke="black" points="786.61,-1889.5 796.61,-1886 786.61,-1882.5 786.61,-1889.5"/>
</g>
<!-- mha_qkv_l2_g1 -->
<g id="node181" class="node">
<title>mha_qkv_l2_g1</title>
<polygon fill="lightcoral" stroke="black" points="3209.95,-2498.17 2737.95,-2498.17 2737.95,-2430.17 3209.95,-2430.17 3209.95,-2498.17"/>
<text text-anchor="middle" x="2973.95" y="-2482.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 2</text>
<text text-anchor="middle" x="2973.95" y="-2467.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2973.95" y="-2452.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2973.95" y="-2437.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l1_g1&#45;&gt;mha_qkv_l2_g1 -->
<g id="edge243" class="edge">
<title>aggregate_l1_g1&#45;&gt;mha_qkv_l2_g1</title>
<path fill="none" stroke="black" d="M2850.43,-2598.71C2850.43,-2598.71 2850.43,-2508.37 2850.43,-2508.37"/>
<polygon fill="black" stroke="black" points="2853.93,-2508.37 2850.43,-2498.37 2846.93,-2508.37 2853.93,-2508.37"/>
</g>
<!-- residual_l2_g1 -->
<g id="node205" class="node">
<title>residual_l2_g1</title>
<polygon fill="lightyellow" stroke="black" points="3401.24,-1984.17 2721.52,-1984.17 2546.67,-1788.17 3226.38,-1788.17 3401.24,-1984.17"/>
<text text-anchor="middle" x="2973.95" y="-1919.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2973.95" y="-1904.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2973.95" y="-1889.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2973.95" y="-1874.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2973.95" y="-1859.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2973.95" y="-1844.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l1_g1&#45;&gt;residual_l2_g1 -->
<g id="edge266" class="edge">
<title>aggregate_l1_g1&#45;&gt;residual_l2_g1</title>
<path fill="none" stroke="black" d="M2442.4,-2533.86C2442.4,-2351.88 2442.4,-1935 2442.4,-1935 2442.4,-1935 2667.48,-1935 2667.48,-1935"/>
<polygon fill="black" stroke="black" points="2667.48,-1938.5 2677.48,-1935 2667.48,-1931.5 2667.48,-1938.5"/>
</g>
<!-- mha_qkv_l2_g2 -->
<g id="node184" class="node">
<title>mha_qkv_l2_g2</title>
<polygon fill="lightcoral" stroke="black" points="5048.95,-2498.17 4576.95,-2498.17 4576.95,-2430.17 5048.95,-2430.17 5048.95,-2498.17"/>
<text text-anchor="middle" x="4812.95" y="-2482.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 2</text>
<text text-anchor="middle" x="4812.95" y="-2467.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4812.95" y="-2452.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4812.95" y="-2437.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l1_g2&#45;&gt;mha_qkv_l2_g2 -->
<g id="edge245" class="edge">
<title>aggregate_l1_g2&#45;&gt;mha_qkv_l2_g2</title>
<path fill="none" stroke="black" d="M4688.43,-2599.62C4688.43,-2599.62 4688.43,-2508.21 4688.43,-2508.21"/>
<polygon fill="black" stroke="black" points="4691.93,-2508.21 4688.43,-2498.21 4684.93,-2508.21 4691.93,-2508.21"/>
</g>
<!-- residual_l2_g2 -->
<g id="node207" class="node">
<title>residual_l2_g2</title>
<polygon fill="lightyellow" stroke="black" points="5240.24,-1984.17 4560.52,-1984.17 4385.67,-1788.17 5065.38,-1788.17 5240.24,-1984.17"/>
<text text-anchor="middle" x="4812.95" y="-1919.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4812.95" y="-1904.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4812.95" y="-1889.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4812.95" y="-1874.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4812.95" y="-1859.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4812.95" y="-1844.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l1_g2&#45;&gt;residual_l2_g2 -->
<g id="edge272" class="edge">
<title>aggregate_l1_g2&#45;&gt;residual_l2_g2</title>
<path fill="none" stroke="black" d="M4282.9,-2533.86C4282.9,-2351.88 4282.9,-1935 4282.9,-1935 4282.9,-1935 4506.55,-1935 4506.55,-1935"/>
<polygon fill="black" stroke="black" points="4506.55,-1938.5 4516.55,-1935 4506.55,-1931.5 4506.55,-1938.5"/>
</g>
<!-- mha_qkv_l2_g3 -->
<g id="node187" class="node">
<title>mha_qkv_l2_g3</title>
<polygon fill="lightcoral" stroke="black" points="6905.95,-2498.17 6433.95,-2498.17 6433.95,-2430.17 6905.95,-2430.17 6905.95,-2498.17"/>
<text text-anchor="middle" x="6669.95" y="-2482.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 2</text>
<text text-anchor="middle" x="6669.95" y="-2467.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6669.95" y="-2452.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6669.95" y="-2437.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l1_g3&#45;&gt;mha_qkv_l2_g3 -->
<g id="edge247" class="edge">
<title>aggregate_l1_g3&#45;&gt;mha_qkv_l2_g3</title>
<path fill="none" stroke="black" d="M6548.43,-2596.85C6548.43,-2596.85 6548.43,-2508.35 6548.43,-2508.35"/>
<polygon fill="black" stroke="black" points="6551.93,-2508.35 6548.43,-2498.35 6544.93,-2508.35 6551.93,-2508.35"/>
</g>
<!-- residual_l2_g3 -->
<g id="node209" class="node">
<title>residual_l2_g3</title>
<polygon fill="lightyellow" stroke="black" points="7097.24,-1984.17 6417.52,-1984.17 6242.67,-1788.17 6922.38,-1788.17 7097.24,-1984.17"/>
<text text-anchor="middle" x="6669.95" y="-1919.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6669.95" y="-1904.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="6669.95" y="-1889.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6669.95" y="-1874.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6669.95" y="-1859.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6669.95" y="-1844.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l1_g3&#45;&gt;residual_l2_g3 -->
<g id="edge278" class="edge">
<title>aggregate_l1_g3&#45;&gt;residual_l2_g3</title>
<path fill="none" stroke="black" d="M6129.4,-2533.86C6129.4,-2351.88 6129.4,-1935 6129.4,-1935 6129.4,-1935 6363.58,-1935 6363.58,-1935"/>
<polygon fill="black" stroke="black" points="6363.58,-1938.5 6373.58,-1935 6363.58,-1931.5 6363.58,-1938.5"/>
</g>
<!-- mha_qkv_l2_g4 -->
<g id="node190" class="node">
<title>mha_qkv_l2_g4</title>
<polygon fill="lightcoral" stroke="black" points="8748.95,-2498.17 8276.95,-2498.17 8276.95,-2430.17 8748.95,-2430.17 8748.95,-2498.17"/>
<text text-anchor="middle" x="8512.95" y="-2482.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 2</text>
<text text-anchor="middle" x="8512.95" y="-2467.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8512.95" y="-2452.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8512.95" y="-2437.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l1_g4&#45;&gt;mha_qkv_l2_g4 -->
<g id="edge249" class="edge">
<title>aggregate_l1_g4&#45;&gt;mha_qkv_l2_g4</title>
<path fill="none" stroke="black" d="M8389.93,-2598.1C8389.93,-2598.1 8389.93,-2508.37 8389.93,-2508.37"/>
<polygon fill="black" stroke="black" points="8393.43,-2508.37 8389.93,-2498.37 8386.43,-2508.37 8393.43,-2508.37"/>
</g>
<!-- residual_l2_g4 -->
<g id="node211" class="node">
<title>residual_l2_g4</title>
<polygon fill="lightyellow" stroke="black" points="8940.24,-1984.17 8260.52,-1984.17 8085.67,-1788.17 8765.38,-1788.17 8940.24,-1984.17"/>
<text text-anchor="middle" x="8512.95" y="-1919.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8512.95" y="-1904.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="8512.95" y="-1889.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8512.95" y="-1874.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8512.95" y="-1859.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8512.95" y="-1844.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l1_g4&#45;&gt;residual_l2_g4 -->
<g id="edge284" class="edge">
<title>aggregate_l1_g4&#45;&gt;residual_l2_g4</title>
<path fill="none" stroke="black" d="M7969.4,-2534C7969.4,-2342.37 7969.4,-1886 7969.4,-1886 7969.4,-1886 8162.57,-1886 8162.57,-1886"/>
<polygon fill="black" stroke="black" points="8162.57,-1889.5 8172.57,-1886 8162.57,-1882.5 8162.57,-1889.5"/>
</g>
<!-- mha_qkv_l2_g5 -->
<g id="node193" class="node">
<title>mha_qkv_l2_g5</title>
<polygon fill="lightcoral" stroke="black" points="10591.95,-2498.17 10119.95,-2498.17 10119.95,-2430.17 10591.95,-2430.17 10591.95,-2498.17"/>
<text text-anchor="middle" x="10355.95" y="-2482.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 2</text>
<text text-anchor="middle" x="10355.95" y="-2467.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10355.95" y="-2452.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10355.95" y="-2437.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l1_g5&#45;&gt;mha_qkv_l2_g5 -->
<g id="edge251" class="edge">
<title>aggregate_l1_g5&#45;&gt;mha_qkv_l2_g5</title>
<path fill="none" stroke="black" d="M10234.43,-2596.85C10234.43,-2596.85 10234.43,-2508.35 10234.43,-2508.35"/>
<polygon fill="black" stroke="black" points="10237.93,-2508.35 10234.43,-2498.35 10230.93,-2508.35 10237.93,-2508.35"/>
</g>
<!-- residual_l2_g5 -->
<g id="node213" class="node">
<title>residual_l2_g5</title>
<polygon fill="lightyellow" stroke="black" points="10783.24,-1984.17 10103.52,-1984.17 9928.67,-1788.17 10608.38,-1788.17 10783.24,-1984.17"/>
<text text-anchor="middle" x="10355.95" y="-1919.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10355.95" y="-1904.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="10355.95" y="-1889.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10355.95" y="-1874.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10355.95" y="-1859.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10355.95" y="-1844.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l1_g5&#45;&gt;residual_l2_g5 -->
<g id="edge290" class="edge">
<title>aggregate_l1_g5&#45;&gt;residual_l2_g5</title>
<path fill="none" stroke="black" d="M9808.9,-2534C9808.9,-2342.37 9808.9,-1886 9808.9,-1886 9808.9,-1886 10005.72,-1886 10005.72,-1886"/>
<polygon fill="black" stroke="black" points="10005.72,-1889.5 10015.72,-1886 10005.72,-1882.5 10005.72,-1889.5"/>
</g>
<!-- mha_qkv_l2_g6 -->
<g id="node196" class="node">
<title>mha_qkv_l2_g6</title>
<polygon fill="lightcoral" stroke="black" points="12433.95,-2498.17 11961.95,-2498.17 11961.95,-2430.17 12433.95,-2430.17 12433.95,-2498.17"/>
<text text-anchor="middle" x="12197.95" y="-2482.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 2</text>
<text text-anchor="middle" x="12197.95" y="-2467.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12197.95" y="-2452.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12197.95" y="-2437.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l1_g6&#45;&gt;mha_qkv_l2_g6 -->
<g id="edge253" class="edge">
<title>aggregate_l1_g6&#45;&gt;mha_qkv_l2_g6</title>
<path fill="none" stroke="black" d="M12074.93,-2598.1C12074.93,-2598.1 12074.93,-2508.37 12074.93,-2508.37"/>
<polygon fill="black" stroke="black" points="12078.43,-2508.37 12074.93,-2498.37 12071.43,-2508.37 12078.43,-2508.37"/>
</g>
<!-- residual_l2_g6 -->
<g id="node215" class="node">
<title>residual_l2_g6</title>
<polygon fill="lightyellow" stroke="black" points="12625.24,-1984.17 11945.52,-1984.17 11770.67,-1788.17 12450.38,-1788.17 12625.24,-1984.17"/>
<text text-anchor="middle" x="12197.95" y="-1919.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12197.95" y="-1904.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="12197.95" y="-1889.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12197.95" y="-1874.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12197.95" y="-1859.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12197.95" y="-1844.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l1_g6&#45;&gt;residual_l2_g6 -->
<g id="edge296" class="edge">
<title>aggregate_l1_g6&#45;&gt;residual_l2_g6</title>
<path fill="none" stroke="black" d="M11655.4,-2534C11655.4,-2342.37 11655.4,-1886 11655.4,-1886 11655.4,-1886 11847.81,-1886 11847.81,-1886"/>
<polygon fill="black" stroke="black" points="11847.81,-1889.5 11857.81,-1886 11847.81,-1882.5 11847.81,-1889.5"/>
</g>
<!-- mha_qkv_l2_g7 -->
<g id="node199" class="node">
<title>mha_qkv_l2_g7</title>
<polygon fill="lightcoral" stroke="black" points="14271.95,-2498.17 13799.95,-2498.17 13799.95,-2430.17 14271.95,-2430.17 14271.95,-2498.17"/>
<text text-anchor="middle" x="14035.95" y="-2482.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 2</text>
<text text-anchor="middle" x="14035.95" y="-2467.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14035.95" y="-2452.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14035.95" y="-2437.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l1_g7&#45;&gt;mha_qkv_l2_g7 -->
<g id="edge255" class="edge">
<title>aggregate_l1_g7&#45;&gt;mha_qkv_l2_g7</title>
<path fill="none" stroke="black" d="M13912.93,-2598.1C13912.93,-2598.1 13912.93,-2508.37 13912.93,-2508.37"/>
<polygon fill="black" stroke="black" points="13916.43,-2508.37 13912.93,-2498.37 13909.43,-2508.37 13916.43,-2508.37"/>
</g>
<!-- residual_l2_g7 -->
<g id="node217" class="node">
<title>residual_l2_g7</title>
<polygon fill="lightyellow" stroke="black" points="14463.24,-1984.17 13783.52,-1984.17 13608.67,-1788.17 14288.38,-1788.17 14463.24,-1984.17"/>
<text text-anchor="middle" x="14035.95" y="-1919.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14035.95" y="-1904.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14035.95" y="-1889.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14035.95" y="-1874.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14035.95" y="-1859.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14035.95" y="-1844.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l1_g7&#45;&gt;residual_l2_g7 -->
<g id="edge302" class="edge">
<title>aggregate_l1_g7&#45;&gt;residual_l2_g7</title>
<path fill="none" stroke="black" d="M13496.9,-2533.86C13496.9,-2351.88 13496.9,-1935 13496.9,-1935 13496.9,-1935 13729.62,-1935 13729.62,-1935"/>
<polygon fill="black" stroke="black" points="13729.62,-1938.5 13739.62,-1935 13729.62,-1931.5 13729.62,-1938.5"/>
</g>
<!-- aggregate_l1_g8&#45;&gt;mha_qkv_l2_g0 -->
<g id="edge242" class="edge">
<title>aggregate_l1_g8&#45;&gt;mha_qkv_l2_g0</title>
<path fill="none" stroke="black" d="M1257.98,-2533.95C1257.98,-2533.95 1257.98,-2508.23 1257.98,-2508.23"/>
<polygon fill="black" stroke="black" points="1261.48,-2508.23 1257.98,-2498.23 1254.48,-2508.23 1261.48,-2508.23"/>
</g>
<!-- aggregate_l1_g8&#45;&gt;residual_l2_g0 -->
<g id="edge261" class="edge">
<title>aggregate_l1_g8&#45;&gt;residual_l2_g0</title>
<path fill="none" stroke="black" d="M1701.77,-2534C1701.77,-2342.37 1701.77,-1886 1701.77,-1886 1701.77,-1886 1486.92,-1886 1486.92,-1886"/>
<polygon fill="black" stroke="black" points="1486.92,-1882.5 1476.92,-1886 1486.92,-1889.5 1486.92,-1882.5"/>
</g>
<!-- aggregate_l1_g9&#45;&gt;mha_qkv_l2_g1 -->
<g id="edge244" class="edge">
<title>aggregate_l1_g9&#45;&gt;mha_qkv_l2_g1</title>
<path fill="none" stroke="black" d="M3095.48,-2533.95C3095.48,-2533.95 3095.48,-2508.23 3095.48,-2508.23"/>
<polygon fill="black" stroke="black" points="3098.98,-2508.23 3095.48,-2498.23 3091.98,-2508.23 3098.98,-2508.23"/>
</g>
<!-- aggregate_l1_g9&#45;&gt;residual_l2_g1 -->
<g id="edge267" class="edge">
<title>aggregate_l1_g9&#45;&gt;residual_l2_g1</title>
<path fill="none" stroke="black" d="M3540.27,-2534C3540.27,-2342.37 3540.27,-1886 3540.27,-1886 3540.27,-1886 3324.01,-1886 3324.01,-1886"/>
<polygon fill="black" stroke="black" points="3324.01,-1882.5 3314.01,-1886 3324.01,-1889.5 3324.01,-1882.5"/>
</g>
<!-- aggregate_l1_g10&#45;&gt;mha_qkv_l2_g2 -->
<g id="edge246" class="edge">
<title>aggregate_l1_g10&#45;&gt;mha_qkv_l2_g2</title>
<path fill="none" stroke="black" d="M4933.48,-2533.95C4933.48,-2533.95 4933.48,-2508.23 4933.48,-2508.23"/>
<polygon fill="black" stroke="black" points="4936.98,-2508.23 4933.48,-2498.23 4929.98,-2508.23 4936.98,-2508.23"/>
</g>
<!-- aggregate_l1_g10&#45;&gt;residual_l2_g2 -->
<g id="edge273" class="edge">
<title>aggregate_l1_g10&#45;&gt;residual_l2_g2</title>
<path fill="none" stroke="black" d="M5379.77,-2534C5379.77,-2342.37 5379.77,-1886 5379.77,-1886 5379.77,-1886 5162.9,-1886 5162.9,-1886"/>
<polygon fill="black" stroke="black" points="5162.9,-1882.5 5152.9,-1886 5162.9,-1889.5 5162.9,-1882.5"/>
</g>
<!-- aggregate_l1_g11&#45;&gt;mha_qkv_l2_g3 -->
<g id="edge248" class="edge">
<title>aggregate_l1_g11&#45;&gt;mha_qkv_l2_g3</title>
<path fill="none" stroke="black" d="M6793.48,-2533.95C6793.48,-2533.95 6793.48,-2508.23 6793.48,-2508.23"/>
<polygon fill="black" stroke="black" points="6796.98,-2508.23 6793.48,-2498.23 6789.98,-2508.23 6796.98,-2508.23"/>
</g>
<!-- aggregate_l1_g11&#45;&gt;residual_l2_g3 -->
<g id="edge279" class="edge">
<title>aggregate_l1_g11&#45;&gt;residual_l2_g3</title>
<path fill="none" stroke="black" d="M7229.77,-2533.86C7229.77,-2351.88 7229.77,-1935 7229.77,-1935 7229.77,-1935 7063.41,-1935 7063.41,-1935"/>
<polygon fill="black" stroke="black" points="7063.41,-1931.5 7053.41,-1935 7063.41,-1938.5 7063.41,-1931.5"/>
</g>
<!-- aggregate_l1_g12&#45;&gt;mha_qkv_l2_g4 -->
<g id="edge250" class="edge">
<title>aggregate_l1_g12&#45;&gt;mha_qkv_l2_g4</title>
<path fill="none" stroke="black" d="M8634.98,-2533.95C8634.98,-2533.95 8634.98,-2508.23 8634.98,-2508.23"/>
<polygon fill="black" stroke="black" points="8638.48,-2508.23 8634.98,-2498.23 8631.48,-2508.23 8638.48,-2508.23"/>
</g>
<!-- aggregate_l1_g12&#45;&gt;residual_l2_g4 -->
<g id="edge285" class="edge">
<title>aggregate_l1_g12&#45;&gt;residual_l2_g4</title>
<path fill="none" stroke="black" d="M9069.77,-2533.86C9069.77,-2351.88 9069.77,-1935 9069.77,-1935 9069.77,-1935 8906.64,-1935 8906.64,-1935"/>
<polygon fill="black" stroke="black" points="8906.64,-1931.5 8896.64,-1935 8906.64,-1938.5 8906.64,-1931.5"/>
</g>
<!-- aggregate_l1_g13&#45;&gt;mha_qkv_l2_g5 -->
<g id="edge252" class="edge">
<title>aggregate_l1_g13&#45;&gt;mha_qkv_l2_g5</title>
<path fill="none" stroke="black" d="M10479.48,-2533.95C10479.48,-2533.95 10479.48,-2508.23 10479.48,-2508.23"/>
<polygon fill="black" stroke="black" points="10482.98,-2508.23 10479.48,-2498.23 10475.98,-2508.23 10482.98,-2508.23"/>
</g>
<!-- aggregate_l1_g13&#45;&gt;residual_l2_g5 -->
<g id="edge291" class="edge">
<title>aggregate_l1_g13&#45;&gt;residual_l2_g5</title>
<path fill="none" stroke="black" d="M10913.27,-2533.86C10913.27,-2351.88 10913.27,-1935 10913.27,-1935 10913.27,-1935 10749.61,-1935 10749.61,-1935"/>
<polygon fill="black" stroke="black" points="10749.61,-1931.5 10739.61,-1935 10749.61,-1938.5 10749.61,-1931.5"/>
</g>
<!-- aggregate_l1_g14&#45;&gt;mha_qkv_l2_g6 -->
<g id="edge254" class="edge">
<title>aggregate_l1_g14&#45;&gt;mha_qkv_l2_g6</title>
<path fill="none" stroke="black" d="M12319.98,-2533.95C12319.98,-2533.95 12319.98,-2508.23 12319.98,-2508.23"/>
<polygon fill="black" stroke="black" points="12323.48,-2508.23 12319.98,-2498.23 12316.48,-2508.23 12323.48,-2508.23"/>
</g>
<!-- aggregate_l1_g14&#45;&gt;residual_l2_g6 -->
<g id="edge297" class="edge">
<title>aggregate_l1_g14&#45;&gt;residual_l2_g6</title>
<path fill="none" stroke="black" d="M12758.27,-2534C12758.27,-2342.37 12758.27,-1886 12758.27,-1886 12758.27,-1886 12548.02,-1886 12548.02,-1886"/>
<polygon fill="black" stroke="black" points="12548.02,-1882.5 12538.02,-1886 12548.02,-1889.5 12548.02,-1882.5"/>
</g>
<!-- aggregate_l1_g15&#45;&gt;mha_qkv_l2_g7 -->
<g id="edge256" class="edge">
<title>aggregate_l1_g15&#45;&gt;mha_qkv_l2_g7</title>
<path fill="none" stroke="black" d="M14157.98,-2533.95C14157.98,-2533.95 14157.98,-2508.23 14157.98,-2508.23"/>
<polygon fill="black" stroke="black" points="14161.48,-2508.23 14157.98,-2498.23 14154.48,-2508.23 14161.48,-2508.23"/>
</g>
<!-- aggregate_l1_g15&#45;&gt;residual_l2_g7 -->
<g id="edge303" class="edge">
<title>aggregate_l1_g15&#45;&gt;residual_l2_g7</title>
<path fill="none" stroke="black" d="M14599.77,-2533.87C14599.77,-2348.48 14599.77,-1918 14599.77,-1918 14599.77,-1918 14414.55,-1918 14414.55,-1918"/>
<polygon fill="black" stroke="black" points="14414.55,-1914.5 14404.55,-1918 14414.55,-1921.5 14414.55,-1914.5"/>
</g>
<!-- mha_attn_l2_g0 -->
<g id="node179" class="node">
<title>mha_attn_l2_g0</title>
<polygon fill="lightcoral" stroke="black" points="1372.95,-2394.17 900.95,-2394.17 900.95,-2326.17 1372.95,-2326.17 1372.95,-2394.17"/>
<text text-anchor="middle" x="1136.95" y="-2378.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 2</text>
<text text-anchor="middle" x="1136.95" y="-2363.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1136.95" y="-2348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="1136.95" y="-2333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l2_g0&#45;&gt;mha_attn_l2_g0 -->
<g id="edge257" class="edge">
<title>mha_qkv_l2_g0&#45;&gt;mha_attn_l2_g0</title>
<path fill="none" stroke="black" d="M1136.95,-2430.11C1136.95,-2430.11 1136.95,-2404.3 1136.95,-2404.3"/>
<polygon fill="black" stroke="black" points="1140.45,-2404.3 1136.95,-2394.3 1133.45,-2404.3 1140.45,-2404.3"/>
</g>
<!-- mha_out_l2_g0 -->
<g id="node180" class="node">
<title>mha_out_l2_g0</title>
<polygon fill="lightcoral" stroke="black" points="1366.95,-2290.17 906.95,-2290.17 906.95,-2222.17 1366.95,-2222.17 1366.95,-2290.17"/>
<text text-anchor="middle" x="1136.95" y="-2274.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 2</text>
<text text-anchor="middle" x="1136.95" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1136.95" y="-2244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="1136.95" y="-2229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l2_g0&#45;&gt;mha_out_l2_g0 -->
<g id="edge258" class="edge">
<title>mha_attn_l2_g0&#45;&gt;mha_out_l2_g0</title>
<path fill="none" stroke="black" d="M1136.95,-2326.11C1136.95,-2326.11 1136.95,-2300.3 1136.95,-2300.3"/>
<polygon fill="black" stroke="black" points="1140.45,-2300.3 1136.95,-2290.3 1133.45,-2300.3 1140.45,-2300.3"/>
</g>
<!-- allreduce_l2_g0 -->
<g id="node202" class="node">
<title>allreduce_l2_g0</title>
<polygon fill="lightyellow" stroke="black" points="1564.24,-2186.17 884.52,-2186.17 709.67,-2020.17 1389.38,-2020.17 1564.24,-2186.17"/>
<text text-anchor="middle" x="1136.95" y="-2129.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="1136.95" y="-2114.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1136.95" y="-2099.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1136.95" y="-2084.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="1136.95" y="-2069.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l2_g0&#45;&gt;allreduce_l2_g0 -->
<g id="edge259" class="edge">
<title>mha_out_l2_g0&#45;&gt;allreduce_l2_g0</title>
<path fill="none" stroke="black" d="M1136.95,-2221.83C1136.95,-2221.83 1136.95,-2196.43 1136.95,-2196.43"/>
<polygon fill="black" stroke="black" points="1140.45,-2196.43 1136.95,-2186.43 1133.45,-2196.43 1140.45,-2196.43"/>
</g>
<!-- mha_attn_l2_g1 -->
<g id="node182" class="node">
<title>mha_attn_l2_g1</title>
<polygon fill="lightcoral" stroke="black" points="3209.95,-2394.17 2737.95,-2394.17 2737.95,-2326.17 3209.95,-2326.17 3209.95,-2394.17"/>
<text text-anchor="middle" x="2973.95" y="-2378.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 2</text>
<text text-anchor="middle" x="2973.95" y="-2363.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2973.95" y="-2348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="2973.95" y="-2333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l2_g1&#45;&gt;mha_attn_l2_g1 -->
<g id="edge263" class="edge">
<title>mha_qkv_l2_g1&#45;&gt;mha_attn_l2_g1</title>
<path fill="none" stroke="black" d="M2973.95,-2430.11C2973.95,-2430.11 2973.95,-2404.3 2973.95,-2404.3"/>
<polygon fill="black" stroke="black" points="2977.45,-2404.3 2973.95,-2394.3 2970.45,-2404.3 2977.45,-2404.3"/>
</g>
<!-- mha_out_l2_g1 -->
<g id="node183" class="node">
<title>mha_out_l2_g1</title>
<polygon fill="lightcoral" stroke="black" points="3203.95,-2290.17 2743.95,-2290.17 2743.95,-2222.17 3203.95,-2222.17 3203.95,-2290.17"/>
<text text-anchor="middle" x="2973.95" y="-2274.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 2</text>
<text text-anchor="middle" x="2973.95" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2973.95" y="-2244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="2973.95" y="-2229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l2_g1&#45;&gt;mha_out_l2_g1 -->
<g id="edge264" class="edge">
<title>mha_attn_l2_g1&#45;&gt;mha_out_l2_g1</title>
<path fill="none" stroke="black" d="M2973.95,-2326.11C2973.95,-2326.11 2973.95,-2300.3 2973.95,-2300.3"/>
<polygon fill="black" stroke="black" points="2977.45,-2300.3 2973.95,-2290.3 2970.45,-2300.3 2977.45,-2300.3"/>
</g>
<!-- allreduce_l2_g1 -->
<g id="node204" class="node">
<title>allreduce_l2_g1</title>
<polygon fill="lightyellow" stroke="black" points="3401.24,-2186.17 2721.52,-2186.17 2546.67,-2020.17 3226.38,-2020.17 3401.24,-2186.17"/>
<text text-anchor="middle" x="2973.95" y="-2129.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="2973.95" y="-2114.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2973.95" y="-2099.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2973.95" y="-2084.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="2973.95" y="-2069.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l2_g1&#45;&gt;allreduce_l2_g1 -->
<g id="edge265" class="edge">
<title>mha_out_l2_g1&#45;&gt;allreduce_l2_g1</title>
<path fill="none" stroke="black" d="M2973.95,-2221.83C2973.95,-2221.83 2973.95,-2196.43 2973.95,-2196.43"/>
<polygon fill="black" stroke="black" points="2977.45,-2196.43 2973.95,-2186.43 2970.45,-2196.43 2977.45,-2196.43"/>
</g>
<!-- mha_attn_l2_g2 -->
<g id="node185" class="node">
<title>mha_attn_l2_g2</title>
<polygon fill="lightcoral" stroke="black" points="5048.95,-2394.17 4576.95,-2394.17 4576.95,-2326.17 5048.95,-2326.17 5048.95,-2394.17"/>
<text text-anchor="middle" x="4812.95" y="-2378.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 2</text>
<text text-anchor="middle" x="4812.95" y="-2363.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4812.95" y="-2348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="4812.95" y="-2333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l2_g2&#45;&gt;mha_attn_l2_g2 -->
<g id="edge269" class="edge">
<title>mha_qkv_l2_g2&#45;&gt;mha_attn_l2_g2</title>
<path fill="none" stroke="black" d="M4812.95,-2430.11C4812.95,-2430.11 4812.95,-2404.3 4812.95,-2404.3"/>
<polygon fill="black" stroke="black" points="4816.45,-2404.3 4812.95,-2394.3 4809.45,-2404.3 4816.45,-2404.3"/>
</g>
<!-- mha_out_l2_g2 -->
<g id="node186" class="node">
<title>mha_out_l2_g2</title>
<polygon fill="lightcoral" stroke="black" points="5042.95,-2290.17 4582.95,-2290.17 4582.95,-2222.17 5042.95,-2222.17 5042.95,-2290.17"/>
<text text-anchor="middle" x="4812.95" y="-2274.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 2</text>
<text text-anchor="middle" x="4812.95" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4812.95" y="-2244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="4812.95" y="-2229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l2_g2&#45;&gt;mha_out_l2_g2 -->
<g id="edge270" class="edge">
<title>mha_attn_l2_g2&#45;&gt;mha_out_l2_g2</title>
<path fill="none" stroke="black" d="M4812.95,-2326.11C4812.95,-2326.11 4812.95,-2300.3 4812.95,-2300.3"/>
<polygon fill="black" stroke="black" points="4816.45,-2300.3 4812.95,-2290.3 4809.45,-2300.3 4816.45,-2300.3"/>
</g>
<!-- allreduce_l2_g2 -->
<g id="node206" class="node">
<title>allreduce_l2_g2</title>
<polygon fill="lightyellow" stroke="black" points="5240.24,-2186.17 4560.52,-2186.17 4385.67,-2020.17 5065.38,-2020.17 5240.24,-2186.17"/>
<text text-anchor="middle" x="4812.95" y="-2129.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="4812.95" y="-2114.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4812.95" y="-2099.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4812.95" y="-2084.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="4812.95" y="-2069.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l2_g2&#45;&gt;allreduce_l2_g2 -->
<g id="edge271" class="edge">
<title>mha_out_l2_g2&#45;&gt;allreduce_l2_g2</title>
<path fill="none" stroke="black" d="M4812.95,-2221.83C4812.95,-2221.83 4812.95,-2196.43 4812.95,-2196.43"/>
<polygon fill="black" stroke="black" points="4816.45,-2196.43 4812.95,-2186.43 4809.45,-2196.43 4816.45,-2196.43"/>
</g>
<!-- mha_attn_l2_g3 -->
<g id="node188" class="node">
<title>mha_attn_l2_g3</title>
<polygon fill="lightcoral" stroke="black" points="6905.95,-2394.17 6433.95,-2394.17 6433.95,-2326.17 6905.95,-2326.17 6905.95,-2394.17"/>
<text text-anchor="middle" x="6669.95" y="-2378.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 2</text>
<text text-anchor="middle" x="6669.95" y="-2363.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6669.95" y="-2348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6669.95" y="-2333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l2_g3&#45;&gt;mha_attn_l2_g3 -->
<g id="edge275" class="edge">
<title>mha_qkv_l2_g3&#45;&gt;mha_attn_l2_g3</title>
<path fill="none" stroke="black" d="M6669.95,-2430.11C6669.95,-2430.11 6669.95,-2404.3 6669.95,-2404.3"/>
<polygon fill="black" stroke="black" points="6673.45,-2404.3 6669.95,-2394.3 6666.45,-2404.3 6673.45,-2404.3"/>
</g>
<!-- mha_out_l2_g3 -->
<g id="node189" class="node">
<title>mha_out_l2_g3</title>
<polygon fill="lightcoral" stroke="black" points="6899.95,-2290.17 6439.95,-2290.17 6439.95,-2222.17 6899.95,-2222.17 6899.95,-2290.17"/>
<text text-anchor="middle" x="6669.95" y="-2274.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 2</text>
<text text-anchor="middle" x="6669.95" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6669.95" y="-2244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6669.95" y="-2229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l2_g3&#45;&gt;mha_out_l2_g3 -->
<g id="edge276" class="edge">
<title>mha_attn_l2_g3&#45;&gt;mha_out_l2_g3</title>
<path fill="none" stroke="black" d="M6669.95,-2326.11C6669.95,-2326.11 6669.95,-2300.3 6669.95,-2300.3"/>
<polygon fill="black" stroke="black" points="6673.45,-2300.3 6669.95,-2290.3 6666.45,-2300.3 6673.45,-2300.3"/>
</g>
<!-- allreduce_l2_g3 -->
<g id="node208" class="node">
<title>allreduce_l2_g3</title>
<polygon fill="lightyellow" stroke="black" points="7097.24,-2186.17 6417.52,-2186.17 6242.67,-2020.17 6922.38,-2020.17 7097.24,-2186.17"/>
<text text-anchor="middle" x="6669.95" y="-2129.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="6669.95" y="-2114.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="6669.95" y="-2099.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6669.95" y="-2084.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="6669.95" y="-2069.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l2_g3&#45;&gt;allreduce_l2_g3 -->
<g id="edge277" class="edge">
<title>mha_out_l2_g3&#45;&gt;allreduce_l2_g3</title>
<path fill="none" stroke="black" d="M6669.95,-2221.83C6669.95,-2221.83 6669.95,-2196.43 6669.95,-2196.43"/>
<polygon fill="black" stroke="black" points="6673.45,-2196.43 6669.95,-2186.43 6666.45,-2196.43 6673.45,-2196.43"/>
</g>
<!-- mha_attn_l2_g4 -->
<g id="node191" class="node">
<title>mha_attn_l2_g4</title>
<polygon fill="lightcoral" stroke="black" points="8748.95,-2394.17 8276.95,-2394.17 8276.95,-2326.17 8748.95,-2326.17 8748.95,-2394.17"/>
<text text-anchor="middle" x="8512.95" y="-2378.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 2</text>
<text text-anchor="middle" x="8512.95" y="-2363.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8512.95" y="-2348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8512.95" y="-2333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l2_g4&#45;&gt;mha_attn_l2_g4 -->
<g id="edge281" class="edge">
<title>mha_qkv_l2_g4&#45;&gt;mha_attn_l2_g4</title>
<path fill="none" stroke="black" d="M8512.95,-2430.11C8512.95,-2430.11 8512.95,-2404.3 8512.95,-2404.3"/>
<polygon fill="black" stroke="black" points="8516.45,-2404.3 8512.95,-2394.3 8509.45,-2404.3 8516.45,-2404.3"/>
</g>
<!-- mha_out_l2_g4 -->
<g id="node192" class="node">
<title>mha_out_l2_g4</title>
<polygon fill="lightcoral" stroke="black" points="8742.95,-2290.17 8282.95,-2290.17 8282.95,-2222.17 8742.95,-2222.17 8742.95,-2290.17"/>
<text text-anchor="middle" x="8512.95" y="-2274.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 2</text>
<text text-anchor="middle" x="8512.95" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8512.95" y="-2244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8512.95" y="-2229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l2_g4&#45;&gt;mha_out_l2_g4 -->
<g id="edge282" class="edge">
<title>mha_attn_l2_g4&#45;&gt;mha_out_l2_g4</title>
<path fill="none" stroke="black" d="M8512.95,-2326.11C8512.95,-2326.11 8512.95,-2300.3 8512.95,-2300.3"/>
<polygon fill="black" stroke="black" points="8516.45,-2300.3 8512.95,-2290.3 8509.45,-2300.3 8516.45,-2300.3"/>
</g>
<!-- allreduce_l2_g4 -->
<g id="node210" class="node">
<title>allreduce_l2_g4</title>
<polygon fill="lightyellow" stroke="black" points="8940.24,-2186.17 8260.52,-2186.17 8085.67,-2020.17 8765.38,-2020.17 8940.24,-2186.17"/>
<text text-anchor="middle" x="8512.95" y="-2129.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="8512.95" y="-2114.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="8512.95" y="-2099.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8512.95" y="-2084.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="8512.95" y="-2069.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l2_g4&#45;&gt;allreduce_l2_g4 -->
<g id="edge283" class="edge">
<title>mha_out_l2_g4&#45;&gt;allreduce_l2_g4</title>
<path fill="none" stroke="black" d="M8512.95,-2221.83C8512.95,-2221.83 8512.95,-2196.43 8512.95,-2196.43"/>
<polygon fill="black" stroke="black" points="8516.45,-2196.43 8512.95,-2186.43 8509.45,-2196.43 8516.45,-2196.43"/>
</g>
<!-- mha_attn_l2_g5 -->
<g id="node194" class="node">
<title>mha_attn_l2_g5</title>
<polygon fill="lightcoral" stroke="black" points="10591.95,-2394.17 10119.95,-2394.17 10119.95,-2326.17 10591.95,-2326.17 10591.95,-2394.17"/>
<text text-anchor="middle" x="10355.95" y="-2378.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 2</text>
<text text-anchor="middle" x="10355.95" y="-2363.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10355.95" y="-2348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10355.95" y="-2333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l2_g5&#45;&gt;mha_attn_l2_g5 -->
<g id="edge287" class="edge">
<title>mha_qkv_l2_g5&#45;&gt;mha_attn_l2_g5</title>
<path fill="none" stroke="black" d="M10355.95,-2430.11C10355.95,-2430.11 10355.95,-2404.3 10355.95,-2404.3"/>
<polygon fill="black" stroke="black" points="10359.45,-2404.3 10355.95,-2394.3 10352.45,-2404.3 10359.45,-2404.3"/>
</g>
<!-- mha_out_l2_g5 -->
<g id="node195" class="node">
<title>mha_out_l2_g5</title>
<polygon fill="lightcoral" stroke="black" points="10585.95,-2290.17 10125.95,-2290.17 10125.95,-2222.17 10585.95,-2222.17 10585.95,-2290.17"/>
<text text-anchor="middle" x="10355.95" y="-2274.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 2</text>
<text text-anchor="middle" x="10355.95" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10355.95" y="-2244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10355.95" y="-2229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l2_g5&#45;&gt;mha_out_l2_g5 -->
<g id="edge288" class="edge">
<title>mha_attn_l2_g5&#45;&gt;mha_out_l2_g5</title>
<path fill="none" stroke="black" d="M10355.95,-2326.11C10355.95,-2326.11 10355.95,-2300.3 10355.95,-2300.3"/>
<polygon fill="black" stroke="black" points="10359.45,-2300.3 10355.95,-2290.3 10352.45,-2300.3 10359.45,-2300.3"/>
</g>
<!-- allreduce_l2_g5 -->
<g id="node212" class="node">
<title>allreduce_l2_g5</title>
<polygon fill="lightyellow" stroke="black" points="10783.24,-2186.17 10103.52,-2186.17 9928.67,-2020.17 10608.38,-2020.17 10783.24,-2186.17"/>
<text text-anchor="middle" x="10355.95" y="-2129.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="10355.95" y="-2114.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="10355.95" y="-2099.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10355.95" y="-2084.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="10355.95" y="-2069.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l2_g5&#45;&gt;allreduce_l2_g5 -->
<g id="edge289" class="edge">
<title>mha_out_l2_g5&#45;&gt;allreduce_l2_g5</title>
<path fill="none" stroke="black" d="M10355.95,-2221.83C10355.95,-2221.83 10355.95,-2196.43 10355.95,-2196.43"/>
<polygon fill="black" stroke="black" points="10359.45,-2196.43 10355.95,-2186.43 10352.45,-2196.43 10359.45,-2196.43"/>
</g>
<!-- mha_attn_l2_g6 -->
<g id="node197" class="node">
<title>mha_attn_l2_g6</title>
<polygon fill="lightcoral" stroke="black" points="12433.95,-2394.17 11961.95,-2394.17 11961.95,-2326.17 12433.95,-2326.17 12433.95,-2394.17"/>
<text text-anchor="middle" x="12197.95" y="-2378.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 2</text>
<text text-anchor="middle" x="12197.95" y="-2363.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12197.95" y="-2348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="12197.95" y="-2333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l2_g6&#45;&gt;mha_attn_l2_g6 -->
<g id="edge293" class="edge">
<title>mha_qkv_l2_g6&#45;&gt;mha_attn_l2_g6</title>
<path fill="none" stroke="black" d="M12197.95,-2430.11C12197.95,-2430.11 12197.95,-2404.3 12197.95,-2404.3"/>
<polygon fill="black" stroke="black" points="12201.45,-2404.3 12197.95,-2394.3 12194.45,-2404.3 12201.45,-2404.3"/>
</g>
<!-- mha_out_l2_g6 -->
<g id="node198" class="node">
<title>mha_out_l2_g6</title>
<polygon fill="lightcoral" stroke="black" points="12427.95,-2290.17 11967.95,-2290.17 11967.95,-2222.17 12427.95,-2222.17 12427.95,-2290.17"/>
<text text-anchor="middle" x="12197.95" y="-2274.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 2</text>
<text text-anchor="middle" x="12197.95" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12197.95" y="-2244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="12197.95" y="-2229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l2_g6&#45;&gt;mha_out_l2_g6 -->
<g id="edge294" class="edge">
<title>mha_attn_l2_g6&#45;&gt;mha_out_l2_g6</title>
<path fill="none" stroke="black" d="M12197.95,-2326.11C12197.95,-2326.11 12197.95,-2300.3 12197.95,-2300.3"/>
<polygon fill="black" stroke="black" points="12201.45,-2300.3 12197.95,-2290.3 12194.45,-2300.3 12201.45,-2300.3"/>
</g>
<!-- allreduce_l2_g6 -->
<g id="node214" class="node">
<title>allreduce_l2_g6</title>
<polygon fill="lightyellow" stroke="black" points="12625.24,-2186.17 11945.52,-2186.17 11770.67,-2020.17 12450.38,-2020.17 12625.24,-2186.17"/>
<text text-anchor="middle" x="12197.95" y="-2129.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="12197.95" y="-2114.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="12197.95" y="-2099.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12197.95" y="-2084.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="12197.95" y="-2069.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l2_g6&#45;&gt;allreduce_l2_g6 -->
<g id="edge295" class="edge">
<title>mha_out_l2_g6&#45;&gt;allreduce_l2_g6</title>
<path fill="none" stroke="black" d="M12197.95,-2221.83C12197.95,-2221.83 12197.95,-2196.43 12197.95,-2196.43"/>
<polygon fill="black" stroke="black" points="12201.45,-2196.43 12197.95,-2186.43 12194.45,-2196.43 12201.45,-2196.43"/>
</g>
<!-- mha_attn_l2_g7 -->
<g id="node200" class="node">
<title>mha_attn_l2_g7</title>
<polygon fill="lightcoral" stroke="black" points="14271.95,-2394.17 13799.95,-2394.17 13799.95,-2326.17 14271.95,-2326.17 14271.95,-2394.17"/>
<text text-anchor="middle" x="14035.95" y="-2378.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 2</text>
<text text-anchor="middle" x="14035.95" y="-2363.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14035.95" y="-2348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="14035.95" y="-2333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l2_g7&#45;&gt;mha_attn_l2_g7 -->
<g id="edge299" class="edge">
<title>mha_qkv_l2_g7&#45;&gt;mha_attn_l2_g7</title>
<path fill="none" stroke="black" d="M14035.95,-2430.11C14035.95,-2430.11 14035.95,-2404.3 14035.95,-2404.3"/>
<polygon fill="black" stroke="black" points="14039.45,-2404.3 14035.95,-2394.3 14032.45,-2404.3 14039.45,-2404.3"/>
</g>
<!-- mha_out_l2_g7 -->
<g id="node201" class="node">
<title>mha_out_l2_g7</title>
<polygon fill="lightcoral" stroke="black" points="14265.95,-2290.17 13805.95,-2290.17 13805.95,-2222.17 14265.95,-2222.17 14265.95,-2290.17"/>
<text text-anchor="middle" x="14035.95" y="-2274.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 2</text>
<text text-anchor="middle" x="14035.95" y="-2259.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14035.95" y="-2244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="14035.95" y="-2229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l2_g7&#45;&gt;mha_out_l2_g7 -->
<g id="edge300" class="edge">
<title>mha_attn_l2_g7&#45;&gt;mha_out_l2_g7</title>
<path fill="none" stroke="black" d="M14035.95,-2326.11C14035.95,-2326.11 14035.95,-2300.3 14035.95,-2300.3"/>
<polygon fill="black" stroke="black" points="14039.45,-2300.3 14035.95,-2290.3 14032.45,-2300.3 14039.45,-2300.3"/>
</g>
<!-- allreduce_l2_g7 -->
<g id="node216" class="node">
<title>allreduce_l2_g7</title>
<polygon fill="lightyellow" stroke="black" points="14463.24,-2186.17 13783.52,-2186.17 13608.67,-2020.17 14288.38,-2020.17 14463.24,-2186.17"/>
<text text-anchor="middle" x="14035.95" y="-2129.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="14035.95" y="-2114.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14035.95" y="-2099.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14035.95" y="-2084.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="14035.95" y="-2069.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l2_g7&#45;&gt;allreduce_l2_g7 -->
<g id="edge301" class="edge">
<title>mha_out_l2_g7&#45;&gt;allreduce_l2_g7</title>
<path fill="none" stroke="black" d="M14035.95,-2221.83C14035.95,-2221.83 14035.95,-2196.43 14035.95,-2196.43"/>
<polygon fill="black" stroke="black" points="14039.45,-2196.43 14035.95,-2186.43 14032.45,-2196.43 14039.45,-2196.43"/>
</g>
<!-- allreduce_l2_g0&#45;&gt;residual_l2_g0 -->
<g id="edge262" class="edge">
<title>allreduce_l2_g0&#45;&gt;residual_l2_g0</title>
<path fill="none" stroke="black" d="M1136.95,-2019.89C1136.95,-2019.89 1136.95,-1994.46 1136.95,-1994.46"/>
<polygon fill="black" stroke="black" points="1140.45,-1994.46 1136.95,-1984.46 1133.45,-1994.46 1140.45,-1994.46"/>
</g>
<!-- gate_l2_g0 -->
<g id="node218" class="node">
<title>gate_l2_g0</title>
<polygon fill="lightgreen" stroke="black" points="1362.45,-1752.17 903.45,-1752.17 903.45,-1669.17 1362.45,-1669.17 1362.45,-1752.17"/>
<text text-anchor="middle" x="1132.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="1132.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1132.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1132.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1132.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g0&#45;&gt;gate_l2_g0 -->
<g id="edge305" class="edge">
<title>residual_l2_g0&#45;&gt;gate_l2_g0</title>
<path fill="none" stroke="black" d="M1132.95,-1788.15C1132.95,-1788.15 1132.95,-1762.37 1132.95,-1762.37"/>
<polygon fill="black" stroke="black" points="1136.45,-1762.37 1132.95,-1752.37 1129.45,-1762.37 1136.45,-1762.37"/>
</g>
<!-- gate_l2_g8 -->
<g id="node234" class="node">
<title>gate_l2_g8</title>
<polygon fill="lightgreen" stroke="black" points="1839.45,-1752.17 1380.45,-1752.17 1380.45,-1669.17 1839.45,-1669.17 1839.45,-1752.17"/>
<text text-anchor="middle" x="1609.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="1609.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1609.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1609.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1609.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g0&#45;&gt;gate_l2_g8 -->
<g id="edge337" class="edge">
<title>residual_l2_g0&#45;&gt;gate_l2_g8</title>
<path fill="none" stroke="black" d="M1472.27,-1880.72C1472.27,-1880.72 1472.27,-1762.22 1472.27,-1762.22"/>
<polygon fill="black" stroke="black" points="1475.77,-1762.22 1472.27,-1752.22 1468.77,-1762.22 1475.77,-1762.22"/>
</g>
<!-- aggregate_l2_g0 -->
<g id="node250" class="node">
<title>aggregate_l2_g0</title>
<polygon fill="lightyellow" stroke="black" points="1399.85,-1499.17 684.16,-1499.17 500.05,-1333.17 1215.74,-1333.17 1399.85,-1499.17"/>
<text text-anchor="middle" x="949.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="949.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="949.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="949.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="949.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g0&#45;&gt;aggregate_l2_g0 -->
<g id="edge308" class="edge">
<title>residual_l2_g0&#45;&gt;aggregate_l2_g0</title>
<path fill="none" stroke="black" d="M806.63,-1787.93C806.63,-1787.93 806.63,-1509.36 806.63,-1509.36"/>
<polygon fill="black" stroke="black" points="810.13,-1509.36 806.63,-1499.36 803.13,-1509.36 810.13,-1509.36"/>
</g>
<!-- aggregate_l2_g8 -->
<g id="node258" class="node">
<title>aggregate_l2_g8</title>
<polygon fill="lightyellow" stroke="black" points="2317.85,-1499.17 1602.16,-1499.17 1418.05,-1333.17 2133.74,-1333.17 2317.85,-1499.17"/>
<text text-anchor="middle" x="1867.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1867.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1867.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1867.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1867.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g0&#45;&gt;aggregate_l2_g8 -->
<g id="edge340" class="edge">
<title>residual_l2_g0&#45;&gt;aggregate_l2_g8</title>
<path fill="none" stroke="black" d="M1432.99,-1837C1662.3,-1837 1941.18,-1837 1941.18,-1837 1941.18,-1837 1941.18,-1509.31 1941.18,-1509.31"/>
<polygon fill="black" stroke="black" points="1944.68,-1509.31 1941.18,-1499.31 1937.68,-1509.31 1944.68,-1509.31"/>
</g>
<!-- allreduce_l2_g1&#45;&gt;residual_l2_g1 -->
<g id="edge268" class="edge">
<title>allreduce_l2_g1&#45;&gt;residual_l2_g1</title>
<path fill="none" stroke="black" d="M2973.95,-2019.89C2973.95,-2019.89 2973.95,-1994.46 2973.95,-1994.46"/>
<polygon fill="black" stroke="black" points="2977.45,-1994.46 2973.95,-1984.46 2970.45,-1994.46 2977.45,-1994.46"/>
</g>
<!-- gate_l2_g1 -->
<g id="node220" class="node">
<title>gate_l2_g1</title>
<polygon fill="lightgreen" stroke="black" points="3202.45,-1752.17 2743.45,-1752.17 2743.45,-1669.17 3202.45,-1669.17 3202.45,-1752.17"/>
<text text-anchor="middle" x="2972.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="2972.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2972.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2972.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="2972.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g1&#45;&gt;gate_l2_g1 -->
<g id="edge309" class="edge">
<title>residual_l2_g1&#45;&gt;gate_l2_g1</title>
<path fill="none" stroke="black" d="M2972.95,-1788.15C2972.95,-1788.15 2972.95,-1762.37 2972.95,-1762.37"/>
<polygon fill="black" stroke="black" points="2976.45,-1762.37 2972.95,-1752.37 2969.45,-1762.37 2976.45,-1762.37"/>
</g>
<!-- gate_l2_g9 -->
<g id="node236" class="node">
<title>gate_l2_g9</title>
<polygon fill="lightgreen" stroke="black" points="3679.45,-1752.17 3220.45,-1752.17 3220.45,-1669.17 3679.45,-1669.17 3679.45,-1752.17"/>
<text text-anchor="middle" x="3449.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="3449.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3449.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3449.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3449.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g1&#45;&gt;gate_l2_g9 -->
<g id="edge341" class="edge">
<title>residual_l2_g1&#45;&gt;gate_l2_g9</title>
<path fill="none" stroke="black" d="M3310.77,-1882.5C3310.77,-1882.5 3310.77,-1762.57 3310.77,-1762.57"/>
<polygon fill="black" stroke="black" points="3314.27,-1762.57 3310.77,-1752.57 3307.27,-1762.57 3314.27,-1762.57"/>
</g>
<!-- aggregate_l2_g1 -->
<g id="node251" class="node">
<title>aggregate_l2_g1</title>
<polygon fill="lightyellow" stroke="black" points="3237.85,-1499.17 2522.16,-1499.17 2338.05,-1333.17 3053.74,-1333.17 3237.85,-1499.17"/>
<text text-anchor="middle" x="2787.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2787.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2787.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2787.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2787.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g1&#45;&gt;aggregate_l2_g1 -->
<g id="edge312" class="edge">
<title>residual_l2_g1&#45;&gt;aggregate_l2_g1</title>
<path fill="none" stroke="black" d="M2645.13,-1787.93C2645.13,-1787.93 2645.13,-1509.36 2645.13,-1509.36"/>
<polygon fill="black" stroke="black" points="2648.63,-1509.36 2645.13,-1499.36 2641.63,-1509.36 2648.63,-1509.36"/>
</g>
<!-- aggregate_l2_g9 -->
<g id="node259" class="node">
<title>aggregate_l2_g9</title>
<polygon fill="lightyellow" stroke="black" points="4155.85,-1499.17 3440.16,-1499.17 3256.05,-1333.17 3971.74,-1333.17 4155.85,-1499.17"/>
<text text-anchor="middle" x="3705.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3705.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3705.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3705.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3705.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g1&#45;&gt;aggregate_l2_g9 -->
<g id="edge344" class="edge">
<title>residual_l2_g1&#45;&gt;aggregate_l2_g9</title>
<path fill="none" stroke="black" d="M3270.15,-1837C3500.14,-1837 3780.18,-1837 3780.18,-1837 3780.18,-1837 3780.18,-1509.31 3780.18,-1509.31"/>
<polygon fill="black" stroke="black" points="3783.68,-1509.31 3780.18,-1499.31 3776.68,-1509.31 3783.68,-1509.31"/>
</g>
<!-- allreduce_l2_g2&#45;&gt;residual_l2_g2 -->
<g id="edge274" class="edge">
<title>allreduce_l2_g2&#45;&gt;residual_l2_g2</title>
<path fill="none" stroke="black" d="M4812.95,-2019.89C4812.95,-2019.89 4812.95,-1994.46 4812.95,-1994.46"/>
<polygon fill="black" stroke="black" points="4816.45,-1994.46 4812.95,-1984.46 4809.45,-1994.46 4816.45,-1994.46"/>
</g>
<!-- gate_l2_g2 -->
<g id="node222" class="node">
<title>gate_l2_g2</title>
<polygon fill="lightgreen" stroke="black" points="5042.45,-1752.17 4583.45,-1752.17 4583.45,-1669.17 5042.45,-1669.17 5042.45,-1752.17"/>
<text text-anchor="middle" x="4812.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="4812.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4812.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4812.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="4812.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g2&#45;&gt;gate_l2_g2 -->
<g id="edge313" class="edge">
<title>residual_l2_g2&#45;&gt;gate_l2_g2</title>
<path fill="none" stroke="black" d="M4812.95,-1788.15C4812.95,-1788.15 4812.95,-1762.37 4812.95,-1762.37"/>
<polygon fill="black" stroke="black" points="4816.45,-1762.37 4812.95,-1752.37 4809.45,-1762.37 4816.45,-1762.37"/>
</g>
<!-- gate_l2_g10 -->
<g id="node238" class="node">
<title>gate_l2_g10</title>
<polygon fill="lightgreen" stroke="black" points="5519.45,-1752.17 5060.45,-1752.17 5060.45,-1669.17 5519.45,-1669.17 5519.45,-1752.17"/>
<text text-anchor="middle" x="5289.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5289.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="5289.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5289.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5289.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g2&#45;&gt;gate_l2_g10 -->
<g id="edge345" class="edge">
<title>residual_l2_g2&#45;&gt;gate_l2_g10</title>
<path fill="none" stroke="black" d="M5150.27,-1883.12C5150.27,-1883.12 5150.27,-1762.37 5150.27,-1762.37"/>
<polygon fill="black" stroke="black" points="5153.77,-1762.37 5150.27,-1752.37 5146.77,-1762.37 5153.77,-1762.37"/>
</g>
<!-- aggregate_l2_g2 -->
<g id="node252" class="node">
<title>aggregate_l2_g2</title>
<polygon fill="lightyellow" stroke="black" points="5079.85,-1499.17 4364.16,-1499.17 4180.05,-1333.17 4895.74,-1333.17 5079.85,-1499.17"/>
<text text-anchor="middle" x="4629.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4629.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4629.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4629.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4629.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g2&#45;&gt;aggregate_l2_g2 -->
<g id="edge316" class="edge">
<title>residual_l2_g2&#45;&gt;aggregate_l2_g2</title>
<path fill="none" stroke="black" d="M4484.63,-1787.93C4484.63,-1787.93 4484.63,-1509.36 4484.63,-1509.36"/>
<polygon fill="black" stroke="black" points="4488.13,-1509.36 4484.63,-1499.36 4481.13,-1509.36 4488.13,-1509.36"/>
</g>
<!-- aggregate_l2_g10 -->
<g id="node260" class="node">
<title>aggregate_l2_g10</title>
<polygon fill="lightyellow" stroke="black" points="5997.85,-1499.17 5282.16,-1499.17 5098.05,-1333.17 5813.74,-1333.17 5997.85,-1499.17"/>
<text text-anchor="middle" x="5547.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5547.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="5547.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5547.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5547.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g2&#45;&gt;aggregate_l2_g10 -->
<g id="edge348" class="edge">
<title>residual_l2_g2&#45;&gt;aggregate_l2_g10</title>
<path fill="none" stroke="black" d="M5108.97,-1837C5338.82,-1837 5618.68,-1837 5618.68,-1837 5618.68,-1837 5618.68,-1509.31 5618.68,-1509.31"/>
<polygon fill="black" stroke="black" points="5622.18,-1509.31 5618.68,-1499.31 5615.18,-1509.31 5622.18,-1509.31"/>
</g>
<!-- allreduce_l2_g3&#45;&gt;residual_l2_g3 -->
<g id="edge280" class="edge">
<title>allreduce_l2_g3&#45;&gt;residual_l2_g3</title>
<path fill="none" stroke="black" d="M6669.95,-2019.89C6669.95,-2019.89 6669.95,-1994.46 6669.95,-1994.46"/>
<polygon fill="black" stroke="black" points="6673.45,-1994.46 6669.95,-1984.46 6666.45,-1994.46 6673.45,-1994.46"/>
</g>
<!-- gate_l2_g3 -->
<g id="node224" class="node">
<title>gate_l2_g3</title>
<polygon fill="lightgreen" stroke="black" points="6885.45,-1752.17 6426.45,-1752.17 6426.45,-1669.17 6885.45,-1669.17 6885.45,-1752.17"/>
<text text-anchor="middle" x="6655.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6655.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="6655.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6655.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6655.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g3&#45;&gt;gate_l2_g3 -->
<g id="edge317" class="edge">
<title>residual_l2_g3&#45;&gt;gate_l2_g3</title>
<path fill="none" stroke="black" d="M6655.95,-1788.15C6655.95,-1788.15 6655.95,-1762.37 6655.95,-1762.37"/>
<polygon fill="black" stroke="black" points="6659.45,-1762.37 6655.95,-1752.37 6652.45,-1762.37 6659.45,-1762.37"/>
</g>
<!-- gate_l2_g11 -->
<g id="node240" class="node">
<title>gate_l2_g11</title>
<polygon fill="lightgreen" stroke="black" points="7362.45,-1752.17 6903.45,-1752.17 6903.45,-1669.17 7362.45,-1669.17 7362.45,-1752.17"/>
<text text-anchor="middle" x="7132.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7132.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="7132.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7132.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="7132.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g3&#45;&gt;gate_l2_g11 -->
<g id="edge349" class="edge">
<title>residual_l2_g3&#45;&gt;gate_l2_g11</title>
<path fill="none" stroke="black" d="M7000.27,-1875.45C7000.27,-1875.45 7000.27,-1762.38 7000.27,-1762.38"/>
<polygon fill="black" stroke="black" points="7003.77,-1762.38 7000.27,-1752.38 6996.77,-1762.38 7003.77,-1762.38"/>
</g>
<!-- aggregate_l2_g3 -->
<g id="node253" class="node">
<title>aggregate_l2_g3</title>
<polygon fill="lightyellow" stroke="black" points="6915.85,-1499.17 6200.16,-1499.17 6016.05,-1333.17 6731.74,-1333.17 6915.85,-1499.17"/>
<text text-anchor="middle" x="6465.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6465.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="6465.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6465.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6465.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g3&#45;&gt;aggregate_l2_g3 -->
<g id="edge320" class="edge">
<title>residual_l2_g3&#45;&gt;aggregate_l2_g3</title>
<path fill="none" stroke="black" d="M6334.63,-1787.93C6334.63,-1787.93 6334.63,-1509.36 6334.63,-1509.36"/>
<polygon fill="black" stroke="black" points="6338.13,-1509.36 6334.63,-1499.36 6331.13,-1509.36 6338.13,-1509.36"/>
</g>
<!-- aggregate_l2_g11 -->
<g id="node261" class="node">
<title>aggregate_l2_g11</title>
<polygon fill="lightyellow" stroke="black" points="7833.85,-1499.17 7118.16,-1499.17 6934.05,-1333.17 7649.74,-1333.17 7833.85,-1499.17"/>
<text text-anchor="middle" x="7383.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7383.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="7383.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7383.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7383.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g3&#45;&gt;aggregate_l2_g11 -->
<g id="edge352" class="edge">
<title>residual_l2_g3&#45;&gt;aggregate_l2_g11</title>
<path fill="none" stroke="black" d="M6966.21,-1837C7194.59,-1837 7471.68,-1837 7471.68,-1837 7471.68,-1837 7471.68,-1509.31 7471.68,-1509.31"/>
<polygon fill="black" stroke="black" points="7475.18,-1509.31 7471.68,-1499.31 7468.18,-1509.31 7475.18,-1509.31"/>
</g>
<!-- allreduce_l2_g4&#45;&gt;residual_l2_g4 -->
<g id="edge286" class="edge">
<title>allreduce_l2_g4&#45;&gt;residual_l2_g4</title>
<path fill="none" stroke="black" d="M8512.95,-2019.89C8512.95,-2019.89 8512.95,-1994.46 8512.95,-1994.46"/>
<polygon fill="black" stroke="black" points="8516.45,-1994.46 8512.95,-1984.46 8509.45,-1994.46 8516.45,-1994.46"/>
</g>
<!-- gate_l2_g4 -->
<g id="node226" class="node">
<title>gate_l2_g4</title>
<polygon fill="lightgreen" stroke="black" points="8722.45,-1752.17 8263.45,-1752.17 8263.45,-1669.17 8722.45,-1669.17 8722.45,-1752.17"/>
<text text-anchor="middle" x="8492.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8492.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="8492.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8492.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8492.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g4&#45;&gt;gate_l2_g4 -->
<g id="edge321" class="edge">
<title>residual_l2_g4&#45;&gt;gate_l2_g4</title>
<path fill="none" stroke="black" d="M8492.95,-1788.15C8492.95,-1788.15 8492.95,-1762.37 8492.95,-1762.37"/>
<polygon fill="black" stroke="black" points="8496.45,-1762.37 8492.95,-1752.37 8489.45,-1762.37 8496.45,-1762.37"/>
</g>
<!-- gate_l2_g12 -->
<g id="node242" class="node">
<title>gate_l2_g12</title>
<polygon fill="lightgreen" stroke="black" points="9199.45,-1752.17 8740.45,-1752.17 8740.45,-1669.17 9199.45,-1669.17 9199.45,-1752.17"/>
<text text-anchor="middle" x="8969.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8969.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="8969.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8969.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8969.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g4&#45;&gt;gate_l2_g12 -->
<g id="edge353" class="edge">
<title>residual_l2_g4&#45;&gt;gate_l2_g12</title>
<path fill="none" stroke="black" d="M8840.27,-1872.1C8840.27,-1872.1 8840.27,-1762.23 8840.27,-1762.23"/>
<polygon fill="black" stroke="black" points="8843.77,-1762.23 8840.27,-1752.23 8836.77,-1762.23 8843.77,-1762.23"/>
</g>
<!-- aggregate_l2_g4 -->
<g id="node254" class="node">
<title>aggregate_l2_g4</title>
<polygon fill="lightyellow" stroke="black" points="8752.85,-1499.17 8037.16,-1499.17 7853.05,-1333.17 8568.74,-1333.17 8752.85,-1499.17"/>
<text text-anchor="middle" x="8302.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8302.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="8302.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8302.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8302.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g4&#45;&gt;aggregate_l2_g4 -->
<g id="edge324" class="edge">
<title>residual_l2_g4&#45;&gt;aggregate_l2_g4</title>
<path fill="none" stroke="black" d="M8174.63,-1787.93C8174.63,-1787.93 8174.63,-1509.36 8174.63,-1509.36"/>
<polygon fill="black" stroke="black" points="8178.13,-1509.36 8174.63,-1499.36 8171.13,-1509.36 8178.13,-1509.36"/>
</g>
<!-- aggregate_l2_g12 -->
<g id="node262" class="node">
<title>aggregate_l2_g12</title>
<polygon fill="lightyellow" stroke="black" points="9670.85,-1499.17 8955.16,-1499.17 8771.05,-1333.17 9486.74,-1333.17 9670.85,-1499.17"/>
<text text-anchor="middle" x="9220.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9220.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="9220.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="9220.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="9220.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g4&#45;&gt;aggregate_l2_g12 -->
<g id="edge356" class="edge">
<title>residual_l2_g4&#45;&gt;aggregate_l2_g12</title>
<path fill="none" stroke="black" d="M8808.96,-1837C9035.79,-1837 9310.18,-1837 9310.18,-1837 9310.18,-1837 9310.18,-1509.31 9310.18,-1509.31"/>
<polygon fill="black" stroke="black" points="9313.68,-1509.31 9310.18,-1499.31 9306.68,-1509.31 9313.68,-1509.31"/>
</g>
<!-- allreduce_l2_g5&#45;&gt;residual_l2_g5 -->
<g id="edge292" class="edge">
<title>allreduce_l2_g5&#45;&gt;residual_l2_g5</title>
<path fill="none" stroke="black" d="M10355.95,-2019.89C10355.95,-2019.89 10355.95,-1994.46 10355.95,-1994.46"/>
<polygon fill="black" stroke="black" points="10359.45,-1994.46 10355.95,-1984.46 10352.45,-1994.46 10359.45,-1994.46"/>
</g>
<!-- gate_l2_g5 -->
<g id="node228" class="node">
<title>gate_l2_g5</title>
<polygon fill="lightgreen" stroke="black" points="10566.45,-1752.17 10107.45,-1752.17 10107.45,-1669.17 10566.45,-1669.17 10566.45,-1752.17"/>
<text text-anchor="middle" x="10336.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10336.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="10336.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10336.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10336.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g5&#45;&gt;gate_l2_g5 -->
<g id="edge325" class="edge">
<title>residual_l2_g5&#45;&gt;gate_l2_g5</title>
<path fill="none" stroke="black" d="M10336.95,-1788.15C10336.95,-1788.15 10336.95,-1762.37 10336.95,-1762.37"/>
<polygon fill="black" stroke="black" points="10340.45,-1762.37 10336.95,-1752.37 10333.45,-1762.37 10340.45,-1762.37"/>
</g>
<!-- gate_l2_g13 -->
<g id="node244" class="node">
<title>gate_l2_g13</title>
<polygon fill="lightgreen" stroke="black" points="11043.45,-1752.17 10584.45,-1752.17 10584.45,-1669.17 11043.45,-1669.17 11043.45,-1752.17"/>
<text text-anchor="middle" x="10813.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10813.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="10813.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10813.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10813.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g5&#45;&gt;gate_l2_g13 -->
<g id="edge357" class="edge">
<title>residual_l2_g5&#45;&gt;gate_l2_g13</title>
<path fill="none" stroke="black" d="M10683.77,-1872.4C10683.77,-1872.4 10683.77,-1762.4 10683.77,-1762.4"/>
<polygon fill="black" stroke="black" points="10687.27,-1762.4 10683.77,-1752.4 10680.27,-1762.4 10687.27,-1762.4"/>
</g>
<!-- aggregate_l2_g5 -->
<g id="node255" class="node">
<title>aggregate_l2_g5</title>
<polygon fill="lightyellow" stroke="black" points="10588.85,-1499.17 9873.16,-1499.17 9689.05,-1333.17 10404.74,-1333.17 10588.85,-1499.17"/>
<text text-anchor="middle" x="10138.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10138.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="10138.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10138.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10138.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g5&#45;&gt;aggregate_l2_g5 -->
<g id="edge328" class="edge">
<title>residual_l2_g5&#45;&gt;aggregate_l2_g5</title>
<path fill="none" stroke="black" d="M10018.13,-1787.93C10018.13,-1787.93 10018.13,-1509.36 10018.13,-1509.36"/>
<polygon fill="black" stroke="black" points="10021.63,-1509.36 10018.13,-1499.36 10014.63,-1509.36 10021.63,-1509.36"/>
</g>
<!-- aggregate_l2_g13 -->
<g id="node263" class="node">
<title>aggregate_l2_g13</title>
<polygon fill="lightyellow" stroke="black" points="11506.85,-1499.17 10791.16,-1499.17 10607.05,-1333.17 11322.74,-1333.17 11506.85,-1499.17"/>
<text text-anchor="middle" x="11056.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11056.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="11056.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11056.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11056.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g5&#45;&gt;aggregate_l2_g13 -->
<g id="edge360" class="edge">
<title>residual_l2_g5&#45;&gt;aggregate_l2_g13</title>
<path fill="none" stroke="black" d="M10652.13,-1837C10879.64,-1837 11155.18,-1837 11155.18,-1837 11155.18,-1837 11155.18,-1509.31 11155.18,-1509.31"/>
<polygon fill="black" stroke="black" points="11158.68,-1509.31 11155.18,-1499.31 11151.68,-1509.31 11158.68,-1509.31"/>
</g>
<!-- allreduce_l2_g6&#45;&gt;residual_l2_g6 -->
<g id="edge298" class="edge">
<title>allreduce_l2_g6&#45;&gt;residual_l2_g6</title>
<path fill="none" stroke="black" d="M12197.95,-2019.89C12197.95,-2019.89 12197.95,-1994.46 12197.95,-1994.46"/>
<polygon fill="black" stroke="black" points="12201.45,-1994.46 12197.95,-1984.46 12194.45,-1994.46 12201.45,-1994.46"/>
</g>
<!-- gate_l2_g6 -->
<g id="node230" class="node">
<title>gate_l2_g6</title>
<polygon fill="lightgreen" stroke="black" points="12414.45,-1752.17 11955.45,-1752.17 11955.45,-1669.17 12414.45,-1669.17 12414.45,-1752.17"/>
<text text-anchor="middle" x="12184.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12184.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="12184.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12184.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12184.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g6&#45;&gt;gate_l2_g6 -->
<g id="edge329" class="edge">
<title>residual_l2_g6&#45;&gt;gate_l2_g6</title>
<path fill="none" stroke="black" d="M12184.95,-1788.15C12184.95,-1788.15 12184.95,-1762.37 12184.95,-1762.37"/>
<polygon fill="black" stroke="black" points="12188.45,-1762.37 12184.95,-1752.37 12181.45,-1762.37 12188.45,-1762.37"/>
</g>
<!-- gate_l2_g14 -->
<g id="node246" class="node">
<title>gate_l2_g14</title>
<polygon fill="lightgreen" stroke="black" points="12891.45,-1752.17 12432.45,-1752.17 12432.45,-1669.17 12891.45,-1669.17 12891.45,-1752.17"/>
<text text-anchor="middle" x="12661.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12661.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="12661.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12661.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12661.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g6&#45;&gt;gate_l2_g14 -->
<g id="edge361" class="edge">
<title>residual_l2_g6&#45;&gt;gate_l2_g14</title>
<path fill="none" stroke="black" d="M12528.77,-1875.97C12528.77,-1875.97 12528.77,-1762.33 12528.77,-1762.33"/>
<polygon fill="black" stroke="black" points="12532.27,-1762.33 12528.77,-1752.33 12525.27,-1762.33 12532.27,-1762.33"/>
</g>
<!-- aggregate_l2_g6 -->
<g id="node256" class="node">
<title>aggregate_l2_g6</title>
<polygon fill="lightyellow" stroke="black" points="12439.85,-1499.17 11724.16,-1499.17 11540.05,-1333.17 12255.74,-1333.17 12439.85,-1499.17"/>
<text text-anchor="middle" x="11989.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11989.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="11989.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="11989.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11989.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g6&#45;&gt;aggregate_l2_g6 -->
<g id="edge332" class="edge">
<title>residual_l2_g6&#45;&gt;aggregate_l2_g6</title>
<path fill="none" stroke="black" d="M11863.13,-1787.93C11863.13,-1787.93 11863.13,-1509.36 11863.13,-1509.36"/>
<polygon fill="black" stroke="black" points="11866.63,-1509.36 11863.13,-1499.36 11859.63,-1509.36 11866.63,-1509.36"/>
</g>
<!-- aggregate_l2_g14 -->
<g id="node264" class="node">
<title>aggregate_l2_g14</title>
<polygon fill="lightyellow" stroke="black" points="13357.85,-1499.17 12642.16,-1499.17 12458.05,-1333.17 13173.74,-1333.17 13357.85,-1499.17"/>
<text text-anchor="middle" x="12907.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12907.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="12907.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12907.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12907.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g6&#45;&gt;aggregate_l2_g14 -->
<g id="edge364" class="edge">
<title>residual_l2_g6&#45;&gt;aggregate_l2_g14</title>
<path fill="none" stroke="black" d="M12494.12,-1837C12722.16,-1837 12998.68,-1837 12998.68,-1837 12998.68,-1837 12998.68,-1509.31 12998.68,-1509.31"/>
<polygon fill="black" stroke="black" points="13002.18,-1509.31 12998.68,-1499.31 12995.18,-1509.31 13002.18,-1509.31"/>
</g>
<!-- allreduce_l2_g7&#45;&gt;residual_l2_g7 -->
<g id="edge304" class="edge">
<title>allreduce_l2_g7&#45;&gt;residual_l2_g7</title>
<path fill="none" stroke="black" d="M14035.95,-2019.89C14035.95,-2019.89 14035.95,-1994.46 14035.95,-1994.46"/>
<polygon fill="black" stroke="black" points="14039.45,-1994.46 14035.95,-1984.46 14032.45,-1994.46 14039.45,-1994.46"/>
</g>
<!-- gate_l2_g7 -->
<g id="node232" class="node">
<title>gate_l2_g7</title>
<polygon fill="lightgreen" stroke="black" points="14259.45,-1752.17 13800.45,-1752.17 13800.45,-1669.17 14259.45,-1669.17 14259.45,-1752.17"/>
<text text-anchor="middle" x="14029.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="14029.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14029.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14029.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14029.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g7&#45;&gt;gate_l2_g7 -->
<g id="edge333" class="edge">
<title>residual_l2_g7&#45;&gt;gate_l2_g7</title>
<path fill="none" stroke="black" d="M14029.95,-1788.15C14029.95,-1788.15 14029.95,-1762.37 14029.95,-1762.37"/>
<polygon fill="black" stroke="black" points="14033.45,-1762.37 14029.95,-1752.37 14026.45,-1762.37 14033.45,-1762.37"/>
</g>
<!-- gate_l2_g15 -->
<g id="node248" class="node">
<title>gate_l2_g15</title>
<polygon fill="lightgreen" stroke="black" points="14736.45,-1752.17 14277.45,-1752.17 14277.45,-1669.17 14736.45,-1669.17 14736.45,-1752.17"/>
<text text-anchor="middle" x="14506.95" y="-1736.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="14506.95" y="-1721.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14506.95" y="-1706.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14506.95" y="-1691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14506.95" y="-1676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l2_g7&#45;&gt;gate_l2_g15 -->
<g id="edge365" class="edge">
<title>residual_l2_g7&#45;&gt;gate_l2_g15</title>
<path fill="none" stroke="black" d="M14370.27,-1879.92C14370.27,-1879.92 14370.27,-1762.38 14370.27,-1762.38"/>
<polygon fill="black" stroke="black" points="14373.77,-1762.38 14370.27,-1752.38 14366.77,-1762.38 14373.77,-1762.38"/>
</g>
<!-- aggregate_l2_g7 -->
<g id="node257" class="node">
<title>aggregate_l2_g7</title>
<polygon fill="lightyellow" stroke="black" points="14284.85,-1499.17 13569.16,-1499.17 13385.05,-1333.17 14100.74,-1333.17 14284.85,-1499.17"/>
<text text-anchor="middle" x="13834.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13834.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="13834.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="13834.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13834.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g7&#45;&gt;aggregate_l2_g7 -->
<g id="edge336" class="edge">
<title>residual_l2_g7&#45;&gt;aggregate_l2_g7</title>
<path fill="none" stroke="black" d="M13704.63,-1787.93C13704.63,-1787.93 13704.63,-1509.36 13704.63,-1509.36"/>
<polygon fill="black" stroke="black" points="13708.13,-1509.36 13704.63,-1499.36 13701.13,-1509.36 13708.13,-1509.36"/>
</g>
<!-- aggregate_l2_g15 -->
<g id="node265" class="node">
<title>aggregate_l2_g15</title>
<polygon fill="lightyellow" stroke="black" points="15202.85,-1499.17 14487.16,-1499.17 14303.05,-1333.17 15018.74,-1333.17 15202.85,-1499.17"/>
<text text-anchor="middle" x="14752.95" y="-1442.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14752.95" y="-1427.47" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14752.95" y="-1412.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14752.95" y="-1397.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14752.95" y="-1382.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l2_g7&#45;&gt;aggregate_l2_g15 -->
<g id="edge368" class="edge">
<title>residual_l2_g7&#45;&gt;aggregate_l2_g15</title>
<path fill="none" stroke="black" d="M14346.31,-1853C14572.74,-1853 14840.18,-1853 14840.18,-1853 14840.18,-1853 14840.18,-1509.36 14840.18,-1509.36"/>
<polygon fill="black" stroke="black" points="14843.68,-1509.36 14840.18,-1499.36 14836.68,-1509.36 14843.68,-1509.36"/>
</g>
<!-- expert_l2_e0_g0 -->
<g id="node219" class="node">
<title>expert_l2_e0_g0</title>
<polygon fill="lightgreen" stroke="black" points="1352.95,-1633.17 906.95,-1633.17 906.95,-1535.17 1352.95,-1535.17 1352.95,-1633.17"/>
<text text-anchor="middle" x="1129.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1129.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1129.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1129.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1129.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1129.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g0&#45;&gt;expert_l2_e0_g0 -->
<g id="edge306" class="edge">
<title>gate_l2_g0&#45;&gt;expert_l2_e0_g0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1129.95,-1668.9C1129.95,-1668.9 1129.95,-1643.36 1129.95,-1643.36"/>
<polygon fill="black" stroke="black" points="1133.45,-1643.36 1129.95,-1633.36 1126.45,-1643.36 1133.45,-1643.36"/>
</g>
<!-- expert_l2_e0_g0&#45;&gt;aggregate_l2_g0 -->
<g id="edge307" class="edge">
<title>expert_l2_e0_g0&#45;&gt;aggregate_l2_g0</title>
<path fill="none" stroke="black" d="M1129.95,-1535.12C1129.95,-1535.12 1129.95,-1509.41 1129.95,-1509.41"/>
<polygon fill="black" stroke="black" points="1133.45,-1509.41 1129.95,-1499.41 1126.45,-1509.41 1133.45,-1509.41"/>
</g>
<!-- expert_l2_e1_g1 -->
<g id="node221" class="node">
<title>expert_l2_e1_g1</title>
<polygon fill="lightgreen" stroke="black" points="3191.95,-1633.17 2745.95,-1633.17 2745.95,-1535.17 3191.95,-1535.17 3191.95,-1633.17"/>
<text text-anchor="middle" x="2968.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2968.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2968.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2968.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2968.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2968.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g1&#45;&gt;expert_l2_e1_g1 -->
<g id="edge310" class="edge">
<title>gate_l2_g1&#45;&gt;expert_l2_e1_g1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2968.95,-1668.9C2968.95,-1668.9 2968.95,-1643.36 2968.95,-1643.36"/>
<polygon fill="black" stroke="black" points="2972.45,-1643.36 2968.95,-1633.36 2965.45,-1643.36 2972.45,-1643.36"/>
</g>
<!-- expert_l2_e1_g1&#45;&gt;aggregate_l2_g1 -->
<g id="edge311" class="edge">
<title>expert_l2_e1_g1&#45;&gt;aggregate_l2_g1</title>
<path fill="none" stroke="black" d="M2968.95,-1535.12C2968.95,-1535.12 2968.95,-1509.41 2968.95,-1509.41"/>
<polygon fill="black" stroke="black" points="2972.45,-1509.41 2968.95,-1499.41 2965.45,-1509.41 2972.45,-1509.41"/>
</g>
<!-- expert_l2_e2_g2 -->
<g id="node223" class="node">
<title>expert_l2_e2_g2</title>
<polygon fill="lightgreen" stroke="black" points="5031.95,-1633.17 4585.95,-1633.17 4585.95,-1535.17 5031.95,-1535.17 5031.95,-1633.17"/>
<text text-anchor="middle" x="4808.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4808.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4808.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4808.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4808.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4808.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g2&#45;&gt;expert_l2_e2_g2 -->
<g id="edge314" class="edge">
<title>gate_l2_g2&#45;&gt;expert_l2_e2_g2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4808.95,-1668.9C4808.95,-1668.9 4808.95,-1643.36 4808.95,-1643.36"/>
<polygon fill="black" stroke="black" points="4812.45,-1643.36 4808.95,-1633.36 4805.45,-1643.36 4812.45,-1643.36"/>
</g>
<!-- expert_l2_e2_g2&#45;&gt;aggregate_l2_g2 -->
<g id="edge315" class="edge">
<title>expert_l2_e2_g2&#45;&gt;aggregate_l2_g2</title>
<path fill="none" stroke="black" d="M4808.95,-1535.12C4808.95,-1535.12 4808.95,-1509.41 4808.95,-1509.41"/>
<polygon fill="black" stroke="black" points="4812.45,-1509.41 4808.95,-1499.41 4805.45,-1509.41 4812.45,-1509.41"/>
</g>
<!-- expert_l2_e3_g3 -->
<g id="node225" class="node">
<title>expert_l2_e3_g3</title>
<polygon fill="lightgreen" stroke="black" points="6875.95,-1633.17 6429.95,-1633.17 6429.95,-1535.17 6875.95,-1535.17 6875.95,-1633.17"/>
<text text-anchor="middle" x="6652.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6652.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="6652.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6652.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6652.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6652.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g3&#45;&gt;expert_l2_e3_g3 -->
<g id="edge318" class="edge">
<title>gate_l2_g3&#45;&gt;expert_l2_e3_g3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6652.95,-1668.9C6652.95,-1668.9 6652.95,-1643.36 6652.95,-1643.36"/>
<polygon fill="black" stroke="black" points="6656.45,-1643.36 6652.95,-1633.36 6649.45,-1643.36 6656.45,-1643.36"/>
</g>
<!-- expert_l2_e3_g3&#45;&gt;aggregate_l2_g3 -->
<g id="edge319" class="edge">
<title>expert_l2_e3_g3&#45;&gt;aggregate_l2_g3</title>
<path fill="none" stroke="black" d="M6652.95,-1535.12C6652.95,-1535.12 6652.95,-1509.41 6652.95,-1509.41"/>
<polygon fill="black" stroke="black" points="6656.45,-1509.41 6652.95,-1499.41 6649.45,-1509.41 6656.45,-1509.41"/>
</g>
<!-- expert_l2_e4_g4 -->
<g id="node227" class="node">
<title>expert_l2_e4_g4</title>
<polygon fill="lightgreen" stroke="black" points="8711.95,-1633.17 8265.95,-1633.17 8265.95,-1535.17 8711.95,-1535.17 8711.95,-1633.17"/>
<text text-anchor="middle" x="8488.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8488.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="8488.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8488.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8488.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8488.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g4&#45;&gt;expert_l2_e4_g4 -->
<g id="edge322" class="edge">
<title>gate_l2_g4&#45;&gt;expert_l2_e4_g4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8488.95,-1668.9C8488.95,-1668.9 8488.95,-1643.36 8488.95,-1643.36"/>
<polygon fill="black" stroke="black" points="8492.45,-1643.36 8488.95,-1633.36 8485.45,-1643.36 8492.45,-1643.36"/>
</g>
<!-- expert_l2_e4_g4&#45;&gt;aggregate_l2_g4 -->
<g id="edge323" class="edge">
<title>expert_l2_e4_g4&#45;&gt;aggregate_l2_g4</title>
<path fill="none" stroke="black" d="M8488.95,-1535.12C8488.95,-1535.12 8488.95,-1509.41 8488.95,-1509.41"/>
<polygon fill="black" stroke="black" points="8492.45,-1509.41 8488.95,-1499.41 8485.45,-1509.41 8492.45,-1509.41"/>
</g>
<!-- expert_l2_e5_g5 -->
<g id="node229" class="node">
<title>expert_l2_e5_g5</title>
<polygon fill="lightgreen" stroke="black" points="10555.95,-1633.17 10109.95,-1633.17 10109.95,-1535.17 10555.95,-1535.17 10555.95,-1633.17"/>
<text text-anchor="middle" x="10332.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10332.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="10332.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10332.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10332.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10332.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g5&#45;&gt;expert_l2_e5_g5 -->
<g id="edge326" class="edge">
<title>gate_l2_g5&#45;&gt;expert_l2_e5_g5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10332.95,-1668.9C10332.95,-1668.9 10332.95,-1643.36 10332.95,-1643.36"/>
<polygon fill="black" stroke="black" points="10336.45,-1643.36 10332.95,-1633.36 10329.45,-1643.36 10336.45,-1643.36"/>
</g>
<!-- expert_l2_e5_g5&#45;&gt;aggregate_l2_g5 -->
<g id="edge327" class="edge">
<title>expert_l2_e5_g5&#45;&gt;aggregate_l2_g5</title>
<path fill="none" stroke="black" d="M10332.95,-1535.12C10332.95,-1535.12 10332.95,-1509.41 10332.95,-1509.41"/>
<polygon fill="black" stroke="black" points="10336.45,-1509.41 10332.95,-1499.41 10329.45,-1509.41 10336.45,-1509.41"/>
</g>
<!-- expert_l2_e6_g6 -->
<g id="node231" class="node">
<title>expert_l2_e6_g6</title>
<polygon fill="lightgreen" stroke="black" points="12403.95,-1633.17 11957.95,-1633.17 11957.95,-1535.17 12403.95,-1535.17 12403.95,-1633.17"/>
<text text-anchor="middle" x="12180.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12180.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="12180.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12180.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12180.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12180.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g6&#45;&gt;expert_l2_e6_g6 -->
<g id="edge330" class="edge">
<title>gate_l2_g6&#45;&gt;expert_l2_e6_g6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12180.95,-1668.9C12180.95,-1668.9 12180.95,-1643.36 12180.95,-1643.36"/>
<polygon fill="black" stroke="black" points="12184.45,-1643.36 12180.95,-1633.36 12177.45,-1643.36 12184.45,-1643.36"/>
</g>
<!-- expert_l2_e6_g6&#45;&gt;aggregate_l2_g6 -->
<g id="edge331" class="edge">
<title>expert_l2_e6_g6&#45;&gt;aggregate_l2_g6</title>
<path fill="none" stroke="black" d="M12180.95,-1535.12C12180.95,-1535.12 12180.95,-1509.41 12180.95,-1509.41"/>
<polygon fill="black" stroke="black" points="12184.45,-1509.41 12180.95,-1499.41 12177.45,-1509.41 12184.45,-1509.41"/>
</g>
<!-- expert_l2_e7_g7 -->
<g id="node233" class="node">
<title>expert_l2_e7_g7</title>
<polygon fill="lightgreen" stroke="black" points="14249.95,-1633.17 13803.95,-1633.17 13803.95,-1535.17 14249.95,-1535.17 14249.95,-1633.17"/>
<text text-anchor="middle" x="14026.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="14026.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14026.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14026.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14026.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14026.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g7&#45;&gt;expert_l2_e7_g7 -->
<g id="edge334" class="edge">
<title>gate_l2_g7&#45;&gt;expert_l2_e7_g7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14026.95,-1668.9C14026.95,-1668.9 14026.95,-1643.36 14026.95,-1643.36"/>
<polygon fill="black" stroke="black" points="14030.45,-1643.36 14026.95,-1633.36 14023.45,-1643.36 14030.45,-1643.36"/>
</g>
<!-- expert_l2_e7_g7&#45;&gt;aggregate_l2_g7 -->
<g id="edge335" class="edge">
<title>expert_l2_e7_g7&#45;&gt;aggregate_l2_g7</title>
<path fill="none" stroke="black" d="M14026.95,-1535.12C14026.95,-1535.12 14026.95,-1509.41 14026.95,-1509.41"/>
<polygon fill="black" stroke="black" points="14030.45,-1509.41 14026.95,-1499.41 14023.45,-1509.41 14030.45,-1509.41"/>
</g>
<!-- expert_l2_e8_g8 -->
<g id="node235" class="node">
<title>expert_l2_e8_g8</title>
<polygon fill="lightgreen" stroke="black" points="1836.95,-1633.17 1390.95,-1633.17 1390.95,-1535.17 1836.95,-1535.17 1836.95,-1633.17"/>
<text text-anchor="middle" x="1613.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1613.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1613.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1613.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1613.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1613.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g8&#45;&gt;expert_l2_e8_g8 -->
<g id="edge338" class="edge">
<title>gate_l2_g8&#45;&gt;expert_l2_e8_g8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1613.95,-1668.9C1613.95,-1668.9 1613.95,-1643.36 1613.95,-1643.36"/>
<polygon fill="black" stroke="black" points="1617.45,-1643.36 1613.95,-1633.36 1610.45,-1643.36 1617.45,-1643.36"/>
</g>
<!-- expert_l2_e8_g8&#45;&gt;aggregate_l2_g8 -->
<g id="edge339" class="edge">
<title>expert_l2_e8_g8&#45;&gt;aggregate_l2_g8</title>
<path fill="none" stroke="black" d="M1627.48,-1535.12C1627.48,-1535.12 1627.48,-1509.41 1627.48,-1509.41"/>
<polygon fill="black" stroke="black" points="1630.98,-1509.41 1627.48,-1499.41 1623.98,-1509.41 1630.98,-1509.41"/>
</g>
<!-- expert_l2_e9_g9 -->
<g id="node237" class="node">
<title>expert_l2_e9_g9</title>
<polygon fill="lightgreen" stroke="black" points="3675.95,-1633.17 3229.95,-1633.17 3229.95,-1535.17 3675.95,-1535.17 3675.95,-1633.17"/>
<text text-anchor="middle" x="3452.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3452.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3452.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3452.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3452.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3452.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g9&#45;&gt;expert_l2_e9_g9 -->
<g id="edge342" class="edge">
<title>gate_l2_g9&#45;&gt;expert_l2_e9_g9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3452.95,-1668.9C3452.95,-1668.9 3452.95,-1643.36 3452.95,-1643.36"/>
<polygon fill="black" stroke="black" points="3456.45,-1643.36 3452.95,-1633.36 3449.45,-1643.36 3456.45,-1643.36"/>
</g>
<!-- expert_l2_e9_g9&#45;&gt;aggregate_l2_g9 -->
<g id="edge343" class="edge">
<title>expert_l2_e9_g9&#45;&gt;aggregate_l2_g9</title>
<path fill="none" stroke="black" d="M3465.98,-1535.12C3465.98,-1535.12 3465.98,-1509.41 3465.98,-1509.41"/>
<polygon fill="black" stroke="black" points="3469.48,-1509.41 3465.98,-1499.41 3462.48,-1509.41 3469.48,-1509.41"/>
</g>
<!-- expert_l2_e10_g10 -->
<g id="node239" class="node">
<title>expert_l2_e10_g10</title>
<polygon fill="lightgreen" stroke="black" points="5515.95,-1633.17 5069.95,-1633.17 5069.95,-1535.17 5515.95,-1535.17 5515.95,-1633.17"/>
<text text-anchor="middle" x="5292.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="5292.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="5292.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5292.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5292.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5292.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g10&#45;&gt;expert_l2_e10_g10 -->
<g id="edge346" class="edge">
<title>gate_l2_g10&#45;&gt;expert_l2_e10_g10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5292.95,-1668.9C5292.95,-1668.9 5292.95,-1643.36 5292.95,-1643.36"/>
<polygon fill="black" stroke="black" points="5296.45,-1643.36 5292.95,-1633.36 5289.45,-1643.36 5296.45,-1643.36"/>
</g>
<!-- expert_l2_e10_g10&#45;&gt;aggregate_l2_g10 -->
<g id="edge347" class="edge">
<title>expert_l2_e10_g10&#45;&gt;aggregate_l2_g10</title>
<path fill="none" stroke="black" d="M5306.98,-1535.12C5306.98,-1535.12 5306.98,-1509.41 5306.98,-1509.41"/>
<polygon fill="black" stroke="black" points="5310.48,-1509.41 5306.98,-1499.41 5303.48,-1509.41 5310.48,-1509.41"/>
</g>
<!-- expert_l2_e11_g11 -->
<g id="node241" class="node">
<title>expert_l2_e11_g11</title>
<polygon fill="lightgreen" stroke="black" points="7359.95,-1633.17 6913.95,-1633.17 6913.95,-1535.17 7359.95,-1535.17 7359.95,-1633.17"/>
<text text-anchor="middle" x="7136.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7136.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="7136.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7136.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7136.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7136.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g11&#45;&gt;expert_l2_e11_g11 -->
<g id="edge350" class="edge">
<title>gate_l2_g11&#45;&gt;expert_l2_e11_g11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7136.95,-1668.9C7136.95,-1668.9 7136.95,-1643.36 7136.95,-1643.36"/>
<polygon fill="black" stroke="black" points="7140.45,-1643.36 7136.95,-1633.36 7133.45,-1643.36 7140.45,-1643.36"/>
</g>
<!-- expert_l2_e11_g11&#45;&gt;aggregate_l2_g11 -->
<g id="edge351" class="edge">
<title>expert_l2_e11_g11&#45;&gt;aggregate_l2_g11</title>
<path fill="none" stroke="black" d="M7146.98,-1535.12C7146.98,-1535.12 7146.98,-1509.41 7146.98,-1509.41"/>
<polygon fill="black" stroke="black" points="7150.48,-1509.41 7146.98,-1499.41 7143.48,-1509.41 7150.48,-1509.41"/>
</g>
<!-- expert_l2_e12_g12 -->
<g id="node243" class="node">
<title>expert_l2_e12_g12</title>
<polygon fill="lightgreen" stroke="black" points="9195.95,-1633.17 8749.95,-1633.17 8749.95,-1535.17 9195.95,-1535.17 9195.95,-1633.17"/>
<text text-anchor="middle" x="8972.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="8972.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="8972.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8972.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8972.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8972.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g12&#45;&gt;expert_l2_e12_g12 -->
<g id="edge354" class="edge">
<title>gate_l2_g12&#45;&gt;expert_l2_e12_g12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8972.95,-1668.9C8972.95,-1668.9 8972.95,-1643.36 8972.95,-1643.36"/>
<polygon fill="black" stroke="black" points="8976.45,-1643.36 8972.95,-1633.36 8969.45,-1643.36 8976.45,-1643.36"/>
</g>
<!-- expert_l2_e12_g12&#45;&gt;aggregate_l2_g12 -->
<g id="edge355" class="edge">
<title>expert_l2_e12_g12&#45;&gt;aggregate_l2_g12</title>
<path fill="none" stroke="black" d="M8983.48,-1535.12C8983.48,-1535.12 8983.48,-1509.41 8983.48,-1509.41"/>
<polygon fill="black" stroke="black" points="8986.98,-1509.41 8983.48,-1499.41 8979.98,-1509.41 8986.98,-1509.41"/>
</g>
<!-- expert_l2_e13_g13 -->
<g id="node245" class="node">
<title>expert_l2_e13_g13</title>
<polygon fill="lightgreen" stroke="black" points="11040.95,-1633.17 10594.95,-1633.17 10594.95,-1535.17 11040.95,-1535.17 11040.95,-1633.17"/>
<text text-anchor="middle" x="10817.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10817.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="10817.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10817.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10817.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10817.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g13&#45;&gt;expert_l2_e13_g13 -->
<g id="edge358" class="edge">
<title>gate_l2_g13&#45;&gt;expert_l2_e13_g13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10817.95,-1668.9C10817.95,-1668.9 10817.95,-1643.36 10817.95,-1643.36"/>
<polygon fill="black" stroke="black" points="10821.45,-1643.36 10817.95,-1633.36 10814.45,-1643.36 10821.45,-1643.36"/>
</g>
<!-- expert_l2_e13_g13&#45;&gt;aggregate_l2_g13 -->
<g id="edge359" class="edge">
<title>expert_l2_e13_g13&#45;&gt;aggregate_l2_g13</title>
<path fill="none" stroke="black" d="M10823.98,-1535.12C10823.98,-1535.12 10823.98,-1509.41 10823.98,-1509.41"/>
<polygon fill="black" stroke="black" points="10827.48,-1509.41 10823.98,-1499.41 10820.48,-1509.41 10827.48,-1509.41"/>
</g>
<!-- expert_l2_e14_g14 -->
<g id="node247" class="node">
<title>expert_l2_e14_g14</title>
<polygon fill="lightgreen" stroke="black" points="12887.95,-1633.17 12441.95,-1633.17 12441.95,-1535.17 12887.95,-1535.17 12887.95,-1633.17"/>
<text text-anchor="middle" x="12664.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12664.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="12664.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12664.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12664.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12664.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g14&#45;&gt;expert_l2_e14_g14 -->
<g id="edge362" class="edge">
<title>gate_l2_g14&#45;&gt;expert_l2_e14_g14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12664.95,-1668.9C12664.95,-1668.9 12664.95,-1643.36 12664.95,-1643.36"/>
<polygon fill="black" stroke="black" points="12668.45,-1643.36 12664.95,-1633.36 12661.45,-1643.36 12668.45,-1643.36"/>
</g>
<!-- expert_l2_e14_g14&#45;&gt;aggregate_l2_g14 -->
<g id="edge363" class="edge">
<title>expert_l2_e14_g14&#45;&gt;aggregate_l2_g14</title>
<path fill="none" stroke="black" d="M12672.98,-1535.12C12672.98,-1535.12 12672.98,-1509.41 12672.98,-1509.41"/>
<polygon fill="black" stroke="black" points="12676.48,-1509.41 12672.98,-1499.41 12669.48,-1509.41 12676.48,-1509.41"/>
</g>
<!-- expert_l2_e15_g15 -->
<g id="node249" class="node">
<title>expert_l2_e15_g15</title>
<polygon fill="lightgreen" stroke="black" points="14733.95,-1633.17 14287.95,-1633.17 14287.95,-1535.17 14733.95,-1535.17 14733.95,-1633.17"/>
<text text-anchor="middle" x="14510.95" y="-1617.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="14510.95" y="-1602.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14510.95" y="-1587.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14510.95" y="-1572.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14510.95" y="-1557.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14510.95" y="-1542.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l2_g15&#45;&gt;expert_l2_e15_g15 -->
<g id="edge366" class="edge">
<title>gate_l2_g15&#45;&gt;expert_l2_e15_g15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14510.95,-1668.9C14510.95,-1668.9 14510.95,-1643.36 14510.95,-1643.36"/>
<polygon fill="black" stroke="black" points="14514.45,-1643.36 14510.95,-1633.36 14507.45,-1643.36 14514.45,-1643.36"/>
</g>
<!-- expert_l2_e15_g15&#45;&gt;aggregate_l2_g15 -->
<g id="edge367" class="edge">
<title>expert_l2_e15_g15&#45;&gt;aggregate_l2_g15</title>
<path fill="none" stroke="black" d="M14518.48,-1535.12C14518.48,-1535.12 14518.48,-1509.41 14518.48,-1509.41"/>
<polygon fill="black" stroke="black" points="14521.98,-1509.41 14518.48,-1499.41 14514.98,-1509.41 14521.98,-1509.41"/>
</g>
<!-- mha_qkv_l3_g0 -->
<g id="node266" class="node">
<title>mha_qkv_l3_g0</title>
<polygon fill="lightcoral" stroke="black" points="1648.95,-1297.17 1176.95,-1297.17 1176.95,-1229.17 1648.95,-1229.17 1648.95,-1297.17"/>
<text text-anchor="middle" x="1412.95" y="-1281.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 3</text>
<text text-anchor="middle" x="1412.95" y="-1266.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1412.95" y="-1251.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1412.95" y="-1236.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l2_g0&#45;&gt;mha_qkv_l3_g0 -->
<g id="edge369" class="edge">
<title>aggregate_l2_g0&#45;&gt;mha_qkv_l3_g0</title>
<path fill="none" stroke="black" d="M1288.43,-1398.62C1288.43,-1398.62 1288.43,-1307.21 1288.43,-1307.21"/>
<polygon fill="black" stroke="black" points="1291.93,-1307.21 1288.43,-1297.21 1284.93,-1307.21 1291.93,-1307.21"/>
</g>
<!-- residual_l3_g0 -->
<g id="node291" class="node">
<title>residual_l3_g0</title>
<polygon fill="lightyellow" stroke="black" points="1840.24,-783.17 1160.52,-783.17 985.67,-587.17 1665.38,-587.17 1840.24,-783.17"/>
<text text-anchor="middle" x="1412.95" y="-718.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1412.95" y="-703.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1412.95" y="-688.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1412.95" y="-673.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1412.95" y="-658.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1412.95" y="-643.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l2_g0&#45;&gt;residual_l3_g0 -->
<g id="edge388" class="edge">
<title>aggregate_l2_g0&#45;&gt;residual_l3_g0</title>
<path fill="none" stroke="black" d="M882.9,-1333C882.9,-1141.37 882.9,-685 882.9,-685 882.9,-685 1062.77,-685 1062.77,-685"/>
<polygon fill="black" stroke="black" points="1062.77,-688.5 1072.77,-685 1062.77,-681.5 1062.77,-688.5"/>
</g>
<!-- mha_qkv_l3_g1 -->
<g id="node269" class="node">
<title>mha_qkv_l3_g1</title>
<polygon fill="lightcoral" stroke="black" points="3485.95,-1297.17 3013.95,-1297.17 3013.95,-1229.17 3485.95,-1229.17 3485.95,-1297.17"/>
<text text-anchor="middle" x="3249.95" y="-1281.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 3</text>
<text text-anchor="middle" x="3249.95" y="-1266.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3249.95" y="-1251.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3249.95" y="-1236.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l2_g1&#45;&gt;mha_qkv_l3_g1 -->
<g id="edge371" class="edge">
<title>aggregate_l2_g1&#45;&gt;mha_qkv_l3_g1</title>
<path fill="none" stroke="black" d="M3125.93,-1398.01C3125.93,-1398.01 3125.93,-1307.22 3125.93,-1307.22"/>
<polygon fill="black" stroke="black" points="3129.43,-1307.22 3125.93,-1297.22 3122.43,-1307.22 3129.43,-1307.22"/>
</g>
<!-- residual_l3_g1 -->
<g id="node293" class="node">
<title>residual_l3_g1</title>
<polygon fill="lightyellow" stroke="black" points="3677.24,-783.17 2997.52,-783.17 2822.67,-587.17 3502.38,-587.17 3677.24,-783.17"/>
<text text-anchor="middle" x="3249.95" y="-718.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3249.95" y="-703.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3249.95" y="-688.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3249.95" y="-673.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3249.95" y="-658.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3249.95" y="-643.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l2_g1&#45;&gt;residual_l3_g1 -->
<g id="edge394" class="edge">
<title>aggregate_l2_g1&#45;&gt;residual_l3_g1</title>
<path fill="none" stroke="black" d="M2719.4,-1332.86C2719.4,-1150.88 2719.4,-734 2719.4,-734 2719.4,-734 2943.65,-734 2943.65,-734"/>
<polygon fill="black" stroke="black" points="2943.65,-737.5 2953.65,-734 2943.65,-730.5 2943.65,-737.5"/>
</g>
<!-- mha_qkv_l3_g2 -->
<g id="node272" class="node">
<title>mha_qkv_l3_g2</title>
<polygon fill="lightcoral" stroke="black" points="5323.95,-1297.17 4851.95,-1297.17 4851.95,-1229.17 5323.95,-1229.17 5323.95,-1297.17"/>
<text text-anchor="middle" x="5087.95" y="-1281.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 3</text>
<text text-anchor="middle" x="5087.95" y="-1266.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5087.95" y="-1251.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5087.95" y="-1236.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l2_g2&#45;&gt;mha_qkv_l3_g2 -->
<g id="edge373" class="edge">
<title>aggregate_l2_g2&#45;&gt;mha_qkv_l3_g2</title>
<path fill="none" stroke="black" d="M4965.93,-1396.16C4965.93,-1396.16 4965.93,-1307.21 4965.93,-1307.21"/>
<polygon fill="black" stroke="black" points="4969.43,-1307.21 4965.93,-1297.21 4962.43,-1307.21 4969.43,-1307.21"/>
</g>
<!-- residual_l3_g2 -->
<g id="node295" class="node">
<title>residual_l3_g2</title>
<polygon fill="lightyellow" stroke="black" points="5515.24,-783.17 4835.52,-783.17 4660.67,-587.17 5340.38,-587.17 5515.24,-783.17"/>
<text text-anchor="middle" x="5087.95" y="-718.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5087.95" y="-703.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="5087.95" y="-688.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5087.95" y="-673.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5087.95" y="-658.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5087.95" y="-643.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l2_g2&#45;&gt;residual_l3_g2 -->
<g id="edge400" class="edge">
<title>aggregate_l2_g2&#45;&gt;residual_l3_g2</title>
<path fill="none" stroke="black" d="M4556.4,-1332.86C4556.4,-1150.88 4556.4,-734 4556.4,-734 4556.4,-734 4781.48,-734 4781.48,-734"/>
<polygon fill="black" stroke="black" points="4781.48,-737.5 4791.48,-734 4781.48,-730.5 4781.48,-737.5"/>
</g>
<!-- mha_qkv_l3_g3 -->
<g id="node275" class="node">
<title>mha_qkv_l3_g3</title>
<polygon fill="lightcoral" stroke="black" points="7159.95,-1297.17 6687.95,-1297.17 6687.95,-1229.17 7159.95,-1229.17 7159.95,-1297.17"/>
<text text-anchor="middle" x="6923.95" y="-1281.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 3</text>
<text text-anchor="middle" x="6923.95" y="-1266.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6923.95" y="-1251.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6923.95" y="-1236.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l2_g3&#45;&gt;mha_qkv_l3_g3 -->
<g id="edge375" class="edge">
<title>aggregate_l2_g3&#45;&gt;mha_qkv_l3_g3</title>
<path fill="none" stroke="black" d="M6801.93,-1396.16C6801.93,-1396.16 6801.93,-1307.21 6801.93,-1307.21"/>
<polygon fill="black" stroke="black" points="6805.43,-1307.21 6801.93,-1297.21 6798.43,-1307.21 6805.43,-1307.21"/>
</g>
<!-- residual_l3_g3 -->
<g id="node297" class="node">
<title>residual_l3_g3</title>
<polygon fill="lightyellow" stroke="black" points="7351.24,-783.17 6671.52,-783.17 6496.67,-587.17 7176.38,-587.17 7351.24,-783.17"/>
<text text-anchor="middle" x="6923.95" y="-718.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6923.95" y="-703.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="6923.95" y="-688.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6923.95" y="-673.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6923.95" y="-658.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6923.95" y="-643.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l2_g3&#45;&gt;residual_l3_g3 -->
<g id="edge406" class="edge">
<title>aggregate_l2_g3&#45;&gt;residual_l3_g3</title>
<path fill="none" stroke="black" d="M6392.4,-1333.04C6392.4,-1132.02 6392.4,-636 6392.4,-636 6392.4,-636 6530.12,-636 6530.12,-636"/>
<polygon fill="black" stroke="black" points="6530.12,-639.5 6540.12,-636 6530.12,-632.5 6530.12,-639.5"/>
</g>
<!-- mha_qkv_l3_g4 -->
<g id="node278" class="node">
<title>mha_qkv_l3_g4</title>
<polygon fill="lightcoral" stroke="black" points="8997.95,-1297.17 8525.95,-1297.17 8525.95,-1229.17 8997.95,-1229.17 8997.95,-1297.17"/>
<text text-anchor="middle" x="8761.95" y="-1281.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 3</text>
<text text-anchor="middle" x="8761.95" y="-1266.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8761.95" y="-1251.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8761.95" y="-1236.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l2_g4&#45;&gt;mha_qkv_l3_g4 -->
<g id="edge377" class="edge">
<title>aggregate_l2_g4&#45;&gt;mha_qkv_l3_g4</title>
<path fill="none" stroke="black" d="M8639.43,-1396.79C8639.43,-1396.79 8639.43,-1307.22 8639.43,-1307.22"/>
<polygon fill="black" stroke="black" points="8642.93,-1307.22 8639.43,-1297.22 8635.93,-1307.22 8642.93,-1307.22"/>
</g>
<!-- residual_l3_g4 -->
<g id="node299" class="node">
<title>residual_l3_g4</title>
<polygon fill="lightyellow" stroke="black" points="9189.24,-783.17 8509.52,-783.17 8334.67,-587.17 9014.38,-587.17 9189.24,-783.17"/>
<text text-anchor="middle" x="8761.95" y="-718.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8761.95" y="-703.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="8761.95" y="-688.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8761.95" y="-673.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8761.95" y="-658.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8761.95" y="-643.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l2_g4&#45;&gt;residual_l3_g4 -->
<g id="edge412" class="edge">
<title>aggregate_l2_g4&#45;&gt;residual_l3_g4</title>
<path fill="none" stroke="black" d="M8229.4,-1333.04C8229.4,-1132.02 8229.4,-636 8229.4,-636 8229.4,-636 8368.1,-636 8368.1,-636"/>
<polygon fill="black" stroke="black" points="8368.1,-639.5 8378.1,-636 8368.1,-632.5 8368.1,-639.5"/>
</g>
<!-- mha_qkv_l3_g5 -->
<g id="node281" class="node">
<title>mha_qkv_l3_g5</title>
<polygon fill="lightcoral" stroke="black" points="10830.95,-1297.17 10358.95,-1297.17 10358.95,-1229.17 10830.95,-1229.17 10830.95,-1297.17"/>
<text text-anchor="middle" x="10594.95" y="-1281.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 3</text>
<text text-anchor="middle" x="10594.95" y="-1266.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10594.95" y="-1251.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10594.95" y="-1236.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l2_g5&#45;&gt;mha_qkv_l3_g5 -->
<g id="edge379" class="edge">
<title>aggregate_l2_g5&#45;&gt;mha_qkv_l3_g5</title>
<path fill="none" stroke="black" d="M10473.93,-1395.53C10473.93,-1395.53 10473.93,-1307.2 10473.93,-1307.2"/>
<polygon fill="black" stroke="black" points="10477.43,-1307.2 10473.93,-1297.2 10470.43,-1307.2 10477.43,-1307.2"/>
</g>
<!-- residual_l3_g5 -->
<g id="node301" class="node">
<title>residual_l3_g5</title>
<polygon fill="lightyellow" stroke="black" points="11022.24,-783.17 10342.52,-783.17 10167.67,-587.17 10847.38,-587.17 11022.24,-783.17"/>
<text text-anchor="middle" x="10594.95" y="-718.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10594.95" y="-703.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="10594.95" y="-688.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10594.95" y="-673.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10594.95" y="-658.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10594.95" y="-643.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l2_g5&#45;&gt;residual_l3_g5 -->
<g id="edge418" class="edge">
<title>aggregate_l2_g5&#45;&gt;residual_l3_g5</title>
<path fill="none" stroke="black" d="M10063.9,-1333.04C10063.9,-1132.02 10063.9,-636 10063.9,-636 10063.9,-636 10201.13,-636 10201.13,-636"/>
<polygon fill="black" stroke="black" points="10201.13,-639.5 10211.13,-636 10201.13,-632.5 10201.13,-639.5"/>
</g>
<!-- mha_qkv_l3_g6 -->
<g id="node284" class="node">
<title>mha_qkv_l3_g6</title>
<polygon fill="lightcoral" stroke="black" points="12685.95,-1297.17 12213.95,-1297.17 12213.95,-1229.17 12685.95,-1229.17 12685.95,-1297.17"/>
<text text-anchor="middle" x="12449.95" y="-1281.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 3</text>
<text text-anchor="middle" x="12449.95" y="-1266.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12449.95" y="-1251.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12449.95" y="-1236.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l2_g6&#45;&gt;mha_qkv_l3_g6 -->
<g id="edge381" class="edge">
<title>aggregate_l2_g6&#45;&gt;mha_qkv_l3_g6</title>
<path fill="none" stroke="black" d="M12326.93,-1397.1C12326.93,-1397.1 12326.93,-1307.37 12326.93,-1307.37"/>
<polygon fill="black" stroke="black" points="12330.43,-1307.37 12326.93,-1297.37 12323.43,-1307.37 12330.43,-1307.37"/>
</g>
<!-- residual_l3_g6 -->
<g id="node303" class="node">
<title>residual_l3_g6</title>
<polygon fill="lightyellow" stroke="black" points="12877.24,-783.17 12197.52,-783.17 12022.67,-587.17 12702.38,-587.17 12877.24,-783.17"/>
<text text-anchor="middle" x="12449.95" y="-718.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12449.95" y="-703.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="12449.95" y="-688.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12449.95" y="-673.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12449.95" y="-658.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12449.95" y="-643.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l2_g6&#45;&gt;residual_l3_g6 -->
<g id="edge424" class="edge">
<title>aggregate_l2_g6&#45;&gt;residual_l3_g6</title>
<path fill="none" stroke="black" d="M11909.4,-1333.04C11909.4,-1132.02 11909.4,-636 11909.4,-636 11909.4,-636 12056.12,-636 12056.12,-636"/>
<polygon fill="black" stroke="black" points="12056.12,-639.5 12066.12,-636 12056.12,-632.5 12056.12,-639.5"/>
</g>
<!-- mha_qkv_l3_g7 -->
<g id="node287" class="node">
<title>mha_qkv_l3_g7</title>
<polygon fill="lightcoral" stroke="black" points="14530.95,-1297.17 14058.95,-1297.17 14058.95,-1229.17 14530.95,-1229.17 14530.95,-1297.17"/>
<text text-anchor="middle" x="14294.95" y="-1281.97" font-family="Times,serif" font-size="14.00">MHA QKV Linear Layer 3</text>
<text text-anchor="middle" x="14294.95" y="-1266.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14294.95" y="-1251.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14294.95" y="-1236.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- aggregate_l2_g7&#45;&gt;mha_qkv_l3_g7 -->
<g id="edge383" class="edge">
<title>aggregate_l2_g7&#45;&gt;mha_qkv_l3_g7</title>
<path fill="none" stroke="black" d="M14171.93,-1397.1C14171.93,-1397.1 14171.93,-1307.37 14171.93,-1307.37"/>
<polygon fill="black" stroke="black" points="14175.43,-1307.37 14171.93,-1297.37 14168.43,-1307.37 14175.43,-1307.37"/>
</g>
<!-- residual_l3_g7 -->
<g id="node305" class="node">
<title>residual_l3_g7</title>
<polygon fill="lightyellow" stroke="black" points="14722.24,-783.17 14042.52,-783.17 13867.67,-587.17 14547.38,-587.17 14722.24,-783.17"/>
<text text-anchor="middle" x="14294.95" y="-718.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="14294.95" y="-703.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14294.95" y="-688.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14294.95" y="-673.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14294.95" y="-658.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14294.95" y="-643.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- aggregate_l2_g7&#45;&gt;residual_l3_g7 -->
<g id="edge430" class="edge">
<title>aggregate_l2_g7&#45;&gt;residual_l3_g7</title>
<path fill="none" stroke="black" d="M13749.9,-1332.86C13749.9,-1150.88 13749.9,-734 13749.9,-734 13749.9,-734 13988.5,-734 13988.5,-734"/>
<polygon fill="black" stroke="black" points="13988.5,-737.5 13998.5,-734 13988.5,-730.5 13988.5,-737.5"/>
</g>
<!-- aggregate_l2_g8&#45;&gt;mha_qkv_l3_g0 -->
<g id="edge370" class="edge">
<title>aggregate_l2_g8&#45;&gt;mha_qkv_l3_g0</title>
<path fill="none" stroke="black" d="M1533.48,-1332.95C1533.48,-1332.95 1533.48,-1307.23 1533.48,-1307.23"/>
<polygon fill="black" stroke="black" points="1536.98,-1307.23 1533.48,-1297.23 1529.98,-1307.23 1536.98,-1307.23"/>
</g>
<!-- aggregate_l2_g8&#45;&gt;residual_l3_g0 -->
<g id="edge389" class="edge">
<title>aggregate_l2_g8&#45;&gt;residual_l3_g0</title>
<path fill="none" stroke="black" d="M1979.77,-1333C1979.77,-1141.37 1979.77,-685 1979.77,-685 1979.77,-685 1762.9,-685 1762.9,-685"/>
<polygon fill="black" stroke="black" points="1762.9,-681.5 1752.9,-685 1762.9,-688.5 1762.9,-681.5"/>
</g>
<!-- aggregate_l2_g9&#45;&gt;mha_qkv_l3_g1 -->
<g id="edge372" class="edge">
<title>aggregate_l2_g9&#45;&gt;mha_qkv_l3_g1</title>
<path fill="none" stroke="black" d="M3370.98,-1332.95C3370.98,-1332.95 3370.98,-1307.23 3370.98,-1307.23"/>
<polygon fill="black" stroke="black" points="3374.48,-1307.23 3370.98,-1297.23 3367.48,-1307.23 3374.48,-1307.23"/>
</g>
<!-- aggregate_l2_g9&#45;&gt;residual_l3_g1 -->
<g id="edge395" class="edge">
<title>aggregate_l2_g9&#45;&gt;residual_l3_g1</title>
<path fill="none" stroke="black" d="M3816.27,-1333C3816.27,-1141.37 3816.27,-685 3816.27,-685 3816.27,-685 3600.01,-685 3600.01,-685"/>
<polygon fill="black" stroke="black" points="3600.01,-681.5 3590.01,-685 3600.01,-688.5 3600.01,-681.5"/>
</g>
<!-- aggregate_l2_g10&#45;&gt;mha_qkv_l3_g2 -->
<g id="edge374" class="edge">
<title>aggregate_l2_g10&#45;&gt;mha_qkv_l3_g2</title>
<path fill="none" stroke="black" d="M5210.98,-1332.95C5210.98,-1332.95 5210.98,-1307.23 5210.98,-1307.23"/>
<polygon fill="black" stroke="black" points="5214.48,-1307.23 5210.98,-1297.23 5207.48,-1307.23 5214.48,-1307.23"/>
</g>
<!-- aggregate_l2_g10&#45;&gt;residual_l3_g2 -->
<g id="edge401" class="edge">
<title>aggregate_l2_g10&#45;&gt;residual_l3_g2</title>
<path fill="none" stroke="black" d="M5653.77,-1332.86C5653.77,-1150.88 5653.77,-734 5653.77,-734 5653.77,-734 5481.63,-734 5481.63,-734"/>
<polygon fill="black" stroke="black" points="5481.63,-730.5 5471.63,-734 5481.63,-737.5 5481.63,-730.5"/>
</g>
<!-- aggregate_l2_g11&#45;&gt;mha_qkv_l3_g3 -->
<g id="edge376" class="edge">
<title>aggregate_l2_g11&#45;&gt;mha_qkv_l3_g3</title>
<path fill="none" stroke="black" d="M7046.98,-1332.95C7046.98,-1332.95 7046.98,-1307.23 7046.98,-1307.23"/>
<polygon fill="black" stroke="black" points="7050.48,-1307.23 7046.98,-1297.23 7043.48,-1307.23 7050.48,-1307.23"/>
</g>
<!-- aggregate_l2_g11&#45;&gt;residual_l3_g3 -->
<g id="edge407" class="edge">
<title>aggregate_l2_g11&#45;&gt;residual_l3_g3</title>
<path fill="none" stroke="black" d="M7489.77,-1332.86C7489.77,-1150.88 7489.77,-734 7489.77,-734 7489.77,-734 7317.63,-734 7317.63,-734"/>
<polygon fill="black" stroke="black" points="7317.63,-730.5 7307.63,-734 7317.63,-737.5 7317.63,-730.5"/>
</g>
<!-- aggregate_l2_g12&#45;&gt;mha_qkv_l3_g4 -->
<g id="edge378" class="edge">
<title>aggregate_l2_g12&#45;&gt;mha_qkv_l3_g4</title>
<path fill="none" stroke="black" d="M8884.48,-1332.95C8884.48,-1332.95 8884.48,-1307.23 8884.48,-1307.23"/>
<polygon fill="black" stroke="black" points="8887.98,-1307.23 8884.48,-1297.23 8880.98,-1307.23 8887.98,-1307.23"/>
</g>
<!-- aggregate_l2_g12&#45;&gt;residual_l3_g4 -->
<g id="edge413" class="edge">
<title>aggregate_l2_g12&#45;&gt;residual_l3_g4</title>
<path fill="none" stroke="black" d="M9328.27,-1332.86C9328.27,-1150.88 9328.27,-734 9328.27,-734 9328.27,-734 9155.58,-734 9155.58,-734"/>
<polygon fill="black" stroke="black" points="9155.58,-730.5 9145.58,-734 9155.58,-737.5 9155.58,-730.5"/>
</g>
<!-- aggregate_l2_g13&#45;&gt;mha_qkv_l3_g5 -->
<g id="edge380" class="edge">
<title>aggregate_l2_g13&#45;&gt;mha_qkv_l3_g5</title>
<path fill="none" stroke="black" d="M10718.98,-1332.95C10718.98,-1332.95 10718.98,-1307.23 10718.98,-1307.23"/>
<polygon fill="black" stroke="black" points="10722.48,-1307.23 10718.98,-1297.23 10715.48,-1307.23 10722.48,-1307.23"/>
</g>
<!-- aggregate_l2_g13&#45;&gt;residual_l3_g5 -->
<g id="edge419" class="edge">
<title>aggregate_l2_g13&#45;&gt;residual_l3_g5</title>
<path fill="none" stroke="black" d="M11161.27,-1332.86C11161.27,-1150.88 11161.27,-734 11161.27,-734 11161.27,-734 10988.58,-734 10988.58,-734"/>
<polygon fill="black" stroke="black" points="10988.58,-730.5 10978.58,-734 10988.58,-737.5 10988.58,-730.5"/>
</g>
<!-- aggregate_l2_g14&#45;&gt;mha_qkv_l3_g6 -->
<g id="edge382" class="edge">
<title>aggregate_l2_g14&#45;&gt;mha_qkv_l3_g6</title>
<path fill="none" stroke="black" d="M12571.98,-1332.95C12571.98,-1332.95 12571.98,-1307.23 12571.98,-1307.23"/>
<polygon fill="black" stroke="black" points="12575.48,-1307.23 12571.98,-1297.23 12568.48,-1307.23 12575.48,-1307.23"/>
</g>
<!-- aggregate_l2_g14&#45;&gt;residual_l3_g6 -->
<g id="edge425" class="edge">
<title>aggregate_l2_g14&#45;&gt;residual_l3_g6</title>
<path fill="none" stroke="black" d="M13011.27,-1333C13011.27,-1141.37 13011.27,-685 13011.27,-685 13011.27,-685 12799.83,-685 12799.83,-685"/>
<polygon fill="black" stroke="black" points="12799.83,-681.5 12789.83,-685 12799.83,-688.5 12799.83,-681.5"/>
</g>
<!-- aggregate_l2_g15&#45;&gt;mha_qkv_l3_g7 -->
<g id="edge384" class="edge">
<title>aggregate_l2_g15&#45;&gt;mha_qkv_l3_g7</title>
<path fill="none" stroke="black" d="M14416.98,-1332.95C14416.98,-1332.95 14416.98,-1307.23 14416.98,-1307.23"/>
<polygon fill="black" stroke="black" points="14420.48,-1307.23 14416.98,-1297.23 14413.48,-1307.23 14420.48,-1307.23"/>
</g>
<!-- aggregate_l2_g15&#45;&gt;residual_l3_g7 -->
<g id="edge431" class="edge">
<title>aggregate_l2_g15&#45;&gt;residual_l3_g7</title>
<path fill="none" stroke="black" d="M14857.77,-1332.87C14857.77,-1147.48 14857.77,-717 14857.77,-717 14857.77,-717 14673.29,-717 14673.29,-717"/>
<polygon fill="black" stroke="black" points="14673.29,-713.5 14663.29,-717 14673.29,-720.5 14673.29,-713.5"/>
</g>
<!-- mha_attn_l3_g0 -->
<g id="node267" class="node">
<title>mha_attn_l3_g0</title>
<polygon fill="lightcoral" stroke="black" points="1648.95,-1193.17 1176.95,-1193.17 1176.95,-1125.17 1648.95,-1125.17 1648.95,-1193.17"/>
<text text-anchor="middle" x="1412.95" y="-1177.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 3</text>
<text text-anchor="middle" x="1412.95" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1412.95" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="1412.95" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l3_g0&#45;&gt;mha_attn_l3_g0 -->
<g id="edge385" class="edge">
<title>mha_qkv_l3_g0&#45;&gt;mha_attn_l3_g0</title>
<path fill="none" stroke="black" d="M1412.95,-1229.11C1412.95,-1229.11 1412.95,-1203.3 1412.95,-1203.3"/>
<polygon fill="black" stroke="black" points="1416.45,-1203.3 1412.95,-1193.3 1409.45,-1203.3 1416.45,-1203.3"/>
</g>
<!-- mha_out_l3_g0 -->
<g id="node268" class="node">
<title>mha_out_l3_g0</title>
<polygon fill="lightcoral" stroke="black" points="1642.95,-1089.17 1182.95,-1089.17 1182.95,-1021.17 1642.95,-1021.17 1642.95,-1089.17"/>
<text text-anchor="middle" x="1412.95" y="-1073.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 3</text>
<text text-anchor="middle" x="1412.95" y="-1058.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1412.95" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="1412.95" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l3_g0&#45;&gt;mha_out_l3_g0 -->
<g id="edge386" class="edge">
<title>mha_attn_l3_g0&#45;&gt;mha_out_l3_g0</title>
<path fill="none" stroke="black" d="M1412.95,-1125.11C1412.95,-1125.11 1412.95,-1099.3 1412.95,-1099.3"/>
<polygon fill="black" stroke="black" points="1416.45,-1099.3 1412.95,-1089.3 1409.45,-1099.3 1416.45,-1099.3"/>
</g>
<!-- allreduce_l3_g0 -->
<g id="node290" class="node">
<title>allreduce_l3_g0</title>
<polygon fill="lightyellow" stroke="black" points="1840.24,-985.17 1160.52,-985.17 985.67,-819.17 1665.38,-819.17 1840.24,-985.17"/>
<text text-anchor="middle" x="1412.95" y="-928.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="1412.95" y="-913.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1412.95" y="-898.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1412.95" y="-883.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="1412.95" y="-868.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l3_g0&#45;&gt;allreduce_l3_g0 -->
<g id="edge387" class="edge">
<title>mha_out_l3_g0&#45;&gt;allreduce_l3_g0</title>
<path fill="none" stroke="black" d="M1412.95,-1020.83C1412.95,-1020.83 1412.95,-995.43 1412.95,-995.43"/>
<polygon fill="black" stroke="black" points="1416.45,-995.43 1412.95,-985.43 1409.45,-995.43 1416.45,-995.43"/>
</g>
<!-- mha_attn_l3_g1 -->
<g id="node270" class="node">
<title>mha_attn_l3_g1</title>
<polygon fill="lightcoral" stroke="black" points="3485.95,-1193.17 3013.95,-1193.17 3013.95,-1125.17 3485.95,-1125.17 3485.95,-1193.17"/>
<text text-anchor="middle" x="3249.95" y="-1177.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 3</text>
<text text-anchor="middle" x="3249.95" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3249.95" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="3249.95" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l3_g1&#45;&gt;mha_attn_l3_g1 -->
<g id="edge391" class="edge">
<title>mha_qkv_l3_g1&#45;&gt;mha_attn_l3_g1</title>
<path fill="none" stroke="black" d="M3249.95,-1229.11C3249.95,-1229.11 3249.95,-1203.3 3249.95,-1203.3"/>
<polygon fill="black" stroke="black" points="3253.45,-1203.3 3249.95,-1193.3 3246.45,-1203.3 3253.45,-1203.3"/>
</g>
<!-- mha_out_l3_g1 -->
<g id="node271" class="node">
<title>mha_out_l3_g1</title>
<polygon fill="lightcoral" stroke="black" points="3479.95,-1089.17 3019.95,-1089.17 3019.95,-1021.17 3479.95,-1021.17 3479.95,-1089.17"/>
<text text-anchor="middle" x="3249.95" y="-1073.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 3</text>
<text text-anchor="middle" x="3249.95" y="-1058.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3249.95" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="3249.95" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l3_g1&#45;&gt;mha_out_l3_g1 -->
<g id="edge392" class="edge">
<title>mha_attn_l3_g1&#45;&gt;mha_out_l3_g1</title>
<path fill="none" stroke="black" d="M3249.95,-1125.11C3249.95,-1125.11 3249.95,-1099.3 3249.95,-1099.3"/>
<polygon fill="black" stroke="black" points="3253.45,-1099.3 3249.95,-1089.3 3246.45,-1099.3 3253.45,-1099.3"/>
</g>
<!-- allreduce_l3_g1 -->
<g id="node292" class="node">
<title>allreduce_l3_g1</title>
<polygon fill="lightyellow" stroke="black" points="3677.24,-985.17 2997.52,-985.17 2822.67,-819.17 3502.38,-819.17 3677.24,-985.17"/>
<text text-anchor="middle" x="3249.95" y="-928.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="3249.95" y="-913.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3249.95" y="-898.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3249.95" y="-883.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="3249.95" y="-868.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l3_g1&#45;&gt;allreduce_l3_g1 -->
<g id="edge393" class="edge">
<title>mha_out_l3_g1&#45;&gt;allreduce_l3_g1</title>
<path fill="none" stroke="black" d="M3249.95,-1020.83C3249.95,-1020.83 3249.95,-995.43 3249.95,-995.43"/>
<polygon fill="black" stroke="black" points="3253.45,-995.43 3249.95,-985.43 3246.45,-995.43 3253.45,-995.43"/>
</g>
<!-- mha_attn_l3_g2 -->
<g id="node273" class="node">
<title>mha_attn_l3_g2</title>
<polygon fill="lightcoral" stroke="black" points="5323.95,-1193.17 4851.95,-1193.17 4851.95,-1125.17 5323.95,-1125.17 5323.95,-1193.17"/>
<text text-anchor="middle" x="5087.95" y="-1177.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 3</text>
<text text-anchor="middle" x="5087.95" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5087.95" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="5087.95" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l3_g2&#45;&gt;mha_attn_l3_g2 -->
<g id="edge397" class="edge">
<title>mha_qkv_l3_g2&#45;&gt;mha_attn_l3_g2</title>
<path fill="none" stroke="black" d="M5087.95,-1229.11C5087.95,-1229.11 5087.95,-1203.3 5087.95,-1203.3"/>
<polygon fill="black" stroke="black" points="5091.45,-1203.3 5087.95,-1193.3 5084.45,-1203.3 5091.45,-1203.3"/>
</g>
<!-- mha_out_l3_g2 -->
<g id="node274" class="node">
<title>mha_out_l3_g2</title>
<polygon fill="lightcoral" stroke="black" points="5317.95,-1089.17 4857.95,-1089.17 4857.95,-1021.17 5317.95,-1021.17 5317.95,-1089.17"/>
<text text-anchor="middle" x="5087.95" y="-1073.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 3</text>
<text text-anchor="middle" x="5087.95" y="-1058.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5087.95" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="5087.95" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l3_g2&#45;&gt;mha_out_l3_g2 -->
<g id="edge398" class="edge">
<title>mha_attn_l3_g2&#45;&gt;mha_out_l3_g2</title>
<path fill="none" stroke="black" d="M5087.95,-1125.11C5087.95,-1125.11 5087.95,-1099.3 5087.95,-1099.3"/>
<polygon fill="black" stroke="black" points="5091.45,-1099.3 5087.95,-1089.3 5084.45,-1099.3 5091.45,-1099.3"/>
</g>
<!-- allreduce_l3_g2 -->
<g id="node294" class="node">
<title>allreduce_l3_g2</title>
<polygon fill="lightyellow" stroke="black" points="5515.24,-985.17 4835.52,-985.17 4660.67,-819.17 5340.38,-819.17 5515.24,-985.17"/>
<text text-anchor="middle" x="5087.95" y="-928.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="5087.95" y="-913.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="5087.95" y="-898.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5087.95" y="-883.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="5087.95" y="-868.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l3_g2&#45;&gt;allreduce_l3_g2 -->
<g id="edge399" class="edge">
<title>mha_out_l3_g2&#45;&gt;allreduce_l3_g2</title>
<path fill="none" stroke="black" d="M5087.95,-1020.83C5087.95,-1020.83 5087.95,-995.43 5087.95,-995.43"/>
<polygon fill="black" stroke="black" points="5091.45,-995.43 5087.95,-985.43 5084.45,-995.43 5091.45,-995.43"/>
</g>
<!-- mha_attn_l3_g3 -->
<g id="node276" class="node">
<title>mha_attn_l3_g3</title>
<polygon fill="lightcoral" stroke="black" points="7159.95,-1193.17 6687.95,-1193.17 6687.95,-1125.17 7159.95,-1125.17 7159.95,-1193.17"/>
<text text-anchor="middle" x="6923.95" y="-1177.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 3</text>
<text text-anchor="middle" x="6923.95" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6923.95" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6923.95" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l3_g3&#45;&gt;mha_attn_l3_g3 -->
<g id="edge403" class="edge">
<title>mha_qkv_l3_g3&#45;&gt;mha_attn_l3_g3</title>
<path fill="none" stroke="black" d="M6923.95,-1229.11C6923.95,-1229.11 6923.95,-1203.3 6923.95,-1203.3"/>
<polygon fill="black" stroke="black" points="6927.45,-1203.3 6923.95,-1193.3 6920.45,-1203.3 6927.45,-1203.3"/>
</g>
<!-- mha_out_l3_g3 -->
<g id="node277" class="node">
<title>mha_out_l3_g3</title>
<polygon fill="lightcoral" stroke="black" points="7153.95,-1089.17 6693.95,-1089.17 6693.95,-1021.17 7153.95,-1021.17 7153.95,-1089.17"/>
<text text-anchor="middle" x="6923.95" y="-1073.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 3</text>
<text text-anchor="middle" x="6923.95" y="-1058.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6923.95" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="6923.95" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l3_g3&#45;&gt;mha_out_l3_g3 -->
<g id="edge404" class="edge">
<title>mha_attn_l3_g3&#45;&gt;mha_out_l3_g3</title>
<path fill="none" stroke="black" d="M6923.95,-1125.11C6923.95,-1125.11 6923.95,-1099.3 6923.95,-1099.3"/>
<polygon fill="black" stroke="black" points="6927.45,-1099.3 6923.95,-1089.3 6920.45,-1099.3 6927.45,-1099.3"/>
</g>
<!-- allreduce_l3_g3 -->
<g id="node296" class="node">
<title>allreduce_l3_g3</title>
<polygon fill="lightyellow" stroke="black" points="7351.24,-985.17 6671.52,-985.17 6496.67,-819.17 7176.38,-819.17 7351.24,-985.17"/>
<text text-anchor="middle" x="6923.95" y="-928.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="6923.95" y="-913.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="6923.95" y="-898.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6923.95" y="-883.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="6923.95" y="-868.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l3_g3&#45;&gt;allreduce_l3_g3 -->
<g id="edge405" class="edge">
<title>mha_out_l3_g3&#45;&gt;allreduce_l3_g3</title>
<path fill="none" stroke="black" d="M6923.95,-1020.83C6923.95,-1020.83 6923.95,-995.43 6923.95,-995.43"/>
<polygon fill="black" stroke="black" points="6927.45,-995.43 6923.95,-985.43 6920.45,-995.43 6927.45,-995.43"/>
</g>
<!-- mha_attn_l3_g4 -->
<g id="node279" class="node">
<title>mha_attn_l3_g4</title>
<polygon fill="lightcoral" stroke="black" points="8997.95,-1193.17 8525.95,-1193.17 8525.95,-1125.17 8997.95,-1125.17 8997.95,-1193.17"/>
<text text-anchor="middle" x="8761.95" y="-1177.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 3</text>
<text text-anchor="middle" x="8761.95" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8761.95" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8761.95" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l3_g4&#45;&gt;mha_attn_l3_g4 -->
<g id="edge409" class="edge">
<title>mha_qkv_l3_g4&#45;&gt;mha_attn_l3_g4</title>
<path fill="none" stroke="black" d="M8761.95,-1229.11C8761.95,-1229.11 8761.95,-1203.3 8761.95,-1203.3"/>
<polygon fill="black" stroke="black" points="8765.45,-1203.3 8761.95,-1193.3 8758.45,-1203.3 8765.45,-1203.3"/>
</g>
<!-- mha_out_l3_g4 -->
<g id="node280" class="node">
<title>mha_out_l3_g4</title>
<polygon fill="lightcoral" stroke="black" points="8991.95,-1089.17 8531.95,-1089.17 8531.95,-1021.17 8991.95,-1021.17 8991.95,-1089.17"/>
<text text-anchor="middle" x="8761.95" y="-1073.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 3</text>
<text text-anchor="middle" x="8761.95" y="-1058.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8761.95" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="8761.95" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l3_g4&#45;&gt;mha_out_l3_g4 -->
<g id="edge410" class="edge">
<title>mha_attn_l3_g4&#45;&gt;mha_out_l3_g4</title>
<path fill="none" stroke="black" d="M8761.95,-1125.11C8761.95,-1125.11 8761.95,-1099.3 8761.95,-1099.3"/>
<polygon fill="black" stroke="black" points="8765.45,-1099.3 8761.95,-1089.3 8758.45,-1099.3 8765.45,-1099.3"/>
</g>
<!-- allreduce_l3_g4 -->
<g id="node298" class="node">
<title>allreduce_l3_g4</title>
<polygon fill="lightyellow" stroke="black" points="9189.24,-985.17 8509.52,-985.17 8334.67,-819.17 9014.38,-819.17 9189.24,-985.17"/>
<text text-anchor="middle" x="8761.95" y="-928.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="8761.95" y="-913.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="8761.95" y="-898.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8761.95" y="-883.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="8761.95" y="-868.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l3_g4&#45;&gt;allreduce_l3_g4 -->
<g id="edge411" class="edge">
<title>mha_out_l3_g4&#45;&gt;allreduce_l3_g4</title>
<path fill="none" stroke="black" d="M8761.95,-1020.83C8761.95,-1020.83 8761.95,-995.43 8761.95,-995.43"/>
<polygon fill="black" stroke="black" points="8765.45,-995.43 8761.95,-985.43 8758.45,-995.43 8765.45,-995.43"/>
</g>
<!-- mha_attn_l3_g5 -->
<g id="node282" class="node">
<title>mha_attn_l3_g5</title>
<polygon fill="lightcoral" stroke="black" points="10830.95,-1193.17 10358.95,-1193.17 10358.95,-1125.17 10830.95,-1125.17 10830.95,-1193.17"/>
<text text-anchor="middle" x="10594.95" y="-1177.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 3</text>
<text text-anchor="middle" x="10594.95" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10594.95" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10594.95" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l3_g5&#45;&gt;mha_attn_l3_g5 -->
<g id="edge415" class="edge">
<title>mha_qkv_l3_g5&#45;&gt;mha_attn_l3_g5</title>
<path fill="none" stroke="black" d="M10594.95,-1229.11C10594.95,-1229.11 10594.95,-1203.3 10594.95,-1203.3"/>
<polygon fill="black" stroke="black" points="10598.45,-1203.3 10594.95,-1193.3 10591.45,-1203.3 10598.45,-1203.3"/>
</g>
<!-- mha_out_l3_g5 -->
<g id="node283" class="node">
<title>mha_out_l3_g5</title>
<polygon fill="lightcoral" stroke="black" points="10824.95,-1089.17 10364.95,-1089.17 10364.95,-1021.17 10824.95,-1021.17 10824.95,-1089.17"/>
<text text-anchor="middle" x="10594.95" y="-1073.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 3</text>
<text text-anchor="middle" x="10594.95" y="-1058.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10594.95" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="10594.95" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l3_g5&#45;&gt;mha_out_l3_g5 -->
<g id="edge416" class="edge">
<title>mha_attn_l3_g5&#45;&gt;mha_out_l3_g5</title>
<path fill="none" stroke="black" d="M10594.95,-1125.11C10594.95,-1125.11 10594.95,-1099.3 10594.95,-1099.3"/>
<polygon fill="black" stroke="black" points="10598.45,-1099.3 10594.95,-1089.3 10591.45,-1099.3 10598.45,-1099.3"/>
</g>
<!-- allreduce_l3_g5 -->
<g id="node300" class="node">
<title>allreduce_l3_g5</title>
<polygon fill="lightyellow" stroke="black" points="11022.24,-985.17 10342.52,-985.17 10167.67,-819.17 10847.38,-819.17 11022.24,-985.17"/>
<text text-anchor="middle" x="10594.95" y="-928.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="10594.95" y="-913.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="10594.95" y="-898.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10594.95" y="-883.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="10594.95" y="-868.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l3_g5&#45;&gt;allreduce_l3_g5 -->
<g id="edge417" class="edge">
<title>mha_out_l3_g5&#45;&gt;allreduce_l3_g5</title>
<path fill="none" stroke="black" d="M10594.95,-1020.83C10594.95,-1020.83 10594.95,-995.43 10594.95,-995.43"/>
<polygon fill="black" stroke="black" points="10598.45,-995.43 10594.95,-985.43 10591.45,-995.43 10598.45,-995.43"/>
</g>
<!-- mha_attn_l3_g6 -->
<g id="node285" class="node">
<title>mha_attn_l3_g6</title>
<polygon fill="lightcoral" stroke="black" points="12685.95,-1193.17 12213.95,-1193.17 12213.95,-1125.17 12685.95,-1125.17 12685.95,-1193.17"/>
<text text-anchor="middle" x="12449.95" y="-1177.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 3</text>
<text text-anchor="middle" x="12449.95" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12449.95" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="12449.95" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l3_g6&#45;&gt;mha_attn_l3_g6 -->
<g id="edge421" class="edge">
<title>mha_qkv_l3_g6&#45;&gt;mha_attn_l3_g6</title>
<path fill="none" stroke="black" d="M12449.95,-1229.11C12449.95,-1229.11 12449.95,-1203.3 12449.95,-1203.3"/>
<polygon fill="black" stroke="black" points="12453.45,-1203.3 12449.95,-1193.3 12446.45,-1203.3 12453.45,-1203.3"/>
</g>
<!-- mha_out_l3_g6 -->
<g id="node286" class="node">
<title>mha_out_l3_g6</title>
<polygon fill="lightcoral" stroke="black" points="12679.95,-1089.17 12219.95,-1089.17 12219.95,-1021.17 12679.95,-1021.17 12679.95,-1089.17"/>
<text text-anchor="middle" x="12449.95" y="-1073.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 3</text>
<text text-anchor="middle" x="12449.95" y="-1058.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12449.95" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="12449.95" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l3_g6&#45;&gt;mha_out_l3_g6 -->
<g id="edge422" class="edge">
<title>mha_attn_l3_g6&#45;&gt;mha_out_l3_g6</title>
<path fill="none" stroke="black" d="M12449.95,-1125.11C12449.95,-1125.11 12449.95,-1099.3 12449.95,-1099.3"/>
<polygon fill="black" stroke="black" points="12453.45,-1099.3 12449.95,-1089.3 12446.45,-1099.3 12453.45,-1099.3"/>
</g>
<!-- allreduce_l3_g6 -->
<g id="node302" class="node">
<title>allreduce_l3_g6</title>
<polygon fill="lightyellow" stroke="black" points="12877.24,-985.17 12197.52,-985.17 12022.67,-819.17 12702.38,-819.17 12877.24,-985.17"/>
<text text-anchor="middle" x="12449.95" y="-928.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="12449.95" y="-913.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="12449.95" y="-898.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12449.95" y="-883.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="12449.95" y="-868.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l3_g6&#45;&gt;allreduce_l3_g6 -->
<g id="edge423" class="edge">
<title>mha_out_l3_g6&#45;&gt;allreduce_l3_g6</title>
<path fill="none" stroke="black" d="M12449.95,-1020.83C12449.95,-1020.83 12449.95,-995.43 12449.95,-995.43"/>
<polygon fill="black" stroke="black" points="12453.45,-995.43 12449.95,-985.43 12446.45,-995.43 12453.45,-995.43"/>
</g>
<!-- mha_attn_l3_g7 -->
<g id="node288" class="node">
<title>mha_attn_l3_g7</title>
<polygon fill="lightcoral" stroke="black" points="14530.95,-1193.17 14058.95,-1193.17 14058.95,-1125.17 14530.95,-1125.17 14530.95,-1193.17"/>
<text text-anchor="middle" x="14294.95" y="-1177.97" font-family="Times,serif" font-size="14.00">MHA Attention Layer 3</text>
<text text-anchor="middle" x="14294.95" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14294.95" y="-1147.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="14294.95" y="-1132.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
</g>
<!-- mha_qkv_l3_g7&#45;&gt;mha_attn_l3_g7 -->
<g id="edge427" class="edge">
<title>mha_qkv_l3_g7&#45;&gt;mha_attn_l3_g7</title>
<path fill="none" stroke="black" d="M14294.95,-1229.11C14294.95,-1229.11 14294.95,-1203.3 14294.95,-1203.3"/>
<polygon fill="black" stroke="black" points="14298.45,-1203.3 14294.95,-1193.3 14291.45,-1203.3 14298.45,-1203.3"/>
</g>
<!-- mha_out_l3_g7 -->
<g id="node289" class="node">
<title>mha_out_l3_g7</title>
<polygon fill="lightcoral" stroke="black" points="14524.95,-1089.17 14064.95,-1089.17 14064.95,-1021.17 14524.95,-1021.17 14524.95,-1089.17"/>
<text text-anchor="middle" x="14294.95" y="-1073.97" font-family="Times,serif" font-size="14.00">MHA Output Linear Layer 3</text>
<text text-anchor="middle" x="14294.95" y="-1058.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14294.95" y="-1043.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=2, d_k=512]</text>
<text text-anchor="middle" x="14294.95" y="-1028.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=1024]</text>
</g>
<!-- mha_attn_l3_g7&#45;&gt;mha_out_l3_g7 -->
<g id="edge428" class="edge">
<title>mha_attn_l3_g7&#45;&gt;mha_out_l3_g7</title>
<path fill="none" stroke="black" d="M14294.95,-1125.11C14294.95,-1125.11 14294.95,-1099.3 14294.95,-1099.3"/>
<polygon fill="black" stroke="black" points="14298.45,-1099.3 14294.95,-1089.3 14291.45,-1099.3 14298.45,-1099.3"/>
</g>
<!-- allreduce_l3_g7 -->
<g id="node304" class="node">
<title>allreduce_l3_g7</title>
<polygon fill="lightyellow" stroke="black" points="14722.24,-985.17 14042.52,-985.17 13867.67,-819.17 14547.38,-819.17 14722.24,-985.17"/>
<text text-anchor="middle" x="14294.95" y="-928.47" font-family="Times,serif" font-size="14.00">All&#45;Reduce Sum</text>
<text text-anchor="middle" x="14294.95" y="-913.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14294.95" y="-898.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14294.95" y="-883.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=1024]</text>
<text text-anchor="middle" x="14294.95" y="-868.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- mha_out_l3_g7&#45;&gt;allreduce_l3_g7 -->
<g id="edge429" class="edge">
<title>mha_out_l3_g7&#45;&gt;allreduce_l3_g7</title>
<path fill="none" stroke="black" d="M14294.95,-1020.83C14294.95,-1020.83 14294.95,-995.43 14294.95,-995.43"/>
<polygon fill="black" stroke="black" points="14298.45,-995.43 14294.95,-985.43 14291.45,-995.43 14298.45,-995.43"/>
</g>
<!-- allreduce_l3_g0&#45;&gt;residual_l3_g0 -->
<g id="edge390" class="edge">
<title>allreduce_l3_g0&#45;&gt;residual_l3_g0</title>
<path fill="none" stroke="black" d="M1412.95,-818.89C1412.95,-818.89 1412.95,-793.46 1412.95,-793.46"/>
<polygon fill="black" stroke="black" points="1416.45,-793.46 1412.95,-783.46 1409.45,-793.46 1416.45,-793.46"/>
</g>
<!-- gate_l3_g0 -->
<g id="node306" class="node">
<title>gate_l3_g0</title>
<polygon fill="lightgreen" stroke="black" points="1642.45,-551.17 1183.45,-551.17 1183.45,-468.17 1642.45,-468.17 1642.45,-551.17"/>
<text text-anchor="middle" x="1412.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="1412.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1412.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1412.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1412.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g0&#45;&gt;gate_l3_g0 -->
<g id="edge433" class="edge">
<title>residual_l3_g0&#45;&gt;gate_l3_g0</title>
<path fill="none" stroke="black" d="M1412.95,-587.15C1412.95,-587.15 1412.95,-561.37 1412.95,-561.37"/>
<polygon fill="black" stroke="black" points="1416.45,-561.37 1412.95,-551.37 1409.45,-561.37 1416.45,-561.37"/>
</g>
<!-- gate_l3_g8 -->
<g id="node322" class="node">
<title>gate_l3_g8</title>
<polygon fill="lightgreen" stroke="black" points="2119.45,-551.17 1660.45,-551.17 1660.45,-468.17 2119.45,-468.17 2119.45,-551.17"/>
<text text-anchor="middle" x="1889.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="1889.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1889.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1889.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="1889.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g0&#45;&gt;gate_l3_g8 -->
<g id="edge465" class="edge">
<title>residual_l3_g0&#45;&gt;gate_l3_g8</title>
<path fill="none" stroke="black" d="M1750.27,-682.12C1750.27,-682.12 1750.27,-561.37 1750.27,-561.37"/>
<polygon fill="black" stroke="black" points="1753.77,-561.37 1750.27,-551.37 1746.77,-561.37 1753.77,-561.37"/>
</g>
<!-- aggregate_l3_g0 -->
<g id="node338" class="node">
<title>aggregate_l3_g0</title>
<polygon fill="lightyellow" stroke="black" points="1679.85,-298.17 964.16,-298.17 780.05,-132.17 1495.74,-132.17 1679.85,-298.17"/>
<text text-anchor="middle" x="1229.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1229.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1229.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1229.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1229.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g0&#45;&gt;aggregate_l3_g0 -->
<g id="edge436" class="edge">
<title>residual_l3_g0&#45;&gt;aggregate_l3_g0</title>
<path fill="none" stroke="black" d="M1651.45,-586.93C1651.45,-586.93 1651.45,-225.21 1651.45,-225.21"/>
<polygon fill="black" stroke="black" points="1654.95,-225.21 1651.45,-215.21 1647.95,-225.21 1654.95,-225.21"/>
</g>
<!-- aggregate_l3_g8 -->
<g id="node346" class="node">
<title>aggregate_l3_g8</title>
<polygon fill="lightyellow" stroke="black" points="2597.85,-298.17 1882.16,-298.17 1698.05,-132.17 2413.74,-132.17 2597.85,-298.17"/>
<text text-anchor="middle" x="2147.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2147.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2147.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2147.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="2147.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g0&#45;&gt;aggregate_l3_g8 -->
<g id="edge468" class="edge">
<title>residual_l3_g0&#45;&gt;aggregate_l3_g8</title>
<path fill="none" stroke="black" d="M1708.97,-636C1938.82,-636 2218.68,-636 2218.68,-636 2218.68,-636 2218.68,-308.31 2218.68,-308.31"/>
<polygon fill="black" stroke="black" points="2222.18,-308.31 2218.68,-298.31 2215.18,-308.31 2222.18,-308.31"/>
</g>
<!-- allreduce_l3_g1&#45;&gt;residual_l3_g1 -->
<g id="edge396" class="edge">
<title>allreduce_l3_g1&#45;&gt;residual_l3_g1</title>
<path fill="none" stroke="black" d="M3249.95,-818.89C3249.95,-818.89 3249.95,-793.46 3249.95,-793.46"/>
<polygon fill="black" stroke="black" points="3253.45,-793.46 3249.95,-783.46 3246.45,-793.46 3253.45,-793.46"/>
</g>
<!-- gate_l3_g1 -->
<g id="node308" class="node">
<title>gate_l3_g1</title>
<polygon fill="lightgreen" stroke="black" points="3478.45,-551.17 3019.45,-551.17 3019.45,-468.17 3478.45,-468.17 3478.45,-551.17"/>
<text text-anchor="middle" x="3248.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="3248.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3248.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3248.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3248.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g1&#45;&gt;gate_l3_g1 -->
<g id="edge437" class="edge">
<title>residual_l3_g1&#45;&gt;gate_l3_g1</title>
<path fill="none" stroke="black" d="M3248.95,-587.15C3248.95,-587.15 3248.95,-561.37 3248.95,-561.37"/>
<polygon fill="black" stroke="black" points="3252.45,-561.37 3248.95,-551.37 3245.45,-561.37 3252.45,-561.37"/>
</g>
<!-- gate_l3_g9 -->
<g id="node324" class="node">
<title>gate_l3_g9</title>
<polygon fill="lightgreen" stroke="black" points="3955.45,-551.17 3496.45,-551.17 3496.45,-468.17 3955.45,-468.17 3955.45,-551.17"/>
<text text-anchor="middle" x="3725.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="3725.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3725.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3725.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="3725.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g1&#45;&gt;gate_l3_g9 -->
<g id="edge469" class="edge">
<title>residual_l3_g1&#45;&gt;gate_l3_g9</title>
<path fill="none" stroke="black" d="M3586.77,-681.5C3586.77,-681.5 3586.77,-561.57 3586.77,-561.57"/>
<polygon fill="black" stroke="black" points="3590.27,-561.57 3586.77,-551.57 3583.27,-561.57 3590.27,-561.57"/>
</g>
<!-- aggregate_l3_g1 -->
<g id="node339" class="node">
<title>aggregate_l3_g1</title>
<polygon fill="lightyellow" stroke="black" points="3515.85,-298.17 2800.16,-298.17 2616.05,-132.17 3331.74,-132.17 3515.85,-298.17"/>
<text text-anchor="middle" x="3065.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3065.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3065.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3065.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3065.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g1&#45;&gt;aggregate_l3_g1 -->
<g id="edge440" class="edge">
<title>residual_l3_g1&#45;&gt;aggregate_l3_g1</title>
<path fill="none" stroke="black" d="M3487.45,-586.93C3487.45,-586.93 3487.45,-225.21 3487.45,-225.21"/>
<polygon fill="black" stroke="black" points="3490.95,-225.21 3487.45,-215.21 3483.95,-225.21 3490.95,-225.21"/>
</g>
<!-- aggregate_l3_g9 -->
<g id="node347" class="node">
<title>aggregate_l3_g9</title>
<polygon fill="lightyellow" stroke="black" points="4433.85,-298.17 3718.16,-298.17 3534.05,-132.17 4249.74,-132.17 4433.85,-298.17"/>
<text text-anchor="middle" x="3983.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3983.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3983.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3983.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3983.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g1&#45;&gt;aggregate_l3_g9 -->
<g id="edge472" class="edge">
<title>residual_l3_g1&#45;&gt;aggregate_l3_g9</title>
<path fill="none" stroke="black" d="M3545.97,-636C3775.82,-636 4055.68,-636 4055.68,-636 4055.68,-636 4055.68,-308.31 4055.68,-308.31"/>
<polygon fill="black" stroke="black" points="4059.18,-308.31 4055.68,-298.31 4052.18,-308.31 4059.18,-308.31"/>
</g>
<!-- allreduce_l3_g2&#45;&gt;residual_l3_g2 -->
<g id="edge402" class="edge">
<title>allreduce_l3_g2&#45;&gt;residual_l3_g2</title>
<path fill="none" stroke="black" d="M5087.95,-818.89C5087.95,-818.89 5087.95,-793.46 5087.95,-793.46"/>
<polygon fill="black" stroke="black" points="5091.45,-793.46 5087.95,-783.46 5084.45,-793.46 5091.45,-793.46"/>
</g>
<!-- gate_l3_g2 -->
<g id="node310" class="node">
<title>gate_l3_g2</title>
<polygon fill="lightgreen" stroke="black" points="5315.45,-551.17 4856.45,-551.17 4856.45,-468.17 5315.45,-468.17 5315.45,-551.17"/>
<text text-anchor="middle" x="5085.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5085.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="5085.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5085.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5085.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g2&#45;&gt;gate_l3_g2 -->
<g id="edge441" class="edge">
<title>residual_l3_g2&#45;&gt;gate_l3_g2</title>
<path fill="none" stroke="black" d="M5085.95,-587.15C5085.95,-587.15 5085.95,-561.37 5085.95,-561.37"/>
<polygon fill="black" stroke="black" points="5089.45,-561.37 5085.95,-551.37 5082.45,-561.37 5089.45,-561.37"/>
</g>
<!-- gate_l3_g10 -->
<g id="node326" class="node">
<title>gate_l3_g10</title>
<polygon fill="lightgreen" stroke="black" points="5792.45,-551.17 5333.45,-551.17 5333.45,-468.17 5792.45,-468.17 5792.45,-551.17"/>
<text text-anchor="middle" x="5562.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="5562.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="5562.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5562.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="5562.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g2&#45;&gt;gate_l3_g10 -->
<g id="edge473" class="edge">
<title>residual_l3_g2&#45;&gt;gate_l3_g10</title>
<path fill="none" stroke="black" d="M5424.27,-681.17C5424.27,-681.17 5424.27,-561.26 5424.27,-561.26"/>
<polygon fill="black" stroke="black" points="5427.77,-561.26 5424.27,-551.26 5420.77,-561.26 5427.77,-561.26"/>
</g>
<!-- aggregate_l3_g2 -->
<g id="node340" class="node">
<title>aggregate_l3_g2</title>
<polygon fill="lightyellow" stroke="black" points="5351.85,-298.17 4636.16,-298.17 4452.05,-132.17 5167.74,-132.17 5351.85,-298.17"/>
<text text-anchor="middle" x="4901.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4901.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4901.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4901.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="4901.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g2&#45;&gt;aggregate_l3_g2 -->
<g id="edge444" class="edge">
<title>residual_l3_g2&#45;&gt;aggregate_l3_g2</title>
<path fill="none" stroke="black" d="M5324.45,-586.93C5324.45,-586.93 5324.45,-225.21 5324.45,-225.21"/>
<polygon fill="black" stroke="black" points="5327.95,-225.21 5324.45,-215.21 5320.95,-225.21 5327.95,-225.21"/>
</g>
<!-- aggregate_l3_g10 -->
<g id="node348" class="node">
<title>aggregate_l3_g10</title>
<polygon fill="lightyellow" stroke="black" points="6269.85,-298.17 5554.16,-298.17 5370.05,-132.17 6085.74,-132.17 6269.85,-298.17"/>
<text text-anchor="middle" x="5819.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5819.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="5819.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5819.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5819.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g2&#45;&gt;aggregate_l3_g10 -->
<g id="edge476" class="edge">
<title>residual_l3_g2&#45;&gt;aggregate_l3_g10</title>
<path fill="none" stroke="black" d="M5427.95,-685C5648.56,-685 5895.18,-685 5895.18,-685 5895.18,-685 5895.18,-308.35 5895.18,-308.35"/>
<polygon fill="black" stroke="black" points="5898.68,-308.35 5895.18,-298.35 5891.68,-308.35 5898.68,-308.35"/>
</g>
<!-- allreduce_l3_g3&#45;&gt;residual_l3_g3 -->
<g id="edge408" class="edge">
<title>allreduce_l3_g3&#45;&gt;residual_l3_g3</title>
<path fill="none" stroke="black" d="M6923.95,-818.89C6923.95,-818.89 6923.95,-793.46 6923.95,-793.46"/>
<polygon fill="black" stroke="black" points="6927.45,-793.46 6923.95,-783.46 6920.45,-793.46 6927.45,-793.46"/>
</g>
<!-- gate_l3_g3 -->
<g id="node312" class="node">
<title>gate_l3_g3</title>
<polygon fill="lightgreen" stroke="black" points="7151.45,-551.17 6692.45,-551.17 6692.45,-468.17 7151.45,-468.17 7151.45,-551.17"/>
<text text-anchor="middle" x="6921.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="6921.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="6921.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6921.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="6921.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g3&#45;&gt;gate_l3_g3 -->
<g id="edge445" class="edge">
<title>residual_l3_g3&#45;&gt;gate_l3_g3</title>
<path fill="none" stroke="black" d="M6921.95,-587.15C6921.95,-587.15 6921.95,-561.37 6921.95,-561.37"/>
<polygon fill="black" stroke="black" points="6925.45,-561.37 6921.95,-551.37 6918.45,-561.37 6925.45,-561.37"/>
</g>
<!-- gate_l3_g11 -->
<g id="node328" class="node">
<title>gate_l3_g11</title>
<polygon fill="lightgreen" stroke="black" points="7628.45,-551.17 7169.45,-551.17 7169.45,-468.17 7628.45,-468.17 7628.45,-551.17"/>
<text text-anchor="middle" x="7398.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="7398.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="7398.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7398.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="7398.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g3&#45;&gt;gate_l3_g11 -->
<g id="edge477" class="edge">
<title>residual_l3_g3&#45;&gt;gate_l3_g11</title>
<path fill="none" stroke="black" d="M7260.27,-681.17C7260.27,-681.17 7260.27,-561.26 7260.27,-561.26"/>
<polygon fill="black" stroke="black" points="7263.77,-561.26 7260.27,-551.26 7256.77,-561.26 7263.77,-561.26"/>
</g>
<!-- aggregate_l3_g3 -->
<g id="node341" class="node">
<title>aggregate_l3_g3</title>
<polygon fill="lightyellow" stroke="black" points="7187.85,-298.17 6472.16,-298.17 6288.05,-132.17 7003.74,-132.17 7187.85,-298.17"/>
<text text-anchor="middle" x="6737.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6737.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="6737.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6737.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6737.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g3&#45;&gt;aggregate_l3_g3 -->
<g id="edge448" class="edge">
<title>residual_l3_g3&#45;&gt;aggregate_l3_g3</title>
<path fill="none" stroke="black" d="M7160.45,-586.93C7160.45,-586.93 7160.45,-225.21 7160.45,-225.21"/>
<polygon fill="black" stroke="black" points="7163.95,-225.21 7160.45,-215.21 7156.95,-225.21 7163.95,-225.21"/>
</g>
<!-- aggregate_l3_g11 -->
<g id="node349" class="node">
<title>aggregate_l3_g11</title>
<polygon fill="lightyellow" stroke="black" points="8105.85,-298.17 7390.16,-298.17 7206.05,-132.17 7921.74,-132.17 8105.85,-298.17"/>
<text text-anchor="middle" x="7655.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7655.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="7655.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7655.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7655.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g3&#45;&gt;aggregate_l3_g11 -->
<g id="edge480" class="edge">
<title>residual_l3_g3&#45;&gt;aggregate_l3_g11</title>
<path fill="none" stroke="black" d="M7263.95,-685C7484.56,-685 7731.18,-685 7731.18,-685 7731.18,-685 7731.18,-308.35 7731.18,-308.35"/>
<polygon fill="black" stroke="black" points="7734.68,-308.35 7731.18,-298.35 7727.68,-308.35 7734.68,-308.35"/>
</g>
<!-- allreduce_l3_g4&#45;&gt;residual_l3_g4 -->
<g id="edge414" class="edge">
<title>allreduce_l3_g4&#45;&gt;residual_l3_g4</title>
<path fill="none" stroke="black" d="M8761.95,-818.89C8761.95,-818.89 8761.95,-793.46 8761.95,-793.46"/>
<polygon fill="black" stroke="black" points="8765.45,-793.46 8761.95,-783.46 8758.45,-793.46 8765.45,-793.46"/>
</g>
<!-- gate_l3_g4 -->
<g id="node314" class="node">
<title>gate_l3_g4</title>
<polygon fill="lightgreen" stroke="black" points="8990.45,-551.17 8531.45,-551.17 8531.45,-468.17 8990.45,-468.17 8990.45,-551.17"/>
<text text-anchor="middle" x="8760.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="8760.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="8760.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8760.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8760.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g4&#45;&gt;gate_l3_g4 -->
<g id="edge449" class="edge">
<title>residual_l3_g4&#45;&gt;gate_l3_g4</title>
<path fill="none" stroke="black" d="M8760.95,-587.15C8760.95,-587.15 8760.95,-561.37 8760.95,-561.37"/>
<polygon fill="black" stroke="black" points="8764.45,-561.37 8760.95,-551.37 8757.45,-561.37 8764.45,-561.37"/>
</g>
<!-- gate_l3_g12 -->
<g id="node330" class="node">
<title>gate_l3_g12</title>
<polygon fill="lightgreen" stroke="black" points="9467.45,-551.17 9008.45,-551.17 9008.45,-468.17 9467.45,-468.17 9467.45,-551.17"/>
<text text-anchor="middle" x="9237.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="9237.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="9237.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="9237.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="9237.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g4&#45;&gt;gate_l3_g12 -->
<g id="edge481" class="edge">
<title>residual_l3_g4&#45;&gt;gate_l3_g12</title>
<path fill="none" stroke="black" d="M9098.77,-681.5C9098.77,-681.5 9098.77,-561.57 9098.77,-561.57"/>
<polygon fill="black" stroke="black" points="9102.27,-561.57 9098.77,-551.57 9095.27,-561.57 9102.27,-561.57"/>
</g>
<!-- aggregate_l3_g4 -->
<g id="node342" class="node">
<title>aggregate_l3_g4</title>
<polygon fill="lightyellow" stroke="black" points="9023.85,-298.17 8308.16,-298.17 8124.05,-132.17 8839.74,-132.17 9023.85,-298.17"/>
<text text-anchor="middle" x="8573.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8573.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="8573.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8573.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8573.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g4&#45;&gt;aggregate_l3_g4 -->
<g id="edge452" class="edge">
<title>residual_l3_g4&#45;&gt;aggregate_l3_g4</title>
<path fill="none" stroke="black" d="M8433.13,-586.93C8433.13,-586.93 8433.13,-308.36 8433.13,-308.36"/>
<polygon fill="black" stroke="black" points="8436.63,-308.36 8433.13,-298.36 8429.63,-308.36 8436.63,-308.36"/>
</g>
<!-- aggregate_l3_g12 -->
<g id="node350" class="node">
<title>aggregate_l3_g12</title>
<polygon fill="lightyellow" stroke="black" points="9941.85,-298.17 9226.16,-298.17 9042.05,-132.17 9757.74,-132.17 9941.85,-298.17"/>
<text text-anchor="middle" x="9491.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9491.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="9491.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="9491.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="9491.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g4&#45;&gt;aggregate_l3_g12 -->
<g id="edge484" class="edge">
<title>residual_l3_g4&#45;&gt;aggregate_l3_g12</title>
<path fill="none" stroke="black" d="M9101.95,-685C9322.56,-685 9569.18,-685 9569.18,-685 9569.18,-685 9569.18,-308.35 9569.18,-308.35"/>
<polygon fill="black" stroke="black" points="9572.68,-308.35 9569.18,-298.35 9565.68,-308.35 9572.68,-308.35"/>
</g>
<!-- allreduce_l3_g5&#45;&gt;residual_l3_g5 -->
<g id="edge420" class="edge">
<title>allreduce_l3_g5&#45;&gt;residual_l3_g5</title>
<path fill="none" stroke="black" d="M10594.95,-818.89C10594.95,-818.89 10594.95,-793.46 10594.95,-793.46"/>
<polygon fill="black" stroke="black" points="10598.45,-793.46 10594.95,-783.46 10591.45,-793.46 10598.45,-793.46"/>
</g>
<!-- gate_l3_g5 -->
<g id="node316" class="node">
<title>gate_l3_g5</title>
<polygon fill="lightgreen" stroke="black" points="10823.45,-551.17 10364.45,-551.17 10364.45,-468.17 10823.45,-468.17 10823.45,-551.17"/>
<text text-anchor="middle" x="10593.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="10593.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="10593.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10593.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="10593.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g5&#45;&gt;gate_l3_g5 -->
<g id="edge453" class="edge">
<title>residual_l3_g5&#45;&gt;gate_l3_g5</title>
<path fill="none" stroke="black" d="M10593.95,-587.15C10593.95,-587.15 10593.95,-561.37 10593.95,-561.37"/>
<polygon fill="black" stroke="black" points="10597.45,-561.37 10593.95,-551.37 10590.45,-561.37 10597.45,-561.37"/>
</g>
<!-- gate_l3_g13 -->
<g id="node332" class="node">
<title>gate_l3_g13</title>
<polygon fill="lightgreen" stroke="black" points="11300.45,-551.17 10841.45,-551.17 10841.45,-468.17 11300.45,-468.17 11300.45,-551.17"/>
<text text-anchor="middle" x="11070.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="11070.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="11070.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11070.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="11070.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g5&#45;&gt;gate_l3_g13 -->
<g id="edge485" class="edge">
<title>residual_l3_g5&#45;&gt;gate_l3_g13</title>
<path fill="none" stroke="black" d="M10931.77,-681.5C10931.77,-681.5 10931.77,-561.57 10931.77,-561.57"/>
<polygon fill="black" stroke="black" points="10935.27,-561.57 10931.77,-551.57 10928.27,-561.57 10935.27,-561.57"/>
</g>
<!-- aggregate_l3_g5 -->
<g id="node343" class="node">
<title>aggregate_l3_g5</title>
<polygon fill="lightyellow" stroke="black" points="10859.85,-298.17 10144.16,-298.17 9960.05,-132.17 10675.74,-132.17 10859.85,-298.17"/>
<text text-anchor="middle" x="10409.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10409.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="10409.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10409.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10409.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g5&#45;&gt;aggregate_l3_g5 -->
<g id="edge456" class="edge">
<title>residual_l3_g5&#45;&gt;aggregate_l3_g5</title>
<path fill="none" stroke="black" d="M10832.45,-586.93C10832.45,-586.93 10832.45,-225.21 10832.45,-225.21"/>
<polygon fill="black" stroke="black" points="10835.95,-225.21 10832.45,-215.21 10828.95,-225.21 10835.95,-225.21"/>
</g>
<!-- aggregate_l3_g13 -->
<g id="node351" class="node">
<title>aggregate_l3_g13</title>
<polygon fill="lightyellow" stroke="black" points="11777.85,-298.17 11062.16,-298.17 10878.05,-132.17 11593.74,-132.17 11777.85,-298.17"/>
<text text-anchor="middle" x="11327.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11327.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="11327.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11327.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11327.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g5&#45;&gt;aggregate_l3_g13 -->
<g id="edge488" class="edge">
<title>residual_l3_g5&#45;&gt;aggregate_l3_g13</title>
<path fill="none" stroke="black" d="M10934.7,-685C11155.94,-685 11403.68,-685 11403.68,-685 11403.68,-685 11403.68,-308.35 11403.68,-308.35"/>
<polygon fill="black" stroke="black" points="11407.18,-308.35 11403.68,-298.35 11400.18,-308.35 11407.18,-308.35"/>
</g>
<!-- allreduce_l3_g6&#45;&gt;residual_l3_g6 -->
<g id="edge426" class="edge">
<title>allreduce_l3_g6&#45;&gt;residual_l3_g6</title>
<path fill="none" stroke="black" d="M12449.95,-818.89C12449.95,-818.89 12449.95,-793.46 12449.95,-793.46"/>
<polygon fill="black" stroke="black" points="12453.45,-793.46 12449.95,-783.46 12446.45,-793.46 12453.45,-793.46"/>
</g>
<!-- gate_l3_g6 -->
<g id="node318" class="node">
<title>gate_l3_g6</title>
<polygon fill="lightgreen" stroke="black" points="12668.45,-551.17 12209.45,-551.17 12209.45,-468.17 12668.45,-468.17 12668.45,-551.17"/>
<text text-anchor="middle" x="12438.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12438.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="12438.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12438.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12438.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g6&#45;&gt;gate_l3_g6 -->
<g id="edge457" class="edge">
<title>residual_l3_g6&#45;&gt;gate_l3_g6</title>
<path fill="none" stroke="black" d="M12438.95,-587.15C12438.95,-587.15 12438.95,-561.37 12438.95,-561.37"/>
<polygon fill="black" stroke="black" points="12442.45,-561.37 12438.95,-551.37 12435.45,-561.37 12442.45,-561.37"/>
</g>
<!-- gate_l3_g14 -->
<g id="node334" class="node">
<title>gate_l3_g14</title>
<polygon fill="lightgreen" stroke="black" points="13145.45,-551.17 12686.45,-551.17 12686.45,-468.17 13145.45,-468.17 13145.45,-551.17"/>
<text text-anchor="middle" x="12915.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="12915.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="12915.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12915.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="12915.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g6&#45;&gt;gate_l3_g14 -->
<g id="edge489" class="edge">
<title>residual_l3_g6&#45;&gt;gate_l3_g14</title>
<path fill="none" stroke="black" d="M12781.77,-675.73C12781.77,-675.73 12781.77,-561.45 12781.77,-561.45"/>
<polygon fill="black" stroke="black" points="12785.27,-561.45 12781.77,-551.45 12778.27,-561.45 12785.27,-561.45"/>
</g>
<!-- aggregate_l3_g6 -->
<g id="node344" class="node">
<title>aggregate_l3_g6</title>
<polygon fill="lightyellow" stroke="black" points="12695.85,-298.17 11980.16,-298.17 11796.05,-132.17 12511.74,-132.17 12695.85,-298.17"/>
<text text-anchor="middle" x="12245.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12245.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="12245.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12245.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12245.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g6&#45;&gt;aggregate_l3_g6 -->
<g id="edge460" class="edge">
<title>residual_l3_g6&#45;&gt;aggregate_l3_g6</title>
<path fill="none" stroke="black" d="M12677.45,-586.93C12677.45,-586.93 12677.45,-225.21 12677.45,-225.21"/>
<polygon fill="black" stroke="black" points="12680.95,-225.21 12677.45,-215.21 12673.95,-225.21 12680.95,-225.21"/>
</g>
<!-- aggregate_l3_g14 -->
<g id="node352" class="node">
<title>aggregate_l3_g14</title>
<polygon fill="lightyellow" stroke="black" points="13613.85,-298.17 12898.16,-298.17 12714.05,-132.17 13429.74,-132.17 13613.85,-298.17"/>
<text text-anchor="middle" x="13163.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13163.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="13163.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="13163.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="13163.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g6&#45;&gt;aggregate_l3_g14 -->
<g id="edge492" class="edge">
<title>residual_l3_g6&#45;&gt;aggregate_l3_g14</title>
<path fill="none" stroke="black" d="M12746.21,-636C12974.59,-636 13251.68,-636 13251.68,-636 13251.68,-636 13251.68,-308.31 13251.68,-308.31"/>
<polygon fill="black" stroke="black" points="13255.18,-308.31 13251.68,-298.31 13248.18,-308.31 13255.18,-308.31"/>
</g>
<!-- allreduce_l3_g7&#45;&gt;residual_l3_g7 -->
<g id="edge432" class="edge">
<title>allreduce_l3_g7&#45;&gt;residual_l3_g7</title>
<path fill="none" stroke="black" d="M14294.95,-818.89C14294.95,-818.89 14294.95,-793.46 14294.95,-793.46"/>
<polygon fill="black" stroke="black" points="14298.45,-793.46 14294.95,-783.46 14291.45,-793.46 14298.45,-793.46"/>
</g>
<!-- gate_l3_g7 -->
<g id="node320" class="node">
<title>gate_l3_g7</title>
<polygon fill="lightgreen" stroke="black" points="14516.45,-551.17 14057.45,-551.17 14057.45,-468.17 14516.45,-468.17 14516.45,-551.17"/>
<text text-anchor="middle" x="14286.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="14286.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14286.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14286.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14286.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g7&#45;&gt;gate_l3_g7 -->
<g id="edge461" class="edge">
<title>residual_l3_g7&#45;&gt;gate_l3_g7</title>
<path fill="none" stroke="black" d="M14286.95,-587.15C14286.95,-587.15 14286.95,-561.37 14286.95,-561.37"/>
<polygon fill="black" stroke="black" points="14290.45,-561.37 14286.95,-551.37 14283.45,-561.37 14290.45,-561.37"/>
</g>
<!-- gate_l3_g15 -->
<g id="node336" class="node">
<title>gate_l3_g15</title>
<polygon fill="lightgreen" stroke="black" points="14993.45,-551.17 14534.45,-551.17 14534.45,-468.17 14993.45,-468.17 14993.45,-551.17"/>
<text text-anchor="middle" x="14763.95" y="-535.97" font-family="Times,serif" font-size="14.00">Gating Network</text>
<text text-anchor="middle" x="14763.95" y="-520.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14763.95" y="-505.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14763.95" y="-490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="14763.95" y="-475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_experts=16]</text>
</g>
<!-- residual_l3_g7&#45;&gt;gate_l3_g15 -->
<g id="edge493" class="edge">
<title>residual_l3_g7&#45;&gt;gate_l3_g15</title>
<path fill="none" stroke="black" d="M14628.27,-677.63C14628.27,-677.63 14628.27,-561.2 14628.27,-561.2"/>
<polygon fill="black" stroke="black" points="14631.77,-561.2 14628.27,-551.2 14624.77,-561.2 14631.77,-561.2"/>
</g>
<!-- aggregate_l3_g7 -->
<g id="node345" class="node">
<title>aggregate_l3_g7</title>
<polygon fill="lightyellow" stroke="black" points="14531.85,-298.17 13816.16,-298.17 13632.05,-132.17 14347.74,-132.17 14531.85,-298.17"/>
<text text-anchor="middle" x="14081.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14081.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14081.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14081.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14081.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g7&#45;&gt;aggregate_l3_g7 -->
<g id="edge464" class="edge">
<title>residual_l3_g7&#45;&gt;aggregate_l3_g7</title>
<path fill="none" stroke="black" d="M14524.18,-586.93C14524.18,-586.93 14524.18,-225.21 14524.18,-225.21"/>
<polygon fill="black" stroke="black" points="14527.68,-225.21 14524.18,-215.21 14520.68,-225.21 14527.68,-225.21"/>
</g>
<!-- aggregate_l3_g15 -->
<g id="node353" class="node">
<title>aggregate_l3_g15</title>
<polygon fill="lightyellow" stroke="black" points="15449.85,-298.17 14734.16,-298.17 14550.05,-132.17 15265.74,-132.17 15449.85,-298.17"/>
<text text-anchor="middle" x="14999.95" y="-241.47" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14999.95" y="-226.47" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14999.95" y="-211.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14999.95" y="-196.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14999.95" y="-181.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
</g>
<!-- residual_l3_g7&#45;&gt;aggregate_l3_g15 -->
<g id="edge496" class="edge">
<title>residual_l3_g7&#45;&gt;aggregate_l3_g15</title>
<path fill="none" stroke="black" d="M14605.5,-652C14831.53,-652 15098.18,-652 15098.18,-652 15098.18,-652 15098.18,-308.36 15098.18,-308.36"/>
<polygon fill="black" stroke="black" points="15101.68,-308.36 15098.18,-298.36 15094.68,-308.36 15101.68,-308.36"/>
</g>
<!-- expert_l3_e0_g0 -->
<g id="node307" class="node">
<title>expert_l3_e0_g0</title>
<polygon fill="lightgreen" stroke="black" points="1632.95,-432.17 1186.95,-432.17 1186.95,-334.17 1632.95,-334.17 1632.95,-432.17"/>
<text text-anchor="middle" x="1409.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1409.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1409.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1409.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1409.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1409.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g0&#45;&gt;expert_l3_e0_g0 -->
<g id="edge434" class="edge">
<title>gate_l3_g0&#45;&gt;expert_l3_e0_g0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1409.95,-467.9C1409.95,-467.9 1409.95,-442.36 1409.95,-442.36"/>
<polygon fill="black" stroke="black" points="1413.45,-442.36 1409.95,-432.36 1406.45,-442.36 1413.45,-442.36"/>
</g>
<!-- expert_l3_e0_g0&#45;&gt;aggregate_l3_g0 -->
<g id="edge435" class="edge">
<title>expert_l3_e0_g0&#45;&gt;aggregate_l3_g0</title>
<path fill="none" stroke="black" d="M1409.95,-334.12C1409.95,-334.12 1409.95,-308.41 1409.95,-308.41"/>
<polygon fill="black" stroke="black" points="1413.45,-308.41 1409.95,-298.41 1406.45,-308.41 1413.45,-308.41"/>
</g>
<!-- expert_l3_e1_g1 -->
<g id="node309" class="node">
<title>expert_l3_e1_g1</title>
<polygon fill="lightgreen" stroke="black" points="3468.95,-432.17 3022.95,-432.17 3022.95,-334.17 3468.95,-334.17 3468.95,-432.17"/>
<text text-anchor="middle" x="3245.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3245.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3245.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3245.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3245.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3245.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g1&#45;&gt;expert_l3_e1_g1 -->
<g id="edge438" class="edge">
<title>gate_l3_g1&#45;&gt;expert_l3_e1_g1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3245.95,-467.9C3245.95,-467.9 3245.95,-442.36 3245.95,-442.36"/>
<polygon fill="black" stroke="black" points="3249.45,-442.36 3245.95,-432.36 3242.45,-442.36 3249.45,-442.36"/>
</g>
<!-- expert_l3_e1_g1&#45;&gt;aggregate_l3_g1 -->
<g id="edge439" class="edge">
<title>expert_l3_e1_g1&#45;&gt;aggregate_l3_g1</title>
<path fill="none" stroke="black" d="M3245.95,-334.12C3245.95,-334.12 3245.95,-308.41 3245.95,-308.41"/>
<polygon fill="black" stroke="black" points="3249.45,-308.41 3245.95,-298.41 3242.45,-308.41 3249.45,-308.41"/>
</g>
<!-- expert_l3_e2_g2 -->
<g id="node311" class="node">
<title>expert_l3_e2_g2</title>
<polygon fill="lightgreen" stroke="black" points="5304.95,-432.17 4858.95,-432.17 4858.95,-334.17 5304.95,-334.17 5304.95,-432.17"/>
<text text-anchor="middle" x="5081.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5081.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="5081.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="5081.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5081.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5081.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g2&#45;&gt;expert_l3_e2_g2 -->
<g id="edge442" class="edge">
<title>gate_l3_g2&#45;&gt;expert_l3_e2_g2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5081.95,-467.9C5081.95,-467.9 5081.95,-442.36 5081.95,-442.36"/>
<polygon fill="black" stroke="black" points="5085.45,-442.36 5081.95,-432.36 5078.45,-442.36 5085.45,-442.36"/>
</g>
<!-- expert_l3_e2_g2&#45;&gt;aggregate_l3_g2 -->
<g id="edge443" class="edge">
<title>expert_l3_e2_g2&#45;&gt;aggregate_l3_g2</title>
<path fill="none" stroke="black" d="M5081.95,-334.12C5081.95,-334.12 5081.95,-308.41 5081.95,-308.41"/>
<polygon fill="black" stroke="black" points="5085.45,-308.41 5081.95,-298.41 5078.45,-308.41 5085.45,-308.41"/>
</g>
<!-- expert_l3_e3_g3 -->
<g id="node313" class="node">
<title>expert_l3_e3_g3</title>
<polygon fill="lightgreen" stroke="black" points="7140.95,-432.17 6694.95,-432.17 6694.95,-334.17 7140.95,-334.17 7140.95,-432.17"/>
<text text-anchor="middle" x="6917.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6917.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="6917.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="6917.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6917.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="6917.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g3&#45;&gt;expert_l3_e3_g3 -->
<g id="edge446" class="edge">
<title>gate_l3_g3&#45;&gt;expert_l3_e3_g3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6917.95,-467.9C6917.95,-467.9 6917.95,-442.36 6917.95,-442.36"/>
<polygon fill="black" stroke="black" points="6921.45,-442.36 6917.95,-432.36 6914.45,-442.36 6921.45,-442.36"/>
</g>
<!-- expert_l3_e3_g3&#45;&gt;aggregate_l3_g3 -->
<g id="edge447" class="edge">
<title>expert_l3_e3_g3&#45;&gt;aggregate_l3_g3</title>
<path fill="none" stroke="black" d="M6917.95,-334.12C6917.95,-334.12 6917.95,-308.41 6917.95,-308.41"/>
<polygon fill="black" stroke="black" points="6921.45,-308.41 6917.95,-298.41 6914.45,-308.41 6921.45,-308.41"/>
</g>
<!-- expert_l3_e4_g4 -->
<g id="node315" class="node">
<title>expert_l3_e4_g4</title>
<polygon fill="lightgreen" stroke="black" points="8979.95,-432.17 8533.95,-432.17 8533.95,-334.17 8979.95,-334.17 8979.95,-432.17"/>
<text text-anchor="middle" x="8756.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8756.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="8756.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="8756.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8756.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="8756.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g4&#45;&gt;expert_l3_e4_g4 -->
<g id="edge450" class="edge">
<title>gate_l3_g4&#45;&gt;expert_l3_e4_g4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8756.95,-467.9C8756.95,-467.9 8756.95,-442.36 8756.95,-442.36"/>
<polygon fill="black" stroke="black" points="8760.45,-442.36 8756.95,-432.36 8753.45,-442.36 8760.45,-442.36"/>
</g>
<!-- expert_l3_e4_g4&#45;&gt;aggregate_l3_g4 -->
<g id="edge451" class="edge">
<title>expert_l3_e4_g4&#45;&gt;aggregate_l3_g4</title>
<path fill="none" stroke="black" d="M8756.95,-334.12C8756.95,-334.12 8756.95,-308.41 8756.95,-308.41"/>
<polygon fill="black" stroke="black" points="8760.45,-308.41 8756.95,-298.41 8753.45,-308.41 8760.45,-308.41"/>
</g>
<!-- expert_l3_e5_g5 -->
<g id="node317" class="node">
<title>expert_l3_e5_g5</title>
<polygon fill="lightgreen" stroke="black" points="10812.95,-432.17 10366.95,-432.17 10366.95,-334.17 10812.95,-334.17 10812.95,-432.17"/>
<text text-anchor="middle" x="10589.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10589.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="10589.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10589.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10589.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="10589.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g5&#45;&gt;expert_l3_e5_g5 -->
<g id="edge454" class="edge">
<title>gate_l3_g5&#45;&gt;expert_l3_e5_g5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10589.95,-467.9C10589.95,-467.9 10589.95,-442.36 10589.95,-442.36"/>
<polygon fill="black" stroke="black" points="10593.45,-442.36 10589.95,-432.36 10586.45,-442.36 10593.45,-442.36"/>
</g>
<!-- expert_l3_e5_g5&#45;&gt;aggregate_l3_g5 -->
<g id="edge455" class="edge">
<title>expert_l3_e5_g5&#45;&gt;aggregate_l3_g5</title>
<path fill="none" stroke="black" d="M10589.95,-334.12C10589.95,-334.12 10589.95,-308.41 10589.95,-308.41"/>
<polygon fill="black" stroke="black" points="10593.45,-308.41 10589.95,-298.41 10586.45,-308.41 10593.45,-308.41"/>
</g>
<!-- expert_l3_e6_g6 -->
<g id="node319" class="node">
<title>expert_l3_e6_g6</title>
<polygon fill="lightgreen" stroke="black" points="12657.95,-432.17 12211.95,-432.17 12211.95,-334.17 12657.95,-334.17 12657.95,-432.17"/>
<text text-anchor="middle" x="12434.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12434.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="12434.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="12434.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12434.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12434.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g6&#45;&gt;expert_l3_e6_g6 -->
<g id="edge458" class="edge">
<title>gate_l3_g6&#45;&gt;expert_l3_e6_g6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12434.95,-467.9C12434.95,-467.9 12434.95,-442.36 12434.95,-442.36"/>
<polygon fill="black" stroke="black" points="12438.45,-442.36 12434.95,-432.36 12431.45,-442.36 12438.45,-442.36"/>
</g>
<!-- expert_l3_e6_g6&#45;&gt;aggregate_l3_g6 -->
<g id="edge459" class="edge">
<title>expert_l3_e6_g6&#45;&gt;aggregate_l3_g6</title>
<path fill="none" stroke="black" d="M12434.95,-334.12C12434.95,-334.12 12434.95,-308.41 12434.95,-308.41"/>
<polygon fill="black" stroke="black" points="12438.45,-308.41 12434.95,-298.41 12431.45,-308.41 12438.45,-308.41"/>
</g>
<!-- expert_l3_e7_g7 -->
<g id="node321" class="node">
<title>expert_l3_e7_g7</title>
<polygon fill="lightgreen" stroke="black" points="14505.95,-432.17 14059.95,-432.17 14059.95,-334.17 14505.95,-334.17 14505.95,-432.17"/>
<text text-anchor="middle" x="14282.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="14282.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14282.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="14282.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14282.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14282.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g7&#45;&gt;expert_l3_e7_g7 -->
<g id="edge462" class="edge">
<title>gate_l3_g7&#45;&gt;expert_l3_e7_g7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14282.95,-467.9C14282.95,-467.9 14282.95,-442.36 14282.95,-442.36"/>
<polygon fill="black" stroke="black" points="14286.45,-442.36 14282.95,-432.36 14279.45,-442.36 14286.45,-442.36"/>
</g>
<!-- expert_l3_e7_g7&#45;&gt;aggregate_l3_g7 -->
<g id="edge463" class="edge">
<title>expert_l3_e7_g7&#45;&gt;aggregate_l3_g7</title>
<path fill="none" stroke="black" d="M14282.95,-334.12C14282.95,-334.12 14282.95,-308.41 14282.95,-308.41"/>
<polygon fill="black" stroke="black" points="14286.45,-308.41 14282.95,-298.41 14279.45,-308.41 14286.45,-308.41"/>
</g>
<!-- expert_l3_e8_g8 -->
<g id="node323" class="node">
<title>expert_l3_e8_g8</title>
<polygon fill="lightgreen" stroke="black" points="2116.95,-432.17 1670.95,-432.17 1670.95,-334.17 2116.95,-334.17 2116.95,-432.17"/>
<text text-anchor="middle" x="1893.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1893.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1893.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1893.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1893.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="1893.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g8&#45;&gt;expert_l3_e8_g8 -->
<g id="edge466" class="edge">
<title>gate_l3_g8&#45;&gt;expert_l3_e8_g8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1893.95,-467.9C1893.95,-467.9 1893.95,-442.36 1893.95,-442.36"/>
<polygon fill="black" stroke="black" points="1897.45,-442.36 1893.95,-432.36 1890.45,-442.36 1897.45,-442.36"/>
</g>
<!-- expert_l3_e8_g8&#45;&gt;aggregate_l3_g8 -->
<g id="edge467" class="edge">
<title>expert_l3_e8_g8&#45;&gt;aggregate_l3_g8</title>
<path fill="none" stroke="black" d="M1907.48,-334.12C1907.48,-334.12 1907.48,-308.41 1907.48,-308.41"/>
<polygon fill="black" stroke="black" points="1910.98,-308.41 1907.48,-298.41 1903.98,-308.41 1910.98,-308.41"/>
</g>
<!-- expert_l3_e9_g9 -->
<g id="node325" class="node">
<title>expert_l3_e9_g9</title>
<polygon fill="lightgreen" stroke="black" points="3952.95,-432.17 3506.95,-432.17 3506.95,-334.17 3952.95,-334.17 3952.95,-432.17"/>
<text text-anchor="middle" x="3729.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3729.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3729.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3729.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3729.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="3729.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g9&#45;&gt;expert_l3_e9_g9 -->
<g id="edge470" class="edge">
<title>gate_l3_g9&#45;&gt;expert_l3_e9_g9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3729.95,-467.9C3729.95,-467.9 3729.95,-442.36 3729.95,-442.36"/>
<polygon fill="black" stroke="black" points="3733.45,-442.36 3729.95,-432.36 3726.45,-442.36 3733.45,-442.36"/>
</g>
<!-- expert_l3_e9_g9&#45;&gt;aggregate_l3_g9 -->
<g id="edge471" class="edge">
<title>expert_l3_e9_g9&#45;&gt;aggregate_l3_g9</title>
<path fill="none" stroke="black" d="M3743.48,-334.12C3743.48,-334.12 3743.48,-308.41 3743.48,-308.41"/>
<polygon fill="black" stroke="black" points="3746.98,-308.41 3743.48,-298.41 3739.98,-308.41 3746.98,-308.41"/>
</g>
<!-- expert_l3_e10_g10 -->
<g id="node327" class="node">
<title>expert_l3_e10_g10</title>
<polygon fill="lightgreen" stroke="black" points="5789.95,-432.17 5343.95,-432.17 5343.95,-334.17 5789.95,-334.17 5789.95,-432.17"/>
<text text-anchor="middle" x="5566.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="5566.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="5566.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5566.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5566.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="5566.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g10&#45;&gt;expert_l3_e10_g10 -->
<g id="edge474" class="edge">
<title>gate_l3_g10&#45;&gt;expert_l3_e10_g10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5566.95,-467.9C5566.95,-467.9 5566.95,-442.36 5566.95,-442.36"/>
<polygon fill="black" stroke="black" points="5570.45,-442.36 5566.95,-432.36 5563.45,-442.36 5570.45,-442.36"/>
</g>
<!-- expert_l3_e10_g10&#45;&gt;aggregate_l3_g10 -->
<g id="edge475" class="edge">
<title>expert_l3_e10_g10&#45;&gt;aggregate_l3_g10</title>
<path fill="none" stroke="black" d="M5579.98,-334.12C5579.98,-334.12 5579.98,-308.41 5579.98,-308.41"/>
<polygon fill="black" stroke="black" points="5583.48,-308.41 5579.98,-298.41 5576.48,-308.41 5583.48,-308.41"/>
</g>
<!-- expert_l3_e11_g11 -->
<g id="node329" class="node">
<title>expert_l3_e11_g11</title>
<polygon fill="lightgreen" stroke="black" points="7624.95,-432.17 7178.95,-432.17 7178.95,-334.17 7624.95,-334.17 7624.95,-432.17"/>
<text text-anchor="middle" x="7401.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7401.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="7401.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7401.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7401.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="7401.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g11&#45;&gt;expert_l3_e11_g11 -->
<g id="edge478" class="edge">
<title>gate_l3_g11&#45;&gt;expert_l3_e11_g11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7401.95,-467.9C7401.95,-467.9 7401.95,-442.36 7401.95,-442.36"/>
<polygon fill="black" stroke="black" points="7405.45,-442.36 7401.95,-432.36 7398.45,-442.36 7405.45,-442.36"/>
</g>
<!-- expert_l3_e11_g11&#45;&gt;aggregate_l3_g11 -->
<g id="edge479" class="edge">
<title>expert_l3_e11_g11&#45;&gt;aggregate_l3_g11</title>
<path fill="none" stroke="black" d="M7415.48,-334.12C7415.48,-334.12 7415.48,-308.41 7415.48,-308.41"/>
<polygon fill="black" stroke="black" points="7418.98,-308.41 7415.48,-298.41 7411.98,-308.41 7418.98,-308.41"/>
</g>
<!-- expert_l3_e12_g12 -->
<g id="node331" class="node">
<title>expert_l3_e12_g12</title>
<polygon fill="lightgreen" stroke="black" points="9464.95,-432.17 9018.95,-432.17 9018.95,-334.17 9464.95,-334.17 9464.95,-432.17"/>
<text text-anchor="middle" x="9241.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="9241.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="9241.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="9241.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="9241.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="9241.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g12&#45;&gt;expert_l3_e12_g12 -->
<g id="edge482" class="edge">
<title>gate_l3_g12&#45;&gt;expert_l3_e12_g12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9241.95,-467.9C9241.95,-467.9 9241.95,-442.36 9241.95,-442.36"/>
<polygon fill="black" stroke="black" points="9245.45,-442.36 9241.95,-432.36 9238.45,-442.36 9245.45,-442.36"/>
</g>
<!-- expert_l3_e12_g12&#45;&gt;aggregate_l3_g12 -->
<g id="edge483" class="edge">
<title>expert_l3_e12_g12&#45;&gt;aggregate_l3_g12</title>
<path fill="none" stroke="black" d="M9253.48,-334.12C9253.48,-334.12 9253.48,-308.41 9253.48,-308.41"/>
<polygon fill="black" stroke="black" points="9256.98,-308.41 9253.48,-298.41 9249.98,-308.41 9256.98,-308.41"/>
</g>
<!-- expert_l3_e13_g13 -->
<g id="node333" class="node">
<title>expert_l3_e13_g13</title>
<polygon fill="lightgreen" stroke="black" points="11296.95,-432.17 10850.95,-432.17 10850.95,-334.17 11296.95,-334.17 11296.95,-432.17"/>
<text text-anchor="middle" x="11073.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="11073.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="11073.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="11073.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11073.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="11073.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g13&#45;&gt;expert_l3_e13_g13 -->
<g id="edge486" class="edge">
<title>gate_l3_g13&#45;&gt;expert_l3_e13_g13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11073.95,-467.9C11073.95,-467.9 11073.95,-442.36 11073.95,-442.36"/>
<polygon fill="black" stroke="black" points="11077.45,-442.36 11073.95,-432.36 11070.45,-442.36 11077.45,-442.36"/>
</g>
<!-- expert_l3_e13_g13&#45;&gt;aggregate_l3_g13 -->
<g id="edge487" class="edge">
<title>expert_l3_e13_g13&#45;&gt;aggregate_l3_g13</title>
<path fill="none" stroke="black" d="M11087.48,-334.12C11087.48,-334.12 11087.48,-308.41 11087.48,-308.41"/>
<polygon fill="black" stroke="black" points="11090.98,-308.41 11087.48,-298.41 11083.98,-308.41 11090.98,-308.41"/>
</g>
<!-- expert_l3_e14_g14 -->
<g id="node335" class="node">
<title>expert_l3_e14_g14</title>
<polygon fill="lightgreen" stroke="black" points="13141.95,-432.17 12695.95,-432.17 12695.95,-334.17 13141.95,-334.17 13141.95,-432.17"/>
<text text-anchor="middle" x="12918.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="12918.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="12918.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12918.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12918.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="12918.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g14&#45;&gt;expert_l3_e14_g14 -->
<g id="edge490" class="edge">
<title>gate_l3_g14&#45;&gt;expert_l3_e14_g14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12918.95,-467.9C12918.95,-467.9 12918.95,-442.36 12918.95,-442.36"/>
<polygon fill="black" stroke="black" points="12922.45,-442.36 12918.95,-432.36 12915.45,-442.36 12922.45,-442.36"/>
</g>
<!-- expert_l3_e14_g14&#45;&gt;aggregate_l3_g14 -->
<g id="edge491" class="edge">
<title>expert_l3_e14_g14&#45;&gt;aggregate_l3_g14</title>
<path fill="none" stroke="black" d="M12927.98,-334.12C12927.98,-334.12 12927.98,-308.41 12927.98,-308.41"/>
<polygon fill="black" stroke="black" points="12931.48,-308.41 12927.98,-298.41 12924.48,-308.41 12931.48,-308.41"/>
</g>
<!-- expert_l3_e15_g15 -->
<g id="node337" class="node">
<title>expert_l3_e15_g15</title>
<polygon fill="lightgreen" stroke="black" points="14989.95,-432.17 14543.95,-432.17 14543.95,-334.17 14989.95,-334.17 14989.95,-432.17"/>
<text text-anchor="middle" x="14766.95" y="-416.97" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="14766.95" y="-401.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14766.95" y="-386.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14766.95" y="-371.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14766.95" y="-356.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, seq_len=variable, dim=8192]</text>
<text text-anchor="middle" x="14766.95" y="-341.97" font-family="Times,serif" font-size="14.00">Type: MLP [8192327688192]</text>
</g>
<!-- gate_l3_g15&#45;&gt;expert_l3_e15_g15 -->
<g id="edge494" class="edge">
<title>gate_l3_g15&#45;&gt;expert_l3_e15_g15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14766.95,-467.9C14766.95,-467.9 14766.95,-442.36 14766.95,-442.36"/>
<polygon fill="black" stroke="black" points="14770.45,-442.36 14766.95,-432.36 14763.45,-442.36 14770.45,-442.36"/>
</g>
<!-- expert_l3_e15_g15&#45;&gt;aggregate_l3_g15 -->
<g id="edge495" class="edge">
<title>expert_l3_e15_g15&#45;&gt;aggregate_l3_g15</title>
<path fill="none" stroke="black" d="M14769.98,-334.12C14769.98,-334.12 14769.98,-308.41 14769.98,-308.41"/>
<polygon fill="black" stroke="black" points="14773.48,-308.41 14769.98,-298.41 14766.48,-308.41 14773.48,-308.41"/>
</g>
<!-- output -->
<g id="node354" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="8114.95" cy="-48.08" rx="291.16" ry="48.17"/>
<text text-anchor="middle" x="8114.95" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8114.95" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8114.95" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, dim=8192]</text>
<text text-anchor="middle" x="8114.95" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- aggregate_l3_g0&#45;&gt;output -->
<g id="edge497" class="edge">
<title>aggregate_l3_g0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1229.95,-131.94C1229.95,-75.84 1229.95,-12 1229.95,-12 1229.95,-12 7912.26,-12 7912.26,-12"/>
<polygon fill="black" stroke="black" points="7912.26,-15.5 7922.26,-12 7912.26,-8.5 7912.26,-15.5"/>
</g>
<!-- aggregate_l3_g1&#45;&gt;output -->
<g id="edge498" class="edge">
<title>aggregate_l3_g1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3065.95,-132.14C3065.95,-85.27 3065.95,-36 3065.95,-36 3065.95,-36 7822.68,-36 7822.68,-36"/>
<polygon fill="black" stroke="black" points="7822.68,-39.5 7832.68,-36 7822.68,-32.5 7822.68,-39.5"/>
</g>
<!-- aggregate_l3_g2&#45;&gt;output -->
<g id="edge499" class="edge">
<title>aggregate_l3_g2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4901.95,-132.13C4901.95,-95.24 4901.95,-60 4901.95,-60 4901.95,-60 7822.63,-60 7822.63,-60"/>
<polygon fill="black" stroke="black" points="7822.63,-63.5 7832.63,-60 7822.63,-56.5 7822.63,-63.5"/>
</g>
<!-- aggregate_l3_g3&#45;&gt;output -->
<g id="edge500" class="edge">
<title>aggregate_l3_g3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6737.95,-132.1C6737.95,-106.07 6737.95,-84 6737.95,-84 6737.95,-84 7910.94,-84 7910.94,-84"/>
<polygon fill="black" stroke="black" points="7910.94,-87.5 7920.94,-84 7910.94,-80.5 7910.94,-87.5"/>
</g>
<!-- aggregate_l3_g4&#45;&gt;output -->
<g id="edge501" class="edge">
<title>aggregate_l3_g4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8265.14,-132.11C8265.14,-132.11 8265.14,-99.66 8265.14,-99.66"/>
<polygon fill="black" stroke="black" points="8268.64,-99.66 8265.14,-89.66 8261.64,-99.66 8268.64,-99.66"/>
</g>
<!-- aggregate_l3_g5&#45;&gt;output -->
<g id="edge502" class="edge">
<title>aggregate_l3_g5&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10409.95,-131.89C10409.95,-100.39 10409.95,-72 10409.95,-72 10409.95,-72 8377.95,-72 8377.95,-72"/>
<polygon fill="black" stroke="black" points="8377.95,-68.5 8367.95,-72 8377.95,-75.5 8377.95,-68.5"/>
</g>
<!-- aggregate_l3_g6&#45;&gt;output -->
<g id="edge503" class="edge">
<title>aggregate_l3_g6&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12245.95,-132.07C12245.95,-90.12 12245.95,-48 12245.95,-48 12245.95,-48 8416.67,-48 8416.67,-48"/>
<polygon fill="black" stroke="black" points="8416.67,-44.5 8406.67,-48 8416.67,-51.5 8416.67,-44.5"/>
</g>
<!-- aggregate_l3_g7&#45;&gt;output -->
<g id="edge504" class="edge">
<title>aggregate_l3_g7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14081.95,-132.15C14081.95,-80.56 14081.95,-24 14081.95,-24 14081.95,-24 8377.53,-24 8377.53,-24"/>
<polygon fill="black" stroke="black" points="8377.53,-20.5 8367.53,-24 8377.53,-27.5 8377.53,-20.5"/>
</g>
<!-- aggregate_l3_g8&#45;&gt;output -->
<g id="edge505" class="edge">
<title>aggregate_l3_g8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2147.95,-132.15C2147.95,-80.56 2147.95,-24 2147.95,-24 2147.95,-24 7852.37,-24 7852.37,-24"/>
<polygon fill="black" stroke="black" points="7852.37,-27.5 7862.37,-24 7852.37,-20.5 7852.37,-27.5"/>
</g>
<!-- aggregate_l3_g9&#45;&gt;output -->
<g id="edge506" class="edge">
<title>aggregate_l3_g9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3983.95,-132.07C3983.95,-90.12 3983.95,-48 3983.95,-48 3983.95,-48 7813.23,-48 7813.23,-48"/>
<polygon fill="black" stroke="black" points="7813.23,-51.5 7823.23,-48 7813.23,-44.5 7813.23,-51.5"/>
</g>
<!-- aggregate_l3_g10&#45;&gt;output -->
<g id="edge507" class="edge">
<title>aggregate_l3_g10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5819.95,-131.89C5819.95,-100.39 5819.95,-72 5819.95,-72 5819.95,-72 7851.96,-72 7851.96,-72"/>
<polygon fill="black" stroke="black" points="7851.96,-75.5 7861.96,-72 7851.96,-68.5 7851.96,-75.5"/>
</g>
<!-- aggregate_l3_g11&#45;&gt;output -->
<g id="edge508" class="edge">
<title>aggregate_l3_g11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7964.76,-170.83C7964.76,-170.83 7964.76,-99.47 7964.76,-99.47"/>
<polygon fill="black" stroke="black" points="7968.26,-99.47 7964.76,-89.47 7961.26,-99.47 7968.26,-99.47"/>
</g>
<!-- aggregate_l3_g12&#45;&gt;output -->
<g id="edge509" class="edge">
<title>aggregate_l3_g12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9491.95,-132.1C9491.95,-106.07 9491.95,-84 9491.95,-84 9491.95,-84 8318.96,-84 8318.96,-84"/>
<polygon fill="black" stroke="black" points="8318.96,-80.5 8308.96,-84 8318.96,-87.5 8318.96,-80.5"/>
</g>
<!-- aggregate_l3_g13&#45;&gt;output -->
<g id="edge510" class="edge">
<title>aggregate_l3_g13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11327.95,-132.13C11327.95,-95.24 11327.95,-60 11327.95,-60 11327.95,-60 8407.27,-60 8407.27,-60"/>
<polygon fill="black" stroke="black" points="8407.27,-56.5 8397.27,-60 8407.27,-63.5 8407.27,-56.5"/>
</g>
<!-- aggregate_l3_g14&#45;&gt;output -->
<g id="edge511" class="edge">
<title>aggregate_l3_g14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M13163.95,-132.14C13163.95,-85.27 13163.95,-36 13163.95,-36 13163.95,-36 8407.23,-36 8407.23,-36"/>
<polygon fill="black" stroke="black" points="8407.23,-32.5 8397.23,-36 8407.23,-39.5 8407.23,-32.5"/>
</g>
<!-- aggregate_l3_g15&#45;&gt;output -->
<g id="edge512" class="edge">
<title>aggregate_l3_g15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14999.95,-131.94C14999.95,-75.84 14999.95,-12 14999.95,-12 14999.95,-12 8317.64,-12 8317.64,-12"/>
<polygon fill="black" stroke="black" points="8317.64,-8.5 8307.64,-12 8317.64,-15.5 8317.64,-8.5"/>
</g>
</g>
</svg>
